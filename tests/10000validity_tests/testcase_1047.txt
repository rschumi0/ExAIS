import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul18045 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Mul18045 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Loc8016 = tf.keras.layers.Input(shape=([2, 2, 2]))

Mul18045 = keras.layers.Multiply(name = 'Mul18045', )([in0Mul18045,in1Mul18045])
Res82908 = keras.layers.Reshape((2, 1, 4), name = 'Res82908', )(Mul18045)
Zer54246 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer54246', )(Res82908)
Loc8016 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc8016', )(in0Loc8016)
Min88282 = keras.layers.Minimum(name = 'Min88282', )([Zer54246,Loc8016])
Loc32009 = keras.layers.LocallyConnected2D(2, (2, 1),strides=(1, 2), name = 'Loc32009', )(Min88282)
ELU52090 = keras.layers.ELU(alpha=-1.3297983560138533, name = 'ELU52090', )(Loc32009)
model = tf.keras.models.Model(inputs=[in0Mul18045,in1Mul18045,in0Loc8016], outputs=ELU52090)
w = model.get_layer('Loc8016').get_weights() 
w[0] = np.array([[[0.2825, 0.0889, 0.3395, 0.4785], [0.635, 0.7185, 0.3056, 0.6527]], [[0.8036, 0.9198, 0.0603, 0.2793], [0.7593, 0.8912, 0.0987, 0.6026]], [[0.7471, 0.9756, 0.0661, 0.1519], [0.9207, 0.9473, 0.9857, 0.7427]], [[0.6508, 0.7054, 0.7695, 0.7208], [0.273, 0.7249, 0.3322, 0.1423]]])
w[1] = np.array([[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0]]])
model.get_layer('Loc8016').set_weights(w) 
w = model.get_layer('Loc32009').get_weights() 
w[0] = np.array([[[0.6074, 0.5961], [0.4308, 0.9216], [0.4616, 0.1323], [0.2971, 0.3173], [0.4546, 0.1499], [0.2676, 0.6207], [0.6985, 0.6634], [0.4353, 0.2969]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc32009').set_weights(w) 
in0Mul18045 = tf.constant([[[[[0.0829, 0.0403], [0.2466, 0.4756]]], [[[0.0005, 0.5458], [0.4073, 0.0426]]]]])
in1Mul18045 = tf.constant([[[[[0.6167, 0.2772], [0.7264, 0.4495]]], [[[0.1482, 0.9898], [0.5758, 0.303]]]]])
in0Loc8016 = tf.constant([[[[0.6781, 0.8162], [0.6826, 0.0388]], [[0.563, 0.1958], [0.8059, 0.4029]]]])
print (np.array2string(model.predict([in0Mul18045,in1Mul18045,in0Loc8016],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU52090.png')

LMul18045 = multiply_layer([[[[[[0.0829, 0.0403], [0.2466, 0.4756]]], [[[0.0005, 0.5458], [0.4073, 0.0426]]]]], [[[[[0.6167, 0.2772], [0.7264, 0.4495]]], [[[0.1482, 0.9898], [0.5758, 0.303]]]]]], Mul18045), 
LRes82908 = reshape_layer(Mul18045, [2, 1, 4], Res82908), 
LZer54246 = zero_padding2D_layer(Res82908, 0, 0, 1, 0, Zer54246), 
LLoc8016 = locally_connected2D_layer([[[[0.6781, 0.8162], [0.6826, 0.0388]], [[0.563, 0.1958], [0.8059, 0.4029]]]], 1, 1,[[[0.2825, 0.0889, 0.3395, 0.4785], [0.635, 0.7185, 0.3056, 0.6527]], [[0.8036, 0.9198, 0.0603, 0.2793], [0.7593, 0.8912, 0.0987, 0.6026]], [[0.7471, 0.9756, 0.0661, 0.1519], [0.9207, 0.9473, 0.9857, 0.7427]], [[0.6508, 0.7054, 0.7695, 0.7208], [0.273, 0.7249, 0.3322, 0.1423]]],[[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0]]], 1, 1, Loc8016), 
LMin88282 = minimum_layer([Zer54246,Loc8016], Min88282), 
LLoc32009 = locally_connected2D_layer(Min88282, 2, 1,[[[0.6074, 0.5961], [0.4308, 0.9216], [0.4616, 0.1323], [0.2971, 0.3173], [0.4546, 0.1499], [0.2676, 0.6207], [0.6985, 0.6634], [0.4353, 0.2969]]],[[[0, 0]]], 1, 2, Loc32009), 
LELU52090 = elu_layer(Loc32009, -1.3297983560138533, ELU52090), 
exec_layers([LMul18045,LRes82908,LZer54246,LLoc8016,LMin88282,LLoc32009,LELU52090],["Mul18045","Res82908","Zer54246","Loc8016","Min88282","Loc32009","ELU52090"],ELU52090,"ELU52090")

Actual (Unparsed): [[[[-0.0000000, -0.0000000]]]]

Expected (Unparsed): [[[[0.0,0.0]]]]

Actual:   [[[[-0, -0]]]]

Expected: [[[[0, 0]]]]