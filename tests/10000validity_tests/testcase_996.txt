import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den13758 = tf.keras.layers.Input(shape=([5, 4]))

Den13758 = keras.layers.Dense(3,name = 'Den13758', )(in0Den13758)
Lay41585 = keras.layers.LayerNormalization(axis=1, epsilon=1.0200504239413957, name = 'Lay41585', )(Den13758)
Res13332 = keras.layers.Reshape((5, 3, 1), name = 'Res13332', )(Lay41585)
Con52946 = keras.layers.Conv2D(4, (3, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con52946', )(Res13332)
model = tf.keras.models.Model(inputs=[in0Den13758], outputs=Con52946)
w = model.get_layer('Den13758').get_weights() 
w[0] = np.array([[0.0386, 0.818, 0.7862], [0.4746, 0.256, 0.7194], [0.765, 0.2844, 0.9227], [0.363, 0.7754, 0.1792]])
w[1] = np.array([0.3053, 0.265, 0.5242])
model.get_layer('Den13758').set_weights(w) 
w = model.get_layer('Con52946').get_weights() 
w[0] = np.array([[[[0.0669, 0.4731, 0.1818, 0.382]], [[0.1357, 0.3933, 0.9865, 0.9222]]], [[[0.1989, 0.9534, 0.1517, 0.691]], [[0.6446, 0.9895, 0.3677, 0.8995]]], [[[0.001, 0.4166, 0.27, 0.1179]], [[0.5586, 0.9371, 0.7726, 0.1757]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con52946').set_weights(w) 
in0Den13758 = tf.constant([[[0.5456, 0.7712, 0.9472, 0.8079], [0.2668, 0.9629, 0.1775, 0.2619], [0.3758, 0.056, 0.3243, 0.4473], [0.1215, 0.9865, 0.0417, 0.9529], [0.879, 0.1318, 0.5396, 0.0758]]])
print (np.array2string(model.predict([in0Den13758],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con52946.png')

LDen13758 = dense_layer([[[0.5456, 0.7712, 0.9472, 0.8079], [0.2668, 0.9629, 0.1775, 0.2619], [0.3758, 0.056, 0.3243, 0.4473], [0.1215, 0.9865, 0.0417, 0.9529], [0.879, 0.1318, 0.5396, 0.0758]]], [[0.0386, 0.818, 0.7862], [0.4746, 0.256, 0.7194], [0.765, 0.2844, 0.9227], [0.363, 0.7754, 0.1792]],[0.3053, 0.265, 0.5242], Den13758), 
LLay41585 = layer_normalization_layer(Den13758, 1, 1.0200504239413957, Lay41585), 
LRes13332 = reshape_layer(Lay41585, [5, 3, 1], Res13332), 
LCon52946 = conv2D_layer(Res13332, 3, 2,[[[[0.0669, 0.4731, 0.1818, 0.382]], [[0.1357, 0.3933, 0.9865, 0.9222]]], [[[0.1989, 0.9534, 0.1517, 0.691]], [[0.6446, 0.9895, 0.3677, 0.8995]]], [[[0.001, 0.4166, 0.27, 0.1179]], [[0.5586, 0.9371, 0.7726, 0.1757]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con52946), 
exec_layers([LDen13758,LLay41585,LRes13332,LCon52946],["Den13758","Lay41585","Res13332","Con52946"],Con52946,"Con52946")

Actual (Unparsed): [[[[-0.2303301, -0.2529634, 0.2038244, 0.2846141], [-0.2568158, -0.4024638, 0.2768780, 0.4380196]], [[-0.2188357, -0.5941826, -0.3547583, -0.7110045], [-0.4919994, -1.0196703, -0.4929376, -0.8191033]], [[-0.0182737, -0.2544611, -0.3613733, -0.2687679], [-0.1543368, -0.3767159, -0.5299690, -0.6384897]]]]

Expected (Unparsed): [[[[-0.23033005587192154,-0.25296341514125886,0.20382440359322662,0.28461414877691643],[-0.25681573914985223,-0.40246381274280396,0.2768780405272557,0.4380196716785101]],[[-0.21883565386878723,-0.5941825897736323,-0.3547582912495161,-0.7110044842184536],[-0.49199945165637293,-1.0196702912126814,-0.4929375330460658,-0.8191032733012551]],[[-0.01827369724761818,-0.254461150209813,-0.36137329487964703,-0.26876789478939905],[-0.15433678278930146,-0.37671595246027495,-0.5299689688662589,-0.6384897376315832]]]]

Actual:   [[[[-0.2303, -0.2529, 0.2039, 0.2847], [-0.2568, -0.4024, 0.2769, 0.4381]], [[-0.2188, -0.5941, -0.3547, -0.711], [-0.4919, -1.0196, -0.4929, -0.8191]], [[-0.0182, -0.2544, -0.3613, -0.2687], [-0.1543, -0.3767, -0.5299, -0.6384]]]]

Expected: [[[[-0.2303, -0.2529, 0.2039, 0.2847], [-0.2568, -0.4024, 0.2769, 0.4381]], [[-0.2188, -0.5941, -0.3547, -0.711], [-0.4919, -1.0196, -0.4929, -0.8191]], [[-0.0182, -0.2544, -0.3613, -0.2687], [-0.1543, -0.3767, -0.5299, -0.6384]]]]