import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per34015 = tf.keras.layers.Input(shape=([1, 4]))

Per34015 = keras.layers.Permute((1,2), name = 'Per34015',)(in0Per34015)
Res50222 = keras.layers.Reshape((1, 4, 1), name = 'Res50222', )(Per34015)
Con59715 = keras.layers.Conv2DTranspose(3, (1, 3),strides=(1, 1), padding='same', name = 'Con59715', )(Res50222)
Res89186 = keras.layers.Reshape((1, 12), name = 'Res89186', )(Con59715)
GRU84411 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU84411', )(Res89186)
model = tf.keras.models.Model(inputs=[in0Per34015], outputs=GRU84411)
w = model.get_layer('Con59715').get_weights() 
w[0] = np.array([[[[0.8308], [0.1504], [0.0564]], [[0.7883], [0.9624], [0.3911]], [[0.1667], [0.0014], [0.3878]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con59715').set_weights(w) 
w = model.get_layer('GRU84411').get_weights() 
w[0] = np.array([[7, 6, 5, 7, 6, 8], [7, 8, 8, 4, 7, 3], [9, 4, 2, 10, 1, 1], [1, 1, 8, 1, 2, 2], [10, 6, 5, 5, 3, 4], [5, 9, 6, 6, 4, 2], [1, 10, 9, 2, 6, 9], [8, 8, 4, 3, 4, 2], [2, 9, 8, 3, 4, 3], [8, 5, 10, 9, 9, 3], [6, 4, 7, 8, 7, 1], [1, 1, 8, 8, 6, 2]])
w[1] = np.array([[7, 3, 8, 7, 7, 10], [8, 4, 6, 3, 8, 6]])
w[2] = np.array([4, 2, 6, 4, 1, 4])
model.get_layer('GRU84411').set_weights(w) 
in0Per34015 = tf.constant([[[1.1452, 1.5848, 1.012, 1.6668]]])
print (np.array2string(model.predict([in0Per34015],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU84411.png')

LPer34015 = permute_layer([[[1.1452, 1.5848, 1.012, 1.6668]]], 1,2, Per34015), 
LRes50222 = reshape_layer(Per34015, [1, 4, 1], Res50222), 
LCon59715 = conv2D_transpose_layer(Res50222, 1, 3,[[[[0.8308], [0.1504], [0.0564]], [[0.7883], [0.9624], [0.3911]], [[0.1667], [0.0014], [0.3878]]]],[0, 0, 0], 1, 1, true, Con59715), 
LRes89186 = reshape_layer(Con59715, [1, 12], Res89186), 
LGRU84411 = gru_layer(Res89186,[[7, 6, 5, 7, 6, 8], [7, 8, 8, 4, 7, 3], [9, 4, 2, 10, 1, 1], [1, 1, 8, 1, 2, 2], [10, 6, 5, 5, 3, 4], [5, 9, 6, 6, 4, 2], [1, 10, 9, 2, 6, 9], [8, 8, 4, 3, 4, 2], [2, 9, 8, 3, 4, 3], [8, 5, 10, 9, 9, 3], [6, 4, 7, 8, 7, 1], [1, 1, 8, 8, 6, 2]],[[7, 3, 8, 7, 7, 10], [8, 4, 6, 3, 8, 6]],[4, 2, 6, 4, 1, 4], false, GRU84411), 
exec_layers([LPer34015,LRes50222,LCon59715,LRes89186,LGRU84411],["Per34015","Res50222","Con59715","Res89186","GRU84411"],GRU84411,"GRU84411")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0]]

Actual:   [[0, 0]]

Expected: [[0, 0]]