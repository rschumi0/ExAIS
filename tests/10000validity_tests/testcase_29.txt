import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_82822 = tf.keras.layers.Input(shape=([4, 4]))
in0Sof51313 = tf.keras.layers.Input(shape=([1, 1]))
in0Con95135 = tf.keras.layers.Input(shape=([8, 3]))

Up_82822 = keras.layers.UpSampling1D(size=(2), name = 'Up_82822', )(in0Up_82822)
Sof51313 = keras.layers.Softmax(axis=1, name = 'Sof51313', input_shape=(1, 1))(in0Sof51313)
Zer39399 = keras.layers.ZeroPadding1D(padding=((7, 0)), name = 'Zer39399', )(Sof51313)
Con95135 = keras.layers.Concatenate(axis=2, name = 'Con95135', )([Zer39399,in0Con95135])
Ave96640 = keras.layers.Average(name = 'Ave96640', )([Up_82822,Con95135])
Res14750 = keras.layers.Reshape((8, 4, 1), name = 'Res14750', )(Ave96640)
Glo80898 = keras.layers.GlobalAveragePooling2D(name = 'Glo80898', )(Res14750)
Res86428 = keras.layers.Reshape((1, 1), name = 'Res86428', )(Glo80898)
Res38035 = keras.layers.Reshape((1, 1, 1), name = 'Res38035', )(Res86428)
Max99266 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 10), padding='same', name = 'Max99266', )(Res38035)
model = tf.keras.models.Model(inputs=[in0Up_82822,in0Sof51313,in0Con95135], outputs=Max99266)
in0Up_82822 = tf.constant([[[1.9033, 1.0384, 1.5694, 1.3958], [1.5903, 1.1231, 1.0993, 1.1351], [1.6608, 1.5007, 1.4518, 1.5367], [1.521, 1.1725, 1.2867, 1.4642]]])
in0Sof51313 = tf.constant([[[0.7327]]])
in0Con95135 = tf.constant([[[0.8339, 0.6979, 0.3081], [0.3892, 0.8168, 0.2848], [0.4133, 0.6636, 0.4564], [0.4959, 0.9581, 0.7279], [0.7905, 0.2432, 0.4468], [0.316, 0.719, 0.4332], [0.2012, 0.522, 0.2797], [0.7252, 0.3679, 0.6818]]])
print (np.array2string(model.predict([in0Up_82822,in0Sof51313,in0Con95135],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max99266.png')

LUp_82822 = up_sampling1D_layer([[[1.9033, 1.0384, 1.5694, 1.3958], [1.5903, 1.1231, 1.0993, 1.1351], [1.6608, 1.5007, 1.4518, 1.5367], [1.521, 1.1725, 1.2867, 1.4642]]], 2, Up_82822), 
LSof51313 = softmax_layer([[[0.7327]]], 1, Sof51313), 
LZer39399 = zero_padding1D_layer(Sof51313, 7, 0, Zer39399), 
LCon95135 = concatenate_layer([Zer39399,[[[0.8339, 0.6979, 0.3081], [0.3892, 0.8168, 0.2848], [0.4133, 0.6636, 0.4564], [0.4959, 0.9581, 0.7279], [0.7905, 0.2432, 0.4468], [0.316, 0.719, 0.4332], [0.2012, 0.522, 0.2797], [0.7252, 0.3679, 0.6818]]]], 2, Con95135), 
LAve96640 = average_layer([Up_82822,Con95135], Ave96640), 
LRes14750 = reshape_layer(Ave96640, [8, 4, 1], Res14750), 
LGlo80898 = global_average_pooling2D_layer(Res14750, Glo80898), 
LRes86428 = reshape_layer(Glo80898, [1, 1], Res86428), 
LRes38035 = reshape_layer(Res86428, [1, 1, 1], Res38035), 
LMax99266 = max_pool2D_layer(Res38035, 1, 1, 1, 10, true, Max99266), 
exec_layers([LUp_82822,LSof51313,LZer39399,LCon95135,LAve96640,LRes14750,LGlo80898,LRes86428,LRes38035,LMax99266],["Up_82822","Sof51313","Zer39399","Con95135","Ave96640","Res14750","Glo80898","Res86428","Res38035","Max99266"],Max99266,"Max99266")

Actual (Unparsed): [[[[0.9167281]]]]

Expected (Unparsed): [[[[0.9167281250000001]]]]

Actual:   [[[[0.9168]]]]

Expected: [[[[0.9168]]]]