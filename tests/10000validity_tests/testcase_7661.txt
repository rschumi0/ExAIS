import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave83239 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave83239 = tf.keras.layers.Input(shape=([1, 1]))
in0LST75872 = tf.keras.layers.Input(shape=([2, 1]))
in0Min64590 = tf.keras.layers.Input(shape=([1, 1]))
in1Min64590 = tf.keras.layers.Input(shape=([1, 1]))

Ave83239 = keras.layers.Average(name = 'Ave83239', )([in0Ave83239,in1Ave83239])
Fla53606 = keras.layers.Flatten(name = 'Fla53606', )(Ave83239)
LST75872 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST75872', )(in0LST75872)
Dot64073 = keras.layers.Dot(axes=(1, 1), name = 'Dot64073', )([Fla53606,LST75872])
Res45168 = keras.layers.Reshape((1, 1), name = 'Res45168', )(Dot64073)
Min64590 = keras.layers.Minimum(name = 'Min64590', )([in0Min64590,in1Min64590])
Ave76515 = keras.layers.Average(name = 'Ave76515', )([Res45168,Min64590])
model = tf.keras.models.Model(inputs=[in0Ave83239,in1Ave83239,in0LST75872,in0Min64590,in1Min64590], outputs=Ave76515)
w = model.get_layer('LST75872').get_weights() 
w[0] = np.array([[2, 7, 5, 7]])
w[1] = np.array([[1, 8, 8, 2]])
w[2] = np.array([6, 10, 3, 5])
model.get_layer('LST75872').set_weights(w) 
in0Ave83239 = tf.constant([[[0.6107]]])
in1Ave83239 = tf.constant([[[0.6665]]])
in0LST75872 = tf.constant([[[3], [7]]])
in0Min64590 = tf.constant([[[0.4871]]])
in1Min64590 = tf.constant([[[0.0612]]])
print (np.array2string(model.predict([in0Ave83239,in1Ave83239,in0LST75872,in0Min64590,in1Min64590],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave76515.png')

LAve83239 = average_layer([[[[0.6107]]], [[[0.6665]]]], Ave83239), 
LFla53606 = flatten_layer(Ave83239, Fla53606), 
LLST75872 = lstm_layer([[[3], [7]]],[[2, 7, 5, 7]],[[1, 8, 8, 2]],[6, 10, 3, 5], LST75872), 
LDot64073 = dot_layer(Fla53606,LST75872, 1, 1, Dot64073), 
LRes45168 = reshape_layer(Dot64073, [1, 1], Res45168), 
LMin64590 = minimum_layer([[[[0.4871]]], [[[0.0612]]]], Min64590), 
LAve76515 = average_layer([Res45168,Min64590], Ave76515), 
exec_layers([LAve83239,LFla53606,LLST75872,LDot64073,LRes45168,LMin64590,LAve76515],["Ave83239","Fla53606","LST75872","Dot64073","Res45168","Min64590","Ave76515"],Ave76515,"Ave76515")

Actual (Unparsed): [[[0.3384139]]]

Expected (Unparsed): [[[0.3384138676904191]]]

Actual:   [[[0.3385]]]

Expected: [[[0.3385]]]