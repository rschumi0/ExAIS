import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min19023 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min19023 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con50686 = tf.keras.layers.Input(shape=([2]))
in0Dot81654 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot81654 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul62135 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul62135 = tf.keras.layers.Input(shape=([2, 2]))
in0Glo16493 = tf.keras.layers.Input(shape=([2, 2]))
in0Con97096 = tf.keras.layers.Input(shape=([2]))

Min19023 = keras.layers.Minimum(name = 'Min19023', )([in0Min19023,in1Min19023])
Res71 = keras.layers.Reshape((1, 2), name = 'Res71', )(Min19023)
Fla61265 = keras.layers.Flatten(name = 'Fla61265', )(Res71)
Con50686 = keras.layers.Concatenate(axis=1, name = 'Con50686', )([Fla61265,in0Con50686])
Dot81654 = keras.layers.Dot(axes=(2, 2), name = 'Dot81654', )([in0Dot81654,in1Dot81654])
Fla37669 = keras.layers.Flatten(name = 'Fla37669', )(Dot81654)
Mul62135 = keras.layers.Multiply(name = 'Mul62135', )([in0Mul62135,in1Mul62135])
Fla67005 = keras.layers.Flatten(name = 'Fla67005', )(Mul62135)
Glo16493 = keras.layers.GlobalMaxPool1D(name = 'Glo16493', )(in0Glo16493)
Mas82732 = keras.layers.Masking(mask_value=2, name = 'Mas82732', )(Glo16493)
Con97096 = keras.layers.Concatenate(axis=1, name = 'Con97096', )([Mas82732,in0Con97096])
Min82458 = keras.layers.Minimum(name = 'Min82458', )([Fla67005,Con97096])
Add32237 = keras.layers.Add(name = 'Add32237', )([Fla37669,Min82458])
Sub60995 = keras.layers.Subtract(name = 'Sub60995', )([Con50686,Add32237])
model = tf.keras.models.Model(inputs=[in0Min19023,in1Min19023,in0Con50686,in0Dot81654,in1Dot81654,in0Mul62135,in1Mul62135,in0Glo16493,in0Con97096], outputs=Sub60995)
in0Min19023 = tf.constant([[[[0.8875], [0.7513]]]])
in1Min19023 = tf.constant([[[[0.7988], [0.5238]]]])
in0Con50686 = tf.constant([[0.0596, 0.0897]])
in0Dot81654 = tf.constant([[[0.443, 0.5514], [0.2659, 0.7954]]])
in1Dot81654 = tf.constant([[[0.5196, 0.9763], [0.4797, 0.2393]]])
in0Mul62135 = tf.constant([[[0.2598, 0.455], [0.6574, 0.997]]])
in1Mul62135 = tf.constant([[[0.0072, 0.2742], [0.8566, 0.3174]]])
in0Glo16493 = tf.constant([[[1.3619, 1.783], [1.3932, 1.2392]]])
in0Con97096 = tf.constant([[0.261, 0.3333]])
print (np.array2string(model.predict([in0Min19023,in1Min19023,in0Con50686,in0Dot81654,in1Dot81654,in0Mul62135,in1Mul62135,in0Glo16493,in0Con97096],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub60995.png')

LMin19023 = minimum_layer([[[[[0.8875], [0.7513]]]], [[[[0.7988], [0.5238]]]]], Min19023), 
LRes71 = reshape_layer(Min19023, [1, 2], Res71), 
LFla61265 = flatten_layer(Res71, Fla61265), 
LCon50686 = concatenate_layer([Fla61265,[[0.0596, 0.0897]]], 1, Con50686), 
LDot81654 = dot_layer([[[0.443, 0.5514], [0.2659, 0.7954]]], [[[0.5196, 0.9763], [0.4797, 0.2393]]], 2, 2, Dot81654), 
LFla37669 = flatten_layer(Dot81654, Fla37669), 
LMul62135 = multiply_layer([[[[0.2598, 0.455], [0.6574, 0.997]]], [[[0.0072, 0.2742], [0.8566, 0.3174]]]], Mul62135), 
LFla67005 = flatten_layer(Mul62135, Fla67005), 
LGlo16493 = global_max_pool1D_layer([[[1.3619, 1.783], [1.3932, 1.2392]]], Glo16493), 
LMas82732 = masking_layer(Glo16493, 2, Mas82732), 
LCon97096 = concatenate_layer([Mas82732,[[0.261, 0.3333]]], 1, Con97096), 
LMin82458 = minimum_layer([Fla67005,Con97096], Min82458), 
LAdd32237 = add_layer([Fla37669,Min82458], Add32237), 
LSub60995 = subtract_layer(Con50686,Add32237, Sub60995), 
exec_layers([LMin19023,LRes71,LFla61265,LCon50686,LDot81654,LFla37669,LMul62135,LFla67005,LGlo16493,LMas82732,LCon97096,LMin82458,LAdd32237,LSub60995],["Min19023","Res71","Fla61265","Con50686","Dot81654","Fla37669","Mul62135","Fla67005","Glo16493","Mas82732","Con97096","Min82458","Add32237","Sub60995"],Sub60995,"Sub60995")

Actual (Unparsed): [[0.0284148, 0.0545819, -1.1161107, -0.5446393]]

Expected (Unparsed): [[0.028414819999999952,0.05458188000000003,-1.11611066,-0.54463925]]

Actual:   [[0.0285, 0.0546, -1.1161, -0.5446]]

Expected: [[0.0285, 0.0546, -1.1161, -0.5446]]