import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot16456 = tf.keras.layers.Input(shape=([2]))
in1Dot16456 = tf.keras.layers.Input(shape=([2]))
in0Min55755 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min55755 = tf.keras.layers.Input(shape=([1, 1, 1]))

Dot16456 = keras.layers.Dot(axes=(1, 1), name = 'Dot16456', )([in0Dot16456,in1Dot16456])
Res46840 = keras.layers.Reshape((1, 1), name = 'Res46840', )(Dot16456)
Res43543 = keras.layers.Reshape((1, 1, 1), name = 'Res43543', )(Res46840)
Min55755 = keras.layers.Minimum(name = 'Min55755', )([in0Min55755,in1Min55755])
Max5696 = keras.layers.Maximum(name = 'Max5696', )([Res43543,Min55755])
Fla85952 = keras.layers.Flatten(name = 'Fla85952', )(Max5696)
model = tf.keras.models.Model(inputs=[in0Dot16456,in1Dot16456,in0Min55755,in1Min55755], outputs=Fla85952)
in0Dot16456 = tf.constant([[0.464, 0.782]])
in1Dot16456 = tf.constant([[0.0469, 0.5618]])
in0Min55755 = tf.constant([[[[0.4768]]]])
in1Min55755 = tf.constant([[[[0.0563]]]])
print (np.array2string(model.predict([in0Dot16456,in1Dot16456,in0Min55755,in1Min55755],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla85952.png')

LDot16456 = dot_layer([[0.464, 0.782]], [[0.0469, 0.5618]], 1, 1, Dot16456), 
LRes46840 = reshape_layer(Dot16456, [1, 1], Res46840), 
LRes43543 = reshape_layer(Res46840, [1, 1, 1], Res43543), 
LMin55755 = minimum_layer([[[[[0.4768]]]], [[[[0.0563]]]]], Min55755), 
LMax5696 = maximum_layer([Res43543,Min55755], Max5696), 
LFla85952 = flatten_layer(Max5696, Fla85952), 
exec_layers([LDot16456,LRes46840,LRes43543,LMin55755,LMax5696,LFla85952],["Dot16456","Res46840","Res43543","Min55755","Max5696","Fla85952"],Fla85952,"Fla85952")

Actual (Unparsed): [[0.4610892]]

Expected (Unparsed): [[0.4610892]]

Actual:   [[0.4611]]

Expected: [[0.4611]]