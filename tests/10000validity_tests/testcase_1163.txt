import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc90655 = tf.keras.layers.Input(shape=([2, 1]))

Loc90655 = keras.layers.LocallyConnected1D(2, (2),strides=(1), name = 'Loc90655', )(in0Loc90655)
Res44388 = keras.layers.Reshape((1, 2, 1), name = 'Res44388', )(Loc90655)
Res52840 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res52840', )(Res44388)
Glo9492 = keras.layers.GlobalMaxPool3D(name = 'Glo9492', )(Res52840)
model = tf.keras.models.Model(inputs=[in0Loc90655], outputs=Glo9492)
w = model.get_layer('Loc90655').get_weights() 
w[0] = np.array([[[0.4403, 0.2643], [0.4909, 0.3077]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc90655').set_weights(w) 
in0Loc90655 = tf.constant([[[0.6683], [0.4379]]])
print (np.array2string(model.predict([in0Loc90655],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo9492.png')

LLoc90655 = locally_connected1D_layer([[[0.6683], [0.4379]]], 2,[[[0.4403, 0.2643], [0.4909, 0.3077]]],[[0, 0]], 1, Loc90655), 
LRes44388 = reshape_layer(Loc90655, [1, 2, 1], Res44388), 
LRes52840 = reshape_layer(Res44388, [1, 2, 1, 1], Res52840), 
LGlo9492 = global_max_pool3D_layer(Res52840, Glo9492), 
exec_layers([LLoc90655,LRes44388,LRes52840,LGlo9492],["Loc90655","Res44388","Res52840","Glo9492"],Glo9492,"Glo9492")

Actual (Unparsed): [[0.5092176]]

Expected (Unparsed): [[0.5092176]]

Actual:   [[0.5093]]

Expected: [[0.5093]]