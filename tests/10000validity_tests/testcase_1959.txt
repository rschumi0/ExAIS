import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer14300 = tf.keras.layers.Input(shape=([4, 1]))
in0Con91220 = tf.keras.layers.Input(shape=([3, 1, 1, 3]))
in0Glo76164 = tf.keras.layers.Input(shape=([1, 2]))
in0Dot39078 = tf.keras.layers.Input(shape=([2]))
in1Dot39078 = tf.keras.layers.Input(shape=([2]))
in0Con52304 = tf.keras.layers.Input(shape=([1]))

Zer14300 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer14300', )(in0Zer14300)
Res3361 = keras.layers.Reshape((6, 1, 1), name = 'Res3361', )(Zer14300)
Glo78810 = keras.layers.GlobalMaxPool2D(name = 'Glo78810', )(Res3361)
Res16343 = keras.layers.Reshape((1, 1), name = 'Res16343', )(Glo78810)
Res18715 = keras.layers.Reshape((1, 1, 1), name = 'Res18715', )(Res16343)
Cro85561 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro85561', )(Res18715)
Res30707 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res30707', )(Cro85561)
Zer52823 = keras.layers.ZeroPadding3D(padding=((2, 0), (0, 0), (0, 0)), name = 'Zer52823', )(Res30707)
Con91220 = keras.layers.Concatenate(axis=4, name = 'Con91220', )([Zer52823,in0Con91220])
Glo76164 = keras.layers.GlobalMaxPool1D(name = 'Glo76164', )(in0Glo76164)
Dot39078 = keras.layers.Dot(axes=(1, 1), name = 'Dot39078', )([in0Dot39078,in1Dot39078])
Con52304 = keras.layers.Concatenate(axis=1, name = 'Con52304', )([Dot39078,in0Con52304])
Add62588 = keras.layers.Add(name = 'Add62588', )([Glo76164,Con52304])
Res11769 = keras.layers.Reshape((2, 1), name = 'Res11769', )(Add62588)
Res78725 = keras.layers.Reshape((2, 1, 1), name = 'Res78725', )(Res11769)
Res99506 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res99506', )(Res78725)
Con53432 = keras.layers.Conv3DTranspose(4, (2, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con53432', )(Res99506)
Max12525 = keras.layers.Maximum(name = 'Max12525', )([Con91220,Con53432])
model = tf.keras.models.Model(inputs=[in0Zer14300,in0Con91220,in0Glo76164,in0Dot39078,in1Dot39078,in0Con52304], outputs=Max12525)
w = model.get_layer('Con53432').get_weights() 
w[0] = np.array([[[[[0.5323], [0.4434], [0.5184], [0.2765]]]], [[[[0.0152], [0.6156], [0.2804], [0.3452]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con53432').set_weights(w) 
in0Zer14300 = tf.constant([[[1.345], [1.8636], [1.3973], [1.7548]]])
in0Con91220 = tf.constant([[[[[0.3259, 0.8741, 0.8605]]], [[[0.0798, 0.3218, 0.4788]]], [[[0.6433, 0.4038, 0.3787]]]]])
in0Glo76164 = tf.constant([[[1.3062, 1.2368]]])
in0Dot39078 = tf.constant([[0.698, 0.3054]])
in1Dot39078 = tf.constant([[0.4635, 0.8286]])
in0Con52304 = tf.constant([[0.7766]])
print (np.array2string(model.predict([in0Zer14300,in0Con91220,in0Glo76164,in0Dot39078,in1Dot39078,in0Con52304],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max12525.png')

LZer14300 = zero_padding1D_layer([[[1.345], [1.8636], [1.3973], [1.7548]]], 1, 1, Zer14300), 
LRes3361 = reshape_layer(Zer14300, [6, 1, 1], Res3361), 
LGlo78810 = global_max_pool2D_layer(Res3361, Glo78810), 
LRes16343 = reshape_layer(Glo78810, [1, 1], Res16343), 
LRes18715 = reshape_layer(Res16343, [1, 1, 1], Res18715), 
LCro85561 = cropping2D_layer(Res18715, 0, 0, 0, 0, Cro85561), 
LRes30707 = reshape_layer(Cro85561, [1, 1, 1, 1], Res30707), 
LZer52823 = zero_padding3D_layer(Res30707, 2, 0, 0, 0, 0, 0, Zer52823), 
LCon91220 = concatenate_layer([Zer52823,[[[[[0.3259, 0.8741, 0.8605]]], [[[0.0798, 0.3218, 0.4788]]], [[[0.6433, 0.4038, 0.3787]]]]]], 4, Con91220), 
LGlo76164 = global_max_pool1D_layer([[[1.3062, 1.2368]]], Glo76164), 
LDot39078 = dot_layer([[0.698, 0.3054]], [[0.4635, 0.8286]], 1, 1, Dot39078), 
LCon52304 = concatenate_layer([Dot39078,[[0.7766]]], 1, Con52304), 
LAdd62588 = add_layer([Glo76164,Con52304], Add62588), 
LRes11769 = reshape_layer(Add62588, [2, 1], Res11769), 
LRes78725 = reshape_layer(Res11769, [2, 1, 1], Res78725), 
LRes99506 = reshape_layer(Res78725, [2, 1, 1, 1], Res99506), 
LCon53432 = conv3D_transpose_layer(Res99506, 2, 1, 1,[[[[[0.5323], [0.4434], [0.5184], [0.2765]]]], [[[[0.0152], [0.6156], [0.2804], [0.3452]]]]],[0, 0, 0, 0], 1, 1, 1, false, Con53432), 
LMax12525 = maximum_layer([Con91220,Con53432], Max12525), 
exec_layers([LZer14300,LRes3361,LGlo78810,LRes16343,LRes18715,LCro85561,LRes30707,LZer52823,LCon91220,LGlo76164,LDot39078,LCon52304,LAdd62588,LRes11769,LRes78725,LRes99506,LCon53432,LMax12525],["Zer14300","Res3361","Glo78810","Res16343","Res18715","Cro85561","Res30707","Zer52823","Con91220","Glo76164","Dot39078","Con52304","Add62588","Res11769","Res78725","Res99506","Con53432","Max12525"],Max12525,"Max12525")

Actual (Unparsed): [[[[[1.0022025, 0.8348235, 0.9760318, 0.8605000]]], [[[1.1003510, 2.0517794, 1.5716773, 1.2066399]]], [[[1.8636000, 1.2394490, 0.5645573, 0.6950257]]]]]

Expected (Unparsed): [[[[[1.002202431312,0.834823516896,0.9760318248959999,0.8605]]],[[[1.1003510370879999,2.051779352064,1.5716773541759999,1.206639872288]]],[[[1.8636,1.23944904,0.5645573599999999,0.69502568]]]]]

Actual:   [[[[[1.0023, 0.8349, 0.9761, 0.8605]]], [[[1.1004, 2.0518, 1.5717, 1.2067]]], [[[1.8636, 1.2395, 0.5646, 0.6951]]]]]

Expected: [[[[[1.0023, 0.8349, 0.9761, 0.8605]]], [[[1.1004, 2.0518, 1.5717, 1.2067]]], [[[1.8636, 1.2395, 0.5646, 0.6951]]]]]