import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max27109 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max27109 = tf.keras.layers.Input(shape=([1, 1, 2]))

Max27109 = keras.layers.Maximum(name = 'Max27109', )([in0Max27109,in1Max27109])
Mas83757 = keras.layers.Masking(mask_value=2, name = 'Mas83757', )(Max27109)
Res49647 = keras.layers.Reshape((1, 2), name = 'Res49647', )(Mas83757)
Zer89363 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer89363', )(Res49647)
model = tf.keras.models.Model(inputs=[in0Max27109,in1Max27109], outputs=Zer89363)
in0Max27109 = tf.constant([[[[0.8456, 0.6048]]]])
in1Max27109 = tf.constant([[[[0.176, 0.886]]]])
print (np.array2string(model.predict([in0Max27109,in1Max27109],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer89363.png')

LMax27109 = maximum_layer([[[[[0.8456, 0.6048]]]], [[[[0.176, 0.886]]]]], Max27109), 
LMas83757 = masking_layer(Max27109, 2, Mas83757), 
LRes49647 = reshape_layer(Mas83757, [1, 2], Res49647), 
LZer89363 = zero_padding1D_layer(Res49647, 1, 1, Zer89363), 
exec_layers([LMax27109,LMas83757,LRes49647,LZer89363],["Max27109","Mas83757","Res49647","Zer89363"],Zer89363,"Zer89363")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.8456000, 0.8860000], [0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0],[0.8456,0.886],[0,0]]]

Actual:   [[[0, 0], [0.8456, 0.886], [0, 0]]]

Expected: [[[0, 0], [0.8456, 0.886], [0, 0]]]