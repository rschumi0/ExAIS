import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul14023 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul14023 = tf.keras.layers.Input(shape=([2, 2, 2]))

Mul14023 = keras.layers.Multiply(name = 'Mul14023', )([in0Mul14023,in1Mul14023])
Sof51931 = keras.layers.Softmax(axis=1, name = 'Sof51931', )(Mul14023)
Con49920 = keras.layers.Conv2D(2, (1, 1),strides=(6, 2), padding='valid', dilation_rate=(1, 1), name = 'Con49920', )(Sof51931)
Sep94591 = keras.layers.SeparableConv2D(4, (1, 1),strides=(2, 2), padding='same', name = 'Sep94591', )(Con49920)
model = tf.keras.models.Model(inputs=[in0Mul14023,in1Mul14023], outputs=Sep94591)
w = model.get_layer('Con49920').get_weights() 
w[0] = np.array([[[[0.1241, 0.3491], [0.8761, 0.7243]]]])
w[1] = np.array([0, 0])
model.get_layer('Con49920').set_weights(w) 
w = model.get_layer('Sep94591').get_weights() 
w[0] = np.array([[[[0.248], [0.9715]]]])
w[1] = np.array([[[[0.2816, 0.3531, 0.9722, 0.0964], [0.7664, 0.0181, 0.4533, 0.5716]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep94591').set_weights(w) 
in0Mul14023 = tf.constant([[[[0.8675, 0.207], [0.3728, 0.1511]], [[0.7658, 0.9828], [0.5498, 0.7325]]]])
in1Mul14023 = tf.constant([[[[0.1026, 0.5166], [0.6995, 0.1055]], [[0.7948, 0.0354], [0.727, 0.6859]]]])
print (np.array2string(model.predict([in0Mul14023,in1Mul14023],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep94591.png')

LMul14023 = multiply_layer([[[[[0.8675, 0.207], [0.3728, 0.1511]], [[0.7658, 0.9828], [0.5498, 0.7325]]]], [[[[0.1026, 0.5166], [0.6995, 0.1055]], [[0.7948, 0.0354], [0.727, 0.6859]]]]], Mul14023), 
LSof51931 = softmax_layer(Mul14023, 1, Sof51931), 
LCon49920 = conv2D_layer(Sof51931, 1, 1,[[[[0.1241, 0.3491], [0.8761, 0.7243]]]],[0, 0], 6, 2, false, 1, 1, Con49920), 
LSep94591 = separable_conv2D_layer(Con49920, 1, 1,[[[[[0.248], [0.9715]]]],[[[[0.2816, 0.3531, 0.9722, 0.0964], [0.7664, 0.0181, 0.4533, 0.5716]]]]],[0, 0, 0, 0], 2, 2, true, Sep94591), 
exec_layers([LMul14023,LSof51931,LCon49920,LSep94591],["Mul14023","Sof51931","Con49920","Sep94591"],Sep94591,"Sep94591")

Actual (Unparsed): [[[[0.4112259, 0.0526824, 0.3431513, 0.2926095]]]]

Expected (Unparsed): [[[[0.4112259270436881,0.052682427794696673,0.3431512626908714,0.29260947962440564]]]]

Actual:   [[[[0.4113, 0.0527, 0.3432, 0.2927]]]]

Expected: [[[[0.4113, 0.0527, 0.3432, 0.2927]]]]