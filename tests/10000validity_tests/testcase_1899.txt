import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add54702 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add54702 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Mul15028 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Mul15028 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Add54702 = keras.layers.Add(name = 'Add54702', )([in0Add54702,in1Add54702])
Lay32124 = keras.layers.LayerNormalization(axis=2, epsilon=2.2161183782813767, name = 'Lay32124', )(Add54702)
Res33406 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res33406', )(Lay32124)
Mul15028 = keras.layers.Multiply(name = 'Mul15028', )([in0Mul15028,in1Mul15028])
Bat8535 = keras.layers.BatchNormalization(axis=2, epsilon=0.29332359363669436,  name = 'Bat8535', )(Mul15028)
Zer26515 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer26515', )(Bat8535)
Mul84903 = keras.layers.Multiply(name = 'Mul84903', )([Res33406,Zer26515])
model = tf.keras.models.Model(inputs=[in0Add54702,in1Add54702,in0Mul15028,in1Mul15028], outputs=Mul84903)
w = model.get_layer('Bat8535').get_weights() 
w[0] = np.array([0.7286])
w[1] = np.array([0.4697])
w[2] = np.array([0.2848])
w[3] = np.array([0.0657])
model.get_layer('Bat8535').set_weights(w) 
in0Add54702 = tf.constant([[[[0.7645, 0.8167]], [[0.8956, 0.4678]]]])
in1Add54702 = tf.constant([[[[0.8318, 0.5309]], [[0.9215, 0.9462]]]])
in0Mul15028 = tf.constant([[[[[0.0983], [0.1279]]]]])
in1Mul15028 = tf.constant([[[[[0.0983], [0.3339]]]]])
print (np.array2string(model.predict([in0Add54702,in1Add54702,in0Mul15028,in1Mul15028],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul84903.png')

LAdd54702 = add_layer([[[[[0.7645, 0.8167]], [[0.8956, 0.4678]]]], [[[[0.8318, 0.5309]], [[0.9215, 0.9462]]]]], Add54702), 
LLay32124 = layer_normalization_layer(Add54702, 2, 2.2161183782813767, Lay32124), 
LRes33406 = reshape_layer(Lay32124, [2, 1, 2, 1], Res33406), 
LMul15028 = multiply_layer([[[[[[0.0983], [0.1279]]]]], [[[[[0.0983], [0.3339]]]]]], Mul15028), 
LBat8535 = batch_normalization_layer(Mul15028, 2, 0.29332359363669436, [0.7286], [0.4697], [0.2848], [0.0657], Bat8535), 
LZer26515 = zero_padding3D_layer(Bat8535, 1, 0, 0, 0, 0, 0, Zer26515), 
LMul84903 = multiply_layer([Res33406,Zer26515], Mul84903), 
exec_layers([LAdd54702,LLay32124,LRes33406,LMul15028,LBat8535,LZer26515,LMul84903],["Add54702","Lay32124","Res33406","Mul15028","Bat8535","Zer26515","Mul84903"],Mul84903,"Mul84903")

Actual (Unparsed): [[[[[0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0.0],[0.0]]],[[[0.0],[0.0]]]]]

Actual:   [[[[[0], [0]]], [[[0], [0]]]]]

Expected: [[[[[0], [0]]], [[[0], [0]]]]]