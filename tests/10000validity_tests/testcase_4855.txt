import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_46738 = tf.keras.layers.Input(shape=([4, 3, 4, 1]))

Up_46738 = keras.layers.UpSampling3D(size=(1, 2, 2), name = 'Up_46738', )(in0Up_46738)
Res68034 = keras.layers.Reshape((4, 6, 8), name = 'Res68034', )(Up_46738)
Dep28305 = keras.layers.DepthwiseConv2D((4, 4),strides=(1, 1), padding='valid', name = 'Dep28305', )(Res68034)
Glo23539 = keras.layers.GlobalMaxPool2D(name = 'Glo23539', )(Dep28305)
Res40652 = keras.layers.Reshape((8, 1), name = 'Res40652', )(Glo23539)
LST88352 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST88352', )(Res40652)
model = tf.keras.models.Model(inputs=[in0Up_46738], outputs=LST88352)
w = model.get_layer('Dep28305').get_weights() 
w[0] = np.array([[[[0.9286], [0.9712], [0.5903], [0.7671], [0.5686], [0.3219], [0.0848], [0.0288]], [[0.6943], [0.845], [0.1619], [0.2876], [0.5202], [0.7522], [0.3515], [0.9021]], [[0.2396], [0.3657], [0.807], [0.3018], [0.0391], [0.3915], [0.7108], [0.7347]], [[0.7099], [0.8674], [0.1946], [0.4182], [0.632], [0.7393], [0.4388], [0.4534]]], [[[0.7573], [0.2178], [0.7291], [0.9539], [0.8388], [0.2963], [0.6358], [0.4551]], [[0.5643], [0.0664], [0.1592], [0.8208], [0.4372], [0.7611], [0.6327], [0.5467]], [[0.2217], [0.7733], [0.4162], [0.5669], [0.5165], [0.2533], [0.9252], [0.4187]], [[0.5553], [0.2704], [0.3402], [0.8918], [0.6455], [0.9395], [0.4206], [0.0936]]], [[[0.7516], [0.3601], [0.206], [0.2019], [0.6048], [0.6925], [0.0321], [0.0411]], [[0.3784], [0.2045], [0.2075], [0.0207], [0.4075], [0.6623], [0.9061], [0.9015]], [[0.6488], [0.0103], [0.3114], [0.3226], [0.5812], [0.8874], [0.8178], [0.0081]], [[0.0263], [0.1612], [0.1408], [0.1048], [0.9332], [0.3255], [0.5191], [0.1504]]], [[[0.518], [0.3044], [0.7972], [0.7648], [0.271], [0.9331], [0.076], [0.2701]], [[0.2548], [0.1429], [0.7834], [0.0994], [0.8034], [0.6718], [0.4788], [0.0297]], [[0.2041], [0.9382], [0.4351], [0.9915], [0.1909], [0.5717], [0.0609], [0.4467]], [[0.1157], [0.9781], [0.5237], [0.1023], [0.472], [0.2286], [0.512], [0.0346]]]])
w[1] = np.array([0, 0, 0, 0, 0, 0, 0, 0])
model.get_layer('Dep28305').set_weights(w) 
w = model.get_layer('LST88352').get_weights() 
w[0] = np.array([[8, 9, 3, 7]])
w[1] = np.array([[7, 10, 7, 2]])
w[2] = np.array([3, 8, 4, 8])
model.get_layer('LST88352').set_weights(w) 
in0Up_46738 = tf.constant([[[[[1.6065], [1.5418], [1.9306], [1.2146]], [[1.469], [1.0705], [1.7497], [1.3342]], [[1.1243], [1.4235], [1.8992], [1.3119]]], [[[1.8721], [1.9361], [1.6199], [1.3571]], [[1.9007], [1.4996], [1.9373], [1.9285]], [[1.1037], [1.176], [1.8132], [1.8559]]], [[[1.8204], [1.0109], [1.0409], [1.4656]], [[1.617], [1.1524], [1.8212], [1.4573]], [[1.4085], [1.2651], [1.8461], [1.9882]]], [[[1.0641], [1.0143], [1.762], [1.5346]], [[1.1338], [1.0872], [1.0828], [1.6218]], [[1.4893], [1.8169], [1.9797], [1.44]]]]])
print (np.array2string(model.predict([in0Up_46738],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST88352.png')

LUp_46738 = up_sampling3D_layer([[[[[1.6065], [1.5418], [1.9306], [1.2146]], [[1.469], [1.0705], [1.7497], [1.3342]], [[1.1243], [1.4235], [1.8992], [1.3119]]], [[[1.8721], [1.9361], [1.6199], [1.3571]], [[1.9007], [1.4996], [1.9373], [1.9285]], [[1.1037], [1.176], [1.8132], [1.8559]]], [[[1.8204], [1.0109], [1.0409], [1.4656]], [[1.617], [1.1524], [1.8212], [1.4573]], [[1.4085], [1.2651], [1.8461], [1.9882]]], [[[1.0641], [1.0143], [1.762], [1.5346]], [[1.1338], [1.0872], [1.0828], [1.6218]], [[1.4893], [1.8169], [1.9797], [1.44]]]]], 1, 2, 2, Up_46738), 
LRes68034 = reshape_layer(Up_46738, [4, 6, 8], Res68034), 
LDep28305 = depthwise_conv2D_layer(Res68034, 4, 4,[[[[0.9286], [0.9712], [0.5903], [0.7671], [0.5686], [0.3219], [0.0848], [0.0288]], [[0.6943], [0.845], [0.1619], [0.2876], [0.5202], [0.7522], [0.3515], [0.9021]], [[0.2396], [0.3657], [0.807], [0.3018], [0.0391], [0.3915], [0.7108], [0.7347]], [[0.7099], [0.8674], [0.1946], [0.4182], [0.632], [0.7393], [0.4388], [0.4534]]], [[[0.7573], [0.2178], [0.7291], [0.9539], [0.8388], [0.2963], [0.6358], [0.4551]], [[0.5643], [0.0664], [0.1592], [0.8208], [0.4372], [0.7611], [0.6327], [0.5467]], [[0.2217], [0.7733], [0.4162], [0.5669], [0.5165], [0.2533], [0.9252], [0.4187]], [[0.5553], [0.2704], [0.3402], [0.8918], [0.6455], [0.9395], [0.4206], [0.0936]]], [[[0.7516], [0.3601], [0.206], [0.2019], [0.6048], [0.6925], [0.0321], [0.0411]], [[0.3784], [0.2045], [0.2075], [0.0207], [0.4075], [0.6623], [0.9061], [0.9015]], [[0.6488], [0.0103], [0.3114], [0.3226], [0.5812], [0.8874], [0.8178], [0.0081]], [[0.0263], [0.1612], [0.1408], [0.1048], [0.9332], [0.3255], [0.5191], [0.1504]]], [[[0.518], [0.3044], [0.7972], [0.7648], [0.271], [0.9331], [0.076], [0.2701]], [[0.2548], [0.1429], [0.7834], [0.0994], [0.8034], [0.6718], [0.4788], [0.0297]], [[0.2041], [0.9382], [0.4351], [0.9915], [0.1909], [0.5717], [0.0609], [0.4467]], [[0.1157], [0.9781], [0.5237], [0.1023], [0.472], [0.2286], [0.512], [0.0346]]]],[0, 0, 0, 0, 0, 0, 0, 0], 1, 1, false, Dep28305), 
LGlo23539 = global_max_pool2D_layer(Dep28305, Glo23539), 
LRes40652 = reshape_layer(Glo23539, [8, 1], Res40652), 
LLST88352 = lstm_layer(Res40652,[[8, 9, 3, 7]],[[7, 10, 7, 2]],[3, 8, 4, 8], LST88352), 
exec_layers([LUp_46738,LRes68034,LDep28305,LGlo23539,LRes40652,LLST88352],["Up_46738","Res68034","Dep28305","Glo23539","Res40652","LST88352"],LST88352,"LST88352")

Actual (Unparsed): [[0.9999998]]

Expected (Unparsed): [[0.9999997749296758]]

Actual:   [[1]]

Expected: [[1]]