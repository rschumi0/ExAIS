import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ELU88467 = tf.keras.layers.Input(shape=([2, 1, 2]))

ELU88467 = keras.layers.ELU(alpha=3.3717413107223653, name = 'ELU88467', input_shape=(2, 1, 2))(in0ELU88467)
Res51806 = keras.layers.Reshape((2, 2), name = 'Res51806', )(ELU88467)
Per52120 = keras.layers.Permute((1,2), name = 'Per52120',)(Res51806)
Lay92717 = keras.layers.LayerNormalization(axis=1, epsilon=2.0486180618740963, name = 'Lay92717', )(Per52120)
model = tf.keras.models.Model(inputs=[in0ELU88467], outputs=Lay92717)
in0ELU88467 = tf.constant([[[[0.315, 0.298]], [[0.9147, 0.1875]]]])
print (np.array2string(model.predict([in0ELU88467],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay92717.png')

LELU88467 = elu_layer([[[[0.315, 0.298]], [[0.9147, 0.1875]]]], 3.3717413107223653, ELU88467), 
LRes51806 = reshape_layer(ELU88467, [2, 2], Res51806), 
LPer52120 = permute_layer(Res51806, 1,2, Per52120), 
LLay92717 = layer_normalization_layer(Per52120, 1, 2.0486180618740963, Lay92717), 
exec_layers([LELU88467,LRes51806,LPer52120,LLay92717],["ELU88467","Res51806","Per52120","Lay92717"],Lay92717,"Lay92717")

Actual (Unparsed): [[[-0.2050438, 0.0385726], [0.2050438, -0.0385726]]]

Expected (Unparsed): [[[-0.2050437680315657,0.03857255990581034],[0.20504376803156568,-0.03857255990581034]]]

Actual:   [[[-0.205, 0.0386], [0.2051, -0.0385]]]

Expected: [[[-0.205, 0.0386], [0.2051, -0.0385]]]