import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max14276 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max14276 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Sim29885 = tf.keras.layers.Input(shape=([3, 1]))

Max14276 = keras.layers.Maximum(name = 'Max14276', )([in0Max14276,in1Max14276])
Res51946 = keras.layers.Reshape((2, 1), name = 'Res51946', )(Max14276)
Sim29885 = keras.layers.SimpleRNN(2,name = 'Sim29885', )(in0Sim29885)
Res49682 = keras.layers.Reshape((2, 1), name = 'Res49682', )(Sim29885)
Max85272 = keras.layers.Maximum(name = 'Max85272', )([Res51946,Res49682])
Res15260 = keras.layers.Reshape((2, 1, 1), name = 'Res15260', )(Max85272)
Glo31787 = keras.layers.GlobalMaxPool2D(name = 'Glo31787', )(Res15260)
model = tf.keras.models.Model(inputs=[in0Max14276,in1Max14276,in0Sim29885], outputs=Glo31787)
w = model.get_layer('Sim29885').get_weights() 
w[0] = np.array([[5, 4]])
w[1] = np.array([[9, 1], [10, 10]])
w[2] = np.array([4, 5])
model.get_layer('Sim29885').set_weights(w) 
in0Max14276 = tf.constant([[[[0.3364]], [[0.6111]]]])
in1Max14276 = tf.constant([[[[0.7945]], [[0.879]]]])
in0Sim29885 = tf.constant([[[9], [6], [3]]])
print (np.array2string(model.predict([in0Max14276,in1Max14276,in0Sim29885],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo31787.png')

LMax14276 = maximum_layer([[[[[0.3364]], [[0.6111]]]], [[[[0.7945]], [[0.879]]]]], Max14276), 
LRes51946 = reshape_layer(Max14276, [2, 1], Res51946), 
LSim29885 = simple_rnn_layer([[[9], [6], [3]]],[[5, 4]],[[9, 1], [10, 10]],[4, 5], Sim29885), 
LRes49682 = reshape_layer(Sim29885, [2, 1], Res49682), 
LMax85272 = maximum_layer([Res51946,Res49682], Max85272), 
LRes15260 = reshape_layer(Max85272, [2, 1, 1], Res15260), 
LGlo31787 = global_max_pool2D_layer(Res15260, Glo31787), 
exec_layers([LMax14276,LRes51946,LSim29885,LRes49682,LMax85272,LRes15260,LGlo31787],["Max14276","Res51946","Sim29885","Res49682","Max85272","Res15260","Glo31787"],Glo31787,"Glo31787")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[1.0]]

Actual:   [[1]]

Expected: [[1]]