import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add37796 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Add37796 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Up_25602 = tf.keras.layers.Input(shape=([3, 1]))
in0Ave34055 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave34055 = tf.keras.layers.Input(shape=([1, 1, 1]))

Add37796 = keras.layers.Add(name = 'Add37796', )([in0Add37796,in1Add37796])
Res63810 = keras.layers.Reshape((1, 2, 1), name = 'Res63810', )(Add37796)
Res28845 = keras.layers.Reshape((1, 2), name = 'Res28845', )(Res63810)
Sim16001 = keras.layers.SimpleRNN(2,name = 'Sim16001', )(Res28845)
Res29551 = keras.layers.Reshape((2, 1), name = 'Res29551', )(Sim16001)
Res28790 = keras.layers.Reshape((2, 1, 1), name = 'Res28790', )(Res29551)
Zer75432 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer75432', )(Res28790)
Up_25602 = keras.layers.UpSampling1D(size=(1), name = 'Up_25602', )(in0Up_25602)
Res65134 = keras.layers.Reshape((3, 1, 1), name = 'Res65134', )(Up_25602)
Ave34055 = keras.layers.Average(name = 'Ave34055', )([in0Ave34055,in1Ave34055])
Zer40294 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer40294', )(Ave34055)
Max48287 = keras.layers.Maximum(name = 'Max48287', )([Res65134,Zer40294])
Ave96520 = keras.layers.Average(name = 'Ave96520', )([Zer75432,Max48287])
model = tf.keras.models.Model(inputs=[in0Add37796,in1Add37796,in0Up_25602,in0Ave34055,in1Ave34055], outputs=Ave96520)
w = model.get_layer('Sim16001').get_weights() 
w[0] = np.array([[10, 7], [9, 9]])
w[1] = np.array([[1, 2], [5, 6]])
w[2] = np.array([9, 9])
model.get_layer('Sim16001').set_weights(w) 
in0Add37796 = tf.constant([[[[[0.1864]], [[0.1989]]]]])
in1Add37796 = tf.constant([[[[[0.5819]], [[0.3593]]]]])
in0Up_25602 = tf.constant([[[1.9055], [1.6528], [1.5354]]])
in0Ave34055 = tf.constant([[[[0.8386]]]])
in1Ave34055 = tf.constant([[[[0.6939]]]])
print (np.array2string(model.predict([in0Add37796,in1Add37796,in0Up_25602,in0Ave34055,in1Ave34055],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave96520.png')

LAdd37796 = add_layer([[[[[[0.1864]], [[0.1989]]]]], [[[[[0.5819]], [[0.3593]]]]]], Add37796), 
LRes63810 = reshape_layer(Add37796, [1, 2, 1], Res63810), 
LRes28845 = reshape_layer(Res63810, [1, 2], Res28845), 
LSim16001 = simple_rnn_layer(Res28845,[[10, 7], [9, 9]],[[1, 2], [5, 6]],[9, 9], Sim16001), 
LRes29551 = reshape_layer(Sim16001, [2, 1], Res29551), 
LRes28790 = reshape_layer(Res29551, [2, 1, 1], Res28790), 
LZer75432 = zero_padding2D_layer(Res28790, 1, 0, 0, 0, Zer75432), 
LUp_25602 = up_sampling1D_layer([[[1.9055], [1.6528], [1.5354]]], 1, Up_25602), 
LRes65134 = reshape_layer(Up_25602, [3, 1, 1], Res65134), 
LAve34055 = average_layer([[[[[0.8386]]]], [[[[0.6939]]]]], Ave34055), 
LZer40294 = zero_padding2D_layer(Ave34055, 2, 0, 0, 0, Zer40294), 
LMax48287 = maximum_layer([Res65134,Zer40294], Max48287), 
LAve96520 = average_layer([Zer75432,Max48287], Ave96520), 
exec_layers([LAdd37796,LRes63810,LRes28845,LSim16001,LRes29551,LRes28790,LZer75432,LUp_25602,LRes65134,LAve34055,LZer40294,LMax48287,LAve96520],["Add37796","Res63810","Res28845","Sim16001","Res29551","Res28790","Zer75432","Up_25602","Res65134","Ave34055","Zer40294","Max48287","Ave96520"],Ave96520,"Ave96520")

Actual (Unparsed): [[[[0.9527500]], [[1.3264000]], [[1.2677000]]]]

Expected (Unparsed): [[[[0.95275]],[[1.3264]],[[1.2677]]]]

Actual:   [[[[0.9528]], [[1.3264]], [[1.2677]]]]

Expected: [[[[0.9528]], [[1.3264]], [[1.2677]]]]