import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per39178 = tf.keras.layers.Input(shape=([3, 4]))
in0ReL29289 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con35715 = tf.keras.layers.Input(shape=([4, 5]))
in0Glo65706 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot78293 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot78293 = tf.keras.layers.Input(shape=([3, 3]))
in0Con26332 = tf.keras.layers.Input(shape=([4, 6]))

Per39178 = keras.layers.Permute((1,2), name = 'Per39178',)(in0Per39178)
Res57516 = keras.layers.Reshape((3, 4, 1), name = 'Res57516', )(Per39178)
ReL29289 = keras.layers.ReLU(max_value=2.2693498987696925, negative_slope=3.6085409149807925, threshold=7.528782574532848, name = 'ReL29289', input_shape=(2, 1, 1))(in0ReL29289)
Zer17307 = keras.layers.ZeroPadding2D(padding=((1, 0), (3, 0)), name = 'Zer17307', )(ReL29289)
Max86095 = keras.layers.Maximum(name = 'Max86095', )([Res57516,Zer17307])
Res89280 = keras.layers.Reshape((3, 4), name = 'Res89280', )(Max86095)
Zer64078 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer64078', )(Res89280)
Con35715 = keras.layers.Concatenate(axis=2, name = 'Con35715', )([Zer64078,in0Con35715])
Glo65706 = keras.layers.GlobalMaxPool2D(name = 'Glo65706', )(in0Glo65706)
Res73993 = keras.layers.Reshape((2, 1), name = 'Res73993', )(Glo65706)
Res62334 = keras.layers.Reshape((2, 1, 1), name = 'Res62334', )(Res73993)
Res83524 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res83524', )(Res62334)
Zer74231 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer74231', )(Res83524)
Res67558 = keras.layers.Reshape((4, 3, 3), name = 'Res67558', )(Zer74231)
Res43188 = keras.layers.Reshape((4, 9), name = 'Res43188', )(Res67558)
Dot78293 = keras.layers.Dot(axes=(1, 1), name = 'Dot78293', )([in0Dot78293,in1Dot78293])
Zer11467 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer11467', )(Dot78293)
Con26332 = keras.layers.Concatenate(axis=2, name = 'Con26332', )([Zer11467,in0Con26332])
Ave93344 = keras.layers.Average(name = 'Ave93344', )([Res43188,Con26332])
Add86309 = keras.layers.Add(name = 'Add86309', )([Con35715,Ave93344])
Res39053 = keras.layers.Reshape((4, 9, 1), name = 'Res39053', )(Add86309)
Loc38580 = keras.layers.LocallyConnected2D(3, (4, 9),strides=(1, 1), name = 'Loc38580', )(Res39053)
model = tf.keras.models.Model(inputs=[in0Per39178,in0ReL29289,in0Con35715,in0Glo65706,in0Dot78293,in1Dot78293,in0Con26332], outputs=Loc38580)
w = model.get_layer('Loc38580').get_weights() 
w[0] = np.array([[[0.2537, 0.1604, 0.38], [0.2016, 0.7135, 0.1307], [0.3775, 0.331, 0.8671], [0.7016, 0.8704, 0.6817], [0.4161, 0.2849, 0.4927], [0.3083, 0.1957, 0.8436], [0.6844, 0.6872, 0.1709], [0.7094, 0.7046, 0.7632], [0.2288, 0.1943, 0.7889], [0.4249, 0.6204, 0.7194], [0.2922, 0.9996, 0.0427], [0.145, 0.7476, 0.3924], [0.6451, 0.3487, 0.5187], [0.4406, 0.6974, 0.8672], [0.1265, 0.899, 0.2573], [0.5977, 0.3926, 0.2293], [0.9456, 0.1351, 0.2543], [0.0261, 0.8487, 0.3111], [0.4807, 0.4819, 0.649], [0.8977, 0.5467, 0.7636], [0.3115, 0.2382, 0.6071], [0.556, 0.0453, 0.7774], [0.8514, 0.3128, 0.8004], [0.0765, 0.5208, 0.9467], [0.2616, 0.9202, 0.5195], [0.7921, 0.1581, 0.5476], [0.8612, 0.6743, 0.7184], [0.8739, 0.162, 0.835], [0.2713, 0.8084, 0.0065], [0.2769, 0.3176, 0.4191], [0.298, 0.8179, 0.8777], [0.7469, 0.6354, 0.7712], [0.5613, 0.53, 0.3501], [0.7072, 0.5943, 0.9637], [0.0845, 0.1941, 0.9939], [0.8901, 0.6965, 0.7618]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc38580').set_weights(w) 
in0Per39178 = tf.constant([[[1.3506, 1.6317, 1.6258, 1.3369], [1.1, 1.7683, 1.9666, 1.6298], [1.8142, 1.0976, 1.1354, 1.6642]]])
in0ReL29289 = tf.constant([[[[0.2487]], [[0.0017]]]])
in0Con35715 = tf.constant([[[0.9034, 0.4001, 0.4097, 0.116, 0.9886], [0.073, 0.8647, 0.4155, 0.22, 0.7193], [0.8266, 0.4314, 0.7931, 0.0485, 0.9926], [0.1488, 0.7323, 0.2847, 0.7463, 0.6546]]])
in0Glo65706 = tf.constant([[[[2, 1.366], [1.8055, 1.3855]], [[1.9573, 1.693], [1.3978, 1.9406]]]])
in0Dot78293 = tf.constant([[[0.028, 0.9731, 0.834], [0.7784, 0.887, 0.7561], [0.4003, 0.581, 0.2402]]])
in1Dot78293 = tf.constant([[[0.7378, 0.4242, 0.6843], [0.4585, 0.5966, 0.7332], [0.0531, 0.398, 0.6457]]])
in0Con26332 = tf.constant([[[0.5551, 0.076, 0.8443, 0.5616, 0.3307, 0.1137], [0.6462, 0.9211, 0.7492, 0.7566, 0.7358, 0.9605], [0.9116, 0.711, 0.2123, 0.7382, 0.8201, 0.724], [0.662, 0.1644, 0.9783, 0.5119, 0.6925, 0.0059]]])
print (np.array2string(model.predict([in0Per39178,in0ReL29289,in0Con35715,in0Glo65706,in0Dot78293,in1Dot78293,in0Con26332],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc38580.png')

LPer39178 = permute_layer([[[1.3506, 1.6317, 1.6258, 1.3369], [1.1, 1.7683, 1.9666, 1.6298], [1.8142, 1.0976, 1.1354, 1.6642]]], 1,2, Per39178), 
LRes57516 = reshape_layer(Per39178, [3, 4, 1], Res57516), 
LReL29289 = relu_layer([[[[0.2487]], [[0.0017]]]], 2.2693498987696925, 3.6085409149807925, 7.528782574532848, ReL29289), 
LZer17307 = zero_padding2D_layer(ReL29289, 1, 0, 3, 0, Zer17307), 
LMax86095 = maximum_layer([Res57516,Zer17307], Max86095), 
LRes89280 = reshape_layer(Max86095, [3, 4], Res89280), 
LZer64078 = zero_padding1D_layer(Res89280, 1, 0, Zer64078), 
LCon35715 = concatenate_layer([Zer64078,[[[0.9034, 0.4001, 0.4097, 0.116, 0.9886], [0.073, 0.8647, 0.4155, 0.22, 0.7193], [0.8266, 0.4314, 0.7931, 0.0485, 0.9926], [0.1488, 0.7323, 0.2847, 0.7463, 0.6546]]]], 2, Con35715), 
LGlo65706 = global_max_pool2D_layer([[[[2, 1.366], [1.8055, 1.3855]], [[1.9573, 1.693], [1.3978, 1.9406]]]], Glo65706), 
LRes73993 = reshape_layer(Glo65706, [2, 1], Res73993), 
LRes62334 = reshape_layer(Res73993, [2, 1, 1], Res62334), 
LRes83524 = reshape_layer(Res62334, [2, 1, 1, 1], Res83524), 
LZer74231 = zero_padding3D_layer(Res83524, 1, 1, 1, 1, 1, 1, Zer74231), 
LRes67558 = reshape_layer(Zer74231, [4, 3, 3], Res67558), 
LRes43188 = reshape_layer(Res67558, [4, 9], Res43188), 
LDot78293 = dot_layer([[[0.028, 0.9731, 0.834], [0.7784, 0.887, 0.7561], [0.4003, 0.581, 0.2402]]], [[[0.7378, 0.4242, 0.6843], [0.4585, 0.5966, 0.7332], [0.0531, 0.398, 0.6457]]], 1, 1, Dot78293), 
LZer11467 = zero_padding1D_layer(Dot78293, 1, 0, Zer11467), 
LCon26332 = concatenate_layer([Zer11467,[[[0.5551, 0.076, 0.8443, 0.5616, 0.3307, 0.1137], [0.6462, 0.9211, 0.7492, 0.7566, 0.7358, 0.9605], [0.9116, 0.711, 0.2123, 0.7382, 0.8201, 0.724], [0.662, 0.1644, 0.9783, 0.5119, 0.6925, 0.0059]]]], 2, Con26332), 
LAve93344 = average_layer([Res43188,Con26332], Ave93344), 
LAdd86309 = add_layer([Con35715,Ave93344], Add86309), 
LRes39053 = reshape_layer(Add86309, [4, 9, 1], Res39053), 
LLoc38580 = locally_connected2D_layer(Res39053, 4, 9,[[[0.2537, 0.1604, 0.38], [0.2016, 0.7135, 0.1307], [0.3775, 0.331, 0.8671], [0.7016, 0.8704, 0.6817], [0.4161, 0.2849, 0.4927], [0.3083, 0.1957, 0.8436], [0.6844, 0.6872, 0.1709], [0.7094, 0.7046, 0.7632], [0.2288, 0.1943, 0.7889], [0.4249, 0.6204, 0.7194], [0.2922, 0.9996, 0.0427], [0.145, 0.7476, 0.3924], [0.6451, 0.3487, 0.5187], [0.4406, 0.6974, 0.8672], [0.1265, 0.899, 0.2573], [0.5977, 0.3926, 0.2293], [0.9456, 0.1351, 0.2543], [0.0261, 0.8487, 0.3111], [0.4807, 0.4819, 0.649], [0.8977, 0.5467, 0.7636], [0.3115, 0.2382, 0.6071], [0.556, 0.0453, 0.7774], [0.8514, 0.3128, 0.8004], [0.0765, 0.5208, 0.9467], [0.2616, 0.9202, 0.5195], [0.7921, 0.1581, 0.5476], [0.8612, 0.6743, 0.7184], [0.8739, 0.162, 0.835], [0.2713, 0.8084, 0.0065], [0.2769, 0.3176, 0.4191], [0.298, 0.8179, 0.8777], [0.7469, 0.6354, 0.7712], [0.5613, 0.53, 0.3501], [0.7072, 0.5943, 0.9637], [0.0845, 0.1941, 0.9939], [0.8901, 0.6965, 0.7618]]],[[[0, 0, 0]]], 1, 1, Loc38580), 
exec_layers([LPer39178,LRes57516,LReL29289,LZer17307,LMax86095,LRes89280,LZer64078,LCon35715,LGlo65706,LRes73993,LRes62334,LRes83524,LZer74231,LRes67558,LRes43188,LDot78293,LZer11467,LCon26332,LAve93344,LAdd86309,LRes39053,LLoc38580],["Per39178","Res57516","ReL29289","Zer17307","Max86095","Res89280","Zer64078","Con35715","Glo65706","Res73993","Res62334","Res83524","Zer74231","Res67558","Res43188","Dot78293","Zer11467","Con26332","Ave93344","Add86309","Res39053","Loc38580"],Loc38580,"Loc38580")

Actual (Unparsed): [[[[20.3409857, 21.6353660, 25.1376330]]]]

Expected (Unparsed): [[[[20.3409855274425,21.635365886721,25.137632886028502]]]]

Actual:   [[[[20.341, 21.6354, 25.1377]]]]

Expected: [[[[20.341, 21.6354, 25.1377]]]]