import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add71853 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Add71853 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Ave69802 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave69802 = tf.keras.layers.Input(shape=([2, 2]))

Add71853 = keras.layers.Add(name = 'Add71853', )([in0Add71853,in1Add71853])
Res3513 = keras.layers.Reshape((1, 1, 2), name = 'Res3513', )(Add71853)
Res14353 = keras.layers.Reshape((1, 2), name = 'Res14353', )(Res3513)
Zer64460 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer64460', )(Res14353)
Ave69802 = keras.layers.Average(name = 'Ave69802', )([in0Ave69802,in1Ave69802])
Ave11634 = keras.layers.Average(name = 'Ave11634', )([Zer64460,Ave69802])
Res79100 = keras.layers.Reshape((2, 2, 1), name = 'Res79100', )(Ave11634)
Sep25899 = keras.layers.SeparableConv2D(3, (1, 2),strides=(2, 2), padding='valid', name = 'Sep25899', )(Res79100)
Zer93420 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer93420', )(Sep25899)
model = tf.keras.models.Model(inputs=[in0Add71853,in1Add71853,in0Ave69802,in1Ave69802], outputs=Zer93420)
w = model.get_layer('Sep25899').get_weights() 
w[0] = np.array([[[[0.4159]], [[0.619]]]])
w[1] = np.array([[[[0.7843, 0.7903, 0.0381]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep25899').set_weights(w) 
in0Add71853 = tf.constant([[[[[0.9957], [0.7739]]]]])
in1Add71853 = tf.constant([[[[[0.2807], [0.5765]]]]])
in0Ave69802 = tf.constant([[[0.8198, 0.2009], [0.0894, 0.0661]]])
in1Ave69802 = tf.constant([[[0.8056, 0.6787], [0.1358, 0.5881]]])
print (np.array2string(model.predict([in0Add71853,in1Add71853,in0Ave69802,in1Ave69802],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer93420.png')

LAdd71853 = add_layer([[[[[[0.9957], [0.7739]]]]], [[[[[0.2807], [0.5765]]]]]], Add71853), 
LRes3513 = reshape_layer(Add71853, [1, 1, 2], Res3513), 
LRes14353 = reshape_layer(Res3513, [1, 2], Res14353), 
LZer64460 = zero_padding1D_layer(Res14353, 1, 0, Zer64460), 
LAve69802 = average_layer([[[[0.8198, 0.2009], [0.0894, 0.0661]]], [[[0.8056, 0.6787], [0.1358, 0.5881]]]], Ave69802), 
LAve11634 = average_layer([Zer64460,Ave69802], Ave11634), 
LRes79100 = reshape_layer(Ave11634, [2, 2, 1], Res79100), 
LSep25899 = separable_conv2D_layer(Res79100, 1, 2,[[[[[0.4159]], [[0.619]]]],[[[[0.7843, 0.7903, 0.0381]]]]],[0, 0, 0], 2, 2, false, Sep25899), 
LZer93420 = zero_padding2D_layer(Sep25899, 1, 1, 1, 1, Zer93420), 
exec_layers([LAdd71853,LRes3513,LRes14353,LZer64460,LAve69802,LAve11634,LRes79100,LSep25899,LZer93420],["Add71853","Res3513","Res14353","Zer64460","Ave69802","Ave11634","Res79100","Sep25899","Zer93420"],Zer93420,"Zer93420")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.2393049, 0.2411356, 0.0116250], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0.2393048826795,0.2411355970695,0.0116250363765],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]]]

Actual:   [[[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0.2394, 0.2412, 0.0117], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]

Expected: [[[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0.2394, 0.2412, 0.0117], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]