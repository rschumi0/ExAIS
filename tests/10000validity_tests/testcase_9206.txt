import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add18647 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Add18647 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Mul57652 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul57652 = tf.keras.layers.Input(shape=([2, 1]))
in0Con1564 = tf.keras.layers.Input(shape=([2, 3]))
in0Mul31007 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Mul31007 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Add18647 = keras.layers.Add(name = 'Add18647', )([in0Add18647,in1Add18647])
Res27140 = keras.layers.Reshape((2, 2, 2), name = 'Res27140', )(Add18647)
Res28401 = keras.layers.Reshape((2, 4), name = 'Res28401', )(Res27140)
Mul57652 = keras.layers.Multiply(name = 'Mul57652', )([in0Mul57652,in1Mul57652])
Con1564 = keras.layers.Concatenate(axis=2, name = 'Con1564', )([Mul57652,in0Con1564])
Sub31565 = keras.layers.Subtract(name = 'Sub31565', )([Res28401,Con1564])
Con75497 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con75497', )(Sub31565)
Bat88637 = keras.layers.BatchNormalization(axis=1, epsilon=0.7592146539377631,  name = 'Bat88637', )(Con75497)
Res92495 = keras.layers.Reshape((2, 4, 1), name = 'Res92495', )(Bat88637)
Res51401 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res51401', )(Res92495)
Mul31007 = keras.layers.Multiply(name = 'Mul31007', )([in0Mul31007,in1Mul31007])
Zer32113 = keras.layers.ZeroPadding3D(padding=((1, 0), (2, 0), (0, 0)), name = 'Zer32113', )(Mul31007)
Mul27950 = keras.layers.Multiply(name = 'Mul27950', )([Res51401,Zer32113])
model = tf.keras.models.Model(inputs=[in0Add18647,in1Add18647,in0Mul57652,in1Mul57652,in0Con1564,in0Mul31007,in1Mul31007], outputs=Mul27950)
w = model.get_layer('Con75497').get_weights() 
w[0] = np.array([[[0.5151, 0.0464, 0.6194, 0.4661], [0.2962, 0.3494, 0.5752, 0.3085], [0.5871, 0.4357, 0.0048, 0.3068], [0.2923, 0.9565, 0.3315, 0.977]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con75497').set_weights(w) 
w = model.get_layer('Bat88637').get_weights() 
w[0] = np.array([0.7691, 0.9798])
w[1] = np.array([0.666, 0.0926])
w[2] = np.array([0.9467, 0.3935])
w[3] = np.array([0.9688, 0.4762])
model.get_layer('Bat88637').set_weights(w) 
in0Add18647 = tf.constant([[[[[0.0622], [0.3127]], [[0.6116], [0.42]]], [[[0.2422], [0.0885]], [[0.9241], [0.668]]]]])
in1Add18647 = tf.constant([[[[[0.5212], [0.3705]], [[0.7482], [0.945]]], [[[0.7387], [0.4866]], [[0.0907], [0.4669]]]]])
in0Mul57652 = tf.constant([[[0.233], [0.5298]]])
in1Mul57652 = tf.constant([[[0.7801], [0.7242]]])
in0Con1564 = tf.constant([[[0.6742, 0.1436, 0.509], [0.4082, 0.5145, 0.637]]])
in0Mul31007 = tf.constant([[[[[0.8492]], [[0.6724]]]]])
in1Mul31007 = tf.constant([[[[[0.6158]], [[0.2749]]]]])
print (np.array2string(model.predict([in0Add18647,in1Add18647,in0Mul57652,in1Mul57652,in0Con1564,in0Mul31007,in1Mul31007],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul27950.png')

LAdd18647 = add_layer([[[[[[0.0622], [0.3127]], [[0.6116], [0.42]]], [[[0.2422], [0.0885]], [[0.9241], [0.668]]]]], [[[[[0.5212], [0.3705]], [[0.7482], [0.945]]], [[[0.7387], [0.4866]], [[0.0907], [0.4669]]]]]], Add18647), 
LRes27140 = reshape_layer(Add18647, [2, 2, 2], Res27140), 
LRes28401 = reshape_layer(Res27140, [2, 4], Res28401), 
LMul57652 = multiply_layer([[[[0.233], [0.5298]]], [[[0.7801], [0.7242]]]], Mul57652), 
LCon1564 = concatenate_layer([Mul57652,[[[0.6742, 0.1436, 0.509], [0.4082, 0.5145, 0.637]]]], 2, Con1564), 
LSub31565 = subtract_layer(Res28401,Con1564, Sub31565), 
LCon75497 = conv1D_layer(Sub31565, 1,[[[0.5151, 0.0464, 0.6194, 0.4661], [0.2962, 0.3494, 0.5752, 0.3085], [0.5871, 0.4357, 0.0048, 0.3068], [0.2923, 0.9565, 0.3315, 0.977]]],[0, 0, 0, 0], 1, true, 1, Con75497), 
LBat88637 = batch_normalization_layer(Con75497, 1, 0.7592146539377631, [0.7691, 0.9798], [0.666, 0.0926], [0.9467, 0.3935], [0.9688, 0.4762], Bat88637), 
LRes92495 = reshape_layer(Bat88637, [2, 4, 1], Res92495), 
LRes51401 = reshape_layer(Res92495, [2, 4, 1, 1], Res51401), 
LMul31007 = multiply_layer([[[[[[0.8492]], [[0.6724]]]]], [[[[[0.6158]], [[0.2749]]]]]], Mul31007), 
LZer32113 = zero_padding3D_layer(Mul31007, 1, 0, 2, 0, 0, 0, Zer32113), 
LMul27950 = multiply_layer([Res51401,Zer32113], Mul27950), 
exec_layers([LAdd18647,LRes27140,LRes28401,LMul57652,LCon1564,LSub31565,LCon75497,LBat88637,LRes92495,LRes51401,LMul31007,LZer32113,LMul27950],["Add18647","Res27140","Res28401","Mul57652","Con1564","Sub31565","Con75497","Bat88637","Res92495","Res51401","Mul31007","Zer32113","Mul27950"],Mul27950,"Mul27950")

Actual (Unparsed): [[[[[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]]], [[[0.0000000]], [[0.0000000]], [[0.1590005]], [[0.1110188]]]]]

Expected (Unparsed): [[[[[0.0]],[[0.0]],[[0.0]],[[0.0]]],[[[0.0]],[[0.0]],[[0.15900055016206768]],[[0.11101882336022884]]]]]

Actual:   [[[[[0]], [[0]], [[0]], [[0]]], [[[0]], [[0]], [[0.1591]], [[0.1111]]]]]

Expected: [[[[[0]], [[0]], [[0]], [[0]]], [[[0]], [[0]], [[0.1591]], [[0.1111]]]]]