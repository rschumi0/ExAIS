import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot78352 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot78352 = tf.keras.layers.Input(shape=([2, 2]))

Dot78352 = keras.layers.Dot(axes=(2, 2), name = 'Dot78352', )([in0Dot78352,in1Dot78352])
Loc81239 = keras.layers.LocallyConnected1D(2, (1),strides=(2), name = 'Loc81239', )(Dot78352)
Den91115 = keras.layers.Dense(1,name = 'Den91115', )(Loc81239)
Res80479 = keras.layers.Reshape((1, 1, 1), name = 'Res80479', )(Den91115)
Ave24927 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='valid', name = 'Ave24927', )(Res80479)
model = tf.keras.models.Model(inputs=[in0Dot78352,in1Dot78352], outputs=Ave24927)
w = model.get_layer('Loc81239').get_weights() 
w[0] = np.array([[[0.527, 0.911], [0.8814, 0.9993]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc81239').set_weights(w) 
w = model.get_layer('Den91115').get_weights() 
w[0] = np.array([[0.1439], [0.6937]])
w[1] = np.array([0.0857])
model.get_layer('Den91115').set_weights(w) 
in0Dot78352 = tf.constant([[[0.1374, 0.1543], [0.3435, 0.3533]]])
in1Dot78352 = tf.constant([[[0.709, 0.5839], [0.2134, 0.0335]]])
print (np.array2string(model.predict([in0Dot78352,in1Dot78352],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave24927.png')

LDot78352 = dot_layer([[[0.1374, 0.1543], [0.3435, 0.3533]]], [[[0.709, 0.5839], [0.2134, 0.0335]]], 2, 2, Dot78352), 
LLoc81239 = locally_connected1D_layer(Dot78352, 1,[[[0.527, 0.911], [0.8814, 0.9993]]],[[0, 0]], 2, Loc81239), 
LDen91115 = dense_layer(Loc81239, [[0.1439], [0.6937]],[0.0857], Den91115), 
LRes80479 = reshape_layer(Den91115, [1, 1, 1], Res80479), 
LAve24927 = average_pooling2D_layer(Res80479, 1, 1, 1, 1, false, Ave24927), 
exec_layers([LDot78352,LLoc81239,LDen91115,LRes80479,LAve24927],["Dot78352","Loc81239","Den91115","Res80479","Ave24927"],Ave24927,"Ave24927")

Actual (Unparsed): [[[[0.2467041]]]]

Expected (Unparsed): [[[[0.2467041286828727]]]]

Actual:   [[[[0.2468]]]]

Expected: [[[[0.2468]]]]