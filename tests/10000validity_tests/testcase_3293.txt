import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min20735 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min20735 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0PRe12545 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con46109 = tf.keras.layers.Input(shape=([1, 2, 1]))

Min20735 = keras.layers.Minimum(name = 'Min20735', )([in0Min20735,in1Min20735])
Res56086 = keras.layers.Reshape((1, 2, 2), name = 'Res56086', )(Min20735)
PRe12545 = keras.layers.PReLU(name = 'PRe12545', input_shape=(1, 2, 1))(in0PRe12545)
Con46109 = keras.layers.Concatenate(axis=3, name = 'Con46109', )([PRe12545,in0Con46109])
Min48481 = keras.layers.Minimum(name = 'Min48481', )([Res56086,Con46109])
Res42644 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res42644', )(Min48481)
Con28228 = keras.layers.Conv3DTranspose(3, (1, 2, 2),strides=(7, 1, 1), padding='same', name = 'Con28228', )(Res42644)
Res51448 = keras.layers.Reshape((7, 2, 6), name = 'Res51448', )(Con28228)
Res91640 = keras.layers.Reshape((7, 12), name = 'Res91640', )(Res51448)
Sep61981 = keras.layers.SeparableConv1D(4, (2),strides=(4), padding='same', name = 'Sep61981', )(Res91640)
Bat69880 = keras.layers.BatchNormalization(axis=1, epsilon=0.8874570958278585,  name = 'Bat69880', )(Sep61981)
model = tf.keras.models.Model(inputs=[in0Min20735,in1Min20735,in0PRe12545,in0Con46109], outputs=Bat69880)
w = model.get_layer('PRe12545').get_weights() 
w[0] = np.array([[[0.7406], [0.8314]]])
model.get_layer('PRe12545').set_weights(w) 
w = model.get_layer('Con28228').get_weights() 
w[0] = np.array([[[[[0.0228], [0.5655], [0.1293]], [[0.5852], [0.7144], [0.6896]]], [[[0.0234], [0.7477], [0.0584]], [[0.4727], [0.4979], [0.1949]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con28228').set_weights(w) 
w = model.get_layer('Sep61981').get_weights() 
w[0] = np.array([[[0.2439], [0.7494], [0.064], [0.308], [0.3003], [0.6169], [0.2212], [0.8015], [0.5929], [0.2037], [0.8316], [0.5654]], [[0.0943], [0.281], [0.1584], [0.4527], [0.4584], [0.9889], [0.9195], [0.7009], [0.6132], [0.4428], [0.7784], [0.2236]]])
w[1] = np.array([[[0.466, 0.0446, 0.995, 0.6795], [0.483, 0.3493, 0.9806, 0.3403], [0.176, 0.3302, 0.7983, 0.3078], [0.5361, 0.5064, 0.7702, 0.1086], [0.2457, 0.8889, 0.7452, 0.5018], [0.8495, 0.5755, 0.6293, 0.1755], [0.1232, 0.1388, 0.3835, 0.5538], [0.7755, 0.6419, 0.7898, 0.0769], [0.4558, 0.4912, 0.2627, 0.4567], [0.41, 0.4941, 0.9936, 0.8355], [0.0221, 0.4285, 0.7535, 0.4782], [0.9155, 0.1477, 0.7539, 0.6135]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep61981').set_weights(w) 
w = model.get_layer('Bat69880').get_weights() 
w[0] = np.array([0.8964, 0.9198])
w[1] = np.array([0.8395, 0.377])
w[2] = np.array([0.4309, 0.8427])
w[3] = np.array([0.9256, 0.0595])
model.get_layer('Bat69880').set_weights(w) 
in0Min20735 = tf.constant([[[[[0.7639], [0.2038]], [[0.1314], [0.2281]]]]])
in1Min20735 = tf.constant([[[[[0.9309], [0.4805]], [[0.0515], [0.7057]]]]])
in0PRe12545 = tf.constant([[[[0.724], [0.5475]]]])
in0Con46109 = tf.constant([[[[0.1138], [0.7346]]]])
print (np.array2string(model.predict([in0Min20735,in1Min20735,in0PRe12545,in0Con46109],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat69880.png')

LMin20735 = minimum_layer([[[[[[0.7639], [0.2038]], [[0.1314], [0.2281]]]]], [[[[[0.9309], [0.4805]], [[0.0515], [0.7057]]]]]], Min20735), 
LRes56086 = reshape_layer(Min20735, [1, 2, 2], Res56086), 
LPRe12545 = prelu_layer([[[[0.724], [0.5475]]]], [[[0.7406], [0.8314]]], PRe12545), 
LCon46109 = concatenate_layer([PRe12545,[[[[0.1138], [0.7346]]]]], 3, Con46109), 
LMin48481 = minimum_layer([Res56086,Con46109], Min48481), 
LRes42644 = reshape_layer(Min48481, [1, 2, 2, 1], Res42644), 
LCon28228 = conv3D_transpose_layer(Res42644, 1, 2, 2,[[[[[0.0228], [0.5655], [0.1293]], [[0.5852], [0.7144], [0.6896]]], [[[0.0234], [0.7477], [0.0584]], [[0.4727], [0.4979], [0.1949]]]]],[0, 0, 0], 7, 1, 1, true, Con28228), 
LRes51448 = reshape_layer(Con28228, [7, 2, 6], Res51448), 
LRes91640 = reshape_layer(Res51448, [7, 12], Res91640), 
LSep61981 = separable_conv1D_layer(Res91640, 2,[[[[0.2439], [0.7494], [0.064], [0.308], [0.3003], [0.6169], [0.2212], [0.8015], [0.5929], [0.2037], [0.8316], [0.5654]], [[0.0943], [0.281], [0.1584], [0.4527], [0.4584], [0.9889], [0.9195], [0.7009], [0.6132], [0.4428], [0.7784], [0.2236]]],[[[0.466, 0.0446, 0.995, 0.6795], [0.483, 0.3493, 0.9806, 0.3403], [0.176, 0.3302, 0.7983, 0.3078], [0.5361, 0.5064, 0.7702, 0.1086], [0.2457, 0.8889, 0.7452, 0.5018], [0.8495, 0.5755, 0.6293, 0.1755], [0.1232, 0.1388, 0.3835, 0.5538], [0.7755, 0.6419, 0.7898, 0.0769], [0.4558, 0.4912, 0.2627, 0.4567], [0.41, 0.4941, 0.9936, 0.8355], [0.0221, 0.4285, 0.7535, 0.4782], [0.9155, 0.1477, 0.7539, 0.6135]]]],[0, 0, 0, 0], 4, true, Sep61981), 
LBat69880 = batch_normalization_layer(Sep61981, 1, 0.8874570958278585, [0.8964, 0.9198], [0.8395, 0.377], [0.4309, 0.8427], [0.9256, 0.0595], Bat69880), 
exec_layers([LMin20735,LRes56086,LPRe12545,LCon46109,LMin48481,LRes42644,LCon28228,LRes51448,LRes91640,LSep61981,LBat69880],["Min20735","Res56086","PRe12545","Con46109","Min48481","Res42644","Con28228","Res51448","Res91640","Sep61981","Bat69880"],Bat69880,"Bat69880")

Actual (Unparsed): [[[1.2551116, 1.2820933, 1.6587205, 1.0178462], [-0.4195284, -0.4195284, -0.4195284, -0.4195284]]]

Expected (Unparsed): [[[1.255111573128533,1.282093351767583,1.6587205566540444,1.017846193349742],[-0.41952836836329954,-0.41952836836329954,-0.41952836836329954,-0.41952836836329954]]]

Actual:   [[[1.2552, 1.2821, 1.6588, 1.0179], [-0.4195, -0.4195, -0.4195, -0.4195]]]

Expected: [[[1.2552, 1.2821, 1.6588, 1.0179], [-0.4195, -0.4195, -0.4195, -0.4195]]]