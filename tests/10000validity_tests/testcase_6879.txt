import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul86687 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Mul86687 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Ave62603 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave62603 = tf.keras.layers.Input(shape=([2, 2]))

Mul86687 = keras.layers.Multiply(name = 'Mul86687', )([in0Mul86687,in1Mul86687])
Res4993 = keras.layers.Reshape((2, 2, 1), name = 'Res4993', )(Mul86687)
Ave62603 = keras.layers.Average(name = 'Ave62603', )([in0Ave62603,in1Ave62603])
Fla528 = keras.layers.Flatten(name = 'Fla528', )(Ave62603)
Res34096 = keras.layers.Reshape((2, 2, 1), name = 'Res34096', )(Fla528)
Add88910 = keras.layers.Add(name = 'Add88910', )([Res4993,Res34096])
model = tf.keras.models.Model(inputs=[in0Mul86687,in1Mul86687,in0Ave62603,in1Ave62603], outputs=Add88910)
in0Mul86687 = tf.constant([[[[[0.3321]], [[0.523]]], [[[0.1131]], [[0.8668]]]]])
in1Mul86687 = tf.constant([[[[[0.7982]], [[0.2683]]], [[[0.6033]], [[0.5791]]]]])
in0Ave62603 = tf.constant([[[0.7524, 0.5855], [0.6623, 0.9458]]])
in1Ave62603 = tf.constant([[[0.4018, 0.2483], [0.7228, 0.9038]]])
print (np.array2string(model.predict([in0Mul86687,in1Mul86687,in0Ave62603,in1Ave62603],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add88910.png')

LMul86687 = multiply_layer([[[[[[0.3321]], [[0.523]]], [[[0.1131]], [[0.8668]]]]], [[[[[0.7982]], [[0.2683]]], [[[0.6033]], [[0.5791]]]]]], Mul86687), 
LRes4993 = reshape_layer(Mul86687, [2, 2, 1], Res4993), 
LAve62603 = average_layer([[[[0.7524, 0.5855], [0.6623, 0.9458]]], [[[0.4018, 0.2483], [0.7228, 0.9038]]]], Ave62603), 
LFla528 = flatten_layer(Ave62603, Fla528), 
LRes34096 = reshape_layer(Fla528, [2, 2, 1], Res34096), 
LAdd88910 = add_layer([Res4993,Res34096], Add88910), 
exec_layers([LMul86687,LRes4993,LAve62603,LFla528,LRes34096,LAdd88910],["Mul86687","Res4993","Ave62603","Fla528","Res34096","Add88910"],Add88910,"Add88910")

Actual (Unparsed): [[[[0.8421822], [0.5572209]], [[0.7607832], [1.4267639]]]]

Expected (Unparsed): [[[[0.84218222],[0.5572209]],[[0.76078323],[1.42676388]]]]

Actual:   [[[[0.8422], [0.5573]], [[0.7608], [1.4268]]]]

Expected: [[[[0.8422], [0.5573]], [[0.7608], [1.4268]]]]