import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max64684 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max64684 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0PRe64858 = tf.keras.layers.Input(shape=([1, 1]))
in0Con42992 = tf.keras.layers.Input(shape=([2, 3]))
in0Con97030 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Max48224 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max48224 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Add35766 = tf.keras.layers.Input(shape=([2, 1]))
in1Add35766 = tf.keras.layers.Input(shape=([2, 1]))
in0Con40585 = tf.keras.layers.Input(shape=([2, 5]))

Max64684 = keras.layers.Maximum(name = 'Max64684', )([in0Max64684,in1Max64684])
Res31694 = keras.layers.Reshape((2, 4), name = 'Res31694', )(Max64684)
PRe64858 = keras.layers.PReLU(name = 'PRe64858', input_shape=(1, 1))(in0PRe64858)
Zer91827 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer91827', )(PRe64858)
Con42992 = keras.layers.Concatenate(axis=2, name = 'Con42992', )([Zer91827,in0Con42992])
Max78968 = keras.layers.Maximum(name = 'Max78968', )([Res31694,Con42992])
Loc71142 = keras.layers.LocallyConnected1D(2, (2),strides=(1), name = 'Loc71142', )(Max78968)
Res88171 = keras.layers.Reshape((1, 2, 1), name = 'Res88171', )(Loc71142)
Zer69402 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer69402', )(Res88171)
Con97030 = keras.layers.Concatenate(axis=3, name = 'Con97030', )([Zer69402,in0Con97030])
Max48224 = keras.layers.Maximum(name = 'Max48224', )([in0Max48224,in1Max48224])
Zer24291 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer24291', )(Max48224)
Min25560 = keras.layers.Minimum(name = 'Min25560', )([Con97030,Zer24291])
Res81902 = keras.layers.Reshape((2, 6), name = 'Res81902', )(Min25560)
Add35766 = keras.layers.Add(name = 'Add35766', )([in0Add35766,in1Add35766])
Con40585 = keras.layers.Concatenate(axis=2, name = 'Con40585', )([Add35766,in0Con40585])
Sub83628 = keras.layers.Subtract(name = 'Sub83628', )([Res81902,Con40585])
model = tf.keras.models.Model(inputs=[in0Max64684,in1Max64684,in0PRe64858,in0Con42992,in0Con97030,in0Max48224,in1Max48224,in0Add35766,in1Add35766,in0Con40585], outputs=Sub83628)
w = model.get_layer('PRe64858').get_weights() 
w[0] = np.array([[0.0707]])
model.get_layer('PRe64858').set_weights(w) 
w = model.get_layer('Loc71142').get_weights() 
w[0] = np.array([[[0.874, 0.9001], [0.7261, 0.337], [0.7023, 0.668], [0.4826, 0.0266], [0.5626, 0.6139], [0.4641, 0.2837], [0.2653, 0.177], [0.4065, 0.8368]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc71142').set_weights(w) 
in0Max64684 = tf.constant([[[[0.1908, 0.7394], [0.2798, 0.509]], [[0.1629, 0.4205], [0.578, 0.8463]]]])
in1Max64684 = tf.constant([[[[0.9285, 0.5262], [0.8256, 0.8708]], [[0.5233, 0.4992], [0.8922, 0.9071]]]])
in0PRe64858 = tf.constant([[[0.2062]]])
in0Con42992 = tf.constant([[[0.7891, 0.8112, 0.5299], [0.4061, 0.3829, 0.7002]]])
in0Con97030 = tf.constant([[[[0.1112], [0.5889], [0.7838]], [[0.6912], [0.1397], [0.586]]]])
in0Max48224 = tf.constant([[[[0.2268, 0.407]], [[0.7457, 0.7547]]]])
in1Max48224 = tf.constant([[[[0.837, 0.0945]], [[0.6092, 0.9864]]]])
in0Add35766 = tf.constant([[[0.3063], [0.9207]]])
in1Add35766 = tf.constant([[[0.963], [0.9195]]])
in0Con40585 = tf.constant([[[0.5789, 0.5235, 0.7539, 0.4492, 0.5881], [0.1404, 0.77, 0.0783, 0.4923, 0.0289]]])
print (np.array2string(model.predict([in0Max64684,in1Max64684,in0PRe64858,in0Con42992,in0Con97030,in0Max48224,in1Max48224,in0Add35766,in1Add35766,in0Con40585],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub83628.png')

LMax64684 = maximum_layer([[[[[0.1908, 0.7394], [0.2798, 0.509]], [[0.1629, 0.4205], [0.578, 0.8463]]]], [[[[0.9285, 0.5262], [0.8256, 0.8708]], [[0.5233, 0.4992], [0.8922, 0.9071]]]]], Max64684), 
LRes31694 = reshape_layer(Max64684, [2, 4], Res31694), 
LPRe64858 = prelu_layer([[[0.2062]]], [[0.0707]], PRe64858), 
LZer91827 = zero_padding1D_layer(PRe64858, 1, 0, Zer91827), 
LCon42992 = concatenate_layer([Zer91827,[[[0.7891, 0.8112, 0.5299], [0.4061, 0.3829, 0.7002]]]], 2, Con42992), 
LMax78968 = maximum_layer([Res31694,Con42992], Max78968), 
LLoc71142 = locally_connected1D_layer(Max78968, 2,[[[0.874, 0.9001], [0.7261, 0.337], [0.7023, 0.668], [0.4826, 0.0266], [0.5626, 0.6139], [0.4641, 0.2837], [0.2653, 0.177], [0.4065, 0.8368]]],[[0, 0]], 1, Loc71142), 
LRes88171 = reshape_layer(Loc71142, [1, 2, 1], Res88171), 
LZer69402 = zero_padding2D_layer(Res88171, 1, 0, 1, 0, Zer69402), 
LCon97030 = concatenate_layer([Zer69402,[[[[0.1112], [0.5889], [0.7838]], [[0.6912], [0.1397], [0.586]]]]], 3, Con97030), 
LMax48224 = maximum_layer([[[[[0.2268, 0.407]], [[0.7457, 0.7547]]]], [[[[0.837, 0.0945]], [[0.6092, 0.9864]]]]], Max48224), 
LZer24291 = zero_padding2D_layer(Max48224, 0, 0, 2, 0, Zer24291), 
LMin25560 = minimum_layer([Con97030,Zer24291], Min25560), 
LRes81902 = reshape_layer(Min25560, [2, 6], Res81902), 
LAdd35766 = add_layer([[[[0.3063], [0.9207]]], [[[0.963], [0.9195]]]], Add35766), 
LCon40585 = concatenate_layer([Add35766,[[[0.5789, 0.5235, 0.7539, 0.4492, 0.5881], [0.1404, 0.77, 0.0783, 0.4923, 0.0289]]]], 2, Con40585), 
LSub83628 = subtract_layer(Res81902,Con40585, Sub83628), 
exec_layers([LMax64684,LRes31694,LPRe64858,LZer91827,LCon42992,LMax78968,LLoc71142,LRes88171,LZer69402,LCon97030,LMax48224,LZer24291,LMin25560,LRes81902,LAdd35766,LCon40585,LSub83628],["Max64684","Res31694","PRe64858","Zer91827","Con42992","Max78968","Loc71142","Res88171","Zer69402","Con97030","Max48224","Zer24291","Min25560","Res81902","Add35766","Con40585","Sub83628"],Sub83628,"Sub83628")

Actual (Unparsed): [[[-1.2693000, -0.5789000, -0.5235000, -0.7539000, -0.4492000, -0.1811000], [-1.8402000, -0.1404000, -0.7700000, -0.0783000, 0.2534000, 0.5571000]]]

Expected (Unparsed): [[[-1.2692999999999999,-0.5789,-0.5235,-0.7539,-0.4492,-0.18109999999999998],[-1.8401999999999998,-0.1404,-0.77,-0.0783,0.2534,0.5570999999999999]]]

Actual:   [[[-1.2693, -0.5789, -0.5235, -0.7539, -0.4492, -0.1811], [-1.8402, -0.1404, -0.77, -0.0783, 0.2534, 0.5571]]]

Expected: [[[-1.2692, -0.5789, -0.5235, -0.7539, -0.4492, -0.181], [-1.8401, -0.1404, -0.77, -0.0783, 0.2534, 0.5571]]]