import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul30598 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Mul30598 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Con28735 = tf.keras.layers.Input(shape=([2, 3]))
in0Min53695 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min53695 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Min58583 = tf.keras.layers.Input(shape=([1, 2]))
in1Min58583 = tf.keras.layers.Input(shape=([1, 2]))
in0Con90845 = tf.keras.layers.Input(shape=([1, 2]))
in0Add17136 = tf.keras.layers.Input(shape=([2, 1]))
in1Add17136 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot53113 = tf.keras.layers.Input(shape=([2]))
in1Dot53113 = tf.keras.layers.Input(shape=([2]))
in0Con39779 = tf.keras.layers.Input(shape=([1]))
in0LST50719 = tf.keras.layers.Input(shape=([2, 1]))
in0Add57435 = tf.keras.layers.Input(shape=([1, 2]))
in1Add57435 = tf.keras.layers.Input(shape=([1, 2]))
in0Con7418 = tf.keras.layers.Input(shape=([1]))
in0Con15882 = tf.keras.layers.Input(shape=([6]))

Mul30598 = keras.layers.Multiply(name = 'Mul30598', )([in0Mul30598,in1Mul30598])
Res97416 = keras.layers.Reshape((2, 1, 2), name = 'Res97416', )(Mul30598)
Glo55702 = keras.layers.GlobalAveragePooling2D(name = 'Glo55702', )(Res97416)
Res82132 = keras.layers.Reshape((2, 1), name = 'Res82132', )(Glo55702)
Con28735 = keras.layers.Concatenate(axis=2, name = 'Con28735', )([Res82132,in0Con28735])
Min53695 = keras.layers.Minimum(name = 'Min53695', )([in0Min53695,in1Min53695])
Res45602 = keras.layers.Reshape((1, 2, 2), name = 'Res45602', )(Min53695)
Res11175 = keras.layers.Reshape((1, 4), name = 'Res11175', )(Res45602)
Min58583 = keras.layers.Minimum(name = 'Min58583', )([in0Min58583,in1Min58583])
Con90845 = keras.layers.Concatenate(axis=2, name = 'Con90845', )([Min58583,in0Con90845])
Add77262 = keras.layers.Add(name = 'Add77262', )([Res11175,Con90845])
Zer86348 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer86348', )(Add77262)
Min18731 = keras.layers.Minimum(name = 'Min18731', )([Con28735,Zer86348])
Fla81002 = keras.layers.Flatten(name = 'Fla81002', )(Min18731)
Add17136 = keras.layers.Add(name = 'Add17136', )([in0Add17136,in1Add17136])
Fla60843 = keras.layers.Flatten(name = 'Fla60843', )(Add17136)
Dot53113 = keras.layers.Dot(axes=(1, 1), name = 'Dot53113', )([in0Dot53113,in1Dot53113])
Con39779 = keras.layers.Concatenate(axis=1, name = 'Con39779', )([Dot53113,in0Con39779])
LST50719 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST50719', )(in0LST50719)
Sub13056 = keras.layers.Subtract(name = 'Sub13056', )([Con39779,LST50719])
Add57435 = keras.layers.Add(name = 'Add57435', )([in0Add57435,in1Add57435])
Res86421 = keras.layers.Reshape((1, 2, 1), name = 'Res86421', )(Add57435)
Res55894 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res55894', )(Res86421)
Glo40098 = keras.layers.GlobalAveragePooling3D(name = 'Glo40098', )(Res55894)
Con7418 = keras.layers.Concatenate(axis=1, name = 'Con7418', )([Glo40098,in0Con7418])
Add15252 = keras.layers.Add(name = 'Add15252', )([Sub13056,Con7418])
Min16781 = keras.layers.Minimum(name = 'Min16781', )([Fla60843,Add15252])
Con15882 = keras.layers.Concatenate(axis=1, name = 'Con15882', )([Min16781,in0Con15882])
Mul64449 = keras.layers.Multiply(name = 'Mul64449', )([Fla81002,Con15882])
model = tf.keras.models.Model(inputs=[in0Mul30598,in1Mul30598,in0Con28735,in0Min53695,in1Min53695,in0Min58583,in1Min58583,in0Con90845,in0Add17136,in1Add17136,in0Dot53113,in1Dot53113,in0Con39779,in0LST50719,in0Add57435,in1Add57435,in0Con7418,in0Con15882], outputs=Mul64449)
w = model.get_layer('LST50719').get_weights() 
w[0] = np.array([[9, 7, 2, 9, 6, 9, 2, 7]])
w[1] = np.array([[5, 2, 3, 10, 9, 10, 6, 5], [4, 5, 1, 1, 10, 2, 8, 6]])
w[2] = np.array([4, 9, 4, 7, 5, 6, 1, 10])
model.get_layer('LST50719').set_weights(w) 
in0Mul30598 = tf.constant([[[[[0.4278, 0.8378]]], [[[0.8369, 0.8375]]]]])
in1Mul30598 = tf.constant([[[[[0.4655, 0.8659]]], [[[0.6459, 0.0584]]]]])
in0Con28735 = tf.constant([[[0.7609, 0.659, 0.7673], [0.0561, 0.9905, 0.4688]]])
in0Min53695 = tf.constant([[[[[0.8673], [0.8618]], [[0.0725], [0.1092]]]]])
in1Min53695 = tf.constant([[[[[0.8403], [0.2833]], [[0.8114], [0.976]]]]])
in0Min58583 = tf.constant([[[0.4406, 0.3673]]])
in1Min58583 = tf.constant([[[0.1491, 0.9958]]])
in0Con90845 = tf.constant([[[0.9244, 0.6547]]])
in0Add17136 = tf.constant([[[0.8693], [0.346]]])
in1Add17136 = tf.constant([[[0.0248], [0.1023]]])
in0Dot53113 = tf.constant([[0.1078, 0.0139]])
in1Dot53113 = tf.constant([[0.1895, 0.4937]])
in0Con39779 = tf.constant([[0.5432]])
in0LST50719 = tf.constant([[[3], [7]]])
in0Add57435 = tf.constant([[[0.5451, 0.8834]]])
in1Add57435 = tf.constant([[[0.7363, 0.8382]]])
in0Con7418 = tf.constant([[0.2396]])
in0Con15882 = tf.constant([[0.087, 0.16, 0.1366, 0.3843, 0.7013, 0.0513]])
print (np.array2string(model.predict([in0Mul30598,in1Mul30598,in0Con28735,in0Min53695,in1Min53695,in0Min58583,in1Min58583,in0Con90845,in0Add17136,in1Add17136,in0Dot53113,in1Dot53113,in0Con39779,in0LST50719,in0Add57435,in1Add57435,in0Con7418,in0Con15882],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul64449.png')

LMul30598 = multiply_layer([[[[[[0.4278, 0.8378]]], [[[0.8369, 0.8375]]]]], [[[[[0.4655, 0.8659]]], [[[0.6459, 0.0584]]]]]], Mul30598), 
LRes97416 = reshape_layer(Mul30598, [2, 1, 2], Res97416), 
LGlo55702 = global_average_pooling2D_layer(Res97416, Glo55702), 
LRes82132 = reshape_layer(Glo55702, [2, 1], Res82132), 
LCon28735 = concatenate_layer([Res82132,[[[0.7609, 0.659, 0.7673], [0.0561, 0.9905, 0.4688]]]], 2, Con28735), 
LMin53695 = minimum_layer([[[[[[0.8673], [0.8618]], [[0.0725], [0.1092]]]]], [[[[[0.8403], [0.2833]], [[0.8114], [0.976]]]]]], Min53695), 
LRes45602 = reshape_layer(Min53695, [1, 2, 2], Res45602), 
LRes11175 = reshape_layer(Res45602, [1, 4], Res11175), 
LMin58583 = minimum_layer([[[[0.4406, 0.3673]]], [[[0.1491, 0.9958]]]], Min58583), 
LCon90845 = concatenate_layer([Min58583,[[[0.9244, 0.6547]]]], 2, Con90845), 
LAdd77262 = add_layer([Res11175,Con90845], Add77262), 
LZer86348 = zero_padding1D_layer(Add77262, 1, 0, Zer86348), 
LMin18731 = minimum_layer([Con28735,Zer86348], Min18731), 
LFla81002 = flatten_layer(Min18731, Fla81002), 
LAdd17136 = add_layer([[[[0.8693], [0.346]]], [[[0.0248], [0.1023]]]], Add17136), 
LFla60843 = flatten_layer(Add17136, Fla60843), 
LDot53113 = dot_layer([[0.1078, 0.0139]], [[0.1895, 0.4937]], 1, 1, Dot53113), 
LCon39779 = concatenate_layer([Dot53113,[[0.5432]]], 1, Con39779), 
LLST50719 = lstm_layer([[[3], [7]]],[[9, 7, 2, 9, 6, 9, 2, 7]],[[5, 2, 3, 10, 9, 10, 6, 5], [4, 5, 1, 1, 10, 2, 8, 6]],[4, 9, 4, 7, 5, 6, 1, 10], LST50719), 
LSub13056 = subtract_layer(Con39779,LST50719, Sub13056), 
LAdd57435 = add_layer([[[[0.5451, 0.8834]]], [[[0.7363, 0.8382]]]], Add57435), 
LRes86421 = reshape_layer(Add57435, [1, 2, 1], Res86421), 
LRes55894 = reshape_layer(Res86421, [1, 2, 1, 1], Res55894), 
LGlo40098 = global_average_pooling3D_layer(Res55894, Glo40098), 
LCon7418 = concatenate_layer([Glo40098,[[0.2396]]], 1, Con7418), 
LAdd15252 = add_layer([Sub13056,Con7418], Add15252), 
LMin16781 = minimum_layer([Fla60843,Add15252], Min16781), 
LCon15882 = concatenate_layer([Min16781,[[0.087, 0.16, 0.1366, 0.3843, 0.7013, 0.0513]]], 1, Con15882), 
LMul64449 = multiply_layer([Fla81002,Con15882], Mul64449), 
exec_layers([LMul30598,LRes97416,LGlo55702,LRes82132,LCon28735,LMin53695,LRes45602,LRes11175,LMin58583,LCon90845,LAdd77262,LZer86348,LMin18731,LFla81002,LAdd17136,LFla60843,LDot53113,LCon39779,LLST50719,LSub13056,LAdd57435,LRes86421,LRes55894,LGlo40098,LCon7418,LAdd15252,LMin16781,LCon15882,LMul64449],["Mul30598","Res97416","Glo55702","Res82132","Con28735","Min53695","Res45602","Res11175","Min58583","Con90845","Add77262","Zer86348","Min18731","Fla81002","Add17136","Fla60843","Dot53113","Con39779","LST50719","Sub13056","Add57435","Res86421","Res55894","Glo40098","Con7418","Add15252","Min16781","Con15882","Mul64449"],Mul64449,"Mul64449")

Actual (Unparsed): [[0.0000000, -0.0000000, 0.0000000, 0.0000000, 0.0528889, 0.0215592, 0.6946377, 0.0240494]]

Expected (Unparsed): [[0.0,-0.0,0.0,0.0,0.052888857665999996,0.02155923,0.6946376500000001,0.02404944]]

Actual:   [[0, -0, 0, 0, 0.0529, 0.0216, 0.6947, 0.0241]]

Expected: [[0, -0, 0, 0, 0.0529, 0.0216, 0.6947, 0.0241]]