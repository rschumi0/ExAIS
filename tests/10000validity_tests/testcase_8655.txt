import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min40130 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min40130 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Min25982 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Min25982 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con71143 = tf.keras.layers.Input(shape=([2, 3]))

Min40130 = keras.layers.Minimum(name = 'Min40130', )([in0Min40130,in1Min40130])
Res30702 = keras.layers.Reshape((1, 2, 2), name = 'Res30702', )(Min40130)
Res21514 = keras.layers.Reshape((1, 4), name = 'Res21514', )(Res30702)
Zer51634 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer51634', )(Res21514)
Min25982 = keras.layers.Minimum(name = 'Min25982', )([in0Min25982,in1Min25982])
Res86763 = keras.layers.Reshape((1, 2), name = 'Res86763', )(Min25982)
Per47398 = keras.layers.Permute((2,1), name = 'Per47398',)(Res86763)
Con71143 = keras.layers.Concatenate(axis=2, name = 'Con71143', )([Per47398,in0Con71143])
Max79996 = keras.layers.Maximum(name = 'Max79996', )([Zer51634,Con71143])
model = tf.keras.models.Model(inputs=[in0Min40130,in1Min40130,in0Min25982,in1Min25982,in0Con71143], outputs=Max79996)
in0Min40130 = tf.constant([[[[[0.4166, 0.7167]], [[0.1745, 0.7052]]]]])
in1Min40130 = tf.constant([[[[[0.0602, 0.1523]], [[0.6387, 0.8457]]]]])
in0Min25982 = tf.constant([[[[0.6813, 0.9911]]]])
in1Min25982 = tf.constant([[[[0.9936, 0.8059]]]])
in0Con71143 = tf.constant([[[0.0067, 0.2731, 0.2729], [0.0343, 0.3425, 0.9553]]])
print (np.array2string(model.predict([in0Min40130,in1Min40130,in0Min25982,in1Min25982,in0Con71143],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max79996.png')

LMin40130 = minimum_layer([[[[[[0.4166, 0.7167]], [[0.1745, 0.7052]]]]], [[[[[0.0602, 0.1523]], [[0.6387, 0.8457]]]]]], Min40130), 
LRes30702 = reshape_layer(Min40130, [1, 2, 2], Res30702), 
LRes21514 = reshape_layer(Res30702, [1, 4], Res21514), 
LZer51634 = zero_padding1D_layer(Res21514, 1, 0, Zer51634), 
LMin25982 = minimum_layer([[[[[0.6813, 0.9911]]]], [[[[0.9936, 0.8059]]]]], Min25982), 
LRes86763 = reshape_layer(Min25982, [1, 2], Res86763), 
LPer47398 = permute_layer(Res86763, 2,1, Per47398), 
LCon71143 = concatenate_layer([Per47398,[[[0.0067, 0.2731, 0.2729], [0.0343, 0.3425, 0.9553]]]], 2, Con71143), 
LMax79996 = maximum_layer([Zer51634,Con71143], Max79996), 
exec_layers([LMin40130,LRes30702,LRes21514,LZer51634,LMin25982,LRes86763,LPer47398,LCon71143,LMax79996],["Min40130","Res30702","Res21514","Zer51634","Min25982","Res86763","Per47398","Con71143","Max79996"],Max79996,"Max79996")

Actual (Unparsed): [[[0.6813000, 0.0067000, 0.2731000, 0.2729000], [0.8059000, 0.1523000, 0.3425000, 0.9553000]]]

Expected (Unparsed): [[[0.6813,0.0067,0.2731,0.2729],[0.8059,0.1523,0.3425,0.9553]]]

Actual:   [[[0.6813, 0.0067, 0.2731, 0.2729], [0.8059, 0.1523, 0.3425, 0.9553]]]

Expected: [[[0.6813, 0.0067, 0.2731, 0.2729], [0.8059, 0.1523, 0.3425, 0.9553]]]