import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave74279 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave74279 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Max70495 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Max70495 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Ave74279 = keras.layers.Average(name = 'Ave74279', )([in0Ave74279,in1Ave74279])
Res31301 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res31301', )(Ave74279)
Max70495 = keras.layers.Maximum(name = 'Max70495', )([in0Max70495,in1Max70495])
Zer72095 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer72095', )(Max70495)
Mul57003 = keras.layers.Multiply(name = 'Mul57003', )([Res31301,Zer72095])
Res89192 = keras.layers.Reshape((2, 2, 2), name = 'Res89192', )(Mul57003)
Res20422 = keras.layers.Reshape((2, 4), name = 'Res20422', )(Res89192)
Con6040 = keras.layers.Conv1D(2, (1),strides=(2), padding='valid', dilation_rate=(1), name = 'Con6040', )(Res20422)
model = tf.keras.models.Model(inputs=[in0Ave74279,in1Ave74279,in0Max70495,in1Max70495], outputs=Con6040)
w = model.get_layer('Con6040').get_weights() 
w[0] = np.array([[[0.5531, 0.4726], [0.6032, 0.8417], [0.472, 0.2769], [0.9947, 0.264]]])
w[1] = np.array([0, 0])
model.get_layer('Con6040').set_weights(w) 
in0Ave74279 = tf.constant([[[[0.0318, 0.2619], [0.1237, 0.2425]], [[0.4645, 0.3076], [0.5448, 0.0081]]]])
in1Ave74279 = tf.constant([[[[0.1123, 0.1655], [0.9099, 0.965]], [[0.47, 0.5211], [0.511, 0.1784]]]])
in0Max70495 = tf.constant([[[[[0.3091], [0.1491]], [[0.77], [0.5789]]]]])
in1Max70495 = tf.constant([[[[[0.16], [0.1542]], [[0.799], [0.261]]]]])
print (np.array2string(model.predict([in0Ave74279,in1Ave74279,in0Max70495,in1Max70495],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con6040.png')

LAve74279 = average_layer([[[[[0.0318, 0.2619], [0.1237, 0.2425]], [[0.4645, 0.3076], [0.5448, 0.0081]]]], [[[[0.1123, 0.1655], [0.9099, 0.965]], [[0.47, 0.5211], [0.511, 0.1784]]]]], Ave74279), 
LRes31301 = reshape_layer(Ave74279, [2, 2, 2, 1], Res31301), 
LMax70495 = maximum_layer([[[[[[0.3091], [0.1491]], [[0.77], [0.5789]]]]], [[[[[0.16], [0.1542]], [[0.799], [0.261]]]]]], Max70495), 
LZer72095 = zero_padding3D_layer(Max70495, 1, 0, 0, 0, 0, 0, Zer72095), 
LMul57003 = multiply_layer([Res31301,Zer72095], Mul57003), 
LRes89192 = reshape_layer(Mul57003, [2, 2, 2], Res89192), 
LRes20422 = reshape_layer(Res89192, [2, 4], Res20422), 
LCon6040 = conv1D_layer(Res20422, 1,[[[0.5531, 0.4726], [0.6032, 0.8417], [0.472, 0.2769], [0.9947, 0.264]]],[0, 0], 2, false, 1, Con6040), 
exec_layers([LAve74279,LRes31301,LMax70495,LZer72095,LMul57003,LRes89192,LRes20422,LCon6040],["Ave74279","Res31301","Max70495","Zer72095","Mul57003","Res89192","Res20422","Con6040"],Con6040,"Con6040")

Actual (Unparsed): [[[0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0]]]

Actual:   [[[0, 0]]]

Expected: [[[0, 0]]]