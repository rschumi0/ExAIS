import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min39150 = tf.keras.layers.Input(shape=([2, 2]))
in1Min39150 = tf.keras.layers.Input(shape=([2, 2]))
in0LST6687 = tf.keras.layers.Input(shape=([1, 1]))
in0Con20897 = tf.keras.layers.Input(shape=([2]))

Min39150 = keras.layers.Minimum(name = 'Min39150', )([in0Min39150,in1Min39150])
Fla60779 = keras.layers.Flatten(name = 'Fla60779', )(Min39150)
LST6687 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST6687', )(in0LST6687)
Con20897 = keras.layers.Concatenate(axis=1, name = 'Con20897', )([LST6687,in0Con20897])
Add22723 = keras.layers.Add(name = 'Add22723', )([Fla60779,Con20897])
Res90086 = keras.layers.Reshape((4, 1), name = 'Res90086', )(Add22723)
Res79825 = keras.layers.Reshape((4, 1, 1), name = 'Res79825', )(Res90086)
Cro39391 = keras.layers.Cropping2D(cropping=((3, 0), (0, 0)), name = 'Cro39391', )(Res79825)
Res93471 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res93471', )(Cro39391)
Glo73732 = keras.layers.GlobalAveragePooling3D(name = 'Glo73732', )(Res93471)
model = tf.keras.models.Model(inputs=[in0Min39150,in1Min39150,in0LST6687,in0Con20897], outputs=Glo73732)
w = model.get_layer('LST6687').get_weights() 
w[0] = np.array([[4, 5, 2, 8, 8, 5, 1, 10]])
w[1] = np.array([[7, 10, 7, 8, 3, 5, 8, 4], [8, 7, 10, 2, 9, 1, 6, 3]])
w[2] = np.array([4, 10, 3, 8, 6, 5, 8, 4])
model.get_layer('LST6687').set_weights(w) 
in0Min39150 = tf.constant([[[0.2277, 0.4247], [0.9816, 0.8642]]])
in1Min39150 = tf.constant([[[0.9539, 0.6694], [0.708, 0.0117]]])
in0LST6687 = tf.constant([[[7]]])
in0Con20897 = tf.constant([[0.48, 0.6163]])
print (np.array2string(model.predict([in0Min39150,in1Min39150,in0LST6687,in0Con20897],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo73732.png')

LMin39150 = minimum_layer([[[[0.2277, 0.4247], [0.9816, 0.8642]]], [[[0.9539, 0.6694], [0.708, 0.0117]]]], Min39150), 
LFla60779 = flatten_layer(Min39150, Fla60779), 
LLST6687 = lstm_layer([[[7]]],[[4, 5, 2, 8, 8, 5, 1, 10]],[[7, 10, 7, 8, 3, 5, 8, 4], [8, 7, 10, 2, 9, 1, 6, 3]],[4, 10, 3, 8, 6, 5, 8, 4], LST6687), 
LCon20897 = concatenate_layer([LST6687,[[0.48, 0.6163]]], 1, Con20897), 
LAdd22723 = add_layer([Fla60779,Con20897], Add22723), 
LRes90086 = reshape_layer(Add22723, [4, 1], Res90086), 
LRes79825 = reshape_layer(Res90086, [4, 1, 1], Res79825), 
LCro39391 = cropping2D_layer(Res79825, 3, 0, 0, 0, Cro39391), 
LRes93471 = reshape_layer(Cro39391, [1, 1, 1, 1], Res93471), 
LGlo73732 = global_average_pooling3D_layer(Res93471, Glo73732), 
exec_layers([LMin39150,LFla60779,LLST6687,LCon20897,LAdd22723,LRes90086,LRes79825,LCro39391,LRes93471,LGlo73732],["Min39150","Fla60779","LST6687","Con20897","Add22723","Res90086","Res79825","Cro39391","Res93471","Glo73732"],Glo73732,"Glo73732")

Actual (Unparsed): [[0.6280000]]

Expected (Unparsed): [[0.628]]

Actual:   [[0.628]]

Expected: [[0.628]]