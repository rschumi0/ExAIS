import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof91554 = tf.keras.layers.Input(shape=([2, 2, 2]))

Sof91554 = keras.layers.Softmax(axis=1, name = 'Sof91554', input_shape=(2, 2, 2))(in0Sof91554)
Res31928 = keras.layers.Reshape((2, 4), name = 'Res31928', )(Sof91554)
Max29956 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max29956', )(Res31928)
Fla69529 = keras.layers.Flatten(name = 'Fla69529', )(Max29956)
model = tf.keras.models.Model(inputs=[in0Sof91554], outputs=Fla69529)
in0Sof91554 = tf.constant([[[[0.3294, 0.8779], [0.4215, 0.8669]], [[0.8752, 0.0939], [0.4303, 0.5409]]]])
print (np.array2string(model.predict([in0Sof91554],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla69529.png')

LSof91554 = softmax_layer([[[[0.3294, 0.8779], [0.4215, 0.8669]], [[0.8752, 0.0939], [0.4303, 0.5409]]]], 1, Sof91554), 
LRes31928 = reshape_layer(Sof91554, [2, 4], Res31928), 
LMax29956 = max_pool1D_layer(Res31928, 2, Max29956), 
LFla69529 = flatten_layer(Max29956, Fla69529), 
exec_layers([LSof91554,LRes31928,LMax29956,LFla69529],["Sof91554","Res31928","Max29956","Fla69529"],Fla69529,"Fla69529")

Actual (Unparsed): [[0.6331606, 0.6865416, 0.5022000, 0.5807858]]

Expected (Unparsed): [[0.6331606110685339,0.6865415645538111,0.5021999858027766,0.5807857981259906]]

Actual:   [[0.6332, 0.6866, 0.5022, 0.5808]]

Expected: [[0.6332, 0.6866, 0.5022, 0.5808]]