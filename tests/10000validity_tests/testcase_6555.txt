import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add36234 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add36234 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con67883 = tf.keras.layers.Input(shape=([1]))
in0Sub3702 = tf.keras.layers.Input(shape=([2]))
in1Sub3702 = tf.keras.layers.Input(shape=([2]))
in0Con81637 = tf.keras.layers.Input(shape=([2, 1, 3]))
in0Sub29929 = tf.keras.layers.Input(shape=([3, 2, 2, 2]))
in1Sub29929 = tf.keras.layers.Input(shape=([3, 2, 2, 2]))

Add36234 = keras.layers.Add(name = 'Add36234', )([in0Add36234,in1Add36234])
Res47629 = keras.layers.Reshape((1, 1), name = 'Res47629', )(Add36234)
Glo54982 = keras.layers.GlobalMaxPool1D(name = 'Glo54982', )(Res47629)
Con67883 = keras.layers.Concatenate(axis=1, name = 'Con67883', )([Glo54982,in0Con67883])
Sub3702 = keras.layers.Subtract(name = 'Sub3702', )([in0Sub3702,in1Sub3702])
Dot92446 = keras.layers.Dot(axes=(1, 1), name = 'Dot92446', )([Con67883,Sub3702])
Res42202 = keras.layers.Reshape((1, 1), name = 'Res42202', )(Dot92446)
Res14989 = keras.layers.Reshape((1, 1, 1), name = 'Res14989', )(Res42202)
Zer19785 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer19785', )(Res14989)
Con81637 = keras.layers.Concatenate(axis=3, name = 'Con81637', )([Zer19785,in0Con81637])
Sub29929 = keras.layers.Subtract(name = 'Sub29929', )([in0Sub29929,in1Sub29929])
Res2630 = keras.layers.Reshape((3, 2, 4), name = 'Res2630', )(Sub29929)
Dep603 = keras.layers.DepthwiseConv2D((2, 2),strides=(1, 1), padding='valid', name = 'Dep603', )(Res2630)
Sub34779 = keras.layers.Subtract(name = 'Sub34779', )([Con81637,Dep603])
model = tf.keras.models.Model(inputs=[in0Add36234,in1Add36234,in0Con67883,in0Sub3702,in1Sub3702,in0Con81637,in0Sub29929,in1Sub29929], outputs=Sub34779)
w = model.get_layer('Dep603').get_weights() 
w[0] = np.array([[[[0.8786], [0.2533], [0.6477], [0.2431]], [[0.8707], [0.1326], [0.4654], [0.7375]]], [[[0.5239], [0.923], [0.5713], [0.1784]], [[0.8567], [0.694], [0.799], [0.9013]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Dep603').set_weights(w) 
in0Add36234 = tf.constant([[[[0.8697]]]])
in1Add36234 = tf.constant([[[[0.6051]]]])
in0Con67883 = tf.constant([[0.7384]])
in0Sub3702 = tf.constant([[0.9822, 0.101]])
in1Sub3702 = tf.constant([[0.5393, 0.4654]])
in0Con81637 = tf.constant([[[[0.1026, 0.1408, 0.8026]], [[0.7989, 0.4857, 0.5856]]]])
in0Sub29929 = tf.constant([[[[[0.3678, 0.9898], [0.2196, 0.4973]], [[0.4752, 0.1385], [0.3642, 0.7568]]], [[[0.0745, 0.5509], [0.9088, 0.7102]], [[0.0235, 0.0457], [0.0577, 0.4781]]], [[[0.5772, 0.9337], [0.0497, 0.6211]], [[0.5221, 0.4498], [0.1446, 0.1697]]]]])
in1Sub29929 = tf.constant([[[[[0.6972, 0.5772], [0.7185, 0.292]], [[0.2507, 0.3543], [0.5372, 0.4583]]], [[[0.8039, 0.492], [0.9878, 0.2177]], [[0.5471, 0.1454], [0.296, 0.7296]]], [[[0.1739, 0.9801], [0.5244, 0.0098]], [[0.4779, 0.2542], [0.4586, 0.4428]]]]])
print (np.array2string(model.predict([in0Add36234,in1Add36234,in0Con67883,in0Sub3702,in1Sub3702,in0Con81637,in0Sub29929,in1Sub29929],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub34779.png')

LAdd36234 = add_layer([[[[[0.8697]]]], [[[[0.6051]]]]], Add36234), 
LRes47629 = reshape_layer(Add36234, [1, 1], Res47629), 
LGlo54982 = global_max_pool1D_layer(Res47629, Glo54982), 
LCon67883 = concatenate_layer([Glo54982,[[0.7384]]], 1, Con67883), 
LSub3702 = subtract_layer([[0.9822, 0.101]], [[0.5393, 0.4654]], Sub3702), 
LDot92446 = dot_layer(Con67883,Sub3702, 1, 1, Dot92446), 
LRes42202 = reshape_layer(Dot92446, [1, 1], Res42202), 
LRes14989 = reshape_layer(Res42202, [1, 1, 1], Res14989), 
LZer19785 = zero_padding2D_layer(Res14989, 1, 0, 0, 0, Zer19785), 
LCon81637 = concatenate_layer([Zer19785,[[[[0.1026, 0.1408, 0.8026]], [[0.7989, 0.4857, 0.5856]]]]], 3, Con81637), 
LSub29929 = subtract_layer([[[[[0.3678, 0.9898], [0.2196, 0.4973]], [[0.4752, 0.1385], [0.3642, 0.7568]]], [[[0.0745, 0.5509], [0.9088, 0.7102]], [[0.0235, 0.0457], [0.0577, 0.4781]]], [[[0.5772, 0.9337], [0.0497, 0.6211]], [[0.5221, 0.4498], [0.1446, 0.1697]]]]], [[[[[0.6972, 0.5772], [0.7185, 0.292]], [[0.2507, 0.3543], [0.5372, 0.4583]]], [[[0.8039, 0.492], [0.9878, 0.2177]], [[0.5471, 0.1454], [0.296, 0.7296]]], [[[0.1739, 0.9801], [0.5244, 0.0098]], [[0.4779, 0.2542], [0.4586, 0.4428]]]]], Sub29929), 
LRes2630 = reshape_layer(Sub29929, [3, 2, 4], Res2630), 
LDep603 = depthwise_conv2D_layer(Res2630, 2, 2,[[[[0.8786], [0.2533], [0.6477], [0.2431]], [[0.8707], [0.1326], [0.4654], [0.7375]]], [[[0.5239], [0.923], [0.5713], [0.1784]], [[0.8567], [0.694], [0.799], [0.9013]]]],[0, 0, 0, 0], 1, 1, false, Dep603), 
LSub34779 = subtract_layer(Con81637,Dep603, Sub34779), 
exec_layers([LAdd36234,LRes47629,LGlo54982,LCon67883,LSub3702,LDot92446,LRes42202,LRes14989,LZer19785,LCon81637,LSub29929,LRes2630,LDep603,LSub34779],["Add36234","Res47629","Glo54982","Con67883","Sub3702","Dot92446","Res42202","Res14989","Zer19785","Con81637","Sub29929","Res2630","Dep603","Sub34779"],Sub34779,"Sub34779")

Actual (Unparsed): [[[[0.9246395, 0.0415306, 0.7799861, 0.6713628]], [[1.2317103, 0.7042816, 1.1698552, 0.7884436]]]]

Expected (Unparsed): [[[[0.92463947,0.0415306,0.7799861299999999,0.6713627699999999]],[[1.23171031,0.7042816500000001,1.16985523,0.7884436100000001]]]]

Actual:   [[[[0.9247, 0.0416, 0.78, 0.6714]], [[1.2318, 0.7043, 1.1699, 0.7885]]]]

Expected: [[[[0.9247, 0.0416, 0.78, 0.6714]], [[1.2318, 0.7043, 1.1699, 0.7885]]]]