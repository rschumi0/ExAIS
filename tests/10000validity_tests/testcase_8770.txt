import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe86516 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con68007 = tf.keras.layers.Input(shape=([1, 2]))
in0Con74786 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Ave42648 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Ave42648 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

PRe86516 = keras.layers.PReLU(name = 'PRe86516', input_shape=(1, 1, 1))(in0PRe86516)
Res58436 = keras.layers.Reshape((1, 1), name = 'Res58436', )(PRe86516)
Max75440 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max75440', )(Res58436)
Con68007 = keras.layers.Concatenate(axis=2, name = 'Con68007', )([Max75440,in0Con68007])
Con74786 = keras.layers.Conv2D(3, (1, 1),strides=(5, 2), padding='valid', dilation_rate=(1, 1), name = 'Con74786', )(in0Con74786)
Res66826 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res66826', )(Con74786)
Zer38377 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer38377', )(Res66826)
Ave42648 = keras.layers.Average(name = 'Ave42648', )([in0Ave42648,in1Ave42648])
Zer88647 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer88647', )(Ave42648)
Add33222 = keras.layers.Add(name = 'Add33222', )([Zer38377,Zer88647])
Res69309 = keras.layers.Reshape((1, 2, 4), name = 'Res69309', )(Add33222)
Res13808 = keras.layers.Reshape((1, 8), name = 'Res13808', )(Res69309)
Sep67132 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep67132', )(Res13808)
Ave71881 = keras.layers.Average(name = 'Ave71881', )([Con68007,Sep67132])
model = tf.keras.models.Model(inputs=[in0PRe86516,in0Con68007,in0Con74786,in0Ave42648,in1Ave42648], outputs=Ave71881)
w = model.get_layer('PRe86516').get_weights() 
w[0] = np.array([[[0.4029]]])
model.get_layer('PRe86516').set_weights(w) 
w = model.get_layer('Con74786').get_weights() 
w[0] = np.array([[[[0.3474, 0.6932, 0.6217], [0.7605, 0.3902, 0.0249]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con74786').set_weights(w) 
w = model.get_layer('Sep67132').get_weights() 
w[0] = np.array([[[0.3956], [0.6861], [0.5821], [0.335], [0.3776], [0.622], [0.2333], [0.8815]]])
w[1] = np.array([[[0.5006, 0.2236, 0.3707], [0.1656, 0.9105, 0.9597], [0.7522, 0.2771, 0.1377], [0.6655, 0.7677, 0.8027], [0.8585, 0.3156, 0.3814], [0.51, 0.4675, 0.9764], [0.8807, 0.6806, 0.3884], [0.0712, 0.286, 0.2287]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep67132').set_weights(w) 
in0PRe86516 = tf.constant([[[[0.7034]]]])
in0Con68007 = tf.constant([[[0.3831, 0.6087]]])
in0Con74786 = tf.constant([[[[0.4409, 0.2784], [0.188, 0.2892]]]])
in0Ave42648 = tf.constant([[[[[0.2933], [0.1605]], [[0.231], [0.8301]]]]])
in1Ave42648 = tf.constant([[[[[0.5463], [0.6549]], [[0.0608], [0.125]]]]])
print (np.array2string(model.predict([in0PRe86516,in0Con68007,in0Con74786,in0Ave42648,in1Ave42648],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave71881.png')

LPRe86516 = prelu_layer([[[[0.7034]]]], [[[0.4029]]], PRe86516), 
LRes58436 = reshape_layer(PRe86516, [1, 1], Res58436), 
LMax75440 = max_pool1D_layer(Res58436, 1, Max75440), 
LCon68007 = concatenate_layer([Max75440,[[[0.3831, 0.6087]]]], 2, Con68007), 
LCon74786 = conv2D_layer([[[[0.4409, 0.2784], [0.188, 0.2892]]]], 1, 1,[[[[0.3474, 0.6932, 0.6217], [0.7605, 0.3902, 0.0249]]]],[0, 0, 0], 5, 2, false, 1, 1, Con74786), 
LRes66826 = reshape_layer(Con74786, [1, 1, 3, 1], Res66826), 
LZer38377 = zero_padding3D_layer(Res66826, 0, 0, 1, 0, 1, 0, Zer38377), 
LAve42648 = average_layer([[[[[[0.2933], [0.1605]], [[0.231], [0.8301]]]]], [[[[[0.5463], [0.6549]], [[0.0608], [0.125]]]]]], Ave42648), 
LZer88647 = zero_padding3D_layer(Ave42648, 0, 0, 0, 0, 2, 0, Zer88647), 
LAdd33222 = add_layer([Zer38377,Zer88647], Add33222), 
LRes69309 = reshape_layer(Add33222, [1, 2, 4], Res69309), 
LRes13808 = reshape_layer(Res69309, [1, 8], Res13808), 
LSep67132 = separable_conv1D_layer(Res13808, 1,[[[[0.3956], [0.6861], [0.5821], [0.335], [0.3776], [0.622], [0.2333], [0.8815]]],[[[0.5006, 0.2236, 0.3707], [0.1656, 0.9105, 0.9597], [0.7522, 0.2771, 0.1377], [0.6655, 0.7677, 0.8027], [0.8585, 0.3156, 0.3814], [0.51, 0.4675, 0.9764], [0.8807, 0.6806, 0.3884], [0.0712, 0.286, 0.2287]]]],[0, 0, 0], 1, false, Sep67132), 
LAve71881 = average_layer([Con68007,Sep67132], Ave71881), 
exec_layers([LPRe86516,LRes58436,LMax75440,LCon68007,LCon74786,LRes66826,LZer38377,LAve42648,LZer88647,LAdd33222,LRes69309,LRes13808,LSep67132,LAve71881],["PRe86516","Res58436","Max75440","Con68007","Con74786","Res66826","Zer38377","Ave42648","Zer88647","Add33222","Res69309","Res13808","Sep67132","Ave71881"],Ave71881,"Ave71881")

Actual (Unparsed): [[[0.6282815, 0.4709816, 0.5886387]]]

Expected (Unparsed): [[[0.6282814775919778,0.4709815757710394,0.5886386930842629]]]

Actual:   [[[0.6283, 0.471, 0.5887]]]

Expected: [[[0.6283, 0.471, 0.5887]]]