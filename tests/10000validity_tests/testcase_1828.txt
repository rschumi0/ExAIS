import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min7951 = tf.keras.layers.Input(shape=([1, 1]))
in1Min7951 = tf.keras.layers.Input(shape=([1, 1]))
in0Con1335 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Min42803 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Min42803 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Min7951 = keras.layers.Minimum(name = 'Min7951', )([in0Min7951,in1Min7951])
Res47449 = keras.layers.Reshape((1, 1, 1), name = 'Res47449', )(Min7951)
Res71488 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res71488', )(Res47449)
Zer77987 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer77987', )(Res71488)
Con1335 = keras.layers.Concatenate(axis=4, name = 'Con1335', )([Zer77987,in0Con1335])
Min42803 = keras.layers.Minimum(name = 'Min42803', )([in0Min42803,in1Min42803])
Ave83402 = keras.layers.Average(name = 'Ave83402', )([Con1335,Min42803])
model = tf.keras.models.Model(inputs=[in0Min7951,in1Min7951,in0Con1335,in0Min42803,in1Min42803], outputs=Ave83402)
in0Min7951 = tf.constant([[[0.6624]]])
in1Min7951 = tf.constant([[[0.0642]]])
in0Con1335 = tf.constant([[[[[0.2823]], [[0.622]]], [[[0.2342]], [[0.2589]]]]])
in0Min42803 = tf.constant([[[[[0.814, 0.0587]], [[0.1933, 0.1637]]], [[[0.7223, 0.7887]], [[0.8113, 0.842]]]]])
in1Min42803 = tf.constant([[[[[0.7088, 0.0221]], [[0.4713, 0.5177]]], [[[0.5242, 0.1253]], [[0.8969, 0.8323]]]]])
print (np.array2string(model.predict([in0Min7951,in1Min7951,in0Con1335,in0Min42803,in1Min42803],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave83402.png')

LMin7951 = minimum_layer([[[[0.6624]]], [[[0.0642]]]], Min7951), 
LRes47449 = reshape_layer(Min7951, [1, 1, 1], Res47449), 
LRes71488 = reshape_layer(Res47449, [1, 1, 1, 1], Res71488), 
LZer77987 = zero_padding3D_layer(Res71488, 1, 0, 1, 0, 0, 0, Zer77987), 
LCon1335 = concatenate_layer([Zer77987,[[[[[0.2823]], [[0.622]]], [[[0.2342]], [[0.2589]]]]]], 4, Con1335), 
LMin42803 = minimum_layer([[[[[[0.814, 0.0587]], [[0.1933, 0.1637]]], [[[0.7223, 0.7887]], [[0.8113, 0.842]]]]], [[[[[0.7088, 0.0221]], [[0.4713, 0.5177]]], [[[0.5242, 0.1253]], [[0.8969, 0.8323]]]]]], Min42803), 
LAve83402 = average_layer([Con1335,Min42803], Ave83402), 
exec_layers([LMin7951,LRes47449,LRes71488,LZer77987,LCon1335,LMin42803,LAve83402],["Min7951","Res47449","Res71488","Zer77987","Con1335","Min42803","Ave83402"],Ave83402,"Ave83402")

Actual (Unparsed): [[[[[0.3544000, 0.1522000]], [[0.0966500, 0.3928500]]], [[[0.2621000, 0.1797500]], [[0.4377500, 0.5456000]]]]]

Expected (Unparsed): [[[[[0.3544,0.1522]],[[0.09665,0.39285000000000003]]],[[[0.2621,0.17975]],[[0.43775000000000003,0.5456000000000001]]]]]

Actual:   [[[[[0.3544, 0.1522]], [[0.0967, 0.3929]]], [[[0.2621, 0.1798]], [[0.4378, 0.5456]]]]]

Expected: [[[[[0.3544, 0.1522]], [[0.0967, 0.3929]]], [[[0.2621, 0.1798]], [[0.4378, 0.5457]]]]]