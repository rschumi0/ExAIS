import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max13941 = tf.keras.layers.Input(shape=([2, 2]))
in1Max13941 = tf.keras.layers.Input(shape=([2, 2]))
in0Con70234 = tf.keras.layers.Input(shape=([3, 1]))
in0Dot75553 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot75553 = tf.keras.layers.Input(shape=([2, 3]))

Max13941 = keras.layers.Maximum(name = 'Max13941', )([in0Max13941,in1Max13941])
Zer58769 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer58769', )(Max13941)
Con70234 = keras.layers.Concatenate(axis=2, name = 'Con70234', )([Zer58769,in0Con70234])
Dot75553 = keras.layers.Dot(axes=(1, 1), name = 'Dot75553', )([in0Dot75553,in1Dot75553])
Ave82965 = keras.layers.Average(name = 'Ave82965', )([Con70234,Dot75553])
Den84818 = keras.layers.Dense(3,name = 'Den84818', )(Ave82965)
model = tf.keras.models.Model(inputs=[in0Max13941,in1Max13941,in0Con70234,in0Dot75553,in1Dot75553], outputs=Den84818)
w = model.get_layer('Den84818').get_weights() 
w[0] = np.array([[0.0718, 0.3574, 0.2294], [0.2338, 0.9521, 0.0097], [0.7366, 0.6167, 0.7516]])
w[1] = np.array([0.6599, 0.6713, 0.0615])
model.get_layer('Den84818').set_weights(w) 
in0Max13941 = tf.constant([[[0.6011, 0.2935], [0.2086, 0.6942]]])
in1Max13941 = tf.constant([[[0.8203, 0.5612], [0.7183, 0.471]]])
in0Con70234 = tf.constant([[[0.7048], [0.2794], [0.4316]]])
in0Dot75553 = tf.constant([[[0.9983, 0.2658, 0.6061], [0.2816, 0.1295, 0.4462]]])
in1Dot75553 = tf.constant([[[0.5914, 0.3307, 0.4119], [0.0945, 0.5207, 0.5818]]])
print (np.array2string(model.predict([in0Max13941,in1Max13941,in0Con70234,in0Dot75553,in1Dot75553],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den84818.png')

LMax13941 = maximum_layer([[[[0.6011, 0.2935], [0.2086, 0.6942]]], [[[0.8203, 0.5612], [0.7183, 0.471]]]], Max13941), 
LZer58769 = zero_padding1D_layer(Max13941, 1, 0, Zer58769), 
LCon70234 = concatenate_layer([Zer58769,[[[0.7048], [0.2794], [0.4316]]]], 2, Con70234), 
LDot75553 = dot_layer([[[0.9983, 0.2658, 0.6061], [0.2816, 0.1295, 0.4462]]], [[[0.5914, 0.3307, 0.4119], [0.0945, 0.5207, 0.5818]]], 1, 1, Dot75553), 
LAve82965 = average_layer([Con70234,Dot75553], Ave82965), 
LDen84818 = dense_layer(Ave82965, [[0.0718, 0.3574, 0.2294], [0.2338, 0.9521, 0.0097], [0.7366, 0.6167, 0.7516]],[0.6599, 0.6713, 0.0615], Den84818), 
exec_layers([LMax13941,LZer58769,LCon70234,LDot75553,LAve82965,LDen84818],["Max13941","Zer58769","Con70234","Dot75553","Ave82965","Den84818"],Den84818,"Den84818")

Actual (Unparsed): [[[1.2091477, 1.4031609, 0.6155448], [0.9501683, 1.3324137, 0.3529536], [1.1783279, 1.6978573, 0.5488773]]]

Expected (Unparsed): [[[1.2091476646500001,1.4031608513879998,0.6155447486345],[0.9501682941280001,1.3324136537665,0.35295359532849996],[1.1783279070300001,1.697857255881,0.5488772812265]]]

Actual:   [[[1.2092, 1.4032, 0.6156], [0.9502, 1.3325, 0.353], [1.1784, 1.6979, 0.5489]]]

Expected: [[[1.2092, 1.4032, 0.6156], [0.9502, 1.3325, 0.353], [1.1784, 1.6979, 0.5489]]]