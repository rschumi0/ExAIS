import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add4306 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Add4306 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Add4306 = keras.layers.Add(name = 'Add4306', )([in0Add4306,in1Add4306])
Con73151 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con73151', )(Add4306)
Res96598 = keras.layers.Reshape((2, 2, 4), name = 'Res96598', )(Con73151)
Res12628 = keras.layers.Reshape((2, 8), name = 'Res12628', )(Res96598)
Cro82610 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro82610', )(Res12628)
model = tf.keras.models.Model(inputs=[in0Add4306,in1Add4306], outputs=Cro82610)
w = model.get_layer('Con73151').get_weights() 
w[0] = np.array([[[[[0.8609, 0.4998, 0.0739, 0.8935]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con73151').set_weights(w) 
in0Add4306 = tf.constant([[[[[0.7573]], [[0.2289]]], [[[0.0127]], [[0.2364]]]]])
in1Add4306 = tf.constant([[[[[0.863]], [[0.061]]], [[[0.3971]], [[0.4582]]]]])
print (np.array2string(model.predict([in0Add4306,in1Add4306],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro82610.png')

LAdd4306 = add_layer([[[[[[0.7573]], [[0.2289]]], [[[0.0127]], [[0.2364]]]]], [[[[[0.863]], [[0.061]]], [[[0.3971]], [[0.4582]]]]]], Add4306), 
LCon73151 = conv3D_layer(Add4306, 1, 1, 1,[[[[[0.8609, 0.4998, 0.0739, 0.8935]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con73151), 
LRes96598 = reshape_layer(Con73151, [2, 2, 4], Res96598), 
LRes12628 = reshape_layer(Res96598, [2, 8], Res12628), 
LCro82610 = cropping1D_layer(Res12628, 0, 1, Cro82610), 
exec_layers([LAdd4306,LCon73151,LRes96598,LRes12628,LCro82610],["Add4306","Con73151","Res96598","Res12628","Cro82610"],Cro82610,"Cro82610")

Actual (Unparsed): [[[1.3949163, 0.8098259, 0.1197402, 1.4477380, 0.2495749, 0.1448920, 0.0214236, 0.2590257]]]

Expected (Unparsed): [[[1.39491627,0.80982594,0.11974016999999998,1.4477380499999999,0.24957490999999998,0.14489202,0.021423609999999996,0.25902565]]]

Actual:   [[[1.395, 0.8099, 0.1198, 1.4478, 0.2496, 0.1449, 0.0215, 0.2591]]]

Expected: [[[1.395, 0.8099, 0.1198, 1.4478, 0.2496, 0.1449, 0.0215, 0.2591]]]