import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con2176 = tf.keras.layers.Input(shape=([2, 2]))
in0Con89576 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot52186 = tf.keras.layers.Input(shape=([2]))
in1Dot52186 = tf.keras.layers.Input(shape=([2]))

Con2176 = keras.layers.Conv1D(2, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con2176', )(in0Con2176)
Con89576 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con89576', )(in0Con89576)
Den43263 = keras.layers.Dense(2,name = 'Den43263', )(Con89576)
Dot39771 = keras.layers.Dot(axes=(2, 2), name = 'Dot39771', )([Con2176,Den43263])
Fla37799 = keras.layers.Flatten(name = 'Fla37799', )(Dot39771)
Dot52186 = keras.layers.Dot(axes=(1, 1), name = 'Dot52186', )([in0Dot52186,in1Dot52186])
Min8862 = keras.layers.Minimum(name = 'Min8862', )([Fla37799,Dot52186])
model = tf.keras.models.Model(inputs=[in0Con2176,in0Con89576,in0Dot52186,in1Dot52186], outputs=Min8862)
w = model.get_layer('Con2176').get_weights() 
w[0] = np.array([[[0.3904, 0.1666], [0.9441, 0.3529]], [[0.7083, 0.5654], [0.5749, 0.2532]]])
w[1] = np.array([0, 0])
model.get_layer('Con2176').set_weights(w) 
w = model.get_layer('Con89576').get_weights() 
w[0] = np.array([[[0.3308, 0.1794, 0.2458]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con89576').set_weights(w) 
w = model.get_layer('Den43263').get_weights() 
w[0] = np.array([[0.3458, 0.5792], [0.3868, 0.4837], [0.2037, 0.2986]])
w[1] = np.array([0.7748, 0.064])
model.get_layer('Den43263').set_weights(w) 
in0Con2176 = tf.constant([[[0.3997, 0.6388], [0.5014, 0.8322]]])
in0Con89576 = tf.constant([[[0.8094]]])
in0Dot52186 = tf.constant([[0.6911, 0.5937]])
in1Dot52186 = tf.constant([[0.5367, 0.4589]])
print (np.array2string(model.predict([in0Con2176,in0Con89576,in0Dot52186,in1Dot52186],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min8862.png')

LCon2176 = conv1D_layer([[[0.3997, 0.6388], [0.5014, 0.8322]]], 2,[[[0.3904, 0.1666], [0.9441, 0.3529]], [[0.7083, 0.5654], [0.5749, 0.2532]]],[0, 0], 1, false, 1, Con2176), 
LCon89576 = conv1D_layer([[[0.8094]]], 1,[[[0.3308, 0.1794, 0.2458]]],[0, 0, 0], 1, true, 1, Con89576), 
LDen43263 = dense_layer(Con89576, [[0.3458, 0.5792], [0.3868, 0.4837], [0.2037, 0.2986]],[0.7748, 0.064], Den43263), 
LDot39771 = dot_layer(Con2176,Den43263, 2, 2, Dot39771), 
LFla37799 = flatten_layer(Dot39771, Fla37799), 
LDot52186 = dot_layer([[0.6911, 0.5937]], [[0.5367, 0.4589]], 1, 1, Dot52186), 
LMin8862 = minimum_layer([Fla37799,Dot52186], Min8862), 
exec_layers([LCon2176,LCon89576,LDen43263,LDot39771,LFla37799,LDot52186,LMin8862],["Con2176","Con89576","Den43263","Dot39771","Fla37799","Dot52186","Min8862"],Min8862,"Min8862")

Actual (Unparsed): [[0.6433623]]

Expected (Unparsed): [[0.6433622999999999]]

Actual:   [[0.6434]]

Expected: [[0.6434]]