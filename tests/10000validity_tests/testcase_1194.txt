import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot22087 = tf.keras.layers.Input(shape=([2]))
in1Dot22087 = tf.keras.layers.Input(shape=([2]))
in0Mul49149 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Mul49149 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con43682 = tf.keras.layers.Input(shape=([3]))

Dot22087 = keras.layers.Dot(axes=(1, 1), name = 'Dot22087', )([in0Dot22087,in1Dot22087])
Res93956 = keras.layers.Reshape((1, 1), name = 'Res93956', )(Dot22087)
Res34029 = keras.layers.Reshape((1, 1, 1), name = 'Res34029', )(Res93956)
Res13890 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res13890', )(Res34029)
Con19925 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con19925', )(Res13890)
Res45322 = keras.layers.Reshape((1, 1, 4), name = 'Res45322', )(Con19925)
Res83862 = keras.layers.Reshape((1, 4), name = 'Res83862', )(Res45322)
Fla55675 = keras.layers.Flatten(name = 'Fla55675', )(Res83862)
Mul49149 = keras.layers.Multiply(name = 'Mul49149', )([in0Mul49149,in1Mul49149])
Fla12804 = keras.layers.Flatten(name = 'Fla12804', )(Mul49149)
Con43682 = keras.layers.Concatenate(axis=1, name = 'Con43682', )([Fla12804,in0Con43682])
Max79834 = keras.layers.Maximum(name = 'Max79834', )([Fla55675,Con43682])
Res79749 = keras.layers.Reshape((4, 1), name = 'Res79749', )(Max79834)
Res24266 = keras.layers.Reshape((4, 1, 1), name = 'Res24266', )(Res79749)
Dep99516 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep99516', )(Res24266)
Res85327 = keras.layers.Reshape((4, 1), name = 'Res85327', )(Dep99516)
Zer14667 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer14667', )(Res85327)
model = tf.keras.models.Model(inputs=[in0Dot22087,in1Dot22087,in0Mul49149,in1Mul49149,in0Con43682], outputs=Zer14667)
w = model.get_layer('Con19925').get_weights() 
w[0] = np.array([[[[[0.2052, 0.3228, 0.3044, 0.6075]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con19925').set_weights(w) 
w = model.get_layer('Dep99516').get_weights() 
w[0] = np.array([[[[0.8595]]]])
w[1] = np.array([0])
model.get_layer('Dep99516').set_weights(w) 
in0Dot22087 = tf.constant([[0.6998, 0.2547]])
in1Dot22087 = tf.constant([[0.1469, 0.5054]])
in0Mul49149 = tf.constant([[[[0.6011]]]])
in1Mul49149 = tf.constant([[[[0.0725]]]])
in0Con43682 = tf.constant([[0.5887, 0.1908, 0.3132]])
print (np.array2string(model.predict([in0Dot22087,in1Dot22087,in0Mul49149,in1Mul49149,in0Con43682],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer14667.png')

LDot22087 = dot_layer([[0.6998, 0.2547]], [[0.1469, 0.5054]], 1, 1, Dot22087), 
LRes93956 = reshape_layer(Dot22087, [1, 1], Res93956), 
LRes34029 = reshape_layer(Res93956, [1, 1, 1], Res34029), 
LRes13890 = reshape_layer(Res34029, [1, 1, 1, 1], Res13890), 
LCon19925 = conv3D_layer(Res13890, 1, 1, 1,[[[[[0.2052, 0.3228, 0.3044, 0.6075]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con19925), 
LRes45322 = reshape_layer(Con19925, [1, 1, 4], Res45322), 
LRes83862 = reshape_layer(Res45322, [1, 4], Res83862), 
LFla55675 = flatten_layer(Res83862, Fla55675), 
LMul49149 = multiply_layer([[[[[0.6011]]]], [[[[0.0725]]]]], Mul49149), 
LFla12804 = flatten_layer(Mul49149, Fla12804), 
LCon43682 = concatenate_layer([Fla12804,[[0.5887, 0.1908, 0.3132]]], 1, Con43682), 
LMax79834 = maximum_layer([Fla55675,Con43682], Max79834), 
LRes79749 = reshape_layer(Max79834, [4, 1], Res79749), 
LRes24266 = reshape_layer(Res79749, [4, 1, 1], Res24266), 
LDep99516 = depthwise_conv2D_layer(Res24266, 1, 1,[[[[0.8595]]]],[0], 1, 1, false, Dep99516), 
LRes85327 = reshape_layer(Dep99516, [4, 1], Res85327), 
LZer14667 = zero_padding1D_layer(Res85327, 1, 1, Zer14667), 
exec_layers([LDot22087,LRes93956,LRes34029,LRes13890,LCon19925,LRes45322,LRes83862,LFla55675,LMul49149,LFla12804,LCon43682,LMax79834,LRes79749,LRes24266,LDep99516,LRes85327,LZer14667],["Dot22087","Res93956","Res34029","Res13890","Con19925","Res45322","Res83862","Fla55675","Mul49149","Fla12804","Con43682","Max79834","Res79749","Res24266","Dep99516","Res85327","Zer14667"],Zer14667,"Zer14667")

Actual (Unparsed): [[[0.0000000], [0.0408341], [0.5059876], [0.1639926], [0.2691954], [0.0000000]]]

Expected (Unparsed): [[[0],[0.040834101704399994],[0.50598765],[0.16399260000000002],[0.2691954],[0]]]

Actual:   [[[0], [0.0409], [0.506], [0.164], [0.2692], [0]]]

Expected: [[[0], [0.0409], [0.506], [0.164], [0.2692], [0]]]