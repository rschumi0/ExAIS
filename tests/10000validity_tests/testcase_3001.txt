import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub74535 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Sub74535 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Fla41150 = tf.keras.layers.Input(shape=([2]))
in0Con28723 = tf.keras.layers.Input(shape=([2, 6]))

Sub74535 = keras.layers.Subtract(name = 'Sub74535', )([in0Sub74535,in1Sub74535])
Res92943 = keras.layers.Reshape((2, 2, 4), name = 'Res92943', )(Sub74535)
Res23950 = keras.layers.Reshape((2, 8), name = 'Res23950', )(Res92943)
Fla41150 = keras.layers.Flatten(name = 'Fla41150', )(in0Fla41150)
Res45294 = keras.layers.Reshape((2, 1), name = 'Res45294', )(Fla41150)
Sep44684 = keras.layers.SeparableConv1D(2, (1),strides=(2), padding='same', name = 'Sep44684', )(Res45294)
Zer60709 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer60709', )(Sep44684)
Con28723 = keras.layers.Concatenate(axis=2, name = 'Con28723', )([Zer60709,in0Con28723])
Max5037 = keras.layers.Maximum(name = 'Max5037', )([Res23950,Con28723])
model = tf.keras.models.Model(inputs=[in0Sub74535,in1Sub74535,in0Fla41150,in0Con28723], outputs=Max5037)
w = model.get_layer('Sep44684').get_weights() 
w[0] = np.array([[[0.1247]]])
w[1] = np.array([[[0.7717, 0.3439]]])
w[2] = np.array([0, 0])
model.get_layer('Sep44684').set_weights(w) 
in0Sub74535 = tf.constant([[[[[0.3589, 0.6658], [0.5507, 0.6703]], [[0.7211, 0.6135], [0.8511, 0.5025]]], [[[0.3895, 0.0773], [0.703, 0.3882]], [[0.1267, 0.5978], [0.5928, 0.8572]]]]])
in1Sub74535 = tf.constant([[[[[0.139, 0.3083], [0.7633, 0.0393]], [[0.0487, 0.9066], [0.0582, 0.7031]]], [[[0.0553, 0.1084], [0.3552, 0.0211]], [[0.8501, 0.3054], [0.5734, 0.1767]]]]])
in0Fla41150 = tf.constant([[1.789, 1.5991]])
in0Con28723 = tf.constant([[[0.1733, 0.5756, 0.3752, 0.2955, 0.138, 0.638], [0.7405, 0.7325, 0.995, 0.3328, 0.9856, 0.5999]]])
print (np.array2string(model.predict([in0Sub74535,in1Sub74535,in0Fla41150,in0Con28723],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max5037.png')

LSub74535 = subtract_layer([[[[[0.3589, 0.6658], [0.5507, 0.6703]], [[0.7211, 0.6135], [0.8511, 0.5025]]], [[[0.3895, 0.0773], [0.703, 0.3882]], [[0.1267, 0.5978], [0.5928, 0.8572]]]]], [[[[[0.139, 0.3083], [0.7633, 0.0393]], [[0.0487, 0.9066], [0.0582, 0.7031]]], [[[0.0553, 0.1084], [0.3552, 0.0211]], [[0.8501, 0.3054], [0.5734, 0.1767]]]]], Sub74535), 
LRes92943 = reshape_layer(Sub74535, [2, 2, 4], Res92943), 
LRes23950 = reshape_layer(Res92943, [2, 8], Res23950), 
LFla41150 = flatten_layer([[1.789, 1.5991]], Fla41150), 
LRes45294 = reshape_layer(Fla41150, [2, 1], Res45294), 
LSep44684 = separable_conv1D_layer(Res45294, 1,[[[[0.1247]]],[[[0.7717, 0.3439]]]],[0, 0], 2, true, Sep44684), 
LZer60709 = zero_padding1D_layer(Sep44684, 1, 0, Zer60709), 
LCon28723 = concatenate_layer([Zer60709,[[[0.1733, 0.5756, 0.3752, 0.2955, 0.138, 0.638], [0.7405, 0.7325, 0.995, 0.3328, 0.9856, 0.5999]]]], 2, Con28723), 
LMax5037 = maximum_layer([Res23950,Con28723], Max5037), 
exec_layers([LSub74535,LRes92943,LRes23950,LFla41150,LRes45294,LSep44684,LZer60709,LCon28723,LMax5037],["Sub74535","Res92943","Res23950","Fla41150","Res45294","Sep44684","Zer60709","Con28723","Max5037"],Max5037,"Max5037")

Actual (Unparsed): [[[0.2199000, 0.3575000, 0.1733000, 0.6310000, 0.6724000, 0.2955000, 0.7929000, 0.6380000], [0.3342000, 0.0767201, 0.7405000, 0.7325000, 0.9950000, 0.3328000, 0.9856000, 0.6805000]]]

Expected (Unparsed): [[[0.21989999999999998,0.35749999999999993,0.1733,0.631,0.6724,0.2955,0.7928999999999999,0.638],[0.3342,0.07672006636999999,0.7405,0.7325,0.995,0.3328,0.9856,0.6805]]]

Actual:   [[[0.2199, 0.3575, 0.1733, 0.631, 0.6724, 0.2955, 0.7929, 0.638], [0.3342, 0.0768, 0.7405, 0.7325, 0.995, 0.3328, 0.9856, 0.6805]]]

Expected: [[[0.2199, 0.3575, 0.1733, 0.631, 0.6724, 0.2955, 0.7929, 0.638], [0.3342, 0.0768, 0.7405, 0.7325, 0.995, 0.3328, 0.9856, 0.6805]]]