import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas13665 = tf.keras.layers.Input(shape=([3, 4, 3]))

Mas13665 = keras.layers.Masking(mask_value=2, name = 'Mas13665', )(in0Mas13665)
Res93256 = keras.layers.Reshape((3, 4, 3, 1), name = 'Res93256', )(Mas13665)
Glo21864 = keras.layers.GlobalMaxPool3D(name = 'Glo21864', )(Res93256)
Res95064 = keras.layers.Reshape((1, 1), name = 'Res95064', )(Glo21864)
Res76181 = keras.layers.Reshape((1, 1, 1), name = 'Res76181', )(Res95064)
Res21930 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res21930', )(Res76181)
Zer60811 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer60811', )(Res21930)
Res92514 = keras.layers.Reshape((3, 3, 3), name = 'Res92514', )(Zer60811)
Res93308 = keras.layers.Reshape((3, 9), name = 'Res93308', )(Res92514)
Sep80596 = keras.layers.SeparableConv1D(4, (2),strides=(2), padding='valid', name = 'Sep80596', )(Res93308)
Res73402 = keras.layers.Reshape((1, 4, 1), name = 'Res73402', )(Sep80596)
Res80298 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res80298', )(Res73402)
Zer33899 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer33899', )(Res80298)
model = tf.keras.models.Model(inputs=[in0Mas13665], outputs=Zer33899)
w = model.get_layer('Sep80596').get_weights() 
w[0] = np.array([[[0.0119], [0.693], [0.6998], [0.6505], [0.8917], [0.5334], [0.786], [0.2024], [0.2803]], [[0.0996], [0.9016], [0.0595], [0.5585], [0.315], [0.6662], [0.3827], [0.6269], [0.1281]]])
w[1] = np.array([[[0.6423, 0.2202, 0.9734, 0.2517], [0.1449, 0.2562, 0.1993, 0.0898], [0.9982, 0.8219, 0.9543, 0.2024], [0.9185, 0.1732, 0.7021, 0.7946], [0.0599, 0.4173, 0.3104, 0.8497], [0.4815, 0.8131, 0.9705, 0.5618], [0.0711, 0.116, 0.4129, 0.8073], [0.7938, 0.5002, 0.1368, 0.9054], [0.3426, 0.344, 0.7251, 0.4319]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep80596').set_weights(w) 
in0Mas13665 = tf.constant([[[[1.02, 1.93, 1.4074], [1.5444, 1.7644, 1.0372], [1.7709, 1.1684, 1.3606], [1.7848, 1.3918, 1.9322]], [[1.7995, 1.3677, 1.5496], [1.8853, 1.1044, 1.7117], [1.717, 1.4664, 1.2307], [1.9772, 1.7595, 1.9324]], [[1.5997, 1.773, 1.4651], [1.8663, 1.0001, 1.3445], [1.8969, 1.6941, 1.5788], [1.3706, 1.6245, 1.2146]]]])
print (np.array2string(model.predict([in0Mas13665],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer33899.png')

LMas13665 = masking_layer([[[[1.02, 1.93, 1.4074], [1.5444, 1.7644, 1.0372], [1.7709, 1.1684, 1.3606], [1.7848, 1.3918, 1.9322]], [[1.7995, 1.3677, 1.5496], [1.8853, 1.1044, 1.7117], [1.717, 1.4664, 1.2307], [1.9772, 1.7595, 1.9324]], [[1.5997, 1.773, 1.4651], [1.8663, 1.0001, 1.3445], [1.8969, 1.6941, 1.5788], [1.3706, 1.6245, 1.2146]]]], 2, Mas13665), 
LRes93256 = reshape_layer(Mas13665, [3, 4, 3, 1], Res93256), 
LGlo21864 = global_max_pool3D_layer(Res93256, Glo21864), 
LRes95064 = reshape_layer(Glo21864, [1, 1], Res95064), 
LRes76181 = reshape_layer(Res95064, [1, 1, 1], Res76181), 
LRes21930 = reshape_layer(Res76181, [1, 1, 1, 1], Res21930), 
LZer60811 = zero_padding3D_layer(Res21930, 1, 1, 1, 1, 1, 1, Zer60811), 
LRes92514 = reshape_layer(Zer60811, [3, 3, 3], Res92514), 
LRes93308 = reshape_layer(Res92514, [3, 9], Res93308), 
LSep80596 = separable_conv1D_layer(Res93308, 2,[[[[0.0119], [0.693], [0.6998], [0.6505], [0.8917], [0.5334], [0.786], [0.2024], [0.2803]], [[0.0996], [0.9016], [0.0595], [0.5585], [0.315], [0.6662], [0.3827], [0.6269], [0.1281]]],[[[0.6423, 0.2202, 0.9734, 0.2517], [0.1449, 0.2562, 0.1993, 0.0898], [0.9982, 0.8219, 0.9543, 0.2024], [0.9185, 0.1732, 0.7021, 0.7946], [0.0599, 0.4173, 0.3104, 0.8497], [0.4815, 0.8131, 0.9705, 0.5618], [0.0711, 0.116, 0.4129, 0.8073], [0.7938, 0.5002, 0.1368, 0.9054], [0.3426, 0.344, 0.7251, 0.4319]]]],[0, 0, 0, 0], 2, false, Sep80596), 
LRes73402 = reshape_layer(Sep80596, [1, 4, 1], Res73402), 
LRes80298 = reshape_layer(Res73402, [1, 4, 1, 1], Res80298), 
LZer33899 = zero_padding3D_layer(Res80298, 1, 1, 1, 1, 1, 1, Zer33899), 
exec_layers([LMas13665,LRes93256,LGlo21864,LRes95064,LRes76181,LRes21930,LZer60811,LRes92514,LRes93308,LSep80596,LRes73402,LRes80298,LZer33899],["Mas13665","Res93256","Glo21864","Res95064","Res76181","Res21930","Zer60811","Res92514","Res93308","Sep80596","Res73402","Res80298","Zer33899"],Zer33899,"Zer33899")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0373068], [0.0000000]], [[0.0000000], [0.2599020], [0.0000000]], [[0.0000000], [0.1933227], [0.0000000]], [[0.0000000], [0.5292085], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.0373067982],[0]],[[0],[0.2599019514],[0]],[[0],[0.1933227072],[0]],[[0],[0.5292084546],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.0374], [0]], [[0], [0.26], [0]], [[0], [0.1934], [0]], [[0], [0.5293], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.0374], [0]], [[0], [0.26], [0]], [[0], [0.1934], [0]], [[0], [0.5293], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]