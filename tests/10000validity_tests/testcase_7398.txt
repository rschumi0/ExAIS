import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo91584 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con27248 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Lay62570 = tf.keras.layers.Input(shape=([1]))
in0Glo67880 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con14433 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max77406 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max77406 = tf.keras.layers.Input(shape=([2, 2, 2]))

Glo91584 = keras.layers.GlobalAveragePooling2D(name = 'Glo91584', )(in0Glo91584)
Lea93418 = keras.layers.LeakyReLU(alpha=0.023045808835000556, name = 'Lea93418', )(Glo91584)
Res75287 = keras.layers.Reshape((2, 1), name = 'Res75287', )(Lea93418)
Res90947 = keras.layers.Reshape((2, 1, 1), name = 'Res90947', )(Res75287)
Res11745 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res11745', )(Res90947)
Glo84652 = keras.layers.GlobalAveragePooling3D(name = 'Glo84652', )(Res11745)
Res892 = keras.layers.Reshape((1, 1), name = 'Res892', )(Glo84652)
Res37823 = keras.layers.Reshape((1, 1, 1), name = 'Res37823', )(Res892)
Zer88310 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer88310', )(Res37823)
Con27248 = keras.layers.Concatenate(axis=3, name = 'Con27248', )([Zer88310,in0Con27248])
Lay62570 = keras.layers.LayerNormalization(axis=1, epsilon=2.673482350717146, name = 'Lay62570', )(in0Lay62570)
Glo67880 = keras.layers.GlobalAveragePooling2D(name = 'Glo67880', )(in0Glo67880)
Res28180 = keras.layers.Reshape((2, 1), name = 'Res28180', )(Glo67880)
Res84652 = keras.layers.Reshape((2, 1, 1), name = 'Res84652', )(Res28180)
Res88604 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res88604', )(Res84652)
Glo72049 = keras.layers.GlobalMaxPool3D(name = 'Glo72049', )(Res88604)
Mul69963 = keras.layers.Multiply(name = 'Mul69963', )([Lay62570,Glo72049])
Res76065 = keras.layers.Reshape((1, 1), name = 'Res76065', )(Mul69963)
Res89180 = keras.layers.Reshape((1, 1, 1), name = 'Res89180', )(Res76065)
Zer60456 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer60456', )(Res89180)
Con14433 = keras.layers.Concatenate(axis=3, name = 'Con14433', )([Zer60456,in0Con14433])
Max77406 = keras.layers.Maximum(name = 'Max77406', )([in0Max77406,in1Max77406])
Ave28016 = keras.layers.Average(name = 'Ave28016', )([Con14433,Max77406])
Mul15521 = keras.layers.Multiply(name = 'Mul15521', )([Con27248,Ave28016])
model = tf.keras.models.Model(inputs=[in0Glo91584,in0Con27248,in0Lay62570,in0Glo67880,in0Con14433,in0Max77406,in1Max77406], outputs=Mul15521)
in0Glo91584 = tf.constant([[[[1.8115, 1.2195], [1.7976, 1.9965]]]])
in0Con27248 = tf.constant([[[[0.9946], [0.4952]], [[0.7448], [0.6216]]]])
in0Lay62570 = tf.constant([[1.9351]])
in0Glo67880 = tf.constant([[[[1.982, 1.0509]]]])
in0Con14433 = tf.constant([[[[0.2511], [0.0951]], [[0.8368], [0.1716]]]])
in0Max77406 = tf.constant([[[[0.6395, 0.3843], [0.9009, 0.6207]], [[0.7951, 0.8772], [0.4648, 0.4119]]]])
in1Max77406 = tf.constant([[[[0.1831, 0.034], [0.9401, 0.1429]], [[0.9714, 0.6671], [0.3378, 0.7688]]]])
print (np.array2string(model.predict([in0Glo91584,in0Con27248,in0Lay62570,in0Glo67880,in0Con14433,in0Max77406,in1Max77406],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul15521.png')

LGlo91584 = global_average_pooling2D_layer([[[[1.8115, 1.2195], [1.7976, 1.9965]]]], Glo91584), 
LLea93418 = leaky_relu_layer(Glo91584, 0.023045808835000556, Lea93418), 
LRes75287 = reshape_layer(Lea93418, [2, 1], Res75287), 
LRes90947 = reshape_layer(Res75287, [2, 1, 1], Res90947), 
LRes11745 = reshape_layer(Res90947, [2, 1, 1, 1], Res11745), 
LGlo84652 = global_average_pooling3D_layer(Res11745, Glo84652), 
LRes892 = reshape_layer(Glo84652, [1, 1], Res892), 
LRes37823 = reshape_layer(Res892, [1, 1, 1], Res37823), 
LZer88310 = zero_padding2D_layer(Res37823, 1, 0, 1, 0, Zer88310), 
LCon27248 = concatenate_layer([Zer88310,[[[[0.9946], [0.4952]], [[0.7448], [0.6216]]]]], 3, Con27248), 
LLay62570 = layer_normalization_layer([[1.9351]], 1, 2.673482350717146, Lay62570), 
LGlo67880 = global_average_pooling2D_layer([[[[1.982, 1.0509]]]], Glo67880), 
LRes28180 = reshape_layer(Glo67880, [2, 1], Res28180), 
LRes84652 = reshape_layer(Res28180, [2, 1, 1], Res84652), 
LRes88604 = reshape_layer(Res84652, [2, 1, 1, 1], Res88604), 
LGlo72049 = global_max_pool3D_layer(Res88604, Glo72049), 
LMul69963 = multiply_layer([Lay62570,Glo72049], Mul69963), 
LRes76065 = reshape_layer(Mul69963, [1, 1], Res76065), 
LRes89180 = reshape_layer(Res76065, [1, 1, 1], Res89180), 
LZer60456 = zero_padding2D_layer(Res89180, 1, 0, 1, 0, Zer60456), 
LCon14433 = concatenate_layer([Zer60456,[[[[0.2511], [0.0951]], [[0.8368], [0.1716]]]]], 3, Con14433), 
LMax77406 = maximum_layer([[[[[0.6395, 0.3843], [0.9009, 0.6207]], [[0.7951, 0.8772], [0.4648, 0.4119]]]], [[[[0.1831, 0.034], [0.9401, 0.1429]], [[0.9714, 0.6671], [0.3378, 0.7688]]]]], Max77406), 
LAve28016 = average_layer([Con14433,Max77406], Ave28016), 
LMul15521 = multiply_layer([Con27248,Ave28016], Mul15521), 
exec_layers([LGlo91584,LLea93418,LRes75287,LRes90947,LRes11745,LGlo84652,LRes892,LRes37823,LZer88310,LCon27248,LLay62570,LGlo67880,LRes28180,LRes84652,LRes88604,LGlo72049,LMul69963,LRes76065,LRes89180,LZer60456,LCon14433,LMax77406,LAve28016,LMul15521],["Glo91584","Lea93418","Res75287","Res90947","Res11745","Glo84652","Res892","Res37823","Zer88310","Con27248","Lay62570","Glo67880","Res28180","Res84652","Res88604","Glo72049","Mul69963","Res76065","Res89180","Zer60456","Con14433","Max77406","Ave28016","Mul15521"],Mul15521,"Mul15521")

Actual (Unparsed): [[[[0.0000000, 0.3159844], [0.0000000, 0.1772321]], [[0.0000000, 0.6382936], [0.3965383, 0.2922763]]]]

Expected (Unparsed): [[[[0.0,0.31598442],[0.0,0.17723208]],[[0.0,0.6382936],[0.39653831000000006,0.29227632000000003]]]]

Actual:   [[[[0, 0.316], [0, 0.1773]], [[0, 0.6383], [0.3966, 0.2923]]]]

Expected: [[[[0, 0.316], [0, 0.1773]], [[0, 0.6383], [0.3966, 0.2923]]]]