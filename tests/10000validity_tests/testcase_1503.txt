import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave18094 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Ave18094 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Ave18094 = keras.layers.Average(name = 'Ave18094', )([in0Ave18094,in1Ave18094])
Den35457 = keras.layers.Dense(1,name = 'Den35457', )(Ave18094)
Res98244 = keras.layers.Reshape((1, 1, 2), name = 'Res98244', )(Den35457)
Res58568 = keras.layers.Reshape((1, 2), name = 'Res58568', )(Res98244)
Ave43937 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave43937', )(Res58568)
Res29204 = keras.layers.Reshape((1, 2, 1), name = 'Res29204', )(Ave43937)
Res86097 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res86097', )(Res29204)
Glo34931 = keras.layers.GlobalMaxPool3D(name = 'Glo34931', )(Res86097)
model = tf.keras.models.Model(inputs=[in0Ave18094,in1Ave18094], outputs=Glo34931)
w = model.get_layer('Den35457').get_weights() 
w[0] = np.array([[0.4133], [0.9528]])
w[1] = np.array([0.5393])
model.get_layer('Den35457').set_weights(w) 
in0Ave18094 = tf.constant([[[[[0.3282, 0.2514], [0.4762, 0.7524]]]]])
in1Ave18094 = tf.constant([[[[[0.7571, 0.3121], [0.6552, 0.315]]]]])
print (np.array2string(model.predict([in0Ave18094,in1Ave18094],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo34931.png')

LAve18094 = average_layer([[[[[[0.3282, 0.2514], [0.4762, 0.7524]]]]], [[[[[0.7571, 0.3121], [0.6552, 0.315]]]]]], Ave18094), 
LDen35457 = dense_layer(Ave18094, [[0.4133], [0.9528]],[0.5393], Den35457), 
LRes98244 = reshape_layer(Den35457, [1, 1, 2], Res98244), 
LRes58568 = reshape_layer(Res98244, [1, 2], Res58568), 
LAve43937 = average_pooling1D_layer(Res58568, 1, Ave43937), 
LRes29204 = reshape_layer(Ave43937, [1, 2, 1], Res29204), 
LRes86097 = reshape_layer(Res29204, [1, 2, 1, 1], Res86097), 
LGlo34931 = global_max_pool3D_layer(Res86097, Glo34931), 
exec_layers([LAve18094,LDen35457,LRes98244,LRes58568,LAve43937,LRes29204,LRes86097,LGlo34931],["Ave18094","Den35457","Res98244","Res58568","Ave43937","Res29204","Res86097","Glo34931"],Glo34931,"Glo34931")

Actual (Unparsed): [[1.2816132]]

Expected (Unparsed): [[1.28161317]]

Actual:   [[1.2817]]

Expected: [[1.2817]]