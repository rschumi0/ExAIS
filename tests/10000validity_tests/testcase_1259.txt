import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul14470 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Mul14470 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Min55234 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min55234 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con60025 = tf.keras.layers.Input(shape=([2, 2, 3]))

Mul14470 = keras.layers.Multiply(name = 'Mul14470', )([in0Mul14470,in1Mul14470])
Lay92801 = keras.layers.LayerNormalization(axis=1, epsilon=2.0820916120776074, name = 'Lay92801', )(Mul14470)
Glo85491 = keras.layers.GlobalAveragePooling3D(name = 'Glo85491', )(Lay92801)
Res57022 = keras.layers.Reshape((2, 1), name = 'Res57022', )(Glo85491)
Res28333 = keras.layers.Reshape((2, 1, 1), name = 'Res28333', )(Res57022)
Res52170 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res52170', )(Res28333)
Con28309 = keras.layers.Conv3D(4, (2, 1, 1),strides=(2, 1, 9), padding='same', dilation_rate=(1, 1, 1), name = 'Con28309', )(Res52170)
Res64609 = keras.layers.Reshape((1, 1, 4), name = 'Res64609', )(Con28309)
Zer58926 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer58926', )(Res64609)
Min55234 = keras.layers.Minimum(name = 'Min55234', )([in0Min55234,in1Min55234])
Con60025 = keras.layers.Concatenate(axis=3, name = 'Con60025', )([Min55234,in0Con60025])
Min49112 = keras.layers.Minimum(name = 'Min49112', )([Zer58926,Con60025])
model = tf.keras.models.Model(inputs=[in0Mul14470,in1Mul14470,in0Min55234,in1Min55234,in0Con60025], outputs=Min49112)
w = model.get_layer('Con28309').get_weights() 
w[0] = np.array([[[[[0.7247, 0.0459, 0.336, 0.7433]]]], [[[[0.605, 0.2161, 0.9637, 0.0869]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con28309').set_weights(w) 
in0Mul14470 = tf.constant([[[[[0.3627, 0.0751], [0.8797, 0.2393]], [[0.5334, 0.6717], [0.0867, 0.7859]]], [[[0.8207, 0.1971], [0.9416, 0.8119]], [[0.9664, 0.5943], [0.685, 0.8899]]]]])
in1Mul14470 = tf.constant([[[[[0.1461, 0.2013], [0.1694, 0.3521]], [[0.6337, 0.7422], [0.4382, 0.4115]]], [[[0.7308, 0.4858], [0.1015, 0.2069]], [[0.76, 0.6509], [0.767, 0.7544]]]]])
in0Min55234 = tf.constant([[[[0.6326], [0.7964]], [[0.7065], [0.7775]]]])
in1Min55234 = tf.constant([[[[0.8778], [0.5054]], [[0.0119], [0.7842]]]])
in0Con60025 = tf.constant([[[[0.0308, 0.603, 0.1871], [0.5724, 0.5957, 0.3865]], [[0.1879, 0.6181, 0.4496], [0.7865, 0.3402, 0.2036]]]])
print (np.array2string(model.predict([in0Mul14470,in1Mul14470,in0Min55234,in1Min55234,in0Con60025],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min49112.png')

LMul14470 = multiply_layer([[[[[[0.3627, 0.0751], [0.8797, 0.2393]], [[0.5334, 0.6717], [0.0867, 0.7859]]], [[[0.8207, 0.1971], [0.9416, 0.8119]], [[0.9664, 0.5943], [0.685, 0.8899]]]]], [[[[[0.1461, 0.2013], [0.1694, 0.3521]], [[0.6337, 0.7422], [0.4382, 0.4115]]], [[[0.7308, 0.4858], [0.1015, 0.2069]], [[0.76, 0.6509], [0.767, 0.7544]]]]]], Mul14470), 
LLay92801 = layer_normalization_layer(Mul14470, 1, 2.0820916120776074, Lay92801), 
LGlo85491 = global_average_pooling3D_layer(Lay92801, Glo85491), 
LRes57022 = reshape_layer(Glo85491, [2, 1], Res57022), 
LRes28333 = reshape_layer(Res57022, [2, 1, 1], Res28333), 
LRes52170 = reshape_layer(Res28333, [2, 1, 1, 1], Res52170), 
LCon28309 = conv3D_layer(Res52170, 2, 1, 1,[[[[[0.7247, 0.0459, 0.336, 0.7433]]]], [[[[0.605, 0.2161, 0.9637, 0.0869]]]]],[0, 0, 0, 0], 2, 1, 9, true, 1, 1, 1, Con28309), 
LRes64609 = reshape_layer(Con28309, [1, 1, 4], Res64609), 
LZer58926 = zero_padding2D_layer(Res64609, 1, 0, 1, 0, Zer58926), 
LMin55234 = minimum_layer([[[[[0.6326], [0.7964]], [[0.7065], [0.7775]]]], [[[[0.8778], [0.5054]], [[0.0119], [0.7842]]]]], Min55234), 
LCon60025 = concatenate_layer([Min55234,[[[[0.0308, 0.603, 0.1871], [0.5724, 0.5957, 0.3865]], [[0.1879, 0.6181, 0.4496], [0.7865, 0.3402, 0.2036]]]]], 3, Con60025), 
LMin49112 = minimum_layer([Zer58926,Con60025], Min49112), 
exec_layers([LMul14470,LLay92801,LGlo85491,LRes57022,LRes28333,LRes52170,LCon28309,LRes64609,LZer58926,LMin55234,LCon60025,LMin49112],["Mul14470","Lay92801","Glo85491","Res57022","Res28333","Res52170","Con28309","Res64609","Zer58926","Min55234","Con60025","Min49112"],Min49112,"Min49112")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[5.0286164121615685e-18,3.184952301893418e-19,2.331468351712829e-18,5.1576798387742426e-18]]]]

Actual:   [[[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0]]]]

Expected: [[[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0]]]]