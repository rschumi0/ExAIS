import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add92424 = tf.keras.layers.Input(shape=([2, 2]))
in1Add92424 = tf.keras.layers.Input(shape=([2, 2]))
in0Sep76329 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Cro6249 = tf.keras.layers.Input(shape=([2, 1]))
in0Con59944 = tf.keras.layers.Input(shape=([1, 1, 3]))
in0Con90852 = tf.keras.layers.Input(shape=([2, 4, 1]))

Add92424 = keras.layers.Add(name = 'Add92424', )([in0Add92424,in1Add92424])
Res15345 = keras.layers.Reshape((2, 2, 1), name = 'Res15345', )(Add92424)
Res38074 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res38074', )(Res15345)
Up_48852 = keras.layers.UpSampling3D(size=(1, 2, 2), name = 'Up_48852', )(Res38074)
Res25953 = keras.layers.Reshape((2, 4, 2), name = 'Res25953', )(Up_48852)
Sep76329 = keras.layers.SeparableConv2D(4, (1, 2),strides=(1, 1), padding='valid', name = 'Sep76329', )(in0Sep76329)
Cro6249 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro6249', )(in0Cro6249)
Res54740 = keras.layers.Reshape((2, 1, 1), name = 'Res54740', )(Cro6249)
Cro37387 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro37387', )(Res54740)
Con59944 = keras.layers.Concatenate(axis=3, name = 'Con59944', )([Cro37387,in0Con59944])
Ave55982 = keras.layers.Average(name = 'Ave55982', )([Sep76329,Con59944])
Den38196 = keras.layers.Dense(1,name = 'Den38196', )(Ave55982)
Zer90308 = keras.layers.ZeroPadding2D(padding=((1, 0), (3, 0)), name = 'Zer90308', )(Den38196)
Con90852 = keras.layers.Concatenate(axis=3, name = 'Con90852', )([Zer90308,in0Con90852])
Sub95555 = keras.layers.Subtract(name = 'Sub95555', )([Res25953,Con90852])
model = tf.keras.models.Model(inputs=[in0Add92424,in1Add92424,in0Sep76329,in0Cro6249,in0Con59944,in0Con90852], outputs=Sub95555)
w = model.get_layer('Sep76329').get_weights() 
w[0] = np.array([[[[0.961], [0.641]], [[0.8764], [0.5911]]]])
w[1] = np.array([[[[0.8055, 0.468, 0.1791, 0.4658], [0.9472, 0.5788, 0.308, 0.3751]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep76329').set_weights(w) 
w = model.get_layer('Den38196').get_weights() 
w[0] = np.array([[0.1787], [0.616], [0.1295], [0.8923]])
w[1] = np.array([0.4832])
model.get_layer('Den38196').set_weights(w) 
in0Add92424 = tf.constant([[[0.3311, 0.0217], [0.09, 0.3934]]])
in1Add92424 = tf.constant([[[0.0009, 0.4148], [0.2569, 0.2668]]])
in0Sep76329 = tf.constant([[[[0.3502, 0.1056], [0.8028, 0.7065]]]])
in0Cro6249 = tf.constant([[[1.5567], [1.0276]]])
in0Con59944 = tf.constant([[[[0.8622, 0.8704, 0.2207]]]])
in0Con90852 = tf.constant([[[[0.2605], [0.2873], [0.7973], [0.2743]], [[0.9433], [0.5457], [0.7761], [0.5403]]]])
print (np.array2string(model.predict([in0Add92424,in1Add92424,in0Sep76329,in0Cro6249,in0Con59944,in0Con90852],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub95555.png')

LAdd92424 = add_layer([[[[0.3311, 0.0217], [0.09, 0.3934]]], [[[0.0009, 0.4148], [0.2569, 0.2668]]]], Add92424), 
LRes15345 = reshape_layer(Add92424, [2, 2, 1], Res15345), 
LRes38074 = reshape_layer(Res15345, [2, 2, 1, 1], Res38074), 
LUp_48852 = up_sampling3D_layer(Res38074, 1, 2, 2, Up_48852), 
LRes25953 = reshape_layer(Up_48852, [2, 4, 2], Res25953), 
LSep76329 = separable_conv2D_layer([[[[0.3502, 0.1056], [0.8028, 0.7065]]]], 1, 2,[[[[[0.961], [0.641]], [[0.8764], [0.5911]]]],[[[[0.8055, 0.468, 0.1791, 0.4658], [0.9472, 0.5788, 0.308, 0.3751]]]]],[0, 0, 0, 0], 1, 1, false, Sep76329), 
LCro6249 = cropping1D_layer([[[1.5567], [1.0276]]], 0, 0, Cro6249), 
LRes54740 = reshape_layer(Cro6249, [2, 1, 1], Res54740), 
LCro37387 = cropping2D_layer(Res54740, 1, 0, 0, 0, Cro37387), 
LCon59944 = concatenate_layer([Cro37387,[[[[0.8622, 0.8704, 0.2207]]]]], 3, Con59944), 
LAve55982 = average_layer([Sep76329,Con59944], Ave55982), 
LDen38196 = dense_layer(Ave55982, [[0.1787], [0.616], [0.1295], [0.8923]],[0.4832], Den38196), 
LZer90308 = zero_padding2D_layer(Den38196, 1, 0, 3, 0, Zer90308), 
LCon90852 = concatenate_layer([Zer90308,[[[[0.2605], [0.2873], [0.7973], [0.2743]], [[0.9433], [0.5457], [0.7761], [0.5403]]]]], 3, Con90852), 
LSub95555 = subtract_layer(Res25953,Con90852, Sub95555), 
exec_layers([LAdd92424,LRes15345,LRes38074,LUp_48852,LRes25953,LSep76329,LCro6249,LRes54740,LCro37387,LCon59944,LAve55982,LDen38196,LZer90308,LCon90852,LSub95555],["Add92424","Res15345","Res38074","Up_48852","Res25953","Sep76329","Cro6249","Res54740","Cro37387","Con59944","Ave55982","Den38196","Zer90308","Con90852","Sub95555"],Sub95555,"Sub95555")

Actual (Unparsed): [[[[0.3320000, 0.0715000], [0.3320000, 0.0447000], [0.4365000, -0.3608000], [0.4365000, 0.1622000]], [[0.3469000, -0.5964000], [0.3469000, -0.1988000], [0.6602000, -0.1159000], [-1.0066791, 0.1199000]]]]

Expected (Unparsed): [[[[0.332,0.07150000000000001],[0.332,0.04470000000000002],[0.4365,-0.3608],[0.4365,0.1622]],[[0.3469,-0.5964],[0.3469,-0.19879999999999998],[0.6602,-0.1159],[-1.0066791019511023,0.1199]]]]

Actual:   [[[[0.332, 0.0715], [0.332, 0.0447], [0.4365, -0.3608], [0.4365, 0.1622]], [[0.3469, -0.5964], [0.3469, -0.1988], [0.6602, -0.1159], [-1.0066, 0.1199]]]]

Expected: [[[[0.332, 0.0716], [0.332, 0.0448], [0.4365, -0.3608], [0.4365, 0.1622]], [[0.3469, -0.5964], [0.3469, -0.1987], [0.6602, -0.1159], [-1.0066, 0.1199]]]]