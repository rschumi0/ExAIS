import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot12049 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot12049 = tf.keras.layers.Input(shape=([3, 3]))
in0Con73235 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Max24720 = tf.keras.layers.Input(shape=([1, 1]))
in0Con33748 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Ave12883 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave12883 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Add58862 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Add58862 = tf.keras.layers.Input(shape=([1, 1, 2]))

Dot12049 = keras.layers.Dot(axes=(2, 2), name = 'Dot12049', )([in0Dot12049,in1Dot12049])
Res57469 = keras.layers.Reshape((3, 3, 1), name = 'Res57469', )(Dot12049)
Con73235 = keras.layers.Concatenate(axis=3, name = 'Con73235', )([Res57469,in0Con73235])
Max24720 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max24720', )(in0Max24720)
Res5443 = keras.layers.Reshape((1, 1, 1), name = 'Res5443', )(Max24720)
Glo35930 = keras.layers.GlobalAveragePooling2D(name = 'Glo35930', )(Res5443)
Res78247 = keras.layers.Reshape((1, 1), name = 'Res78247', )(Glo35930)
Res22164 = keras.layers.Reshape((1, 1, 1), name = 'Res22164', )(Res78247)
Zer10990 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer10990', )(Res22164)
Con33748 = keras.layers.Concatenate(axis=3, name = 'Con33748', )([Zer10990,in0Con33748])
Ave12883 = keras.layers.Average(name = 'Ave12883', )([in0Ave12883,in1Ave12883])
Min17908 = keras.layers.Minimum(name = 'Min17908', )([Con33748,Ave12883])
Zer22028 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer22028', )(Min17908)
Max74154 = keras.layers.Maximum(name = 'Max74154', )([Con73235,Zer22028])
Add58862 = keras.layers.Add(name = 'Add58862', )([in0Add58862,in1Add58862])
Zer62006 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer62006', )(Add58862)
Max49607 = keras.layers.Maximum(name = 'Max49607', )([Max74154,Zer62006])
model = tf.keras.models.Model(inputs=[in0Dot12049,in1Dot12049,in0Con73235,in0Max24720,in0Con33748,in0Ave12883,in1Ave12883,in0Add58862,in1Add58862], outputs=Max49607)
in0Dot12049 = tf.constant([[[0.2829, 0.434, 0.576], [0.1334, 0.1326, 0.9236], [0.1817, 0.2815, 0.7548]]])
in1Dot12049 = tf.constant([[[0.9798, 0.1785, 0.1105], [0.8625, 0.9003, 0.063], [0.0517, 0.05, 0.7611]]])
in0Con73235 = tf.constant([[[[0.3092], [0.8604], [0.2148]], [[0.8436], [0.5971], [0.3711]], [[0.8229], [0.5835], [0.3828]]]])
in0Max24720 = tf.constant([[[1.0198]]])
in0Con33748 = tf.constant([[[[0.342], [0.5515]]]])
in0Ave12883 = tf.constant([[[[0.3706, 0.2774], [0.8931, 0.3024]]]])
in1Ave12883 = tf.constant([[[[0.6336, 0.6912], [0.439, 0.0437]]]])
in0Add58862 = tf.constant([[[[0.9962, 0.3154]]]])
in1Add58862 = tf.constant([[[[0.2147, 0.165]]]])
print (np.array2string(model.predict([in0Dot12049,in1Dot12049,in0Con73235,in0Max24720,in0Con33748,in0Ave12883,in1Ave12883,in0Add58862,in1Add58862],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max49607.png')

LDot12049 = dot_layer([[[0.2829, 0.434, 0.576], [0.1334, 0.1326, 0.9236], [0.1817, 0.2815, 0.7548]]], [[[0.9798, 0.1785, 0.1105], [0.8625, 0.9003, 0.063], [0.0517, 0.05, 0.7611]]], 2, 2, Dot12049), 
LRes57469 = reshape_layer(Dot12049, [3, 3, 1], Res57469), 
LCon73235 = concatenate_layer([Res57469,[[[[0.3092], [0.8604], [0.2148]], [[0.8436], [0.5971], [0.3711]], [[0.8229], [0.5835], [0.3828]]]]], 3, Con73235), 
LMax24720 = max_pool1D_layer([[[1.0198]]], 1, Max24720), 
LRes5443 = reshape_layer(Max24720, [1, 1, 1], Res5443), 
LGlo35930 = global_average_pooling2D_layer(Res5443, Glo35930), 
LRes78247 = reshape_layer(Glo35930, [1, 1], Res78247), 
LRes22164 = reshape_layer(Res78247, [1, 1, 1], Res22164), 
LZer10990 = zero_padding2D_layer(Res22164, 0, 0, 1, 0, Zer10990), 
LCon33748 = concatenate_layer([Zer10990,[[[[0.342], [0.5515]]]]], 3, Con33748), 
LAve12883 = average_layer([[[[[0.3706, 0.2774], [0.8931, 0.3024]]]], [[[[0.6336, 0.6912], [0.439, 0.0437]]]]], Ave12883), 
LMin17908 = minimum_layer([Con33748,Ave12883], Min17908), 
LZer22028 = zero_padding2D_layer(Min17908, 2, 0, 1, 0, Zer22028), 
LMax74154 = maximum_layer([Con73235,Zer22028], Max74154), 
LAdd58862 = add_layer([[[[[0.9962, 0.3154]]]], [[[[0.2147, 0.165]]]]], Add58862), 
LZer62006 = zero_padding2D_layer(Add58862, 2, 0, 2, 0, Zer62006), 
LMax49607 = maximum_layer([Max74154,Zer62006], Max49607), 
exec_layers([LDot12049,LRes57469,LCon73235,LMax24720,LRes5443,LGlo35930,LRes78247,LRes22164,LZer10990,LCon33748,LAve12883,LMin17908,LZer22028,LMax74154,LAdd58862,LZer62006,LMax49607],["Dot12049","Res57469","Con73235","Max24720","Res5443","Glo35930","Res78247","Res22164","Zer10990","Con33748","Ave12883","Min17908","Zer22028","Max74154","Add58862","Zer62006","Max49607"],Max49607,"Max49607")

Actual (Unparsed): [[[[0.4183024, 0.3092000], [0.6710195, 0.8604000], [0.4747195, 0.2148000]], [[0.2564322, 0.8436000], [0.2926241, 0.5971000], [0.7164787, 0.3711000]], [[0.3116828, 0.8229000], [0.4577031, 0.5835000], [1.2109000, 0.4804000]]]]

Expected (Unparsed): [[[[0.41830241999999995,0.3092],[0.67101945,0.8604],[0.47471952999999995,0.2148]],[[0.25643222,0.8436],[0.29262407999999995,0.5971],[0.7164787399999999,0.3711]],[[0.31168281000000003,0.8229],[0.4577031,0.5835],[1.2109,0.48040000000000005]]]]

Actual:   [[[[0.4184, 0.3092], [0.6711, 0.8604], [0.4748, 0.2148]], [[0.2565, 0.8436], [0.2927, 0.5971], [0.7165, 0.3711]], [[0.3117, 0.8229], [0.4578, 0.5835], [1.2109, 0.4804]]]]

Expected: [[[[0.4184, 0.3092], [0.6711, 0.8604], [0.4748, 0.2148]], [[0.2565, 0.8436], [0.2927, 0.5971], [0.7165, 0.3711]], [[0.3117, 0.8229], [0.4578, 0.5835], [1.2109, 0.4805]]]]