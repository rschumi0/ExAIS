import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min25200 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min25200 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Dot41467 = tf.keras.layers.Input(shape=([3]))
in1Dot41467 = tf.keras.layers.Input(shape=([3]))
in0Con56892 = tf.keras.layers.Input(shape=([4, 5]))

Min25200 = keras.layers.Minimum(name = 'Min25200', )([in0Min25200,in1Min25200])
Res19499 = keras.layers.Reshape((2, 1, 2), name = 'Res19499', )(Min25200)
Zer71953 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer71953', )(Res19499)
Res86203 = keras.layers.Reshape((4, 6), name = 'Res86203', )(Zer71953)
Dot41467 = keras.layers.Dot(axes=(1, 1), name = 'Dot41467', )([in0Dot41467,in1Dot41467])
Res90691 = keras.layers.Reshape((1, 1), name = 'Res90691', )(Dot41467)
Ave21308 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave21308', )(Res90691)
Zer54230 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer54230', )(Ave21308)
Con56892 = keras.layers.Concatenate(axis=2, name = 'Con56892', )([Zer54230,in0Con56892])
Min46457 = keras.layers.Minimum(name = 'Min46457', )([Res86203,Con56892])
Res13805 = keras.layers.Reshape((4, 6, 1), name = 'Res13805', )(Min46457)
Glo60714 = keras.layers.GlobalMaxPool2D(name = 'Glo60714', )(Res13805)
model = tf.keras.models.Model(inputs=[in0Min25200,in1Min25200,in0Dot41467,in1Dot41467,in0Con56892], outputs=Glo60714)
in0Min25200 = tf.constant([[[[[0.0471], [0.6784]]], [[[0.4868], [0.4964]]]]])
in1Min25200 = tf.constant([[[[[0.6551], [0.6343]]], [[[0.0792], [0.7441]]]]])
in0Dot41467 = tf.constant([[0.2497, 0.3063, 0.6007]])
in1Dot41467 = tf.constant([[0.2519, 0.191, 0.185]])
in0Con56892 = tf.constant([[[0.975, 0.9808, 0.0379, 0.6578, 0.3997], [0.3915, 0.4708, 0.1412, 0.1578, 0.5704], [0.8345, 0.0181, 0.814, 0.6996, 0.0565], [0.3378, 0.8371, 0.9946, 0.6525, 0.5298]]])
print (np.array2string(model.predict([in0Min25200,in1Min25200,in0Dot41467,in1Dot41467,in0Con56892],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo60714.png')

LMin25200 = minimum_layer([[[[[[0.0471], [0.6784]]], [[[0.4868], [0.4964]]]]], [[[[[0.6551], [0.6343]]], [[[0.0792], [0.7441]]]]]], Min25200), 
LRes19499 = reshape_layer(Min25200, [2, 1, 2], Res19499), 
LZer71953 = zero_padding2D_layer(Res19499, 1, 1, 1, 1, Zer71953), 
LRes86203 = reshape_layer(Zer71953, [4, 6], Res86203), 
LDot41467 = dot_layer([[0.2497, 0.3063, 0.6007]], [[0.2519, 0.191, 0.185]], 1, 1, Dot41467), 
LRes90691 = reshape_layer(Dot41467, [1, 1], Res90691), 
LAve21308 = average_pooling1D_layer(Res90691, 1, Ave21308), 
LZer54230 = zero_padding1D_layer(Ave21308, 3, 0, Zer54230), 
LCon56892 = concatenate_layer([Zer54230,[[[0.975, 0.9808, 0.0379, 0.6578, 0.3997], [0.3915, 0.4708, 0.1412, 0.1578, 0.5704], [0.8345, 0.0181, 0.814, 0.6996, 0.0565], [0.3378, 0.8371, 0.9946, 0.6525, 0.5298]]]], 2, Con56892), 
LMin46457 = minimum_layer([Res86203,Con56892], Min46457), 
LRes13805 = reshape_layer(Min46457, [4, 6, 1], Res13805), 
LGlo60714 = global_max_pool2D_layer(Res13805, Glo60714), 
exec_layers([LMin25200,LRes19499,LZer71953,LRes86203,LDot41467,LRes90691,LAve21308,LZer54230,LCon56892,LMin46457,LRes13805,LGlo60714],["Min25200","Res19499","Zer71953","Res86203","Dot41467","Res90691","Ave21308","Zer54230","Con56892","Min46457","Res13805","Glo60714"],Glo60714,"Glo60714")

Actual (Unparsed): [[0.4964000]]

Expected (Unparsed): [[0.4964]]

Actual:   [[0.4964]]

Expected: [[0.4964]]