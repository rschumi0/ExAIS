import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max83968 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max83968 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Max83968 = keras.layers.Maximum(name = 'Max83968', )([in0Max83968,in1Max83968])
Res67678 = keras.layers.Reshape((2, 2, 2), name = 'Res67678', )(Max83968)
PRe62162 = keras.layers.PReLU(name = 'PRe62162', )(Res67678)
Ave55142 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave55142', )(PRe62162)
model = tf.keras.models.Model(inputs=[in0Max83968,in1Max83968], outputs=Ave55142)
w = model.get_layer('PRe62162').get_weights() 
w[0] = np.array([[[0.7864, 0.1427], [0.5778, 0.4677]], [[0.0133, 0.7053], [0.1632, 0.0914]]])
model.get_layer('PRe62162').set_weights(w) 
in0Max83968 = tf.constant([[[[[0.5213, 0.8827]], [[0.8541, 0.5097]]], [[[0.7037, 0.7294]], [[0.2709, 0.9926]]]]])
in1Max83968 = tf.constant([[[[[0.0866, 0.353]], [[0.2255, 0.3861]]], [[[0.7255, 0.3889]], [[0.7623, 0.0995]]]]])
print (np.array2string(model.predict([in0Max83968,in1Max83968],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave55142.png')

LMax83968 = maximum_layer([[[[[[0.5213, 0.8827]], [[0.8541, 0.5097]]], [[[0.7037, 0.7294]], [[0.2709, 0.9926]]]]], [[[[[0.0866, 0.353]], [[0.2255, 0.3861]]], [[[0.7255, 0.3889]], [[0.7623, 0.0995]]]]]], Max83968), 
LRes67678 = reshape_layer(Max83968, [2, 2, 2], Res67678), 
LPRe62162 = prelu_layer(Res67678, [[[0.7864, 0.1427], [0.5778, 0.4677]], [[0.0133, 0.7053], [0.1632, 0.0914]]], PRe62162), 
LAve55142 = average_pooling2D_layer(PRe62162, 1, 1, Ave55142), 
exec_layers([LMax83968,LRes67678,LPRe62162,LAve55142],["Max83968","Res67678","PRe62162","Ave55142"],Ave55142,"Ave55142")

Actual (Unparsed): [[[[0.5213000, 0.8827000], [0.8541000, 0.5097000]], [[0.7255000, 0.7294000], [0.7623000, 0.9926000]]]]

Expected (Unparsed): [[[[0.5213,0.8827],[0.8541,0.5097]],[[0.7255,0.7294],[0.7623,0.9926]]]]

Actual:   [[[[0.5213, 0.8827], [0.8541, 0.5097]], [[0.7255, 0.7294], [0.7623, 0.9926]]]]

Expected: [[[[0.5213, 0.8827], [0.8541, 0.5097]], [[0.7255, 0.7294], [0.7623, 0.9926]]]]