import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con60645 = tf.keras.layers.Input(shape=([2, 2]))

Con60645 = keras.layers.Conv1D(4, (2),strides=(1), padding='same', dilation_rate=(1), name = 'Con60645', )(in0Con60645)
Fla90219 = keras.layers.Flatten(name = 'Fla90219', )(Con60645)
Res93554 = keras.layers.Reshape((8, 1), name = 'Res93554', )(Fla90219)
Res8058 = keras.layers.Reshape((8, 1, 1), name = 'Res8058', )(Res93554)
Res48455 = keras.layers.Reshape((8, 1, 1, 1), name = 'Res48455', )(Res8058)
Con44041 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con44041', )(Res48455)
model = tf.keras.models.Model(inputs=[in0Con60645], outputs=Con44041)
w = model.get_layer('Con60645').get_weights() 
w[0] = np.array([[[0.5667, 0.6921, 0.7261, 0.8491], [0.6846, 0.9884, 0.7449, 0.7439]], [[0.1106, 0.3967, 0.9865, 0.2221], [0.943, 0.8258, 0.5967, 0.7043]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con60645').set_weights(w) 
w = model.get_layer('Con44041').get_weights() 
w[0] = np.array([[[[[0.1927, 0.7341, 0.8636]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con44041').set_weights(w) 
in0Con60645 = tf.constant([[[0.7465, 0.7116], [0.2637, 0.0184]]])
print (np.array2string(model.predict([in0Con60645],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con44041.png')

LCon60645 = conv1D_layer([[[0.7465, 0.7116], [0.2637, 0.0184]]], 2,[[[0.5667, 0.6921, 0.7261, 0.8491], [0.6846, 0.9884, 0.7449, 0.7439]], [[0.1106, 0.3967, 0.9865, 0.2221], [0.943, 0.8258, 0.5967, 0.7043]]],[0, 0, 0, 0], 1, true, 1, Con60645), 
LFla90219 = flatten_layer(Con60645, Fla90219), 
LRes93554 = reshape_layer(Fla90219, [8, 1], Res93554), 
LRes8058 = reshape_layer(Res93554, [8, 1, 1], Res8058), 
LRes48455 = reshape_layer(Res8058, [8, 1, 1, 1], Res48455), 
LCon44041 = conv3D_layer(Res48455, 1, 1, 1,[[[[[0.1927, 0.7341, 0.8636]]]]],[0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con44041), 
exec_layers([LCon60645,LFla90219,LRes93554,LRes8058,LRes48455,LCon44041],["Con60645","Fla90219","Res93554","Res8058","Res48455","Con44041"],Con44041,"Con44041")

Actual (Unparsed): [[[[[0.1843598, 0.7023277, 0.8262228]]], [[[0.2581800, 0.9835491, 1.1570535]]], [[[0.2588392, 0.9860606, 1.1600081]]], [[[0.2379343, 0.9064221, 1.0663209]]], [[[0.0312242, 0.1189502, 0.1399338]]], [[[0.0386736, 0.1473290, 0.1733188]]], [[[0.0395379, 0.1506217, 0.1771924]]], [[[0.0457846, 0.1744188, 0.2051874]]]]]

Expected (Unparsed): [[[[[0.184359814891,0.702327660153,0.826222813388]]],[[[0.25817996102,0.98354908866,1.15705352536]]],[[[0.258839230114,0.986060606262,1.160008090952]]],[[[0.23793425925600004,0.9064221054480001,1.0663208422080002]]],[[[0.031224227360999997,0.11895020916299998,0.139933797348]]],[[[0.038673604691,0.147328973553,0.17331875978800002]]],[[[0.039537941271,0.15062170569299999,0.17719235122799998]]],[[[0.045784639360999996,0.17441880516299998,0.20518741334799998]]]]]

Actual:   [[[[[0.1844, 0.7024, 0.8263]]], [[[0.2582, 0.9836, 1.1571]]], [[[0.2589, 0.9861, 1.1601]]], [[[0.238, 0.9065, 1.0664]]], [[[0.0313, 0.119, 0.14]]], [[[0.0387, 0.1474, 0.1734]]], [[[0.0396, 0.1507, 0.1772]]], [[[0.0458, 0.1745, 0.2052]]]]]

Expected: [[[[[0.1844, 0.7024, 0.8263]]], [[[0.2582, 0.9836, 1.1571]]], [[[0.2589, 0.9861, 1.1601]]], [[[0.238, 0.9065, 1.0664]]], [[[0.0313, 0.119, 0.14]]], [[[0.0387, 0.1474, 0.1734]]], [[[0.0396, 0.1507, 0.1772]]], [[[0.0458, 0.1745, 0.2052]]]]]