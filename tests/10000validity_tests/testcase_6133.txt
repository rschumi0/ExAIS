import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul71555 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul71555 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Mul3543 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Mul3543 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Dot47454 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot47454 = tf.keras.layers.Input(shape=([2, 3]))
in0Con31436 = tf.keras.layers.Input(shape=([1, 2, 1]))

Mul71555 = keras.layers.Multiply(name = 'Mul71555', )([in0Mul71555,in1Mul71555])
Res84109 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res84109', )(Mul71555)
Up_72150 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_72150', )(Res84109)
Mul3543 = keras.layers.Multiply(name = 'Mul3543', )([in0Mul3543,in1Mul3543])
Zer76492 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer76492', )(Mul3543)
Mul41913 = keras.layers.Multiply(name = 'Mul41913', )([Up_72150,Zer76492])
Res40728 = keras.layers.Reshape((1, 2, 2), name = 'Res40728', )(Mul41913)
Dot47454 = keras.layers.Dot(axes=(2, 2), name = 'Dot47454', )([in0Dot47454,in1Dot47454])
Bat40035 = keras.layers.BatchNormalization(axis=1, epsilon=0.2542544115293691,  name = 'Bat40035', )(Dot47454)
Res55257 = keras.layers.Reshape((2, 2, 1), name = 'Res55257', )(Bat40035)
Cro59907 = keras.layers.Cropping2D(cropping=((0, 1), (1, 0)), name = 'Cro59907', )(Res55257)
Zer40638 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer40638', )(Cro59907)
Con31436 = keras.layers.Concatenate(axis=3, name = 'Con31436', )([Zer40638,in0Con31436])
Add53243 = keras.layers.Add(name = 'Add53243', )([Res40728,Con31436])
Fla67487 = keras.layers.Flatten(name = 'Fla67487', )(Add53243)
model = tf.keras.models.Model(inputs=[in0Mul71555,in1Mul71555,in0Mul3543,in1Mul3543,in0Dot47454,in1Dot47454,in0Con31436], outputs=Fla67487)
w = model.get_layer('Bat40035').get_weights() 
w[0] = np.array([0.8934, 0.9859])
w[1] = np.array([0.8378, 0.7893])
w[2] = np.array([0.4851, 0.5221])
w[3] = np.array([0.2007, 0.6818])
model.get_layer('Bat40035').set_weights(w) 
in0Mul71555 = tf.constant([[[[0.8332], [0.0442]]]])
in1Mul71555 = tf.constant([[[[0.844], [0.0128]]]])
in0Mul3543 = tf.constant([[[[[0.0962], [0.2843]]]]])
in1Mul3543 = tf.constant([[[[[0.9064], [0.0528]]]]])
in0Dot47454 = tf.constant([[[0.1916, 0.854, 0.3867], [0.2741, 0.1704, 0.7848]]])
in1Dot47454 = tf.constant([[[0.2687, 0.3576, 0.1531], [0.2582, 0.3298, 0.7028]]])
in0Con31436 = tf.constant([[[[0.7451], [0.2867]]]])
print (np.array2string(model.predict([in0Mul71555,in1Mul71555,in0Mul3543,in1Mul3543,in0Dot47454,in1Dot47454,in0Con31436],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla67487.png')

LMul71555 = multiply_layer([[[[[0.8332], [0.0442]]]], [[[[0.844], [0.0128]]]]], Mul71555), 
LRes84109 = reshape_layer(Mul71555, [1, 2, 1, 1], Res84109), 
LUp_72150 = up_sampling3D_layer(Res84109, 1, 1, 2, Up_72150), 
LMul3543 = multiply_layer([[[[[[0.0962], [0.2843]]]]], [[[[[0.9064], [0.0528]]]]]], Mul3543), 
LZer76492 = zero_padding3D_layer(Mul3543, 0, 0, 1, 0, 0, 0, Zer76492), 
LMul41913 = multiply_layer([Up_72150,Zer76492], Mul41913), 
LRes40728 = reshape_layer(Mul41913, [1, 2, 2], Res40728), 
LDot47454 = dot_layer([[[0.1916, 0.854, 0.3867], [0.2741, 0.1704, 0.7848]]], [[[0.2687, 0.3576, 0.1531], [0.2582, 0.3298, 0.7028]]], 2, 2, Dot47454), 
LBat40035 = batch_normalization_layer(Dot47454, 1, 0.2542544115293691, [0.8934, 0.9859], [0.8378, 0.7893], [0.4851, 0.5221], [0.2007, 0.6818], Bat40035), 
LRes55257 = reshape_layer(Bat40035, [2, 2, 1], Res55257), 
LCro59907 = cropping2D_layer(Res55257, 0, 1, 1, 0, Cro59907), 
LZer40638 = zero_padding2D_layer(Cro59907, 0, 0, 1, 0, Zer40638), 
LCon31436 = concatenate_layer([Zer40638,[[[[0.7451], [0.2867]]]]], 3, Con31436), 
LAdd53243 = add_layer([Res40728,Con31436], Add53243), 
LFla67487 = flatten_layer(Add53243, Fla67487), 
exec_layers([LMul71555,LRes84109,LUp_72150,LMul3543,LZer76492,LMul41913,LRes40728,LDot47454,LBat40035,LRes55257,LCro59907,LZer40638,LCon31436,LAdd53243,LFla67487],["Mul71555","Res84109","Up_72150","Mul3543","Zer76492","Mul41913","Res40728","Dot47454","Bat40035","Res55257","Cro59907","Zer40638","Con31436","Add53243","Fla67487"],Fla67487,"Fla67487")

Actual (Unparsed): [[0.0000000, 0.7451000, 0.9938699, 0.2867085]]

Expected (Unparsed): [[0.0,0.7451,0.9938698749938346,0.2867084926459904]]

Actual:   [[0, 0.7451, 0.9939, 0.2868]]

Expected: [[0, 0.7451, 0.9939, 0.2868]]