import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max98712 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max98712 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0ReL37206 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Con92763 = tf.keras.layers.Input(shape=([5, 2]))
in0Dot34293 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot34293 = tf.keras.layers.Input(shape=([3, 2]))

Max98712 = keras.layers.Maximum(name = 'Max98712', )([in0Max98712,in1Max98712])
Res92652 = keras.layers.Reshape((1, 1), name = 'Res92652', )(Max98712)
Sim36986 = keras.layers.SimpleRNN(2,name = 'Sim36986', )(Res92652)
Res87860 = keras.layers.Reshape((2, 1), name = 'Res87860', )(Sim36986)
Zer10973 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer10973', )(Res87860)
Res63055 = keras.layers.Reshape((4, 1, 1), name = 'Res63055', )(Zer10973)
ReL37206 = keras.layers.ReLU(max_value=8.907097904009726, negative_slope=7.969578938926273, threshold=4.670053499514969, name = 'ReL37206', input_shape=(2, 1, 2, 1))(in0ReL37206)
Res37032 = keras.layers.Reshape((4, 1, 1), name = 'Res37032', )(ReL37206)
Mul61829 = keras.layers.Multiply(name = 'Mul61829', )([Res63055,Res37032])
Res55518 = keras.layers.Reshape((4, 1), name = 'Res55518', )(Mul61829)
Zer59992 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer59992', )(Res55518)
Con92763 = keras.layers.Concatenate(axis=2, name = 'Con92763', )([Zer59992,in0Con92763])
Dot34293 = keras.layers.Dot(axes=(2, 2), name = 'Dot34293', )([in0Dot34293,in1Dot34293])
Lea46751 = keras.layers.LeakyReLU(alpha=3.3449437573819747, name = 'Lea46751', )(Dot34293)
Zer42957 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer42957', )(Lea46751)
Sub1581 = keras.layers.Subtract(name = 'Sub1581', )([Con92763,Zer42957])
model = tf.keras.models.Model(inputs=[in0Max98712,in1Max98712,in0ReL37206,in0Con92763,in0Dot34293,in1Dot34293], outputs=Sub1581)
w = model.get_layer('Sim36986').get_weights() 
w[0] = np.array([[6, 10]])
w[1] = np.array([[3, 8], [7, 8]])
w[2] = np.array([1, 4])
model.get_layer('Sim36986').set_weights(w) 
in0Max98712 = tf.constant([[[[0.4836]]]])
in1Max98712 = tf.constant([[[[0.174]]]])
in0ReL37206 = tf.constant([[[[[0.7345], [0.7304]]], [[[0.4515], [0.157]]]]])
in0Con92763 = tf.constant([[[0.5632, 0.0729], [0.7251, 0.3423], [0.5218, 0.6565], [0.2593, 0.814], [0.6453, 0.4238]]])
in0Dot34293 = tf.constant([[[0.757, 0.974], [0.9952, 0.6864], [0.1447, 0.2861]]])
in1Dot34293 = tf.constant([[[0.433, 0.3502], [0.1212, 0.0155], [0.2119, 0.6079]]])
print (np.array2string(model.predict([in0Max98712,in1Max98712,in0ReL37206,in0Con92763,in0Dot34293,in1Dot34293],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub1581.png')

LMax98712 = maximum_layer([[[[[0.4836]]]], [[[[0.174]]]]], Max98712), 
LRes92652 = reshape_layer(Max98712, [1, 1], Res92652), 
LSim36986 = simple_rnn_layer(Res92652,[[6, 10]],[[3, 8], [7, 8]],[1, 4], Sim36986), 
LRes87860 = reshape_layer(Sim36986, [2, 1], Res87860), 
LZer10973 = zero_padding1D_layer(Res87860, 1, 1, Zer10973), 
LRes63055 = reshape_layer(Zer10973, [4, 1, 1], Res63055), 
LReL37206 = relu_layer([[[[[0.7345], [0.7304]]], [[[0.4515], [0.157]]]]], 8.907097904009726, 7.969578938926273, 4.670053499514969, ReL37206), 
LRes37032 = reshape_layer(ReL37206, [4, 1, 1], Res37032), 
LMul61829 = multiply_layer([Res63055,Res37032], Mul61829), 
LRes55518 = reshape_layer(Mul61829, [4, 1], Res55518), 
LZer59992 = zero_padding1D_layer(Res55518, 1, 0, Zer59992), 
LCon92763 = concatenate_layer([Zer59992,[[[0.5632, 0.0729], [0.7251, 0.3423], [0.5218, 0.6565], [0.2593, 0.814], [0.6453, 0.4238]]]], 2, Con92763), 
LDot34293 = dot_layer([[[0.757, 0.974], [0.9952, 0.6864], [0.1447, 0.2861]]], [[[0.433, 0.3502], [0.1212, 0.0155], [0.2119, 0.6079]]], 2, 2, Dot34293), 
LLea46751 = leaky_relu_layer(Dot34293, 3.3449437573819747, Lea46751), 
LZer42957 = zero_padding1D_layer(Lea46751, 1, 1, Zer42957), 
LSub1581 = subtract_layer(Con92763,Zer42957, Sub1581), 
exec_layers([LMax98712,LRes92652,LSim36986,LRes87860,LZer10973,LRes63055,LReL37206,LRes37032,LMul61829,LRes55518,LZer59992,LCon92763,LDot34293,LLea46751,LZer42957,LSub1581],["Max98712","Res92652","Sim36986","Res87860","Zer10973","Res63055","ReL37206","Res37032","Mul61829","Res55518","Zer59992","Con92763","Dot34293","Lea46751","Zer42957","Sub1581"],Sub1581,"Sub1581")

Actual (Unparsed): [[[0.0000000, 0.5632000, 0.0729000], [-0.6688758, 0.6182546, -0.4102029], [-32.0430417, 0.3905425, 0.0283545], [-33.7829410, 0.2373278, 0.6094179], [-0.0000000, 0.6453000, 0.4238000]]]

Expected (Unparsed): [[[0,0.5632,0.0729],[-0.6688757999999999,0.6182546,-0.4102029000000001],[-32.04304189959939,0.39054256000000004,0.02835456000000003],[-33.7829410208701,0.23732780999999997,0.60941788],[-0.0,0.6453,0.4238]]]

Actual:   [[[0, 0.5632, 0.0729], [-0.6688, 0.6183, -0.4102], [-32.043, 0.3906, 0.0284], [-33.7829, 0.2374, 0.6095], [-0, 0.6453, 0.4238]]]

Expected: [[[0, 0.5632, 0.0729], [-0.6688, 0.6183, -0.4102], [-32.043, 0.3906, 0.0284], [-33.7829, 0.2374, 0.6095], [-0, 0.6453, 0.4238]]]