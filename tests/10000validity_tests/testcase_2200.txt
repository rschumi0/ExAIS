import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max65796 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Max65796 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Max65796 = keras.layers.Maximum(name = 'Max65796', )([in0Max65796,in1Max65796])
Sof8722 = keras.layers.Softmax(axis=1, name = 'Sof8722', )(Max65796)
model = tf.keras.models.Model(inputs=[in0Max65796,in1Max65796], outputs=Sof8722)
in0Max65796 = tf.constant([[[[[0.8273, 0.2586], [0.0179, 0.8991]], [[0.5514, 0.2021], [0.5725, 0.8856]]]]])
in1Max65796 = tf.constant([[[[[0.1404, 0.5142], [0.1867, 0.4653]], [[0.4513, 0.7797], [0.7887, 0.9116]]]]])
print (np.array2string(model.predict([in0Max65796,in1Max65796],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof8722.png')

LMax65796 = maximum_layer([[[[[[0.8273, 0.2586], [0.0179, 0.8991]], [[0.5514, 0.2021], [0.5725, 0.8856]]]]], [[[[[0.1404, 0.5142], [0.1867, 0.4653]], [[0.4513, 0.7797], [0.7887, 0.9116]]]]]], Max65796), 
LSof8722 = softmax_layer(Max65796, 1, Sof8722), 
exec_layers([LMax65796,LSof8722],["Max65796","Sof8722"],Sof8722,"Sof8722")

Actual (Unparsed): [[[[[1.0000000, 1.0000000], [1.0000000, 1.0000000]], [[1.0000000, 1.0000000], [1.0000000, 1.0000000]]]]]

Expected (Unparsed): [[[[[1.0,1.0],[1.0,1.0]],[[1.0,1.0],[1.0,1.0]]]]]

Actual:   [[[[[1, 1], [1, 1]], [[1, 1], [1, 1]]]]]

Expected: [[[[[1, 1], [1, 1]], [[1, 1], [1, 1]]]]]