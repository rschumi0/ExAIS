import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con76671 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Min7500 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min7500 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Con57222 = tf.keras.layers.Input(shape=([8]))
in0Min7967 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Min7967 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con54615 = tf.keras.layers.Input(shape=([8]))

Con76671 = keras.layers.Conv3D(3, (1, 1, 1),strides=(9, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con76671', )(in0Con76671)
Res34468 = keras.layers.Reshape((1, 1, 3), name = 'Res34468', )(Con76671)
Res10284 = keras.layers.Reshape((1, 3), name = 'Res10284', )(Res34468)
Up_61007 = keras.layers.UpSampling1D(size=(1), name = 'Up_61007', )(Res10284)
Res17328 = keras.layers.Reshape((1, 3, 1), name = 'Res17328', )(Up_61007)
Con64337 = keras.layers.Conv2D(3, (1, 3),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con64337', )(Res17328)
Res96432 = keras.layers.Reshape((1, 9), name = 'Res96432', )(Con64337)
Fla155 = keras.layers.Flatten(name = 'Fla155', )(Res96432)
Min7500 = keras.layers.Minimum(name = 'Min7500', )([in0Min7500,in1Min7500])
Glo67276 = keras.layers.GlobalMaxPool3D(name = 'Glo67276', )(Min7500)
Con57222 = keras.layers.Concatenate(axis=1, name = 'Con57222', )([Glo67276,in0Con57222])
Max73932 = keras.layers.Maximum(name = 'Max73932', )([Fla155,Con57222])
Min7967 = keras.layers.Minimum(name = 'Min7967', )([in0Min7967,in1Min7967])
Res65998 = keras.layers.Reshape((2, 2, 1), name = 'Res65998', )(Min7967)
Glo95400 = keras.layers.GlobalAveragePooling2D(name = 'Glo95400', )(Res65998)
Con54615 = keras.layers.Concatenate(axis=1, name = 'Con54615', )([Glo95400,in0Con54615])
Sub35364 = keras.layers.Subtract(name = 'Sub35364', )([Max73932,Con54615])
model = tf.keras.models.Model(inputs=[in0Con76671,in0Min7500,in1Min7500,in0Con57222,in0Min7967,in1Min7967,in0Con54615], outputs=Sub35364)
w = model.get_layer('Con76671').get_weights() 
w[0] = np.array([[[[[0.8239, 0.5197, 0.2346]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con76671').set_weights(w) 
w = model.get_layer('Con64337').get_weights() 
w[0] = np.array([[[[0.1901, 0.3125, 0.0627]], [[0.7321, 0.3866, 0.3243]], [[0.8929, 0.6791, 0.6009]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con64337').set_weights(w) 
in0Con76671 = tf.constant([[[[[0.8332]]]]])
in0Min7500 = tf.constant([[[[[0.0211], [0.459]]], [[[0.0975], [0.291]]]]])
in1Min7500 = tf.constant([[[[[0.8746], [0.3184]]], [[[0.3924], [0.2636]]]]])
in0Con57222 = tf.constant([[0.5882, 0.6206, 0.2433, 0.3808, 0.0883, 0.6589, 0.888, 0.6407]])
in0Min7967 = tf.constant([[[[[0.6073]], [[0.5469]]], [[[0.7695]], [[0.2798]]]]])
in1Min7967 = tf.constant([[[[[0.2214]], [[0.5655]]], [[[0.6374]], [[0.8114]]]]])
in0Con54615 = tf.constant([[0.5675, 0.1981, 0.1279, 0.2531, 0.4419, 0.5088, 0.7257, 0.5476]])
print (np.array2string(model.predict([in0Con76671,in0Min7500,in1Min7500,in0Con57222,in0Min7967,in1Min7967,in0Con54615],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub35364.png')

LCon76671 = conv3D_layer([[[[[0.8332]]]]], 1, 1, 1,[[[[[0.8239, 0.5197, 0.2346]]]]],[0, 0, 0], 9, 1, 1, false, 1, 1, 1, Con76671), 
LRes34468 = reshape_layer(Con76671, [1, 1, 3], Res34468), 
LRes10284 = reshape_layer(Res34468, [1, 3], Res10284), 
LUp_61007 = up_sampling1D_layer(Res10284, 1, Up_61007), 
LRes17328 = reshape_layer(Up_61007, [1, 3, 1], Res17328), 
LCon64337 = conv2D_layer(Res17328, 1, 3,[[[[0.1901, 0.3125, 0.0627]], [[0.7321, 0.3866, 0.3243]], [[0.8929, 0.6791, 0.6009]]]],[0, 0, 0], 1, 1, true, 1, 1, Con64337), 
LRes96432 = reshape_layer(Con64337, [1, 9], Res96432), 
LFla155 = flatten_layer(Res96432, Fla155), 
LMin7500 = minimum_layer([[[[[[0.0211], [0.459]]], [[[0.0975], [0.291]]]]], [[[[[0.8746], [0.3184]]], [[[0.3924], [0.2636]]]]]], Min7500), 
LGlo67276 = global_max_pool3D_layer(Min7500, Glo67276), 
LCon57222 = concatenate_layer([Glo67276,[[0.5882, 0.6206, 0.2433, 0.3808, 0.0883, 0.6589, 0.888, 0.6407]]], 1, Con57222), 
LMax73932 = maximum_layer([Fla155,Con57222], Max73932), 
LMin7967 = minimum_layer([[[[[[0.6073]], [[0.5469]]], [[[0.7695]], [[0.2798]]]]], [[[[[0.2214]], [[0.5655]]], [[[0.6374]], [[0.8114]]]]]], Min7967), 
LRes65998 = reshape_layer(Min7967, [2, 2, 1], Res65998), 
LGlo95400 = global_average_pooling2D_layer(Res65998, Glo95400), 
LCon54615 = concatenate_layer([Glo95400,[[0.5675, 0.1981, 0.1279, 0.2531, 0.4419, 0.5088, 0.7257, 0.5476]]], 1, Con54615), 
LSub35364 = subtract_layer(Max73932,Con54615, Sub35364), 
exec_layers([LCon76671,LRes34468,LRes10284,LUp_61007,LRes17328,LCon64337,LRes96432,LFla155,LMin7500,LGlo67276,LCon57222,LMax73932,LMin7967,LRes65998,LGlo95400,LCon54615,LSub35364],["Con76671","Res34468","Res10284","Up_61007","Res17328","Con64337","Res96432","Fla155","Min7500","Glo67276","Con57222","Max73932","Min7967","Res65998","Glo95400","Con54615","Sub35364"],Sub35364,"Sub35364")

Actual (Unparsed): [[0.4678305, 0.0207000, 0.4225000, 0.4941422, 0.2615690, -0.1409745, 0.1501000, 0.1623000, 0.0931000]]

Expected (Unparsed): [[0.46783047102399994,0.02069999999999994,0.42250000000000004,0.49414220732,0.261568998116,-0.140974505784,0.1501,0.1623,0.09310000000000007]]

Actual:   [[0.4679, 0.0207, 0.4225, 0.4942, 0.2616, -0.1409, 0.1501, 0.1623, 0.0931]]

Expected: [[0.4679, 0.0207, 0.4226, 0.4942, 0.2616, -0.1409, 0.1501, 0.1623, 0.0932]]