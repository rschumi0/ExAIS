import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST83756 = tf.keras.layers.Input(shape=([1, 2]))
in0Con2617 = tf.keras.layers.Input(shape=([3, 2]))
in0Ave49276 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave49276 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con93485 = tf.keras.layers.Input(shape=([3, 1]))
in0Dot10150 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot10150 = tf.keras.layers.Input(shape=([3, 3]))

LST83756 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST83756', )(in0LST83756)
ELU43083 = keras.layers.ELU(alpha=5.3531343916074565, name = 'ELU43083', )(LST83756)
Res75945 = keras.layers.Reshape((3, 1), name = 'Res75945', )(ELU43083)
Con2617 = keras.layers.Concatenate(axis=2, name = 'Con2617', )([Res75945,in0Con2617])
Ave49276 = keras.layers.Average(name = 'Ave49276', )([in0Ave49276,in1Ave49276])
Res99146 = keras.layers.Reshape((2, 2), name = 'Res99146', )(Ave49276)
Zer12324 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer12324', )(Res99146)
Con93485 = keras.layers.Concatenate(axis=2, name = 'Con93485', )([Zer12324,in0Con93485])
Dot10150 = keras.layers.Dot(axes=(2, 1), name = 'Dot10150', )([in0Dot10150,in1Dot10150])
Ave42641 = keras.layers.Average(name = 'Ave42641', )([Con93485,Dot10150])
ELU43550 = keras.layers.ELU(alpha=3.875499888875476, name = 'ELU43550', )(Ave42641)
Min7362 = keras.layers.Minimum(name = 'Min7362', )([Con2617,ELU43550])
model = tf.keras.models.Model(inputs=[in0LST83756,in0Con2617,in0Ave49276,in1Ave49276,in0Con93485,in0Dot10150,in1Dot10150], outputs=Min7362)
w = model.get_layer('LST83756').get_weights() 
w[0] = np.array([[1, 5, 9, 1, 10, 10, 3, 3, 6, 6, 9, 2], [7, 8, 10, 6, 5, 6, 1, 2, 7, 3, 1, 10]])
w[1] = np.array([[5, 6, 4, 7, 6, 3, 1, 3, 5, 10, 3, 4], [4, 1, 6, 1, 9, 10, 10, 1, 2, 1, 7, 1], [10, 2, 7, 6, 4, 3, 9, 6, 7, 8, 5, 9]])
w[2] = np.array([3, 1, 6, 8, 8, 3, 7, 7, 4, 9, 2, 3])
model.get_layer('LST83756').set_weights(w) 
in0LST83756 = tf.constant([[[6, 10]]])
in0Con2617 = tf.constant([[[0.8433, 0.74], [0.2765, 0.4149], [0.1595, 0.4976]]])
in0Ave49276 = tf.constant([[[[0.3688], [0.0703]], [[0.0627], [0.2576]]]])
in1Ave49276 = tf.constant([[[[0.3839], [0.1886]], [[0.9424], [0.1908]]]])
in0Con93485 = tf.constant([[[0.7273], [0.6104], [0.7893]]])
in0Dot10150 = tf.constant([[[0.1132, 0.3482, 0.3736], [0.7466, 0.7985, 0.9249], [0.2315, 0.1918, 0.5519]]])
in1Dot10150 = tf.constant([[[0.4578, 0.636, 0.7149], [0.5285, 0.4424, 0.4532], [0.8594, 0.3527, 0.7875]]])
print (np.array2string(model.predict([in0LST83756,in0Con2617,in0Ave49276,in1Ave49276,in0Con93485,in0Dot10150,in1Dot10150],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min7362.png')

LLST83756 = lstm_layer([[[6, 10]]],[[1, 5, 9, 1, 10, 10, 3, 3, 6, 6, 9, 2], [7, 8, 10, 6, 5, 6, 1, 2, 7, 3, 1, 10]],[[5, 6, 4, 7, 6, 3, 1, 3, 5, 10, 3, 4], [4, 1, 6, 1, 9, 10, 10, 1, 2, 1, 7, 1], [10, 2, 7, 6, 4, 3, 9, 6, 7, 8, 5, 9]],[3, 1, 6, 8, 8, 3, 7, 7, 4, 9, 2, 3], LST83756), 
LELU43083 = elu_layer(LST83756, 5.3531343916074565, ELU43083), 
LRes75945 = reshape_layer(ELU43083, [3, 1], Res75945), 
LCon2617 = concatenate_layer([Res75945,[[[0.8433, 0.74], [0.2765, 0.4149], [0.1595, 0.4976]]]], 2, Con2617), 
LAve49276 = average_layer([[[[[0.3688], [0.0703]], [[0.0627], [0.2576]]]], [[[[0.3839], [0.1886]], [[0.9424], [0.1908]]]]], Ave49276), 
LRes99146 = reshape_layer(Ave49276, [2, 2], Res99146), 
LZer12324 = zero_padding1D_layer(Res99146, 1, 0, Zer12324), 
LCon93485 = concatenate_layer([Zer12324,[[[0.7273], [0.6104], [0.7893]]]], 2, Con93485), 
LDot10150 = dot_layer([[[0.1132, 0.3482, 0.3736], [0.7466, 0.7985, 0.9249], [0.2315, 0.1918, 0.5519]]], [[[0.4578, 0.636, 0.7149], [0.5285, 0.4424, 0.4532], [0.8594, 0.3527, 0.7875]]], 2, 1, Dot10150), 
LAve42641 = average_layer([Con93485,Dot10150], Ave42641), 
LELU43550 = elu_layer(Ave42641, 3.875499888875476, ELU43550), 
LMin7362 = minimum_layer([Con2617,ELU43550], Min7362), 
exec_layers([LLST83756,LELU43083,LRes75945,LCon2617,LAve49276,LRes99146,LZer12324,LCon93485,LDot10150,LAve42641,LELU43550,LMin7362],["LST83756","ELU43083","Res75945","Con2617","Ave49276","Res99146","Zer12324","Con93485","Dot10150","Ave42641","ELU43550","Min7362"],Min7362,"Min7362")

Actual (Unparsed): [[[0.2784593, 0.1789038, 0.6301205], [0.7615942, 0.2765000, 0.4149000], [0.5920999, 0.1595000, 0.4976000]]]

Expected (Unparsed): [[[0.27845925,0.1789038,0.6301204599999999],[0.7615941559557649,0.2765,0.4149],[0.59209993,0.1595,0.4976]]]

Actual:   [[[0.2785, 0.179, 0.6302], [0.7616, 0.2765, 0.4149], [0.5921, 0.1595, 0.4976]]]

Expected: [[[0.2785, 0.179, 0.6302], [0.7616, 0.2765, 0.4149], [0.5921, 0.1595, 0.4976]]]