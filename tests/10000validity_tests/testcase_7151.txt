import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer49016 = tf.keras.layers.Input(shape=([3, 4]))
in0Ave41707 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave41707 = tf.keras.layers.Input(shape=([1, 2, 1]))

Zer49016 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer49016', )(in0Zer49016)
Loc33339 = keras.layers.LocallyConnected1D(4, (4),strides=(1), name = 'Loc33339', )(Zer49016)
Res77651 = keras.layers.Reshape((2, 4, 1), name = 'Res77651', )(Loc33339)
Ave41707 = keras.layers.Average(name = 'Ave41707', )([in0Ave41707,in1Ave41707])
Zer20127 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer20127', )(Ave41707)
Min82786 = keras.layers.Minimum(name = 'Min82786', )([Res77651,Zer20127])
model = tf.keras.models.Model(inputs=[in0Zer49016,in0Ave41707,in1Ave41707], outputs=Min82786)
w = model.get_layer('Loc33339').get_weights() 
w[0] = np.array([[[0.4765, 0.4319, 0.1831, 0.6046], [0.8815, 0.3884, 0.7532, 0.8362], [0.4066, 0.0445, 0.645, 0.1436], [0.3995, 0.5585, 0.0647, 0.8878], [0.2765, 0.0236, 0.7698, 0.1147], [0.8988, 0.4559, 0.5519, 0.6018], [0.9817, 0.9242, 0.7876, 0.3401], [0.2617, 0.1565, 0.2312, 0.4578], [0.6455, 0.4672, 0.5568, 0.0606], [0.981, 0.5239, 0.8957, 0.5834], [0.4051, 0.2904, 0.7589, 0.0292], [0.4472, 0.4706, 0.2911, 0.902], [0.1975, 0.9116, 0.754, 0.7346], [0.8857, 0.7202, 0.5075, 0.8579], [0.1568, 0.296, 0.5226, 0.4608], [0.1811, 0.0916, 0.6401, 0.0508]], [[0.4883, 0.6735, 0.37, 0.1411], [0.0789, 0.5737, 0.018, 0.3604], [0.9317, 0.5012, 0.3175, 0.2124], [0.5009, 0.7105, 0.5524, 0.3948], [0.1762, 0.7136, 0.3578, 0.928], [0.964, 0.0661, 0.0057, 0.3439], [0.8423, 0.6569, 0.9996, 0.8341], [0.3395, 0.7892, 0.2305, 0.5698], [0.8912, 0.3513, 0.7777, 0.3696], [0.4425, 0.5465, 0.6814, 0.5159], [0.5782, 0.9752, 0.6532, 0.7937], [0.1889, 0.3444, 0.749, 0.7682], [0.3101, 0.7172, 0.4815, 0.8999], [0.3074, 0.0093, 0.7171, 0.3491], [0.0227, 0.389, 0.9716, 0.223], [0.8473, 0.3446, 0.3942, 0.5764]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc33339').set_weights(w) 
in0Zer49016 = tf.constant([[[1.9634, 1.8257, 1.87, 1.261], [1.2243, 1.6302, 1.1277, 1.2087], [1.344, 1.1472, 1.2973, 1.1996]]])
in0Ave41707 = tf.constant([[[[0.5322], [0.9369]]]])
in1Ave41707 = tf.constant([[[[0.2816], [0.1713]]]])
print (np.array2string(model.predict([in0Zer49016,in0Ave41707,in1Ave41707],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min82786.png')

LZer49016 = zero_padding1D_layer([[[1.9634, 1.8257, 1.87, 1.261], [1.2243, 1.6302, 1.1277, 1.2087], [1.344, 1.1472, 1.2973, 1.1996]]], 1, 1, Zer49016), 
LLoc33339 = locally_connected1D_layer(Zer49016, 4,[[[0.4765, 0.4319, 0.1831, 0.6046], [0.8815, 0.3884, 0.7532, 0.8362], [0.4066, 0.0445, 0.645, 0.1436], [0.3995, 0.5585, 0.0647, 0.8878], [0.2765, 0.0236, 0.7698, 0.1147], [0.8988, 0.4559, 0.5519, 0.6018], [0.9817, 0.9242, 0.7876, 0.3401], [0.2617, 0.1565, 0.2312, 0.4578], [0.6455, 0.4672, 0.5568, 0.0606], [0.981, 0.5239, 0.8957, 0.5834], [0.4051, 0.2904, 0.7589, 0.0292], [0.4472, 0.4706, 0.2911, 0.902], [0.1975, 0.9116, 0.754, 0.7346], [0.8857, 0.7202, 0.5075, 0.8579], [0.1568, 0.296, 0.5226, 0.4608], [0.1811, 0.0916, 0.6401, 0.0508]], [[0.4883, 0.6735, 0.37, 0.1411], [0.0789, 0.5737, 0.018, 0.3604], [0.9317, 0.5012, 0.3175, 0.2124], [0.5009, 0.7105, 0.5524, 0.3948], [0.1762, 0.7136, 0.3578, 0.928], [0.964, 0.0661, 0.0057, 0.3439], [0.8423, 0.6569, 0.9996, 0.8341], [0.3395, 0.7892, 0.2305, 0.5698], [0.8912, 0.3513, 0.7777, 0.3696], [0.4425, 0.5465, 0.6814, 0.5159], [0.5782, 0.9752, 0.6532, 0.7937], [0.1889, 0.3444, 0.749, 0.7682], [0.3101, 0.7172, 0.4815, 0.8999], [0.3074, 0.0093, 0.7171, 0.3491], [0.0227, 0.389, 0.9716, 0.223], [0.8473, 0.3446, 0.3942, 0.5764]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc33339), 
LRes77651 = reshape_layer(Loc33339, [2, 4, 1], Res77651), 
LAve41707 = average_layer([[[[[0.5322], [0.9369]]]], [[[[0.2816], [0.1713]]]]], Ave41707), 
LZer20127 = zero_padding2D_layer(Ave41707, 1, 0, 2, 0, Zer20127), 
LMin82786 = minimum_layer([Res77651,Zer20127], Min82786), 
exec_layers([LZer49016,LLoc33339,LRes77651,LAve41707,LZer20127,LMin82786],["Zer49016","Loc33339","Res77651","Ave41707","Zer20127","Min82786"],Min82786,"Min82786")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.4069000], [0.5541000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[0],[0.40690000000000004],[0.5541]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [0], [0.4069], [0.5541]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [0], [0.407], [0.5541]]]]