import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave60609 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave60609 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con95585 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Min16106 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Min16106 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Ave60609 = keras.layers.Average(name = 'Ave60609', )([in0Ave60609,in1Ave60609])
Res71791 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res71791', )(Ave60609)
Con95585 = keras.layers.Concatenate(axis=4, name = 'Con95585', )([Res71791,in0Con95585])
Min16106 = keras.layers.Minimum(name = 'Min16106', )([in0Min16106,in1Min16106])
Zer39820 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer39820', )(Min16106)
Ave59092 = keras.layers.Average(name = 'Ave59092', )([Con95585,Zer39820])
model = tf.keras.models.Model(inputs=[in0Ave60609,in1Ave60609,in0Con95585,in0Min16106,in1Min16106], outputs=Ave59092)
in0Ave60609 = tf.constant([[[[0.9425, 0.3958], [0.9782, 0.81]], [[0.0579, 0.2879], [0.3446, 0.4847]]]])
in1Ave60609 = tf.constant([[[[0.589, 0.7446], [0.2849, 0.1092]], [[0.0563, 0.5575], [0.9781, 0.8023]]]])
in0Con95585 = tf.constant([[[[[0.1767], [0.434]], [[0.1523], [0.9069]]], [[[0.0486], [0.1808]], [[0.2887], [0.0015]]]]])
in0Min16106 = tf.constant([[[[[0.638, 0.4219], [0.3308, 0.0996]]], [[[0.1698, 0.5583], [0.6453, 0.0355]]]]])
in1Min16106 = tf.constant([[[[[0.2695, 0.028], [0.0967, 0.5758]]], [[[0.7761, 0.6445], [0.2182, 0.6268]]]]])
print (np.array2string(model.predict([in0Ave60609,in1Ave60609,in0Con95585,in0Min16106,in1Min16106],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave59092.png')

LAve60609 = average_layer([[[[[0.9425, 0.3958], [0.9782, 0.81]], [[0.0579, 0.2879], [0.3446, 0.4847]]]], [[[[0.589, 0.7446], [0.2849, 0.1092]], [[0.0563, 0.5575], [0.9781, 0.8023]]]]], Ave60609), 
LRes71791 = reshape_layer(Ave60609, [2, 2, 2, 1], Res71791), 
LCon95585 = concatenate_layer([Res71791,[[[[[0.1767], [0.434]], [[0.1523], [0.9069]]], [[[0.0486], [0.1808]], [[0.2887], [0.0015]]]]]], 4, Con95585), 
LMin16106 = minimum_layer([[[[[[0.638, 0.4219], [0.3308, 0.0996]]], [[[0.1698, 0.5583], [0.6453, 0.0355]]]]], [[[[[0.2695, 0.028], [0.0967, 0.5758]]], [[[0.7761, 0.6445], [0.2182, 0.6268]]]]]], Min16106), 
LZer39820 = zero_padding3D_layer(Min16106, 0, 0, 1, 0, 0, 0, Zer39820), 
LAve59092 = average_layer([Con95585,Zer39820], Ave59092), 
exec_layers([LAve60609,LRes71791,LCon95585,LMin16106,LZer39820,LAve59092],["Ave60609","Res71791","Con95585","Min16106","Zer39820","Ave59092"],Ave59092,"Ave59092")

Actual (Unparsed): [[[[[0.3828750, 0.0883500], [0.2851000, 0.2170000]], [[0.4505250, 0.0901500], [0.2781500, 0.5032500]]], [[[0.0285500, 0.0243000], [0.2113500, 0.0904000]], [[0.4155750, 0.4235000], [0.4308500, 0.0185000]]]]]

Expected (Unparsed): [[[[[0.38287499999999997,0.08835],[0.2851,0.217]],[[0.45052499999999995,0.09015],[0.27815,0.50325]]],[[[0.02855,0.0243],[0.21134999999999998,0.0904]],[[0.415575,0.4235],[0.43084999999999996,0.0185]]]]]

Actual:   [[[[[0.3829, 0.0884], [0.2851, 0.217]], [[0.4506, 0.0902], [0.2782, 0.5033]]], [[[0.0286, 0.0243], [0.2114, 0.0904]], [[0.4156, 0.4235], [0.4309, 0.0185]]]]]

Expected: [[[[[0.3829, 0.0884], [0.2851, 0.217]], [[0.4506, 0.0902], [0.2782, 0.5033]]], [[[0.0286, 0.0243], [0.2114, 0.0904]], [[0.4156, 0.4235], [0.4309, 0.0185]]]]]