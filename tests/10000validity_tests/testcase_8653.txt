import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe4396 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Sep70737 = tf.keras.layers.Input(shape=([2, 1, 1]))

PRe4396 = keras.layers.PReLU(name = 'PRe4396', input_shape=(2, 1, 2, 1))(in0PRe4396)
Zer85886 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (12, 0)), name = 'Zer85886', )(PRe4396)
Sep70737 = keras.layers.SeparableConv2D(4, (2, 1),strides=(2, 2), padding='valid', name = 'Sep70737', )(in0Sep70737)
Res8584 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res8584', )(Sep70737)
Up_81821 = keras.layers.UpSampling3D(size=(1, 2, 2), name = 'Up_81821', )(Res8584)
Zer70636 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (6, 0)), name = 'Zer70636', )(Up_81821)
Sub24687 = keras.layers.Subtract(name = 'Sub24687', )([Zer85886,Zer70636])
Lay56212 = keras.layers.LayerNormalization(axis=1, epsilon=1.3111057582674928, name = 'Lay56212', )(Sub24687)
model = tf.keras.models.Model(inputs=[in0PRe4396,in0Sep70737], outputs=Lay56212)
w = model.get_layer('PRe4396').get_weights() 
w[0] = np.array([[[[0.9586], [0.0785]]], [[[0.2517], [0.3356]]]])
model.get_layer('PRe4396').set_weights(w) 
w = model.get_layer('Sep70737').get_weights() 
w[0] = np.array([[[[0.9405]]], [[[0.9321]]]])
w[1] = np.array([[[[0.8082, 0.1259, 0.1038, 0.9233]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep70737').set_weights(w) 
in0PRe4396 = tf.constant([[[[[0.7578], [0.1474]]], [[[0.5749], [0.0851]]]]])
in0Sep70737 = tf.constant([[[[0.5034]], [[0.7041]]]])
print (np.array2string(model.predict([in0PRe4396,in0Sep70737],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay56212.png')

LPRe4396 = prelu_layer([[[[[0.7578], [0.1474]]], [[[0.5749], [0.0851]]]]], [[[[0.9586], [0.0785]]], [[[0.2517], [0.3356]]]], PRe4396), 
LZer85886 = zero_padding3D_layer(PRe4396, 0, 0, 2, 0, 12, 0, Zer85886), 
LSep70737 = separable_conv2D_layer([[[[0.5034]], [[0.7041]]]], 2, 1,[[[[[0.9405]]], [[[0.9321]]]],[[[[0.8082, 0.1259, 0.1038, 0.9233]]]]],[0, 0, 0, 0], 2, 2, false, Sep70737), 
LRes8584 = reshape_layer(Sep70737, [1, 1, 4, 1], Res8584), 
LUp_81821 = up_sampling3D_layer(Res8584, 1, 2, 2, Up_81821), 
LZer70636 = zero_padding3D_layer(Up_81821, 1, 0, 1, 0, 6, 0, Zer70636), 
LSub24687 = subtract_layer(Zer85886,Zer70636, Sub24687), 
LLay56212 = layer_normalization_layer(Sub24687, 1, 1.3111057582674928, Lay56212), 
exec_layers([LPRe4396,LZer85886,LSep70737,LRes8584,LUp_81821,LZer70636,LSub24687,LLay56212],["PRe4396","Zer85886","Sep70737","Res8584","Up_81821","Zer70636","Sub24687","Lay56212"],Lay56212,"Lay56212")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.3703509], [0.3703509], [0.0619896], [0.0619896], [0.0511397], [0.0511397], [0.4145100], [0.4145100]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.3703509], [0.3703509], [0.0619896], [0.0619896], [0.0511397], [0.0511397], [0.4719716], [0.4346971]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.3703509], [-0.3703509], [-0.0619896], [-0.0619896], [-0.0511397], [-0.0511397], [-0.4145100], [-0.4145100]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.3703509], [-0.3703509], [-0.0619896], [-0.0619896], [-0.0511397], [-0.0511397], [-0.4719716], [-0.4346971]]]]]

Expected (Unparsed): [[[[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.37035090911707175],[0.37035090911707175],[0.061989633739462424],[0.061989633739462424],[0.05113969033394888],[0.05113969033394888],[0.4145099665916161],[0.4145099665916161]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.37035090911707175],[0.37035090911707175],[0.061989633739462424],[0.061989633739462424],[0.05113969033394888],[0.05113969033394888],[0.4719715653584915],[0.43469708489358094]]],[[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.37035090911707175],[-0.37035090911707175],[-0.061989633739462424],[-0.061989633739462424],[-0.05113969033394888],[-0.05113969033394888],[-0.4145099665916161],[-0.4145099665916161]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.37035090911707175],[-0.37035090911707175],[-0.061989633739462424],[-0.061989633739462424],[-0.05113969033394888],[-0.05113969033394888],[-0.4719715653584915],[-0.43469708489358094]]]]]

Actual:   [[[[[0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0], [0.3704], [0.3704], [0.062], [0.062], [0.0512], [0.0512], [0.4146], [0.4146]], [[0], [0], [0], [0], [0], [0], [0.3704], [0.3704], [0.062], [0.062], [0.0512], [0.0512], [0.472], [0.4347]]], [[[0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0], [-0.3703], [-0.3703], [-0.0619], [-0.0619], [-0.0511], [-0.0511], [-0.4145], [-0.4145]], [[0], [0], [0], [0], [0], [0], [-0.3703], [-0.3703], [-0.0619], [-0.0619], [-0.0511], [-0.0511], [-0.4719], [-0.4346]]]]]

Expected: [[[[[0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0], [0.3704], [0.3704], [0.062], [0.062], [0.0512], [0.0512], [0.4146], [0.4146]], [[0], [0], [0], [0], [0], [0], [0.3704], [0.3704], [0.062], [0.062], [0.0512], [0.0512], [0.472], [0.4347]]], [[[0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0], [-0.3703], [-0.3703], [-0.0619], [-0.0619], [-0.0511], [-0.0511], [-0.4145], [-0.4145]], [[0], [0], [0], [0], [0], [0], [-0.3703], [-0.3703], [-0.0619], [-0.0619], [-0.0511], [-0.0511], [-0.4719], [-0.4346]]]]]