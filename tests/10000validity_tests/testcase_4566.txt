import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ELU90820 = tf.keras.layers.Input(shape=([1, 2]))
in0Sub89677 = tf.keras.layers.Input(shape=([3]))
in1Sub89677 = tf.keras.layers.Input(shape=([3]))

ELU90820 = keras.layers.ELU(alpha=-0.5416480700921014, name = 'ELU90820', input_shape=(1, 2))(in0ELU90820)
Fla54061 = keras.layers.Flatten(name = 'Fla54061', )(ELU90820)
Res39413 = keras.layers.Reshape((2, 1), name = 'Res39413', )(Fla54061)
Res68162 = keras.layers.Reshape((2, 1, 1), name = 'Res68162', )(Res39413)
Sub89677 = keras.layers.Subtract(name = 'Sub89677', )([in0Sub89677,in1Sub89677])
Res29572 = keras.layers.Reshape((3, 1), name = 'Res29572', )(Sub89677)
Res20722 = keras.layers.Reshape((3, 1, 1), name = 'Res20722', )(Res29572)
Cro54626 = keras.layers.Cropping2D(cropping=((2, 0), (0, 0)), name = 'Cro54626', )(Res20722)
Zer30667 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer30667', )(Cro54626)
Ave68151 = keras.layers.Average(name = 'Ave68151', )([Res68162,Zer30667])
Res74003 = keras.layers.Reshape((2, 1), name = 'Res74003', )(Ave68151)
LST5658 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST5658', )(Res74003)
model = tf.keras.models.Model(inputs=[in0ELU90820,in0Sub89677,in1Sub89677], outputs=LST5658)
w = model.get_layer('LST5658').get_weights() 
w[0] = np.array([[3, 8, 10, 4, 9, 6, 2, 2]])
w[1] = np.array([[5, 6, 1, 7, 8, 7, 7, 2], [8, 3, 8, 1, 8, 5, 7, 1]])
w[2] = np.array([3, 10, 9, 10, 3, 5, 2, 8])
model.get_layer('LST5658').set_weights(w) 
in0ELU90820 = tf.constant([[[0.2006, 0.3038]]])
in0Sub89677 = tf.constant([[0.8758, 0.3658, 0.6175]])
in1Sub89677 = tf.constant([[0.4374, 0.6006, 0.9131]])
print (np.array2string(model.predict([in0ELU90820,in0Sub89677,in1Sub89677],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST5658.png')

LELU90820 = elu_layer([[[0.2006, 0.3038]]], -0.5416480700921014, ELU90820), 
LFla54061 = flatten_layer(ELU90820, Fla54061), 
LRes39413 = reshape_layer(Fla54061, [2, 1], Res39413), 
LRes68162 = reshape_layer(Res39413, [2, 1, 1], Res68162), 
LSub89677 = subtract_layer([[0.8758, 0.3658, 0.6175]], [[0.4374, 0.6006, 0.9131]], Sub89677), 
LRes29572 = reshape_layer(Sub89677, [3, 1], Res29572), 
LRes20722 = reshape_layer(Res29572, [3, 1, 1], Res20722), 
LCro54626 = cropping2D_layer(Res20722, 2, 0, 0, 0, Cro54626), 
LZer30667 = zero_padding2D_layer(Cro54626, 1, 0, 0, 0, Zer30667), 
LAve68151 = average_layer([Res68162,Zer30667], Ave68151), 
LRes74003 = reshape_layer(Ave68151, [2, 1], Res74003), 
LLST5658 = lstm_layer(Res74003,[[3, 8, 10, 4, 9, 6, 2, 2]],[[5, 6, 1, 7, 8, 7, 7, 2], [8, 3, 8, 1, 8, 5, 7, 1]],[3, 10, 9, 10, 3, 5, 2, 8], LST5658), 
exec_layers([LELU90820,LFla54061,LRes39413,LRes68162,LSub89677,LRes29572,LRes20722,LCro54626,LZer30667,LAve68151,LRes74003,LLST5658],["ELU90820","Fla54061","Res39413","Res68162","Sub89677","Res29572","Res20722","Cro54626","Zer30667","Ave68151","Res74003","LST5658"],LST5658,"LST5658")

Actual (Unparsed): [[0.9613632, 0.9639851]]

Expected (Unparsed): [[0.9613631984918297,0.9639850959811349]]

Actual:   [[0.9614, 0.964]]

Expected: [[0.9614, 0.964]]