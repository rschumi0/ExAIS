import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den50527 = tf.keras.layers.Input(shape=([3, 4]))

Den50527 = keras.layers.Dense(1,name = 'Den50527', )(in0Den50527)
Zer35670 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer35670', )(Den50527)
Con58669 = keras.layers.Conv1D(2, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con58669', )(Zer35670)
Sof5379 = keras.layers.Softmax(axis=1, name = 'Sof5379', )(Con58669)
model = tf.keras.models.Model(inputs=[in0Den50527], outputs=Sof5379)
w = model.get_layer('Den50527').get_weights() 
w[0] = np.array([[0.2814], [0.835], [0.6721], [0.1673]])
w[1] = np.array([0.7178])
model.get_layer('Den50527').set_weights(w) 
w = model.get_layer('Con58669').get_weights() 
w[0] = np.array([[[0.3833, 0.8455]], [[0.4431, 0.036]]])
w[1] = np.array([0, 0])
model.get_layer('Con58669').set_weights(w) 
in0Den50527 = tf.constant([[[0.7338, 0.1032, 0.4122, 0.1972], [0.3817, 0.5665, 0.6389, 0.0994], [0.9725, 0.4601, 0.9362, 0.0643]]])
print (np.array2string(model.predict([in0Den50527],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof5379.png')

LDen50527 = dense_layer([[[0.7338, 0.1032, 0.4122, 0.1972], [0.3817, 0.5665, 0.6389, 0.0994], [0.9725, 0.4601, 0.9362, 0.0643]]], [[0.2814], [0.835], [0.6721], [0.1673]],[0.7178], Den50527), 
LZer35670 = zero_padding1D_layer(Den50527, 2, 0, Zer35670), 
LCon58669 = conv1D_layer(Zer35670, 2,[[[0.3833, 0.8455]], [[0.4431, 0.036]]],[0, 0], 1, false, 1, Con58669), 
LSof5379 = softmax_layer(Con58669, 1, Sof5379), 
exec_layers([LDen50527,LZer35670,LCon58669,LSof5379],["Den50527","Zer35670","Con58669","Sof5379"],Sof5379,"Sof5379")

Actual (Unparsed): [[[0.0896437, 0.1000033], [0.1609274, 0.1048721], [0.3221042, 0.3252114], [0.4273247, 0.4699132]]]

Expected (Unparsed): [[[0.08964365597194211,0.10000332942756525],[0.16092743451805042,0.10487207580297654],[0.32210416350875926,0.32521138240271963],[0.4273247460012481,0.4699132123667386]]]

Actual:   [[[0.0897, 0.1001], [0.161, 0.1049], [0.3222, 0.3253], [0.4274, 0.47]]]

Expected: [[[0.0897, 0.1001], [0.161, 0.1049], [0.3222, 0.3253], [0.4274, 0.47]]]