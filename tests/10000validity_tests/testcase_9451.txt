import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min4853 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min4853 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Con84713 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Mul27101 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Mul27101 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Cro92923 = tf.keras.layers.Input(shape=([1, 4]))
in0Con6461 = tf.keras.layers.Input(shape=([2, 2]))
in0Add82076 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add82076 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con46794 = tf.keras.layers.Input(shape=([6, 6]))

Min4853 = keras.layers.Minimum(name = 'Min4853', )([in0Min4853,in1Min4853])
Con84713 = keras.layers.Concatenate(axis=4, name = 'Con84713', )([Min4853,in0Con84713])
Mul27101 = keras.layers.Multiply(name = 'Mul27101', )([in0Mul27101,in1Mul27101])
Zer5687 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer5687', )(Mul27101)
Sub94262 = keras.layers.Subtract(name = 'Sub94262', )([Con84713,Zer5687])
Res72739 = keras.layers.Reshape((1, 2, 4), name = 'Res72739', )(Sub94262)
Res33966 = keras.layers.Reshape((1, 8), name = 'Res33966', )(Res72739)
Zer13840 = keras.layers.ZeroPadding1D(padding=((5, 0)), name = 'Zer13840', )(Res33966)
Cro92923 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro92923', )(in0Cro92923)
Res30823 = keras.layers.Reshape((1, 4, 1), name = 'Res30823', )(Cro92923)
PRe8801 = keras.layers.PReLU(name = 'PRe8801', )(Res30823)
Res63718 = keras.layers.Reshape((1, 4), name = 'Res63718', )(PRe8801)
Zer20857 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer20857', )(Res63718)
Con6461 = keras.layers.Concatenate(axis=2, name = 'Con6461', )([Zer20857,in0Con6461])
Add82076 = keras.layers.Add(name = 'Add82076', )([in0Add82076,in1Add82076])
ELU2549 = keras.layers.ELU(alpha=-7.973000714859038, name = 'ELU2549', )(Add82076)
Res82820 = keras.layers.Reshape((2, 2), name = 'Res82820', )(ELU2549)
Dot65632 = keras.layers.Dot(axes=(1, 1), name = 'Dot65632', )([Con6461,Res82820])
Con46794 = keras.layers.Concatenate(axis=2, name = 'Con46794', )([Dot65632,in0Con46794])
Min79578 = keras.layers.Minimum(name = 'Min79578', )([Zer13840,Con46794])
model = tf.keras.models.Model(inputs=[in0Min4853,in1Min4853,in0Con84713,in0Mul27101,in1Mul27101,in0Cro92923,in0Con6461,in0Add82076,in1Add82076,in0Con46794], outputs=Min79578)
w = model.get_layer('PRe8801').get_weights() 
w[0] = np.array([[[0.9772], [0.4332], [0.243], [0.6226]]])
model.get_layer('PRe8801').set_weights(w) 
in0Min4853 = tf.constant([[[[[0.0063], [0.0974]], [[0.0526], [0.3285]]]]])
in1Min4853 = tf.constant([[[[[0.2119], [0.0437]], [[0.5818], [0.5583]]]]])
in0Con84713 = tf.constant([[[[[0.6423], [0.2656]], [[0.2008], [0.6924]]]]])
in0Mul27101 = tf.constant([[[[[0.3083, 0.5768], [0.2367, 0.6675]]]]])
in1Mul27101 = tf.constant([[[[[0.463, 0.3438], [0.1298, 0.28]]]]])
in0Cro92923 = tf.constant([[[1.0931, 1.1871, 1.8815, 1.5034]]])
in0Con6461 = tf.constant([[[0.2452, 0.43], [0.7351, 0.6618]]])
in0Add82076 = tf.constant([[[[0.8041, 0.2713]], [[0.2317, 0.4034]]]])
in1Add82076 = tf.constant([[[[0.2746, 0.3638]], [[0.0532, 0.0407]]]])
in0Con46794 = tf.constant([[[0.1307, 0.9751, 0.6414, 0.4193, 0.7223, 0.7898], [0.0198, 0.6373, 0.7671, 0.0474, 0.3736, 0.2176], [0.4687, 0.9561, 0.7623, 0.3073, 0.0159, 0.302], [0.7106, 0.3334, 0.8457, 0.8587, 0.288, 0.4604], [0.3144, 0.8982, 0.4376, 0.7413, 0.2856, 0.7844], [0.6092, 0.4604, 0.3367, 0.327, 0.7728, 0.8189]]])
print (np.array2string(model.predict([in0Min4853,in1Min4853,in0Con84713,in0Mul27101,in1Mul27101,in0Cro92923,in0Con6461,in0Add82076,in1Add82076,in0Con46794],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min79578.png')

LMin4853 = minimum_layer([[[[[[0.0063], [0.0974]], [[0.0526], [0.3285]]]]], [[[[[0.2119], [0.0437]], [[0.5818], [0.5583]]]]]], Min4853), 
LCon84713 = concatenate_layer([Min4853,[[[[[0.6423], [0.2656]], [[0.2008], [0.6924]]]]]], 4, Con84713), 
LMul27101 = multiply_layer([[[[[[0.3083, 0.5768], [0.2367, 0.6675]]]]], [[[[[0.463, 0.3438], [0.1298, 0.28]]]]]], Mul27101), 
LZer5687 = zero_padding3D_layer(Mul27101, 0, 0, 1, 0, 0, 0, Zer5687), 
LSub94262 = subtract_layer(Con84713,Zer5687, Sub94262), 
LRes72739 = reshape_layer(Sub94262, [1, 2, 4], Res72739), 
LRes33966 = reshape_layer(Res72739, [1, 8], Res33966), 
LZer13840 = zero_padding1D_layer(Res33966, 5, 0, Zer13840), 
LCro92923 = cropping1D_layer([[[1.0931, 1.1871, 1.8815, 1.5034]]], 0, 0, Cro92923), 
LRes30823 = reshape_layer(Cro92923, [1, 4, 1], Res30823), 
LPRe8801 = prelu_layer(Res30823, [[[0.9772], [0.4332], [0.243], [0.6226]]], PRe8801), 
LRes63718 = reshape_layer(PRe8801, [1, 4], Res63718), 
LZer20857 = zero_padding1D_layer(Res63718, 1, 0, Zer20857), 
LCon6461 = concatenate_layer([Zer20857,[[[0.2452, 0.43], [0.7351, 0.6618]]]], 2, Con6461), 
LAdd82076 = add_layer([[[[[0.8041, 0.2713]], [[0.2317, 0.4034]]]], [[[[0.2746, 0.3638]], [[0.0532, 0.0407]]]]], Add82076), 
LELU2549 = elu_layer(Add82076, -7.973000714859038, ELU2549), 
LRes82820 = reshape_layer(ELU2549, [2, 2], Res82820), 
LDot65632 = dot_layer(Con6461,Res82820, 1, 1, Dot65632), 
LCon46794 = concatenate_layer([Dot65632,[[[0.1307, 0.9751, 0.6414, 0.4193, 0.7223, 0.7898], [0.0198, 0.6373, 0.7671, 0.0474, 0.3736, 0.2176], [0.4687, 0.9561, 0.7623, 0.3073, 0.0159, 0.302], [0.7106, 0.3334, 0.8457, 0.8587, 0.288, 0.4604], [0.3144, 0.8982, 0.4376, 0.7413, 0.2856, 0.7844], [0.6092, 0.4604, 0.3367, 0.327, 0.7728, 0.8189]]]], 2, Con46794), 
LMin79578 = minimum_layer([Zer13840,Con46794], Min79578), 
exec_layers([LMin4853,LCon84713,LMul27101,LZer5687,LSub94262,LRes72739,LRes33966,LZer13840,LCro92923,LRes30823,LPRe8801,LRes63718,LZer20857,LCon6461,LAdd82076,LELU2549,LRes82820,LDot65632,LCon46794,LMin79578],["Min4853","Con84713","Mul27101","Zer5687","Sub94262","Res72739","Res33966","Zer13840","Cro92923","Res30823","PRe8801","Res63718","Zer20857","Con6461","Add82076","ELU2549","Res82820","Dot65632","Con46794","Min79578"],Min79578,"Min79578")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0063000, 0.5669984, 0.0437000, 0.2656000, -0.0901429, 0.0024962, 0.2977763, 0.5055000]]]

Expected (Unparsed): [[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0.0063,0.56699838,0.0437,0.2656,-0.0901429,0.002496160000000025,0.29777634000000003,0.5055000000000001]]]

Actual:   [[[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0.0063, 0.567, 0.0437, 0.2656, -0.0901, 0.0025, 0.2978, 0.5055]]]

Expected: [[[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0.0063, 0.567, 0.0437, 0.2656, -0.0901, 0.0025, 0.2978, 0.5056]]]