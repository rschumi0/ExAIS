import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo41859 = tf.keras.layers.Input(shape=([1, 2]))
in0Con3545 = tf.keras.layers.Input(shape=([2, 1, 3, 1]))
in0Add82967 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Add82967 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Dot93175 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot93175 = tf.keras.layers.Input(shape=([3, 2]))
in0Con11460 = tf.keras.layers.Input(shape=([37]))

Glo41859 = keras.layers.GlobalMaxPool1D(name = 'Glo41859', )(in0Glo41859)
Res45593 = keras.layers.Reshape((2, 1), name = 'Res45593', )(Glo41859)
Res51230 = keras.layers.Reshape((2, 1, 1), name = 'Res51230', )(Res45593)
Res65809 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res65809', )(Res51230)
Zer57722 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer57722', )(Res65809)
Con3545 = keras.layers.Concatenate(axis=4, name = 'Con3545', )([Zer57722,in0Con3545])
Add82967 = keras.layers.Add(name = 'Add82967', )([in0Add82967,in1Add82967])
Zer71613 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer71613', )(Add82967)
Min26527 = keras.layers.Minimum(name = 'Min26527', )([Con3545,Zer71613])
Zer62767 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer62767', )(Min26527)
Con34974 = keras.layers.Conv3D(2, (1, 2, 1),strides=(2, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con34974', )(Zer62767)
Res17322 = keras.layers.Reshape((2, 2, 10), name = 'Res17322', )(Con34974)
Res80536 = keras.layers.Reshape((2, 20), name = 'Res80536', )(Res17322)
Fla5311 = keras.layers.Flatten(name = 'Fla5311', )(Res80536)
Dot93175 = keras.layers.Dot(axes=(2, 2), name = 'Dot93175', )([in0Dot93175,in1Dot93175])
Glo95509 = keras.layers.GlobalMaxPool1D(name = 'Glo95509', )(Dot93175)
Con11460 = keras.layers.Concatenate(axis=1, name = 'Con11460', )([Glo95509,in0Con11460])
Mul96048 = keras.layers.Multiply(name = 'Mul96048', )([Fla5311,Con11460])
model = tf.keras.models.Model(inputs=[in0Glo41859,in0Con3545,in0Add82967,in1Add82967,in0Dot93175,in1Dot93175,in0Con11460], outputs=Mul96048)
w = model.get_layer('Con34974').get_weights() 
w[0] = np.array([[[[[0.2374, 0.0034], [0.4428, 0.2818]]], [[[0.3364, 0.46], [0.2404, 0.5623]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con34974').set_weights(w) 
in0Glo41859 = tf.constant([[[1.358, 1.2887]]])
in0Con3545 = tf.constant([[[[[0.548], [0.8498], [0.1265]]], [[[0.4776], [0.3404], [0.0192]]]]])
in0Add82967 = tf.constant([[[[[0.2653, 0.5864], [0.0633, 0.9639]]]]])
in1Add82967 = tf.constant([[[[[0.2597, 0.888], [0.1935, 0.6118]]]]])
in0Dot93175 = tf.constant([[[0.1613, 0.0749], [0.6922, 0.8473], [0.0583, 0.9862]]])
in1Dot93175 = tf.constant([[[0.2683, 0.4558], [0.881, 0.9898], [0.131, 0.0783]]])
in0Con11460 = tf.constant([[0.2372, 0.0107, 0.6883, 0.5634, 0.2841, 0.2287, 0.1207, 0.3648, 0.1959, 0.0191, 0.1302, 0.3739, 0.6729, 0.3835, 0.9659, 0.2641, 0.0723, 0.4194, 0.6708, 0.3121, 0.0754, 0.3137, 0.6198, 0.6894, 0.7448, 0.2239, 0.8769, 0.0982, 0.9594, 0.1492, 0.6248, 0.6409, 0.8141, 0.8442, 0.7769, 0.6433, 0.9416]])
print (np.array2string(model.predict([in0Glo41859,in0Con3545,in0Add82967,in1Add82967,in0Dot93175,in1Dot93175,in0Con11460],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul96048.png')

LGlo41859 = global_max_pool1D_layer([[[1.358, 1.2887]]], Glo41859), 
LRes45593 = reshape_layer(Glo41859, [2, 1], Res45593), 
LRes51230 = reshape_layer(Res45593, [2, 1, 1], Res51230), 
LRes65809 = reshape_layer(Res51230, [2, 1, 1, 1], Res65809), 
LZer57722 = zero_padding3D_layer(Res65809, 0, 0, 0, 0, 2, 0, Zer57722), 
LCon3545 = concatenate_layer([Zer57722,[[[[[0.548], [0.8498], [0.1265]]], [[[0.4776], [0.3404], [0.0192]]]]]], 4, Con3545), 
LAdd82967 = add_layer([[[[[[0.2653, 0.5864], [0.0633, 0.9639]]]]], [[[[[0.2597, 0.888], [0.1935, 0.6118]]]]]], Add82967), 
LZer71613 = zero_padding3D_layer(Add82967, 1, 0, 0, 0, 1, 0, Zer71613), 
LMin26527 = minimum_layer([Con3545,Zer71613], Min26527), 
LZer62767 = zero_padding3D_layer(Min26527, 1, 1, 1, 1, 1, 1, Zer62767), 
LCon34974 = conv3D_layer(Zer62767, 1, 2, 1,[[[[[0.2374, 0.0034], [0.4428, 0.2818]]], [[[0.3364, 0.46], [0.2404, 0.5623]]]]],[0, 0], 2, 1, 1, false, 1, 1, 1, Con34974), 
LRes17322 = reshape_layer(Con34974, [2, 2, 10], Res17322), 
LRes80536 = reshape_layer(Res17322, [2, 20], Res80536), 
LFla5311 = flatten_layer(Res80536, Fla5311), 
LDot93175 = dot_layer([[[0.1613, 0.0749], [0.6922, 0.8473], [0.0583, 0.9862]]], [[[0.2683, 0.4558], [0.881, 0.9898], [0.131, 0.0783]]], 2, 2, Dot93175), 
LGlo95509 = global_max_pool1D_layer(Dot93175, Glo95509), 
LCon11460 = concatenate_layer([Glo95509,[[0.2372, 0.0107, 0.6883, 0.5634, 0.2841, 0.2287, 0.1207, 0.3648, 0.1959, 0.0191, 0.1302, 0.3739, 0.6729, 0.3835, 0.9659, 0.2641, 0.0723, 0.4194, 0.6708, 0.3121, 0.0754, 0.3137, 0.6198, 0.6894, 0.7448, 0.2239, 0.8769, 0.0982, 0.9594, 0.1492, 0.6248, 0.6409, 0.8141, 0.8442, 0.7769, 0.6433, 0.9416]]], 1, Con11460), 
LMul96048 = multiply_layer([Fla5311,Con11460], Mul96048), 
exec_layers([LGlo41859,LRes45593,LRes51230,LRes65809,LZer57722,LCon3545,LAdd82967,LZer71613,LMin26527,LZer62767,LCon34974,LRes17322,LRes80536,LFla5311,LDot93175,LGlo95509,LCon11460,LMul96048],["Glo41859","Res45593","Res51230","Res65809","Zer57722","Con3545","Add82967","Zer71613","Min26527","Zer62767","Con34974","Res17322","Res80536","Fla5311","Dot93175","Glo95509","Con11460","Mul96048"],Mul96048,"Mul96048")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0256707, 0.1186340, 0.0627376, 0.0960227, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0966023, 0.0780923, 0.0586433, 0.0048818, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.025670748591999998,0.118634009016,0.06273760608000001,0.09602271436800001,0.0,0.0,0.0,0.0,0.0,0.0,0.096602293008,0.078092314552,0.058643264736000005,0.004881790991999999,0.0,0.0]]

Actual:   [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0257, 0.1187, 0.0628, 0.0961, 0, 0, 0, 0, 0, 0, 0.0967, 0.0781, 0.0587, 0.0049, 0, 0]]

Expected: [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.0257, 0.1187, 0.0628, 0.0961, 0, 0, 0, 0, 0, 0, 0.0967, 0.0781, 0.0587, 0.0049, 0, 0]]