import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep18067 = tf.keras.layers.Input(shape=([1, 1, 2]))

Sep18067 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep18067', )(in0Sep18067)
Res7230 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res7230', )(Sep18067)
Con76716 = keras.layers.Conv3D(4, (1, 1, 2),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con76716', )(Res7230)
Res54221 = keras.layers.Reshape((1, 1, 4), name = 'Res54221', )(Con76716)
Res39453 = keras.layers.Reshape((1, 4), name = 'Res39453', )(Res54221)
Zer1411 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer1411', )(Res39453)
model = tf.keras.models.Model(inputs=[in0Sep18067], outputs=Zer1411)
w = model.get_layer('Sep18067').get_weights() 
w[0] = np.array([[[[0.918], [0.6407]]]])
w[1] = np.array([[[[0.6078, 0.918], [0.9954, 0.7858]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep18067').set_weights(w) 
w = model.get_layer('Con76716').get_weights() 
w[0] = np.array([[[[[0.6419, 0.9567, 0.2757, 0.6962]], [[0.1502, 0.1965, 0.324, 0.9607]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con76716').set_weights(w) 
in0Sep18067 = tf.constant([[[[0.5264, 0.1824]]]])
print (np.array2string(model.predict([in0Sep18067],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer1411.png')

LSep18067 = separable_conv2D_layer([[[[0.5264, 0.1824]]]], 1, 1,[[[[[0.918], [0.6407]]]],[[[[0.6078, 0.918], [0.9954, 0.7858]]]]],[0, 0], 1, 1, false, Sep18067), 
LRes7230 = reshape_layer(Sep18067, [1, 1, 2, 1], Res7230), 
LCon76716 = conv3D_layer(Res7230, 1, 1, 2,[[[[[0.6419, 0.9567, 0.2757, 0.6962]], [[0.1502, 0.1965, 0.324, 0.9607]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con76716), 
LRes54221 = reshape_layer(Con76716, [1, 1, 4], Res54221), 
LRes39453 = reshape_layer(Res54221, [1, 4], Res39453), 
LZer1411 = zero_padding1D_layer(Res39453, 1, 1, Zer1411), 
exec_layers([LSep18067,LRes7230,LCon76716,LRes54221,LRes39453,LZer1411],["Sep18067","Res7230","Con76716","Res54221","Res39453","Zer1411"],Zer1411,"Zer1411")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.3436257, 0.4974961, 0.2865301, 0.7998660], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0],[0.34362570200184966,0.4974961166354305,0.2865300639153985,0.7998659311737794],[0,0,0,0]]]

Actual:   [[[0, 0, 0, 0], [0.3437, 0.4975, 0.2866, 0.7999], [0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0], [0.3437, 0.4975, 0.2866, 0.7999], [0, 0, 0, 0]]]