import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot71238 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot71238 = tf.keras.layers.Input(shape=([2, 3]))
in0Con12999 = tf.keras.layers.Input(shape=([5, 3, 3]))
in0Den68195 = tf.keras.layers.Input(shape=([5, 3, 4]))

Dot71238 = keras.layers.Dot(axes=(1, 1), name = 'Dot71238', )([in0Dot71238,in1Dot71238])
Res54529 = keras.layers.Reshape((3, 3, 1), name = 'Res54529', )(Dot71238)
Zer75937 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer75937', )(Res54529)
Con12999 = keras.layers.Concatenate(axis=3, name = 'Con12999', )([Zer75937,in0Con12999])
Den68195 = keras.layers.Dense(4,name = 'Den68195', )(in0Den68195)
Sub67729 = keras.layers.Subtract(name = 'Sub67729', )([Con12999,Den68195])
Res88169 = keras.layers.Reshape((5, 3, 4, 1), name = 'Res88169', )(Sub67729)
Up_50443 = keras.layers.UpSampling3D(size=(2, 1, 1), name = 'Up_50443', )(Res88169)
model = tf.keras.models.Model(inputs=[in0Dot71238,in1Dot71238,in0Con12999,in0Den68195], outputs=Up_50443)
w = model.get_layer('Den68195').get_weights() 
w[0] = np.array([[0.4937, 0.4646, 0.6101, 0.5597], [0.971, 0.8766, 0.0632, 0.3916], [0.406, 0.8278, 0.3762, 0.5814], [0.8345, 0.2001, 0.0067, 0.5198]])
w[1] = np.array([0.582, 0.0534, 0.308, 0.8313])
model.get_layer('Den68195').set_weights(w) 
in0Dot71238 = tf.constant([[[0.5809, 0.0301, 0.8631], [0.6326, 0.8009, 0.837]]])
in1Dot71238 = tf.constant([[[0.0807, 0.6008, 0.5072], [0.2312, 0.0709, 0.569]]])
in0Con12999 = tf.constant([[[[0.217, 0.3774, 0.7049], [0.7318, 0.7198, 0.3645], [0.9824, 0.3633, 0.255]], [[0.2472, 0.6262, 0.4032], [0.6024, 0.9249, 0.6703], [0.7924, 0.167, 0.0947]], [[0.9051, 0.7662, 0.1862], [0.6298, 0.6153, 0.4739], [0.6757, 0.2729, 0.8825]], [[0.3282, 0.711, 0.1781], [0.473, 0.2171, 0.1191], [0.4783, 0.1984, 0.368]], [[0.1652, 0.9744, 0.0359], [0.0906, 0.3562, 0.2512], [0.2261, 0.8481, 0.0567]]]])
in0Den68195 = tf.constant([[[[0.0496, 0.8018, 0.4148, 0.8947], [0.8453, 0.7671, 0.038, 0.2001], [0.1306, 0.372, 0.773, 0.3633]], [[0.3557, 0.8145, 0.7728, 0.6737], [0.7975, 0.0304, 0.1065, 0.9412], [0.4194, 0.8405, 0.336, 0.1662]], [[0.7427, 0.6809, 0.1231, 0.2334], [0.5106, 0.377, 0.9492, 0.974], [0.2227, 0.1985, 0.8452, 0.8559]], [[0.2006, 0.7376, 0.6192, 0.5106], [0.6996, 0.9877, 0.4513, 0.2778], [0.7288, 0.3717, 0.8772, 0.9637]], [[0.6618, 0.3653, 0.1242, 0.044], [0.4242, 0.7929, 0.4801, 0.616], [0.0315, 0.8347, 0.8794, 0.5077]]]])
print (np.array2string(model.predict([in0Dot71238,in1Dot71238,in0Con12999,in0Den68195],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_50443.png')

LDot71238 = dot_layer([[[0.5809, 0.0301, 0.8631], [0.6326, 0.8009, 0.837]]], [[[0.0807, 0.6008, 0.5072], [0.2312, 0.0709, 0.569]]], 1, 1, Dot71238), 
LRes54529 = reshape_layer(Dot71238, [3, 3, 1], Res54529), 
LZer75937 = zero_padding2D_layer(Res54529, 2, 0, 0, 0, Zer75937), 
LCon12999 = concatenate_layer([Zer75937,[[[[0.217, 0.3774, 0.7049], [0.7318, 0.7198, 0.3645], [0.9824, 0.3633, 0.255]], [[0.2472, 0.6262, 0.4032], [0.6024, 0.9249, 0.6703], [0.7924, 0.167, 0.0947]], [[0.9051, 0.7662, 0.1862], [0.6298, 0.6153, 0.4739], [0.6757, 0.2729, 0.8825]], [[0.3282, 0.711, 0.1781], [0.473, 0.2171, 0.1191], [0.4783, 0.1984, 0.368]], [[0.1652, 0.9744, 0.0359], [0.0906, 0.3562, 0.2512], [0.2261, 0.8481, 0.0567]]]]], 3, Con12999), 
LDen68195 = dense_layer([[[[0.0496, 0.8018, 0.4148, 0.8947], [0.8453, 0.7671, 0.038, 0.2001], [0.1306, 0.372, 0.773, 0.3633]], [[0.3557, 0.8145, 0.7728, 0.6737], [0.7975, 0.0304, 0.1065, 0.9412], [0.4194, 0.8405, 0.336, 0.1662]], [[0.7427, 0.6809, 0.1231, 0.2334], [0.5106, 0.377, 0.9492, 0.974], [0.2227, 0.1985, 0.8452, 0.8559]], [[0.2006, 0.7376, 0.6192, 0.5106], [0.6996, 0.9877, 0.4513, 0.2778], [0.7288, 0.3717, 0.8772, 0.9637]], [[0.6618, 0.3653, 0.1242, 0.044], [0.4242, 0.7929, 0.4801, 0.616], [0.0315, 0.8347, 0.8794, 0.5077]]]], [[0.4937, 0.4646, 0.6101, 0.5597], [0.971, 0.8766, 0.0632, 0.3916], [0.406, 0.8278, 0.3762, 0.5814], [0.8345, 0.2001, 0.0067, 0.5198]],[0.582, 0.0534, 0.308, 0.8313], Den68195), 
LSub67729 = subtract_layer(Con12999,Den68195, Sub67729), 
LRes88169 = reshape_layer(Sub67729, [5, 3, 4, 1], Res88169), 
LUp_50443 = up_sampling3D_layer(Res88169, 2, 1, 1, Up_50443), 
exec_layers([LDot71238,LRes54529,LZer75937,LCon12999,LDen68195,LSub67729,LRes88169,LUp_50443],["Dot71238","Res54529","Zer75937","Con12999","Den68195","Sub67729","Res88169","Up_50443"],Up_50443,"Up_50443")

Actual (Unparsed): [[[[[-2.3000713], [-1.0847030], [-0.1735770], [-1.1743757]], [[-1.9265901], [-0.4582626], [-0.1680345], [-1.3664160]], [[-1.6247011], [-0.1703577], [-0.3411262], [-1.4333376]]], [[[-2.3000713], [-1.0847030], [-0.1735770], [-1.1743757]], [[-1.9265901], [-0.4582626], [-0.1680345], [-1.3664160]], [[-1.6247011], [-0.1703577], [-0.3411262], [-1.4333376]]], [[[-2.4244480], [-1.4599801], [-0.2455301], [-1.7456387]], [[-1.8339146], [-0.1246620], [0.0820526], [-1.1704203]], [[-1.8802932], [-0.5040330], [-0.5775123], [-1.5822191]]], [[[-2.4244480], [-1.4599801], [-0.2455301], [-1.7456387]], [[-1.8339146], [-0.1246620], [0.0820526], [-1.1704203]], [[-1.8802932], [-0.5040330], [-0.5775123], [-1.5822191]]], [[[-1.6614400], [-0.2388409], [-0.0858281], [-1.5203213]], [[-2.0044723], [-0.9719481], [-0.3916583], [-1.8489661]], [[-1.2875083], [-0.5260937], [-0.5072133], [-1.0874739]]], [[[-1.6614400], [-0.2388409], [-0.0858281], [-1.5203213]], [[-2.0044723], [-0.9719481], [-0.3916583], [-1.8489661]], [[-1.2875083], [-0.5260937], [-0.5072133], [-1.0874739]]], [[[-1.8871396], [-1.0797237], [-0.0023664], [-1.6797327]], [[-2.2266332], [-1.2004259], [-0.7517889], [-1.8973357]], [[-1.9921013], [-1.1585152], [-0.9141917], [-2.0277024]]], [[[-1.8871396], [-1.0797237], [-0.0023664], [-1.6797327]], [[-2.2266332], [-1.2004259], [-0.7517889], [-1.8973357]], [[-1.9921013], [-1.1585152], [-0.9141917], [-2.0277024]]], [[[-1.0874136], [-0.6275114], [0.1925300], [-1.4039420]], [[-1.6924123], [-1.3756279], [-0.4454565], [-1.7273513]], [[-1.2747400], [-1.4031910], [0.1338969], [-1.8942847]]], [[[-1.0874136], [-0.6275114], [0.1925300], [-1.4039420]], [[-1.6924123], [-1.3756279], [-0.4454565], [-1.7273513]], [[-1.2747400], [-1.4031910], [0.1338969], [-1.8942847]]]]]

Expected (Unparsed): [[[[[-2.30007127],[-1.08470295],[-0.17357697],[-1.17437578]],[[-1.92659016],[-0.45826265],[-0.16803451999999997],[-1.3664159500000004]],[[-1.6247010700000002],[-0.17035769000000023],[-0.34112616999999995],[-1.43333756]]],[[[-2.30007127],[-1.08470295],[-0.17357697],[-1.17437578]],[[-1.92659016],[-0.45826265],[-0.16803451999999997],[-1.3664159500000004]],[[-1.6247010700000002],[-0.17035769000000023],[-0.34112616999999995],[-1.43333756]]],[[[-2.42444804],[-1.4599801300000002],[-0.24553011999999996],[-1.74563867]],[[-1.83391455],[-0.12466196000000007],[0.08205263000000007],[-1.1704202499999998]],[[-1.88029318],[-0.5040329600000002],[-0.5775122799999999],[-1.5822191400000003]]],[[[-2.42444804],[-1.4599801300000002],[-0.24553011999999996],[-1.74563867]],[[-1.83391455],[-0.12466196000000007],[0.08205263000000007],[-1.1704202499999998]],[[-1.88029318],[-0.5040329600000002],[-0.5775122799999999],[-1.5822191400000003]]],[[[-1.6614400400000002],[-0.23884088000000014],[-0.0858281500000001],[-1.5203212900000003]],[[-2.0044723600000003],[-0.9719481199999999],[-0.3916583],[-1.8489660999999997]],[[-1.28750836],[-0.5260936700000001],[-0.50721324],[-1.08747389]]],[[[-1.6614400400000002],[-0.23884088000000014],[-0.0858281500000001],[-1.5203212900000003]],[[-2.0044723600000003],[-0.9719481199999999],[-0.3916583],[-1.8489660999999997]],[[-1.28750836],[-0.5260936700000001],[-0.50721324],[-1.08747389]]],[[[-1.8871395699999998],[-1.0797237400000002],[-0.0023664399999999697],[-1.6797327400000002]],[[-2.2266332299999996],[-1.2004259],[-0.75178892],[-1.8973356999999997]],[[-1.99210129],[-1.1585152300000001],[-0.91419175],[-2.0277024200000002]]],[[[-1.8871395699999998],[-1.0797237400000002],[-0.0023664399999999697],[-1.6797327400000002]],[[-2.2266332299999996],[-1.2004259],[-0.75178892],[-1.8973356999999997]],[[-1.99210129],[-1.1585152300000001],[-0.91419175],[-2.0277024200000002]]],[[[-1.0874135900000002],[-0.62751142],[0.19253001999999997],[-1.40394202]],[[-1.6924122599999998],[-1.37562784],[-0.44545651999999997],[-1.72735132]],[[-1.2747399799999999],[-1.4031910100000002],[0.13389693999999996],[-1.8942846900000003]]],[[[-1.0874135900000002],[-0.62751142],[0.19253001999999997],[-1.40394202]],[[-1.6924122599999998],[-1.37562784],[-0.44545651999999997],[-1.72735132]],[[-1.2747399799999999],[-1.4031910100000002],[0.13389693999999996],[-1.8942846900000003]]]]]

Actual:   [[[[[-2.3], [-1.0847], [-0.1735], [-1.1743]], [[-1.9265], [-0.4582], [-0.168], [-1.3664]], [[-1.6247], [-0.1703], [-0.3411], [-1.4333]]], [[[-2.3], [-1.0847], [-0.1735], [-1.1743]], [[-1.9265], [-0.4582], [-0.168], [-1.3664]], [[-1.6247], [-0.1703], [-0.3411], [-1.4333]]], [[[-2.4244], [-1.4599], [-0.2455], [-1.7456]], [[-1.8339], [-0.1246], [0.0821], [-1.1704]], [[-1.8802], [-0.504], [-0.5775], [-1.5822]]], [[[-2.4244], [-1.4599], [-0.2455], [-1.7456]], [[-1.8339], [-0.1246], [0.0821], [-1.1704]], [[-1.8802], [-0.504], [-0.5775], [-1.5822]]], [[[-1.6614], [-0.2388], [-0.0858], [-1.5203]], [[-2.0044], [-0.9719], [-0.3916], [-1.8489]], [[-1.2875], [-0.526], [-0.5072], [-1.0874]]], [[[-1.6614], [-0.2388], [-0.0858], [-1.5203]], [[-2.0044], [-0.9719], [-0.3916], [-1.8489]], [[-1.2875], [-0.526], [-0.5072], [-1.0874]]], [[[-1.8871], [-1.0797], [-0.0023], [-1.6797]], [[-2.2266], [-1.2004], [-0.7517], [-1.8973]], [[-1.9921], [-1.1585], [-0.9141], [-2.0277]]], [[[-1.8871], [-1.0797], [-0.0023], [-1.6797]], [[-2.2266], [-1.2004], [-0.7517], [-1.8973]], [[-1.9921], [-1.1585], [-0.9141], [-2.0277]]], [[[-1.0874], [-0.6275], [0.1926], [-1.4039]], [[-1.6924], [-1.3756], [-0.4454], [-1.7273]], [[-1.2747], [-1.4031], [0.1339], [-1.8942]]], [[[-1.0874], [-0.6275], [0.1926], [-1.4039]], [[-1.6924], [-1.3756], [-0.4454], [-1.7273]], [[-1.2747], [-1.4031], [0.1339], [-1.8942]]]]]

Expected: [[[[[-2.3], [-1.0847], [-0.1735], [-1.1743]], [[-1.9265], [-0.4582], [-0.168], [-1.3664]], [[-1.6247], [-0.1703], [-0.3411], [-1.4333]]], [[[-2.3], [-1.0847], [-0.1735], [-1.1743]], [[-1.9265], [-0.4582], [-0.168], [-1.3664]], [[-1.6247], [-0.1703], [-0.3411], [-1.4333]]], [[[-2.4244], [-1.4599], [-0.2455], [-1.7456]], [[-1.8339], [-0.1246], [0.0821], [-1.1704]], [[-1.8802], [-0.504], [-0.5775], [-1.5822]]], [[[-2.4244], [-1.4599], [-0.2455], [-1.7456]], [[-1.8339], [-0.1246], [0.0821], [-1.1704]], [[-1.8802], [-0.504], [-0.5775], [-1.5822]]], [[[-1.6614], [-0.2388], [-0.0858], [-1.5203]], [[-2.0044], [-0.9719], [-0.3916], [-1.8489]], [[-1.2875], [-0.526], [-0.5072], [-1.0874]]], [[[-1.6614], [-0.2388], [-0.0858], [-1.5203]], [[-2.0044], [-0.9719], [-0.3916], [-1.8489]], [[-1.2875], [-0.526], [-0.5072], [-1.0874]]], [[[-1.8871], [-1.0797], [-0.0023], [-1.6797]], [[-2.2266], [-1.2004], [-0.7517], [-1.8973]], [[-1.9921], [-1.1585], [-0.9141], [-2.0277]]], [[[-1.8871], [-1.0797], [-0.0023], [-1.6797]], [[-2.2266], [-1.2004], [-0.7517], [-1.8973]], [[-1.9921], [-1.1585], [-0.9141], [-2.0277]]], [[[-1.0874], [-0.6275], [0.1926], [-1.4039]], [[-1.6924], [-1.3756], [-0.4454], [-1.7273]], [[-1.2747], [-1.4031], [0.1339], [-1.8942]]], [[[-1.0874], [-0.6275], [0.1926], [-1.4039]], [[-1.6924], [-1.3756], [-0.4454], [-1.7273]], [[-1.2747], [-1.4031], [0.1339], [-1.8942]]]]]