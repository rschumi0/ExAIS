import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min31866 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min31866 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Sof12504 = tf.keras.layers.Input(shape=([2, 1, 2]))

Min31866 = keras.layers.Minimum(name = 'Min31866', )([in0Min31866,in1Min31866])
Res30173 = keras.layers.Reshape((1, 2), name = 'Res30173', )(Min31866)
Sof12504 = keras.layers.Softmax(axis=1, name = 'Sof12504', input_shape=(2, 1, 2))(in0Sof12504)
Res86894 = keras.layers.Reshape((2, 2), name = 'Res86894', )(Sof12504)
Cro31820 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro31820', )(Res86894)
Mul72501 = keras.layers.Multiply(name = 'Mul72501', )([Res30173,Cro31820])
Bat44105 = keras.layers.BatchNormalization(axis=1, epsilon=0.476741153070513,  name = 'Bat44105', )(Mul72501)
model = tf.keras.models.Model(inputs=[in0Min31866,in1Min31866,in0Sof12504], outputs=Bat44105)
w = model.get_layer('Bat44105').get_weights() 
w[0] = np.array([0.2041])
w[1] = np.array([0.2952])
w[2] = np.array([0.4795])
w[3] = np.array([0.2907])
model.get_layer('Bat44105').set_weights(w) 
in0Min31866 = tf.constant([[[[0.0986], [0.2506]]]])
in1Min31866 = tf.constant([[[[0.6383], [0.6277]]]])
in0Sof12504 = tf.constant([[[[0.5768, 0.4738]], [[0.0058, 0.511]]]])
print (np.array2string(model.predict([in0Min31866,in1Min31866,in0Sof12504],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat44105.png')

LMin31866 = minimum_layer([[[[[0.0986], [0.2506]]]], [[[[0.6383], [0.6277]]]]], Min31866), 
LRes30173 = reshape_layer(Min31866, [1, 2], Res30173), 
LSof12504 = softmax_layer([[[[0.5768, 0.4738]], [[0.0058, 0.511]]]], 1, Sof12504), 
LRes86894 = reshape_layer(Sof12504, [2, 2], Res86894), 
LCro31820 = cropping1D_layer(Res86894, 1, 0, Cro31820), 
LMul72501 = multiply_layer([Res30173,Cro31820], Mul72501), 
LBat44105 = batch_normalization_layer(Mul72501, 1, 0.476741153070513, [0.2041], [0.2952], [0.4795], [0.2907], Bat44105), 
exec_layers([LMin31866,LRes30173,LSof12504,LRes86894,LCro31820,LMul72501,LBat44105],["Min31866","Res30173","Sof12504","Res86894","Cro31820","Mul72501","Bat44105"],Bat44105,"Bat44105")

Actual (Unparsed): [[[0.1917786, 0.2132211]]]

Expected (Unparsed): [[[0.1917786264793785,0.21322105603325753]]]

Actual:   [[[0.1918, 0.2133]]]

Expected: [[[0.1918, 0.2133]]]