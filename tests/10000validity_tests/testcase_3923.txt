import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo88105 = tf.keras.layers.Input(shape=([1, 2, 1]))

Glo88105 = keras.layers.GlobalAveragePooling2D(name = 'Glo88105', )(in0Glo88105)
Res31413 = keras.layers.Reshape((1, 1), name = 'Res31413', )(Glo88105)
Per13106 = keras.layers.Permute((1,2), name = 'Per13106',)(Res31413)
Res1500 = keras.layers.Reshape((1, 1, 1), name = 'Res1500', )(Per13106)
Sep14188 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep14188', )(Res1500)
Res61960 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res61960', )(Sep14188)
PRe85081 = keras.layers.PReLU(name = 'PRe85081', )(Res61960)
Res28310 = keras.layers.Reshape((1, 1, 4), name = 'Res28310', )(PRe85081)
Res81600 = keras.layers.Reshape((1, 4), name = 'Res81600', )(Res28310)
LST18934 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST18934', )(Res81600)
model = tf.keras.models.Model(inputs=[in0Glo88105], outputs=LST18934)
w = model.get_layer('Sep14188').get_weights() 
w[0] = np.array([[[[0.4248]]]])
w[1] = np.array([[[[0.3462, 0.4302, 0.278, 0.6811]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep14188').set_weights(w) 
w = model.get_layer('PRe85081').get_weights() 
w[0] = np.array([[[[0.7424], [0.3135], [0.8495], [0.4388]]]])
model.get_layer('PRe85081').set_weights(w) 
w = model.get_layer('LST18934').get_weights() 
w[0] = np.array([[10, 6, 6, 5, 1, 5, 1, 10], [2, 1, 2, 2, 2, 2, 10, 10], [1, 5, 8, 8, 9, 1, 8, 1], [1, 2, 10, 6, 4, 5, 7, 1]])
w[1] = np.array([[6, 3, 1, 7, 1, 10, 7, 1], [10, 7, 2, 3, 9, 9, 1, 6]])
w[2] = np.array([4, 8, 8, 6, 7, 4, 6, 9])
model.get_layer('LST18934').set_weights(w) 
in0Glo88105 = tf.constant([[[[1.4619], [1.5293]]]])
print (np.array2string(model.predict([in0Glo88105],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST18934.png')

LGlo88105 = global_average_pooling2D_layer([[[[1.4619], [1.5293]]]], Glo88105), 
LRes31413 = reshape_layer(Glo88105, [1, 1], Res31413), 
LPer13106 = permute_layer(Res31413, 1,2, Per13106), 
LRes1500 = reshape_layer(Per13106, [1, 1, 1], Res1500), 
LSep14188 = separable_conv2D_layer(Res1500, 1, 1,[[[[[0.4248]]]],[[[[0.3462, 0.4302, 0.278, 0.6811]]]]],[0, 0, 0, 0], 1, 1, false, Sep14188), 
LRes61960 = reshape_layer(Sep14188, [1, 1, 4, 1], Res61960), 
LPRe85081 = prelu_layer(Res61960, [[[[0.7424], [0.3135], [0.8495], [0.4388]]]], PRe85081), 
LRes28310 = reshape_layer(PRe85081, [1, 1, 4], Res28310), 
LRes81600 = reshape_layer(Res28310, [1, 4], Res81600), 
LLST18934 = lstm_layer(Res81600,[[10, 6, 6, 5, 1, 5, 1, 10], [2, 1, 2, 2, 2, 2, 10, 10], [1, 5, 8, 8, 9, 1, 8, 1], [1, 2, 10, 6, 4, 5, 7, 1]],[[6, 3, 1, 7, 1, 10, 7, 1], [10, 7, 2, 3, 9, 9, 1, 6]],[4, 8, 8, 6, 7, 4, 6, 9], LST18934), 
exec_layers([LGlo88105,LRes31413,LPer13106,LRes1500,LSep14188,LRes61960,LPRe85081,LRes28310,LRes81600,LLST18934],["Glo88105","Res31413","Per13106","Res1500","Sep14188","Res61960","PRe85081","Res28310","Res81600","LST18934"],LST18934,"LST18934")

Actual (Unparsed): [[0.7613246, 0.7615887]]

Expected (Unparsed): [[0.7613246455312325,0.7615887059513109]]

Actual:   [[0.7614, 0.7616]]

Expected: [[0.7614, 0.7616]]