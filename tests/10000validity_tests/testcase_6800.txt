import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min22246 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Min22246 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Min22246 = keras.layers.Minimum(name = 'Min22246', )([in0Min22246,in1Min22246])
Res35148 = keras.layers.Reshape((2, 1, 1), name = 'Res35148', )(Min22246)
Res1763 = keras.layers.Reshape((2, 1), name = 'Res1763', )(Res35148)
Sim77445 = keras.layers.SimpleRNN(3,name = 'Sim77445', )(Res1763)
model = tf.keras.models.Model(inputs=[in0Min22246,in1Min22246], outputs=Sim77445)
w = model.get_layer('Sim77445').get_weights() 
w[0] = np.array([[5, 5, 6]])
w[1] = np.array([[2, 2, 6], [1, 10, 5], [10, 3, 8]])
w[2] = np.array([6, 10, 4])
model.get_layer('Sim77445').set_weights(w) 
in0Min22246 = tf.constant([[[[[0.1988]]], [[[0.8167]]]]])
in1Min22246 = tf.constant([[[[[0.4783]]], [[[0.0803]]]]])
print (np.array2string(model.predict([in0Min22246,in1Min22246],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim77445.png')

LMin22246 = minimum_layer([[[[[[0.1988]]], [[[0.8167]]]]], [[[[[0.4783]]], [[[0.0803]]]]]], Min22246), 
LRes35148 = reshape_layer(Min22246, [2, 1, 1], Res35148), 
LRes1763 = reshape_layer(Res35148, [2, 1], Res1763), 
LSim77445 = simple_rnn_layer(Res1763,[[5, 5, 6]],[[2, 2, 6], [1, 10, 5], [10, 3, 8]],[6, 10, 4], Sim77445), 
exec_layers([LMin22246,LRes35148,LRes1763,LSim77445],["Min22246","Res35148","Res1763","Sim77445"],Sim77445,"Sim77445")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0,1.0]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]