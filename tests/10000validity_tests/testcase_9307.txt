import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add87446 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Add87446 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con52645 = tf.keras.layers.Input(shape=([2, 2, 3]))
in0Ave75408 = tf.keras.layers.Input(shape=([2, 2, 1]))

Add87446 = keras.layers.Add(name = 'Add87446', )([in0Add87446,in1Add87446])
Res54742 = keras.layers.Reshape((2, 2, 1), name = 'Res54742', )(Add87446)
Con52645 = keras.layers.Concatenate(axis=3, name = 'Con52645', )([Res54742,in0Con52645])
Ave75408 = keras.layers.AveragePooling2D(pool_size=(1, 2), strides=(2, 2), padding='valid', name = 'Ave75408', )(in0Ave75408)
Mas22244 = keras.layers.Masking(mask_value=2, name = 'Mas22244', )(Ave75408)
Zer32989 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer32989', )(Mas22244)
Sep22019 = keras.layers.SeparableConv2D(4, (2, 2),strides=(2, 2), padding='valid', name = 'Sep22019', )(Zer32989)
Zer60438 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer60438', )(Sep22019)
Min54893 = keras.layers.Minimum(name = 'Min54893', )([Con52645,Zer60438])
model = tf.keras.models.Model(inputs=[in0Add87446,in1Add87446,in0Con52645,in0Ave75408], outputs=Min54893)
w = model.get_layer('Sep22019').get_weights() 
w[0] = np.array([[[[0.1717]], [[0.8435]]], [[[0.1666]], [[0.5025]]]])
w[1] = np.array([[[[0.2693, 0.1225, 0.8031, 0.408]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep22019').set_weights(w) 
in0Add87446 = tf.constant([[[[[0.0249]], [[0.9401]]], [[[0.8595]], [[0.4811]]]]])
in1Add87446 = tf.constant([[[[[0.5185]], [[0.1525]]], [[[0.7545]], [[0.5311]]]]])
in0Con52645 = tf.constant([[[[0.8623, 0.3216, 0.4129], [0.34, 0.5863, 0.8303]], [[0.71, 0.851, 0.8011], [0.7797, 0.4654, 0.8416]]]])
in0Ave75408 = tf.constant([[[[1.3617], [1.5146]], [[1.6849], [1.9334]]]])
print (np.array2string(model.predict([in0Add87446,in1Add87446,in0Con52645,in0Ave75408],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min54893.png')

LAdd87446 = add_layer([[[[[[0.0249]], [[0.9401]]], [[[0.8595]], [[0.4811]]]]], [[[[[0.5185]], [[0.1525]]], [[[0.7545]], [[0.5311]]]]]], Add87446), 
LRes54742 = reshape_layer(Add87446, [2, 2, 1], Res54742), 
LCon52645 = concatenate_layer([Res54742,[[[[0.8623, 0.3216, 0.4129], [0.34, 0.5863, 0.8303]], [[0.71, 0.851, 0.8011], [0.7797, 0.4654, 0.8416]]]]], 3, Con52645), 
LAve75408 = average_pooling2D_layer([[[[1.3617], [1.5146]], [[1.6849], [1.9334]]]], 1, 2, 2, 2, false, Ave75408), 
LMas22244 = masking_layer(Ave75408, 2, Mas22244), 
LZer32989 = zero_padding2D_layer(Mas22244, 1, 1, 1, 1, Zer32989), 
LSep22019 = separable_conv2D_layer(Zer32989, 2, 2,[[[[[0.1717]], [[0.8435]]], [[[0.1666]], [[0.5025]]]],[[[[0.2693, 0.1225, 0.8031, 0.408]]]]],[0, 0, 0, 0], 2, 2, false, Sep22019), 
LZer60438 = zero_padding2D_layer(Sep22019, 1, 0, 1, 0, Zer60438), 
LMin54893 = minimum_layer([Con52645,Zer60438], Min54893), 
exec_layers([LAdd87446,LRes54742,LCon52645,LAve75408,LMas22244,LZer32989,LSep22019,LZer60438,LMin54893],["Add87446","Res54742","Con52645","Ave75408","Mas22244","Zer32989","Sep22019","Zer60438","Min54893"],Min54893,"Min54893")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.1946151, 0.0885271, 0.4654000, 0.2948495]]]]

Expected (Unparsed): [[[[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[0.19461513198749994,0.08852712093749998,0.4654,0.29484951299999995]]]]

Actual:   [[[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0.1947, 0.0886, 0.4654, 0.2949]]]]

Expected: [[[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0.1947, 0.0886, 0.4654, 0.2949]]]]