import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add95584 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Add95584 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Add95584 = keras.layers.Add(name = 'Add95584', )([in0Add95584,in1Add95584])
Res88714 = keras.layers.Reshape((2, 2, 2), name = 'Res88714', )(Add95584)
Res31611 = keras.layers.Reshape((2, 4), name = 'Res31611', )(Res88714)
Loc71395 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc71395', )(Res31611)
Res27347 = keras.layers.Reshape((2, 4, 1), name = 'Res27347', )(Loc71395)
Glo94490 = keras.layers.GlobalMaxPool2D(name = 'Glo94490', )(Res27347)
model = tf.keras.models.Model(inputs=[in0Add95584,in1Add95584], outputs=Glo94490)
w = model.get_layer('Loc71395').get_weights() 
w[0] = np.array([[[0.1356, 0.4755, 0.306, 0.377], [0.8661, 0.9572, 0.3317, 0.2868], [0.6216, 0.8202, 0.526, 0.8714], [0.0857, 0.5289, 0.4716, 0.986]], [[0.4244, 0.6396, 0.5757, 0.6617], [0.7936, 0.6655, 0.7891, 0.2267], [0.5055, 0.3692, 0.665, 0.2578], [0.3333, 0.6428, 0.5241, 0.5586]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc71395').set_weights(w) 
in0Add95584 = tf.constant([[[[[0.9314], [0.371]], [[0.0429], [0.4577]]], [[[0.1112], [0.5018]], [[0.7754], [0.4251]]]]])
in1Add95584 = tf.constant([[[[[0.9188], [0.7509]], [[0.4749], [0.5167]]], [[[0.1112], [0.8069]], [[0.4865], [0.0403]]]]])
print (np.array2string(model.predict([in0Add95584,in1Add95584],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo94490.png')

LAdd95584 = add_layer([[[[[[0.9314], [0.371]], [[0.0429], [0.4577]]], [[[0.1112], [0.5018]], [[0.7754], [0.4251]]]]], [[[[[0.9188], [0.7509]], [[0.4749], [0.5167]]], [[[0.1112], [0.8069]], [[0.4865], [0.0403]]]]]], Add95584), 
LRes88714 = reshape_layer(Add95584, [2, 2, 2], Res88714), 
LRes31611 = reshape_layer(Res88714, [2, 4], Res31611), 
LLoc71395 = locally_connected1D_layer(Res31611, 1,[[[0.1356, 0.4755, 0.306, 0.377], [0.8661, 0.9572, 0.3317, 0.2868], [0.6216, 0.8202, 0.526, 0.8714], [0.0857, 0.5289, 0.4716, 0.986]], [[0.4244, 0.6396, 0.5757, 0.6617], [0.7936, 0.6655, 0.7891, 0.2267], [0.5055, 0.3692, 0.665, 0.2578], [0.3333, 0.6428, 0.5241, 0.5586]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc71395), 
LRes27347 = reshape_layer(Loc71395, [2, 4, 1], Res27347), 
LGlo94490 = global_max_pool2D_layer(Res27347, Glo94490), 
exec_layers([LAdd95584,LRes88714,LRes31611,LLoc71395,LRes27347,LGlo94490],["Add95584","Res88714","Res31611","Loc71395","Res27347","Glo94490"],Glo94490,"Glo94490")

Actual (Unparsed): [[2.8937125]]

Expected (Unparsed): [[2.8937125000000004]]

Actual:   [[2.8938]]

Expected: [[2.8938]]