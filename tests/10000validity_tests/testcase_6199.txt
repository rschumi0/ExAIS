import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave33738 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave33738 = tf.keras.layers.Input(shape=([1, 1, 2]))

Ave33738 = keras.layers.Average(name = 'Ave33738', )([in0Ave33738,in1Ave33738])
Res64248 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res64248', )(Ave33738)
PRe14428 = keras.layers.PReLU(name = 'PRe14428', )(Res64248)
model = tf.keras.models.Model(inputs=[in0Ave33738,in1Ave33738], outputs=PRe14428)
w = model.get_layer('PRe14428').get_weights() 
w[0] = np.array([[[[0.0266], [0.3426]]]])
model.get_layer('PRe14428').set_weights(w) 
in0Ave33738 = tf.constant([[[[0.9956, 0.386]]]])
in1Ave33738 = tf.constant([[[[0.034, 0.2217]]]])
print (np.array2string(model.predict([in0Ave33738,in1Ave33738],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe14428.png')

LAve33738 = average_layer([[[[[0.9956, 0.386]]]], [[[[0.034, 0.2217]]]]], Ave33738), 
LRes64248 = reshape_layer(Ave33738, [1, 1, 2, 1], Res64248), 
LPRe14428 = prelu_layer(Res64248, [[[[0.0266], [0.3426]]]], PRe14428), 
exec_layers([LAve33738,LRes64248,LPRe14428],["Ave33738","Res64248","PRe14428"],PRe14428,"PRe14428")

Actual (Unparsed): [[[[[0.5148000], [0.3038500]]]]]

Expected (Unparsed): [[[[[0.5148],[0.30385]]]]]

Actual:   [[[[[0.5148], [0.3039]]]]]

Expected: [[[[[0.5148], [0.3039]]]]]