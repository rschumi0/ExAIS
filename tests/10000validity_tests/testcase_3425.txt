import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST60775 = tf.keras.layers.Input(shape=([2, 3]))
in0LST91154 = tf.keras.layers.Input(shape=([2, 3]))
in0Con30667 = tf.keras.layers.Input(shape=([1]))
in0Ave69537 = tf.keras.layers.Input(shape=([1, 2]))
in0Con82139 = tf.keras.layers.Input(shape=([1]))

LST60775 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST60775', )(in0LST60775)
LST91154 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST91154', )(in0LST91154)
Res86300 = keras.layers.Reshape((2, 1), name = 'Res86300', )(LST91154)
Ave71020 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='same', name = 'Ave71020', )(Res86300)
Res67015 = keras.layers.Reshape((2, 1, 1), name = 'Res67015', )(Ave71020)
Res27818 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res27818', )(Res67015)
Glo44746 = keras.layers.GlobalMaxPool3D(name = 'Glo44746', )(Res27818)
Con30667 = keras.layers.Concatenate(axis=1, name = 'Con30667', )([Glo44746,in0Con30667])
Max46277 = keras.layers.Maximum(name = 'Max46277', )([LST60775,Con30667])
Ave69537 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave69537', )(in0Ave69537)
Res50065 = keras.layers.Reshape((1, 2, 1), name = 'Res50065', )(Ave69537)
Loc12354 = keras.layers.LocallyConnected2D(3, (1, 2),strides=(1, 1), name = 'Loc12354', )(Res50065)
Res48024 = keras.layers.Reshape((1, 3), name = 'Res48024', )(Loc12354)
Glo86844 = keras.layers.GlobalMaxPool1D(name = 'Glo86844', )(Res48024)
Res8673 = keras.layers.Reshape((3, 1), name = 'Res8673', )(Glo86844)
Res24071 = keras.layers.Reshape((3, 1, 1), name = 'Res24071', )(Res8673)
Glo40405 = keras.layers.GlobalAveragePooling2D(name = 'Glo40405', )(Res24071)
Con82139 = keras.layers.Concatenate(axis=1, name = 'Con82139', )([Glo40405,in0Con82139])
Max74556 = keras.layers.Maximum(name = 'Max74556', )([Max46277,Con82139])
model = tf.keras.models.Model(inputs=[in0LST60775,in0LST91154,in0Con30667,in0Ave69537,in0Con82139], outputs=Max74556)
w = model.get_layer('LST60775').get_weights() 
w[0] = np.array([[6, 3, 3, 9, 8, 4, 7, 5], [9, 10, 3, 10, 10, 4, 7, 2], [10, 2, 6, 7, 10, 4, 1, 10]])
w[1] = np.array([[10, 1, 1, 9, 3, 7, 9, 2], [7, 5, 4, 9, 9, 9, 5, 2]])
w[2] = np.array([2, 6, 5, 3, 10, 1, 5, 8])
model.get_layer('LST60775').set_weights(w) 
w = model.get_layer('LST91154').get_weights() 
w[0] = np.array([[2, 10, 1, 5, 10, 7, 10, 3], [2, 2, 1, 9, 5, 10, 2, 7], [5, 9, 2, 9, 7, 2, 3, 7]])
w[1] = np.array([[1, 4, 8, 5, 10, 4, 6, 9], [2, 4, 5, 3, 8, 4, 7, 7]])
w[2] = np.array([5, 4, 8, 1, 8, 4, 7, 6])
model.get_layer('LST91154').set_weights(w) 
w = model.get_layer('Loc12354').get_weights() 
w[0] = np.array([[[0.5778, 0.3097, 0.7732], [0.6744, 0.9724, 0.1974]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc12354').set_weights(w) 
in0LST60775 = tf.constant([[[9, 5, 5], [1, 3, 8]]])
in0LST91154 = tf.constant([[[3, 1, 4], [10, 4, 8]]])
in0Con30667 = tf.constant([[0.7425]])
in0Ave69537 = tf.constant([[[1.24, 1.2322]]])
in0Con82139 = tf.constant([[0.4726]])
print (np.array2string(model.predict([in0LST60775,in0LST91154,in0Con30667,in0Ave69537,in0Con82139],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max74556.png')

LLST60775 = lstm_layer([[[9, 5, 5], [1, 3, 8]]],[[6, 3, 3, 9, 8, 4, 7, 5], [9, 10, 3, 10, 10, 4, 7, 2], [10, 2, 6, 7, 10, 4, 1, 10]],[[10, 1, 1, 9, 3, 7, 9, 2], [7, 5, 4, 9, 9, 9, 5, 2]],[2, 6, 5, 3, 10, 1, 5, 8], LST60775), 
LLST91154 = lstm_layer([[[3, 1, 4], [10, 4, 8]]],[[2, 10, 1, 5, 10, 7, 10, 3], [2, 2, 1, 9, 5, 10, 2, 7], [5, 9, 2, 9, 7, 2, 3, 7]],[[1, 4, 8, 5, 10, 4, 6, 9], [2, 4, 5, 3, 8, 4, 7, 7]],[5, 4, 8, 1, 8, 4, 7, 6], LST91154), 
LRes86300 = reshape_layer(LST91154, [2, 1], Res86300), 
LAve71020 = average_pooling1D_layer(Res86300, 1, 1, true, Ave71020), 
LRes67015 = reshape_layer(Ave71020, [2, 1, 1], Res67015), 
LRes27818 = reshape_layer(Res67015, [2, 1, 1, 1], Res27818), 
LGlo44746 = global_max_pool3D_layer(Res27818, Glo44746), 
LCon30667 = concatenate_layer([Glo44746,[[0.7425]]], 1, Con30667), 
LMax46277 = maximum_layer([LST60775,Con30667], Max46277), 
LAve69537 = average_pooling1D_layer([[[1.24, 1.2322]]], 1, Ave69537), 
LRes50065 = reshape_layer(Ave69537, [1, 2, 1], Res50065), 
LLoc12354 = locally_connected2D_layer(Res50065, 1, 2,[[[0.5778, 0.3097, 0.7732], [0.6744, 0.9724, 0.1974]]],[[[0, 0, 0]]], 1, 1, Loc12354), 
LRes48024 = reshape_layer(Loc12354, [1, 3], Res48024), 
LGlo86844 = global_max_pool1D_layer(Res48024, Glo86844), 
LRes8673 = reshape_layer(Glo86844, [3, 1], Res8673), 
LRes24071 = reshape_layer(Res8673, [3, 1, 1], Res24071), 
LGlo40405 = global_average_pooling2D_layer(Res24071, Glo40405), 
LCon82139 = concatenate_layer([Glo40405,[[0.4726]]], 1, Con82139), 
LMax74556 = maximum_layer([Max46277,Con82139], Max74556), 
exec_layers([LLST60775,LLST91154,LRes86300,LAve71020,LRes67015,LRes27818,LGlo44746,LCon30667,LMax46277,LAve69537,LRes50065,LLoc12354,LRes48024,LGlo86844,LRes8673,LRes24071,LGlo40405,LCon82139,LMax74556],["LST60775","LST91154","Res86300","Ave71020","Res67015","Res27818","Glo44746","Con30667","Max46277","Ave69537","Res50065","Loc12354","Res48024","Glo86844","Res8673","Res24071","Glo40405","Con82139","Max74556"],Max74556,"Max74556")

Actual (Unparsed): [[1.4438971, 0.9640276]]

Expected (Unparsed): [[1.44389708,0.9640275800758169]]

Actual:   [[1.4439, 0.9641]]

Expected: [[1.4439, 0.9641]]