import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla75507 = tf.keras.layers.Input(shape=([3, 1]))

Fla75507 = keras.layers.Flatten(name = 'Fla75507', )(in0Fla75507)
Bat90971 = keras.layers.BatchNormalization(axis=1, epsilon=0.17304033616885464,  name = 'Bat90971', )(Fla75507)
Res17453 = keras.layers.Reshape((3, 1), name = 'Res17453', )(Bat90971)
Con10894 = keras.layers.Conv1D(4, (3),strides=(1), padding='same', dilation_rate=(1), name = 'Con10894', )(Res17453)
model = tf.keras.models.Model(inputs=[in0Fla75507], outputs=Con10894)
w = model.get_layer('Bat90971').get_weights() 
w[0] = np.array([0.0387, 0.8691, 0.7802])
w[1] = np.array([0.8892, 0.9208, 0.032])
w[2] = np.array([0.257, 0.5816, 0.1839])
w[3] = np.array([0.606, 0.859, 0.6074])
model.get_layer('Bat90971').set_weights(w) 
w = model.get_layer('Con10894').get_weights() 
w[0] = np.array([[[0.4864, 0.0483, 0.6841, 0.8031]], [[0.6458, 0.1801, 0.3068, 0.7671]], [[0.9662, 0.6344, 0.238, 0.5278]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con10894').set_weights(w) 
in0Fla75507 = tf.constant([[[1.2718], [1.9315], [1.7416]]])
print (np.array2string(model.predict([in0Fla75507],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con10894.png')

LFla75507 = flatten_layer([[[1.2718], [1.9315], [1.7416]]], Fla75507), 
LBat90971 = batch_normalization_layer(Fla75507, 1, 0.17304033616885464, [0.0387, 0.8691, 0.7802], [0.8892, 0.9208, 0.032], [0.257, 0.5816, 0.1839], [0.606, 0.859, 0.6074], Bat90971), 
LRes17453 = reshape_layer(Bat90971, [3, 1], Res17453), 
LCon10894 = conv1D_layer(Res17453, 3,[[[0.4864, 0.0483, 0.6841, 0.8031]], [[0.6458, 0.1801, 0.3068, 0.7671]], [[0.9662, 0.6344, 0.238, 0.5278]]],[0, 0, 0, 0], 1, true, 1, Con10894), 
exec_layers([LFla75507,LBat90971,LRes17453,LCon10894],["Fla75507","Bat90971","Res17453","Con10894"],Con10894,"Con10894")

Actual (Unparsed): [[[2.6084666, 1.4849465, 0.7804607, 1.8117619], [3.1547077, 1.3119580, 1.6105778, 3.0850540], [1.9186777, 0.3537782, 1.8518261, 2.7467864]]]

Expected (Unparsed): [[[2.608466681118314,1.484946503194948,0.7804607088400308,1.8117619203438493],[3.1547076544867325,1.3119579985528924,1.6105778082425957,3.085054017579365],[1.9186776747775536,0.35377815310543825,1.8518261376565586,2.7467864080961313]]]

Actual:   [[[2.6085, 1.485, 0.7805, 1.8118], [3.1548, 1.312, 1.6106, 3.0851], [1.9187, 0.3538, 1.8519, 2.7468]]]

Expected: [[[2.6085, 1.485, 0.7805, 1.8118], [3.1548, 1.312, 1.6106, 3.0851], [1.9187, 0.3538, 1.8519, 2.7468]]]