import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr6128 = tf.keras.layers.Input(shape=([1, 2, 2]))

Thr6128 = keras.layers.ThresholdedReLU(theta=1.3919946669481225, name = 'Thr6128', input_shape=(1, 2, 2))(in0Thr6128)
Res2769 = keras.layers.Reshape((1, 4), name = 'Res2769', )(Thr6128)
Res47935 = keras.layers.Reshape((1, 4, 1), name = 'Res47935', )(Res2769)
Res35289 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res35289', )(Res47935)
Glo53070 = keras.layers.GlobalAveragePooling3D(name = 'Glo53070', )(Res35289)
Res91311 = keras.layers.Reshape((1, 1), name = 'Res91311', )(Glo53070)
Res63239 = keras.layers.Reshape((1, 1, 1), name = 'Res63239', )(Res91311)
Zer42201 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer42201', )(Res63239)
model = tf.keras.models.Model(inputs=[in0Thr6128], outputs=Zer42201)
in0Thr6128 = tf.constant([[[[0.3163, 0.6636], [0.8045, 0.622]]]])
print (np.array2string(model.predict([in0Thr6128],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer42201.png')

LThr6128 = thresholded_relu_layer([[[[0.3163, 0.6636], [0.8045, 0.622]]]], 1.3919946669481225, Thr6128), 
LRes2769 = reshape_layer(Thr6128, [1, 4], Res2769), 
LRes47935 = reshape_layer(Res2769, [1, 4, 1], Res47935), 
LRes35289 = reshape_layer(Res47935, [1, 4, 1, 1], Res35289), 
LGlo53070 = global_average_pooling3D_layer(Res35289, Glo53070), 
LRes91311 = reshape_layer(Glo53070, [1, 1], Res91311), 
LRes63239 = reshape_layer(Res91311, [1, 1, 1], Res63239), 
LZer42201 = zero_padding2D_layer(Res63239, 1, 1, 1, 1, Zer42201), 
exec_layers([LThr6128,LRes2769,LRes47935,LRes35289,LGlo53070,LRes91311,LRes63239,LZer42201],["Thr6128","Res2769","Res47935","Res35289","Glo53070","Res91311","Res63239","Zer42201"],Zer42201,"Zer42201")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]

Actual:   [[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]