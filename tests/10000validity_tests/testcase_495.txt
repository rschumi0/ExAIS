import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul37669 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul37669 = tf.keras.layers.Input(shape=([2, 2]))
in0Sep95438 = tf.keras.layers.Input(shape=([1, 2]))

Mul37669 = keras.layers.Multiply(name = 'Mul37669', )([in0Mul37669,in1Mul37669])
Sep95438 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep95438', )(in0Sep95438)
Dot49986 = keras.layers.Dot(axes=(2, 2), name = 'Dot49986', )([Mul37669,Sep95438])
Res55536 = keras.layers.Reshape((2, 1, 1), name = 'Res55536', )(Dot49986)
Res38363 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res38363', )(Res55536)
Con53319 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con53319', )(Res38363)
Con98429 = keras.layers.Conv3D(3, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con98429', )(Con53319)
model = tf.keras.models.Model(inputs=[in0Mul37669,in1Mul37669,in0Sep95438], outputs=Con98429)
w = model.get_layer('Sep95438').get_weights() 
w[0] = np.array([[[0.6924], [0.4382]]])
w[1] = np.array([[[0.1298, 0.691], [0.3977, 0.277]]])
w[2] = np.array([0, 0])
model.get_layer('Sep95438').set_weights(w) 
w = model.get_layer('Con53319').get_weights() 
w[0] = np.array([[[[[0.5672], [0.5534], [0.8446]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con53319').set_weights(w) 
w = model.get_layer('Con98429').get_weights() 
w[0] = np.array([[[[[0.3791, 0.4799, 0.5099], [0.1972, 0.9791, 0.2291], [0.196, 0.6286, 0.0964]]]], [[[[0.7483, 0.5287, 0.8108], [0.8699, 0.6973, 0.8905], [0.4172, 0.604, 0.7551]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con98429').set_weights(w) 
in0Mul37669 = tf.constant([[[0.1085, 0.3972], [0.0705, 0.6869]]])
in1Mul37669 = tf.constant([[[0.5614, 0.9238], [0.1523, 0.4722]]])
in0Sep95438 = tf.constant([[[0.2856, 0.3745]]])
print (np.array2string(model.predict([in0Mul37669,in1Mul37669,in0Sep95438],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con98429.png')

LMul37669 = multiply_layer([[[[0.1085, 0.3972], [0.0705, 0.6869]]], [[[0.5614, 0.9238], [0.1523, 0.4722]]]], Mul37669), 
LSep95438 = separable_conv1D_layer([[[0.2856, 0.3745]]], 1,[[[[0.6924], [0.4382]]],[[[0.1298, 0.691], [0.3977, 0.277]]]],[0, 0], 1, true, Sep95438), 
LDot49986 = dot_layer(Mul37669,Sep95438, 2, 2, Dot49986), 
LRes55536 = reshape_layer(Dot49986, [2, 1, 1], Res55536), 
LRes38363 = reshape_layer(Res55536, [2, 1, 1, 1], Res38363), 
LCon53319 = conv3D_transpose_layer(Res38363, 1, 1, 1,[[[[[0.5672], [0.5534], [0.8446]]]]],[0, 0, 0], 1, 1, 1, true, Con53319), 
LCon98429 = conv3D_layer(Con53319, 2, 1, 1,[[[[[0.3791, 0.4799, 0.5099], [0.1972, 0.9791, 0.2291], [0.196, 0.6286, 0.0964]]]], [[[[0.7483, 0.5287, 0.8108], [0.8699, 0.6973, 0.8905], [0.4172, 0.604, 0.7551]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con98429), 
exec_layers([LMul37669,LSep95438,LDot49986,LRes55536,LRes38363,LCon53319,LCon98429],["Mul37669","Sep95438","Dot49986","Res55536","Res38363","Con53319","Con98429"],Con98429,"Con98429")

Actual (Unparsed): [[[[[0.1109788, 0.1691225, 0.1314859]]], [[[0.0294024, 0.0807534, 0.0298660]]]]]

Expected (Unparsed): [[[[[0.11097880314012232,0.16912251519125304,0.1314858518545334]]],[[[0.029402407599857718,0.08075337153069846,0.02986599523684625]]]]]

Actual:   [[[[[0.111, 0.1692, 0.1315]]], [[[0.0295, 0.0808, 0.0299]]]]]

Expected: [[[[[0.111, 0.1692, 0.1315]]], [[[0.0295, 0.0808, 0.0299]]]]]