import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub23947 = tf.keras.layers.Input(shape=([3]))
in1Sub23947 = tf.keras.layers.Input(shape=([3]))

Sub23947 = keras.layers.Subtract(name = 'Sub23947', )([in0Sub23947,in1Sub23947])
Bat69971 = keras.layers.BatchNormalization(axis=1, epsilon=0.7864014653081645,  name = 'Bat69971', )(Sub23947)
Res62765 = keras.layers.Reshape((3, 1), name = 'Res62765', )(Bat69971)
Res17211 = keras.layers.Reshape((3, 1, 1), name = 'Res17211', )(Res62765)
Res89421 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res89421', )(Res17211)
Zer40005 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer40005', )(Res89421)
model = tf.keras.models.Model(inputs=[in0Sub23947,in1Sub23947], outputs=Zer40005)
w = model.get_layer('Bat69971').get_weights() 
w[0] = np.array([0.592, 0.9505, 0.7634])
w[1] = np.array([0.1733, 0.5903, 0.5184])
w[2] = np.array([0.6409, 0.2481, 0.979])
w[3] = np.array([0.6184, 0.2621, 0.7555])
model.get_layer('Bat69971').set_weights(w) 
in0Sub23947 = tf.constant([[0.1496, 0.4408, 0.6146]])
in1Sub23947 = tf.constant([[0.7218, 0.9131, 0.9568]])
print (np.array2string(model.predict([in0Sub23947,in1Sub23947],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer40005.png')

LSub23947 = subtract_layer([[0.1496, 0.4408, 0.6146]], [[0.7218, 0.9131, 0.9568]], Sub23947), 
LBat69971 = batch_normalization_layer(Sub23947, 1, 0.7864014653081645, [0.592, 0.9505, 0.7634], [0.1733, 0.5903, 0.5184], [0.6409, 0.2481, 0.979], [0.6184, 0.2621, 0.7555], Bat69971), 
LRes62765 = reshape_layer(Bat69971, [3, 1], Res62765), 
LRes17211 = reshape_layer(Res62765, [3, 1, 1], Res17211), 
LRes89421 = reshape_layer(Res17211, [3, 1, 1, 1], Res89421), 
LZer40005 = zero_padding3D_layer(Res89421, 1, 1, 1, 1, 1, 1, Zer40005), 
exec_layers([LSub23947,LBat69971,LRes62765,LRes17211,LRes89421,LZer40005],["Sub23947","Bat69971","Res62765","Res17211","Res89421","Zer40005"],Zer40005,"Zer40005")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.4326138], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0784154], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.2938550], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[-0.4326137857405543],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[-0.07841536873802646],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[-0.29385503112123657],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.4326], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.0784], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.2938], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.4326], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.0784], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.2938], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]