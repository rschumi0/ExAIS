import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul37434 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul37434 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min36698 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Min36698 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Ave56285 = tf.keras.layers.Input(shape=([2, 2]))
in0Con25987 = tf.keras.layers.Input(shape=([2, 2]))
in0Bat72650 = tf.keras.layers.Input(shape=([1, 4, 1]))

Mul37434 = keras.layers.Multiply(name = 'Mul37434', )([in0Mul37434,in1Mul37434])
Res8277 = keras.layers.Reshape((2, 4), name = 'Res8277', )(Mul37434)
Min36698 = keras.layers.Minimum(name = 'Min36698', )([in0Min36698,in1Min36698])
Res17503 = keras.layers.Reshape((2, 4), name = 'Res17503', )(Min36698)
Ave56285 = keras.layers.AveragePooling1D(pool_size=(2), strides=(1), padding='same', name = 'Ave56285', )(in0Ave56285)
Con25987 = keras.layers.Concatenate(axis=2, name = 'Con25987', )([Ave56285,in0Con25987])
Add37689 = keras.layers.Add(name = 'Add37689', )([Res17503,Con25987])
Mul46419 = keras.layers.Multiply(name = 'Mul46419', )([Res8277,Add37689])
Res7451 = keras.layers.Reshape((2, 4, 1), name = 'Res7451', )(Mul46419)
Bat72650 = keras.layers.BatchNormalization(axis=3, epsilon=0.3104430277754273,  name = 'Bat72650', )(in0Bat72650)
Zer66347 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer66347', )(Bat72650)
Max47115 = keras.layers.Maximum(name = 'Max47115', )([Res7451,Zer66347])
Max7049 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 8), padding='valid', name = 'Max7049', )(Max47115)
model = tf.keras.models.Model(inputs=[in0Mul37434,in1Mul37434,in0Min36698,in1Min36698,in0Ave56285,in0Con25987,in0Bat72650], outputs=Max7049)
w = model.get_layer('Bat72650').get_weights() 
w[0] = np.array([0.7603])
w[1] = np.array([0.9087])
w[2] = np.array([0.3943])
w[3] = np.array([0.1353])
model.get_layer('Bat72650').set_weights(w) 
in0Mul37434 = tf.constant([[[[0.3235, 0.7433], [0.5774, 0.2632]], [[0.5695, 0.1933], [0.873, 0.2705]]]])
in1Mul37434 = tf.constant([[[[0.5412, 0.8266], [0.6014, 0.4779]], [[0.9307, 0.4212], [0.9274, 0.117]]]])
in0Min36698 = tf.constant([[[[0.1732, 0.1434], [0.2837, 0.2904]], [[0.7114, 0.831], [0.9341, 0.956]]]])
in1Min36698 = tf.constant([[[[0.2391, 0.7941], [0.8887, 0.2726]], [[0.4909, 0.4122], [0.7447, 0.9094]]]])
in0Ave56285 = tf.constant([[[1.7018, 1.0567], [1.2936, 1.0077]]])
in0Con25987 = tf.constant([[[0.4146, 0.3055], [0.0574, 0.1718]]])
in0Bat72650 = tf.constant([[[[1.0793], [1.034], [1.1506], [1.9676]]]])
print (np.array2string(model.predict([in0Mul37434,in1Mul37434,in0Min36698,in1Min36698,in0Ave56285,in0Con25987,in0Bat72650],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max7049.png')

LMul37434 = multiply_layer([[[[[0.3235, 0.7433], [0.5774, 0.2632]], [[0.5695, 0.1933], [0.873, 0.2705]]]], [[[[0.5412, 0.8266], [0.6014, 0.4779]], [[0.9307, 0.4212], [0.9274, 0.117]]]]], Mul37434), 
LRes8277 = reshape_layer(Mul37434, [2, 4], Res8277), 
LMin36698 = minimum_layer([[[[[0.1732, 0.1434], [0.2837, 0.2904]], [[0.7114, 0.831], [0.9341, 0.956]]]], [[[[0.2391, 0.7941], [0.8887, 0.2726]], [[0.4909, 0.4122], [0.7447, 0.9094]]]]], Min36698), 
LRes17503 = reshape_layer(Min36698, [2, 4], Res17503), 
LAve56285 = average_pooling1D_layer([[[1.7018, 1.0567], [1.2936, 1.0077]]], 2, 1, true, Ave56285), 
LCon25987 = concatenate_layer([Ave56285,[[[0.4146, 0.3055], [0.0574, 0.1718]]]], 2, Con25987), 
LAdd37689 = add_layer([Res17503,Con25987], Add37689), 
LMul46419 = multiply_layer([Res8277,Add37689], Mul46419), 
LRes7451 = reshape_layer(Mul46419, [2, 4, 1], Res7451), 
LBat72650 = batch_normalization_layer([[[[1.0793], [1.034], [1.1506], [1.9676]]]], 3, 0.3104430277754273, [0.7603], [0.9087], [0.3943], [0.1353], Bat72650), 
LZer66347 = zero_padding2D_layer(Bat72650, 1, 0, 0, 0, Zer66347), 
LMax47115 = maximum_layer([Res7451,Zer66347], Max47115), 
LMax7049 = max_pool2D_layer(Max47115, 1, 1, 1, 8, false, Max7049), 
exec_layers([LMul37434,LRes8277,LMin36698,LRes17503,LAve56285,LCon25987,LAdd37689,LMul46419,LRes7451,LBat72650,LZer66347,LMax47115,LMax7049],["Mul37434","Res8277","Min36698","Res17503","Ave56285","Con25987","Add37689","Mul46419","Res7451","Bat72650","Zer66347","Max47115","Max7049"],Max7049,"Max7049")

Actual (Unparsed): [[[[0.2925382]], [[1.6887695]]]]

Expected (Unparsed): [[[[0.29253816438]],[[1.6887694728503455]]]]

Actual:   [[[[0.2926]], [[1.6888]]]]

Expected: [[[[0.2926]], [[1.6888]]]]