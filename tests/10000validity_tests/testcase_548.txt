import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave17355 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave17355 = tf.keras.layers.Input(shape=([2, 2, 1]))

Ave17355 = keras.layers.Average(name = 'Ave17355', )([in0Ave17355,in1Ave17355])
Res72355 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res72355', )(Ave17355)
PRe90642 = keras.layers.PReLU(name = 'PRe90642', )(Res72355)
model = tf.keras.models.Model(inputs=[in0Ave17355,in1Ave17355], outputs=PRe90642)
w = model.get_layer('PRe90642').get_weights() 
w[0] = np.array([[[[0.3261]], [[0.0531]]], [[[0.8071]], [[0.7637]]]])
model.get_layer('PRe90642').set_weights(w) 
in0Ave17355 = tf.constant([[[[0.2348], [0.9075]], [[0.3372], [0.1503]]]])
in1Ave17355 = tf.constant([[[[0.5082], [0.0732]], [[0.0897], [0.6883]]]])
print (np.array2string(model.predict([in0Ave17355,in1Ave17355],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe90642.png')

LAve17355 = average_layer([[[[[0.2348], [0.9075]], [[0.3372], [0.1503]]]], [[[[0.5082], [0.0732]], [[0.0897], [0.6883]]]]], Ave17355), 
LRes72355 = reshape_layer(Ave17355, [2, 2, 1, 1], Res72355), 
LPRe90642 = prelu_layer(Res72355, [[[[0.3261]], [[0.0531]]], [[[0.8071]], [[0.7637]]]], PRe90642), 
exec_layers([LAve17355,LRes72355,LPRe90642],["Ave17355","Res72355","PRe90642"],PRe90642,"PRe90642")

Actual (Unparsed): [[[[[0.3715000]], [[0.4903500]]], [[[0.2134500]], [[0.4193000]]]]]

Expected (Unparsed): [[[[[0.3715]],[[0.49035]]],[[[0.21345]],[[0.4193]]]]]

Actual:   [[[[[0.3715]], [[0.4904]]], [[[0.2135]], [[0.4193]]]]]

Expected: [[[[[0.3715]], [[0.4904]]], [[[0.2135]], [[0.4193]]]]]