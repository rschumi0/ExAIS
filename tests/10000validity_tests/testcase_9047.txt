import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot54427 = tf.keras.layers.Input(shape=([2]))
in1Dot54427 = tf.keras.layers.Input(shape=([2]))
in0Con98318 = tf.keras.layers.Input(shape=([4, 7]))
in0Zer41791 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot74479 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot74479 = tf.keras.layers.Input(shape=([3, 3]))
in0Con74578 = tf.keras.layers.Input(shape=([4, 5]))

Dot54427 = keras.layers.Dot(axes=(1, 1), name = 'Dot54427', )([in0Dot54427,in1Dot54427])
Res63868 = keras.layers.Reshape((1, 1), name = 'Res63868', )(Dot54427)
Zer14968 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer14968', )(Res63868)
Con98318 = keras.layers.Concatenate(axis=2, name = 'Con98318', )([Zer14968,in0Con98318])
Zer41791 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer41791', )(in0Zer41791)
Res36000 = keras.layers.Reshape((4, 8), name = 'Res36000', )(Zer41791)
Dot74479 = keras.layers.Dot(axes=(1, 2), name = 'Dot74479', )([in0Dot74479,in1Dot74479])
Loc84936 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc84936', )(Dot74479)
Zer68903 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer68903', )(Loc84936)
Con74578 = keras.layers.Concatenate(axis=2, name = 'Con74578', )([Zer68903,in0Con74578])
Mul82525 = keras.layers.Multiply(name = 'Mul82525', )([Res36000,Con74578])
Max9055 = keras.layers.Maximum(name = 'Max9055', )([Con98318,Mul82525])
Res37685 = keras.layers.Reshape((4, 8, 1), name = 'Res37685', )(Max9055)
Res52303 = keras.layers.Reshape((4, 8, 1, 1), name = 'Res52303', )(Res37685)
Cro68588 = keras.layers.Cropping3D(cropping=((0, 2), (3, 3), (0, 0)), name = 'Cro68588', )(Res52303)
model = tf.keras.models.Model(inputs=[in0Dot54427,in1Dot54427,in0Con98318,in0Zer41791,in0Dot74479,in1Dot74479,in0Con74578], outputs=Cro68588)
w = model.get_layer('Loc84936').get_weights() 
w[0] = np.array([[[0.2526, 0.2526, 0.7297], [0.9964, 0.1965, 0.1805], [0.4564, 0.9804, 0.4386], [0.1683, 0.7358, 0.6439], [0.5495, 0.0588, 0.48], [0.8435, 0.5033, 0.7297]], [[0.6724, 0.9147, 0.8029], [0.1475, 0.3325, 0.6026], [0.0667, 0.6568, 0.9932], [0.8846, 0.2844, 0.3515], [0.0375, 0.8025, 0.8981], [0.6414, 0.1499, 0.7669]]])
w[1] = np.array([[0, 0, 0], [0, 0, 0]])
model.get_layer('Loc84936').set_weights(w) 
in0Dot54427 = tf.constant([[0.8727, 0.4008]])
in1Dot54427 = tf.constant([[0.8584, 0.1959]])
in0Con98318 = tf.constant([[[0.7875, 0.9651, 0.0569, 0.4259, 0.0029, 0.8748, 0.2652], [0.3358, 0.8447, 0.5552, 0.9397, 0.274, 0.7055, 0.8184], [0.66, 0.913, 0.9954, 0.1298, 0.6091, 0.6089, 0.6217], [0.4082, 0.7823, 0.3835, 0.8789, 0.9393, 0.8904, 0.4244]]])
in0Zer41791 = tf.constant([[[[1.9989, 1.8359], [1.7549, 1.5844]], [[1.5543, 1.4292], [1.4767, 1.3435]]]])
in0Dot74479 = tf.constant([[[0.7942, 0.5379, 0.6506], [0.2483, 0.9284, 0.2902], [0.7407, 0.9651, 0.4583]]])
in1Dot74479 = tf.constant([[[0.5647, 0.6283, 0.3434], [0.0499, 0.346, 0.0577], [0.3138, 0.2566, 0.2656]]])
in0Con74578 = tf.constant([[[0.502, 0.9626, 0.3547, 0.3977, 0.7649], [0.0062, 0.6859, 0.1076, 0.6637, 0.4664], [0.0035, 0.0184, 0.04, 0.0762, 0.2858], [0.3819, 0.0764, 0.0158, 0.3346, 0.4826]]])
print (np.array2string(model.predict([in0Dot54427,in1Dot54427,in0Con98318,in0Zer41791,in0Dot74479,in1Dot74479,in0Con74578],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro68588.png')

LDot54427 = dot_layer([[0.8727, 0.4008]], [[0.8584, 0.1959]], 1, 1, Dot54427), 
LRes63868 = reshape_layer(Dot54427, [1, 1], Res63868), 
LZer14968 = zero_padding1D_layer(Res63868, 3, 0, Zer14968), 
LCon98318 = concatenate_layer([Zer14968,[[[0.7875, 0.9651, 0.0569, 0.4259, 0.0029, 0.8748, 0.2652], [0.3358, 0.8447, 0.5552, 0.9397, 0.274, 0.7055, 0.8184], [0.66, 0.913, 0.9954, 0.1298, 0.6091, 0.6089, 0.6217], [0.4082, 0.7823, 0.3835, 0.8789, 0.9393, 0.8904, 0.4244]]]], 2, Con98318), 
LZer41791 = zero_padding2D_layer([[[[1.9989, 1.8359], [1.7549, 1.5844]], [[1.5543, 1.4292], [1.4767, 1.3435]]]], 1, 1, 1, 1, Zer41791), 
LRes36000 = reshape_layer(Zer41791, [4, 8], Res36000), 
LDot74479 = dot_layer([[[0.7942, 0.5379, 0.6506], [0.2483, 0.9284, 0.2902], [0.7407, 0.9651, 0.4583]]], [[[0.5647, 0.6283, 0.3434], [0.0499, 0.346, 0.0577], [0.3138, 0.2566, 0.2656]]], 1, 2, Dot74479), 
LLoc84936 = locally_connected1D_layer(Dot74479, 2,[[[0.2526, 0.2526, 0.7297], [0.9964, 0.1965, 0.1805], [0.4564, 0.9804, 0.4386], [0.1683, 0.7358, 0.6439], [0.5495, 0.0588, 0.48], [0.8435, 0.5033, 0.7297]], [[0.6724, 0.9147, 0.8029], [0.1475, 0.3325, 0.6026], [0.0667, 0.6568, 0.9932], [0.8846, 0.2844, 0.3515], [0.0375, 0.8025, 0.8981], [0.6414, 0.1499, 0.7669]]],[[0, 0, 0], [0, 0, 0]], 1, Loc84936), 
LZer68903 = zero_padding1D_layer(Loc84936, 2, 0, Zer68903), 
LCon74578 = concatenate_layer([Zer68903,[[[0.502, 0.9626, 0.3547, 0.3977, 0.7649], [0.0062, 0.6859, 0.1076, 0.6637, 0.4664], [0.0035, 0.0184, 0.04, 0.0762, 0.2858], [0.3819, 0.0764, 0.0158, 0.3346, 0.4826]]]], 2, Con74578), 
LMul82525 = multiply_layer([Res36000,Con74578], Mul82525), 
LMax9055 = maximum_layer([Con98318,Mul82525], Max9055), 
LRes37685 = reshape_layer(Max9055, [4, 8, 1], Res37685), 
LRes52303 = reshape_layer(Res37685, [4, 8, 1, 1], Res52303), 
LCro68588 = cropping3D_layer(Res52303, 0, 2, 3, 3, 0, 0, Cro68588), 
exec_layers([LDot54427,LRes63868,LZer14968,LCon98318,LZer41791,LRes36000,LDot74479,LLoc84936,LZer68903,LCon74578,LMul82525,LMax9055,LRes37685,LRes52303,LCro68588],["Dot54427","Res63868","Zer14968","Con98318","Zer41791","Res36000","Dot74479","Loc84936","Zer68903","Con74578","Mul82525","Max9055","Res37685","Res52303","Cro68588"],Cro68588,"Cro68588")

Actual (Unparsed): [[[[[0.0569000]], [[0.4259000]]], [[[0.5552000]], [[1.2036858]]]]]

Expected (Unparsed): [[[[[0.0569]],[[0.4259]]],[[[0.5552]],[[1.20368591]]]]]

Actual:   [[[[[0.0569]], [[0.4259]]], [[[0.5552]], [[1.2037]]]]]

Expected: [[[[[0.0569]], [[0.4259]]], [[[0.5552]], [[1.2037]]]]]