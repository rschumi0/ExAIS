import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot67683 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot67683 = tf.keras.layers.Input(shape=([3, 3]))
in0Con89977 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Sub29151 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub29151 = tf.keras.layers.Input(shape=([2, 2, 2]))

Dot67683 = keras.layers.Dot(axes=(2, 1), name = 'Dot67683', )([in0Dot67683,in1Dot67683])
Res55832 = keras.layers.Reshape((3, 3, 1), name = 'Res55832', )(Dot67683)
Con89977 = keras.layers.Concatenate(axis=3, name = 'Con89977', )([Res55832,in0Con89977])
Sub29151 = keras.layers.Subtract(name = 'Sub29151', )([in0Sub29151,in1Sub29151])
Zer20015 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer20015', )(Sub29151)
Sub34242 = keras.layers.Subtract(name = 'Sub34242', )([Con89977,Zer20015])
Res50934 = keras.layers.Reshape((3, 3, 2, 1), name = 'Res50934', )(Sub34242)
Zer8374 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer8374', )(Res50934)
model = tf.keras.models.Model(inputs=[in0Dot67683,in1Dot67683,in0Con89977,in0Sub29151,in1Sub29151], outputs=Zer8374)
in0Dot67683 = tf.constant([[[0.1583, 0.2006, 0.5106], [0.3979, 0.2684, 0.0754], [0.2874, 0.3197, 0.118]]])
in1Dot67683 = tf.constant([[[0.4625, 0.5173, 0.945], [0.748, 0.8994, 0.7263], [0.8218, 0.2019, 0.5756]]])
in0Con89977 = tf.constant([[[[0.0567], [0.0938], [0.1796]], [[0.5617], [0.3762], [0.1318]], [[0.0955], [0.1194], [0.5743]]]])
in0Sub29151 = tf.constant([[[[0.3808, 0.6087], [0.6623, 0.321]], [[0.1021, 0.4356], [0.4116, 0.5526]]]])
in1Sub29151 = tf.constant([[[[0.5703, 0.6485], [0.6937, 0.5849]], [[0.6256, 0.9685], [0.7077, 0.3066]]]])
print (np.array2string(model.predict([in0Dot67683,in1Dot67683,in0Con89977,in0Sub29151,in1Sub29151],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer8374.png')

LDot67683 = dot_layer([[[0.1583, 0.2006, 0.5106], [0.3979, 0.2684, 0.0754], [0.2874, 0.3197, 0.118]]], [[[0.4625, 0.5173, 0.945], [0.748, 0.8994, 0.7263], [0.8218, 0.2019, 0.5756]]], 2, 1, Dot67683), 
LRes55832 = reshape_layer(Dot67683, [3, 3, 1], Res55832), 
LCon89977 = concatenate_layer([Res55832,[[[[0.0567], [0.0938], [0.1796]], [[0.5617], [0.3762], [0.1318]], [[0.0955], [0.1194], [0.5743]]]]], 3, Con89977), 
LSub29151 = subtract_layer([[[[0.3808, 0.6087], [0.6623, 0.321]], [[0.1021, 0.4356], [0.4116, 0.5526]]]], [[[[0.5703, 0.6485], [0.6937, 0.5849]], [[0.6256, 0.9685], [0.7077, 0.3066]]]], Sub29151), 
LZer20015 = zero_padding2D_layer(Sub29151, 1, 0, 1, 0, Zer20015), 
LSub34242 = subtract_layer(Con89977,Zer20015, Sub34242), 
LRes50934 = reshape_layer(Sub34242, [3, 3, 2, 1], Res50934), 
LZer8374 = zero_padding3D_layer(Res50934, 1, 1, 1, 1, 1, 1, Zer8374), 
exec_layers([LDot67683,LRes55832,LCon89977,LSub29151,LZer20015,LSub34242,LRes50934,LZer8374],["Dot67683","Res55832","Con89977","Sub29151","Zer20015","Sub34242","Res50934","Zer8374"],Zer8374,"Zer8374")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.6428736], [0.0567000], [0.0000000]], [[0.0000000], [0.3653984], [0.0938000], [0.0000000]], [[0.0000000], [0.5891906], [0.1796000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.4467557], [0.5617000], [0.0000000]], [[0.0000000], [0.6519559], [0.4160000], [0.0000000]], [[0.0000000], [0.6457547], [0.3957000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.4690305], [0.0955000], [0.0000000]], [[0.0000000], [0.9835344], [0.6523000], [0.0000000]], [[0.0000000], [0.8678119], [0.3283000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]]],[[[0],[0],[0],[0]],[[0],[0.64287363],[0.0567],[0]],[[0],[0.36539837],[0.0938],[0]],[[0],[0.58919064],[0.1796],[0]],[[0],[0],[0],[0]]],[[[0],[0],[0],[0]],[[0],[0.44675567],[0.5617],[0]],[[0],[0.65195589],[0.4159999999999999],[0]],[[0],[0.6457546599999999],[0.39569999999999994],[0]],[[0],[0],[0],[0]]],[[[0],[0],[0],[0]],[[0],[0.4690304999999999],[0.0955],[0]],[[0],[0.9835344000000001],[0.6523000000000001],[0]],[[0],[0.8678119099999999],[0.32830000000000004],[0]],[[0],[0],[0],[0]]],[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0.6429], [0.0567], [0]], [[0], [0.3654], [0.0938], [0]], [[0], [0.5892], [0.1796], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0.4468], [0.5617], [0]], [[0], [0.652], [0.416], [0]], [[0], [0.6458], [0.3957], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0.4691], [0.0955], [0]], [[0], [0.9836], [0.6523], [0]], [[0], [0.8679], [0.3283], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]]

Expected: [[[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0.6429], [0.0567], [0]], [[0], [0.3654], [0.0938], [0]], [[0], [0.5892], [0.1796], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0.4468], [0.5617], [0]], [[0], [0.652], [0.416], [0]], [[0], [0.6458], [0.3957], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0.4691], [0.0955], [0]], [[0], [0.9836], [0.6524], [0]], [[0], [0.8679], [0.3284], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]]