import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con4076 = tf.keras.layers.Input(shape=([2, 2]))
in0Con20231 = tf.keras.layers.Input(shape=([3, 1]))
in0Dot10963 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot10963 = tf.keras.layers.Input(shape=([2, 3]))
in0Con95592 = tf.keras.layers.Input(shape=([3, 3, 3, 3]))
in0Con21391 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Zer8543 = tf.keras.layers.Input(shape=([2, 3, 2]))
in0Con56105 = tf.keras.layers.Input(shape=([10]))

Con4076 = keras.layers.Conv1D(2, (2),strides=(1), padding='same', dilation_rate=(1), name = 'Con4076', )(in0Con4076)
Zer70824 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer70824', )(Con4076)
Con20231 = keras.layers.Concatenate(axis=2, name = 'Con20231', )([Zer70824,in0Con20231])
Dot10963 = keras.layers.Dot(axes=(1, 1), name = 'Dot10963', )([in0Dot10963,in1Dot10963])
Max90058 = keras.layers.Maximum(name = 'Max90058', )([Con20231,Dot10963])
Res69096 = keras.layers.Reshape((3, 3, 1), name = 'Res69096', )(Max90058)
Res93521 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res93521', )(Res69096)
Zer14510 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer14510', )(Res93521)
Con95592 = keras.layers.Concatenate(axis=4, name = 'Con95592', )([Zer14510,in0Con95592])
Con21391 = keras.layers.Conv3D(4, (1, 2, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con21391', )(in0Con21391)
Zer52199 = keras.layers.ZeroPadding3D(padding=((2, 0), (2, 0), (1, 0)), name = 'Zer52199', )(Con21391)
Min99958 = keras.layers.Minimum(name = 'Min99958', )([Con95592,Zer52199])
Res68998 = keras.layers.Reshape((3, 3, 12), name = 'Res68998', )(Min99958)
Glo31938 = keras.layers.GlobalMaxPool2D(name = 'Glo31938', )(Res68998)
Zer8543 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer8543', )(in0Zer8543)
Glo81207 = keras.layers.GlobalAveragePooling2D(name = 'Glo81207', )(Zer8543)
Con56105 = keras.layers.Concatenate(axis=1, name = 'Con56105', )([Glo81207,in0Con56105])
Max82925 = keras.layers.Maximum(name = 'Max82925', )([Glo31938,Con56105])
model = tf.keras.models.Model(inputs=[in0Con4076,in0Con20231,in0Dot10963,in1Dot10963,in0Con95592,in0Con21391,in0Zer8543,in0Con56105], outputs=Max82925)
w = model.get_layer('Con4076').get_weights() 
w[0] = np.array([[[0.4323, 0.2984], [0.2761, 0.2989]], [[0.0263, 0.8609], [0.4295, 0.0936]]])
w[1] = np.array([0, 0])
model.get_layer('Con4076').set_weights(w) 
w = model.get_layer('Con21391').get_weights() 
w[0] = np.array([[[[[0.9213, 0.7426, 0.8446, 0.946], [0.1397, 0.1836, 0.6341, 0.6743]]], [[[0.3322, 0.7548, 0.9183, 0.7488], [0.0459, 0.901, 0.3489, 0.1779]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con21391').set_weights(w) 
in0Con4076 = tf.constant([[[0.7229, 0.0808], [0.7574, 0.7998]]])
in0Con20231 = tf.constant([[[0.9983], [0.7139], [0.7764]]])
in0Dot10963 = tf.constant([[[0.6451, 0.0308, 0.0791], [0.414, 0.3809, 0.4122]]])
in1Dot10963 = tf.constant([[[0.1619, 0.8258, 0.3486], [0.4972, 0.7114, 0.2226]]])
in0Con95592 = tf.constant([[[[[0.8677, 0.78, 0.864], [0.7297, 0.5534, 0.8146], [0.3544, 0.4684, 0.8281]], [[0.9552, 0.0645, 0.4571], [0.0955, 0.974, 0.1631], [0.152, 0.3867, 0.9867]], [[0.4265, 0.9393, 0.3696], [0.4352, 0.5073, 0.1518], [0.3367, 0.4349, 0.8729]]], [[[0.6726, 0.7946, 0.4064], [0.5683, 0.3336, 0.2568], [0.4688, 0.3942, 0.451]], [[0.9813, 0.0251, 0.1799], [0.8731, 0.6889, 0.3376], [0.58, 0.8591, 0.7453]], [[0.6604, 0.2258, 0.9572], [0.8997, 0.6726, 0.1213], [0.803, 0.4339, 0.5398]]], [[[0.8923, 0.4232, 0.495], [0.92, 0.8656, 0.1933], [0.4593, 0.6258, 0.9852]], [[0.0759, 0.4081, 0.4562], [0.2591, 0.1425, 0.1827], [0.9197, 0.7661, 0.6694]], [[0.0292, 0.1853, 0.255], [0.2912, 0.5453, 0.6161], [0.0166, 0.7927, 0.4976]]]]])
in0Con21391 = tf.constant([[[[[0.1426, 0.2435], [0.7739, 0.141]], [[0.8087, 0.8069], [0.6207, 0.0884]]]]])
in0Zer8543 = tf.constant([[[[1.2005, 1.0273], [1.6617, 1.544], [1.9916, 1.3085]], [[1.0686, 1.1386], [1.6966, 1.9503], [1.8345, 1.3337]]]])
in0Con56105 = tf.constant([[0.5374, 0.4874, 0.1682, 0.9787, 0.1606, 0.8576, 0.3574, 0.9772, 0.6224, 0.592]])
print (np.array2string(model.predict([in0Con4076,in0Con20231,in0Dot10963,in1Dot10963,in0Con95592,in0Con21391,in0Zer8543,in0Con56105],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max82925.png')

LCon4076 = conv1D_layer([[[0.7229, 0.0808], [0.7574, 0.7998]]], 2,[[[0.4323, 0.2984], [0.2761, 0.2989]], [[0.0263, 0.8609], [0.4295, 0.0936]]],[0, 0], 1, true, 1, Con4076), 
LZer70824 = zero_padding1D_layer(Con4076, 1, 0, Zer70824), 
LCon20231 = concatenate_layer([Zer70824,[[[0.9983], [0.7139], [0.7764]]]], 2, Con20231), 
LDot10963 = dot_layer([[[0.6451, 0.0308, 0.0791], [0.414, 0.3809, 0.4122]]], [[[0.1619, 0.8258, 0.3486], [0.4972, 0.7114, 0.2226]]], 1, 1, Dot10963), 
LMax90058 = maximum_layer([Con20231,Dot10963], Max90058), 
LRes69096 = reshape_layer(Max90058, [3, 3, 1], Res69096), 
LRes93521 = reshape_layer(Res69096, [3, 3, 1, 1], Res93521), 
LZer14510 = zero_padding3D_layer(Res93521, 0, 0, 0, 0, 2, 0, Zer14510), 
LCon95592 = concatenate_layer([Zer14510,[[[[[0.8677, 0.78, 0.864], [0.7297, 0.5534, 0.8146], [0.3544, 0.4684, 0.8281]], [[0.9552, 0.0645, 0.4571], [0.0955, 0.974, 0.1631], [0.152, 0.3867, 0.9867]], [[0.4265, 0.9393, 0.3696], [0.4352, 0.5073, 0.1518], [0.3367, 0.4349, 0.8729]]], [[[0.6726, 0.7946, 0.4064], [0.5683, 0.3336, 0.2568], [0.4688, 0.3942, 0.451]], [[0.9813, 0.0251, 0.1799], [0.8731, 0.6889, 0.3376], [0.58, 0.8591, 0.7453]], [[0.6604, 0.2258, 0.9572], [0.8997, 0.6726, 0.1213], [0.803, 0.4339, 0.5398]]], [[[0.8923, 0.4232, 0.495], [0.92, 0.8656, 0.1933], [0.4593, 0.6258, 0.9852]], [[0.0759, 0.4081, 0.4562], [0.2591, 0.1425, 0.1827], [0.9197, 0.7661, 0.6694]], [[0.0292, 0.1853, 0.255], [0.2912, 0.5453, 0.6161], [0.0166, 0.7927, 0.4976]]]]]], 4, Con95592), 
LCon21391 = conv3D_layer([[[[[0.1426, 0.2435], [0.7739, 0.141]], [[0.8087, 0.8069], [0.6207, 0.0884]]]]], 1, 2, 1,[[[[[0.9213, 0.7426, 0.8446, 0.946], [0.1397, 0.1836, 0.6341, 0.6743]]], [[[0.3322, 0.7548, 0.9183, 0.7488], [0.0459, 0.901, 0.3489, 0.1779]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con21391), 
LZer52199 = zero_padding3D_layer(Con21391, 2, 0, 2, 0, 1, 0, Zer52199), 
LMin99958 = minimum_layer([Con95592,Zer52199], Min99958), 
LRes68998 = reshape_layer(Min99958, [3, 3, 12], Res68998), 
LGlo31938 = global_max_pool2D_layer(Res68998, Glo31938), 
LZer8543 = zero_padding2D_layer([[[[1.2005, 1.0273], [1.6617, 1.544], [1.9916, 1.3085]], [[1.0686, 1.1386], [1.6966, 1.9503], [1.8345, 1.3337]]]], 1, 1, 1, 1, Zer8543), 
LGlo81207 = global_average_pooling2D_layer(Zer8543, Glo81207), 
LCon56105 = concatenate_layer([Glo81207,[[0.5374, 0.4874, 0.1682, 0.9787, 0.1606, 0.8576, 0.3574, 0.9772, 0.6224, 0.592]]], 1, Con56105), 
LMax82925 = maximum_layer([Glo31938,Con56105], Max82925), 
exec_layers([LCon4076,LZer70824,LCon20231,LDot10963,LMax90058,LRes69096,LRes93521,LZer14510,LCon95592,LCon21391,LZer52199,LMin99958,LRes68998,LGlo31938,LZer8543,LGlo81207,LCon56105,LMax82925],["Con4076","Zer70824","Con20231","Dot10963","Max90058","Res69096","Res93521","Zer14510","Con95592","Con21391","Zer52199","Min99958","Res68998","Glo31938","Zer8543","Glo81207","Con56105","Max82925"],Max82925,"Max82925")

Actual (Unparsed): [[0.4726750, 0.4151200, 0.5374000, 0.4874000, 0.1682000, 0.9787000, 0.5453000, 0.8576000, 0.7764000, 0.9772000, 0.7927000, 0.5920000]]

Expected (Unparsed): [[0.472675,0.41512000000000004,0.5374,0.4874,0.1682,0.9787,0.5453,0.8576,0.7764,0.9772,0.7927,0.592]]

Actual:   [[0.4727, 0.4152, 0.5374, 0.4874, 0.1682, 0.9787, 0.5453, 0.8576, 0.7764, 0.9772, 0.7927, 0.592]]

Expected: [[0.4727, 0.4152, 0.5374, 0.4874, 0.1682, 0.9787, 0.5453, 0.8576, 0.7764, 0.9772, 0.7927, 0.592]]