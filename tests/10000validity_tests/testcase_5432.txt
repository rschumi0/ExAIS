import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub83283 = tf.keras.layers.Input(shape=([2, 3, 3]))
in1Sub83283 = tf.keras.layers.Input(shape=([2, 3, 3]))

Sub83283 = keras.layers.Subtract(name = 'Sub83283', )([in0Sub83283,in1Sub83283])
Res27814 = keras.layers.Reshape((2, 3, 3, 1), name = 'Res27814', )(Sub83283)
Con32032 = keras.layers.Conv3D(2, (1, 3, 1),strides=(1, 2, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con32032', )(Res27814)
model = tf.keras.models.Model(inputs=[in0Sub83283,in1Sub83283], outputs=Con32032)
w = model.get_layer('Con32032').get_weights() 
w[0] = np.array([[[[[0.104, 0.0538]]], [[[0.1719, 0.478]]], [[[0.0191, 0.6725]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con32032').set_weights(w) 
in0Sub83283 = tf.constant([[[[0.3211, 0.0423, 0.3025], [0.7565, 0.9202, 0.7542], [0.2372, 0.4809, 0.0341]], [[0.6913, 0.7199, 0.4567], [0.0015, 0.1118, 0.2922], [0.8854, 0.5902, 0.0195]]]])
in1Sub83283 = tf.constant([[[[0.6395, 0.7556, 0.1442], [0.4904, 0.8426, 0.7879], [0.4496, 0.4082, 0.0638]], [[0.4677, 0.2385, 0.682], [0.7831, 0.0464, 0.648], [0.4527, 0.2383, 0.5926]]]])
print (np.array2string(model.predict([in0Sub83283,in1Sub83283],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con32032.png')

LSub83283 = subtract_layer([[[[0.3211, 0.0423, 0.3025], [0.7565, 0.9202, 0.7542], [0.2372, 0.4809, 0.0341]], [[0.6913, 0.7199, 0.4567], [0.0015, 0.1118, 0.2922], [0.8854, 0.5902, 0.0195]]]], [[[[0.6395, 0.7556, 0.1442], [0.4904, 0.8426, 0.7879], [0.4496, 0.4082, 0.0638]], [[0.4677, 0.2385, 0.682], [0.7831, 0.0464, 0.648], [0.4527, 0.2383, 0.5926]]]], Sub83283), 
LRes27814 = reshape_layer(Sub83283, [2, 3, 3, 1], Res27814), 
LCon32032 = conv3D_layer(Res27814, 1, 3, 1,[[[[[0.104, 0.0538]]], [[[0.1719, 0.478]]], [[[0.0191, 0.6725]]]]],[0, 0], 1, 2, 1, false, 1, 1, 1, Con32032), 
exec_layers([LSub83283,LRes27814,LCon32032],["Sub83283","Res27814","Con32032"],Con32032,"Con32032")

Actual (Unparsed): [[[[[0.0085722, -0.0327731], [-0.0594552, 0.0476080], [0.0101029, -0.0275653]]], [[[-0.1028381, -0.0705844], [0.0680292, 0.2938133], [-0.0955394, -0.5676033]]]]]

Expected (Unparsed): [[[[[0.00857215,-0.03277312000000002],[-0.059455190000000005,0.04760800999999999],[0.010102899999999986,-0.027565310000000027]]],[[[-0.10283807,-0.07058437000000006],[0.06802915,0.2938132699999999],[-0.09553943,-0.5676032900000001]]]]]

Actual:   [[[[[0.0086, -0.0327], [-0.0594, 0.0477], [0.0102, -0.0275]]], [[[-0.1028, -0.0705], [0.0681, 0.2939], [-0.0955, -0.5676]]]]]

Expected: [[[[[0.0086, -0.0327], [-0.0594, 0.0477], [0.0102, -0.0275]]], [[[-0.1028, -0.0705], [0.0681, 0.2939], [-0.0955, -0.5676]]]]]