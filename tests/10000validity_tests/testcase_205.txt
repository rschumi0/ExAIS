import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max12520 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max12520 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con89727 = tf.keras.layers.Input(shape=([2, 8]))
in0Sub53782 = tf.keras.layers.Input(shape=([2, 3, 3]))
in1Sub53782 = tf.keras.layers.Input(shape=([2, 3, 3]))
in0Con36053 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max65047 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max65047 = tf.keras.layers.Input(shape=([2, 1, 2]))

Max12520 = keras.layers.Maximum(name = 'Max12520', )([in0Max12520,in1Max12520])
Res31330 = keras.layers.Reshape((2, 1), name = 'Res31330', )(Max12520)
Con89727 = keras.layers.Concatenate(axis=2, name = 'Con89727', )([Res31330,in0Con89727])
Sub53782 = keras.layers.Subtract(name = 'Sub53782', )([in0Sub53782,in1Sub53782])
Res40752 = keras.layers.Reshape((2, 9), name = 'Res40752', )(Sub53782)
Dot76788 = keras.layers.Dot(axes=(2, 2), name = 'Dot76788', )([Con89727,Res40752])
Res91338 = keras.layers.Reshape((2, 2, 1), name = 'Res91338', )(Dot76788)
Con36053 = keras.layers.Concatenate(axis=3, name = 'Con36053', )([Res91338,in0Con36053])
Max65047 = keras.layers.Maximum(name = 'Max65047', )([in0Max65047,in1Max65047])
Zer69938 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer69938', )(Max65047)
Add11535 = keras.layers.Add(name = 'Add11535', )([Con36053,Zer69938])
model = tf.keras.models.Model(inputs=[in0Max12520,in1Max12520,in0Con89727,in0Sub53782,in1Sub53782,in0Con36053,in0Max65047,in1Max65047], outputs=Add11535)
in0Max12520 = tf.constant([[[[0.2848]], [[0.0137]]]])
in1Max12520 = tf.constant([[[[0.5888]], [[0.6351]]]])
in0Con89727 = tf.constant([[[0.5498, 0.4542, 0.9084, 0.4563, 0.0239, 0.7043, 0.3133, 0.1216], [0.4911, 0.0791, 0.9249, 0.2961, 0.5436, 0.1203, 0.1891, 0.4727]]])
in0Sub53782 = tf.constant([[[[0.8311, 0.6172, 0.4289], [0.6022, 0.4384, 0.3715], [0.1975, 0.6753, 0.1872]], [[0.2011, 0.5976, 0.3857], [0.844, 0.6555, 0.3313], [0.9308, 0.5308, 0.5429]]]])
in1Sub53782 = tf.constant([[[[0.6402, 0.1919, 0.0724], [0.0568, 0.8997, 0.4247], [0.3975, 0.2254, 0.5314]], [[0.0659, 0.7465, 0.9006], [0.7064, 0.4364, 0.7276], [0.048, 0.9225, 0.122]]]])
in0Con36053 = tf.constant([[[[0.8019], [0.9068]], [[0.5752], [0.4188]]]])
in0Max65047 = tf.constant([[[[0.453, 0.8003]], [[0.5655, 0.4639]]]])
in1Max65047 = tf.constant([[[[0.0877, 0.5914]], [[0.9836, 0.9006]]]])
print (np.array2string(model.predict([in0Max12520,in1Max12520,in0Con89727,in0Sub53782,in1Sub53782,in0Con36053,in0Max65047,in1Max65047],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add11535.png')

LMax12520 = maximum_layer([[[[[0.2848]], [[0.0137]]]], [[[[0.5888]], [[0.6351]]]]], Max12520), 
LRes31330 = reshape_layer(Max12520, [2, 1], Res31330), 
LCon89727 = concatenate_layer([Res31330,[[[0.5498, 0.4542, 0.9084, 0.4563, 0.0239, 0.7043, 0.3133, 0.1216], [0.4911, 0.0791, 0.9249, 0.2961, 0.5436, 0.1203, 0.1891, 0.4727]]]], 2, Con89727), 
LSub53782 = subtract_layer([[[[0.8311, 0.6172, 0.4289], [0.6022, 0.4384, 0.3715], [0.1975, 0.6753, 0.1872]], [[0.2011, 0.5976, 0.3857], [0.844, 0.6555, 0.3313], [0.9308, 0.5308, 0.5429]]]], [[[[0.6402, 0.1919, 0.0724], [0.0568, 0.8997, 0.4247], [0.3975, 0.2254, 0.5314]], [[0.0659, 0.7465, 0.9006], [0.7064, 0.4364, 0.7276], [0.048, 0.9225, 0.122]]]], Sub53782), 
LRes40752 = reshape_layer(Sub53782, [2, 9], Res40752), 
LDot76788 = dot_layer(Con89727,Res40752, 2, 2, Dot76788), 
LRes91338 = reshape_layer(Dot76788, [2, 2, 1], Res91338), 
LCon36053 = concatenate_layer([Res91338,[[[[0.8019], [0.9068]], [[0.5752], [0.4188]]]]], 3, Con36053), 
LMax65047 = maximum_layer([[[[[0.453, 0.8003]], [[0.5655, 0.4639]]]], [[[[0.0877, 0.5914]], [[0.9836, 0.9006]]]]], Max65047), 
LZer69938 = zero_padding2D_layer(Max65047, 0, 0, 1, 0, Zer69938), 
LAdd11535 = add_layer([Con36053,Zer69938], Add11535), 
exec_layers([LMax12520,LRes31330,LCon89727,LSub53782,LRes40752,LDot76788,LRes91338,LCon36053,LMax65047,LZer69938,LAdd11535],["Max12520","Res31330","Con89727","Sub53782","Res40752","Dot76788","Res91338","Con36053","Max65047","Zer69938","Add11535"],Add11535,"Add11535")

Actual (Unparsed): [[[[0.7500718, 0.8019000], [0.9825904, 1.7071000]], [[0.5955473, 0.5752000], [1.1634150, 1.3194000]]]]

Expected (Unparsed): [[[[0.7500718,0.8019],[0.9825904299999999,1.7071]],[[0.59554733,0.5752],[1.16341501,1.3194]]]]

Actual:   [[[[0.7501, 0.8019], [0.9826, 1.7071]], [[0.5956, 0.5752], [1.1635, 1.3194]]]]

Expected: [[[[0.7501, 0.8019], [0.9826, 1.7071]], [[0.5956, 0.5752], [1.1635, 1.3194]]]]