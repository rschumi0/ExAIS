import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep94650 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Den53271 = tf.keras.layers.Input(shape=([5, 3]))
in0Con51343 = tf.keras.layers.Input(shape=([5, 3]))
in0Add46124 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add46124 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con9809 = tf.keras.layers.Input(shape=([19]))

Sep94650 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='same', name = 'Sep94650', )(in0Sep94650)
Res47385 = keras.layers.Reshape((2, 4), name = 'Res47385', )(Sep94650)
Zer80167 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer80167', )(Res47385)
Den53271 = keras.layers.Dense(1,name = 'Den53271', )(in0Den53271)
Con51343 = keras.layers.Concatenate(axis=2, name = 'Con51343', )([Den53271,in0Con51343])
Min84650 = keras.layers.Minimum(name = 'Min84650', )([Zer80167,Con51343])
Fla10357 = keras.layers.Flatten(name = 'Fla10357', )(Min84650)
Add46124 = keras.layers.Add(name = 'Add46124', )([in0Add46124,in1Add46124])
Res11552 = keras.layers.Reshape((2, 2), name = 'Res11552', )(Add46124)
Fla87815 = keras.layers.Flatten(name = 'Fla87815', )(Res11552)
Res27191 = keras.layers.Reshape((4, 1), name = 'Res27191', )(Fla87815)
LST64301 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST64301', )(Res27191)
Con9809 = keras.layers.Concatenate(axis=1, name = 'Con9809', )([LST64301,in0Con9809])
Add68841 = keras.layers.Add(name = 'Add68841', )([Fla10357,Con9809])
model = tf.keras.models.Model(inputs=[in0Sep94650,in0Den53271,in0Con51343,in0Add46124,in1Add46124,in0Con9809], outputs=Add68841)
w = model.get_layer('Sep94650').get_weights() 
w[0] = np.array([[[[0.4549], [0.0034]]]])
w[1] = np.array([[[[0.187, 0.8261, 0.8294, 0.6929], [0.952, 0.95, 0.7645, 0.0892]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep94650').set_weights(w) 
w = model.get_layer('Den53271').get_weights() 
w[0] = np.array([[0.3036], [0.4103], [0.1296]])
w[1] = np.array([0.2236])
model.get_layer('Den53271').set_weights(w) 
w = model.get_layer('LST64301').get_weights() 
w[0] = np.array([[1, 3, 8, 7]])
w[1] = np.array([[6, 1, 7, 2]])
w[2] = np.array([1, 5, 5, 2])
model.get_layer('LST64301').set_weights(w) 
in0Sep94650 = tf.constant([[[[0.8379, 0.6646]], [[0.8111, 0.0031]]]])
in0Den53271 = tf.constant([[[0.2333, 0.7489, 0.0377], [0.3075, 0.259, 0.5329], [0.1417, 0.496, 0.4297], [0.7822, 0.7276, 0.3606], [0.112, 0.8357, 0.8921]]])
in0Con51343 = tf.constant([[[0.845, 0.8503, 0.1449], [0.5587, 0.5467, 0.0135], [0.5103, 0.243, 0.2392], [0.596, 0.9438, 0.2444], [0.3552, 0.2298, 0.1534]]])
in0Add46124 = tf.constant([[[[0.8444, 0.5792]], [[0.9208, 0.6242]]]])
in1Add46124 = tf.constant([[[[0.253, 0.3626]], [[0.1099, 0.2947]]]])
in0Con9809 = tf.constant([[0.7214, 0.7785, 0.5202, 0.7384, 0.6904, 0.203, 0.4146, 0.2346, 0.5475, 0.7464, 0.8213, 0.177, 0.5223, 0.5806, 0.2934, 0.5034, 0.6664, 0.6911, 0.0337]])
print (np.array2string(model.predict([in0Sep94650,in0Den53271,in0Con51343,in0Add46124,in1Add46124,in0Con9809],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add68841.png')

LSep94650 = separable_conv2D_layer([[[[0.8379, 0.6646]], [[0.8111, 0.0031]]]], 1, 1,[[[[[0.4549], [0.0034]]]],[[[[0.187, 0.8261, 0.8294, 0.6929], [0.952, 0.95, 0.7645, 0.0892]]]]],[0, 0, 0, 0], 1, 1, true, Sep94650), 
LRes47385 = reshape_layer(Sep94650, [2, 4], Res47385), 
LZer80167 = zero_padding1D_layer(Res47385, 3, 0, Zer80167), 
LDen53271 = dense_layer([[[0.2333, 0.7489, 0.0377], [0.3075, 0.259, 0.5329], [0.1417, 0.496, 0.4297], [0.7822, 0.7276, 0.3606], [0.112, 0.8357, 0.8921]]], [[0.3036], [0.4103], [0.1296]],[0.2236], Den53271), 
LCon51343 = concatenate_layer([Den53271,[[[0.845, 0.8503, 0.1449], [0.5587, 0.5467, 0.0135], [0.5103, 0.243, 0.2392], [0.596, 0.9438, 0.2444], [0.3552, 0.2298, 0.1534]]]], 2, Con51343), 
LMin84650 = minimum_layer([Zer80167,Con51343], Min84650), 
LFla10357 = flatten_layer(Min84650, Fla10357), 
LAdd46124 = add_layer([[[[[0.8444, 0.5792]], [[0.9208, 0.6242]]]], [[[[0.253, 0.3626]], [[0.1099, 0.2947]]]]], Add46124), 
LRes11552 = reshape_layer(Add46124, [2, 2], Res11552), 
LFla87815 = flatten_layer(Res11552, Fla87815), 
LRes27191 = reshape_layer(Fla87815, [4, 1], Res27191), 
LLST64301 = lstm_layer(Res27191,[[1, 3, 8, 7]],[[6, 1, 7, 2]],[1, 5, 5, 2], LST64301), 
LCon9809 = concatenate_layer([LST64301,[[0.7214, 0.7785, 0.5202, 0.7384, 0.6904, 0.203, 0.4146, 0.2346, 0.5475, 0.7464, 0.8213, 0.177, 0.5223, 0.5806, 0.2934, 0.5034, 0.6664, 0.6911, 0.0337]]], 1, Con9809), 
LAdd68841 = add_layer([Fla10357,Con9809], Add68841), 
exec_layers([LSep94650,LRes47385,LZer80167,LDen53271,LCon51343,LMin84650,LFla10357,LAdd46124,LRes11552,LFla87815,LRes27191,LLST64301,LCon9809,LAdd68841],["Sep94650","Res47385","Zer80167","Den53271","Con51343","Min84650","Fla10357","Add46124","Res11552","Fla87815","Res27191","LST64301","Con9809","Add68841"],Add68841,"Add68841")

Actual (Unparsed): [[0.9991295, 0.7214000, 0.7785000, 0.5202000, 0.7384000, 0.6904000, 0.2030000, 0.4146000, 0.2346000, 0.5475000, 0.7464000, 0.8213000, 0.2504282, 0.8393235, 0.8984622, 0.5378000, 0.5724073, 0.9712156, 0.9209000, 0.1871000]]

Expected (Unparsed): [[0.9991294769113914,0.7214,0.7785,0.5202,0.7384,0.6904,0.203,0.4146,0.2346,0.5475,0.7464,0.8213,0.25042823005,0.839323520531,0.898462187654,0.5378000000000001,0.57240731001,0.971215626079,0.9209,0.18710000000000002]]

Actual:   [[0.9992, 0.7214, 0.7785, 0.5202, 0.7384, 0.6904, 0.203, 0.4146, 0.2346, 0.5475, 0.7464, 0.8213, 0.2505, 0.8394, 0.8985, 0.5378, 0.5725, 0.9713, 0.9209, 0.1871]]

Expected: [[0.9992, 0.7214, 0.7785, 0.5202, 0.7384, 0.6904, 0.203, 0.4146, 0.2346, 0.5475, 0.7464, 0.8213, 0.2505, 0.8394, 0.8985, 0.5379, 0.5725, 0.9713, 0.9209, 0.1872]]