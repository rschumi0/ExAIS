import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo84513 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul70959 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul70959 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Min555 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min555 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max75990 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max75990 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con78329 = tf.keras.layers.Input(shape=([4, 4, 3]))

Glo84513 = keras.layers.GlobalMaxPool1D(name = 'Glo84513', )(in0Glo84513)
Res16718 = keras.layers.Reshape((2, 1), name = 'Res16718', )(Glo84513)
Zer11970 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer11970', )(Res16718)
Res10214 = keras.layers.Reshape((4, 1, 1), name = 'Res10214', )(Zer11970)
Zer26466 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer26466', )(Res10214)
Mul70959 = keras.layers.Multiply(name = 'Mul70959', )([in0Mul70959,in1Mul70959])
Zer13279 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer13279', )(Mul70959)
Add72662 = keras.layers.Add(name = 'Add72662', )([Zer26466,Zer13279])
Res35592 = keras.layers.Reshape((4, 3, 1, 1), name = 'Res35592', )(Add72662)
Con10406 = keras.layers.Conv3DTranspose(4, (1, 2, 1),strides=(1, 1, 1), padding='valid', name = 'Con10406', )(Res35592)
Res53056 = keras.layers.Reshape((4, 4, 4), name = 'Res53056', )(Con10406)
Min555 = keras.layers.Minimum(name = 'Min555', )([in0Min555,in1Min555])
Max75990 = keras.layers.Maximum(name = 'Max75990', )([in0Max75990,in1Max75990])
Den87858 = keras.layers.Dense(1,name = 'Den87858', )(Max75990)
Zer51820 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer51820', )(Den87858)
Ave63936 = keras.layers.Average(name = 'Ave63936', )([Min555,Zer51820])
Zer80327 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer80327', )(Ave63936)
Con78329 = keras.layers.Concatenate(axis=3, name = 'Con78329', )([Zer80327,in0Con78329])
Min41038 = keras.layers.Minimum(name = 'Min41038', )([Res53056,Con78329])
model = tf.keras.models.Model(inputs=[in0Glo84513,in0Mul70959,in1Mul70959,in0Min555,in1Min555,in0Max75990,in1Max75990,in0Con78329], outputs=Min41038)
w = model.get_layer('Con10406').get_weights() 
w[0] = np.array([[[[[0.5147], [0.5262], [0.0082], [0.5003]]], [[[0.2395], [0.1366], [0.7586], [0.176]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con10406').set_weights(w) 
w = model.get_layer('Den87858').get_weights() 
w[0] = np.array([[0.3528]])
w[1] = np.array([0.8192])
model.get_layer('Den87858').set_weights(w) 
in0Glo84513 = tf.constant([[[1.7925, 1.8948]]])
in0Mul70959 = tf.constant([[[[0.0018], [0.5753]], [[0.2362], [0.7282]]]])
in1Mul70959 = tf.constant([[[[0.1329], [0.0826]], [[0.6488], [0.0744]]]])
in0Min555 = tf.constant([[[[0.686], [0.4902]], [[0.5202], [0.8229]]]])
in1Min555 = tf.constant([[[[0.0778], [0.9769]], [[0.8544], [0.382]]]])
in0Max75990 = tf.constant([[[[0.8579]], [[0.0831]]]])
in1Max75990 = tf.constant([[[[0.5994]], [[0.1401]]]])
in0Con78329 = tf.constant([[[[0.2728, 0.877, 0.0525], [0.9932, 0.1053, 0.4375], [0.6028, 0.6628, 0.4456], [0.5727, 0.4404, 0.2039]], [[0.8323, 0.071, 0.7723], [0.1227, 0.6953, 0.3422], [0.3238, 0.178, 0.3867], [0.3377, 0.6851, 0.048]], [[0.9289, 0.8449, 0.6228], [0.8538, 0.0501, 0.5649], [0.2037, 0.3713, 0.9512], [0.8595, 0.2185, 0.6318]], [[0.9062, 0.5652, 0.3162], [0.0105, 0.2365, 0.8098], [0.4643, 0.8344, 0.4189], [0.3379, 0.8356, 0.0005]]]])
print (np.array2string(model.predict([in0Glo84513,in0Mul70959,in1Mul70959,in0Min555,in1Min555,in0Max75990,in1Max75990,in0Con78329],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min41038.png')

LGlo84513 = global_max_pool1D_layer([[[1.7925, 1.8948]]], Glo84513), 
LRes16718 = reshape_layer(Glo84513, [2, 1], Res16718), 
LZer11970 = zero_padding1D_layer(Res16718, 1, 1, Zer11970), 
LRes10214 = reshape_layer(Zer11970, [4, 1, 1], Res10214), 
LZer26466 = zero_padding2D_layer(Res10214, 0, 0, 2, 0, Zer26466), 
LMul70959 = multiply_layer([[[[[0.0018], [0.5753]], [[0.2362], [0.7282]]]], [[[[0.1329], [0.0826]], [[0.6488], [0.0744]]]]], Mul70959), 
LZer13279 = zero_padding2D_layer(Mul70959, 2, 0, 1, 0, Zer13279), 
LAdd72662 = add_layer([Zer26466,Zer13279], Add72662), 
LRes35592 = reshape_layer(Add72662, [4, 3, 1, 1], Res35592), 
LCon10406 = conv3D_transpose_layer(Res35592, 1, 2, 1,[[[[[0.5147], [0.5262], [0.0082], [0.5003]]], [[[0.2395], [0.1366], [0.7586], [0.176]]]]],[0, 0, 0, 0], 1, 1, 1, false, Con10406), 
LRes53056 = reshape_layer(Con10406, [4, 4, 4], Res53056), 
LMin555 = minimum_layer([[[[[0.686], [0.4902]], [[0.5202], [0.8229]]]], [[[[0.0778], [0.9769]], [[0.8544], [0.382]]]]], Min555), 
LMax75990 = maximum_layer([[[[[0.8579]], [[0.0831]]]], [[[[0.5994]], [[0.1401]]]]], Max75990), 
LDen87858 = dense_layer(Max75990, [[0.3528]],[0.8192], Den87858), 
LZer51820 = zero_padding2D_layer(Den87858, 0, 0, 1, 0, Zer51820), 
LAve63936 = average_layer([Min555,Zer51820], Ave63936), 
LZer80327 = zero_padding2D_layer(Ave63936, 2, 0, 2, 0, Zer80327), 
LCon78329 = concatenate_layer([Zer80327,[[[[0.2728, 0.877, 0.0525], [0.9932, 0.1053, 0.4375], [0.6028, 0.6628, 0.4456], [0.5727, 0.4404, 0.2039]], [[0.8323, 0.071, 0.7723], [0.1227, 0.6953, 0.3422], [0.3238, 0.178, 0.3867], [0.3377, 0.6851, 0.048]], [[0.9289, 0.8449, 0.6228], [0.8538, 0.0501, 0.5649], [0.2037, 0.3713, 0.9512], [0.8595, 0.2185, 0.6318]], [[0.9062, 0.5652, 0.3162], [0.0105, 0.2365, 0.8098], [0.4643, 0.8344, 0.4189], [0.3379, 0.8356, 0.0005]]]]], 3, Con78329), 
LMin41038 = minimum_layer([Res53056,Con78329], Min41038), 
exec_layers([LGlo84513,LRes16718,LZer11970,LRes10214,LZer26466,LMul70959,LZer13279,LAdd72662,LRes35592,LCon10406,LRes53056,LMin555,LMax75990,LDen87858,LZer51820,LAve63936,LZer80327,LCon78329,LMin41038],["Glo84513","Res16718","Zer11970","Res10214","Zer26466","Mul70959","Zer13279","Add72662","Res35592","Con10406","Res53056","Min555","Max75990","Den87858","Zer51820","Ave63936","Zer80327","Con78329","Min41038"],Min41038,"Min41038")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.3238000, 0.0146985, 0.3867000], [0.0000000, 0.2448555, 0.6851000, 0.0480000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0001259, 0.0000020, 0.0001197], [0.0389000, 0.2037000, 0.0161085, 0.9512000], [0.4651856, 0.2653209, 0.2185000, 0.3418483]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0105000, 0.0012566, 0.0766693], [0.0645880, 0.0494420, 0.1166971, 0.0540767], [0.0129757, 0.0074007, 0.0410995, 0.0005000]]]]

Expected (Unparsed): [[[[0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0]],[[0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0],[0,0.3238,0.014698500000000001,0.3867],[0,0.2448555,0.6851,0.048]],[[0.0,0.0,0.0,0.0],[0,0.00012587756399999998,1.961604e-6,0.00011968176599999998],[0.0389,0.2037,0.016108494488000002,0.9512],[0.46518558731,0.265320881948,0.2185,0.34184828128]],[[0.0,0.0,0.0,0.0],[0,0.0105,0.0012566217920000002,0.07666925396799999],[0.064588008896,0.049441985791999994,0.11669710067200001,0.05407668798399999],[0.012975650159999998,0.007400725727999998,0.041099491487999996,0.0005]]]]

Actual:   [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0.3238, 0.0147, 0.3867], [0, 0.2449, 0.6851, 0.048]], [[0, 0, 0, 0], [0, 0.0002, 0, 0.0002], [0.0389, 0.2037, 0.0162, 0.9512], [0.4652, 0.2654, 0.2185, 0.3419]], [[0, 0, 0, 0], [0, 0.0105, 0.0013, 0.0767], [0.0646, 0.0495, 0.1167, 0.0541], [0.013, 0.0075, 0.0411, 0.0005]]]]

Expected: [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0.3238, 0.0147, 0.3867], [0, 0.2449, 0.6851, 0.048]], [[0, 0, 0, 0], [0, 0.0002, 0, 0.0002], [0.0389, 0.2037, 0.0162, 0.9512], [0.4652, 0.2654, 0.2185, 0.3419]], [[0, 0, 0, 0], [0, 0.0105, 0.0013, 0.0767], [0.0646, 0.0495, 0.1167, 0.0541], [0.013, 0.0075, 0.0411, 0.0005]]]]