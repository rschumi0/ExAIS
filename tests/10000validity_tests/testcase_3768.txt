import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max83929 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max83929 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Glo6790 = tf.keras.layers.Input(shape=([2, 1]))
in0Con82433 = tf.keras.layers.Input(shape=([7]))

Max83929 = keras.layers.Maximum(name = 'Max83929', )([in0Max83929,in1Max83929])
Res63140 = keras.layers.Reshape((2, 2, 2), name = 'Res63140', )(Max83929)
Res65390 = keras.layers.Reshape((2, 4), name = 'Res65390', )(Res63140)
Fla91947 = keras.layers.Flatten(name = 'Fla91947', )(Res65390)
Glo6790 = keras.layers.GlobalAveragePooling1D(name = 'Glo6790', )(in0Glo6790)
Con82433 = keras.layers.Concatenate(axis=1, name = 'Con82433', )([Glo6790,in0Con82433])
Ave44629 = keras.layers.Average(name = 'Ave44629', )([Fla91947,Con82433])
Thr86919 = keras.layers.ThresholdedReLU(theta=0.40903281479527276, name = 'Thr86919', )(Ave44629)
Res93837 = keras.layers.Reshape((8, 1), name = 'Res93837', )(Thr86919)
Res72281 = keras.layers.Reshape((8, 1, 1), name = 'Res72281', )(Res93837)
Res15312 = keras.layers.Reshape((8, 1, 1, 1), name = 'Res15312', )(Res72281)
Glo74675 = keras.layers.GlobalAveragePooling3D(name = 'Glo74675', )(Res15312)
model = tf.keras.models.Model(inputs=[in0Max83929,in1Max83929,in0Glo6790,in0Con82433], outputs=Glo74675)
in0Max83929 = tf.constant([[[[[0.3986, 0.4977]], [[0.1692, 0.0794]]], [[[0.7116, 0.147]], [[0.5594, 0.3965]]]]])
in1Max83929 = tf.constant([[[[[0.1298, 0.4774]], [[0.0424, 0.8691]]], [[[0.7298, 0.4997]], [[0.394, 0.8484]]]]])
in0Glo6790 = tf.constant([[[1.9647], [1.6251]]])
in0Con82433 = tf.constant([[0.7684, 0.4028, 0.5097, 0.3947, 0.9701, 0.2708, 0.0605]])
print (np.array2string(model.predict([in0Max83929,in1Max83929,in0Glo6790,in0Con82433],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo74675.png')

LMax83929 = maximum_layer([[[[[[0.3986, 0.4977]], [[0.1692, 0.0794]]], [[[0.7116, 0.147]], [[0.5594, 0.3965]]]]], [[[[[0.1298, 0.4774]], [[0.0424, 0.8691]]], [[[0.7298, 0.4997]], [[0.394, 0.8484]]]]]], Max83929), 
LRes63140 = reshape_layer(Max83929, [2, 2, 2], Res63140), 
LRes65390 = reshape_layer(Res63140, [2, 4], Res65390), 
LFla91947 = flatten_layer(Res65390, Fla91947), 
LGlo6790 = global_average_pooling1D_layer([[[1.9647], [1.6251]]], Glo6790), 
LCon82433 = concatenate_layer([Glo6790,[[0.7684, 0.4028, 0.5097, 0.3947, 0.9701, 0.2708, 0.0605]]], 1, Con82433), 
LAve44629 = average_layer([Fla91947,Con82433], Ave44629), 
LThr86919 = thresholded_relu_layer(Ave44629, 0.40903281479527276, Thr86919), 
LRes93837 = reshape_layer(Thr86919, [8, 1], Res93837), 
LRes72281 = reshape_layer(Res93837, [8, 1, 1], Res72281), 
LRes15312 = reshape_layer(Res72281, [8, 1, 1, 1], Res15312), 
LGlo74675 = global_average_pooling3D_layer(Res15312, Glo74675), 
exec_layers([LMax83929,LRes63140,LRes65390,LFla91947,LGlo6790,LCon82433,LAve44629,LThr86919,LRes93837,LRes72281,LRes15312,LGlo74675],["Max83929","Res63140","Res65390","Fla91947","Glo6790","Con82433","Ave44629","Thr86919","Res93837","Res72281","Res15312","Glo74675"],Glo74675,"Glo74675")

Actual (Unparsed): [[0.5732375]]

Expected (Unparsed): [[0.5732375000000001]]

Actual:   [[0.5733]]

Expected: [[0.5733]]