import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro79266 = tf.keras.layers.Input(shape=([4, 2, 4]))
in0Dot52746 = tf.keras.layers.Input(shape=([3]))
in1Dot52746 = tf.keras.layers.Input(shape=([3]))
in0Con72564 = tf.keras.layers.Input(shape=([7]))
in0Con97702 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Ave96374 = tf.keras.layers.Input(shape=([2, 1, 2]))

Cro79266 = keras.layers.Cropping2D(cropping=((0, 2), (0, 1)), name = 'Cro79266', )(in0Cro79266)
Res10232 = keras.layers.Reshape((2, 4), name = 'Res10232', )(Cro79266)
Fla21704 = keras.layers.Flatten(name = 'Fla21704', )(Res10232)
Dot52746 = keras.layers.Dot(axes=(1, 1), name = 'Dot52746', )([in0Dot52746,in1Dot52746])
Con72564 = keras.layers.Concatenate(axis=1, name = 'Con72564', )([Dot52746,in0Con72564])
Max72254 = keras.layers.Maximum(name = 'Max72254', )([Fla21704,Con72564])
Res84576 = keras.layers.Reshape((8, 1), name = 'Res84576', )(Max72254)
Glo21608 = keras.layers.GlobalAveragePooling1D(name = 'Glo21608', )(Res84576)
Res86070 = keras.layers.Reshape((1, 1), name = 'Res86070', )(Glo21608)
Res28923 = keras.layers.Reshape((1, 1, 1), name = 'Res28923', )(Res86070)
Res33878 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res33878', )(Res28923)
Zer24218 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer24218', )(Res33878)
Con97702 = keras.layers.Concatenate(axis=4, name = 'Con97702', )([Zer24218,in0Con97702])
Ave96374 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave96374', )(in0Ave96374)
Res23547 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res23547', )(Ave96374)
Con85660 = keras.layers.Conv3DTranspose(3, (2, 1, 2),strides=(1, 1, 1), padding='same', name = 'Con85660', )(Res23547)
Min34557 = keras.layers.Minimum(name = 'Min34557', )([Con97702,Con85660])
model = tf.keras.models.Model(inputs=[in0Cro79266,in0Dot52746,in1Dot52746,in0Con72564,in0Con97702,in0Ave96374], outputs=Min34557)
w = model.get_layer('Con85660').get_weights() 
w[0] = np.array([[[[[0.6081], [0.9851], [0.3603]], [[0.17], [0.2889], [0.8604]]]], [[[[0.2478], [0.455], [0.5018]], [[0.1939], [0.6698], [0.8167]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con85660').set_weights(w) 
in0Cro79266 = tf.constant([[[[1.6487, 1.0294, 1.7717, 1.5957], [1.6763, 1.4556, 1.5565, 1.6011]], [[1.4166, 1.7797, 1.8562, 1.9751], [1.0616, 1.3508, 1.7339, 1.0257]], [[1.8367, 1.2316, 1.3733, 1.6352], [1.7761, 1.7781, 1.6224, 1.5439]], [[1.0638, 1.3395, 1.6901, 1.7792], [1.2285, 1.2804, 1.0314, 1.2838]]]])
in0Dot52746 = tf.constant([[0.3286, 0.1363, 0.6342]])
in1Dot52746 = tf.constant([[0.8498, 0.0181, 0.4765]])
in0Con72564 = tf.constant([[0.9229, 0.7141, 0.102, 0.5089, 0.3286, 0.3062, 0.6898]])
in0Con97702 = tf.constant([[[[[0.9867, 0.4008], [0.2103, 0.5296]]], [[[0.3253, 0.064], [0.5438, 0.8903]]]]])
in0Ave96374 = tf.constant([[[[1.1127, 1.511]], [[1.0339, 1.0139]]]])
print (np.array2string(model.predict([in0Cro79266,in0Dot52746,in1Dot52746,in0Con72564,in0Con97702,in0Ave96374],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min34557.png')

LCro79266 = cropping2D_layer([[[[1.6487, 1.0294, 1.7717, 1.5957], [1.6763, 1.4556, 1.5565, 1.6011]], [[1.4166, 1.7797, 1.8562, 1.9751], [1.0616, 1.3508, 1.7339, 1.0257]], [[1.8367, 1.2316, 1.3733, 1.6352], [1.7761, 1.7781, 1.6224, 1.5439]], [[1.0638, 1.3395, 1.6901, 1.7792], [1.2285, 1.2804, 1.0314, 1.2838]]]], 0, 2, 0, 1, Cro79266), 
LRes10232 = reshape_layer(Cro79266, [2, 4], Res10232), 
LFla21704 = flatten_layer(Res10232, Fla21704), 
LDot52746 = dot_layer([[0.3286, 0.1363, 0.6342]], [[0.8498, 0.0181, 0.4765]], 1, 1, Dot52746), 
LCon72564 = concatenate_layer([Dot52746,[[0.9229, 0.7141, 0.102, 0.5089, 0.3286, 0.3062, 0.6898]]], 1, Con72564), 
LMax72254 = maximum_layer([Fla21704,Con72564], Max72254), 
LRes84576 = reshape_layer(Max72254, [8, 1], Res84576), 
LGlo21608 = global_average_pooling1D_layer(Res84576, Glo21608), 
LRes86070 = reshape_layer(Glo21608, [1, 1], Res86070), 
LRes28923 = reshape_layer(Res86070, [1, 1, 1], Res28923), 
LRes33878 = reshape_layer(Res28923, [1, 1, 1, 1], Res33878), 
LZer24218 = zero_padding3D_layer(Res33878, 1, 0, 0, 0, 1, 0, Zer24218), 
LCon97702 = concatenate_layer([Zer24218,[[[[[0.9867, 0.4008], [0.2103, 0.5296]]], [[[0.3253, 0.064], [0.5438, 0.8903]]]]]], 4, Con97702), 
LAve96374 = average_pooling2D_layer([[[[1.1127, 1.511]], [[1.0339, 1.0139]]]], 1, 1, Ave96374), 
LRes23547 = reshape_layer(Ave96374, [2, 1, 2, 1], Res23547), 
LCon85660 = conv3D_transpose_layer(Res23547, 2, 1, 2,[[[[[0.6081], [0.9851], [0.3603]], [[0.17], [0.2889], [0.8604]]]], [[[[0.2478], [0.455], [0.5018]], [[0.1939], [0.6698], [0.8167]]]]],[0, 0, 0], 1, 1, 1, true, Con85660), 
LMin34557 = minimum_layer([Con97702,Con85660], Min34557), 
exec_layers([LCro79266,LRes10232,LFla21704,LDot52746,LCon72564,LMax72254,LRes84576,LGlo21608,LRes86070,LRes28923,LRes33878,LZer24218,LCon97702,LAve96374,LRes23547,LCon85660,LMin34557],["Cro79266","Res10232","Fla21704","Dot52746","Con72564","Max72254","Res84576","Glo21608","Res86070","Res28923","Res33878","Zer24218","Con97702","Ave96374","Res23547","Con85660","Min34557"],Min34557,"Min34557")

Actual (Unparsed): [[[[[0.0000000, 0.9867000, 0.4008000], [0.0000000, 0.2103000, 0.5296000]]], [[[0.0000000, 0.3253000, 0.0640000], [1.3824940, 0.5438000, 0.8903000]]]]]

Expected (Unparsed): [[[[[0,0.9867,0.4008],[0,0.2103,0.5296]]],[[[0,0.3253,0.064],[1.38249392,0.5438,0.8903]]]]]

Actual:   [[[[[0, 0.9867, 0.4008], [0, 0.2103, 0.5296]]], [[[0, 0.3253, 0.064], [1.3825, 0.5438, 0.8903]]]]]

Expected: [[[[[0, 0.9867, 0.4008], [0, 0.2103, 0.5296]]], [[[0, 0.3253, 0.064], [1.3825, 0.5438, 0.8903]]]]]