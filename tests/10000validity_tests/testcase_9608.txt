import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr45345 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Max42388 = tf.keras.layers.Input(shape=([2, 1]))
in1Max42388 = tf.keras.layers.Input(shape=([2, 1]))
in0Con56702 = tf.keras.layers.Input(shape=([2, 1]))

Thr45345 = keras.layers.ThresholdedReLU(theta=8.171657363437399, name = 'Thr45345', input_shape=(2, 1, 1, 2))(in0Thr45345)
Res30032 = keras.layers.Reshape((2, 1, 2), name = 'Res30032', )(Thr45345)
Res20758 = keras.layers.Reshape((2, 2), name = 'Res20758', )(Res30032)
Max42388 = keras.layers.Maximum(name = 'Max42388', )([in0Max42388,in1Max42388])
Thr48103 = keras.layers.ThresholdedReLU(theta=8.548700380530454, name = 'Thr48103', )(Max42388)
Con56702 = keras.layers.Concatenate(axis=2, name = 'Con56702', )([Thr48103,in0Con56702])
Ave45416 = keras.layers.Average(name = 'Ave45416', )([Res20758,Con56702])
Res5156 = keras.layers.Reshape((2, 2, 1), name = 'Res5156', )(Ave45416)
Glo60342 = keras.layers.GlobalMaxPool2D(name = 'Glo60342', )(Res5156)
model = tf.keras.models.Model(inputs=[in0Thr45345,in0Max42388,in1Max42388,in0Con56702], outputs=Glo60342)
in0Thr45345 = tf.constant([[[[[0.5662, 0.3881]]], [[[0.8174, 0.0425]]]]])
in0Max42388 = tf.constant([[[0.3069], [0.002]]])
in1Max42388 = tf.constant([[[0.0033], [0.7634]]])
in0Con56702 = tf.constant([[[0.4094], [0.5765]]])
print (np.array2string(model.predict([in0Thr45345,in0Max42388,in1Max42388,in0Con56702],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo60342.png')

LThr45345 = thresholded_relu_layer([[[[[0.5662, 0.3881]]], [[[0.8174, 0.0425]]]]], 8.171657363437399, Thr45345), 
LRes30032 = reshape_layer(Thr45345, [2, 1, 2], Res30032), 
LRes20758 = reshape_layer(Res30032, [2, 2], Res20758), 
LMax42388 = maximum_layer([[[[0.3069], [0.002]]], [[[0.0033], [0.7634]]]], Max42388), 
LThr48103 = thresholded_relu_layer(Max42388, 8.548700380530454, Thr48103), 
LCon56702 = concatenate_layer([Thr48103,[[[0.4094], [0.5765]]]], 2, Con56702), 
LAve45416 = average_layer([Res20758,Con56702], Ave45416), 
LRes5156 = reshape_layer(Ave45416, [2, 2, 1], Res5156), 
LGlo60342 = global_max_pool2D_layer(Res5156, Glo60342), 
exec_layers([LThr45345,LRes30032,LRes20758,LMax42388,LThr48103,LCon56702,LAve45416,LRes5156,LGlo60342],["Thr45345","Res30032","Res20758","Max42388","Thr48103","Con56702","Ave45416","Res5156","Glo60342"],Glo60342,"Glo60342")

Actual (Unparsed): [[0.2882500]]

Expected (Unparsed): [[0.28825]]

Actual:   [[0.2883]]

Expected: [[0.2883]]