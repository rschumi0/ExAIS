import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave15080 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Ave15080 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Ave15080 = keras.layers.Average(name = 'Ave15080', )([in0Ave15080,in1Ave15080])
Res6475 = keras.layers.Reshape((2, 2, 2), name = 'Res6475', )(Ave15080)
Res42566 = keras.layers.Reshape((2, 4), name = 'Res42566', )(Res6475)
Zer34614 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer34614', )(Res42566)
Res56725 = keras.layers.Reshape((4, 4, 1), name = 'Res56725', )(Zer34614)
Res94219 = keras.layers.Reshape((4, 4, 1, 1), name = 'Res94219', )(Res56725)
Con85400 = keras.layers.Conv3DTranspose(3, (4, 2, 1),strides=(1, 1, 1), padding='valid', name = 'Con85400', )(Res94219)
model = tf.keras.models.Model(inputs=[in0Ave15080,in1Ave15080], outputs=Con85400)
w = model.get_layer('Con85400').get_weights() 
w[0] = np.array([[[[[0.1567], [0.8634], [0.692]]], [[[0.4348], [0.814], [0.1962]]]], [[[[0.1053], [0.3377], [0.5069]]], [[[0.4172], [0.4841], [0.53]]]], [[[[0.9083], [0.8976], [0.0579]]], [[[0.1509], [0.682], [0.9811]]]], [[[[0.6317], [0.2242], [0.7436]]], [[[0.7319], [0.9697], [0.5405]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con85400').set_weights(w) 
in0Ave15080 = tf.constant([[[[[0.0758, 0.2996]], [[0.0764, 0.8715]]], [[[0.8987, 0.4268]], [[0.5576, 0.6583]]]]])
in1Ave15080 = tf.constant([[[[[0.8382, 0.8248]], [[0.8849, 0.2442]]], [[[0.1004, 0.1363]], [[0.7833, 0.4562]]]]])
print (np.array2string(model.predict([in0Ave15080,in1Ave15080],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con85400.png')

LAve15080 = average_layer([[[[[[0.0758, 0.2996]], [[0.0764, 0.8715]]], [[[0.8987, 0.4268]], [[0.5576, 0.6583]]]]], [[[[[0.8382, 0.8248]], [[0.8849, 0.2442]]], [[[0.1004, 0.1363]], [[0.7833, 0.4562]]]]]], Ave15080), 
LRes6475 = reshape_layer(Ave15080, [2, 2, 2], Res6475), 
LRes42566 = reshape_layer(Res6475, [2, 4], Res42566), 
LZer34614 = zero_padding1D_layer(Res42566, 1, 1, Zer34614), 
LRes56725 = reshape_layer(Zer34614, [4, 4, 1], Res56725), 
LRes94219 = reshape_layer(Res56725, [4, 4, 1, 1], Res94219), 
LCon85400 = conv3D_transpose_layer(Res94219, 4, 2, 1,[[[[[0.1567], [0.8634], [0.692]]], [[[0.4348], [0.814], [0.1962]]]], [[[[0.1053], [0.3377], [0.5069]]], [[[0.4172], [0.4841], [0.53]]]], [[[[0.9083], [0.8976], [0.0579]]], [[[0.1509], [0.682], [0.9811]]]], [[[[0.6317], [0.2242], [0.7436]]], [[[0.7319], [0.9697], [0.5405]]]]],[0, 0, 0], 1, 1, 1, false, Con85400), 
exec_layers([LAve15080,LRes6475,LRes42566,LZer34614,LRes56725,LRes94219,LCon85400],["Ave15080","Res6475","Res42566","Zer34614","Res56725","Res94219","Con85400"],Con85400,"Con85400")

Actual (Unparsed): [[[[[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]]], [[[0.0716119, 0.3945738, 0.3162440]], [[0.2868003, 0.8574015, 0.4787058]], [[0.3197624, 0.8726240, 0.4429134]], [[0.2964017, 0.8728968, 0.4803357]], [[0.2425532, 0.4540899, 0.1094502]]], [[[0.1264016, 0.5856404, 0.5773419]], [[0.5111833, 1.0608126, 0.8200335]], [[0.5126397, 1.2425248, 1.0607990]], [[0.6381015, 1.4479446, 1.0546779]], [[0.4750273, 0.7236567, 0.4049930]]], [[[0.4676957, 0.5789012, 0.2796822]], [[0.8176670, 1.1532163, 0.8883933]], [[0.7094714, 1.1775612, 1.0684767]], [[0.9176154, 1.3412776, 1.1416737]], [[0.3166643, 0.6502184, 0.8426491]]], [[[0.7424282, 0.5508555, 0.3687491]], [[1.0207340, 1.1626105, 1.1714707]], [[1.3665564, 1.4467401, 0.9763282]], [[1.3115027, 1.5485908, 1.3646519]], [[0.4923794, 0.9209917, 0.8482359]]], [[[0.3155657, 0.1119991, 0.3714654]], [[0.5434758, 0.5475371, 0.4793674]], [[0.6295897, 0.4233339, 0.6507244]], [[0.8427172, 0.7750708, 0.7767493]], [[0.4078513, 0.5403653, 0.3011936]]], [[[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]]]]]

Expected (Unparsed): [[[[[0.0,0.0,0.0]],[[0.0,0.0,0.0]],[[0.0,0.0,0.0]],[[0.0,0.0,0.0]],[[0.0,0.0,0.0]]],[[[0.07161189999999999,0.3945737999999999,0.31624399999999997]],[[0.28680034,0.8574014799999999,0.4787058]],[[0.319762415,0.87262401,0.44291344]],[[0.296401715,0.87289679,0.48033573]],[[0.24255318000000003,0.45408990000000005,0.10945017000000003]]],[[[0.126401585,0.58564037,0.5773419]],[[0.511183285,1.06081261,0.8200334900000001]],[[0.51263974,1.242524755,1.060798995]],[[0.63810152,1.4479445599999998,1.054677955]],[[0.47502732000000003,0.723656685,0.4049929500000001]]],[[[0.46769571499999996,0.578901235,0.279682195]],[[0.817667035,1.15321631,0.888393275]],[[0.7094714200000001,1.17756116,1.06847666]],[[0.917615405,1.3412776300000002,1.141673755]],[[0.316664265,0.650218425,0.842649135]]],[[[0.742428165,0.5508554800000001,0.368749145]],[[1.020734,1.16261052,1.17147067]],[[1.366556415,1.44674009,0.9763282000000002]],[[1.31150266,1.548590775,1.3646518550000002]],[[0.4923794400000001,0.9209916450000002,0.8482358999999999]]],[[[0.31556573500000007,0.11199911000000001,0.37146538000000007]],[[0.5434757800000001,0.5475371450000001,0.47936735500000005]],[[0.6295897100000001,0.423333925,0.650724395]],[[0.84271718,0.7750708150000001,0.776749325]],[[0.407851275,0.540365325,0.301193625]]],[[[0.0,0.0,0.0]],[[0.0,0.0,0.0]],[[0.0,0.0,0.0]],[[0.0,0.0,0.0]],[[0.0,0.0,0.0]]]]]

Actual:   [[[[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]], [[[0.0717, 0.3946, 0.3163]], [[0.2869, 0.8575, 0.4788]], [[0.3198, 0.8727, 0.443]], [[0.2965, 0.8729, 0.4804]], [[0.2426, 0.4541, 0.1095]]], [[[0.1265, 0.5857, 0.5774]], [[0.5112, 1.0609, 0.8201]], [[0.5127, 1.2426, 1.0608]], [[0.6382, 1.448, 1.0547]], [[0.4751, 0.7237, 0.405]]], [[[0.4677, 0.579, 0.2797]], [[0.8177, 1.1533, 0.8884]], [[0.7095, 1.1776, 1.0685]], [[0.9177, 1.3413, 1.1417]], [[0.3167, 0.6503, 0.8427]]], [[[0.7425, 0.5509, 0.3688]], [[1.0208, 1.1627, 1.1715]], [[1.3666, 1.4468, 0.9764]], [[1.3116, 1.5486, 1.3647]], [[0.4924, 0.921, 0.8483]]], [[[0.3156, 0.112, 0.3715]], [[0.5435, 0.5476, 0.4794]], [[0.6296, 0.4234, 0.6508]], [[0.8428, 0.7751, 0.7768]], [[0.4079, 0.5404, 0.3012]]], [[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]]]]

Expected: [[[[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]], [[[0.0717, 0.3946, 0.3163]], [[0.2869, 0.8575, 0.4788]], [[0.3198, 0.8727, 0.443]], [[0.2965, 0.8729, 0.4804]], [[0.2426, 0.4541, 0.1095]]], [[[0.1265, 0.5857, 0.5774]], [[0.5112, 1.0609, 0.8201]], [[0.5127, 1.2426, 1.0608]], [[0.6382, 1.448, 1.0547]], [[0.4751, 0.7237, 0.405]]], [[[0.4677, 0.579, 0.2797]], [[0.8177, 1.1533, 0.8884]], [[0.7095, 1.1776, 1.0685]], [[0.9177, 1.3413, 1.1417]], [[0.3167, 0.6503, 0.8427]]], [[[0.7425, 0.5509, 0.3688]], [[1.0208, 1.1627, 1.1715]], [[1.3666, 1.4468, 0.9764]], [[1.3116, 1.5486, 1.3647]], [[0.4924, 0.921, 0.8483]]], [[[0.3156, 0.112, 0.3715]], [[0.5435, 0.5476, 0.4794]], [[0.6296, 0.4234, 0.6508]], [[0.8428, 0.7751, 0.7768]], [[0.4079, 0.5404, 0.3012]]], [[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]]]]