import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave62131 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Ave62131 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Max59527 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max59527 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con20277 = tf.keras.layers.Input(shape=([2, 2, 2]))

Ave62131 = keras.layers.Average(name = 'Ave62131', )([in0Ave62131,in1Ave62131])
Res61005 = keras.layers.Reshape((2, 2, 4), name = 'Res61005', )(Ave62131)
Max59527 = keras.layers.Maximum(name = 'Max59527', )([in0Max59527,in1Max59527])
Con20277 = keras.layers.Concatenate(axis=3, name = 'Con20277', )([Max59527,in0Con20277])
Ave55772 = keras.layers.Average(name = 'Ave55772', )([Res61005,Con20277])
Max41592 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 12), padding='same', name = 'Max41592', )(Ave55772)
model = tf.keras.models.Model(inputs=[in0Ave62131,in1Ave62131,in0Max59527,in1Max59527,in0Con20277], outputs=Max41592)
in0Ave62131 = tf.constant([[[[[0.356, 0.9621], [0.1328, 0.484]], [[0.7503, 0.0015], [0.7931, 0.6354]]], [[[0.3196, 0.691], [0.0605, 0.0672]], [[0.3201, 0.2731], [0.0119, 0.0924]]]]])
in1Ave62131 = tf.constant([[[[[0.5663, 0.3614], [0.3937, 0.2785]], [[0.262, 0.7651], [0.5696, 0.0431]]], [[[0.6955, 0.1868], [0.6366, 0.6234]], [[0.1497, 0.5824], [0.895, 0.2855]]]]])
in0Max59527 = tf.constant([[[[0.3083, 0.1939], [0.4291, 0.1248]], [[0.8981, 0.2666], [0.1597, 0.573]]]])
in1Max59527 = tf.constant([[[[0.3055, 0.2427], [0.3615, 0.7778]], [[0.424, 0.7894], [0.3032, 0.348]]]])
in0Con20277 = tf.constant([[[[0.7282, 0.084], [0.5435, 0.7311]], [[0.5758, 0.4577], [0.1921, 0.5145]]]])
print (np.array2string(model.predict([in0Ave62131,in1Ave62131,in0Max59527,in1Max59527,in0Con20277],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max41592.png')

LAve62131 = average_layer([[[[[[0.356, 0.9621], [0.1328, 0.484]], [[0.7503, 0.0015], [0.7931, 0.6354]]], [[[0.3196, 0.691], [0.0605, 0.0672]], [[0.3201, 0.2731], [0.0119, 0.0924]]]]], [[[[[0.5663, 0.3614], [0.3937, 0.2785]], [[0.262, 0.7651], [0.5696, 0.0431]]], [[[0.6955, 0.1868], [0.6366, 0.6234]], [[0.1497, 0.5824], [0.895, 0.2855]]]]]], Ave62131), 
LRes61005 = reshape_layer(Ave62131, [2, 2, 4], Res61005), 
LMax59527 = maximum_layer([[[[[0.3083, 0.1939], [0.4291, 0.1248]], [[0.8981, 0.2666], [0.1597, 0.573]]]], [[[[0.3055, 0.2427], [0.3615, 0.7778]], [[0.424, 0.7894], [0.3032, 0.348]]]]], Max59527), 
LCon20277 = concatenate_layer([Max59527,[[[[0.7282, 0.084], [0.5435, 0.7311]], [[0.5758, 0.4577], [0.1921, 0.5145]]]]], 3, Con20277), 
LAve55772 = average_layer([Res61005,Con20277], Ave55772), 
LMax41592 = max_pool2D_layer(Ave55772, 1, 1, 1, 12, true, Max41592), 
exec_layers([LAve62131,LRes61005,LMax59527,LCon20277,LAve55772,LMax41592],["Ave62131","Res61005","Max59527","Con20277","Ave55772","Max41592"],Max41592,"Max41592")

Actual (Unparsed): [[[[0.3847250, 0.4522250, 0.4957250, 0.2326250]], [[0.7028250, 0.6141500, 0.4621750, 0.4015000]]]]

Expected (Unparsed): [[[[0.384725,0.452225,0.49572499999999997,0.232625]],[[0.702825,0.61415,0.462175,0.40149999999999997]]]]

Actual:   [[[[0.3848, 0.4523, 0.4958, 0.2327]], [[0.7029, 0.6142, 0.4622, 0.4015]]]]

Expected: [[[[0.3848, 0.4523, 0.4958, 0.2327]], [[0.7029, 0.6142, 0.4622, 0.4015]]]]