import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot56288 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot56288 = tf.keras.layers.Input(shape=([3, 2]))

Dot56288 = keras.layers.Dot(axes=(1, 1), name = 'Dot56288', )([in0Dot56288,in1Dot56288])
Res68358 = keras.layers.Reshape((2, 2, 1), name = 'Res68358', )(Dot56288)
Res483 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res483', )(Res68358)
Up_81426 = keras.layers.UpSampling3D(size=(1, 2, 1), name = 'Up_81426', )(Res483)
Res12634 = keras.layers.Reshape((2, 4, 1), name = 'Res12634', )(Up_81426)
Con44370 = keras.layers.Conv2DTranspose(4, (2, 2),strides=(2, 3), padding='valid', name = 'Con44370', )(Res12634)
Max74555 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 11), padding='same', name = 'Max74555', )(Con44370)
model = tf.keras.models.Model(inputs=[in0Dot56288,in1Dot56288], outputs=Max74555)
w = model.get_layer('Con44370').get_weights() 
w[0] = np.array([[[[0.7501], [0.5355], [0.5839], [0.7985]], [[0.9012], [0.2615], [0.7965], [0.8295]]], [[[0.2833], [0.8501], [0.5231], [0.7122]], [[0.15], [0.1719], [0.9619], [0.9463]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con44370').set_weights(w) 
in0Dot56288 = tf.constant([[[0.3584, 0.9723], [0.5091, 0.2623], [0.5552, 0.0256]]])
in1Dot56288 = tf.constant([[[0.8197, 0.8143], [0.9279, 0.1563], [0.2689, 0.1723]]])
print (np.array2string(model.predict([in0Dot56288,in1Dot56288],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max74555.png')

LDot56288 = dot_layer([[[0.3584, 0.9723], [0.5091, 0.2623], [0.5552, 0.0256]]], [[[0.8197, 0.8143], [0.9279, 0.1563], [0.2689, 0.1723]]], 1, 1, Dot56288), 
LRes68358 = reshape_layer(Dot56288, [2, 2, 1], Res68358), 
LRes483 = reshape_layer(Res68358, [2, 2, 1, 1], Res483), 
LUp_81426 = up_sampling3D_layer(Res483, 1, 2, 1, Up_81426), 
LRes12634 = reshape_layer(Up_81426, [2, 4, 1], Res12634), 
LCon44370 = conv2D_transpose_layer(Res12634, 2, 2,[[[[0.7501], [0.5355], [0.5839], [0.7985]], [[0.9012], [0.2615], [0.7965], [0.8295]]], [[[0.2833], [0.8501], [0.5231], [0.7122]], [[0.15], [0.1719], [0.9619], [0.9463]]]],[0, 0, 0, 0], 2, 3, false, Con44370), 
LMax74555 = max_pool2D_layer(Con44370, 1, 1, 1, 11, true, Max74555), 
exec_layers([LDot56288,LRes68358,LRes483,LUp_81426,LRes12634,LCon44370,LMax74555],["Dot56288","Res68358","Res483","Up_81426","Res12634","Con44370","Max74555"],Max74555,"Max74555")

Actual (Unparsed): [[[[0.6866923, 0.4902329, 0.5345416, 0.7310009], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.2593520, 0.7782391, 0.4788811, 0.6519961], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.7855545, 0.5608111, 0.6114988, 0.8362422], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.2966906, 0.8902811, 0.5478250, 0.7458631], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0.686692284265,0.49023292657499995,0.5345415608349999,0.7310009185249999],[0,0,0,0]],[[0.25935198524499997,0.778239049265,0.47888112771499997,0.65199606033],[0,0,0,0]],[[0.7855544666319999,0.5608111143599999,0.6114988042479998,0.8362421565199999],[0,0,0,0]],[[0.29669054845599996,0.8902810986319999,0.547825011992,0.7458630731039999],[0,0,0,0]]]]

Actual:   [[[[0.6867, 0.4903, 0.5346, 0.7311], [0, 0, 0, 0]], [[0.2594, 0.7783, 0.4789, 0.652], [0, 0, 0, 0]], [[0.7856, 0.5609, 0.6115, 0.8363], [0, 0, 0, 0]], [[0.2967, 0.8903, 0.5479, 0.7459], [0, 0, 0, 0]]]]

Expected: [[[[0.6867, 0.4903, 0.5346, 0.7311], [0, 0, 0, 0]], [[0.2594, 0.7783, 0.4789, 0.652], [0, 0, 0, 0]], [[0.7856, 0.5609, 0.6115, 0.8363], [0, 0, 0, 0]], [[0.2967, 0.8903, 0.5479, 0.7459], [0, 0, 0, 0]]]]