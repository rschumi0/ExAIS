import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max83038 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max83038 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con139 = tf.keras.layers.Input(shape=([2]))
in0Max50136 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max50136 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Glo21976 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con74541 = tf.keras.layers.Input(shape=([3]))

Max83038 = keras.layers.Maximum(name = 'Max83038', )([in0Max83038,in1Max83038])
Res14434 = keras.layers.Reshape((1, 2), name = 'Res14434', )(Max83038)
Fla97086 = keras.layers.Flatten(name = 'Fla97086', )(Res14434)
Con139 = keras.layers.Concatenate(axis=1, name = 'Con139', )([Fla97086,in0Con139])
Max50136 = keras.layers.Maximum(name = 'Max50136', )([in0Max50136,in1Max50136])
Res83266 = keras.layers.Reshape((2, 2), name = 'Res83266', )(Max50136)
Fla99062 = keras.layers.Flatten(name = 'Fla99062', )(Res83266)
Glo21976 = keras.layers.GlobalMaxPool2D(name = 'Glo21976', )(in0Glo21976)
Con74541 = keras.layers.Concatenate(axis=1, name = 'Con74541', )([Glo21976,in0Con74541])
Ave99463 = keras.layers.Average(name = 'Ave99463', )([Fla99062,Con74541])
Dot3598 = keras.layers.Dot(axes=(1, 1), name = 'Dot3598', )([Con139,Ave99463])
Mas11827 = keras.layers.Masking(mask_value=1, name = 'Mas11827', )(Dot3598)
model = tf.keras.models.Model(inputs=[in0Max83038,in1Max83038,in0Con139,in0Max50136,in1Max50136,in0Glo21976,in0Con74541], outputs=Mas11827)
in0Max83038 = tf.constant([[[[0.9748], [0.8763]]]])
in1Max83038 = tf.constant([[[[0.6743], [0.4253]]]])
in0Con139 = tf.constant([[0.5241, 0.1586]])
in0Max50136 = tf.constant([[[[0.0603, 0.3779]], [[0.6708, 0.8595]]]])
in1Max50136 = tf.constant([[[[0.3322, 0.4867]], [[0.4676, 0.322]]]])
in0Glo21976 = tf.constant([[[[1.8249]], [[1.7763]]]])
in0Con74541 = tf.constant([[0.3434, 0.3153, 0.2747]])
print (np.array2string(model.predict([in0Max83038,in1Max83038,in0Con139,in0Max50136,in1Max50136,in0Glo21976,in0Con74541],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas11827.png')

LMax83038 = maximum_layer([[[[[0.9748], [0.8763]]]], [[[[0.6743], [0.4253]]]]], Max83038), 
LRes14434 = reshape_layer(Max83038, [1, 2], Res14434), 
LFla97086 = flatten_layer(Res14434, Fla97086), 
LCon139 = concatenate_layer([Fla97086,[[0.5241, 0.1586]]], 1, Con139), 
LMax50136 = maximum_layer([[[[[0.0603, 0.3779]], [[0.6708, 0.8595]]]], [[[[0.3322, 0.4867]], [[0.4676, 0.322]]]]], Max50136), 
LRes83266 = reshape_layer(Max50136, [2, 2], Res83266), 
LFla99062 = flatten_layer(Res83266, Fla99062), 
LGlo21976 = global_max_pool2D_layer([[[[1.8249]], [[1.7763]]]], Glo21976), 
LCon74541 = concatenate_layer([Glo21976,[[0.3434, 0.3153, 0.2747]]], 1, Con74541), 
LAve99463 = average_layer([Fla99062,Con74541], Ave99463), 
LDot3598 = dot_layer(Con139,Ave99463, 1, 1, Dot3598), 
LMas11827 = masking_layer(Dot3598, 1, Mas11827), 
exec_layers([LMax83038,LRes14434,LFla97086,LCon139,LMax50136,LRes83266,LFla99062,LGlo21976,LCon74541,LAve99463,LDot3598,LMas11827],["Max83038","Res14434","Fla97086","Con139","Max50136","Res83266","Fla99062","Glo21976","Con74541","Ave99463","Dot3598","Mas11827"],Mas11827,"Mas11827")

Actual (Unparsed): [[1.7634284]]

Expected (Unparsed): [[1.76342842]]

Actual:   [[1.7635]]

Expected: [[1.7635]]