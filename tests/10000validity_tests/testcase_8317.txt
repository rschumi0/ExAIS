import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max11614 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max11614 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con45867 = tf.keras.layers.Input(shape=([2, 2, 7]))
in0Con79958 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Max11614 = keras.layers.Maximum(name = 'Max11614', )([in0Max11614,in1Max11614])
Con45867 = keras.layers.Concatenate(axis=3, name = 'Con45867', )([Max11614,in0Con45867])
Con79958 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con79958', )(in0Con79958)
Res29015 = keras.layers.Reshape((1, 1, 8), name = 'Res29015', )(Con79958)
Dep97926 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep97926', )(Res29015)
Zer21156 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer21156', )(Dep97926)
Mul38820 = keras.layers.Multiply(name = 'Mul38820', )([Con45867,Zer21156])
model = tf.keras.models.Model(inputs=[in0Max11614,in1Max11614,in0Con45867,in0Con79958], outputs=Mul38820)
w = model.get_layer('Con79958').get_weights() 
w[0] = np.array([[[[[0.2622, 0.9938, 0.2377, 0.0684]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con79958').set_weights(w) 
w = model.get_layer('Dep97926').get_weights() 
w[0] = np.array([[[[0.3095], [0.9075], [0.3056], [0.1281], [0.7921], [0.3851], [0.6629], [0.6133]]]])
w[1] = np.array([0, 0, 0, 0, 0, 0, 0, 0])
model.get_layer('Dep97926').set_weights(w) 
in0Max11614 = tf.constant([[[[0.2885], [0.37]], [[0.4851], [0.4762]]]])
in1Max11614 = tf.constant([[[[0.9997], [0.7238]], [[0.6199], [0.4842]]]])
in0Con45867 = tf.constant([[[[0.7232, 0.9426, 0.0156, 0.0257, 0.3534, 0.6346, 0.7482], [0.8332, 0.7634, 0.1573, 0.6086, 0.5608, 0.7448, 0.141]], [[0.5794, 0.3645, 0.6063, 0.5876, 0.0601, 0.1514, 0.5951], [0.8575, 0.7063, 0.7232, 0.1562, 0.237, 0.8751, 0.9455]]]])
in0Con79958 = tf.constant([[[[[0.6175], [0.0857]]]]])
print (np.array2string(model.predict([in0Max11614,in1Max11614,in0Con45867,in0Con79958],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul38820.png')

LMax11614 = maximum_layer([[[[[0.2885], [0.37]], [[0.4851], [0.4762]]]], [[[[0.9997], [0.7238]], [[0.6199], [0.4842]]]]], Max11614), 
LCon45867 = concatenate_layer([Max11614,[[[[0.7232, 0.9426, 0.0156, 0.0257, 0.3534, 0.6346, 0.7482], [0.8332, 0.7634, 0.1573, 0.6086, 0.5608, 0.7448, 0.141]], [[0.5794, 0.3645, 0.6063, 0.5876, 0.0601, 0.1514, 0.5951], [0.8575, 0.7063, 0.7232, 0.1562, 0.237, 0.8751, 0.9455]]]]], 3, Con45867), 
LCon79958 = conv3D_layer([[[[[0.6175], [0.0857]]]]], 1, 1, 1,[[[[[0.2622, 0.9938, 0.2377, 0.0684]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con79958), 
LRes29015 = reshape_layer(Con79958, [1, 1, 8], Res29015), 
LDep97926 = depthwise_conv2D_layer(Res29015, 1, 1,[[[[0.3095], [0.9075], [0.3056], [0.1281], [0.7921], [0.3851], [0.6629], [0.6133]]]],[0, 0, 0, 0, 0, 0, 0, 0], 1, 1, false, Dep97926), 
LZer21156 = zero_padding2D_layer(Dep97926, 1, 0, 1, 0, Zer21156), 
LMul38820 = multiply_layer([Con45867,Zer21156], Mul38820), 
exec_layers([LMax11614,LCon45867,LCon79958,LRes29015,LDep97926,LZer21156,LMul38820],["Max11614","Con45867","Con79958","Res29015","Dep97926","Zer21156","Mul38820"],Mul38820,"Mul38820")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0242636, 0.4775477, 0.0316817, 0.0039129, 0.0027802, 0.0077732, 0.0118172, 0.0033992]]]]

Expected (Unparsed): [[[[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]],[[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.024263591619150003,0.47754765495937507,0.03168171623708001,0.00391291677504,0.0027801904814508,0.007773232878941999,0.0118172304946731,0.0033991585442819995]]]]

Actual:   [[[[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]], [[0, 0, 0, 0, 0, 0, 0, 0], [0.0243, 0.4776, 0.0317, 0.004, 0.0028, 0.0078, 0.0119, 0.0034]]]]

Expected: [[[[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]], [[0, 0, 0, 0, 0, 0, 0, 0], [0.0243, 0.4776, 0.0317, 0.004, 0.0028, 0.0078, 0.0119, 0.0034]]]]