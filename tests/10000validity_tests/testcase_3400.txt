import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas92974 = tf.keras.layers.Input(shape=([2, 1]))
in0Con13624 = tf.keras.layers.Input(shape=([2, 3, 3]))
in0Min58494 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Min58494 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Max40407 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Max40407 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Mas92974 = keras.layers.Masking(mask_value=2, name = 'Mas92974', )(in0Mas92974)
Res14737 = keras.layers.Reshape((2, 1, 1), name = 'Res14737', )(Mas92974)
Zer45147 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer45147', )(Res14737)
Con13624 = keras.layers.Concatenate(axis=3, name = 'Con13624', )([Zer45147,in0Con13624])
Min58494 = keras.layers.Minimum(name = 'Min58494', )([in0Min58494,in1Min58494])
ELU60370 = keras.layers.ELU(alpha=-1.0487928640008288, name = 'ELU60370', )(Min58494)
Res68366 = keras.layers.Reshape((1, 2, 4), name = 'Res68366', )(ELU60370)
Zer90783 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer90783', )(Res68366)
Max40407 = keras.layers.Maximum(name = 'Max40407', )([in0Max40407,in1Max40407])
Res5484 = keras.layers.Reshape((2, 1, 2), name = 'Res5484', )(Max40407)
Loc24546 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 3), name = 'Loc24546', )(Res5484)
Zer50552 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer50552', )(Loc24546)
Ave79264 = keras.layers.Average(name = 'Ave79264', )([Zer90783,Zer50552])
Add30126 = keras.layers.Add(name = 'Add30126', )([Con13624,Ave79264])
model = tf.keras.models.Model(inputs=[in0Mas92974,in0Con13624,in0Min58494,in1Min58494,in0Max40407,in1Max40407], outputs=Add30126)
w = model.get_layer('Loc24546').get_weights() 
w[0] = np.array([[[0.4742, 0.7233, 0.8901, 0.4915], [0.1252, 0.4889, 0.9571, 0.6389]], [[0.6032, 0.3806, 0.1744, 0.716], [0.785, 0.6605, 0.6876, 0.9273]]])
w[1] = np.array([[[0, 0, 0, 0]], [[0, 0, 0, 0]]])
model.get_layer('Loc24546').set_weights(w) 
in0Mas92974 = tf.constant([[[1.8], [1.1488]]])
in0Con13624 = tf.constant([[[[0.0227, 0.9086, 0.5994], [0.1591, 0.9509, 0.6443], [0.3322, 0.9301, 0.8357]], [[0.6719, 0.6383, 0.0648], [0.6999, 0.2854, 0.7137], [0.0215, 0.8028, 0.5454]]]])
in0Min58494 = tf.constant([[[[[0.8412, 0.969], [0.4777, 0.1859]], [[0.6684, 0.2217], [0.3104, 0.8474]]]]])
in1Min58494 = tf.constant([[[[[0.2854, 0.3106], [0.0707, 0.4203]], [[0.2018, 0.8089], [0.472, 0.5567]]]]])
in0Max40407 = tf.constant([[[[[0.5408], [0.5824]]], [[[0.3162], [0.7385]]]]])
in1Max40407 = tf.constant([[[[[0.0592], [0.3672]]], [[[0.1361], [0.2724]]]]])
print (np.array2string(model.predict([in0Mas92974,in0Con13624,in0Min58494,in1Min58494,in0Max40407,in1Max40407],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add30126.png')

LMas92974 = masking_layer([[[1.8], [1.1488]]], 2, Mas92974), 
LRes14737 = reshape_layer(Mas92974, [2, 1, 1], Res14737), 
LZer45147 = zero_padding2D_layer(Res14737, 0, 0, 2, 0, Zer45147), 
LCon13624 = concatenate_layer([Zer45147,[[[[0.0227, 0.9086, 0.5994], [0.1591, 0.9509, 0.6443], [0.3322, 0.9301, 0.8357]], [[0.6719, 0.6383, 0.0648], [0.6999, 0.2854, 0.7137], [0.0215, 0.8028, 0.5454]]]]], 3, Con13624), 
LMin58494 = minimum_layer([[[[[[0.8412, 0.969], [0.4777, 0.1859]], [[0.6684, 0.2217], [0.3104, 0.8474]]]]], [[[[[0.2854, 0.3106], [0.0707, 0.4203]], [[0.2018, 0.8089], [0.472, 0.5567]]]]]], Min58494), 
LELU60370 = elu_layer(Min58494, -1.0487928640008288, ELU60370), 
LRes68366 = reshape_layer(ELU60370, [1, 2, 4], Res68366), 
LZer90783 = zero_padding2D_layer(Res68366, 1, 0, 1, 0, Zer90783), 
LMax40407 = maximum_layer([[[[[[0.5408], [0.5824]]], [[[0.3162], [0.7385]]]]], [[[[[0.0592], [0.3672]]], [[[0.1361], [0.2724]]]]]], Max40407), 
LRes5484 = reshape_layer(Max40407, [2, 1, 2], Res5484), 
LLoc24546 = locally_connected2D_layer(Res5484, 1, 1,[[[0.4742, 0.7233, 0.8901, 0.4915], [0.1252, 0.4889, 0.9571, 0.6389]], [[0.6032, 0.3806, 0.1744, 0.716], [0.785, 0.6605, 0.6876, 0.9273]]],[[[0, 0, 0, 0]], [[0, 0, 0, 0]]], 1, 3, Loc24546), 
LZer50552 = zero_padding2D_layer(Loc24546, 0, 0, 2, 0, Zer50552), 
LAve79264 = average_layer([Zer90783,Zer50552], Ave79264), 
LAdd30126 = add_layer([Con13624,Ave79264], Add30126), 
exec_layers([LMas92974,LRes14737,LZer45147,LCon13624,LMin58494,LELU60370,LRes68366,LZer90783,LMax40407,LRes5484,LLoc24546,LZer50552,LAve79264,LAdd30126],["Mas92974","Res14737","Zer45147","Con13624","Min58494","ELU60370","Res68366","Zer90783","Max40407","Res5484","Loc24546","Zer50552","Ave79264","Add30126"],Add30126,"Add30126")

Actual (Unparsed): [[[[0.0000000, 0.0227000, 0.9086000, 0.5994000], [0.0000000, 0.1591000, 0.9509000, 0.6443000], [1.9646819, 0.6701480, 1.4494906, 1.1546493]], [[0.0000000, 0.6719000, 0.6383000, 0.0648000], [0.1427000, 0.8552000, 0.3207500, 0.8066500], [1.6349272, 0.4364125, 1.2394689, 1.2793551]]]]

Expected (Unparsed): [[[[0,0.0227,0.9086,0.5994],[0,0.1591,0.9509,0.6443],[1.96468192,0.670148,1.44949056,1.1546492800000001]],[[0,0.6719,0.6383,0.0648],[0.1427,0.8552,0.32075,0.80665],[1.63492717,0.436412485,1.23946894,1.279355125]]]]

Actual:   [[[[0, 0.0227, 0.9086, 0.5994], [0, 0.1591, 0.9509, 0.6443], [1.9647, 0.6702, 1.4495, 1.1547]], [[0, 0.6719, 0.6383, 0.0648], [0.1427, 0.8552, 0.3208, 0.8067], [1.635, 0.4365, 1.2395, 1.2794]]]]

Expected: [[[[0, 0.0227, 0.9086, 0.5994], [0, 0.1591, 0.9509, 0.6443], [1.9647, 0.6702, 1.4495, 1.1547]], [[0, 0.6719, 0.6383, 0.0648], [0.1427, 0.8552, 0.3208, 0.8067], [1.635, 0.4365, 1.2395, 1.2794]]]]