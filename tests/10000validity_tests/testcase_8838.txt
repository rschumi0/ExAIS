import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave41582 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave41582 = tf.keras.layers.Input(shape=([2, 1]))
in0Add58116 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Add58116 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Ave41582 = keras.layers.Average(name = 'Ave41582', )([in0Ave41582,in1Ave41582])
Loc41799 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc41799', )(Ave41582)
Res45620 = keras.layers.Reshape((1, 3, 1), name = 'Res45620', )(Loc41799)
Res83792 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res83792', )(Res45620)
Add58116 = keras.layers.Add(name = 'Add58116', )([in0Add58116,in1Add58116])
Zer76793 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer76793', )(Add58116)
Max41687 = keras.layers.Maximum(name = 'Max41687', )([Res83792,Zer76793])
ReL88492 = keras.layers.ReLU(max_value=9.217555690242875, negative_slope=5.639534357988969, threshold=0.8245261718434505, name = 'ReL88492', )(Max41687)
Lay81743 = keras.layers.LayerNormalization(axis=3, epsilon=2.868303858146559, name = 'Lay81743', )(ReL88492)
model = tf.keras.models.Model(inputs=[in0Ave41582,in1Ave41582,in0Add58116,in1Add58116], outputs=Lay81743)
w = model.get_layer('Loc41799').get_weights() 
w[0] = np.array([[[0.109, 0.3333, 0.0062], [0.5661, 0.7494, 0.1442]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc41799').set_weights(w) 
in0Ave41582 = tf.constant([[[0.1265], [0.2964]]])
in1Ave41582 = tf.constant([[[0.395], [0.5658]]])
in0Add58116 = tf.constant([[[[[0.1068]]]]])
in1Add58116 = tf.constant([[[[[0.4855]]]]])
print (np.array2string(model.predict([in0Ave41582,in1Ave41582,in0Add58116,in1Add58116],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay81743.png')

LAve41582 = average_layer([[[[0.1265], [0.2964]]], [[[0.395], [0.5658]]]], Ave41582), 
LLoc41799 = locally_connected1D_layer(Ave41582, 2,[[[0.109, 0.3333, 0.0062], [0.5661, 0.7494, 0.1442]]],[[0, 0, 0]], 1, Loc41799), 
LRes45620 = reshape_layer(Loc41799, [1, 3, 1], Res45620), 
LRes83792 = reshape_layer(Res45620, [1, 3, 1, 1], Res83792), 
LAdd58116 = add_layer([[[[[[0.1068]]]]], [[[[[0.4855]]]]]], Add58116), 
LZer76793 = zero_padding3D_layer(Add58116, 0, 0, 2, 0, 0, 0, Zer76793), 
LMax41687 = maximum_layer([Res83792,Zer76793], Max41687), 
LReL88492 = relu_layer(Max41687, 9.217555690242875, 5.639534357988969, 0.8245261718434505, ReL88492), 
LLay81743 = layer_normalization_layer(ReL88492, 3, 2.868303858146559, Lay81743), 
exec_layers([LAve41582,LLoc41799,LRes45620,LRes83792,LAdd58116,LZer76793,LMax41687,LReL88492,LLay81743],["Ave41582","Loc41799","Res45620","Res83792","Add58116","Zer76793","Max41687","ReL88492","Lay81743"],Lay81743,"Lay81743")

Actual (Unparsed): [[[[[0.0000000]], [[0.0000000]], [[0.0000000]]]]]

Expected (Unparsed): [[[[[0.0]],[[0.0]],[[0.0]]]]]

Actual:   [[[[[0]], [[0]], [[0]]]]]

Expected: [[[[[0]], [[0]], [[0]]]]]