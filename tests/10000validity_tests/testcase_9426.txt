import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer28123 = tf.keras.layers.Input(shape=([1, 2]))
in0Max27529 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max27529 = tf.keras.layers.Input(shape=([1, 1, 2]))

Zer28123 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer28123', )(in0Zer28123)
Max27529 = keras.layers.Maximum(name = 'Max27529', )([in0Max27529,in1Max27529])
Res7565 = keras.layers.Reshape((1, 2), name = 'Res7565', )(Max27529)
Dot2049 = keras.layers.Dot(axes=(2, 2), name = 'Dot2049', )([Zer28123,Res7565])
GRU66511 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU66511', )(Dot2049)
model = tf.keras.models.Model(inputs=[in0Zer28123,in0Max27529,in1Max27529], outputs=GRU66511)
w = model.get_layer('GRU66511').get_weights() 
w[0] = np.array([[4, 6, 10, 8, 7, 4, 8, 7, 7]])
w[1] = np.array([[7, 8, 5, 4, 5, 9, 3, 3, 4], [5, 4, 5, 8, 7, 2, 2, 8, 8], [8, 5, 2, 8, 2, 5, 3, 10, 7]])
w[2] = np.array([[8, 9, 2, 4, 5, 1, 9, 8, 6], [10, 2, 6, 6, 6, 2, 2, 3, 10]])
model.get_layer('GRU66511').set_weights(w) 
in0Zer28123 = tf.constant([[[1.5822, 1.4602]]])
in0Max27529 = tf.constant([[[[0.2836, 0.0825]]]])
in1Max27529 = tf.constant([[[[0.6226, 0.871]]]])
print (np.array2string(model.predict([in0Zer28123,in0Max27529,in1Max27529],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU66511.png')

LZer28123 = zero_padding1D_layer([[[1.5822, 1.4602]]], 1, 1, Zer28123), 
LMax27529 = maximum_layer([[[[[0.2836, 0.0825]]]], [[[[0.6226, 0.871]]]]], Max27529), 
LRes7565 = reshape_layer(Max27529, [1, 2], Res7565), 
LDot2049 = dot_layer(Zer28123,Res7565, 2, 2, Dot2049), 
LGRU66511 = gru_layer(Dot2049,[[4, 6, 10, 8, 7, 4, 8, 7, 7]],[[7, 8, 5, 4, 5, 9, 3, 3, 4], [5, 4, 5, 8, 7, 2, 2, 8, 8], [8, 5, 2, 8, 2, 5, 3, 10, 7]],[[8, 9, 2, 4, 5, 1, 9, 8, 6], [10, 2, 6, 6, 6, 2, 2, 3, 10]], true, GRU66511), 
exec_layers([LZer28123,LMax27529,LRes7565,LDot2049,LGRU66511],["Zer28123","Max27529","Res7565","Dot2049","GRU66511"],GRU66511,"GRU66511")

Actual (Unparsed): [[0.0000000, 0.0000334, 0.0006703]]

Expected (Unparsed): [[3.041970783749586e-8,3.337349110762434e-5,0.0006703351170293789]]

Actual:   [[0, 0.0001, 0.0007]]

Expected: [[0, 0.0001, 0.0007]]