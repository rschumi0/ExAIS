import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave51208 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Ave51208 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Ave51208 = keras.layers.Average(name = 'Ave51208', )([in0Ave51208,in1Ave51208])
Zer16336 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer16336', )(Ave51208)
Res21218 = keras.layers.Reshape((3, 4, 4), name = 'Res21218', )(Zer16336)
Dep76563 = keras.layers.DepthwiseConv2D((3, 3),strides=(2, 2), padding='same', name = 'Dep76563', )(Res21218)
Con88371 = keras.layers.Conv2D(3, (1, 2),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con88371', )(Dep76563)
ELU59884 = keras.layers.ELU(alpha=5.3541494746261105, name = 'ELU59884', )(Con88371)
model = tf.keras.models.Model(inputs=[in0Ave51208,in1Ave51208], outputs=ELU59884)
w = model.get_layer('Dep76563').get_weights() 
w[0] = np.array([[[[0.8367], [0.9515], [0.3842], [0.4175]], [[0.851], [0.3603], [0.7428], [0.0505]], [[0.5012], [0.5379], [0.7156], [0.5562]]], [[[0.9692], [0.8097], [0.8128], [0.1967]], [[0.1368], [0.274], [0.9568], [0.5059]], [[0.094], [0.9105], [0.9362], [0.3673]]], [[[0.9361], [0.4673], [0.5457], [0.6382]], [[0.2077], [0.7826], [0.9031], [0.6337]], [[0.6942], [0.8986], [0.0505], [0.3742]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Dep76563').set_weights(w) 
w = model.get_layer('Con88371').get_weights() 
w[0] = np.array([[[[0.4772, 0.3479, 0.7442], [0.7043, 0.3449, 0.0863], [0.6492, 0.1534, 0.647], [0.7272, 0.8408, 0.7534]], [[0.3793, 0.5912, 0.4074], [0.7658, 0.7937, 0.4707], [0.8888, 0.5694, 0.484], [0.2808, 0.5964, 0.1307]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con88371').set_weights(w) 
in0Ave51208 = tf.constant([[[[[0.0209], [0.7206]], [[0.3919], [0.5708]]]]])
in1Ave51208 = tf.constant([[[[[0.9025], [0.6197]], [[0.4408], [0.7915]]]]])
print (np.array2string(model.predict([in0Ave51208,in1Ave51208],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU59884.png')

LAve51208 = average_layer([[[[[[0.0209], [0.7206]], [[0.3919], [0.5708]]]]], [[[[[0.9025], [0.6197]], [[0.4408], [0.7915]]]]]], Ave51208), 
LZer16336 = zero_padding3D_layer(Ave51208, 1, 1, 1, 1, 1, 1, Zer16336), 
LRes21218 = reshape_layer(Zer16336, [3, 4, 4], Res21218), 
LDep76563 = depthwise_conv2D_layer(Res21218, 3, 3,[[[[0.8367], [0.9515], [0.3842], [0.4175]], [[0.851], [0.3603], [0.7428], [0.0505]], [[0.5012], [0.5379], [0.7156], [0.5562]]], [[[0.9692], [0.8097], [0.8128], [0.1967]], [[0.1368], [0.274], [0.9568], [0.5059]], [[0.094], [0.9105], [0.9362], [0.3673]]], [[[0.9361], [0.4673], [0.5457], [0.6382]], [[0.2077], [0.7826], [0.9031], [0.6337]], [[0.6942], [0.8986], [0.0505], [0.3742]]]],[0, 0, 0, 0], 2, 2, true, Dep76563), 
LCon88371 = conv2D_layer(Dep76563, 1, 2,[[[[0.4772, 0.3479, 0.7442], [0.7043, 0.3449, 0.0863], [0.6492, 0.1534, 0.647], [0.7272, 0.8408, 0.7534]], [[0.3793, 0.5912, 0.4074], [0.7658, 0.7937, 0.4707], [0.8888, 0.5694, 0.484], [0.2808, 0.5964, 0.1307]]]],[0, 0, 0], 1, 1, true, 1, 1, Con88371), 
LELU59884 = elu_layer(Con88371, 5.3541494746261105, ELU59884), 
exec_layers([LAve51208,LZer16336,LRes21218,LDep76563,LCon88371,LELU59884],["Ave51208","Zer16336","Res21218","Dep76563","Con88371","ELU59884"],ELU59884,"ELU59884")

Actual (Unparsed): [[[[1.4125830, 0.7178465, 0.7487822], [0.3783388, 0.1241232, 0.2572828]], [[1.4504698, 0.7491893, 0.9842525], [0.4489076, 0.1767790, 0.2035068]]]]

Expected (Unparsed): [[[[1.4125830447899999,0.7178464618134999,0.7487821702375],[0.3783388059324999,0.12412319177649997,0.2572827587214999]],[[1.4504697751135,0.749189326426,0.98425247691],[0.44890762394350003,0.17677900504449998,0.20350684726749999]]]]

Actual:   [[[[1.4126, 0.7179, 0.7488], [0.3784, 0.1242, 0.2573]], [[1.4505, 0.7492, 0.9843], [0.449, 0.1768, 0.2036]]]]

Expected: [[[[1.4126, 0.7179, 0.7488], [0.3784, 0.1242, 0.2573]], [[1.4505, 0.7492, 0.9843], [0.449, 0.1768, 0.2036]]]]