import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max15629 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max15629 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con75583 = tf.keras.layers.Input(shape=([3, 3, 5, 2]))
in0Sub5017 = tf.keras.layers.Input(shape=([2, 2, 3, 3]))
in1Sub5017 = tf.keras.layers.Input(shape=([2, 2, 3, 3]))

Max15629 = keras.layers.Maximum(name = 'Max15629', )([in0Max15629,in1Max15629])
Zer29520 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer29520', )(Max15629)
Sof8796 = keras.layers.Softmax(axis=1, name = 'Sof8796', )(Zer29520)
Lea39929 = keras.layers.LeakyReLU(alpha=8.775488051816067, name = 'Lea39929', )(Sof8796)
Res10401 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res10401', )(Lea39929)
Zer90211 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (4, 0)), name = 'Zer90211', )(Res10401)
Con75583 = keras.layers.Concatenate(axis=4, name = 'Con75583', )([Zer90211,in0Con75583])
Sub5017 = keras.layers.Subtract(name = 'Sub5017', )([in0Sub5017,in1Sub5017])
Zer26101 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (2, 0)), name = 'Zer26101', )(Sub5017)
Sub63528 = keras.layers.Subtract(name = 'Sub63528', )([Con75583,Zer26101])
model = tf.keras.models.Model(inputs=[in0Max15629,in1Max15629,in0Con75583,in0Sub5017,in1Sub5017], outputs=Sub63528)
in0Max15629 = tf.constant([[[[0.0797]]]])
in1Max15629 = tf.constant([[[[0.9838]]]])
in0Con75583 = tf.constant([[[[[0.7794, 0.0937], [0.9613, 0.7876], [0.1935, 0.8105], [0.2133, 0.7891], [0.367, 0.6864]], [[0.5221, 0.4992], [0.1252, 0.9654], [0.3971, 0.3715], [0.6143, 0.2576], [0.6465, 0.8095]], [[0.011, 0.0145], [0.875, 0.9358], [0.6834, 0.3815], [0.5372, 0.6657], [0.4982, 0.3954]]], [[[0.6727, 0.2677], [0.0562, 0.7123], [0.6081, 0.0126], [0.1236, 0.9227], [0.9814, 0.0872]], [[0.4261, 0.0378], [0.4157, 0.6804], [0.2708, 0.919], [0.0488, 0.0376], [0.1715, 0.2586]], [[0.9139, 0.3225], [0.7663, 0.2206], [0.8558, 0.3264], [0.8369, 0.0023], [0.2677, 0.4206]]], [[[0.1656, 0.3876], [0.4396, 0.6621], [0.2993, 0.827], [0.715, 0.6279], [0.0298, 0.7039]], [[0.9792, 0.3836], [0.5428, 0.2234], [0.2153, 0.969], [0.7433, 0.795], [0.0042, 0.9237]], [[0.2194, 0.871], [0.8728, 0.6677], [0.6739, 0.9497], [0.3418, 0.0046], [0.4212, 0.8564]]]]])
in0Sub5017 = tf.constant([[[[[0.377, 0.0909, 0.2716], [0.6553, 0.4131, 0.8356], [0.8666, 0.2658, 0.6316]], [[0.184, 0.9551, 0.9745], [0.1018, 0.4938, 0.9597], [0.3767, 0.5539, 0.6992]]], [[[0.2627, 0.8393, 0.9117], [0.7667, 0.4176, 0.901], [0.8039, 0.8901, 0.0779]], [[0.4346, 0.0826, 0.56], [0.2956, 0.4301, 0.9782], [0.9964, 0.7705, 0.0605]]]]])
in1Sub5017 = tf.constant([[[[[0.0243, 0.9478, 0.9623], [0.1601, 0.295, 0.5276], [0.7184, 0.3691, 0.8189]], [[0.5856, 0.2144, 0.9739], [0.2533, 0.0912, 0.5581], [0.9074, 0.0342, 0.1462]]], [[[0.363, 0.467, 0.2546], [0.5351, 0.9644, 0.0509], [0.4626, 0.1738, 0.7197]], [[0.6213, 0.4247, 0.4239], [0.0116, 0.658, 0.6482], [0.9997, 0.1573, 0.0857]]]]])
print (np.array2string(model.predict([in0Max15629,in1Max15629,in0Con75583,in0Sub5017,in1Sub5017],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub63528.png')

LMax15629 = maximum_layer([[[[[0.0797]]]], [[[[0.9838]]]]], Max15629), 
LZer29520 = zero_padding2D_layer(Max15629, 1, 1, 1, 1, Zer29520), 
LSof8796 = softmax_layer(Zer29520, 1, Sof8796), 
LLea39929 = leaky_relu_layer(Sof8796, 8.775488051816067, Lea39929), 
LRes10401 = reshape_layer(Lea39929, [3, 3, 1, 1], Res10401), 
LZer90211 = zero_padding3D_layer(Res10401, 0, 0, 0, 0, 4, 0, Zer90211), 
LCon75583 = concatenate_layer([Zer90211,[[[[[0.7794, 0.0937], [0.9613, 0.7876], [0.1935, 0.8105], [0.2133, 0.7891], [0.367, 0.6864]], [[0.5221, 0.4992], [0.1252, 0.9654], [0.3971, 0.3715], [0.6143, 0.2576], [0.6465, 0.8095]], [[0.011, 0.0145], [0.875, 0.9358], [0.6834, 0.3815], [0.5372, 0.6657], [0.4982, 0.3954]]], [[[0.6727, 0.2677], [0.0562, 0.7123], [0.6081, 0.0126], [0.1236, 0.9227], [0.9814, 0.0872]], [[0.4261, 0.0378], [0.4157, 0.6804], [0.2708, 0.919], [0.0488, 0.0376], [0.1715, 0.2586]], [[0.9139, 0.3225], [0.7663, 0.2206], [0.8558, 0.3264], [0.8369, 0.0023], [0.2677, 0.4206]]], [[[0.1656, 0.3876], [0.4396, 0.6621], [0.2993, 0.827], [0.715, 0.6279], [0.0298, 0.7039]], [[0.9792, 0.3836], [0.5428, 0.2234], [0.2153, 0.969], [0.7433, 0.795], [0.0042, 0.9237]], [[0.2194, 0.871], [0.8728, 0.6677], [0.6739, 0.9497], [0.3418, 0.0046], [0.4212, 0.8564]]]]]], 4, Con75583), 
LSub5017 = subtract_layer([[[[[0.377, 0.0909, 0.2716], [0.6553, 0.4131, 0.8356], [0.8666, 0.2658, 0.6316]], [[0.184, 0.9551, 0.9745], [0.1018, 0.4938, 0.9597], [0.3767, 0.5539, 0.6992]]], [[[0.2627, 0.8393, 0.9117], [0.7667, 0.4176, 0.901], [0.8039, 0.8901, 0.0779]], [[0.4346, 0.0826, 0.56], [0.2956, 0.4301, 0.9782], [0.9964, 0.7705, 0.0605]]]]], [[[[[0.0243, 0.9478, 0.9623], [0.1601, 0.295, 0.5276], [0.7184, 0.3691, 0.8189]], [[0.5856, 0.2144, 0.9739], [0.2533, 0.0912, 0.5581], [0.9074, 0.0342, 0.1462]]], [[[0.363, 0.467, 0.2546], [0.5351, 0.9644, 0.0509], [0.4626, 0.1738, 0.7197]], [[0.6213, 0.4247, 0.4239], [0.0116, 0.658, 0.6482], [0.9997, 0.1573, 0.0857]]]]], Sub5017), 
LZer26101 = zero_padding3D_layer(Sub5017, 1, 0, 1, 0, 2, 0, Zer26101), 
LSub63528 = subtract_layer(Con75583,Zer26101, Sub63528), 
exec_layers([LMax15629,LZer29520,LSof8796,LLea39929,LRes10401,LZer90211,LCon75583,LSub5017,LZer26101,LSub63528],["Max15629","Zer29520","Sof8796","Lea39929","Res10401","Zer90211","Con75583","Sub5017","Zer26101","Sub63528"],Sub63528,"Sub63528")

Actual (Unparsed): [[[[[0.0000000, 0.7794000, 0.0937000], [0.0000000, 0.9613000, 0.7876000], [0.0000000, 0.1935000, 0.8105000], [0.0000000, 0.2133000, 0.7891000], [0.3333333, 0.3670000, 0.6864000]], [[0.0000000, 0.5221000, 0.4992000], [0.0000000, 0.1252000, 0.9654000], [0.0000000, 0.3971000, 0.3715000], [0.0000000, 0.6143000, 0.2576000], [0.2139220, 0.6465000, 0.8095000]], [[0.0000000, 0.0110000, 0.0145000], [0.0000000, 0.8750000, 0.9358000], [0.0000000, 0.6834000, 0.3815000], [0.0000000, 0.5372000, 0.6657000], [0.3333333, 0.4982000, 0.3954000]]], [[[0.0000000, 0.6727000, 0.2677000], [0.0000000, 0.0562000, 0.7123000], [0.0000000, 0.6081000, 0.0126000], [0.0000000, 0.1236000, 0.9227000], [0.3333333, 0.9814000, 0.0872000]], [[0.0000000, 0.4261000, 0.0378000], [0.0000000, 0.4157000, 0.6804000], [-0.3527000, 1.1277000, 1.6097000], [-0.4952000, -0.0693000, -0.2704000], [0.4239560, 0.2748000, 0.4459000]], [[0.0000000, 0.9139000, 0.3225000], [0.0000000, 0.7663000, 0.2206000], [0.4016000, 0.1151000, 0.3258000], [0.1515000, 0.4343000, -0.3993000], [0.8640333, -0.2520000, -0.1324000]]], [[[0.0000000, 0.1656000, 0.3876000], [0.0000000, 0.4396000, 0.6621000], [0.0000000, 0.2993000, 0.8270000], [0.0000000, 0.7150000, 0.6279000], [0.3333333, 0.0298000, 0.7039000]], [[0.0000000, 0.9792000, 0.3836000], [0.0000000, 0.5428000, 0.2234000], [0.1003000, -0.1570000, 0.3119000], [-0.2316000, 1.2901000, -0.0551000], [-0.1273780, -0.7121000, 1.5655000]], [[0.0000000, 0.2194000, 0.8710000], [0.0000000, 0.8728000, 0.6677000], [0.1867000, 1.0160000, 0.8136000], [-0.2840000, 0.5697000, -0.3254000], [0.3366333, -0.1920000, 0.8816000]]]]]

Expected (Unparsed): [[[[[0,0.7794,0.0937],[0,0.9613,0.7876],[0,0.1935,0.8105],[0,0.2133,0.7891],[0.3333333333333333,0.367,0.6864]],[[0,0.5221,0.4992],[0,0.1252,0.9654],[0,0.3971,0.3715],[0,0.6143,0.2576],[0.21392202678895636,0.6465,0.8095]],[[0,0.011,0.0145],[0,0.875,0.9358],[0,0.6834,0.3815],[0,0.5372,0.6657],[0.3333333333333333,0.4982,0.3954]]],[[[0,0.6727,0.2677],[0,0.0562,0.7123],[0,0.6081,0.0126],[0,0.1236,0.9227],[0.3333333333333333,0.9814,0.0872]],[[0,0.4261,0.0378],[0,0.4157,0.6804],[-0.3527,1.1277,1.6097000000000001],[-0.4952,-0.06930000000000003,-0.27040000000000003],[0.4239559464220872,0.27480000000000004,0.4458999999999999]],[[0,0.9139,0.3225],[0,0.7663,0.2206],[0.4016,0.11510000000000009,0.3258],[0.15150000000000002,0.43429999999999996,-0.39929999999999993],[0.8640333333333332,-0.25199999999999995,-0.13240000000000007]]],[[[0,0.1656,0.3876],[0,0.4396,0.6621],[0,0.2993,0.827],[0,0.715,0.6279],[0.3333333333333333,0.0298,0.7039]],[[0,0.9792,0.3836],[0,0.5428,0.2234],[0.1003,-0.15700000000000003,0.31189999999999996],[-0.23160000000000003,1.2900999999999998,-0.05510000000000004],[-0.12737797321104358,-0.7121,1.5655000000000001]],[[0,0.2194,0.871],[0,0.8728,0.6677],[0.18669999999999998,1.016,0.8135999999999999],[-0.284,0.5697000000000001,-0.32539999999999997],[0.3366333333333334,-0.19199999999999995,0.8816]]]]]

Actual:   [[[[[0, 0.7794, 0.0937], [0, 0.9613, 0.7876], [0, 0.1935, 0.8105], [0, 0.2133, 0.7891], [0.3334, 0.367, 0.6864]], [[0, 0.5221, 0.4992], [0, 0.1252, 0.9654], [0, 0.3971, 0.3715], [0, 0.6143, 0.2576], [0.214, 0.6465, 0.8095]], [[0, 0.011, 0.0145], [0, 0.875, 0.9358], [0, 0.6834, 0.3815], [0, 0.5372, 0.6657], [0.3334, 0.4982, 0.3954]]], [[[0, 0.6727, 0.2677], [0, 0.0562, 0.7123], [0, 0.6081, 0.0126], [0, 0.1236, 0.9227], [0.3334, 0.9814, 0.0872]], [[0, 0.4261, 0.0378], [0, 0.4157, 0.6804], [-0.3527, 1.1277, 1.6097], [-0.4952, -0.0693, -0.2704], [0.424, 0.2748, 0.4459]], [[0, 0.9139, 0.3225], [0, 0.7663, 0.2206], [0.4016, 0.1151, 0.3258], [0.1515, 0.4343, -0.3993], [0.8641, -0.252, -0.1324]]], [[[0, 0.1656, 0.3876], [0, 0.4396, 0.6621], [0, 0.2993, 0.827], [0, 0.715, 0.6279], [0.3334, 0.0298, 0.7039]], [[0, 0.9792, 0.3836], [0, 0.5428, 0.2234], [0.1003, -0.157, 0.3119], [-0.2316, 1.2901, -0.0551], [-0.1273, -0.7121, 1.5655]], [[0, 0.2194, 0.871], [0, 0.8728, 0.6677], [0.1867, 1.016, 0.8136], [-0.284, 0.5697, -0.3254], [0.3367, -0.192, 0.8816]]]]]

Expected: [[[[[0, 0.7794, 0.0937], [0, 0.9613, 0.7876], [0, 0.1935, 0.8105], [0, 0.2133, 0.7891], [0.3334, 0.367, 0.6864]], [[0, 0.5221, 0.4992], [0, 0.1252, 0.9654], [0, 0.3971, 0.3715], [0, 0.6143, 0.2576], [0.214, 0.6465, 0.8095]], [[0, 0.011, 0.0145], [0, 0.875, 0.9358], [0, 0.6834, 0.3815], [0, 0.5372, 0.6657], [0.3334, 0.4982, 0.3954]]], [[[0, 0.6727, 0.2677], [0, 0.0562, 0.7123], [0, 0.6081, 0.0126], [0, 0.1236, 0.9227], [0.3334, 0.9814, 0.0872]], [[0, 0.4261, 0.0378], [0, 0.4157, 0.6804], [-0.3527, 1.1277, 1.6098], [-0.4952, -0.0693, -0.2704], [0.424, 0.2749, 0.4459]], [[0, 0.9139, 0.3225], [0, 0.7663, 0.2206], [0.4016, 0.1152, 0.3258], [0.1516, 0.4343, -0.3992], [0.8641, -0.2519, -0.1324]]], [[[0, 0.1656, 0.3876], [0, 0.4396, 0.6621], [0, 0.2993, 0.827], [0, 0.715, 0.6279], [0.3334, 0.0298, 0.7039]], [[0, 0.9792, 0.3836], [0, 0.5428, 0.2234], [0.1003, -0.157, 0.3119], [-0.2316, 1.2901, -0.0551], [-0.1273, -0.7121, 1.5656]], [[0, 0.2194, 0.871], [0, 0.8728, 0.6677], [0.1867, 1.016, 0.8136], [-0.284, 0.5698, -0.3253], [0.3367, -0.1919, 0.8816]]]]]