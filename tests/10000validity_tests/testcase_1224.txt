import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe37920 = tf.keras.layers.Input(shape=([2, 1]))

PRe37920 = keras.layers.PReLU(name = 'PRe37920', input_shape=(2, 1))(in0PRe37920)
Res21822 = keras.layers.Reshape((2, 1, 1), name = 'Res21822', )(PRe37920)
Res10599 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res10599', )(Res21822)
Glo96146 = keras.layers.GlobalAveragePooling3D(name = 'Glo96146', )(Res10599)
Res53215 = keras.layers.Reshape((1, 1), name = 'Res53215', )(Glo96146)
Sep20784 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep20784', )(Res53215)
model = tf.keras.models.Model(inputs=[in0PRe37920], outputs=Sep20784)
w = model.get_layer('PRe37920').get_weights() 
w[0] = np.array([[0.4832], [0.066]])
model.get_layer('PRe37920').set_weights(w) 
w = model.get_layer('Sep20784').get_weights() 
w[0] = np.array([[[0.9621]]])
w[1] = np.array([[[0.439, 0.657, 0.4749, 0.4318]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep20784').set_weights(w) 
in0PRe37920 = tf.constant([[[0.3604], [0.0694]]])
print (np.array2string(model.predict([in0PRe37920],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep20784.png')

LPRe37920 = prelu_layer([[[0.3604], [0.0694]]], [[0.4832], [0.066]], PRe37920), 
LRes21822 = reshape_layer(PRe37920, [2, 1, 1], Res21822), 
LRes10599 = reshape_layer(Res21822, [2, 1, 1, 1], Res10599), 
LGlo96146 = global_average_pooling3D_layer(Res10599, Glo96146), 
LRes53215 = reshape_layer(Glo96146, [1, 1], Res53215), 
LSep20784 = separable_conv1D_layer(Res53215, 1,[[[[0.9621]]],[[[0.439, 0.657, 0.4749, 0.4318]]]],[0, 0, 0, 0], 1, false, Sep20784), 
exec_layers([LPRe37920,LRes21822,LRes10599,LGlo96146,LRes53215,LSep20784],["PRe37920","Res21822","Res10599","Glo96146","Res53215","Sep20784"],Sep20784,"Sep20784")

Actual (Unparsed): [[[0.0907656, 0.1358382, 0.0981881, 0.0892769]]]

Expected (Unparsed): [[[0.09076557231,0.13583822553000002,0.098188087221,0.089276934222]]]

Actual:   [[[0.0908, 0.1359, 0.0982, 0.0893]]]

Expected: [[[0.0908, 0.1359, 0.0982, 0.0893]]]