import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot88186 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot88186 = tf.keras.layers.Input(shape=([3, 3]))

Dot88186 = keras.layers.Dot(axes=(2, 1), name = 'Dot88186', )([in0Dot88186,in1Dot88186])
Glo58985 = keras.layers.GlobalAveragePooling1D(name = 'Glo58985', )(Dot88186)
Res36628 = keras.layers.Reshape((3, 1), name = 'Res36628', )(Glo58985)
Res16990 = keras.layers.Reshape((3, 1, 1), name = 'Res16990', )(Res36628)
Res68288 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res68288', )(Res16990)
Glo42492 = keras.layers.GlobalAveragePooling3D(name = 'Glo42492', )(Res68288)
model = tf.keras.models.Model(inputs=[in0Dot88186,in1Dot88186], outputs=Glo42492)
in0Dot88186 = tf.constant([[[0.0434, 0.836, 0.4799], [0.8289, 0.8456, 0.021], [0.5191, 0.4692, 0.0705]]])
in1Dot88186 = tf.constant([[[0.6872, 0.2496, 0.0526], [0.5328, 0.671, 0.9047], [0.6984, 0.1054, 0.5017]]])
print (np.array2string(model.predict([in0Dot88186,in1Dot88186],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo42492.png')

LDot88186 = dot_layer([[[0.0434, 0.836, 0.4799], [0.8289, 0.8456, 0.021], [0.5191, 0.4692, 0.0705]]], [[[0.6872, 0.2496, 0.0526], [0.5328, 0.671, 0.9047], [0.6984, 0.1054, 0.5017]]], 2, 1, Dot88186), 
LGlo58985 = global_average_pooling1D_layer(Dot88186, Glo58985), 
LRes36628 = reshape_layer(Glo58985, [3, 1], Res36628), 
LRes16990 = reshape_layer(Res36628, [3, 1, 1], Res16990), 
LRes68288 = reshape_layer(Res16990, [3, 1, 1, 1], Res68288), 
LGlo42492 = global_average_pooling3D_layer(Res68288, Glo42492), 
exec_layers([LDot88186,LGlo58985,LRes36628,LRes16990,LRes68288,LGlo42492],["Dot88186","Glo58985","Res36628","Res16990","Res68288","Glo42492"],Glo42492,"Glo42492")

Actual (Unparsed): [[0.7397306]]

Expected (Unparsed): [[0.7397306288888889]]

Actual:   [[0.7398]]

Expected: [[0.7398]]