import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min2945 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min2945 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Thr10713 = tf.keras.layers.Input(shape=([1, 2]))

Min2945 = keras.layers.Minimum(name = 'Min2945', )([in0Min2945,in1Min2945])
Res2850 = keras.layers.Reshape((1, 2), name = 'Res2850', )(Min2945)
Thr10713 = keras.layers.ThresholdedReLU(theta=0.529269559801749, name = 'Thr10713', input_shape=(1, 2))(in0Thr10713)
Ave90407 = keras.layers.Average(name = 'Ave90407', )([Res2850,Thr10713])
model = tf.keras.models.Model(inputs=[in0Min2945,in1Min2945,in0Thr10713], outputs=Ave90407)
in0Min2945 = tf.constant([[[[0.5638], [0.7826]]]])
in1Min2945 = tf.constant([[[[0.9446], [0.8084]]]])
in0Thr10713 = tf.constant([[[0.4887, 0.0124]]])
print (np.array2string(model.predict([in0Min2945,in1Min2945,in0Thr10713],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave90407.png')

LMin2945 = minimum_layer([[[[[0.5638], [0.7826]]]], [[[[0.9446], [0.8084]]]]], Min2945), 
LRes2850 = reshape_layer(Min2945, [1, 2], Res2850), 
LThr10713 = thresholded_relu_layer([[[0.4887, 0.0124]]], 0.529269559801749, Thr10713), 
LAve90407 = average_layer([Res2850,Thr10713], Ave90407), 
exec_layers([LMin2945,LRes2850,LThr10713,LAve90407],["Min2945","Res2850","Thr10713","Ave90407"],Ave90407,"Ave90407")

Actual (Unparsed): [[[0.2819000, 0.3913000]]]

Expected (Unparsed): [[[0.2819,0.3913]]]

Actual:   [[[0.2819, 0.3913]]]

Expected: [[[0.2819, 0.3913]]]