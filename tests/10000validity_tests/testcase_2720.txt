import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL34795 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con83513 = tf.keras.layers.Input(shape=([2, 3]))
in0Mul31860 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul31860 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Lea11940 = tf.keras.layers.Input(shape=([2, 1]))
in0Con3763 = tf.keras.layers.Input(shape=([2, 3]))

ReL34795 = keras.layers.ReLU(max_value=7.816174780414767, negative_slope=1.5109997844039307, threshold=3.5258034464496824, name = 'ReL34795', input_shape=(1, 1, 1, 2))(in0ReL34795)
Res34646 = keras.layers.Reshape((1, 1, 2), name = 'Res34646', )(ReL34795)
Res86277 = keras.layers.Reshape((1, 2), name = 'Res86277', )(Res34646)
GRU22407 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU22407', )(Res86277)
Res62170 = keras.layers.Reshape((2, 1), name = 'Res62170', )(GRU22407)
Con83513 = keras.layers.Concatenate(axis=2, name = 'Con83513', )([Res62170,in0Con83513])
Mul31860 = keras.layers.Multiply(name = 'Mul31860', )([in0Mul31860,in1Mul31860])
Res3366 = keras.layers.Reshape((2, 4), name = 'Res3366', )(Mul31860)
Lea11940 = keras.layers.LeakyReLU(alpha=9.39820554645718, name = 'Lea11940', input_shape=(2, 1))(in0Lea11940)
Con3763 = keras.layers.Concatenate(axis=2, name = 'Con3763', )([Lea11940,in0Con3763])
Add70184 = keras.layers.Add(name = 'Add70184', )([Res3366,Con3763])
Add33933 = keras.layers.Add(name = 'Add33933', )([Con83513,Add70184])
model = tf.keras.models.Model(inputs=[in0ReL34795,in0Con83513,in0Mul31860,in1Mul31860,in0Lea11940,in0Con3763], outputs=Add33933)
w = model.get_layer('GRU22407').get_weights() 
w[0] = np.array([[7, 1, 5, 2, 2, 3], [8, 9, 1, 9, 4, 2]])
w[1] = np.array([[6, 9, 5, 8, 10, 10], [2, 5, 10, 7, 1, 2]])
w[2] = np.array([[8, 1, 7, 2, 10, 9], [3, 5, 1, 7, 9, 2]])
model.get_layer('GRU22407').set_weights(w) 
in0ReL34795 = tf.constant([[[[[0.2195, 0.2141]]]]])
in0Con83513 = tf.constant([[[0.8736, 0.5042, 0.5859], [0.8141, 0.05, 0.1059]]])
in0Mul31860 = tf.constant([[[[0.4374, 0.3015], [0.4537, 0.1852]], [[0.5086, 0.5274], [0.0794, 0.3571]]]])
in1Mul31860 = tf.constant([[[[0.1748, 0.1358], [0.5984, 0.9268]], [[0.6441, 0.3875], [0.0152, 0.4037]]]])
in0Lea11940 = tf.constant([[[0.764], [0.1046]]])
in0Con3763 = tf.constant([[[0.5501, 0.7966, 0.2486], [0.6529, 0.2855, 0.8705]]])
print (np.array2string(model.predict([in0ReL34795,in0Con83513,in0Mul31860,in1Mul31860,in0Lea11940,in0Con3763],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add33933.png')

LReL34795 = relu_layer([[[[[0.2195, 0.2141]]]]], 7.816174780414767, 1.5109997844039307, 3.5258034464496824, ReL34795), 
LRes34646 = reshape_layer(ReL34795, [1, 1, 2], Res34646), 
LRes86277 = reshape_layer(Res34646, [1, 2], Res86277), 
LGRU22407 = gru_layer(Res86277,[[7, 1, 5, 2, 2, 3], [8, 9, 1, 9, 4, 2]],[[6, 9, 5, 8, 10, 10], [2, 5, 10, 7, 1, 2]],[[8, 1, 7, 2, 10, 9], [3, 5, 1, 7, 9, 2]], true, GRU22407), 
LRes62170 = reshape_layer(GRU22407, [2, 1], Res62170), 
LCon83513 = concatenate_layer([Res62170,[[[0.8736, 0.5042, 0.5859], [0.8141, 0.05, 0.1059]]]], 2, Con83513), 
LMul31860 = multiply_layer([[[[[0.4374, 0.3015], [0.4537, 0.1852]], [[0.5086, 0.5274], [0.0794, 0.3571]]]], [[[[0.1748, 0.1358], [0.5984, 0.9268]], [[0.6441, 0.3875], [0.0152, 0.4037]]]]], Mul31860), 
LRes3366 = reshape_layer(Mul31860, [2, 4], Res3366), 
LLea11940 = leaky_relu_layer([[[0.764], [0.1046]]], 9.39820554645718, Lea11940), 
LCon3763 = concatenate_layer([Lea11940,[[[0.5501, 0.7966, 0.2486], [0.6529, 0.2855, 0.8705]]]], 2, Con3763), 
LAdd70184 = add_layer([Res3366,Con3763], Add70184), 
LAdd33933 = add_layer([Con83513,Add70184], Add33933), 
exec_layers([LReL34795,LRes34646,LRes86277,LGRU22407,LRes62170,LCon83513,LMul31860,LRes3366,LLea11940,LCon3763,LAdd70184,LAdd33933],["ReL34795","Res34646","Res86277","GRU22407","Res62170","Con83513","Mul31860","Res3366","Lea11940","Con3763","Add70184","Add33933"],Add33933,"Add33933")

Actual (Unparsed): [[[-0.1595425, 1.4646437, 1.5722940, 1.0061434], [-0.5678107, 1.6713675, 0.3367069, 1.1205613]]]

Expected (Unparsed): [[[-0.1595424794505007,1.4646437,1.57229408,1.0061433599999998],[-0.5678107399986044,1.6713675000000001,0.33670688,1.12056127]]]

Actual:   [[[-0.1595, 1.4647, 1.5723, 1.0062], [-0.5678, 1.6714, 0.3368, 1.1206]]]

Expected: [[[-0.1595, 1.4647, 1.5723, 1.0062], [-0.5678, 1.6714, 0.3368, 1.1206]]]