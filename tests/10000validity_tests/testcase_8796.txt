import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_87741 = tf.keras.layers.Input(shape=([4, 1, 4]))
in0Cro90110 = tf.keras.layers.Input(shape=([1, 3]))
in0Con37992 = tf.keras.layers.Input(shape=([3, 9]))

Up_87741 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_87741', )(in0Up_87741)
Dep24280 = keras.layers.DepthwiseConv2D((8, 1),strides=(8, 8), padding='same', name = 'Dep24280', )(Up_87741)
Zer87428 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer87428', )(Dep24280)
Res57737 = keras.layers.Reshape((3, 12), name = 'Res57737', )(Zer87428)
Cro90110 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro90110', )(in0Cro90110)
Zer79761 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer79761', )(Cro90110)
Con37992 = keras.layers.Concatenate(axis=2, name = 'Con37992', )([Zer79761,in0Con37992])
Add30144 = keras.layers.Add(name = 'Add30144', )([Res57737,Con37992])
Loc95581 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc95581', )(Add30144)
model = tf.keras.models.Model(inputs=[in0Up_87741,in0Cro90110,in0Con37992], outputs=Loc95581)
w = model.get_layer('Dep24280').get_weights() 
w[0] = np.array([[[[0.6801], [0.7511], [0.9887], [0.3498]]], [[[0.8646], [0.4004], [0.986], [0.603]]], [[[0.3021], [0.704], [0.5659], [0.7653]]], [[[0.4651], [0.8194], [0.6182], [0.1672]]], [[[0.9557], [0.8647], [0.917], [0.4204]]], [[[0.6263], [0.198], [0.33], [0.3545]]], [[[0.0683], [0.4303], [0.9098], [0.5907]]], [[[0.3257], [0.3773], [0.0377], [0.0717]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Dep24280').set_weights(w) 
w = model.get_layer('Loc95581').get_weights() 
w[0] = np.array([[[0.3491, 0.3328], [0.9766, 0.0858], [0.8843, 0.0803], [0.853, 0.6928], [0.8172, 0.2974], [0.0199, 0.5974], [0.1585, 0.311], [0.5468, 0.9068], [0.4556, 0.3245], [0.7766, 0.8148], [0.6587, 0.9623], [0.2633, 0.81]], [[0.7254, 0.5963], [0.5458, 0.6604], [0.2098, 0.4256], [0.8592, 0.2682], [0.3628, 0.41], [0.432, 0.5153], [0.336, 0.3273], [0.8491, 0.7727], [0.9237, 0.4178], [0.0673, 0.837], [0.9057, 0.3085], [0.0647, 0.6728]], [[0.4593, 0.1668], [0.7775, 0.4916], [0.2986, 0.326], [0.93, 0.3752], [0.1679, 0.943], [0.6018, 0.8683], [0.0675, 0.6037], [0.8902, 0.7021], [0.1227, 0.1743], [0.8259, 0.0917], [0.3189, 0.6121], [0.7772, 0.8496]]])
w[1] = np.array([[0, 0], [0, 0], [0, 0]])
model.get_layer('Loc95581').set_weights(w) 
in0Up_87741 = tf.constant([[[[1.389, 1.8017, 1.2838, 1.1769]], [[1.7729, 1.3634, 1.5223, 1.4993]], [[1.0981, 1.5098, 1.2168, 1.2811]], [[1.8285, 1.15, 1.7709, 1.2296]]]])
in0Cro90110 = tf.constant([[[1.1056, 1.4604, 1.6649]]])
in0Con37992 = tf.constant([[[0.9509, 0.5356, 0.3602, 0.6247, 0.2085, 0.851, 0.4111, 0.2069, 0.9396], [0.3805, 0.9908, 0.3392, 0.652, 0.4837, 0.5636, 0.3218, 0.5967, 0.8103], [0.471, 0.6754, 0.7364, 0.095, 0.8527, 0.6705, 0.7133, 0.0987, 0.8661]]])
print (np.array2string(model.predict([in0Up_87741,in0Cro90110,in0Con37992],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc95581.png')

LUp_87741 = up_sampling2D_layer([[[[1.389, 1.8017, 1.2838, 1.1769]], [[1.7729, 1.3634, 1.5223, 1.4993]], [[1.0981, 1.5098, 1.2168, 1.2811]], [[1.8285, 1.15, 1.7709, 1.2296]]]], 2, 1, Up_87741), 
LDep24280 = depthwise_conv2D_layer(Up_87741, 8, 1,[[[[0.6801], [0.7511], [0.9887], [0.3498]]], [[[0.8646], [0.4004], [0.986], [0.603]]], [[[0.3021], [0.704], [0.5659], [0.7653]]], [[[0.4651], [0.8194], [0.6182], [0.1672]]], [[[0.9557], [0.8647], [0.917], [0.4204]]], [[[0.6263], [0.198], [0.33], [0.3545]]], [[[0.0683], [0.4303], [0.9098], [0.5907]]], [[[0.3257], [0.3773], [0.0377], [0.0717]]]],[0, 0, 0, 0], 8, 8, true, Dep24280), 
LZer87428 = zero_padding2D_layer(Dep24280, 1, 1, 1, 1, Zer87428), 
LRes57737 = reshape_layer(Zer87428, [3, 12], Res57737), 
LCro90110 = cropping1D_layer([[[1.1056, 1.4604, 1.6649]]], 0, 0, Cro90110), 
LZer79761 = zero_padding1D_layer(Cro90110, 2, 0, Zer79761), 
LCon37992 = concatenate_layer([Zer79761,[[[0.9509, 0.5356, 0.3602, 0.6247, 0.2085, 0.851, 0.4111, 0.2069, 0.9396], [0.3805, 0.9908, 0.3392, 0.652, 0.4837, 0.5636, 0.3218, 0.5967, 0.8103], [0.471, 0.6754, 0.7364, 0.095, 0.8527, 0.6705, 0.7133, 0.0987, 0.8661]]]], 2, Con37992), 
LAdd30144 = add_layer([Res57737,Con37992], Add30144), 
LLoc95581 = locally_connected1D_layer(Add30144, 1,[[[0.3491, 0.3328], [0.9766, 0.0858], [0.8843, 0.0803], [0.853, 0.6928], [0.8172, 0.2974], [0.0199, 0.5974], [0.1585, 0.311], [0.5468, 0.9068], [0.4556, 0.3245], [0.7766, 0.8148], [0.6587, 0.9623], [0.2633, 0.81]], [[0.7254, 0.5963], [0.5458, 0.6604], [0.2098, 0.4256], [0.8592, 0.2682], [0.3628, 0.41], [0.432, 0.5153], [0.336, 0.3273], [0.8491, 0.7727], [0.9237, 0.4178], [0.0673, 0.837], [0.9057, 0.3085], [0.0647, 0.6728]], [[0.4593, 0.1668], [0.7775, 0.4916], [0.2986, 0.326], [0.93, 0.3752], [0.1679, 0.943], [0.6018, 0.8683], [0.0675, 0.6037], [0.8902, 0.7021], [0.1227, 0.1743], [0.8259, 0.0917], [0.3189, 0.6121], [0.7772, 0.8496]]],[[0, 0], [0, 0], [0, 0]], 1, Loc95581), 
exec_layers([LUp_87741,LDep24280,LZer87428,LRes57737,LCro90110,LZer79761,LCon37992,LAdd30144,LLoc95581],["Up_87741","Dep24280","Zer87428","Res57737","Cro90110","Zer79761","Con37992","Add30144","Loc95581"],Loc95581,"Loc95581")

Actual (Unparsed): [[[2.5596583, 2.9878936], [13.8540305, 14.2027349], [5.2764766, 4.5327044]]]

Expected (Unparsed): [[[2.5596583199999996,2.98789359],[13.854030542044,14.202734912392998],[5.27647661,4.5327044]]]

Actual:   [[[2.5597, 2.9879], [13.8541, 14.2028], [5.2765, 4.5328]]]

Expected: [[[2.5597, 2.9879], [13.8541, 14.2028], [5.2765, 4.5328]]]