import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add23546 = tf.keras.layers.Input(shape=([2, 2]))
in1Add23546 = tf.keras.layers.Input(shape=([2, 2]))

Add23546 = keras.layers.Add(name = 'Add23546', )([in0Add23546,in1Add23546])
Res43201 = keras.layers.Reshape((2, 2, 1), name = 'Res43201', )(Add23546)
Up_35046 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_35046', )(Res43201)
Res54075 = keras.layers.Reshape((4, 4), name = 'Res54075', )(Up_35046)
Sim5331 = keras.layers.SimpleRNN(2,name = 'Sim5331', )(Res54075)
model = tf.keras.models.Model(inputs=[in0Add23546,in1Add23546], outputs=Sim5331)
w = model.get_layer('Sim5331').get_weights() 
w[0] = np.array([[2, 5], [10, 7], [1, 3], [8, 10]])
w[1] = np.array([[5, 1], [3, 1]])
w[2] = np.array([9, 7])
model.get_layer('Sim5331').set_weights(w) 
in0Add23546 = tf.constant([[[0.7331, 0.1297], [0.8574, 0.4295]]])
in1Add23546 = tf.constant([[[0.2452, 0.3589], [0.089, 0.6849]]])
print (np.array2string(model.predict([in0Add23546,in1Add23546],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim5331.png')

LAdd23546 = add_layer([[[[0.7331, 0.1297], [0.8574, 0.4295]]], [[[0.2452, 0.3589], [0.089, 0.6849]]]], Add23546), 
LRes43201 = reshape_layer(Add23546, [2, 2, 1], Res43201), 
LUp_35046 = up_sampling2D_layer(Res43201, 2, 2, Up_35046), 
LRes54075 = reshape_layer(Up_35046, [4, 4], Res54075), 
LSim5331 = simple_rnn_layer(Res54075,[[2, 5], [10, 7], [1, 3], [8, 10]],[[5, 1], [3, 1]],[9, 7], Sim5331), 
exec_layers([LAdd23546,LRes43201,LUp_35046,LRes54075,LSim5331],["Add23546","Res43201","Up_35046","Res54075","Sim5331"],Sim5331,"Sim5331")

Actual (Unparsed): [[1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0]]

Actual:   [[1, 1]]

Expected: [[1, 1]]