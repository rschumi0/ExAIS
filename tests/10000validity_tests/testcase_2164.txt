import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add88551 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Add88551 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Mul56558 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul56558 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con31424 = tf.keras.layers.Input(shape=([2, 2, 2]))

Add88551 = keras.layers.Add(name = 'Add88551', )([in0Add88551,in1Add88551])
Res94777 = keras.layers.Reshape((1, 1, 4), name = 'Res94777', )(Add88551)
Zer76651 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer76651', )(Res94777)
Mul56558 = keras.layers.Multiply(name = 'Mul56558', )([in0Mul56558,in1Mul56558])
Con31424 = keras.layers.Concatenate(axis=3, name = 'Con31424', )([Mul56558,in0Con31424])
Max89559 = keras.layers.Maximum(name = 'Max89559', )([Zer76651,Con31424])
Mas75338 = keras.layers.Masking(mask_value=1, name = 'Mas75338', )(Max89559)
model = tf.keras.models.Model(inputs=[in0Add88551,in1Add88551,in0Mul56558,in1Mul56558,in0Con31424], outputs=Mas75338)
in0Add88551 = tf.constant([[[[[0.3918, 0.5452], [0.5557, 0.3447]]]]])
in1Add88551 = tf.constant([[[[[0.2004, 0.8191], [0.4685, 0.7126]]]]])
in0Mul56558 = tf.constant([[[[0.8658, 0.8339], [0.1975, 0.7308]], [[0.0351, 0.7512], [0.0642, 0.7439]]]])
in1Mul56558 = tf.constant([[[[0.2069, 0.2225], [0.5238, 0.0672]], [[0.3011, 0.2566], [0.4699, 0.6384]]]])
in0Con31424 = tf.constant([[[[0.1157, 0.5326], [0.8649, 0.86]], [[0.5186, 0.9936], [0.8944, 0.4191]]]])
print (np.array2string(model.predict([in0Add88551,in1Add88551,in0Mul56558,in1Mul56558,in0Con31424],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas75338.png')

LAdd88551 = add_layer([[[[[[0.3918, 0.5452], [0.5557, 0.3447]]]]], [[[[[0.2004, 0.8191], [0.4685, 0.7126]]]]]], Add88551), 
LRes94777 = reshape_layer(Add88551, [1, 1, 4], Res94777), 
LZer76651 = zero_padding2D_layer(Res94777, 1, 0, 1, 0, Zer76651), 
LMul56558 = multiply_layer([[[[[0.8658, 0.8339], [0.1975, 0.7308]], [[0.0351, 0.7512], [0.0642, 0.7439]]]], [[[[0.2069, 0.2225], [0.5238, 0.0672]], [[0.3011, 0.2566], [0.4699, 0.6384]]]]], Mul56558), 
LCon31424 = concatenate_layer([Mul56558,[[[[0.1157, 0.5326], [0.8649, 0.86]], [[0.5186, 0.9936], [0.8944, 0.4191]]]]], 3, Con31424), 
LMax89559 = maximum_layer([Zer76651,Con31424], Max89559), 
LMas75338 = masking_layer(Max89559, 1, Mas75338), 
exec_layers([LAdd88551,LRes94777,LZer76651,LMul56558,LCon31424,LMax89559,LMas75338],["Add88551","Res94777","Zer76651","Mul56558","Con31424","Max89559","Mas75338"],Mas75338,"Mas75338")

Actual (Unparsed): [[[[0.1791340, 0.1855427, 0.1157000, 0.5326000], [0.1034505, 0.0491098, 0.8649000, 0.8600000]], [[0.0105686, 0.1927579, 0.5186000, 0.9936000], [0.5922000, 1.3643000, 1.0242000, 1.0573000]]]]

Expected (Unparsed): [[[[0.17913402,0.18554275,0.1157,0.5326],[0.10345050000000001,0.049109759999999995,0.8649,0.86]],[[0.010568609999999999,0.19275792,0.5186,0.9936],[0.5922,1.3643,1.0242,1.0573000000000001]]]]

Actual:   [[[[0.1792, 0.1856, 0.1157, 0.5326], [0.1035, 0.0492, 0.8649, 0.86]], [[0.0106, 0.1928, 0.5186, 0.9936], [0.5922, 1.3643, 1.0242, 1.0573]]]]

Expected: [[[[0.1792, 0.1856, 0.1157, 0.5326], [0.1035, 0.0492, 0.8649, 0.86]], [[0.0106, 0.1928, 0.5186, 0.9936], [0.5922, 1.3643, 1.0242, 1.0574]]]]