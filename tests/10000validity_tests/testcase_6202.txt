import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max21721 = tf.keras.layers.Input(shape=([1, 1]))
in1Max21721 = tf.keras.layers.Input(shape=([1, 1]))
in0Con73762 = tf.keras.layers.Input(shape=([1, 1]))
in0Max90673 = tf.keras.layers.Input(shape=([1, 2]))
in1Max90673 = tf.keras.layers.Input(shape=([1, 2]))

Max21721 = keras.layers.Maximum(name = 'Max21721', )([in0Max21721,in1Max21721])
Res40574 = keras.layers.Reshape((1, 1, 1), name = 'Res40574', )(Max21721)
Glo22587 = keras.layers.GlobalMaxPool2D(name = 'Glo22587', )(Res40574)
Res59671 = keras.layers.Reshape((1, 1), name = 'Res59671', )(Glo22587)
Con73762 = keras.layers.Concatenate(axis=2, name = 'Con73762', )([Res59671,in0Con73762])
Max90673 = keras.layers.Maximum(name = 'Max90673', )([in0Max90673,in1Max90673])
Add84930 = keras.layers.Add(name = 'Add84930', )([Con73762,Max90673])
Res61751 = keras.layers.Reshape((1, 2, 1), name = 'Res61751', )(Add84930)
Sep85300 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep85300', )(Res61751)
model = tf.keras.models.Model(inputs=[in0Max21721,in1Max21721,in0Con73762,in0Max90673,in1Max90673], outputs=Sep85300)
w = model.get_layer('Sep85300').get_weights() 
w[0] = np.array([[[[0.6061]]]])
w[1] = np.array([[[[0.4063, 0.2907]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep85300').set_weights(w) 
in0Max21721 = tf.constant([[[0.3374]]])
in1Max21721 = tf.constant([[[0.7132]]])
in0Con73762 = tf.constant([[[0.6725]]])
in0Max90673 = tf.constant([[[0.4271, 0.4986]]])
in1Max90673 = tf.constant([[[0.8157, 0.6303]]])
print (np.array2string(model.predict([in0Max21721,in1Max21721,in0Con73762,in0Max90673,in1Max90673],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep85300.png')

LMax21721 = maximum_layer([[[[0.3374]]], [[[0.7132]]]], Max21721), 
LRes40574 = reshape_layer(Max21721, [1, 1, 1], Res40574), 
LGlo22587 = global_max_pool2D_layer(Res40574, Glo22587), 
LRes59671 = reshape_layer(Glo22587, [1, 1], Res59671), 
LCon73762 = concatenate_layer([Res59671,[[[0.6725]]]], 2, Con73762), 
LMax90673 = maximum_layer([[[[0.4271, 0.4986]]], [[[0.8157, 0.6303]]]], Max90673), 
LAdd84930 = add_layer([Con73762,Max90673], Add84930), 
LRes61751 = reshape_layer(Add84930, [1, 2, 1], Res61751), 
LSep85300 = separable_conv2D_layer(Res61751, 1, 1,[[[[[0.6061]]]],[[[[0.4063, 0.2907]]]]],[0, 0], 1, 1, false, Sep85300), 
exec_layers([LMax21721,LRes40574,LGlo22587,LRes59671,LCon73762,LMax90673,LAdd84930,LRes61751,LSep85300],["Max21721","Res40574","Glo22587","Res59671","Con73762","Max90673","Add84930","Res61751","Sep85300"],Sep85300,"Sep85300")

Actual (Unparsed): [[[[0.3765045, 0.2693819], [0.3208255, 0.2295446]]]]

Expected (Unparsed): [[[[0.37650451362699994,0.269381890503],[0.32082548260399996,0.22954459215599998]]]]

Actual:   [[[[0.3766, 0.2694], [0.3209, 0.2296]]]]

Expected: [[[[0.3766, 0.2694], [0.3209, 0.2296]]]]