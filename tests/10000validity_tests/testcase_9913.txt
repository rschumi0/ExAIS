import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot96971 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot96971 = tf.keras.layers.Input(shape=([2, 2]))

Dot96971 = keras.layers.Dot(axes=(1, 1), name = 'Dot96971', )([in0Dot96971,in1Dot96971])
Thr12616 = keras.layers.ThresholdedReLU(theta=5.194573552557627, name = 'Thr12616', )(Dot96971)
Thr22904 = keras.layers.ThresholdedReLU(theta=5.709203887013219, name = 'Thr22904', )(Thr12616)
model = tf.keras.models.Model(inputs=[in0Dot96971,in1Dot96971], outputs=Thr22904)
in0Dot96971 = tf.constant([[[0.1972, 0.0815], [0.6454, 0.2355]]])
in1Dot96971 = tf.constant([[[0.7062, 0.6634], [0.672, 0.4234]]])
print (np.array2string(model.predict([in0Dot96971,in1Dot96971],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr22904.png')

LDot96971 = dot_layer([[[0.1972, 0.0815], [0.6454, 0.2355]]], [[[0.7062, 0.6634], [0.672, 0.4234]]], 1, 1, Dot96971), 
LThr12616 = thresholded_relu_layer(Dot96971, 5.194573552557627, Thr12616), 
LThr22904 = thresholded_relu_layer(Thr12616, 5.709203887013219, Thr22904), 
exec_layers([LDot96971,LThr12616,LThr22904],["Dot96971","Thr12616","Thr22904"],Thr22904,"Thr22904")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0],[0,0]]]

Actual:   [[[0, 0], [0, 0]]]

Expected: [[[0, 0], [0, 0]]]