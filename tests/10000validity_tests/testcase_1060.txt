import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul29308 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Mul29308 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Glo77422 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Ave48653 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Ave48653 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Mul29308 = keras.layers.Multiply(name = 'Mul29308', )([in0Mul29308,in1Mul29308])
Res51396 = keras.layers.Reshape((2, 1, 1), name = 'Res51396', )(Mul29308)
Glo77422 = keras.layers.GlobalMaxPool2D(name = 'Glo77422', )(in0Glo77422)
Res56987 = keras.layers.Reshape((2, 1, 1), name = 'Res56987', )(Glo77422)
Ave49767 = keras.layers.Average(name = 'Ave49767', )([Res51396,Res56987])
Res62063 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res62063', )(Ave49767)
Zer4158 = keras.layers.ZeroPadding3D(padding=((2, 0), (2, 0), (2, 0)), name = 'Zer4158', )(Res62063)
Ave48653 = keras.layers.Average(name = 'Ave48653', )([in0Ave48653,in1Ave48653])
Zer39740 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer39740', )(Ave48653)
Max79999 = keras.layers.Maximum(name = 'Max79999', )([Zer4158,Zer39740])
model = tf.keras.models.Model(inputs=[in0Mul29308,in1Mul29308,in0Glo77422,in0Ave48653,in1Ave48653], outputs=Max79999)
in0Mul29308 = tf.constant([[[[[0.2982]]], [[[0.5653]]]]])
in1Mul29308 = tf.constant([[[[[0.0687]]], [[[0.8362]]]]])
in0Glo77422 = tf.constant([[[[1.8946, 1.1525]]]])
in0Ave48653 = tf.constant([[[[[0.6457]]], [[[0.1317]]]]])
in1Ave48653 = tf.constant([[[[[0.1771]]], [[[0.4578]]]]])
print (np.array2string(model.predict([in0Mul29308,in1Mul29308,in0Glo77422,in0Ave48653,in1Ave48653],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max79999.png')

LMul29308 = multiply_layer([[[[[[0.2982]]], [[[0.5653]]]]], [[[[[0.0687]]], [[[0.8362]]]]]], Mul29308), 
LRes51396 = reshape_layer(Mul29308, [2, 1, 1], Res51396), 
LGlo77422 = global_max_pool2D_layer([[[[1.8946, 1.1525]]]], Glo77422), 
LRes56987 = reshape_layer(Glo77422, [2, 1, 1], Res56987), 
LAve49767 = average_layer([Res51396,Res56987], Ave49767), 
LRes62063 = reshape_layer(Ave49767, [2, 1, 1, 1], Res62063), 
LZer4158 = zero_padding3D_layer(Res62063, 2, 0, 2, 0, 2, 0, Zer4158), 
LAve48653 = average_layer([[[[[[0.6457]]], [[[0.1317]]]]], [[[[[0.1771]]], [[[0.4578]]]]]], Ave48653), 
LZer39740 = zero_padding3D_layer(Ave48653, 1, 1, 1, 1, 1, 1, Zer39740), 
LMax79999 = maximum_layer([Zer4158,Zer39740], Max79999), 
exec_layers([LMul29308,LRes51396,LGlo77422,LRes56987,LAve49767,LRes62063,LZer4158,LAve48653,LZer39740,LMax79999],["Mul29308","Res51396","Glo77422","Res56987","Ave49767","Res62063","Zer4158","Ave48653","Zer39740","Max79999"],Max79999,"Max79999")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.4114000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.2947500], [0.0000000]], [[0.0000000], [0.0000000], [0.9575432]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.8126019]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.41140000000000004],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.29475],[0]],[[0],[0],[0.95754317]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0.81260193]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.4114], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.2948], [0]], [[0], [0], [0.9576]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.8127]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.4115], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.2948], [0]], [[0], [0], [0.9576]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.8127]]]]]