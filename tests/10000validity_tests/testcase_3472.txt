import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas25497 = tf.keras.layers.Input(shape=([4, 1, 4]))

Mas25497 = keras.layers.Masking(mask_value=1, name = 'Mas25497', )(in0Mas25497)
Sep43096 = keras.layers.SeparableConv2D(3, (3, 1),strides=(1, 1), padding='valid', name = 'Sep43096', )(Mas25497)
model = tf.keras.models.Model(inputs=[in0Mas25497], outputs=Sep43096)
w = model.get_layer('Sep43096').get_weights() 
w[0] = np.array([[[[0.8633], [0.8984], [0.6128], [0.1702]]], [[[0.6727], [0.7792], [0.8854], [0.2931]]], [[[0.2689], [0.0071], [0.0938], [0.6791]]]])
w[1] = np.array([[[[0.5244, 0.1711, 0.7819], [0.6299, 0.2966, 0.7632], [0.9539, 0.1584, 0.0692], [0.8984, 0.4691, 0.5221]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep43096').set_weights(w) 
in0Mas25497 = tf.constant([[[[1.0154, 1.8844, 1.8393, 1.1859]], [[1.6028, 1.3085, 1.4953, 1.7611]], [[1.5521, 1.0181, 1.1054, 1.6064]], [[1.8142, 1.9056, 1.6825, 1.477]]]])
print (np.array2string(model.predict([in0Mas25497],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep43096.png')

LMas25497 = masking_layer([[[[1.0154, 1.8844, 1.8393, 1.1859]], [[1.6028, 1.3085, 1.4953, 1.7611]], [[1.5521, 1.0181, 1.1054, 1.6064]], [[1.8142, 1.9056, 1.6825, 1.477]]]], 1, Mas25497), 
LSep43096 = separable_conv2D_layer(Mas25497, 3, 1,[[[[[0.8633], [0.8984], [0.6128], [0.1702]]], [[[0.6727], [0.7792], [0.8854], [0.2931]]], [[[0.2689], [0.0071], [0.0938], [0.6791]]]],[[[[0.5244, 0.1711, 0.7819], [0.6299, 0.2966, 0.7632], [0.9539, 0.1584, 0.0692], [0.8984, 0.4691, 0.5221]]]]],[0, 0, 0], 1, 1, false, Sep43096), 
exec_layers([LMas25497,LSep43096],["Mas25497","Sep43096"],Sep43096,"Sep43096")

Actual (Unparsed): [[[[7.0192469, 2.4657949, 5.0517370]], [[6.3292955, 2.2440131, 4.8607510]]]]

Expected (Unparsed): [[[[7.019246774515,2.465794823564,5.051736913275999]],[[6.329295448542,2.244013041823,4.860750917922999]]]]

Actual:   [[[[7.0193, 2.4658, 5.0518]], [[6.3293, 2.2441, 4.8608]]]]

Expected: [[[[7.0193, 2.4658, 5.0518]], [[6.3293, 2.2441, 4.8608]]]]