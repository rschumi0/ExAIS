import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot39457 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot39457 = tf.keras.layers.Input(shape=([2, 2]))
in0Max57770 = tf.keras.layers.Input(shape=([2, 2]))
in1Max57770 = tf.keras.layers.Input(shape=([2, 2]))
in0Add11690 = tf.keras.layers.Input(shape=([1, 1]))
in1Add11690 = tf.keras.layers.Input(shape=([1, 1]))
in0Con22793 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot90554 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot90554 = tf.keras.layers.Input(shape=([2, 3]))
in0Con75511 = tf.keras.layers.Input(shape=([3, 3]))

Dot39457 = keras.layers.Dot(axes=(2, 1), name = 'Dot39457', )([in0Dot39457,in1Dot39457])
Res66110 = keras.layers.Reshape((2, 2, 1), name = 'Res66110', )(Dot39457)
Res19671 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res19671', )(Res66110)
Con31395 = keras.layers.Conv3DTranspose(2, (2, 2, 1),strides=(1, 1, 1), padding='valid', name = 'Con31395', )(Res19671)
Res96537 = keras.layers.Reshape((3, 3, 2), name = 'Res96537', )(Con31395)
Res24364 = keras.layers.Reshape((3, 6), name = 'Res24364', )(Res96537)
Max57770 = keras.layers.Maximum(name = 'Max57770', )([in0Max57770,in1Max57770])
Res98400 = keras.layers.Reshape((2, 2, 1), name = 'Res98400', )(Max57770)
Res57997 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res57997', )(Res98400)
Glo96287 = keras.layers.GlobalAveragePooling3D(name = 'Glo96287', )(Res57997)
Res47470 = keras.layers.Reshape((1, 1), name = 'Res47470', )(Glo96287)
Add11690 = keras.layers.Add(name = 'Add11690', )([in0Add11690,in1Add11690])
Res66147 = keras.layers.Reshape((1, 1, 1), name = 'Res66147', )(Add11690)
Cro15219 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro15219', )(Res66147)
Res87182 = keras.layers.Reshape((1, 1), name = 'Res87182', )(Cro15219)
Max33226 = keras.layers.Maximum(name = 'Max33226', )([Res47470,Res87182])
Zer7895 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer7895', )(Max33226)
Con22793 = keras.layers.Concatenate(axis=2, name = 'Con22793', )([Zer7895,in0Con22793])
Dot90554 = keras.layers.Dot(axes=(1, 1), name = 'Dot90554', )([in0Dot90554,in1Dot90554])
Max56275 = keras.layers.Maximum(name = 'Max56275', )([Con22793,Dot90554])
Con75511 = keras.layers.Concatenate(axis=2, name = 'Con75511', )([Max56275,in0Con75511])
Min62758 = keras.layers.Minimum(name = 'Min62758', )([Res24364,Con75511])
model = tf.keras.models.Model(inputs=[in0Dot39457,in1Dot39457,in0Max57770,in1Max57770,in0Add11690,in1Add11690,in0Con22793,in0Dot90554,in1Dot90554,in0Con75511], outputs=Min62758)
w = model.get_layer('Con31395').get_weights() 
w[0] = np.array([[[[[0.0175], [0.4]]], [[[0.7964], [0.3796]]]], [[[[0.8783], [0.4081]]], [[[0.077], [0.4869]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con31395').set_weights(w) 
in0Dot39457 = tf.constant([[[0.9667, 0.7187], [0.044, 0.1382]]])
in1Dot39457 = tf.constant([[[0.1003, 0.2609], [0.2165, 0.3784]]])
in0Max57770 = tf.constant([[[0.448, 0.2595], [0.852, 0.9203]]])
in1Max57770 = tf.constant([[[0.3496, 0.7502], [0.9085, 0.3304]]])
in0Add11690 = tf.constant([[[0.0119]]])
in1Add11690 = tf.constant([[[0.2743]]])
in0Con22793 = tf.constant([[[0.2514, 0.958], [0.5532, 0.5228], [0.3457, 0.238]]])
in0Dot90554 = tf.constant([[[0.8277, 0.4105, 0.7385], [0.0467, 0.2778, 0.9058]]])
in1Dot90554 = tf.constant([[[0.0256, 0.4398, 0.6337], [0.5202, 0.0335, 0.2081]]])
in0Con75511 = tf.constant([[[0.5735, 0.1065, 0.0653], [0.2773, 0.5385, 0.1022], [0.3619, 0.1833, 0.7537]]])
print (np.array2string(model.predict([in0Dot39457,in1Dot39457,in0Max57770,in1Max57770,in0Add11690,in1Add11690,in0Con22793,in0Dot90554,in1Dot90554,in0Con75511],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min62758.png')

LDot39457 = dot_layer([[[0.9667, 0.7187], [0.044, 0.1382]]], [[[0.1003, 0.2609], [0.2165, 0.3784]]], 2, 1, Dot39457), 
LRes66110 = reshape_layer(Dot39457, [2, 2, 1], Res66110), 
LRes19671 = reshape_layer(Res66110, [2, 2, 1, 1], Res19671), 
LCon31395 = conv3D_transpose_layer(Res19671, 2, 2, 1,[[[[[0.0175], [0.4]]], [[[0.7964], [0.3796]]]], [[[[0.8783], [0.4081]]], [[[0.077], [0.4869]]]]],[0, 0], 1, 1, 1, false, Con31395), 
LRes96537 = reshape_layer(Con31395, [3, 3, 2], Res96537), 
LRes24364 = reshape_layer(Res96537, [3, 6], Res24364), 
LMax57770 = maximum_layer([[[[0.448, 0.2595], [0.852, 0.9203]]], [[[0.3496, 0.7502], [0.9085, 0.3304]]]], Max57770), 
LRes98400 = reshape_layer(Max57770, [2, 2, 1], Res98400), 
LRes57997 = reshape_layer(Res98400, [2, 2, 1, 1], Res57997), 
LGlo96287 = global_average_pooling3D_layer(Res57997, Glo96287), 
LRes47470 = reshape_layer(Glo96287, [1, 1], Res47470), 
LAdd11690 = add_layer([[[[0.0119]]], [[[0.2743]]]], Add11690), 
LRes66147 = reshape_layer(Add11690, [1, 1, 1], Res66147), 
LCro15219 = cropping2D_layer(Res66147, 0, 0, 0, 0, Cro15219), 
LRes87182 = reshape_layer(Cro15219, [1, 1], Res87182), 
LMax33226 = maximum_layer([Res47470,Res87182], Max33226), 
LZer7895 = zero_padding1D_layer(Max33226, 2, 0, Zer7895), 
LCon22793 = concatenate_layer([Zer7895,[[[0.2514, 0.958], [0.5532, 0.5228], [0.3457, 0.238]]]], 2, Con22793), 
LDot90554 = dot_layer([[[0.8277, 0.4105, 0.7385], [0.0467, 0.2778, 0.9058]]], [[[0.0256, 0.4398, 0.6337], [0.5202, 0.0335, 0.2081]]], 1, 1, Dot90554), 
LMax56275 = maximum_layer([Con22793,Dot90554], Max56275), 
LCon75511 = concatenate_layer([Max56275,[[[0.5735, 0.1065, 0.0653], [0.2773, 0.5385, 0.1022], [0.3619, 0.1833, 0.7537]]]], 2, Con75511), 
LMin62758 = minimum_layer([Res24364,Con75511], Min62758), 
exec_layers([LDot39457,LRes66110,LRes19671,LCon31395,LRes96537,LRes24364,LMax57770,LRes98400,LRes57997,LGlo96287,LRes47470,LAdd11690,LRes66147,LCro15219,LRes87182,LMax33226,LZer7895,LCon22793,LDot90554,LMax56275,LCon75511,LMin62758],["Dot39457","Res66110","Res19671","Con31395","Res96537","Res24364","Max57770","Res98400","Res57997","Glo96287","Res47470","Add11690","Res66147","Cro15219","Res87182","Max33226","Zer7895","Con22793","Dot90554","Max56275","Con75511","Min62758"],Min62758,"Min62758")

Actual (Unparsed): [[[0.0044198, 0.1010234, 0.2103106, 0.3055385, 0.1065000, 0.0653000], [0.1550204, 0.1168025, 0.5082831, 0.2773000, 0.0911509, 0.1022000], [0.0301551, 0.0140115, 0.0586568, 0.0427433, 0.0049106, 0.0310518]]]

Expected (Unparsed): [[[0.0044197748,0.101023424,0.210310579109,0.305538473376,0.1065,0.0653],[0.15502036,0.11680254833600001,0.508283112933,0.2773,0.091150940342,0.1022],[0.030155113049999994,0.014011501349999999,0.058656805283999996,0.042743346438,0.004910634959999999,0.031051794311999996]]]

Actual:   [[[0.0045, 0.1011, 0.2104, 0.3056, 0.1065, 0.0653], [0.1551, 0.1169, 0.5083, 0.2773, 0.0912, 0.1022], [0.0302, 0.0141, 0.0587, 0.0428, 0.005, 0.0311]]]

Expected: [[[0.0045, 0.1011, 0.2104, 0.3056, 0.1065, 0.0653], [0.1551, 0.1169, 0.5083, 0.2773, 0.0912, 0.1022], [0.0302, 0.0141, 0.0587, 0.0428, 0.005, 0.0311]]]