import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul22914 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul22914 = tf.keras.layers.Input(shape=([1, 2]))
in0Con24712 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul62142 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Mul62142 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Con80062 = tf.keras.layers.Input(shape=([1, 1]))
in0Max24761 = tf.keras.layers.Input(shape=([1, 2]))
in1Max24761 = tf.keras.layers.Input(shape=([1, 2]))

Mul22914 = keras.layers.Multiply(name = 'Mul22914', )([in0Mul22914,in1Mul22914])
Con24712 = keras.layers.Concatenate(axis=2, name = 'Con24712', )([Mul22914,in0Con24712])
Mul62142 = keras.layers.Multiply(name = 'Mul62142', )([in0Mul62142,in1Mul62142])
Res88936 = keras.layers.Reshape((1, 2, 2), name = 'Res88936', )(Mul62142)
Res38665 = keras.layers.Reshape((1, 4), name = 'Res38665', )(Res88936)
Dot38823 = keras.layers.Dot(axes=(2, 2), name = 'Dot38823', )([Con24712,Res38665])
Res43050 = keras.layers.Reshape((1, 1, 1), name = 'Res43050', )(Dot38823)
Glo27000 = keras.layers.GlobalMaxPool2D(name = 'Glo27000', )(Res43050)
Res6418 = keras.layers.Reshape((1, 1), name = 'Res6418', )(Glo27000)
Con80062 = keras.layers.Concatenate(axis=2, name = 'Con80062', )([Res6418,in0Con80062])
Max24761 = keras.layers.Maximum(name = 'Max24761', )([in0Max24761,in1Max24761])
Mul94 = keras.layers.Multiply(name = 'Mul94', )([Con80062,Max24761])
model = tf.keras.models.Model(inputs=[in0Mul22914,in1Mul22914,in0Con24712,in0Mul62142,in1Mul62142,in0Con80062,in0Max24761,in1Max24761], outputs=Mul94)
in0Mul22914 = tf.constant([[[0.1471, 0.5737]]])
in1Mul22914 = tf.constant([[[0.2219, 0.7075]]])
in0Con24712 = tf.constant([[[0.6878, 0.9459]]])
in0Mul62142 = tf.constant([[[[[0.9218, 0.0955]], [[0.6101, 0.3044]]]]])
in1Mul62142 = tf.constant([[[[[0.7317, 0.0554]], [[0.416, 0.5293]]]]])
in0Con80062 = tf.constant([[[0.8597]]])
in0Max24761 = tf.constant([[[0.7744, 0.4967]]])
in1Max24761 = tf.constant([[[0.0193, 0.2095]]])
print (np.array2string(model.predict([in0Mul22914,in1Mul22914,in0Con24712,in0Mul62142,in1Mul62142,in0Con80062,in0Max24761,in1Max24761],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul94.png')

LMul22914 = multiply_layer([[[[0.1471, 0.5737]]], [[[0.2219, 0.7075]]]], Mul22914), 
LCon24712 = concatenate_layer([Mul22914,[[[0.6878, 0.9459]]]], 2, Con24712), 
LMul62142 = multiply_layer([[[[[[0.9218, 0.0955]], [[0.6101, 0.3044]]]]], [[[[[0.7317, 0.0554]], [[0.416, 0.5293]]]]]], Mul62142), 
LRes88936 = reshape_layer(Mul62142, [1, 2, 2], Res88936), 
LRes38665 = reshape_layer(Res88936, [1, 4], Res38665), 
LDot38823 = dot_layer(Con24712,Res38665, 2, 2, Dot38823), 
LRes43050 = reshape_layer(Dot38823, [1, 1, 1], Res43050), 
LGlo27000 = global_max_pool2D_layer(Res43050, Glo27000), 
LRes6418 = reshape_layer(Glo27000, [1, 1], Res6418), 
LCon80062 = concatenate_layer([Res6418,[[[0.8597]]]], 2, Con80062), 
LMax24761 = maximum_layer([[[[0.7744, 0.4967]]], [[[0.0193, 0.2095]]]], Max24761), 
LMul94 = multiply_layer([Con80062,Max24761], Mul94), 
exec_layers([LMul22914,LCon24712,LMul62142,LRes88936,LRes38665,LDot38823,LRes43050,LGlo27000,LRes6418,LCon80062,LMax24761,LMul94],["Mul22914","Con24712","Mul62142","Res88936","Res38665","Dot38823","Res43050","Glo27000","Res6418","Con80062","Max24761","Mul94"],Mul94,"Mul94")

Actual (Unparsed): [[[0.2719156, 0.4270130]]]

Expected (Unparsed): [[[0.27191557571282,0.42701299]]]

Actual:   [[[0.272, 0.4271]]]

Expected: [[[0.272, 0.4271]]]