import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per74346 = tf.keras.layers.Input(shape=([4, 2]))

Per74346 = keras.layers.Permute((2,1), name = 'Per74346',)(in0Per74346)
ELU82054 = keras.layers.ELU(alpha=7.8754226757854475, name = 'ELU82054', )(Per74346)
GRU30218 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU30218', )(ELU82054)
model = tf.keras.models.Model(inputs=[in0Per74346], outputs=GRU30218)
w = model.get_layer('GRU30218').get_weights() 
w[0] = np.array([[6, 9, 2, 8, 5, 5, 7, 5, 10], [8, 1, 6, 4, 10, 8, 3, 8, 10], [2, 8, 6, 10, 7, 4, 4, 3, 7], [6, 6, 2, 5, 6, 10, 4, 5, 8]])
w[1] = np.array([[3, 3, 7, 10, 3, 6, 1, 6, 6], [9, 9, 5, 1, 6, 8, 1, 1, 10], [2, 9, 4, 6, 6, 4, 9, 2, 6]])
w[2] = np.array([[9, 10, 8, 6, 7, 5, 6, 9, 4], [1, 10, 3, 7, 2, 10, 8, 5, 7]])
model.get_layer('GRU30218').set_weights(w) 
in0Per74346 = tf.constant([[[1.5612, 1.0412], [1.3705, 1.8637], [1.5125, 1.4582], [1.9874, 1.3039]]])
print (np.array2string(model.predict([in0Per74346],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU30218.png')

LPer74346 = permute_layer([[[1.5612, 1.0412], [1.3705, 1.8637], [1.5125, 1.4582], [1.9874, 1.3039]]], 2,1, Per74346), 
LELU82054 = elu_layer(Per74346, 7.8754226757854475, ELU82054), 
LGRU30218 = gru_layer(ELU82054,[[6, 9, 2, 8, 5, 5, 7, 5, 10], [8, 1, 6, 4, 10, 8, 3, 8, 10], [2, 8, 6, 10, 7, 4, 4, 3, 7], [6, 6, 2, 5, 6, 10, 4, 5, 8]],[[3, 3, 7, 10, 3, 6, 1, 6, 6], [9, 9, 5, 1, 6, 8, 1, 1, 10], [2, 9, 4, 6, 6, 4, 9, 2, 6]],[[9, 10, 8, 6, 7, 5, 6, 9, 4], [1, 10, 3, 7, 2, 10, 8, 5, 7]], true, GRU30218), 
exec_layers([LPer74346,LELU82054,LGRU30218],["Per74346","ELU82054","GRU30218"],GRU30218,"GRU30218")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0,8.88178419700125e-16]]

Actual:   [[0, 0, 0]]

Expected: [[0, 0, 0]]