import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max8008 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Max8008 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Sof40846 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Sub27084 = tf.keras.layers.Input(shape=([2]))
in1Sub27084 = tf.keras.layers.Input(shape=([2]))
in0Con23620 = tf.keras.layers.Input(shape=([2]))

Max8008 = keras.layers.Maximum(name = 'Max8008', )([in0Max8008,in1Max8008])
Res46589 = keras.layers.Reshape((1, 2, 2), name = 'Res46589', )(Max8008)
Res39030 = keras.layers.Reshape((1, 4), name = 'Res39030', )(Res46589)
Ave73281 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='valid', name = 'Ave73281', )(Res39030)
ELU75193 = keras.layers.ELU(alpha=-6.577427522241795, name = 'ELU75193', )(Ave73281)
Fla32709 = keras.layers.Flatten(name = 'Fla32709', )(ELU75193)
Sof40846 = keras.layers.Softmax(axis=1, name = 'Sof40846', input_shape=(1, 2, 1))(in0Sof40846)
Res58704 = keras.layers.Reshape((1, 2), name = 'Res58704', )(Sof40846)
Fla88710 = keras.layers.Flatten(name = 'Fla88710', )(Res58704)
Sub27084 = keras.layers.Subtract(name = 'Sub27084', )([in0Sub27084,in1Sub27084])
Min97822 = keras.layers.Minimum(name = 'Min97822', )([Fla88710,Sub27084])
Con23620 = keras.layers.Concatenate(axis=1, name = 'Con23620', )([Min97822,in0Con23620])
Ave31605 = keras.layers.Average(name = 'Ave31605', )([Fla32709,Con23620])
model = tf.keras.models.Model(inputs=[in0Max8008,in1Max8008,in0Sof40846,in0Sub27084,in1Sub27084,in0Con23620], outputs=Ave31605)
in0Max8008 = tf.constant([[[[[0.9021], [0.2764]], [[0.6413], [0.5417]]]]])
in1Max8008 = tf.constant([[[[[0.3249], [0.1372]], [[0.5862], [0.6699]]]]])
in0Sof40846 = tf.constant([[[[0.4138], [0.4103]]]])
in0Sub27084 = tf.constant([[0.0598, 0.2947]])
in1Sub27084 = tf.constant([[0.0722, 0.1808]])
in0Con23620 = tf.constant([[0.0682, 0.8507]])
print (np.array2string(model.predict([in0Max8008,in1Max8008,in0Sof40846,in0Sub27084,in1Sub27084,in0Con23620],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave31605.png')

LMax8008 = maximum_layer([[[[[[0.9021], [0.2764]], [[0.6413], [0.5417]]]]], [[[[[0.3249], [0.1372]], [[0.5862], [0.6699]]]]]], Max8008), 
LRes46589 = reshape_layer(Max8008, [1, 2, 2], Res46589), 
LRes39030 = reshape_layer(Res46589, [1, 4], Res39030), 
LAve73281 = average_pooling1D_layer(Res39030, 1, 1, false, Ave73281), 
LELU75193 = elu_layer(Ave73281, -6.577427522241795, ELU75193), 
LFla32709 = flatten_layer(ELU75193, Fla32709), 
LSof40846 = softmax_layer([[[[0.4138], [0.4103]]]], 1, Sof40846), 
LRes58704 = reshape_layer(Sof40846, [1, 2], Res58704), 
LFla88710 = flatten_layer(Res58704, Fla88710), 
LSub27084 = subtract_layer([[0.0598, 0.2947]], [[0.0722, 0.1808]], Sub27084), 
LMin97822 = minimum_layer([Fla88710,Sub27084], Min97822), 
LCon23620 = concatenate_layer([Min97822,[[0.0682, 0.8507]]], 1, Con23620), 
LAve31605 = average_layer([Fla32709,Con23620], Ave31605), 
exec_layers([LMax8008,LRes46589,LRes39030,LAve73281,LELU75193,LFla32709,LSof40846,LRes58704,LFla88710,LSub27084,LMin97822,LCon23620,LAve31605],["Max8008","Res46589","Res39030","Ave73281","ELU75193","Fla32709","Sof40846","Res58704","Fla88710","Sub27084","Min97822","Con23620","Ave31605"],Ave31605,"Ave31605")

Actual (Unparsed): [[0.4448500, 0.1951500, 0.3547500, 0.7603000]]

Expected (Unparsed): [[0.44485,0.19515,0.35475,0.7603]]

Actual:   [[0.4449, 0.1952, 0.3548, 0.7603]]

Expected: [[0.4449, 0.1952, 0.3548, 0.7603]]