import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla90385 = tf.keras.layers.Input(shape=([2, 1]))

Fla90385 = keras.layers.Flatten(name = 'Fla90385', )(in0Fla90385)
Res98877 = keras.layers.Reshape((2, 1), name = 'Res98877', )(Fla90385)
GRU6416 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU6416', )(Res98877)
Lea65634 = keras.layers.LeakyReLU(alpha=4.715519470404846, name = 'Lea65634', )(GRU6416)
model = tf.keras.models.Model(inputs=[in0Fla90385], outputs=Lea65634)
w = model.get_layer('GRU6416').get_weights() 
w[0] = np.array([[6, 2, 7, 8, 8, 6]])
w[1] = np.array([[6, 3, 9, 10, 7, 2], [7, 1, 5, 8, 3, 9]])
w[2] = np.array([[10, 3, 9, 5, 1, 9], [5, 5, 2, 4, 7, 9]])
model.get_layer('GRU6416').set_weights(w) 
in0Fla90385 = tf.constant([[[1.2331], [1.4215]]])
print (np.array2string(model.predict([in0Fla90385],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lea65634.png')

LFla90385 = flatten_layer([[[1.2331], [1.4215]]], Fla90385), 
LRes98877 = reshape_layer(Fla90385, [2, 1], Res98877), 
LGRU6416 = gru_layer(Res98877,[[6, 2, 7, 8, 8, 6]],[[6, 3, 9, 10, 7, 2], [7, 1, 5, 8, 3, 9]],[[10, 3, 9, 5, 1, 9], [5, 5, 2, 4, 7, 9]], true, GRU6416), 
LLea65634 = leaky_relu_layer(GRU6416, 4.715519470404846, Lea65634), 
exec_layers([LFla90385,LRes98877,LGRU6416,LLea65634],["Fla90385","Res98877","GRU6416","Lea65634"],Lea65634,"Lea65634")

Actual (Unparsed): [[0.0000000, 0.0000480]]

Expected (Unparsed): [[2.4769586380846656e-10,4.802169990552425e-5]]

Actual:   [[0, 0.0001]]

Expected: [[0, 0.0001]]