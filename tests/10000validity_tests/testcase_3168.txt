import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL52085 = tf.keras.layers.Input(shape=([2, 2]))
in0Glo6151 = tf.keras.layers.Input(shape=([1, 2, 1]))

ReL52085 = keras.layers.ReLU(max_value=9.805834006239316, negative_slope=4.953017769435096, threshold=1.6921881157740615, name = 'ReL52085', input_shape=(2, 2))(in0ReL52085)
PRe13140 = keras.layers.PReLU(name = 'PRe13140', )(ReL52085)
Res69406 = keras.layers.Reshape((2, 2, 1), name = 'Res69406', )(PRe13140)
Cro87241 = keras.layers.Cropping2D(cropping=((0, 1), (1, 0)), name = 'Cro87241', )(Res69406)
Res19989 = keras.layers.Reshape((1, 1), name = 'Res19989', )(Cro87241)
Fla94113 = keras.layers.Flatten(name = 'Fla94113', )(Res19989)
Glo6151 = keras.layers.GlobalMaxPool2D(name = 'Glo6151', )(in0Glo6151)
Res90737 = keras.layers.Reshape((1, 1), name = 'Res90737', )(Glo6151)
Res45988 = keras.layers.Reshape((1, 1, 1), name = 'Res45988', )(Res90737)
Cro70536 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro70536', )(Res45988)
Glo17602 = keras.layers.GlobalMaxPool2D(name = 'Glo17602', )(Cro70536)
Sub63578 = keras.layers.Subtract(name = 'Sub63578', )([Fla94113,Glo17602])
model = tf.keras.models.Model(inputs=[in0ReL52085,in0Glo6151], outputs=Sub63578)
w = model.get_layer('PRe13140').get_weights() 
w[0] = np.array([[0.6288, 0.6675], [0.3754, 0.322]])
model.get_layer('PRe13140').set_weights(w) 
in0ReL52085 = tf.constant([[[0.8758, 0.2435], [0.4043, 0.3291]]])
in0Glo6151 = tf.constant([[[[1.6026], [1.6028]]]])
print (np.array2string(model.predict([in0ReL52085,in0Glo6151],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub63578.png')

LReL52085 = relu_layer([[[0.8758, 0.2435], [0.4043, 0.3291]]], 9.805834006239316, 4.953017769435096, 1.6921881157740615, ReL52085), 
LPRe13140 = prelu_layer(ReL52085, [[0.6288, 0.6675], [0.3754, 0.322]], PRe13140), 
LRes69406 = reshape_layer(PRe13140, [2, 2, 1], Res69406), 
LCro87241 = cropping2D_layer(Res69406, 0, 1, 1, 0, Cro87241), 
LRes19989 = reshape_layer(Cro87241, [1, 1], Res19989), 
LFla94113 = flatten_layer(Res19989, Fla94113), 
LGlo6151 = global_max_pool2D_layer([[[[1.6026], [1.6028]]]], Glo6151), 
LRes90737 = reshape_layer(Glo6151, [1, 1], Res90737), 
LRes45988 = reshape_layer(Res90737, [1, 1, 1], Res45988), 
LCro70536 = cropping2D_layer(Res45988, 0, 0, 0, 0, Cro70536), 
LGlo17602 = global_max_pool2D_layer(Cro70536, Glo17602), 
LSub63578 = subtract_layer(Fla94113,Glo17602, Sub63578), 
exec_layers([LReL52085,LPRe13140,LRes69406,LCro87241,LRes19989,LFla94113,LGlo6151,LRes90737,LRes45988,LCro70536,LGlo17602,LSub63578],["ReL52085","PRe13140","Res69406","Cro87241","Res19989","Fla94113","Glo6151","Res90737","Res45988","Cro70536","Glo17602","Sub63578"],Sub63578,"Sub63578")

Actual (Unparsed): [[-6.3923648]]

Expected (Unparsed): [[-6.392364801515415]]

Actual:   [[-6.3923]]

Expected: [[-6.3923]]