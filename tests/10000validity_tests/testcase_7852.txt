import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep50003 = tf.keras.layers.Input(shape=([2, 2, 1]))

Sep50003 = keras.layers.SeparableConv2D(2, (2, 2),strides=(2, 2), padding='valid', name = 'Sep50003', )(in0Sep50003)
Up_2791 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_2791', )(Sep50003)
Con8679 = keras.layers.Conv2DTranspose(2, (2, 2),strides=(1, 8), padding='valid', name = 'Con8679', )(Up_2791)
Glo53297 = keras.layers.GlobalAveragePooling2D(name = 'Glo53297', )(Con8679)
model = tf.keras.models.Model(inputs=[in0Sep50003], outputs=Glo53297)
w = model.get_layer('Sep50003').get_weights() 
w[0] = np.array([[[[0.7338]], [[0.523]]], [[[0.1021]], [[0.2056]]]])
w[1] = np.array([[[[0.4996, 0.9909]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep50003').set_weights(w) 
w = model.get_layer('Con8679').get_weights() 
w[0] = np.array([[[[0.2287, 0.7181], [0.9564, 0.5732]], [[0.9093, 0.3211], [0.6031, 0.739]]], [[[0.497, 0.1701], [0.895, 0.6961]], [[0.5729, 0.708], [0.9401, 0.2927]]]])
w[1] = np.array([0, 0])
model.get_layer('Con8679').set_weights(w) 
in0Sep50003 = tf.constant([[[[0.4992], [0.6451]], [[0.2802], [0.6389]]]])
print (np.array2string(model.predict([in0Sep50003],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo53297.png')

LSep50003 = separable_conv2D_layer([[[[0.4992], [0.6451]], [[0.2802], [0.6389]]]], 2, 2,[[[[[0.7338]], [[0.523]]], [[[0.1021]], [[0.2056]]]],[[[[0.4996, 0.9909]]]]],[0, 0], 2, 2, false, Sep50003), 
LUp_2791 = up_sampling2D_layer(Sep50003, 2, 2, Up_2791), 
LCon8679 = conv2D_transpose_layer(Up_2791, 2, 2,[[[[0.2287, 0.7181], [0.9564, 0.5732]], [[0.9093, 0.3211], [0.6031, 0.739]]], [[[0.497, 0.1701], [0.895, 0.6961]], [[0.5729, 0.708], [0.9401, 0.2927]]]],[0, 0], 1, 8, false, Con8679), 
LGlo53297 = global_average_pooling2D_layer(Con8679, Glo53297), 
exec_layers([LSep50003,LUp_2791,LCon8679,LGlo53297],["Sep50003","Up_2791","Con8679","Glo53297"],Glo53297,"Glo53297")

Actual (Unparsed): [[0.2161267, 0.2861617]]

Expected (Unparsed): [[0.21612674638959603,0.2861617271949626]]

Actual:   [[0.2162, 0.2862]]

Expected: [[0.2162, 0.2862]]