import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_55408 = tf.keras.layers.Input(shape=([2, 2]))
in0Con10503 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Cro47256 = tf.keras.layers.Input(shape=([4, 4, 3, 2]))
in0PRe48355 = tf.keras.layers.Input(shape=([1, 1, 1]))

Up_55408 = keras.layers.UpSampling1D(size=(1), name = 'Up_55408', )(in0Up_55408)
Res49970 = keras.layers.Reshape((2, 2, 1), name = 'Res49970', )(Up_55408)
Res57589 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res57589', )(Res49970)
Con10503 = keras.layers.Concatenate(axis=4, name = 'Con10503', )([Res57589,in0Con10503])
Cro47256 = keras.layers.Cropping3D(cropping=((1, 2), (1, 1), (1, 1)), name = 'Cro47256', )(in0Cro47256)
Zer14498 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer14498', )(Cro47256)
Add22912 = keras.layers.Add(name = 'Add22912', )([Con10503,Zer14498])
Res45881 = keras.layers.Reshape((2, 2, 2), name = 'Res45881', )(Add22912)
Res35037 = keras.layers.Reshape((2, 4), name = 'Res35037', )(Res45881)
PRe48355 = keras.layers.PReLU(name = 'PRe48355', input_shape=(1, 1, 1))(in0PRe48355)
Cro30791 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro30791', )(PRe48355)
Res21904 = keras.layers.Reshape((1, 1), name = 'Res21904', )(Cro30791)
Zer25006 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer25006', )(Res21904)
Dot50087 = keras.layers.Dot(axes=(1, 1), name = 'Dot50087', )([Res35037,Zer25006])
model = tf.keras.models.Model(inputs=[in0Up_55408,in0Con10503,in0Cro47256,in0PRe48355], outputs=Dot50087)
w = model.get_layer('PRe48355').get_weights() 
w[0] = np.array([[[0.1741]]])
model.get_layer('PRe48355').set_weights(w) 
in0Up_55408 = tf.constant([[[1.6721, 1.1637], [1.1455, 1.7586]]])
in0Con10503 = tf.constant([[[[[0.3883]], [[0.5531]]], [[[0.9464]], [[0.1547]]]]])
in0Cro47256 = tf.constant([[[[[1.4524, 1.1348], [1.7351, 1.0909], [1.178, 1.5172]], [[1.1051, 1.5943], [1.2742, 1.6524], [1.4705, 1.5483]], [[1.811, 1.861], [1.7209, 1.8551], [1.3019, 1.7001]], [[1.7385, 1.1803], [1.7256, 1.3017], [1.3907, 1.1406]]], [[[1.356, 1.7448], [1.9596, 1.253], [1.0327, 1.9407]], [[1.3346, 1.0221], [1.8362, 1.5653], [1.6374, 1.2393]], [[1.7406, 1.1592], [1.0755, 1.295], [1.7072, 1.6361]], [[1.7289, 1.0652], [1.8581, 1.0864], [1.6599, 1.7203]]], [[[1.8209, 1.9475], [1.2099, 1.6299], [1.0699, 1.3193]], [[1.5934, 1.3858], [1.1103, 1.4532], [1.9357, 1.8519]], [[1.644, 1.2087], [1.7122, 1.0639], [1.4388, 1.5868]], [[1.142, 1.7465], [1.4824, 1.2786], [1.4646, 1.1968]]], [[[1.1417, 1.5389], [1.1868, 1.2876], [1.4746, 1.5962]], [[1.3236, 1.3866], [1.5435, 1.2352], [1.3778, 1.0587]], [[1.5633, 1.1569], [1.3043, 1.5199], [1.9881, 1.2084]], [[1.9853, 1.9461], [1.1838, 1.6028], [1.8091, 1.9055]]]]])
in0PRe48355 = tf.constant([[[[0.1652]]]])
print (np.array2string(model.predict([in0Up_55408,in0Con10503,in0Cro47256,in0PRe48355],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot50087.png')

LUp_55408 = up_sampling1D_layer([[[1.6721, 1.1637], [1.1455, 1.7586]]], 1, Up_55408), 
LRes49970 = reshape_layer(Up_55408, [2, 2, 1], Res49970), 
LRes57589 = reshape_layer(Res49970, [2, 2, 1, 1], Res57589), 
LCon10503 = concatenate_layer([Res57589,[[[[[0.3883]], [[0.5531]]], [[[0.9464]], [[0.1547]]]]]], 4, Con10503), 
LCro47256 = cropping3D_layer([[[[[1.4524, 1.1348], [1.7351, 1.0909], [1.178, 1.5172]], [[1.1051, 1.5943], [1.2742, 1.6524], [1.4705, 1.5483]], [[1.811, 1.861], [1.7209, 1.8551], [1.3019, 1.7001]], [[1.7385, 1.1803], [1.7256, 1.3017], [1.3907, 1.1406]]], [[[1.356, 1.7448], [1.9596, 1.253], [1.0327, 1.9407]], [[1.3346, 1.0221], [1.8362, 1.5653], [1.6374, 1.2393]], [[1.7406, 1.1592], [1.0755, 1.295], [1.7072, 1.6361]], [[1.7289, 1.0652], [1.8581, 1.0864], [1.6599, 1.7203]]], [[[1.8209, 1.9475], [1.2099, 1.6299], [1.0699, 1.3193]], [[1.5934, 1.3858], [1.1103, 1.4532], [1.9357, 1.8519]], [[1.644, 1.2087], [1.7122, 1.0639], [1.4388, 1.5868]], [[1.142, 1.7465], [1.4824, 1.2786], [1.4646, 1.1968]]], [[[1.1417, 1.5389], [1.1868, 1.2876], [1.4746, 1.5962]], [[1.3236, 1.3866], [1.5435, 1.2352], [1.3778, 1.0587]], [[1.5633, 1.1569], [1.3043, 1.5199], [1.9881, 1.2084]], [[1.9853, 1.9461], [1.1838, 1.6028], [1.8091, 1.9055]]]]], 1, 2, 1, 1, 1, 1, Cro47256), 
LZer14498 = zero_padding3D_layer(Cro47256, 1, 0, 0, 0, 0, 0, Zer14498), 
LAdd22912 = add_layer([Con10503,Zer14498], Add22912), 
LRes45881 = reshape_layer(Add22912, [2, 2, 2], Res45881), 
LRes35037 = reshape_layer(Res45881, [2, 4], Res35037), 
LPRe48355 = prelu_layer([[[[0.1652]]]], [[[0.1741]]], PRe48355), 
LCro30791 = cropping2D_layer(PRe48355, 0, 0, 0, 0, Cro30791), 
LRes21904 = reshape_layer(Cro30791, [1, 1], Res21904), 
LZer25006 = zero_padding1D_layer(Res21904, 1, 0, Zer25006), 
LDot50087 = dot_layer(Res35037,Zer25006, 1, 1, Dot50087), 
exec_layers([LUp_55408,LRes49970,LRes57589,LCon10503,LCro47256,LZer14498,LAdd22912,LRes45881,LRes35037,LPRe48355,LCro30791,LRes21904,LZer25006,LDot50087],["Up_55408","Res49970","Res57589","Con10503","Cro47256","Zer14498","Add22912","Res45881","Res35037","PRe48355","Cro30791","Res21904","Zer25006","Dot50087"],Dot50087,"Dot50087")

Actual (Unparsed): [[[0.4925768], [0.4149328], [0.4681933], [0.2394904]]]

Expected (Unparsed): [[[0.49257684],[0.41493284],[0.46819332],[0.23949044000000003]]]

Actual:   [[[0.4926], [0.415], [0.4682], [0.2395]]]

Expected: [[[0.4926], [0.415], [0.4682], [0.2395]]]