import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub12266 = tf.keras.layers.Input(shape=([2, 2, 3]))
in1Sub12266 = tf.keras.layers.Input(shape=([2, 2, 3]))
in0Max79773 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max79773 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Add21399 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Add21399 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con17684 = tf.keras.layers.Input(shape=([2, 5]))

Sub12266 = keras.layers.Subtract(name = 'Sub12266', )([in0Sub12266,in1Sub12266])
Res14430 = keras.layers.Reshape((2, 6), name = 'Res14430', )(Sub12266)
Max79773 = keras.layers.Maximum(name = 'Max79773', )([in0Max79773,in1Max79773])
Res58849 = keras.layers.Reshape((1, 1), name = 'Res58849', )(Max79773)
Add21399 = keras.layers.Add(name = 'Add21399', )([in0Add21399,in1Add21399])
Res66300 = keras.layers.Reshape((1, 1, 1), name = 'Res66300', )(Add21399)
Res15441 = keras.layers.Reshape((1, 1), name = 'Res15441', )(Res66300)
Dot78498 = keras.layers.Dot(axes=(1, 1), name = 'Dot78498', )([Res58849,Res15441])
Max22623 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='valid', name = 'Max22623', )(Dot78498)
Zer3260 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer3260', )(Max22623)
Con17684 = keras.layers.Concatenate(axis=2, name = 'Con17684', )([Zer3260,in0Con17684])
Mul31400 = keras.layers.Multiply(name = 'Mul31400', )([Res14430,Con17684])
model = tf.keras.models.Model(inputs=[in0Sub12266,in1Sub12266,in0Max79773,in1Max79773,in0Add21399,in1Add21399,in0Con17684], outputs=Mul31400)
in0Sub12266 = tf.constant([[[[0.0302, 0.6049, 0.9374], [0.1513, 0.4551, 0.8566]], [[0.3341, 0.3397, 0.2172], [0.531, 0.9921, 0.2229]]]])
in1Sub12266 = tf.constant([[[[0.4814, 0.4242, 0.8919], [0.8575, 0.8385, 0.9898]], [[0.1282, 0.4739, 0.2422], [0.6785, 0.1813, 0.2414]]]])
in0Max79773 = tf.constant([[[[0.1264]]]])
in1Max79773 = tf.constant([[[[0.082]]]])
in0Add21399 = tf.constant([[[[[0.9457]]]]])
in1Add21399 = tf.constant([[[[[0.6113]]]]])
in0Con17684 = tf.constant([[[0.6984, 0.9557, 0.9557, 0.3651, 0.8761], [0.2294, 0.5221, 0.7748, 0.4998, 0.4009]]])
print (np.array2string(model.predict([in0Sub12266,in1Sub12266,in0Max79773,in1Max79773,in0Add21399,in1Add21399,in0Con17684],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul31400.png')

LSub12266 = subtract_layer([[[[0.0302, 0.6049, 0.9374], [0.1513, 0.4551, 0.8566]], [[0.3341, 0.3397, 0.2172], [0.531, 0.9921, 0.2229]]]], [[[[0.4814, 0.4242, 0.8919], [0.8575, 0.8385, 0.9898]], [[0.1282, 0.4739, 0.2422], [0.6785, 0.1813, 0.2414]]]], Sub12266), 
LRes14430 = reshape_layer(Sub12266, [2, 6], Res14430), 
LMax79773 = maximum_layer([[[[[0.1264]]]], [[[[0.082]]]]], Max79773), 
LRes58849 = reshape_layer(Max79773, [1, 1], Res58849), 
LAdd21399 = add_layer([[[[[[0.9457]]]]], [[[[[0.6113]]]]]], Add21399), 
LRes66300 = reshape_layer(Add21399, [1, 1, 1], Res66300), 
LRes15441 = reshape_layer(Res66300, [1, 1], Res15441), 
LDot78498 = dot_layer(Res58849,Res15441, 1, 1, Dot78498), 
LMax22623 = max_pool1D_layer(Dot78498, 1, 1, false, Max22623), 
LZer3260 = zero_padding1D_layer(Max22623, 1, 0, Zer3260), 
LCon17684 = concatenate_layer([Zer3260,[[[0.6984, 0.9557, 0.9557, 0.3651, 0.8761], [0.2294, 0.5221, 0.7748, 0.4998, 0.4009]]]], 2, Con17684), 
LMul31400 = multiply_layer([Res14430,Con17684], Mul31400), 
exec_layers([LSub12266,LRes14430,LMax79773,LRes58849,LAdd21399,LRes66300,LRes15441,LDot78498,LMax22623,LZer3260,LCon17684,LMul31400],["Sub12266","Res14430","Max79773","Res58849","Add21399","Res66300","Res15441","Dot78498","Max22623","Zer3260","Con17684","Mul31400"],Mul31400,"Mul31400")

Actual (Unparsed): [[[-0.0000000, 0.1262009, 0.0434843, -0.6749153, -0.1399793, -0.1166965], [0.0405221, -0.0307855, -0.0130525, -0.1142830, 0.4052378, -0.0074167]]]

Expected (Unparsed): [[[-0.0,0.12620088,0.043484349999999984,-0.6749153400000001,-0.13997934,-0.11669651999999998],[0.04052210832,-0.030785479999999997,-0.013052499999999998,-0.11428299999999998,0.40523784,-0.007416650000000006]]]

Actual:   [[[-0, 0.1263, 0.0435, -0.6749, -0.1399, -0.1166], [0.0406, -0.0307, -0.013, -0.1142, 0.4053, -0.0074]]]

Expected: [[[-0, 0.1263, 0.0435, -0.6749, -0.1399, -0.1166], [0.0406, -0.0307, -0.013, -0.1142, 0.4053, -0.0074]]]