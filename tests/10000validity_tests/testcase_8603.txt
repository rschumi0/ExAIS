import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave46061 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Ave46061 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Add85472 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add85472 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con1693 = tf.keras.layers.Input(shape=([2, 2]))
in0Cro70793 = tf.keras.layers.Input(shape=([3, 3]))
in0Sof24229 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con99314 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con92301 = tf.keras.layers.Input(shape=([2, 1]))
in0Up_12525 = tf.keras.layers.Input(shape=([2, 4]))

Ave46061 = keras.layers.Average(name = 'Ave46061', )([in0Ave46061,in1Ave46061])
Add85472 = keras.layers.Add(name = 'Add85472', )([in0Add85472,in1Add85472])
Res3588 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res3588', )(Add85472)
Cro85815 = keras.layers.Cropping3D(cropping=((0, 1), (0, 0), (0, 0)), name = 'Cro85815', )(Res3588)
Zer67604 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer67604', )(Cro85815)
Min83864 = keras.layers.Minimum(name = 'Min83864', )([Ave46061,Zer67604])
Res10850 = keras.layers.Reshape((2, 2, 1), name = 'Res10850', )(Min83864)
Res96612 = keras.layers.Reshape((2, 2), name = 'Res96612', )(Res10850)
Con1693 = keras.layers.Concatenate(axis=2, name = 'Con1693', )([Res96612,in0Con1693])
Cro70793 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro70793', )(in0Cro70793)
Res94579 = keras.layers.Reshape((3, 3, 1), name = 'Res94579', )(Cro70793)
Con19517 = keras.layers.Conv2D(3, (2, 3),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con19517', )(Res94579)
Sof24229 = keras.layers.Softmax(axis=1, name = 'Sof24229', input_shape=(1, 1, 1))(in0Sof24229)
Zer44292 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer44292', )(Sof24229)
Con99314 = keras.layers.Concatenate(axis=3, name = 'Con99314', )([Zer44292,in0Con99314])
Ave75270 = keras.layers.Average(name = 'Ave75270', )([Con19517,Con99314])
Res32247 = keras.layers.Reshape((2, 3), name = 'Res32247', )(Ave75270)
Con92301 = keras.layers.Concatenate(axis=2, name = 'Con92301', )([Res32247,in0Con92301])
Up_12525 = keras.layers.UpSampling1D(size=(1), name = 'Up_12525', )(in0Up_12525)
Max35365 = keras.layers.Maximum(name = 'Max35365', )([Con92301,Up_12525])
Sub25162 = keras.layers.Subtract(name = 'Sub25162', )([Con1693,Max35365])
model = tf.keras.models.Model(inputs=[in0Ave46061,in1Ave46061,in0Add85472,in1Add85472,in0Con1693,in0Cro70793,in0Sof24229,in0Con99314,in0Con92301,in0Up_12525], outputs=Sub25162)
w = model.get_layer('Con19517').get_weights() 
w[0] = np.array([[[[0.3576, 0.5137, 0.5454]], [[0.8978, 0.1215, 0.6387]], [[0.391, 0.4966, 0.9629]]], [[[0.6519, 0.2446, 0.4978]], [[0.7487, 0.0486, 0.6585]], [[0.51, 0.4499, 0.9864]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con19517').set_weights(w) 
in0Ave46061 = tf.constant([[[[[0.4663]], [[0.8528]]], [[[0.6513]], [[0.2486]]]]])
in1Ave46061 = tf.constant([[[[[0.7645]], [[0.7442]]], [[[0.6302]], [[0.5986]]]]])
in0Add85472 = tf.constant([[[[0.6521]], [[0.7152]]]])
in1Add85472 = tf.constant([[[[0.0207]], [[0.5533]]]])
in0Con1693 = tf.constant([[[0.0192, 0.9026], [0.0828, 0.085]]])
in0Cro70793 = tf.constant([[[1.1452, 1.7752, 1.3695], [1.1644, 1.0604, 1.8703], [1.4026, 1.4716, 1.3198]]])
in0Sof24229 = tf.constant([[[[0.9217]]]])
in0Con99314 = tf.constant([[[[0.8977, 0.108]], [[0.0696, 0.1112]]]])
in0Con92301 = tf.constant([[[0.1965], [0.9079]]])
in0Up_12525 = tf.constant([[[1.2491, 1.7788, 1.4505, 1.4727], [1.7858, 1.8821, 1.6651, 1.4742]]])
print (np.array2string(model.predict([in0Ave46061,in1Ave46061,in0Add85472,in1Add85472,in0Con1693,in0Cro70793,in0Sof24229,in0Con99314,in0Con92301,in0Up_12525],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub25162.png')

LAve46061 = average_layer([[[[[[0.4663]], [[0.8528]]], [[[0.6513]], [[0.2486]]]]], [[[[[0.7645]], [[0.7442]]], [[[0.6302]], [[0.5986]]]]]], Ave46061), 
LAdd85472 = add_layer([[[[[0.6521]], [[0.7152]]]], [[[[0.0207]], [[0.5533]]]]], Add85472), 
LRes3588 = reshape_layer(Add85472, [2, 1, 1, 1], Res3588), 
LCro85815 = cropping3D_layer(Res3588, 0, 1, 0, 0, 0, 0, Cro85815), 
LZer67604 = zero_padding3D_layer(Cro85815, 1, 0, 1, 0, 0, 0, Zer67604), 
LMin83864 = minimum_layer([Ave46061,Zer67604], Min83864), 
LRes10850 = reshape_layer(Min83864, [2, 2, 1], Res10850), 
LRes96612 = reshape_layer(Res10850, [2, 2], Res96612), 
LCon1693 = concatenate_layer([Res96612,[[[0.0192, 0.9026], [0.0828, 0.085]]]], 2, Con1693), 
LCro70793 = cropping1D_layer([[[1.1452, 1.7752, 1.3695], [1.1644, 1.0604, 1.8703], [1.4026, 1.4716, 1.3198]]], 0, 0, Cro70793), 
LRes94579 = reshape_layer(Cro70793, [3, 3, 1], Res94579), 
LCon19517 = conv2D_layer(Res94579, 2, 3,[[[[0.3576, 0.5137, 0.5454]], [[0.8978, 0.1215, 0.6387]], [[0.391, 0.4966, 0.9629]]], [[[0.6519, 0.2446, 0.4978]], [[0.7487, 0.0486, 0.6585]], [[0.51, 0.4499, 0.9864]]]],[0, 0, 0], 1, 1, false, 1, 1, Con19517), 
LSof24229 = softmax_layer([[[[0.9217]]]], 1, Sof24229), 
LZer44292 = zero_padding2D_layer(Sof24229, 1, 0, 0, 0, Zer44292), 
LCon99314 = concatenate_layer([Zer44292,[[[[0.8977, 0.108]], [[0.0696, 0.1112]]]]], 3, Con99314), 
LAve75270 = average_layer([Con19517,Con99314], Ave75270), 
LRes32247 = reshape_layer(Ave75270, [2, 3], Res32247), 
LCon92301 = concatenate_layer([Res32247,[[[0.1965], [0.9079]]]], 2, Con92301), 
LUp_12525 = up_sampling1D_layer([[[1.2491, 1.7788, 1.4505, 1.4727], [1.7858, 1.8821, 1.6651, 1.4742]]], 1, Up_12525), 
LMax35365 = maximum_layer([Con92301,Up_12525], Max35365), 
LSub25162 = subtract_layer(Con1693,Max35365, Sub25162), 
exec_layers([LAve46061,LAdd85472,LRes3588,LCro85815,LZer67604,LMin83864,LRes10850,LRes96612,LCon1693,LCro70793,LRes94579,LCon19517,LSof24229,LZer44292,LCon99314,LAve75270,LRes32247,LCon92301,LUp_12525,LMax35365,LSub25162],["Ave46061","Add85472","Res3588","Cro85815","Zer67604","Min83864","Res10850","Res96612","Con1693","Cro70793","Res94579","Con19517","Sof24229","Zer44292","Con99314","Ave75270","Res32247","Con92301","Up_12525","Max35365","Sub25162"],Sub25162,"Sub25162")

Actual (Unparsed): [[[-2.5228097, -1.7797827, -3.1347398, -0.5701000], [-2.8944719, -1.4585000, -3.0139834, -1.3892000]]]

Expected (Unparsed): [[[-2.5228097099999998,-1.779782695,-3.1347397549999996,-0.5700999999999999],[-2.8944718600000003,-1.4585000000000001,-3.013983355,-1.3892]]]

Actual:   [[[-2.5228, -1.7797, -3.1347, -0.5701], [-2.8944, -1.4585, -3.0139, -1.3892]]]

Expected: [[[-2.5228, -1.7797, -3.1347, -0.57], [-2.8944, -1.4585, -3.0139, -1.3892]]]