import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer77335 = tf.keras.layers.Input(shape=([4, 3, 1]))

Zer77335 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer77335', )(in0Zer77335)
Mas1011 = keras.layers.Masking(mask_value=1, name = 'Mas1011', )(Zer77335)
Dep44426 = keras.layers.DepthwiseConv2D((3, 2),strides=(1, 1), padding='valid', name = 'Dep44426', )(Mas1011)
Res66447 = keras.layers.Reshape((4, 4, 1, 1), name = 'Res66447', )(Dep44426)
Glo12691 = keras.layers.GlobalAveragePooling3D(name = 'Glo12691', )(Res66447)
model = tf.keras.models.Model(inputs=[in0Zer77335], outputs=Glo12691)
w = model.get_layer('Dep44426').get_weights() 
w[0] = np.array([[[[0.5146]], [[0.9246]]], [[[0.404]], [[0.887]]], [[[0.0663]], [[0.1223]]]])
w[1] = np.array([0])
model.get_layer('Dep44426').set_weights(w) 
in0Zer77335 = tf.constant([[[[1.7474], [1.7473], [1.45]], [[1.077], [1.4361], [1.5399]], [[1.3912], [1.8752], [1.6376]], [[1.797], [1.5806], [1.1544]]]])
print (np.array2string(model.predict([in0Zer77335],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo12691.png')

LZer77335 = zero_padding2D_layer([[[[1.7474], [1.7473], [1.45]], [[1.077], [1.4361], [1.5399]], [[1.3912], [1.8752], [1.6376]], [[1.797], [1.5806], [1.1544]]]], 1, 1, 1, 1, Zer77335), 
LMas1011 = masking_layer(Zer77335, 1, Mas1011), 
LDep44426 = depthwise_conv2D_layer(Mas1011, 3, 2,[[[[0.5146]], [[0.9246]]], [[[0.404]], [[0.887]]], [[[0.0663]], [[0.1223]]]],[0], 1, 1, false, Dep44426), 
LRes66447 = reshape_layer(Dep44426, [4, 4, 1, 1], Res66447), 
LGlo12691 = global_average_pooling3D_layer(Res66447, Glo12691), 
exec_layers([LZer77335,LMas1011,LDep44426,LRes66447,LGlo12691],["Zer77335","Mas1011","Dep44426","Res66447","Glo12691"],Glo12691,"Glo12691")

Actual (Unparsed): [[2.8968287]]

Expected (Unparsed): [[2.89682867125]]

Actual:   [[2.8969]]

Expected: [[2.8969]]