import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add67392 = tf.keras.layers.Input(shape=([1, 1]))
in1Add67392 = tf.keras.layers.Input(shape=([1, 1]))
in0Con28219 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0LST18592 = tf.keras.layers.Input(shape=([1, 1]))
in0Max60223 = tf.keras.layers.Input(shape=([2, 1]))
in1Max60223 = tf.keras.layers.Input(shape=([2, 1]))
in0Con35027 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Sub72822 = tf.keras.layers.Input(shape=([3, 3, 2]))
in1Sub72822 = tf.keras.layers.Input(shape=([3, 3, 2]))

Add67392 = keras.layers.Add(name = 'Add67392', )([in0Add67392,in1Add67392])
Res84028 = keras.layers.Reshape((1, 1, 1), name = 'Res84028', )(Add67392)
Zer96909 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer96909', )(Res84028)
Con28219 = keras.layers.Concatenate(axis=3, name = 'Con28219', )([Zer96909,in0Con28219])
LST18592 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST18592', )(in0LST18592)
Res25188 = keras.layers.Reshape((2, 1), name = 'Res25188', )(LST18592)
Max60223 = keras.layers.Maximum(name = 'Max60223', )([in0Max60223,in1Max60223])
Dot56223 = keras.layers.Dot(axes=(1, 1), name = 'Dot56223', )([Res25188,Max60223])
Res37134 = keras.layers.Reshape((1, 1, 1), name = 'Res37134', )(Dot56223)
Zer43988 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer43988', )(Res37134)
Con35027 = keras.layers.Concatenate(axis=3, name = 'Con35027', )([Zer43988,in0Con35027])
Sub72822 = keras.layers.Subtract(name = 'Sub72822', )([in0Sub72822,in1Sub72822])
Mul17437 = keras.layers.Multiply(name = 'Mul17437', )([Con35027,Sub72822])
Max94964 = keras.layers.Maximum(name = 'Max94964', )([Con28219,Mul17437])
model = tf.keras.models.Model(inputs=[in0Add67392,in1Add67392,in0Con28219,in0LST18592,in0Max60223,in1Max60223,in0Con35027,in0Sub72822,in1Sub72822], outputs=Max94964)
w = model.get_layer('LST18592').get_weights() 
w[0] = np.array([[4, 5, 9, 2, 5, 5, 5, 2]])
w[1] = np.array([[5, 2, 4, 5, 10, 9, 8, 3], [4, 7, 6, 7, 4, 6, 7, 3]])
w[2] = np.array([10, 2, 2, 10, 7, 8, 10, 7])
model.get_layer('LST18592').set_weights(w) 
in0Add67392 = tf.constant([[[0.9322]]])
in1Add67392 = tf.constant([[[0.105]]])
in0Con28219 = tf.constant([[[[0.9394], [0.702], [0.6548]], [[0.6529], [0.6294], [0.4084]], [[0.2756], [0.3195], [0.0179]]]])
in0LST18592 = tf.constant([[[4]]])
in0Max60223 = tf.constant([[[0.7656], [0.9349]]])
in1Max60223 = tf.constant([[[0.8362], [0.2061]]])
in0Con35027 = tf.constant([[[[0.6718], [0.1975], [0.981]], [[0.8052], [0.7269], [0.8535]], [[0.0532], [0.1729], [0.9914]]]])
in0Sub72822 = tf.constant([[[[0.0943, 0.2723], [0.7601, 0.9028], [0.609, 0.9087]], [[0.7562, 0.859], [0.3658, 0.2162], [0.3214, 0.9748]], [[0.4496, 0.6404], [0.4727, 0.4919], [0.1204, 0.566]]]])
in1Sub72822 = tf.constant([[[[0.2741, 0.2612], [0.3162, 0.2059], [0.0699, 0.4098]], [[0.5322, 0.3447], [0.6183, 0.5871], [0.0734, 0.9094]], [[0.6821, 0.1261], [0.6852, 0.7612], [0.5379, 0.3933]]]])
print (np.array2string(model.predict([in0Add67392,in1Add67392,in0Con28219,in0LST18592,in0Max60223,in1Max60223,in0Con35027,in0Sub72822,in1Sub72822],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max94964.png')

LAdd67392 = add_layer([[[[0.9322]]], [[[0.105]]]], Add67392), 
LRes84028 = reshape_layer(Add67392, [1, 1, 1], Res84028), 
LZer96909 = zero_padding2D_layer(Res84028, 2, 0, 2, 0, Zer96909), 
LCon28219 = concatenate_layer([Zer96909,[[[[0.9394], [0.702], [0.6548]], [[0.6529], [0.6294], [0.4084]], [[0.2756], [0.3195], [0.0179]]]]], 3, Con28219), 
LLST18592 = lstm_layer([[[4]]],[[4, 5, 9, 2, 5, 5, 5, 2]],[[5, 2, 4, 5, 10, 9, 8, 3], [4, 7, 6, 7, 4, 6, 7, 3]],[10, 2, 2, 10, 7, 8, 10, 7], LST18592), 
LRes25188 = reshape_layer(LST18592, [2, 1], Res25188), 
LMax60223 = maximum_layer([[[[0.7656], [0.9349]]], [[[0.8362], [0.2061]]]], Max60223), 
LDot56223 = dot_layer(Res25188,Max60223, 1, 1, Dot56223), 
LRes37134 = reshape_layer(Dot56223, [1, 1, 1], Res37134), 
LZer43988 = zero_padding2D_layer(Res37134, 2, 0, 2, 0, Zer43988), 
LCon35027 = concatenate_layer([Zer43988,[[[[0.6718], [0.1975], [0.981]], [[0.8052], [0.7269], [0.8535]], [[0.0532], [0.1729], [0.9914]]]]], 3, Con35027), 
LSub72822 = subtract_layer([[[[0.0943, 0.2723], [0.7601, 0.9028], [0.609, 0.9087]], [[0.7562, 0.859], [0.3658, 0.2162], [0.3214, 0.9748]], [[0.4496, 0.6404], [0.4727, 0.4919], [0.1204, 0.566]]]], [[[[0.2741, 0.2612], [0.3162, 0.2059], [0.0699, 0.4098]], [[0.5322, 0.3447], [0.6183, 0.5871], [0.0734, 0.9094]], [[0.6821, 0.1261], [0.6852, 0.7612], [0.5379, 0.3933]]]], Sub72822), 
LMul17437 = multiply_layer([Con35027,Sub72822], Mul17437), 
LMax94964 = maximum_layer([Con28219,Mul17437], Max94964), 
exec_layers([LAdd67392,LRes84028,LZer96909,LCon28219,LLST18592,LRes25188,LMax60223,LDot56223,LRes37134,LZer43988,LCon35027,LSub72822,LMul17437,LMax94964],["Add67392","Res84028","Zer96909","Con28219","LST18592","Res25188","Max60223","Dot56223","Res37134","Zer43988","Con35027","Sub72822","Mul17437","Max94964"],Max94964,"Max94964")

Actual (Unparsed): [[[[-0.0000000, 0.9394000], [0.0000000, 0.7020000], [0.0000000, 0.6548000]], [[0.0000000, 0.6529000], [-0.0000000, 0.6294000], [0.0000000, 0.4084000]], [[-0.0000000, 0.2756000], [-0.0000000, 0.3195000], [1.0372000, 0.1712148]]]]

Expected (Unparsed): [[[[0,0.9394],[0,0.702],[0,0.6548]],[[0,0.6529],[0,0.6294],[0,0.4084]],[[0,0.2756],[0,0.3195],[1.0372000000000001,0.17121477999999996]]]]

Actual:   [[[[-0, 0.9394], [0, 0.702], [0, 0.6548]], [[0, 0.6529], [-0, 0.6294], [0, 0.4084]], [[-0, 0.2756], [-0, 0.3195], [1.0372, 0.1713]]]]

Expected: [[[[0, 0.9394], [0, 0.702], [0, 0.6548]], [[0, 0.6529], [0, 0.6294], [0, 0.4084]], [[0, 0.2756], [0, 0.3195], [1.0373, 0.1713]]]]