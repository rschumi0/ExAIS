import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min88110 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min88110 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con38973 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Max40381 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Max40381 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Min88110 = keras.layers.Minimum(name = 'Min88110', )([in0Min88110,in1Min88110])
Con26020 = keras.layers.Conv2D(2, (2, 1),strides=(1, 11), padding='same', dilation_rate=(1, 1), name = 'Con26020', )(Min88110)
Res53888 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res53888', )(Con26020)
Con38973 = keras.layers.Concatenate(axis=4, name = 'Con38973', )([Res53888,in0Con38973])
Max40381 = keras.layers.Maximum(name = 'Max40381', )([in0Max40381,in1Max40381])
Zer30900 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer30900', )(Max40381)
Add69641 = keras.layers.Add(name = 'Add69641', )([Con38973,Zer30900])
model = tf.keras.models.Model(inputs=[in0Min88110,in1Min88110,in0Con38973,in0Max40381,in1Max40381], outputs=Add69641)
w = model.get_layer('Con26020').get_weights() 
w[0] = np.array([[[[0.0241, 0.3498]]], [[[0.4228, 0.8115]]]])
w[1] = np.array([0, 0])
model.get_layer('Con26020').set_weights(w) 
in0Min88110 = tf.constant([[[[0.9076], [0.1737]], [[0.6289], [0.6354]]]])
in1Min88110 = tf.constant([[[[0.8567], [0.625]], [[0.6564], [0.9621]]]])
in0Con38973 = tf.constant([[[[[0.4997], [0.8831]]], [[[0.7571], [0.8673]]]]])
in0Max40381 = tf.constant([[[[[0.9615, 0.8739]]]]])
in1Max40381 = tf.constant([[[[[0.1355, 0.4885]]]]])
print (np.array2string(model.predict([in0Min88110,in1Min88110,in0Con38973,in0Max40381,in1Max40381],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add69641.png')

LMin88110 = minimum_layer([[[[[0.9076], [0.1737]], [[0.6289], [0.6354]]]], [[[[0.8567], [0.625]], [[0.6564], [0.9621]]]]], Min88110), 
LCon26020 = conv2D_layer(Min88110, 2, 1,[[[[0.0241, 0.3498]]], [[[0.4228, 0.8115]]]],[0, 0], 1, 11, true, 1, 1, Con26020), 
LRes53888 = reshape_layer(Con26020, [2, 1, 2, 1], Res53888), 
LCon38973 = concatenate_layer([Res53888,[[[[[0.4997], [0.8831]]], [[[0.7571], [0.8673]]]]]], 4, Con38973), 
LMax40381 = maximum_layer([[[[[[0.9615, 0.8739]]]]], [[[[[0.1355, 0.4885]]]]]], Max40381), 
LZer30900 = zero_padding3D_layer(Max40381, 1, 0, 0, 0, 1, 0, Zer30900), 
LAdd69641 = add_layer([Con38973,Zer30900], Add69641), 
exec_layers([LMin88110,LCon26020,LRes53888,LCon38973,LMax40381,LZer30900,LAdd69641],["Min88110","Con26020","Res53888","Con38973","Max40381","Zer30900","Add69641"],Add69641,"Add69641")

Actual (Unparsed): [[[[[0.2865454, 0.4997000], [0.8100260, 0.8831000]]], [[[0.0151565, 0.7571000], [1.1814892, 1.7412000]]]]]

Expected (Unparsed): [[[[[0.28654539,0.4997],[0.8100260100000001,0.8831]]],[[[0.01515649,0.7571],[1.18148922,1.7412]]]]]

Actual:   [[[[[0.2866, 0.4997], [0.8101, 0.8831]]], [[[0.0152, 0.7571], [1.1815, 1.7412]]]]]

Expected: [[[[[0.2866, 0.4997], [0.8101, 0.8831]]], [[[0.0152, 0.7571], [1.1815, 1.7412]]]]]