import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo66043 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Glo66043 = keras.layers.GlobalAveragePooling3D(name = 'Glo66043', )(in0Glo66043)
Res68402 = keras.layers.Reshape((1, 1), name = 'Res68402', )(Glo66043)
Glo5025 = keras.layers.GlobalMaxPool1D(name = 'Glo5025', )(Res68402)
Res66489 = keras.layers.Reshape((1, 1), name = 'Res66489', )(Glo5025)
Res28551 = keras.layers.Reshape((1, 1, 1), name = 'Res28551', )(Res66489)
Res22231 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res22231', )(Res28551)
Zer17541 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer17541', )(Res22231)
Res57987 = keras.layers.Reshape((3, 3, 3), name = 'Res57987', )(Zer17541)
Res17661 = keras.layers.Reshape((3, 9), name = 'Res17661', )(Res57987)
Con46677 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con46677', )(Res17661)
model = tf.keras.models.Model(inputs=[in0Glo66043], outputs=Con46677)
w = model.get_layer('Con46677').get_weights() 
w[0] = np.array([[[0.1175, 0.0345, 0.9772, 0.8016], [0.63, 0.2611, 0.7369, 0.5404], [0.1051, 0.3032, 0.4347, 0.3067], [0.8598, 0.1179, 0.1214, 0.7923], [0.135, 0.2679, 0.2339, 0.9703], [0.5103, 0.3686, 0.8849, 0.6837], [0.8697, 0.6176, 0.4196, 0.3417], [0.8946, 0.3277, 0.4666, 0.1995], [0.4459, 0.1843, 0.9842, 0.0065]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con46677').set_weights(w) 
in0Glo66043 = tf.constant([[[[[1.3676], [1.1222]], [[1.7534], [1.3368]]], [[[1.9459], [1.4097]], [[1.8793], [1.9181]]]]])
print (np.array2string(model.predict([in0Glo66043],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con46677.png')

LGlo66043 = global_average_pooling3D_layer([[[[[1.3676], [1.1222]], [[1.7534], [1.3368]]], [[[1.9459], [1.4097]], [[1.8793], [1.9181]]]]], Glo66043), 
LRes68402 = reshape_layer(Glo66043, [1, 1], Res68402), 
LGlo5025 = global_max_pool1D_layer(Res68402, Glo5025), 
LRes66489 = reshape_layer(Glo5025, [1, 1], Res66489), 
LRes28551 = reshape_layer(Res66489, [1, 1, 1], Res28551), 
LRes22231 = reshape_layer(Res28551, [1, 1, 1, 1], Res22231), 
LZer17541 = zero_padding3D_layer(Res22231, 1, 1, 1, 1, 1, 1, Zer17541), 
LRes57987 = reshape_layer(Zer17541, [3, 3, 3], Res57987), 
LRes17661 = reshape_layer(Res57987, [3, 9], Res17661), 
LCon46677 = conv1D_layer(Res17661, 1,[[[0.1175, 0.0345, 0.9772, 0.8016], [0.63, 0.2611, 0.7369, 0.5404], [0.1051, 0.3032, 0.4347, 0.3067], [0.8598, 0.1179, 0.1214, 0.7923], [0.135, 0.2679, 0.2339, 0.9703], [0.5103, 0.3686, 0.8849, 0.6837], [0.8697, 0.6176, 0.4196, 0.3417], [0.8946, 0.3277, 0.4666, 0.1995], [0.4459, 0.1843, 0.9842, 0.0065]]],[0, 0, 0, 0], 1, false, 1, Con46677), 
exec_layers([LGlo66043,LRes68402,LGlo5025,LRes66489,LRes28551,LRes22231,LZer17541,LRes57987,LRes17661,LCon46677],["Glo66043","Res68402","Glo5025","Res66489","Res28551","Res22231","Zer17541","Res57987","Res17661","Con46677"],Con46677,"Con46677")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.2148694, 0.4263963, 0.3722811, 1.5443537], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.0],[0.21486937500000003,0.42639633750000006,0.3722810875,1.5443537375],[0.0,0.0,0.0,0.0]]]

Actual:   [[[0, 0, 0, 0], [0.2149, 0.4264, 0.3723, 1.5444], [0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0], [0.2149, 0.4264, 0.3723, 1.5444], [0, 0, 0, 0]]]