import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo8349 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Glo8349 = keras.layers.GlobalAveragePooling3D(name = 'Glo8349', )(in0Glo8349)
Res620 = keras.layers.Reshape((2, 1), name = 'Res620', )(Glo8349)
Sep63168 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep63168', )(Res620)
Res95011 = keras.layers.Reshape((2, 4, 1), name = 'Res95011', )(Sep63168)
Res6064 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res6064', )(Res95011)
Con22924 = keras.layers.Conv3D(3, (2, 1, 1),strides=(2, 3, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con22924', )(Res6064)
Res90097 = keras.layers.Reshape((1, 2, 3), name = 'Res90097', )(Con22924)
Glo33554 = keras.layers.GlobalAveragePooling2D(name = 'Glo33554', )(Res90097)
Res75442 = keras.layers.Reshape((3, 1), name = 'Res75442', )(Glo33554)
Res59356 = keras.layers.Reshape((3, 1, 1), name = 'Res59356', )(Res75442)
Sep20050 = keras.layers.SeparableConv2D(4, (1, 1),strides=(3, 3), padding='same', name = 'Sep20050', )(Res59356)
model = tf.keras.models.Model(inputs=[in0Glo8349], outputs=Sep20050)
w = model.get_layer('Sep63168').get_weights() 
w[0] = np.array([[[0.4945]]])
w[1] = np.array([[[0.7287, 0.2943, 0.9745, 0.5108]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep63168').set_weights(w) 
w = model.get_layer('Con22924').get_weights() 
w[0] = np.array([[[[[0.6612, 0.0756, 0.5286]]]], [[[[0.257, 0.4608, 0.0957]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con22924').set_weights(w) 
w = model.get_layer('Sep20050').get_weights() 
w[0] = np.array([[[[0.7698]]]])
w[1] = np.array([[[[0.7638, 0.8456, 0.0944, 0.5062]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep20050').set_weights(w) 
in0Glo8349 = tf.constant([[[[[1.1974, 1.158], [1.0461, 1.9401]]]]])
print (np.array2string(model.predict([in0Glo8349],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep20050.png')

LGlo8349 = global_average_pooling3D_layer([[[[[1.1974, 1.158], [1.0461, 1.9401]]]]], Glo8349), 
LRes620 = reshape_layer(Glo8349, [2, 1], Res620), 
LSep63168 = separable_conv1D_layer(Res620, 1,[[[[0.4945]]],[[[0.7287, 0.2943, 0.9745, 0.5108]]]],[0, 0, 0, 0], 1, false, Sep63168), 
LRes95011 = reshape_layer(Sep63168, [2, 4, 1], Res95011), 
LRes6064 = reshape_layer(Res95011, [2, 4, 1, 1], Res6064), 
LCon22924 = conv3D_layer(Res6064, 2, 1, 1,[[[[[0.6612, 0.0756, 0.5286]]]], [[[[0.257, 0.4608, 0.0957]]]]],[0, 0, 0], 2, 3, 1, true, 1, 1, 1, Con22924), 
LRes90097 = reshape_layer(Con22924, [1, 2, 3], Res90097), 
LGlo33554 = global_average_pooling2D_layer(Res90097, Glo33554), 
LRes75442 = reshape_layer(Glo33554, [3, 1], Res75442), 
LRes59356 = reshape_layer(Res75442, [3, 1, 1], Res59356), 
LSep20050 = separable_conv2D_layer(Res59356, 1, 1,[[[[[0.7698]]]],[[[[0.7638, 0.8456, 0.0944, 0.5062]]]]],[0, 0, 0, 0], 3, 3, true, Sep20050), 
exec_layers([LGlo8349,LRes620,LSep63168,LRes95011,LRes6064,LCon22924,LRes90097,LGlo33554,LRes75442,LRes59356,LSep20050],["Glo8349","Res620","Sep63168","Res95011","Res6064","Con22924","Res90097","Glo33554","Res75442","Res59356","Sep20050"],Sep20050,"Sep20050")

Actual (Unparsed): [[[[0.2053864, 0.2273825, 0.0253842, 0.1361176]]]]

Expected (Unparsed): [[[[0.20538640484717663,0.22738248748202744,0.025384232282761814,0.13611756760099608]]]]

Actual:   [[[[0.2054, 0.2274, 0.0254, 0.1362]]]]

Expected: [[[[0.2054, 0.2274, 0.0254, 0.1362]]]]