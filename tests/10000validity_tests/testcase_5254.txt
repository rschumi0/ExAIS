import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot58746 = tf.keras.layers.Input(shape=([3]))
in1Dot58746 = tf.keras.layers.Input(shape=([3]))

Dot58746 = keras.layers.Dot(axes=(1, 1), name = 'Dot58746', )([in0Dot58746,in1Dot58746])
Res97715 = keras.layers.Reshape((1, 1), name = 'Res97715', )(Dot58746)
Glo67640 = keras.layers.GlobalMaxPool1D(name = 'Glo67640', )(Res97715)
Bat77363 = keras.layers.BatchNormalization(axis=1, epsilon=0.5784107822283281,  name = 'Bat77363', )(Glo67640)
Res59383 = keras.layers.Reshape((1, 1), name = 'Res59383', )(Bat77363)
Sim859 = keras.layers.SimpleRNN(1,name = 'Sim859', )(Res59383)
model = tf.keras.models.Model(inputs=[in0Dot58746,in1Dot58746], outputs=Sim859)
w = model.get_layer('Bat77363').get_weights() 
w[0] = np.array([0.9951])
w[1] = np.array([0.7039])
w[2] = np.array([0.6276])
w[3] = np.array([0.8182])
model.get_layer('Bat77363').set_weights(w) 
w = model.get_layer('Sim859').get_weights() 
w[0] = np.array([[4]])
w[1] = np.array([[10]])
w[2] = np.array([7])
model.get_layer('Sim859').set_weights(w) 
in0Dot58746 = tf.constant([[0.0615, 0.9201, 0.0115]])
in1Dot58746 = tf.constant([[0.5069, 0.02, 0.3165]])
print (np.array2string(model.predict([in0Dot58746,in1Dot58746],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim859.png')

LDot58746 = dot_layer([[0.0615, 0.9201, 0.0115]], [[0.5069, 0.02, 0.3165]], 1, 1, Dot58746), 
LRes97715 = reshape_layer(Dot58746, [1, 1], Res97715), 
LGlo67640 = global_max_pool1D_layer(Res97715, Glo67640), 
LBat77363 = batch_normalization_layer(Glo67640, 1, 0.5784107822283281, [0.9951], [0.7039], [0.6276], [0.8182], Bat77363), 
LRes59383 = reshape_layer(Bat77363, [1, 1], Res59383), 
LSim859 = simple_rnn_layer(Res59383,[[4]],[[10]],[7], Sim859), 
exec_layers([LDot58746,LRes97715,LGlo67640,LBat77363,LRes59383,LSim859],["Dot58746","Res97715","Glo67640","Bat77363","Res59383","Sim859"],Sim859,"Sim859")

Actual (Unparsed): [[0.9999997]]

Expected (Unparsed): [[0.9999997144509728]]

Actual:   [[1]]

Expected: [[1]]