import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add82137 = tf.keras.layers.Input(shape=([2, 1]))
in1Add82137 = tf.keras.layers.Input(shape=([2, 1]))
in0Con96000 = tf.keras.layers.Input(shape=([11, 7, 1]))
in0Up_48779 = tf.keras.layers.Input(shape=([4, 4]))

Add82137 = keras.layers.Add(name = 'Add82137', )([in0Add82137,in1Add82137])
Res44505 = keras.layers.Reshape((2, 1, 1), name = 'Res44505', )(Add82137)
Zer7254 = keras.layers.ZeroPadding2D(padding=((9, 0), (6, 0)), name = 'Zer7254', )(Res44505)
Con96000 = keras.layers.Concatenate(axis=3, name = 'Con96000', )([Zer7254,in0Con96000])
Up_48779 = keras.layers.UpSampling1D(size=(2), name = 'Up_48779', )(in0Up_48779)
Res15629 = keras.layers.Reshape((8, 4, 1), name = 'Res15629', )(Up_48779)
Con36783 = keras.layers.Conv2DTranspose(2, (4, 4),strides=(1, 1), padding='valid', name = 'Con36783', )(Res15629)
Ave23809 = keras.layers.Average(name = 'Ave23809', )([Con96000,Con36783])
model = tf.keras.models.Model(inputs=[in0Add82137,in1Add82137,in0Con96000,in0Up_48779], outputs=Ave23809)
w = model.get_layer('Con36783').get_weights() 
w[0] = np.array([[[[0.9725], [0.9442]], [[0.8567], [0.5335]], [[0.2147], [0.3749]], [[0.5409], [0.2177]]], [[[0.3835], [0.2141]], [[0.6339], [0.6121]], [[0.8726], [0.5893]], [[0.0177], [0.8215]]], [[[0.3121], [0.8204]], [[0.5509], [0.4126]], [[0.0479], [0.7019]], [[0.3079], [0.7821]]], [[[0.5149], [0.4818]], [[0.565], [0.7686]], [[0.4283], [0.6472]], [[0.5683], [0.6051]]]])
w[1] = np.array([0, 0])
model.get_layer('Con36783').set_weights(w) 
in0Add82137 = tf.constant([[[0.924], [0.4923]]])
in1Add82137 = tf.constant([[[0.44], [0.3229]]])
in0Con96000 = tf.constant([[[[0.4957], [0.2338], [0.7269], [0.152], [0.9321], [0.7985], [0.8607]], [[0.0088], [0.564], [0.3259], [0.9468], [0.697], [0.7189], [0.8679]], [[0.6874], [0.6535], [0.5413], [0.5283], [0.9155], [0.6286], [0.2981]], [[0.5308], [0.1131], [0.0851], [0.3164], [0.1776], [0.9684], [0.8589]], [[0.2644], [0.6309], [0.3317], [0.4019], [0.047], [0.3005], [0.1293]], [[0.0422], [0.668], [0.2391], [0.0202], [0.0824], [0.0359], [0.3616]], [[0.841], [0.2361], [0.8343], [0.4873], [0.1731], [0.8503], [0.2612]], [[0.1768], [0.6875], [0.6035], [0.6534], [0.0857], [0.2761], [0.8789]], [[0.7534], [0.0892], [0.3618], [0.8164], [0.6543], [0.7446], [0.1941]], [[0.1211], [0.2593], [0.7554], [0.3835], [0.0702], [0.4327], [0.9742]], [[0.4064], [0.7988], [0.8864], [0.1402], [0.3196], [0.8702], [0.2455]]]])
in0Up_48779 = tf.constant([[[1.8507, 1.8405, 1.719, 1.4753], [1.674, 1.3642, 1.7112, 1.4249], [1.4656, 1.4442, 1.0301, 1.4924], [1.866, 1.1272, 1.5849, 1.1568]]])
print (np.array2string(model.predict([in0Add82137,in1Add82137,in0Con96000,in0Up_48779],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave23809.png')

LAdd82137 = add_layer([[[[0.924], [0.4923]]], [[[0.44], [0.3229]]]], Add82137), 
LRes44505 = reshape_layer(Add82137, [2, 1, 1], Res44505), 
LZer7254 = zero_padding2D_layer(Res44505, 9, 0, 6, 0, Zer7254), 
LCon96000 = concatenate_layer([Zer7254,[[[[0.4957], [0.2338], [0.7269], [0.152], [0.9321], [0.7985], [0.8607]], [[0.0088], [0.564], [0.3259], [0.9468], [0.697], [0.7189], [0.8679]], [[0.6874], [0.6535], [0.5413], [0.5283], [0.9155], [0.6286], [0.2981]], [[0.5308], [0.1131], [0.0851], [0.3164], [0.1776], [0.9684], [0.8589]], [[0.2644], [0.6309], [0.3317], [0.4019], [0.047], [0.3005], [0.1293]], [[0.0422], [0.668], [0.2391], [0.0202], [0.0824], [0.0359], [0.3616]], [[0.841], [0.2361], [0.8343], [0.4873], [0.1731], [0.8503], [0.2612]], [[0.1768], [0.6875], [0.6035], [0.6534], [0.0857], [0.2761], [0.8789]], [[0.7534], [0.0892], [0.3618], [0.8164], [0.6543], [0.7446], [0.1941]], [[0.1211], [0.2593], [0.7554], [0.3835], [0.0702], [0.4327], [0.9742]], [[0.4064], [0.7988], [0.8864], [0.1402], [0.3196], [0.8702], [0.2455]]]]], 3, Con96000), 
LUp_48779 = up_sampling1D_layer([[[1.8507, 1.8405, 1.719, 1.4753], [1.674, 1.3642, 1.7112, 1.4249], [1.4656, 1.4442, 1.0301, 1.4924], [1.866, 1.1272, 1.5849, 1.1568]]], 2, Up_48779), 
LRes15629 = reshape_layer(Up_48779, [8, 4, 1], Res15629), 
LCon36783 = conv2D_transpose_layer(Res15629, 4, 4,[[[[0.9725], [0.9442]], [[0.8567], [0.5335]], [[0.2147], [0.3749]], [[0.5409], [0.2177]]], [[[0.3835], [0.2141]], [[0.6339], [0.6121]], [[0.8726], [0.5893]], [[0.0177], [0.8215]]], [[[0.3121], [0.8204]], [[0.5509], [0.4126]], [[0.0479], [0.7019]], [[0.3079], [0.7821]]], [[[0.5149], [0.4818]], [[0.565], [0.7686]], [[0.4283], [0.6472]], [[0.5683], [0.6051]]]],[0, 0], 1, 1, false, Con36783), 
LAve23809 = average_layer([Con96000,Con36783], Ave23809), 
exec_layers([LAdd82137,LRes44505,LZer7254,LCon96000,LUp_48779,LRes15629,LCon36783,LAve23809],["Add82137","Res44505","Zer7254","Con96000","Up_48779","Res15629","Con36783","Ave23809"],Ave23809,"Ave23809")

Actual (Unparsed): [[[[0.8999029, 1.1215655], [1.6876905, 1.4794743], [1.8229146, 2.0128570], [2.1517977, 1.7774828], [1.3142426, 1.3821512], [0.6232770, 0.8629081], [0.3989949, 0.5909364]], [[1.2547746, 1.0762329], [2.6271857, 2.4080066], [3.5433397, 3.1049697], [3.7989124, 4.1613919], [2.5481270, 2.9786055], [1.2821635, 1.9638845], [0.4120513, 1.2005159]], [[1.4576560, 2.0912700], [3.1168807, 3.3175331], [4.1360950, 4.7831440], [4.7048593, 6.1471887], [3.1277720, 4.6484689], [1.5746171, 3.0984095], [0.6255431, 1.4870459]], [[1.9002365, 2.4398879], [3.9662046, 4.0968666], [5.2653671, 6.0766705], [6.2688024, 7.9920614], [4.4120535, 5.7462250], [2.3569479, 4.2477458], [1.0443035, 2.1930961]], [[1.7713279, 2.1358199], [3.7928379, 4.1061125], [4.8094325, 5.6972255], [5.9134776, 7.6187672], [4.3020912, 5.3805744], [2.1775826, 3.8315729], [1.0547998, 1.8159346]], [[1.6858758, 1.9598437], [3.5695843, 3.8867992], [4.4388595, 5.2989915], [5.5762178, 6.9419340], [3.8757804, 5.0851093], [2.1879956, 3.4207307], [1.0410760, 1.9445617]], [[1.8480495, 2.4627868], [3.5420346, 3.6178233], [4.5265862, 5.5129866], [5.5176964, 6.9829608], [3.7204478, 4.9166071], [2.1987759, 3.5827574], [0.9607046, 1.8842276]], [[1.8711736, 2.1233461], [3.5698797, 3.8713147], [4.5098124, 5.2771668], [5.2773076, 6.9882923], [3.7492764, 4.6332010], [1.8781842, 3.2404332], [0.9769147, 2.0756520]], [[1.0263135, 1.6949516], [2.2832999, 2.4948272], [3.0648520, 4.0603254], [3.5647558, 5.7086045], [2.6508151, 4.1906493], [1.4027393, 3.1845003], [0.6123925, 1.4760979]], [[0.7715910, 1.2755026], [1.5072319, 1.9656296], [1.7285720, 3.3340631], [2.4485127, 3.9355949], [1.5166276, 2.5692263], [0.9697788, 2.0959561], [1.1887941, 1.2894565]], [[0.4804017, 0.6527194], [0.8173427, 1.3880463], [1.1260704, 1.8620230], [1.5171662, 1.8871704], [0.9864962, 1.4582663], [0.6980781, 1.2889520], [0.7363047, 0.4727398]]]]

Expected (Unparsed): [[[[0.899902875,1.12156547],[1.6876904700000002,1.479474275],[1.82291457,2.01285699],[2.1517977650000004,1.7774828],[1.31424263,1.38215125],[0.623277005,0.8629081350000001],[0.3989948850000001,0.590936405]],[[1.2547746,1.076232905],[2.62718571,2.4080065349999997],[3.5433397050000006,3.1049697199999997],[3.7989124350000005,4.161391965],[2.5481270900000004,2.9786055399999998],[1.282163545,1.9638845300000003],[0.41205129000000007,1.20051588]],[[1.4576559599999999,2.091269975],[3.1168807299999997,3.31753309],[4.136095045,4.7831440149999995],[4.7048593400000005,6.147188715],[3.1277719950000002,4.64846894],[1.5746170800000003,3.0984095050000002],[0.6255430450000001,1.487045905]],[[1.90023645,2.43988787],[3.966204614999999,4.0968666],[5.265367105,6.076670525000001],[6.268802410000001,7.992061440000002],[4.412053495,5.746224990000001],[2.3569478750000004,4.247745825],[1.0443035,2.1930961200000003]],[[1.771327915,2.13581989],[3.7928378449999998,4.1061124300000005],[4.8094325,5.697225520000001],[5.913477540000001,7.618767185],[4.302091160000001,5.380574375],[2.177582615,3.831572895],[1.054799795,1.815934575]],[[1.6858758000000003,1.95984364],[3.56958428,3.8867991299999995],[4.4388594900000005,5.298991475000001],[5.5762177500000005,6.94193394],[3.8757803400000004,5.08510927],[2.1879956000000003,3.4207306149999996],[1.04107601,1.94456168]],[[1.8480494800000002,2.4627868000000004],[3.54203459,3.61782321],[4.5265861450000004,5.512986585],[5.51769626,6.9829607199999995],[3.7204477400000004,4.9166069850000005],[2.1987758800000003,3.582757345],[0.960704615,1.8842274949999998]],[[1.8711736,2.1233460600000003],[3.56987962,3.8713146600000004],[4.50981236,5.277166705],[5.277307525,6.988292129999998],[3.749276295000001,4.6332009649999994],[1.8781841400000001,3.2404330999999997],[0.9769146800000001,2.07565192]],[[1.02631352,1.6949515400000001],[2.28329985,2.4948271600000003],[3.064851985,4.060325355],[3.5647557,5.708604424999999],[2.6508150500000003,4.19064927],[1.402739295,3.184500295],[0.6123925,1.47609786]],[[0.771591,1.2755026000000003],[1.5072318999999998,1.96562952],[1.72857199,3.33406301],[2.448512675,3.9355947799999997],[1.5166275699999998,2.569226295],[0.96977877,2.0959560799999997],[1.18879408,1.2894564800000001]],[[0.48040170000000004,0.6527194000000001],[0.81734264,1.38804628],[1.1260704049999999,1.86202297],[1.51716619,1.88717041],[0.986496215,1.45826624],[0.6980780550000001,1.288951975],[0.73630472,0.47273984]]]]

Actual:   [[[[0.9, 1.1216], [1.6877, 1.4795], [1.823, 2.0129], [2.1518, 1.7775], [1.3143, 1.3822], [0.6233, 0.863], [0.399, 0.591]], [[1.2548, 1.0763], [2.6272, 2.4081], [3.5434, 3.105], [3.799, 4.1614], [2.5482, 2.9787], [1.2822, 1.9639], [0.4121, 1.2006]], [[1.4577, 2.0913], [3.1169, 3.3176], [4.1361, 4.7832], [4.7049, 6.1472], [3.1278, 4.6485], [1.5747, 3.0985], [0.6256, 1.4871]], [[1.9003, 2.4399], [3.9663, 4.0969], [5.2654, 6.0767], [6.2689, 7.9921], [4.4121, 5.7463], [2.357, 4.2478], [1.0444, 2.1931]], [[1.7714, 2.1359], [3.7929, 4.1062], [4.8095, 5.6973], [5.9135, 7.6188], [4.3021, 5.3806], [2.1776, 3.8316], [1.0548, 1.816]], [[1.6859, 1.9599], [3.5696, 3.8868], [4.4389, 5.299], [5.5763, 6.942], [3.8758, 5.0852], [2.188, 3.4208], [1.0411, 1.9446]], [[1.8481, 2.4628], [3.5421, 3.6179], [4.5266, 5.513], [5.5177, 6.983], [3.7205, 4.9167], [2.1988, 3.5828], [0.9608, 1.8843]], [[1.8712, 2.1234], [3.5699, 3.8714], [4.5099, 5.2772], [5.2774, 6.9883], [3.7493, 4.6333], [1.8782, 3.2405], [0.977, 2.0757]], [[1.0264, 1.695], [2.2833, 2.4949], [3.0649, 4.0604], [3.5648, 5.7087], [2.6509, 4.1907], [1.4028, 3.1846], [0.6124, 1.4761]], [[0.7716, 1.2756], [1.5073, 1.9657], [1.7286, 3.3341], [2.4486, 3.9356], [1.5167, 2.5693], [0.9698, 2.096], [1.1888, 1.2895]], [[0.4805, 0.6528], [0.8174, 1.3881], [1.1261, 1.8621], [1.5172, 1.8872], [0.9865, 1.4583], [0.6981, 1.289], [0.7364, 0.4728]]]]

Expected: [[[[0.9, 1.1216], [1.6877, 1.4795], [1.823, 2.0129], [2.1518, 1.7775], [1.3143, 1.3822], [0.6233, 0.863], [0.399, 0.591]], [[1.2548, 1.0763], [2.6272, 2.4081], [3.5434, 3.105], [3.799, 4.1614], [2.5482, 2.9787], [1.2822, 1.9639], [0.4121, 1.2006]], [[1.4577, 2.0913], [3.1169, 3.3176], [4.1361, 4.7832], [4.7049, 6.1472], [3.1278, 4.6485], [1.5747, 3.0985], [0.6256, 1.4871]], [[1.9003, 2.4399], [3.9663, 4.0969], [5.2654, 6.0767], [6.2689, 7.9921], [4.4121, 5.7463], [2.357, 4.2478], [1.0444, 2.1931]], [[1.7714, 2.1359], [3.7929, 4.1062], [4.8095, 5.6973], [5.9135, 7.6188], [4.3021, 5.3806], [2.1776, 3.8316], [1.0548, 1.816]], [[1.6859, 1.9599], [3.5696, 3.8868], [4.4389, 5.299], [5.5763, 6.942], [3.8758, 5.0852], [2.188, 3.4208], [1.0411, 1.9446]], [[1.8481, 2.4628], [3.5421, 3.6179], [4.5266, 5.513], [5.5177, 6.983], [3.7205, 4.9167], [2.1988, 3.5828], [0.9608, 1.8843]], [[1.8712, 2.1234], [3.5699, 3.8714], [4.5099, 5.2772], [5.2774, 6.9883], [3.7493, 4.6333], [1.8782, 3.2405], [0.977, 2.0757]], [[1.0264, 1.695], [2.2833, 2.4949], [3.0649, 4.0604], [3.5648, 5.7087], [2.6509, 4.1907], [1.4028, 3.1846], [0.6124, 1.4761]], [[0.7716, 1.2756], [1.5073, 1.9657], [1.7286, 3.3341], [2.4486, 3.9356], [1.5167, 2.5693], [0.9698, 2.096], [1.1888, 1.2895]], [[0.4805, 0.6528], [0.8174, 1.3881], [1.1261, 1.8621], [1.5172, 1.8872], [0.9865, 1.4583], [0.6981, 1.289], [0.7364, 0.4728]]]]