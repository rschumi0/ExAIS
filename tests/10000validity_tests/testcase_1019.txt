import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer64202 = tf.keras.layers.Input(shape=([2, 4]))
in0Con33210 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Ave45106 = tf.keras.layers.Input(shape=([2, 1, 2]))

Zer64202 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer64202', )(in0Zer64202)
ELU61544 = keras.layers.ELU(alpha=2.4208829650010557, name = 'ELU61544', )(Zer64202)
LST92272 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST92272', )(ELU61544)
Res95485 = keras.layers.Reshape((2, 1), name = 'Res95485', )(LST92272)
Res49297 = keras.layers.Reshape((2, 1, 1), name = 'Res49297', )(Res95485)
Con33210 = keras.layers.Concatenate(axis=3, name = 'Con33210', )([Res49297,in0Con33210])
Ave45106 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='valid', name = 'Ave45106', )(in0Ave45106)
Mul86435 = keras.layers.Multiply(name = 'Mul86435', )([Con33210,Ave45106])
model = tf.keras.models.Model(inputs=[in0Zer64202,in0Con33210,in0Ave45106], outputs=Mul86435)
w = model.get_layer('LST92272').get_weights() 
w[0] = np.array([[4, 6, 1, 7, 3, 10, 6, 4], [2, 2, 5, 1, 3, 9, 4, 3], [7, 9, 9, 9, 4, 7, 10, 1], [2, 5, 5, 10, 6, 5, 9, 2]])
w[1] = np.array([[2, 9, 8, 8, 9, 7, 6, 6], [10, 10, 2, 4, 5, 4, 7, 9]])
w[2] = np.array([1, 7, 7, 6, 1, 1, 2, 2])
model.get_layer('LST92272').set_weights(w) 
in0Zer64202 = tf.constant([[[1.4679, 1.5294, 1.9735, 1.3792], [1.211, 1.6282, 1.1279, 1.6566]]])
in0Con33210 = tf.constant([[[[0.5155]], [[0.2671]]]])
in0Ave45106 = tf.constant([[[[1.3803, 1.7496]], [[1.6027, 1.3861]]]])
print (np.array2string(model.predict([in0Zer64202,in0Con33210,in0Ave45106],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul86435.png')

LZer64202 = zero_padding1D_layer([[[1.4679, 1.5294, 1.9735, 1.3792], [1.211, 1.6282, 1.1279, 1.6566]]], 1, 1, Zer64202), 
LELU61544 = elu_layer(Zer64202, 2.4208829650010557, ELU61544), 
LLST92272 = lstm_layer(ELU61544,[[4, 6, 1, 7, 3, 10, 6, 4], [2, 2, 5, 1, 3, 9, 4, 3], [7, 9, 9, 9, 4, 7, 10, 1], [2, 5, 5, 10, 6, 5, 9, 2]],[[2, 9, 8, 8, 9, 7, 6, 6], [10, 10, 2, 4, 5, 4, 7, 9]],[1, 7, 7, 6, 1, 1, 2, 2], LST92272), 
LRes95485 = reshape_layer(LST92272, [2, 1], Res95485), 
LRes49297 = reshape_layer(Res95485, [2, 1, 1], Res49297), 
LCon33210 = concatenate_layer([Res49297,[[[[0.5155]], [[0.2671]]]]], 3, Con33210), 
LAve45106 = average_pooling2D_layer([[[[1.3803, 1.7496]], [[1.6027, 1.3861]]]], 1, 1, 1, 1, false, Ave45106), 
LMul86435 = multiply_layer([Con33210,Ave45106], Mul86435), 
exec_layers([LZer64202,LELU61544,LLST92272,LRes95485,LRes49297,LCon33210,LAve45106,LMul86435],["Zer64202","ELU61544","LST92272","Res95485","Res49297","Con33210","Ave45106","Mul86435"],Mul86435,"Mul86435")

Actual (Unparsed): [[[[1.3780542, 0.9019188]], [[1.6009662, 0.3702273]]]]

Expected (Unparsed): [[[[1.378054185489268,0.9019187999999999]],[[1.6009662360004595,0.37022731000000003]]]]

Actual:   [[[[1.3781, 0.902]], [[1.601, 0.3703]]]]

Expected: [[[[1.3781, 0.902]], [[1.601, 0.3703]]]]