import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add18649 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add18649 = tf.keras.layers.Input(shape=([1, 2, 2]))

Add18649 = keras.layers.Add(name = 'Add18649', )([in0Add18649,in1Add18649])
Res79718 = keras.layers.Reshape((1, 4), name = 'Res79718', )(Add18649)
Sim9388 = keras.layers.SimpleRNN(3,name = 'Sim9388', )(Res79718)
Res44417 = keras.layers.Reshape((3, 1), name = 'Res44417', )(Sim9388)
Con41279 = keras.layers.Conv1D(2, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con41279', )(Res44417)
model = tf.keras.models.Model(inputs=[in0Add18649,in1Add18649], outputs=Con41279)
w = model.get_layer('Sim9388').get_weights() 
w[0] = np.array([[9, 10, 6], [5, 7, 6], [2, 3, 4], [7, 3, 8]])
w[1] = np.array([[8, 7, 10], [6, 6, 8], [2, 5, 5]])
w[2] = np.array([3, 8, 7])
model.get_layer('Sim9388').set_weights(w) 
w = model.get_layer('Con41279').get_weights() 
w[0] = np.array([[[0.9402, 0.5021]], [[0.4265, 0.4891]]])
w[1] = np.array([0, 0])
model.get_layer('Con41279').set_weights(w) 
in0Add18649 = tf.constant([[[[0.1992, 0.7232], [0.3842, 0.9807]]]])
in1Add18649 = tf.constant([[[[0.1987, 0.0837], [0.7555, 0.9082]]]])
print (np.array2string(model.predict([in0Add18649,in1Add18649],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con41279.png')

LAdd18649 = add_layer([[[[[0.1992, 0.7232], [0.3842, 0.9807]]]], [[[[0.1987, 0.0837], [0.7555, 0.9082]]]]], Add18649), 
LRes79718 = reshape_layer(Add18649, [1, 4], Res79718), 
LSim9388 = simple_rnn_layer(Res79718,[[9, 10, 6], [5, 7, 6], [2, 3, 4], [7, 3, 8]],[[8, 7, 10], [6, 6, 8], [2, 5, 5]],[3, 8, 7], Sim9388), 
LRes44417 = reshape_layer(Sim9388, [3, 1], Res44417), 
LCon41279 = conv1D_layer(Res44417, 2,[[[0.9402, 0.5021]], [[0.4265, 0.4891]]],[0, 0], 1, false, 1, Con41279), 
exec_layers([LAdd18649,LRes79718,LSim9388,LRes44417,LCon41279],["Add18649","Res79718","Sim9388","Res44417","Con41279"],Con41279,"Con41279")

Actual (Unparsed): [[[1.3667000, 0.9912000], [1.3667000, 0.9912000]]]

Expected (Unparsed): [[[1.3667,0.9912],[1.3667,0.9912]]]

Actual:   [[[1.3667, 0.9912], [1.3667, 0.9912]]]

Expected: [[[1.3667, 0.9912], [1.3667, 0.9912]]]