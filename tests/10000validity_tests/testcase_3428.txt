import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea97294 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Lea97294 = keras.layers.LeakyReLU(alpha=0.7778068341663487, name = 'Lea97294', input_shape=(2, 2, 1, 2))(in0Lea97294)
Res61763 = keras.layers.Reshape((2, 2, 2), name = 'Res61763', )(Lea97294)
Res76363 = keras.layers.Reshape((2, 4), name = 'Res76363', )(Res61763)
GRU65229 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU65229', )(Res76363)
model = tf.keras.models.Model(inputs=[in0Lea97294], outputs=GRU65229)
w = model.get_layer('GRU65229').get_weights() 
w[0] = np.array([[6, 7, 1, 2, 8, 4], [7, 5, 2, 10, 4, 5], [5, 5, 4, 4, 3, 2], [8, 2, 1, 3, 1, 3]])
w[1] = np.array([[3, 9, 2, 5, 10, 10], [8, 3, 1, 9, 6, 9]])
w[2] = np.array([10, 4, 2, 10, 9, 6])
model.get_layer('GRU65229').set_weights(w) 
in0Lea97294 = tf.constant([[[[[0.6321, 0.0019]], [[0.3325, 0.8362]]], [[[0.355, 0.7124]], [[0.109, 0.7233]]]]])
print (np.array2string(model.predict([in0Lea97294],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU65229.png')

LLea97294 = leaky_relu_layer([[[[[0.6321, 0.0019]], [[0.3325, 0.8362]]], [[[0.355, 0.7124]], [[0.109, 0.7233]]]]], 0.7778068341663487, Lea97294), 
LRes61763 = reshape_layer(Lea97294, [2, 2, 2], Res61763), 
LRes76363 = reshape_layer(Res61763, [2, 4], Res76363), 
LGRU65229 = gru_layer(Res76363,[[6, 7, 1, 2, 8, 4], [7, 5, 2, 10, 4, 5], [5, 5, 4, 4, 3, 2], [8, 2, 1, 3, 1, 3]],[[3, 9, 2, 5, 10, 10], [8, 3, 1, 9, 6, 9]],[10, 4, 2, 10, 9, 6], false, GRU65229), 
exec_layers([LLea97294,LRes61763,LRes76363,LGRU65229],["Lea97294","Res61763","Res76363","GRU65229"],GRU65229,"GRU65229")

Actual (Unparsed): [[0.0000000, 0.0000137]]

Expected (Unparsed): [[3.037250450987117e-10,1.3651355512001333e-5]]

Actual:   [[0, 0.0001]]

Expected: [[0, 0.0001]]