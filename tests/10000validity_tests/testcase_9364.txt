import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot58484 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot58484 = tf.keras.layers.Input(shape=([3, 3]))
in0Ave73420 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave73420 = tf.keras.layers.Input(shape=([2, 2]))
in0Ave96783 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Ave96783 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Dot58484 = keras.layers.Dot(axes=(2, 1), name = 'Dot58484', )([in0Dot58484,in1Dot58484])
Max68185 = keras.layers.MaxPool1D(pool_size=(1), strides=(11), padding='same', name = 'Max68185', )(Dot58484)
ELU25308 = keras.layers.ELU(alpha=-4.039368375281782, name = 'ELU25308', )(Max68185)
Res68831 = keras.layers.Reshape((1, 3, 1), name = 'Res68831', )(ELU25308)
Res15730 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res15730', )(Res68831)
Zer75934 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer75934', )(Res15730)
Ave73420 = keras.layers.Average(name = 'Ave73420', )([in0Ave73420,in1Ave73420])
Res2597 = keras.layers.Reshape((2, 2, 1), name = 'Res2597', )(Ave73420)
Res84997 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res84997', )(Res2597)
Zer31215 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer31215', )(Res84997)
Ave96783 = keras.layers.Average(name = 'Ave96783', )([in0Ave96783,in1Ave96783])
Add78843 = keras.layers.Add(name = 'Add78843', )([Zer31215,Ave96783])
Zer82300 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer82300', )(Add78843)
Ave96109 = keras.layers.Average(name = 'Ave96109', )([Zer75934,Zer82300])
model = tf.keras.models.Model(inputs=[in0Dot58484,in1Dot58484,in0Ave73420,in1Ave73420,in0Ave96783,in1Ave96783], outputs=Ave96109)
in0Dot58484 = tf.constant([[[0.4213, 0.6001, 0.5453], [0.715, 0.3635, 0.0522], [0.6284, 0.2115, 0.8762]]])
in1Dot58484 = tf.constant([[[0.9091, 0.5115, 0.6159], [0.481, 0.2803, 0.6523], [0.9132, 0.435, 0.9428]]])
in0Ave73420 = tf.constant([[[0.8005, 0.8265], [0.2462, 0.6776]]])
in1Ave73420 = tf.constant([[[0.6614, 0.7217], [0.7053, 0.3913]]])
in0Ave96783 = tf.constant([[[[[0.6242], [0.2959]], [[0.283], [0.2287]]], [[[0.1438], [0.6915]], [[0.5135], [0.1052]]]]])
in1Ave96783 = tf.constant([[[[[0.3503], [0.229]], [[0.4251], [0.2183]]], [[[0.5937], [0.9099]], [[0.1672], [0.1333]]]]])
print (np.array2string(model.predict([in0Dot58484,in1Dot58484,in0Ave73420,in1Ave73420,in0Ave96783,in1Ave96783],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave96109.png')

LDot58484 = dot_layer([[[0.4213, 0.6001, 0.5453], [0.715, 0.3635, 0.0522], [0.6284, 0.2115, 0.8762]]], [[[0.9091, 0.5115, 0.6159], [0.481, 0.2803, 0.6523], [0.9132, 0.435, 0.9428]]], 2, 1, Dot58484), 
LMax68185 = max_pool1D_layer(Dot58484, 1, 11, true, Max68185), 
LELU25308 = elu_layer(Max68185, -4.039368375281782, ELU25308), 
LRes68831 = reshape_layer(ELU25308, [1, 3, 1], Res68831), 
LRes15730 = reshape_layer(Res68831, [1, 3, 1, 1], Res15730), 
LZer75934 = zero_padding3D_layer(Res15730, 1, 0, 1, 0, 1, 0, Zer75934), 
LAve73420 = average_layer([[[[0.8005, 0.8265], [0.2462, 0.6776]]], [[[0.6614, 0.7217], [0.7053, 0.3913]]]], Ave73420), 
LRes2597 = reshape_layer(Ave73420, [2, 2, 1], Res2597), 
LRes84997 = reshape_layer(Res2597, [2, 2, 1, 1], Res84997), 
LZer31215 = zero_padding3D_layer(Res84997, 0, 0, 0, 0, 1, 0, Zer31215), 
LAve96783 = average_layer([[[[[[0.6242], [0.2959]], [[0.283], [0.2287]]], [[[0.1438], [0.6915]], [[0.5135], [0.1052]]]]], [[[[[0.3503], [0.229]], [[0.4251], [0.2183]]], [[[0.5937], [0.9099]], [[0.1672], [0.1333]]]]]], Ave96783), 
LAdd78843 = add_layer([Zer31215,Ave96783], Add78843), 
LZer82300 = zero_padding3D_layer(Add78843, 0, 0, 2, 0, 0, 0, Zer82300), 
LAve96109 = average_layer([Zer75934,Zer82300], Ave96109), 
exec_layers([LDot58484,LMax68185,LELU25308,LRes68831,LRes15730,LZer75934,LAve73420,LRes2597,LRes84997,LZer31215,LAve96783,LAdd78843,LZer82300,LAve96109],["Dot58484","Max68185","ELU25308","Res68831","Res15730","Zer75934","Ave73420","Res2597","Res84997","Zer31215","Ave96783","Add78843","Zer82300","Ave96109"],Ave96109,"Ave96109")

Actual (Unparsed): [[[[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.2436250], [0.4967000]], [[0.1770250], [0.4988000]]], [[[0.0000000], [0.0000000]], [[0.0000000], [0.5848099]], [[0.1843750], [0.9486792]], [[0.1701750], [0.9093664]]]]]

Expected (Unparsed): [[[[[0],[0]],[[0],[0]],[[0.24362499999999998],[0.49670000000000003]],[[0.177025],[0.4988]]],[[[0],[0]],[[0],[0.5848099449999999]],[[0.184375],[0.94867924]],[[0.170175],[0.90936637]]]]]

Actual:   [[[[[0], [0]], [[0], [0]], [[0.2437], [0.4967]], [[0.1771], [0.4988]]], [[[0], [0]], [[0], [0.5849]], [[0.1844], [0.9487]], [[0.1702], [0.9094]]]]]

Expected: [[[[[0], [0]], [[0], [0]], [[0.2437], [0.4968]], [[0.1771], [0.4988]]], [[[0], [0]], [[0], [0.5849]], [[0.1844], [0.9487]], [[0.1702], [0.9094]]]]]