import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep45248 = tf.keras.layers.Input(shape=([2, 1, 1]))

Sep45248 = keras.layers.SeparableConv2D(4, (2, 1),strides=(2, 2), padding='valid', name = 'Sep45248', )(in0Sep45248)
Glo94943 = keras.layers.GlobalMaxPool2D(name = 'Glo94943', )(Sep45248)
Res73025 = keras.layers.Reshape((4, 1), name = 'Res73025', )(Glo94943)
Res59802 = keras.layers.Reshape((4, 1, 1), name = 'Res59802', )(Res73025)
Con29757 = keras.layers.Conv2DTranspose(4, (1, 1),strides=(1, 1), padding='valid', name = 'Con29757', )(Res59802)
model = tf.keras.models.Model(inputs=[in0Sep45248], outputs=Con29757)
w = model.get_layer('Sep45248').get_weights() 
w[0] = np.array([[[[0.5506]]], [[[0.127]]]])
w[1] = np.array([[[[0.1191, 0.4873, 0.6277, 0.7763]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep45248').set_weights(w) 
w = model.get_layer('Con29757').get_weights() 
w[0] = np.array([[[[0.9131], [0.7256], [0.3597], [0.5583]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con29757').set_weights(w) 
in0Sep45248 = tf.constant([[[[0.2316]], [[0.4527]]]])
print (np.array2string(model.predict([in0Sep45248],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con29757.png')

LSep45248 = separable_conv2D_layer([[[[0.2316]], [[0.4527]]]], 2, 1,[[[[[0.5506]]], [[[0.127]]]],[[[[0.1191, 0.4873, 0.6277, 0.7763]]]]],[0, 0, 0, 0], 2, 2, false, Sep45248), 
LGlo94943 = global_max_pool2D_layer(Sep45248, Glo94943), 
LRes73025 = reshape_layer(Glo94943, [4, 1], Res73025), 
LRes59802 = reshape_layer(Res73025, [4, 1, 1], Res59802), 
LCon29757 = conv2D_transpose_layer(Res59802, 1, 1,[[[[0.9131], [0.7256], [0.3597], [0.5583]]]],[0, 0, 0, 0], 1, 1, false, Con29757), 
exec_layers([LSep45248,LGlo94943,LRes73025,LRes59802,LCon29757],["Sep45248","Glo94943","Res73025","Res59802","Con29757"],Con29757,"Con29757")

Actual (Unparsed): [[[[0.0201201, 0.0159885, 0.0079260, 0.0123021]], [[0.0823217, 0.0654174, 0.0324292, 0.0503343]], [[0.1060401, 0.0842653, 0.0417727, 0.0648365]], [[0.1311437, 0.1042141, 0.0516618, 0.0801857]]]]

Expected (Unparsed): [[[[0.020120078627490597,0.015988532528865597,0.0079259580356022,0.0123020916632658]],[[0.0823216987000518,0.0654173963166768,0.032429213692266604,0.0503342507767374]],[[0.1060400785430382,0.08426533894516319,0.041772660444563396,0.06483646462663259]],[[0.1311437198868258,0.1042140873397008,0.051661807078404606,0.0801856738723194]]]]

Actual:   [[[[0.0202, 0.016, 0.008, 0.0124]], [[0.0824, 0.0655, 0.0325, 0.0504]], [[0.1061, 0.0843, 0.0418, 0.0649]], [[0.1312, 0.1043, 0.0517, 0.0802]]]]

Expected: [[[[0.0202, 0.016, 0.008, 0.0124]], [[0.0824, 0.0655, 0.0325, 0.0504]], [[0.1061, 0.0843, 0.0418, 0.0649]], [[0.1312, 0.1043, 0.0517, 0.0802]]]]