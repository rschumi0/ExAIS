import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot18588 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot18588 = tf.keras.layers.Input(shape=([3, 2]))

Dot18588 = keras.layers.Dot(axes=(1, 1), name = 'Dot18588', )([in0Dot18588,in1Dot18588])
Res23692 = keras.layers.Reshape((2, 2, 1), name = 'Res23692', )(Dot18588)
PRe42035 = keras.layers.PReLU(name = 'PRe42035', )(Res23692)
ReL84529 = keras.layers.ReLU(max_value=5.121162952171046, negative_slope=5.142984697922249, threshold=2.4308633850395136, name = 'ReL84529', )(PRe42035)
Res72886 = keras.layers.Reshape((2, 2), name = 'Res72886', )(ReL84529)
Glo76620 = keras.layers.GlobalMaxPool1D(name = 'Glo76620', )(Res72886)
model = tf.keras.models.Model(inputs=[in0Dot18588,in1Dot18588], outputs=Glo76620)
w = model.get_layer('PRe42035').get_weights() 
w[0] = np.array([[[0.19], [0.7825]], [[0.6864], [0.7896]]])
model.get_layer('PRe42035').set_weights(w) 
in0Dot18588 = tf.constant([[[0.6401, 0.4327], [0.4327, 0.3239], [0.2004, 0.6196]]])
in1Dot18588 = tf.constant([[[0.4009, 0.8627], [0.0174, 0.8638], [0.8729, 0.3545]]])
print (np.array2string(model.predict([in0Dot18588,in1Dot18588],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo76620.png')

LDot18588 = dot_layer([[[0.6401, 0.4327], [0.4327, 0.3239], [0.2004, 0.6196]]], [[[0.4009, 0.8627], [0.0174, 0.8638], [0.8729, 0.3545]]], 1, 1, Dot18588), 
LRes23692 = reshape_layer(Dot18588, [2, 2, 1], Res23692), 
LPRe42035 = prelu_layer(Res23692, [[[0.19], [0.7825]], [[0.6864], [0.7896]]], PRe42035), 
LReL84529 = relu_layer(PRe42035, 5.121162952171046, 5.142984697922249, 2.4308633850395136, ReL84529), 
LRes72886 = reshape_layer(ReL84529, [2, 2], Res72886), 
LGlo76620 = global_max_pool1D_layer(Res72886, Glo76620), 
exec_layers([LDot18588,LRes23692,LPRe42035,LReL84529,LRes72886,LGlo76620],["Dot18588","Res23692","PRe42035","ReL84529","Res72886","Glo76620"],Glo76620,"Glo76620")

Actual (Unparsed): [[-8.7991801, -7.3742226]]

Expected (Unparsed): [[-8.799180118201773,-7.374222605320912]]

Actual:   [[-8.7991, -7.3742]]

Expected: [[-8.7991, -7.3742]]