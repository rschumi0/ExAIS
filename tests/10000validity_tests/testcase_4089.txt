import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add78185 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add78185 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave62509 = tf.keras.layers.Input(shape=([2, 2]))

Add78185 = keras.layers.Add(name = 'Add78185', )([in0Add78185,in1Add78185])
Res29181 = keras.layers.Reshape((2, 2), name = 'Res29181', )(Add78185)
Ave62509 = keras.layers.AveragePooling1D(pool_size=(2), strides=(1), padding='same', name = 'Ave62509', )(in0Ave62509)
Mul94336 = keras.layers.Multiply(name = 'Mul94336', )([Res29181,Ave62509])
Max11223 = keras.layers.MaxPool1D(pool_size=(2), strides=(4), padding='same', name = 'Max11223', )(Mul94336)
model = tf.keras.models.Model(inputs=[in0Add78185,in1Add78185,in0Ave62509], outputs=Max11223)
in0Add78185 = tf.constant([[[[0.2358], [0.5236]], [[0.2306], [0.2383]]]])
in1Add78185 = tf.constant([[[[0.2993], [0.6441]], [[0.3045], [0.9282]]]])
in0Ave62509 = tf.constant([[[1.3614, 1.3093], [1.6072, 1.3358]]])
print (np.array2string(model.predict([in0Add78185,in1Add78185,in0Ave62509],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max11223.png')

LAdd78185 = add_layer([[[[[0.2358], [0.5236]], [[0.2306], [0.2383]]]], [[[[0.2993], [0.6441]], [[0.3045], [0.9282]]]]], Add78185), 
LRes29181 = reshape_layer(Add78185, [2, 2], Res29181), 
LAve62509 = average_pooling1D_layer([[[1.3614, 1.3093], [1.6072, 1.3358]]], 2, 1, true, Ave62509), 
LMul94336 = multiply_layer([Res29181,Ave62509], Mul94336), 
LMax11223 = max_pool1D_layer(Mul94336, 2, 4, true, Max11223), 
exec_layers([LAdd78185,LRes29181,LAve62509,LMul94336,LMax11223],["Add78185","Res29181","Ave62509","Mul94336","Max11223"],Max11223,"Max11223")

Actual (Unparsed): [[[0.8600128, 1.5582108]]]

Expected (Unparsed): [[[0.8600127200000001,1.5582107000000003]]]

Actual:   [[[0.8601, 1.5583]]]

Expected: [[[0.8601, 1.5583]]]