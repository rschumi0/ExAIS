import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub31243 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub31243 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Ave28070 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Ave28070 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Sub31243 = keras.layers.Subtract(name = 'Sub31243', )([in0Sub31243,in1Sub31243])
Res81118 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res81118', )(Sub31243)
Ave28070 = keras.layers.Average(name = 'Ave28070', )([in0Ave28070,in1Ave28070])
Zer82566 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer82566', )(Ave28070)
Add83748 = keras.layers.Add(name = 'Add83748', )([Res81118,Zer82566])
Lea60599 = keras.layers.LeakyReLU(alpha=0.8673258117558376, name = 'Lea60599', )(Add83748)
model = tf.keras.models.Model(inputs=[in0Sub31243,in1Sub31243,in0Ave28070,in1Ave28070], outputs=Lea60599)
in0Sub31243 = tf.constant([[[[0.3242, 0.4663], [0.3714, 0.9284]], [[0.9886, 0.5633], [0.6913, 0.6688]]]])
in1Sub31243 = tf.constant([[[[0.9207, 0.2862], [0.189, 0.1114]], [[0.8893, 0.2131], [0.055, 0.4867]]]])
in0Ave28070 = tf.constant([[[[[0.1966], [0.3692]]], [[[0.4273], [0.4399]]]]])
in1Ave28070 = tf.constant([[[[[0.424], [0.5457]]], [[[0.2586], [0.9637]]]]])
print (np.array2string(model.predict([in0Sub31243,in1Sub31243,in0Ave28070,in1Ave28070],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lea60599.png')

LSub31243 = subtract_layer([[[[0.3242, 0.4663], [0.3714, 0.9284]], [[0.9886, 0.5633], [0.6913, 0.6688]]]], [[[[0.9207, 0.2862], [0.189, 0.1114]], [[0.8893, 0.2131], [0.055, 0.4867]]]], Sub31243), 
LRes81118 = reshape_layer(Sub31243, [2, 2, 2, 1], Res81118), 
LAve28070 = average_layer([[[[[[0.1966], [0.3692]]], [[[0.4273], [0.4399]]]]], [[[[[0.424], [0.5457]]], [[[0.2586], [0.9637]]]]]], Ave28070), 
LZer82566 = zero_padding3D_layer(Ave28070, 0, 0, 1, 0, 0, 0, Zer82566), 
LAdd83748 = add_layer([Res81118,Zer82566], Add83748), 
LLea60599 = leaky_relu_layer(Add83748, 0.8673258117558376, Lea60599), 
exec_layers([LSub31243,LRes81118,LAve28070,LZer82566,LAdd83748,LLea60599],["Sub31243","Res81118","Ave28070","Zer82566","Add83748","Lea60599"],Lea60599,"Lea60599")

Actual (Unparsed): [[[[[-0.5173598], [0.1801000]], [[0.4927000], [1.2744500]]], [[[0.0993000], [0.3502000]], [[0.9792500], [0.8839000]]]]]

Expected (Unparsed): [[[[[-0.5173598467123571],[0.18009999999999998]],[[0.4927],[1.2744499999999999]]],[[[0.09930000000000005],[0.3502]],[[0.97925],[0.8838999999999999]]]]]

Actual:   [[[[[-0.5173], [0.1801]], [[0.4927], [1.2745]]], [[[0.0993], [0.3502]], [[0.9793], [0.8839]]]]]

Expected: [[[[[-0.5173], [0.1801]], [[0.4927], [1.2745]]], [[[0.0994], [0.3502]], [[0.9793], [0.8839]]]]]