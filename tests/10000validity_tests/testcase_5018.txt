import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con49581 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con33477 = tf.keras.layers.Input(shape=([3, 1, 1]))
in0Bat13506 = tf.keras.layers.Input(shape=([3, 1]))
in0Con48359 = tf.keras.layers.Input(shape=([3, 1, 1, 2]))
in0Con54390 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Max18152 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Max18152 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Con32775 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Con49581 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con49581', )(in0Con49581)
Zer10678 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer10678', )(Con49581)
Con33477 = keras.layers.Concatenate(axis=3, name = 'Con33477', )([Zer10678,in0Con33477])
Bat13506 = keras.layers.BatchNormalization(axis=2, epsilon=0.6412556855554645,  name = 'Bat13506', )(in0Bat13506)
Res95861 = keras.layers.Reshape((3, 1, 1), name = 'Res95861', )(Bat13506)
Res87382 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res87382', )(Res95861)
Con48359 = keras.layers.Concatenate(axis=4, name = 'Con48359', )([Res87382,in0Con48359])
Con54390 = keras.layers.Conv3D(3, (1, 2, 1),strides=(8, 2, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con54390', )(in0Con54390)
Zer14938 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer14938', )(Con54390)
Max18152 = keras.layers.Maximum(name = 'Max18152', )([in0Max18152,in1Max18152])
Con32775 = keras.layers.Concatenate(axis=4, name = 'Con32775', )([Max18152,in0Con32775])
Ave39527 = keras.layers.Average(name = 'Ave39527', )([Zer14938,Con32775])
Zer50227 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer50227', )(Ave39527)
Max8263 = keras.layers.Maximum(name = 'Max8263', )([Con48359,Zer50227])
Res28364 = keras.layers.Reshape((3, 1, 3), name = 'Res28364', )(Max8263)
Ave29557 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave29557', )(Res28364)
Add19360 = keras.layers.Add(name = 'Add19360', )([Con33477,Ave29557])
model = tf.keras.models.Model(inputs=[in0Con49581,in0Con33477,in0Bat13506,in0Con48359,in0Con54390,in0Max18152,in1Max18152,in0Con32775], outputs=Add19360)
w = model.get_layer('Con49581').get_weights() 
w[0] = np.array([[[[0.5097, 0.0823], [0.938, 0.343]]]])
w[1] = np.array([0, 0])
model.get_layer('Con49581').set_weights(w) 
w = model.get_layer('Bat13506').get_weights() 
w[0] = np.array([0.01])
w[1] = np.array([0.2421])
w[2] = np.array([0.7306])
w[3] = np.array([0.8529])
model.get_layer('Bat13506').set_weights(w) 
w = model.get_layer('Con54390').get_weights() 
w[0] = np.array([[[[[0.4567, 0.3182, 0.54]]], [[[0.2906, 0.926, 0.2474]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con54390').set_weights(w) 
in0Con49581 = tf.constant([[[[0.8433, 0.6221]]]])
in0Con33477 = tf.constant([[[[0.7482]], [[0.1368]], [[0.2682]]]])
in0Bat13506 = tf.constant([[[1.9314], [1.0698], [1.149]]])
in0Con48359 = tf.constant([[[[[0.781, 0.1701]]], [[[0.1915, 0.8612]]], [[[0.6481, 0.1323]]]]])
in0Con54390 = tf.constant([[[[[0.581]], [[0.6154]]], [[[0.2099]], [[0.0846]]]]])
in0Max18152 = tf.constant([[[[[0.5517, 0.4851]]], [[[0.8979, 0.3115]]]]])
in1Max18152 = tf.constant([[[[[0.0531, 0.1898]]], [[[0.7961, 0.9104]]]]])
in0Con32775 = tf.constant([[[[[0.0323]]], [[[0.413]]]]])
print (np.array2string(model.predict([in0Con49581,in0Con33477,in0Bat13506,in0Con48359,in0Con54390,in0Max18152,in1Max18152,in0Con32775],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add19360.png')

LCon49581 = conv2D_layer([[[[0.8433, 0.6221]]]], 1, 1,[[[[0.5097, 0.0823], [0.938, 0.343]]]],[0, 0], 1, 1, true, 1, 1, Con49581), 
LZer10678 = zero_padding2D_layer(Con49581, 2, 0, 0, 0, Zer10678), 
LCon33477 = concatenate_layer([Zer10678,[[[[0.7482]], [[0.1368]], [[0.2682]]]]], 3, Con33477), 
LBat13506 = batch_normalization_layer([[[1.9314], [1.0698], [1.149]]], 2, 0.6412556855554645, [0.01], [0.2421], [0.7306], [0.8529], Bat13506), 
LRes95861 = reshape_layer(Bat13506, [3, 1, 1], Res95861), 
LRes87382 = reshape_layer(Res95861, [3, 1, 1, 1], Res87382), 
LCon48359 = concatenate_layer([Res87382,[[[[[0.781, 0.1701]]], [[[0.1915, 0.8612]]], [[[0.6481, 0.1323]]]]]], 4, Con48359), 
LCon54390 = conv3D_layer([[[[[0.581]], [[0.6154]]], [[[0.2099]], [[0.0846]]]]], 1, 2, 1,[[[[[0.4567, 0.3182, 0.54]]], [[[0.2906, 0.926, 0.2474]]]]],[0, 0, 0], 8, 2, 1, false, 1, 1, 1, Con54390), 
LZer14938 = zero_padding3D_layer(Con54390, 1, 0, 0, 0, 0, 0, Zer14938), 
LMax18152 = maximum_layer([[[[[[0.5517, 0.4851]]], [[[0.8979, 0.3115]]]]], [[[[[0.0531, 0.1898]]], [[[0.7961, 0.9104]]]]]], Max18152), 
LCon32775 = concatenate_layer([Max18152,[[[[[0.0323]]], [[[0.413]]]]]], 4, Con32775), 
LAve39527 = average_layer([Zer14938,Con32775], Ave39527), 
LZer50227 = zero_padding3D_layer(Ave39527, 1, 0, 0, 0, 0, 0, Zer50227), 
LMax8263 = maximum_layer([Con48359,Zer50227], Max8263), 
LRes28364 = reshape_layer(Max8263, [3, 1, 3], Res28364), 
LAve29557 = average_pooling2D_layer(Res28364, 1, 1, Ave29557), 
LAdd19360 = add_layer([Con33477,Ave29557], Add19360), 
exec_layers([LCon49581,LZer10678,LCon33477,LBat13506,LRes95861,LRes87382,LCon48359,LCon54390,LZer14938,LMax18152,LCon32775,LAve39527,LZer50227,LMax8263,LRes28364,LAve29557,LAdd19360],["Con49581","Zer10678","Con33477","Bat13506","Res95861","Res87382","Con48359","Con54390","Zer14938","Max18152","Con32775","Ave39527","Zer50227","Max8263","Res28364","Ave29557","Add19360"],Add19360,"Add19360")

Actual (Unparsed): [[[[0.2519236, 0.7810000, 0.9183000]], [[0.2758500, 0.2425500, 0.9980000]], [[1.6843988, 1.1153512, 0.7076950]]]]

Expected (Unparsed): [[[[0.25192364711535037,0.781,0.9183]],[[0.27585,0.24255,0.998]],[[1.68439878,1.1153511900000002,0.70769498]]]]

Actual:   [[[[0.252, 0.781, 0.9183]], [[0.2759, 0.2426, 0.998]], [[1.6844, 1.1154, 0.7077]]]]

Expected: [[[[0.252, 0.781, 0.9183]], [[0.2759, 0.2426, 0.998]], [[1.6844, 1.1154, 0.7077]]]]