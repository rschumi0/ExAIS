import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add5002 = tf.keras.layers.Input(shape=([1, 1]))
in1Add5002 = tf.keras.layers.Input(shape=([1, 1]))
in0Con29235 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot76061 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot76061 = tf.keras.layers.Input(shape=([3, 2]))

Add5002 = keras.layers.Add(name = 'Add5002', )([in0Add5002,in1Add5002])
Res17863 = keras.layers.Reshape((1, 1, 1), name = 'Res17863', )(Add5002)
Glo52977 = keras.layers.GlobalAveragePooling2D(name = 'Glo52977', )(Res17863)
Res40889 = keras.layers.Reshape((1, 1), name = 'Res40889', )(Glo52977)
Zer83379 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer83379', )(Res40889)
Con29235 = keras.layers.Concatenate(axis=2, name = 'Con29235', )([Zer83379,in0Con29235])
Dot76061 = keras.layers.Dot(axes=(2, 2), name = 'Dot76061', )([in0Dot76061,in1Dot76061])
Ave58053 = keras.layers.Average(name = 'Ave58053', )([Con29235,Dot76061])
Res848 = keras.layers.Reshape((3, 3, 1), name = 'Res848', )(Ave58053)
Ave90275 = keras.layers.AveragePooling2D(pool_size=(2, 2), name = 'Ave90275', )(Res848)
model = tf.keras.models.Model(inputs=[in0Add5002,in1Add5002,in0Con29235,in0Dot76061,in1Dot76061], outputs=Ave90275)
in0Add5002 = tf.constant([[[0.428]]])
in1Add5002 = tf.constant([[[0.0163]]])
in0Con29235 = tf.constant([[[0.5455, 0.537], [0.0161, 0.6846], [0.1684, 0.9657]]])
in0Dot76061 = tf.constant([[[0.8427, 0.0726], [0.0646, 0.7094], [0.2618, 0.9745]]])
in1Dot76061 = tf.constant([[[0.4547, 0.779], [0.3477, 0.4108], [0.17, 0.8943]]])
print (np.array2string(model.predict([in0Add5002,in1Add5002,in0Con29235,in0Dot76061,in1Dot76061],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave90275.png')

LAdd5002 = add_layer([[[[0.428]]], [[[0.0163]]]], Add5002), 
LRes17863 = reshape_layer(Add5002, [1, 1, 1], Res17863), 
LGlo52977 = global_average_pooling2D_layer(Res17863, Glo52977), 
LRes40889 = reshape_layer(Glo52977, [1, 1], Res40889), 
LZer83379 = zero_padding1D_layer(Res40889, 2, 0, Zer83379), 
LCon29235 = concatenate_layer([Zer83379,[[[0.5455, 0.537], [0.0161, 0.6846], [0.1684, 0.9657]]]], 2, Con29235), 
LDot76061 = dot_layer([[[0.8427, 0.0726], [0.0646, 0.7094], [0.2618, 0.9745]]], [[[0.4547, 0.779], [0.3477, 0.4108], [0.17, 0.8943]]], 2, 2, Dot76061), 
LAve58053 = average_layer([Con29235,Dot76061], Ave58053), 
LRes848 = reshape_layer(Ave58053, [3, 3, 1], Res848), 
LAve90275 = average_pooling2D_layer(Res848, 2, 2, Ave90275), 
exec_layers([LAdd5002,LRes17863,LGlo52977,LRes40889,LZer83379,LCon29235,LDot76061,LAve58053,LRes848,LAve90275],["Add5002","Res17863","Glo52977","Res40889","Zer83379","Con29235","Dot76061","Ave58053","Res848","Ave90275"],Ave90275,"Ave90275")

Actual (Unparsed): [[[[0.2775051]]]]

Expected (Unparsed): [[[[0.27750514]]]]

Actual:   [[[[0.2776]]]]

Expected: [[[[0.2776]]]]