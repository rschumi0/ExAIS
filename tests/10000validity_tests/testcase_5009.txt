import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max98831 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max98831 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max98831 = keras.layers.Maximum(name = 'Max98831', )([in0Max98831,in1Max98831])
Res58300 = keras.layers.Reshape((2, 1), name = 'Res58300', )(Max98831)
Max34005 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='same', name = 'Max34005', )(Res58300)
Bat85928 = keras.layers.BatchNormalization(axis=2, epsilon=0.6242469170218624,  name = 'Bat85928', )(Max34005)
Max96060 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='same', name = 'Max96060', )(Bat85928)
model = tf.keras.models.Model(inputs=[in0Max98831,in1Max98831], outputs=Max96060)
w = model.get_layer('Bat85928').get_weights() 
w[0] = np.array([0.3453])
w[1] = np.array([0.4763])
w[2] = np.array([0.7112])
w[3] = np.array([0.1154])
model.get_layer('Bat85928').set_weights(w) 
in0Max98831 = tf.constant([[[[0.5119]], [[0.0792]]]])
in1Max98831 = tf.constant([[[[0.5634]], [[0.8365]]]])
print (np.array2string(model.predict([in0Max98831,in1Max98831],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max96060.png')

LMax98831 = maximum_layer([[[[[0.5119]], [[0.0792]]]], [[[[0.5634]], [[0.8365]]]]], Max98831), 
LRes58300 = reshape_layer(Max98831, [2, 1], Res58300), 
LMax34005 = max_pool1D_layer(Res58300, 2, 1, true, Max34005), 
LBat85928 = batch_normalization_layer(Max34005, 2, 0.6242469170218624, [0.3453], [0.4763], [0.7112], [0.1154], Bat85928), 
LMax96060 = max_pool1D_layer(Bat85928, 1, 1, true, Max96060), 
exec_layers([LMax98831,LRes58300,LMax34005,LBat85928,LMax96060],["Max98831","Res58300","Max34005","Bat85928","Max96060"],Max96060,"Max96060")

Actual (Unparsed): [[[0.5266078], [0.5266078]]]

Expected (Unparsed): [[[0.5266078113471779],[0.5266078113471779]]]

Actual:   [[[0.5267], [0.5267]]]

Expected: [[[0.5267], [0.5267]]]