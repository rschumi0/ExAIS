import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo60952 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con40199 = tf.keras.layers.Input(shape=([2]))
in0Sim92427 = tf.keras.layers.Input(shape=([3, 1]))

Glo60952 = keras.layers.GlobalAveragePooling2D(name = 'Glo60952', )(in0Glo60952)
Res15182 = keras.layers.Reshape((1, 1), name = 'Res15182', )(Glo60952)
Res9110 = keras.layers.Reshape((1, 1, 1), name = 'Res9110', )(Res15182)
Cro57276 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro57276', )(Res9110)
Res12001 = keras.layers.Reshape((1, 1), name = 'Res12001', )(Cro57276)
Fla33104 = keras.layers.Flatten(name = 'Fla33104', )(Res12001)
Con40199 = keras.layers.Concatenate(axis=1, name = 'Con40199', )([Fla33104,in0Con40199])
Sim92427 = keras.layers.SimpleRNN(3,name = 'Sim92427', )(in0Sim92427)
Dot30093 = keras.layers.Dot(axes=(1, 1), name = 'Dot30093', )([Con40199,Sim92427])
Res785 = keras.layers.Reshape((1, 1), name = 'Res785', )(Dot30093)
Con11810 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con11810', )(Res785)
model = tf.keras.models.Model(inputs=[in0Glo60952,in0Con40199,in0Sim92427], outputs=Con11810)
w = model.get_layer('Sim92427').get_weights() 
w[0] = np.array([[2, 1, 6]])
w[1] = np.array([[5, 4, 7], [2, 3, 9], [10, 1, 1]])
w[2] = np.array([5, 2, 8])
model.get_layer('Sim92427').set_weights(w) 
w = model.get_layer('Con11810').get_weights() 
w[0] = np.array([[[0.1094, 0.8123]]])
w[1] = np.array([0, 0])
model.get_layer('Con11810').set_weights(w) 
in0Glo60952 = tf.constant([[[[1.0525]], [[1.3397]]]])
in0Con40199 = tf.constant([[0.7532, 0.9561]])
in0Sim92427 = tf.constant([[[3], [2], [10]]])
print (np.array2string(model.predict([in0Glo60952,in0Con40199,in0Sim92427],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con11810.png')

LGlo60952 = global_average_pooling2D_layer([[[[1.0525]], [[1.3397]]]], Glo60952), 
LRes15182 = reshape_layer(Glo60952, [1, 1], Res15182), 
LRes9110 = reshape_layer(Res15182, [1, 1, 1], Res9110), 
LCro57276 = cropping2D_layer(Res9110, 0, 0, 0, 0, Cro57276), 
LRes12001 = reshape_layer(Cro57276, [1, 1], Res12001), 
LFla33104 = flatten_layer(Res12001, Fla33104), 
LCon40199 = concatenate_layer([Fla33104,[[0.7532, 0.9561]]], 1, Con40199), 
LSim92427 = simple_rnn_layer([[[3], [2], [10]]],[[2, 1, 6]],[[5, 4, 7], [2, 3, 9], [10, 1, 1]],[5, 2, 8], Sim92427), 
LDot30093 = dot_layer(Con40199,Sim92427, 1, 1, Dot30093), 
LRes785 = reshape_layer(Dot30093, [1, 1], Res785), 
LCon11810 = conv1D_layer(Res785, 1,[[[0.1094, 0.8123]]],[0, 0], 1, false, 1, Con11810), 
exec_layers([LGlo60952,LRes15182,LRes9110,LCro57276,LRes12001,LFla33104,LCon40199,LSim92427,LDot30093,LRes785,LCon11810],["Glo60952","Res15182","Res9110","Cro57276","Res12001","Fla33104","Con40199","Sim92427","Dot30093","Res785","Con11810"],Con11810,"Con11810")

Actual (Unparsed): [[[0.3178508, 2.3600564]]]

Expected (Unparsed): [[[0.31785076,2.3600564200000003]]]

Actual:   [[[0.3179, 2.3601]]]

Expected: [[[0.3179, 2.3601]]]