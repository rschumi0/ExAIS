import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave14560 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave14560 = tf.keras.layers.Input(shape=([1, 2, 1]))

Ave14560 = keras.layers.Average(name = 'Ave14560', )([in0Ave14560,in1Ave14560])
Con46297 = keras.layers.Conv2D(2, (2, 2),strides=(1, 12), padding='same', dilation_rate=(1, 1), name = 'Con46297', )(Ave14560)
Res22960 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res22960', )(Con46297)
PRe37112 = keras.layers.PReLU(name = 'PRe37112', )(Res22960)
Res6650 = keras.layers.Reshape((1, 1, 2), name = 'Res6650', )(PRe37112)
PRe3632 = keras.layers.PReLU(name = 'PRe3632', )(Res6650)
model = tf.keras.models.Model(inputs=[in0Ave14560,in1Ave14560], outputs=PRe3632)
w = model.get_layer('Con46297').get_weights() 
w[0] = np.array([[[[0.2851, 0.426]], [[0.6539, 0.509]]], [[[0.0745, 0.9181]], [[0.9515, 0.4582]]]])
w[1] = np.array([0, 0])
model.get_layer('Con46297').set_weights(w) 
w = model.get_layer('PRe37112').get_weights() 
w[0] = np.array([[[[0.5784], [0.1095]]]])
model.get_layer('PRe37112').set_weights(w) 
w = model.get_layer('PRe3632').get_weights() 
w[0] = np.array([[[0.488, 0.7603]]])
model.get_layer('PRe3632').set_weights(w) 
in0Ave14560 = tf.constant([[[[0.1977], [0.3215]]]])
in1Ave14560 = tf.constant([[[[0.9517], [0.3442]]]])
print (np.array2string(model.predict([in0Ave14560,in1Ave14560],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe3632.png')

LAve14560 = average_layer([[[[[0.1977], [0.3215]]]], [[[[0.9517], [0.3442]]]]], Ave14560), 
LCon46297 = conv2D_layer(Ave14560, 2, 2,[[[[0.2851, 0.426]], [[0.6539, 0.509]]], [[[0.0745, 0.9181]], [[0.9515, 0.4582]]]],[0, 0], 1, 12, true, 1, 1, Con46297), 
LRes22960 = reshape_layer(Con46297, [1, 1, 2, 1], Res22960), 
LPRe37112 = prelu_layer(Res22960, [[[[0.5784], [0.1095]]]], PRe37112), 
LRes6650 = reshape_layer(PRe37112, [1, 1, 2], Res6650), 
LPRe3632 = prelu_layer(Res6650, [[[0.488, 0.7603]]], PRe3632), 
exec_layers([LAve14560,LCon46297,LRes22960,LPRe37112,LRes6650,LPRe3632],["Ave14560","Con46297","Res22960","PRe37112","Res6650","PRe3632"],PRe3632,"PRe3632")

Actual (Unparsed): [[[[0.3814976, 0.4142428]]]]

Expected (Unparsed): [[[[0.381497585,0.41424284999999994]]]]

Actual:   [[[[0.3815, 0.4143]]]]

Expected: [[[[0.3815, 0.4143]]]]