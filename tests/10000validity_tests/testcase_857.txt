import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con62250 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Con62250 = keras.layers.Conv3DTranspose(2, (2, 2, 1),strides=(1, 1, 1), padding='valid', name = 'Con62250', )(in0Con62250)
Res68006 = keras.layers.Reshape((3, 3, 4), name = 'Res68006', )(Con62250)
Res93597 = keras.layers.Reshape((3, 12), name = 'Res93597', )(Res68006)
Sep59514 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep59514', )(Res93597)
Ave88981 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave88981', )(Sep59514)
Cro80130 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro80130', )(Ave88981)
model = tf.keras.models.Model(inputs=[in0Con62250], outputs=Cro80130)
w = model.get_layer('Con62250').get_weights() 
w[0] = np.array([[[[[0.4621], [0.5686]]], [[[0.8222], [0.9228]]]], [[[[0.109], [0.9537]]], [[[0.6008], [0.5818]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con62250').set_weights(w) 
w = model.get_layer('Sep59514').get_weights() 
w[0] = np.array([[[0.8144], [0.7227], [0.2482], [0.7417], [0.6601], [0.3859], [0.5166], [0.6985], [0.5421], [0.3034], [0.4037], [0.8992]]])
w[1] = np.array([[[0.3544, 0.3455, 0.8763, 0.6693], [0.455, 0.7616, 0.0016, 0.8531], [0.787, 0.3674, 0.0593, 0.0713], [0.9999, 0.4731, 0.1407, 0.6713], [0.0319, 0.0397, 0.0928, 0.8281], [0.1905, 0.726, 0.2113, 0.7505], [0.2329, 0.0158, 0.5471, 0.3786], [0.7704, 0.9466, 0.3148, 0.6222], [0.1567, 0.3386, 0.8691, 0.3312], [0.388, 0.5778, 0.7216, 0.6119], [0.4439, 0.947, 0.114, 0.8085], [0.9258, 0.2187, 0.7319, 0.4508]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep59514').set_weights(w) 
in0Con62250 = tf.constant([[[[[0.6568], [0.1216]], [[0.6157], [0.3106]]], [[[0.9095], [0.5009]], [[0.5965], [0.4549]]]]])
print (np.array2string(model.predict([in0Con62250],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro80130.png')

LCon62250 = conv3D_transpose_layer([[[[[0.6568], [0.1216]], [[0.6157], [0.3106]]], [[[0.9095], [0.5009]], [[0.5965], [0.4549]]]]], 2, 2, 1,[[[[[0.4621], [0.5686]]], [[[0.8222], [0.9228]]]], [[[[0.109], [0.9537]]], [[[0.6008], [0.5818]]]]],[0, 0], 1, 1, 1, false, Con62250), 
LRes68006 = reshape_layer(Con62250, [3, 3, 4], Res68006), 
LRes93597 = reshape_layer(Res68006, [3, 12], Res93597), 
LSep59514 = separable_conv1D_layer(Res93597, 1,[[[[0.8144], [0.7227], [0.2482], [0.7417], [0.6601], [0.3859], [0.5166], [0.6985], [0.5421], [0.3034], [0.4037], [0.8992]]],[[[0.3544, 0.3455, 0.8763, 0.6693], [0.455, 0.7616, 0.0016, 0.8531], [0.787, 0.3674, 0.0593, 0.0713], [0.9999, 0.4731, 0.1407, 0.6713], [0.0319, 0.0397, 0.0928, 0.8281], [0.1905, 0.726, 0.2113, 0.7505], [0.2329, 0.0158, 0.5471, 0.3786], [0.7704, 0.9466, 0.3148, 0.6222], [0.1567, 0.3386, 0.8691, 0.3312], [0.388, 0.5778, 0.7216, 0.6119], [0.4439, 0.947, 0.114, 0.8085], [0.9258, 0.2187, 0.7319, 0.4508]]]],[0, 0, 0, 0], 1, false, Sep59514), 
LAve88981 = average_pooling1D_layer(Sep59514, 1, Ave88981), 
LCro80130 = cropping1D_layer(Ave88981, 1, 0, Cro80130), 
exec_layers([LCon62250,LRes68006,LRes93597,LSep59514,LAve88981,LCro80130],["Con62250","Res68006","Res93597","Sep59514","Ave88981","Cro80130"],Cro80130,"Cro80130")

Actual (Unparsed): [[[2.5057062, 2.9462800, 2.1343988, 3.9758022], [1.5454299, 1.7671264, 0.9395257, 2.1888958]]]

Expected (Unparsed): [[[2.5057062034184705,2.9462800445267927,2.1343988119717956,3.9758022782938873],[1.5454299228647,1.7671264394280135,0.93952572162001,2.188895858121308]]]

Actual:   [[[2.5058, 2.9463, 2.1344, 3.9759], [1.5455, 1.7672, 0.9396, 2.1889]]]

Expected: [[[2.5058, 2.9463, 2.1344, 3.9759], [1.5455, 1.7672, 0.9396, 2.1889]]]