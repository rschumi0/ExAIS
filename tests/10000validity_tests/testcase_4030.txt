import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den89527 = tf.keras.layers.Input(shape=([5, 3, 3]))
in0Con17162 = tf.keras.layers.Input(shape=([1]))
in0Sub33417 = tf.keras.layers.Input(shape=([2]))
in1Sub33417 = tf.keras.layers.Input(shape=([2]))
in0Add90358 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Add90358 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con72043 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Add40736 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Add40736 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Max80308 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Max80308 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Den89527 = keras.layers.Dense(1,name = 'Den89527', )(in0Den89527)
Glo36244 = keras.layers.GlobalAveragePooling2D(name = 'Glo36244', )(Den89527)
Con17162 = keras.layers.Concatenate(axis=1, name = 'Con17162', )([Glo36244,in0Con17162])
Sub33417 = keras.layers.Subtract(name = 'Sub33417', )([in0Sub33417,in1Sub33417])
Sub93433 = keras.layers.Subtract(name = 'Sub93433', )([Con17162,Sub33417])
Res30572 = keras.layers.Reshape((2, 1), name = 'Res30572', )(Sub93433)
Add90358 = keras.layers.Add(name = 'Add90358', )([in0Add90358,in1Add90358])
Res61839 = keras.layers.Reshape((2, 1), name = 'Res61839', )(Add90358)
Add71817 = keras.layers.Add(name = 'Add71817', )([Res30572,Res61839])
Res45001 = keras.layers.Reshape((2, 1, 1), name = 'Res45001', )(Add71817)
Res75670 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res75670', )(Res45001)
Zer82980 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer82980', )(Res75670)
Con72043 = keras.layers.Concatenate(axis=4, name = 'Con72043', )([Zer82980,in0Con72043])
Add40736 = keras.layers.Add(name = 'Add40736', )([in0Add40736,in1Add40736])
Zer22439 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer22439', )(Add40736)
Max80308 = keras.layers.Maximum(name = 'Max80308', )([in0Max80308,in1Max80308])
Add3758 = keras.layers.Add(name = 'Add3758', )([Zer22439,Max80308])
Sub17621 = keras.layers.Subtract(name = 'Sub17621', )([Con72043,Add3758])
model = tf.keras.models.Model(inputs=[in0Den89527,in0Con17162,in0Sub33417,in1Sub33417,in0Add90358,in1Add90358,in0Con72043,in0Add40736,in1Add40736,in0Max80308,in1Max80308], outputs=Sub17621)
w = model.get_layer('Den89527').get_weights() 
w[0] = np.array([[0.1484], [0.0503], [0.8893]])
w[1] = np.array([0.3125])
model.get_layer('Den89527').set_weights(w) 
in0Den89527 = tf.constant([[[[0.4201, 0.205, 0.8207], [0.3302, 0.9921, 0.3411], [0.1134, 0.207, 0.3794]], [[0.792, 0.3634, 0.5244], [0.4041, 0.8934, 0.0546], [0.9406, 0.2156, 0.4625]], [[0.2378, 0.6489, 0.0995], [0.9846, 0.9878, 0.8136], [0.8293, 0.4365, 0.8162]], [[0.6304, 0.8812, 0.2565], [0.6942, 0.0945, 0.76], [0.1886, 0.9138, 0.0451]], [[0.1475, 0.7324, 0.6131], [0.8231, 0.5771, 0.7093], [0.4304, 0.9246, 0.8639]]]])
in0Con17162 = tf.constant([[0.491]])
in0Sub33417 = tf.constant([[0.0206, 0.4135]])
in1Sub33417 = tf.constant([[0.3631, 0.5735]])
in0Add90358 = tf.constant([[[[[0.0188, 0.0077]]]]])
in1Add90358 = tf.constant([[[[[0.0642, 0.4021]]]]])
in0Con72043 = tf.constant([[[[[0.007], [0.7939]]], [[[0.8833], [0.2337]]]]])
in0Add40736 = tf.constant([[[[[0.0366, 0.6754]]], [[[0.5057, 0.4548]]]]])
in1Add40736 = tf.constant([[[[[0.5287, 0.4553]]], [[[0.9928, 0.0638]]]]])
in0Max80308 = tf.constant([[[[[0.9668, 0.5622], [0.4085, 0.9634]]], [[[0.1003, 0.9501], [0.0157, 0.3544]]]]])
in1Max80308 = tf.constant([[[[[0.4454, 0.6102], [0.9067, 0.6316]]], [[[0.8966, 0.2628], [0.9891, 0.324]]]]])
print (np.array2string(model.predict([in0Den89527,in0Con17162,in0Sub33417,in1Sub33417,in0Add90358,in1Add90358,in0Con72043,in0Add40736,in1Add40736,in0Max80308,in1Max80308],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub17621.png')

LDen89527 = dense_layer([[[[0.4201, 0.205, 0.8207], [0.3302, 0.9921, 0.3411], [0.1134, 0.207, 0.3794]], [[0.792, 0.3634, 0.5244], [0.4041, 0.8934, 0.0546], [0.9406, 0.2156, 0.4625]], [[0.2378, 0.6489, 0.0995], [0.9846, 0.9878, 0.8136], [0.8293, 0.4365, 0.8162]], [[0.6304, 0.8812, 0.2565], [0.6942, 0.0945, 0.76], [0.1886, 0.9138, 0.0451]], [[0.1475, 0.7324, 0.6131], [0.8231, 0.5771, 0.7093], [0.4304, 0.9246, 0.8639]]]], [[0.1484], [0.0503], [0.8893]],[0.3125], Den89527), 
LGlo36244 = global_average_pooling2D_layer(Den89527, Glo36244), 
LCon17162 = concatenate_layer([Glo36244,[[0.491]]], 1, Con17162), 
LSub33417 = subtract_layer([[0.0206, 0.4135]], [[0.3631, 0.5735]], Sub33417), 
LSub93433 = subtract_layer(Con17162,Sub33417, Sub93433), 
LRes30572 = reshape_layer(Sub93433, [2, 1], Res30572), 
LAdd90358 = add_layer([[[[[[0.0188, 0.0077]]]]], [[[[[0.0642, 0.4021]]]]]], Add90358), 
LRes61839 = reshape_layer(Add90358, [2, 1], Res61839), 
LAdd71817 = add_layer([Res30572,Res61839], Add71817), 
LRes45001 = reshape_layer(Add71817, [2, 1, 1], Res45001), 
LRes75670 = reshape_layer(Res45001, [2, 1, 1, 1], Res75670), 
LZer82980 = zero_padding3D_layer(Res75670, 0, 0, 0, 0, 1, 0, Zer82980), 
LCon72043 = concatenate_layer([Zer82980,[[[[[0.007], [0.7939]]], [[[0.8833], [0.2337]]]]]], 4, Con72043), 
LAdd40736 = add_layer([[[[[[0.0366, 0.6754]]], [[[0.5057, 0.4548]]]]], [[[[[0.5287, 0.4553]]], [[[0.9928, 0.0638]]]]]], Add40736), 
LZer22439 = zero_padding3D_layer(Add40736, 0, 0, 0, 0, 1, 0, Zer22439), 
LMax80308 = maximum_layer([[[[[[0.9668, 0.5622], [0.4085, 0.9634]]], [[[0.1003, 0.9501], [0.0157, 0.3544]]]]], [[[[[0.4454, 0.6102], [0.9067, 0.6316]]], [[[0.8966, 0.2628], [0.9891, 0.324]]]]]], Max80308), 
LAdd3758 = add_layer([Zer22439,Max80308], Add3758), 
LSub17621 = subtract_layer(Con72043,Add3758, Sub17621), 
exec_layers([LDen89527,LGlo36244,LCon17162,LSub33417,LSub93433,LRes30572,LAdd90358,LRes61839,LAdd71817,LRes45001,LRes75670,LZer82980,LCon72043,LAdd40736,LZer22439,LMax80308,LAdd3758,LSub17621],["Den89527","Glo36244","Con17162","Sub33417","Sub93433","Res30572","Add90358","Res61839","Add71817","Res45001","Res75670","Zer82980","Con72043","Add40736","Zer22439","Max80308","Add3758","Sub17621"],Sub17621,"Sub17621")

Actual (Unparsed): [[[[[-0.9668000, -0.6032000], [-0.1765597, -1.3002000]]], [[[-0.8966000, -0.0668000], [-1.4268000, -0.6393000]]]]]

Expected (Unparsed): [[[[[-0.9668,-0.6032],[-0.17655966800000011,-1.3002]]],[[[-0.8966,-0.06679999999999997],[-1.4268,-0.6393]]]]]

Actual:   [[[[[-0.9668, -0.6032], [-0.1765, -1.3002]]], [[[-0.8966, -0.0668], [-1.4268, -0.6393]]]]]

Expected: [[[[[-0.9668, -0.6032], [-0.1765, -1.3002]]], [[[-0.8966, -0.0667], [-1.4268, -0.6393]]]]]