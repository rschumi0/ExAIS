import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max25671 = tf.keras.layers.Input(shape=([1, 2, 2]))

Max25671 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max25671', )(in0Max25671)
Res91580 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res91580', )(Max25671)
Up_24319 = keras.layers.UpSampling3D(size=(2, 2, 1), name = 'Up_24319', )(Res91580)
Res29699 = keras.layers.Reshape((2, 4, 2), name = 'Res29699', )(Up_24319)
Res89936 = keras.layers.Reshape((2, 8), name = 'Res89936', )(Res29699)
Glo78182 = keras.layers.GlobalMaxPool1D(name = 'Glo78182', )(Res89936)
Res70936 = keras.layers.Reshape((8, 1), name = 'Res70936', )(Glo78182)
Res31988 = keras.layers.Reshape((8, 1, 1), name = 'Res31988', )(Res70936)
Res25532 = keras.layers.Reshape((8, 1, 1, 1), name = 'Res25532', )(Res31988)
Zer87394 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer87394', )(Res25532)
Res78799 = keras.layers.Reshape((10, 3, 3), name = 'Res78799', )(Zer87394)
Res10717 = keras.layers.Reshape((10, 9), name = 'Res10717', )(Res78799)
Con10056 = keras.layers.Conv1D(2, (9),strides=(1), padding='valid', dilation_rate=(1), name = 'Con10056', )(Res10717)
GRU41194 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU41194', )(Con10056)
model = tf.keras.models.Model(inputs=[in0Max25671], outputs=GRU41194)
w = model.get_layer('Con10056').get_weights() 
w[0] = np.array([[[0.2844, 0.2699], [0.8255, 0.6699], [0.0358, 0.2102], [0.1651, 0.0979], [0.9082, 0.795], [0.1793, 0.9097], [0.0301, 0.9428], [0.0061, 0.6407], [0.0068, 0.9544]], [[0.4953, 0.292], [0.5398, 0.4939], [0.848, 0.802], [0.4212, 0.8108], [0.2951, 0.6891], [0.7141, 0.7664], [0.984, 0.2593], [0.745, 0.5512], [0.8852, 0.0479]], [[0.2599, 0.4625], [0.5852, 0.1037], [0.7251, 0.748], [0.2884, 0.3093], [0.2897, 0.317], [0.2154, 0.1832], [0.3679, 0.0684], [0.8553, 0.509], [0.1521, 0.6946]], [[0.2077, 0.6993], [0.6154, 0.0781], [0.2309, 0.0156], [0.7322, 0.8229], [0.2037, 0.6386], [0.7042, 0.0323], [0.6038, 0.1128], [0.96, 0.1789], [0.4056, 0.8703]], [[0.5708, 0.8005], [0.4118, 0.384], [0.5155, 0.7987], [0.3423, 0.9936], [0.9162, 0.317], [0.9309, 0.6045], [0.969, 0.5318], [0.2003, 0.2654], [0.7937, 0.2043]], [[0.4238, 0.1005], [0.8442, 0.5064], [0.0202, 0.1908], [0.8318, 0.4624], [0.7718, 0.7795], [0.3428, 0.3283], [0.3097, 0.609], [0.4578, 0.3681], [0.7684, 0.2914]], [[0.7191, 0.7806], [0.8733, 0.3558], [0.7326, 0.9808], [0.4989, 0.0261], [0.5418, 0.0455], [0.9099, 0.8352], [0.6626, 0.8973], [0.4809, 0.9042], [0.3335, 0.7165]], [[0.6796, 0.0818], [0.0996, 0.1512], [0.4945, 0.1698], [0.3231, 0.1206], [0.2894, 0.147], [0.5945, 0.401], [0.2745, 0.6396], [0.3026, 0.7215], [0.3994, 0.8893]], [[0.8156, 0.8022], [0.4926, 0.1181], [0.8235, 0.6208], [0.8997, 0.5025], [0.3962, 0.2063], [0.7048, 0.9338], [0.2242, 0.4296], [0.8595, 0.3625], [0.325, 0.5834]]])
w[1] = np.array([0, 0])
model.get_layer('Con10056').set_weights(w) 
w = model.get_layer('GRU41194').get_weights() 
w[0] = np.array([[6, 1, 2, 9, 2, 3], [4, 9, 5, 2, 4, 7]])
w[1] = np.array([[2, 7, 6, 2, 10, 8], [4, 1, 8, 8, 4, 3]])
w[2] = np.array([6, 5, 8, 5, 1, 9])
model.get_layer('GRU41194').set_weights(w) 
in0Max25671 = tf.constant([[[[1.0633, 1.7332], [1.3844, 1.6989]]]])
print (np.array2string(model.predict([in0Max25671],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU41194.png')

LMax25671 = max_pool2D_layer([[[[1.0633, 1.7332], [1.3844, 1.6989]]]], 1, 1, Max25671), 
LRes91580 = reshape_layer(Max25671, [1, 2, 2, 1], Res91580), 
LUp_24319 = up_sampling3D_layer(Res91580, 2, 2, 1, Up_24319), 
LRes29699 = reshape_layer(Up_24319, [2, 4, 2], Res29699), 
LRes89936 = reshape_layer(Res29699, [2, 8], Res89936), 
LGlo78182 = global_max_pool1D_layer(Res89936, Glo78182), 
LRes70936 = reshape_layer(Glo78182, [8, 1], Res70936), 
LRes31988 = reshape_layer(Res70936, [8, 1, 1], Res31988), 
LRes25532 = reshape_layer(Res31988, [8, 1, 1, 1], Res25532), 
LZer87394 = zero_padding3D_layer(Res25532, 1, 1, 1, 1, 1, 1, Zer87394), 
LRes78799 = reshape_layer(Zer87394, [10, 3, 3], Res78799), 
LRes10717 = reshape_layer(Res78799, [10, 9], Res10717), 
LCon10056 = conv1D_layer(Res10717, 9,[[[0.2844, 0.2699], [0.8255, 0.6699], [0.0358, 0.2102], [0.1651, 0.0979], [0.9082, 0.795], [0.1793, 0.9097], [0.0301, 0.9428], [0.0061, 0.6407], [0.0068, 0.9544]], [[0.4953, 0.292], [0.5398, 0.4939], [0.848, 0.802], [0.4212, 0.8108], [0.2951, 0.6891], [0.7141, 0.7664], [0.984, 0.2593], [0.745, 0.5512], [0.8852, 0.0479]], [[0.2599, 0.4625], [0.5852, 0.1037], [0.7251, 0.748], [0.2884, 0.3093], [0.2897, 0.317], [0.2154, 0.1832], [0.3679, 0.0684], [0.8553, 0.509], [0.1521, 0.6946]], [[0.2077, 0.6993], [0.6154, 0.0781], [0.2309, 0.0156], [0.7322, 0.8229], [0.2037, 0.6386], [0.7042, 0.0323], [0.6038, 0.1128], [0.96, 0.1789], [0.4056, 0.8703]], [[0.5708, 0.8005], [0.4118, 0.384], [0.5155, 0.7987], [0.3423, 0.9936], [0.9162, 0.317], [0.9309, 0.6045], [0.969, 0.5318], [0.2003, 0.2654], [0.7937, 0.2043]], [[0.4238, 0.1005], [0.8442, 0.5064], [0.0202, 0.1908], [0.8318, 0.4624], [0.7718, 0.7795], [0.3428, 0.3283], [0.3097, 0.609], [0.4578, 0.3681], [0.7684, 0.2914]], [[0.7191, 0.7806], [0.8733, 0.3558], [0.7326, 0.9808], [0.4989, 0.0261], [0.5418, 0.0455], [0.9099, 0.8352], [0.6626, 0.8973], [0.4809, 0.9042], [0.3335, 0.7165]], [[0.6796, 0.0818], [0.0996, 0.1512], [0.4945, 0.1698], [0.3231, 0.1206], [0.2894, 0.147], [0.5945, 0.401], [0.2745, 0.6396], [0.3026, 0.7215], [0.3994, 0.8893]], [[0.8156, 0.8022], [0.4926, 0.1181], [0.8235, 0.6208], [0.8997, 0.5025], [0.3962, 0.2063], [0.7048, 0.9338], [0.2242, 0.4296], [0.8595, 0.3625], [0.325, 0.5834]]],[0, 0], 1, false, 1, Con10056), 
LGRU41194 = gru_layer(Con10056,[[6, 1, 2, 9, 2, 3], [4, 9, 5, 2, 4, 7]],[[2, 7, 6, 2, 10, 8], [4, 1, 8, 8, 4, 3]],[6, 5, 8, 5, 1, 9], false, GRU41194), 
exec_layers([LMax25671,LRes91580,LUp_24319,LRes29699,LRes89936,LGlo78182,LRes70936,LRes31988,LRes25532,LZer87394,LRes78799,LRes10717,LCon10056,LGRU41194],["Max25671","Res91580","Up_24319","Res29699","Res89936","Glo78182","Res70936","Res31988","Res25532","Zer87394","Res78799","Res10717","Con10056","GRU41194"],GRU41194,"GRU41194")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0]]

Actual:   [[0, 0]]

Expected: [[0, 0]]