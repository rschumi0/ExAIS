import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min20380 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Min20380 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Min20380 = keras.layers.Minimum(name = 'Min20380', )([in0Min20380,in1Min20380])
Res71212 = keras.layers.Reshape((1, 1, 4), name = 'Res71212', )(Min20380)
Res73374 = keras.layers.Reshape((1, 4), name = 'Res73374', )(Res71212)
Zer37656 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer37656', )(Res73374)
Sof10606 = keras.layers.Softmax(axis=1, name = 'Sof10606', )(Zer37656)
Lay22073 = keras.layers.LayerNormalization(axis=1, epsilon=2.3173395919639965, name = 'Lay22073', )(Sof10606)
model = tf.keras.models.Model(inputs=[in0Min20380,in1Min20380], outputs=Lay22073)
in0Min20380 = tf.constant([[[[[0.3713, 0.8131], [0.2581, 0.1045]]]]])
in1Min20380 = tf.constant([[[[[0.131, 0.8276], [0.7633, 0.3967]]]]])
print (np.array2string(model.predict([in0Min20380,in1Min20380],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay22073.png')

LMin20380 = minimum_layer([[[[[[0.3713, 0.8131], [0.2581, 0.1045]]]]], [[[[[0.131, 0.8276], [0.7633, 0.3967]]]]]], Min20380), 
LRes71212 = reshape_layer(Min20380, [1, 1, 4], Res71212), 
LRes73374 = reshape_layer(Res71212, [1, 4], Res73374), 
LZer37656 = zero_padding1D_layer(Res73374, 1, 1, Zer37656), 
LSof10606 = softmax_layer(Zer37656, 1, Sof10606), 
LLay22073 = layer_normalization_layer(Sof10606, 1, 2.3173395919639965, Lay22073), 
exec_layers([LMin20380,LRes71212,LRes73374,LZer37656,LSof10606,LLay22073],["Min20380","Res71212","Res73374","Zer37656","Sof10606","Lay22073"],Lay22073,"Lay22073")

Actual (Unparsed): [[[-0.0097599, -0.0643127, -0.0195646, -0.0077550], [0.0195198, 0.1286254, 0.0391292, 0.0155100], [-0.0097599, -0.0643127, -0.0195646, -0.0077550]]]

Expected (Unparsed): [[[-0.009759901128004678,-0.06431270901592481,-0.019564590645333346,-0.0077549939566851425],[0.019519802256009317,0.12862541803184963,0.039129181290666726,0.015509987913370358],[-0.009759901128004678,-0.06431270901592481,-0.019564590645333346,-0.0077549939566851425]]]

Actual:   [[[-0.0097, -0.0643, -0.0195, -0.0077], [0.0196, 0.1287, 0.0392, 0.0156], [-0.0097, -0.0643, -0.0195, -0.0077]]]

Expected: [[[-0.0097, -0.0643, -0.0195, -0.0077], [0.0196, 0.1287, 0.0392, 0.0156], [-0.0097, -0.0643, -0.0195, -0.0077]]]