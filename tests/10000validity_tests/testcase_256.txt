import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave74799 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Max95696 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Max95696 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Sub18326 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub18326 = tf.keras.layers.Input(shape=([2, 3]))
in0Con38658 = tf.keras.layers.Input(shape=([2, 1]))

Ave74799 = keras.layers.AveragePooling2D(pool_size=(2, 1), name = 'Ave74799', )(in0Ave74799)
Res28822 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res28822', )(Ave74799)
Zer22203 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer22203', )(Res28822)
Max95696 = keras.layers.Maximum(name = 'Max95696', )([in0Max95696,in1Max95696])
Add6677 = keras.layers.Add(name = 'Add6677', )([Zer22203,Max95696])
Res29057 = keras.layers.Reshape((2, 2, 2), name = 'Res29057', )(Add6677)
Res83332 = keras.layers.Reshape((2, 4), name = 'Res83332', )(Res29057)
Sub18326 = keras.layers.Subtract(name = 'Sub18326', )([in0Sub18326,in1Sub18326])
Con38658 = keras.layers.Concatenate(axis=2, name = 'Con38658', )([Sub18326,in0Con38658])
Max74517 = keras.layers.Maximum(name = 'Max74517', )([Res83332,Con38658])
Con2687 = keras.layers.Conv1D(4, (1),strides=(2), padding='same', dilation_rate=(1), name = 'Con2687', )(Max74517)
Den11195 = keras.layers.Dense(3,name = 'Den11195', )(Con2687)
model = tf.keras.models.Model(inputs=[in0Ave74799,in0Max95696,in1Max95696,in0Sub18326,in1Sub18326,in0Con38658], outputs=Den11195)
w = model.get_layer('Con2687').get_weights() 
w[0] = np.array([[[0.1123, 0.6122, 0.1906, 0.4799], [0.1741, 0.865, 0.2162, 0.3407], [0.8579, 0.7871, 0.1649, 0.8111], [0.5797, 0.2913, 0.9652, 0.5608]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con2687').set_weights(w) 
w = model.get_layer('Den11195').get_weights() 
w[0] = np.array([[0.895, 0.8317, 0.4679], [0.2921, 0.0853, 0.5322], [0.1111, 0.0972, 0.2391], [0.5894, 0.8682, 0.9638]])
w[1] = np.array([0.301, 0.4904, 0.7311])
model.get_layer('Den11195').set_weights(w) 
in0Ave74799 = tf.constant([[[[1.9613, 1.0555], [1.1453, 1.2053]], [[1.4049, 1.8239], [1.4056, 1.3302]]]])
in0Max95696 = tf.constant([[[[[0.3833], [0.6028]], [[0.9461], [0.5637]]], [[[0.8075], [0.5859]], [[0.3281], [0.8866]]]]])
in1Max95696 = tf.constant([[[[[0.3552], [0.4143]], [[0.3898], [0.5087]]], [[[0.051], [0.0256]], [[0.9432], [0.3707]]]]])
in0Sub18326 = tf.constant([[[0.7558, 0.3567, 0.9286], [0.3322, 0.8011, 0.1713]]])
in1Sub18326 = tf.constant([[[0.4343, 0.4561, 0.4462], [0.23, 0.2559, 0.706]]])
in0Con38658 = tf.constant([[[0.4642], [0.0334]]])
print (np.array2string(model.predict([in0Ave74799,in0Max95696,in1Max95696,in0Sub18326,in1Sub18326,in0Con38658],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den11195.png')

LAve74799 = average_pooling2D_layer([[[[1.9613, 1.0555], [1.1453, 1.2053]], [[1.4049, 1.8239], [1.4056, 1.3302]]]], 2, 1, Ave74799), 
LRes28822 = reshape_layer(Ave74799, [1, 2, 2, 1], Res28822), 
LZer22203 = zero_padding3D_layer(Res28822, 1, 0, 0, 0, 0, 0, Zer22203), 
LMax95696 = maximum_layer([[[[[[0.3833], [0.6028]], [[0.9461], [0.5637]]], [[[0.8075], [0.5859]], [[0.3281], [0.8866]]]]], [[[[[0.3552], [0.4143]], [[0.3898], [0.5087]]], [[[0.051], [0.0256]], [[0.9432], [0.3707]]]]]], Max95696), 
LAdd6677 = add_layer([Zer22203,Max95696], Add6677), 
LRes29057 = reshape_layer(Add6677, [2, 2, 2], Res29057), 
LRes83332 = reshape_layer(Res29057, [2, 4], Res83332), 
LSub18326 = subtract_layer([[[0.7558, 0.3567, 0.9286], [0.3322, 0.8011, 0.1713]]], [[[0.4343, 0.4561, 0.4462], [0.23, 0.2559, 0.706]]], Sub18326), 
LCon38658 = concatenate_layer([Sub18326,[[[0.4642], [0.0334]]]], 2, Con38658), 
LMax74517 = maximum_layer([Res83332,Con38658], Max74517), 
LCon2687 = conv1D_layer(Max74517, 1,[[[0.1123, 0.6122, 0.1906, 0.4799], [0.1741, 0.865, 0.2162, 0.3407], [0.8579, 0.7871, 0.1649, 0.8111], [0.5797, 0.2913, 0.9652, 0.5608]]],[0, 0, 0, 0], 2, true, 1, Con2687), 
LDen11195 = dense_layer(Con2687, [[0.895, 0.8317, 0.4679], [0.2921, 0.0853, 0.5322], [0.1111, 0.0972, 0.2391], [0.5894, 0.8682, 0.9638]],[0.301, 0.4904, 0.7311], Den11195), 
exec_layers([LAve74799,LRes28822,LZer22203,LMax95696,LAdd6677,LRes29057,LRes83332,LSub18326,LCon38658,LMax74517,LCon2687,LDen11195],["Ave74799","Res28822","Zer22203","Max95696","Add6677","Res29057","Res83332","Sub18326","Con38658","Max74517","Con2687","Den11195"],Den11195,"Den11195")

Actual (Unparsed): [[[2.9071468, 3.0688674, 3.8546407]]]

Expected (Unparsed): [[[2.9071468184850002,3.068867394813,3.854640636838]]]

Actual:   [[[2.9072, 3.0689, 3.8547]]]

Expected: [[[2.9072, 3.0689, 3.8547]]]