import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul5358 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul5358 = tf.keras.layers.Input(shape=([1, 2]))

Mul5358 = keras.layers.Multiply(name = 'Mul5358', )([in0Mul5358,in1Mul5358])
Zer65004 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer65004', )(Mul5358)
Res25199 = keras.layers.Reshape((3, 2, 1), name = 'Res25199', )(Zer65004)
Zer88981 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer88981', )(Res25199)
model = tf.keras.models.Model(inputs=[in0Mul5358,in1Mul5358], outputs=Zer88981)
in0Mul5358 = tf.constant([[[0.6484, 0.1308]]])
in1Mul5358 = tf.constant([[[0.5165, 0.698]]])
print (np.array2string(model.predict([in0Mul5358,in1Mul5358],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer88981.png')

LMul5358 = multiply_layer([[[[0.6484, 0.1308]]], [[[0.5165, 0.698]]]], Mul5358), 
LZer65004 = zero_padding1D_layer(Mul5358, 1, 1, Zer65004), 
LRes25199 = reshape_layer(Zer65004, [3, 2, 1], Res25199), 
LZer88981 = zero_padding2D_layer(Res25199, 1, 1, 1, 1, Zer88981), 
exec_layers([LMul5358,LZer65004,LRes25199,LZer88981],["Mul5358","Zer65004","Res25199","Zer88981"],Zer88981,"Zer88981")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.3348986], [0.0912984], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0.33489859999999994],[0.09129839999999999],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0.3349], [0.0913], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0.3349], [0.0913], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]