import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add45002 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Add45002 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Add45002 = keras.layers.Add(name = 'Add45002', )([in0Add45002,in1Add45002])
Res95565 = keras.layers.Reshape((1, 2, 1), name = 'Res95565', )(Add45002)
Res45337 = keras.layers.Reshape((1, 2), name = 'Res45337', )(Res95565)
Con78163 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con78163', )(Res45337)
GRU7311 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU7311', )(Con78163)
model = tf.keras.models.Model(inputs=[in0Add45002,in1Add45002], outputs=GRU7311)
w = model.get_layer('Con78163').get_weights() 
w[0] = np.array([[[0.5744, 0.5021], [0.362, 0.0765]]])
w[1] = np.array([0, 0])
model.get_layer('Con78163').set_weights(w) 
w = model.get_layer('GRU7311').get_weights() 
w[0] = np.array([[1, 10, 9, 10, 5, 3], [1, 3, 9, 5, 6, 3]])
w[1] = np.array([[10, 1, 3, 5, 7, 8], [5, 6, 5, 7, 4, 7]])
w[2] = np.array([[9, 10, 4, 5, 4, 8], [5, 4, 5, 10, 2, 4]])
model.get_layer('GRU7311').set_weights(w) 
in0Add45002 = tf.constant([[[[[0.5927]], [[0.7242]]]]])
in1Add45002 = tf.constant([[[[[0.7235]], [[0.433]]]]])
print (np.array2string(model.predict([in0Add45002,in1Add45002],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU7311.png')

LAdd45002 = add_layer([[[[[[0.5927]], [[0.7242]]]]], [[[[[0.7235]], [[0.433]]]]]], Add45002), 
LRes95565 = reshape_layer(Add45002, [1, 2, 1], Res95565), 
LRes45337 = reshape_layer(Res95565, [1, 2], Res45337), 
LCon78163 = conv1D_layer(Res45337, 1,[[[0.5744, 0.5021], [0.362, 0.0765]]],[0, 0], 1, true, 1, Con78163), 
LGRU7311 = gru_layer(Con78163,[[1, 10, 9, 10, 5, 3], [1, 3, 9, 5, 6, 3]],[[10, 1, 3, 5, 7, 8], [5, 6, 5, 7, 4, 7]],[[9, 10, 4, 5, 4, 8], [5, 4, 5, 10, 2, 4]], true, GRU7311), 
exec_layers([LAdd45002,LRes95565,LRes45337,LCon78163,LGRU7311],["Add45002","Res95565","Res45337","Con78163","GRU7311"],GRU7311,"GRU7311")

Actual (Unparsed): [[0.0000001, 0.0000000]]

Expected (Unparsed): [[1.2138219640522717e-7,6.932232565759472e-13]]

Actual:   [[0, 0]]

Expected: [[0, 0]]