import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min33641 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Min33641 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0PRe22709 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Glo33744 = tf.keras.layers.Input(shape=([1, 1]))
in0PRe9772 = tf.keras.layers.Input(shape=([2, 1]))
in0Con15674 = tf.keras.layers.Input(shape=([2, 1]))
in0Cro10858 = tf.keras.layers.Input(shape=([2, 1, 4, 3]))
in0Con53771 = tf.keras.layers.Input(shape=([3]))

Min33641 = keras.layers.Minimum(name = 'Min33641', )([in0Min33641,in1Min33641])
Res13577 = keras.layers.Reshape((2, 2, 1), name = 'Res13577', )(Min33641)
Res84171 = keras.layers.Reshape((2, 2), name = 'Res84171', )(Res13577)
PRe22709 = keras.layers.PReLU(name = 'PRe22709', input_shape=(2, 1, 2))(in0PRe22709)
Res69419 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res69419', )(PRe22709)
Cro76863 = keras.layers.Cropping3D(cropping=((1, 0), (0, 0), (1, 0)), name = 'Cro76863', )(Res69419)
Res35210 = keras.layers.Reshape((1, 1, 1), name = 'Res35210', )(Cro76863)
Res90739 = keras.layers.Reshape((1, 1), name = 'Res90739', )(Res35210)
Zer68056 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer68056', )(Res90739)
Glo33744 = keras.layers.GlobalAveragePooling1D(name = 'Glo33744', )(in0Glo33744)
Res87212 = keras.layers.Reshape((1, 1), name = 'Res87212', )(Glo33744)
Zer76815 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer76815', )(Res87212)
PRe9772 = keras.layers.PReLU(name = 'PRe9772', input_shape=(2, 1))(in0PRe9772)
Add92070 = keras.layers.Add(name = 'Add92070', )([Zer76815,PRe9772])
Max46826 = keras.layers.Maximum(name = 'Max46826', )([Zer68056,Add92070])
Con15674 = keras.layers.Concatenate(axis=2, name = 'Con15674', )([Max46826,in0Con15674])
Min1514 = keras.layers.Minimum(name = 'Min1514', )([Res84171,Con15674])
Fla16257 = keras.layers.Flatten(name = 'Fla16257', )(Min1514)
Cro10858 = keras.layers.Cropping3D(cropping=((0, 1), (0, 0), (0, 1)), name = 'Cro10858', )(in0Cro10858)
Res23640 = keras.layers.Reshape((1, 1, 9), name = 'Res23640', )(Cro10858)
Res42829 = keras.layers.Reshape((1, 9), name = 'Res42829', )(Res23640)
Max19300 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='same', name = 'Max19300', )(Res42829)
Per39422 = keras.layers.Permute((1,2), name = 'Per39422',)(Max19300)
Res94483 = keras.layers.Reshape((1, 9, 1), name = 'Res94483', )(Per39422)
Cro87725 = keras.layers.Cropping2D(cropping=((0, 0), (1, 0)), name = 'Cro87725', )(Res94483)
Glo48145 = keras.layers.GlobalMaxPool2D(name = 'Glo48145', )(Cro87725)
Con53771 = keras.layers.Concatenate(axis=1, name = 'Con53771', )([Glo48145,in0Con53771])
Ave39812 = keras.layers.Average(name = 'Ave39812', )([Fla16257,Con53771])
model = tf.keras.models.Model(inputs=[in0Min33641,in1Min33641,in0PRe22709,in0Glo33744,in0PRe9772,in0Con15674,in0Cro10858,in0Con53771], outputs=Ave39812)
w = model.get_layer('PRe22709').get_weights() 
w[0] = np.array([[[0.2028, 0.344]], [[0.4426, 0.6515]]])
model.get_layer('PRe22709').set_weights(w) 
w = model.get_layer('PRe9772').get_weights() 
w[0] = np.array([[0.6513], [0.4984]])
model.get_layer('PRe9772').set_weights(w) 
in0Min33641 = tf.constant([[[[[0.5002]], [[0.0167]]], [[[0.8606]], [[0.8139]]]]])
in1Min33641 = tf.constant([[[[[0.2244]], [[0.6827]]], [[[0.5289]], [[0.3952]]]]])
in0PRe22709 = tf.constant([[[[0.3511, 0.2484]], [[0.2893, 0.3165]]]])
in0Glo33744 = tf.constant([[[1.1647]]])
in0PRe9772 = tf.constant([[[0.1606], [0.666]]])
in0Con15674 = tf.constant([[[0.5286], [0.0643]]])
in0Cro10858 = tf.constant([[[[[1.2629, 1.1862, 1.5799], [1.6576, 1.8855, 1.2699], [1.4074, 1.0722, 1.108], [1.8562, 1.6436, 1.0636]]], [[[1.9165, 1.1663, 1.4333], [1.346, 1.6777, 1.9213], [1.0168, 1.8136, 1.4781], [1.1169, 1.0741, 1.1908]]]]])
in0Con53771 = tf.constant([[0.2916, 0.2923, 0.9431]])
print (np.array2string(model.predict([in0Min33641,in1Min33641,in0PRe22709,in0Glo33744,in0PRe9772,in0Con15674,in0Cro10858,in0Con53771],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave39812.png')

LMin33641 = minimum_layer([[[[[[0.5002]], [[0.0167]]], [[[0.8606]], [[0.8139]]]]], [[[[[0.2244]], [[0.6827]]], [[[0.5289]], [[0.3952]]]]]], Min33641), 
LRes13577 = reshape_layer(Min33641, [2, 2, 1], Res13577), 
LRes84171 = reshape_layer(Res13577, [2, 2], Res84171), 
LPRe22709 = prelu_layer([[[[0.3511, 0.2484]], [[0.2893, 0.3165]]]], [[[0.2028, 0.344]], [[0.4426, 0.6515]]], PRe22709), 
LRes69419 = reshape_layer(PRe22709, [2, 1, 2, 1], Res69419), 
LCro76863 = cropping3D_layer(Res69419, 1, 0, 0, 0, 1, 0, Cro76863), 
LRes35210 = reshape_layer(Cro76863, [1, 1, 1], Res35210), 
LRes90739 = reshape_layer(Res35210, [1, 1], Res90739), 
LZer68056 = zero_padding1D_layer(Res90739, 1, 0, Zer68056), 
LGlo33744 = global_average_pooling1D_layer([[[1.1647]]], Glo33744), 
LRes87212 = reshape_layer(Glo33744, [1, 1], Res87212), 
LZer76815 = zero_padding1D_layer(Res87212, 1, 0, Zer76815), 
LPRe9772 = prelu_layer([[[0.1606], [0.666]]], [[0.6513], [0.4984]], PRe9772), 
LAdd92070 = add_layer([Zer76815,PRe9772], Add92070), 
LMax46826 = maximum_layer([Zer68056,Add92070], Max46826), 
LCon15674 = concatenate_layer([Max46826,[[[0.5286], [0.0643]]]], 2, Con15674), 
LMin1514 = minimum_layer([Res84171,Con15674], Min1514), 
LFla16257 = flatten_layer(Min1514, Fla16257), 
LCro10858 = cropping3D_layer([[[[[1.2629, 1.1862, 1.5799], [1.6576, 1.8855, 1.2699], [1.4074, 1.0722, 1.108], [1.8562, 1.6436, 1.0636]]], [[[1.9165, 1.1663, 1.4333], [1.346, 1.6777, 1.9213], [1.0168, 1.8136, 1.4781], [1.1169, 1.0741, 1.1908]]]]], 0, 1, 0, 0, 0, 1, Cro10858), 
LRes23640 = reshape_layer(Cro10858, [1, 1, 9], Res23640), 
LRes42829 = reshape_layer(Res23640, [1, 9], Res42829), 
LMax19300 = max_pool1D_layer(Res42829, 1, 1, true, Max19300), 
LPer39422 = permute_layer(Max19300, 1,2, Per39422), 
LRes94483 = reshape_layer(Per39422, [1, 9, 1], Res94483), 
LCro87725 = cropping2D_layer(Res94483, 0, 0, 1, 0, Cro87725), 
LGlo48145 = global_max_pool2D_layer(Cro87725, Glo48145), 
LCon53771 = concatenate_layer([Glo48145,[[0.2916, 0.2923, 0.9431]]], 1, Con53771), 
LAve39812 = average_layer([Fla16257,Con53771], Ave39812), 
exec_layers([LMin33641,LRes13577,LRes84171,LPRe22709,LRes69419,LCro76863,LRes35210,LRes90739,LZer68056,LGlo33744,LRes87212,LZer76815,LPRe9772,LAdd92070,LMax46826,LCon15674,LMin1514,LFla16257,LCro10858,LRes23640,LRes42829,LMax19300,LPer39422,LRes94483,LCro87725,LGlo48145,LCon53771,LAve39812],["Min33641","Res13577","Res84171","PRe22709","Res69419","Cro76863","Res35210","Res90739","Zer68056","Glo33744","Res87212","Zer76815","PRe9772","Add92070","Max46826","Con15674","Min1514","Fla16257","Cro10858","Res23640","Res42829","Max19300","Per39422","Res94483","Cro87725","Glo48145","Con53771","Ave39812"],Ave39812,"Ave39812")

Actual (Unparsed): [[1.0230500, 0.1541500, 0.4106000, 0.5037000]]

Expected (Unparsed): [[1.02305,0.15415,0.4106,0.5037]]

Actual:   [[1.0231, 0.1542, 0.4106, 0.5037]]

Expected: [[1.0231, 0.1542, 0.4106, 0.5037]]