import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con2295 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0PRe80009 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Ave71427 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave71427 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con83102 = tf.keras.layers.Input(shape=([61]))
in0Con25742 = tf.keras.layers.Input(shape=([2]))

Con2295 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 1), padding='same', name = 'Con2295', )(in0Con2295)
Lea44693 = keras.layers.LeakyReLU(alpha=4.867507507661386, name = 'Lea44693', )(Con2295)
Glo30721 = keras.layers.GlobalAveragePooling2D(name = 'Glo30721', )(Lea44693)
PRe80009 = keras.layers.PReLU(name = 'PRe80009', input_shape=(2, 2, 2, 2))(in0PRe80009)
Res7493 = keras.layers.Reshape((2, 2, 4), name = 'Res7493', )(PRe80009)
Res39317 = keras.layers.Reshape((2, 8), name = 'Res39317', )(Res7493)
Res40874 = keras.layers.Reshape((2, 8, 1), name = 'Res40874', )(Res39317)
Res89181 = keras.layers.Reshape((2, 8, 1, 1), name = 'Res89181', )(Res40874)
Con8539 = keras.layers.Conv3D(4, (1, 8, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con8539', )(Res89181)
Res64334 = keras.layers.Reshape((2, 8, 4), name = 'Res64334', )(Con8539)
Res97317 = keras.layers.Reshape((2, 32), name = 'Res97317', )(Res64334)
Fla76487 = keras.layers.Flatten(name = 'Fla76487', )(Res97317)
Ave71427 = keras.layers.Average(name = 'Ave71427', )([in0Ave71427,in1Ave71427])
Res15607 = keras.layers.Reshape((2, 2), name = 'Res15607', )(Ave71427)
LST82605 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST82605', )(Res15607)
Bat78447 = keras.layers.BatchNormalization(axis=1, epsilon=0.26866128908308573,  name = 'Bat78447', )(LST82605)
Con83102 = keras.layers.Concatenate(axis=1, name = 'Con83102', )([Bat78447,in0Con83102])
Mul6400 = keras.layers.Multiply(name = 'Mul6400', )([Fla76487,Con83102])
Res39613 = keras.layers.Reshape((64, 1), name = 'Res39613', )(Mul6400)
Res80932 = keras.layers.Reshape((64, 1, 1), name = 'Res80932', )(Res39613)
Glo88064 = keras.layers.GlobalAveragePooling2D(name = 'Glo88064', )(Res80932)
Con25742 = keras.layers.Concatenate(axis=1, name = 'Con25742', )([Glo88064,in0Con25742])
Add2108 = keras.layers.Add(name = 'Add2108', )([Glo30721,Con25742])
model = tf.keras.models.Model(inputs=[in0Con2295,in0PRe80009,in0Ave71427,in1Ave71427,in0Con83102,in0Con25742], outputs=Add2108)
w = model.get_layer('Con2295').get_weights() 
w[0] = np.array([[[[0.9182, 0.6246], [0.8469, 0.9233], [0.5123, 0.2773]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con2295').set_weights(w) 
w = model.get_layer('PRe80009').get_weights() 
w[0] = np.array([[[[0.4476, 0.1569], [0.224, 0.5242]], [[0.828, 0.6691], [0.5289, 0.2432]]], [[[0.0745, 0.8054], [0.1959, 0.2291]], [[0.5014, 0.3314], [0.4217, 0.1234]]]])
model.get_layer('PRe80009').set_weights(w) 
w = model.get_layer('Con8539').get_weights() 
w[0] = np.array([[[[[0.7809, 0.994, 0.7697, 0.6689]]], [[[0.8409, 0.0372, 0.2829, 0.9819]]], [[[0.3321, 0.0054, 0.416, 0.1206]]], [[[0.4992, 0.1179, 0.747, 0.2483]]], [[[0.4062, 0.8227, 0.0986, 0.1683]]], [[[0.0809, 0.2205, 0.1311, 0.4991]]], [[[0.6794, 0.6401, 0.4538, 0.1743]]], [[[0.0232, 0.0824, 0.1795, 0.3718]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con8539').set_weights(w) 
w = model.get_layer('LST82605').get_weights() 
w[0] = np.array([[8, 8, 5, 8, 10, 10, 4, 1, 1, 1, 5, 6], [3, 1, 6, 9, 9, 8, 5, 1, 2, 4, 6, 9]])
w[1] = np.array([[5, 9, 8, 1, 10, 2, 7, 6, 3, 10, 2, 8], [5, 8, 6, 10, 6, 7, 5, 9, 5, 9, 9, 9], [4, 5, 3, 4, 4, 8, 4, 3, 4, 4, 2, 1]])
w[2] = np.array([9, 9, 5, 2, 5, 8, 9, 3, 5, 1, 5, 4])
model.get_layer('LST82605').set_weights(w) 
w = model.get_layer('Bat78447').get_weights() 
w[0] = np.array([0.5155, 0.7228, 0.6328])
w[1] = np.array([0.6239, 0.852, 0.8697])
w[2] = np.array([0.9091, 0.3701, 0.8811])
w[3] = np.array([0.0116, 0.5671, 0.304])
model.get_layer('Bat78447').set_weights(w) 
in0Con2295 = tf.constant([[[[0.1421, 0.8612], [0.2776, 0.6932]]]])
in0PRe80009 = tf.constant([[[[[0.8726, 0.6648], [0.4562, 0.155]], [[0.1991, 0.2247], [0.2735, 0.1405]]], [[[0.8094, 0.7882], [0.6753, 0.4605]], [[0.6822, 0.0173], [0.8397, 0.6094]]]]])
in0Ave71427 = tf.constant([[[[0.4185, 0.8766]], [[0.7916, 0.7806]]]])
in1Ave71427 = tf.constant([[[[0.4799, 0.3018]], [[0.0574, 0.741]]]])
in0Con83102 = tf.constant([[0.3756, 0.826, 0.8306, 0.4933, 0.1197, 0.3127, 0.4571, 0.5381, 0.4936, 0.8571, 0.9787, 0.2113, 0.3561, 0.7371, 0.1453, 0.7132, 0.6442, 0.2437, 0.8591, 0.0971, 0.6905, 0.6372, 0.2519, 0.631, 0.8582, 0.1627, 0.2031, 0.2058, 0.6692, 0.159, 0.614, 0.8867, 0.0117, 0.3713, 0.5576, 0.8031, 0.4632, 0.938, 0.7615, 0.4452, 0.2411, 0.1671, 0.7493, 0.0953, 0.801, 0.1361, 0.3646, 0.5583, 0.6449, 0.3556, 0.3331, 0.5771, 0.4711, 0.2237, 0.9801, 0.3181, 0.4007, 0.7604, 0.2139, 0.0959, 0.649]])
in0Con25742 = tf.constant([[0.1203, 0.9077]])
print (np.array2string(model.predict([in0Con2295,in0PRe80009,in0Ave71427,in1Ave71427,in0Con83102,in0Con25742],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add2108.png')

LCon2295 = conv2D_transpose_layer([[[[0.1421, 0.8612], [0.2776, 0.6932]]]], 1, 1,[[[[0.9182, 0.6246], [0.8469, 0.9233], [0.5123, 0.2773]]]],[0, 0, 0], 1, 1, true, Con2295), 
LLea44693 = leaky_relu_layer(Con2295, 4.867507507661386, Lea44693), 
LGlo30721 = global_average_pooling2D_layer(Lea44693, Glo30721), 
LPRe80009 = prelu_layer([[[[[0.8726, 0.6648], [0.4562, 0.155]], [[0.1991, 0.2247], [0.2735, 0.1405]]], [[[0.8094, 0.7882], [0.6753, 0.4605]], [[0.6822, 0.0173], [0.8397, 0.6094]]]]], [[[[0.4476, 0.1569], [0.224, 0.5242]], [[0.828, 0.6691], [0.5289, 0.2432]]], [[[0.0745, 0.8054], [0.1959, 0.2291]], [[0.5014, 0.3314], [0.4217, 0.1234]]]], PRe80009), 
LRes7493 = reshape_layer(PRe80009, [2, 2, 4], Res7493), 
LRes39317 = reshape_layer(Res7493, [2, 8], Res39317), 
LRes40874 = reshape_layer(Res39317, [2, 8, 1], Res40874), 
LRes89181 = reshape_layer(Res40874, [2, 8, 1, 1], Res89181), 
LCon8539 = conv3D_layer(Res89181, 1, 8, 1,[[[[[0.7809, 0.994, 0.7697, 0.6689]]], [[[0.8409, 0.0372, 0.2829, 0.9819]]], [[[0.3321, 0.0054, 0.416, 0.1206]]], [[[0.4992, 0.1179, 0.747, 0.2483]]], [[[0.4062, 0.8227, 0.0986, 0.1683]]], [[[0.0809, 0.2205, 0.1311, 0.4991]]], [[[0.6794, 0.6401, 0.4538, 0.1743]]], [[[0.0232, 0.0824, 0.1795, 0.3718]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con8539), 
LRes64334 = reshape_layer(Con8539, [2, 8, 4], Res64334), 
LRes97317 = reshape_layer(Res64334, [2, 32], Res97317), 
LFla76487 = flatten_layer(Res97317, Fla76487), 
LAve71427 = average_layer([[[[[0.4185, 0.8766]], [[0.7916, 0.7806]]]], [[[[0.4799, 0.3018]], [[0.0574, 0.741]]]]], Ave71427), 
LRes15607 = reshape_layer(Ave71427, [2, 2], Res15607), 
LLST82605 = lstm_layer(Res15607,[[8, 8, 5, 8, 10, 10, 4, 1, 1, 1, 5, 6], [3, 1, 6, 9, 9, 8, 5, 1, 2, 4, 6, 9]],[[5, 9, 8, 1, 10, 2, 7, 6, 3, 10, 2, 8], [5, 8, 6, 10, 6, 7, 5, 9, 5, 9, 9, 9], [4, 5, 3, 4, 4, 8, 4, 3, 4, 4, 2, 1]],[9, 9, 5, 2, 5, 8, 9, 3, 5, 1, 5, 4], LST82605), 
LBat78447 = batch_normalization_layer(LST82605, 1, 0.26866128908308573, [0.5155, 0.7228, 0.6328], [0.6239, 0.852, 0.8697], [0.9091, 0.3701, 0.8811], [0.0116, 0.5671, 0.304], Bat78447), 
LCon83102 = concatenate_layer([Bat78447,[[0.3756, 0.826, 0.8306, 0.4933, 0.1197, 0.3127, 0.4571, 0.5381, 0.4936, 0.8571, 0.9787, 0.2113, 0.3561, 0.7371, 0.1453, 0.7132, 0.6442, 0.2437, 0.8591, 0.0971, 0.6905, 0.6372, 0.2519, 0.631, 0.8582, 0.1627, 0.2031, 0.2058, 0.6692, 0.159, 0.614, 0.8867, 0.0117, 0.3713, 0.5576, 0.8031, 0.4632, 0.938, 0.7615, 0.4452, 0.2411, 0.1671, 0.7493, 0.0953, 0.801, 0.1361, 0.3646, 0.5583, 0.6449, 0.3556, 0.3331, 0.5771, 0.4711, 0.2237, 0.9801, 0.3181, 0.4007, 0.7604, 0.2139, 0.0959, 0.649]]], 1, Con83102), 
LMul6400 = multiply_layer([Fla76487,Con83102], Mul6400), 
LRes39613 = reshape_layer(Mul6400, [64, 1], Res39613), 
LRes80932 = reshape_layer(Res39613, [64, 1, 1], Res80932), 
LGlo88064 = global_average_pooling2D_layer(Res80932, Glo88064), 
LCon25742 = concatenate_layer([Glo88064,[[0.1203, 0.9077]]], 1, Con25742), 
LAdd2108 = add_layer([Glo30721,Con25742], Add2108), 
exec_layers([LCon2295,LLea44693,LGlo30721,LPRe80009,LRes7493,LRes39317,LRes40874,LRes89181,LCon8539,LRes64334,LRes97317,LFla76487,LAve71427,LRes15607,LLST82605,LBat78447,LCon83102,LMul6400,LRes39613,LRes80932,LGlo88064,LCon25742,LAdd2108],["Con2295","Lea44693","Glo30721","PRe80009","Res7493","Res39317","Res40874","Res89181","Con8539","Res64334","Res97317","Fla76487","Ave71427","Res15607","LST82605","Bat78447","Con83102","Mul6400","Res39613","Res80932","Glo88064","Con25742","Add2108"],Add2108,"Add2108")

Actual (Unparsed): [[1.2489389, 1.0156107, 1.2307237]]

Expected (Unparsed): [[1.2489388824521335,1.0156107250000002,1.2307237149999999]]

Actual:   [[1.249, 1.0157, 1.2308]]

Expected: [[1.249, 1.0157, 1.2308]]