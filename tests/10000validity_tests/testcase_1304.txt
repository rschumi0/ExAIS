import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim21093 = tf.keras.layers.Input(shape=([3, 1]))

Sim21093 = keras.layers.SimpleRNN(1,name = 'Sim21093', )(in0Sim21093)
Res84717 = keras.layers.Reshape((1, 1), name = 'Res84717', )(Sim21093)
LST28952 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST28952', )(Res84717)
Res31649 = keras.layers.Reshape((1, 1), name = 'Res31649', )(LST28952)
Res37252 = keras.layers.Reshape((1, 1, 1), name = 'Res37252', )(Res31649)
Glo9998 = keras.layers.GlobalAveragePooling2D(name = 'Glo9998', )(Res37252)
ReL89 = keras.layers.ReLU(max_value=2.272096490298698, negative_slope=5.646877676615062, threshold=8.127624347262342, name = 'ReL89', )(Glo9998)
model = tf.keras.models.Model(inputs=[in0Sim21093], outputs=ReL89)
w = model.get_layer('Sim21093').get_weights() 
w[0] = np.array([[4]])
w[1] = np.array([[2]])
w[2] = np.array([10])
model.get_layer('Sim21093').set_weights(w) 
w = model.get_layer('LST28952').get_weights() 
w[0] = np.array([[2, 8, 9, 10]])
w[1] = np.array([[7, 6, 2, 5]])
w[2] = np.array([10, 6, 1, 10])
model.get_layer('LST28952').set_weights(w) 
in0Sim21093 = tf.constant([[[2], [3], [2]]])
print (np.array2string(model.predict([in0Sim21093],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL89.png')

LSim21093 = simple_rnn_layer([[[2], [3], [2]]],[[4]],[[2]],[10], Sim21093), 
LRes84717 = reshape_layer(Sim21093, [1, 1], Res84717), 
LLST28952 = lstm_layer(Res84717,[[2, 8, 9, 10]],[[7, 6, 2, 5]],[10, 6, 1, 10], LST28952), 
LRes31649 = reshape_layer(LST28952, [1, 1], Res31649), 
LRes37252 = reshape_layer(Res31649, [1, 1, 1], Res37252), 
LGlo9998 = global_average_pooling2D_layer(Res37252, Glo9998), 
LReL89 = relu_layer(Glo9998, 2.272096490298698, 5.646877676615062, 8.127624347262342, ReL89), 
exec_layers([LSim21093,LRes84717,LLST28952,LRes31649,LRes37252,LGlo9998,LReL89],["Sim21093","Res84717","LST28952","Res31649","Res37252","Glo9998","ReL89"],ReL89,"ReL89")

Actual (Unparsed): [[-41.5950860]]

Expected (Unparsed): [[-41.59508604244914]]

Actual:   [[-41.595]]

Expected: [[-41.595]]