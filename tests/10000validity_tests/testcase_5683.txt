import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub97197 = tf.keras.layers.Input(shape=([2]))
in1Sub97197 = tf.keras.layers.Input(shape=([2]))
in0Con31676 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave48294 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave48294 = tf.keras.layers.Input(shape=([2, 1, 2]))

Sub97197 = keras.layers.Subtract(name = 'Sub97197', )([in0Sub97197,in1Sub97197])
Res567 = keras.layers.Reshape((2, 1), name = 'Res567', )(Sub97197)
Con31676 = keras.layers.Concatenate(axis=2, name = 'Con31676', )([Res567,in0Con31676])
Ave48294 = keras.layers.Average(name = 'Ave48294', )([in0Ave48294,in1Ave48294])
Lay76684 = keras.layers.LayerNormalization(axis=2, epsilon=1.558418627318567, name = 'Lay76684', )(Ave48294)
Res92034 = keras.layers.Reshape((2, 2), name = 'Res92034', )(Lay76684)
PRe61795 = keras.layers.PReLU(name = 'PRe61795', )(Res92034)
Max5136 = keras.layers.Maximum(name = 'Max5136', )([Con31676,PRe61795])
model = tf.keras.models.Model(inputs=[in0Sub97197,in1Sub97197,in0Con31676,in0Ave48294,in1Ave48294], outputs=Max5136)
w = model.get_layer('PRe61795').get_weights() 
w[0] = np.array([[0.4453, 0.1457], [0.8204, 0.2995]])
model.get_layer('PRe61795').set_weights(w) 
in0Sub97197 = tf.constant([[0.4456, 0.2263]])
in1Sub97197 = tf.constant([[0.5726, 0.7917]])
in0Con31676 = tf.constant([[[0.3832], [0.4622]]])
in0Ave48294 = tf.constant([[[[0.5705, 0.0075]], [[0.803, 0.6586]]]])
in1Ave48294 = tf.constant([[[[0.1862, 0.6249]], [[0.7421, 0.9287]]]])
print (np.array2string(model.predict([in0Sub97197,in1Sub97197,in0Con31676,in0Ave48294,in1Ave48294],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max5136.png')

LSub97197 = subtract_layer([[0.4456, 0.2263]], [[0.5726, 0.7917]], Sub97197), 
LRes567 = reshape_layer(Sub97197, [2, 1], Res567), 
LCon31676 = concatenate_layer([Res567,[[[0.3832], [0.4622]]]], 2, Con31676), 
LAve48294 = average_layer([[[[[0.5705, 0.0075]], [[0.803, 0.6586]]]], [[[[0.1862, 0.6249]], [[0.7421, 0.9287]]]]], Ave48294), 
LLay76684 = layer_normalization_layer(Ave48294, 2, 1.558418627318567, Lay76684), 
LRes92034 = reshape_layer(Lay76684, [2, 2], Res92034), 
LPRe61795 = prelu_layer(Res92034, [[0.4453, 0.1457], [0.8204, 0.2995]], PRe61795), 
LMax5136 = maximum_layer([Con31676,PRe61795], Max5136), 
exec_layers([LSub97197,LRes567,LCon31676,LAve48294,LLay76684,LRes92034,LPRe61795,LMax5136],["Sub97197","Res567","Con31676","Ave48294","Lay76684","Res92034","PRe61795","Max5136"],Max5136,"Max5136")

Actual (Unparsed): [[[0.0000000, 0.3832000], [0.0000000, 0.4622000]]]

Expected (Unparsed): [[[0.0,0.3832],[0.0,0.4622]]]

Actual:   [[[0, 0.3832], [0, 0.4622]]]

Expected: [[[0, 0.3832], [0, 0.4622]]]