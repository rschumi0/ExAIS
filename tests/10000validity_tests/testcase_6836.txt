import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min70947 = tf.keras.layers.Input(shape=([2, 2]))
in1Min70947 = tf.keras.layers.Input(shape=([2, 2]))

Min70947 = keras.layers.Minimum(name = 'Min70947', )([in0Min70947,in1Min70947])
Res90746 = keras.layers.Reshape((2, 2, 1), name = 'Res90746', )(Min70947)
Sep70452 = keras.layers.SeparableConv2D(3, (2, 1),strides=(2, 2), padding='valid', name = 'Sep70452', )(Res90746)
Max6328 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(6, 1), padding='valid', name = 'Max6328', )(Sep70452)
Max6015 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Max6015', )(Max6328)
model = tf.keras.models.Model(inputs=[in0Min70947,in1Min70947], outputs=Max6015)
w = model.get_layer('Sep70452').get_weights() 
w[0] = np.array([[[[0.2427]]], [[[0.6407]]]])
w[1] = np.array([[[[0.1386, 0.3356, 0.2906]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep70452').set_weights(w) 
in0Min70947 = tf.constant([[[0.8272, 0.163], [0.2722, 0.9925]]])
in1Min70947 = tf.constant([[[0.5663, 0.7199], [0.815, 0.9796]]])
print (np.array2string(model.predict([in0Min70947,in1Min70947],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max6015.png')

LMin70947 = minimum_layer([[[[0.8272, 0.163], [0.2722, 0.9925]]], [[[0.5663, 0.7199], [0.815, 0.9796]]]], Min70947), 
LRes90746 = reshape_layer(Min70947, [2, 2, 1], Res90746), 
LSep70452 = separable_conv2D_layer(Res90746, 2, 1,[[[[[0.2427]]], [[[0.6407]]]],[[[[0.1386, 0.3356, 0.2906]]]]],[0, 0, 0], 2, 2, false, Sep70452), 
LMax6328 = max_pool2D_layer(Sep70452, 1, 1, 6, 1, false, Max6328), 
LMax6015 = max_pool2D_layer(Max6328, 1, 1, 1, 1, true, Max6015), 
exec_layers([LMin70947,LRes90746,LSep70452,LMax6328,LMax6015],["Min70947","Res90746","Sep70452","Max6328","Max6015"],Max6015,"Max6015")

Actual (Unparsed): [[[[0.0432210, 0.1046533, 0.0906206]]]]

Expected (Unparsed): [[[[0.04322096163,0.10465335298000002,0.09062057323]]]]

Actual:   [[[[0.0433, 0.1047, 0.0907]]]]

Expected: [[[[0.0433, 0.1047, 0.0907]]]]