import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add59343 = tf.keras.layers.Input(shape=([2, 1]))
in1Add59343 = tf.keras.layers.Input(shape=([2, 1]))

Add59343 = keras.layers.Add(name = 'Add59343', )([in0Add59343,in1Add59343])
Loc94968 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc94968', )(Add59343)
Res26849 = keras.layers.Reshape((1, 3, 1), name = 'Res26849', )(Loc94968)
Cro31903 = keras.layers.Cropping2D(cropping=((0, 0), (2, 0)), name = 'Cro31903', )(Res26849)
Sof16212 = keras.layers.Softmax(axis=1, name = 'Sof16212', )(Cro31903)
model = tf.keras.models.Model(inputs=[in0Add59343,in1Add59343], outputs=Sof16212)
w = model.get_layer('Loc94968').get_weights() 
w[0] = np.array([[[0.0312, 0.788, 0.0645], [0.2856, 0.6983, 0.6896]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc94968').set_weights(w) 
in0Add59343 = tf.constant([[[0.5381], [0.6664]]])
in1Add59343 = tf.constant([[[0.0928], [0.9406]]])
print (np.array2string(model.predict([in0Add59343,in1Add59343],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof16212.png')

LAdd59343 = add_layer([[[[0.5381], [0.6664]]], [[[0.0928], [0.9406]]]], Add59343), 
LLoc94968 = locally_connected1D_layer(Add59343, 2,[[[0.0312, 0.788, 0.0645], [0.2856, 0.6983, 0.6896]]],[[0, 0, 0]], 1, Loc94968), 
LRes26849 = reshape_layer(Loc94968, [1, 3, 1], Res26849), 
LCro31903 = cropping2D_layer(Res26849, 0, 0, 2, 0, Cro31903), 
LSof16212 = softmax_layer(Cro31903, 1, Sof16212), 
exec_layers([LAdd59343,LLoc94968,LRes26849,LCro31903,LSof16212],["Add59343","Loc94968","Res26849","Cro31903","Sof16212"],Sof16212,"Sof16212")

Actual (Unparsed): [[[[1.0000000]]]]

Expected (Unparsed): [[[[1.0]]]]

Actual:   [[[[1]]]]

Expected: [[[[1]]]]