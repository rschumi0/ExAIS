import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub72953 = tf.keras.layers.Input(shape=([2]))
in1Sub72953 = tf.keras.layers.Input(shape=([2]))
in0Con56112 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0ReL54283 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con84315 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Mul45167 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul45167 = tf.keras.layers.Input(shape=([1, 2]))
in0Con46931 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Sof37712 = tf.keras.layers.Input(shape=([1, 1, 2]))

Sub72953 = keras.layers.Subtract(name = 'Sub72953', )([in0Sub72953,in1Sub72953])
Res73696 = keras.layers.Reshape((2, 1), name = 'Res73696', )(Sub72953)
Res28244 = keras.layers.Reshape((2, 1, 1), name = 'Res28244', )(Res73696)
Zer67253 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer67253', )(Res28244)
Con56112 = keras.layers.Concatenate(axis=3, name = 'Con56112', )([Zer67253,in0Con56112])
ReL54283 = keras.layers.ReLU(max_value=9.289013521174553, negative_slope=3.4172075490840554, threshold=3.8250828665902725, name = 'ReL54283', input_shape=(2, 2, 1))(in0ReL54283)
Con84315 = keras.layers.Concatenate(axis=3, name = 'Con84315', )([ReL54283,in0Con84315])
Mul45167 = keras.layers.Multiply(name = 'Mul45167', )([in0Mul45167,in1Mul45167])
Res87876 = keras.layers.Reshape((1, 2, 1), name = 'Res87876', )(Mul45167)
Con46931 = keras.layers.Concatenate(axis=3, name = 'Con46931', )([Res87876,in0Con46931])
Sof37712 = keras.layers.Softmax(axis=1, name = 'Sof37712', input_shape=(1, 1, 2))(in0Sof37712)
Zer30927 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer30927', )(Sof37712)
Min56790 = keras.layers.Minimum(name = 'Min56790', )([Con46931,Zer30927])
Zer4916 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer4916', )(Min56790)
Add54944 = keras.layers.Add(name = 'Add54944', )([Con84315,Zer4916])
Max71270 = keras.layers.Maximum(name = 'Max71270', )([Con56112,Add54944])
model = tf.keras.models.Model(inputs=[in0Sub72953,in1Sub72953,in0Con56112,in0ReL54283,in0Con84315,in0Mul45167,in1Mul45167,in0Con46931,in0Sof37712], outputs=Max71270)
in0Sub72953 = tf.constant([[0.0913, 0.1436]])
in1Sub72953 = tf.constant([[0.5699, 0.8897]])
in0Con56112 = tf.constant([[[[0.9267], [0.6181]], [[0.5279], [0.6205]]]])
in0ReL54283 = tf.constant([[[[0.8331], [0.7872]], [[0.5369], [0.7021]]]])
in0Con84315 = tf.constant([[[[0.9751], [0.6267]], [[0.0437], [0.3838]]]])
in0Mul45167 = tf.constant([[[0.6135, 0.2758]]])
in1Mul45167 = tf.constant([[[0.7655, 0.8928]]])
in0Con46931 = tf.constant([[[[0.6168], [0.6144]]]])
in0Sof37712 = tf.constant([[[[0.3963, 0.8611]]]])
print (np.array2string(model.predict([in0Sub72953,in1Sub72953,in0Con56112,in0ReL54283,in0Con84315,in0Mul45167,in1Mul45167,in0Con46931,in0Sof37712],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max71270.png')

LSub72953 = subtract_layer([[0.0913, 0.1436]], [[0.5699, 0.8897]], Sub72953), 
LRes73696 = reshape_layer(Sub72953, [2, 1], Res73696), 
LRes28244 = reshape_layer(Res73696, [2, 1, 1], Res28244), 
LZer67253 = zero_padding2D_layer(Res28244, 0, 0, 1, 0, Zer67253), 
LCon56112 = concatenate_layer([Zer67253,[[[[0.9267], [0.6181]], [[0.5279], [0.6205]]]]], 3, Con56112), 
LReL54283 = relu_layer([[[[0.8331], [0.7872]], [[0.5369], [0.7021]]]], 9.289013521174553, 3.4172075490840554, 3.8250828665902725, ReL54283), 
LCon84315 = concatenate_layer([ReL54283,[[[[0.9751], [0.6267]], [[0.0437], [0.3838]]]]], 3, Con84315), 
LMul45167 = multiply_layer([[[[0.6135, 0.2758]]], [[[0.7655, 0.8928]]]], Mul45167), 
LRes87876 = reshape_layer(Mul45167, [1, 2, 1], Res87876), 
LCon46931 = concatenate_layer([Res87876,[[[[0.6168], [0.6144]]]]], 3, Con46931), 
LSof37712 = softmax_layer([[[[0.3963, 0.8611]]]], 1, Sof37712), 
LZer30927 = zero_padding2D_layer(Sof37712, 0, 0, 1, 0, Zer30927), 
LMin56790 = minimum_layer([Con46931,Zer30927], Min56790), 
LZer4916 = zero_padding2D_layer(Min56790, 1, 0, 0, 0, Zer4916), 
LAdd54944 = add_layer([Con84315,Zer4916], Add54944), 
LMax71270 = maximum_layer([Con56112,Add54944], Max71270), 
exec_layers([LSub72953,LRes73696,LRes28244,LZer67253,LCon56112,LReL54283,LCon84315,LMul45167,LRes87876,LCon46931,LSof37712,LZer30927,LMin56790,LZer4916,LAdd54944,LMax71270],["Sub72953","Res73696","Res28244","Zer67253","Con56112","ReL54283","Con84315","Mul45167","Res87876","Con46931","Sof37712","Zer30927","Min56790","Zer4916","Add54944","Max71270"],Max71270,"Max71270")

Actual (Unparsed): [[[[0.0000000, 0.9751000], [-0.4786000, 0.6267000]], [[0.0000000, 0.5279000], [-0.7461000, 0.9982000]]]]

Expected (Unparsed): [[[[0,0.9751],[-0.47859999999999997,0.6267]],[[0,0.5279],[-0.7461,0.9982]]]]

Actual:   [[[[0, 0.9751], [-0.4786, 0.6267]], [[0, 0.5279], [-0.7461, 0.9982]]]]

Expected: [[[[0, 0.9751], [-0.4785, 0.6267]], [[0, 0.5279], [-0.7461, 0.9982]]]]