import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min33270 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Min33270 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Min33270 = keras.layers.Minimum(name = 'Min33270', )([in0Min33270,in1Min33270])
Den23748 = keras.layers.Dense(4,name = 'Den23748', )(Min33270)
model = tf.keras.models.Model(inputs=[in0Min33270,in1Min33270], outputs=Den23748)
w = model.get_layer('Den23748').get_weights() 
w[0] = np.array([[0.4265, 0.0563, 0.4843, 0.6392], [0.9336, 0.7728, 0.7622, 0.9288]])
w[1] = np.array([0.3861, 0.632, 0.4425, 0.6597])
model.get_layer('Den23748').set_weights(w) 
in0Min33270 = tf.constant([[[[[0.4198, 0.2818], [0.8198, 0.6225]]]]])
in1Min33270 = tf.constant([[[[[0.9997, 0.6952], [0.374, 0.1304]]]]])
print (np.array2string(model.predict([in0Min33270,in1Min33270],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den23748.png')

LMin33270 = minimum_layer([[[[[[0.4198, 0.2818], [0.8198, 0.6225]]]]], [[[[[0.9997, 0.6952], [0.374, 0.1304]]]]]], Min33270), 
LDen23748 = dense_layer(Min33270, [[0.4265, 0.0563, 0.4843, 0.6392], [0.9336, 0.7728, 0.7622, 0.9288]],[0.3861, 0.632, 0.4425, 0.6597], Den23748), 
exec_layers([LMin33270,LDen23748],["Min33270","Den23748"],Den23748,"Den23748")

Actual (Unparsed): [[[[[0.8282332, 0.8734098, 0.8605971, 1.1897720], [0.6673524, 0.7538293, 0.7230191, 1.0198763]]]]]

Expected (Unparsed): [[[[[0.82823318,0.87340978,0.8605971,1.189772],[0.6673524399999999,0.7538293199999999,0.7230190799999999,1.0198763199999998]]]]]

Actual:   [[[[[0.8283, 0.8735, 0.8606, 1.1898], [0.6674, 0.7539, 0.7231, 1.0199]]]]]

Expected: [[[[[0.8283, 0.8735, 0.8606, 1.1898], [0.6674, 0.7539, 0.7231, 1.0199]]]]]