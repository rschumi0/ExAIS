import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul42422 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Mul42422 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Mul42422 = keras.layers.Multiply(name = 'Mul42422', )([in0Mul42422,in1Mul42422])
Res89003 = keras.layers.Reshape((2, 2, 2), name = 'Res89003', )(Mul42422)
Max98222 = keras.layers.MaxPool2D(pool_size=(2, 2), name = 'Max98222', )(Res89003)
Res36827 = keras.layers.Reshape((1, 2), name = 'Res36827', )(Max98222)
Glo78928 = keras.layers.GlobalMaxPool1D(name = 'Glo78928', )(Res36827)
model = tf.keras.models.Model(inputs=[in0Mul42422,in1Mul42422], outputs=Glo78928)
in0Mul42422 = tf.constant([[[[[0.5431], [0.7807]], [[0.2151], [0.4024]]], [[[0.1537], [0.5771]], [[0.3697], [0.9698]]]]])
in1Mul42422 = tf.constant([[[[[0.6584], [0.3696]], [[0.1017], [0.9396]]], [[[0.6673], [0.1381]], [[0.8131], [0.8029]]]]])
print (np.array2string(model.predict([in0Mul42422,in1Mul42422],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo78928.png')

LMul42422 = multiply_layer([[[[[[0.5431], [0.7807]], [[0.2151], [0.4024]]], [[[0.1537], [0.5771]], [[0.3697], [0.9698]]]]], [[[[[0.6584], [0.3696]], [[0.1017], [0.9396]]], [[[0.6673], [0.1381]], [[0.8131], [0.8029]]]]]], Mul42422), 
LRes89003 = reshape_layer(Mul42422, [2, 2, 2], Res89003), 
LMax98222 = max_pool2D_layer(Res89003, 2, 2, Max98222), 
LRes36827 = reshape_layer(Max98222, [1, 2], Res36827), 
LGlo78928 = global_max_pool1D_layer(Res36827, Glo78928), 
exec_layers([LMul42422,LRes89003,LMax98222,LRes36827,LGlo78928],["Mul42422","Res89003","Max98222","Res36827","Glo78928"],Glo78928,"Glo78928")

Actual (Unparsed): [[0.3575770, 0.7786524]]

Expected (Unparsed): [[0.35757704,0.7786524199999999]]

Actual:   [[0.3576, 0.7787]]

Expected: [[0.3576, 0.7787]]