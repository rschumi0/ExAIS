import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL62522 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

ReL62522 = keras.layers.ReLU(max_value=1.2628071935137508, negative_slope=9.726602658749654, threshold=4.259677854420233, name = 'ReL62522', input_shape=(1, 1, 2, 2))(in0ReL62522)
Res33629 = keras.layers.Reshape((1, 1, 4), name = 'Res33629', )(ReL62522)
Loc95723 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 1), name = 'Loc95723', )(Res33629)
Res57401 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res57401', )(Loc95723)
Cro65746 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro65746', )(Res57401)
Mas63776 = keras.layers.Masking(mask_value=2, name = 'Mas63776', )(Cro65746)
model = tf.keras.models.Model(inputs=[in0ReL62522], outputs=Mas63776)
w = model.get_layer('Loc95723').get_weights() 
w[0] = np.array([[[0.2781, 0.039], [0.4254, 0.7417], [0.0034, 0.3829], [0.8188, 0.9894]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc95723').set_weights(w) 
in0ReL62522 = tf.constant([[[[[0.4541, 0.7846], [0.1423, 0.7758]]]]])
print (np.array2string(model.predict([in0ReL62522],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas63776.png')

LReL62522 = relu_layer([[[[[0.4541, 0.7846], [0.1423, 0.7758]]]]], 1.2628071935137508, 9.726602658749654, 4.259677854420233, ReL62522), 
LRes33629 = reshape_layer(ReL62522, [1, 1, 4], Res33629), 
LLoc95723 = locally_connected2D_layer(Res33629, 1, 1,[[[0.2781, 0.039], [0.4254, 0.7417], [0.0034, 0.3829], [0.8188, 0.9894]]],[[[0, 0]]], 1, 1, Loc95723), 
LRes57401 = reshape_layer(Loc95723, [1, 1, 2, 1], Res57401), 
LCro65746 = cropping3D_layer(Res57401, 0, 0, 0, 0, 0, 0, Cro65746), 
LMas63776 = masking_layer(Cro65746, 2, Mas63776), 
exec_layers([LReL62522,LRes33629,LLoc95723,LRes57401,LCro65746,LMas63776],["ReL62522","Res33629","Loc95723","Res57401","Cro65746","Mas63776"],Mas63776,"Mas63776")

Actual (Unparsed): [[[[[-52.5550478], [-75.3750964]]]]]

Expected (Unparsed): [[[[[-52.555047866932505],[-75.37509644472811]]]]]

Actual:   [[[[[-52.555], [-75.375]]]]]

Expected: [[[[[-52.555], [-75.375]]]]]