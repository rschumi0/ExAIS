import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof37398 = tf.keras.layers.Input(shape=([2, 2]))
in0Add28637 = tf.keras.layers.Input(shape=([1, 1]))
in1Add28637 = tf.keras.layers.Input(shape=([1, 1]))
in0Con44187 = tf.keras.layers.Input(shape=([2, 1]))

Sof37398 = keras.layers.Softmax(axis=1, name = 'Sof37398', input_shape=(2, 2))(in0Sof37398)
Bat11211 = keras.layers.BatchNormalization(axis=1, epsilon=0.6151375113635182,  name = 'Bat11211', )(Sof37398)
Add28637 = keras.layers.Add(name = 'Add28637', )([in0Add28637,in1Add28637])
Thr88669 = keras.layers.ThresholdedReLU(theta=6.223655345439491, name = 'Thr88669', )(Add28637)
Zer69698 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer69698', )(Thr88669)
Con44187 = keras.layers.Concatenate(axis=2, name = 'Con44187', )([Zer69698,in0Con44187])
Sub54697 = keras.layers.Subtract(name = 'Sub54697', )([Bat11211,Con44187])
model = tf.keras.models.Model(inputs=[in0Sof37398,in0Add28637,in1Add28637,in0Con44187], outputs=Sub54697)
w = model.get_layer('Bat11211').get_weights() 
w[0] = np.array([0.2878, 0.6688])
w[1] = np.array([0.4833, 0.1205])
w[2] = np.array([0.6625, 0.8693])
w[3] = np.array([0.5457, 0.5508])
model.get_layer('Bat11211').set_weights(w) 
in0Sof37398 = tf.constant([[[0.2826, 0.9325], [0.1486, 0.5225]]])
in0Add28637 = tf.constant([[[0.0324]]])
in1Add28637 = tf.constant([[[0.7562]]])
in0Con44187 = tf.constant([[[0.8992], [0.31]]])
print (np.array2string(model.predict([in0Sof37398,in0Add28637,in1Add28637,in0Con44187],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub54697.png')

LSof37398 = softmax_layer([[[0.2826, 0.9325], [0.1486, 0.5225]]], 1, Sof37398), 
LBat11211 = batch_normalization_layer(Sof37398, 1, 0.6151375113635182, [0.2878, 0.6688], [0.4833, 0.1205], [0.6625, 0.8693], [0.5457, 0.5508], Bat11211), 
LAdd28637 = add_layer([[[[0.0324]]], [[[0.7562]]]], Add28637), 
LThr88669 = thresholded_relu_layer(Add28637, 6.223655345439491, Thr88669), 
LZer69698 = zero_padding1D_layer(Thr88669, 1, 0, Zer69698), 
LCon44187 = concatenate_layer([Zer69698,[[[0.8992], [0.31]]]], 2, Con44187), 
LSub54697 = subtract_layer(Bat11211,Con44187, Sub54697), 
exec_layers([LSof37398,LBat11211,LAdd28637,LThr88669,LZer69698,LCon44187,LSub54697],["Sof37398","Bat11211","Add28637","Thr88669","Zer69698","Con44187","Sub54697"],Sub54697,"Sub54697")

Actual (Unparsed): [[[0.4488283, -0.4323044], [-0.1289561, -0.4808498]]]

Expected (Unparsed): [[[0.4488282598508974,-0.43230435544446233],[-0.1289561043111951,-0.48084981662657716]]]

Actual:   [[[0.4489, -0.4323], [-0.1289, -0.4808]]]

Expected: [[[0.4489, -0.4323], [-0.1289, -0.4808]]]