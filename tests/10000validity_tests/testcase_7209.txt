import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con85027 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Add53716 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Add53716 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con31586 = tf.keras.layers.Input(shape=([1, 20]))
in0Mul57545 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Mul57545 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Add81898 = tf.keras.layers.Input(shape=([1, 1]))
in1Add81898 = tf.keras.layers.Input(shape=([1, 1]))
in0Con76013 = tf.keras.layers.Input(shape=([1, 4]))

Con85027 = keras.layers.Conv2DTranspose(4, (1, 2),strides=(1, 1), padding='valid', name = 'Con85027', )(in0Con85027)
Res79971 = keras.layers.Reshape((1, 3, 4, 1), name = 'Res79971', )(Con85027)
Add53716 = keras.layers.Add(name = 'Add53716', )([in0Add53716,in1Add53716])
Zer69560 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (3, 0)), name = 'Zer69560', )(Add53716)
Add43573 = keras.layers.Add(name = 'Add43573', )([Res79971,Zer69560])
Res51451 = keras.layers.Reshape((1, 3, 4), name = 'Res51451', )(Add43573)
Res58361 = keras.layers.Reshape((1, 12), name = 'Res58361', )(Res51451)
Con31586 = keras.layers.Concatenate(axis=2, name = 'Con31586', )([Res58361,in0Con31586])
Mul57545 = keras.layers.Multiply(name = 'Mul57545', )([in0Mul57545,in1Mul57545])
Zer35449 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer35449', )(Mul57545)
Res354 = keras.layers.Reshape((3, 4, 8), name = 'Res354', )(Zer35449)
Res82630 = keras.layers.Reshape((3, 32), name = 'Res82630', )(Res354)
Zer53326 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer53326', )(Res82630)
Dot2486 = keras.layers.Dot(axes=(2, 2), name = 'Dot2486', )([Con31586,Zer53326])
Add81898 = keras.layers.Add(name = 'Add81898', )([in0Add81898,in1Add81898])
Con76013 = keras.layers.Concatenate(axis=2, name = 'Con76013', )([Add81898,in0Con76013])
Min78540 = keras.layers.Minimum(name = 'Min78540', )([Dot2486,Con76013])
model = tf.keras.models.Model(inputs=[in0Con85027,in0Add53716,in1Add53716,in0Con31586,in0Mul57545,in1Mul57545,in0Add81898,in1Add81898,in0Con76013], outputs=Min78540)
w = model.get_layer('Con85027').get_weights() 
w[0] = np.array([[[[0.6685], [0.4825], [0.7593], [0.2484]], [[0.3741], [0.9614], [0.2092], [0.6387]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con85027').set_weights(w) 
in0Con85027 = tf.constant([[[[0.8801], [0.7653]]]])
in0Add53716 = tf.constant([[[[[0.6732]], [[0.1982]]]]])
in1Add53716 = tf.constant([[[[[0.0011]], [[0.7339]]]]])
in0Con31586 = tf.constant([[[0.0336, 0.4653, 0.1765, 0.1488, 0.8334, 0.4914, 0.8501, 0.24, 0.8758, 0.4853, 0.7462, 0.1447, 0.7493, 0.1582, 0.7591, 0.254, 0.5993, 0.3728, 0.4975, 0.6817]]])
in0Mul57545 = tf.constant([[[[[0.2572, 0.3603], [0.5627, 0.8338]], [[0.7175, 0.6957], [0.5013, 0.577]]]]])
in1Mul57545 = tf.constant([[[[[0.6808, 0.0812], [0.9236, 0.4285]], [[0.2105, 0.5522], [0.8497, 0.1922]]]]])
in0Add81898 = tf.constant([[[0.4948]]])
in1Add81898 = tf.constant([[[0.6256]]])
in0Con76013 = tf.constant([[[0.2432, 0.3547, 0.771, 0.3309]]])
print (np.array2string(model.predict([in0Con85027,in0Add53716,in1Add53716,in0Con31586,in0Mul57545,in1Mul57545,in0Add81898,in1Add81898,in0Con76013],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min78540.png')

LCon85027 = conv2D_transpose_layer([[[[0.8801], [0.7653]]]], 1, 2,[[[[0.6685], [0.4825], [0.7593], [0.2484]], [[0.3741], [0.9614], [0.2092], [0.6387]]]],[0, 0, 0, 0], 1, 1, false, Con85027), 
LRes79971 = reshape_layer(Con85027, [1, 3, 4, 1], Res79971), 
LAdd53716 = add_layer([[[[[[0.6732]], [[0.1982]]]]], [[[[[0.0011]], [[0.7339]]]]]], Add53716), 
LZer69560 = zero_padding3D_layer(Add53716, 0, 0, 1, 0, 3, 0, Zer69560), 
LAdd43573 = add_layer([Res79971,Zer69560], Add43573), 
LRes51451 = reshape_layer(Add43573, [1, 3, 4], Res51451), 
LRes58361 = reshape_layer(Res51451, [1, 12], Res58361), 
LCon31586 = concatenate_layer([Res58361,[[[0.0336, 0.4653, 0.1765, 0.1488, 0.8334, 0.4914, 0.8501, 0.24, 0.8758, 0.4853, 0.7462, 0.1447, 0.7493, 0.1582, 0.7591, 0.254, 0.5993, 0.3728, 0.4975, 0.6817]]]], 2, Con31586), 
LMul57545 = multiply_layer([[[[[[0.2572, 0.3603], [0.5627, 0.8338]], [[0.7175, 0.6957], [0.5013, 0.577]]]]], [[[[[0.6808, 0.0812], [0.9236, 0.4285]], [[0.2105, 0.5522], [0.8497, 0.1922]]]]]], Mul57545), 
LZer35449 = zero_padding3D_layer(Mul57545, 1, 1, 1, 1, 1, 1, Zer35449), 
LRes354 = reshape_layer(Zer35449, [3, 4, 8], Res354), 
LRes82630 = reshape_layer(Res354, [3, 32], Res82630), 
LZer53326 = zero_padding1D_layer(Res82630, 2, 0, Zer53326), 
LDot2486 = dot_layer(Con31586,Zer53326, 2, 2, Dot2486), 
LAdd81898 = add_layer([[[[0.4948]]], [[[0.6256]]]], Add81898), 
LCon76013 = concatenate_layer([Add81898,[[[0.2432, 0.3547, 0.771, 0.3309]]]], 2, Con76013), 
LMin78540 = minimum_layer([Dot2486,Con76013], Min78540), 
exec_layers([LCon85027,LRes79971,LAdd53716,LZer69560,LAdd43573,LRes51451,LRes58361,LCon31586,LMul57545,LZer35449,LRes354,LRes82630,LZer53326,LDot2486,LAdd81898,LCon76013,LMin78540],["Con85027","Res79971","Add53716","Zer69560","Add43573","Res51451","Res58361","Con31586","Mul57545","Zer35449","Res354","Res82630","Zer53326","Dot2486","Add81898","Con76013","Min78540"],Min78540,"Min78540")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.7710000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.771,0.0]]]

Actual:   [[[0, 0, 0, 0.771, 0]]]

Expected: [[[0, 0, 0, 0.771, 0]]]