import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer45722 = tf.keras.layers.Input(shape=([1, 1]))

Zer45722 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer45722', )(in0Zer45722)
Loc6936 = keras.layers.LocallyConnected1D(2, (3),strides=(1), name = 'Loc6936', )(Zer45722)
Sim2585 = keras.layers.SimpleRNN(2,name = 'Sim2585', )(Loc6936)
Res26422 = keras.layers.Reshape((2, 1), name = 'Res26422', )(Sim2585)
PRe69619 = keras.layers.PReLU(name = 'PRe69619', )(Res26422)
model = tf.keras.models.Model(inputs=[in0Zer45722], outputs=PRe69619)
w = model.get_layer('Loc6936').get_weights() 
w[0] = np.array([[[0.0794, 0.8752], [0.7735, 0.631], [0.261, 0.4095]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc6936').set_weights(w) 
w = model.get_layer('Sim2585').get_weights() 
w[0] = np.array([[6, 1], [3, 4]])
w[1] = np.array([[9, 5], [10, 10]])
w[2] = np.array([10, 3])
model.get_layer('Sim2585').set_weights(w) 
w = model.get_layer('PRe69619').get_weights() 
w[0] = np.array([[0.3697], [0.0044]])
model.get_layer('PRe69619').set_weights(w) 
in0Zer45722 = tf.constant([[[1.3503]]])
print (np.array2string(model.predict([in0Zer45722],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe69619.png')

LZer45722 = zero_padding1D_layer([[[1.3503]]], 1, 1, Zer45722), 
LLoc6936 = locally_connected1D_layer(Zer45722, 3,[[[0.0794, 0.8752], [0.7735, 0.631], [0.261, 0.4095]]],[[0, 0]], 1, Loc6936), 
LSim2585 = simple_rnn_layer(Loc6936,[[6, 1], [3, 4]],[[9, 5], [10, 10]],[10, 3], Sim2585), 
LRes26422 = reshape_layer(Sim2585, [2, 1], Res26422), 
LPRe69619 = prelu_layer(Res26422, [[0.3697], [0.0044]], PRe69619), 
exec_layers([LZer45722,LLoc6936,LSim2585,LRes26422,LPRe69619],["Zer45722","Loc6936","Sim2585","Res26422","PRe69619"],PRe69619,"PRe69619")

Actual (Unparsed): [[[1.0000000], [0.9999993]]]

Expected (Unparsed): [[[0.9999999999999999],[0.9999993273775469]]]

Actual:   [[[1], [1]]]

Expected: [[[1], [1]]]