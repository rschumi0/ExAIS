import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con89465 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Con89465 = keras.layers.Conv3D(4, (1, 1, 2),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con89465', )(in0Con89465)
Res62709 = keras.layers.Reshape((1, 2, 4), name = 'Res62709', )(Con89465)
Res92202 = keras.layers.Reshape((1, 8), name = 'Res92202', )(Res62709)
Loc21022 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc21022', )(Res92202)
model = tf.keras.models.Model(inputs=[in0Con89465], outputs=Loc21022)
w = model.get_layer('Con89465').get_weights() 
w[0] = np.array([[[[[0.9788, 0.3302, 0.3373, 0.1374]], [[0.2149, 0.2372, 0.0938, 0.107]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con89465').set_weights(w) 
w = model.get_layer('Loc21022').get_weights() 
w[0] = np.array([[[0.5147, 0.7587, 0.7702], [0.3605, 0.2284, 0.8062], [0.5696, 0.7608, 0.9005], [0.2601, 0.7051, 0.1984], [0.766, 0.2424, 0.4809], [0.7168, 0.1819, 0.1535], [0.8823, 0.954, 0.9329], [0.5675, 0.5012, 0.4605]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc21022').set_weights(w) 
in0Con89465 = tf.constant([[[[[0.4892], [0.9178]], [[0.1986], [0.6738]]]]])
print (np.array2string(model.predict([in0Con89465],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc21022.png')

LCon89465 = conv3D_layer([[[[[0.4892], [0.9178]], [[0.1986], [0.6738]]]]], 1, 1, 2,[[[[[0.9788, 0.3302, 0.3373, 0.1374]], [[0.2149, 0.2372, 0.0938, 0.107]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con89465), 
LRes62709 = reshape_layer(Con89465, [1, 2, 4], Res62709), 
LRes92202 = reshape_layer(Res62709, [1, 8], Res92202), 
LLoc21022 = locally_connected1D_layer(Res92202, 1,[[[0.5147, 0.7587, 0.7702], [0.3605, 0.2284, 0.8062], [0.5696, 0.7608, 0.9005], [0.2601, 0.7051, 0.1984], [0.766, 0.2424, 0.4809], [0.7168, 0.1819, 0.1535], [0.8823, 0.954, 0.9329], [0.5675, 0.5012, 0.4605]]],[[0, 0, 0]], 1, Loc21022), 
exec_layers([LCon89465,LRes62709,LRes92202,LLoc21022],["Con89465","Res62709","Res92202","Loc21022"],Loc21022,"Loc21022")

Actual (Unparsed): [[[1.2633908, 1.2044531, 1.4503132]]]

Expected (Unparsed): [[[1.263390786444,1.204453120214,1.4503132318560001]]]

Actual:   [[[1.2634, 1.2045, 1.4504]]]

Expected: [[[1.2634, 1.2045, 1.4504]]]