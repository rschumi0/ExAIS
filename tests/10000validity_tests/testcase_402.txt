import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min66882 = tf.keras.layers.Input(shape=([2, 2]))
in1Min66882 = tf.keras.layers.Input(shape=([2, 2]))

Min66882 = keras.layers.Minimum(name = 'Min66882', )([in0Min66882,in1Min66882])
Per33656 = keras.layers.Permute((1,2), name = 'Per33656',)(Min66882)
Bat3456 = keras.layers.BatchNormalization(axis=1, epsilon=0.1869286546045693,  name = 'Bat3456', )(Per33656)
Res35649 = keras.layers.Reshape((2, 2, 1), name = 'Res35649', )(Bat3456)
Sep30254 = keras.layers.SeparableConv2D(2, (1, 2),strides=(2, 2), padding='valid', name = 'Sep30254', )(Res35649)
model = tf.keras.models.Model(inputs=[in0Min66882,in1Min66882], outputs=Sep30254)
w = model.get_layer('Bat3456').get_weights() 
w[0] = np.array([0.4524, 0.414])
w[1] = np.array([0.1507, 0.1959])
w[2] = np.array([0.4122, 0.2682])
w[3] = np.array([0.9445, 0.8417])
model.get_layer('Bat3456').set_weights(w) 
w = model.get_layer('Sep30254').get_weights() 
w[0] = np.array([[[[0.3462]], [[0.7442]]]])
w[1] = np.array([[[[0.3312, 0.753]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep30254').set_weights(w) 
in0Min66882 = tf.constant([[[0.3178, 0.7784], [0.3306, 0.4775]]])
in1Min66882 = tf.constant([[[0.2028, 0.975], [0.1968, 0.5041]]])
print (np.array2string(model.predict([in0Min66882,in1Min66882],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep30254.png')

LMin66882 = minimum_layer([[[[0.3178, 0.7784], [0.3306, 0.4775]]], [[[0.2028, 0.975], [0.1968, 0.5041]]]], Min66882), 
LPer33656 = permute_layer(Min66882, 1,2, Per33656), 
LBat3456 = batch_normalization_layer(Per33656, 1, 0.1869286546045693, [0.4524, 0.414], [0.1507, 0.1959], [0.4122, 0.2682], [0.9445, 0.8417], Bat3456), 
LRes35649 = reshape_layer(Bat3456, [2, 2, 1], Res35649), 
LSep30254 = separable_conv2D_layer(Res35649, 1, 2,[[[[[0.3462]], [[0.7442]]]],[[[[0.3312, 0.753]]]]],[0, 0], 2, 2, false, Sep30254), 
exec_layers([LMin66882,LPer33656,LBat3456,LRes35649,LSep30254],["Min66882","Per33656","Bat3456","Res35649","Sep30254"],Sep30254,"Sep30254")

Actual (Unparsed): [[[[0.0826011, 0.1877978]]]]

Expected (Unparsed): [[[[0.08260110012782855,0.18779779105149425]]]]

Actual:   [[[[0.0827, 0.1878]]]]

Expected: [[[[0.0827, 0.1878]]]]