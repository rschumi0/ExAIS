import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul66334 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul66334 = tf.keras.layers.Input(shape=([2, 1]))
in0Con27371 = tf.keras.layers.Input(shape=([1]))
in0Min95972 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min95972 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con78878 = tf.keras.layers.Input(shape=([1]))
in0Zer53132 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave34876 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave34876 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Mul66334 = keras.layers.Multiply(name = 'Mul66334', )([in0Mul66334,in1Mul66334])
Fla35226 = keras.layers.Flatten(name = 'Fla35226', )(Mul66334)
Con27371 = keras.layers.Concatenate(axis=1, name = 'Con27371', )([Fla35226,in0Con27371])
Min95972 = keras.layers.Minimum(name = 'Min95972', )([in0Min95972,in1Min95972])
Res85640 = keras.layers.Reshape((2, 1), name = 'Res85640', )(Min95972)
Fla2990 = keras.layers.Flatten(name = 'Fla2990', )(Res85640)
Con78878 = keras.layers.Concatenate(axis=1, name = 'Con78878', )([Fla2990,in0Con78878])
Zer53132 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer53132', )(in0Zer53132)
Res71137 = keras.layers.Reshape((4, 1, 1), name = 'Res71137', )(Zer53132)
Res51790 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res51790', )(Res71137)
Zer96386 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer96386', )(Res51790)
Ave34876 = keras.layers.Average(name = 'Ave34876', )([in0Ave34876,in1Ave34876])
Zer39741 = keras.layers.ZeroPadding3D(padding=((3, 0), (0, 0), (1, 0)), name = 'Zer39741', )(Ave34876)
Ave48278 = keras.layers.Average(name = 'Ave48278', )([Zer96386,Zer39741])
Res13476 = keras.layers.Reshape((4, 1, 3), name = 'Res13476', )(Ave48278)
Res11018 = keras.layers.Reshape((4, 3), name = 'Res11018', )(Res13476)
Glo31803 = keras.layers.GlobalAveragePooling1D(name = 'Glo31803', )(Res11018)
Add62386 = keras.layers.Add(name = 'Add62386', )([Con78878,Glo31803])
Dot4201 = keras.layers.Dot(axes=(1, 1), name = 'Dot4201', )([Con27371,Add62386])
model = tf.keras.models.Model(inputs=[in0Mul66334,in1Mul66334,in0Con27371,in0Min95972,in1Min95972,in0Con78878,in0Zer53132,in0Ave34876,in1Ave34876], outputs=Dot4201)
in0Mul66334 = tf.constant([[[0.2798], [0.0772]]])
in1Mul66334 = tf.constant([[[0.7253], [0.25]]])
in0Con27371 = tf.constant([[0.3193]])
in0Min95972 = tf.constant([[[[0.6239]], [[0.2268]]]])
in1Min95972 = tf.constant([[[[0.7484]], [[0.1535]]]])
in0Con78878 = tf.constant([[0.6195]])
in0Zer53132 = tf.constant([[[1.3464], [1.0638]]])
in0Ave34876 = tf.constant([[[[[0.2259], [0.3169]]]]])
in1Ave34876 = tf.constant([[[[[0.1536], [0.1664]]]]])
print (np.array2string(model.predict([in0Mul66334,in1Mul66334,in0Con27371,in0Min95972,in1Min95972,in0Con78878,in0Zer53132,in0Ave34876,in1Ave34876],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot4201.png')

LMul66334 = multiply_layer([[[[0.2798], [0.0772]]], [[[0.7253], [0.25]]]], Mul66334), 
LFla35226 = flatten_layer(Mul66334, Fla35226), 
LCon27371 = concatenate_layer([Fla35226,[[0.3193]]], 1, Con27371), 
LMin95972 = minimum_layer([[[[[0.6239]], [[0.2268]]]], [[[[0.7484]], [[0.1535]]]]], Min95972), 
LRes85640 = reshape_layer(Min95972, [2, 1], Res85640), 
LFla2990 = flatten_layer(Res85640, Fla2990), 
LCon78878 = concatenate_layer([Fla2990,[[0.6195]]], 1, Con78878), 
LZer53132 = zero_padding1D_layer([[[1.3464], [1.0638]]], 1, 1, Zer53132), 
LRes71137 = reshape_layer(Zer53132, [4, 1, 1], Res71137), 
LRes51790 = reshape_layer(Res71137, [4, 1, 1, 1], Res51790), 
LZer96386 = zero_padding3D_layer(Res51790, 0, 0, 0, 0, 2, 0, Zer96386), 
LAve34876 = average_layer([[[[[[0.2259], [0.3169]]]]], [[[[[0.1536], [0.1664]]]]]], Ave34876), 
LZer39741 = zero_padding3D_layer(Ave34876, 3, 0, 0, 0, 1, 0, Zer39741), 
LAve48278 = average_layer([Zer96386,Zer39741], Ave48278), 
LRes13476 = reshape_layer(Ave48278, [4, 1, 3], Res13476), 
LRes11018 = reshape_layer(Res13476, [4, 3], Res11018), 
LGlo31803 = global_average_pooling1D_layer(Res11018, Glo31803), 
LAdd62386 = add_layer([Con78878,Glo31803], Add62386), 
LDot4201 = dot_layer(Con27371,Add62386, 1, 1, Dot4201), 
exec_layers([LMul66334,LFla35226,LCon27371,LMin95972,LRes85640,LFla2990,LCon78878,LZer53132,LRes71137,LRes51790,LZer96386,LAve34876,LZer39741,LAve48278,LRes13476,LRes11018,LGlo31803,LAdd62386,LDot4201],["Mul66334","Fla35226","Con27371","Min95972","Res85640","Fla2990","Con78878","Zer53132","Res71137","Res51790","Zer96386","Ave34876","Zer39741","Ave48278","Res13476","Res11018","Glo31803","Add62386","Dot4201"],Dot4201,"Dot4201")

Actual (Unparsed): [[0.4336822]]

Expected (Unparsed): [[0.433682239666]]

Actual:   [[0.4337]]

Expected: [[0.4337]]