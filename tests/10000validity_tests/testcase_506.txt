import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub98128 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub98128 = tf.keras.layers.Input(shape=([3, 3]))
in0Con81916 = tf.keras.layers.Input(shape=([3, 1]))
in0Min75262 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min75262 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con97922 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Mul87639 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Mul87639 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Ave37844 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave37844 = tf.keras.layers.Input(shape=([1, 2]))
in0Glo79555 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Ave2070 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Ave2070 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Sub98128 = keras.layers.Subtract(name = 'Sub98128', )([in0Sub98128,in1Sub98128])
Con81916 = keras.layers.Concatenate(axis=2, name = 'Con81916', )([Sub98128,in0Con81916])
Min75262 = keras.layers.Minimum(name = 'Min75262', )([in0Min75262,in1Min75262])
Res36337 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res36337', )(Min75262)
Zer48551 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer48551', )(Res36337)
Con97922 = keras.layers.Concatenate(axis=4, name = 'Con97922', )([Zer48551,in0Con97922])
Mul87639 = keras.layers.Multiply(name = 'Mul87639', )([in0Mul87639,in1Mul87639])
Max73632 = keras.layers.Maximum(name = 'Max73632', )([Con97922,Mul87639])
Res75119 = keras.layers.Reshape((2, 1, 4), name = 'Res75119', )(Max73632)
Res11652 = keras.layers.Reshape((2, 4), name = 'Res11652', )(Res75119)
Dot2872 = keras.layers.Dot(axes=(2, 2), name = 'Dot2872', )([Con81916,Res11652])
Ave37844 = keras.layers.Average(name = 'Ave37844', )([in0Ave37844,in1Ave37844])
Zer50367 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer50367', )(Ave37844)
Dot72729 = keras.layers.Dot(axes=(1, 1), name = 'Dot72729', )([Dot2872,Zer50367])
Res51289 = keras.layers.Reshape((2, 2, 1), name = 'Res51289', )(Dot72729)
Res57774 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res57774', )(Res51289)
Zer95556 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer95556', )(Res57774)
Glo79555 = keras.layers.GlobalAveragePooling2D(name = 'Glo79555', )(in0Glo79555)
Res43134 = keras.layers.Reshape((1, 1), name = 'Res43134', )(Glo79555)
Up_36752 = keras.layers.UpSampling1D(size=(1), name = 'Up_36752', )(Res43134)
Res3751 = keras.layers.Reshape((1, 1, 1), name = 'Res3751', )(Up_36752)
Res26899 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res26899', )(Res3751)
Zer29892 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer29892', )(Res26899)
Ave2070 = keras.layers.Average(name = 'Ave2070', )([in0Ave2070,in1Ave2070])
Add76754 = keras.layers.Add(name = 'Add76754', )([Zer29892,Ave2070])
Zer91346 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer91346', )(Add76754)
Max64456 = keras.layers.Maximum(name = 'Max64456', )([Zer95556,Zer91346])
model = tf.keras.models.Model(inputs=[in0Sub98128,in1Sub98128,in0Con81916,in0Min75262,in1Min75262,in0Con97922,in0Mul87639,in1Mul87639,in0Ave37844,in1Ave37844,in0Glo79555,in0Ave2070,in1Ave2070], outputs=Max64456)
in0Sub98128 = tf.constant([[[0.7167, 0.386, 0.76], [0.9583, 0.4771, 0.6433], [0.5041, 0.382, 0.4727]]])
in1Sub98128 = tf.constant([[[0.8273, 0.0465, 0.9142], [0.7031, 0.8043, 0.9234], [0.5341, 0.4412, 0.6913]]])
in0Con81916 = tf.constant([[[0.5929], [0.7244], [0.2734]]])
in0Min75262 = tf.constant([[[[0.4346]]]])
in1Min75262 = tf.constant([[[[0.7729]]]])
in0Con97922 = tf.constant([[[[[0.6011], [0.246]]], [[[0.7392], [0.4291]]]]])
in0Mul87639 = tf.constant([[[[[0.668, 0.6496], [0.4661, 0.1932]]], [[[0.3412, 0.629], [0.0999, 0.3776]]]]])
in1Mul87639 = tf.constant([[[[[0.3072, 0.9741], [0.2386, 0.3205]]], [[[0.5388, 0.8721], [0.0448, 0.0154]]]]])
in0Ave37844 = tf.constant([[[0.9072, 0.5941]]])
in1Ave37844 = tf.constant([[[0.7292, 0.3256]]])
in0Glo79555 = tf.constant([[[[1.8857]], [[1.3627]]]])
in0Ave2070 = tf.constant([[[[[0.1071], [0.9419]], [[0.4172], [0.4645]]]]])
in1Ave2070 = tf.constant([[[[[0.3893], [0.3387]], [[0.6813], [0.9177]]]]])
print (np.array2string(model.predict([in0Sub98128,in1Sub98128,in0Con81916,in0Min75262,in1Min75262,in0Con97922,in0Mul87639,in1Mul87639,in0Ave37844,in1Ave37844,in0Glo79555,in0Ave2070,in1Ave2070],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max64456.png')

LSub98128 = subtract_layer([[[0.7167, 0.386, 0.76], [0.9583, 0.4771, 0.6433], [0.5041, 0.382, 0.4727]]], [[[0.8273, 0.0465, 0.9142], [0.7031, 0.8043, 0.9234], [0.5341, 0.4412, 0.6913]]], Sub98128), 
LCon81916 = concatenate_layer([Sub98128,[[[0.5929], [0.7244], [0.2734]]]], 2, Con81916), 
LMin75262 = minimum_layer([[[[[0.4346]]]], [[[[0.7729]]]]], Min75262), 
LRes36337 = reshape_layer(Min75262, [1, 1, 1, 1], Res36337), 
LZer48551 = zero_padding3D_layer(Res36337, 1, 0, 0, 0, 1, 0, Zer48551), 
LCon97922 = concatenate_layer([Zer48551,[[[[[0.6011], [0.246]]], [[[0.7392], [0.4291]]]]]], 4, Con97922), 
LMul87639 = multiply_layer([[[[[[0.668, 0.6496], [0.4661, 0.1932]]], [[[0.3412, 0.629], [0.0999, 0.3776]]]]], [[[[[0.3072, 0.9741], [0.2386, 0.3205]]], [[[0.5388, 0.8721], [0.0448, 0.0154]]]]]], Mul87639), 
LMax73632 = maximum_layer([Con97922,Mul87639], Max73632), 
LRes75119 = reshape_layer(Max73632, [2, 1, 4], Res75119), 
LRes11652 = reshape_layer(Res75119, [2, 4], Res11652), 
LDot2872 = dot_layer(Con81916,Res11652, 2, 2, Dot2872), 
LAve37844 = average_layer([[[[0.9072, 0.5941]]], [[[0.7292, 0.3256]]]], Ave37844), 
LZer50367 = zero_padding1D_layer(Ave37844, 2, 0, Zer50367), 
LDot72729 = dot_layer(Dot2872,Zer50367, 1, 1, Dot72729), 
LRes51289 = reshape_layer(Dot72729, [2, 2, 1], Res51289), 
LRes57774 = reshape_layer(Res51289, [2, 2, 1, 1], Res57774), 
LZer95556 = zero_padding3D_layer(Res57774, 0, 0, 0, 0, 2, 0, Zer95556), 
LGlo79555 = global_average_pooling2D_layer([[[[1.8857]], [[1.3627]]]], Glo79555), 
LRes43134 = reshape_layer(Glo79555, [1, 1], Res43134), 
LUp_36752 = up_sampling1D_layer(Res43134, 1, Up_36752), 
LRes3751 = reshape_layer(Up_36752, [1, 1, 1], Res3751), 
LRes26899 = reshape_layer(Res3751, [1, 1, 1, 1], Res26899), 
LZer29892 = zero_padding3D_layer(Res26899, 0, 0, 1, 0, 1, 0, Zer29892), 
LAve2070 = average_layer([[[[[[0.1071], [0.9419]], [[0.4172], [0.4645]]]]], [[[[[0.3893], [0.3387]], [[0.6813], [0.9177]]]]]], Ave2070), 
LAdd76754 = add_layer([Zer29892,Ave2070], Add76754), 
LZer91346 = zero_padding3D_layer(Add76754, 1, 0, 0, 0, 1, 0, Zer91346), 
LMax64456 = maximum_layer([Zer95556,Zer91346], Max64456), 
exec_layers([LSub98128,LCon81916,LMin75262,LRes36337,LZer48551,LCon97922,LMul87639,LMax73632,LRes75119,LRes11652,LDot2872,LAve37844,LZer50367,LDot72729,LRes51289,LRes57774,LZer95556,LGlo79555,LRes43134,LUp_36752,LRes3751,LRes26899,LZer29892,LAve2070,LAdd76754,LZer91346,LMax64456],["Sub98128","Con81916","Min75262","Res36337","Zer48551","Con97922","Mul87639","Max73632","Res75119","Res11652","Dot2872","Ave37844","Zer50367","Dot72729","Res51289","Res57774","Zer95556","Glo79555","Res43134","Up_36752","Res3751","Res26899","Zer29892","Ave2070","Add76754","Zer91346","Max64456"],Max64456,"Max64456")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.2482000], [0.6403000]], [[0.0000000], [0.5492500], [2.3153000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0.24819999999999998],[0.6403]],[[0],[0.54925],[2.3153]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]]], [[[0], [0.2482], [0.6403]], [[0], [0.5493], [2.3153]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]]], [[[0], [0.2482], [0.6403]], [[0], [0.5493], [2.3153]]]]]