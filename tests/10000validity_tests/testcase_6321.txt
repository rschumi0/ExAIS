import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot40177 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot40177 = tf.keras.layers.Input(shape=([2, 3]))
in0Max88358 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Max88358 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Dot40177 = keras.layers.Dot(axes=(2, 2), name = 'Dot40177', )([in0Dot40177,in1Dot40177])
Glo2532 = keras.layers.GlobalAveragePooling1D(name = 'Glo2532', )(Dot40177)
Res65462 = keras.layers.Reshape((2, 1), name = 'Res65462', )(Glo2532)
Max88358 = keras.layers.Maximum(name = 'Max88358', )([in0Max88358,in1Max88358])
Res24189 = keras.layers.Reshape((2, 1), name = 'Res24189', )(Max88358)
Mul15989 = keras.layers.Multiply(name = 'Mul15989', )([Res65462,Res24189])
model = tf.keras.models.Model(inputs=[in0Dot40177,in1Dot40177,in0Max88358,in1Max88358], outputs=Mul15989)
in0Dot40177 = tf.constant([[[0.0546, 0.1252, 0.5192], [0.5053, 0.3439, 0.8038]]])
in1Dot40177 = tf.constant([[[0.481, 0.2378, 0.3988], [0.5357, 0.2508, 0.9165]]])
in0Max88358 = tf.constant([[[[[0.8072, 0.8941]]]]])
in1Max88358 = tf.constant([[[[[0.4915, 0.1895]]]]])
print (np.array2string(model.predict([in0Dot40177,in1Dot40177,in0Max88358,in1Max88358],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul15989.png')

LDot40177 = dot_layer([[[0.0546, 0.1252, 0.5192], [0.5053, 0.3439, 0.8038]]], [[[0.481, 0.2378, 0.3988], [0.5357, 0.2508, 0.9165]]], 2, 2, Dot40177), 
LGlo2532 = global_average_pooling1D_layer(Dot40177, Glo2532), 
LRes65462 = reshape_layer(Glo2532, [2, 1], Res65462), 
LMax88358 = maximum_layer([[[[[[0.8072, 0.8941]]]]], [[[[[0.4915, 0.1895]]]]]], Max88358), 
LRes24189 = reshape_layer(Max88358, [2, 1], Res24189), 
LMul15989 = multiply_layer([Res65462,Res24189], Mul15989), 
exec_layers([LDot40177,LGlo2532,LRes65462,LMax88358,LRes24189,LMul15989],["Dot40177","Glo2532","Res65462","Max88358","Res24189","Mul15989"],Mul15989,"Mul15989")

Actual (Unparsed): [[[0.3666610], [0.7287443]]]

Expected (Unparsed): [[[0.366661026608],[0.7287443457805]]]

Actual:   [[[0.3667], [0.7288]]]

Expected: [[[0.3667], [0.7288]]]