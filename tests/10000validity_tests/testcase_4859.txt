import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU34551 = tf.keras.layers.Input(shape=([3, 2]))

GRU34551 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU34551', )(in0GRU34551)
Fla35566 = keras.layers.Flatten(name = 'Fla35566', )(GRU34551)
Mas80630 = keras.layers.Masking(mask_value=2, name = 'Mas80630', )(Fla35566)
model = tf.keras.models.Model(inputs=[in0GRU34551], outputs=Mas80630)
w = model.get_layer('GRU34551').get_weights() 
w[0] = np.array([[5, 5, 7, 5, 4, 7, 7, 4, 6], [7, 8, 7, 2, 2, 10, 6, 7, 4]])
w[1] = np.array([[8, 3, 3, 7, 9, 9, 8, 5, 5], [3, 3, 10, 3, 8, 3, 4, 1, 4], [1, 5, 1, 8, 6, 8, 2, 7, 6]])
w[2] = np.array([8, 4, 6, 9, 2, 2, 7, 1, 1])
model.get_layer('GRU34551').set_weights(w) 
in0GRU34551 = tf.constant([[[6, 6], [2, 4], [10, 6]]])
print (np.array2string(model.predict([in0GRU34551],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas80630.png')

LGRU34551 = gru_layer([[[6, 6], [2, 4], [10, 6]]],[[5, 5, 7, 5, 4, 7, 7, 4, 6], [7, 8, 7, 2, 2, 10, 6, 7, 4]],[[8, 3, 3, 7, 9, 9, 8, 5, 5], [3, 3, 10, 3, 8, 3, 4, 1, 4], [1, 5, 1, 8, 6, 8, 2, 7, 6]],[8, 4, 6, 9, 2, 2, 7, 1, 1], false, GRU34551), 
LFla35566 = flatten_layer(GRU34551, Fla35566), 
LMas80630 = masking_layer(Fla35566, 2, Mas80630), 
exec_layers([LGRU34551,LFla35566,LMas80630],["GRU34551","Fla35566","Mas80630"],Mas80630,"Mas80630")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0,0.0]]

Actual:   [[0, 0, 0]]

Expected: [[0, 0, 0]]