import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea33501 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Ave75364 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave75364 = tf.keras.layers.Input(shape=([2, 1]))
in0Con49671 = tf.keras.layers.Input(shape=([2, 7]))
in0Con71889 = tf.keras.layers.Input(shape=([2, 8, 3, 1]))
in0Sub6910 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))
in1Sub6910 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))

Lea33501 = keras.layers.LeakyReLU(alpha=9.150153259804128, name = 'Lea33501', input_shape=(2, 1, 2))(in0Lea33501)
Res56250 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res56250', )(Lea33501)
Con50571 = keras.layers.Conv3D(4, (2, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con50571', )(Res56250)
Res9406 = keras.layers.Reshape((1, 1, 8), name = 'Res9406', )(Con50571)
Res57508 = keras.layers.Reshape((1, 8), name = 'Res57508', )(Res9406)
Zer3459 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer3459', )(Res57508)
Ave75364 = keras.layers.Average(name = 'Ave75364', )([in0Ave75364,in1Ave75364])
Con49671 = keras.layers.Concatenate(axis=2, name = 'Con49671', )([Ave75364,in0Con49671])
Max70981 = keras.layers.Maximum(name = 'Max70981', )([Zer3459,Con49671])
Res74027 = keras.layers.Reshape((2, 8, 1), name = 'Res74027', )(Max70981)
Res78971 = keras.layers.Reshape((2, 8, 1, 1), name = 'Res78971', )(Res74027)
Zer66750 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer66750', )(Res78971)
Con71889 = keras.layers.Concatenate(axis=4, name = 'Con71889', )([Zer66750,in0Con71889])
Sub6910 = keras.layers.Subtract(name = 'Sub6910', )([in0Sub6910,in1Sub6910])
Zer52530 = keras.layers.ZeroPadding3D(padding=((0, 0), (5, 0), (1, 0)), name = 'Zer52530', )(Sub6910)
Add85226 = keras.layers.Add(name = 'Add85226', )([Con71889,Zer52530])
Res80795 = keras.layers.Reshape((2, 8, 6), name = 'Res80795', )(Add85226)
Res27752 = keras.layers.Reshape((2, 48), name = 'Res27752', )(Res80795)
Sep27734 = keras.layers.SeparableConv1D(2, (2),strides=(1), padding='valid', name = 'Sep27734', )(Res27752)
model = tf.keras.models.Model(inputs=[in0Lea33501,in0Ave75364,in1Ave75364,in0Con49671,in0Con71889,in0Sub6910,in1Sub6910], outputs=Sep27734)
w = model.get_layer('Con50571').get_weights() 
w[0] = np.array([[[[[0.2477, 0.8235, 0.1393, 0.3523]]]], [[[[0.2377, 0.9305, 0.1188, 0.897]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con50571').set_weights(w) 
w = model.get_layer('Sep27734').get_weights() 
w[0] = np.array([[[0.1006], [0.7486], [0.048], [0.2477], [0.2794], [0.2392], [0.6993], [0.9516], [0.1638], [0.3679], [0.2566], [0.7557], [0.1979], [0.8071], [0.7977], [0.8926], [0.4493], [0.2676], [0.2752], [0.5863], [0.1238], [0.5382], [0.5862], [0.6873], [0.1528], [0.8234], [0.1267], [0.1026], [0.7183], [0.5252], [0.5715], [0.5509], [0.743], [0.8569], [0.2413], [0.9895], [0.7053], [0.3198], [0.696], [0.7811], [0.6134], [0.1279], [0.1287], [0.3015], [0.6158], [0.121], [0.7263], [0.2232]], [[0.5172], [0.5747], [0.4082], [0.1536], [0.4182], [0.5806], [0.2589], [0.6538], [0.8054], [0.354], [0.5296], [0.9203], [0.6805], [0.9022], [0.3004], [0.5724], [0.7355], [0.9807], [0.7652], [0.0544], [0.1571], [0.159], [0.6311], [0.1385], [0.3736], [0.1174], [0.3081], [0.8896], [0.947], [0.0069], [0.4063], [0.2435], [0.8561], [0.8171], [0.5543], [0.0403], [0.6153], [0.2177], [0.7048], [0.9537], [0.0333], [0.2664], [0.9058], [0.2617], [0.9251], [0.7087], [0.9794], [0.8156]]])
w[1] = np.array([[[0.6903, 0.3385], [0.0689, 0.4786], [0.0205, 0.8267], [0.5466, 0.136], [0.4522, 0.0707], [0.9662, 0.8159], [0.6928, 0.6238], [0.3198, 0.5001], [0.5654, 0.8917], [0.193, 0.9627], [0.2669, 0.8639], [0.8013, 0.4018], [0.4454, 0.1325], [0.1372, 0.1441], [0.7817, 0.4794], [0.9139, 0.2069], [0.1732, 0.8009], [0.8605, 0.573], [0.1993, 0.0344], [0.4562, 0.005], [0.2744, 0.0545], [0.3707, 0.1072], [0.7843, 0.2133], [0.7234, 0.1285], [0.5469, 0.3124], [0.7673, 0.6913], [0.1348, 0.3186], [0.7605, 0.2327], [0.9574, 0.0569], [0.5931, 0.4458], [0.511, 0.452], [0.2081, 0.4228], [0.8744, 0.6257], [0.9737, 0.5176], [0.3536, 0.305], [0.9436, 0.1687], [0.1594, 0.5456], [0.377, 0.0553], [0.1399, 0.7356], [0.9794, 0.9933], [0.885, 0.2074], [0.0748, 0.921], [0.968, 0.5554], [0.3207, 0.1744], [0.6981, 0.9354], [0.6379, 0.0039], [0.5177, 0.2046], [0.7439, 0.9482]]])
w[2] = np.array([0, 0])
model.get_layer('Sep27734').set_weights(w) 
in0Lea33501 = tf.constant([[[[0.0307, 0.472]], [[0.6776, 0.2347]]]])
in0Ave75364 = tf.constant([[[0.5051], [0.7751]]])
in1Ave75364 = tf.constant([[[0.7646], [0.9806]]])
in0Con49671 = tf.constant([[[0.0088, 0.8667, 0.5802, 0.3622, 0.3406, 0.7748, 0.4247], [0.4727, 0.2965, 0.2734, 0.1097, 0.399, 0.5044, 0.0692]]])
in0Con71889 = tf.constant([[[[[0.5145], [0.427], [0.8998]], [[0.0832], [0.6175], [0.4856]], [[0.483], [0.0263], [0.2237]], [[0.5969], [0.1009], [0.5383]], [[0.9923], [0.5265], [0.9928]], [[0.891], [0.7025], [0.0768]], [[0.7224], [0.0137], [0.5426]], [[0.6341], [0.8771], [0.2048]]], [[[0.5502], [0.2446], [0.5703]], [[0.7699], [0.9197], [0.3339]], [[0.555], [0.6419], [0.9268]], [[0.4806], [0.12], [0.7866]], [[0.1659], [0.1046], [0.7104]], [[0.599], [0.6406], [0.5345]], [[0.3931], [0.5577], [0.0069]], [[0.6856], [0.8674], [0.1167]]]]])
in0Sub6910 = tf.constant([[[[[0.4915, 0.5941], [0.0318, 0.348]], [[0.5873, 0.3891], [0.4468, 0.3783]], [[0.7598, 0.2089], [0.2682, 0.7258]]], [[[0.0559, 0.7953], [0.0254, 0.5726]], [[0.8374, 0.3991], [0.526, 0.8402]], [[0.9626, 0.4072], [0.009, 0.3083]]]]])
in1Sub6910 = tf.constant([[[[[0.2695, 0.514], [0.2, 0.7178]], [[0.3078, 0.7009], [0.8205, 0.792]], [[0.5121, 0.7371], [0.0489, 0.387]]], [[[0.9145, 0.2561], [0.5439, 0.654]], [[0.0518, 0.7232], [0.897, 0.1813]], [[0.94, 0.7674], [0.8049, 0.574]]]]])
print (np.array2string(model.predict([in0Lea33501,in0Ave75364,in1Ave75364,in0Con49671,in0Con71889,in0Sub6910,in1Sub6910],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep27734.png')

LLea33501 = leaky_relu_layer([[[[0.0307, 0.472]], [[0.6776, 0.2347]]]], 9.150153259804128, Lea33501), 
LRes56250 = reshape_layer(Lea33501, [2, 1, 2, 1], Res56250), 
LCon50571 = conv3D_layer(Res56250, 2, 1, 1,[[[[[0.2477, 0.8235, 0.1393, 0.3523]]]], [[[[0.2377, 0.9305, 0.1188, 0.897]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con50571), 
LRes9406 = reshape_layer(Con50571, [1, 1, 8], Res9406), 
LRes57508 = reshape_layer(Res9406, [1, 8], Res57508), 
LZer3459 = zero_padding1D_layer(Res57508, 1, 0, Zer3459), 
LAve75364 = average_layer([[[[0.5051], [0.7751]]], [[[0.7646], [0.9806]]]], Ave75364), 
LCon49671 = concatenate_layer([Ave75364,[[[0.0088, 0.8667, 0.5802, 0.3622, 0.3406, 0.7748, 0.4247], [0.4727, 0.2965, 0.2734, 0.1097, 0.399, 0.5044, 0.0692]]]], 2, Con49671), 
LMax70981 = maximum_layer([Zer3459,Con49671], Max70981), 
LRes74027 = reshape_layer(Max70981, [2, 8, 1], Res74027), 
LRes78971 = reshape_layer(Res74027, [2, 8, 1, 1], Res78971), 
LZer66750 = zero_padding3D_layer(Res78971, 0, 0, 0, 0, 2, 0, Zer66750), 
LCon71889 = concatenate_layer([Zer66750,[[[[[0.5145], [0.427], [0.8998]], [[0.0832], [0.6175], [0.4856]], [[0.483], [0.0263], [0.2237]], [[0.5969], [0.1009], [0.5383]], [[0.9923], [0.5265], [0.9928]], [[0.891], [0.7025], [0.0768]], [[0.7224], [0.0137], [0.5426]], [[0.6341], [0.8771], [0.2048]]], [[[0.5502], [0.2446], [0.5703]], [[0.7699], [0.9197], [0.3339]], [[0.555], [0.6419], [0.9268]], [[0.4806], [0.12], [0.7866]], [[0.1659], [0.1046], [0.7104]], [[0.599], [0.6406], [0.5345]], [[0.3931], [0.5577], [0.0069]], [[0.6856], [0.8674], [0.1167]]]]]], 4, Con71889), 
LSub6910 = subtract_layer([[[[[0.4915, 0.5941], [0.0318, 0.348]], [[0.5873, 0.3891], [0.4468, 0.3783]], [[0.7598, 0.2089], [0.2682, 0.7258]]], [[[0.0559, 0.7953], [0.0254, 0.5726]], [[0.8374, 0.3991], [0.526, 0.8402]], [[0.9626, 0.4072], [0.009, 0.3083]]]]], [[[[[0.2695, 0.514], [0.2, 0.7178]], [[0.3078, 0.7009], [0.8205, 0.792]], [[0.5121, 0.7371], [0.0489, 0.387]]], [[[0.9145, 0.2561], [0.5439, 0.654]], [[0.0518, 0.7232], [0.897, 0.1813]], [[0.94, 0.7674], [0.8049, 0.574]]]]], Sub6910), 
LZer52530 = zero_padding3D_layer(Sub6910, 0, 0, 5, 0, 1, 0, Zer52530), 
LAdd85226 = add_layer([Con71889,Zer52530], Add85226), 
LRes80795 = reshape_layer(Add85226, [2, 8, 6], Res80795), 
LRes27752 = reshape_layer(Res80795, [2, 48], Res27752), 
LSep27734 = separable_conv1D_layer(Res27752, 2,[[[[0.1006], [0.7486], [0.048], [0.2477], [0.2794], [0.2392], [0.6993], [0.9516], [0.1638], [0.3679], [0.2566], [0.7557], [0.1979], [0.8071], [0.7977], [0.8926], [0.4493], [0.2676], [0.2752], [0.5863], [0.1238], [0.5382], [0.5862], [0.6873], [0.1528], [0.8234], [0.1267], [0.1026], [0.7183], [0.5252], [0.5715], [0.5509], [0.743], [0.8569], [0.2413], [0.9895], [0.7053], [0.3198], [0.696], [0.7811], [0.6134], [0.1279], [0.1287], [0.3015], [0.6158], [0.121], [0.7263], [0.2232]], [[0.5172], [0.5747], [0.4082], [0.1536], [0.4182], [0.5806], [0.2589], [0.6538], [0.8054], [0.354], [0.5296], [0.9203], [0.6805], [0.9022], [0.3004], [0.5724], [0.7355], [0.9807], [0.7652], [0.0544], [0.1571], [0.159], [0.6311], [0.1385], [0.3736], [0.1174], [0.3081], [0.8896], [0.947], [0.0069], [0.4063], [0.2435], [0.8561], [0.8171], [0.5543], [0.0403], [0.6153], [0.2177], [0.7048], [0.9537], [0.0333], [0.2664], [0.9058], [0.2617], [0.9251], [0.7087], [0.9794], [0.8156]]],[[[0.6903, 0.3385], [0.0689, 0.4786], [0.0205, 0.8267], [0.5466, 0.136], [0.4522, 0.0707], [0.9662, 0.8159], [0.6928, 0.6238], [0.3198, 0.5001], [0.5654, 0.8917], [0.193, 0.9627], [0.2669, 0.8639], [0.8013, 0.4018], [0.4454, 0.1325], [0.1372, 0.1441], [0.7817, 0.4794], [0.9139, 0.2069], [0.1732, 0.8009], [0.8605, 0.573], [0.1993, 0.0344], [0.4562, 0.005], [0.2744, 0.0545], [0.3707, 0.1072], [0.7843, 0.2133], [0.7234, 0.1285], [0.5469, 0.3124], [0.7673, 0.6913], [0.1348, 0.3186], [0.7605, 0.2327], [0.9574, 0.0569], [0.5931, 0.4458], [0.511, 0.452], [0.2081, 0.4228], [0.8744, 0.6257], [0.9737, 0.5176], [0.3536, 0.305], [0.9436, 0.1687], [0.1594, 0.5456], [0.377, 0.0553], [0.1399, 0.7356], [0.9794, 0.9933], [0.885, 0.2074], [0.0748, 0.921], [0.968, 0.5554], [0.3207, 0.1744], [0.6981, 0.9354], [0.6379, 0.0039], [0.5177, 0.2046], [0.7439, 0.9482]]]],[0, 0], 1, false, Sep27734), 
exec_layers([LLea33501,LRes56250,LCon50571,LRes9406,LRes57508,LZer3459,LAve75364,LCon49671,LMax70981,LRes74027,LRes78971,LZer66750,LCon71889,LSub6910,LZer52530,LAdd85226,LRes80795,LRes27752,LSep27734],["Lea33501","Res56250","Con50571","Res9406","Res57508","Zer3459","Ave75364","Con49671","Max70981","Res74027","Res78971","Zer66750","Con71889","Sub6910","Zer52530","Add85226","Res80795","Res27752","Sep27734"],Sep27734,"Sep27734")

Actual (Unparsed): [[[7.8127236, 6.3537813]]]

Expected (Unparsed): [[[7.812723694712983,6.3537812952011015]]]

Actual:   [[[7.8128, 6.3538]]]

Expected: [[[7.8128, 6.3538]]]