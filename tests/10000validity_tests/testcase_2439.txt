import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max91589 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Dot93033 = tf.keras.layers.Input(shape=([3]))
in1Dot93033 = tf.keras.layers.Input(shape=([3]))
in0Con9395 = tf.keras.layers.Input(shape=([1]))
in0Dot20485 = tf.keras.layers.Input(shape=([2]))
in1Dot20485 = tf.keras.layers.Input(shape=([2]))
in0Con47106 = tf.keras.layers.Input(shape=([4, 3]))
in0Thr36700 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Max91589 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max91589', )(in0Max91589)
Res60213 = keras.layers.Reshape((1, 2), name = 'Res60213', )(Max91589)
Fla62646 = keras.layers.Flatten(name = 'Fla62646', )(Res60213)
Dot93033 = keras.layers.Dot(axes=(1, 1), name = 'Dot93033', )([in0Dot93033,in1Dot93033])
Con9395 = keras.layers.Concatenate(axis=1, name = 'Con9395', )([Dot93033,in0Con9395])
Min93861 = keras.layers.Minimum(name = 'Min93861', )([Fla62646,Con9395])
Res25257 = keras.layers.Reshape((2, 1), name = 'Res25257', )(Min93861)
Zer6658 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer6658', )(Res25257)
Dot20485 = keras.layers.Dot(axes=(1, 1), name = 'Dot20485', )([in0Dot20485,in1Dot20485])
Res1262 = keras.layers.Reshape((1, 1), name = 'Res1262', )(Dot20485)
Zer35522 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer35522', )(Res1262)
Con47106 = keras.layers.Concatenate(axis=2, name = 'Con47106', )([Zer35522,in0Con47106])
Thr36700 = keras.layers.ThresholdedReLU(theta=9.20557752178708, name = 'Thr36700', input_shape=(2, 2, 2, 1))(in0Thr36700)
Lea59561 = keras.layers.LeakyReLU(alpha=9.125768460510304, name = 'Lea59561', )(Thr36700)
Res58763 = keras.layers.Reshape((2, 2, 2), name = 'Res58763', )(Lea59561)
Res1905 = keras.layers.Reshape((2, 4), name = 'Res1905', )(Res58763)
Dot94402 = keras.layers.Dot(axes=(1, 2), name = 'Dot94402', )([Con47106,Res1905])
Den49925 = keras.layers.Dense(1,name = 'Den49925', )(Dot94402)
Min68144 = keras.layers.Minimum(name = 'Min68144', )([Zer6658,Den49925])
model = tf.keras.models.Model(inputs=[in0Max91589,in0Dot93033,in1Dot93033,in0Con9395,in0Dot20485,in1Dot20485,in0Con47106,in0Thr36700], outputs=Min68144)
w = model.get_layer('Den49925').get_weights() 
w[0] = np.array([[0.7196], [0.6836]])
w[1] = np.array([0.2743])
model.get_layer('Den49925').set_weights(w) 
in0Max91589 = tf.constant([[[[1.977, 1.9624]]]])
in0Dot93033 = tf.constant([[0.2928, 0.507, 0.4666]])
in1Dot93033 = tf.constant([[0.9452, 0.0367, 0.4884]])
in0Con9395 = tf.constant([[0.7929]])
in0Dot20485 = tf.constant([[0.8736, 0.1013]])
in1Dot20485 = tf.constant([[0.7317, 0.0647]])
in0Con47106 = tf.constant([[[0.0058, 0.5491, 0.0552], [0.0393, 0.5489, 0.5246], [0.3218, 0.6668, 0.9137], [0.6354, 0.4468, 0.9648]]])
in0Thr36700 = tf.constant([[[[[0.4468], [0.0593]], [[0.1236], [0.4585]]], [[[0.7517], [0.1463]], [[0.879], [0.8405]]]]])
print (np.array2string(model.predict([in0Max91589,in0Dot93033,in1Dot93033,in0Con9395,in0Dot20485,in1Dot20485,in0Con47106,in0Thr36700],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min68144.png')

LMax91589 = max_pool2D_layer([[[[1.977, 1.9624]]]], 1, 1, Max91589), 
LRes60213 = reshape_layer(Max91589, [1, 2], Res60213), 
LFla62646 = flatten_layer(Res60213, Fla62646), 
LDot93033 = dot_layer([[0.2928, 0.507, 0.4666]], [[0.9452, 0.0367, 0.4884]], 1, 1, Dot93033), 
LCon9395 = concatenate_layer([Dot93033,[[0.7929]]], 1, Con9395), 
LMin93861 = minimum_layer([Fla62646,Con9395], Min93861), 
LRes25257 = reshape_layer(Min93861, [2, 1], Res25257), 
LZer6658 = zero_padding1D_layer(Res25257, 2, 0, Zer6658), 
LDot20485 = dot_layer([[0.8736, 0.1013]], [[0.7317, 0.0647]], 1, 1, Dot20485), 
LRes1262 = reshape_layer(Dot20485, [1, 1], Res1262), 
LZer35522 = zero_padding1D_layer(Res1262, 3, 0, Zer35522), 
LCon47106 = concatenate_layer([Zer35522,[[[0.0058, 0.5491, 0.0552], [0.0393, 0.5489, 0.5246], [0.3218, 0.6668, 0.9137], [0.6354, 0.4468, 0.9648]]]], 2, Con47106), 
LThr36700 = thresholded_relu_layer([[[[[0.4468], [0.0593]], [[0.1236], [0.4585]]], [[[0.7517], [0.1463]], [[0.879], [0.8405]]]]], 9.20557752178708, Thr36700), 
LLea59561 = leaky_relu_layer(Thr36700, 9.125768460510304, Lea59561), 
LRes58763 = reshape_layer(Lea59561, [2, 2, 2], Res58763), 
LRes1905 = reshape_layer(Res58763, [2, 4], Res1905), 
LDot94402 = dot_layer(Con47106,Res1905, 1, 2, Dot94402), 
LDen49925 = dense_layer(Dot94402, [[0.7196], [0.6836]],[0.2743], Den49925), 
LMin68144 = minimum_layer([Zer6658,Den49925], Min68144), 
exec_layers([LMax91589,LRes60213,LFla62646,LDot93033,LCon9395,LMin93861,LRes25257,LZer6658,LDot20485,LRes1262,LZer35522,LCon47106,LThr36700,LLea59561,LRes58763,LRes1905,LDot94402,LDen49925,LMin68144],["Max91589","Res60213","Fla62646","Dot93033","Con9395","Min93861","Res25257","Zer6658","Dot20485","Res1262","Zer35522","Con47106","Thr36700","Lea59561","Res58763","Res1905","Dot94402","Den49925","Min68144"],Min68144,"Min68144")

Actual (Unparsed): [[[0.0000000], [0.0000000], [0.2743000], [0.2743000]]]

Expected (Unparsed): [[[0],[0],[0.2743],[0.2743]]]

Actual:   [[[0], [0], [0.2743], [0.2743]]]

Expected: [[[0], [0], [0.2743], [0.2743]]]