import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max3625 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Max3625 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con13537 = tf.keras.layers.Input(shape=([3, 2]))
in0Add2702 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add2702 = tf.keras.layers.Input(shape=([1, 2, 2]))

Max3625 = keras.layers.Maximum(name = 'Max3625', )([in0Max3625,in1Max3625])
Res37910 = keras.layers.Reshape((1, 1, 2), name = 'Res37910', )(Max3625)
Res60159 = keras.layers.Reshape((1, 2), name = 'Res60159', )(Res37910)
Zer34696 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer34696', )(Res60159)
Con13537 = keras.layers.Concatenate(axis=2, name = 'Con13537', )([Zer34696,in0Con13537])
Add2702 = keras.layers.Add(name = 'Add2702', )([in0Add2702,in1Add2702])
Res79511 = keras.layers.Reshape((1, 4), name = 'Res79511', )(Add2702)
Zer37606 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer37606', )(Res79511)
Sof8371 = keras.layers.Softmax(axis=1, name = 'Sof8371', )(Zer37606)
Min50146 = keras.layers.Minimum(name = 'Min50146', )([Con13537,Sof8371])
model = tf.keras.models.Model(inputs=[in0Max3625,in1Max3625,in0Con13537,in0Add2702,in1Add2702], outputs=Min50146)
in0Max3625 = tf.constant([[[[[0.9907], [0.9989]]]]])
in1Max3625 = tf.constant([[[[[0.3885], [0.6305]]]]])
in0Con13537 = tf.constant([[[0.4145, 0.3708], [0.5059, 0.8699], [0.9963, 0.4099]]])
in0Add2702 = tf.constant([[[[0.516, 0.9101], [0.2968, 0.7702]]]])
in1Add2702 = tf.constant([[[[0.9533, 0.919], [0.3816, 0.2229]]]])
print (np.array2string(model.predict([in0Max3625,in1Max3625,in0Con13537,in0Add2702,in1Add2702],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min50146.png')

LMax3625 = maximum_layer([[[[[[0.9907], [0.9989]]]]], [[[[[0.3885], [0.6305]]]]]], Max3625), 
LRes37910 = reshape_layer(Max3625, [1, 1, 2], Res37910), 
LRes60159 = reshape_layer(Res37910, [1, 2], Res60159), 
LZer34696 = zero_padding1D_layer(Res60159, 2, 0, Zer34696), 
LCon13537 = concatenate_layer([Zer34696,[[[0.4145, 0.3708], [0.5059, 0.8699], [0.9963, 0.4099]]]], 2, Con13537), 
LAdd2702 = add_layer([[[[[0.516, 0.9101], [0.2968, 0.7702]]]], [[[[0.9533, 0.919], [0.3816, 0.2229]]]]], Add2702), 
LRes79511 = reshape_layer(Add2702, [1, 4], Res79511), 
LZer37606 = zero_padding1D_layer(Res79511, 1, 1, Zer37606), 
LSof8371 = softmax_layer(Zer37606, 1, Sof8371), 
LMin50146 = minimum_layer([Con13537,Sof8371], Min50146), 
exec_layers([LMax3625,LRes37910,LRes60159,LZer34696,LCon13537,LAdd2702,LRes79511,LZer37606,LSof8371,LMin50146],["Max3625","Res37910","Res60159","Zer34696","Con13537","Add2702","Res79511","Zer37606","Sof8371","Min50146"],Min50146,"Min50146")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.2518434, 0.2127845], [0.0000000, 0.0000000, 0.4963133, 0.5744310], [0.1575748, 0.1215321, 0.2518434, 0.2127845]]]

Expected (Unparsed): [[[0,0,0.2518433641623133,0.21278450845443847],[0,0,0.4963132716753733,0.5744309830911231],[0.15757481662850437,0.12153210146903287,0.2518433641623133,0.21278450845443847]]]

Actual:   [[[0, 0, 0.2519, 0.2128], [0, 0, 0.4964, 0.5745], [0.1576, 0.1216, 0.2519, 0.2128]]]

Expected: [[[0, 0, 0.2519, 0.2128], [0, 0, 0.4964, 0.5745], [0.1576, 0.1216, 0.2519, 0.2128]]]