import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min78035 = tf.keras.layers.Input(shape=([1, 1]))
in1Min78035 = tf.keras.layers.Input(shape=([1, 1]))

Min78035 = keras.layers.Minimum(name = 'Min78035', )([in0Min78035,in1Min78035])
Res54787 = keras.layers.Reshape((1, 1, 1), name = 'Res54787', )(Min78035)
Res57455 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res57455', )(Res54787)
Glo54963 = keras.layers.GlobalAveragePooling3D(name = 'Glo54963', )(Res57455)
ELU83046 = keras.layers.ELU(alpha=-3.554538360130179, name = 'ELU83046', )(Glo54963)
Res58054 = keras.layers.Reshape((1, 1), name = 'Res58054', )(ELU83046)
Res49103 = keras.layers.Reshape((1, 1, 1), name = 'Res49103', )(Res58054)
Loc43725 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc43725', )(Res49103)
Res48167 = keras.layers.Reshape((1, 3), name = 'Res48167', )(Loc43725)
PRe63966 = keras.layers.PReLU(name = 'PRe63966', )(Res48167)
model = tf.keras.models.Model(inputs=[in0Min78035,in1Min78035], outputs=PRe63966)
w = model.get_layer('Loc43725').get_weights() 
w[0] = np.array([[[0.2564, 0.2199, 0.8404]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc43725').set_weights(w) 
w = model.get_layer('PRe63966').get_weights() 
w[0] = np.array([[0.0139, 0.8353, 0.9464]])
model.get_layer('PRe63966').set_weights(w) 
in0Min78035 = tf.constant([[[0.4498]]])
in1Min78035 = tf.constant([[[0.9034]]])
print (np.array2string(model.predict([in0Min78035,in1Min78035],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe63966.png')

LMin78035 = minimum_layer([[[[0.4498]]], [[[0.9034]]]], Min78035), 
LRes54787 = reshape_layer(Min78035, [1, 1, 1], Res54787), 
LRes57455 = reshape_layer(Res54787, [1, 1, 1, 1], Res57455), 
LGlo54963 = global_average_pooling3D_layer(Res57455, Glo54963), 
LELU83046 = elu_layer(Glo54963, -3.554538360130179, ELU83046), 
LRes58054 = reshape_layer(ELU83046, [1, 1], Res58054), 
LRes49103 = reshape_layer(Res58054, [1, 1, 1], Res49103), 
LLoc43725 = locally_connected2D_layer(Res49103, 1, 1,[[[0.2564, 0.2199, 0.8404]]],[[[0, 0, 0]]], 1, 1, Loc43725), 
LRes48167 = reshape_layer(Loc43725, [1, 3], Res48167), 
LPRe63966 = prelu_layer(Res48167, [[0.0139, 0.8353, 0.9464]], PRe63966), 
exec_layers([LMin78035,LRes54787,LRes57455,LGlo54963,LELU83046,LRes58054,LRes49103,LLoc43725,LRes48167,LPRe63966],["Min78035","Res54787","Res57455","Glo54963","ELU83046","Res58054","Res49103","Loc43725","Res48167","PRe63966"],PRe63966,"PRe63966")

Actual (Unparsed): [[[0.1153287, 0.0989110, 0.3780119]]]

Expected (Unparsed): [[[0.11532872,0.09891102,0.37801192]]]

Actual:   [[[0.1154, 0.099, 0.3781]]]

Expected: [[[0.1154, 0.099, 0.3781]]]