import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave3123 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave3123 = tf.keras.layers.Input(shape=([2, 2]))
in0Con13229 = tf.keras.layers.Input(shape=([2, 1]))
in0Loc69721 = tf.keras.layers.Input(shape=([1, 1]))

Ave3123 = keras.layers.Average(name = 'Ave3123', )([in0Ave3123,in1Ave3123])
Con13229 = keras.layers.Concatenate(axis=2, name = 'Con13229', )([Ave3123,in0Con13229])
Loc69721 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc69721', )(in0Loc69721)
Zer77639 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer77639', )(Loc69721)
Mul67061 = keras.layers.Multiply(name = 'Mul67061', )([Con13229,Zer77639])
Thr63377 = keras.layers.ThresholdedReLU(theta=8.892868330124541, name = 'Thr63377', )(Mul67061)
Per96441 = keras.layers.Permute((2,1), name = 'Per96441',)(Thr63377)
model = tf.keras.models.Model(inputs=[in0Ave3123,in1Ave3123,in0Con13229,in0Loc69721], outputs=Per96441)
w = model.get_layer('Loc69721').get_weights() 
w[0] = np.array([[[0.2331, 0.7911, 0.7393]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc69721').set_weights(w) 
in0Ave3123 = tf.constant([[[0.8316, 0.0015], [0.3872, 0.8853]]])
in1Ave3123 = tf.constant([[[0.8571, 0.2054], [0.7339, 0.9925]]])
in0Con13229 = tf.constant([[[0.939], [0.649]]])
in0Loc69721 = tf.constant([[[0.8257]]])
print (np.array2string(model.predict([in0Ave3123,in1Ave3123,in0Con13229,in0Loc69721],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per96441.png')

LAve3123 = average_layer([[[[0.8316, 0.0015], [0.3872, 0.8853]]], [[[0.8571, 0.2054], [0.7339, 0.9925]]]], Ave3123), 
LCon13229 = concatenate_layer([Ave3123,[[[0.939], [0.649]]]], 2, Con13229), 
LLoc69721 = locally_connected1D_layer([[[0.8257]]], 1,[[[0.2331, 0.7911, 0.7393]]],[[0, 0, 0]], 1, Loc69721), 
LZer77639 = zero_padding1D_layer(Loc69721, 1, 0, Zer77639), 
LMul67061 = multiply_layer([Con13229,Zer77639], Mul67061), 
LThr63377 = thresholded_relu_layer(Mul67061, 8.892868330124541, Thr63377), 
LPer96441 = permute_layer(Thr63377, 2,1, Per96441), 
exec_layers([LAve3123,LCon13229,LLoc69721,LZer77639,LMul67061,LThr63377,LPer96441],["Ave3123","Con13229","Loc69721","Zer77639","Mul67061","Thr63377","Per96441"],Per96441,"Per96441")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0],[0,0],[0,0]]]

Actual:   [[[0, 0], [0, 0], [0, 0]]]

Expected: [[[0, 0], [0, 0], [0, 0]]]