import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub56829 = tf.keras.layers.Input(shape=([2]))
in1Sub56829 = tf.keras.layers.Input(shape=([2]))
in0Glo34058 = tf.keras.layers.Input(shape=([1, 2]))

Sub56829 = keras.layers.Subtract(name = 'Sub56829', )([in0Sub56829,in1Sub56829])
Glo34058 = keras.layers.GlobalMaxPool1D(name = 'Glo34058', )(in0Glo34058)
Min28146 = keras.layers.Minimum(name = 'Min28146', )([Sub56829,Glo34058])
Res31781 = keras.layers.Reshape((2, 1), name = 'Res31781', )(Min28146)
Res96441 = keras.layers.Reshape((2, 1, 1), name = 'Res96441', )(Res31781)
Sep72558 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='same', name = 'Sep72558', )(Res96441)
Res61097 = keras.layers.Reshape((2, 2), name = 'Res61097', )(Sep72558)
Con34142 = keras.layers.Conv1D(4, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con34142', )(Res61097)
model = tf.keras.models.Model(inputs=[in0Sub56829,in1Sub56829,in0Glo34058], outputs=Con34142)
w = model.get_layer('Sep72558').get_weights() 
w[0] = np.array([[[[0.1441]]]])
w[1] = np.array([[[[0.1104, 0.3254]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep72558').set_weights(w) 
w = model.get_layer('Con34142').get_weights() 
w[0] = np.array([[[0.5668, 0.9076, 0.757, 0.3238], [0.3793, 0.4236, 0.7862, 0.5629]], [[0.7629, 0.339, 0.871, 0.6425], [0.3457, 0.405, 0.2142, 0.5591]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con34142').set_weights(w) 
in0Sub56829 = tf.constant([[0.7561, 0.1713]])
in1Sub56829 = tf.constant([[0.3154, 0.3936]])
in0Glo34058 = tf.constant([[[1.2911, 1.9667]]])
print (np.array2string(model.predict([in0Sub56829,in1Sub56829,in0Glo34058],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con34142.png')

LSub56829 = subtract_layer([[0.7561, 0.1713]], [[0.3154, 0.3936]], Sub56829), 
LGlo34058 = global_max_pool1D_layer([[[1.2911, 1.9667]]], Glo34058), 
LMin28146 = minimum_layer([Sub56829,Glo34058], Min28146), 
LRes31781 = reshape_layer(Min28146, [2, 1], Res31781), 
LRes96441 = reshape_layer(Res31781, [2, 1, 1], Res96441), 
LSep72558 = separable_conv2D_layer(Res96441, 1, 1,[[[[[0.1441]]]],[[[[0.1104, 0.3254]]]]],[0, 0], 1, 1, true, Sep72558), 
LRes61097 = reshape_layer(Sep72558, [2, 2], Res61097), 
LCon34142 = conv1D_layer(Res61097, 2,[[[0.5668, 0.9076, 0.757, 0.3238], [0.3793, 0.4236, 0.7862, 0.5629]], [[0.7629, 0.339, 0.871, 0.6425], [0.3457, 0.405, 0.2142, 0.5591]]],[0, 0, 0, 0], 1, false, 1, Con34142), 
exec_layers([LSub56829,LGlo34058,LMin28146,LRes31781,LRes96441,LSep72558,LRes61097,LCon34142],["Sub56829","Glo34058","Min28146","Res31781","Res96441","Sep72558","Res61097","Con34142"],Con34142,"Con34142")

Actual (Unparsed): [[[0.0055104, 0.0096961, 0.0162407, 0.0058021]]]

Expected (Unparsed): [[[0.0055103842443936,0.0096961427501796,0.0162406624400592,0.005802106352156399]]]

Actual:   [[[0.0056, 0.0097, 0.0163, 0.0059]]]

Expected: [[[0.0056, 0.0097, 0.0163, 0.0059]]]