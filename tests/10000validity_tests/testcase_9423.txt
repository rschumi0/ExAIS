import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla9046 = tf.keras.layers.Input(shape=([3, 4, 3]))
in0Con96456 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot75022 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot75022 = tf.keras.layers.Input(shape=([3, 2]))

Fla9046 = keras.layers.Flatten(name = 'Fla9046', )(in0Fla9046)
Res13660 = keras.layers.Reshape((36, 1), name = 'Res13660', )(Fla9046)
Res50864 = keras.layers.Reshape((36, 1, 1), name = 'Res50864', )(Res13660)
Res10130 = keras.layers.Reshape((36, 1, 1, 1), name = 'Res10130', )(Res50864)
Glo82786 = keras.layers.GlobalMaxPool3D(name = 'Glo82786', )(Res10130)
Res89913 = keras.layers.Reshape((1, 1), name = 'Res89913', )(Glo82786)
Zer85931 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer85931', )(Res89913)
Con96456 = keras.layers.Concatenate(axis=2, name = 'Con96456', )([Zer85931,in0Con96456])
Dot75022 = keras.layers.Dot(axes=(1, 1), name = 'Dot75022', )([in0Dot75022,in1Dot75022])
Max19720 = keras.layers.Maximum(name = 'Max19720', )([Con96456,Dot75022])
model = tf.keras.models.Model(inputs=[in0Fla9046,in0Con96456,in0Dot75022,in1Dot75022], outputs=Max19720)
in0Fla9046 = tf.constant([[[[1.1526, 1.1163, 1.1493], [1.2565, 1.2431, 1.1841], [1.0546, 1.5027, 1.0413], [1.4574, 1.6006, 1.937]], [[1.3845, 1.2594, 1.4407], [1.8615, 1.8898, 1.7423], [1.4209, 1.303, 1.5209], [1.7839, 1.712, 1.7593]], [[1.1393, 1.4659, 1.2025], [1.2009, 1.9458, 1.6513], [1.0977, 1.0434, 1.7721], [1.1075, 1.2982, 1.4379]]]])
in0Con96456 = tf.constant([[[0.5923], [0.5834]]])
in0Dot75022 = tf.constant([[[0.6385, 0.2172], [0.67, 0.0262], [0.8605, 0.5637]]])
in1Dot75022 = tf.constant([[[0.7586, 0.2531], [0.2532, 0.5815], [0.8487, 0.438]]])
print (np.array2string(model.predict([in0Fla9046,in0Con96456,in0Dot75022,in1Dot75022],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max19720.png')

LFla9046 = flatten_layer([[[[1.1526, 1.1163, 1.1493], [1.2565, 1.2431, 1.1841], [1.0546, 1.5027, 1.0413], [1.4574, 1.6006, 1.937]], [[1.3845, 1.2594, 1.4407], [1.8615, 1.8898, 1.7423], [1.4209, 1.303, 1.5209], [1.7839, 1.712, 1.7593]], [[1.1393, 1.4659, 1.2025], [1.2009, 1.9458, 1.6513], [1.0977, 1.0434, 1.7721], [1.1075, 1.2982, 1.4379]]]], Fla9046), 
LRes13660 = reshape_layer(Fla9046, [36, 1], Res13660), 
LRes50864 = reshape_layer(Res13660, [36, 1, 1], Res50864), 
LRes10130 = reshape_layer(Res50864, [36, 1, 1, 1], Res10130), 
LGlo82786 = global_max_pool3D_layer(Res10130, Glo82786), 
LRes89913 = reshape_layer(Glo82786, [1, 1], Res89913), 
LZer85931 = zero_padding1D_layer(Res89913, 1, 0, Zer85931), 
LCon96456 = concatenate_layer([Zer85931,[[[0.5923], [0.5834]]]], 2, Con96456), 
LDot75022 = dot_layer([[[0.6385, 0.2172], [0.67, 0.0262], [0.8605, 0.5637]]], [[[0.7586, 0.2531], [0.2532, 0.5815], [0.8487, 0.438]]], 1, 1, Dot75022), 
LMax19720 = maximum_layer([Con96456,Dot75022], Max19720), 
exec_layers([LFla9046,LRes13660,LRes50864,LRes10130,LGlo82786,LRes89913,LZer85931,LCon96456,LDot75022,LMax19720],["Fla9046","Res13660","Res50864","Res10130","Glo82786","Res89913","Zer85931","Con96456","Dot75022","Max19720"],Max19720,"Max19720")

Actual (Unparsed): [[[1.3843164, 0.9281083], [1.9457999, 0.5834000]]]

Expected (Unparsed): [[[1.38431645,0.92810835],[1.9458,0.5834]]]

Actual:   [[[1.3844, 0.9282], [1.9458, 0.5834]]]

Expected: [[[1.3844, 0.9282], [1.9458, 0.5834]]]