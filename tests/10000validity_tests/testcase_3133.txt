import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max4673 = tf.keras.layers.Input(shape=([1, 2]))
in1Max4673 = tf.keras.layers.Input(shape=([1, 2]))

Max4673 = keras.layers.Maximum(name = 'Max4673', )([in0Max4673,in1Max4673])
Thr61075 = keras.layers.ThresholdedReLU(theta=9.53484882142289, name = 'Thr61075', )(Max4673)
Lay29095 = keras.layers.LayerNormalization(axis=1, epsilon=2.9047352906813306, name = 'Lay29095', )(Thr61075)
Res98769 = keras.layers.Reshape((1, 2, 1), name = 'Res98769', )(Lay29095)
Res64088 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res64088', )(Res98769)
Glo72865 = keras.layers.GlobalMaxPool3D(name = 'Glo72865', )(Res64088)
model = tf.keras.models.Model(inputs=[in0Max4673,in1Max4673], outputs=Glo72865)
in0Max4673 = tf.constant([[[0.9048, 0.5975]]])
in1Max4673 = tf.constant([[[0.823, 0.769]]])
print (np.array2string(model.predict([in0Max4673,in1Max4673],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo72865.png')

LMax4673 = maximum_layer([[[[0.9048, 0.5975]]], [[[0.823, 0.769]]]], Max4673), 
LThr61075 = thresholded_relu_layer(Max4673, 9.53484882142289, Thr61075), 
LLay29095 = layer_normalization_layer(Thr61075, 1, 2.9047352906813306, Lay29095), 
LRes98769 = reshape_layer(Lay29095, [1, 2, 1], Res98769), 
LRes64088 = reshape_layer(Res98769, [1, 2, 1, 1], Res64088), 
LGlo72865 = global_max_pool3D_layer(Res64088, Glo72865), 
exec_layers([LMax4673,LThr61075,LLay29095,LRes98769,LRes64088,LGlo72865],["Max4673","Thr61075","Lay29095","Res98769","Res64088","Glo72865"],Glo72865,"Glo72865")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0.0]]

Actual:   [[0]]

Expected: [[0]]