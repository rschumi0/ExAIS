import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave83836 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Ave83836 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Ave83836 = keras.layers.Average(name = 'Ave83836', )([in0Ave83836,in1Ave83836])
Bat47442 = keras.layers.BatchNormalization(axis=2, epsilon=0.7871250348235188,  name = 'Bat47442', )(Ave83836)
Res43270 = keras.layers.Reshape((2, 1, 2), name = 'Res43270', )(Bat47442)
Res2036 = keras.layers.Reshape((2, 2), name = 'Res2036', )(Res43270)
Up_99900 = keras.layers.UpSampling1D(size=(2), name = 'Up_99900', )(Res2036)
model = tf.keras.models.Model(inputs=[in0Ave83836,in1Ave83836], outputs=Up_99900)
w = model.get_layer('Bat47442').get_weights() 
w[0] = np.array([0.1787])
w[1] = np.array([0.0549])
w[2] = np.array([0.7358])
w[3] = np.array([0.0852])
model.get_layer('Bat47442').set_weights(w) 
in0Ave83836 = tf.constant([[[[[0.6121, 0.1165]]], [[[0.749, 0.3217]]]]])
in1Ave83836 = tf.constant([[[[[0.4791, 0.0313]]], [[[0.0341, 0.0911]]]]])
print (np.array2string(model.predict([in0Ave83836,in1Ave83836],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_99900.png')

LAve83836 = average_layer([[[[[[0.6121, 0.1165]]], [[[0.749, 0.3217]]]]], [[[[[0.4791, 0.0313]]], [[[0.0341, 0.0911]]]]]], Ave83836), 
LBat47442 = batch_normalization_layer(Ave83836, 2, 0.7871250348235188, [0.1787], [0.0549], [0.7358], [0.0852], Bat47442), 
LRes43270 = reshape_layer(Bat47442, [2, 1, 2], Res43270), 
LRes2036 = reshape_layer(Res43270, [2, 2], Res2036), 
LUp_99900 = up_sampling1D_layer(Res2036, 2, Up_99900), 
exec_layers([LAve83836,LBat47442,LRes43270,LRes2036,LUp_99900],["Ave83836","Bat47442","Res43270","Res2036","Up_99900"],Up_99900,"Up_99900")

Actual (Unparsed): [[[0.0185088, -0.0717420], [0.0185088, -0.0717420], [-0.0109657, -0.0463906], [-0.0109657, -0.0463906]]]

Expected (Unparsed): [[[0.018508840204752783,-0.07174200141153589],[0.018508840204752783,-0.07174200141153589],[-0.010965703257170618,-0.04639064140696043],[-0.010965703257170618,-0.04639064140696043]]]

Actual:   [[[0.0186, -0.0717], [0.0186, -0.0717], [-0.0109, -0.0463], [-0.0109, -0.0463]]]

Expected: [[[0.0186, -0.0717], [0.0186, -0.0717], [-0.0109, -0.0463], [-0.0109, -0.0463]]]