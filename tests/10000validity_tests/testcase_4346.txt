import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof40809 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Add74116 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Add74116 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con86665 = tf.keras.layers.Input(shape=([2, 2]))
in0Cro287 = tf.keras.layers.Input(shape=([2, 2]))
in0Con35760 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Mul63077 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Mul63077 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Mul99397 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Mul99397 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con38734 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Sof40809 = keras.layers.Softmax(axis=1, name = 'Sof40809', input_shape=(1, 2, 1, 1))(in0Sof40809)
ReL79643 = keras.layers.ReLU(max_value=0.6193881120967005, negative_slope=2.4375097880626004, threshold=1.9244310902095563, name = 'ReL79643', )(Sof40809)
Res57336 = keras.layers.Reshape((1, 2, 1), name = 'Res57336', )(ReL79643)
Res1759 = keras.layers.Reshape((1, 2), name = 'Res1759', )(Res57336)
Add74116 = keras.layers.Add(name = 'Add74116', )([in0Add74116,in1Add74116])
Res71407 = keras.layers.Reshape((1, 1, 2), name = 'Res71407', )(Add74116)
Res6302 = keras.layers.Reshape((1, 2), name = 'Res6302', )(Res71407)
Dot9343 = keras.layers.Dot(axes=(1, 1), name = 'Dot9343', )([Res1759,Res6302])
Con86665 = keras.layers.Concatenate(axis=2, name = 'Con86665', )([Dot9343,in0Con86665])
Cro287 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro287', )(in0Cro287)
Res19656 = keras.layers.Reshape((2, 2, 1), name = 'Res19656', )(Cro287)
Res97946 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res97946', )(Res19656)
Con35760 = keras.layers.Concatenate(axis=4, name = 'Con35760', )([Res97946,in0Con35760])
Mul63077 = keras.layers.Multiply(name = 'Mul63077', )([in0Mul63077,in1Mul63077])
Zer9704 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer9704', )(Mul63077)
Add92392 = keras.layers.Add(name = 'Add92392', )([Con35760,Zer9704])
Mul99397 = keras.layers.Multiply(name = 'Mul99397', )([in0Mul99397,in1Mul99397])
Zer54159 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer54159', )(Mul99397)
Con38734 = keras.layers.Concatenate(axis=4, name = 'Con38734', )([Zer54159,in0Con38734])
Max74872 = keras.layers.Maximum(name = 'Max74872', )([Add92392,Con38734])
Res55326 = keras.layers.Reshape((2, 2, 2), name = 'Res55326', )(Max74872)
Res39562 = keras.layers.Reshape((2, 4), name = 'Res39562', )(Res55326)
Dot49962 = keras.layers.Dot(axes=(1, 1), name = 'Dot49962', )([Con86665,Res39562])
Mas57271 = keras.layers.Masking(mask_value=2, name = 'Mas57271', )(Dot49962)
model = tf.keras.models.Model(inputs=[in0Sof40809,in0Add74116,in1Add74116,in0Con86665,in0Cro287,in0Con35760,in0Mul63077,in1Mul63077,in0Mul99397,in1Mul99397,in0Con38734], outputs=Mas57271)
in0Sof40809 = tf.constant([[[[[0.8709]], [[0.1492]]]]])
in0Add74116 = tf.constant([[[[[0.3673, 0.7244]]]]])
in1Add74116 = tf.constant([[[[[0.0042, 0.0527]]]]])
in0Con86665 = tf.constant([[[0.7747, 0.0257], [0.4353, 0.6363]]])
in0Cro287 = tf.constant([[[1.7602, 1.6142], [1.2025, 1.1042]]])
in0Con35760 = tf.constant([[[[[0.122]], [[0.1207]]], [[[0.7604]], [[0.153]]]]])
in0Mul63077 = tf.constant([[[[[0.1148, 0.9309]]], [[[0.22, 0.8356]]]]])
in1Mul63077 = tf.constant([[[[[0.9093, 0.8085]]], [[[0.0668, 0.5438]]]]])
in0Mul99397 = tf.constant([[[[[0.8356]]]]])
in1Mul99397 = tf.constant([[[[[0.8256]]]]])
in0Con38734 = tf.constant([[[[[0.5487]], [[0.4044]]], [[[0.0995]], [[0.601]]]]])
print (np.array2string(model.predict([in0Sof40809,in0Add74116,in1Add74116,in0Con86665,in0Cro287,in0Con35760,in0Mul63077,in1Mul63077,in0Mul99397,in1Mul99397,in0Con38734],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas57271.png')

LSof40809 = softmax_layer([[[[[0.8709]], [[0.1492]]]]], 1, Sof40809), 
LReL79643 = relu_layer(Sof40809, 0.6193881120967005, 2.4375097880626004, 1.9244310902095563, ReL79643), 
LRes57336 = reshape_layer(ReL79643, [1, 2, 1], Res57336), 
LRes1759 = reshape_layer(Res57336, [1, 2], Res1759), 
LAdd74116 = add_layer([[[[[[0.3673, 0.7244]]]]], [[[[[0.0042, 0.0527]]]]]], Add74116), 
LRes71407 = reshape_layer(Add74116, [1, 1, 2], Res71407), 
LRes6302 = reshape_layer(Res71407, [1, 2], Res6302), 
LDot9343 = dot_layer(Res1759,Res6302, 1, 1, Dot9343), 
LCon86665 = concatenate_layer([Dot9343,[[[0.7747, 0.0257], [0.4353, 0.6363]]]], 2, Con86665), 
LCro287 = cropping1D_layer([[[1.7602, 1.6142], [1.2025, 1.1042]]], 0, 0, Cro287), 
LRes19656 = reshape_layer(Cro287, [2, 2, 1], Res19656), 
LRes97946 = reshape_layer(Res19656, [2, 2, 1, 1], Res97946), 
LCon35760 = concatenate_layer([Res97946,[[[[[0.122]], [[0.1207]]], [[[0.7604]], [[0.153]]]]]], 4, Con35760), 
LMul63077 = multiply_layer([[[[[[0.1148, 0.9309]]], [[[0.22, 0.8356]]]]], [[[[[0.9093, 0.8085]]], [[[0.0668, 0.5438]]]]]], Mul63077), 
LZer9704 = zero_padding3D_layer(Mul63077, 0, 0, 1, 0, 0, 0, Zer9704), 
LAdd92392 = add_layer([Con35760,Zer9704], Add92392), 
LMul99397 = multiply_layer([[[[[[0.8356]]]]], [[[[[0.8256]]]]]], Mul99397), 
LZer54159 = zero_padding3D_layer(Mul99397, 1, 0, 1, 0, 0, 0, Zer54159), 
LCon38734 = concatenate_layer([Zer54159,[[[[[0.5487]], [[0.4044]]], [[[0.0995]], [[0.601]]]]]], 4, Con38734), 
LMax74872 = maximum_layer([Add92392,Con38734], Max74872), 
LRes55326 = reshape_layer(Max74872, [2, 2, 2], Res55326), 
LRes39562 = reshape_layer(Res55326, [2, 4], Res39562), 
LDot49962 = dot_layer(Con86665,Res39562, 1, 1, Dot49962), 
LMas57271 = masking_layer(Dot49962, 2, Mas57271), 
exec_layers([LSof40809,LReL79643,LRes57336,LRes1759,LAdd74116,LRes71407,LRes6302,LDot9343,LCon86665,LCro287,LRes19656,LRes97946,LCon35760,LMul63077,LZer9704,LAdd92392,LMul99397,LZer54159,LCon38734,LMax74872,LRes55326,LRes39562,LDot49962,LMas57271],["Sof40809","ReL79643","Res57336","Res1759","Add74116","Res71407","Res6302","Dot9343","Con86665","Cro287","Res19656","Res97946","Con35760","Mul63077","Zer9704","Add92392","Mul99397","Zer54159","Con38734","Max74872","Res55326","Res39562","Dot49962","Mas57271"],Mas57271,"Mas57271")

Actual (Unparsed): [[[-2.4800898, -1.0958536, -2.3752706, -1.2395275], [-5.1878271, -2.2922956, -4.9685673, -2.5928312], [1.8870752, 0.7560800, 1.8184452, 0.9409717], [0.8103879, 0.4979441, 0.7561213, 0.4089328]]]

Expected (Unparsed): [[[-2.480089804739371,-1.0958536346522803,-2.3752706135210317,-1.239527513128245],[-5.187827152793984,-2.292295718676412,-4.968567412563105,-2.592831306734749],[1.88707519,0.75608001,1.8184452735080003,0.9409717105390001],[0.8103878899999999,0.49794410999999994,0.7561212271480001,0.40893281096899997]]]

Actual:   [[[-2.48, -1.0958, -2.3752, -1.2395], [-5.1878, -2.2922, -4.9685, -2.5928], [1.8871, 0.7561, 1.8185, 0.941], [0.8104, 0.498, 0.7562, 0.409]]]

Expected: [[[-2.48, -1.0958, -2.3752, -1.2395], [-5.1878, -2.2922, -4.9685, -2.5928], [1.8871, 0.7561, 1.8185, 0.941], [0.8104, 0.498, 0.7562, 0.409]]]