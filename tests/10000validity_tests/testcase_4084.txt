import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul33115 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Mul33115 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Con56575 = tf.keras.layers.Input(shape=([1, 20]))
in0Sub89923 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))
in1Sub89923 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))

Mul33115 = keras.layers.Multiply(name = 'Mul33115', )([in0Mul33115,in1Mul33115])
Res12567 = keras.layers.Reshape((2, 1, 4), name = 'Res12567', )(Mul33115)
Dep72320 = keras.layers.DepthwiseConv2D((2, 1),strides=(2, 2), padding='valid', name = 'Dep72320', )(Res12567)
Res93742 = keras.layers.Reshape((1, 4), name = 'Res93742', )(Dep72320)
Con56575 = keras.layers.Concatenate(axis=2, name = 'Con56575', )([Res93742,in0Con56575])
Sub89923 = keras.layers.Subtract(name = 'Sub89923', )([in0Sub89923,in1Sub89923])
Res90896 = keras.layers.Reshape((3, 2, 6), name = 'Res90896', )(Sub89923)
Zer5680 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer5680', )(Res90896)
Res25407 = keras.layers.Reshape((5, 24), name = 'Res25407', )(Zer5680)
Dot60613 = keras.layers.Dot(axes=(2, 2), name = 'Dot60613', )([Con56575,Res25407])
Up_78705 = keras.layers.UpSampling1D(size=(2), name = 'Up_78705', )(Dot60613)
model = tf.keras.models.Model(inputs=[in0Mul33115,in1Mul33115,in0Con56575,in0Sub89923,in1Sub89923], outputs=Up_78705)
w = model.get_layer('Dep72320').get_weights() 
w[0] = np.array([[[[0.112], [0.5807], [0.712], [0.4925]]], [[[0.5071], [0.6637], [0.4403], [0.4742]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Dep72320').set_weights(w) 
in0Mul33115 = tf.constant([[[[[0.1961, 0.2085], [0.9709, 0.2139]]], [[[0.1928, 0.4164], [0.9789, 0.6253]]]]])
in1Mul33115 = tf.constant([[[[[0.76, 0.1476], [0.1209, 0.0141]]], [[[0.967, 0.8081], [0.174, 0.584]]]]])
in0Con56575 = tf.constant([[[0.9974, 0.869, 0.3653, 0.5163, 0.4888, 0.8601, 0.8957, 0.0791, 0.5708, 0.6058, 0.6676, 0.31, 0.7486, 0.1805, 0.6138, 0.9766, 0.2499, 0.0984, 0.6383, 0.1086]]])
in0Sub89923 = tf.constant([[[[[0.4915, 0.3531], [0.4709, 0.3271], [0.0747, 0.2294]], [[0.5971, 0.0434], [0.73, 0.1523], [0.4175, 0.8724]]], [[[0.3452, 0.3896], [0.0365, 0.4144], [0.0356, 0.8856]], [[0.215, 0.5062], [0.9758, 0.1266], [0.8435, 0.1144]]], [[[0.4673, 0.1218], [0.2986, 0.6097], [0.6846, 0.2535]], [[0.9034, 0.8932], [0.8801, 0.0387], [0.2504, 0.4607]]]]])
in1Sub89923 = tf.constant([[[[[0.8299, 0.0326], [0.8511, 0.5121], [0.9503, 0.2072]], [[0.4274, 0.6378], [0.83, 0.1411], [0.1786, 0.4495]]], [[[0.8848, 0.2669], [0.521, 0.7595], [0.4645, 0.2423]], [[0.1266, 0.5607], [0.0223, 0.2327], [0.567, 0.1084]]], [[[0.8885, 0.524], [0.5055, 0.8665], [0.7823, 0.4195]], [[0.1768, 0.9407], [0.4439, 0.8188], [0.8412, 0.8968]]]]])
print (np.array2string(model.predict([in0Mul33115,in1Mul33115,in0Con56575,in0Sub89923,in1Sub89923],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_78705.png')

LMul33115 = multiply_layer([[[[[[0.1961, 0.2085], [0.9709, 0.2139]]], [[[0.1928, 0.4164], [0.9789, 0.6253]]]]], [[[[[0.76, 0.1476], [0.1209, 0.0141]]], [[[0.967, 0.8081], [0.174, 0.584]]]]]], Mul33115), 
LRes12567 = reshape_layer(Mul33115, [2, 1, 4], Res12567), 
LDep72320 = depthwise_conv2D_layer(Res12567, 2, 1,[[[[0.112], [0.5807], [0.712], [0.4925]]], [[[0.5071], [0.6637], [0.4403], [0.4742]]]],[0, 0, 0, 0], 2, 2, false, Dep72320), 
LRes93742 = reshape_layer(Dep72320, [1, 4], Res93742), 
LCon56575 = concatenate_layer([Res93742,[[[0.9974, 0.869, 0.3653, 0.5163, 0.4888, 0.8601, 0.8957, 0.0791, 0.5708, 0.6058, 0.6676, 0.31, 0.7486, 0.1805, 0.6138, 0.9766, 0.2499, 0.0984, 0.6383, 0.1086]]]], 2, Con56575), 
LSub89923 = subtract_layer([[[[[0.4915, 0.3531], [0.4709, 0.3271], [0.0747, 0.2294]], [[0.5971, 0.0434], [0.73, 0.1523], [0.4175, 0.8724]]], [[[0.3452, 0.3896], [0.0365, 0.4144], [0.0356, 0.8856]], [[0.215, 0.5062], [0.9758, 0.1266], [0.8435, 0.1144]]], [[[0.4673, 0.1218], [0.2986, 0.6097], [0.6846, 0.2535]], [[0.9034, 0.8932], [0.8801, 0.0387], [0.2504, 0.4607]]]]], [[[[[0.8299, 0.0326], [0.8511, 0.5121], [0.9503, 0.2072]], [[0.4274, 0.6378], [0.83, 0.1411], [0.1786, 0.4495]]], [[[0.8848, 0.2669], [0.521, 0.7595], [0.4645, 0.2423]], [[0.1266, 0.5607], [0.0223, 0.2327], [0.567, 0.1084]]], [[[0.8885, 0.524], [0.5055, 0.8665], [0.7823, 0.4195]], [[0.1768, 0.9407], [0.4439, 0.8188], [0.8412, 0.8968]]]]], Sub89923), 
LRes90896 = reshape_layer(Sub89923, [3, 2, 6], Res90896), 
LZer5680 = zero_padding2D_layer(Res90896, 1, 1, 1, 1, Zer5680), 
LRes25407 = reshape_layer(Zer5680, [5, 24], Res25407), 
LDot60613 = dot_layer(Con56575,Res25407, 2, 2, Dot60613), 
LUp_78705 = up_sampling1D_layer(Dot60613, 2, Up_78705), 
exec_layers([LMul33115,LRes12567,LDep72320,LRes93742,LCon56575,LSub89923,LRes90896,LZer5680,LRes25407,LDot60613,LUp_78705],["Mul33115","Res12567","Dep72320","Res93742","Con56575","Sub89923","Res90896","Zer5680","Res25407","Dot60613","Up_78705"],Up_78705,"Up_78705")

Actual (Unparsed): [[[0.0000000, -1.1569592, -0.1715116, -0.8698121, 0.0000000], [0.0000000, -1.1569592, -0.1715116, -0.8698121, 0.0000000]]]

Expected (Unparsed): [[[0.0,-1.1569593000000005,-0.1715115599999999,-0.8698121400000002,0.0],[0.0,-1.1569593000000005,-0.1715115599999999,-0.8698121400000002,0.0]]]

Actual:   [[[0, -1.1569, -0.1715, -0.8698, 0], [0, -1.1569, -0.1715, -0.8698, 0]]]

Expected: [[[0, -1.1569, -0.1715, -0.8698, 0], [0, -1.1569, -0.1715, -0.8698, 0]]]