import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo47291 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Dot34076 = tf.keras.layers.Input(shape=([2]))
in1Dot34076 = tf.keras.layers.Input(shape=([2]))

Glo47291 = keras.layers.GlobalAveragePooling2D(name = 'Glo47291', )(in0Glo47291)
Res688 = keras.layers.Reshape((1, 1), name = 'Res688', )(Glo47291)
Res32278 = keras.layers.Reshape((1, 1, 1), name = 'Res32278', )(Res688)
Max10719 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='valid', name = 'Max10719', )(Res32278)
Res62268 = keras.layers.Reshape((1, 1), name = 'Res62268', )(Max10719)
Fla27328 = keras.layers.Flatten(name = 'Fla27328', )(Res62268)
Dot34076 = keras.layers.Dot(axes=(1, 1), name = 'Dot34076', )([in0Dot34076,in1Dot34076])
Dot24508 = keras.layers.Dot(axes=(1, 1), name = 'Dot24508', )([Fla27328,Dot34076])
Den19410 = keras.layers.Dense(4,name = 'Den19410', )(Dot24508)
Res63567 = keras.layers.Reshape((4, 1), name = 'Res63567', )(Den19410)
Res87432 = keras.layers.Reshape((4, 1, 1), name = 'Res87432', )(Res63567)
Res71477 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res71477', )(Res87432)
Glo60867 = keras.layers.GlobalMaxPool3D(name = 'Glo60867', )(Res71477)
model = tf.keras.models.Model(inputs=[in0Glo47291,in0Dot34076,in1Dot34076], outputs=Glo60867)
w = model.get_layer('Den19410').get_weights() 
w[0] = np.array([[0.6734, 0.2392, 0.6373, 0.2156]])
w[1] = np.array([0.4527, 0.0926, 0.6035, 0.2952])
model.get_layer('Den19410').set_weights(w) 
in0Glo47291 = tf.constant([[[[1.0913]]]])
in0Dot34076 = tf.constant([[0.3416, 0.6375]])
in1Dot34076 = tf.constant([[0.5838, 0.3842]])
print (np.array2string(model.predict([in0Glo47291,in0Dot34076,in1Dot34076],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo60867.png')

LGlo47291 = global_average_pooling2D_layer([[[[1.0913]]]], Glo47291), 
LRes688 = reshape_layer(Glo47291, [1, 1], Res688), 
LRes32278 = reshape_layer(Res688, [1, 1, 1], Res32278), 
LMax10719 = max_pool2D_layer(Res32278, 1, 1, 1, 1, false, Max10719), 
LRes62268 = reshape_layer(Max10719, [1, 1], Res62268), 
LFla27328 = flatten_layer(Res62268, Fla27328), 
LDot34076 = dot_layer([[0.3416, 0.6375]], [[0.5838, 0.3842]], 1, 1, Dot34076), 
LDot24508 = dot_layer(Fla27328,Dot34076, 1, 1, Dot24508), 
LDen19410 = dense_layer(Dot24508, [[0.6734, 0.2392, 0.6373, 0.2156]],[0.4527, 0.0926, 0.6035, 0.2952], Den19410), 
LRes63567 = reshape_layer(Den19410, [4, 1], Res63567), 
LRes87432 = reshape_layer(Res63567, [4, 1, 1], Res87432), 
LRes71477 = reshape_layer(Res87432, [4, 1, 1, 1], Res71477), 
LGlo60867 = global_max_pool3D_layer(Res71477, Glo60867), 
exec_layers([LGlo47291,LRes688,LRes32278,LMax10719,LRes62268,LFla27328,LDot34076,LDot24508,LDen19410,LRes63567,LRes87432,LRes71477,LGlo60867],["Glo47291","Res688","Res32278","Max10719","Res62268","Fla27328","Dot34076","Dot24508","Den19410","Res63567","Res87432","Res71477","Glo60867"],Glo60867,"Glo60867")

Actual (Unparsed): [[0.9125415]]

Expected (Unparsed): [[0.9125414673195542]]

Actual:   [[0.9126]]

Expected: [[0.9126]]