import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min51989 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min51989 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Thr99899 = tf.keras.layers.Input(shape=([2, 1]))

Min51989 = keras.layers.Minimum(name = 'Min51989', )([in0Min51989,in1Min51989])
Res32245 = keras.layers.Reshape((1, 1), name = 'Res32245', )(Min51989)
Zer50587 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer50587', )(Res32245)
Thr99899 = keras.layers.ThresholdedReLU(theta=6.234258646272161, name = 'Thr99899', input_shape=(2, 1))(in0Thr99899)
Mul14159 = keras.layers.Multiply(name = 'Mul14159', )([Zer50587,Thr99899])
Con64953 = keras.layers.Conv1D(3, (2),strides=(9), padding='valid', dilation_rate=(1), name = 'Con64953', )(Mul14159)
GRU72299 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU72299', )(Con64953)
Res51082 = keras.layers.Reshape((2, 1), name = 'Res51082', )(GRU72299)
Res9111 = keras.layers.Reshape((2, 1, 1), name = 'Res9111', )(Res51082)
Glo31043 = keras.layers.GlobalMaxPool2D(name = 'Glo31043', )(Res9111)
model = tf.keras.models.Model(inputs=[in0Min51989,in1Min51989,in0Thr99899], outputs=Glo31043)
w = model.get_layer('Con64953').get_weights() 
w[0] = np.array([[[0.4409, 0.8261, 0.111]], [[0.2865, 0.2393, 0.4109]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con64953').set_weights(w) 
w = model.get_layer('GRU72299').get_weights() 
w[0] = np.array([[7, 4, 9, 2, 3, 1], [2, 2, 5, 9, 7, 7], [1, 10, 9, 8, 5, 5]])
w[1] = np.array([[2, 1, 8, 7, 4, 2], [1, 2, 10, 1, 6, 2]])
w[2] = np.array([[6, 9, 1, 6, 1, 5], [3, 9, 3, 6, 8, 1]])
model.get_layer('GRU72299').set_weights(w) 
in0Min51989 = tf.constant([[[[0.537]]]])
in1Min51989 = tf.constant([[[[0.4335]]]])
in0Thr99899 = tf.constant([[[0.8923], [0.192]]])
print (np.array2string(model.predict([in0Min51989,in1Min51989,in0Thr99899],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo31043.png')

LMin51989 = minimum_layer([[[[[0.537]]]], [[[[0.4335]]]]], Min51989), 
LRes32245 = reshape_layer(Min51989, [1, 1], Res32245), 
LZer50587 = zero_padding1D_layer(Res32245, 1, 0, Zer50587), 
LThr99899 = thresholded_relu_layer([[[0.8923], [0.192]]], 6.234258646272161, Thr99899), 
LMul14159 = multiply_layer([Zer50587,Thr99899], Mul14159), 
LCon64953 = conv1D_layer(Mul14159, 2,[[[0.4409, 0.8261, 0.111]], [[0.2865, 0.2393, 0.4109]]],[0, 0, 0], 9, false, 1, Con64953), 
LGRU72299 = gru_layer(Con64953,[[7, 4, 9, 2, 3, 1], [2, 2, 5, 9, 7, 7], [1, 10, 9, 8, 5, 5]],[[2, 1, 8, 7, 4, 2], [1, 2, 10, 1, 6, 2]],[[6, 9, 1, 6, 1, 5], [3, 9, 3, 6, 8, 1]], true, GRU72299), 
LRes51082 = reshape_layer(GRU72299, [2, 1], Res51082), 
LRes9111 = reshape_layer(Res51082, [2, 1, 1], Res9111), 
LGlo31043 = global_max_pool2D_layer(Res9111, Glo31043), 
exec_layers([LMin51989,LRes32245,LZer50587,LThr99899,LMul14159,LCon64953,LGRU72299,LRes51082,LRes9111,LGlo31043],["Min51989","Res32245","Zer50587","Thr99899","Mul14159","Con64953","GRU72299","Res51082","Res9111","Glo31043"],Glo31043,"Glo31043")

Actual (Unparsed): [[0.0001234]]

Expected (Unparsed): [[0.00012339457222771937]]

Actual:   [[0.0002]]

Expected: [[0.0002]]