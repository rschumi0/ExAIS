import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave86101 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave86101 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con764 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0ReL55568 = tf.keras.layers.Input(shape=([1, 2]))
in0Con88929 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Min6754 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min6754 = tf.keras.layers.Input(shape=([1, 2, 2]))

Ave86101 = keras.layers.Average(name = 'Ave86101', )([in0Ave86101,in1Ave86101])
ReL64478 = keras.layers.ReLU(max_value=4.726523047350334, negative_slope=6.647324301437895, threshold=0.010239196873289558, name = 'ReL64478', )(Ave86101)
Con764 = keras.layers.Concatenate(axis=3, name = 'Con764', )([ReL64478,in0Con764])
ReL55568 = keras.layers.ReLU(max_value=5.115522293839937, negative_slope=5.437286014380113, threshold=2.0749469303717607, name = 'ReL55568', input_shape=(1, 2))(in0ReL55568)
Res45473 = keras.layers.Reshape((1, 2, 1), name = 'Res45473', )(ReL55568)
Con88929 = keras.layers.Concatenate(axis=3, name = 'Con88929', )([Res45473,in0Con88929])
Min6754 = keras.layers.Minimum(name = 'Min6754', )([in0Min6754,in1Min6754])
Sub12458 = keras.layers.Subtract(name = 'Sub12458', )([Con88929,Min6754])
Zer9596 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer9596', )(Sub12458)
Min32144 = keras.layers.Minimum(name = 'Min32144', )([Con764,Zer9596])
Res58107 = keras.layers.Reshape((2, 4), name = 'Res58107', )(Min32144)
Sep57221 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='same', name = 'Sep57221', )(Res58107)
model = tf.keras.models.Model(inputs=[in0Ave86101,in1Ave86101,in0Con764,in0ReL55568,in0Con88929,in0Min6754,in1Min6754], outputs=Sep57221)
w = model.get_layer('Sep57221').get_weights() 
w[0] = np.array([[[0.7499], [0.1951], [0.437], [0.7908]]])
w[1] = np.array([[[0.6363, 0.4377, 0.9437], [0.1565, 0.9552, 0.1207], [0.9146, 0.2634, 0.3713], [0.7653, 0.2898, 0.4598]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep57221').set_weights(w) 
in0Ave86101 = tf.constant([[[[0.464], [0.7693]], [[0.6649], [0.7272]]]])
in1Ave86101 = tf.constant([[[[0.038], [0.8072]], [[0.5593], [0.9689]]]])
in0Con764 = tf.constant([[[[0.6209], [0.7707]], [[0.6604], [0.6983]]]])
in0ReL55568 = tf.constant([[[0.0971, 0.917]]])
in0Con88929 = tf.constant([[[[0.9474], [0.0154]]]])
in0Min6754 = tf.constant([[[[0.7691, 0.2722], [0.068, 0.4214]]]])
in1Min6754 = tf.constant([[[[0.9991, 0.3539], [0.9897, 0.2202]]]])
print (np.array2string(model.predict([in0Ave86101,in1Ave86101,in0Con764,in0ReL55568,in0Con88929,in0Min6754,in1Min6754],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep57221.png')

LAve86101 = average_layer([[[[[0.464], [0.7693]], [[0.6649], [0.7272]]]], [[[[0.038], [0.8072]], [[0.5593], [0.9689]]]]], Ave86101), 
LReL64478 = relu_layer(Ave86101, 4.726523047350334, 6.647324301437895, 0.010239196873289558, ReL64478), 
LCon764 = concatenate_layer([ReL64478,[[[[0.6209], [0.7707]], [[0.6604], [0.6983]]]]], 3, Con764), 
LReL55568 = relu_layer([[[0.0971, 0.917]]], 5.115522293839937, 5.437286014380113, 2.0749469303717607, ReL55568), 
LRes45473 = reshape_layer(ReL55568, [1, 2, 1], Res45473), 
LCon88929 = concatenate_layer([Res45473,[[[[0.9474], [0.0154]]]]], 3, Con88929), 
LMin6754 = minimum_layer([[[[[0.7691, 0.2722], [0.068, 0.4214]]]], [[[[0.9991, 0.3539], [0.9897, 0.2202]]]]], Min6754), 
LSub12458 = subtract_layer(Con88929,Min6754, Sub12458), 
LZer9596 = zero_padding2D_layer(Sub12458, 1, 0, 0, 0, Zer9596), 
LMin32144 = minimum_layer([Con764,Zer9596], Min32144), 
LRes58107 = reshape_layer(Min32144, [2, 4], Res58107), 
LSep57221 = separable_conv1D_layer(Res58107, 1,[[[[0.7499], [0.1951], [0.437], [0.7908]]],[[[0.6363, 0.4377, 0.9437], [0.1565, 0.9552, 0.1207], [0.9146, 0.2634, 0.3713], [0.7653, 0.2898, 0.4598]]]],[0, 0, 0], 1, true, Sep57221), 
exec_layers([LAve86101,LReL64478,LCon764,LReL55568,LRes45473,LCon88929,LMin6754,LSub12458,LZer9596,LMin32144,LRes58107,LSep57221],["Ave86101","ReL64478","Con764","ReL55568","Res45473","Con88929","Min6754","Sub12458","Zer9596","Min32144","Res58107","Sep57221"],Sep57221,"Sep57221")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000], [-8.1458161, -4.4386870, -9.2463000]]]

Expected (Unparsed): [[[0.0,0.0,0.0],[-8.14581611755313,-4.438686985391511,-9.246299954363645]]]

Actual:   [[[0, 0, 0], [-8.1458, -4.4386, -9.2463]]]

Expected: [[[0, 0, 0], [-8.1458, -4.4386, -9.2462]]]