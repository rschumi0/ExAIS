import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot940 = tf.keras.layers.Input(shape=([3]))
in1Dot940 = tf.keras.layers.Input(shape=([3]))

Dot940 = keras.layers.Dot(axes=(1, 1), name = 'Dot940', )([in0Dot940,in1Dot940])
Lea67105 = keras.layers.LeakyReLU(alpha=9.962423120801155, name = 'Lea67105', )(Dot940)
Res43405 = keras.layers.Reshape((1, 1), name = 'Res43405', )(Lea67105)
Res29821 = keras.layers.Reshape((1, 1, 1), name = 'Res29821', )(Res43405)
Sep77612 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep77612', )(Res29821)
model = tf.keras.models.Model(inputs=[in0Dot940,in1Dot940], outputs=Sep77612)
w = model.get_layer('Sep77612').get_weights() 
w[0] = np.array([[[[0.2058]]]])
w[1] = np.array([[[[0.6263, 0.7047, 0.7168, 0.566]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep77612').set_weights(w) 
in0Dot940 = tf.constant([[0.8498, 0.799, 0.6881]])
in1Dot940 = tf.constant([[0.7005, 0.9299, 0.4063]])
print (np.array2string(model.predict([in0Dot940,in1Dot940],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep77612.png')

LDot940 = dot_layer([[0.8498, 0.799, 0.6881]], [[0.7005, 0.9299, 0.4063]], 1, 1, Dot940), 
LLea67105 = leaky_relu_layer(Dot940, 9.962423120801155, Lea67105), 
LRes43405 = reshape_layer(Lea67105, [1, 1], Res43405), 
LRes29821 = reshape_layer(Res43405, [1, 1, 1], Res29821), 
LSep77612 = separable_conv2D_layer(Res29821, 1, 1,[[[[[0.2058]]]],[[[[0.6263, 0.7047, 0.7168, 0.566]]]]],[0, 0, 0, 0], 1, 1, false, Sep77612), 
exec_layers([LDot940,LLea67105,LRes43405,LRes29821,LSep77612],["Dot940","Lea67105","Res43405","Res29821","Sep77612"],Sep77612,"Sep77612")

Actual (Unparsed): [[[[0.2085288, 0.2346324, 0.2386611, 0.1884517]]]]

Expected (Unparsed): [[[[0.20852879970577617,0.23463235694181778,0.23866109472952318,0.18845170147448398]]]]

Actual:   [[[[0.2086, 0.2347, 0.2387, 0.1885]]]]

Expected: [[[[0.2086, 0.2347, 0.2387, 0.1885]]]]