import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave14392 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave14392 = tf.keras.layers.Input(shape=([1, 2]))
in0Max80550 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Max48828 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Max48828 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Ave14392 = keras.layers.Average(name = 'Ave14392', )([in0Ave14392,in1Ave14392])
Res62661 = keras.layers.Reshape((1, 2, 1), name = 'Res62661', )(Ave14392)
Res86329 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res86329', )(Res62661)
Zer55184 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer55184', )(Res86329)
Max80550 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max80550', )(in0Max80550)
Res82840 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res82840', )(Max80550)
Zer5693 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer5693', )(Res82840)
Max48828 = keras.layers.Maximum(name = 'Max48828', )([in0Max48828,in1Max48828])
Mul31353 = keras.layers.Multiply(name = 'Mul31353', )([Zer5693,Max48828])
Zer38140 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer38140', )(Mul31353)
Ave51186 = keras.layers.Average(name = 'Ave51186', )([Zer55184,Zer38140])
model = tf.keras.models.Model(inputs=[in0Ave14392,in1Ave14392,in0Max80550,in0Max48828,in1Max48828], outputs=Ave51186)
in0Ave14392 = tf.constant([[[0.0151, 0.0131]]])
in1Ave14392 = tf.constant([[[0.1343, 0.9706]]])
in0Max80550 = tf.constant([[[[1.9532]]]])
in0Max48828 = tf.constant([[[[[0.7835], [0.6057]]], [[[0.1366], [0.1267]]]]])
in1Max48828 = tf.constant([[[[[0.7699], [0.7013]]], [[[0.4417], [0.2827]]]]])
print (np.array2string(model.predict([in0Ave14392,in1Ave14392,in0Max80550,in0Max48828,in1Max48828],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave51186.png')

LAve14392 = average_layer([[[[0.0151, 0.0131]]], [[[0.1343, 0.9706]]]], Ave14392), 
LRes62661 = reshape_layer(Ave14392, [1, 2, 1], Res62661), 
LRes86329 = reshape_layer(Res62661, [1, 2, 1, 1], Res86329), 
LZer55184 = zero_padding3D_layer(Res86329, 1, 0, 1, 0, 1, 0, Zer55184), 
LMax80550 = max_pool2D_layer([[[[1.9532]]]], 1, 1, Max80550), 
LRes82840 = reshape_layer(Max80550, [1, 1, 1, 1], Res82840), 
LZer5693 = zero_padding3D_layer(Res82840, 1, 0, 0, 0, 1, 0, Zer5693), 
LMax48828 = maximum_layer([[[[[[0.7835], [0.6057]]], [[[0.1366], [0.1267]]]]], [[[[[0.7699], [0.7013]]], [[[0.4417], [0.2827]]]]]], Max48828), 
LMul31353 = multiply_layer([Zer5693,Max48828], Mul31353), 
LZer38140 = zero_padding3D_layer(Mul31353, 0, 0, 2, 0, 0, 0, Zer38140), 
LAve51186 = average_layer([Zer55184,Zer38140], Ave51186), 
exec_layers([LAve14392,LRes62661,LRes86329,LZer55184,LMax80550,LRes82840,LZer5693,LMax48828,LMul31353,LZer38140,LAve51186],["Ave14392","Res62661","Res86329","Zer55184","Max80550","Res82840","Zer5693","Max48828","Mul31353","Zer38140","Ave51186"],Ave51186,"Ave51186")

Actual (Unparsed): [[[[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000]], [[0.0000000], [0.0373500]], [[0.0000000], [0.5220098]]]]]

Expected (Unparsed): [[[[[0],[0]],[[0],[0]],[[0.0],[0.0]]],[[[0],[0]],[[0],[0.03735]],[[0.0],[0.5220098200000001]]]]]

Actual:   [[[[[0], [0]], [[0], [0]], [[0], [0]]], [[[0], [0]], [[0], [0.0374]], [[0], [0.5221]]]]]

Expected: [[[[[0], [0]], [[0], [0]], [[0], [0]]], [[[0], [0]], [[0], [0.0374]], [[0], [0.5221]]]]]