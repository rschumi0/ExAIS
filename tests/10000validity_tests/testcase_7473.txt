import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add35954 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Add35954 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Max16213 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max16213 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con23721 = tf.keras.layers.Input(shape=([1, 2]))
in0Sub42378 = tf.keras.layers.Input(shape=([3, 3, 2]))
in1Sub42378 = tf.keras.layers.Input(shape=([3, 3, 2]))
in0Con90177 = tf.keras.layers.Input(shape=([2, 1]))

Add35954 = keras.layers.Add(name = 'Add35954', )([in0Add35954,in1Add35954])
Dep65197 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep65197', )(Add35954)
Res83159 = keras.layers.Reshape((2, 4), name = 'Res83159', )(Dep65197)
Max16213 = keras.layers.Maximum(name = 'Max16213', )([in0Max16213,in1Max16213])
Res77610 = keras.layers.Reshape((1, 4), name = 'Res77610', )(Max16213)
Con23721 = keras.layers.Concatenate(axis=2, name = 'Con23721', )([Res77610,in0Con23721])
Sub42378 = keras.layers.Subtract(name = 'Sub42378', )([in0Sub42378,in1Sub42378])
Res59668 = keras.layers.Reshape((3, 6), name = 'Res59668', )(Sub42378)
Dot39529 = keras.layers.Dot(axes=(2, 2), name = 'Dot39529', )([Con23721,Res59668])
Zer92868 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer92868', )(Dot39529)
Con90177 = keras.layers.Concatenate(axis=2, name = 'Con90177', )([Zer92868,in0Con90177])
Sub11882 = keras.layers.Subtract(name = 'Sub11882', )([Res83159,Con90177])
model = tf.keras.models.Model(inputs=[in0Add35954,in1Add35954,in0Max16213,in1Max16213,in0Con23721,in0Sub42378,in1Sub42378,in0Con90177], outputs=Sub11882)
w = model.get_layer('Dep65197').get_weights() 
w[0] = np.array([[[[0.2018], [0.0483]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep65197').set_weights(w) 
in0Add35954 = tf.constant([[[[0.8409, 0.7002], [0.7328, 0.3843]], [[0.8768, 0.0774], [0.252, 0.6022]]]])
in1Add35954 = tf.constant([[[[0.8935, 0.7538], [0.863, 0.0601]], [[0.0314, 0.8209], [0.6616, 0.404]]]])
in0Max16213 = tf.constant([[[[0.8828, 0.5899], [0.3642, 0.8291]]]])
in1Max16213 = tf.constant([[[[0.6583, 0.1742], [0.6344, 0.5503]]]])
in0Con23721 = tf.constant([[[0.917, 0.9785]]])
in0Sub42378 = tf.constant([[[[0.2727, 0.0396], [0.467, 0.1924], [0.7744, 0.6595]], [[0.6691, 0.9313], [0.4703, 0.8138], [0.9165, 0.7607]], [[0.2942, 0.9969], [0.082, 0.8296], [0.4609, 0.8673]]]])
in1Sub42378 = tf.constant([[[[0.5352, 0.3968], [0.2067, 0.6587], [0.8935, 0.5847]], [[0.4721, 0.0027], [0.2693, 0.778], [0.705, 0.6639]], [[0.4024, 0.2101], [0.5781, 0.2787], [0.1912, 0.0066]]]])
in0Con90177 = tf.constant([[[0.2679], [0.0382]]])
print (np.array2string(model.predict([in0Add35954,in1Add35954,in0Max16213,in1Max16213,in0Con23721,in0Sub42378,in1Sub42378,in0Con90177],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub11882.png')

LAdd35954 = add_layer([[[[[0.8409, 0.7002], [0.7328, 0.3843]], [[0.8768, 0.0774], [0.252, 0.6022]]]], [[[[0.8935, 0.7538], [0.863, 0.0601]], [[0.0314, 0.8209], [0.6616, 0.404]]]]], Add35954), 
LDep65197 = depthwise_conv2D_layer(Add35954, 1, 1,[[[[0.2018], [0.0483]]]],[0, 0], 1, 1, true, Dep65197), 
LRes83159 = reshape_layer(Dep65197, [2, 4], Res83159), 
LMax16213 = maximum_layer([[[[[0.8828, 0.5899], [0.3642, 0.8291]]]], [[[[0.6583, 0.1742], [0.6344, 0.5503]]]]], Max16213), 
LRes77610 = reshape_layer(Max16213, [1, 4], Res77610), 
LCon23721 = concatenate_layer([Res77610,[[[0.917, 0.9785]]]], 2, Con23721), 
LSub42378 = subtract_layer([[[[0.2727, 0.0396], [0.467, 0.1924], [0.7744, 0.6595]], [[0.6691, 0.9313], [0.4703, 0.8138], [0.9165, 0.7607]], [[0.2942, 0.9969], [0.082, 0.8296], [0.4609, 0.8673]]]], [[[[0.5352, 0.3968], [0.2067, 0.6587], [0.8935, 0.5847]], [[0.4721, 0.0027], [0.2693, 0.778], [0.705, 0.6639]], [[0.4024, 0.2101], [0.5781, 0.2787], [0.1912, 0.0066]]]], Sub42378), 
LRes59668 = reshape_layer(Sub42378, [3, 6], Res59668), 
LDot39529 = dot_layer(Con23721,Res59668, 2, 2, Dot39529), 
LZer92868 = zero_padding1D_layer(Dot39529, 1, 0, Zer92868), 
LCon90177 = concatenate_layer([Zer92868,[[[0.2679], [0.0382]]]], 2, Con90177), 
LSub11882 = subtract_layer(Res83159,Con90177, Sub11882), 
exec_layers([LAdd35954,LDep65197,LRes83159,LMax16213,LRes77610,LCon23721,LSub42378,LRes59668,LDot39529,LZer92868,LCon90177,LSub11882],["Add35954","Dep65197","Res83159","Max16213","Res77610","Con23721","Sub42378","Res59668","Dot39529","Zer92868","Con90177","Sub11882"],Sub11882,"Sub11882")

Actual (Unparsed): [[[0.3500019, 0.0702282, 0.3220324, -0.2464355], [0.8832199, -1.1241653, -1.4157851, 0.0103995]]]

Expected (Unparsed): [[[0.35000192,0.07022820000000002,0.32203244000000003,-0.24643548000000004],[0.8832199499999999,-1.12416533,-1.4157850799999998,0.010399460000000006]]]

Actual:   [[[0.3501, 0.0703, 0.3221, -0.2464], [0.8833, -1.1241, -1.4157, 0.0104]]]

Expected: [[[0.3501, 0.0703, 0.3221, -0.2464], [0.8833, -1.1241, -1.4157, 0.0104]]]