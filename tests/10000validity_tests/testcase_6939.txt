import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub40223 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub40223 = tf.keras.layers.Input(shape=([2, 2, 2]))

Sub40223 = keras.layers.Subtract(name = 'Sub40223', )([in0Sub40223,in1Sub40223])
Sof29959 = keras.layers.Softmax(axis=1, name = 'Sof29959', )(Sub40223)
Dep36239 = keras.layers.DepthwiseConv2D((1, 2),strides=(1, 1), padding='same', name = 'Dep36239', )(Sof29959)
model = tf.keras.models.Model(inputs=[in0Sub40223,in1Sub40223], outputs=Dep36239)
w = model.get_layer('Dep36239').get_weights() 
w[0] = np.array([[[[0.9254], [0.1748]], [[0.0042], [0.0593]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep36239').set_weights(w) 
in0Sub40223 = tf.constant([[[[0.5586, 0.657], [0.0304, 0.8381]], [[0.584, 0.5969], [0.8384, 0.481]]]])
in1Sub40223 = tf.constant([[[[0.608, 0.5099], [0.6594, 0.9859]], [[0.2574, 0.5775], [0.1833, 0.9044]]]])
print (np.array2string(model.predict([in0Sub40223,in1Sub40223],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep36239.png')

LSub40223 = subtract_layer([[[[0.5586, 0.657], [0.0304, 0.8381]], [[0.584, 0.5969], [0.8384, 0.481]]]], [[[[0.608, 0.5099], [0.6594, 0.9859]], [[0.2574, 0.5775], [0.1833, 0.9044]]]], Sub40223), 
LSof29959 = softmax_layer(Sub40223, 1, Sof29959), 
LDep36239 = depthwise_conv2D_layer(Sof29959, 1, 2,[[[[0.9254], [0.1748]], [[0.0042], [0.0593]]]],[0, 0], 1, 1, true, Dep36239), 
exec_layers([LSub40223,LSof29959,LDep36239],["Sub40223","Sof29959","Dep36239"],Dep36239,"Dep36239")

Actual (Unparsed): [[[[0.3776337, 0.1266830], [0.2006759, 0.0993681]], [[0.5519663, 0.1074170], [0.7247241, 0.0754319]]]]

Expected (Unparsed): [[[[0.3776337287311314,0.12668302237889226],[0.2006758782855695,0.09936806251652584]],[[0.5519662712688685,0.10741697762110772],[0.7247241217144305,0.07543193748347415]]]]

Actual:   [[[[0.3777, 0.1267], [0.2007, 0.0994]], [[0.552, 0.1075], [0.7248, 0.0755]]]]

Expected: [[[[0.3777, 0.1267], [0.2007, 0.0994]], [[0.552, 0.1075], [0.7248, 0.0755]]]]