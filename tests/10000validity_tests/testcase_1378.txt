import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max64265 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max64265 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con47532 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot93220 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot93220 = tf.keras.layers.Input(shape=([3, 3]))

Max64265 = keras.layers.Maximum(name = 'Max64265', )([in0Max64265,in1Max64265])
Res67155 = keras.layers.Reshape((2, 2), name = 'Res67155', )(Max64265)
Glo90110 = keras.layers.GlobalAveragePooling1D(name = 'Glo90110', )(Res67155)
Res35744 = keras.layers.Reshape((2, 1), name = 'Res35744', )(Glo90110)
Res53059 = keras.layers.Reshape((2, 1, 1), name = 'Res53059', )(Res35744)
Res80718 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res80718', )(Res53059)
Glo32549 = keras.layers.GlobalMaxPool3D(name = 'Glo32549', )(Res80718)
Res1583 = keras.layers.Reshape((1, 1), name = 'Res1583', )(Glo32549)
Zer98200 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer98200', )(Res1583)
Con47532 = keras.layers.Concatenate(axis=2, name = 'Con47532', )([Zer98200,in0Con47532])
Dot93220 = keras.layers.Dot(axes=(2, 2), name = 'Dot93220', )([in0Dot93220,in1Dot93220])
Min32900 = keras.layers.Minimum(name = 'Min32900', )([Con47532,Dot93220])
model = tf.keras.models.Model(inputs=[in0Max64265,in1Max64265,in0Con47532,in0Dot93220,in1Dot93220], outputs=Min32900)
in0Max64265 = tf.constant([[[[0.7687], [0.3186]], [[0.215], [0.0041]]]])
in1Max64265 = tf.constant([[[[0.8033], [0.4833]], [[0.2534], [0.8277]]]])
in0Con47532 = tf.constant([[[0.2939, 0.2464], [0.3149, 0.6329], [0.796, 0.8598]]])
in0Dot93220 = tf.constant([[[0.3084, 0.636, 0.3787], [0.7, 0.4439, 0.7478], [0.7197, 0.9661, 0.9482]]])
in1Dot93220 = tf.constant([[[0.7118, 0.2228, 0.2345], [0.7054, 0.3168, 0.7466], [0.731, 0.9951, 0.059]]])
print (np.array2string(model.predict([in0Max64265,in1Max64265,in0Con47532,in0Dot93220,in1Dot93220],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min32900.png')

LMax64265 = maximum_layer([[[[[0.7687], [0.3186]], [[0.215], [0.0041]]]], [[[[0.8033], [0.4833]], [[0.2534], [0.8277]]]]], Max64265), 
LRes67155 = reshape_layer(Max64265, [2, 2], Res67155), 
LGlo90110 = global_average_pooling1D_layer(Res67155, Glo90110), 
LRes35744 = reshape_layer(Glo90110, [2, 1], Res35744), 
LRes53059 = reshape_layer(Res35744, [2, 1, 1], Res53059), 
LRes80718 = reshape_layer(Res53059, [2, 1, 1, 1], Res80718), 
LGlo32549 = global_max_pool3D_layer(Res80718, Glo32549), 
LRes1583 = reshape_layer(Glo32549, [1, 1], Res1583), 
LZer98200 = zero_padding1D_layer(Res1583, 2, 0, Zer98200), 
LCon47532 = concatenate_layer([Zer98200,[[[0.2939, 0.2464], [0.3149, 0.6329], [0.796, 0.8598]]]], 2, Con47532), 
LDot93220 = dot_layer([[[0.3084, 0.636, 0.3787], [0.7, 0.4439, 0.7478], [0.7197, 0.9661, 0.9482]]], [[[0.7118, 0.2228, 0.2345], [0.7054, 0.3168, 0.7466], [0.731, 0.9951, 0.059]]], 2, 2, Dot93220), 
LMin32900 = minimum_layer([Con47532,Dot93220], Min32900), 
exec_layers([LMax64265,LRes67155,LGlo90110,LRes35744,LRes53059,LRes80718,LGlo32549,LRes1583,LZer98200,LCon47532,LDot93220,LMin32900],["Max64265","Res67155","Glo90110","Res35744","Res53059","Res80718","Glo32549","Res1583","Zer98200","Con47532","Dot93220","Min32900"],Min32900,"Min32900")

Actual (Unparsed): [[[0.0000000, 0.2939000, 0.2464000], [0.0000000, 0.3149000, 0.6329000], [0.6555000, 0.7960000, 0.8598000]]]

Expected (Unparsed): [[[0,0.2939,0.2464],[0,0.3149,0.6329],[0.6555,0.796,0.8598]]]

Actual:   [[[0, 0.2939, 0.2464], [0, 0.3149, 0.6329], [0.6555, 0.796, 0.8598]]]

Expected: [[[0, 0.2939, 0.2464], [0, 0.3149, 0.6329], [0.6555, 0.796, 0.8598]]]