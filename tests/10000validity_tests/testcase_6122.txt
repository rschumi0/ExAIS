import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min55451 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min55451 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Con6176 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Con4329 = tf.keras.layers.Input(shape=([1, 2, 2]))

Min55451 = keras.layers.Minimum(name = 'Min55451', )([in0Min55451,in1Min55451])
Res21134 = keras.layers.Reshape((2, 1, 2), name = 'Res21134', )(Min55451)
Zer91680 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer91680', )(Res21134)
Con6176 = keras.layers.Concatenate(axis=3, name = 'Con6176', )([Zer91680,in0Con6176])
Con4329 = keras.layers.Conv2DTranspose(3, (1, 2),strides=(1, 1), padding='same', name = 'Con4329', )(in0Con4329)
Zer86532 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer86532', )(Con4329)
Ave56761 = keras.layers.Average(name = 'Ave56761', )([Con6176,Zer86532])
Res8768 = keras.layers.Reshape((2, 9), name = 'Res8768', )(Ave56761)
Glo68944 = keras.layers.GlobalAveragePooling1D(name = 'Glo68944', )(Res8768)
Res28522 = keras.layers.Reshape((9, 1), name = 'Res28522', )(Glo68944)
Res59199 = keras.layers.Reshape((9, 1, 1), name = 'Res59199', )(Res28522)
Res4977 = keras.layers.Reshape((9, 1, 1, 1), name = 'Res4977', )(Res59199)
Glo5733 = keras.layers.GlobalMaxPool3D(name = 'Glo5733', )(Res4977)
model = tf.keras.models.Model(inputs=[in0Min55451,in1Min55451,in0Con6176,in0Con4329], outputs=Glo5733)
w = model.get_layer('Con4329').get_weights() 
w[0] = np.array([[[[0.1883, 0.6085], [0.7744, 0.9933], [0.7927, 0.8408]], [[0.5212, 0.4971], [0.91, 0.4976], [0.1108, 0.4202]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con4329').set_weights(w) 
in0Min55451 = tf.constant([[[[[0.7607], [0.5598]]], [[[0.5017], [0.4898]]]]])
in1Min55451 = tf.constant([[[[[0.2061], [0.94]]], [[[0.2466], [0.6101]]]]])
in0Con6176 = tf.constant([[[[0.3441], [0.1509], [0.1847]], [[0.5514], [0.3509], [0.8409]]]])
in0Con4329 = tf.constant([[[[0.9305, 0.8891], [0.0276, 0.2019]]]])
print (np.array2string(model.predict([in0Min55451,in1Min55451,in0Con6176,in0Con4329],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo5733.png')

LMin55451 = minimum_layer([[[[[[0.7607], [0.5598]]], [[[0.5017], [0.4898]]]]], [[[[[0.2061], [0.94]]], [[[0.2466], [0.6101]]]]]], Min55451), 
LRes21134 = reshape_layer(Min55451, [2, 1, 2], Res21134), 
LZer91680 = zero_padding2D_layer(Res21134, 0, 0, 2, 0, Zer91680), 
LCon6176 = concatenate_layer([Zer91680,[[[[0.3441], [0.1509], [0.1847]], [[0.5514], [0.3509], [0.8409]]]]], 3, Con6176), 
LCon4329 = conv2D_transpose_layer([[[[0.9305, 0.8891], [0.0276, 0.2019]]]], 1, 2,[[[[0.1883, 0.6085], [0.7744, 0.9933], [0.7927, 0.8408]], [[0.5212, 0.4971], [0.91, 0.4976], [0.1108, 0.4202]]]],[0, 0, 0], 1, 1, true, Con4329), 
LZer86532 = zero_padding2D_layer(Con4329, 1, 0, 1, 0, Zer86532), 
LAve56761 = average_layer([Con6176,Zer86532], Ave56761), 
LRes8768 = reshape_layer(Ave56761, [2, 9], Res8768), 
LGlo68944 = global_average_pooling1D_layer(Res8768, Glo68944), 
LRes28522 = reshape_layer(Glo68944, [9, 1], Res28522), 
LRes59199 = reshape_layer(Res28522, [9, 1, 1], Res59199), 
LRes4977 = reshape_layer(Res59199, [9, 1, 1, 1], Res4977), 
LGlo5733 = global_max_pool3D_layer(Res4977, Glo5733), 
exec_layers([LMin55451,LRes21134,LZer91680,LCon6176,LCon4329,LZer86532,LAve56761,LRes8768,LGlo68944,LRes28522,LRes59199,LRes4977,LGlo5733],["Min55451","Res21134","Zer91680","Con6176","Con4329","Zer86532","Ave56761","Res8768","Glo68944","Res28522","Res59199","Res4977","Glo5733"],Glo5733,"Glo5733")

Actual (Unparsed): [[0.6401730]]

Expected (Unparsed): [[0.6401729675000001]]

Actual:   [[0.6402]]

Expected: [[0.6402]]