import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave85210 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave85210 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Den72709 = tf.keras.layers.Input(shape=([2, 5]))
in0Mul39171 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul39171 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con59816 = tf.keras.layers.Input(shape=([3, 1]))

Ave85210 = keras.layers.Average(name = 'Ave85210', )([in0Ave85210,in1Ave85210])
Res57360 = keras.layers.Reshape((1, 1, 2), name = 'Res57360', )(Ave85210)
Res15262 = keras.layers.Reshape((1, 2), name = 'Res15262', )(Res57360)
Max21204 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='same', name = 'Max21204', )(Res15262)
Res17022 = keras.layers.Reshape((1, 2, 1), name = 'Res17022', )(Max21204)
Zer78004 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer78004', )(Res17022)
Res73802 = keras.layers.Reshape((3, 4), name = 'Res73802', )(Zer78004)
Den72709 = keras.layers.Dense(3,name = 'Den72709', )(in0Den72709)
Mul39171 = keras.layers.Multiply(name = 'Mul39171', )([in0Mul39171,in1Mul39171])
Res91765 = keras.layers.Reshape((1, 2), name = 'Res91765', )(Mul39171)
Loc99098 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc99098', )(Res91765)
Zer50081 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer50081', )(Loc99098)
Add19440 = keras.layers.Add(name = 'Add19440', )([Den72709,Zer50081])
Zer31780 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer31780', )(Add19440)
Con59816 = keras.layers.Concatenate(axis=2, name = 'Con59816', )([Zer31780,in0Con59816])
Min79158 = keras.layers.Minimum(name = 'Min79158', )([Res73802,Con59816])
Res94939 = keras.layers.Reshape((3, 4, 1), name = 'Res94939', )(Min79158)
Dep44837 = keras.layers.DepthwiseConv2D((2, 4),strides=(2, 2), padding='same', name = 'Dep44837', )(Res94939)
model = tf.keras.models.Model(inputs=[in0Ave85210,in1Ave85210,in0Den72709,in0Mul39171,in1Mul39171,in0Con59816], outputs=Dep44837)
w = model.get_layer('Den72709').get_weights() 
w[0] = np.array([[0.802, 0.9288, 0.7637], [0.9172, 0.923, 0.9686], [0.9754, 0.0008, 0.9231], [0.8029, 0.9672, 0.0334], [0.0786, 0.1585, 0.6261]])
w[1] = np.array([0.3518, 0.8159, 0.0139])
model.get_layer('Den72709').set_weights(w) 
w = model.get_layer('Loc99098').get_weights() 
w[0] = np.array([[[0.0305, 0.9016, 0.7462], [0.3883, 0.3374, 0.874]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc99098').set_weights(w) 
w = model.get_layer('Dep44837').get_weights() 
w[0] = np.array([[[[0.6241]], [[0.6392]], [[0.5565]], [[0.9984]]], [[[0.2853]], [[0.7558]], [[0.7419]], [[0.4281]]]])
w[1] = np.array([0])
model.get_layer('Dep44837').set_weights(w) 
in0Ave85210 = tf.constant([[[[[0.965], [0.2685]]]]])
in1Ave85210 = tf.constant([[[[[0.1674], [0.1724]]]]])
in0Den72709 = tf.constant([[[0.9635, 0.7198, 0.2936, 0.5394, 0.2468], [0.3512, 0.7306, 0.7075, 0.3324, 0.4859]]])
in0Mul39171 = tf.constant([[[[0.3794, 0.0502]]]])
in1Mul39171 = tf.constant([[[[0.6298, 0.2325]]]])
in0Con59816 = tf.constant([[[0.8068], [0.5679], [0.7264]]])
print (np.array2string(model.predict([in0Ave85210,in1Ave85210,in0Den72709,in0Mul39171,in1Mul39171,in0Con59816],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep44837.png')

LAve85210 = average_layer([[[[[[0.965], [0.2685]]]]], [[[[[0.1674], [0.1724]]]]]], Ave85210), 
LRes57360 = reshape_layer(Ave85210, [1, 1, 2], Res57360), 
LRes15262 = reshape_layer(Res57360, [1, 2], Res15262), 
LMax21204 = max_pool1D_layer(Res15262, 1, 1, true, Max21204), 
LRes17022 = reshape_layer(Max21204, [1, 2, 1], Res17022), 
LZer78004 = zero_padding2D_layer(Res17022, 1, 1, 1, 1, Zer78004), 
LRes73802 = reshape_layer(Zer78004, [3, 4], Res73802), 
LDen72709 = dense_layer([[[0.9635, 0.7198, 0.2936, 0.5394, 0.2468], [0.3512, 0.7306, 0.7075, 0.3324, 0.4859]]], [[0.802, 0.9288, 0.7637], [0.9172, 0.923, 0.9686], [0.9754, 0.0008, 0.9231], [0.8029, 0.9672, 0.0334], [0.0786, 0.1585, 0.6261]],[0.3518, 0.8159, 0.0139], Den72709), 
LMul39171 = multiply_layer([[[[[0.3794, 0.0502]]]], [[[[0.6298, 0.2325]]]]], Mul39171), 
LRes91765 = reshape_layer(Mul39171, [1, 2], Res91765), 
LLoc99098 = locally_connected1D_layer(Res91765, 1,[[[0.0305, 0.9016, 0.7462], [0.3883, 0.3374, 0.874]]],[[0, 0, 0]], 1, Loc99098), 
LZer50081 = zero_padding1D_layer(Loc99098, 1, 0, Zer50081), 
LAdd19440 = add_layer([Den72709,Zer50081], Add19440), 
LZer31780 = zero_padding1D_layer(Add19440, 1, 0, Zer31780), 
LCon59816 = concatenate_layer([Zer31780,[[[0.8068], [0.5679], [0.7264]]]], 2, Con59816), 
LMin79158 = minimum_layer([Res73802,Con59816], Min79158), 
LRes94939 = reshape_layer(Min79158, [3, 4, 1], Res94939), 
LDep44837 = depthwise_conv2D_layer(Res94939, 2, 4,[[[[0.6241]], [[0.6392]], [[0.5565]], [[0.9984]]], [[[0.2853]], [[0.7558]], [[0.7419]], [[0.4281]]]],[0], 2, 2, true, Dep44837), 
exec_layers([LAve85210,LRes57360,LRes15262,LMax21204,LRes17022,LZer78004,LRes73802,LDen72709,LMul39171,LRes91765,LLoc99098,LZer50081,LAdd19440,LZer31780,LCon59816,LMin79158,LRes94939,LDep44837],["Ave85210","Res57360","Res15262","Max21204","Res17022","Zer78004","Res73802","Den72709","Mul39171","Res91765","Loc99098","Zer50081","Add19440","Zer31780","Con59816","Min79158","Res94939","Dep44837"],Dep44837,"Dep44837")

Actual (Unparsed): [[[[0.5144384], [0.3281530]], [[0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0.514438425],[0.32815297]],[[0.0],[0.0]]]]

Actual:   [[[[0.5145], [0.3282]], [[0], [0]]]]

Expected: [[[[0.5145], [0.3282]], [[0], [0]]]]