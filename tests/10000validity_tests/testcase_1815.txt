import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub12799 = tf.keras.layers.Input(shape=([3]))
in1Sub12799 = tf.keras.layers.Input(shape=([3]))

Sub12799 = keras.layers.Subtract(name = 'Sub12799', )([in0Sub12799,in1Sub12799])
Res1247 = keras.layers.Reshape((3, 1), name = 'Res1247', )(Sub12799)
Res74833 = keras.layers.Reshape((3, 1, 1), name = 'Res74833', )(Res1247)
Res34066 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res34066', )(Res74833)
Glo53312 = keras.layers.GlobalMaxPool3D(name = 'Glo53312', )(Res34066)
Res49137 = keras.layers.Reshape((1, 1), name = 'Res49137', )(Glo53312)
Res74417 = keras.layers.Reshape((1, 1, 1), name = 'Res74417', )(Res49137)
Con84892 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con84892', )(Res74417)
Res58631 = keras.layers.Reshape((1, 2), name = 'Res58631', )(Con84892)
Sep74013 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep74013', )(Res58631)
model = tf.keras.models.Model(inputs=[in0Sub12799,in1Sub12799], outputs=Sep74013)
w = model.get_layer('Con84892').get_weights() 
w[0] = np.array([[[[0.6266, 0.6233]]]])
w[1] = np.array([0, 0])
model.get_layer('Con84892').set_weights(w) 
w = model.get_layer('Sep74013').get_weights() 
w[0] = np.array([[[0.9315], [0.5992]]])
w[1] = np.array([[[0.6359, 0.9965, 0.0977, 0.2561], [0.971, 0.1294, 0.3515, 0.4262]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep74013').set_weights(w) 
in0Sub12799 = tf.constant([[0.1716, 0.9902, 0.5323]])
in1Sub12799 = tf.constant([[0.5157, 0.4404, 0.7988]])
print (np.array2string(model.predict([in0Sub12799,in1Sub12799],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep74013.png')

LSub12799 = subtract_layer([[0.1716, 0.9902, 0.5323]], [[0.5157, 0.4404, 0.7988]], Sub12799), 
LRes1247 = reshape_layer(Sub12799, [3, 1], Res1247), 
LRes74833 = reshape_layer(Res1247, [3, 1, 1], Res74833), 
LRes34066 = reshape_layer(Res74833, [3, 1, 1, 1], Res34066), 
LGlo53312 = global_max_pool3D_layer(Res34066, Glo53312), 
LRes49137 = reshape_layer(Glo53312, [1, 1], Res49137), 
LRes74417 = reshape_layer(Res49137, [1, 1, 1], Res74417), 
LCon84892 = conv2D_layer(Res74417, 1, 1,[[[[0.6266, 0.6233]]]],[0, 0], 1, 1, true, 1, 1, Con84892), 
LRes58631 = reshape_layer(Con84892, [1, 2], Res58631), 
LSep74013 = separable_conv1D_layer(Res58631, 1,[[[[0.9315], [0.5992]]],[[[0.6359, 0.9965, 0.0977, 0.2561], [0.971, 0.1294, 0.3515, 0.4262]]]],[0, 0, 0, 0], 1, false, Sep74013), 
exec_layers([LSub12799,LRes1247,LRes74833,LRes34066,LGlo53312,LRes49137,LRes74417,LCon84892,LRes58631,LSep74013],["Sub12799","Res1247","Res74833","Res34066","Glo53312","Res49137","Res74417","Con84892","Res58631","Sep74013"],Sep74013,"Sep74013")

Actual (Unparsed): [[[0.4034494, 0.3463539, 0.1035296, 0.1697000]]]

Expected (Unparsed): [[[0.40344938520806595,0.34635394073063325,0.10352955507272596,0.1696999846689356]]]

Actual:   [[[0.4035, 0.3464, 0.1036, 0.1697]]]

Expected: [[[0.4035, 0.3464, 0.1036, 0.1697]]]