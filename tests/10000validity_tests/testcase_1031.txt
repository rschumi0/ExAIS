import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot35890 = tf.keras.layers.Input(shape=([2]))
in1Dot35890 = tf.keras.layers.Input(shape=([2]))
in0Con47147 = tf.keras.layers.Input(shape=([2, 3]))
in0Ave33524 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave33524 = tf.keras.layers.Input(shape=([2, 1]))

Dot35890 = keras.layers.Dot(axes=(1, 1), name = 'Dot35890', )([in0Dot35890,in1Dot35890])
Res6255 = keras.layers.Reshape((1, 1), name = 'Res6255', )(Dot35890)
Zer73540 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer73540', )(Res6255)
Con47147 = keras.layers.Concatenate(axis=2, name = 'Con47147', )([Zer73540,in0Con47147])
Ave33524 = keras.layers.Average(name = 'Ave33524', )([in0Ave33524,in1Ave33524])
Con63786 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con63786', )(Ave33524)
Max66484 = keras.layers.Maximum(name = 'Max66484', )([Con47147,Con63786])
model = tf.keras.models.Model(inputs=[in0Dot35890,in1Dot35890,in0Con47147,in0Ave33524,in1Ave33524], outputs=Max66484)
w = model.get_layer('Con63786').get_weights() 
w[0] = np.array([[[0.2838, 0.4616, 0.869, 0.9644]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con63786').set_weights(w) 
in0Dot35890 = tf.constant([[0.0276, 0.8588]])
in1Dot35890 = tf.constant([[0.3131, 0.4607]])
in0Con47147 = tf.constant([[[0.0673, 0.736, 0.237], [0.012, 0.4414, 0.1529]]])
in0Ave33524 = tf.constant([[[0.8529], [0.87]]])
in1Ave33524 = tf.constant([[[0.8574], [0.1549]]])
print (np.array2string(model.predict([in0Dot35890,in1Dot35890,in0Con47147,in0Ave33524,in1Ave33524],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max66484.png')

LDot35890 = dot_layer([[0.0276, 0.8588]], [[0.3131, 0.4607]], 1, 1, Dot35890), 
LRes6255 = reshape_layer(Dot35890, [1, 1], Res6255), 
LZer73540 = zero_padding1D_layer(Res6255, 1, 0, Zer73540), 
LCon47147 = concatenate_layer([Zer73540,[[[0.0673, 0.736, 0.237], [0.012, 0.4414, 0.1529]]]], 2, Con47147), 
LAve33524 = average_layer([[[[0.8529], [0.87]]], [[[0.8574], [0.1549]]]], Ave33524), 
LCon63786 = conv1D_layer(Ave33524, 1,[[[0.2838, 0.4616, 0.869, 0.9644]]],[0, 0, 0, 0], 1, true, 1, Con63786), 
LMax66484 = maximum_layer([Con47147,Con63786], Max66484), 
exec_layers([LDot35890,LRes6255,LZer73540,LCon47147,LAve33524,LCon63786,LMax66484],["Dot35890","Res6255","Zer73540","Con47147","Ave33524","Con63786","Max66484"],Max66484,"Max66484")

Actual (Unparsed): [[[0.2426916, 0.3947372, 0.7431254, 0.8247067], [0.4042907, 0.2365469, 0.4453191, 0.4942068]]]

Expected (Unparsed): [[[0.24269157000000002,0.39473724000000004,0.74312535,0.8247066600000001],[0.40429072,0.23654692,0.44531904999999994,0.49420677999999996]]]

Actual:   [[[0.2427, 0.3948, 0.7432, 0.8248], [0.4043, 0.2366, 0.4454, 0.4943]]]

Expected: [[[0.2427, 0.3948, 0.7432, 0.8248], [0.4043, 0.2366, 0.4454, 0.4943]]]