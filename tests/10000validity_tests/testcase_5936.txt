import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe4899 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con2896 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Ave99227 = tf.keras.layers.Input(shape=([1, 1, 2]))

PRe4899 = keras.layers.PReLU(name = 'PRe4899', input_shape=(1, 2, 1))(in0PRe4899)
Con2896 = keras.layers.Concatenate(axis=3, name = 'Con2896', )([PRe4899,in0Con2896])
Ave99227 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='valid', name = 'Ave99227', )(in0Ave99227)
Zer79427 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer79427', )(Ave99227)
Max86435 = keras.layers.Maximum(name = 'Max86435', )([Con2896,Zer79427])
Lay83199 = keras.layers.LayerNormalization(axis=2, epsilon=2.910231557978621, name = 'Lay83199', )(Max86435)
model = tf.keras.models.Model(inputs=[in0PRe4899,in0Con2896,in0Ave99227], outputs=Lay83199)
w = model.get_layer('PRe4899').get_weights() 
w[0] = np.array([[[0.1559], [0.8136]]])
model.get_layer('PRe4899').set_weights(w) 
in0PRe4899 = tf.constant([[[[0.211], [0.258]]]])
in0Con2896 = tf.constant([[[[0.5719], [0.0278]]]])
in0Ave99227 = tf.constant([[[[1.0794, 1.3064]]]])
print (np.array2string(model.predict([in0PRe4899,in0Con2896,in0Ave99227],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay83199.png')

LPRe4899 = prelu_layer([[[[0.211], [0.258]]]], [[[0.1559], [0.8136]]], PRe4899), 
LCon2896 = concatenate_layer([PRe4899,[[[[0.5719], [0.0278]]]]], 3, Con2896), 
LAve99227 = average_pooling2D_layer([[[[1.0794, 1.3064]]]], 1, 1, 1, 1, false, Ave99227), 
LZer79427 = zero_padding2D_layer(Ave99227, 0, 0, 1, 0, Zer79427), 
LMax86435 = maximum_layer([Con2896,Zer79427], Max86435), 
LLay83199 = layer_normalization_layer(Max86435, 2, 2.910231557978621, Lay83199), 
exec_layers([LPRe4899,LCon2896,LAve99227,LZer79427,LMax86435,LLay83199],["PRe4899","Con2896","Ave99227","Zer79427","Max86435","Lay83199"],Lay83199,"Lay83199")

Actual (Unparsed): [[[[-0.2466583, -0.2104557], [0.2466583, 0.2104557]]]]

Expected (Unparsed): [[[[-0.24665831735826846,-0.2104557185492703],[0.2466583173582684,0.21045571854927037]]]]

Actual:   [[[[-0.2466, -0.2104], [0.2467, 0.2105]]]]

Expected: [[[[-0.2466, -0.2104], [0.2467, 0.2105]]]]