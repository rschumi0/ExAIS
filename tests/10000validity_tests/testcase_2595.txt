import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min19702 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Min19702 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Min19702 = keras.layers.Minimum(name = 'Min19702', )([in0Min19702,in1Min19702])
Res21878 = keras.layers.Reshape((2, 2, 2), name = 'Res21878', )(Min19702)
Loc48604 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc48604', )(Res21878)
model = tf.keras.models.Model(inputs=[in0Min19702,in1Min19702], outputs=Loc48604)
w = model.get_layer('Loc48604').get_weights() 
w[0] = np.array([[[0.3131, 0.1637, 0.5896], [0.1919, 0.5608, 0.0413]], [[0.3539, 0.4855, 0.4929], [0.5327, 0.754, 0.9003]], [[0.0007, 0.8481, 0.8212], [0.4114, 0.5464, 0.595]], [[0.5145, 0.0217, 0.3336], [0.8093, 0.9934, 0.7223]]])
w[1] = np.array([[[0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0]]])
model.get_layer('Loc48604').set_weights(w) 
in0Min19702 = tf.constant([[[[[0.7839, 0.1368]], [[0.1749, 0.8743]]], [[[0.613, 0.1741]], [[0.8529, 0.0885]]]]])
in1Min19702 = tf.constant([[[[[0.9556, 0.4418]], [[0.8782, 0.4026]]], [[[0.51, 0.3261]], [[0.6718, 0.3123]]]]])
print (np.array2string(model.predict([in0Min19702,in1Min19702],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc48604.png')

LMin19702 = minimum_layer([[[[[[0.7839, 0.1368]], [[0.1749, 0.8743]]], [[[0.613, 0.1741]], [[0.8529, 0.0885]]]]], [[[[[0.9556, 0.4418]], [[0.8782, 0.4026]]], [[[0.51, 0.3261]], [[0.6718, 0.3123]]]]]], Min19702), 
LRes21878 = reshape_layer(Min19702, [2, 2, 2], Res21878), 
LLoc48604 = locally_connected2D_layer(Res21878, 1, 1,[[[0.3131, 0.1637, 0.5896], [0.1919, 0.5608, 0.0413]], [[0.3539, 0.4855, 0.4929], [0.5327, 0.754, 0.9003]], [[0.0007, 0.8481, 0.8212], [0.4114, 0.5464, 0.595]], [[0.5145, 0.0217, 0.3336], [0.8093, 0.9934, 0.7223]]],[[[0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0]]], 1, 1, Loc48604), 
exec_layers([LMin19702,LRes21878,LLoc48604],["Min19702","Res21878","Loc48604"],Loc48604,"Loc48604")

Actual (Unparsed): [[[[0.2716910, 0.2050419, 0.4678373], [0.2763621, 0.3884743, 0.4486690]], [[0.0719817, 0.5276592, 0.5224015], [0.4172642, 0.1024940, 0.2880360]]]]

Expected (Unparsed): [[[[0.27169101,0.20504187000000001,0.4678372800000001],[0.27636213,0.38847435,0.44866899]],[[0.07198174,0.52765924,0.5224015],[0.41726414999999994,0.10249396,0.28803603]]]]

Actual:   [[[[0.2717, 0.2051, 0.4679], [0.2764, 0.3885, 0.4487]], [[0.072, 0.5277, 0.5225], [0.4173, 0.1025, 0.2881]]]]

Expected: [[[[0.2717, 0.2051, 0.4679], [0.2764, 0.3885, 0.4487]], [[0.072, 0.5277, 0.5225], [0.4173, 0.1025, 0.2881]]]]