import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe59027 = tf.keras.layers.Input(shape=([1, 2]))
in0Zer76674 = tf.keras.layers.Input(shape=([2, 1, 3, 1]))
in0Ave20472 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Ave20472 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

PRe59027 = keras.layers.PReLU(name = 'PRe59027', input_shape=(1, 2))(in0PRe59027)
Res62849 = keras.layers.Reshape((1, 2, 1), name = 'Res62849', )(PRe59027)
Res996 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res996', )(Res62849)
Zer90053 = keras.layers.ZeroPadding3D(padding=((3, 0), (1, 0), (4, 0)), name = 'Zer90053', )(Res996)
Zer76674 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer76674', )(in0Zer76674)
Ave20472 = keras.layers.Average(name = 'Ave20472', )([in0Ave20472,in1Ave20472])
Zer64616 = keras.layers.ZeroPadding3D(padding=((2, 0), (2, 0), (3, 0)), name = 'Zer64616', )(Ave20472)
Mul92801 = keras.layers.Multiply(name = 'Mul92801', )([Zer76674,Zer64616])
Mul91827 = keras.layers.Multiply(name = 'Mul91827', )([Zer90053,Mul92801])
Glo44114 = keras.layers.GlobalMaxPool3D(name = 'Glo44114', )(Mul91827)
model = tf.keras.models.Model(inputs=[in0PRe59027,in0Zer76674,in0Ave20472,in1Ave20472], outputs=Glo44114)
w = model.get_layer('PRe59027').get_weights() 
w[0] = np.array([[0.2196, 0.4894]])
model.get_layer('PRe59027').set_weights(w) 
in0PRe59027 = tf.constant([[[0.6394, 0.8764]]])
in0Zer76674 = tf.constant([[[[[1.4184], [1.8284], [1.9931]]], [[[1.9499], [1.9114], [1.2662]]]]])
in0Ave20472 = tf.constant([[[[[0.6216], [0.7031]]], [[[0.603], [0.6234]]]]])
in1Ave20472 = tf.constant([[[[[0.4626], [0.4558]]], [[[0.0474], [0.5692]]]]])
print (np.array2string(model.predict([in0PRe59027,in0Zer76674,in0Ave20472,in1Ave20472],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo44114.png')

LPRe59027 = prelu_layer([[[0.6394, 0.8764]]], [[0.2196, 0.4894]], PRe59027), 
LRes62849 = reshape_layer(PRe59027, [1, 2, 1], Res62849), 
LRes996 = reshape_layer(Res62849, [1, 2, 1, 1], Res996), 
LZer90053 = zero_padding3D_layer(Res996, 3, 0, 1, 0, 4, 0, Zer90053), 
LZer76674 = zero_padding3D_layer([[[[[1.4184], [1.8284], [1.9931]]], [[[1.9499], [1.9114], [1.2662]]]]], 1, 1, 1, 1, 1, 1, Zer76674), 
LAve20472 = average_layer([[[[[[0.6216], [0.7031]]], [[[0.603], [0.6234]]]]], [[[[[0.4626], [0.4558]]], [[[0.0474], [0.5692]]]]]], Ave20472), 
LZer64616 = zero_padding3D_layer(Ave20472, 2, 0, 2, 0, 3, 0, Zer64616), 
LMul92801 = multiply_layer([Zer76674,Zer64616], Mul92801), 
LMul91827 = multiply_layer([Zer90053,Mul92801], Mul91827), 
LGlo44114 = global_max_pool3D_layer(Mul91827, Glo44114), 
exec_layers([LPRe59027,LRes62849,LRes996,LZer90053,LZer76674,LAve20472,LZer64616,LMul92801,LMul91827,LGlo44114],["PRe59027","Res62849","Res996","Zer90053","Zer76674","Ave20472","Zer64616","Mul92801","Mul91827","Glo44114"],Glo44114,"Glo44114")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0.0]]

Actual:   [[0]]

Expected: [[0]]