import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave28808 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Ave28808 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Ave28808 = keras.layers.Average(name = 'Ave28808', )([in0Ave28808,in1Ave28808])
Res94121 = keras.layers.Reshape((1, 1, 1), name = 'Res94121', )(Ave28808)
Res33464 = keras.layers.Reshape((1, 1), name = 'Res33464', )(Res94121)
Per64877 = keras.layers.Permute((1,2), name = 'Per64877',)(Res33464)
Res70206 = keras.layers.Reshape((1, 1, 1), name = 'Res70206', )(Per64877)
Ave14732 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Ave14732', )(Res70206)
model = tf.keras.models.Model(inputs=[in0Ave28808,in1Ave28808], outputs=Ave14732)
in0Ave28808 = tf.constant([[[[[0.8884]]]]])
in1Ave28808 = tf.constant([[[[[0.4876]]]]])
print (np.array2string(model.predict([in0Ave28808,in1Ave28808],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave14732.png')

LAve28808 = average_layer([[[[[[0.8884]]]]], [[[[[0.4876]]]]]], Ave28808), 
LRes94121 = reshape_layer(Ave28808, [1, 1, 1], Res94121), 
LRes33464 = reshape_layer(Res94121, [1, 1], Res33464), 
LPer64877 = permute_layer(Res33464, 1,2, Per64877), 
LRes70206 = reshape_layer(Per64877, [1, 1, 1], Res70206), 
LAve14732 = average_pooling2D_layer(Res70206, 1, 1, 1, 1, true, Ave14732), 
exec_layers([LAve28808,LRes94121,LRes33464,LPer64877,LRes70206,LAve14732],["Ave28808","Res94121","Res33464","Per64877","Res70206","Ave14732"],Ave14732,"Ave14732")

Actual (Unparsed): [[[[0.6880000]]]]

Expected (Unparsed): [[[[0.688]]]]

Actual:   [[[[0.688]]]]

Expected: [[[[0.688]]]]