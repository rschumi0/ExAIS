import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max31635 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Max31635 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con66903 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0ReL15832 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con40280 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Cro33726 = tf.keras.layers.Input(shape=([1, 3, 4]))
in0Con13080 = tf.keras.layers.Input(shape=([1, 2, 4, 1]))
in0Add58500 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Add58500 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Max31635 = keras.layers.Maximum(name = 'Max31635', )([in0Max31635,in1Max31635])
Res66527 = keras.layers.Reshape((1, 1, 2), name = 'Res66527', )(Max31635)
Zer37461 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer37461', )(Res66527)
Con66903 = keras.layers.Concatenate(axis=3, name = 'Con66903', )([Zer37461,in0Con66903])
ReL15832 = keras.layers.ReLU(max_value=6.363431129302465, negative_slope=2.300521082086429, threshold=0.028902523779563705, name = 'ReL15832', input_shape=(1, 2, 2))(in0ReL15832)
Con40280 = keras.layers.Concatenate(axis=3, name = 'Con40280', )([ReL15832,in0Con40280])
Cro33726 = keras.layers.Cropping2D(cropping=((0, 0), (1, 0)), name = 'Cro33726', )(in0Cro33726)
Sub80237 = keras.layers.Subtract(name = 'Sub80237', )([Con40280,Cro33726])
Add77568 = keras.layers.Add(name = 'Add77568', )([Con66903,Sub80237])
Res69865 = keras.layers.Reshape((1, 2, 4, 1), name = 'Res69865', )(Add77568)
Con13080 = keras.layers.Concatenate(axis=4, name = 'Con13080', )([Res69865,in0Con13080])
Add58500 = keras.layers.Add(name = 'Add58500', )([in0Add58500,in1Add58500])
Con21534 = keras.layers.Conv3DTranspose(2, (1, 1, 2),strides=(1, 1, 1), padding='same', name = 'Con21534', )(Add58500)
Zer75951 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (2, 0)), name = 'Zer75951', )(Con21534)
Add118 = keras.layers.Add(name = 'Add118', )([Con13080,Zer75951])
model = tf.keras.models.Model(inputs=[in0Max31635,in1Max31635,in0Con66903,in0ReL15832,in0Con40280,in0Cro33726,in0Con13080,in0Add58500,in1Add58500], outputs=Add118)
w = model.get_layer('Con21534').get_weights() 
w[0] = np.array([[[[[0.8533], [0.5788]], [[0.5662], [0.2525]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con21534').set_weights(w) 
in0Max31635 = tf.constant([[[[[0.0223, 0.4436]]]]])
in1Max31635 = tf.constant([[[[[0.3916, 0.6238]]]]])
in0Con66903 = tf.constant([[[[0.6442, 0.2662], [0.7494, 0.9924]]]])
in0ReL15832 = tf.constant([[[[0.019, 0.1871], [0.3614, 0.8625]]]])
in0Con40280 = tf.constant([[[[0.7495, 0.0008], [0.6025, 0.0997]]]])
in0Cro33726 = tf.constant([[[[1.8916, 1.2048, 1.0901, 1.4636], [1.7133, 1.966, 1.4261, 1.8438], [1.2547, 1.0356, 1.9548, 1.4247]]]])
in0Con13080 = tf.constant([[[[[0.0309], [0.0051], [0.9148], [0.5387]], [[0.2034], [0.6921], [0.0378], [0.3021]]]]])
in0Add58500 = tf.constant([[[[[0.9992], [0.1071]]]]])
in1Add58500 = tf.constant([[[[[0.8283], [0.3284]]]]])
print (np.array2string(model.predict([in0Max31635,in1Max31635,in0Con66903,in0ReL15832,in0Con40280,in0Cro33726,in0Con13080,in0Add58500,in1Add58500],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add118.png')

LMax31635 = maximum_layer([[[[[[0.0223, 0.4436]]]]], [[[[[0.3916, 0.6238]]]]]], Max31635), 
LRes66527 = reshape_layer(Max31635, [1, 1, 2], Res66527), 
LZer37461 = zero_padding2D_layer(Res66527, 0, 0, 1, 0, Zer37461), 
LCon66903 = concatenate_layer([Zer37461,[[[[0.6442, 0.2662], [0.7494, 0.9924]]]]], 3, Con66903), 
LReL15832 = relu_layer([[[[0.019, 0.1871], [0.3614, 0.8625]]]], 6.363431129302465, 2.300521082086429, 0.028902523779563705, ReL15832), 
LCon40280 = concatenate_layer([ReL15832,[[[[0.7495, 0.0008], [0.6025, 0.0997]]]]], 3, Con40280), 
LCro33726 = cropping2D_layer([[[[1.8916, 1.2048, 1.0901, 1.4636], [1.7133, 1.966, 1.4261, 1.8438], [1.2547, 1.0356, 1.9548, 1.4247]]]], 0, 0, 1, 0, Cro33726), 
LSub80237 = subtract_layer(Con40280,Cro33726, Sub80237), 
LAdd77568 = add_layer([Con66903,Sub80237], Add77568), 
LRes69865 = reshape_layer(Add77568, [1, 2, 4, 1], Res69865), 
LCon13080 = concatenate_layer([Res69865,[[[[[0.0309], [0.0051], [0.9148], [0.5387]], [[0.2034], [0.6921], [0.0378], [0.3021]]]]]], 4, Con13080), 
LAdd58500 = add_layer([[[[[[0.9992], [0.1071]]]]], [[[[[0.8283], [0.3284]]]]]], Add58500), 
LCon21534 = conv3D_transpose_layer(Add58500, 1, 1, 2,[[[[[0.8533], [0.5788]], [[0.5662], [0.2525]]]]],[0, 0], 1, 1, 1, true, Con21534), 
LZer75951 = zero_padding3D_layer(Con21534, 0, 0, 1, 0, 2, 0, Zer75951), 
LAdd118 = add_layer([Con13080,Zer75951], Add118), 
exec_layers([LMax31635,LRes66527,LZer37461,LCon66903,LReL15832,LCon40280,LCro33726,LSub80237,LAdd77568,LRes69865,LCon13080,LAdd58500,LCon21534,LZer75951,LAdd118],["Max31635","Res66527","Zer37461","Con66903","ReL15832","Con40280","Cro33726","Sub80237","Add77568","Res69865","Con13080","Add58500","Con21534","Zer75951","Add118"],Add118,"Add118")

Actual (Unparsed): [[[[[-1.7360810, 0.0309000], [-1.7789000, 0.0051000], [-0.0324000, 0.9148000], [-1.5767999, 0.5387000]], [[-0.5016999, 0.2034000], [0.4507000, 0.6921000], [0.9565058, 1.0955570], [1.0737426, 1.0156111]]]]]

Expected (Unparsed): [[[[[-1.7360809647207485,0.0309],[-1.7789,0.0051],[-0.03239999999999987,0.9148],[-1.5768000000000002,0.5387]],[[-0.5017,0.2034],[0.4507,0.6921],[0.9565057499999999,1.0955570000000001],[1.07374265,1.01561115]]]]]

Actual:   [[[[[-1.736, 0.0309], [-1.7789, 0.0051], [-0.0324, 0.9148], [-1.5767, 0.5387]], [[-0.5016, 0.2034], [0.4507, 0.6921], [0.9566, 1.0956], [1.0738, 1.0157]]]]]

Expected: [[[[[-1.736, 0.0309], [-1.7789, 0.0051], [-0.0323, 0.9148], [-1.5768, 0.5387]], [[-0.5017, 0.2034], [0.4507, 0.6921], [0.9566, 1.0956], [1.0738, 1.0157]]]]]