import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min86776 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min86776 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Min86776 = keras.layers.Minimum(name = 'Min86776', )([in0Min86776,in1Min86776])
Res4193 = keras.layers.Reshape((2, 1, 2), name = 'Res4193', )(Min86776)
Res44250 = keras.layers.Reshape((2, 2), name = 'Res44250', )(Res4193)
Glo59288 = keras.layers.GlobalMaxPool1D(name = 'Glo59288', )(Res44250)
Res30085 = keras.layers.Reshape((2, 1), name = 'Res30085', )(Glo59288)
Glo95482 = keras.layers.GlobalMaxPool1D(name = 'Glo95482', )(Res30085)
Mas50868 = keras.layers.Masking(mask_value=1, name = 'Mas50868', )(Glo95482)
model = tf.keras.models.Model(inputs=[in0Min86776,in1Min86776], outputs=Mas50868)
in0Min86776 = tf.constant([[[[[0.8641], [0.0162]]], [[[0.5913], [0.3991]]]]])
in1Min86776 = tf.constant([[[[[0.4726], [0.7466]]], [[[0.289], [0.4316]]]]])
print (np.array2string(model.predict([in0Min86776,in1Min86776],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas50868.png')

LMin86776 = minimum_layer([[[[[[0.8641], [0.0162]]], [[[0.5913], [0.3991]]]]], [[[[[0.4726], [0.7466]]], [[[0.289], [0.4316]]]]]], Min86776), 
LRes4193 = reshape_layer(Min86776, [2, 1, 2], Res4193), 
LRes44250 = reshape_layer(Res4193, [2, 2], Res44250), 
LGlo59288 = global_max_pool1D_layer(Res44250, Glo59288), 
LRes30085 = reshape_layer(Glo59288, [2, 1], Res30085), 
LGlo95482 = global_max_pool1D_layer(Res30085, Glo95482), 
LMas50868 = masking_layer(Glo95482, 1, Mas50868), 
exec_layers([LMin86776,LRes4193,LRes44250,LGlo59288,LRes30085,LGlo95482,LMas50868],["Min86776","Res4193","Res44250","Glo59288","Res30085","Glo95482","Mas50868"],Mas50868,"Mas50868")

Actual (Unparsed): [[0.4726000]]

Expected (Unparsed): [[0.4726]]

Actual:   [[0.4726]]

Expected: [[0.4726]]