import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add78857 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Add78857 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Add140 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add140 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Loc71236 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con80924 = tf.keras.layers.Input(shape=([3]))

Add78857 = keras.layers.Add(name = 'Add78857', )([in0Add78857,in1Add78857])
Res16992 = keras.layers.Reshape((2, 1, 2), name = 'Res16992', )(Add78857)
Res82545 = keras.layers.Reshape((2, 2), name = 'Res82545', )(Res16992)
Fla64320 = keras.layers.Flatten(name = 'Fla64320', )(Res82545)
Add140 = keras.layers.Add(name = 'Add140', )([in0Add140,in1Add140])
Loc71236 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 1), name = 'Loc71236', )(in0Loc71236)
Max4398 = keras.layers.Maximum(name = 'Max4398', )([Add140,Loc71236])
Res72382 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res72382', )(Max4398)
Glo63968 = keras.layers.GlobalAveragePooling3D(name = 'Glo63968', )(Res72382)
Con80924 = keras.layers.Concatenate(axis=1, name = 'Con80924', )([Glo63968,in0Con80924])
Max29477 = keras.layers.Maximum(name = 'Max29477', )([Fla64320,Con80924])
model = tf.keras.models.Model(inputs=[in0Add78857,in1Add78857,in0Add140,in1Add140,in0Loc71236,in0Con80924], outputs=Max29477)
w = model.get_layer('Loc71236').get_weights() 
w[0] = np.array([[[0.4219, 0.6057], [0.6987, 0.9712]], [[0.6685, 0.8878], [0.5387, 0.3881]]])
w[1] = np.array([[[0, 0]], [[0, 0]]])
model.get_layer('Loc71236').set_weights(w) 
in0Add78857 = tf.constant([[[[[0.7551], [0.7375]]], [[[0.5696], [0.5823]]]]])
in1Add78857 = tf.constant([[[[[0.4668], [0.8196]]], [[[0.5763], [0.5026]]]]])
in0Add140 = tf.constant([[[[0.8583, 0.3968]], [[0.4606, 0.2317]]]])
in1Add140 = tf.constant([[[[0.1202, 0.9079]], [[0.0868, 0.3034]]]])
in0Loc71236 = tf.constant([[[[0.0318, 0.3137]], [[0.6369, 0.0942]]]])
in0Con80924 = tf.constant([[0.4049, 0.4864, 0.2826]])
print (np.array2string(model.predict([in0Add78857,in1Add78857,in0Add140,in1Add140,in0Loc71236,in0Con80924],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max29477.png')

LAdd78857 = add_layer([[[[[[0.7551], [0.7375]]], [[[0.5696], [0.5823]]]]], [[[[[0.4668], [0.8196]]], [[[0.5763], [0.5026]]]]]], Add78857), 
LRes16992 = reshape_layer(Add78857, [2, 1, 2], Res16992), 
LRes82545 = reshape_layer(Res16992, [2, 2], Res82545), 
LFla64320 = flatten_layer(Res82545, Fla64320), 
LAdd140 = add_layer([[[[[0.8583, 0.3968]], [[0.4606, 0.2317]]]], [[[[0.1202, 0.9079]], [[0.0868, 0.3034]]]]], Add140), 
LLoc71236 = locally_connected2D_layer([[[[0.0318, 0.3137]], [[0.6369, 0.0942]]]], 1, 1,[[[0.4219, 0.6057], [0.6987, 0.9712]], [[0.6685, 0.8878], [0.5387, 0.3881]]],[[[0, 0]], [[0, 0]]], 1, 1, Loc71236), 
LMax4398 = maximum_layer([Add140,Loc71236], Max4398), 
LRes72382 = reshape_layer(Max4398, [2, 1, 2, 1], Res72382), 
LGlo63968 = global_average_pooling3D_layer(Res72382, Glo63968), 
LCon80924 = concatenate_layer([Glo63968,[[0.4049, 0.4864, 0.2826]]], 1, Con80924), 
LMax29477 = maximum_layer([Fla64320,Con80924], Max29477), 
exec_layers([LAdd78857,LRes16992,LRes82545,LFla64320,LAdd140,LLoc71236,LMax4398,LRes72382,LGlo63968,LCon80924,LMax29477],["Add78857","Res16992","Res82545","Fla64320","Add140","Loc71236","Max4398","Res72382","Glo63968","Con80924","Max29477"],Max29477,"Max29477")

Actual (Unparsed): [[1.2219000, 1.5571000, 1.1459000, 1.0849000]]

Expected (Unparsed): [[1.2219,1.5571000000000002,1.1459000000000001,1.0849000000000002]]

Actual:   [[1.2219, 1.5571, 1.1459, 1.0849]]

Expected: [[1.2219, 1.5572, 1.146, 1.085]]