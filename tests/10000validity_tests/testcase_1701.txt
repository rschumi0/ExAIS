import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU62463 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot30270 = tf.keras.layers.Input(shape=([3]))
in1Dot30270 = tf.keras.layers.Input(shape=([3]))

GRU62463 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU62463', )(in0GRU62463)
Dot30270 = keras.layers.Dot(axes=(1, 1), name = 'Dot30270', )([in0Dot30270,in1Dot30270])
Add29412 = keras.layers.Add(name = 'Add29412', )([GRU62463,Dot30270])
Res59922 = keras.layers.Reshape((1, 1), name = 'Res59922', )(Add29412)
PRe58412 = keras.layers.PReLU(name = 'PRe58412', )(Res59922)
Res22737 = keras.layers.Reshape((1, 1, 1), name = 'Res22737', )(PRe58412)
Loc24512 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 1), name = 'Loc24512', )(Res22737)
model = tf.keras.models.Model(inputs=[in0GRU62463,in0Dot30270,in1Dot30270], outputs=Loc24512)
w = model.get_layer('GRU62463').get_weights() 
w[0] = np.array([[5, 8, 10]])
w[1] = np.array([[1, 4, 7]])
w[2] = np.array([7, 9, 3])
model.get_layer('GRU62463').set_weights(w) 
w = model.get_layer('PRe58412').get_weights() 
w[0] = np.array([[0.8229]])
model.get_layer('PRe58412').set_weights(w) 
w = model.get_layer('Loc24512').get_weights() 
w[0] = np.array([[[0.1051, 0.9308]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc24512').set_weights(w) 
in0GRU62463 = tf.constant([[[7], [4]]])
in0Dot30270 = tf.constant([[0.992, 0.5454, 0.9111]])
in1Dot30270 = tf.constant([[0.915, 0.6692, 0.9802]])
print (np.array2string(model.predict([in0GRU62463,in0Dot30270,in1Dot30270],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc24512.png')

LGRU62463 = gru_layer([[[7], [4]]],[[5, 8, 10]],[[1, 4, 7]],[7, 9, 3], false, GRU62463), 
LDot30270 = dot_layer([[0.992, 0.5454, 0.9111]], [[0.915, 0.6692, 0.9802]], 1, 1, Dot30270), 
LAdd29412 = add_layer([GRU62463,Dot30270], Add29412), 
LRes59922 = reshape_layer(Add29412, [1, 1], Res59922), 
LPRe58412 = prelu_layer(Res59922, [[0.8229]], PRe58412), 
LRes22737 = reshape_layer(PRe58412, [1, 1, 1], Res22737), 
LLoc24512 = locally_connected2D_layer(Res22737, 1, 1,[[[0.1051, 0.9308]]],[[[0, 0]]], 1, 1, Loc24512), 
exec_layers([LGRU62463,LDot30270,LAdd29412,LRes59922,LPRe58412,LRes22737,LLoc24512],["GRU62463","Dot30270","Add29412","Res59922","PRe58412","Res22737","Loc24512"],Loc24512,"Loc24512")

Actual (Unparsed): [[[[0.2276174, 2.0158539]]]]

Expected (Unparsed): [[[[0.22761737169019755,2.0158539445217496]]]]

Actual:   [[[[0.2277, 2.0159]]]]

Expected: [[[[0.2277, 2.0159]]]]