import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul23038 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul23038 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Sub77204 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub77204 = tf.keras.layers.Input(shape=([2, 2]))

Mul23038 = keras.layers.Multiply(name = 'Mul23038', )([in0Mul23038,in1Mul23038])
Res79221 = keras.layers.Reshape((2, 2), name = 'Res79221', )(Mul23038)
Sub77204 = keras.layers.Subtract(name = 'Sub77204', )([in0Sub77204,in1Sub77204])
ReL29430 = keras.layers.ReLU(max_value=6.5211611902201465, negative_slope=7.435812810048902, threshold=6.69526433288061, name = 'ReL29430', )(Sub77204)
Max56662 = keras.layers.Maximum(name = 'Max56662', )([Res79221,ReL29430])
Res13842 = keras.layers.Reshape((2, 2, 1), name = 'Res13842', )(Max56662)
Sep59236 = keras.layers.SeparableConv2D(2, (2, 1),strides=(2, 2), padding='valid', name = 'Sep59236', )(Res13842)
model = tf.keras.models.Model(inputs=[in0Mul23038,in1Mul23038,in0Sub77204,in1Sub77204], outputs=Sep59236)
w = model.get_layer('Sep59236').get_weights() 
w[0] = np.array([[[[0.7867]]], [[[0.336]]]])
w[1] = np.array([[[[0.4118, 0.7332]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep59236').set_weights(w) 
in0Mul23038 = tf.constant([[[[0.6281], [0.8004]], [[0.6015], [0.0377]]]])
in1Mul23038 = tf.constant([[[[0.5264], [0.7963]], [[0.4171], [0.3161]]]])
in0Sub77204 = tf.constant([[[0.293, 0.6865], [0.9643, 0.9725]]])
in1Sub77204 = tf.constant([[[0.9042, 0.1033], [0.6575, 0.4943]]])
print (np.array2string(model.predict([in0Mul23038,in1Mul23038,in0Sub77204,in1Sub77204],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep59236.png')

LMul23038 = multiply_layer([[[[[0.6281], [0.8004]], [[0.6015], [0.0377]]]], [[[[0.5264], [0.7963]], [[0.4171], [0.3161]]]]], Mul23038), 
LRes79221 = reshape_layer(Mul23038, [2, 2], Res79221), 
LSub77204 = subtract_layer([[[0.293, 0.6865], [0.9643, 0.9725]]], [[[0.9042, 0.1033], [0.6575, 0.4943]]], Sub77204), 
LReL29430 = relu_layer(Sub77204, 6.5211611902201465, 7.435812810048902, 6.69526433288061, ReL29430), 
LMax56662 = maximum_layer([Res79221,ReL29430], Max56662), 
LRes13842 = reshape_layer(Max56662, [2, 2, 1], Res13842), 
LSep59236 = separable_conv2D_layer(Res13842, 2, 1,[[[[[0.7867]]], [[[0.336]]]],[[[[0.4118, 0.7332]]]]],[0, 0], 2, 2, false, Sep59236), 
exec_layers([LMul23038,LRes79221,LSub77204,LReL29430,LMax56662,LRes13842,LSep59236],["Mul23038","Res79221","Sub77204","ReL29430","Max56662","Res13842","Sep59236"],Sep59236,"Sep59236")

Actual (Unparsed): [[[[0.1418262, 0.2525182]]]]

Expected (Unparsed): [[[[0.14182624540495042,0.2525182203276096]]]]

Actual:   [[[[0.1419, 0.2526]]]]

Expected: [[[[0.1419, 0.2526]]]]