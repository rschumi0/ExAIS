import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo23052 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul3897 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Mul3897 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Con81138 = tf.keras.layers.Input(shape=([3, 6, 1, 2]))
in0Glo81917 = tf.keras.layers.Input(shape=([2, 2]))

Glo23052 = keras.layers.GlobalAveragePooling1D(name = 'Glo23052', )(in0Glo23052)
Res73742 = keras.layers.Reshape((1, 1), name = 'Res73742', )(Glo23052)
Mul3897 = keras.layers.Multiply(name = 'Mul3897', )([in0Mul3897,in1Mul3897])
Res99279 = keras.layers.Reshape((1, 2, 2), name = 'Res99279', )(Mul3897)
Res93642 = keras.layers.Reshape((1, 4), name = 'Res93642', )(Res99279)
Dot48016 = keras.layers.Dot(axes=(2, 1), name = 'Dot48016', )([Res73742,Res93642])
Res16333 = keras.layers.Reshape((1, 4, 1), name = 'Res16333', )(Dot48016)
Dep22967 = keras.layers.DepthwiseConv2D((1, 4),strides=(1, 1), padding='same', name = 'Dep22967', )(Res16333)
Res84190 = keras.layers.Reshape((1, 4), name = 'Res84190', )(Dep22967)
Cro41846 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro41846', )(Res84190)
Zer37274 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer37274', )(Cro41846)
Res47064 = keras.layers.Reshape((3, 4, 1), name = 'Res47064', )(Zer37274)
Res31378 = keras.layers.Reshape((3, 4, 1, 1), name = 'Res31378', )(Res47064)
Zer94095 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer94095', )(Res31378)
Con81138 = keras.layers.Concatenate(axis=4, name = 'Con81138', )([Zer94095,in0Con81138])
Glo81917 = keras.layers.GlobalAveragePooling1D(name = 'Glo81917', )(in0Glo81917)
Res12829 = keras.layers.Reshape((2, 1), name = 'Res12829', )(Glo81917)
Con26605 = keras.layers.Conv1D(4, (2),strides=(5), padding='valid', dilation_rate=(1), name = 'Con26605', )(Res12829)
Thr28567 = keras.layers.ThresholdedReLU(theta=2.9592364027131697, name = 'Thr28567', )(Con26605)
Res7717 = keras.layers.Reshape((1, 4, 1), name = 'Res7717', )(Thr28567)
Res78335 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res78335', )(Res7717)
Con24331 = keras.layers.Conv3DTranspose(3, (1, 2, 1),strides=(1, 1, 1), padding='valid', name = 'Con24331', )(Res78335)
Zer72047 = keras.layers.ZeroPadding3D(padding=((2, 0), (1, 0), (0, 0)), name = 'Zer72047', )(Con24331)
Min20249 = keras.layers.Minimum(name = 'Min20249', )([Con81138,Zer72047])
model = tf.keras.models.Model(inputs=[in0Glo23052,in0Mul3897,in1Mul3897,in0Con81138,in0Glo81917], outputs=Min20249)
w = model.get_layer('Dep22967').get_weights() 
w[0] = np.array([[[[0.1181]], [[0.0505]], [[0.108]], [[0.0985]]]])
w[1] = np.array([0])
model.get_layer('Dep22967').set_weights(w) 
w = model.get_layer('Con26605').get_weights() 
w[0] = np.array([[[0.883, 0.9325, 0.2042, 0.8617]], [[0.8659, 0.4306, 0.5635, 0.3715]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con26605').set_weights(w) 
w = model.get_layer('Con24331').get_weights() 
w[0] = np.array([[[[[0.8961], [0.5687], [0.6946]]], [[[0.9153], [0.8399], [0.0724]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con24331').set_weights(w) 
in0Glo23052 = tf.constant([[[1.7717], [1.4784]]])
in0Mul3897 = tf.constant([[[[[0.9181, 0.0017]], [[0.9265, 0.7017]]]]])
in1Mul3897 = tf.constant([[[[[0.453, 0.4768]], [[0.6706, 0.1897]]]]])
in0Con81138 = tf.constant([[[[[0.55, 0.0864]], [[0.959, 0.4136]], [[0.1915, 0.0455]], [[0.7991, 0.1771]], [[0.1088, 0.9167]], [[0.0217, 0.7743]]], [[[0.9031, 0.5093]], [[0.2458, 0.2156]], [[0.8002, 0.8638]], [[0.5086, 0.8618]], [[0.6962, 0.7366]], [[0.6812, 0.8761]]], [[[0.8814, 0.6162]], [[0.021, 0.4415]], [[0.5744, 0.9471]], [[0.8035, 0.6231]], [[0.8396, 0.7788]], [[0.1787, 0.6876]]]]])
in0Glo81917 = tf.constant([[[1.5464, 1.1208], [1.3734, 1.3015]]])
print (np.array2string(model.predict([in0Glo23052,in0Mul3897,in1Mul3897,in0Con81138,in0Glo81917],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min20249.png')

LGlo23052 = global_average_pooling1D_layer([[[1.7717], [1.4784]]], Glo23052), 
LRes73742 = reshape_layer(Glo23052, [1, 1], Res73742), 
LMul3897 = multiply_layer([[[[[[0.9181, 0.0017]], [[0.9265, 0.7017]]]]], [[[[[0.453, 0.4768]], [[0.6706, 0.1897]]]]]], Mul3897), 
LRes99279 = reshape_layer(Mul3897, [1, 2, 2], Res99279), 
LRes93642 = reshape_layer(Res99279, [1, 4], Res93642), 
LDot48016 = dot_layer(Res73742,Res93642, 2, 1, Dot48016), 
LRes16333 = reshape_layer(Dot48016, [1, 4, 1], Res16333), 
LDep22967 = depthwise_conv2D_layer(Res16333, 1, 4,[[[[0.1181]], [[0.0505]], [[0.108]], [[0.0985]]]],[0], 1, 1, true, Dep22967), 
LRes84190 = reshape_layer(Dep22967, [1, 4], Res84190), 
LCro41846 = cropping1D_layer(Res84190, 0, 0, Cro41846), 
LZer37274 = zero_padding1D_layer(Cro41846, 1, 1, Zer37274), 
LRes47064 = reshape_layer(Zer37274, [3, 4, 1], Res47064), 
LRes31378 = reshape_layer(Res47064, [3, 4, 1, 1], Res31378), 
LZer94095 = zero_padding3D_layer(Res31378, 0, 0, 2, 0, 0, 0, Zer94095), 
LCon81138 = concatenate_layer([Zer94095,[[[[[0.55, 0.0864]], [[0.959, 0.4136]], [[0.1915, 0.0455]], [[0.7991, 0.1771]], [[0.1088, 0.9167]], [[0.0217, 0.7743]]], [[[0.9031, 0.5093]], [[0.2458, 0.2156]], [[0.8002, 0.8638]], [[0.5086, 0.8618]], [[0.6962, 0.7366]], [[0.6812, 0.8761]]], [[[0.8814, 0.6162]], [[0.021, 0.4415]], [[0.5744, 0.9471]], [[0.8035, 0.6231]], [[0.8396, 0.7788]], [[0.1787, 0.6876]]]]]], 4, Con81138), 
LGlo81917 = global_average_pooling1D_layer([[[1.5464, 1.1208], [1.3734, 1.3015]]], Glo81917), 
LRes12829 = reshape_layer(Glo81917, [2, 1], Res12829), 
LCon26605 = conv1D_layer(Res12829, 2,[[[0.883, 0.9325, 0.2042, 0.8617]], [[0.8659, 0.4306, 0.5635, 0.3715]]],[0, 0, 0, 0], 5, false, 1, Con26605), 
LThr28567 = thresholded_relu_layer(Con26605, 2.9592364027131697, Thr28567), 
LRes7717 = reshape_layer(Thr28567, [1, 4, 1], Res7717), 
LRes78335 = reshape_layer(Res7717, [1, 4, 1, 1], Res78335), 
LCon24331 = conv3D_transpose_layer(Res78335, 1, 2, 1,[[[[[0.8961], [0.5687], [0.6946]]], [[[0.9153], [0.8399], [0.0724]]]]],[0, 0, 0], 1, 1, 1, false, Con24331), 
LZer72047 = zero_padding3D_layer(Con24331, 2, 0, 1, 0, 0, 0, Zer72047), 
LMin20249 = minimum_layer([Con81138,Zer72047], Min20249), 
exec_layers([LGlo23052,LRes73742,LMul3897,LRes99279,LRes93642,LDot48016,LRes16333,LDep22967,LRes84190,LCro41846,LZer37274,LRes47064,LRes31378,LZer94095,LCon81138,LGlo81917,LRes12829,LCon26605,LThr28567,LRes7717,LRes78335,LCon24331,LZer72047,LMin20249],["Glo23052","Res73742","Mul3897","Res99279","Res93642","Dot48016","Res16333","Dep22967","Res84190","Cro41846","Zer37274","Res47064","Res31378","Zer94095","Con81138","Glo81917","Res12829","Con26605","Thr28567","Res7717","Res78335","Con24331","Zer72047","Min20249"],Min20249,"Min20249")

Actual (Unparsed): [[[[[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000]]]]]

Expected (Unparsed): [[[[[0,0,0]],[[0,0,0]],[[0,0,0]],[[0,0,0]],[[0,0,0]],[[0,0,0]]],[[[0,0,0]],[[0,0,0]],[[0,0,0]],[[0,0,0]],[[0,0,0]],[[0,0,0]]],[[[0,0,0]],[[0,0.0,0.0]],[[0,0.0,0.0]],[[0,0.0,0.0]],[[0,0.0,0.0]],[[0,0.0,0.0]]]]]

Actual:   [[[[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]], [[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]], [[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]]]]

Expected: [[[[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]], [[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]], [[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]]]]