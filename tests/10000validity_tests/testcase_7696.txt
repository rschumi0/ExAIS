import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim25260 = tf.keras.layers.Input(shape=([3, 3]))
in0Min35978 = tf.keras.layers.Input(shape=([1, 1]))
in1Min35978 = tf.keras.layers.Input(shape=([1, 1]))

Sim25260 = keras.layers.SimpleRNN(2,name = 'Sim25260', )(in0Sim25260)
Res36024 = keras.layers.Reshape((2, 1), name = 'Res36024', )(Sim25260)
Min35978 = keras.layers.Minimum(name = 'Min35978', )([in0Min35978,in1Min35978])
Zer88610 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer88610', )(Min35978)
Add69756 = keras.layers.Add(name = 'Add69756', )([Res36024,Zer88610])
LST96437 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST96437', )(Add69756)
Res79064 = keras.layers.Reshape((2, 1), name = 'Res79064', )(LST96437)
Cro75995 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro75995', )(Res79064)
model = tf.keras.models.Model(inputs=[in0Sim25260,in0Min35978,in1Min35978], outputs=Cro75995)
w = model.get_layer('Sim25260').get_weights() 
w[0] = np.array([[8, 10], [2, 2], [2, 7]])
w[1] = np.array([[6, 9], [7, 9]])
w[2] = np.array([7, 9])
model.get_layer('Sim25260').set_weights(w) 
w = model.get_layer('LST96437').get_weights() 
w[0] = np.array([[2, 2, 1, 9, 1, 3, 3, 6]])
w[1] = np.array([[6, 3, 4, 6, 3, 7, 2, 10], [2, 4, 9, 7, 7, 5, 2, 5]])
w[2] = np.array([10, 7, 4, 8, 10, 2, 3, 3])
model.get_layer('LST96437').set_weights(w) 
in0Sim25260 = tf.constant([[[1, 1, 4], [1, 8, 10], [4, 10, 4]]])
in0Min35978 = tf.constant([[[0.4545]]])
in1Min35978 = tf.constant([[[0.853]]])
print (np.array2string(model.predict([in0Sim25260,in0Min35978,in1Min35978],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro75995.png')

LSim25260 = simple_rnn_layer([[[1, 1, 4], [1, 8, 10], [4, 10, 4]]],[[8, 10], [2, 2], [2, 7]],[[6, 9], [7, 9]],[7, 9], Sim25260), 
LRes36024 = reshape_layer(Sim25260, [2, 1], Res36024), 
LMin35978 = minimum_layer([[[[0.4545]]], [[[0.853]]]], Min35978), 
LZer88610 = zero_padding1D_layer(Min35978, 1, 0, Zer88610), 
LAdd69756 = add_layer([Res36024,Zer88610], Add69756), 
LLST96437 = lstm_layer(Add69756,[[2, 2, 1, 9, 1, 3, 3, 6]],[[6, 3, 4, 6, 3, 7, 2, 10], [2, 4, 9, 7, 7, 5, 2, 5]],[10, 7, 4, 8, 10, 2, 3, 3], LST96437), 
LRes79064 = reshape_layer(LST96437, [2, 1], Res79064), 
LCro75995 = cropping1D_layer(Res79064, 0, 1, Cro75995), 
exec_layers([LSim25260,LRes36024,LMin35978,LZer88610,LAdd69756,LLST96437,LRes79064,LCro75995],["Sim25260","Res36024","Min35978","Zer88610","Add69756","LST96437","Res79064","Cro75995"],Cro75995,"Cro75995")

Actual (Unparsed): [[[0.9639980]]]

Expected (Unparsed): [[[0.9639979612345372]]]

Actual:   [[[0.964]]]

Expected: [[[0.964]]]