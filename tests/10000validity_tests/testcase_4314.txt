import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub13379 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub13379 = tf.keras.layers.Input(shape=([2, 2]))

Sub13379 = keras.layers.Subtract(name = 'Sub13379', )([in0Sub13379,in1Sub13379])
LST93096 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST93096', )(Sub13379)
Res5687 = keras.layers.Reshape((2, 1), name = 'Res5687', )(LST93096)
Res63459 = keras.layers.Reshape((2, 1, 1), name = 'Res63459', )(Res5687)
Max89727 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(1, 1), padding='valid', name = 'Max89727', )(Res63459)
Sof37772 = keras.layers.Softmax(axis=1, name = 'Sof37772', )(Max89727)
model = tf.keras.models.Model(inputs=[in0Sub13379,in1Sub13379], outputs=Sof37772)
w = model.get_layer('LST93096').get_weights() 
w[0] = np.array([[7, 2, 9, 7, 9, 10, 2, 5], [9, 9, 9, 9, 1, 5, 8, 7]])
w[1] = np.array([[8, 9, 2, 1, 10, 9, 5, 4], [10, 10, 10, 7, 3, 7, 6, 4]])
w[2] = np.array([2, 8, 7, 5, 7, 10, 2, 5])
model.get_layer('LST93096').set_weights(w) 
in0Sub13379 = tf.constant([[[0.2303, 0.3481], [0.8153, 0.2364]]])
in1Sub13379 = tf.constant([[[0.948, 0.8493], [0.4666, 0.5622]]])
print (np.array2string(model.predict([in0Sub13379,in1Sub13379],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof37772.png')

LSub13379 = subtract_layer([[[0.2303, 0.3481], [0.8153, 0.2364]]], [[[0.948, 0.8493], [0.4666, 0.5622]]], Sub13379), 
LLST93096 = lstm_layer(Sub13379,[[7, 2, 9, 7, 9, 10, 2, 5], [9, 9, 9, 9, 1, 5, 8, 7]],[[8, 9, 2, 1, 10, 9, 5, 4], [10, 10, 10, 7, 3, 7, 6, 4]],[2, 8, 7, 5, 7, 10, 2, 5], LST93096), 
LRes5687 = reshape_layer(LST93096, [2, 1], Res5687), 
LRes63459 = reshape_layer(Res5687, [2, 1, 1], Res63459), 
LMax89727 = max_pool2D_layer(Res63459, 2, 1, 1, 1, false, Max89727), 
LSof37772 = softmax_layer(Max89727, 1, Sof37772), 
exec_layers([LSub13379,LLST93096,LRes5687,LRes63459,LMax89727,LSof37772],["Sub13379","LST93096","Res5687","Res63459","Max89727","Sof37772"],Sof37772,"Sof37772")

Actual (Unparsed): [[[[1.0000000]]]]

Expected (Unparsed): [[[[1.0]]]]

Actual:   [[[[1]]]]

Expected: [[[[1]]]]