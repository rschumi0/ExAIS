import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul82057 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul82057 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dep83206 = tf.keras.layers.Input(shape=([2, 1, 2]))

Mul82057 = keras.layers.Multiply(name = 'Mul82057', )([in0Mul82057,in1Mul82057])
Dep83206 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='valid', name = 'Dep83206', )(in0Dep83206)
Zer52891 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer52891', )(Dep83206)
Max87432 = keras.layers.Maximum(name = 'Max87432', )([Mul82057,Zer52891])
Con7539 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con7539', )(Max87432)
model = tf.keras.models.Model(inputs=[in0Mul82057,in1Mul82057,in0Dep83206], outputs=Con7539)
w = model.get_layer('Dep83206').get_weights() 
w[0] = np.array([[[[0.458], [0.1459]]], [[[0.4661], [0.2018]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep83206').set_weights(w) 
w = model.get_layer('Con7539').get_weights() 
w[0] = np.array([[[[0.6053, 0.3665, 0.3775, 0.8154], [0.9947, 0.9355, 0.367, 0.7099]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con7539').set_weights(w) 
in0Mul82057 = tf.constant([[[[0.0103, 0.361], [0.4448, 0.6527]]]])
in1Mul82057 = tf.constant([[[[0.181, 0.6374], [0.1782, 0.7695]]]])
in0Dep83206 = tf.constant([[[[0.8655, 0.7955]], [[0.8071, 0.6336]]]])
print (np.array2string(model.predict([in0Mul82057,in1Mul82057,in0Dep83206],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con7539.png')

LMul82057 = multiply_layer([[[[[0.0103, 0.361], [0.4448, 0.6527]]]], [[[[0.181, 0.6374], [0.1782, 0.7695]]]]], Mul82057), 
LDep83206 = depthwise_conv2D_layer([[[[0.8655, 0.7955]], [[0.8071, 0.6336]]]], 2, 1,[[[[0.458], [0.1459]]], [[[0.4661], [0.2018]]]],[0, 0], 1, 1, false, Dep83206), 
LZer52891 = zero_padding2D_layer(Dep83206, 0, 0, 1, 0, Zer52891), 
LMax87432 = maximum_layer([Mul82057,Zer52891], Max87432), 
LCon7539 = conv2D_layer(Max87432, 1, 1,[[[[0.6053, 0.3665, 0.3775, 0.8154], [0.9947, 0.9355, 0.367, 0.7099]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con7539), 
exec_layers([LMul82057,LDep83206,LZer52891,LMax87432,LCon7539],["Mul82057","Dep83206","Zer52891","Max87432","Con7539"],Con7539,"Con7539")

Actual (Unparsed): [[[[0.2300103, 0.2159431, 0.0851510, 0.1648691], [0.9672384, 0.7530110, 0.4759788, 0.9865177]]]]

Expected (Unparsed): [[[[0.23001032337,0.21594312564999998,0.08515098704999999,0.16486913407999998],[0.967238414998,0.75301096969,0.47597880957500005,0.9865176642090001]]]]

Actual:   [[[[0.2301, 0.216, 0.0852, 0.1649], [0.9673, 0.7531, 0.476, 0.9866]]]]

Expected: [[[[0.2301, 0.216, 0.0852, 0.1649], [0.9673, 0.7531, 0.476, 0.9866]]]]