import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max10642 = tf.keras.layers.Input(shape=([2, 1]))
in0Con27559 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Ave28272 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Bat34768 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Ave37569 = tf.keras.layers.Input(shape=([2, 1]))
in0Con94131 = tf.keras.layers.Input(shape=([1, 1]))

Max10642 = keras.layers.MaxPool1D(pool_size=(1), strides=(2), padding='valid', name = 'Max10642', )(in0Max10642)
Res12585 = keras.layers.Reshape((1, 1, 1), name = 'Res12585', )(Max10642)
Zer27429 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer27429', )(Res12585)
Con27559 = keras.layers.Concatenate(axis=3, name = 'Con27559', )([Zer27429,in0Con27559])
Ave28272 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave28272', )(in0Ave28272)
Add26212 = keras.layers.Add(name = 'Add26212', )([Con27559,Ave28272])
Res27744 = keras.layers.Reshape((2, 2), name = 'Res27744', )(Add26212)
Bat34768 = keras.layers.BatchNormalization(axis=3, epsilon=0.7180386189393629,  name = 'Bat34768', )(in0Bat34768)
Res83334 = keras.layers.Reshape((1, 2), name = 'Res83334', )(Bat34768)
Ave37569 = keras.layers.AveragePooling1D(pool_size=(2), name = 'Ave37569', )(in0Ave37569)
Con94131 = keras.layers.Concatenate(axis=2, name = 'Con94131', )([Ave37569,in0Con94131])
Ave29421 = keras.layers.Average(name = 'Ave29421', )([Res83334,Con94131])
Dot87769 = keras.layers.Dot(axes=(1, 2), name = 'Dot87769', )([Res27744,Ave29421])
Res56367 = keras.layers.Reshape((2, 1, 1), name = 'Res56367', )(Dot87769)
Glo46010 = keras.layers.GlobalMaxPool2D(name = 'Glo46010', )(Res56367)
model = tf.keras.models.Model(inputs=[in0Max10642,in0Con27559,in0Ave28272,in0Bat34768,in0Ave37569,in0Con94131], outputs=Glo46010)
w = model.get_layer('Bat34768').get_weights() 
w[0] = np.array([0.5761, 0.2272])
w[1] = np.array([0.268, 0.5318])
w[2] = np.array([0.3582, 0.4516])
w[3] = np.array([0.5363, 0.1157])
model.get_layer('Bat34768').set_weights(w) 
in0Max10642 = tf.constant([[[1.8655], [1.7207]]])
in0Con27559 = tf.constant([[[[0.2918]], [[0.5651]]]])
in0Ave28272 = tf.constant([[[[1.5878, 1.155]], [[1.6759, 1.5413]]]])
in0Bat34768 = tf.constant([[[[1.3959, 1.4659]]]])
in0Ave37569 = tf.constant([[[1.3868], [1.5034]]])
in0Con94131 = tf.constant([[[0.6728]]])
print (np.array2string(model.predict([in0Max10642,in0Con27559,in0Ave28272,in0Bat34768,in0Ave37569,in0Con94131],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo46010.png')

LMax10642 = max_pool1D_layer([[[1.8655], [1.7207]]], 1, 2, false, Max10642), 
LRes12585 = reshape_layer(Max10642, [1, 1, 1], Res12585), 
LZer27429 = zero_padding2D_layer(Res12585, 1, 0, 0, 0, Zer27429), 
LCon27559 = concatenate_layer([Zer27429,[[[[0.2918]], [[0.5651]]]]], 3, Con27559), 
LAve28272 = average_pooling2D_layer([[[[1.5878, 1.155]], [[1.6759, 1.5413]]]], 1, 1, Ave28272), 
LAdd26212 = add_layer([Con27559,Ave28272], Add26212), 
LRes27744 = reshape_layer(Add26212, [2, 2], Res27744), 
LBat34768 = batch_normalization_layer([[[[1.3959, 1.4659]]]], 3, 0.7180386189393629, [0.5761, 0.2272], [0.268, 0.5318], [0.3582, 0.4516], [0.5363, 0.1157], Bat34768), 
LRes83334 = reshape_layer(Bat34768, [1, 2], Res83334), 
LAve37569 = average_pooling1D_layer([[[1.3868], [1.5034]]], 2, Ave37569), 
LCon94131 = concatenate_layer([Ave37569,[[[0.6728]]]], 2, Con94131), 
LAve29421 = average_layer([Res83334,Con94131], Ave29421), 
LDot87769 = dot_layer(Res27744,Ave29421, 1, 2, Dot87769), 
LRes56367 = reshape_layer(Dot87769, [2, 1, 1], Res56367), 
LGlo46010 = global_max_pool2D_layer(Res56367, Glo46010), 
exec_layers([LMax10642,LRes12585,LZer27429,LCon27559,LAve28272,LAdd26212,LRes27744,LBat34768,LRes83334,LAve37569,LCon94131,LAve29421,LDot87769,LRes56367,LGlo46010],["Max10642","Res12585","Zer27429","Con27559","Ave28272","Add26212","Res27744","Bat34768","Res83334","Ave37569","Con94131","Ave29421","Dot87769","Res56367","Glo46010"],Glo46010,"Glo46010")

Actual (Unparsed): [[4.3636775]]

Expected (Unparsed): [[4.363677513955674]]

Actual:   [[4.3637]]

Expected: [[4.3637]]