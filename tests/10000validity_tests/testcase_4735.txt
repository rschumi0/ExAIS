import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla49123 = tf.keras.layers.Input(shape=([4, 2]))

Fla49123 = keras.layers.Flatten(name = 'Fla49123', )(in0Fla49123)
Res38839 = keras.layers.Reshape((8, 1), name = 'Res38839', )(Fla49123)
GRU31233 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU31233', )(Res38839)
model = tf.keras.models.Model(inputs=[in0Fla49123], outputs=GRU31233)
w = model.get_layer('GRU31233').get_weights() 
w[0] = np.array([[8, 3, 6, 10, 1, 3]])
w[1] = np.array([[1, 7, 6, 9, 10, 2], [4, 7, 7, 5, 9, 6]])
w[2] = np.array([8, 7, 8, 3, 3, 8])
model.get_layer('GRU31233').set_weights(w) 
in0Fla49123 = tf.constant([[[1.911, 1.6994], [1.1156, 1.4853], [1.7622, 1.4821], [1.2401, 1.1657]]])
print (np.array2string(model.predict([in0Fla49123],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU31233.png')

LFla49123 = flatten_layer([[[1.911, 1.6994], [1.1156, 1.4853], [1.7622, 1.4821], [1.2401, 1.1657]]], Fla49123), 
LRes38839 = reshape_layer(Fla49123, [8, 1], Res38839), 
LGRU31233 = gru_layer(Res38839,[[8, 3, 6, 10, 1, 3]],[[1, 7, 6, 9, 10, 2], [4, 7, 7, 5, 9, 6]],[8, 7, 8, 3, 3, 8], false, GRU31233), 
exec_layers([LFla49123,LRes38839,LGRU31233],["Fla49123","Res38839","GRU31233"],GRU31233,"GRU31233")

Actual (Unparsed): [[0.0000001, 0.0001162]]

Expected (Unparsed): [[9.639336731497241e-8,0.00011616785476802408]]

Actual:   [[0, 0.0002]]

Expected: [[0, 0.0002]]