import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul41520 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Mul41520 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Cro62362 = tf.keras.layers.Input(shape=([1, 1]))
in0Con14101 = tf.keras.layers.Input(shape=([2, 3]))

Mul41520 = keras.layers.Multiply(name = 'Mul41520', )([in0Mul41520,in1Mul41520])
Res81970 = keras.layers.Reshape((2, 2, 2), name = 'Res81970', )(Mul41520)
Res60061 = keras.layers.Reshape((2, 4), name = 'Res60061', )(Res81970)
Cro62362 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro62362', )(in0Cro62362)
Zer33506 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer33506', )(Cro62362)
Con14101 = keras.layers.Concatenate(axis=2, name = 'Con14101', )([Zer33506,in0Con14101])
Sub46557 = keras.layers.Subtract(name = 'Sub46557', )([Res60061,Con14101])
model = tf.keras.models.Model(inputs=[in0Mul41520,in1Mul41520,in0Cro62362,in0Con14101], outputs=Sub46557)
in0Mul41520 = tf.constant([[[[[0.2151, 0.0207]], [[0.7699, 0.2796]]], [[[0.1364, 0.8161]], [[0.2863, 0.7282]]]]])
in1Mul41520 = tf.constant([[[[[0.3959, 0.0747]], [[0.096, 0.4139]]], [[[0.0857, 0.4639]], [[0.4299, 0.7449]]]]])
in0Cro62362 = tf.constant([[[1.1401]]])
in0Con14101 = tf.constant([[[0.691, 0.3576, 0.4046], [0.731, 0.8825, 0.1014]]])
print (np.array2string(model.predict([in0Mul41520,in1Mul41520,in0Cro62362,in0Con14101],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub46557.png')

LMul41520 = multiply_layer([[[[[[0.2151, 0.0207]], [[0.7699, 0.2796]]], [[[0.1364, 0.8161]], [[0.2863, 0.7282]]]]], [[[[[0.3959, 0.0747]], [[0.096, 0.4139]]], [[[0.0857, 0.4639]], [[0.4299, 0.7449]]]]]], Mul41520), 
LRes81970 = reshape_layer(Mul41520, [2, 2, 2], Res81970), 
LRes60061 = reshape_layer(Res81970, [2, 4], Res60061), 
LCro62362 = cropping1D_layer([[[1.1401]]], 0, 0, Cro62362), 
LZer33506 = zero_padding1D_layer(Cro62362, 1, 0, Zer33506), 
LCon14101 = concatenate_layer([Zer33506,[[[0.691, 0.3576, 0.4046], [0.731, 0.8825, 0.1014]]]], 2, Con14101), 
LSub46557 = subtract_layer(Res60061,Con14101, Sub46557), 
exec_layers([LMul41520,LRes81970,LRes60061,LCro62362,LZer33506,LCon14101,LSub46557],["Mul41520","Res81970","Res60061","Cro62362","Zer33506","Con14101","Sub46557"],Sub46557,"Sub46557")

Actual (Unparsed): [[[0.0851581, -0.6894537, -0.2836896, -0.2888736], [-1.1284105, -0.3524112, -0.7594196, 0.4410362]]]

Expected (Unparsed): [[[0.08515809,-0.68945371,-0.2836896,-0.28887356000000003],[-1.1284105199999999,-0.35241121,-0.75941963,0.44103617999999994]]]

Actual:   [[[0.0852, -0.6894, -0.2836, -0.2888], [-1.1284, -0.3524, -0.7594, 0.4411]]]

Expected: [[[0.0852, -0.6894, -0.2836, -0.2888], [-1.1284, -0.3524, -0.7594, 0.4411]]]