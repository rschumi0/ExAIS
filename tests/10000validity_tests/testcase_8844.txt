import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo44015 = tf.keras.layers.Input(shape=([1, 2]))
in0Zer68192 = tf.keras.layers.Input(shape=([4, 1]))

Glo44015 = keras.layers.GlobalMaxPool1D(name = 'Glo44015', )(in0Glo44015)
Res4672 = keras.layers.Reshape((2, 1), name = 'Res4672', )(Glo44015)
Zer74473 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer74473', )(Res4672)
Zer68192 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer68192', )(in0Zer68192)
Mul48502 = keras.layers.Multiply(name = 'Mul48502', )([Zer74473,Zer68192])
Lay32952 = keras.layers.LayerNormalization(axis=1, epsilon=2.9189135494444276, name = 'Lay32952', )(Mul48502)
model = tf.keras.models.Model(inputs=[in0Glo44015,in0Zer68192], outputs=Lay32952)
in0Glo44015 = tf.constant([[[1.8925, 1.0401]]])
in0Zer68192 = tf.constant([[[1.1161], [1.7425], [1.377], [1.8404]]])
print (np.array2string(model.predict([in0Glo44015,in0Zer68192],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay32952.png')

LGlo44015 = global_max_pool1D_layer([[[1.8925, 1.0401]]], Glo44015), 
LRes4672 = reshape_layer(Glo44015, [2, 1], Res4672), 
LZer74473 = zero_padding1D_layer(Res4672, 4, 0, Zer74473), 
LZer68192 = zero_padding1D_layer([[[1.1161], [1.7425], [1.377], [1.8404]]], 1, 1, Zer68192), 
LMul48502 = multiply_layer([Zer74473,Zer68192], Mul48502), 
LLay32952 = layer_normalization_layer(Mul48502, 1, 2.9189135494444276, Lay32952), 
exec_layers([LGlo44015,LRes4672,LZer74473,LZer68192,LMul48502,LLay32952],["Glo44015","Res4672","Zer74473","Zer68192","Mul48502","Lay32952"],Lay32952,"Lay32952")

Actual (Unparsed): [[[-0.2705452], [-0.2705452], [-0.2705452], [-0.2705452], [1.3527262], [-0.2705452]]]

Expected (Unparsed): [[[-0.27054524310474615],[-0.27054524310474615],[-0.27054524310474615],[-0.27054524310474615],[1.3527262155237307],[-0.27054524310474615]]]

Actual:   [[[-0.2705], [-0.2705], [-0.2705], [-0.2705], [1.3528], [-0.2705]]]

Expected: [[[-0.2705], [-0.2705], [-0.2705], [-0.2705], [1.3528], [-0.2705]]]