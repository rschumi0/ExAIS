import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add3516 = tf.keras.layers.Input(shape=([2, 1]))
in1Add3516 = tf.keras.layers.Input(shape=([2, 1]))
in0Con66127 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con13184 = tf.keras.layers.Input(shape=([4, 3, 1]))

Add3516 = keras.layers.Add(name = 'Add3516', )([in0Add3516,in1Add3516])
Res94330 = keras.layers.Reshape((2, 1, 1), name = 'Res94330', )(Add3516)
Dep96343 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep96343', )(Res94330)
Res41501 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res41501', )(Dep96343)
Up_79022 = keras.layers.UpSampling3D(size=(2, 1, 2), name = 'Up_79022', )(Res41501)
Res73669 = keras.layers.Reshape((4, 1, 2), name = 'Res73669', )(Up_79022)
Zer62904 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer62904', )(Res73669)
Con66127 = keras.layers.Conv3DTranspose(4, (1, 1, 1),strides=(3, 1, 1), padding='same', name = 'Con66127', )(in0Con66127)
Fla79446 = keras.layers.Flatten(name = 'Fla79446', )(Con66127)
Res40389 = keras.layers.Reshape((12, 1), name = 'Res40389', )(Fla79446)
Res15840 = keras.layers.Reshape((12, 1, 1), name = 'Res15840', )(Res40389)
Ave53360 = keras.layers.AveragePooling2D(pool_size=(8, 1), name = 'Ave53360', )(Res15840)
Up_99306 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_99306', )(Ave53360)
Zer22260 = keras.layers.ZeroPadding2D(padding=((3, 0), (1, 0)), name = 'Zer22260', )(Up_99306)
Con13184 = keras.layers.Concatenate(axis=3, name = 'Con13184', )([Zer22260,in0Con13184])
Add53824 = keras.layers.Add(name = 'Add53824', )([Zer62904,Con13184])
Res30969 = keras.layers.Reshape((4, 6), name = 'Res30969', )(Add53824)
Loc62034 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc62034', )(Res30969)
model = tf.keras.models.Model(inputs=[in0Add3516,in1Add3516,in0Con66127,in0Con13184], outputs=Loc62034)
w = model.get_layer('Dep96343').get_weights() 
w[0] = np.array([[[[0.6914]]]])
w[1] = np.array([0])
model.get_layer('Dep96343').set_weights(w) 
w = model.get_layer('Con66127').get_weights() 
w[0] = np.array([[[[[0.7762], [0.3042], [0.1621], [0.7827]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con66127').set_weights(w) 
w = model.get_layer('Loc62034').get_weights() 
w[0] = np.array([[[0.1143, 0.5549, 0.8303], [0.871, 0.5471, 0.8828], [0.8213, 0.6755, 0.6173], [0.0831, 0.6162, 0.4416], [0.2734, 0.0954, 0.9631], [0.1113, 0.5757, 0.0967], [0.5654, 0.2855, 0.369], [0.7507, 0.9238, 0.8557], [0.4323, 0.7557, 0.6619], [0.8202, 0.7052, 0.4295], [0.8906, 0.4011, 0.2301], [0.7755, 0.5929, 0.3022]], [[0.5206, 0.4581, 0.9755], [0.446, 0.1692, 0.3815], [0.2251, 0.811, 0.6408], [0.1166, 0.1325, 0.0551], [0.3646, 0.2473, 0.6032], [0.4533, 0.4316, 0.8172], [0.16, 0.3066, 0.4341], [0.4539, 0.1611, 0.3843], [0.2409, 0.4138, 0.6068], [0.1502, 0.7941, 0.7524], [0.0886, 0.4951, 0.3314], [0.0526, 0.6467, 0.4466]], [[0.7938, 0.6672, 0.044], [0.861, 0.5598, 0.224], [0.2402, 0.4137, 0.0644], [0.2243, 0.6549, 0.3024], [0.3047, 0.9257, 0.1462], [0.9498, 0.715, 0.3394], [0.497, 0.6521, 0.3991], [0.0978, 0.6044, 0.5576], [0.2519, 0.1516, 0.4948], [0.5788, 0.0692, 0.7388], [0.7512, 0.8422, 0.351], [0.838, 0.9325, 0.0646]]])
w[1] = np.array([[0, 0, 0], [0, 0, 0], [0, 0, 0]])
model.get_layer('Loc62034').set_weights(w) 
in0Add3516 = tf.constant([[[0.0411], [0.4113]]])
in1Add3516 = tf.constant([[[0.7349], [0.585]]])
in0Con66127 = tf.constant([[[[[0.9665]]]]])
in0Con13184 = tf.constant([[[[0.5804], [0.3569], [0.9027]], [[0.9818], [0.2249], [0.8458]], [[0.1738], [0.593], [0.7083]], [[0.6994], [0.7092], [0.4879]]]])
print (np.array2string(model.predict([in0Add3516,in1Add3516,in0Con66127,in0Con13184],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc62034.png')

LAdd3516 = add_layer([[[[0.0411], [0.4113]]], [[[0.7349], [0.585]]]], Add3516), 
LRes94330 = reshape_layer(Add3516, [2, 1, 1], Res94330), 
LDep96343 = depthwise_conv2D_layer(Res94330, 1, 1,[[[[0.6914]]]],[0], 1, 1, false, Dep96343), 
LRes41501 = reshape_layer(Dep96343, [2, 1, 1, 1], Res41501), 
LUp_79022 = up_sampling3D_layer(Res41501, 2, 1, 2, Up_79022), 
LRes73669 = reshape_layer(Up_79022, [4, 1, 2], Res73669), 
LZer62904 = zero_padding2D_layer(Res73669, 0, 0, 2, 0, Zer62904), 
LCon66127 = conv3D_transpose_layer([[[[[0.9665]]]]], 1, 1, 1,[[[[[0.7762], [0.3042], [0.1621], [0.7827]]]]],[0, 0, 0, 0], 3, 1, 1, true, Con66127), 
LFla79446 = flatten_layer(Con66127, Fla79446), 
LRes40389 = reshape_layer(Fla79446, [12, 1], Res40389), 
LRes15840 = reshape_layer(Res40389, [12, 1, 1], Res15840), 
LAve53360 = average_pooling2D_layer(Res15840, 8, 1, Ave53360), 
LUp_99306 = up_sampling2D_layer(Ave53360, 1, 2, Up_99306), 
LZer22260 = zero_padding2D_layer(Up_99306, 3, 0, 1, 0, Zer22260), 
LCon13184 = concatenate_layer([Zer22260,[[[[0.5804], [0.3569], [0.9027]], [[0.9818], [0.2249], [0.8458]], [[0.1738], [0.593], [0.7083]], [[0.6994], [0.7092], [0.4879]]]]], 3, Con13184), 
LAdd53824 = add_layer([Zer62904,Con13184], Add53824), 
LRes30969 = reshape_layer(Add53824, [4, 6], Res30969), 
LLoc62034 = locally_connected1D_layer(Res30969, 2,[[[0.1143, 0.5549, 0.8303], [0.871, 0.5471, 0.8828], [0.8213, 0.6755, 0.6173], [0.0831, 0.6162, 0.4416], [0.2734, 0.0954, 0.9631], [0.1113, 0.5757, 0.0967], [0.5654, 0.2855, 0.369], [0.7507, 0.9238, 0.8557], [0.4323, 0.7557, 0.6619], [0.8202, 0.7052, 0.4295], [0.8906, 0.4011, 0.2301], [0.7755, 0.5929, 0.3022]], [[0.5206, 0.4581, 0.9755], [0.446, 0.1692, 0.3815], [0.2251, 0.811, 0.6408], [0.1166, 0.1325, 0.0551], [0.3646, 0.2473, 0.6032], [0.4533, 0.4316, 0.8172], [0.16, 0.3066, 0.4341], [0.4539, 0.1611, 0.3843], [0.2409, 0.4138, 0.6068], [0.1502, 0.7941, 0.7524], [0.0886, 0.4951, 0.3314], [0.0526, 0.6467, 0.4466]], [[0.7938, 0.6672, 0.044], [0.861, 0.5598, 0.224], [0.2402, 0.4137, 0.0644], [0.2243, 0.6549, 0.3024], [0.3047, 0.9257, 0.1462], [0.9498, 0.715, 0.3394], [0.497, 0.6521, 0.3991], [0.0978, 0.6044, 0.5576], [0.2519, 0.1516, 0.4948], [0.5788, 0.0692, 0.7388], [0.7512, 0.8422, 0.351], [0.838, 0.9325, 0.0646]]],[[0, 0, 0], [0, 0, 0], [0, 0, 0]], 1, Loc62034), 
exec_layers([LAdd3516,LRes94330,LDep96343,LRes41501,LUp_79022,LRes73669,LZer62904,LCon66127,LFla79446,LRes40389,LRes15840,LAve53360,LUp_99306,LZer22260,LCon13184,LAdd53824,LRes30969,LLoc62034],["Add3516","Res94330","Dep96343","Res41501","Up_79022","Res73669","Zer62904","Con66127","Fla79446","Res40389","Res15840","Ave53360","Up_99306","Zer22260","Con13184","Add53824","Res30969","Loc62034"],Loc62034,"Loc62034")

Actual (Unparsed): [[[3.3133838, 3.5175743, 2.8038005], [1.5888097, 2.6686925, 3.2054288], [4.0474289, 4.5146670, 2.2318379]]]

Expected (Unparsed): [[[3.3133837811199998,3.5175742586399994,2.8038005014400005],[1.5888096875440003,2.6686925430360002,3.2054288045200003],[4.0474289539065,4.514667066283,2.231837850139]]]

Actual:   [[[3.3134, 3.5176, 2.8039], [1.5889, 2.6687, 3.2055], [4.0475, 4.5147, 2.2319]]]

Expected: [[[3.3134, 3.5176, 2.8039], [1.5889, 2.6687, 3.2055], [4.0475, 4.5147, 2.2319]]]