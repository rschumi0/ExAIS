import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave38728 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave38728 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Min69641 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Min69641 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Ave38728 = keras.layers.Average(name = 'Ave38728', )([in0Ave38728,in1Ave38728])
Den6614 = keras.layers.Dense(2,name = 'Den6614', )(Ave38728)
Res60678 = keras.layers.Reshape((1, 1, 4), name = 'Res60678', )(Den6614)
Res36967 = keras.layers.Reshape((1, 4), name = 'Res36967', )(Res60678)
Glo26979 = keras.layers.GlobalMaxPool1D(name = 'Glo26979', )(Res36967)
Res88768 = keras.layers.Reshape((4, 1), name = 'Res88768', )(Glo26979)
Ave95316 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave95316', )(Res88768)
Res40721 = keras.layers.Reshape((4, 1, 1), name = 'Res40721', )(Ave95316)
Zer55817 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer55817', )(Res40721)
Min69641 = keras.layers.Minimum(name = 'Min69641', )([in0Min69641,in1Min69641])
Res69892 = keras.layers.Reshape((2, 2, 2), name = 'Res69892', )(Min69641)
Glo11789 = keras.layers.GlobalAveragePooling2D(name = 'Glo11789', )(Res69892)
Res46943 = keras.layers.Reshape((2, 1), name = 'Res46943', )(Glo11789)
Res8636 = keras.layers.Reshape((2, 1, 1), name = 'Res8636', )(Res46943)
Zer2860 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer2860', )(Res8636)
Max12910 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max12910', )(Zer2860)
Zer35133 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer35133', )(Max12910)
Min29245 = keras.layers.Minimum(name = 'Min29245', )([Zer55817,Zer35133])
model = tf.keras.models.Model(inputs=[in0Ave38728,in1Ave38728,in0Min69641,in1Min69641], outputs=Min29245)
w = model.get_layer('Den6614').get_weights() 
w[0] = np.array([[0.6364, 0.6805]])
w[1] = np.array([0.4911, 0.6174])
model.get_layer('Den6614').set_weights(w) 
in0Ave38728 = tf.constant([[[[[0.3012], [0.5121]]]]])
in1Ave38728 = tf.constant([[[[[0.2253], [0.2405]]]]])
in0Min69641 = tf.constant([[[[[0.9351, 0.461]], [[0.8469, 0.3701]]], [[[0.2886, 0.5774]], [[0.647, 0.1758]]]]])
in1Min69641 = tf.constant([[[[[0.5005, 0.0215]], [[0.8258, 0.4505]]], [[[0.5141, 0.2554]], [[0.0501, 0.1212]]]]])
print (np.array2string(model.predict([in0Ave38728,in1Ave38728,in0Min69641,in1Min69641],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min29245.png')

LAve38728 = average_layer([[[[[[0.3012], [0.5121]]]]], [[[[[0.2253], [0.2405]]]]]], Ave38728), 
LDen6614 = dense_layer(Ave38728, [[0.6364, 0.6805]],[0.4911, 0.6174], Den6614), 
LRes60678 = reshape_layer(Den6614, [1, 1, 4], Res60678), 
LRes36967 = reshape_layer(Res60678, [1, 4], Res36967), 
LGlo26979 = global_max_pool1D_layer(Res36967, Glo26979), 
LRes88768 = reshape_layer(Glo26979, [4, 1], Res88768), 
LAve95316 = average_pooling1D_layer(Res88768, 1, Ave95316), 
LRes40721 = reshape_layer(Ave95316, [4, 1, 1], Res40721), 
LZer55817 = zero_padding2D_layer(Res40721, 0, 0, 4, 0, Zer55817), 
LMin69641 = minimum_layer([[[[[[0.9351, 0.461]], [[0.8469, 0.3701]]], [[[0.2886, 0.5774]], [[0.647, 0.1758]]]]], [[[[[0.5005, 0.0215]], [[0.8258, 0.4505]]], [[[0.5141, 0.2554]], [[0.0501, 0.1212]]]]]], Min69641), 
LRes69892 = reshape_layer(Min69641, [2, 2, 2], Res69892), 
LGlo11789 = global_average_pooling2D_layer(Res69892, Glo11789), 
LRes46943 = reshape_layer(Glo11789, [2, 1], Res46943), 
LRes8636 = reshape_layer(Res46943, [2, 1, 1], Res8636), 
LZer2860 = zero_padding2D_layer(Res8636, 1, 1, 1, 1, Zer2860), 
LMax12910 = max_pool2D_layer(Zer2860, 2, 1, Max12910), 
LZer35133 = zero_padding2D_layer(Max12910, 2, 0, 2, 0, Zer35133), 
LMin29245 = minimum_layer([Zer55817,Zer35133], Min29245), 
exec_layers([LAve38728,LDen6614,LRes60678,LRes36967,LGlo26979,LRes88768,LAve95316,LRes40721,LZer55817,LMin69641,LRes69892,LGlo11789,LRes46943,LRes8636,LZer2860,LMax12910,LZer35133,LMin29245],["Ave38728","Den6614","Res60678","Res36967","Glo26979","Res88768","Ave95316","Res40721","Zer55817","Min69641","Res69892","Glo11789","Res46943","Res8636","Zer2860","Max12910","Zer35133","Min29245"],Min29245,"Min29245")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]]]]

Actual:   [[[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]]]

Expected: [[[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]]]