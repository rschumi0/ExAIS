import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add69714 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Add69714 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Add69714 = keras.layers.Add(name = 'Add69714', )([in0Add69714,in1Add69714])
Res98310 = keras.layers.Reshape((2, 1, 1), name = 'Res98310', )(Add69714)
Res66170 = keras.layers.Reshape((2, 1), name = 'Res66170', )(Res98310)
Glo10097 = keras.layers.GlobalMaxPool1D(name = 'Glo10097', )(Res66170)
Res64159 = keras.layers.Reshape((1, 1), name = 'Res64159', )(Glo10097)
Res94044 = keras.layers.Reshape((1, 1, 1), name = 'Res94044', )(Res64159)
Max58652 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max58652', )(Res94044)
Res44858 = keras.layers.Reshape((1, 1), name = 'Res44858', )(Max58652)
Loc4024 = keras.layers.LocallyConnected1D(4, (1),strides=(7), name = 'Loc4024', )(Res44858)
model = tf.keras.models.Model(inputs=[in0Add69714,in1Add69714], outputs=Loc4024)
w = model.get_layer('Loc4024').get_weights() 
w[0] = np.array([[[0.1396, 0.0463, 0.6146, 0.327]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc4024').set_weights(w) 
in0Add69714 = tf.constant([[[[[0.4309]]], [[[0.7039]]]]])
in1Add69714 = tf.constant([[[[[0.3925]]], [[[0.8053]]]]])
print (np.array2string(model.predict([in0Add69714,in1Add69714],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc4024.png')

LAdd69714 = add_layer([[[[[[0.4309]]], [[[0.7039]]]]], [[[[[0.3925]]], [[[0.8053]]]]]], Add69714), 
LRes98310 = reshape_layer(Add69714, [2, 1, 1], Res98310), 
LRes66170 = reshape_layer(Res98310, [2, 1], Res66170), 
LGlo10097 = global_max_pool1D_layer(Res66170, Glo10097), 
LRes64159 = reshape_layer(Glo10097, [1, 1], Res64159), 
LRes94044 = reshape_layer(Res64159, [1, 1, 1], Res94044), 
LMax58652 = max_pool2D_layer(Res94044, 1, 1, Max58652), 
LRes44858 = reshape_layer(Max58652, [1, 1], Res44858), 
LLoc4024 = locally_connected1D_layer(Res44858, 1,[[[0.1396, 0.0463, 0.6146, 0.327]]],[[0, 0, 0, 0]], 7, Loc4024), 
exec_layers([LAdd69714,LRes98310,LRes66170,LGlo10097,LRes64159,LRes94044,LMax58652,LRes44858,LLoc4024],["Add69714","Res98310","Res66170","Glo10097","Res64159","Res94044","Max58652","Res44858","Loc4024"],Loc4024,"Loc4024")

Actual (Unparsed): [[[0.2106843, 0.0698760, 0.9275543, 0.4935084]]]

Expected (Unparsed): [[[0.21068431999999998,0.06987596,0.9275543199999999,0.49350839999999996]]]

Actual:   [[[0.2107, 0.0699, 0.9276, 0.4936]]]

Expected: [[[0.2107, 0.0699, 0.9276, 0.4936]]]