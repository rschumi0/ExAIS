import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min13954 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Min13954 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Min37783 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min37783 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con48660 = tf.keras.layers.Input(shape=([2, 2, 3]))

Min13954 = keras.layers.Minimum(name = 'Min13954', )([in0Min13954,in1Min13954])
Res84176 = keras.layers.Reshape((1, 1, 4), name = 'Res84176', )(Min13954)
Zer62586 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer62586', )(Res84176)
Min37783 = keras.layers.Minimum(name = 'Min37783', )([in0Min37783,in1Min37783])
Con48660 = keras.layers.Concatenate(axis=3, name = 'Con48660', )([Min37783,in0Con48660])
Sub10022 = keras.layers.Subtract(name = 'Sub10022', )([Zer62586,Con48660])
Res70505 = keras.layers.Reshape((2, 2, 4, 1), name = 'Res70505', )(Sub10022)
Con15166 = keras.layers.Conv3D(2, (2, 1, 2),strides=(8, 1, 5), padding='valid', dilation_rate=(1, 1, 1), name = 'Con15166', )(Res70505)
model = tf.keras.models.Model(inputs=[in0Min13954,in1Min13954,in0Min37783,in1Min37783,in0Con48660], outputs=Con15166)
w = model.get_layer('Con15166').get_weights() 
w[0] = np.array([[[[[0.8861, 0.374]], [[0.6428, 0.6993]]]], [[[[0.7764, 0.683]], [[0.5727, 0.4396]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con15166').set_weights(w) 
in0Min13954 = tf.constant([[[[[0.5852, 0.0332], [0.5876, 0.7826]]]]])
in1Min13954 = tf.constant([[[[[0.8268, 0.6754], [0.2095, 0.2213]]]]])
in0Min37783 = tf.constant([[[[0.8636], [0.0084]], [[0.825], [0.5758]]]])
in1Min37783 = tf.constant([[[[0.0114], [0.9813]], [[0.2664], [0.188]]]])
in0Con48660 = tf.constant([[[[0.0512, 0.6904, 0.444], [0.5863, 0.72, 0.6454]], [[0.0782, 0.5345, 0.9769], [0.9232, 0.2578, 0.8262]]]])
print (np.array2string(model.predict([in0Min13954,in1Min13954,in0Min37783,in1Min37783,in0Con48660],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con15166.png')

LMin13954 = minimum_layer([[[[[[0.5852, 0.0332], [0.5876, 0.7826]]]]], [[[[[0.8268, 0.6754], [0.2095, 0.2213]]]]]], Min13954), 
LRes84176 = reshape_layer(Min13954, [1, 1, 4], Res84176), 
LZer62586 = zero_padding2D_layer(Res84176, 1, 0, 1, 0, Zer62586), 
LMin37783 = minimum_layer([[[[[0.8636], [0.0084]], [[0.825], [0.5758]]]], [[[[0.0114], [0.9813]], [[0.2664], [0.188]]]]], Min37783), 
LCon48660 = concatenate_layer([Min37783,[[[[0.0512, 0.6904, 0.444], [0.5863, 0.72, 0.6454]], [[0.0782, 0.5345, 0.9769], [0.9232, 0.2578, 0.8262]]]]], 3, Con48660), 
LSub10022 = subtract_layer(Zer62586,Con48660, Sub10022), 
LRes70505 = reshape_layer(Sub10022, [2, 2, 4, 1], Res70505), 
LCon15166 = conv3D_layer(Res70505, 2, 1, 2,[[[[[0.8861, 0.374]], [[0.6428, 0.6993]]]], [[[[0.7764, 0.683]], [[0.5727, 0.4396]]]]],[0, 0], 8, 1, 5, false, 1, 1, 1, Con15166), 
exec_layers([LMin13954,LRes84176,LZer62586,LMin37783,LCon48660,LSub10022,LRes70505,LCon15166],["Min13954","Res84176","Zer62586","Min37783","Con48660","Sub10022","Res70505","Con15166"],Con15166,"Con15166")

Actual (Unparsed): [[[[[-0.2946310, -0.2563957]], [[-0.5856338, -0.5330976]]]]]

Expected (Unparsed): [[[[[-0.294631,-0.25639568]],[[-0.5856338000000001,-0.5330975899999999]]]]]

Actual:   [[[[[-0.2946, -0.2563]], [[-0.5856, -0.533]]]]]

Expected: [[[[[-0.2946, -0.2563]], [[-0.5856, -0.533]]]]]