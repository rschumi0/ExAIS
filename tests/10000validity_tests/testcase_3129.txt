import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave24538 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Ave24538 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Ave19839 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave19839 = tf.keras.layers.Input(shape=([1, 2, 2]))

Ave24538 = keras.layers.Average(name = 'Ave24538', )([in0Ave24538,in1Ave24538])
Res61296 = keras.layers.Reshape((1, 2, 2), name = 'Res61296', )(Ave24538)
Ave19839 = keras.layers.Average(name = 'Ave19839', )([in0Ave19839,in1Ave19839])
Sub50982 = keras.layers.Subtract(name = 'Sub50982', )([Res61296,Ave19839])
model = tf.keras.models.Model(inputs=[in0Ave24538,in1Ave24538,in0Ave19839,in1Ave19839], outputs=Sub50982)
in0Ave24538 = tf.constant([[[[[0.328], [0.5905]], [[0.528], [0.8183]]]]])
in1Ave24538 = tf.constant([[[[[0.1248], [0.8516]], [[0.6357], [0.7445]]]]])
in0Ave19839 = tf.constant([[[[0.4441, 0.9261], [0.1392, 0.7509]]]])
in1Ave19839 = tf.constant([[[[0.574, 0.2022], [0.9814, 0.2259]]]])
print (np.array2string(model.predict([in0Ave24538,in1Ave24538,in0Ave19839,in1Ave19839],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub50982.png')

LAve24538 = average_layer([[[[[[0.328], [0.5905]], [[0.528], [0.8183]]]]], [[[[[0.1248], [0.8516]], [[0.6357], [0.7445]]]]]], Ave24538), 
LRes61296 = reshape_layer(Ave24538, [1, 2, 2], Res61296), 
LAve19839 = average_layer([[[[[0.4441, 0.9261], [0.1392, 0.7509]]]], [[[[0.574, 0.2022], [0.9814, 0.2259]]]]], Ave19839), 
LSub50982 = subtract_layer(Res61296,Ave19839, Sub50982), 
exec_layers([LAve24538,LRes61296,LAve19839,LSub50982],["Ave24538","Res61296","Ave19839","Sub50982"],Sub50982,"Sub50982")

Actual (Unparsed): [[[[-0.2826500, 0.1569000], [0.0215500, 0.2930000]]]]

Expected (Unparsed): [[[[-0.28265,0.15689999999999993],[0.021549999999999958,0.2930000000000001]]]]

Actual:   [[[[-0.2826, 0.1569], [0.0216, 0.293]]]]

Expected: [[[[-0.2826, 0.1569], [0.0216, 0.2931]]]]