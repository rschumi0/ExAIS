import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave88247 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave88247 = tf.keras.layers.Input(shape=([2, 2, 2]))

Ave88247 = keras.layers.Average(name = 'Ave88247', )([in0Ave88247,in1Ave88247])
Res83101 = keras.layers.Reshape((2, 4), name = 'Res83101', )(Ave88247)
Res51063 = keras.layers.Reshape((2, 4, 1), name = 'Res51063', )(Res83101)
Glo17058 = keras.layers.GlobalAveragePooling2D(name = 'Glo17058', )(Res51063)
model = tf.keras.models.Model(inputs=[in0Ave88247,in1Ave88247], outputs=Glo17058)
in0Ave88247 = tf.constant([[[[0.1815, 0.8192], [0.3139, 0.6257]], [[0.4238, 0.8827], [0.7468, 0.1603]]]])
in1Ave88247 = tf.constant([[[[0.3345, 0.7457], [0.352, 0.6435]], [[0.4859, 0.3918], [0.3411, 0.2258]]]])
print (np.array2string(model.predict([in0Ave88247,in1Ave88247],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo17058.png')

LAve88247 = average_layer([[[[[0.1815, 0.8192], [0.3139, 0.6257]], [[0.4238, 0.8827], [0.7468, 0.1603]]]], [[[[0.3345, 0.7457], [0.352, 0.6435]], [[0.4859, 0.3918], [0.3411, 0.2258]]]]], Ave88247), 
LRes83101 = reshape_layer(Ave88247, [2, 4], Res83101), 
LRes51063 = reshape_layer(Res83101, [2, 4, 1], Res51063), 
LGlo17058 = global_average_pooling2D_layer(Res51063, Glo17058), 
exec_layers([LAve88247,LRes83101,LRes51063,LGlo17058],["Ave88247","Res83101","Res51063","Glo17058"],Glo17058,"Glo17058")

Actual (Unparsed): [[0.4796375]]

Expected (Unparsed): [[0.4796375]]

Actual:   [[0.4797]]

Expected: [[0.4797]]