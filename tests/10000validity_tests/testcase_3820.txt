import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min51084 = tf.keras.layers.Input(shape=([1, 2]))
in1Min51084 = tf.keras.layers.Input(shape=([1, 2]))
in0Max67284 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max67284 = tf.keras.layers.Input(shape=([2, 2, 1]))

Min51084 = keras.layers.Minimum(name = 'Min51084', )([in0Min51084,in1Min51084])
Sof5972 = keras.layers.Softmax(axis=1, name = 'Sof5972', )(Min51084)
Zer84236 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer84236', )(Sof5972)
Max67284 = keras.layers.Maximum(name = 'Max67284', )([in0Max67284,in1Max67284])
Res92780 = keras.layers.Reshape((2, 2), name = 'Res92780', )(Max67284)
Sep47254 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep47254', )(Res92780)
Ave10268 = keras.layers.Average(name = 'Ave10268', )([Zer84236,Sep47254])
model = tf.keras.models.Model(inputs=[in0Min51084,in1Min51084,in0Max67284,in1Max67284], outputs=Ave10268)
w = model.get_layer('Sep47254').get_weights() 
w[0] = np.array([[[0.4684], [0.3536]]])
w[1] = np.array([[[0.5993, 0.334], [0.0066, 0.3219]]])
w[2] = np.array([0, 0])
model.get_layer('Sep47254').set_weights(w) 
in0Min51084 = tf.constant([[[0.6822, 0.1876]]])
in1Min51084 = tf.constant([[[0.216, 0.6384]]])
in0Max67284 = tf.constant([[[[0.2977], [0.8293]], [[0.6109], [0.4425]]]])
in1Max67284 = tf.constant([[[[0.8494], [0.1031]], [[0.7759], [0.283]]]])
print (np.array2string(model.predict([in0Min51084,in1Min51084,in0Max67284,in1Max67284],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave10268.png')

LMin51084 = minimum_layer([[[[0.6822, 0.1876]]], [[[0.216, 0.6384]]]], Min51084), 
LSof5972 = softmax_layer(Min51084, 1, Sof5972), 
LZer84236 = zero_padding1D_layer(Sof5972, 1, 0, Zer84236), 
LMax67284 = maximum_layer([[[[[0.2977], [0.8293]], [[0.6109], [0.4425]]]], [[[[0.8494], [0.1031]], [[0.7759], [0.283]]]]], Max67284), 
LRes92780 = reshape_layer(Max67284, [2, 2], Res92780), 
LSep47254 = separable_conv1D_layer(Res92780, 1,[[[[0.4684], [0.3536]]],[[[0.5993, 0.334], [0.0066, 0.3219]]]],[0, 0], 1, true, Sep47254), 
LAve10268 = average_layer([Zer84236,Sep47254], Ave10268), 
exec_layers([LMin51084,LSof5972,LZer84236,LMax67284,LRes92780,LSep47254,LAve10268],["Min51084","Sof5972","Zer84236","Max67284","Res92780","Sep47254","Ave10268"],Ave10268,"Ave10268")

Actual (Unparsed): [[[0.1201861, 0.1136395], [0.6094186, 0.5858766]]]

Expected (Unparsed): [[[0.12018613094800001,0.113639501576],[0.609418611354,0.58587659512]]]

Actual:   [[[0.1202, 0.1137], [0.6095, 0.5859]]]

Expected: [[[0.1202, 0.1137], [0.6095, 0.5859]]]