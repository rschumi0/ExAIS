import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave30382 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Ave30382 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Ave30382 = keras.layers.Average(name = 'Ave30382', )([in0Ave30382,in1Ave30382])
Sof97275 = keras.layers.Softmax(axis=1, name = 'Sof97275', )(Ave30382)
Glo88288 = keras.layers.GlobalAveragePooling3D(name = 'Glo88288', )(Sof97275)
Res85379 = keras.layers.Reshape((1, 1), name = 'Res85379', )(Glo88288)
Res32838 = keras.layers.Reshape((1, 1, 1), name = 'Res32838', )(Res85379)
Ave63469 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave63469', )(Res32838)
model = tf.keras.models.Model(inputs=[in0Ave30382,in1Ave30382], outputs=Ave63469)
in0Ave30382 = tf.constant([[[[[0.3021], [0.9507]], [[0.4503], [0.6941]]]]])
in1Ave30382 = tf.constant([[[[[0.6201], [0.5485]], [[0.6977], [0.1335]]]]])
print (np.array2string(model.predict([in0Ave30382,in1Ave30382],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave63469.png')

LAve30382 = average_layer([[[[[[0.3021], [0.9507]], [[0.4503], [0.6941]]]]], [[[[[0.6201], [0.5485]], [[0.6977], [0.1335]]]]]], Ave30382), 
LSof97275 = softmax_layer(Ave30382, 1, Sof97275), 
LGlo88288 = global_average_pooling3D_layer(Sof97275, Glo88288), 
LRes85379 = reshape_layer(Glo88288, [1, 1], Res85379), 
LRes32838 = reshape_layer(Res85379, [1, 1, 1], Res32838), 
LAve63469 = average_pooling2D_layer(Res32838, 1, 1, Ave63469), 
exec_layers([LAve30382,LSof97275,LGlo88288,LRes85379,LRes32838,LAve63469],["Ave30382","Sof97275","Glo88288","Res85379","Res32838","Ave63469"],Ave63469,"Ave63469")

Actual (Unparsed): [[[[1.0000000]]]]

Expected (Unparsed): [[[[1.0]]]]

Actual:   [[[[1]]]]

Expected: [[[[1]]]]