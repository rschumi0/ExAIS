import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave99813 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Ave99813 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Mul5698 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul5698 = tf.keras.layers.Input(shape=([2, 1, 2]))

Ave99813 = keras.layers.Average(name = 'Ave99813', )([in0Ave99813,in1Ave99813])
Up_84659 = keras.layers.UpSampling3D(size=(1, 1, 1), name = 'Up_84659', )(Ave99813)
Res14497 = keras.layers.Reshape((2, 1, 2), name = 'Res14497', )(Up_84659)
Mul5698 = keras.layers.Multiply(name = 'Mul5698', )([in0Mul5698,in1Mul5698])
Max31480 = keras.layers.Maximum(name = 'Max31480', )([Res14497,Mul5698])
model = tf.keras.models.Model(inputs=[in0Ave99813,in1Ave99813,in0Mul5698,in1Mul5698], outputs=Max31480)
in0Ave99813 = tf.constant([[[[[0.6816], [0.804]]], [[[0.6666], [0.3085]]]]])
in1Ave99813 = tf.constant([[[[[0.1891], [0.4327]]], [[[0.596], [0.0476]]]]])
in0Mul5698 = tf.constant([[[[0.0961, 0.4494]], [[0.6277, 0.4358]]]])
in1Mul5698 = tf.constant([[[[0.6712, 0.8242]], [[0.7664, 0.2897]]]])
print (np.array2string(model.predict([in0Ave99813,in1Ave99813,in0Mul5698,in1Mul5698],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max31480.png')

LAve99813 = average_layer([[[[[[0.6816], [0.804]]], [[[0.6666], [0.3085]]]]], [[[[[0.1891], [0.4327]]], [[[0.596], [0.0476]]]]]], Ave99813), 
LUp_84659 = up_sampling3D_layer(Ave99813, 1, 1, 1, Up_84659), 
LRes14497 = reshape_layer(Up_84659, [2, 1, 2], Res14497), 
LMul5698 = multiply_layer([[[[[0.0961, 0.4494]], [[0.6277, 0.4358]]]], [[[[0.6712, 0.8242]], [[0.7664, 0.2897]]]]], Mul5698), 
LMax31480 = maximum_layer([Res14497,Mul5698], Max31480), 
exec_layers([LAve99813,LUp_84659,LRes14497,LMul5698,LMax31480],["Ave99813","Up_84659","Res14497","Mul5698","Max31480"],Max31480,"Max31480")

Actual (Unparsed): [[[[0.4353500, 0.6183500]], [[0.6313000, 0.1780500]]]]

Expected (Unparsed): [[[[0.43535,0.61835]],[[0.6313,0.17804999999999999]]]]

Actual:   [[[[0.4354, 0.6184]], [[0.6313, 0.1781]]]]

Expected: [[[[0.4354, 0.6184]], [[0.6313, 0.1781]]]]