import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc70258 = tf.keras.layers.Input(shape=([1, 1, 2]))

Loc70258 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc70258', )(in0Loc70258)
Res39045 = keras.layers.Reshape((1, 3), name = 'Res39045', )(Loc70258)
Fla58625 = keras.layers.Flatten(name = 'Fla58625', )(Res39045)
Lea80684 = keras.layers.LeakyReLU(alpha=1.0024031272040719, name = 'Lea80684', )(Fla58625)
Res61771 = keras.layers.Reshape((3, 1), name = 'Res61771', )(Lea80684)
Sim51046 = keras.layers.SimpleRNN(1,name = 'Sim51046', )(Res61771)
model = tf.keras.models.Model(inputs=[in0Loc70258], outputs=Sim51046)
w = model.get_layer('Loc70258').get_weights() 
w[0] = np.array([[[0.4058, 0.2631, 0.2995], [0.8593, 0.4091, 0.2474]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc70258').set_weights(w) 
w = model.get_layer('Sim51046').get_weights() 
w[0] = np.array([[9]])
w[1] = np.array([[3]])
w[2] = np.array([9])
model.get_layer('Sim51046').set_weights(w) 
in0Loc70258 = tf.constant([[[[0.2483, 0.1241]]]])
print (np.array2string(model.predict([in0Loc70258],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim51046.png')

LLoc70258 = locally_connected2D_layer([[[[0.2483, 0.1241]]]], 1, 1,[[[0.4058, 0.2631, 0.2995], [0.8593, 0.4091, 0.2474]]],[[[0, 0, 0]]], 1, 1, Loc70258), 
LRes39045 = reshape_layer(Loc70258, [1, 3], Res39045), 
LFla58625 = flatten_layer(Res39045, Fla58625), 
LLea80684 = leaky_relu_layer(Fla58625, 1.0024031272040719, Lea80684), 
LRes61771 = reshape_layer(Lea80684, [3, 1], Res61771), 
LSim51046 = simple_rnn_layer(Res61771,[[9]],[[3]],[9], Sim51046), 
exec_layers([LLoc70258,LRes39045,LFla58625,LLea80684,LRes61771,LSim51046],["Loc70258","Res39045","Fla58625","Lea80684","Res61771","Sim51046"],Sim51046,"Sim51046")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[0.9999999999886077]]

Actual:   [[1]]

Expected: [[1]]