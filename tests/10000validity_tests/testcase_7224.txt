import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot23340 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot23340 = tf.keras.layers.Input(shape=([2, 2]))

Dot23340 = keras.layers.Dot(axes=(2, 2), name = 'Dot23340', )([in0Dot23340,in1Dot23340])
Cro41916 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro41916', )(Dot23340)
Res50495 = keras.layers.Reshape((1, 2, 1), name = 'Res50495', )(Cro41916)
Res35581 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res35581', )(Res50495)
Glo34382 = keras.layers.GlobalMaxPool3D(name = 'Glo34382', )(Res35581)
model = tf.keras.models.Model(inputs=[in0Dot23340,in1Dot23340], outputs=Glo34382)
in0Dot23340 = tf.constant([[[0.347, 0.9346], [0.6875, 0.5718]]])
in1Dot23340 = tf.constant([[[0.9963, 0.9826], [0.2333, 0.9027]]])
print (np.array2string(model.predict([in0Dot23340,in1Dot23340],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo34382.png')

LDot23340 = dot_layer([[[0.347, 0.9346], [0.6875, 0.5718]]], [[[0.9963, 0.9826], [0.2333, 0.9027]]], 2, 2, Dot23340), 
LCro41916 = cropping1D_layer(Dot23340, 1, 0, Cro41916), 
LRes50495 = reshape_layer(Cro41916, [1, 2, 1], Res50495), 
LRes35581 = reshape_layer(Res50495, [1, 2, 1, 1], Res35581), 
LGlo34382 = global_max_pool3D_layer(Res35581, Glo34382), 
exec_layers([LDot23340,LCro41916,LRes50495,LRes35581,LGlo34382],["Dot23340","Cro41916","Res50495","Res35581","Glo34382"],Glo34382,"Glo34382")

Actual (Unparsed): [[1.2468069]]

Expected (Unparsed): [[1.24680693]]

Actual:   [[1.2469]]

Expected: [[1.2469]]