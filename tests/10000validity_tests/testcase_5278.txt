import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep77189 = tf.keras.layers.Input(shape=([2, 1, 2]))

Sep77189 = keras.layers.SeparableConv2D(3, (2, 1),strides=(2, 2), padding='same', name = 'Sep77189', )(in0Sep77189)
Res38824 = keras.layers.Reshape((1, 3), name = 'Res38824', )(Sep77189)
Sep41047 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='same', name = 'Sep41047', )(Res38824)
Thr2641 = keras.layers.ThresholdedReLU(theta=7.26275443496111, name = 'Thr2641', )(Sep41047)
model = tf.keras.models.Model(inputs=[in0Sep77189], outputs=Thr2641)
w = model.get_layer('Sep77189').get_weights() 
w[0] = np.array([[[[0.0422], [0.7749]]], [[[0.8484], [0.5522]]]])
w[1] = np.array([[[[0.5173, 0.0728, 0.2186], [0.4143, 0.6458, 0.7735]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep77189').set_weights(w) 
w = model.get_layer('Sep41047').get_weights() 
w[0] = np.array([[[0.2619], [0.8191], [0.1279]]])
w[1] = np.array([[[0.7873, 0.8091, 0.5826], [0.2827, 0.0541, 0.0424], [0.0313, 0.0624, 0.7458]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep41047').set_weights(w) 
in0Sep77189 = tf.constant([[[[0.8556, 0.4632]], [[0.2554, 0.5405]]]])
print (np.array2string(model.predict([in0Sep77189],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr2641.png')

LSep77189 = separable_conv2D_layer([[[[0.8556, 0.4632]], [[0.2554, 0.5405]]]], 2, 1,[[[[[0.0422], [0.7749]]], [[[0.8484], [0.5522]]]],[[[[0.5173, 0.0728, 0.2186], [0.4143, 0.6458, 0.7735]]]]],[0, 0, 0], 2, 2, true, Sep77189), 
LRes38824 = reshape_layer(Sep77189, [1, 3], Res38824), 
LSep41047 = separable_conv1D_layer(Res38824, 1,[[[[0.2619], [0.8191], [0.1279]]],[[[0.7873, 0.8091, 0.5826], [0.2827, 0.0541, 0.0424], [0.0313, 0.0624, 0.7458]]]],[0, 0, 0], 1, true, Sep41047), 
LThr2641 = thresholded_relu_layer(Sep41047, 7.26275443496111, Thr2641), 
exec_layers([LSep77189,LRes38824,LSep41047,LThr2641],["Sep77189","Res38824","Sep41047","Thr2641"],Thr2641,"Thr2641")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0]]]

Actual:   [[[0, 0, 0]]]

Expected: [[[0, 0, 0]]]