import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max77199 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Max77199 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Max77199 = keras.layers.Maximum(name = 'Max77199', )([in0Max77199,in1Max77199])
Res61358 = keras.layers.Reshape((1, 2, 2), name = 'Res61358', )(Max77199)
Res46564 = keras.layers.Reshape((1, 4), name = 'Res46564', )(Res61358)
Ave80800 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='valid', name = 'Ave80800', )(Res46564)
Con98123 = keras.layers.Conv1D(3, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con98123', )(Ave80800)
model = tf.keras.models.Model(inputs=[in0Max77199,in1Max77199], outputs=Con98123)
w = model.get_layer('Con98123').get_weights() 
w[0] = np.array([[[0.9988, 0.4532, 0.9821], [0.5212, 0.8019, 0.776], [0.8007, 0.7365, 0.3087], [0.1533, 0.0552, 0.3075]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con98123').set_weights(w) 
in0Max77199 = tf.constant([[[[[0.5166, 0.233]], [[0.3153, 0.3552]]]]])
in1Max77199 = tf.constant([[[[[0.1382, 0.3255]], [[0.7729, 0.6439]]]]])
print (np.array2string(model.predict([in0Max77199,in1Max77199],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con98123.png')

LMax77199 = maximum_layer([[[[[[0.5166, 0.233]], [[0.3153, 0.3552]]]]], [[[[[0.1382, 0.3255]], [[0.7729, 0.6439]]]]]], Max77199), 
LRes61358 = reshape_layer(Max77199, [1, 2, 2], Res61358), 
LRes46564 = reshape_layer(Res61358, [1, 4], Res46564), 
LAve80800 = average_pooling1D_layer(Res46564, 1, 1, false, Ave80800), 
LCon98123 = conv1D_layer(Ave80800, 1,[[[0.9988, 0.4532, 0.9821], [0.5212, 0.8019, 0.776], [0.8007, 0.7365, 0.3087], [0.1533, 0.0552, 0.3075]]],[0, 0, 0], 1, false, 1, Con98123), 
exec_layers([LMax77199,LRes61358,LRes46564,LAve80800,LCon98123],["Max77199","Res61358","Res46564","Ave80800","Con98123"],Con98123,"Con98123")

Actual (Unparsed): [[[1.4032016, 1.0999257, 1.1965343]]]

Expected (Unparsed): [[[1.40320158,1.0999257,1.19653434]]]

Actual:   [[[1.4033, 1.1, 1.1966]]]

Expected: [[[1.4033, 1.1, 1.1966]]]