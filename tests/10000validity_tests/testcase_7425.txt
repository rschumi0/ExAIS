import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro55366 = tf.keras.layers.Input(shape=([3, 4]))
in0Dot91755 = tf.keras.layers.Input(shape=([2]))
in1Dot91755 = tf.keras.layers.Input(shape=([2]))
in0Con92238 = tf.keras.layers.Input(shape=([1]))

Cro55366 = keras.layers.Cropping1D(cropping=((2, 0)), name = 'Cro55366', )(in0Cro55366)
Con93066 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con93066', )(Cro55366)
Fla25981 = keras.layers.Flatten(name = 'Fla25981', )(Con93066)
Dot91755 = keras.layers.Dot(axes=(1, 1), name = 'Dot91755', )([in0Dot91755,in1Dot91755])
Con92238 = keras.layers.Concatenate(axis=1, name = 'Con92238', )([Dot91755,in0Con92238])
Add76998 = keras.layers.Add(name = 'Add76998', )([Fla25981,Con92238])
Res84946 = keras.layers.Reshape((2, 1), name = 'Res84946', )(Add76998)
Res16873 = keras.layers.Reshape((2, 1, 1), name = 'Res16873', )(Res84946)
Max33728 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 3), padding='same', name = 'Max33728', )(Res16873)
model = tf.keras.models.Model(inputs=[in0Cro55366,in0Dot91755,in1Dot91755,in0Con92238], outputs=Max33728)
w = model.get_layer('Con93066').get_weights() 
w[0] = np.array([[[0.5517, 0.1519], [0.6588, 0.5046], [0.3333, 0.4231], [0.6892, 0.3831]]])
w[1] = np.array([0, 0])
model.get_layer('Con93066').set_weights(w) 
in0Cro55366 = tf.constant([[[1.3093, 1.5515, 1.1367, 1.6477], [1.36, 1.8521, 1.6814, 1.6741], [1.8312, 1.8861, 1.0291, 1.8383]]])
in0Dot91755 = tf.constant([[0.435, 0.4062]])
in1Dot91755 = tf.constant([[0.856, 0.9052]])
in0Con92238 = tf.constant([[0.9154]])
print (np.array2string(model.predict([in0Cro55366,in0Dot91755,in1Dot91755,in0Con92238],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max33728.png')

LCro55366 = cropping1D_layer([[[1.3093, 1.5515, 1.1367, 1.6477], [1.36, 1.8521, 1.6814, 1.6741], [1.8312, 1.8861, 1.0291, 1.8383]]], 2, 0, Cro55366), 
LCon93066 = conv1D_layer(Cro55366, 1,[[[0.5517, 0.1519], [0.6588, 0.5046], [0.3333, 0.4231], [0.6892, 0.3831]]],[0, 0], 1, true, 1, Con93066), 
LFla25981 = flatten_layer(Con93066, Fla25981), 
LDot91755 = dot_layer([[0.435, 0.4062]], [[0.856, 0.9052]], 1, 1, Dot91755), 
LCon92238 = concatenate_layer([Dot91755,[[0.9154]]], 1, Con92238), 
LAdd76998 = add_layer([Fla25981,Con92238], Add76998), 
LRes84946 = reshape_layer(Add76998, [2, 1], Res84946), 
LRes16873 = reshape_layer(Res84946, [2, 1, 1], Res16873), 
LMax33728 = max_pool2D_layer(Res16873, 1, 1, 1, 3, true, Max33728), 
exec_layers([LCro55366,LCon93066,LFla25981,LDot91755,LCon92238,LAdd76998,LRes84946,LRes16873,LMax33728],["Cro55366","Con93066","Fla25981","Dot91755","Con92238","Add76998","Res84946","Res16873","Max33728"],Max33728,"Max33728")

Actual (Unparsed): [[[[4.6028434]], [[3.2849503]]]]

Expected (Unparsed): [[[[4.6028433500000006]],[[3.28495028]]]]

Actual:   [[[[4.6029]], [[3.285]]]]

Expected: [[[[4.6029]], [[3.285]]]]