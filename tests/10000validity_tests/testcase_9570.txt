import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave33326 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave33326 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con760 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot68720 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot68720 = tf.keras.layers.Input(shape=([3, 2]))

Ave33326 = keras.layers.Average(name = 'Ave33326', )([in0Ave33326,in1Ave33326])
Res75452 = keras.layers.Reshape((2, 1), name = 'Res75452', )(Ave33326)
Con760 = keras.layers.Concatenate(axis=2, name = 'Con760', )([Res75452,in0Con760])
Dot68720 = keras.layers.Dot(axes=(1, 1), name = 'Dot68720', )([in0Dot68720,in1Dot68720])
Max29380 = keras.layers.Maximum(name = 'Max29380', )([Con760,Dot68720])
model = tf.keras.models.Model(inputs=[in0Ave33326,in1Ave33326,in0Con760,in0Dot68720,in1Dot68720], outputs=Max29380)
in0Ave33326 = tf.constant([[[[0.8357]], [[0.8891]]]])
in1Ave33326 = tf.constant([[[[0.3884]], [[0.4096]]]])
in0Con760 = tf.constant([[[0.2231], [0.2185]]])
in0Dot68720 = tf.constant([[[0.6544, 0.0191], [0.1099, 0.0756], [0.7361, 0.9428]]])
in1Dot68720 = tf.constant([[[0.6899, 0.8678], [0.5103, 0.8515], [0.5489, 0.2843]]])
print (np.array2string(model.predict([in0Ave33326,in1Ave33326,in0Con760,in0Dot68720,in1Dot68720],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max29380.png')

LAve33326 = average_layer([[[[[0.8357]], [[0.8891]]]], [[[[0.3884]], [[0.4096]]]]], Ave33326), 
LRes75452 = reshape_layer(Ave33326, [2, 1], Res75452), 
LCon760 = concatenate_layer([Res75452,[[[0.2231], [0.2185]]]], 2, Con760), 
LDot68720 = dot_layer([[[0.6544, 0.0191], [0.1099, 0.0756], [0.7361, 0.9428]]], [[[0.6899, 0.8678], [0.5103, 0.8515], [0.5489, 0.2843]]], 1, 1, Dot68720), 
LMax29380 = maximum_layer([Con760,Dot68720], Max29380), 
exec_layers([LAve33326,LRes75452,LCon760,LDot68720,LMax29380],["Ave33326","Res75452","Con760","Dot68720","Max29380"],Max29380,"Max29380")

Actual (Unparsed): [[[0.9115978, 0.8707414], [0.6493500, 0.3489864]]]

Expected (Unparsed): [[[0.91159782,0.8707414],[0.64935,0.34898641999999996]]]

Actual:   [[[0.9116, 0.8708], [0.6494, 0.349]]]

Expected: [[[0.9116, 0.8708], [0.6494, 0.349]]]