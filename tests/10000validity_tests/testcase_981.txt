import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max85323 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max85323 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max85323 = keras.layers.Maximum(name = 'Max85323', )([in0Max85323,in1Max85323])
Con11878 = keras.layers.Conv2D(4, (2, 1),strides=(3, 1), padding='valid', dilation_rate=(1, 1), name = 'Con11878', )(Max85323)
model = tf.keras.models.Model(inputs=[in0Max85323,in1Max85323], outputs=Con11878)
w = model.get_layer('Con11878').get_weights() 
w[0] = np.array([[[[0.5257, 0.7254, 0.2133, 0.8714]]], [[[0.4158, 0.1977, 0.6639, 0.6979]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con11878').set_weights(w) 
in0Max85323 = tf.constant([[[[0.6477]], [[0.3739]]]])
in1Max85323 = tf.constant([[[[0.9812]], [[0.5077]]]])
print (np.array2string(model.predict([in0Max85323,in1Max85323],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con11878.png')

LMax85323 = maximum_layer([[[[[0.6477]], [[0.3739]]]], [[[[0.9812]], [[0.5077]]]]], Max85323), 
LCon11878 = conv2D_layer(Max85323, 2, 1,[[[[0.5257, 0.7254, 0.2133, 0.8714]]], [[[0.4158, 0.1977, 0.6639, 0.6979]]]],[0, 0, 0, 0], 3, 1, false, 1, 1, Con11878), 
exec_layers([LMax85323,LCon11878],["Max85323","Con11878"],Con11878,"Con11878")

Actual (Unparsed): [[[[0.7269185, 0.8121348, 0.5463520, 1.2093415]]]]

Expected (Unparsed): [[[[0.7269185,0.81213477,0.54635199,1.2093415099999998]]]]

Actual:   [[[[0.727, 0.8122, 0.5464, 1.2094]]]]

Expected: [[[[0.727, 0.8122, 0.5464, 1.2094]]]]