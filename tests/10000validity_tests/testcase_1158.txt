import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub93798 = tf.keras.layers.Input(shape=([2]))
in1Sub93798 = tf.keras.layers.Input(shape=([2]))
in0Lay93569 = tf.keras.layers.Input(shape=([3]))
in0Con54552 = tf.keras.layers.Input(shape=([1]))

Sub93798 = keras.layers.Subtract(name = 'Sub93798', )([in0Sub93798,in1Sub93798])
Res99775 = keras.layers.Reshape((2, 1), name = 'Res99775', )(Sub93798)
Zer47560 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer47560', )(Res99775)
Fla88921 = keras.layers.Flatten(name = 'Fla88921', )(Zer47560)
Lay93569 = keras.layers.LayerNormalization(axis=1, epsilon=2.869610964067291, name = 'Lay93569', )(in0Lay93569)
Con54552 = keras.layers.Concatenate(axis=1, name = 'Con54552', )([Lay93569,in0Con54552])
Add17877 = keras.layers.Add(name = 'Add17877', )([Fla88921,Con54552])
Res81126 = keras.layers.Reshape((4, 1), name = 'Res81126', )(Add17877)
Res20149 = keras.layers.Reshape((4, 1, 1), name = 'Res20149', )(Res81126)
Loc99847 = keras.layers.LocallyConnected2D(3, (2, 1),strides=(1, 1), name = 'Loc99847', )(Res20149)
model = tf.keras.models.Model(inputs=[in0Sub93798,in1Sub93798,in0Lay93569,in0Con54552], outputs=Loc99847)
w = model.get_layer('Loc99847').get_weights() 
w[0] = np.array([[[0.7912, 0.1576, 0.4842], [0.1046, 0.6289, 0.0003]], [[0.1984, 0.5554, 0.5321], [0.8924, 0.9819, 0.3973]], [[0.9753, 0.6315, 0.1846], [0.8967, 0.6071, 0.3859]]])
w[1] = np.array([[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]])
model.get_layer('Loc99847').set_weights(w) 
in0Sub93798 = tf.constant([[0.7011, 0.3727]])
in1Sub93798 = tf.constant([[0.2899, 0.1922]])
in0Lay93569 = tf.constant([[1.1732, 1.2545, 1.7776]])
in0Con54552 = tf.constant([[0.2348]])
print (np.array2string(model.predict([in0Sub93798,in1Sub93798,in0Lay93569,in0Con54552],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc99847.png')

LSub93798 = subtract_layer([[0.7011, 0.3727]], [[0.2899, 0.1922]], Sub93798), 
LRes99775 = reshape_layer(Sub93798, [2, 1], Res99775), 
LZer47560 = zero_padding1D_layer(Res99775, 1, 1, Zer47560), 
LFla88921 = flatten_layer(Zer47560, Fla88921), 
LLay93569 = layer_normalization_layer([[1.1732, 1.2545, 1.7776]], 1, 2.869610964067291, Lay93569), 
LCon54552 = concatenate_layer([Lay93569,[[0.2348]]], 1, Con54552), 
LAdd17877 = add_layer([Fla88921,Con54552], Add17877), 
LRes81126 = reshape_layer(Add17877, [4, 1], Res81126), 
LRes20149 = reshape_layer(Res81126, [4, 1, 1], Res20149), 
LLoc99847 = locally_connected2D_layer(Res20149, 2, 1,[[[0.7912, 0.1576, 0.4842], [0.1046, 0.6289, 0.0003]], [[0.1984, 0.5554, 0.5321], [0.8924, 0.9819, 0.3973]], [[0.9753, 0.6315, 0.1846], [0.8967, 0.6071, 0.3859]]],[[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]], 1, 1, Loc99847), 
exec_layers([LSub93798,LRes99775,LZer47560,LFla88921,LLay93569,LCon54552,LAdd17877,LRes81126,LRes20149,LLoc99847],["Sub93798","Res99775","Zer47560","Fla88921","Lay93569","Con54552","Add17877","Res81126","Res20149","Loc99847"],Loc99847,"Loc99847")

Actual (Unparsed): [[[[-0.0714155, 0.1835975, -0.0644329]], [[0.4211851, 0.5730964, 0.3318863]], [[0.6003146, 0.3949201, 0.1643830]]]]

Expected (Unparsed): [[[[-0.07141546119144601,0.1835974736332553,-0.064432928411777]],[[0.4211851094242931,0.5730964208596174,0.33188629702499806]],[[0.600314631272062,0.39492011507465097,0.16438297364177445]]]]

Actual:   [[[[-0.0714, 0.1836, -0.0644]], [[0.4212, 0.5731, 0.3319]], [[0.6004, 0.395, 0.1644]]]]

Expected: [[[[-0.0714, 0.1836, -0.0644]], [[0.4212, 0.5731, 0.3319]], [[0.6004, 0.395, 0.1644]]]]