import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub2669 = tf.keras.layers.Input(shape=([3]))
in1Sub2669 = tf.keras.layers.Input(shape=([3]))
in0Fla62168 = tf.keras.layers.Input(shape=([1, 4, 4]))

Sub2669 = keras.layers.Subtract(name = 'Sub2669', )([in0Sub2669,in1Sub2669])
Res76771 = keras.layers.Reshape((3, 1), name = 'Res76771', )(Sub2669)
Res23008 = keras.layers.Reshape((3, 1, 1), name = 'Res23008', )(Res76771)
Zer4796 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer4796', )(Res23008)
Fla62168 = keras.layers.Flatten(name = 'Fla62168', )(in0Fla62168)
ReL64386 = keras.layers.ReLU(max_value=3.811032803160418, negative_slope=3.62138406224079, threshold=5.134345569228211, name = 'ReL64386', )(Fla62168)
Res44159 = keras.layers.Reshape((16, 1), name = 'Res44159', )(ReL64386)
Res53641 = keras.layers.Reshape((16, 1, 1), name = 'Res53641', )(Res44159)
Cro21946 = keras.layers.Cropping2D(cropping=((0, 11), (0, 0)), name = 'Cro21946', )(Res53641)
Ave61371 = keras.layers.Average(name = 'Ave61371', )([Zer4796,Cro21946])
model = tf.keras.models.Model(inputs=[in0Sub2669,in1Sub2669,in0Fla62168], outputs=Ave61371)
in0Sub2669 = tf.constant([[0.2905, 0.8471, 0.1573]])
in1Sub2669 = tf.constant([[0.4351, 0.7741, 0.7106]])
in0Fla62168 = tf.constant([[[[1.263, 1.2465, 1.2556, 1.049], [1.8444, 1.8103, 1.3753, 1.9656], [1.252, 1.8398, 1.8552, 1.493], [1.5684, 1.6368, 1.0063, 1.7009]]]])
print (np.array2string(model.predict([in0Sub2669,in1Sub2669,in0Fla62168],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave61371.png')

LSub2669 = subtract_layer([[0.2905, 0.8471, 0.1573]], [[0.4351, 0.7741, 0.7106]], Sub2669), 
LRes76771 = reshape_layer(Sub2669, [3, 1], Res76771), 
LRes23008 = reshape_layer(Res76771, [3, 1, 1], Res23008), 
LZer4796 = zero_padding2D_layer(Res23008, 2, 0, 0, 0, Zer4796), 
LFla62168 = flatten_layer([[[[1.263, 1.2465, 1.2556, 1.049], [1.8444, 1.8103, 1.3753, 1.9656], [1.252, 1.8398, 1.8552, 1.493], [1.5684, 1.6368, 1.0063, 1.7009]]]], Fla62168), 
LReL64386 = relu_layer(Fla62168, 3.811032803160418, 3.62138406224079, 5.134345569228211, ReL64386), 
LRes44159 = reshape_layer(ReL64386, [16, 1], Res44159), 
LRes53641 = reshape_layer(Res44159, [16, 1, 1], Res53641), 
LCro21946 = cropping2D_layer(Res53641, 0, 11, 0, 0, Cro21946), 
LAve61371 = average_layer([Zer4796,Cro21946], Ave61371), 
exec_layers([LSub2669,LRes76771,LRes23008,LZer4796,LFla62168,LReL64386,LRes44159,LRes53641,LCro21946,LAve61371],["Sub2669","Res76771","Res23008","Zer4796","Fla62168","ReL64386","Res44159","Res53641","Cro21946","Ave61371"],Ave61371,"Ave61371")

Actual (Unparsed): [[[[-7.0098146]], [[-7.0396910]], [[-7.0955137]], [[-7.3608026]], [[-6.2337281]]]]

Expected (Unparsed): [[[[-7.009814571914772]],[[-7.039690990428259]],[[-7.095513692945063]],[[-7.360802666574536]],[[-6.233728225021373]]]]

Actual:   [[[[-7.0098]], [[-7.0396]], [[-7.0955]], [[-7.3608]], [[-6.2337]]]]

Expected: [[[[-7.0098]], [[-7.0396]], [[-7.0955]], [[-7.3608]], [[-6.2337]]]]