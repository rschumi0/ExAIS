import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add30203 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Add30203 = tf.keras.layers.Input(shape=([2, 2, 2]))

Add30203 = keras.layers.Add(name = 'Add30203', )([in0Add30203,in1Add30203])
Up_15162 = keras.layers.UpSampling2D(size=(1, 1), name = 'Up_15162', )(Add30203)
Res96249 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res96249', )(Up_15162)
PRe29285 = keras.layers.PReLU(name = 'PRe29285', )(Res96249)
model = tf.keras.models.Model(inputs=[in0Add30203,in1Add30203], outputs=PRe29285)
w = model.get_layer('PRe29285').get_weights() 
w[0] = np.array([[[[0.513], [0.5914]], [[0.9785], [0.0701]]], [[[0.9475], [0.0249]], [[0.9383], [0.9751]]]])
model.get_layer('PRe29285').set_weights(w) 
in0Add30203 = tf.constant([[[[0.7729, 0.1165], [0.2522, 0.4689]], [[0.0836, 0.6919], [0.0388, 0.3897]]]])
in1Add30203 = tf.constant([[[[0.2408, 0.5246], [0.7515, 0.5695]], [[0.2885, 0.0695], [0.0686, 0.9032]]]])
print (np.array2string(model.predict([in0Add30203,in1Add30203],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe29285.png')

LAdd30203 = add_layer([[[[[0.7729, 0.1165], [0.2522, 0.4689]], [[0.0836, 0.6919], [0.0388, 0.3897]]]], [[[[0.2408, 0.5246], [0.7515, 0.5695]], [[0.2885, 0.0695], [0.0686, 0.9032]]]]], Add30203), 
LUp_15162 = up_sampling2D_layer(Add30203, 1, 1, Up_15162), 
LRes96249 = reshape_layer(Up_15162, [2, 2, 2, 1], Res96249), 
LPRe29285 = prelu_layer(Res96249, [[[[0.513], [0.5914]], [[0.9785], [0.0701]]], [[[0.9475], [0.0249]], [[0.9383], [0.9751]]]], PRe29285), 
exec_layers([LAdd30203,LUp_15162,LRes96249,LPRe29285],["Add30203","Up_15162","Res96249","PRe29285"],PRe29285,"PRe29285")

Actual (Unparsed): [[[[[1.0137000], [0.6411000]], [[1.0037000], [1.0384000]]], [[[0.3721000], [0.7614000]], [[0.1074000], [1.2929000]]]]]

Expected (Unparsed): [[[[[1.0137],[0.6411]],[[1.0036999999999998],[1.0384]]],[[[0.3721],[0.7614]],[[0.1074],[1.2929]]]]]

Actual:   [[[[[1.0137], [0.6411]], [[1.0037], [1.0384]]], [[[0.3721], [0.7614]], [[0.1074], [1.2929]]]]]

Expected: [[[[[1.0137], [0.6411]], [[1.0037], [1.0384]]], [[[0.3721], [0.7614]], [[0.1074], [1.2929]]]]]