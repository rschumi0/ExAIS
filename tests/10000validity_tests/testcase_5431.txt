import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min79764 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Min79764 = tf.keras.layers.Input(shape=([2, 1, 2]))

Min79764 = keras.layers.Minimum(name = 'Min79764', )([in0Min79764,in1Min79764])
Res25715 = keras.layers.Reshape((2, 2), name = 'Res25715', )(Min79764)
LST32624 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST32624', )(Res25715)
Res77440 = keras.layers.Reshape((1, 1), name = 'Res77440', )(LST32624)
PRe80674 = keras.layers.PReLU(name = 'PRe80674', )(Res77440)
model = tf.keras.models.Model(inputs=[in0Min79764,in1Min79764], outputs=PRe80674)
w = model.get_layer('LST32624').get_weights() 
w[0] = np.array([[10, 6, 9, 9], [1, 2, 8, 7]])
w[1] = np.array([[5, 10, 7, 1]])
w[2] = np.array([4, 7, 1, 9])
model.get_layer('LST32624').set_weights(w) 
w = model.get_layer('PRe80674').get_weights() 
w[0] = np.array([[0.5729]])
model.get_layer('PRe80674').set_weights(w) 
in0Min79764 = tf.constant([[[[0.9334, 0.997]], [[0.3989, 0.3034]]]])
in1Min79764 = tf.constant([[[[0.6291, 0.5208]], [[0.1774, 0.1203]]]])
print (np.array2string(model.predict([in0Min79764,in1Min79764],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe80674.png')

LMin79764 = minimum_layer([[[[[0.9334, 0.997]], [[0.3989, 0.3034]]]], [[[[0.6291, 0.5208]], [[0.1774, 0.1203]]]]], Min79764), 
LRes25715 = reshape_layer(Min79764, [2, 2], Res25715), 
LLST32624 = lstm_layer(Res25715,[[10, 6, 9, 9], [1, 2, 8, 7]],[[5, 10, 7, 1]],[4, 7, 1, 9], LST32624), 
LRes77440 = reshape_layer(LST32624, [1, 1], Res77440), 
LPRe80674 = prelu_layer(Res77440, [[0.5729]], PRe80674), 
exec_layers([LMin79764,LRes25715,LLST32624,LRes77440,LPRe80674],["Min79764","Res25715","LST32624","Res77440","PRe80674"],PRe80674,"PRe80674")

Actual (Unparsed): [[[0.9640170]]]

Expected (Unparsed): [[[0.9640169760885797]]]

Actual:   [[[0.9641]]]

Expected: [[[0.9641]]]