import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot32198 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot32198 = tf.keras.layers.Input(shape=([2, 2]))

Dot32198 = keras.layers.Dot(axes=(1, 2), name = 'Dot32198', )([in0Dot32198,in1Dot32198])
Con52464 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con52464', )(Dot32198)
Thr8278 = keras.layers.ThresholdedReLU(theta=6.784218229294536, name = 'Thr8278', )(Con52464)
Res47738 = keras.layers.Reshape((2, 2, 1), name = 'Res47738', )(Thr8278)
Con1923 = keras.layers.Conv2D(4, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con1923', )(Res47738)
model = tf.keras.models.Model(inputs=[in0Dot32198,in1Dot32198], outputs=Con1923)
w = model.get_layer('Con52464').get_weights() 
w[0] = np.array([[[0.4823, 0.6056], [0.0553, 0.6581]]])
w[1] = np.array([0, 0])
model.get_layer('Con52464').set_weights(w) 
w = model.get_layer('Con1923').get_weights() 
w[0] = np.array([[[[0.773, 0.9802, 0.8617, 0.1358]], [[0.6451, 0.419, 0.0749, 0.5351]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con1923').set_weights(w) 
in0Dot32198 = tf.constant([[[0.9948, 0.9936], [0.939, 0.6688]]])
in1Dot32198 = tf.constant([[[0.3709, 0.6992], [0.0298, 0.9524]]])
print (np.array2string(model.predict([in0Dot32198,in1Dot32198],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con1923.png')

LDot32198 = dot_layer([[[0.9948, 0.9936], [0.939, 0.6688]]], [[[0.3709, 0.6992], [0.0298, 0.9524]]], 1, 2, Dot32198), 
LCon52464 = conv1D_layer(Dot32198, 1,[[[0.4823, 0.6056], [0.0553, 0.6581]]],[0, 0], 1, true, 1, Con52464), 
LThr8278 = thresholded_relu_layer(Con52464, 6.784218229294536, Thr8278), 
LRes47738 = reshape_layer(Thr8278, [2, 2, 1], Res47738), 
LCon1923 = conv2D_layer(Res47738, 1, 2,[[[[0.773, 0.9802, 0.8617, 0.1358]], [[0.6451, 0.419, 0.0749, 0.5351]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con1923), 
exec_layers([LDot32198,LCon52464,LThr8278,LRes47738,LCon1923],["Dot32198","Con52464","Thr8278","Res47738","Con1923"],Con1923,"Con1923")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0.0,0.0,0.0,0.0]],[[0.0,0.0,0.0,0.0]]]]

Actual:   [[[[0, 0, 0, 0]], [[0, 0, 0, 0]]]]

Expected: [[[[0, 0, 0, 0]], [[0, 0, 0, 0]]]]