import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min53514 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min53514 = tf.keras.layers.Input(shape=([1, 2, 1]))

Min53514 = keras.layers.Minimum(name = 'Min53514', )([in0Min53514,in1Min53514])
Sep54408 = keras.layers.SeparableConv2D(2, (1, 2),strides=(1, 1), padding='valid', name = 'Sep54408', )(Min53514)
Res74340 = keras.layers.Reshape((1, 2), name = 'Res74340', )(Sep54408)
Con4146 = keras.layers.Conv1D(3, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con4146', )(Res74340)
Glo49585 = keras.layers.GlobalMaxPool1D(name = 'Glo49585', )(Con4146)
Bat64236 = keras.layers.BatchNormalization(axis=1, epsilon=0.6500862750531723,  name = 'Bat64236', )(Glo49585)
model = tf.keras.models.Model(inputs=[in0Min53514,in1Min53514], outputs=Bat64236)
w = model.get_layer('Sep54408').get_weights() 
w[0] = np.array([[[[0.6152]], [[0.3012]]]])
w[1] = np.array([[[[0.1545, 0.3672]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep54408').set_weights(w) 
w = model.get_layer('Con4146').get_weights() 
w[0] = np.array([[[0.3359, 0.2109, 0.8961], [0.8773, 0.7201, 0.008]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con4146').set_weights(w) 
w = model.get_layer('Bat64236').get_weights() 
w[0] = np.array([0.0132, 0.5407, 0.9027])
w[1] = np.array([0.5793, 0.6344, 0.8524])
w[2] = np.array([0.3124, 0.3197, 0.8298])
w[3] = np.array([0.1293, 0.0281, 0.0944])
model.get_layer('Bat64236').set_weights(w) 
in0Min53514 = tf.constant([[[[0.091], [0.443]]]])
in1Min53514 = tf.constant([[[[0.5085], [0.9515]]]])
print (np.array2string(model.predict([in0Min53514,in1Min53514],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat64236.png')

LMin53514 = minimum_layer([[[[[0.091], [0.443]]]], [[[[0.5085], [0.9515]]]]], Min53514), 
LSep54408 = separable_conv2D_layer(Min53514, 1, 2,[[[[[0.6152]], [[0.3012]]]],[[[[0.1545, 0.3672]]]]],[0, 0], 1, 1, false, Sep54408), 
LRes74340 = reshape_layer(Sep54408, [1, 2], Res74340), 
LCon4146 = conv1D_layer(Res74340, 1,[[[0.3359, 0.2109, 0.8961], [0.8773, 0.7201, 0.008]]],[0, 0, 0], 1, false, 1, Con4146), 
LGlo49585 = global_max_pool1D_layer(Con4146, Glo49585), 
LBat64236 = batch_normalization_layer(Glo49585, 1, 0.6500862750531723, [0.0132, 0.5407, 0.9027], [0.5793, 0.6344, 0.8524], [0.3124, 0.3197, 0.8298], [0.1293, 0.0281, 0.0944], Bat64236), 
exec_layers([LMin53514,LSep54408,LRes74340,LCon4146,LGlo49585,LBat64236],["Min53514","Sep54408","Res74340","Con4146","Glo49585","Bat64236"],Bat64236,"Bat64236")

Actual (Unparsed): [[0.5756883, 0.4614310, 0.0122802]]

Expected (Unparsed): [[0.5756883427024144,0.46143096147780926,0.01228018346234594]]

Actual:   [[0.5757, 0.4615, 0.0123]]

Expected: [[0.5757, 0.4615, 0.0123]]