import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep57553 = tf.keras.layers.Input(shape=([2, 2]))

Sep57553 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep57553', )(in0Sep57553)
Mas86743 = keras.layers.Masking(mask_value=1, name = 'Mas86743', )(Sep57553)
ELU83007 = keras.layers.ELU(alpha=8.031801089702434, name = 'ELU83007', )(Mas86743)
ELU35960 = keras.layers.ELU(alpha=5.725541370289175, name = 'ELU35960', )(ELU83007)
model = tf.keras.models.Model(inputs=[in0Sep57553], outputs=ELU35960)
w = model.get_layer('Sep57553').get_weights() 
w[0] = np.array([[[0.3855], [0.7371]]])
w[1] = np.array([[[0.5225, 0.0305, 0.2035, 0.8969], [0.1879, 0.7761, 0.7345, 0.0791]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep57553').set_weights(w) 
in0Sep57553 = tf.constant([[[0.0464, 0.8012], [0.428, 0.7508]]])
print (np.array2string(model.predict([in0Sep57553],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU35960.png')

LSep57553 = separable_conv1D_layer([[[0.0464, 0.8012], [0.428, 0.7508]]], 1,[[[[0.3855], [0.7371]]],[[[0.5225, 0.0305, 0.2035, 0.8969], [0.1879, 0.7761, 0.7345, 0.0791]]]],[0, 0, 0, 0], 1, false, Sep57553), 
LMas86743 = masking_layer(Sep57553, 1, Mas86743), 
LELU83007 = elu_layer(Mas86743, 8.031801089702434, ELU83007), 
LELU35960 = elu_layer(ELU83007, 5.725541370289175, ELU35960), 
exec_layers([LSep57553,LMas86743,LELU83007,LELU35960],["Sep57553","Mas86743","ELU83007","ELU35960"],ELU35960,"ELU35960")

Actual (Unparsed): [[[0.1203131, 0.4588827, 0.4374097, 0.0627567], [0.1901960, 0.4345375, 0.4400594, 0.1917582]]]

Expected (Unparsed): [[[0.12031313530800002,0.45888268357200007,0.43740968514000006,0.06275668321200001],[0.190195983372,0.43453745014800005,0.44005936146,0.19175821978800003]]]

Actual:   [[[0.1204, 0.4589, 0.4375, 0.0628], [0.1902, 0.4346, 0.4401, 0.1918]]]

Expected: [[[0.1204, 0.4589, 0.4375, 0.0628], [0.1902, 0.4346, 0.4401, 0.1918]]]