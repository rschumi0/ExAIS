import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe53270 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con37017 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Min81189 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min81189 = tf.keras.layers.Input(shape=([1, 2, 2]))

PRe53270 = keras.layers.PReLU(name = 'PRe53270', input_shape=(1, 1, 1, 1))(in0PRe53270)
Res18408 = keras.layers.Reshape((1, 1, 1), name = 'Res18408', )(PRe53270)
Zer6334 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer6334', )(Res18408)
Con37017 = keras.layers.Concatenate(axis=3, name = 'Con37017', )([Zer6334,in0Con37017])
Min81189 = keras.layers.Minimum(name = 'Min81189', )([in0Min81189,in1Min81189])
Max48618 = keras.layers.Maximum(name = 'Max48618', )([Con37017,Min81189])
Res29121 = keras.layers.Reshape((1, 4), name = 'Res29121', )(Max48618)
Cro77567 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro77567', )(Res29121)
model = tf.keras.models.Model(inputs=[in0PRe53270,in0Con37017,in0Min81189,in1Min81189], outputs=Cro77567)
w = model.get_layer('PRe53270').get_weights() 
w[0] = np.array([[[[0.9094]]]])
model.get_layer('PRe53270').set_weights(w) 
in0PRe53270 = tf.constant([[[[[0.1641]]]]])
in0Con37017 = tf.constant([[[[0.0911], [0.7193]]]])
in0Min81189 = tf.constant([[[[0.5416, 0.2023], [0.9136, 0.1092]]]])
in1Min81189 = tf.constant([[[[0.1374, 0.1893], [0.6025, 0.1403]]]])
print (np.array2string(model.predict([in0PRe53270,in0Con37017,in0Min81189,in1Min81189],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro77567.png')

LPRe53270 = prelu_layer([[[[[0.1641]]]]], [[[[0.9094]]]], PRe53270), 
LRes18408 = reshape_layer(PRe53270, [1, 1, 1], Res18408), 
LZer6334 = zero_padding2D_layer(Res18408, 0, 0, 1, 0, Zer6334), 
LCon37017 = concatenate_layer([Zer6334,[[[[0.0911], [0.7193]]]]], 3, Con37017), 
LMin81189 = minimum_layer([[[[[0.5416, 0.2023], [0.9136, 0.1092]]]], [[[[0.1374, 0.1893], [0.6025, 0.1403]]]]], Min81189), 
LMax48618 = maximum_layer([Con37017,Min81189], Max48618), 
LRes29121 = reshape_layer(Max48618, [1, 4], Res29121), 
LCro77567 = cropping1D_layer(Res29121, 0, 0, Cro77567), 
exec_layers([LPRe53270,LRes18408,LZer6334,LCon37017,LMin81189,LMax48618,LRes29121,LCro77567],["PRe53270","Res18408","Zer6334","Con37017","Min81189","Max48618","Res29121","Cro77567"],Cro77567,"Cro77567")

Actual (Unparsed): [[[0.1374000, 0.1893000, 0.6025000, 0.7193000]]]

Expected (Unparsed): [[[0.1374,0.1893,0.6025,0.7193]]]

Actual:   [[[0.1374, 0.1893, 0.6025, 0.7193]]]

Expected: [[[0.1374, 0.1893, 0.6025, 0.7193]]]