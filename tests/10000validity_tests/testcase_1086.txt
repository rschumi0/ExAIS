import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul71137 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Mul71137 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0GRU61750 = tf.keras.layers.Input(shape=([1, 3]))
in0Con74779 = tf.keras.layers.Input(shape=([3, 3, 1]))

Mul71137 = keras.layers.Multiply(name = 'Mul71137', )([in0Mul71137,in1Mul71137])
Res83494 = keras.layers.Reshape((1, 1), name = 'Res83494', )(Mul71137)
Glo13316 = keras.layers.GlobalMaxPool1D(name = 'Glo13316', )(Res83494)
Res62203 = keras.layers.Reshape((1, 1), name = 'Res62203', )(Glo13316)
Res57739 = keras.layers.Reshape((1, 1, 1), name = 'Res57739', )(Res62203)
Res26270 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res26270', )(Res57739)
Zer92359 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer92359', )(Res26270)
Res67639 = keras.layers.Reshape((3, 3, 3), name = 'Res67639', )(Zer92359)
GRU61750 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU61750', )(in0GRU61750)
Res62084 = keras.layers.Reshape((1, 1), name = 'Res62084', )(GRU61750)
Res40545 = keras.layers.Reshape((1, 1, 1), name = 'Res40545', )(Res62084)
Sep14031 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep14031', )(Res40545)
Zer89835 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer89835', )(Sep14031)
Con74779 = keras.layers.Concatenate(axis=3, name = 'Con74779', )([Zer89835,in0Con74779])
Min37439 = keras.layers.Minimum(name = 'Min37439', )([Res67639,Con74779])
model = tf.keras.models.Model(inputs=[in0Mul71137,in1Mul71137,in0GRU61750,in0Con74779], outputs=Min37439)
w = model.get_layer('GRU61750').get_weights() 
w[0] = np.array([[8, 5, 7], [2, 7, 2], [2, 1, 1]])
w[1] = np.array([[9, 9, 10]])
w[2] = np.array([5, 7, 4])
model.get_layer('GRU61750').set_weights(w) 
w = model.get_layer('Sep14031').get_weights() 
w[0] = np.array([[[[0.8913]]]])
w[1] = np.array([[[[0.0309, 0.3998]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep14031').set_weights(w) 
in0Mul71137 = tf.constant([[[[0.7555]]]])
in1Mul71137 = tf.constant([[[[0.4273]]]])
in0GRU61750 = tf.constant([[[5, 5, 8]]])
in0Con74779 = tf.constant([[[[0.9316], [0.9312], [0.122]], [[0.7528], [0.1132], [0.9091]], [[0.5015], [0.8529], [0.1309]]]])
print (np.array2string(model.predict([in0Mul71137,in1Mul71137,in0GRU61750,in0Con74779],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min37439.png')

LMul71137 = multiply_layer([[[[[0.7555]]]], [[[[0.4273]]]]], Mul71137), 
LRes83494 = reshape_layer(Mul71137, [1, 1], Res83494), 
LGlo13316 = global_max_pool1D_layer(Res83494, Glo13316), 
LRes62203 = reshape_layer(Glo13316, [1, 1], Res62203), 
LRes57739 = reshape_layer(Res62203, [1, 1, 1], Res57739), 
LRes26270 = reshape_layer(Res57739, [1, 1, 1, 1], Res26270), 
LZer92359 = zero_padding3D_layer(Res26270, 1, 1, 1, 1, 1, 1, Zer92359), 
LRes67639 = reshape_layer(Zer92359, [3, 3, 3], Res67639), 
LGRU61750 = gru_layer([[[5, 5, 8]]],[[8, 5, 7], [2, 7, 2], [2, 1, 1]],[[9, 9, 10]],[5, 7, 4], false, GRU61750), 
LRes62084 = reshape_layer(GRU61750, [1, 1], Res62084), 
LRes40545 = reshape_layer(Res62084, [1, 1, 1], Res40545), 
LSep14031 = separable_conv2D_layer(Res40545, 1, 1,[[[[[0.8913]]]],[[[[0.0309, 0.3998]]]]],[0, 0], 1, 1, false, Sep14031), 
LZer89835 = zero_padding2D_layer(Sep14031, 2, 0, 2, 0, Zer89835), 
LCon74779 = concatenate_layer([Zer89835,[[[[0.9316], [0.9312], [0.122]], [[0.7528], [0.1132], [0.9091]], [[0.5015], [0.8529], [0.1309]]]]], 3, Con74779), 
LMin37439 = minimum_layer([Res67639,Con74779], Min37439), 
exec_layers([LMul71137,LRes83494,LGlo13316,LRes62203,LRes57739,LRes26270,LZer92359,LRes67639,LGRU61750,LRes62084,LRes40545,LSep14031,LZer89835,LCon74779,LMin37439],["Mul71137","Res83494","Glo13316","Res62203","Res57739","Res26270","Zer92359","Res67639","GRU61750","Res62084","Res40545","Sep14031","Zer89835","Con74779","Min37439"],Min37439,"Min37439")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]]]

Actual:   [[[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]

Expected: [[[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]