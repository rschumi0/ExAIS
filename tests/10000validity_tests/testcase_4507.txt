import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim30416 = tf.keras.layers.Input(shape=([1, 2]))
in0Con60684 = tf.keras.layers.Input(shape=([3, 3]))
in0Cro42188 = tf.keras.layers.Input(shape=([4, 4]))

Sim30416 = keras.layers.SimpleRNN(2,name = 'Sim30416', )(in0Sim30416)
Res18116 = keras.layers.Reshape((2, 1), name = 'Res18116', )(Sim30416)
Per37002 = keras.layers.Permute((1,2), name = 'Per37002',)(Res18116)
Zer67724 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer67724', )(Per37002)
Con60684 = keras.layers.Concatenate(axis=2, name = 'Con60684', )([Zer67724,in0Con60684])
Cro42188 = keras.layers.Cropping1D(cropping=((2, 1)), name = 'Cro42188', )(in0Cro42188)
Dot39083 = keras.layers.Dot(axes=(2, 2), name = 'Dot39083', )([Con60684,Cro42188])
model = tf.keras.models.Model(inputs=[in0Sim30416,in0Con60684,in0Cro42188], outputs=Dot39083)
w = model.get_layer('Sim30416').get_weights() 
w[0] = np.array([[3, 6], [1, 5]])
w[1] = np.array([[3, 4], [6, 2]])
w[2] = np.array([7, 6])
model.get_layer('Sim30416').set_weights(w) 
in0Sim30416 = tf.constant([[[5, 4]]])
in0Con60684 = tf.constant([[[0.8087, 0.9316, 0.0739], [0.5881, 0.6264, 0.5497], [0.0971, 0.6705, 0.8519]]])
in0Cro42188 = tf.constant([[[1.6671, 1.0977, 1.5464, 1.3707], [1.45, 1.9608, 1.615, 1.1232], [1.9266, 1.4385, 1.2012, 1.0328], [1.2284, 1.2006, 1.3389, 1.3614]]])
print (np.array2string(model.predict([in0Sim30416,in0Con60684,in0Cro42188],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot39083.png')

LSim30416 = simple_rnn_layer([[[5, 4]]],[[3, 6], [1, 5]],[[3, 4], [6, 2]],[7, 6], Sim30416), 
LRes18116 = reshape_layer(Sim30416, [2, 1], Res18116), 
LPer37002 = permute_layer(Res18116, 1,2, Per37002), 
LZer67724 = zero_padding1D_layer(Per37002, 1, 0, Zer67724), 
LCon60684 = concatenate_layer([Zer67724,[[[0.8087, 0.9316, 0.0739], [0.5881, 0.6264, 0.5497], [0.0971, 0.6705, 0.8519]]]], 2, Con60684), 
LCro42188 = cropping1D_layer([[[1.6671, 1.0977, 1.5464, 1.3707], [1.45, 1.9608, 1.615, 1.1232], [1.9266, 1.4385, 1.2012, 1.0328], [1.2284, 1.2006, 1.3389, 1.3614]]], 2, 1, Cro42188), 
LDot39083 = dot_layer(Con60684,Cro42188, 2, 2, Dot39083), 
exec_layers([LSim30416,LRes18116,LPer37002,LZer67724,LCon60684,LCro42188,LDot39083],["Sim30416","Res18116","Per37002","Zer67724","Con60684","Cro42188","Dot39083"],Dot39083,"Dot39083")

Actual (Unparsed): [[[2.3586768], [4.0927437], [3.7515252]]]

Expected (Unparsed): [[[2.35867679],[4.09274369],[3.75152527]]]

Actual:   [[[2.3587], [4.0928], [3.7516]]]

Expected: [[[2.3587], [4.0928], [3.7516]]]