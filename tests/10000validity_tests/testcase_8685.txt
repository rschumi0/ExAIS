import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max47815 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Max47815 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Max47815 = keras.layers.Maximum(name = 'Max47815', )([in0Max47815,in1Max47815])
Den18892 = keras.layers.Dense(1,name = 'Den18892', )(Max47815)
Res19226 = keras.layers.Reshape((1, 1, 2), name = 'Res19226', )(Den18892)
Res77079 = keras.layers.Reshape((1, 2), name = 'Res77079', )(Res19226)
Sep71512 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='same', name = 'Sep71512', )(Res77079)
model = tf.keras.models.Model(inputs=[in0Max47815,in1Max47815], outputs=Sep71512)
w = model.get_layer('Den18892').get_weights() 
w[0] = np.array([[0.4742], [0.2325]])
w[1] = np.array([0.2369])
model.get_layer('Den18892').set_weights(w) 
w = model.get_layer('Sep71512').get_weights() 
w[0] = np.array([[[0.9116], [0.4802]]])
w[1] = np.array([[[0.4738, 0.6613, 0.1438], [0.3395, 0.7463, 0.6883]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep71512').set_weights(w) 
in0Max47815 = tf.constant([[[[[0.2904, 0.7434], [0.5276, 0.8854]]]]])
in1Max47815 = tf.constant([[[[[0.665, 0.625], [0.3866, 0.2794]]]]])
print (np.array2string(model.predict([in0Max47815,in1Max47815],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep71512.png')

LMax47815 = maximum_layer([[[[[[0.2904, 0.7434], [0.5276, 0.8854]]]]], [[[[[0.665, 0.625], [0.3866, 0.2794]]]]]], Max47815), 
LDen18892 = dense_layer(Max47815, [[0.4742], [0.2325]],[0.2369], Den18892), 
LRes19226 = reshape_layer(Den18892, [1, 1, 2], Res19226), 
LRes77079 = reshape_layer(Res19226, [1, 2], Res77079), 
LSep71512 = separable_conv1D_layer(Res77079, 1,[[[[0.9116], [0.4802]]],[[[0.4738, 0.6613, 0.1438], [0.3395, 0.7463, 0.6883]]]],[0, 0, 0], 1, true, Sep71512), 
exec_layers([LMax47815,LDen18892,LRes19226,LRes77079,LSep71512],["Max47815","Den18892","Res19226","Res77079","Sep71512"],Sep71512,"Sep71512")

Actual (Unparsed): [[[0.4261443, 0.6854425, 0.3240826]]]

Expected (Unparsed): [[[0.42614433357409803,0.6854425126511292,0.3240826133191572]]]

Actual:   [[[0.4262, 0.6855, 0.3241]]]

Expected: [[[0.4262, 0.6855, 0.3241]]]