import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max17430 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max17430 = tf.keras.layers.Input(shape=([2, 1, 2]))

Max17430 = keras.layers.Maximum(name = 'Max17430', )([in0Max17430,in1Max17430])
Res15023 = keras.layers.Reshape((2, 2), name = 'Res15023', )(Max17430)
PRe92685 = keras.layers.PReLU(name = 'PRe92685', )(Res15023)
model = tf.keras.models.Model(inputs=[in0Max17430,in1Max17430], outputs=PRe92685)
w = model.get_layer('PRe92685').get_weights() 
w[0] = np.array([[0.3138, 0.73], [0.115, 0.985]])
model.get_layer('PRe92685').set_weights(w) 
in0Max17430 = tf.constant([[[[0.4121, 0.527]], [[0.6956, 0.2195]]]])
in1Max17430 = tf.constant([[[[0.8653, 0.8854]], [[0.9341, 0.6254]]]])
print (np.array2string(model.predict([in0Max17430,in1Max17430],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe92685.png')

LMax17430 = maximum_layer([[[[[0.4121, 0.527]], [[0.6956, 0.2195]]]], [[[[0.8653, 0.8854]], [[0.9341, 0.6254]]]]], Max17430), 
LRes15023 = reshape_layer(Max17430, [2, 2], Res15023), 
LPRe92685 = prelu_layer(Res15023, [[0.3138, 0.73], [0.115, 0.985]], PRe92685), 
exec_layers([LMax17430,LRes15023,LPRe92685],["Max17430","Res15023","PRe92685"],PRe92685,"PRe92685")

Actual (Unparsed): [[[0.8653000, 0.8854000], [0.9341000, 0.6254000]]]

Expected (Unparsed): [[[0.8653,0.8854],[0.9341,0.6254]]]

Actual:   [[[0.8653, 0.8854], [0.9341, 0.6254]]]

Expected: [[[0.8653, 0.8854], [0.9341, 0.6254]]]