import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo86459 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con89251 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Min97226 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min97226 = tf.keras.layers.Input(shape=([1, 2, 2]))

Glo86459 = keras.layers.GlobalAveragePooling2D(name = 'Glo86459', )(in0Glo86459)
Res52765 = keras.layers.Reshape((2, 1), name = 'Res52765', )(Glo86459)
Res81164 = keras.layers.Reshape((2, 1, 1), name = 'Res81164', )(Res52765)
Zer27037 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer27037', )(Res81164)
Con89251 = keras.layers.Concatenate(axis=3, name = 'Con89251', )([Zer27037,in0Con89251])
Min97226 = keras.layers.Minimum(name = 'Min97226', )([in0Min97226,in1Min97226])
Con16518 = keras.layers.Conv2D(4, (1, 2),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con16518', )(Min97226)
Den27343 = keras.layers.Dense(2,name = 'Den27343', )(Con16518)
Zer7583 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer7583', )(Den27343)
Max7086 = keras.layers.Maximum(name = 'Max7086', )([Con89251,Zer7583])
Res62404 = keras.layers.Reshape((2, 6), name = 'Res62404', )(Max7086)
Con43918 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con43918', )(Res62404)
Con29186 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con29186', )(Con43918)
model = tf.keras.models.Model(inputs=[in0Glo86459,in0Con89251,in0Min97226,in1Min97226], outputs=Con29186)
w = model.get_layer('Con16518').get_weights() 
w[0] = np.array([[[[0.4135, 0.8712, 0.5818, 0.3327], [0.6696, 0.5034, 0.1294, 0.3568]], [[0.1012, 0.5513, 0.6377, 0.379], [0.8971, 0.6389, 0.1005, 0.5918]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con16518').set_weights(w) 
w = model.get_layer('Den27343').get_weights() 
w[0] = np.array([[0.9342, 0.0236], [0.4221, 0.6822], [0.399, 0.2166], [0.394, 0.7551]])
w[1] = np.array([0.7381, 0.5208])
model.get_layer('Den27343').set_weights(w) 
w = model.get_layer('Con43918').get_weights() 
w[0] = np.array([[[0.4308, 0.3424, 0.589, 0.7854], [0.6726, 0.5012, 0.1964, 0.863], [0.3567, 0.0423, 0.0543, 0.9006], [0.4375, 0.638, 0.5749, 0.2188], [0.0073, 0.6863, 0.5461, 0.1889], [0.7965, 0.4811, 0.241, 0.8229]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con43918').set_weights(w) 
w = model.get_layer('Con29186').get_weights() 
w[0] = np.array([[[0.8101, 0.3122], [0.5657, 0.7444], [0.5196, 0.2142], [0.3444, 0.9388]]])
w[1] = np.array([0, 0])
model.get_layer('Con29186').set_weights(w) 
in0Glo86459 = tf.constant([[[[1.0811, 1.5688], [1.4709, 1.3224]]]])
in0Con89251 = tf.constant([[[[0.6335], [0.8107], [0.9742]], [[0.3268], [0.3884], [0.3975]]]])
in0Min97226 = tf.constant([[[[0.0071, 0.3102], [0.8492, 0.2094]]]])
in1Min97226 = tf.constant([[[[0.6343, 0.8725], [0.1017, 0.5248]]]])
print (np.array2string(model.predict([in0Glo86459,in0Con89251,in0Min97226,in1Min97226],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con29186.png')

LGlo86459 = global_average_pooling2D_layer([[[[1.0811, 1.5688], [1.4709, 1.3224]]]], Glo86459), 
LRes52765 = reshape_layer(Glo86459, [2, 1], Res52765), 
LRes81164 = reshape_layer(Res52765, [2, 1, 1], Res81164), 
LZer27037 = zero_padding2D_layer(Res81164, 0, 0, 2, 0, Zer27037), 
LCon89251 = concatenate_layer([Zer27037,[[[[0.6335], [0.8107], [0.9742]], [[0.3268], [0.3884], [0.3975]]]]], 3, Con89251), 
LMin97226 = minimum_layer([[[[[0.0071, 0.3102], [0.8492, 0.2094]]]], [[[[0.6343, 0.8725], [0.1017, 0.5248]]]]], Min97226), 
LCon16518 = conv2D_layer(Min97226, 1, 2,[[[[0.4135, 0.8712, 0.5818, 0.3327], [0.6696, 0.5034, 0.1294, 0.3568]], [[0.1012, 0.5513, 0.6377, 0.379], [0.8971, 0.6389, 0.1005, 0.5918]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con16518), 
LDen27343 = dense_layer(Con16518, [[0.9342, 0.0236], [0.4221, 0.6822], [0.399, 0.2166], [0.394, 0.7551]],[0.7381, 0.5208], Den27343), 
LZer7583 = zero_padding2D_layer(Den27343, 1, 0, 1, 0, Zer7583), 
LMax7086 = maximum_layer([Con89251,Zer7583], Max7086), 
LRes62404 = reshape_layer(Max7086, [2, 6], Res62404), 
LCon43918 = conv1D_layer(Res62404, 1,[[[0.4308, 0.3424, 0.589, 0.7854], [0.6726, 0.5012, 0.1964, 0.863], [0.3567, 0.0423, 0.0543, 0.9006], [0.4375, 0.638, 0.5749, 0.2188], [0.0073, 0.6863, 0.5461, 0.1889], [0.7965, 0.4811, 0.241, 0.8229]]],[0, 0, 0, 0], 1, false, 1, Con43918), 
LCon29186 = conv1D_layer(Con43918, 1,[[[0.8101, 0.3122], [0.5657, 0.7444], [0.5196, 0.2142], [0.3444, 0.9388]]],[0, 0], 1, true, 1, Con29186), 
exec_layers([LGlo86459,LRes52765,LRes81164,LZer27037,LCon89251,LMin97226,LCon16518,LDen27343,LZer7583,LMax7086,LRes62404,LCon43918,LCon29186],["Glo86459","Res52765","Res81164","Zer27037","Con89251","Min97226","Con16518","Den27343","Zer7583","Max7086","Res62404","Con43918","Con29186"],Con29186,"Con29186")

Actual (Unparsed): [[[3.9007555, 4.0957738], [4.5082422, 5.0968595]]]

Expected (Unparsed): [[[3.900755446302999,4.095773764116],[4.508242274894903,5.09685954805288]]]

Actual:   [[[3.9008, 4.0958], [4.5083, 5.0969]]]

Expected: [[[3.9008, 4.0958], [4.5083, 5.0969]]]