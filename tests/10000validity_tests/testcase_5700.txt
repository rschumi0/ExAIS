import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max96770 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max96770 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Sub14257 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub14257 = tf.keras.layers.Input(shape=([3, 3]))

Max96770 = keras.layers.Maximum(name = 'Max96770', )([in0Max96770,in1Max96770])
Res77155 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res77155', )(Max96770)
Glo92560 = keras.layers.GlobalMaxPool3D(name = 'Glo92560', )(Res77155)
Sub14257 = keras.layers.Subtract(name = 'Sub14257', )([in0Sub14257,in1Sub14257])
Res14052 = keras.layers.Reshape((3, 3, 1), name = 'Res14052', )(Sub14257)
Glo92528 = keras.layers.GlobalAveragePooling2D(name = 'Glo92528', )(Res14052)
Sub39440 = keras.layers.Subtract(name = 'Sub39440', )([Glo92560,Glo92528])
model = tf.keras.models.Model(inputs=[in0Max96770,in1Max96770,in0Sub14257,in1Sub14257], outputs=Sub39440)
in0Max96770 = tf.constant([[[[0.2113, 0.6545]], [[0.6124, 0.2726]]]])
in1Max96770 = tf.constant([[[[0.8447, 0.1366]], [[0.3292, 0.9467]]]])
in0Sub14257 = tf.constant([[[0.2032, 0.1296, 0.4715], [0.8391, 0.5752, 0.8906], [0.4251, 0.7685, 0.1788]]])
in1Sub14257 = tf.constant([[[0.0734, 0.1366, 0.8363], [0.2263, 0.7217, 0.5229], [0.4117, 0.023, 0.151]]])
print (np.array2string(model.predict([in0Max96770,in1Max96770,in0Sub14257,in1Sub14257],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub39440.png')

LMax96770 = maximum_layer([[[[[0.2113, 0.6545]], [[0.6124, 0.2726]]]], [[[[0.8447, 0.1366]], [[0.3292, 0.9467]]]]], Max96770), 
LRes77155 = reshape_layer(Max96770, [2, 1, 2, 1], Res77155), 
LGlo92560 = global_max_pool3D_layer(Res77155, Glo92560), 
LSub14257 = subtract_layer([[[0.2032, 0.1296, 0.4715], [0.8391, 0.5752, 0.8906], [0.4251, 0.7685, 0.1788]]], [[[0.0734, 0.1366, 0.8363], [0.2263, 0.7217, 0.5229], [0.4117, 0.023, 0.151]]], Sub14257), 
LRes14052 = reshape_layer(Sub14257, [3, 3, 1], Res14052), 
LGlo92528 = global_average_pooling2D_layer(Res14052, Glo92528), 
LSub39440 = subtract_layer(Glo92560,Glo92528, Sub39440), 
exec_layers([LMax96770,LRes77155,LGlo92560,LSub14257,LRes14052,LGlo92528,LSub39440],["Max96770","Res77155","Glo92560","Sub14257","Res14052","Glo92528","Sub39440"],Sub39440,"Sub39440")

Actual (Unparsed): [[0.7935111]]

Expected (Unparsed): [[0.7935111111111111]]

Actual:   [[0.7936]]

Expected: [[0.7936]]