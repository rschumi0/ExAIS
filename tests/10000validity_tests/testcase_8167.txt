import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min38092 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Min38092 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Min38092 = keras.layers.Minimum(name = 'Min38092', )([in0Min38092,in1Min38092])
Con13464 = keras.layers.Conv3D(2, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con13464', )(Min38092)
Res55985 = keras.layers.Reshape((2, 2, 2), name = 'Res55985', )(Con13464)
Res553 = keras.layers.Reshape((2, 4), name = 'Res553', )(Res55985)
Glo90594 = keras.layers.GlobalMaxPool1D(name = 'Glo90594', )(Res553)
model = tf.keras.models.Model(inputs=[in0Min38092,in1Min38092], outputs=Glo90594)
w = model.get_layer('Con13464').get_weights() 
w[0] = np.array([[[[[0.2068, 0.3239]]]], [[[[0.7107, 0.3755]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con13464').set_weights(w) 
in0Min38092 = tf.constant([[[[[0.4618]], [[0.7712]]], [[[0.3069]], [[0.7406]]]]])
in1Min38092 = tf.constant([[[[[0.4804]], [[0.739]]], [[[0.2473]], [[0.9364]]]]])
print (np.array2string(model.predict([in0Min38092,in1Min38092],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo90594.png')

LMin38092 = minimum_layer([[[[[[0.4618]], [[0.7712]]], [[[0.3069]], [[0.7406]]]]], [[[[[0.4804]], [[0.739]]], [[[0.2473]], [[0.9364]]]]]], Min38092), 
LCon13464 = conv3D_layer(Min38092, 2, 1, 1,[[[[[0.2068, 0.3239]]]], [[[[0.7107, 0.3755]]]]],[0, 0], 1, 1, 1, true, 1, 1, 1, Con13464), 
LRes55985 = reshape_layer(Con13464, [2, 2, 2], Res55985), 
LRes553 = reshape_layer(Res55985, [2, 4], Res553), 
LGlo90594 = global_max_pool1D_layer(Res553, Glo90594), 
exec_layers([LMin38092,LCon13464,LRes55985,LRes553,LGlo90594],["Min38092","Con13464","Res55985","Res553","Glo90594"],Glo90594,"Glo90594")

Actual (Unparsed): [[0.2712564, 0.2424382, 0.6791696, 0.5174574]]

Expected (Unparsed): [[0.27125635,0.24243817,0.67916962,0.5174574000000001]]

Actual:   [[0.2713, 0.2425, 0.6792, 0.5175]]

Expected: [[0.2713, 0.2425, 0.6792, 0.5175]]