import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea83673 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Lea83673 = keras.layers.LeakyReLU(alpha=6.664639498762392, name = 'Lea83673', input_shape=(1, 1, 2, 2))(in0Lea83673)
Res9174 = keras.layers.Reshape((1, 1, 4), name = 'Res9174', )(Lea83673)
Res68898 = keras.layers.Reshape((1, 4), name = 'Res68898', )(Res9174)
Sep3668 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep3668', )(Res68898)
GRU4458 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU4458', )(Sep3668)
model = tf.keras.models.Model(inputs=[in0Lea83673], outputs=GRU4458)
w = model.get_layer('Sep3668').get_weights() 
w[0] = np.array([[[0.2621], [0.5395], [0.8706], [0.0074]]])
w[1] = np.array([[[0.4342, 0.2909, 0.9385], [0.3965, 0.4415, 0.2776], [0.7601, 0.4636, 0.2824], [0.4194, 0.1105, 0.3991]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep3668').set_weights(w) 
w = model.get_layer('GRU4458').get_weights() 
w[0] = np.array([[6, 6, 10, 4, 5, 2, 7, 1, 7], [8, 9, 9, 5, 6, 5, 1, 10, 5], [4, 3, 4, 7, 2, 3, 7, 7, 1]])
w[1] = np.array([[6, 7, 7, 10, 2, 8, 4, 3, 9], [10, 5, 4, 3, 5, 1, 10, 9, 3], [9, 10, 7, 3, 6, 10, 3, 1, 7]])
w[2] = np.array([[6, 1, 10, 4, 9, 6, 6, 10, 1], [8, 10, 7, 1, 10, 9, 5, 3, 7]])
model.get_layer('GRU4458').set_weights(w) 
in0Lea83673 = tf.constant([[[[[0.1109, 0.8744], [0.194, 0.3628]]]]])
print (np.array2string(model.predict([in0Lea83673],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU4458.png')

LLea83673 = leaky_relu_layer([[[[[0.1109, 0.8744], [0.194, 0.3628]]]]], 6.664639498762392, Lea83673), 
LRes9174 = reshape_layer(Lea83673, [1, 1, 4], Res9174), 
LRes68898 = reshape_layer(Res9174, [1, 4], Res68898), 
LSep3668 = separable_conv1D_layer(Res68898, 1,[[[[0.2621], [0.5395], [0.8706], [0.0074]]],[[[0.4342, 0.2909, 0.9385], [0.3965, 0.4415, 0.2776], [0.7601, 0.4636, 0.2824], [0.4194, 0.1105, 0.3991]]]],[0, 0, 0], 1, false, Sep3668), 
LGRU4458 = gru_layer(Sep3668,[[6, 6, 10, 4, 5, 2, 7, 1, 7], [8, 9, 9, 5, 6, 5, 1, 10, 5], [4, 3, 4, 7, 2, 3, 7, 7, 1]],[[6, 7, 7, 10, 2, 8, 4, 3, 9], [10, 5, 4, 3, 5, 1, 10, 9, 3], [9, 10, 7, 3, 6, 10, 3, 1, 7]],[[6, 1, 10, 4, 9, 6, 6, 10, 1], [8, 10, 7, 1, 10, 9, 5, 3, 7]], true, GRU4458), 
exec_layers([LLea83673,LRes9174,LRes68898,LSep3668,LGRU4458],["Lea83673","Res9174","Res68898","Sep3668","GRU4458"],GRU4458,"GRU4458")

Actual (Unparsed): [[0.0000000, 0.0000001, 0.0000000]]

Expected (Unparsed): [[4.74760430968421e-9,8.729703904197799e-8,4.7152726164416884e-11]]

Actual:   [[0, 0, 0]]

Expected: [[0, 0, 0]]