import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub51446 = tf.keras.layers.Input(shape=([2]))
in1Sub51446 = tf.keras.layers.Input(shape=([2]))
in0Con48398 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Mul44989 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul44989 = tf.keras.layers.Input(shape=([1, 1, 2]))

Sub51446 = keras.layers.Subtract(name = 'Sub51446', )([in0Sub51446,in1Sub51446])
Res84350 = keras.layers.Reshape((2, 1), name = 'Res84350', )(Sub51446)
Res28556 = keras.layers.Reshape((2, 1, 1), name = 'Res28556', )(Res84350)
Con48398 = keras.layers.Concatenate(axis=3, name = 'Con48398', )([Res28556,in0Con48398])
Mul44989 = keras.layers.Multiply(name = 'Mul44989', )([in0Mul44989,in1Mul44989])
Den86947 = keras.layers.Dense(3,name = 'Den86947', )(Mul44989)
Zer77193 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer77193', )(Den86947)
Max4706 = keras.layers.Maximum(name = 'Max4706', )([Con48398,Zer77193])
Res93356 = keras.layers.Reshape((2, 3), name = 'Res93356', )(Max4706)
Max54976 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max54976', )(Res93356)
model = tf.keras.models.Model(inputs=[in0Sub51446,in1Sub51446,in0Con48398,in0Mul44989,in1Mul44989], outputs=Max54976)
w = model.get_layer('Den86947').get_weights() 
w[0] = np.array([[0.4309, 0.8423, 0.5688], [0.525, 0.1825, 0.6817]])
w[1] = np.array([0.7254, 0.6235, 0.1427])
model.get_layer('Den86947').set_weights(w) 
in0Sub51446 = tf.constant([[0.3897, 0.9592]])
in1Sub51446 = tf.constant([[0.0845, 0.4064]])
in0Con48398 = tf.constant([[[[0.3085, 0.1259]], [[0.0859, 0.3553]]]])
in0Mul44989 = tf.constant([[[[0.4624, 0.5733]]]])
in1Mul44989 = tf.constant([[[[0.0262, 0.4561]]]])
print (np.array2string(model.predict([in0Sub51446,in1Sub51446,in0Con48398,in0Mul44989,in1Mul44989],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max54976.png')

LSub51446 = subtract_layer([[0.3897, 0.9592]], [[0.0845, 0.4064]], Sub51446), 
LRes84350 = reshape_layer(Sub51446, [2, 1], Res84350), 
LRes28556 = reshape_layer(Res84350, [2, 1, 1], Res28556), 
LCon48398 = concatenate_layer([Res28556,[[[[0.3085, 0.1259]], [[0.0859, 0.3553]]]]], 3, Con48398), 
LMul44989 = multiply_layer([[[[[0.4624, 0.5733]]]], [[[[0.0262, 0.4561]]]]], Mul44989), 
LDen86947 = dense_layer(Mul44989, [[0.4309, 0.8423, 0.5688], [0.525, 0.1825, 0.6817]],[0.7254, 0.6235, 0.1427], Den86947), 
LZer77193 = zero_padding2D_layer(Den86947, 1, 0, 0, 0, Zer77193), 
LMax4706 = maximum_layer([Con48398,Zer77193], Max4706), 
LRes93356 = reshape_layer(Max4706, [2, 3], Res93356), 
LMax54976 = max_pool1D_layer(Res93356, 1, Max54976), 
exec_layers([LSub51446,LRes84350,LRes28556,LCon48398,LMul44989,LDen86947,LZer77193,LMax4706,LRes93356,LMax54976],["Sub51446","Res84350","Res28556","Con48398","Mul44989","Den86947","Zer77193","Max4706","Res93356","Max54976"],Max54976,"Max54976")

Actual (Unparsed): [[[0.3052000, 0.3085000, 0.1259000], [0.8678984, 0.6814249, 0.3553000]]]

Expected (Unparsed): [[[0.30519999999999997,0.3085,0.1259],[0.867898420042,0.6814248521490001,0.3553]]]

Actual:   [[[0.3052, 0.3085, 0.1259], [0.8679, 0.6815, 0.3553]]]

Expected: [[[0.3052, 0.3085, 0.1259], [0.8679, 0.6815, 0.3553]]]