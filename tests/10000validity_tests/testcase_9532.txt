import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub3247 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub3247 = tf.keras.layers.Input(shape=([3, 3]))

Sub3247 = keras.layers.Subtract(name = 'Sub3247', )([in0Sub3247,in1Sub3247])
Res10148 = keras.layers.Reshape((3, 3, 1), name = 'Res10148', )(Sub3247)
Res46857 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res46857', )(Res10148)
Zer74040 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer74040', )(Res46857)
Res43400 = keras.layers.Reshape((5, 5, 3), name = 'Res43400', )(Zer74040)
Res16698 = keras.layers.Reshape((5, 15), name = 'Res16698', )(Res43400)
Zer39928 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer39928', )(Res16698)
Con56016 = keras.layers.Conv1D(4, (2),strides=(2), padding='valid', dilation_rate=(1), name = 'Con56016', )(Zer39928)
model = tf.keras.models.Model(inputs=[in0Sub3247,in1Sub3247], outputs=Con56016)
w = model.get_layer('Con56016').get_weights() 
w[0] = np.array([[[0.2682, 0.1189, 0.6221, 0.0576], [0.4462, 0.4268, 0.1025, 0.8631], [0.2769, 0.7401, 0.1631, 0.2065], [0.9853, 0.4134, 0.5771, 0.5102], [0.113, 0.231, 0.0287, 0.1668], [0.4598, 0.7569, 0.2112, 0.1684], [0.919, 0.2145, 0.9942, 0.3658], [0.5094, 0.4141, 0.9935, 0.0477], [0.283, 0.2259, 0.0134, 0.9008], [0.9444, 0.1021, 0.2591, 0.3096], [0.9566, 0.1958, 0.9164, 0.3844], [0.6283, 0.6913, 0.6855, 0.0707], [0.1769, 0.0667, 0.1186, 0.1836], [0.0455, 0.1409, 0.1614, 0.2371], [0.8157, 0.9231, 0.127, 0.4929]], [[0.9003, 0.4805, 0.4394, 0.7397], [0.8293, 0.2636, 0.8789, 0.9342], [0.3471, 0.5926, 0.731, 0.9829], [0.7297, 0.2939, 0.1968, 0.623], [0.6971, 0.7989, 0.6564, 0.577], [0.0519, 0.3705, 0.8966, 0.8938], [0.7011, 0.5049, 0.2071, 0.6673], [0.0386, 0.9724, 0.3335, 0.1261], [0.7543, 0.4068, 0.633, 0.4287], [0.0155, 0.8309, 0.4198, 0.3613], [0.6228, 0.0139, 0.4132, 0.5411], [0.1798, 0.0965, 0.4012, 0.6527], [0.5374, 0.4916, 0.7214, 0.7118], [0.7741, 0.6705, 0.9258, 0.3402], [0.7537, 0.0774, 0.0446, 0.5627]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con56016').set_weights(w) 
in0Sub3247 = tf.constant([[[0.2177, 0.5218, 0.6569], [0.2853, 0.3935, 0.4838], [0.9121, 0.484, 0.0435]]])
in1Sub3247 = tf.constant([[[0.4169, 0.3841, 0.8694], [0.4117, 0.4098, 0.4311], [0.8835, 0.7561, 0.5712]]])
print (np.array2string(model.predict([in0Sub3247,in1Sub3247],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con56016.png')

LSub3247 = subtract_layer([[[0.2177, 0.5218, 0.6569], [0.2853, 0.3935, 0.4838], [0.9121, 0.484, 0.0435]]], [[[0.4169, 0.3841, 0.8694], [0.4117, 0.4098, 0.4311], [0.8835, 0.7561, 0.5712]]], Sub3247), 
LRes10148 = reshape_layer(Sub3247, [3, 3, 1], Res10148), 
LRes46857 = reshape_layer(Res10148, [3, 3, 1, 1], Res46857), 
LZer74040 = zero_padding3D_layer(Res46857, 1, 1, 1, 1, 1, 1, Zer74040), 
LRes43400 = reshape_layer(Zer74040, [5, 5, 3], Res43400), 
LRes16698 = reshape_layer(Res43400, [5, 15], Res16698), 
LZer39928 = zero_padding1D_layer(Res16698, 1, 1, Zer39928), 
LCon56016 = conv1D_layer(Zer39928, 2,[[[0.2682, 0.1189, 0.6221, 0.0576], [0.4462, 0.4268, 0.1025, 0.8631], [0.2769, 0.7401, 0.1631, 0.2065], [0.9853, 0.4134, 0.5771, 0.5102], [0.113, 0.231, 0.0287, 0.1668], [0.4598, 0.7569, 0.2112, 0.1684], [0.919, 0.2145, 0.9942, 0.3658], [0.5094, 0.4141, 0.9935, 0.0477], [0.283, 0.2259, 0.0134, 0.9008], [0.9444, 0.1021, 0.2591, 0.3096], [0.9566, 0.1958, 0.9164, 0.3844], [0.6283, 0.6913, 0.6855, 0.0707], [0.1769, 0.0667, 0.1186, 0.1836], [0.0455, 0.1409, 0.1614, 0.2371], [0.8157, 0.9231, 0.127, 0.4929]], [[0.9003, 0.4805, 0.4394, 0.7397], [0.8293, 0.2636, 0.8789, 0.9342], [0.3471, 0.5926, 0.731, 0.9829], [0.7297, 0.2939, 0.1968, 0.623], [0.6971, 0.7989, 0.6564, 0.577], [0.0519, 0.3705, 0.8966, 0.8938], [0.7011, 0.5049, 0.2071, 0.6673], [0.0386, 0.9724, 0.3335, 0.1261], [0.7543, 0.4068, 0.633, 0.4287], [0.0155, 0.8309, 0.4198, 0.3613], [0.6228, 0.0139, 0.4132, 0.5411], [0.1798, 0.0965, 0.4012, 0.6527], [0.5374, 0.4916, 0.7214, 0.7118], [0.7741, 0.6705, 0.9258, 0.3402], [0.7537, 0.0774, 0.0446, 0.5627]]],[0, 0, 0, 0], 2, false, 1, Con56016), 
exec_layers([LSub3247,LRes10148,LRes46857,LZer74040,LRes43400,LRes16698,LZer39928,LCon56016],["Sub3247","Res10148","Res46857","Zer74040","Res43400","Res16698","Zer39928","Con56016"],Con56016,"Con56016")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.2115638, -0.1466997, -0.1302765, -0.1548156], [-0.6401738, -0.2093937, -0.7530948, -0.2110566]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.0],[-0.21156377999999987,-0.14669967999999994,-0.13027645999999984,-0.15481552999999998],[-0.64017376,-0.20939367,-0.7530948100000001,-0.21105657000000003]]]

Actual:   [[[0, 0, 0, 0], [-0.2115, -0.1466, -0.1302, -0.1548], [-0.6401, -0.2093, -0.753, -0.211]]]

Expected: [[[0, 0, 0, 0], [-0.2115, -0.1466, -0.1302, -0.1548], [-0.6401, -0.2093, -0.753, -0.211]]]