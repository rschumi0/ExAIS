import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max19646 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max19646 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con93966 = tf.keras.layers.Input(shape=([2, 1]))

Max19646 = keras.layers.Maximum(name = 'Max19646', )([in0Max19646,in1Max19646])
Res20912 = keras.layers.Reshape((1, 2), name = 'Res20912', )(Max19646)
Zer43902 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer43902', )(Res20912)
Con93966 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con93966', )(in0Con93966)
Sub27116 = keras.layers.Subtract(name = 'Sub27116', )([Zer43902,Con93966])
Res73595 = keras.layers.Reshape((2, 2, 1), name = 'Res73595', )(Sub27116)
Zer45774 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer45774', )(Res73595)
model = tf.keras.models.Model(inputs=[in0Max19646,in1Max19646,in0Con93966], outputs=Zer45774)
w = model.get_layer('Con93966').get_weights() 
w[0] = np.array([[[0.4463, 0.6166]]])
w[1] = np.array([0, 0])
model.get_layer('Con93966').set_weights(w) 
in0Max19646 = tf.constant([[[[0.6771, 0.731]]]])
in1Max19646 = tf.constant([[[[0.4364, 0.039]]]])
in0Con93966 = tf.constant([[[0.1066], [0.1425]]])
print (np.array2string(model.predict([in0Max19646,in1Max19646,in0Con93966],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer45774.png')

LMax19646 = maximum_layer([[[[[0.6771, 0.731]]]], [[[[0.4364, 0.039]]]]], Max19646), 
LRes20912 = reshape_layer(Max19646, [1, 2], Res20912), 
LZer43902 = zero_padding1D_layer(Res20912, 1, 0, Zer43902), 
LCon93966 = conv1D_layer([[[0.1066], [0.1425]]], 1,[[[0.4463, 0.6166]]],[0, 0], 1, false, 1, Con93966), 
LSub27116 = subtract_layer(Zer43902,Con93966, Sub27116), 
LRes73595 = reshape_layer(Sub27116, [2, 2, 1], Res73595), 
LZer45774 = zero_padding2D_layer(Res73595, 1, 1, 1, 1, Zer45774), 
exec_layers([LMax19646,LRes20912,LZer43902,LCon93966,LSub27116,LRes73595,LZer45774],["Max19646","Res20912","Zer43902","Con93966","Sub27116","Res73595","Zer45774"],Zer45774,"Zer45774")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0475756], [-0.0657296], [0.0000000]], [[0.0000000], [0.6135023], [0.6431345], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[-0.04757558],[-0.06572956],[0]],[[0],[0.61350225],[0.6431344999999999],[0]],[[0],[0],[0],[0]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [-0.0475], [-0.0657], [0]], [[0], [0.6136], [0.6432], [0]], [[0], [0], [0], [0]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [-0.0475], [-0.0657], [0]], [[0], [0.6136], [0.6432], [0]], [[0], [0], [0], [0]]]]