import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat42731 = tf.keras.layers.Input(shape=([3, 3]))
in0Con65379 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Max52064 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max52064 = tf.keras.layers.Input(shape=([1, 1, 2]))

Bat42731 = keras.layers.BatchNormalization(axis=1, epsilon=0.4071486552519913,  name = 'Bat42731', )(in0Bat42731)
Thr76527 = keras.layers.ThresholdedReLU(theta=5.830896082280614, name = 'Thr76527', )(Bat42731)
Res59512 = keras.layers.Reshape((3, 3, 1), name = 'Res59512', )(Thr76527)
Con65379 = keras.layers.Concatenate(axis=3, name = 'Con65379', )([Res59512,in0Con65379])
Max52064 = keras.layers.Maximum(name = 'Max52064', )([in0Max52064,in1Max52064])
Zer39885 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer39885', )(Max52064)
Min5042 = keras.layers.Minimum(name = 'Min5042', )([Con65379,Zer39885])
model = tf.keras.models.Model(inputs=[in0Bat42731,in0Con65379,in0Max52064,in1Max52064], outputs=Min5042)
w = model.get_layer('Bat42731').get_weights() 
w[0] = np.array([0.7068, 0.0512, 0.588])
w[1] = np.array([0.5975, 0.7389, 0.3235])
w[2] = np.array([0.9998, 0.8407, 0.7656])
w[3] = np.array([0.4376, 0.9069, 0.5725])
model.get_layer('Bat42731').set_weights(w) 
in0Bat42731 = tf.constant([[[1.5596, 1.8278, 1.7295], [1.89, 1.4905, 1.3677], [1.6192, 1.1297, 1.3451]]])
in0Con65379 = tf.constant([[[[0.4094], [0.8685], [0.7522]], [[0.0056], [0.763], [0.5012]], [[0.7012], [0.4471], [0.1495]]]])
in0Max52064 = tf.constant([[[[0.7181, 0.0177]]]])
in1Max52064 = tf.constant([[[[0.3634, 0.0095]]]])
print (np.array2string(model.predict([in0Bat42731,in0Con65379,in0Max52064,in1Max52064],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min5042.png')

LBat42731 = batch_normalization_layer([[[1.5596, 1.8278, 1.7295], [1.89, 1.4905, 1.3677], [1.6192, 1.1297, 1.3451]]], 1, 0.4071486552519913, [0.7068, 0.0512, 0.588], [0.5975, 0.7389, 0.3235], [0.9998, 0.8407, 0.7656], [0.4376, 0.9069, 0.5725], Bat42731), 
LThr76527 = thresholded_relu_layer(Bat42731, 5.830896082280614, Thr76527), 
LRes59512 = reshape_layer(Thr76527, [3, 3, 1], Res59512), 
LCon65379 = concatenate_layer([Res59512,[[[[0.4094], [0.8685], [0.7522]], [[0.0056], [0.763], [0.5012]], [[0.7012], [0.4471], [0.1495]]]]], 3, Con65379), 
LMax52064 = maximum_layer([[[[[0.7181, 0.0177]]]], [[[[0.3634, 0.0095]]]]], Max52064), 
LZer39885 = zero_padding2D_layer(Max52064, 2, 0, 2, 0, Zer39885), 
LMin5042 = minimum_layer([Con65379,Zer39885], Min5042), 
exec_layers([LBat42731,LThr76527,LRes59512,LCon65379,LMax52064,LZer39885,LMin5042],["Bat42731","Thr76527","Res59512","Con65379","Max52064","Zer39885","Min5042"],Min5042,"Min5042")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0177000]]]]

Expected (Unparsed): [[[[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0]],[[0,0],[0,0],[0,0.0177]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0.0177]]]]

Expected: [[[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0.0177]]]]