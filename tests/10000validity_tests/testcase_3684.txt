import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay85350 = tf.keras.layers.Input(shape=([4]))
in0Con63718 = tf.keras.layers.Input(shape=([4, 1]))
in0ReL95588 = tf.keras.layers.Input(shape=([2, 2]))
in0Con80740 = tf.keras.layers.Input(shape=([4, 2]))
in0Mul22193 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul22193 = tf.keras.layers.Input(shape=([2, 1]))
in0Con7750 = tf.keras.layers.Input(shape=([2, 3]))
in0Min68730 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Min68730 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Ave40714 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave40714 = tf.keras.layers.Input(shape=([1, 1]))
in0Con31706 = tf.keras.layers.Input(shape=([2, 3]))

Lay85350 = keras.layers.LayerNormalization(axis=1, epsilon=2.304845363749748, name = 'Lay85350', )(in0Lay85350)
Res41882 = keras.layers.Reshape((4, 1), name = 'Res41882', )(Lay85350)
Con63718 = keras.layers.Concatenate(axis=2, name = 'Con63718', )([Res41882,in0Con63718])
ReL95588 = keras.layers.ReLU(max_value=4.890301556447844, negative_slope=3.6006340685214253, threshold=7.698139183281352, name = 'ReL95588', input_shape=(2, 2))(in0ReL95588)
Zer36577 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer36577', )(ReL95588)
Max55316 = keras.layers.Maximum(name = 'Max55316', )([Con63718,Zer36577])
Con80740 = keras.layers.Concatenate(axis=2, name = 'Con80740', )([Max55316,in0Con80740])
Mul22193 = keras.layers.Multiply(name = 'Mul22193', )([in0Mul22193,in1Mul22193])
Fla81704 = keras.layers.Flatten(name = 'Fla81704', )(Mul22193)
Res28509 = keras.layers.Reshape((2, 1), name = 'Res28509', )(Fla81704)
Con7750 = keras.layers.Concatenate(axis=2, name = 'Con7750', )([Res28509,in0Con7750])
Min68730 = keras.layers.Minimum(name = 'Min68730', )([in0Min68730,in1Min68730])
Res44679 = keras.layers.Reshape((2, 4), name = 'Res44679', )(Min68730)
Ave40714 = keras.layers.Average(name = 'Ave40714', )([in0Ave40714,in1Ave40714])
Zer16757 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer16757', )(Ave40714)
Con31706 = keras.layers.Concatenate(axis=2, name = 'Con31706', )([Zer16757,in0Con31706])
Mul63820 = keras.layers.Multiply(name = 'Mul63820', )([Res44679,Con31706])
Ave47069 = keras.layers.Average(name = 'Ave47069', )([Con7750,Mul63820])
Zer83777 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer83777', )(Ave47069)
Min61224 = keras.layers.Minimum(name = 'Min61224', )([Con80740,Zer83777])
model = tf.keras.models.Model(inputs=[in0Lay85350,in0Con63718,in0ReL95588,in0Con80740,in0Mul22193,in1Mul22193,in0Con7750,in0Min68730,in1Min68730,in0Ave40714,in1Ave40714,in0Con31706], outputs=Min61224)
in0Lay85350 = tf.constant([[1.5265, 1.1583, 1.6674, 1.9958]])
in0Con63718 = tf.constant([[[0.0138], [0.4375], [0.1908], [0.2849]]])
in0ReL95588 = tf.constant([[[0.0575, 0.8053], [0.6963, 0.5839]]])
in0Con80740 = tf.constant([[[0.7743, 0.9383], [0.7499, 0.1876], [0.8514, 0.3119], [0.3536, 0.6975]]])
in0Mul22193 = tf.constant([[[0.5164], [0.0546]]])
in1Mul22193 = tf.constant([[[0.4544], [0.6367]]])
in0Con7750 = tf.constant([[[0.0645, 0.711, 0.9616], [0.9262, 0.3026, 0.5382]]])
in0Min68730 = tf.constant([[[[0.3019, 0.4761], [0.1361, 0.4457]], [[0.9949, 0.3735], [0.5391, 0.2824]]]])
in1Min68730 = tf.constant([[[[0.9098, 0.5476], [0.3146, 0.4737]], [[0.1433, 0.4327], [0.5099, 0.9187]]]])
in0Ave40714 = tf.constant([[[0.0193]]])
in1Ave40714 = tf.constant([[[0.3956]]])
in0Con31706 = tf.constant([[[0.013, 0.7879, 0.022], [0.1765, 0.0891, 0.238]]])
print (np.array2string(model.predict([in0Lay85350,in0Con63718,in0ReL95588,in0Con80740,in0Mul22193,in1Mul22193,in0Con7750,in0Min68730,in1Min68730,in0Ave40714,in1Ave40714,in0Con31706],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min61224.png')

LLay85350 = layer_normalization_layer([[1.5265, 1.1583, 1.6674, 1.9958]], 1, 2.304845363749748, Lay85350), 
LRes41882 = reshape_layer(Lay85350, [4, 1], Res41882), 
LCon63718 = concatenate_layer([Res41882,[[[0.0138], [0.4375], [0.1908], [0.2849]]]], 2, Con63718), 
LReL95588 = relu_layer([[[0.0575, 0.8053], [0.6963, 0.5839]]], 4.890301556447844, 3.6006340685214253, 7.698139183281352, ReL95588), 
LZer36577 = zero_padding1D_layer(ReL95588, 2, 0, Zer36577), 
LMax55316 = maximum_layer([Con63718,Zer36577], Max55316), 
LCon80740 = concatenate_layer([Max55316,[[[0.7743, 0.9383], [0.7499, 0.1876], [0.8514, 0.3119], [0.3536, 0.6975]]]], 2, Con80740), 
LMul22193 = multiply_layer([[[[0.5164], [0.0546]]], [[[0.4544], [0.6367]]]], Mul22193), 
LFla81704 = flatten_layer(Mul22193, Fla81704), 
LRes28509 = reshape_layer(Fla81704, [2, 1], Res28509), 
LCon7750 = concatenate_layer([Res28509,[[[0.0645, 0.711, 0.9616], [0.9262, 0.3026, 0.5382]]]], 2, Con7750), 
LMin68730 = minimum_layer([[[[[0.3019, 0.4761], [0.1361, 0.4457]], [[0.9949, 0.3735], [0.5391, 0.2824]]]], [[[[0.9098, 0.5476], [0.3146, 0.4737]], [[0.1433, 0.4327], [0.5099, 0.9187]]]]], Min68730), 
LRes44679 = reshape_layer(Min68730, [2, 4], Res44679), 
LAve40714 = average_layer([[[[0.0193]]], [[[0.3956]]]], Ave40714), 
LZer16757 = zero_padding1D_layer(Ave40714, 1, 0, Zer16757), 
LCon31706 = concatenate_layer([Zer16757,[[[0.013, 0.7879, 0.022], [0.1765, 0.0891, 0.238]]]], 2, Con31706), 
LMul63820 = multiply_layer([Res44679,Con31706], Mul63820), 
LAve47069 = average_layer([Con7750,Mul63820], Ave47069), 
LZer83777 = zero_padding1D_layer(Ave47069, 2, 0, Zer83777), 
LMin61224 = minimum_layer([Con80740,Zer83777], Min61224), 
exec_layers([LLay85350,LRes41882,LCon63718,LReL95588,LZer36577,LMax55316,LCon80740,LMul22193,LFla81704,LRes28509,LCon7750,LMin68730,LRes44679,LAve40714,LZer16757,LCon31706,LMul63820,LAve47069,LZer83777,LMin61224],["Lay85350","Res41882","Con63718","ReL95588","Zer36577","Max55316","Con80740","Mul22193","Fla81704","Res28509","Con7750","Min68730","Res44679","Ave40714","Zer16757","Con31706","Mul63820","Ave47069","Zer83777","Min61224"],Min61224,"Min61224")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0519510, 0.0353446, 0.4091166, 0.3119000], [0.0322457, 0.2849000, 0.1740160, 0.3027056]]]

Expected (Unparsed): [[[0,0,0,0],[0,0,0,0],[0.0519510183208552,0.03534465,0.40911659499999997,0.3119],[0.0322457025,0.2849,0.17401604499999998,0.3027056]]]

Actual:   [[[0, 0, 0, 0], [0, 0, 0, 0], [0.052, 0.0354, 0.4092, 0.3119], [0.0323, 0.2849, 0.1741, 0.3028]]]

Expected: [[[0, 0, 0, 0], [0, 0, 0, 0], [0.052, 0.0354, 0.4092, 0.3119], [0.0323, 0.2849, 0.1741, 0.3028]]]