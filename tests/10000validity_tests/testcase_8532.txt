import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo88573 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul20820 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Mul20820 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Max55723 = tf.keras.layers.Input(shape=([1, 2]))
in1Max55723 = tf.keras.layers.Input(shape=([1, 2]))

Glo88573 = keras.layers.GlobalMaxPool1D(name = 'Glo88573', )(in0Glo88573)
Res78784 = keras.layers.Reshape((2, 1), name = 'Res78784', )(Glo88573)
Res8416 = keras.layers.Reshape((2, 1, 1), name = 'Res8416', )(Res78784)
Zer14744 = keras.layers.ZeroPadding2D(padding=((1, 0), (3, 0)), name = 'Zer14744', )(Res8416)
Mul20820 = keras.layers.Multiply(name = 'Mul20820', )([in0Mul20820,in1Mul20820])
Res98487 = keras.layers.Reshape((2, 1, 2), name = 'Res98487', )(Mul20820)
Res92160 = keras.layers.Reshape((2, 2), name = 'Res92160', )(Res98487)
Ave27597 = keras.layers.AveragePooling1D(pool_size=(2), strides=(11), padding='same', name = 'Ave27597', )(Res92160)
Max55723 = keras.layers.Maximum(name = 'Max55723', )([in0Max55723,in1Max55723])
Sub89269 = keras.layers.Subtract(name = 'Sub89269', )([Ave27597,Max55723])
Res99060 = keras.layers.Reshape((1, 2, 1), name = 'Res99060', )(Sub89269)
Zer52113 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer52113', )(Res99060)
Sub51450 = keras.layers.Subtract(name = 'Sub51450', )([Zer14744,Zer52113])
model = tf.keras.models.Model(inputs=[in0Glo88573,in0Mul20820,in1Mul20820,in0Max55723,in1Max55723], outputs=Sub51450)
in0Glo88573 = tf.constant([[[1.0131, 1.631], [1.8184, 1.747]]])
in0Mul20820 = tf.constant([[[[[0.608, 0.9572]]], [[[0.4744, 0.9679]]]]])
in1Mul20820 = tf.constant([[[[[0.9918, 0.3613]]], [[[0.5663, 0.4598]]]]])
in0Max55723 = tf.constant([[[0.2513, 0.0477]]])
in1Max55723 = tf.constant([[[0.575, 0.294]]])
print (np.array2string(model.predict([in0Glo88573,in0Mul20820,in1Mul20820,in0Max55723,in1Max55723],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub51450.png')

LGlo88573 = global_max_pool1D_layer([[[1.0131, 1.631], [1.8184, 1.747]]], Glo88573), 
LRes78784 = reshape_layer(Glo88573, [2, 1], Res78784), 
LRes8416 = reshape_layer(Res78784, [2, 1, 1], Res8416), 
LZer14744 = zero_padding2D_layer(Res8416, 1, 0, 3, 0, Zer14744), 
LMul20820 = multiply_layer([[[[[[0.608, 0.9572]]], [[[0.4744, 0.9679]]]]], [[[[[0.9918, 0.3613]]], [[[0.5663, 0.4598]]]]]], Mul20820), 
LRes98487 = reshape_layer(Mul20820, [2, 1, 2], Res98487), 
LRes92160 = reshape_layer(Res98487, [2, 2], Res92160), 
LAve27597 = average_pooling1D_layer(Res92160, 2, 11, true, Ave27597), 
LMax55723 = maximum_layer([[[[0.2513, 0.0477]]], [[[0.575, 0.294]]]], Max55723), 
LSub89269 = subtract_layer(Ave27597,Max55723, Sub89269), 
LRes99060 = reshape_layer(Sub89269, [1, 2, 1], Res99060), 
LZer52113 = zero_padding2D_layer(Res99060, 1, 1, 1, 1, Zer52113), 
LSub51450 = subtract_layer(Zer14744,Zer52113, Sub51450), 
exec_layers([LGlo88573,LRes78784,LRes8416,LZer14744,LMul20820,LRes98487,LRes92160,LAve27597,LMax55723,LSub89269,LRes99060,LZer52113,LSub51450],["Glo88573","Res78784","Res8416","Zer14744","Mul20820","Res98487","Res92160","Ave27597","Max55723","Sub89269","Res99060","Zer52113","Sub51450"],Sub51450,"Sub51450")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.1391664], [-0.1014384], [1.8184000]], [[0.0000000], [0.0000000], [0.0000000], [1.7470000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[0.13916644],[-0.10143839000000004],[1.8184]],[[0],[0],[0],[1.747]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [0.1392], [-0.1014], [1.8184]], [[0], [0], [0], [1.747]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [0.1392], [-0.1014], [1.8184]], [[0], [0], [0], [1.747]]]]