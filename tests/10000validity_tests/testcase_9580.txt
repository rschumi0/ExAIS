import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max89131 = tf.keras.layers.Input(shape=([2, 2]))
in0Con81416 = tf.keras.layers.Input(shape=([1, 4]))
in0Up_99382 = tf.keras.layers.Input(shape=([4, 3, 2]))

Max89131 = keras.layers.MaxPool1D(pool_size=(1), strides=(2), padding='valid', name = 'Max89131', )(in0Max89131)
Con81416 = keras.layers.Concatenate(axis=2, name = 'Con81416', )([Max89131,in0Con81416])
Up_99382 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_99382', )(in0Up_99382)
Ave35169 = keras.layers.AveragePooling2D(pool_size=(1, 2), name = 'Ave35169', )(Up_99382)
Res20070 = keras.layers.Reshape((4, 6), name = 'Res20070', )(Ave35169)
Ave10015 = keras.layers.AveragePooling1D(pool_size=(2), strides=(4), padding='valid', name = 'Ave10015', )(Res20070)
Mul25991 = keras.layers.Multiply(name = 'Mul25991', )([Con81416,Ave10015])
model = tf.keras.models.Model(inputs=[in0Max89131,in0Con81416,in0Up_99382], outputs=Mul25991)
in0Max89131 = tf.constant([[[1.0585, 1.697], [1.5648, 1.6008]]])
in0Con81416 = tf.constant([[[0.9722, 0.1366, 0.6524, 0.6133]]])
in0Up_99382 = tf.constant([[[[1.514, 1.8209], [1.1123, 1.114], [1.9395, 1.9793]], [[1.2438, 1.0235], [1.1618, 1.3389], [1.4412, 1.751]], [[1.1588, 1.7863], [1.2372, 1.9273], [1.5869, 1.8241]], [[1.7242, 1.3314], [1.213, 1.5972], [1.1909, 1.5647]]]])
print (np.array2string(model.predict([in0Max89131,in0Con81416,in0Up_99382],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul25991.png')

LMax89131 = max_pool1D_layer([[[1.0585, 1.697], [1.5648, 1.6008]]], 1, 2, false, Max89131), 
LCon81416 = concatenate_layer([Max89131,[[[0.9722, 0.1366, 0.6524, 0.6133]]]], 2, Con81416), 
LUp_99382 = up_sampling2D_layer([[[[1.514, 1.8209], [1.1123, 1.114], [1.9395, 1.9793]], [[1.2438, 1.0235], [1.1618, 1.3389], [1.4412, 1.751]], [[1.1588, 1.7863], [1.2372, 1.9273], [1.5869, 1.8241]], [[1.7242, 1.3314], [1.213, 1.5972], [1.1909, 1.5647]]]], 1, 2, Up_99382), 
LAve35169 = average_pooling2D_layer(Up_99382, 1, 2, Ave35169), 
LRes20070 = reshape_layer(Ave35169, [4, 6], Res20070), 
LAve10015 = average_pooling1D_layer(Res20070, 2, 4, false, Ave10015), 
LMul25991 = multiply_layer([Con81416,Ave10015], Mul25991), 
exec_layers([LMax89131,LCon81416,LUp_99382,LAve35169,LRes20070,LAve10015,LMul25991],["Max89131","Con81416","Up_99382","Ave35169","Res20070","Ave10015","Mul25991"],Mul25991,"Mul25991")

Actual (Unparsed): [[[1.4595658, 2.4134734, 1.1054400, 0.1675331, 1.1027844, 1.1438966]]]

Expected (Unparsed): [[[1.45956565,2.4134734000000004,1.10544001,0.16753307,1.10278434,1.143896495]]]

Actual:   [[[1.4596, 2.4135, 1.1055, 0.1676, 1.1028, 1.1439]]]

Expected: [[[1.4596, 2.4135, 1.1055, 0.1676, 1.1028, 1.1439]]]