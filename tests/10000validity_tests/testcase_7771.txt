import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro41560 = tf.keras.layers.Input(shape=([2, 2, 4]))
in0Add13994 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add13994 = tf.keras.layers.Input(shape=([2, 2, 1]))

Cro41560 = keras.layers.Cropping2D(cropping=((1, 0), (1, 0)), name = 'Cro41560', )(in0Cro41560)
Res85305 = keras.layers.Reshape((1, 4), name = 'Res85305', )(Cro41560)
Zer79819 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer79819', )(Res85305)
Res45879 = keras.layers.Reshape((3, 4, 1), name = 'Res45879', )(Zer79819)
Res80248 = keras.layers.Reshape((3, 4, 1, 1), name = 'Res80248', )(Res45879)
Up_57687 = keras.layers.UpSampling3D(size=(2, 1, 1), name = 'Up_57687', )(Res80248)
Res96105 = keras.layers.Reshape((6, 4, 1), name = 'Res96105', )(Up_57687)
Add13994 = keras.layers.Add(name = 'Add13994', )([in0Add13994,in1Add13994])
Zer83478 = keras.layers.ZeroPadding2D(padding=((4, 0), (2, 0)), name = 'Zer83478', )(Add13994)
Mul28704 = keras.layers.Multiply(name = 'Mul28704', )([Res96105,Zer83478])
model = tf.keras.models.Model(inputs=[in0Cro41560,in0Add13994,in1Add13994], outputs=Mul28704)
in0Cro41560 = tf.constant([[[[1.9281, 1.0705, 1.5563, 1.4671], [1.4919, 1.8069, 1.3165, 1.9431]], [[1.3107, 1.1989, 1.9784, 1.1845], [1.4304, 1.5306, 1.2937, 1.4104]]]])
in0Add13994 = tf.constant([[[[0.4279], [0.7468]], [[0.2967], [0.5174]]]])
in1Add13994 = tf.constant([[[[0.8126], [0.5335]], [[0.1019], [0.3776]]]])
print (np.array2string(model.predict([in0Cro41560,in0Add13994,in1Add13994],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul28704.png')

LCro41560 = cropping2D_layer([[[[1.9281, 1.0705, 1.5563, 1.4671], [1.4919, 1.8069, 1.3165, 1.9431]], [[1.3107, 1.1989, 1.9784, 1.1845], [1.4304, 1.5306, 1.2937, 1.4104]]]], 1, 0, 1, 0, Cro41560), 
LRes85305 = reshape_layer(Cro41560, [1, 4], Res85305), 
LZer79819 = zero_padding1D_layer(Res85305, 2, 0, Zer79819), 
LRes45879 = reshape_layer(Zer79819, [3, 4, 1], Res45879), 
LRes80248 = reshape_layer(Res45879, [3, 4, 1, 1], Res80248), 
LUp_57687 = up_sampling3D_layer(Res80248, 2, 1, 1, Up_57687), 
LRes96105 = reshape_layer(Up_57687, [6, 4, 1], Res96105), 
LAdd13994 = add_layer([[[[[0.4279], [0.7468]], [[0.2967], [0.5174]]]], [[[[0.8126], [0.5335]], [[0.1019], [0.3776]]]]], Add13994), 
LZer83478 = zero_padding2D_layer(Add13994, 4, 0, 2, 0, Zer83478), 
LMul28704 = multiply_layer([Res96105,Zer83478], Mul28704), 
exec_layers([LCro41560,LRes85305,LZer79819,LRes45879,LRes80248,LUp_57687,LRes96105,LAdd13994,LZer83478,LMul28704],["Cro41560","Res85305","Zer79819","Res45879","Res80248","Up_57687","Res96105","Add13994","Zer83478","Mul28704"],Mul28704,"Mul28704")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [1.6048348], [1.8057352]], [[0.0000000], [0.0000000], [0.5156688], [1.2623081]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0.0],[0.0],[1.60483485],[1.80573512]],[[0.0],[0.0],[0.51566882],[1.2623080000000002]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [1.6049], [1.8058]], [[0], [0], [0.5157], [1.2624]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [1.6049], [1.8058]], [[0], [0], [0.5157], [1.2624]]]]