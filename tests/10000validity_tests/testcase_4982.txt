import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add56347 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Add56347 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Ave29130 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Ave29130 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Add56347 = keras.layers.Add(name = 'Add56347', )([in0Add56347,in1Add56347])
Res81657 = keras.layers.Reshape((1, 2, 1), name = 'Res81657', )(Add56347)
Max94059 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max94059', )(Res81657)
Res5715 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res5715', )(Max94059)
Zer31585 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer31585', )(Res5715)
Ave29130 = keras.layers.Average(name = 'Ave29130', )([in0Ave29130,in1Ave29130])
Zer18106 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer18106', )(Ave29130)
Max72192 = keras.layers.Maximum(name = 'Max72192', )([Zer31585,Zer18106])
model = tf.keras.models.Model(inputs=[in0Add56347,in1Add56347,in0Ave29130,in1Ave29130], outputs=Max72192)
in0Add56347 = tf.constant([[[[[0.9846]], [[0.503]]]]])
in1Add56347 = tf.constant([[[[[0.0333]], [[0.1678]]]]])
in0Ave29130 = tf.constant([[[[[0.9769], [0.1128]]], [[[0.589], [0.837]]]]])
in1Ave29130 = tf.constant([[[[[0.5225], [0.6735]]], [[[0.8518], [0.136]]]]])
print (np.array2string(model.predict([in0Add56347,in1Add56347,in0Ave29130,in1Ave29130],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max72192.png')

LAdd56347 = add_layer([[[[[[0.9846]], [[0.503]]]]], [[[[[0.0333]], [[0.1678]]]]]], Add56347), 
LRes81657 = reshape_layer(Add56347, [1, 2, 1], Res81657), 
LMax94059 = max_pool2D_layer(Res81657, 1, 1, Max94059), 
LRes5715 = reshape_layer(Max94059, [1, 2, 1, 1], Res5715), 
LZer31585 = zero_padding3D_layer(Res5715, 1, 0, 1, 0, 1, 0, Zer31585), 
LAve29130 = average_layer([[[[[[0.9769], [0.1128]]], [[[0.589], [0.837]]]]], [[[[[0.5225], [0.6735]]], [[[0.8518], [0.136]]]]]], Ave29130), 
LZer18106 = zero_padding3D_layer(Ave29130, 0, 0, 2, 0, 0, 0, Zer18106), 
LMax72192 = maximum_layer([Zer31585,Zer18106], Max72192), 
exec_layers([LAdd56347,LRes81657,LMax94059,LRes5715,LZer31585,LAve29130,LZer18106,LMax72192],["Add56347","Res81657","Max94059","Res5715","Zer31585","Ave29130","Zer18106","Max72192"],Max72192,"Max72192")

Actual (Unparsed): [[[[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.7497000], [0.3931500]]], [[[0.0000000], [0.0000000]], [[0.0000000], [1.0179000]], [[0.7204000], [0.6708000]]]]]

Expected (Unparsed): [[[[[0],[0]],[[0],[0]],[[0.7497],[0.39315]]],[[[0],[0]],[[0],[1.0179]],[[0.7203999999999999],[0.6708000000000001]]]]]

Actual:   [[[[[0], [0]], [[0], [0]], [[0.7497], [0.3932]]], [[[0], [0]], [[0], [1.0179]], [[0.7204], [0.6708]]]]]

Expected: [[[[[0], [0]], [[0], [0]], [[0.7497], [0.3932]]], [[[0], [0]], [[0], [1.0179]], [[0.7204], [0.6709]]]]]