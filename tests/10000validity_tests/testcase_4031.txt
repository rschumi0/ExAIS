import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot35459 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot35459 = tf.keras.layers.Input(shape=([2, 2]))

Dot35459 = keras.layers.Dot(axes=(2, 2), name = 'Dot35459', )([in0Dot35459,in1Dot35459])
GRU54861 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU54861', )(Dot35459)
model = tf.keras.models.Model(inputs=[in0Dot35459,in1Dot35459], outputs=GRU54861)
w = model.get_layer('GRU54861').get_weights() 
w[0] = np.array([[9, 8, 1], [5, 9, 8]])
w[1] = np.array([[2, 6, 6]])
w[2] = np.array([[8, 6, 8], [8, 10, 2]])
model.get_layer('GRU54861').set_weights(w) 
in0Dot35459 = tf.constant([[[0.3651, 0.0027], [0.4544, 0.056]]])
in1Dot35459 = tf.constant([[[0.1016, 0.3923], [0.6736, 0.0089]]])
print (np.array2string(model.predict([in0Dot35459,in1Dot35459],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU54861.png')

LDot35459 = dot_layer([[[0.3651, 0.0027], [0.4544, 0.056]]], [[[0.1016, 0.3923], [0.6736, 0.0089]]], 2, 2, Dot35459), 
LGRU54861 = gru_layer(Dot35459,[[9, 8, 1], [5, 9, 8]],[[2, 6, 6]],[[8, 6, 8], [8, 10, 2]], true, GRU54861), 
exec_layers([LDot35459,LGRU54861],["Dot35459","GRU54861"],GRU54861,"GRU54861")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[3.6497940249497645e-8]]

Actual:   [[0]]

Expected: [[0]]