import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave8987 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con97046 = tf.keras.layers.Input(shape=([1, 8]))
in0Sub7281 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub7281 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Loc13610 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con58612 = tf.keras.layers.Input(shape=([3, 3, 1]))

Ave8987 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Ave8987', )(in0Ave8987)
Res45132 = keras.layers.Reshape((1, 1), name = 'Res45132', )(Ave8987)
Con97046 = keras.layers.Concatenate(axis=2, name = 'Con97046', )([Res45132,in0Con97046])
Sub7281 = keras.layers.Subtract(name = 'Sub7281', )([in0Sub7281,in1Sub7281])
Loc13610 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(7, 5), name = 'Loc13610', )(in0Loc13610)
Lea55207 = keras.layers.LeakyReLU(alpha=4.116229043926257, name = 'Lea55207', )(Loc13610)
Zer35240 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer35240', )(Lea55207)
Con58612 = keras.layers.Concatenate(axis=3, name = 'Con58612', )([Zer35240,in0Con58612])
Mul61487 = keras.layers.Multiply(name = 'Mul61487', )([Sub7281,Con58612])
Res20691 = keras.layers.Reshape((3, 9), name = 'Res20691', )(Mul61487)
Dot85826 = keras.layers.Dot(axes=(2, 2), name = 'Dot85826', )([Con97046,Res20691])
model = tf.keras.models.Model(inputs=[in0Ave8987,in0Con97046,in0Sub7281,in1Sub7281,in0Loc13610,in0Con58612], outputs=Dot85826)
w = model.get_layer('Loc13610').get_weights() 
w[0] = np.array([[[0.4689, 0.5847], [0.6723, 0.5029]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc13610').set_weights(w) 
in0Ave8987 = tf.constant([[[[1.3355]]]])
in0Con97046 = tf.constant([[[0.1581, 0.1557, 0.0147, 0.2682, 0.5351, 0.2682, 0.3441, 0.2462]]])
in0Sub7281 = tf.constant([[[[0.5228, 0.1149, 0.5908], [0.2123, 0.2825, 0.9262], [0.41, 0.1043, 0.9851]], [[0.2476, 0.8216, 0.0111], [0.8025, 0.2215, 0.7356], [0.0498, 0.0273, 0.5516]], [[0.107, 0.517, 0.5192], [0.2376, 0.0613, 0.0258], [0.9518, 0.9229, 0.234]]]])
in1Sub7281 = tf.constant([[[[0.1714, 0.9178, 0.5353], [0.4714, 0.138, 0.4501], [0.0009, 0.3071, 0.1556]], [[0.7981, 0.9491, 0.1745], [0.7373, 0.3642, 0.4872], [0.1478, 0.185, 0.5478]], [[0.3218, 0.1112, 0.9377], [0.8715, 0.7329, 0.6501], [0.9542, 0.1709, 0.1626]]]])
in0Loc13610 = tf.constant([[[[0.6293, 0.4736], [0.8182, 0.4711]]]])
in0Con58612 = tf.constant([[[[0.2158], [0.4608], [0.048]], [[0.6416], [0.7697], [0.044]], [[0.2627], [0.1535], [0.1136]]]])
print (np.array2string(model.predict([in0Ave8987,in0Con97046,in0Sub7281,in1Sub7281,in0Loc13610,in0Con58612],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot85826.png')

LAve8987 = average_pooling2D_layer([[[[1.3355]]]], 1, 1, 1, 1, true, Ave8987), 
LRes45132 = reshape_layer(Ave8987, [1, 1], Res45132), 
LCon97046 = concatenate_layer([Res45132,[[[0.1581, 0.1557, 0.0147, 0.2682, 0.5351, 0.2682, 0.3441, 0.2462]]]], 2, Con97046), 
LSub7281 = subtract_layer([[[[0.5228, 0.1149, 0.5908], [0.2123, 0.2825, 0.9262], [0.41, 0.1043, 0.9851]], [[0.2476, 0.8216, 0.0111], [0.8025, 0.2215, 0.7356], [0.0498, 0.0273, 0.5516]], [[0.107, 0.517, 0.5192], [0.2376, 0.0613, 0.0258], [0.9518, 0.9229, 0.234]]]], [[[[0.1714, 0.9178, 0.5353], [0.4714, 0.138, 0.4501], [0.0009, 0.3071, 0.1556]], [[0.7981, 0.9491, 0.1745], [0.7373, 0.3642, 0.4872], [0.1478, 0.185, 0.5478]], [[0.3218, 0.1112, 0.9377], [0.8715, 0.7329, 0.6501], [0.9542, 0.1709, 0.1626]]]], Sub7281), 
LLoc13610 = locally_connected2D_layer([[[[0.6293, 0.4736], [0.8182, 0.4711]]]], 1, 1,[[[0.4689, 0.5847], [0.6723, 0.5029]]],[[[0, 0]]], 7, 5, Loc13610), 
LLea55207 = leaky_relu_layer(Loc13610, 4.116229043926257, Lea55207), 
LZer35240 = zero_padding2D_layer(Lea55207, 2, 0, 2, 0, Zer35240), 
LCon58612 = concatenate_layer([Zer35240,[[[[0.2158], [0.4608], [0.048]], [[0.6416], [0.7697], [0.044]], [[0.2627], [0.1535], [0.1136]]]]], 3, Con58612), 
LMul61487 = multiply_layer([Sub7281,Con58612], Mul61487), 
LRes20691 = reshape_layer(Mul61487, [3, 9], Res20691), 
LDot85826 = dot_layer(Con97046,Res20691, 2, 2, Dot85826), 
exec_layers([LAve8987,LRes45132,LCon97046,LSub7281,LLoc13610,LLea55207,LZer35240,LCon58612,LMul61487,LRes20691,LDot85826],["Ave8987","Res45132","Con97046","Sub7281","Loc13610","Lea55207","Zer35240","Con58612","Mul61487","Res20691","Dot85826"],Dot85826,"Dot85826")

Actual (Unparsed): [[[0.1290614, 0.0860256, 0.0900486]]]

Expected (Unparsed): [[[0.129061422018,0.08602560638000002,0.09004862665389599]]]

Actual:   [[[0.1291, 0.0861, 0.0901]]]

Expected: [[[0.1291, 0.0861, 0.0901]]]