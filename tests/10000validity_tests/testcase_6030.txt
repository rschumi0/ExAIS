import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max1584 = tf.keras.layers.Input(shape=([1, 1]))
in0Max9475 = tf.keras.layers.Input(shape=([1, 1]))
in1Max9475 = tf.keras.layers.Input(shape=([1, 1]))
in0Con2261 = tf.keras.layers.Input(shape=([3]))
in0Max37324 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max37324 = tf.keras.layers.Input(shape=([2, 2, 2]))

Max1584 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='same', name = 'Max1584', )(in0Max1584)
Per17809 = keras.layers.Permute((2,1), name = 'Per17809',)(Max1584)
Max9475 = keras.layers.Maximum(name = 'Max9475', )([in0Max9475,in1Max9475])
Sub81789 = keras.layers.Subtract(name = 'Sub81789', )([Per17809,Max9475])
Fla28402 = keras.layers.Flatten(name = 'Fla28402', )(Sub81789)
Con2261 = keras.layers.Concatenate(axis=1, name = 'Con2261', )([Fla28402,in0Con2261])
Max37324 = keras.layers.Maximum(name = 'Max37324', )([in0Max37324,in1Max37324])
Up_73679 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_73679', )(Max37324)
Res42590 = keras.layers.Reshape((4, 4), name = 'Res42590', )(Up_73679)
Glo67785 = keras.layers.GlobalMaxPool1D(name = 'Glo67785', )(Res42590)
Max18984 = keras.layers.Maximum(name = 'Max18984', )([Con2261,Glo67785])
model = tf.keras.models.Model(inputs=[in0Max1584,in0Max9475,in1Max9475,in0Con2261,in0Max37324,in1Max37324], outputs=Max18984)
in0Max1584 = tf.constant([[[1.3254]]])
in0Max9475 = tf.constant([[[0.6235]]])
in1Max9475 = tf.constant([[[0.1147]]])
in0Con2261 = tf.constant([[0.3833, 0.2173, 0.5872]])
in0Max37324 = tf.constant([[[[0.0621, 0.6358], [0.3254, 0.4199]], [[0.278, 0.6113], [0.0524, 0.3744]]]])
in1Max37324 = tf.constant([[[[0.5526, 0.2506], [0.9771, 0.8423]], [[0.3686, 0.5817], [0.1379, 0.3054]]]])
print (np.array2string(model.predict([in0Max1584,in0Max9475,in1Max9475,in0Con2261,in0Max37324,in1Max37324],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max18984.png')

LMax1584 = max_pool1D_layer([[[1.3254]]], 1, 1, true, Max1584), 
LPer17809 = permute_layer(Max1584, 2,1, Per17809), 
LMax9475 = maximum_layer([[[[0.6235]]], [[[0.1147]]]], Max9475), 
LSub81789 = subtract_layer(Per17809,Max9475, Sub81789), 
LFla28402 = flatten_layer(Sub81789, Fla28402), 
LCon2261 = concatenate_layer([Fla28402,[[0.3833, 0.2173, 0.5872]]], 1, Con2261), 
LMax37324 = maximum_layer([[[[[0.0621, 0.6358], [0.3254, 0.4199]], [[0.278, 0.6113], [0.0524, 0.3744]]]], [[[[0.5526, 0.2506], [0.9771, 0.8423]], [[0.3686, 0.5817], [0.1379, 0.3054]]]]], Max37324), 
LUp_73679 = up_sampling2D_layer(Max37324, 2, 1, Up_73679), 
LRes42590 = reshape_layer(Up_73679, [4, 4], Res42590), 
LGlo67785 = global_max_pool1D_layer(Res42590, Glo67785), 
LMax18984 = maximum_layer([Con2261,Glo67785], Max18984), 
exec_layers([LMax1584,LPer17809,LMax9475,LSub81789,LFla28402,LCon2261,LMax37324,LUp_73679,LRes42590,LGlo67785,LMax18984],["Max1584","Per17809","Max9475","Sub81789","Fla28402","Con2261","Max37324","Up_73679","Res42590","Glo67785","Max18984"],Max18984,"Max18984")

Actual (Unparsed): [[0.7019000, 0.6358000, 0.9771000, 0.8423000]]

Expected (Unparsed): [[0.7018999999999999,0.6358,0.9771,0.8423]]

Actual:   [[0.7019, 0.6358, 0.9771, 0.8423]]

Expected: [[0.7019, 0.6358, 0.9771, 0.8423]]