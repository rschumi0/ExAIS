import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro45127 = tf.keras.layers.Input(shape=([3, 4]))

Cro45127 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro45127', )(in0Cro45127)
Res1193 = keras.layers.Reshape((2, 4, 1), name = 'Res1193', )(Cro45127)
Con82593 = keras.layers.Conv2D(3, (2, 3),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con82593', )(Res1193)
Res65981 = keras.layers.Reshape((2, 12), name = 'Res65981', )(Con82593)
Max75492 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='same', name = 'Max75492', )(Res65981)
model = tf.keras.models.Model(inputs=[in0Cro45127], outputs=Max75492)
w = model.get_layer('Con82593').get_weights() 
w[0] = np.array([[[[0.6441, 0.9326, 0.9375]], [[0.5526, 0.5827, 0.4893]], [[0.4797, 0.4648, 0.2466]]], [[[0.9284, 0.3537, 0.9206]], [[0.7304, 0.1307, 0.348]], [[0.9561, 0.6929, 0.2551]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con82593').set_weights(w) 
in0Cro45127 = tf.constant([[[1.6615, 1.8548, 1.6475, 1.2438], [1.4124, 1.5621, 1.5132, 1.7586], [1.7443, 1.4533, 1.7853, 1.337]]])
print (np.array2string(model.predict([in0Cro45127],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max75492.png')

LCro45127 = cropping1D_layer([[[1.6615, 1.8548, 1.6475, 1.2438], [1.4124, 1.5621, 1.5132, 1.7586], [1.7443, 1.4533, 1.7853, 1.337]]], 1, 0, Cro45127), 
LRes1193 = reshape_layer(Cro45127, [2, 4, 1], Res1193), 
LCon82593 = conv2D_layer(Res1193, 2, 3,[[[[0.6441, 0.9326, 0.9375]], [[0.5526, 0.5827, 0.4893]], [[0.4797, 0.4648, 0.2466]]], [[[0.9284, 0.3537, 0.9206]], [[0.7304, 0.1307, 0.348]], [[0.9561, 0.6929, 0.2551]]]],[0, 0, 0], 1, 1, true, 1, 1, Con82593), 
LRes65981 = reshape_layer(Con82593, [2, 12], Res65981), 
LMax75492 = max_pool1D_layer(Res65981, 2, 1, true, Max75492), 
exec_layers([LCro45127,LRes1193,LCon82593,LRes65981,LMax75492],["Cro45127","Res1193","Con82593","Res65981","Max75492"],Max75492,"Max75492")

Actual (Unparsed): [[[4.1933685, 2.7840412, 2.0540544, 6.8866492, 4.9747149, 5.0285967, 6.6174760, 4.8297317, 4.9388094, 4.5804719, 3.2421531, 4.3879312], [1.6610482, 1.6918975, 1.2118698, 2.7830056, 3.3033795, 2.7866359, 2.5639862, 3.0170795, 2.5657203, 1.8887379, 2.4440407, 2.3279129]]]

Expected (Unparsed): [[[4.19336846,2.7840411400000002,2.05405441,6.88664911,4.974714860000001,5.02859666,6.617475890000001,4.8297316,4.9388093500000005,4.5804718,3.24215305,4.38793116],[1.66104819,1.69189745,1.21186977,2.7830056200000004,3.30337953,2.78663592,2.5639862100000004,3.0170794900000004,2.56572024,1.88873793,2.44404068,2.32791285]]]

Actual:   [[[4.1934, 2.7841, 2.0541, 6.8867, 4.9748, 5.0286, 6.6175, 4.8298, 4.9389, 4.5805, 3.2422, 4.388], [1.6611, 1.6919, 1.2119, 2.7831, 3.3034, 2.7867, 2.564, 3.0171, 2.5658, 1.8888, 2.4441, 2.328]]]

Expected: [[[4.1934, 2.7841, 2.0541, 6.8867, 4.9748, 5.0286, 6.6175, 4.8298, 4.9389, 4.5805, 3.2422, 4.388], [1.6611, 1.6919, 1.2119, 2.7831, 3.3034, 2.7867, 2.564, 3.0171, 2.5658, 1.8888, 2.4441, 2.328]]]