import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla37491 = tf.keras.layers.Input(shape=([3, 3]))

Fla37491 = keras.layers.Flatten(name = 'Fla37491', )(in0Fla37491)
Res25684 = keras.layers.Reshape((9, 1), name = 'Res25684', )(Fla37491)
Glo51407 = keras.layers.GlobalMaxPool1D(name = 'Glo51407', )(Res25684)
Res40027 = keras.layers.Reshape((1, 1), name = 'Res40027', )(Glo51407)
Res8483 = keras.layers.Reshape((1, 1, 1), name = 'Res8483', )(Res40027)
Res78012 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res78012', )(Res8483)
Glo59112 = keras.layers.GlobalMaxPool3D(name = 'Glo59112', )(Res78012)
Res54183 = keras.layers.Reshape((1, 1), name = 'Res54183', )(Glo59112)
GRU62669 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU62669', )(Res54183)
Res75451 = keras.layers.Reshape((2, 1), name = 'Res75451', )(GRU62669)
Res49863 = keras.layers.Reshape((2, 1, 1), name = 'Res49863', )(Res75451)
Res88935 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res88935', )(Res49863)
Cro47208 = keras.layers.Cropping3D(cropping=((1, 0), (0, 0), (0, 0)), name = 'Cro47208', )(Res88935)
model = tf.keras.models.Model(inputs=[in0Fla37491], outputs=Cro47208)
w = model.get_layer('GRU62669').get_weights() 
w[0] = np.array([[9, 9, 2, 4, 5, 2]])
w[1] = np.array([[8, 5, 9, 7, 7, 8], [6, 10, 3, 8, 1, 9]])
w[2] = np.array([8, 7, 7, 1, 1, 9])
model.get_layer('GRU62669').set_weights(w) 
in0Fla37491 = tf.constant([[[1.5538, 1.3561, 1.5256], [1.9996, 1.817, 1.1617], [1.0322, 1.5696, 1.9338]]])
print (np.array2string(model.predict([in0Fla37491],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro47208.png')

LFla37491 = flatten_layer([[[1.5538, 1.3561, 1.5256], [1.9996, 1.817, 1.1617], [1.0322, 1.5696, 1.9338]]], Fla37491), 
LRes25684 = reshape_layer(Fla37491, [9, 1], Res25684), 
LGlo51407 = global_max_pool1D_layer(Res25684, Glo51407), 
LRes40027 = reshape_layer(Glo51407, [1, 1], Res40027), 
LRes8483 = reshape_layer(Res40027, [1, 1, 1], Res8483), 
LRes78012 = reshape_layer(Res8483, [1, 1, 1, 1], Res78012), 
LGlo59112 = global_max_pool3D_layer(Res78012, Glo59112), 
LRes54183 = reshape_layer(Glo59112, [1, 1], Res54183), 
LGRU62669 = gru_layer(Res54183,[[9, 9, 2, 4, 5, 2]],[[8, 5, 9, 7, 7, 8], [6, 10, 3, 8, 1, 9]],[8, 7, 7, 1, 1, 9], false, GRU62669), 
LRes75451 = reshape_layer(GRU62669, [2, 1], Res75451), 
LRes49863 = reshape_layer(Res75451, [2, 1, 1], Res49863), 
LRes88935 = reshape_layer(Res49863, [2, 1, 1, 1], Res88935), 
LCro47208 = cropping3D_layer(Res88935, 1, 0, 0, 0, 0, 0, Cro47208), 
exec_layers([LFla37491,LRes25684,LGlo51407,LRes40027,LRes8483,LRes78012,LGlo59112,LRes54183,LGRU62669,LRes75451,LRes49863,LRes88935,LCro47208],["Fla37491","Res25684","Glo51407","Res40027","Res8483","Res78012","Glo59112","Res54183","GRU62669","Res75451","Res49863","Res88935","Cro47208"],Cro47208,"Cro47208")

Actual (Unparsed): [[[[[0.0000000]]]]]

Expected (Unparsed): [[[[[1.393796189560649e-11]]]]]

Actual:   [[[[[0]]]]]

Expected: [[[[[0]]]]]