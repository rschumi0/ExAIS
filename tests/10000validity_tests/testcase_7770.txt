import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub12205 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub12205 = tf.keras.layers.Input(shape=([3, 3]))

Sub12205 = keras.layers.Subtract(name = 'Sub12205', )([in0Sub12205,in1Sub12205])
Res92518 = keras.layers.Reshape((3, 3, 1), name = 'Res92518', )(Sub12205)
Glo22519 = keras.layers.GlobalMaxPool2D(name = 'Glo22519', )(Res92518)
Res51655 = keras.layers.Reshape((1, 1), name = 'Res51655', )(Glo22519)
Res1379 = keras.layers.Reshape((1, 1, 1), name = 'Res1379', )(Res51655)
Glo26878 = keras.layers.GlobalMaxPool2D(name = 'Glo26878', )(Res1379)
Lay31947 = keras.layers.LayerNormalization(axis=1, epsilon=1.0682665876605324, name = 'Lay31947', )(Glo26878)
model = tf.keras.models.Model(inputs=[in0Sub12205,in1Sub12205], outputs=Lay31947)
in0Sub12205 = tf.constant([[[0.1143, 0.7255, 0.3806], [0.2266, 0.1018, 0.01], [0.5274, 0.0164, 0.4546]]])
in1Sub12205 = tf.constant([[[0.7128, 0.2711, 0.2139], [0.837, 0.8711, 0.2673], [0.3233, 0.6235, 0.2486]]])
print (np.array2string(model.predict([in0Sub12205,in1Sub12205],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay31947.png')

LSub12205 = subtract_layer([[[0.1143, 0.7255, 0.3806], [0.2266, 0.1018, 0.01], [0.5274, 0.0164, 0.4546]]], [[[0.7128, 0.2711, 0.2139], [0.837, 0.8711, 0.2673], [0.3233, 0.6235, 0.2486]]], Sub12205), 
LRes92518 = reshape_layer(Sub12205, [3, 3, 1], Res92518), 
LGlo22519 = global_max_pool2D_layer(Res92518, Glo22519), 
LRes51655 = reshape_layer(Glo22519, [1, 1], Res51655), 
LRes1379 = reshape_layer(Res51655, [1, 1, 1], Res1379), 
LGlo26878 = global_max_pool2D_layer(Res1379, Glo26878), 
LLay31947 = layer_normalization_layer(Glo26878, 1, 1.0682665876605324, Lay31947), 
exec_layers([LSub12205,LRes92518,LGlo22519,LRes51655,LRes1379,LGlo26878,LLay31947],["Sub12205","Res92518","Glo22519","Res51655","Res1379","Glo26878","Lay31947"],Lay31947,"Lay31947")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0.0]]

Actual:   [[0]]

Expected: [[0]]