import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub71643 = tf.keras.layers.Input(shape=([2]))
in1Sub71643 = tf.keras.layers.Input(shape=([2]))

Sub71643 = keras.layers.Subtract(name = 'Sub71643', )([in0Sub71643,in1Sub71643])
Res26053 = keras.layers.Reshape((2, 1), name = 'Res26053', )(Sub71643)
Con21331 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con21331', )(Res26053)
model = tf.keras.models.Model(inputs=[in0Sub71643,in1Sub71643], outputs=Con21331)
w = model.get_layer('Con21331').get_weights() 
w[0] = np.array([[[0.2136, 0.6051, 0.2249, 0.3622]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con21331').set_weights(w) 
in0Sub71643 = tf.constant([[0.2634, 0.5285]])
in1Sub71643 = tf.constant([[0.3818, 0.2655]])
print (np.array2string(model.predict([in0Sub71643,in1Sub71643],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con21331.png')

LSub71643 = subtract_layer([[0.2634, 0.5285]], [[0.3818, 0.2655]], Sub71643), 
LRes26053 = reshape_layer(Sub71643, [2, 1], Res26053), 
LCon21331 = conv1D_layer(Res26053, 1,[[[0.2136, 0.6051, 0.2249, 0.3622]]],[0, 0, 0, 0], 1, true, 1, Con21331), 
exec_layers([LSub71643,LRes26053,LCon21331],["Sub71643","Res26053","Con21331"],Con21331,"Con21331")

Actual (Unparsed): [[[-0.0252902, -0.0716438, -0.0266282, -0.0428845], [0.0561768, 0.1591413, 0.0591487, 0.0952586]]]

Expected (Unparsed): [[[-0.02529023999999999,-0.07164383999999997,-0.026628159999999988,-0.04288447999999998],[0.05617679999999999,0.15914129999999996,0.059148699999999985,0.09525859999999998]]]

Actual:   [[[-0.0252, -0.0716, -0.0266, -0.0428], [0.0562, 0.1592, 0.0592, 0.0953]]]

Expected: [[[-0.0252, -0.0716, -0.0266, -0.0428], [0.0562, 0.1592, 0.0592, 0.0953]]]