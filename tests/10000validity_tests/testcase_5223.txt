import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave25014 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Ave25014 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Ave25014 = keras.layers.Average(name = 'Ave25014', )([in0Ave25014,in1Ave25014])
Res81472 = keras.layers.Reshape((2, 1, 1), name = 'Res81472', )(Ave25014)
Ave85746 = keras.layers.AveragePooling2D(pool_size=(2, 1), name = 'Ave85746', )(Res81472)
Bat70577 = keras.layers.BatchNormalization(axis=2, epsilon=0.9844981297325011,  name = 'Bat70577', )(Ave85746)
Lay78753 = keras.layers.LayerNormalization(axis=1, epsilon=2.3249117264684385, name = 'Lay78753', )(Bat70577)
model = tf.keras.models.Model(inputs=[in0Ave25014,in1Ave25014], outputs=Lay78753)
w = model.get_layer('Bat70577').get_weights() 
w[0] = np.array([0.3386])
w[1] = np.array([0.1918])
w[2] = np.array([0.5431])
w[3] = np.array([0.1969])
model.get_layer('Bat70577').set_weights(w) 
in0Ave25014 = tf.constant([[[[[0.429]]], [[[0.7716]]]]])
in1Ave25014 = tf.constant([[[[[0.6608]]], [[[0.2006]]]]])
print (np.array2string(model.predict([in0Ave25014,in1Ave25014],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay78753.png')

LAve25014 = average_layer([[[[[[0.429]]], [[[0.7716]]]]], [[[[[0.6608]]], [[[0.2006]]]]]], Ave25014), 
LRes81472 = reshape_layer(Ave25014, [2, 1, 1], Res81472), 
LAve85746 = average_pooling2D_layer(Res81472, 2, 1, Ave85746), 
LBat70577 = batch_normalization_layer(Ave85746, 2, 0.9844981297325011, [0.3386], [0.1918], [0.5431], [0.1969], Bat70577), 
LLay78753 = layer_normalization_layer(Bat70577, 1, 2.3249117264684385, Lay78753), 
exec_layers([LAve25014,LRes81472,LAve85746,LBat70577,LLay78753],["Ave25014","Res81472","Ave85746","Bat70577","Lay78753"],Lay78753,"Lay78753")

Actual (Unparsed): [[[[0.0000000]]]]

Expected (Unparsed): [[[[0.0]]]]

Actual:   [[[[0]]]]

Expected: [[[[0]]]]