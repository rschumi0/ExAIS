import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub92359 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub92359 = tf.keras.layers.Input(shape=([3, 2]))
in0Con12695 = tf.keras.layers.Input(shape=([3, 7]))
in0Sep2599 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Dot27461 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot27461 = tf.keras.layers.Input(shape=([2, 2]))
in0Con50395 = tf.keras.layers.Input(shape=([3, 6]))

Sub92359 = keras.layers.Subtract(name = 'Sub92359', )([in0Sub92359,in1Sub92359])
Con12695 = keras.layers.Concatenate(axis=2, name = 'Con12695', )([Sub92359,in0Con12695])
Sep2599 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep2599', )(in0Sep2599)
Zer64038 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer64038', )(Sep2599)
Res67265 = keras.layers.Reshape((3, 9), name = 'Res67265', )(Zer64038)
Dot27461 = keras.layers.Dot(axes=(1, 1), name = 'Dot27461', )([in0Dot27461,in1Dot27461])
Loc64971 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc64971', )(Dot27461)
Zer91965 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer91965', )(Loc64971)
Con50395 = keras.layers.Concatenate(axis=2, name = 'Con50395', )([Zer91965,in0Con50395])
Min53913 = keras.layers.Minimum(name = 'Min53913', )([Res67265,Con50395])
Mul13686 = keras.layers.Multiply(name = 'Mul13686', )([Con12695,Min53913])
model = tf.keras.models.Model(inputs=[in0Sub92359,in1Sub92359,in0Con12695,in0Sep2599,in0Dot27461,in1Dot27461,in0Con50395], outputs=Mul13686)
w = model.get_layer('Sep2599').get_weights() 
w[0] = np.array([[[[0.1268]]]])
w[1] = np.array([[[[0.8486, 0.1605, 0.5267]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep2599').set_weights(w) 
w = model.get_layer('Loc64971').get_weights() 
w[0] = np.array([[[0.5806, 0.0252, 0.7847], [0.9387, 0.8653, 0.5866], [0.6045, 0.6549, 0.5396], [0.843, 0.6288, 0.7739]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc64971').set_weights(w) 
in0Sub92359 = tf.constant([[[0.7756, 0.9148], [0.0265, 0.3586], [0.7874, 0.7889]]])
in1Sub92359 = tf.constant([[[0.9907, 0.3956], [0.8162, 0.6707], [0.0266, 0.1778]]])
in0Con12695 = tf.constant([[[0.7211, 0.169, 0.3207, 0.706, 0.5524, 0.0805, 0.0187], [0.9802, 0.4999, 0.9022, 0.8936, 0.2499, 0.8636, 0.9251], [0.72, 0.8908, 0.4357, 0.6476, 0.0497, 0.9092, 0.8366]]])
in0Sep2599 = tf.constant([[[[0.1849]]]])
in0Dot27461 = tf.constant([[[0.0675, 0.7444], [0.5922, 0.7085]]])
in1Dot27461 = tf.constant([[[0.3603, 0.1844], [0.6479, 0.8028]]])
in0Con50395 = tf.constant([[[0.7458, 0.369, 0.3352, 0.5407, 0.4009, 0.6525], [0.8714, 0.7546, 0.9161, 0.8776, 0.3945, 0.6667], [0.7934, 0.8504, 0.3097, 0.8639, 0.0258, 0.8063]]])
print (np.array2string(model.predict([in0Sub92359,in1Sub92359,in0Con12695,in0Sep2599,in0Dot27461,in1Dot27461,in0Con50395],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul13686.png')

LSub92359 = subtract_layer([[[0.7756, 0.9148], [0.0265, 0.3586], [0.7874, 0.7889]]], [[[0.9907, 0.3956], [0.8162, 0.6707], [0.0266, 0.1778]]], Sub92359), 
LCon12695 = concatenate_layer([Sub92359,[[[0.7211, 0.169, 0.3207, 0.706, 0.5524, 0.0805, 0.0187], [0.9802, 0.4999, 0.9022, 0.8936, 0.2499, 0.8636, 0.9251], [0.72, 0.8908, 0.4357, 0.6476, 0.0497, 0.9092, 0.8366]]]], 2, Con12695), 
LSep2599 = separable_conv2D_layer([[[[0.1849]]]], 1, 1,[[[[[0.1268]]]],[[[[0.8486, 0.1605, 0.5267]]]]],[0, 0, 0], 1, 1, true, Sep2599), 
LZer64038 = zero_padding2D_layer(Sep2599, 1, 1, 1, 1, Zer64038), 
LRes67265 = reshape_layer(Zer64038, [3, 9], Res67265), 
LDot27461 = dot_layer([[[0.0675, 0.7444], [0.5922, 0.7085]]], [[[0.3603, 0.1844], [0.6479, 0.8028]]], 1, 1, Dot27461), 
LLoc64971 = locally_connected1D_layer(Dot27461, 2,[[[0.5806, 0.0252, 0.7847], [0.9387, 0.8653, 0.5866], [0.6045, 0.6549, 0.5396], [0.843, 0.6288, 0.7739]]],[[0, 0, 0]], 1, Loc64971), 
LZer91965 = zero_padding1D_layer(Loc64971, 2, 0, Zer91965), 
LCon50395 = concatenate_layer([Zer91965,[[[0.7458, 0.369, 0.3352, 0.5407, 0.4009, 0.6525], [0.8714, 0.7546, 0.9161, 0.8776, 0.3945, 0.6667], [0.7934, 0.8504, 0.3097, 0.8639, 0.0258, 0.8063]]]], 2, Con50395), 
LMin53913 = minimum_layer([Res67265,Con50395], Min53913), 
LMul13686 = multiply_layer([Con12695,Min53913], Mul13686), 
exec_layers([LSub92359,LCon12695,LSep2599,LZer64038,LRes67265,LDot27461,LLoc64971,LZer91965,LCon50395,LMin53913,LMul13686],["Sub92359","Con12695","Sep2599","Zer64038","Res67265","Dot27461","Loc64971","Zer91965","Con50395","Min53913","Mul13686"],Mul13686,"Mul13686")

Actual (Unparsed): [[[-0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.0000000, -0.0000000, 0.0000000, 0.0099459, 0.0033950, 0.0110348, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[-0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[-0.0,-0.0,0.0,0.009945859706144798,0.003394955016492,0.011034753679318396,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]]]

Actual:   [[[-0, 0, 0, 0, 0, 0, 0, 0, 0], [-0, -0, 0, 0.01, 0.0034, 0.0111, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0]]]

Expected: [[[-0, 0, 0, 0, 0, 0, 0, 0, 0], [-0, -0, 0, 0.01, 0.0034, 0.0111, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0]]]