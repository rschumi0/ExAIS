import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con40200 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Con40200 = keras.layers.Conv3D(2, (1, 1, 1),strides=(10, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con40200', )(in0Con40200)
Res71503 = keras.layers.Reshape((1, 2, 2), name = 'Res71503', )(Con40200)
Res31142 = keras.layers.Reshape((1, 4), name = 'Res31142', )(Res71503)
Ave4710 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='same', name = 'Ave4710', )(Res31142)
Cro45453 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro45453', )(Ave4710)
Lay321 = keras.layers.LayerNormalization(axis=2, epsilon=1.790734825170682, name = 'Lay321', )(Cro45453)
model = tf.keras.models.Model(inputs=[in0Con40200], outputs=Lay321)
w = model.get_layer('Con40200').get_weights() 
w[0] = np.array([[[[[0.6038, 0.8991], [0.4818, 0.8175]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con40200').set_weights(w) 
in0Con40200 = tf.constant([[[[[0.4028, 0.3134]], [[0.6705, 0.3059]]], [[[0.1425, 0.5529]], [[0.5257, 0.5081]]]]])
print (np.array2string(model.predict([in0Con40200],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay321.png')

LCon40200 = conv3D_layer([[[[[0.4028, 0.3134]], [[0.6705, 0.3059]]], [[[0.1425, 0.5529]], [[0.5257, 0.5081]]]]], 1, 1, 1,[[[[[0.6038, 0.8991], [0.4818, 0.8175]]]]],[0, 0], 10, 1, 1, false, 1, 1, 1, Con40200), 
LRes71503 = reshape_layer(Con40200, [1, 2, 2], Res71503), 
LRes31142 = reshape_layer(Res71503, [1, 4], Res31142), 
LAve4710 = average_pooling1D_layer(Res31142, 1, 1, true, Ave4710), 
LCro45453 = cropping1D_layer(Ave4710, 0, 0, Cro45453), 
LLay321 = layer_normalization_layer(Cro45453, 2, 1.790734825170682, Lay321), 
exec_layers([LCon40200,LRes71503,LRes31142,LAve4710,LCro45453,LLay321],["Con40200","Res71503","Res31142","Ave4710","Cro45453","Lay321"],Lay321,"Lay321")

Actual (Unparsed): [[[-0.1559155, 0.0103331, -0.0387145, 0.1842969]]]

Expected (Unparsed): [[[-0.15591550190732556,0.01033306651860382,-0.03871446649408541,0.1842969018828074]]]

Actual:   [[[-0.1559, 0.0104, -0.0387, 0.1843]]]

Expected: [[[-0.1559, 0.0104, -0.0387, 0.1843]]]