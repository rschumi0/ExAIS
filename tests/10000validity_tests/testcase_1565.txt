import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min56591 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min56591 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Min72483 = tf.keras.layers.Input(shape=([1, 1]))
in1Min72483 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot63940 = tf.keras.layers.Input(shape=([3]))
in1Dot63940 = tf.keras.layers.Input(shape=([3]))
in0Con47638 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Ave10897 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Ave10897 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con96333 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Cro31233 = tf.keras.layers.Input(shape=([4, 2]))
in0Up_22384 = tf.keras.layers.Input(shape=([3, 2, 3, 1]))

Min56591 = keras.layers.Minimum(name = 'Min56591', )([in0Min56591,in1Min56591])
Res84804 = keras.layers.Reshape((1, 1), name = 'Res84804', )(Min56591)
Min72483 = keras.layers.Minimum(name = 'Min72483', )([in0Min72483,in1Min72483])
Max92663 = keras.layers.Maximum(name = 'Max92663', )([Res84804,Min72483])
Fla39095 = keras.layers.Flatten(name = 'Fla39095', )(Max92663)
Dot63940 = keras.layers.Dot(axes=(1, 1), name = 'Dot63940', )([in0Dot63940,in1Dot63940])
Max77515 = keras.layers.Maximum(name = 'Max77515', )([Fla39095,Dot63940])
Res37595 = keras.layers.Reshape((1, 1), name = 'Res37595', )(Max77515)
Res28330 = keras.layers.Reshape((1, 1, 1), name = 'Res28330', )(Res37595)
Con47638 = keras.layers.Concatenate(axis=3, name = 'Con47638', )([Res28330,in0Con47638])
Ave10897 = keras.layers.Average(name = 'Ave10897', )([in0Ave10897,in1Ave10897])
Res80176 = keras.layers.Reshape((1, 1, 2), name = 'Res80176', )(Ave10897)
Con96333 = keras.layers.Concatenate(axis=3, name = 'Con96333', )([Res80176,in0Con96333])
Cro31233 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro31233', )(in0Cro31233)
Res50643 = keras.layers.Reshape((3, 2, 1), name = 'Res50643', )(Cro31233)
Res45672 = keras.layers.Reshape((3, 2, 1, 1), name = 'Res45672', )(Res50643)
Zer89258 = keras.layers.ZeroPadding3D(padding=((3, 0), (0, 0), (2, 0)), name = 'Zer89258', )(Res45672)
Up_22384 = keras.layers.UpSampling3D(size=(2, 1, 1), name = 'Up_22384', )(in0Up_22384)
Add95799 = keras.layers.Add(name = 'Add95799', )([Zer89258,Up_22384])
Res2048 = keras.layers.Reshape((6, 2, 3), name = 'Res2048', )(Add95799)
Dep92367 = keras.layers.DepthwiseConv2D((6, 1),strides=(6, 6), padding='same', name = 'Dep92367', )(Res2048)
Max56198 = keras.layers.Maximum(name = 'Max56198', )([Con96333,Dep92367])
Max30732 = keras.layers.Maximum(name = 'Max30732', )([Con47638,Max56198])
model = tf.keras.models.Model(inputs=[in0Min56591,in1Min56591,in0Min72483,in1Min72483,in0Dot63940,in1Dot63940,in0Con47638,in0Ave10897,in1Ave10897,in0Con96333,in0Cro31233,in0Up_22384], outputs=Max30732)
w = model.get_layer('Dep92367').get_weights() 
w[0] = np.array([[[[0.382], [0.4898], [0.2793]]], [[[0.9727], [0.6124], [0.101]]], [[[0.7066], [0.6032], [0.6456]]], [[[0.1671], [0.3835], [0.1888]]], [[[0.8729], [0.2986], [0.0182]]], [[[0.4972], [0.3392], [0.9903]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Dep92367').set_weights(w) 
in0Min56591 = tf.constant([[[[0.2789]]]])
in1Min56591 = tf.constant([[[[0.4611]]]])
in0Min72483 = tf.constant([[[0.5049]]])
in1Min72483 = tf.constant([[[0.9528]]])
in0Dot63940 = tf.constant([[0.2007, 0.886, 0.3669]])
in1Dot63940 = tf.constant([[0.1742, 0.9489, 0.4748]])
in0Con47638 = tf.constant([[[[0.9733, 0.0292]]]])
in0Ave10897 = tf.constant([[[[[0.6117, 0.852]]]]])
in1Ave10897 = tf.constant([[[[[0.7714, 0.596]]]]])
in0Con96333 = tf.constant([[[[0.3669]]]])
in0Cro31233 = tf.constant([[[1.4755, 1.3096], [1.9133, 1.9561], [1.66, 1.9589], [1.944, 1.533]]])
in0Up_22384 = tf.constant([[[[[1.3837], [1.1273], [1.5395]], [[1.3304], [1.9135], [1.5355]]], [[[1.4837], [1.5249], [1.6831]], [[1.3864], [1.7258], [1.5555]]], [[[1.0692], [1.5327], [1.4305]], [[1.9793], [1.3893], [1.4665]]]]])
print (np.array2string(model.predict([in0Min56591,in1Min56591,in0Min72483,in1Min72483,in0Dot63940,in1Dot63940,in0Con47638,in0Ave10897,in1Ave10897,in0Con96333,in0Cro31233,in0Up_22384],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max30732.png')

LMin56591 = minimum_layer([[[[[0.2789]]]], [[[[0.4611]]]]], Min56591), 
LRes84804 = reshape_layer(Min56591, [1, 1], Res84804), 
LMin72483 = minimum_layer([[[[0.5049]]], [[[0.9528]]]], Min72483), 
LMax92663 = maximum_layer([Res84804,Min72483], Max92663), 
LFla39095 = flatten_layer(Max92663, Fla39095), 
LDot63940 = dot_layer([[0.2007, 0.886, 0.3669]], [[0.1742, 0.9489, 0.4748]], 1, 1, Dot63940), 
LMax77515 = maximum_layer([Fla39095,Dot63940], Max77515), 
LRes37595 = reshape_layer(Max77515, [1, 1], Res37595), 
LRes28330 = reshape_layer(Res37595, [1, 1, 1], Res28330), 
LCon47638 = concatenate_layer([Res28330,[[[[0.9733, 0.0292]]]]], 3, Con47638), 
LAve10897 = average_layer([[[[[[0.6117, 0.852]]]]], [[[[[0.7714, 0.596]]]]]], Ave10897), 
LRes80176 = reshape_layer(Ave10897, [1, 1, 2], Res80176), 
LCon96333 = concatenate_layer([Res80176,[[[[0.3669]]]]], 3, Con96333), 
LCro31233 = cropping1D_layer([[[1.4755, 1.3096], [1.9133, 1.9561], [1.66, 1.9589], [1.944, 1.533]]], 1, 0, Cro31233), 
LRes50643 = reshape_layer(Cro31233, [3, 2, 1], Res50643), 
LRes45672 = reshape_layer(Res50643, [3, 2, 1, 1], Res45672), 
LZer89258 = zero_padding3D_layer(Res45672, 3, 0, 0, 0, 2, 0, Zer89258), 
LUp_22384 = up_sampling3D_layer([[[[[1.3837], [1.1273], [1.5395]], [[1.3304], [1.9135], [1.5355]]], [[[1.4837], [1.5249], [1.6831]], [[1.3864], [1.7258], [1.5555]]], [[[1.0692], [1.5327], [1.4305]], [[1.9793], [1.3893], [1.4665]]]]], 2, 1, 1, Up_22384), 
LAdd95799 = add_layer([Zer89258,Up_22384], Add95799), 
LRes2048 = reshape_layer(Add95799, [6, 2, 3], Res2048), 
LDep92367 = depthwise_conv2D_layer(Res2048, 6, 1,[[[[0.382], [0.4898], [0.2793]]], [[[0.9727], [0.6124], [0.101]]], [[[0.7066], [0.6032], [0.6456]]], [[[0.1671], [0.3835], [0.1888]]], [[[0.8729], [0.2986], [0.0182]]], [[[0.4972], [0.3392], [0.9903]]]],[0, 0, 0], 6, 6, true, Dep92367), 
LMax56198 = maximum_layer([Con96333,Dep92367], Max56198), 
LMax30732 = maximum_layer([Con47638,Max56198], Max30732), 
exec_layers([LMin56591,LRes84804,LMin72483,LMax92663,LFla39095,LDot63940,LMax77515,LRes37595,LRes28330,LCon47638,LAve10897,LRes80176,LCon96333,LCro31233,LRes50643,LRes45672,LZer89258,LUp_22384,LAdd95799,LRes2048,LDep92367,LMax56198,LMax30732],["Min56591","Res84804","Min72483","Max92663","Fla39095","Dot63940","Max77515","Res37595","Res28330","Con47638","Ave10897","Res80176","Con96333","Cro31233","Res50643","Res45672","Zer89258","Up_22384","Add95799","Res2048","Dep92367","Max56198","Max30732"],Max30732,"Max30732")

Actual (Unparsed): [[[[4.6357181, 3.7246849, 5.7490960]]]]

Expected (Unparsed): [[[[4.635717999999999,3.72468495,5.74909598]]]]

Actual:   [[[[4.6358, 3.7247, 5.7491]]]]

Expected: [[[[4.6358, 3.7247, 5.7491]]]]