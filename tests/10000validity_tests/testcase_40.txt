import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add25732 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add25732 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con3676 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Sub63689 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub63689 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0LST769 = tf.keras.layers.Input(shape=([1, 1]))
in0Con3140 = tf.keras.layers.Input(shape=([6]))
in0Add89303 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Add89303 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Add25732 = keras.layers.Add(name = 'Add25732', )([in0Add25732,in1Add25732])
Zer42744 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer42744', )(Add25732)
Con3676 = keras.layers.Concatenate(axis=3, name = 'Con3676', )([Zer42744,in0Con3676])
Sub63689 = keras.layers.Subtract(name = 'Sub63689', )([in0Sub63689,in1Sub63689])
Mul34368 = keras.layers.Multiply(name = 'Mul34368', )([Con3676,Sub63689])
Res19652 = keras.layers.Reshape((2, 4), name = 'Res19652', )(Mul34368)
Fla76208 = keras.layers.Flatten(name = 'Fla76208', )(Res19652)
LST769 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST769', )(in0LST769)
Con3140 = keras.layers.Concatenate(axis=1, name = 'Con3140', )([LST769,in0Con3140])
Mul773 = keras.layers.Multiply(name = 'Mul773', )([Fla76208,Con3140])
Res56571 = keras.layers.Reshape((8, 1), name = 'Res56571', )(Mul773)
Res56242 = keras.layers.Reshape((8, 1, 1), name = 'Res56242', )(Res56571)
Res84381 = keras.layers.Reshape((8, 1, 1, 1), name = 'Res84381', )(Res56242)
Zer62451 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer62451', )(Res84381)
Add89303 = keras.layers.Add(name = 'Add89303', )([in0Add89303,in1Add89303])
Zer11081 = keras.layers.ZeroPadding3D(padding=((7, 0), (0, 0), (1, 0)), name = 'Zer11081', )(Add89303)
Sub66163 = keras.layers.Subtract(name = 'Sub66163', )([Zer62451,Zer11081])
Res52328 = keras.layers.Reshape((8, 1, 3), name = 'Res52328', )(Sub66163)
PRe46938 = keras.layers.PReLU(name = 'PRe46938', )(Res52328)
model = tf.keras.models.Model(inputs=[in0Add25732,in1Add25732,in0Con3676,in0Sub63689,in1Sub63689,in0LST769,in0Con3140,in0Add89303,in1Add89303], outputs=PRe46938)
w = model.get_layer('LST769').get_weights() 
w[0] = np.array([[8, 10, 5, 8, 6, 8, 2, 5]])
w[1] = np.array([[7, 8, 4, 9, 9, 7, 10, 1], [5, 5, 3, 6, 10, 7, 3, 9]])
w[2] = np.array([2, 10, 1, 5, 3, 4, 9, 9])
model.get_layer('LST769').set_weights(w) 
w = model.get_layer('PRe46938').get_weights() 
w[0] = np.array([[[0.8529, 0.713, 0.1061]], [[0.6281, 0.5048, 0.3233]], [[0.0697, 0.5035, 0.0327]], [[0.3842, 0.6332, 0.5248]], [[0.4202, 0.1069, 0.8344]], [[0.2697, 0.9204, 0.1226]], [[0.3552, 0.3762, 0.0281]], [[0.1062, 0.4354, 0.9015]]])
model.get_layer('PRe46938').set_weights(w) 
in0Add25732 = tf.constant([[[[0.2591]]]])
in1Add25732 = tf.constant([[[[0.5012]]]])
in0Con3676 = tf.constant([[[[0.6809], [0.0527]], [[0.6314], [0.0576]]]])
in0Sub63689 = tf.constant([[[[0.0999, 0.3095], [0.2131, 0.1774]], [[0.8449, 0.8308], [0.4603, 0.1293]]]])
in1Sub63689 = tf.constant([[[[0.8481, 0.5565], [0.8108, 0.0243]], [[0.6736, 0.8841], [0.6005, 0.2813]]]])
in0LST769 = tf.constant([[[8]]])
in0Con3140 = tf.constant([[0.2919, 0.3436, 0.8161, 0.0761, 0.67, 0.5349]])
in0Add89303 = tf.constant([[[[[0.9472], [0.975]]]]])
in1Add89303 = tf.constant([[[[[0.8354], [0.645]]]]])
print (np.array2string(model.predict([in0Add25732,in1Add25732,in0Con3676,in0Sub63689,in1Sub63689,in0LST769,in0Con3140,in0Add89303,in1Add89303],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe46938.png')

LAdd25732 = add_layer([[[[[0.2591]]]], [[[[0.5012]]]]], Add25732), 
LZer42744 = zero_padding2D_layer(Add25732, 1, 0, 1, 0, Zer42744), 
LCon3676 = concatenate_layer([Zer42744,[[[[0.6809], [0.0527]], [[0.6314], [0.0576]]]]], 3, Con3676), 
LSub63689 = subtract_layer([[[[0.0999, 0.3095], [0.2131, 0.1774]], [[0.8449, 0.8308], [0.4603, 0.1293]]]], [[[[0.8481, 0.5565], [0.8108, 0.0243]], [[0.6736, 0.8841], [0.6005, 0.2813]]]], Sub63689), 
LMul34368 = multiply_layer([Con3676,Sub63689], Mul34368), 
LRes19652 = reshape_layer(Mul34368, [2, 4], Res19652), 
LFla76208 = flatten_layer(Res19652, Fla76208), 
LLST769 = lstm_layer([[[8]]],[[8, 10, 5, 8, 6, 8, 2, 5]],[[7, 8, 4, 9, 9, 7, 10, 1], [5, 5, 3, 6, 10, 7, 3, 9]],[2, 10, 1, 5, 3, 4, 9, 9], LST769), 
LCon3140 = concatenate_layer([LST769,[[0.2919, 0.3436, 0.8161, 0.0761, 0.67, 0.5349]]], 1, Con3140), 
LMul773 = multiply_layer([Fla76208,Con3140], Mul773), 
LRes56571 = reshape_layer(Mul773, [8, 1], Res56571), 
LRes56242 = reshape_layer(Res56571, [8, 1, 1], Res56242), 
LRes84381 = reshape_layer(Res56242, [8, 1, 1, 1], Res84381), 
LZer62451 = zero_padding3D_layer(Res84381, 0, 0, 0, 0, 2, 0, Zer62451), 
LAdd89303 = add_layer([[[[[[0.9472], [0.975]]]]], [[[[[0.8354], [0.645]]]]]], Add89303), 
LZer11081 = zero_padding3D_layer(Add89303, 7, 0, 0, 0, 1, 0, Zer11081), 
LSub66163 = subtract_layer(Zer62451,Zer11081, Sub66163), 
LRes52328 = reshape_layer(Sub66163, [8, 1, 3], Res52328), 
LPRe46938 = prelu_layer(Res52328, [[[0.8529, 0.713, 0.1061]], [[0.6281, 0.5048, 0.3233]], [[0.0697, 0.5035, 0.0327]], [[0.3842, 0.6332, 0.5248]], [[0.4202, 0.1069, 0.8344]], [[0.2697, 0.9204, 0.1226]], [[0.3552, 0.3762, 0.0281]], [[0.1062, 0.4354, 0.9015]]], PRe46938), 
exec_layers([LAdd25732,LZer42744,LCon3676,LSub63689,LMul34368,LRes19652,LFla76208,LLST769,LCon3140,LMul773,LRes56571,LRes56242,LRes84381,LZer62451,LAdd89303,LZer11081,LSub66163,LRes52328,LPRe46938],["Add25732","Zer42744","Con3676","Sub63689","Mul34368","Res19652","Fla76208","LST769","Con3140","Mul773","Res56571","Res56242","Res84381","Zer62451","Add89303","Zer11081","Sub66163","Res52328","PRe46938"],PRe46938,"PRe46938")

Actual (Unparsed): [[[[0.0000000, 0.0000000, -0.0000000]], [[0.0000000, 0.0000000, -0.0414104]], [[0.0000000, 0.0000000, -0.0000000]], [[0.0000000, 0.0000000, 0.0027723]], [[0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, -0.0003140]], [[0.0000000, 0.0000000, -0.0020068]], [[0.0000000, -0.7761440, -1.4646519]]]]

Expected (Unparsed): [[[[0,0,-0.0]],[[0,0,-0.0414104161483539]],[[0,0,-0.0]],[[0,0,0.0027722919320000003]],[[0,0,0.0]],[[0,0,-0.0003139835630932001]],[[0,0,-0.002006846367620001]],[[0,-0.77614404,-1.46465186556672]]]]

Actual:   [[[[0, 0, -0]], [[0, 0, -0.0414]], [[0, 0, -0]], [[0, 0, 0.0028]], [[0, 0, 0]], [[0, 0, -0.0003]], [[0, 0, -0.002]], [[0, -0.7761, -1.4646]]]]

Expected: [[[[0, 0, -0]], [[0, 0, -0.0414]], [[0, 0, -0]], [[0, 0, 0.0028]], [[0, 0, 0]], [[0, 0, -0.0003]], [[0, 0, -0.002]], [[0, -0.7761, -1.4646]]]]