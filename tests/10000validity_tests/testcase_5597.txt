import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add71720 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Add71720 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Add71720 = keras.layers.Add(name = 'Add71720', )([in0Add71720,in1Add71720])
Res17296 = keras.layers.Reshape((2, 1, 2), name = 'Res17296', )(Add71720)
Res48517 = keras.layers.Reshape((2, 2), name = 'Res48517', )(Res17296)
Loc66636 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc66636', )(Res48517)
Fla38063 = keras.layers.Flatten(name = 'Fla38063', )(Loc66636)
Res46642 = keras.layers.Reshape((6, 1), name = 'Res46642', )(Fla38063)
Res6381 = keras.layers.Reshape((6, 1, 1), name = 'Res6381', )(Res46642)
Res89625 = keras.layers.Reshape((6, 1, 1, 1), name = 'Res89625', )(Res6381)
Glo3769 = keras.layers.GlobalMaxPool3D(name = 'Glo3769', )(Res89625)
Res33374 = keras.layers.Reshape((1, 1), name = 'Res33374', )(Glo3769)
Res72330 = keras.layers.Reshape((1, 1, 1), name = 'Res72330', )(Res33374)
Res7575 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res7575', )(Res72330)
Con34544 = keras.layers.Conv3DTranspose(2, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con34544', )(Res7575)
model = tf.keras.models.Model(inputs=[in0Add71720,in1Add71720], outputs=Con34544)
w = model.get_layer('Loc66636').get_weights() 
w[0] = np.array([[[0.7124, 0.0611, 0.8867], [0.3281, 0.9194, 0.9777]], [[0.0515, 0.6314, 0.4412], [0.3934, 0.9281, 0.3817]]])
w[1] = np.array([[0, 0, 0], [0, 0, 0]])
model.get_layer('Loc66636').set_weights(w) 
w = model.get_layer('Con34544').get_weights() 
w[0] = np.array([[[[[0.0361], [0.7182]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con34544').set_weights(w) 
in0Add71720 = tf.constant([[[[[0.1868], [0.4238]]], [[[0.234], [0.346]]]]])
in1Add71720 = tf.constant([[[[[0.0465], [0.2614]]], [[[0.347], [0.0692]]]]])
print (np.array2string(model.predict([in0Add71720,in1Add71720],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con34544.png')

LAdd71720 = add_layer([[[[[[0.1868], [0.4238]]], [[[0.234], [0.346]]]]], [[[[[0.0465], [0.2614]]], [[[0.347], [0.0692]]]]]], Add71720), 
LRes17296 = reshape_layer(Add71720, [2, 1, 2], Res17296), 
LRes48517 = reshape_layer(Res17296, [2, 2], Res48517), 
LLoc66636 = locally_connected1D_layer(Res48517, 1,[[[0.7124, 0.0611, 0.8867], [0.3281, 0.9194, 0.9777]], [[0.0515, 0.6314, 0.4412], [0.3934, 0.9281, 0.3817]]],[[0, 0, 0], [0, 0, 0]], 1, Loc66636), 
LFla38063 = flatten_layer(Loc66636, Fla38063), 
LRes46642 = reshape_layer(Fla38063, [6, 1], Res46642), 
LRes6381 = reshape_layer(Res46642, [6, 1, 1], Res6381), 
LRes89625 = reshape_layer(Res6381, [6, 1, 1, 1], Res89625), 
LGlo3769 = global_max_pool3D_layer(Res89625, Glo3769), 
LRes33374 = reshape_layer(Glo3769, [1, 1], Res33374), 
LRes72330 = reshape_layer(Res33374, [1, 1, 1], Res72330), 
LRes7575 = reshape_layer(Res72330, [1, 1, 1, 1], Res7575), 
LCon34544 = conv3D_transpose_layer(Res7575, 1, 1, 1,[[[[[0.0361], [0.7182]]]]],[0, 0], 1, 1, 1, false, Con34544), 
exec_layers([LAdd71720,LRes17296,LRes48517,LLoc66636,LFla38063,LRes46642,LRes6381,LRes89625,LGlo3769,LRes33374,LRes72330,LRes7575,LCon34544],["Add71720","Res17296","Res48517","Loc66636","Fla38063","Res46642","Res6381","Res89625","Glo3769","Res33374","Res72330","Res7575","Con34544"],Con34544,"Con34544")

Actual (Unparsed): [[[[[0.0316520, 0.6297085]]]]]

Expected (Unparsed): [[[[[0.031652016115,0.62970853113]]]]]

Actual:   [[[[[0.0317, 0.6298]]]]]

Expected: [[[[[0.0317, 0.6298]]]]]