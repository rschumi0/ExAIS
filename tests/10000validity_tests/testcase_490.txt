import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot56275 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot56275 = tf.keras.layers.Input(shape=([2, 3]))
in0Loc46111 = tf.keras.layers.Input(shape=([2, 1]))
in0Con12215 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Mul64050 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul64050 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul55085 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul55085 = tf.keras.layers.Input(shape=([2, 1]))
in0Con85163 = tf.keras.layers.Input(shape=([2, 1]))
in0Con37337 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max42841 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max42841 = tf.keras.layers.Input(shape=([1, 1, 2]))

Dot56275 = keras.layers.Dot(axes=(2, 2), name = 'Dot56275', )([in0Dot56275,in1Dot56275])
Loc46111 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc46111', )(in0Loc46111)
Res43824 = keras.layers.Reshape((2, 2, 1), name = 'Res43824', )(Loc46111)
Sep42241 = keras.layers.SeparableConv2D(2, (2, 1),strides=(2, 2), padding='same', name = 'Sep42241', )(Res43824)
Res14534 = keras.layers.Reshape((1, 2), name = 'Res14534', )(Sep42241)
Dot32100 = keras.layers.Dot(axes=(2, 2), name = 'Dot32100', )([Dot56275,Res14534])
Res62634 = keras.layers.Reshape((2, 1, 1), name = 'Res62634', )(Dot32100)
Zer3024 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer3024', )(Res62634)
Con12215 = keras.layers.Concatenate(axis=3, name = 'Con12215', )([Zer3024,in0Con12215])
Mul64050 = keras.layers.Multiply(name = 'Mul64050', )([in0Mul64050,in1Mul64050])
Mul55085 = keras.layers.Multiply(name = 'Mul55085', )([in0Mul55085,in1Mul55085])
Con85163 = keras.layers.Concatenate(axis=2, name = 'Con85163', )([Mul55085,in0Con85163])
Ave88597 = keras.layers.Average(name = 'Ave88597', )([Mul64050,Con85163])
Res62721 = keras.layers.Reshape((2, 2, 1), name = 'Res62721', )(Ave88597)
Con37337 = keras.layers.Concatenate(axis=3, name = 'Con37337', )([Res62721,in0Con37337])
Max42841 = keras.layers.Maximum(name = 'Max42841', )([in0Max42841,in1Max42841])
Zer52223 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer52223', )(Max42841)
Min82372 = keras.layers.Minimum(name = 'Min82372', )([Con37337,Zer52223])
Add12015 = keras.layers.Add(name = 'Add12015', )([Con12215,Min82372])
model = tf.keras.models.Model(inputs=[in0Dot56275,in1Dot56275,in0Loc46111,in0Con12215,in0Mul64050,in1Mul64050,in0Mul55085,in1Mul55085,in0Con85163,in0Con37337,in0Max42841,in1Max42841], outputs=Add12015)
w = model.get_layer('Loc46111').get_weights() 
w[0] = np.array([[[0.2738, 0.2827]], [[0.4129, 0.032]]])
w[1] = np.array([[0, 0], [0, 0]])
model.get_layer('Loc46111').set_weights(w) 
w = model.get_layer('Sep42241').get_weights() 
w[0] = np.array([[[[0.3136]]], [[[0.1591]]]])
w[1] = np.array([[[[0.381, 0.4461]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep42241').set_weights(w) 
in0Dot56275 = tf.constant([[[0.454, 0.0386, 0.9259], [0.0815, 0.2949, 0.8454]]])
in1Dot56275 = tf.constant([[[0.8272, 0.6057, 0.6764], [0.9136, 0.1334, 0.5245]]])
in0Loc46111 = tf.constant([[[0.5914], [0.1792]]])
in0Con12215 = tf.constant([[[[0.6554], [0.7406]], [[0.9062], [0.7377]]]])
in0Mul64050 = tf.constant([[[0.9884, 0.8795], [0.3392, 0.1416]]])
in1Mul64050 = tf.constant([[[0.0541, 0.5727], [0.0102, 0.4535]]])
in0Mul55085 = tf.constant([[[0.5485], [0.2307]]])
in1Mul55085 = tf.constant([[[0.5871], [0.5228]]])
in0Con85163 = tf.constant([[[0.7845], [0.2366]]])
in0Con37337 = tf.constant([[[[0.1518], [0.6289]], [[0.8588], [0.4423]]]])
in0Max42841 = tf.constant([[[[0.0187, 0.4916]]]])
in1Max42841 = tf.constant([[[[0.2794, 0.9878]]]])
print (np.array2string(model.predict([in0Dot56275,in1Dot56275,in0Loc46111,in0Con12215,in0Mul64050,in1Mul64050,in0Mul55085,in1Mul55085,in0Con85163,in0Con37337,in0Max42841,in1Max42841],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add12015.png')

LDot56275 = dot_layer([[[0.454, 0.0386, 0.9259], [0.0815, 0.2949, 0.8454]]], [[[0.8272, 0.6057, 0.6764], [0.9136, 0.1334, 0.5245]]], 2, 2, Dot56275), 
LLoc46111 = locally_connected1D_layer([[[0.5914], [0.1792]]], 1,[[[0.2738, 0.2827]], [[0.4129, 0.032]]],[[0, 0], [0, 0]], 1, Loc46111), 
LRes43824 = reshape_layer(Loc46111, [2, 2, 1], Res43824), 
LSep42241 = separable_conv2D_layer(Res43824, 2, 1,[[[[[0.3136]]], [[[0.1591]]]],[[[[0.381, 0.4461]]]]],[0, 0], 2, 2, true, Sep42241), 
LRes14534 = reshape_layer(Sep42241, [1, 2], Res14534), 
LDot32100 = dot_layer(Dot56275,Res14534, 2, 2, Dot32100), 
LRes62634 = reshape_layer(Dot32100, [2, 1, 1], Res62634), 
LZer3024 = zero_padding2D_layer(Res62634, 0, 0, 1, 0, Zer3024), 
LCon12215 = concatenate_layer([Zer3024,[[[[0.6554], [0.7406]], [[0.9062], [0.7377]]]]], 3, Con12215), 
LMul64050 = multiply_layer([[[[0.9884, 0.8795], [0.3392, 0.1416]]], [[[0.0541, 0.5727], [0.0102, 0.4535]]]], Mul64050), 
LMul55085 = multiply_layer([[[[0.5485], [0.2307]]], [[[0.5871], [0.5228]]]], Mul55085), 
LCon85163 = concatenate_layer([Mul55085,[[[0.7845], [0.2366]]]], 2, Con85163), 
LAve88597 = average_layer([Mul64050,Con85163], Ave88597), 
LRes62721 = reshape_layer(Ave88597, [2, 2, 1], Res62721), 
LCon37337 = concatenate_layer([Res62721,[[[[0.1518], [0.6289]], [[0.8588], [0.4423]]]]], 3, Con37337), 
LMax42841 = maximum_layer([[[[[0.0187, 0.4916]]]], [[[[0.2794, 0.9878]]]]], Max42841), 
LZer52223 = zero_padding2D_layer(Max42841, 1, 0, 1, 0, Zer52223), 
LMin82372 = minimum_layer([Con37337,Zer52223], Min82372), 
LAdd12015 = add_layer([Con12215,Min82372], Add12015), 
exec_layers([LDot56275,LLoc46111,LRes43824,LSep42241,LRes14534,LDot32100,LRes62634,LZer3024,LCon12215,LMul64050,LMul55085,LCon85163,LAve88597,LRes62721,LCon37337,LMax42841,LZer52223,LMin82372,LAdd12015],["Dot56275","Loc46111","Res43824","Sep42241","Res14534","Dot32100","Res62634","Zer3024","Con12215","Mul64050","Mul55085","Con85163","Ave88597","Res62721","Con37337","Max42841","Zer52223","Min82372","Add12015"],Add12015,"Add12015")

Actual (Unparsed): [[[[0.0000000, 0.6554000], [0.0497021, 0.7406000]], [[0.0000000, 0.9062000], [0.1854480, 1.1800000]]]]

Expected (Unparsed): [[[[0,0.6554],[0.04970205370063673,0.7406]],[[0,0.9062],[0.18544801136027167,1.1800000000000002]]]]

Actual:   [[[[0, 0.6554], [0.0498, 0.7406]], [[0, 0.9062], [0.1855, 1.18]]]]

Expected: [[[[0, 0.6554], [0.0498, 0.7406]], [[0, 0.9062], [0.1855, 1.1801]]]]