import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min88963 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min88963 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Max42777 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Max42777 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Min68127 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min68127 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con23012 = tf.keras.layers.Input(shape=([3, 3]))

Min88963 = keras.layers.Minimum(name = 'Min88963', )([in0Min88963,in1Min88963])
Res52169 = keras.layers.Reshape((1, 2, 2), name = 'Res52169', )(Min88963)
Res32808 = keras.layers.Reshape((1, 4), name = 'Res32808', )(Res52169)
Zer98520 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer98520', )(Res32808)
Max42777 = keras.layers.Maximum(name = 'Max42777', )([in0Max42777,in1Max42777])
Res79540 = keras.layers.Reshape((1, 1, 1), name = 'Res79540', )(Max42777)
Res99 = keras.layers.Reshape((1, 1), name = 'Res99', )(Res79540)
Min68127 = keras.layers.Minimum(name = 'Min68127', )([in0Min68127,in1Min68127])
Res53511 = keras.layers.Reshape((1, 1), name = 'Res53511', )(Min68127)
Dot10805 = keras.layers.Dot(axes=(1, 2), name = 'Dot10805', )([Res99,Res53511])
Zer75932 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer75932', )(Dot10805)
Con23012 = keras.layers.Concatenate(axis=2, name = 'Con23012', )([Zer75932,in0Con23012])
Max77904 = keras.layers.Maximum(name = 'Max77904', )([Zer98520,Con23012])
model = tf.keras.models.Model(inputs=[in0Min88963,in1Min88963,in0Max42777,in1Max42777,in0Min68127,in1Min68127,in0Con23012], outputs=Max77904)
in0Min88963 = tf.constant([[[[[0.5513, 0.0606]], [[0.7515, 0.9799]]]]])
in1Min88963 = tf.constant([[[[[0.7844, 0.9431]], [[0.8533, 0.4552]]]]])
in0Max42777 = tf.constant([[[[[0.1731]]]]])
in1Max42777 = tf.constant([[[[[0.6141]]]]])
in0Min68127 = tf.constant([[[[0.903]]]])
in1Min68127 = tf.constant([[[[0.4832]]]])
in0Con23012 = tf.constant([[[0.3777, 0.0469, 0.5237], [0.4223, 0.3846, 0.0078], [0.199, 0.2814, 0.2934]]])
print (np.array2string(model.predict([in0Min88963,in1Min88963,in0Max42777,in1Max42777,in0Min68127,in1Min68127,in0Con23012],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max77904.png')

LMin88963 = minimum_layer([[[[[[0.5513, 0.0606]], [[0.7515, 0.9799]]]]], [[[[[0.7844, 0.9431]], [[0.8533, 0.4552]]]]]], Min88963), 
LRes52169 = reshape_layer(Min88963, [1, 2, 2], Res52169), 
LRes32808 = reshape_layer(Res52169, [1, 4], Res32808), 
LZer98520 = zero_padding1D_layer(Res32808, 2, 0, Zer98520), 
LMax42777 = maximum_layer([[[[[[0.1731]]]]], [[[[[0.6141]]]]]], Max42777), 
LRes79540 = reshape_layer(Max42777, [1, 1, 1], Res79540), 
LRes99 = reshape_layer(Res79540, [1, 1], Res99), 
LMin68127 = minimum_layer([[[[[0.903]]]], [[[[0.4832]]]]], Min68127), 
LRes53511 = reshape_layer(Min68127, [1, 1], Res53511), 
LDot10805 = dot_layer(Res99,Res53511, 1, 2, Dot10805), 
LZer75932 = zero_padding1D_layer(Dot10805, 1, 1, Zer75932), 
LCon23012 = concatenate_layer([Zer75932,[[[0.3777, 0.0469, 0.5237], [0.4223, 0.3846, 0.0078], [0.199, 0.2814, 0.2934]]]], 2, Con23012), 
LMax77904 = maximum_layer([Zer98520,Con23012], Max77904), 
exec_layers([LMin88963,LRes52169,LRes32808,LZer98520,LMax42777,LRes79540,LRes99,LMin68127,LRes53511,LDot10805,LZer75932,LCon23012,LMax77904],["Min88963","Res52169","Res32808","Zer98520","Max42777","Res79540","Res99","Min68127","Res53511","Dot10805","Zer75932","Con23012","Max77904"],Max77904,"Max77904")

Actual (Unparsed): [[[0.0000000, 0.3777000, 0.0469000, 0.5237000], [0.2967331, 0.4223000, 0.3846000, 0.0078000], [0.5513000, 0.1990000, 0.7515000, 0.4552000]]]

Expected (Unparsed): [[[0,0.3777,0.0469,0.5237],[0.29673312,0.4223,0.3846,0.0078],[0.5513,0.199,0.7515,0.4552]]]

Actual:   [[[0, 0.3777, 0.0469, 0.5237], [0.2968, 0.4223, 0.3846, 0.0078], [0.5513, 0.199, 0.7515, 0.4552]]]

Expected: [[[0, 0.3777, 0.0469, 0.5237], [0.2968, 0.4223, 0.3846, 0.0078], [0.5513, 0.199, 0.7515, 0.4552]]]