import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave93231 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave93231 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con11309 = tf.keras.layers.Input(shape=([3]))
in0Zer938 = tf.keras.layers.Input(shape=([3, 1]))
in0Zer55258 = tf.keras.layers.Input(shape=([1, 2]))
in0Con7495 = tf.keras.layers.Input(shape=([4]))

Ave93231 = keras.layers.Average(name = 'Ave93231', )([in0Ave93231,in1Ave93231])
Res4826 = keras.layers.Reshape((1, 2), name = 'Res4826', )(Ave93231)
Fla25452 = keras.layers.Flatten(name = 'Fla25452', )(Res4826)
Con11309 = keras.layers.Concatenate(axis=1, name = 'Con11309', )([Fla25452,in0Con11309])
Zer938 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer938', )(in0Zer938)
Fla37250 = keras.layers.Flatten(name = 'Fla37250', )(Zer938)
Zer55258 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer55258', )(in0Zer55258)
GRU56616 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU56616', )(Zer55258)
Con7495 = keras.layers.Concatenate(axis=1, name = 'Con7495', )([GRU56616,in0Con7495])
Sub73783 = keras.layers.Subtract(name = 'Sub73783', )([Fla37250,Con7495])
Thr70969 = keras.layers.ThresholdedReLU(theta=3.5707913620638636, name = 'Thr70969', )(Sub73783)
Ave28924 = keras.layers.Average(name = 'Ave28924', )([Con11309,Thr70969])
model = tf.keras.models.Model(inputs=[in0Ave93231,in1Ave93231,in0Con11309,in0Zer938,in0Zer55258,in0Con7495], outputs=Ave28924)
w = model.get_layer('GRU56616').get_weights() 
w[0] = np.array([[7, 8, 8], [3, 7, 8]])
w[1] = np.array([[4, 10, 8]])
w[2] = np.array([3, 8, 9])
model.get_layer('GRU56616').set_weights(w) 
in0Ave93231 = tf.constant([[[[0.6347, 0.1056]]]])
in1Ave93231 = tf.constant([[[[0.6045, 0.3297]]]])
in0Con11309 = tf.constant([[0.5886, 0.2907, 0.9462]])
in0Zer938 = tf.constant([[[1.5433], [1.0943], [1.5315]]])
in0Zer55258 = tf.constant([[[1.0441, 1.8908]]])
in0Con7495 = tf.constant([[0.7739, 0.8098, 0.0297, 0.1426]])
print (np.array2string(model.predict([in0Ave93231,in1Ave93231,in0Con11309,in0Zer938,in0Zer55258,in0Con7495],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave28924.png')

LAve93231 = average_layer([[[[[0.6347, 0.1056]]]], [[[[0.6045, 0.3297]]]]], Ave93231), 
LRes4826 = reshape_layer(Ave93231, [1, 2], Res4826), 
LFla25452 = flatten_layer(Res4826, Fla25452), 
LCon11309 = concatenate_layer([Fla25452,[[0.5886, 0.2907, 0.9462]]], 1, Con11309), 
LZer938 = zero_padding1D_layer([[[1.5433], [1.0943], [1.5315]]], 1, 1, Zer938), 
LFla37250 = flatten_layer(Zer938, Fla37250), 
LZer55258 = zero_padding1D_layer([[[1.0441, 1.8908]]], 1, 1, Zer55258), 
LGRU56616 = gru_layer(Zer55258,[[7, 8, 8], [3, 7, 8]],[[4, 10, 8]],[3, 8, 9], false, GRU56616), 
LCon7495 = concatenate_layer([GRU56616,[[0.7739, 0.8098, 0.0297, 0.1426]]], 1, Con7495), 
LSub73783 = subtract_layer(Fla37250,Con7495, Sub73783), 
LThr70969 = thresholded_relu_layer(Sub73783, 3.5707913620638636, Thr70969), 
LAve28924 = average_layer([Con11309,Thr70969], Ave28924), 
exec_layers([LAve93231,LRes4826,LFla25452,LCon11309,LZer938,LFla37250,LZer55258,LGRU56616,LCon7495,LSub73783,LThr70969,LAve28924],["Ave93231","Res4826","Fla25452","Con11309","Zer938","Fla37250","Zer55258","GRU56616","Con7495","Sub73783","Thr70969","Ave28924"],Ave28924,"Ave28924")

Actual (Unparsed): [[0.3098000, 0.1088250, 0.2943000, 0.1453500, 0.4731000]]

Expected (Unparsed): [[0.3098,0.108825,0.2943,0.14535,0.4731]]

Actual:   [[0.3098, 0.1089, 0.2943, 0.1454, 0.4731]]

Expected: [[0.3098, 0.1089, 0.2943, 0.1454, 0.4731]]