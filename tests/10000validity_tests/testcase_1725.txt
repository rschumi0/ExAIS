import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul76115 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul76115 = tf.keras.layers.Input(shape=([2, 2]))

Mul76115 = keras.layers.Multiply(name = 'Mul76115', )([in0Mul76115,in1Mul76115])
GRU11984 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU11984', )(Mul76115)
model = tf.keras.models.Model(inputs=[in0Mul76115,in1Mul76115], outputs=GRU11984)
w = model.get_layer('GRU11984').get_weights() 
w[0] = np.array([[3, 9, 5], [7, 3, 6]])
w[1] = np.array([[7, 9, 4]])
w[2] = np.array([7, 10, 8])
model.get_layer('GRU11984').set_weights(w) 
in0Mul76115 = tf.constant([[[0.6571, 0.3983], [0.6785, 0.278]]])
in1Mul76115 = tf.constant([[[0.9857, 0.3732], [0.4637, 0.0439]]])
print (np.array2string(model.predict([in0Mul76115,in1Mul76115],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU11984.png')

LMul76115 = multiply_layer([[[[0.6571, 0.3983], [0.6785, 0.278]]], [[[0.9857, 0.3732], [0.4637, 0.0439]]]], Mul76115), 
LGRU11984 = gru_layer(Mul76115,[[3, 9, 5], [7, 3, 6]],[[7, 9, 4]],[7, 10, 8], false, GRU11984), 
exec_layers([LMul76115,LGRU11984],["Mul76115","GRU11984"],GRU11984,"GRU11984")

Actual (Unparsed): [[0.0003717]]

Expected (Unparsed): [[0.00037170005494482076]]

Actual:   [[0.0004]]

Expected: [[0.0004]]