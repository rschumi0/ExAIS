import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub27904 = tf.keras.layers.Input(shape=([2]))
in1Sub27904 = tf.keras.layers.Input(shape=([2]))

Sub27904 = keras.layers.Subtract(name = 'Sub27904', )([in0Sub27904,in1Sub27904])
Res82972 = keras.layers.Reshape((2, 1), name = 'Res82972', )(Sub27904)
Res63514 = keras.layers.Reshape((2, 1, 1), name = 'Res63514', )(Res82972)
Res70979 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res70979', )(Res63514)
Con26836 = keras.layers.Conv3D(4, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con26836', )(Res70979)
model = tf.keras.models.Model(inputs=[in0Sub27904,in1Sub27904], outputs=Con26836)
w = model.get_layer('Con26836').get_weights() 
w[0] = np.array([[[[[0.0755, 0.5044, 0.4799, 0.8754]]]], [[[[0.1559, 0.8761, 0.8567, 0.1237]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con26836').set_weights(w) 
in0Sub27904 = tf.constant([[0.4522, 0.1589]])
in1Sub27904 = tf.constant([[0.4328, 0.5427]])
print (np.array2string(model.predict([in0Sub27904,in1Sub27904],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con26836.png')

LSub27904 = subtract_layer([[0.4522, 0.1589]], [[0.4328, 0.5427]], Sub27904), 
LRes82972 = reshape_layer(Sub27904, [2, 1], Res82972), 
LRes63514 = reshape_layer(Res82972, [2, 1, 1], Res63514), 
LRes70979 = reshape_layer(Res63514, [2, 1, 1, 1], Res70979), 
LCon26836 = conv3D_layer(Res70979, 2, 1, 1,[[[[[0.0755, 0.5044, 0.4799, 0.8754]]]], [[[[0.1559, 0.8761, 0.8567, 0.1237]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con26836), 
exec_layers([LSub27904,LRes82972,LRes63514,LRes70979,LCon26836],["Sub27904","Res82972","Res63514","Res70979","Con26836"],Con26836,"Con26836")

Actual (Unparsed): [[[[[-0.0583697, -0.3264618, -0.3194914, -0.0304933]]], [[[-0.0289769, -0.1935887, -0.1841856, -0.3359785]]]]]

Expected (Unparsed): [[[[[-0.05836971999999999,-0.32646181999999996,-0.3194913999999999,-0.03049330000000002]]],[[[-0.028976899999999993,-0.19358871999999994,-0.18418561999999997,-0.3359785199999999]]]]]

Actual:   [[[[[-0.0583, -0.3264, -0.3194, -0.0304]]], [[[-0.0289, -0.1935, -0.1841, -0.3359]]]]]

Expected: [[[[[-0.0583, -0.3264, -0.3194, -0.0304]]], [[[-0.0289, -0.1935, -0.1841, -0.3359]]]]]