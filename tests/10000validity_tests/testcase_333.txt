import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add4457 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add4457 = tf.keras.layers.Input(shape=([2, 1, 2]))

Add4457 = keras.layers.Add(name = 'Add4457', )([in0Add4457,in1Add4457])
Ave16982 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Ave16982', )(Add4457)
Res78431 = keras.layers.Reshape((2, 2), name = 'Res78431', )(Ave16982)
PRe69862 = keras.layers.PReLU(name = 'PRe69862', )(Res78431)
model = tf.keras.models.Model(inputs=[in0Add4457,in1Add4457], outputs=PRe69862)
w = model.get_layer('PRe69862').get_weights() 
w[0] = np.array([[0.5874, 0.9417], [0.3345, 0.5671]])
model.get_layer('PRe69862').set_weights(w) 
in0Add4457 = tf.constant([[[[0.342, 0.5639]], [[0.8746, 0.7141]]]])
in1Add4457 = tf.constant([[[[0.2485, 0.8055]], [[0.6354, 0.9328]]]])
print (np.array2string(model.predict([in0Add4457,in1Add4457],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe69862.png')

LAdd4457 = add_layer([[[[[0.342, 0.5639]], [[0.8746, 0.7141]]]], [[[[0.2485, 0.8055]], [[0.6354, 0.9328]]]]], Add4457), 
LAve16982 = average_pooling2D_layer(Add4457, 1, 1, 1, 1, true, Ave16982), 
LRes78431 = reshape_layer(Ave16982, [2, 2], Res78431), 
LPRe69862 = prelu_layer(Res78431, [[0.5874, 0.9417], [0.3345, 0.5671]], PRe69862), 
exec_layers([LAdd4457,LAve16982,LRes78431,LPRe69862],["Add4457","Ave16982","Res78431","PRe69862"],PRe69862,"PRe69862")

Actual (Unparsed): [[[0.5905000, 1.3694000], [1.5100000, 1.6469000]]]

Expected (Unparsed): [[[0.5905,1.3694],[1.51,1.6469]]]

Actual:   [[[0.5905, 1.3694], [1.51, 1.6469]]]

Expected: [[[0.5905, 1.3694], [1.51, 1.6469]]]