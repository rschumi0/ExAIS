import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dep87793 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Dot67220 = tf.keras.layers.Input(shape=([2]))
in1Dot67220 = tf.keras.layers.Input(shape=([2]))
in0Mul66955 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul66955 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Ave61819 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con48308 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con65389 = tf.keras.layers.Input(shape=([2, 6]))
in0Mul10276 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Mul10276 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Dep87793 = keras.layers.DepthwiseConv2D((2, 1),strides=(2, 2), padding='valid', name = 'Dep87793', )(in0Dep87793)
Res46649 = keras.layers.Reshape((1, 2), name = 'Res46649', )(Dep87793)
GRU1062 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU1062', )(Res46649)
Res12846 = keras.layers.Reshape((2, 1), name = 'Res12846', )(GRU1062)
Dot67220 = keras.layers.Dot(axes=(1, 1), name = 'Dot67220', )([in0Dot67220,in1Dot67220])
Res66058 = keras.layers.Reshape((1, 1), name = 'Res66058', )(Dot67220)
Up_37135 = keras.layers.UpSampling1D(size=(2), name = 'Up_37135', )(Res66058)
Add50884 = keras.layers.Add(name = 'Add50884', )([Res12846,Up_37135])
Mul66955 = keras.layers.Multiply(name = 'Mul66955', )([in0Mul66955,in1Mul66955])
Ave61819 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave61819', )(in0Ave61819)
Zer70876 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer70876', )(Ave61819)
Con48308 = keras.layers.Concatenate(axis=3, name = 'Con48308', )([Zer70876,in0Con48308])
Max4046 = keras.layers.Maximum(name = 'Max4046', )([Mul66955,Con48308])
Res43914 = keras.layers.Reshape((2, 2), name = 'Res43914', )(Max4046)
Con65389 = keras.layers.Concatenate(axis=2, name = 'Con65389', )([Res43914,in0Con65389])
Mul10276 = keras.layers.Multiply(name = 'Mul10276', )([in0Mul10276,in1Mul10276])
Res36368 = keras.layers.Reshape((1, 2, 4), name = 'Res36368', )(Mul10276)
Res29536 = keras.layers.Reshape((1, 8), name = 'Res29536', )(Res36368)
Dot18359 = keras.layers.Dot(axes=(2, 2), name = 'Dot18359', )([Con65389,Res29536])
Ave43851 = keras.layers.Average(name = 'Ave43851', )([Add50884,Dot18359])
Fla30880 = keras.layers.Flatten(name = 'Fla30880', )(Ave43851)
model = tf.keras.models.Model(inputs=[in0Dep87793,in0Dot67220,in1Dot67220,in0Mul66955,in1Mul66955,in0Ave61819,in0Con48308,in0Con65389,in0Mul10276,in1Mul10276], outputs=Fla30880)
w = model.get_layer('Dep87793').get_weights() 
w[0] = np.array([[[[0.0042], [0.3841]]], [[[0.3614], [0.386]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep87793').set_weights(w) 
w = model.get_layer('GRU1062').get_weights() 
w[0] = np.array([[8, 4, 10, 9, 5, 2], [10, 6, 6, 7, 8, 3]])
w[1] = np.array([[5, 5, 8, 5, 1, 5], [7, 2, 10, 6, 8, 7]])
w[2] = np.array([[4, 9, 10, 3, 3, 9], [8, 4, 6, 3, 2, 8]])
model.get_layer('GRU1062').set_weights(w) 
in0Dep87793 = tf.constant([[[[0.5314, 0.766]], [[0.3351, 0.6742]]]])
in0Dot67220 = tf.constant([[0.1153, 0.8175]])
in1Dot67220 = tf.constant([[0.7153, 0.2985]])
in0Mul66955 = tf.constant([[[[0.5733, 0.0183]], [[0.2297, 0.9922]]]])
in1Mul66955 = tf.constant([[[[0.772, 0.5112]], [[0.0103, 0.1165]]]])
in0Ave61819 = tf.constant([[[[1.6702]]]])
in0Con48308 = tf.constant([[[[0.0906]], [[0.8775]]]])
in0Con65389 = tf.constant([[[0.5642, 0.6751, 0.2587, 0.0205, 0.6128, 0.3198], [0.8902, 0.7152, 0.6154, 0.4274, 0.3202, 0.9838]]])
in0Mul10276 = tf.constant([[[[[0.9123, 0.3063], [0.7439, 0.7955]], [[0.9721, 0.8756], [0.2046, 0.1125]]]]])
in1Mul10276 = tf.constant([[[[[0.4397, 0.1366], [0.6604, 0.8871]], [[0.2782, 0.702], [0.7972, 0.3144]]]]])
print (np.array2string(model.predict([in0Dep87793,in0Dot67220,in1Dot67220,in0Mul66955,in1Mul66955,in0Ave61819,in0Con48308,in0Con65389,in0Mul10276,in1Mul10276],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla30880.png')

LDep87793 = depthwise_conv2D_layer([[[[0.5314, 0.766]], [[0.3351, 0.6742]]]], 2, 1,[[[[0.0042], [0.3841]]], [[[0.3614], [0.386]]]],[0, 0], 2, 2, false, Dep87793), 
LRes46649 = reshape_layer(Dep87793, [1, 2], Res46649), 
LGRU1062 = gru_layer(Res46649,[[8, 4, 10, 9, 5, 2], [10, 6, 6, 7, 8, 3]],[[5, 5, 8, 5, 1, 5], [7, 2, 10, 6, 8, 7]],[[4, 9, 10, 3, 3, 9], [8, 4, 6, 3, 2, 8]], true, GRU1062), 
LRes12846 = reshape_layer(GRU1062, [2, 1], Res12846), 
LDot67220 = dot_layer([[0.1153, 0.8175]], [[0.7153, 0.2985]], 1, 1, Dot67220), 
LRes66058 = reshape_layer(Dot67220, [1, 1], Res66058), 
LUp_37135 = up_sampling1D_layer(Res66058, 2, Up_37135), 
LAdd50884 = add_layer([Res12846,Up_37135], Add50884), 
LMul66955 = multiply_layer([[[[[0.5733, 0.0183]], [[0.2297, 0.9922]]]], [[[[0.772, 0.5112]], [[0.0103, 0.1165]]]]], Mul66955), 
LAve61819 = average_pooling2D_layer([[[[1.6702]]]], 1, 1, Ave61819), 
LZer70876 = zero_padding2D_layer(Ave61819, 1, 0, 0, 0, Zer70876), 
LCon48308 = concatenate_layer([Zer70876,[[[[0.0906]], [[0.8775]]]]], 3, Con48308), 
LMax4046 = maximum_layer([Mul66955,Con48308], Max4046), 
LRes43914 = reshape_layer(Max4046, [2, 2], Res43914), 
LCon65389 = concatenate_layer([Res43914,[[[0.5642, 0.6751, 0.2587, 0.0205, 0.6128, 0.3198], [0.8902, 0.7152, 0.6154, 0.4274, 0.3202, 0.9838]]]], 2, Con65389), 
LMul10276 = multiply_layer([[[[[[0.9123, 0.3063], [0.7439, 0.7955]], [[0.9721, 0.8756], [0.2046, 0.1125]]]]], [[[[[0.4397, 0.1366], [0.6604, 0.8871]], [[0.2782, 0.702], [0.7972, 0.3144]]]]]], Mul10276), 
LRes36368 = reshape_layer(Mul10276, [1, 2, 4], Res36368), 
LRes29536 = reshape_layer(Res36368, [1, 8], Res29536), 
LDot18359 = dot_layer(Con65389,Res29536, 2, 2, Dot18359), 
LAve43851 = average_layer([Add50884,Dot18359], Ave43851), 
LFla30880 = flatten_layer(Ave43851, Fla30880), 
exec_layers([LDep87793,LRes46649,LGRU1062,LRes12846,LDot67220,LRes66058,LUp_37135,LAdd50884,LMul66955,LAve61819,LZer70876,LCon48308,LMax4046,LRes43914,LCon65389,LMul10276,LRes36368,LRes29536,LDot18359,LAve43851,LFla30880],["Dep87793","Res46649","GRU1062","Res12846","Dot67220","Res66058","Up_37135","Add50884","Mul66955","Ave61819","Zer70876","Con48308","Max4046","Res43914","Con65389","Mul10276","Res36368","Res29536","Dot18359","Ave43851","Fla30880"],Fla30880,"Fla30880")

Actual (Unparsed): [[0.7276197, 1.2456971]]

Expected (Unparsed): [[0.7276196801743123,1.2456971486170794]]

Actual:   [[0.7277, 1.2457]]

Expected: [[0.7277, 1.2457]]