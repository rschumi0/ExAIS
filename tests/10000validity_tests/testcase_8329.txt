import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot63878 = tf.keras.layers.Input(shape=([2]))
in1Dot63878 = tf.keras.layers.Input(shape=([2]))

Dot63878 = keras.layers.Dot(axes=(1, 1), name = 'Dot63878', )([in0Dot63878,in1Dot63878])
Res37077 = keras.layers.Reshape((1, 1), name = 'Res37077', )(Dot63878)
Res11196 = keras.layers.Reshape((1, 1, 1), name = 'Res11196', )(Res37077)
Loc79080 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc79080', )(Res11196)
Res43749 = keras.layers.Reshape((1, 4), name = 'Res43749', )(Loc79080)
Max30860 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max30860', )(Res43749)
Glo49720 = keras.layers.GlobalAveragePooling1D(name = 'Glo49720', )(Max30860)
Res28296 = keras.layers.Reshape((4, 1), name = 'Res28296', )(Glo49720)
Ave44260 = keras.layers.AveragePooling1D(pool_size=(3), name = 'Ave44260', )(Res28296)
Res661 = keras.layers.Reshape((1, 1, 1), name = 'Res661', )(Ave44260)
Glo37515 = keras.layers.GlobalMaxPool2D(name = 'Glo37515', )(Res661)
model = tf.keras.models.Model(inputs=[in0Dot63878,in1Dot63878], outputs=Glo37515)
w = model.get_layer('Loc79080').get_weights() 
w[0] = np.array([[[0.0021, 0.6206, 0.4292, 0.8474]]])
w[1] = np.array([[[0, 0, 0, 0]]])
model.get_layer('Loc79080').set_weights(w) 
in0Dot63878 = tf.constant([[0.428, 0.4105]])
in1Dot63878 = tf.constant([[0.0735, 0.1051]])
print (np.array2string(model.predict([in0Dot63878,in1Dot63878],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo37515.png')

LDot63878 = dot_layer([[0.428, 0.4105]], [[0.0735, 0.1051]], 1, 1, Dot63878), 
LRes37077 = reshape_layer(Dot63878, [1, 1], Res37077), 
LRes11196 = reshape_layer(Res37077, [1, 1, 1], Res11196), 
LLoc79080 = locally_connected2D_layer(Res11196, 1, 1,[[[0.0021, 0.6206, 0.4292, 0.8474]]],[[[0, 0, 0, 0]]], 1, 1, Loc79080), 
LRes43749 = reshape_layer(Loc79080, [1, 4], Res43749), 
LMax30860 = max_pool1D_layer(Res43749, 1, Max30860), 
LGlo49720 = global_average_pooling1D_layer(Max30860, Glo49720), 
LRes28296 = reshape_layer(Glo49720, [4, 1], Res28296), 
LAve44260 = average_pooling1D_layer(Res28296, 3, Ave44260), 
LRes661 = reshape_layer(Ave44260, [1, 1, 1], Res661), 
LGlo37515 = global_max_pool2D_layer(Res661, Glo37515), 
exec_layers([LDot63878,LRes37077,LRes11196,LLoc79080,LRes43749,LMax30860,LGlo49720,LRes28296,LAve44260,LRes661,LGlo37515],["Dot63878","Res37077","Res11196","Loc79080","Res43749","Max30860","Glo49720","Res28296","Ave44260","Res661","Glo37515"],Glo37515,"Glo37515")

Actual (Unparsed): [[0.0261578]]

Expected (Unparsed): [[0.026157790148333332]]

Actual:   [[0.0262]]

Expected: [[0.0262]]