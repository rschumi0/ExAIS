import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr71453 = tf.keras.layers.Input(shape=([2, 2]))

Thr71453 = keras.layers.ThresholdedReLU(theta=5.376428497368332, name = 'Thr71453', input_shape=(2, 2))(in0Thr71453)
Res38467 = keras.layers.Reshape((2, 2, 1), name = 'Res38467', )(Thr71453)
Con3963 = keras.layers.Conv2D(2, (2, 2),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con3963', )(Res38467)
Glo56016 = keras.layers.GlobalAveragePooling2D(name = 'Glo56016', )(Con3963)
model = tf.keras.models.Model(inputs=[in0Thr71453], outputs=Glo56016)
w = model.get_layer('Con3963').get_weights() 
w[0] = np.array([[[[0.393, 0.5402]], [[0.3139, 0.8828]]], [[[0.7076, 0.0014]], [[0.2484, 0.5334]]]])
w[1] = np.array([0, 0])
model.get_layer('Con3963').set_weights(w) 
in0Thr71453 = tf.constant([[[0.3348, 0.8925], [0.0208, 0.6451]]])
print (np.array2string(model.predict([in0Thr71453],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo56016.png')

LThr71453 = thresholded_relu_layer([[[0.3348, 0.8925], [0.0208, 0.6451]]], 5.376428497368332, Thr71453), 
LRes38467 = reshape_layer(Thr71453, [2, 2, 1], Res38467), 
LCon3963 = conv2D_layer(Res38467, 2, 2,[[[[0.393, 0.5402]], [[0.3139, 0.8828]]], [[[0.7076, 0.0014]], [[0.2484, 0.5334]]]],[0, 0], 1, 1, true, 1, 1, Con3963), 
LGlo56016 = global_average_pooling2D_layer(Con3963, Glo56016), 
exec_layers([LThr71453,LRes38467,LCon3963,LGlo56016],["Thr71453","Res38467","Con3963","Glo56016"],Glo56016,"Glo56016")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0]]

Actual:   [[0, 0]]

Expected: [[0, 0]]