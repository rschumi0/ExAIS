import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof80149 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con77377 = tf.keras.layers.Input(shape=([2, 3, 3]))
in0Ave67715 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave67715 = tf.keras.layers.Input(shape=([2, 1]))
in0Con86275 = tf.keras.layers.Input(shape=([2, 3, 3]))
in0Mul78763 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Mul78763 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Sof80149 = keras.layers.Softmax(axis=1, name = 'Sof80149', input_shape=(1, 1, 1, 1))(in0Sof80149)
Res76116 = keras.layers.Reshape((1, 1, 1), name = 'Res76116', )(Sof80149)
Zer60293 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer60293', )(Res76116)
Con77377 = keras.layers.Concatenate(axis=3, name = 'Con77377', )([Zer60293,in0Con77377])
Ave67715 = keras.layers.Average(name = 'Ave67715', )([in0Ave67715,in1Ave67715])
Res40317 = keras.layers.Reshape((2, 1, 1), name = 'Res40317', )(Ave67715)
Zer33116 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer33116', )(Res40317)
Con86275 = keras.layers.Concatenate(axis=3, name = 'Con86275', )([Zer33116,in0Con86275])
Mul78763 = keras.layers.Multiply(name = 'Mul78763', )([in0Mul78763,in1Mul78763])
Res10429 = keras.layers.Reshape((1, 2, 4), name = 'Res10429', )(Mul78763)
PRe70332 = keras.layers.PReLU(name = 'PRe70332', )(Res10429)
Zer81327 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer81327', )(PRe70332)
Add32193 = keras.layers.Add(name = 'Add32193', )([Con86275,Zer81327])
Add395 = keras.layers.Add(name = 'Add395', )([Con77377,Add32193])
model = tf.keras.models.Model(inputs=[in0Sof80149,in0Con77377,in0Ave67715,in1Ave67715,in0Con86275,in0Mul78763,in1Mul78763], outputs=Add395)
w = model.get_layer('PRe70332').get_weights() 
w[0] = np.array([[[0.4439, 0.7068, 0.3392, 0.6829], [0.8899, 0.7021, 0.7604, 0.0736]]])
model.get_layer('PRe70332').set_weights(w) 
in0Sof80149 = tf.constant([[[[[0.9456]]]]])
in0Con77377 = tf.constant([[[[0.9219, 0.2984, 0.759], [0.0113, 0.4369, 0.3384], [0.7544, 0.113, 0.099]], [[0.703, 0.8155, 0.1449], [0.6379, 0.2636, 0.6277], [0.8435, 0.5696, 0.1333]]]])
in0Ave67715 = tf.constant([[[0.8037], [0.7814]]])
in1Ave67715 = tf.constant([[[0.5792], [0.6906]]])
in0Con86275 = tf.constant([[[[0.1884, 0.774, 0.9335], [0.4763, 0.8046, 0.2232], [0.4442, 0.3462, 0.349]], [[0.5064, 0.3866, 0.1255], [0.8177, 0.6926, 0.8759], [0.8771, 0.0697, 0.768]]]])
in0Mul78763 = tf.constant([[[[[0.6053, 0.6541], [0.741, 0.6091]], [[0.404, 0.0512], [0.0581, 0.4219]]]]])
in1Mul78763 = tf.constant([[[[[0.4464, 0.2016], [0.3812, 0.4542]], [[0.4946, 0.5951], [0.2143, 0.753]]]]])
print (np.array2string(model.predict([in0Sof80149,in0Con77377,in0Ave67715,in1Ave67715,in0Con86275,in0Mul78763,in1Mul78763],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add395.png')

LSof80149 = softmax_layer([[[[[0.9456]]]]], 1, Sof80149), 
LRes76116 = reshape_layer(Sof80149, [1, 1, 1], Res76116), 
LZer60293 = zero_padding2D_layer(Res76116, 1, 0, 2, 0, Zer60293), 
LCon77377 = concatenate_layer([Zer60293,[[[[0.9219, 0.2984, 0.759], [0.0113, 0.4369, 0.3384], [0.7544, 0.113, 0.099]], [[0.703, 0.8155, 0.1449], [0.6379, 0.2636, 0.6277], [0.8435, 0.5696, 0.1333]]]]], 3, Con77377), 
LAve67715 = average_layer([[[[0.8037], [0.7814]]], [[[0.5792], [0.6906]]]], Ave67715), 
LRes40317 = reshape_layer(Ave67715, [2, 1, 1], Res40317), 
LZer33116 = zero_padding2D_layer(Res40317, 0, 0, 2, 0, Zer33116), 
LCon86275 = concatenate_layer([Zer33116,[[[[0.1884, 0.774, 0.9335], [0.4763, 0.8046, 0.2232], [0.4442, 0.3462, 0.349]], [[0.5064, 0.3866, 0.1255], [0.8177, 0.6926, 0.8759], [0.8771, 0.0697, 0.768]]]]], 3, Con86275), 
LMul78763 = multiply_layer([[[[[[0.6053, 0.6541], [0.741, 0.6091]], [[0.404, 0.0512], [0.0581, 0.4219]]]]], [[[[[0.4464, 0.2016], [0.3812, 0.4542]], [[0.4946, 0.5951], [0.2143, 0.753]]]]]], Mul78763), 
LRes10429 = reshape_layer(Mul78763, [1, 2, 4], Res10429), 
LPRe70332 = prelu_layer(Res10429, [[[0.4439, 0.7068, 0.3392, 0.6829], [0.8899, 0.7021, 0.7604, 0.0736]]], PRe70332), 
LZer81327 = zero_padding2D_layer(PRe70332, 1, 0, 1, 0, Zer81327), 
LAdd32193 = add_layer([Con86275,Zer81327], Add32193), 
LAdd395 = add_layer([Con77377,Add32193], Add395), 
exec_layers([LSof80149,LRes76116,LZer60293,LCon77377,LAve67715,LRes40317,LZer33116,LCon86275,LMul78763,LRes10429,LPRe70332,LZer81327,LAdd32193,LAdd395],["Sof80149","Res76116","Zer60293","Con77377","Ave67715","Res40317","Zer33116","Con86275","Mul78763","Res10429","PRe70332","Zer81327","Add32193","Add395"],Add395,"Add395")

Actual (Unparsed): [[[[0.0000000, 1.1103000, 1.0724000, 1.6925000], [0.0000000, 0.4876000, 1.2415000, 0.5616000], [0.6914500, 1.1986000, 0.4592000, 0.4480000]], [[0.0000000, 1.2094000, 1.2021000, 0.2704000], [0.2702059, 1.5874666, 1.2386692, 1.7802532], [1.9358184, 1.7510691, 0.6517508, 1.2189907]]]]

Expected (Unparsed): [[[[0,1.1103,1.0724,1.6925],[0,0.4876,1.2415,0.5616],[0.69145,1.1985999999999999,0.4592,0.44799999999999995]],[[0,1.2094,1.2021,0.2704],[0.27020592,1.58746656,1.2386692,1.78025322],[1.9358184,1.75106912,0.65175083,1.2189907]]]]

Actual:   [[[[0, 1.1103, 1.0724, 1.6925], [0, 0.4876, 1.2415, 0.5616], [0.6915, 1.1986, 0.4592, 0.448]], [[0, 1.2094, 1.2021, 0.2704], [0.2703, 1.5875, 1.2387, 1.7803], [1.9359, 1.7511, 0.6518, 1.219]]]]

Expected: [[[[0, 1.1103, 1.0724, 1.6925], [0, 0.4876, 1.2415, 0.5616], [0.6915, 1.1986, 0.4592, 0.448]], [[0, 1.2094, 1.2021, 0.2704], [0.2703, 1.5875, 1.2387, 1.7803], [1.9359, 1.7511, 0.6518, 1.219]]]]