import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min47589 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min47589 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con88969 = tf.keras.layers.Input(shape=([6]))
in0Ave38516 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Ave38516 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Glo19717 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con38548 = tf.keras.layers.Input(shape=([6]))
in0GRU2537 = tf.keras.layers.Input(shape=([2, 1]))
in0Con76764 = tf.keras.layers.Input(shape=([6]))

Min47589 = keras.layers.Minimum(name = 'Min47589', )([in0Min47589,in1Min47589])
Res45990 = keras.layers.Reshape((1, 2), name = 'Res45990', )(Min47589)
Fla37057 = keras.layers.Flatten(name = 'Fla37057', )(Res45990)
Con88969 = keras.layers.Concatenate(axis=1, name = 'Con88969', )([Fla37057,in0Con88969])
Ave38516 = keras.layers.Average(name = 'Ave38516', )([in0Ave38516,in1Ave38516])
Res8532 = keras.layers.Reshape((1, 2, 4), name = 'Res8532', )(Ave38516)
Cro46335 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro46335', )(Res8532)
Res60865 = keras.layers.Reshape((1, 8), name = 'Res60865', )(Cro46335)
Fla18953 = keras.layers.Flatten(name = 'Fla18953', )(Res60865)
Glo19717 = keras.layers.GlobalMaxPool2D(name = 'Glo19717', )(in0Glo19717)
Con38548 = keras.layers.Concatenate(axis=1, name = 'Con38548', )([Glo19717,in0Con38548])
Mul11929 = keras.layers.Multiply(name = 'Mul11929', )([Fla18953,Con38548])
GRU2537 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU2537', )(in0GRU2537)
Con76764 = keras.layers.Concatenate(axis=1, name = 'Con76764', )([GRU2537,in0Con76764])
Sub22906 = keras.layers.Subtract(name = 'Sub22906', )([Mul11929,Con76764])
Add44413 = keras.layers.Add(name = 'Add44413', )([Con88969,Sub22906])
model = tf.keras.models.Model(inputs=[in0Min47589,in1Min47589,in0Con88969,in0Ave38516,in1Ave38516,in0Glo19717,in0Con38548,in0GRU2537,in0Con76764], outputs=Add44413)
w = model.get_layer('GRU2537').get_weights() 
w[0] = np.array([[2, 9, 1, 7, 9, 3]])
w[1] = np.array([[7, 6, 2, 5, 4, 2], [10, 6, 10, 6, 3, 7]])
w[2] = np.array([7, 2, 5, 4, 8, 7])
model.get_layer('GRU2537').set_weights(w) 
in0Min47589 = tf.constant([[[[0.7185], [0.3451]]]])
in1Min47589 = tf.constant([[[[0.9888], [0.1391]]]])
in0Con88969 = tf.constant([[0.9765, 0.9602, 0.9662, 0.354, 0.9465, 0.1139]])
in0Ave38516 = tf.constant([[[[[0.2892, 0.3598], [0.617, 0.8927]], [[0.8555, 0.2889], [0.2971, 0.2949]]]]])
in1Ave38516 = tf.constant([[[[[0.138, 0.0876], [0.2215, 0.1303]], [[0.0309, 0.0956], [0.3573, 0.2827]]]]])
in0Glo19717 = tf.constant([[[[1.0057, 1.7524], [1.344, 1.1735]]]])
in0Con38548 = tf.constant([[0.9607, 0.7716, 0.9131, 0.1999, 0.9634, 0.7001]])
in0GRU2537 = tf.constant([[[6], [4]]])
in0Con76764 = tf.constant([[0.347, 0.8483, 0.2146, 0.4542, 0.3296, 0.4959]])
print (np.array2string(model.predict([in0Min47589,in1Min47589,in0Con88969,in0Ave38516,in1Ave38516,in0Glo19717,in0Con38548,in0GRU2537,in0Con76764],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add44413.png')

LMin47589 = minimum_layer([[[[[0.7185], [0.3451]]]], [[[[0.9888], [0.1391]]]]], Min47589), 
LRes45990 = reshape_layer(Min47589, [1, 2], Res45990), 
LFla37057 = flatten_layer(Res45990, Fla37057), 
LCon88969 = concatenate_layer([Fla37057,[[0.9765, 0.9602, 0.9662, 0.354, 0.9465, 0.1139]]], 1, Con88969), 
LAve38516 = average_layer([[[[[[0.2892, 0.3598], [0.617, 0.8927]], [[0.8555, 0.2889], [0.2971, 0.2949]]]]], [[[[[0.138, 0.0876], [0.2215, 0.1303]], [[0.0309, 0.0956], [0.3573, 0.2827]]]]]], Ave38516), 
LRes8532 = reshape_layer(Ave38516, [1, 2, 4], Res8532), 
LCro46335 = cropping2D_layer(Res8532, 0, 0, 0, 0, Cro46335), 
LRes60865 = reshape_layer(Cro46335, [1, 8], Res60865), 
LFla18953 = flatten_layer(Res60865, Fla18953), 
LGlo19717 = global_max_pool2D_layer([[[[1.0057, 1.7524], [1.344, 1.1735]]]], Glo19717), 
LCon38548 = concatenate_layer([Glo19717,[[0.9607, 0.7716, 0.9131, 0.1999, 0.9634, 0.7001]]], 1, Con38548), 
LMul11929 = multiply_layer([Fla18953,Con38548], Mul11929), 
LGRU2537 = gru_layer([[[6], [4]]],[[2, 9, 1, 7, 9, 3]],[[7, 6, 2, 5, 4, 2], [10, 6, 10, 6, 3, 7]],[7, 2, 5, 4, 8, 7], false, GRU2537), 
LCon76764 = concatenate_layer([GRU2537,[[0.347, 0.8483, 0.2146, 0.4542, 0.3296, 0.4959]]], 1, Con76764), 
LSub22906 = subtract_layer(Mul11929,Con76764, Sub22906), 
LAdd44413 = add_layer([Con88969,Sub22906], Add44413), 
exec_layers([LMin47589,LRes45990,LFla37057,LCon88969,LAve38516,LRes8532,LCro46335,LRes60865,LFla18953,LGlo19717,LCon38548,LMul11929,LGRU2537,LCon76764,LSub22906,LAdd44413],["Min47589","Res45990","Fla37057","Con88969","Ave38516","Res8532","Cro46335","Res60865","Fla18953","Glo19717","Con38548","Mul11929","GRU2537","Con76764","Sub22906","Add44413"],Add44413,"Add44413")

Actual (Unparsed): [[1.0055781, 0.5311119, 1.0322734, 0.5065734, 1.1562859, -0.0617692, 0.9321245, -0.1798111]]

Expected (Unparsed): [[1.0055780884949903,0.5311118800000001,1.032273475,0.5065734,1.15628592,-0.06176922500000004,0.93212448,-0.17981112]]

Actual:   [[1.0056, 0.5312, 1.0323, 0.5066, 1.1563, -0.0617, 0.9322, -0.1798]]

Expected: [[1.0056, 0.5312, 1.0323, 0.5066, 1.1563, -0.0617, 0.9322, -0.1798]]