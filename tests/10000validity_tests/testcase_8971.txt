import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat5257 = tf.keras.layers.Input(shape=([4, 1, 2]))
in0Con83731 = tf.keras.layers.Input(shape=([5, 15]))
in0Up_5774 = tf.keras.layers.Input(shape=([3, 3, 3, 2]))

Bat5257 = keras.layers.BatchNormalization(axis=3, epsilon=0.3794249498043507,  name = 'Bat5257', )(in0Bat5257)
Res25272 = keras.layers.Reshape((4, 2), name = 'Res25272', )(Bat5257)
Con75774 = keras.layers.Conv1D(3, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con75774', )(Res25272)
Zer88235 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer88235', )(Con75774)
Con83731 = keras.layers.Concatenate(axis=2, name = 'Con83731', )([Zer88235,in0Con83731])
Up_5774 = keras.layers.UpSampling3D(size=(1, 1, 1), name = 'Up_5774', )(in0Up_5774)
Lea56756 = keras.layers.LeakyReLU(alpha=3.48079451485703, name = 'Lea56756', )(Up_5774)
Res88722 = keras.layers.Reshape((3, 3, 6), name = 'Res88722', )(Lea56756)
Res38176 = keras.layers.Reshape((3, 18), name = 'Res38176', )(Res88722)
Zer34035 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer34035', )(Res38176)
Add7686 = keras.layers.Add(name = 'Add7686', )([Con83731,Zer34035])
model = tf.keras.models.Model(inputs=[in0Bat5257,in0Con83731,in0Up_5774], outputs=Add7686)
w = model.get_layer('Bat5257').get_weights() 
w[0] = np.array([0.3939, 0.3191])
w[1] = np.array([0.9079, 0.6069])
w[2] = np.array([0.307, 0.627])
w[3] = np.array([0.2589, 0.465])
model.get_layer('Bat5257').set_weights(w) 
w = model.get_layer('Con75774').get_weights() 
w[0] = np.array([[[0.1981, 0.0798, 0.5073], [0.078, 0.8609, 0.2632]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con75774').set_weights(w) 
in0Bat5257 = tf.constant([[[[1.9292, 1.3049]], [[1.824, 1.9733]], [[1.0557, 1.4894]], [[1.6172, 1.9163]]]])
in0Con83731 = tf.constant([[[0.5916, 0.847, 0.0992, 0.0393, 0.0515, 0.9787, 0.6678, 0.0813, 0.0066, 0.08, 0.0709, 0.5393, 0.2999, 0.1326, 0.4645], [0.167, 0.0172, 0.4994, 0.914, 0.0899, 0.9557, 0.1167, 0.7499, 0.9326, 0.5079, 0.4606, 0.4284, 0.6582, 0.3161, 0.8736], [0.1281, 0.6784, 0.156, 0.6949, 0.7403, 0.0998, 0.5104, 0.6498, 0.7449, 0.9413, 0.2045, 0.123, 0.7015, 0.7766, 0.2937], [0.266, 0.7323, 0.5364, 0.1168, 0.369, 0.4236, 0.1376, 0.058, 0.5676, 0.0325, 0.1985, 0.0981, 0.7457, 0.7478, 0.3465], [0.675, 0.4491, 0.0264, 0.5276, 0.7255, 0.7288, 0.7017, 0.2859, 0.0336, 0.0962, 0.6439, 0.1983, 0.1712, 0.1917, 0.2433]]])
in0Up_5774 = tf.constant([[[[[1.6505, 1.2772], [1.7778, 1.0728], [1.2268, 1.2573]], [[1.96, 1.6026], [1.5918, 1.6248], [1.7543, 1.2901]], [[1.2206, 1.78], [1.3217, 1.3706], [1.3723, 1.3495]]], [[[1.1628, 1.2022], [1.3733, 1.5869], [1.6162, 1.8854]], [[1.932, 1.0608], [1.9513, 1.8324], [1.7001, 1.6417]], [[1.5952, 1.848], [1.5489, 1.0654], [1.1176, 1.5029]]], [[[1.1922, 1.7672], [1.0882, 1.447], [1.8511, 1.257]], [[1.814, 1.8441], [1.6352, 1.0372], [1.2671, 1.2898]], [[1.1878, 1.9521], [1.2226, 1.4177], [1.9361, 1.9035]]]]])
print (np.array2string(model.predict([in0Bat5257,in0Con83731,in0Up_5774],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add7686.png')

LBat5257 = batch_normalization_layer([[[[1.9292, 1.3049]], [[1.824, 1.9733]], [[1.0557, 1.4894]], [[1.6172, 1.9163]]]], 3, 0.3794249498043507, [0.3939, 0.3191], [0.9079, 0.6069], [0.307, 0.627], [0.2589, 0.465], Bat5257), 
LRes25272 = reshape_layer(Bat5257, [4, 2], Res25272), 
LCon75774 = conv1D_layer(Res25272, 1,[[[0.1981, 0.0798, 0.5073], [0.078, 0.8609, 0.2632]]],[0, 0, 0], 1, false, 1, Con75774), 
LZer88235 = zero_padding1D_layer(Con75774, 1, 0, Zer88235), 
LCon83731 = concatenate_layer([Zer88235,[[[0.5916, 0.847, 0.0992, 0.0393, 0.0515, 0.9787, 0.6678, 0.0813, 0.0066, 0.08, 0.0709, 0.5393, 0.2999, 0.1326, 0.4645], [0.167, 0.0172, 0.4994, 0.914, 0.0899, 0.9557, 0.1167, 0.7499, 0.9326, 0.5079, 0.4606, 0.4284, 0.6582, 0.3161, 0.8736], [0.1281, 0.6784, 0.156, 0.6949, 0.7403, 0.0998, 0.5104, 0.6498, 0.7449, 0.9413, 0.2045, 0.123, 0.7015, 0.7766, 0.2937], [0.266, 0.7323, 0.5364, 0.1168, 0.369, 0.4236, 0.1376, 0.058, 0.5676, 0.0325, 0.1985, 0.0981, 0.7457, 0.7478, 0.3465], [0.675, 0.4491, 0.0264, 0.5276, 0.7255, 0.7288, 0.7017, 0.2859, 0.0336, 0.0962, 0.6439, 0.1983, 0.1712, 0.1917, 0.2433]]]], 2, Con83731), 
LUp_5774 = up_sampling3D_layer([[[[[1.6505, 1.2772], [1.7778, 1.0728], [1.2268, 1.2573]], [[1.96, 1.6026], [1.5918, 1.6248], [1.7543, 1.2901]], [[1.2206, 1.78], [1.3217, 1.3706], [1.3723, 1.3495]]], [[[1.1628, 1.2022], [1.3733, 1.5869], [1.6162, 1.8854]], [[1.932, 1.0608], [1.9513, 1.8324], [1.7001, 1.6417]], [[1.5952, 1.848], [1.5489, 1.0654], [1.1176, 1.5029]]], [[[1.1922, 1.7672], [1.0882, 1.447], [1.8511, 1.257]], [[1.814, 1.8441], [1.6352, 1.0372], [1.2671, 1.2898]], [[1.1878, 1.9521], [1.2226, 1.4177], [1.9361, 1.9035]]]]], 1, 1, 1, Up_5774), 
LLea56756 = leaky_relu_layer(Up_5774, 3.48079451485703, Lea56756), 
LRes88722 = reshape_layer(Lea56756, [3, 3, 6], Res88722), 
LRes38176 = reshape_layer(Res88722, [3, 18], Res38176), 
LZer34035 = zero_padding1D_layer(Res38176, 1, 1, Zer34035), 
LAdd7686 = add_layer([Con83731,Zer34035], Add7686), 
exec_layers([LBat5257,LRes25272,LCon75774,LZer88235,LCon83731,LUp_5774,LLea56756,LRes88722,LRes38176,LZer34035,LAdd7686],["Bat5257","Res25272","Con75774","Zer88235","Con83731","Up_5774","Lea56756","Res88722","Res38176","Zer34035","Add7686"],Add7686,"Add7686")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.5916000, 0.8470000, 0.0992000, 0.0393000, 0.0515000, 0.9787000, 0.6678000, 0.0813000, 0.0066000, 0.0800000, 0.0709000, 0.5393000, 0.2999000, 0.1326000, 0.4645000], [2.0544907, 2.1386113, 2.8657992, 1.2398000, 1.2440000, 1.7567000, 2.8740000, 1.6925000, 2.5475000, 1.7415000, 2.5042000, 2.2227000, 1.7285000, 2.2406000, 1.7501000, 2.0288000, 1.6884000, 2.2230999], [1.5746201, 2.2592909, 2.4960774, 1.7150000, 2.2946000, 2.0414001, 2.6269000, 1.8011000, 2.0511000, 2.3428000, 2.3498999, 2.3866000, 2.5364999, 2.0525001, 1.6719000, 1.7669000, 1.8942000, 1.7966000], [1.5158755, 2.6494015, 1.9745914, 1.7130000, 2.5834000, 1.7934000, 1.9308000, 2.2131000, 2.0588000, 1.1748000, 1.3251000, 1.8574001, 1.2203000, 2.1506000, 1.3207000, 2.1634001, 2.6839000, 2.2500000], [0.3900787, 1.0319145, 1.0658452, 0.6750000, 0.4491000, 0.0264000, 0.5276000, 0.7255000, 0.7288000, 0.7017000, 0.2859000, 0.0336000, 0.0962000, 0.6439000, 0.1983000, 0.1712000, 0.1917000, 0.2433000]]]

Expected (Unparsed): [[[0,0,0,0.5916,0.847,0.0992,0.0393,0.0515,0.9787,0.6678,0.0813,0.0066,0.08,0.0709,0.5393,0.2999,0.1326,0.4645],[2.0544906475409546,2.13861132026476,2.8657992005867285,1.2398,1.244,1.7567000000000002,2.874,1.6925000000000001,2.5475000000000003,1.7415,2.5042,2.2227,1.7285,2.2406,1.7501000000000002,2.0288,1.6884000000000001,2.2231],[1.5746201547927985,2.2592908079569707,2.4960774823707386,1.7149999999999999,2.2946,2.0414,2.6269,1.8011,2.0511,2.3428,2.3499,2.3866,2.5365,2.0525,1.6719,1.7669,1.8941999999999999,1.7966],[1.5158755103925774,2.6494015001268645,1.9745914355361887,1.713,2.5834,1.7933999999999999,1.9308,2.2131,2.0587999999999997,1.1747999999999998,1.3251,1.8574000000000002,1.2203,2.1506,1.3207,2.1634,2.6839,2.25],[0.39007865240058837,1.0319144996772898,1.0658452364722821,0.675,0.4491,0.0264,0.5276,0.7255,0.7288,0.7017,0.2859,0.0336,0.0962,0.6439,0.1983,0.1712,0.1917,0.2433]]]

Actual:   [[[0, 0, 0, 0.5916, 0.847, 0.0992, 0.0393, 0.0515, 0.9787, 0.6678, 0.0813, 0.0066, 0.08, 0.0709, 0.5393, 0.2999, 0.1326, 0.4645], [2.0545, 2.1387, 2.8658, 1.2398, 1.244, 1.7567, 2.874, 1.6925, 2.5475, 1.7415, 2.5042, 2.2227, 1.7285, 2.2406, 1.7501, 2.0288, 1.6884, 2.2231], [1.5747, 2.2593, 2.4961, 1.715, 2.2946, 2.0415, 2.6269, 1.8011, 2.0511, 2.3428, 2.3499, 2.3866, 2.5365, 2.0526, 1.6719, 1.7669, 1.8942, 1.7966], [1.5159, 2.6495, 1.9746, 1.713, 2.5834, 1.7934, 1.9308, 2.2131, 2.0588, 1.1748, 1.3251, 1.8575, 1.2203, 2.1506, 1.3207, 2.1635, 2.6839, 2.25], [0.3901, 1.032, 1.0659, 0.675, 0.4491, 0.0264, 0.5276, 0.7255, 0.7288, 0.7017, 0.2859, 0.0336, 0.0962, 0.6439, 0.1983, 0.1712, 0.1917, 0.2433]]]

Expected: [[[0, 0, 0, 0.5916, 0.847, 0.0992, 0.0393, 0.0515, 0.9787, 0.6678, 0.0813, 0.0066, 0.08, 0.0709, 0.5393, 0.2999, 0.1326, 0.4645], [2.0545, 2.1387, 2.8658, 1.2398, 1.244, 1.7568, 2.874, 1.6926, 2.5476, 1.7415, 2.5042, 2.2227, 1.7285, 2.2406, 1.7502, 2.0288, 1.6885, 2.2231], [1.5747, 2.2593, 2.4961, 1.715, 2.2946, 2.0414, 2.6269, 1.8011, 2.0511, 2.3428, 2.3499, 2.3866, 2.5365, 2.0525, 1.6719, 1.7669, 1.8942, 1.7966], [1.5159, 2.6495, 1.9746, 1.713, 2.5834, 1.7934, 1.9308, 2.2131, 2.0588, 1.1748, 1.3251, 1.8575, 1.2203, 2.1506, 1.3207, 2.1634, 2.6839, 2.25], [0.3901, 1.032, 1.0659, 0.675, 0.4491, 0.0264, 0.5276, 0.7255, 0.7288, 0.7017, 0.2859, 0.0336, 0.0962, 0.6439, 0.1983, 0.1712, 0.1917, 0.2433]]]