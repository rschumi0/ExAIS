import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul26663 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul26663 = tf.keras.layers.Input(shape=([1, 2]))
in0Den95569 = tf.keras.layers.Input(shape=([4, 3]))
in0Con72570 = tf.keras.layers.Input(shape=([4, 1]))

Mul26663 = keras.layers.Multiply(name = 'Mul26663', )([in0Mul26663,in1Mul26663])
Res94936 = keras.layers.Reshape((1, 2, 1), name = 'Res94936', )(Mul26663)
PRe74344 = keras.layers.PReLU(name = 'PRe74344', )(Res94936)
Res33921 = keras.layers.Reshape((1, 2), name = 'Res33921', )(PRe74344)
Zer96221 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer96221', )(Res33921)
Den95569 = keras.layers.Dense(1,name = 'Den95569', )(in0Den95569)
ELU70124 = keras.layers.ELU(alpha=4.2210305458314785, name = 'ELU70124', )(Den95569)
Con72570 = keras.layers.Concatenate(axis=2, name = 'Con72570', )([ELU70124,in0Con72570])
Max4067 = keras.layers.Maximum(name = 'Max4067', )([Zer96221,Con72570])
model = tf.keras.models.Model(inputs=[in0Mul26663,in1Mul26663,in0Den95569,in0Con72570], outputs=Max4067)
w = model.get_layer('PRe74344').get_weights() 
w[0] = np.array([[[0.4749], [0.226]]])
model.get_layer('PRe74344').set_weights(w) 
w = model.get_layer('Den95569').get_weights() 
w[0] = np.array([[0.8023], [0.7467], [0.7551]])
w[1] = np.array([0.614])
model.get_layer('Den95569').set_weights(w) 
in0Mul26663 = tf.constant([[[0.9858, 0.5949]]])
in1Mul26663 = tf.constant([[[0.375, 0.2318]]])
in0Den95569 = tf.constant([[[0.6084, 0.5709, 0.6561], [0.6733, 0.1472, 0.4275], [0.5445, 0.7744, 0.0971], [0.8978, 0.7163, 0.2518]]])
in0Con72570 = tf.constant([[[0.127], [0.8209], [0.4575], [0.8282]]])
print (np.array2string(model.predict([in0Mul26663,in1Mul26663,in0Den95569,in0Con72570],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max4067.png')

LMul26663 = multiply_layer([[[[0.9858, 0.5949]]], [[[0.375, 0.2318]]]], Mul26663), 
LRes94936 = reshape_layer(Mul26663, [1, 2, 1], Res94936), 
LPRe74344 = prelu_layer(Res94936, [[[0.4749], [0.226]]], PRe74344), 
LRes33921 = reshape_layer(PRe74344, [1, 2], Res33921), 
LZer96221 = zero_padding1D_layer(Res33921, 3, 0, Zer96221), 
LDen95569 = dense_layer([[[0.6084, 0.5709, 0.6561], [0.6733, 0.1472, 0.4275], [0.5445, 0.7744, 0.0971], [0.8978, 0.7163, 0.2518]]], [[0.8023], [0.7467], [0.7551]],[0.614], Den95569), 
LELU70124 = elu_layer(Den95569, 4.2210305458314785, ELU70124), 
LCon72570 = concatenate_layer([ELU70124,[[[0.127], [0.8209], [0.4575], [0.8282]]]], 2, Con72570), 
LMax4067 = maximum_layer([Zer96221,Con72570], Max4067), 
exec_layers([LMul26663,LRes94936,LPRe74344,LRes33921,LZer96221,LDen95569,LELU70124,LCon72570,LMax4067],["Mul26663","Res94936","PRe74344","Res33921","Zer96221","Den95569","ELU70124","Con72570","Max4067"],Max4067,"Max4067")

Actual (Unparsed): [[[2.0238314, 0.1270000], [1.5869081, 0.8209000], [1.7024170, 0.4575000], [2.0593004, 0.8282000]]]

Expected (Unparsed): [[[2.02383146,0.127],[1.58690808,0.8209],[1.7024170399999998,0.4575],[2.05930033,0.8282]]]

Actual:   [[[2.0239, 0.127], [1.587, 0.8209], [1.7025, 0.4575], [2.0594, 0.8282]]]

Expected: [[[2.0239, 0.127], [1.587, 0.8209], [1.7025, 0.4575], [2.0594, 0.8282]]]