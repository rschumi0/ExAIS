import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add52360 = tf.keras.layers.Input(shape=([2, 2]))
in1Add52360 = tf.keras.layers.Input(shape=([2, 2]))

Add52360 = keras.layers.Add(name = 'Add52360', )([in0Add52360,in1Add52360])
Res13313 = keras.layers.Reshape((2, 2, 1), name = 'Res13313', )(Add52360)
Sep64424 = keras.layers.SeparableConv2D(4, (2, 2),strides=(2, 2), padding='same', name = 'Sep64424', )(Res13313)
model = tf.keras.models.Model(inputs=[in0Add52360,in1Add52360], outputs=Sep64424)
w = model.get_layer('Sep64424').get_weights() 
w[0] = np.array([[[[0.5949]], [[0.1183]]], [[[0.4017]], [[0.8572]]]])
w[1] = np.array([[[[0.293, 0.4429, 0.46, 0.1892]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep64424').set_weights(w) 
in0Add52360 = tf.constant([[[0.2283, 0.6102], [0.7032, 0.222]]])
in1Add52360 = tf.constant([[[0.8533, 0.3477], [0.1846, 0.0698]]])
print (np.array2string(model.predict([in0Add52360,in1Add52360],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep64424.png')

LAdd52360 = add_layer([[[[0.2283, 0.6102], [0.7032, 0.222]]], [[[0.8533, 0.3477], [0.1846, 0.0698]]]], Add52360), 
LRes13313 = reshape_layer(Add52360, [2, 2, 1], Res13313), 
LSep64424 = separable_conv2D_layer(Res13313, 2, 2,[[[[[0.5949]], [[0.1183]]], [[[0.4017]], [[0.8572]]]],[[[[0.293, 0.4429, 0.46, 0.1892]]]]],[0, 0, 0, 0], 2, 2, true, Sep64424), 
exec_layers([LAdd52360,LRes13313,LSep64424],["Add52360","Res13313","Sep64424"],Sep64424,"Sep64424")

Actual (Unparsed): [[[[0.3995124, 0.6039046, 0.6272209, 0.2579787]]]]

Expected (Unparsed): [[[[0.39951242358999994,0.6039046157269999,0.6272208698,0.257978670796]]]]

Actual:   [[[[0.3996, 0.604, 0.6273, 0.258]]]]

Expected: [[[[0.3996, 0.604, 0.6273, 0.258]]]]