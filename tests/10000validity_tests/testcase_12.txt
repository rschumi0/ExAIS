import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min36746 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Min36746 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Min36746 = keras.layers.Minimum(name = 'Min36746', )([in0Min36746,in1Min36746])
Bat1860 = keras.layers.BatchNormalization(axis=1, epsilon=0.6048394393865242,  name = 'Bat1860', )(Min36746)
model = tf.keras.models.Model(inputs=[in0Min36746,in1Min36746], outputs=Bat1860)
w = model.get_layer('Bat1860').get_weights() 
w[0] = np.array([0.7277])
w[1] = np.array([0.0199])
w[2] = np.array([0.3863])
w[3] = np.array([0.2125])
model.get_layer('Bat1860').set_weights(w) 
in0Min36746 = tf.constant([[[[[0.2938, 0.0269], [0.3801, 0.4855]], [[0.3123, 0.2732], [0.7016, 0.152]]]]])
in1Min36746 = tf.constant([[[[[0.4499, 0.8418], [0.4524, 0.6069]], [[0.8132, 0.6919], [0.9554, 0.6371]]]]])
print (np.array2string(model.predict([in0Min36746,in1Min36746],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat1860.png')

LMin36746 = minimum_layer([[[[[[0.2938, 0.0269], [0.3801, 0.4855]], [[0.3123, 0.2732], [0.7016, 0.152]]]]], [[[[[0.4499, 0.8418], [0.4524, 0.6069]], [[0.8132, 0.6919], [0.9554, 0.6371]]]]]], Min36746), 
LBat1860 = batch_normalization_layer(Min36746, 1, 0.6048394393865242, [0.7277], [0.0199], [0.3863], [0.2125], Bat1860), 
exec_layers([LMin36746,LBat1860],["Min36746","Bat1860"],Bat1860,"Bat1860")

Actual (Unparsed): [[[[[-0.0545548, -0.2693872], [0.0149095, 0.0997478]], [[-0.0396639, -0.0711361], [0.2736904, -0.1686921]]]]]

Expected (Unparsed): [[[[[-0.05455483060073457,-0.269387201274638],[0.014909514057031857,0.09974777508749053]],[[-0.03966386448058764,-0.07113612260479008],[0.2736903577125581,-0.16869207361894178]]]]]

Actual:   [[[[[-0.0545, -0.2693], [0.015, 0.0998]], [[-0.0396, -0.0711], [0.2737, -0.1686]]]]]

Expected: [[[[[-0.0545, -0.2693], [0.015, 0.0998]], [[-0.0396, -0.0711], [0.2737, -0.1686]]]]]