import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max42754 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Max42754 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Mul64429 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul64429 = tf.keras.layers.Input(shape=([1, 2, 2]))

Max42754 = keras.layers.Maximum(name = 'Max42754', )([in0Max42754,in1Max42754])
Res21033 = keras.layers.Reshape((2, 2, 2), name = 'Res21033', )(Max42754)
Res24029 = keras.layers.Reshape((2, 4), name = 'Res24029', )(Res21033)
Mul64429 = keras.layers.Multiply(name = 'Mul64429', )([in0Mul64429,in1Mul64429])
Res33778 = keras.layers.Reshape((1, 4), name = 'Res33778', )(Mul64429)
Dot57233 = keras.layers.Dot(axes=(2, 2), name = 'Dot57233', )([Res24029,Res33778])
Res36075 = keras.layers.Reshape((2, 1, 1), name = 'Res36075', )(Dot57233)
Sep4357 = keras.layers.SeparableConv2D(3, (1, 1),strides=(2, 2), padding='valid', name = 'Sep4357', )(Res36075)
ReL16278 = keras.layers.ReLU(max_value=4.849081543311588, negative_slope=1.8011831908390337, threshold=5.794572941347012, name = 'ReL16278', )(Sep4357)
model = tf.keras.models.Model(inputs=[in0Max42754,in1Max42754,in0Mul64429,in1Mul64429], outputs=ReL16278)
w = model.get_layer('Sep4357').get_weights() 
w[0] = np.array([[[[0.7078]]]])
w[1] = np.array([[[[0.5512, 0.7497, 0.0677]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep4357').set_weights(w) 
in0Max42754 = tf.constant([[[[[0.1965], [0.0456]], [[0.1008], [0.9373]]], [[[0.6406], [0.5021]], [[0.6072], [0.9617]]]]])
in1Max42754 = tf.constant([[[[[0.6392], [0.7304]], [[0.5373], [0.0923]]], [[[0.2051], [0.7876]], [[0.7612], [0.2597]]]]])
in0Mul64429 = tf.constant([[[[0.9755, 0.5286], [0.0993, 0.7811]]]])
in1Mul64429 = tf.constant([[[[0.8653, 0.8635], [0.8646, 0.5505]]]])
print (np.array2string(model.predict([in0Max42754,in1Max42754,in0Mul64429,in1Mul64429],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL16278.png')

LMax42754 = maximum_layer([[[[[[0.1965], [0.0456]], [[0.1008], [0.9373]]], [[[0.6406], [0.5021]], [[0.6072], [0.9617]]]]], [[[[[0.6392], [0.7304]], [[0.5373], [0.0923]]], [[[0.2051], [0.7876]], [[0.7612], [0.2597]]]]]], Max42754), 
LRes21033 = reshape_layer(Max42754, [2, 2, 2], Res21033), 
LRes24029 = reshape_layer(Res21033, [2, 4], Res24029), 
LMul64429 = multiply_layer([[[[[0.9755, 0.5286], [0.0993, 0.7811]]]], [[[[0.8653, 0.8635], [0.8646, 0.5505]]]]], Mul64429), 
LRes33778 = reshape_layer(Mul64429, [1, 4], Res33778), 
LDot57233 = dot_layer(Res24029,Res33778, 2, 2, Dot57233), 
LRes36075 = reshape_layer(Dot57233, [2, 1, 1], Res36075), 
LSep4357 = separable_conv2D_layer(Res36075, 1, 1,[[[[[0.7078]]]],[[[[0.5512, 0.7497, 0.0677]]]]],[0, 0, 0], 2, 2, false, Sep4357), 
LReL16278 = relu_layer(Sep4357, 4.849081543311588, 1.8011831908390337, 5.794572941347012, ReL16278), 
exec_layers([LMax42754,LRes21033,LRes24029,LMul64429,LRes33778,LDot57233,LRes36075,LSep4357,LReL16278],["Max42754","Res21033","Res24029","Mul64429","Res33778","Dot57233","Res36075","Sep4357","ReL16278"],ReL16278,"ReL16278")

Actual (Unparsed): [[[[-9.5080301, -9.1734549, -10.3229778]]]]

Expected (Unparsed): [[[[-9.50803008101168,-9.173454838163167,-10.322977838781236]]]]

Actual:   [[[[-9.508, -9.1734, -10.3229]]]]

Expected: [[[[-9.508, -9.1734, -10.3229]]]]