import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep59563 = tf.keras.layers.Input(shape=([1, 1]))
in0Glo60932 = tf.keras.layers.Input(shape=([2, 1]))
in0Con34934 = tf.keras.layers.Input(shape=([3]))
in0Con90285 = tf.keras.layers.Input(shape=([4, 3, 1]))
in0Add98989 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add98989 = tf.keras.layers.Input(shape=([1, 2, 2]))

Sep59563 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep59563', )(in0Sep59563)
Fla17364 = keras.layers.Flatten(name = 'Fla17364', )(Sep59563)
Glo60932 = keras.layers.GlobalMaxPool1D(name = 'Glo60932', )(in0Glo60932)
Con34934 = keras.layers.Concatenate(axis=1, name = 'Con34934', )([Glo60932,in0Con34934])
Max42271 = keras.layers.Maximum(name = 'Max42271', )([Fla17364,Con34934])
Res99436 = keras.layers.Reshape((4, 1), name = 'Res99436', )(Max42271)
Res61296 = keras.layers.Reshape((4, 1, 1), name = 'Res61296', )(Res99436)
Zer22438 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer22438', )(Res61296)
Con90285 = keras.layers.Concatenate(axis=3, name = 'Con90285', )([Zer22438,in0Con90285])
Add98989 = keras.layers.Add(name = 'Add98989', )([in0Add98989,in1Add98989])
Zer30478 = keras.layers.ZeroPadding2D(padding=((3, 0), (1, 0)), name = 'Zer30478', )(Add98989)
Max47633 = keras.layers.Maximum(name = 'Max47633', )([Con90285,Zer30478])
model = tf.keras.models.Model(inputs=[in0Sep59563,in0Glo60932,in0Con34934,in0Con90285,in0Add98989,in1Add98989], outputs=Max47633)
w = model.get_layer('Sep59563').get_weights() 
w[0] = np.array([[[0.9193]]])
w[1] = np.array([[[0.7478, 0.7297, 0.6133, 0.5978]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep59563').set_weights(w) 
in0Sep59563 = tf.constant([[[0.1048]]])
in0Glo60932 = tf.constant([[[1.7116], [1.906]]])
in0Con34934 = tf.constant([[0.3787, 0.4763, 0.1497]])
in0Con90285 = tf.constant([[[[0.6189], [0.5655], [0.7046]], [[0.1728], [0.6903], [0.9751]], [[0.8049], [0.0553], [0.0223]], [[0.8494], [0.0114], [0.8218]]]])
in0Add98989 = tf.constant([[[[0.0307, 0.9221], [0.8889, 0.6463]]]])
in1Add98989 = tf.constant([[[[0.6228, 0.9604], [0.4535, 0.2375]]]])
print (np.array2string(model.predict([in0Sep59563,in0Glo60932,in0Con34934,in0Con90285,in0Add98989,in1Add98989],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max47633.png')

LSep59563 = separable_conv1D_layer([[[0.1048]]], 1,[[[[0.9193]]],[[[0.7478, 0.7297, 0.6133, 0.5978]]]],[0, 0, 0, 0], 1, true, Sep59563), 
LFla17364 = flatten_layer(Sep59563, Fla17364), 
LGlo60932 = global_max_pool1D_layer([[[1.7116], [1.906]]], Glo60932), 
LCon34934 = concatenate_layer([Glo60932,[[0.3787, 0.4763, 0.1497]]], 1, Con34934), 
LMax42271 = maximum_layer([Fla17364,Con34934], Max42271), 
LRes99436 = reshape_layer(Max42271, [4, 1], Res99436), 
LRes61296 = reshape_layer(Res99436, [4, 1, 1], Res61296), 
LZer22438 = zero_padding2D_layer(Res61296, 0, 0, 2, 0, Zer22438), 
LCon90285 = concatenate_layer([Zer22438,[[[[0.6189], [0.5655], [0.7046]], [[0.1728], [0.6903], [0.9751]], [[0.8049], [0.0553], [0.0223]], [[0.8494], [0.0114], [0.8218]]]]], 3, Con90285), 
LAdd98989 = add_layer([[[[[0.0307, 0.9221], [0.8889, 0.6463]]]], [[[[0.6228, 0.9604], [0.4535, 0.2375]]]]], Add98989), 
LZer30478 = zero_padding2D_layer(Add98989, 3, 0, 1, 0, Zer30478), 
LMax47633 = maximum_layer([Con90285,Zer30478], Max47633), 
exec_layers([LSep59563,LFla17364,LGlo60932,LCon34934,LMax42271,LRes99436,LRes61296,LZer22438,LCon90285,LAdd98989,LZer30478,LMax47633],["Sep59563","Fla17364","Glo60932","Con34934","Max42271","Res99436","Res61296","Zer22438","Con90285","Add98989","Zer30478","Max47633"],Max47633,"Max47633")

Actual (Unparsed): [[[[0.0000000, 0.6189000], [0.0000000, 0.5655000], [1.9060000, 0.7046000]], [[0.0000000, 0.1728000], [0.0000000, 0.6903000], [0.3787000, 0.9751000]], [[0.0000000, 0.8049000], [0.0000000, 0.0553000], [0.4763000, 0.0223000]], [[0.0000000, 0.8494000], [0.6535000, 1.8825000], [1.3424000, 0.8838000]]]]

Expected (Unparsed): [[[[0,0.6189],[0,0.5655],[1.906,0.7046]],[[0,0.1728],[0,0.6903],[0.3787,0.9751]],[[0,0.8049],[0,0.0553],[0.4763,0.0223]],[[0,0.8494],[0.6535,1.8825],[1.3424,0.8837999999999999]]]]

Actual:   [[[[0, 0.6189], [0, 0.5655], [1.906, 0.7046]], [[0, 0.1728], [0, 0.6903], [0.3787, 0.9751]], [[0, 0.8049], [0, 0.0553], [0.4763, 0.0223]], [[0, 0.8494], [0.6535, 1.8825], [1.3424, 0.8838]]]]

Expected: [[[[0, 0.6189], [0, 0.5655], [1.906, 0.7046]], [[0, 0.1728], [0, 0.6903], [0.3787, 0.9751]], [[0, 0.8049], [0, 0.0553], [0.4763, 0.0223]], [[0, 0.8494], [0.6535, 1.8825], [1.3424, 0.8838]]]]