import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub97623 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub97623 = tf.keras.layers.Input(shape=([3, 3]))
in0Ave97488 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave97488 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave62880 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave62880 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Glo14211 = tf.keras.layers.Input(shape=([1, 2]))
in0Con29557 = tf.keras.layers.Input(shape=([2]))
in0Min26708 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min26708 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dot32453 = tf.keras.layers.Input(shape=([3]))
in1Dot32453 = tf.keras.layers.Input(shape=([3]))
in0Con49771 = tf.keras.layers.Input(shape=([3]))
in0Con80100 = tf.keras.layers.Input(shape=([2]))

Sub97623 = keras.layers.Subtract(name = 'Sub97623', )([in0Sub97623,in1Sub97623])
LST24315 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST24315', )(Sub97623)
Res90375 = keras.layers.Reshape((2, 1), name = 'Res90375', )(LST24315)
PRe62060 = keras.layers.PReLU(name = 'PRe62060', )(Res90375)
Res30737 = keras.layers.Reshape((2, 1, 1), name = 'Res30737', )(PRe62060)
Zer77266 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer77266', )(Res30737)
Ave97488 = keras.layers.Average(name = 'Ave97488', )([in0Ave97488,in1Ave97488])
Res89819 = keras.layers.Reshape((2, 1, 1), name = 'Res89819', )(Ave97488)
Zer16881 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer16881', )(Res89819)
Ave62880 = keras.layers.Average(name = 'Ave62880', )([in0Ave62880,in1Ave62880])
Zer69212 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer69212', )(Ave62880)
Ave55108 = keras.layers.Average(name = 'Ave55108', )([Zer16881,Zer69212])
Sub92159 = keras.layers.Subtract(name = 'Sub92159', )([Zer77266,Ave55108])
Res75372 = keras.layers.Reshape((2, 3), name = 'Res75372', )(Sub92159)
Fla89146 = keras.layers.Flatten(name = 'Fla89146', )(Res75372)
Glo14211 = keras.layers.GlobalAveragePooling1D(name = 'Glo14211', )(in0Glo14211)
Con29557 = keras.layers.Concatenate(axis=1, name = 'Con29557', )([Glo14211,in0Con29557])
Min26708 = keras.layers.Minimum(name = 'Min26708', )([in0Min26708,in1Min26708])
Res15622 = keras.layers.Reshape((1, 4), name = 'Res15622', )(Min26708)
Fla82082 = keras.layers.Flatten(name = 'Fla82082', )(Res15622)
Dot32453 = keras.layers.Dot(axes=(1, 1), name = 'Dot32453', )([in0Dot32453,in1Dot32453])
Con49771 = keras.layers.Concatenate(axis=1, name = 'Con49771', )([Dot32453,in0Con49771])
Min83075 = keras.layers.Minimum(name = 'Min83075', )([Fla82082,Con49771])
Mul67438 = keras.layers.Multiply(name = 'Mul67438', )([Con29557,Min83075])
Con80100 = keras.layers.Concatenate(axis=1, name = 'Con80100', )([Mul67438,in0Con80100])
Min1518 = keras.layers.Minimum(name = 'Min1518', )([Fla89146,Con80100])
model = tf.keras.models.Model(inputs=[in0Sub97623,in1Sub97623,in0Ave97488,in1Ave97488,in0Ave62880,in1Ave62880,in0Glo14211,in0Con29557,in0Min26708,in1Min26708,in0Dot32453,in1Dot32453,in0Con49771,in0Con80100], outputs=Min1518)
w = model.get_layer('LST24315').get_weights() 
w[0] = np.array([[7, 4, 1, 3, 7, 10, 6, 7], [6, 5, 5, 7, 3, 1, 10, 1], [2, 4, 1, 10, 4, 10, 4, 4]])
w[1] = np.array([[9, 7, 5, 6, 8, 1, 8, 5], [5, 9, 9, 2, 5, 8, 7, 7]])
w[2] = np.array([2, 3, 5, 6, 3, 1, 5, 4])
model.get_layer('LST24315').set_weights(w) 
w = model.get_layer('PRe62060').get_weights() 
w[0] = np.array([[0.6922], [0.6559]])
model.get_layer('PRe62060').set_weights(w) 
in0Sub97623 = tf.constant([[[0.2687, 0.8288, 0.832], [0.8331, 0.1709, 0.4989], [0.474, 0.5676, 0.2773]]])
in1Sub97623 = tf.constant([[[0.9076, 0.7327, 0.8309], [0.4533, 0.216, 0.8], [0.2963, 0.3782, 0.63]]])
in0Ave97488 = tf.constant([[[0.4697], [0.7097]]])
in1Ave97488 = tf.constant([[[0.8961], [0.8979]]])
in0Ave62880 = tf.constant([[[[0.1767], [0.5173]]]])
in1Ave62880 = tf.constant([[[[0.861], [0.5088]]]])
in0Glo14211 = tf.constant([[[1.136, 1.7618]]])
in0Con29557 = tf.constant([[0.152, 0.8107]])
in0Min26708 = tf.constant([[[[0.5719, 0.0715], [0.5121, 0.3898]]]])
in1Min26708 = tf.constant([[[[0.7539, 0.1896], [0.9189, 0.0915]]]])
in0Dot32453 = tf.constant([[0.1823, 0.5174, 0.7153]])
in1Dot32453 = tf.constant([[0.8051, 0.47, 0.5822]])
in0Con49771 = tf.constant([[0.9086, 0.2618, 0.9576]])
in0Con80100 = tf.constant([[0.6272, 0.3993]])
print (np.array2string(model.predict([in0Sub97623,in1Sub97623,in0Ave97488,in1Ave97488,in0Ave62880,in1Ave62880,in0Glo14211,in0Con29557,in0Min26708,in1Min26708,in0Dot32453,in1Dot32453,in0Con49771,in0Con80100],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min1518.png')

LSub97623 = subtract_layer([[[0.2687, 0.8288, 0.832], [0.8331, 0.1709, 0.4989], [0.474, 0.5676, 0.2773]]], [[[0.9076, 0.7327, 0.8309], [0.4533, 0.216, 0.8], [0.2963, 0.3782, 0.63]]], Sub97623), 
LLST24315 = lstm_layer(Sub97623,[[7, 4, 1, 3, 7, 10, 6, 7], [6, 5, 5, 7, 3, 1, 10, 1], [2, 4, 1, 10, 4, 10, 4, 4]],[[9, 7, 5, 6, 8, 1, 8, 5], [5, 9, 9, 2, 5, 8, 7, 7]],[2, 3, 5, 6, 3, 1, 5, 4], LST24315), 
LRes90375 = reshape_layer(LST24315, [2, 1], Res90375), 
LPRe62060 = prelu_layer(Res90375, [[0.6922], [0.6559]], PRe62060), 
LRes30737 = reshape_layer(PRe62060, [2, 1, 1], Res30737), 
LZer77266 = zero_padding2D_layer(Res30737, 0, 0, 2, 0, Zer77266), 
LAve97488 = average_layer([[[[0.4697], [0.7097]]], [[[0.8961], [0.8979]]]], Ave97488), 
LRes89819 = reshape_layer(Ave97488, [2, 1, 1], Res89819), 
LZer16881 = zero_padding2D_layer(Res89819, 0, 0, 2, 0, Zer16881), 
LAve62880 = average_layer([[[[[0.1767], [0.5173]]]], [[[[0.861], [0.5088]]]]], Ave62880), 
LZer69212 = zero_padding2D_layer(Ave62880, 1, 0, 1, 0, Zer69212), 
LAve55108 = average_layer([Zer16881,Zer69212], Ave55108), 
LSub92159 = subtract_layer(Zer77266,Ave55108, Sub92159), 
LRes75372 = reshape_layer(Sub92159, [2, 3], Res75372), 
LFla89146 = flatten_layer(Res75372, Fla89146), 
LGlo14211 = global_average_pooling1D_layer([[[1.136, 1.7618]]], Glo14211), 
LCon29557 = concatenate_layer([Glo14211,[[0.152, 0.8107]]], 1, Con29557), 
LMin26708 = minimum_layer([[[[[0.5719, 0.0715], [0.5121, 0.3898]]]], [[[[0.7539, 0.1896], [0.9189, 0.0915]]]]], Min26708), 
LRes15622 = reshape_layer(Min26708, [1, 4], Res15622), 
LFla82082 = flatten_layer(Res15622, Fla82082), 
LDot32453 = dot_layer([[0.1823, 0.5174, 0.7153]], [[0.8051, 0.47, 0.5822]], 1, 1, Dot32453), 
LCon49771 = concatenate_layer([Dot32453,[[0.9086, 0.2618, 0.9576]]], 1, Con49771), 
LMin83075 = minimum_layer([Fla82082,Con49771], Min83075), 
LMul67438 = multiply_layer([Con29557,Min83075], Mul67438), 
LCon80100 = concatenate_layer([Mul67438,[[0.6272, 0.3993]]], 1, Con80100), 
LMin1518 = minimum_layer([Fla89146,Con80100], Min1518), 
exec_layers([LSub97623,LLST24315,LRes90375,LPRe62060,LRes30737,LZer77266,LAve97488,LRes89819,LZer16881,LAve62880,LZer69212,LAve55108,LSub92159,LRes75372,LFla89146,LGlo14211,LCon29557,LMin26708,LRes15622,LFla82082,LDot32453,LCon49771,LMin83075,LMul67438,LCon80100,LMin1518],["Sub97623","LST24315","Res90375","PRe62060","Res30737","Zer77266","Ave97488","Res89819","Zer16881","Ave62880","Zer69212","Ave55108","Sub92159","Res75372","Fla89146","Glo14211","Con29557","Min26708","Res15622","Fla82082","Dot32453","Con49771","Min83075","Mul67438","Con80100","Min1518"],Min1518,"Min1518")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0397936, 0.0000000, -0.2594250, -1.2137851]]

Expected (Unparsed): [[0,0,0.0397936,0,-0.259425,-1.2137851056220081]]

Actual:   [[0, 0, 0.0398, 0, -0.2594, -1.2137]]

Expected: [[0, 0, 0.0398, 0, -0.2594, -1.2137]]