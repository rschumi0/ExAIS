import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU55149 = tf.keras.layers.Input(shape=([3, 1]))

GRU55149 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU55149', )(in0GRU55149)
Res71587 = keras.layers.Reshape((2, 1), name = 'Res71587', )(GRU55149)
Per11804 = keras.layers.Permute((1,2), name = 'Per11804',)(Res71587)
Res63282 = keras.layers.Reshape((2, 1, 1), name = 'Res63282', )(Per11804)
Res59100 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res59100', )(Res63282)
Con48794 = keras.layers.Conv3D(3, (2, 1, 1),strides=(1, 1, 3), padding='valid', dilation_rate=(1, 1, 1), name = 'Con48794', )(Res59100)
model = tf.keras.models.Model(inputs=[in0GRU55149], outputs=Con48794)
w = model.get_layer('GRU55149').get_weights() 
w[0] = np.array([[7, 10, 7, 9, 5, 4]])
w[1] = np.array([[8, 2, 2, 2, 10, 8], [3, 9, 6, 6, 2, 6]])
w[2] = np.array([[3, 3, 9, 3, 9, 4], [5, 3, 6, 1, 5, 8]])
model.get_layer('GRU55149').set_weights(w) 
w = model.get_layer('Con48794').get_weights() 
w[0] = np.array([[[[[0.7062, 0.2364, 0.2312]]]], [[[[0.6824, 0.9291, 0.9735]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con48794').set_weights(w) 
in0GRU55149 = tf.constant([[[7], [6], [6]]])
print (np.array2string(model.predict([in0GRU55149],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con48794.png')

LGRU55149 = gru_layer([[[7], [6], [6]]],[[7, 10, 7, 9, 5, 4]],[[8, 2, 2, 2, 10, 8], [3, 9, 6, 6, 2, 6]],[[3, 3, 9, 3, 9, 4], [5, 3, 6, 1, 5, 8]], true, GRU55149), 
LRes71587 = reshape_layer(GRU55149, [2, 1], Res71587), 
LPer11804 = permute_layer(Res71587, 1,2, Per11804), 
LRes63282 = reshape_layer(Per11804, [2, 1, 1], Res63282), 
LRes59100 = reshape_layer(Res63282, [2, 1, 1, 1], Res59100), 
LCon48794 = conv3D_layer(Res59100, 2, 1, 1,[[[[[0.7062, 0.2364, 0.2312]]]], [[[[0.6824, 0.9291, 0.9735]]]]],[0, 0, 0], 1, 1, 3, false, 1, 1, 1, Con48794), 
exec_layers([LGRU55149,LRes71587,LPer11804,LRes63282,LRes59100,LCon48794],["GRU55149","Res71587","Per11804","Res63282","Res59100","Con48794"],Con48794,"Con48794")

Actual (Unparsed): [[[[[0.0000000, 0.0000000, 0.0000000]]]]]

Expected (Unparsed): [[[[[0.0,0.0,0.0]]]]]

Actual:   [[[[[0, 0, 0]]]]]

Expected: [[[[[0, 0, 0]]]]]