import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dep26876 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Dot87292 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot87292 = tf.keras.layers.Input(shape=([3, 2]))
in0Ave76730 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave76730 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Dep26876 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='same', name = 'Dep26876', )(in0Dep26876)
Res26023 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res26023', )(Dep26876)
Zer19252 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer19252', )(Res26023)
Dot87292 = keras.layers.Dot(axes=(1, 1), name = 'Dot87292', )([in0Dot87292,in1Dot87292])
Res88875 = keras.layers.Reshape((2, 2, 1), name = 'Res88875', )(Dot87292)
Res26098 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res26098', )(Res88875)
Zer68383 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer68383', )(Res26098)
Ave76730 = keras.layers.Average(name = 'Ave76730', )([in0Ave76730,in1Ave76730])
Zer50686 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer50686', )(Ave76730)
Min63608 = keras.layers.Minimum(name = 'Min63608', )([Zer68383,Zer50686])
Sub391 = keras.layers.Subtract(name = 'Sub391', )([Zer19252,Min63608])
Res97094 = keras.layers.Reshape((2, 2, 3), name = 'Res97094', )(Sub391)
Res75451 = keras.layers.Reshape((2, 6), name = 'Res75451', )(Res97094)
Ave7572 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='valid', name = 'Ave7572', )(Res75451)
model = tf.keras.models.Model(inputs=[in0Dep26876,in0Dot87292,in1Dot87292,in0Ave76730,in1Ave76730], outputs=Ave7572)
w = model.get_layer('Dep26876').get_weights() 
w[0] = np.array([[[[0.3324], [0.9354]]], [[[0.127], [0.331]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep26876').set_weights(w) 
in0Dep26876 = tf.constant([[[[0.5209, 0.5513]], [[0.8528, 0.8949]]]])
in0Dot87292 = tf.constant([[[0.5387, 0.7694], [0.2632, 0.6012], [0.4619, 0.2225]]])
in1Dot87292 = tf.constant([[[0.9712, 0.1452], [0.7366, 0.2901], [0.0884, 0.4263]]])
in0Ave76730 = tf.constant([[[[[0.5163], [0.257]]]]])
in1Ave76730 = tf.constant([[[[[0.9642], [0.0096]]]]])
print (np.array2string(model.predict([in0Dep26876,in0Dot87292,in1Dot87292,in0Ave76730,in1Ave76730],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave7572.png')

LDep26876 = depthwise_conv2D_layer([[[[0.5209, 0.5513]], [[0.8528, 0.8949]]]], 2, 1,[[[[0.3324], [0.9354]]], [[[0.127], [0.331]]]],[0, 0], 1, 1, true, Dep26876), 
LRes26023 = reshape_layer(Dep26876, [2, 1, 2, 1], Res26023), 
LZer19252 = zero_padding3D_layer(Res26023, 0, 0, 1, 0, 1, 0, Zer19252), 
LDot87292 = dot_layer([[[0.5387, 0.7694], [0.2632, 0.6012], [0.4619, 0.2225]]], [[[0.9712, 0.1452], [0.7366, 0.2901], [0.0884, 0.4263]]], 1, 1, Dot87292), 
LRes88875 = reshape_layer(Dot87292, [2, 2, 1], Res88875), 
LRes26098 = reshape_layer(Res88875, [2, 2, 1, 1], Res26098), 
LZer68383 = zero_padding3D_layer(Res26098, 0, 0, 0, 0, 2, 0, Zer68383), 
LAve76730 = average_layer([[[[[[0.5163], [0.257]]]]], [[[[[0.9642], [0.0096]]]]]], Ave76730), 
LZer50686 = zero_padding3D_layer(Ave76730, 1, 0, 1, 0, 1, 0, Zer50686), 
LMin63608 = minimum_layer([Zer68383,Zer50686], Min63608), 
LSub391 = subtract_layer(Zer19252,Min63608, Sub391), 
LRes97094 = reshape_layer(Sub391, [2, 2, 3], Res97094), 
LRes75451 = reshape_layer(Res97094, [2, 6], Res75451), 
LAve7572 = average_pooling1D_layer(Res75451, 1, 1, false, Ave7572), 
exec_layers([LDep26876,LRes26023,LZer19252,LDot87292,LRes88875,LRes26098,LZer68383,LAve76730,LZer50686,LMin63608,LSub391,LRes97094,LRes75451,LAve7572],["Dep26876","Res26023","Zer19252","Dot87292","Res88875","Res26098","Zer68383","Ave76730","Zer50686","Min63608","Sub391","Res97094","Res75451","Ave7572"],Ave7572,"Ave7572")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.2814528, 0.8118979], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.2834707, 0.7037895]]]

Expected (Unparsed): [[[0,0,0,0,0.28145275999999997,0.81189792],[0,0,0,0,0.28347071999999995,0.7037894600000001]]]

Actual:   [[[0, 0, 0, 0, 0.2815, 0.8119], [0, 0, 0, 0, 0.2835, 0.7038]]]

Expected: [[[0, 0, 0, 0, 0.2815, 0.8119], [0, 0, 0, 0, 0.2835, 0.7038]]]