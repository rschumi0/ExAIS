import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add5412 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Add5412 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Add5412 = keras.layers.Add(name = 'Add5412', )([in0Add5412,in1Add5412])
Bat18275 = keras.layers.BatchNormalization(axis=1, epsilon=0.6628369552850206,  name = 'Bat18275', )(Add5412)
model = tf.keras.models.Model(inputs=[in0Add5412,in1Add5412], outputs=Bat18275)
w = model.get_layer('Bat18275').get_weights() 
w[0] = np.array([0.1779, 0.601])
w[1] = np.array([0.0713, 0.9727])
w[2] = np.array([0.001, 0.1944])
w[3] = np.array([0.0089, 0.9152])
model.get_layer('Bat18275').set_weights(w) 
in0Add5412 = tf.constant([[[[[0.0005]]], [[[0.0038]]]]])
in1Add5412 = tf.constant([[[[[0.1451]]], [[[0.2345]]]]])
print (np.array2string(model.predict([in0Add5412,in1Add5412],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat18275.png')

LAdd5412 = add_layer([[[[[[0.0005]]], [[[0.0038]]]]], [[[[[0.1451]]], [[[0.2345]]]]]], Add5412), 
LBat18275 = batch_normalization_layer(Add5412, 1, 0.6628369552850206, [0.1779, 0.601], [0.0713, 0.9727], [0.001, 0.1944], [0.0089, 0.9152], Bat18275), 
exec_layers([LAdd5412,LBat18275],["Add5412","Bat18275"],Bat18275,"Bat18275")

Actual (Unparsed): [[[[[0.1026866]]], [[[0.9937030]]]]]

Expected (Unparsed): [[[[[0.10268662512547526]]],[[[0.9937029552712955]]]]]

Actual:   [[[[[0.1027]]], [[[0.9938]]]]]

Expected: [[[[[0.1027]]], [[[0.9938]]]]]