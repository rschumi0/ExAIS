import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe21991 = tf.keras.layers.Input(shape=([2, 2]))

PRe21991 = keras.layers.PReLU(name = 'PRe21991', input_shape=(2, 2))(in0PRe21991)
Per51211 = keras.layers.Permute((2,1), name = 'Per51211',)(PRe21991)
Sim8809 = keras.layers.SimpleRNN(2,name = 'Sim8809', )(Per51211)
model = tf.keras.models.Model(inputs=[in0PRe21991], outputs=Sim8809)
w = model.get_layer('PRe21991').get_weights() 
w[0] = np.array([[0.8066, 0.7771], [0.3618, 0.5532]])
model.get_layer('PRe21991').set_weights(w) 
w = model.get_layer('Sim8809').get_weights() 
w[0] = np.array([[9, 2], [4, 10]])
w[1] = np.array([[3, 6], [5, 4]])
w[2] = np.array([4, 10])
model.get_layer('Sim8809').set_weights(w) 
in0PRe21991 = tf.constant([[[0.1425, 0.1901], [0.3482, 0.6671]]])
print (np.array2string(model.predict([in0PRe21991],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim8809.png')

LPRe21991 = prelu_layer([[[0.1425, 0.1901], [0.3482, 0.6671]]], [[0.8066, 0.7771], [0.3618, 0.5532]], PRe21991), 
LPer51211 = permute_layer(PRe21991, 2,1, Per51211), 
LSim8809 = simple_rnn_layer(Per51211,[[9, 2], [4, 10]],[[3, 6], [5, 4]],[4, 10], Sim8809), 
exec_layers([LPRe21991,LPer51211,LSim8809],["PRe21991","Per51211","Sim8809"],Sim8809,"Sim8809")

Actual (Unparsed): [[1.0000000, 1.0000000]]

Expected (Unparsed): [[0.9999999999999881,1.0]]

Actual:   [[1, 1]]

Expected: [[1, 1]]