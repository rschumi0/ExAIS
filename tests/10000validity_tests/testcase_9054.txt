import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add91287 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Add91287 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con52731 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Max26682 = tf.keras.layers.Input(shape=([2, 2]))
in1Max26682 = tf.keras.layers.Input(shape=([2, 2]))
in0Con95322 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Min74049 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Min74049 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Up_28432 = tf.keras.layers.Input(shape=([1, 3, 1]))
in0Con43580 = tf.keras.layers.Input(shape=([2, 6]))

Add91287 = keras.layers.Add(name = 'Add91287', )([in0Add91287,in1Add91287])
Con52731 = keras.layers.Concatenate(axis=4, name = 'Con52731', )([Add91287,in0Con52731])
Max26682 = keras.layers.Maximum(name = 'Max26682', )([in0Max26682,in1Max26682])
Res88434 = keras.layers.Reshape((2, 2, 1), name = 'Res88434', )(Max26682)
Res39551 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res39551', )(Res88434)
Zer49929 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer49929', )(Res39551)
Con95322 = keras.layers.Concatenate(axis=4, name = 'Con95322', )([Zer49929,in0Con95322])
Min74049 = keras.layers.Minimum(name = 'Min74049', )([in0Min74049,in1Min74049])
Ave36194 = keras.layers.Average(name = 'Ave36194', )([Con95322,Min74049])
Mul33259 = keras.layers.Multiply(name = 'Mul33259', )([Con52731,Ave36194])
Res69651 = keras.layers.Reshape((2, 2, 4), name = 'Res69651', )(Mul33259)
Res79298 = keras.layers.Reshape((2, 8), name = 'Res79298', )(Res69651)
Up_28432 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_28432', )(in0Up_28432)
Res451 = keras.layers.Reshape((2, 6), name = 'Res451', )(Up_28432)
Con99134 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con99134', )(Res451)
Con43580 = keras.layers.Concatenate(axis=2, name = 'Con43580', )([Con99134,in0Con43580])
Mul62626 = keras.layers.Multiply(name = 'Mul62626', )([Res79298,Con43580])
model = tf.keras.models.Model(inputs=[in0Add91287,in1Add91287,in0Con52731,in0Max26682,in1Max26682,in0Con95322,in0Min74049,in1Min74049,in0Up_28432,in0Con43580], outputs=Mul62626)
w = model.get_layer('Con99134').get_weights() 
w[0] = np.array([[[0.2972, 0.1926], [0.4644, 0.2535], [0.4756, 0.589], [0.7565, 0.4625], [0.2894, 0.6304], [0.373, 0.3176]]])
w[1] = np.array([0, 0])
model.get_layer('Con99134').set_weights(w) 
in0Add91287 = tf.constant([[[[[0.9644], [0.6903]], [[0.3276], [0.2226]]], [[[0.6642], [0.618]], [[0.4629], [0.4459]]]]])
in1Add91287 = tf.constant([[[[[0.461], [0.194]], [[0.0245], [0.6828]]], [[[0.336], [0.8608]], [[0.9967], [0.7724]]]]])
in0Con52731 = tf.constant([[[[[0.3749], [0.0667]], [[0.5149], [0.2631]]], [[[0.7404], [0.7592]], [[0.0896], [0.7463]]]]])
in0Max26682 = tf.constant([[[0.4621, 0.9402], [0.5522, 0.9488]]])
in1Max26682 = tf.constant([[[0.9034, 0.1068], [0.8339, 0.1688]]])
in0Con95322 = tf.constant([[[[[0.2488], [0.9021]], [[0.2052], [0.444]]], [[[0.0982], [0.1213]], [[0.7289], [0.6275]]]]])
in0Min74049 = tf.constant([[[[[0.5053, 0.9563], [0.187, 0.5746]], [[0.7247, 0.8013], [0.2144, 0.1476]]], [[[0.2851, 0.3743], [0.0583, 0.6779]], [[0.7052, 0.9489], [0.8628, 0.0151]]]]])
in1Min74049 = tf.constant([[[[[0.9483, 0.4977], [0.4611, 0.1943]], [[0.6633, 0.8985], [0.9479, 0.4375]]], [[[0.752, 0.8749], [0.9479, 0.218]], [[0.2817, 0.307], [0.0723, 0.5483]]]]])
in0Up_28432 = tf.constant([[[[1.0891], [1.7886], [1.2643]]]])
in0Con43580 = tf.constant([[[0.0372, 0.8324, 0.3392, 0.806, 0.7563, 0.522], [0.6417, 0.9743, 0.5298, 0.6794, 0.7308, 0.2447]]])
print (np.array2string(model.predict([in0Add91287,in1Add91287,in0Con52731,in0Max26682,in1Max26682,in0Con95322,in0Min74049,in1Min74049,in0Up_28432,in0Con43580],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul62626.png')

LAdd91287 = add_layer([[[[[[0.9644], [0.6903]], [[0.3276], [0.2226]]], [[[0.6642], [0.618]], [[0.4629], [0.4459]]]]], [[[[[0.461], [0.194]], [[0.0245], [0.6828]]], [[[0.336], [0.8608]], [[0.9967], [0.7724]]]]]], Add91287), 
LCon52731 = concatenate_layer([Add91287,[[[[[0.3749], [0.0667]], [[0.5149], [0.2631]]], [[[0.7404], [0.7592]], [[0.0896], [0.7463]]]]]], 4, Con52731), 
LMax26682 = maximum_layer([[[[0.4621, 0.9402], [0.5522, 0.9488]]], [[[0.9034, 0.1068], [0.8339, 0.1688]]]], Max26682), 
LRes88434 = reshape_layer(Max26682, [2, 2, 1], Res88434), 
LRes39551 = reshape_layer(Res88434, [2, 2, 1, 1], Res39551), 
LZer49929 = zero_padding3D_layer(Res39551, 0, 0, 0, 0, 1, 0, Zer49929), 
LCon95322 = concatenate_layer([Zer49929,[[[[[0.2488], [0.9021]], [[0.2052], [0.444]]], [[[0.0982], [0.1213]], [[0.7289], [0.6275]]]]]], 4, Con95322), 
LMin74049 = minimum_layer([[[[[[0.5053, 0.9563], [0.187, 0.5746]], [[0.7247, 0.8013], [0.2144, 0.1476]]], [[[0.2851, 0.3743], [0.0583, 0.6779]], [[0.7052, 0.9489], [0.8628, 0.0151]]]]], [[[[[0.9483, 0.4977], [0.4611, 0.1943]], [[0.6633, 0.8985], [0.9479, 0.4375]]], [[[0.752, 0.8749], [0.9479, 0.218]], [[0.2817, 0.307], [0.0723, 0.5483]]]]]], Min74049), 
LAve36194 = average_layer([Con95322,Min74049], Ave36194), 
LMul33259 = multiply_layer([Con52731,Ave36194], Mul33259), 
LRes69651 = reshape_layer(Mul33259, [2, 2, 4], Res69651), 
LRes79298 = reshape_layer(Res69651, [2, 8], Res79298), 
LUp_28432 = up_sampling2D_layer([[[[1.0891], [1.7886], [1.2643]]]], 2, 2, Up_28432), 
LRes451 = reshape_layer(Up_28432, [2, 6], Res451), 
LCon99134 = conv1D_layer(Res451, 1,[[[0.2972, 0.1926], [0.4644, 0.2535], [0.4756, 0.589], [0.7565, 0.4625], [0.2894, 0.6304], [0.373, 0.3176]]],[0, 0], 1, true, 1, Con99134), 
LCon43580 = concatenate_layer([Con99134,[[[0.0372, 0.8324, 0.3392, 0.806, 0.7563, 0.522], [0.6417, 0.9743, 0.5298, 0.6794, 0.7308, 0.2447]]]], 2, Con43580), 
LMul62626 = multiply_layer([Res79298,Con43580], Mul62626), 
exec_layers([LAdd91287,LCon52731,LMax26682,LRes88434,LRes39551,LZer49929,LCon95322,LMin74049,LAve36194,LMul33259,LRes69651,LRes79298,LUp_28432,LRes451,LCon99134,LCon43580,LMul62626],["Add91287","Con52731","Max26682","Res88434","Res39551","Zer49929","Con95322","Min74049","Ave36194","Mul33259","Res69651","Res79298","Up_28432","Res451","Con99134","Con43580","Mul62626"],Mul62626,"Mul62626")

Actual (Unparsed): [[[1.3939321, 0.4988719, 0.0179349, 0.0304367, 0.0396097, 0.2088535, 0.3953085, 0.0406246], [0.5518737, 0.6236085, 0.4233248, 0.1254882, 0.1089187, 0.0315298, 0.4545598, 0.0586757]]]

Expected (Unparsed): [[[1.3939321527535113,0.49887187551475426,0.017934877392,0.030436656056,0.039609728928,0.20885348055000003,0.395308495746,0.04062463956],[0.5518736398544395,0.6236084498467951,0.42332479275600005,0.125488164204,0.10891875286800001,0.031529812608,0.45455983990199994,0.058675680693]]]

Actual:   [[[1.394, 0.4989, 0.018, 0.0305, 0.0397, 0.2089, 0.3954, 0.0407], [0.5519, 0.6237, 0.4234, 0.1255, 0.109, 0.0316, 0.4546, 0.0587]]]

Expected: [[[1.394, 0.4989, 0.018, 0.0305, 0.0397, 0.2089, 0.3954, 0.0407], [0.5519, 0.6237, 0.4234, 0.1255, 0.109, 0.0316, 0.4546, 0.0587]]]