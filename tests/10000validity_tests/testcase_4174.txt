import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max79222 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max79222 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dep14749 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con87727 = tf.keras.layers.Input(shape=([1, 2, 2]))

Max79222 = keras.layers.Maximum(name = 'Max79222', )([in0Max79222,in1Max79222])
Dep14749 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep14749', )(in0Dep14749)
Zer10091 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer10091', )(Dep14749)
Mul21524 = keras.layers.Multiply(name = 'Mul21524', )([Max79222,Zer10091])
Con87727 = keras.layers.Conv2DTranspose(2, (1, 1),strides=(1, 1), padding='valid', name = 'Con87727', )(in0Con87727)
Ave65377 = keras.layers.Average(name = 'Ave65377', )([Mul21524,Con87727])
model = tf.keras.models.Model(inputs=[in0Max79222,in1Max79222,in0Dep14749,in0Con87727], outputs=Ave65377)
w = model.get_layer('Dep14749').get_weights() 
w[0] = np.array([[[[0.3699], [0.9694]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep14749').set_weights(w) 
w = model.get_layer('Con87727').get_weights() 
w[0] = np.array([[[[0.6525, 0.8489], [0.538, 0.8394]]]])
w[1] = np.array([0, 0])
model.get_layer('Con87727').set_weights(w) 
in0Max79222 = tf.constant([[[[0.9521, 0.8494], [0.1482, 0.5272]]]])
in1Max79222 = tf.constant([[[[0.9123, 0.4449], [0.7465, 0.8425]]]])
in0Dep14749 = tf.constant([[[[0.3342, 0.8074]]]])
in0Con87727 = tf.constant([[[[0.8205, 0.8623], [0.0301, 0.5207]]]])
print (np.array2string(model.predict([in0Max79222,in1Max79222,in0Dep14749,in0Con87727],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave65377.png')

LMax79222 = maximum_layer([[[[[0.9521, 0.8494], [0.1482, 0.5272]]]], [[[[0.9123, 0.4449], [0.7465, 0.8425]]]]], Max79222), 
LDep14749 = depthwise_conv2D_layer([[[[0.3342, 0.8074]]]], 1, 1,[[[[0.3699], [0.9694]]]],[0, 0], 1, 1, false, Dep14749), 
LZer10091 = zero_padding2D_layer(Dep14749, 0, 0, 1, 0, Zer10091), 
LMul21524 = multiply_layer([Max79222,Zer10091], Mul21524), 
LCon87727 = conv2D_transpose_layer([[[[0.8205, 0.8623], [0.0301, 0.5207]]]], 1, 1,[[[[0.6525, 0.8489], [0.538, 0.8394]]]],[0, 0], 1, 1, false, Con87727), 
LAve65377 = average_layer([Mul21524,Con87727], Ave65377), 
exec_layers([LMax79222,LDep14749,LZer10091,LMul21524,LCon87727,LAve65377],["Max79222","Dep14749","Zer10091","Mul21524","Con87727","Ave65377"],Ave65377,"Ave65377")

Actual (Unparsed): [[[[0.6336914, 0.5826218], [0.2769726, 0.5563443]]]]

Expected (Unparsed): [[[[0.63369136,0.58262181],[0.276972621485,0.55634435215]]]]

Actual:   [[[[0.6337, 0.5827], [0.277, 0.5564]]]]

Expected: [[[[0.6337, 0.5827], [0.277, 0.5564]]]]