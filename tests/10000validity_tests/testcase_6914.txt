import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_8331 = tf.keras.layers.Input(shape=([2, 3, 2]))
in0Con35564 = tf.keras.layers.Input(shape=([2, 2, 2]))

Up_8331 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_8331', )(in0Up_8331)
Thr36563 = keras.layers.ThresholdedReLU(theta=0.8026435775087573, name = 'Thr36563', )(Up_8331)
Res83787 = keras.layers.Reshape((4, 12), name = 'Res83787', )(Thr36563)
Con35564 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 2), padding='same', name = 'Con35564', )(in0Con35564)
Cro61096 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro61096', )(Con35564)
Res83892 = keras.layers.Reshape((2, 12), name = 'Res83892', )(Cro61096)
Dot64096 = keras.layers.Dot(axes=(2, 2), name = 'Dot64096', )([Res83787,Res83892])
model = tf.keras.models.Model(inputs=[in0Up_8331,in0Con35564], outputs=Dot64096)
w = model.get_layer('Con35564').get_weights() 
w[0] = np.array([[[[0.3995, 0.8151], [0.1979, 0.9027], [0.4899, 0.6538]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con35564').set_weights(w) 
in0Up_8331 = tf.constant([[[[1.3181, 1.7816], [1.7125, 1.4549], [1.9265, 1.8736]], [[1.3278, 1.3495], [1.2302, 1.9255], [1.9906, 1.5188]]]])
in0Con35564 = tf.constant([[[[0.3046, 0.9943], [0.2781, 0.6893]], [[0.964, 0.8943], [0.4607, 0.3159]]]])
print (np.array2string(model.predict([in0Up_8331,in0Con35564],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot64096.png')

LUp_8331 = up_sampling2D_layer([[[[1.3181, 1.7816], [1.7125, 1.4549], [1.9265, 1.8736]], [[1.3278, 1.3495], [1.2302, 1.9255], [1.9906, 1.5188]]]], 2, 2, Up_8331), 
LThr36563 = thresholded_relu_layer(Up_8331, 0.8026435775087573, Thr36563), 
LRes83787 = reshape_layer(Thr36563, [4, 12], Res83787), 
LCon35564 = conv2D_transpose_layer([[[[0.3046, 0.9943], [0.2781, 0.6893]], [[0.964, 0.8943], [0.4607, 0.3159]]]], 1, 1,[[[[0.3995, 0.8151], [0.1979, 0.9027], [0.4899, 0.6538]]]],[0, 0, 0], 1, 2, true, Con35564), 
LCro61096 = cropping2D_layer(Con35564, 0, 0, 0, 0, Cro61096), 
LRes83892 = reshape_layer(Cro61096, [2, 12], Res83892), 
LDot64096 = dot_layer(Res83787,Res83892, 2, 2, Dot64096), 
exec_layers([LUp_8331,LThr36563,LRes83787,LCon35564,LCro61096,LRes83892,LDot64096],["Up_8331","Thr36563","Res83787","Con35564","Cro61096","Res83892","Dot64096"],Dot64096,"Dot64096")

Actual (Unparsed): [[[7.2571431, 6.7761268], [7.2571431, 6.7761268], [6.8918367, 6.3577789], [6.8918367, 6.3577789]]]

Expected (Unparsed): [[[7.257143067536001,6.776126930462],[7.257143067536001,6.776126930462],[6.891836594947,6.357778941269001],[6.891836594947,6.357778941269001]]]

Actual:   [[[7.2572, 6.7762], [7.2572, 6.7762], [6.8919, 6.3578], [6.8919, 6.3578]]]

Expected: [[[7.2572, 6.7762], [7.2572, 6.7762], [6.8919, 6.3578], [6.8919, 6.3578]]]