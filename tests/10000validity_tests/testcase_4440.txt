import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add44153 = tf.keras.layers.Input(shape=([1, 2]))
in1Add44153 = tf.keras.layers.Input(shape=([1, 2]))

Add44153 = keras.layers.Add(name = 'Add44153', )([in0Add44153,in1Add44153])
Max4114 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max4114', )(Add44153)
LST95453 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST95453', )(Max4114)
model = tf.keras.models.Model(inputs=[in0Add44153,in1Add44153], outputs=LST95453)
w = model.get_layer('LST95453').get_weights() 
w[0] = np.array([[10, 7, 10, 5, 9, 1, 4, 9, 7, 8, 10, 8], [1, 10, 2, 5, 2, 6, 4, 6, 3, 7, 2, 4]])
w[1] = np.array([[8, 3, 5, 4, 1, 6, 5, 5, 7, 2, 7, 7], [1, 2, 2, 6, 8, 4, 7, 8, 8, 2, 9, 6], [6, 5, 2, 3, 8, 7, 4, 7, 10, 5, 5, 2]])
w[2] = np.array([6, 9, 3, 10, 3, 1, 8, 7, 8, 9, 8, 9])
model.get_layer('LST95453').set_weights(w) 
in0Add44153 = tf.constant([[[0.5155, 0.664]]])
in1Add44153 = tf.constant([[[0.9288, 0.2953]]])
print (np.array2string(model.predict([in0Add44153,in1Add44153],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST95453.png')

LAdd44153 = add_layer([[[[0.5155, 0.664]]], [[[0.9288, 0.2953]]]], Add44153), 
LMax4114 = max_pool1D_layer(Add44153, 1, Max4114), 
LLST95453 = lstm_layer(Max4114,[[10, 7, 10, 5, 9, 1, 4, 9, 7, 8, 10, 8], [1, 10, 2, 5, 2, 6, 4, 6, 3, 7, 2, 4]],[[8, 3, 5, 4, 1, 6, 5, 5, 7, 2, 7, 7], [1, 2, 2, 6, 8, 4, 7, 8, 8, 2, 9, 6], [6, 5, 2, 3, 8, 7, 4, 7, 10, 5, 5, 2]],[6, 9, 3, 10, 3, 1, 8, 7, 8, 9, 8, 9], LST95453), 
exec_layers([LAdd44153,LMax4114,LLST95453],["Add44153","Max4114","LST95453"],LST95453,"LST95453")

Actual (Unparsed): [[0.7615942, 0.7615942, 0.7615942]]

Expected (Unparsed): [[0.7615941557416994,0.7615941559355941,0.7615941542973006]]

Actual:   [[0.7616, 0.7616, 0.7616]]

Expected: [[0.7616, 0.7616, 0.7616]]