import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max32916 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max32916 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Glo98364 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Con58509 = tf.keras.layers.Input(shape=([2, 3]))

Max32916 = keras.layers.Maximum(name = 'Max32916', )([in0Max32916,in1Max32916])
Res87881 = keras.layers.Reshape((2, 4), name = 'Res87881', )(Max32916)
Glo98364 = keras.layers.GlobalMaxPool3D(name = 'Glo98364', )(in0Glo98364)
Res34194 = keras.layers.Reshape((2, 1), name = 'Res34194', )(Glo98364)
Cro93163 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro93163', )(Res34194)
Zer6969 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer6969', )(Cro93163)
Con58509 = keras.layers.Concatenate(axis=2, name = 'Con58509', )([Zer6969,in0Con58509])
Sub42709 = keras.layers.Subtract(name = 'Sub42709', )([Res87881,Con58509])
Res52491 = keras.layers.Reshape((2, 4, 1), name = 'Res52491', )(Sub42709)
Res40713 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res40713', )(Res52491)
Glo21237 = keras.layers.GlobalMaxPool3D(name = 'Glo21237', )(Res40713)
model = tf.keras.models.Model(inputs=[in0Max32916,in1Max32916,in0Glo98364,in0Con58509], outputs=Glo21237)
in0Max32916 = tf.constant([[[[0.7365, 0.594], [0.0372, 0.6043]], [[0.3072, 0.1563], [0.4053, 0.4212]]]])
in1Max32916 = tf.constant([[[[0.1625, 0.2907], [0.7498, 0.7471]], [[0.3334, 0.5808], [0.9074, 0.72]]]])
in0Glo98364 = tf.constant([[[[[1.3637, 1.349]], [[1.6729, 1.9795]]], [[[1.1817, 1.2711]], [[1.7332, 1.9218]]]]])
in0Con58509 = tf.constant([[[0.7729, 0.296, 0.8042], [0.6178, 0.4756, 0.2712]]])
print (np.array2string(model.predict([in0Max32916,in1Max32916,in0Glo98364,in0Con58509],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo21237.png')

LMax32916 = maximum_layer([[[[[0.7365, 0.594], [0.0372, 0.6043]], [[0.3072, 0.1563], [0.4053, 0.4212]]]], [[[[0.1625, 0.2907], [0.7498, 0.7471]], [[0.3334, 0.5808], [0.9074, 0.72]]]]], Max32916), 
LRes87881 = reshape_layer(Max32916, [2, 4], Res87881), 
LGlo98364 = global_max_pool3D_layer([[[[[1.3637, 1.349]], [[1.6729, 1.9795]]], [[[1.1817, 1.2711]], [[1.7332, 1.9218]]]]], Glo98364), 
LRes34194 = reshape_layer(Glo98364, [2, 1], Res34194), 
LCro93163 = cropping1D_layer(Res34194, 1, 0, Cro93163), 
LZer6969 = zero_padding1D_layer(Cro93163, 1, 0, Zer6969), 
LCon58509 = concatenate_layer([Zer6969,[[[0.7729, 0.296, 0.8042], [0.6178, 0.4756, 0.2712]]]], 2, Con58509), 
LSub42709 = subtract_layer(Res87881,Con58509, Sub42709), 
LRes52491 = reshape_layer(Sub42709, [2, 4, 1], Res52491), 
LRes40713 = reshape_layer(Res52491, [2, 4, 1, 1], Res40713), 
LGlo21237 = global_max_pool3D_layer(Res40713, Glo21237), 
exec_layers([LMax32916,LRes87881,LGlo98364,LRes34194,LCro93163,LZer6969,LCon58509,LSub42709,LRes52491,LRes40713,LGlo21237],["Max32916","Res87881","Glo98364","Res34194","Cro93163","Zer6969","Con58509","Sub42709","Res52491","Res40713","Glo21237"],Glo21237,"Glo21237")

Actual (Unparsed): [[0.7365000]]

Expected (Unparsed): [[0.7365]]

Actual:   [[0.7365]]

Expected: [[0.7365]]