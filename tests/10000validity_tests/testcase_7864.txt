import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub88135 = tf.keras.layers.Input(shape=([2]))
in1Sub88135 = tf.keras.layers.Input(shape=([2]))

Sub88135 = keras.layers.Subtract(name = 'Sub88135', )([in0Sub88135,in1Sub88135])
Res12114 = keras.layers.Reshape((2, 1), name = 'Res12114', )(Sub88135)
Sep9288 = keras.layers.SeparableConv1D(3, (1),strides=(2), padding='valid', name = 'Sep9288', )(Res12114)
Den64849 = keras.layers.Dense(2,name = 'Den64849', )(Sep9288)
Glo1270 = keras.layers.GlobalAveragePooling1D(name = 'Glo1270', )(Den64849)
model = tf.keras.models.Model(inputs=[in0Sub88135,in1Sub88135], outputs=Glo1270)
w = model.get_layer('Sep9288').get_weights() 
w[0] = np.array([[[0.0093]]])
w[1] = np.array([[[0.1292, 0.298, 0.9505]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep9288').set_weights(w) 
w = model.get_layer('Den64849').get_weights() 
w[0] = np.array([[0.2462, 0.1779], [0.0001, 0.3949], [0.0354, 0.8853]])
w[1] = np.array([0.5916, 0.348])
model.get_layer('Den64849').set_weights(w) 
in0Sub88135 = tf.constant([[0.8487, 0.9145]])
in1Sub88135 = tf.constant([[0.1088, 0.583]])
print (np.array2string(model.predict([in0Sub88135,in1Sub88135],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo1270.png')

LSub88135 = subtract_layer([[0.8487, 0.9145]], [[0.1088, 0.583]], Sub88135), 
LRes12114 = reshape_layer(Sub88135, [2, 1], Res12114), 
LSep9288 = separable_conv1D_layer(Res12114, 1,[[[[0.0093]]],[[[0.1292, 0.298, 0.9505]]]],[0, 0, 0], 2, false, Sep9288), 
LDen64849 = dense_layer(Sep9288, [[0.2462, 0.1779], [0.0001, 0.3949], [0.0354, 0.8853]],[0.5916, 0.348], Den64849), 
LGlo1270 = global_average_pooling1D_layer(Den64849, Glo1270), 
exec_layers([LSub88135,LRes12114,LSep9288,LDen64849,LGlo1270],["Sub88135","Res12114","Sep9288","Den64849","Glo1270"],Glo1270,"Glo1270")

Actual (Unparsed): [[0.5920506, 0.3547582]]

Expected (Unparsed): [[0.5920506174657979,0.35475819149890714]]

Actual:   [[0.5921, 0.3548]]

Expected: [[0.5921, 0.3548]]