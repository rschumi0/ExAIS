import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max37468 = tf.keras.layers.Input(shape=([1, 2]))
in0Con36980 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max37468 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='valid', name = 'Max37468', )(in0Max37468)
Bat41703 = keras.layers.BatchNormalization(axis=1, epsilon=0.3674332988623583,  name = 'Bat41703', )(Max37468)
Con36980 = keras.layers.Conv2D(4, (2, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con36980', )(in0Con36980)
Res95759 = keras.layers.Reshape((1, 4), name = 'Res95759', )(Con36980)
Dot70845 = keras.layers.Dot(axes=(1, 1), name = 'Dot70845', )([Bat41703,Res95759])
model = tf.keras.models.Model(inputs=[in0Max37468,in0Con36980], outputs=Dot70845)
w = model.get_layer('Bat41703').get_weights() 
w[0] = np.array([0.4823])
w[1] = np.array([0.222])
w[2] = np.array([0.3105])
w[3] = np.array([0.0189])
model.get_layer('Bat41703').set_weights(w) 
w = model.get_layer('Con36980').get_weights() 
w[0] = np.array([[[[0.0866, 0.2464, 0.8649, 0.2489]]], [[[0.4645, 0.921, 0.6482, 0.1648]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con36980').set_weights(w) 
in0Max37468 = tf.constant([[[1.9723, 1.6569]]])
in0Con36980 = tf.constant([[[[0.3282]], [[0.4334]]]])
print (np.array2string(model.predict([in0Max37468,in0Con36980],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot70845.png')

LMax37468 = max_pool1D_layer([[[1.9723, 1.6569]]], 1, 1, false, Max37468), 
LBat41703 = batch_normalization_layer(Max37468, 1, 0.3674332988623583, [0.4823], [0.222], [0.3105], [0.0189], Bat41703), 
LCon36980 = conv2D_layer([[[[0.3282]], [[0.4334]]]], 2, 1,[[[[0.0866, 0.2464, 0.8649, 0.2489]]], [[[0.4645, 0.921, 0.6482, 0.1648]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con36980), 
LRes95759 = reshape_layer(Con36980, [1, 4], Res95759), 
LDot70845 = dot_layer(Bat41703,Res95759, 1, 1, Dot70845), 
exec_layers([LMax37468,LBat41703,LCon36980,LRes95759,LDot70845],["Max37468","Bat41703","Con36980","Res95759","Dot70845"],Dot70845,"Dot70845")

Actual (Unparsed): [[[0.3472422, 0.7255561, 0.8536695, 0.2314279], [0.2910175, 0.6080755, 0.7154450, 0.1939555]]]

Expected (Unparsed): [[[0.34724223243746605,0.7255560401258492,0.8536694412357013,0.23142784286386753],[0.29101745709381416,0.6080754414413211,0.7154449740840513,0.19395550436993095]]]

Actual:   [[[0.3473, 0.7256, 0.8537, 0.2315], [0.2911, 0.6081, 0.7155, 0.194]]]

Expected: [[[0.3473, 0.7256, 0.8537, 0.2315], [0.2911, 0.6081, 0.7155, 0.194]]]