import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub16837 = tf.keras.layers.Input(shape=([2, 3, 3]))
in1Sub16837 = tf.keras.layers.Input(shape=([2, 3, 3]))
in0Cro43186 = tf.keras.layers.Input(shape=([4, 1, 4, 1]))
in0Con51452 = tf.keras.layers.Input(shape=([9, 1, 1]))
in0Add49972 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add49972 = tf.keras.layers.Input(shape=([2, 1, 2]))

Sub16837 = keras.layers.Subtract(name = 'Sub16837', )([in0Sub16837,in1Sub16837])
ReL97202 = keras.layers.ReLU(max_value=0.4409403575761521, negative_slope=3.1416325961271085, threshold=5.170790824812536, name = 'ReL97202', )(Sub16837)
Res92336 = keras.layers.Reshape((2, 9), name = 'Res92336', )(ReL97202)
Cro43186 = keras.layers.Cropping3D(cropping=((2, 0), (0, 0), (2, 1)), name = 'Cro43186', )(in0Cro43186)
Res20860 = keras.layers.Reshape((2, 1, 1), name = 'Res20860', )(Cro43186)
Res17590 = keras.layers.Reshape((2, 1), name = 'Res17590', )(Res20860)
Dot93494 = keras.layers.Dot(axes=(1, 1), name = 'Dot93494', )([Res92336,Res17590])
Res77155 = keras.layers.Reshape((9, 1, 1), name = 'Res77155', )(Dot93494)
Con51452 = keras.layers.Concatenate(axis=3, name = 'Con51452', )([Res77155,in0Con51452])
Add49972 = keras.layers.Add(name = 'Add49972', )([in0Add49972,in1Add49972])
Zer35411 = keras.layers.ZeroPadding2D(padding=((7, 0), (0, 0)), name = 'Zer35411', )(Add49972)
Sub4605 = keras.layers.Subtract(name = 'Sub4605', )([Con51452,Zer35411])
Bat39969 = keras.layers.BatchNormalization(axis=2, epsilon=0.39851563934329315,  name = 'Bat39969', )(Sub4605)
model = tf.keras.models.Model(inputs=[in0Sub16837,in1Sub16837,in0Cro43186,in0Con51452,in0Add49972,in1Add49972], outputs=Bat39969)
w = model.get_layer('Bat39969').get_weights() 
w[0] = np.array([0.3873])
w[1] = np.array([0.0742])
w[2] = np.array([0.303])
w[3] = np.array([0.1081])
model.get_layer('Bat39969').set_weights(w) 
in0Sub16837 = tf.constant([[[[0.5039, 0.8447, 0.9402], [0.8194, 0.2936, 0.9101], [0.6144, 0.1026, 0.6711]], [[0.0362, 0.4064, 0.0238], [0.115, 0.2281, 0.13], [0.6161, 0.9868, 0.5205]]]])
in1Sub16837 = tf.constant([[[[0.8633, 0.8663, 0.2253], [0.5171, 0.2379, 0.0454], [0.5898, 0.2256, 0.8817]], [[0.9978, 0.8937, 0.7725], [0.6182, 0.092, 0.4415], [0.5797, 0.8099, 0.1701]]]])
in0Cro43186 = tf.constant([[[[[1.9259], [1.1033], [1.7958], [1.4987]]], [[[1.3745], [1.2956], [1.7202], [1.4207]]], [[[1.3424], [1.5366], [1.1704], [1.133]]], [[[1.4419], [1.8984], [1.955], [1.7765]]]]])
in0Con51452 = tf.constant([[[[0.4287]], [[0.8693]], [[0.6225]], [[0.0523]], [[0.2088]], [[0.6082]], [[0.156]], [[0.5721]], [[0.1688]]]])
in0Add49972 = tf.constant([[[[0.4703, 0.256]], [[0.0386, 0.8119]]]])
in1Add49972 = tf.constant([[[[0.8534, 0.9407]], [[0.1181, 0.4802]]]])
print (np.array2string(model.predict([in0Sub16837,in1Sub16837,in0Cro43186,in0Con51452,in0Add49972,in1Add49972],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat39969.png')

LSub16837 = subtract_layer([[[[0.5039, 0.8447, 0.9402], [0.8194, 0.2936, 0.9101], [0.6144, 0.1026, 0.6711]], [[0.0362, 0.4064, 0.0238], [0.115, 0.2281, 0.13], [0.6161, 0.9868, 0.5205]]]], [[[[0.8633, 0.8663, 0.2253], [0.5171, 0.2379, 0.0454], [0.5898, 0.2256, 0.8817]], [[0.9978, 0.8937, 0.7725], [0.6182, 0.092, 0.4415], [0.5797, 0.8099, 0.1701]]]], Sub16837), 
LReL97202 = relu_layer(Sub16837, 0.4409403575761521, 3.1416325961271085, 5.170790824812536, ReL97202), 
LRes92336 = reshape_layer(ReL97202, [2, 9], Res92336), 
LCro43186 = cropping3D_layer([[[[[1.9259], [1.1033], [1.7958], [1.4987]]], [[[1.3745], [1.2956], [1.7202], [1.4207]]], [[[1.3424], [1.5366], [1.1704], [1.133]]], [[[1.4419], [1.8984], [1.955], [1.7765]]]]], 2, 0, 0, 0, 2, 1, Cro43186), 
LRes20860 = reshape_layer(Cro43186, [2, 1, 1], Res20860), 
LRes17590 = reshape_layer(Res20860, [2, 1], Res17590), 
LDot93494 = dot_layer(Res92336,Res17590, 1, 1, Dot93494), 
LRes77155 = reshape_layer(Dot93494, [9, 1, 1], Res77155), 
LCon51452 = concatenate_layer([Res77155,[[[[0.4287]], [[0.8693]], [[0.6225]], [[0.0523]], [[0.2088]], [[0.6082]], [[0.156]], [[0.5721]], [[0.1688]]]]], 3, Con51452), 
LAdd49972 = add_layer([[[[[0.4703, 0.256]], [[0.0386, 0.8119]]]], [[[[0.8534, 0.9407]], [[0.1181, 0.4802]]]]], Add49972), 
LZer35411 = zero_padding2D_layer(Add49972, 7, 0, 0, 0, Zer35411), 
LSub4605 = subtract_layer(Con51452,Zer35411, Sub4605), 
LBat39969 = batch_normalization_layer(Sub4605, 2, 0.39851563934329315, [0.3873], [0.0742], [0.303], [0.1081], Bat39969), 
exec_layers([LSub16837,LReL97202,LRes92336,LCro43186,LRes20860,LRes17590,LDot93494,LRes77155,LCon51452,LAdd49972,LZer35411,LSub4605,LBat39969],["Sub16837","ReL97202","Res92336","Cro43186","Res20860","Res17590","Dot93494","Res77155","Con51452","Add49972","Zer35411","Sub4605","Bat39969"],Bat39969,"Bat39969")

Actual (Unparsed): [[[[-31.6499677, 0.1425980]], [[-29.3889815, 0.3823447]], [[-28.7890185, 0.2480517]], [[-28.7940692, -0.0622151]], [[-27.1509001, 0.0229423]], [[-27.0281671, 0.2402706]], [[-27.5463244, -0.0057881]], [[-28.0923574, -0.4305414]], [[-27.0527752, -0.7019025]]]]

Expected (Unparsed): [[[[-31.649966984409918,0.14259801190480378]],[[-29.388980849087012,0.3823447425751024]],[[-28.78901789636536,0.24805174863631507]],[[-28.794068618414766,-0.06221512795970009]],[[-27.15089950081159,0.022942301341030133]],[[-27.028166479776235,0.2402705905596349]],[[-27.546323954827844,-0.005788128480558097]],[[-28.092356934301396,-0.43054141482017466]],[[-27.05277466794668,-0.7019025010327893]]]]

Actual:   [[[[-31.6499, 0.1426]], [[-29.3889, 0.3824]], [[-28.789, 0.2481]], [[-28.794, -0.0622]], [[-27.1509, 0.023]], [[-27.0281, 0.2403]], [[-27.5463, -0.0057]], [[-28.0923, -0.4305]], [[-27.0527, -0.7019]]]]

Expected: [[[[-31.6499, 0.1426]], [[-29.3889, 0.3824]], [[-28.789, 0.2481]], [[-28.794, -0.0622]], [[-27.1508, 0.023]], [[-27.0281, 0.2403]], [[-27.5463, -0.0057]], [[-28.0923, -0.4305]], [[-27.0527, -0.7019]]]]