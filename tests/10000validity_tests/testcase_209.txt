import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla81348 = tf.keras.layers.Input(shape=([4, 1]))

Fla81348 = keras.layers.Flatten(name = 'Fla81348', )(in0Fla81348)
Sof1793 = keras.layers.Softmax(axis=1, name = 'Sof1793', )(Fla81348)
Res15811 = keras.layers.Reshape((4, 1), name = 'Res15811', )(Sof1793)
Res26207 = keras.layers.Reshape((4, 1, 1), name = 'Res26207', )(Res15811)
Res95073 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res95073', )(Res26207)
Cro43133 = keras.layers.Cropping3D(cropping=((3, 0), (0, 0), (0, 0)), name = 'Cro43133', )(Res95073)
Glo99593 = keras.layers.GlobalMaxPool3D(name = 'Glo99593', )(Cro43133)
Res35214 = keras.layers.Reshape((1, 1), name = 'Res35214', )(Glo99593)
Con26638 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con26638', )(Res35214)
model = tf.keras.models.Model(inputs=[in0Fla81348], outputs=Con26638)
w = model.get_layer('Con26638').get_weights() 
w[0] = np.array([[[0.5497, 0.8192]]])
w[1] = np.array([0, 0])
model.get_layer('Con26638').set_weights(w) 
in0Fla81348 = tf.constant([[[1.0544], [1.9302], [1.3866], [1.1794]]])
print (np.array2string(model.predict([in0Fla81348],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con26638.png')

LFla81348 = flatten_layer([[[1.0544], [1.9302], [1.3866], [1.1794]]], Fla81348), 
LSof1793 = softmax_layer(Fla81348, 1, Sof1793), 
LRes15811 = reshape_layer(Sof1793, [4, 1], Res15811), 
LRes26207 = reshape_layer(Res15811, [4, 1, 1], Res26207), 
LRes95073 = reshape_layer(Res26207, [4, 1, 1, 1], Res95073), 
LCro43133 = cropping3D_layer(Res95073, 3, 0, 0, 0, 0, 0, Cro43133), 
LGlo99593 = global_max_pool3D_layer(Cro43133, Glo99593), 
LRes35214 = reshape_layer(Glo99593, [1, 1], Res35214), 
LCon26638 = conv1D_layer(Res35214, 1,[[[0.5497, 0.8192]]],[0, 0], 1, true, 1, Con26638), 
exec_layers([LFla81348,LSof1793,LRes15811,LRes26207,LRes95073,LCro43133,LGlo99593,LRes35214,LCon26638],["Fla81348","Sof1793","Res15811","Res26207","Res95073","Cro43133","Glo99593","Res35214","Con26638"],Con26638,"Con26638")

Actual (Unparsed): [[[0.1050766, 0.1565923]]]

Expected (Unparsed): [[[0.10507663733646146,0.1565922890777319]]]

Actual:   [[[0.1051, 0.1566]]]

Expected: [[[0.1051, 0.1566]]]