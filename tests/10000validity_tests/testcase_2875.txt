import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max67781 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max67781 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con31686 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Mul71680 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Mul71680 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Max67781 = keras.layers.Maximum(name = 'Max67781', )([in0Max67781,in1Max67781])
Res81326 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res81326', )(Max67781)
Con31686 = keras.layers.Concatenate(axis=4, name = 'Con31686', )([Res81326,in0Con31686])
Mul71680 = keras.layers.Multiply(name = 'Mul71680', )([in0Mul71680,in1Mul71680])
Zer8821 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer8821', )(Mul71680)
Min47686 = keras.layers.Minimum(name = 'Min47686', )([Con31686,Zer8821])
model = tf.keras.models.Model(inputs=[in0Max67781,in1Max67781,in0Con31686,in0Mul71680,in1Mul71680], outputs=Min47686)
in0Max67781 = tf.constant([[[[0.1376], [0.0109]], [[0.6007], [0.6501]]]])
in1Max67781 = tf.constant([[[[0.4378], [0.9682]], [[0.8331], [0.0946]]]])
in0Con31686 = tf.constant([[[[[0.0639]], [[0.6042]]], [[[0.5125]], [[0.0341]]]]])
in0Mul71680 = tf.constant([[[[[0.4088, 0.2769]], [[0.8882, 0.5658]]]]])
in1Mul71680 = tf.constant([[[[[0.4147, 0.9969]], [[0.874, 0.7602]]]]])
print (np.array2string(model.predict([in0Max67781,in1Max67781,in0Con31686,in0Mul71680,in1Mul71680],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min47686.png')

LMax67781 = maximum_layer([[[[[0.1376], [0.0109]], [[0.6007], [0.6501]]]], [[[[0.4378], [0.9682]], [[0.8331], [0.0946]]]]], Max67781), 
LRes81326 = reshape_layer(Max67781, [2, 2, 1, 1], Res81326), 
LCon31686 = concatenate_layer([Res81326,[[[[[0.0639]], [[0.6042]]], [[[0.5125]], [[0.0341]]]]]], 4, Con31686), 
LMul71680 = multiply_layer([[[[[[0.4088, 0.2769]], [[0.8882, 0.5658]]]]], [[[[[0.4147, 0.9969]], [[0.874, 0.7602]]]]]], Mul71680), 
LZer8821 = zero_padding3D_layer(Mul71680, 1, 0, 0, 0, 0, 0, Zer8821), 
LMin47686 = minimum_layer([Con31686,Zer8821], Min47686), 
exec_layers([LMax67781,LRes81326,LCon31686,LMul71680,LZer8821,LMin47686],["Max67781","Res81326","Con31686","Mul71680","Zer8821","Min47686"],Min47686,"Min47686")

Actual (Unparsed): [[[[[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]]], [[[0.1695294, 0.2760416]], [[0.6501000, 0.0341000]]]]]

Expected (Unparsed): [[[[[0,0]],[[0,0]]],[[[0.16952936000000002,0.27604161]],[[0.6501,0.0341]]]]]

Actual:   [[[[[0, 0]], [[0, 0]]], [[[0.1696, 0.2761]], [[0.6501, 0.0341]]]]]

Expected: [[[[[0, 0]], [[0, 0]]], [[[0.1696, 0.2761]], [[0.6501, 0.0341]]]]]