import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add13865 = tf.keras.layers.Input(shape=([1, 1]))
in1Add13865 = tf.keras.layers.Input(shape=([1, 1]))
in0Cro67371 = tf.keras.layers.Input(shape=([3, 1]))

Add13865 = keras.layers.Add(name = 'Add13865', )([in0Add13865,in1Add13865])
Res63119 = keras.layers.Reshape((1, 1, 1), name = 'Res63119', )(Add13865)
Glo32980 = keras.layers.GlobalAveragePooling2D(name = 'Glo32980', )(Res63119)
Res59962 = keras.layers.Reshape((1, 1), name = 'Res59962', )(Glo32980)
Cro67371 = keras.layers.Cropping1D(cropping=((2, 0)), name = 'Cro67371', )(in0Cro67371)
Add31580 = keras.layers.Add(name = 'Add31580', )([Res59962,Cro67371])
LST1829 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST1829', )(Add31580)
model = tf.keras.models.Model(inputs=[in0Add13865,in1Add13865,in0Cro67371], outputs=LST1829)
w = model.get_layer('LST1829').get_weights() 
w[0] = np.array([[5, 1, 10, 4, 7, 8, 9, 5]])
w[1] = np.array([[2, 7, 2, 5, 7, 9, 5, 4], [2, 6, 3, 5, 5, 8, 7, 4]])
w[2] = np.array([1, 7, 9, 9, 5, 10, 1, 6])
model.get_layer('LST1829').set_weights(w) 
in0Add13865 = tf.constant([[[0.3495]]])
in1Add13865 = tf.constant([[[0.659]]])
in0Cro67371 = tf.constant([[[1.4479], [1.521], [1.7913]]])
print (np.array2string(model.predict([in0Add13865,in1Add13865,in0Cro67371],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST1829.png')

LAdd13865 = add_layer([[[[0.3495]]], [[[0.659]]]], Add13865), 
LRes63119 = reshape_layer(Add13865, [1, 1, 1], Res63119), 
LGlo32980 = global_average_pooling2D_layer(Res63119, Glo32980), 
LRes59962 = reshape_layer(Glo32980, [1, 1], Res59962), 
LCro67371 = cropping1D_layer([[[1.4479], [1.521], [1.7913]]], 2, 0, Cro67371), 
LAdd31580 = add_layer([Res59962,Cro67371], Add31580), 
LLST1829 = lstm_layer(Add31580,[[5, 1, 10, 4, 7, 8, 9, 5]],[[2, 7, 2, 5, 7, 9, 5, 4], [2, 6, 3, 5, 5, 8, 7, 4]],[1, 7, 9, 9, 5, 10, 1, 6], LST1829), 
exec_layers([LAdd13865,LRes63119,LGlo32980,LRes59962,LCro67371,LAdd31580,LLST1829],["Add13865","Res63119","Glo32980","Res59962","Cro67371","Add31580","LST1829"],LST1829,"LST1829")

Actual (Unparsed): [[0.7615940, 0.7615709]]

Expected (Unparsed): [[0.7615940273529218,0.7615708617854144]]

Actual:   [[0.7616, 0.7616]]

Expected: [[0.7616, 0.7616]]