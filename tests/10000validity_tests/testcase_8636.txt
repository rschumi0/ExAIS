import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ELU86310 = tf.keras.layers.Input(shape=([2, 1]))
in0Max23655 = tf.keras.layers.Input(shape=([1, 2]))
in1Max23655 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul78587 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Mul78587 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

ELU86310 = keras.layers.ELU(alpha=-9.524949545559732, name = 'ELU86310', input_shape=(2, 1))(in0ELU86310)
Res38523 = keras.layers.Reshape((2, 1, 1), name = 'Res38523', )(ELU86310)
Glo66030 = keras.layers.GlobalAveragePooling2D(name = 'Glo66030', )(Res38523)
Res2978 = keras.layers.Reshape((1, 1), name = 'Res2978', )(Glo66030)
Res99774 = keras.layers.Reshape((1, 1, 1), name = 'Res99774', )(Res2978)
Loc3643 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 8), name = 'Loc3643', )(Res99774)
Res9460 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res9460', )(Loc3643)
Zer43511 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer43511', )(Res9460)
Max23655 = keras.layers.Maximum(name = 'Max23655', )([in0Max23655,in1Max23655])
Res70677 = keras.layers.Reshape((1, 2, 1), name = 'Res70677', )(Max23655)
Res52509 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res52509', )(Res70677)
Zer30078 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer30078', )(Res52509)
Mul78587 = keras.layers.Multiply(name = 'Mul78587', )([in0Mul78587,in1Mul78587])
Ave32666 = keras.layers.Average(name = 'Ave32666', )([Zer30078,Mul78587])
Max14517 = keras.layers.Maximum(name = 'Max14517', )([Zer43511,Ave32666])
Res65038 = keras.layers.Reshape((1, 2, 2), name = 'Res65038', )(Max14517)
Res88746 = keras.layers.Reshape((1, 4), name = 'Res88746', )(Res65038)
Sim52513 = keras.layers.SimpleRNN(2,name = 'Sim52513', )(Res88746)
model = tf.keras.models.Model(inputs=[in0ELU86310,in0Max23655,in1Max23655,in0Mul78587,in1Mul78587], outputs=Sim52513)
w = model.get_layer('Loc3643').get_weights() 
w[0] = np.array([[[0.6403, 0.0424]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc3643').set_weights(w) 
w = model.get_layer('Sim52513').get_weights() 
w[0] = np.array([[5, 10], [7, 1], [3, 7], [6, 1]])
w[1] = np.array([[1, 3], [6, 1]])
w[2] = np.array([4, 3])
model.get_layer('Sim52513').set_weights(w) 
in0ELU86310 = tf.constant([[[0.0259], [0.2353]]])
in0Max23655 = tf.constant([[[0.806, 0.1913]]])
in1Max23655 = tf.constant([[[0.3472, 0.0307]]])
in0Mul78587 = tf.constant([[[[[0.7652], [0.0074]], [[0.6303], [0.1733]]]]])
in1Mul78587 = tf.constant([[[[[0.2872], [0.4639]], [[0.332], [0.9876]]]]])
print (np.array2string(model.predict([in0ELU86310,in0Max23655,in1Max23655,in0Mul78587,in1Mul78587],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim52513.png')

LELU86310 = elu_layer([[[0.0259], [0.2353]]], -9.524949545559732, ELU86310), 
LRes38523 = reshape_layer(ELU86310, [2, 1, 1], Res38523), 
LGlo66030 = global_average_pooling2D_layer(Res38523, Glo66030), 
LRes2978 = reshape_layer(Glo66030, [1, 1], Res2978), 
LRes99774 = reshape_layer(Res2978, [1, 1, 1], Res99774), 
LLoc3643 = locally_connected2D_layer(Res99774, 1, 1,[[[0.6403, 0.0424]]],[[[0, 0]]], 1, 8, Loc3643), 
LRes9460 = reshape_layer(Loc3643, [1, 1, 2, 1], Res9460), 
LZer43511 = zero_padding3D_layer(Res9460, 0, 0, 1, 0, 0, 0, Zer43511), 
LMax23655 = maximum_layer([[[[0.806, 0.1913]]], [[[0.3472, 0.0307]]]], Max23655), 
LRes70677 = reshape_layer(Max23655, [1, 2, 1], Res70677), 
LRes52509 = reshape_layer(Res70677, [1, 2, 1, 1], Res52509), 
LZer30078 = zero_padding3D_layer(Res52509, 0, 0, 0, 0, 1, 0, Zer30078), 
LMul78587 = multiply_layer([[[[[[0.7652], [0.0074]], [[0.6303], [0.1733]]]]], [[[[[0.2872], [0.4639]], [[0.332], [0.9876]]]]]], Mul78587), 
LAve32666 = average_layer([Zer30078,Mul78587], Ave32666), 
LMax14517 = maximum_layer([Zer43511,Ave32666], Max14517), 
LRes65038 = reshape_layer(Max14517, [1, 2, 2], Res65038), 
LRes88746 = reshape_layer(Res65038, [1, 4], Res88746), 
LSim52513 = simple_rnn_layer(Res88746,[[5, 10], [7, 1], [3, 7], [6, 1]],[[1, 3], [6, 1]],[4, 3], Sim52513), 
exec_layers([LELU86310,LRes38523,LGlo66030,LRes2978,LRes99774,LLoc3643,LRes9460,LZer43511,LMax23655,LRes70677,LRes52509,LZer30078,LMul78587,LAve32666,LMax14517,LRes65038,LRes88746,LSim52513],["ELU86310","Res38523","Glo66030","Res2978","Res99774","Loc3643","Res9460","Zer43511","Max23655","Res70677","Res52509","Zer30078","Mul78587","Ave32666","Max14517","Res65038","Res88746","Sim52513"],Sim52513,"Sim52513")

Actual (Unparsed): [[1.0000000, 0.9999606]]

Expected (Unparsed): [[0.9999999530505969,0.9999605796378694]]

Actual:   [[1, 1]]

Expected: [[1, 1]]