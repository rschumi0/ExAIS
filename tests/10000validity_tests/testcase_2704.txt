import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr4705 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Thr4705 = keras.layers.ThresholdedReLU(theta=4.67988451354483, name = 'Thr4705', input_shape=(1, 2, 1, 1))(in0Thr4705)
Glo10083 = keras.layers.GlobalAveragePooling3D(name = 'Glo10083', )(Thr4705)
Res74707 = keras.layers.Reshape((1, 1), name = 'Res74707', )(Glo10083)
LST2631 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST2631', )(Res74707)
Res458 = keras.layers.Reshape((3, 1), name = 'Res458', )(LST2631)
PRe97073 = keras.layers.PReLU(name = 'PRe97073', )(Res458)
model = tf.keras.models.Model(inputs=[in0Thr4705], outputs=PRe97073)
w = model.get_layer('LST2631').get_weights() 
w[0] = np.array([[6, 4, 9, 10, 9, 10, 6, 8, 5, 2, 5, 8]])
w[1] = np.array([[10, 6, 4, 1, 4, 3, 3, 10, 10, 7, 10, 10], [8, 4, 3, 9, 10, 3, 1, 3, 3, 4, 6, 2], [9, 7, 8, 8, 4, 6, 5, 4, 8, 4, 9, 1]])
w[2] = np.array([6, 9, 8, 7, 5, 2, 6, 6, 1, 10, 6, 1])
model.get_layer('LST2631').set_weights(w) 
w = model.get_layer('PRe97073').get_weights() 
w[0] = np.array([[0.6664], [0.642], [0.0773]])
model.get_layer('PRe97073').set_weights(w) 
in0Thr4705 = tf.constant([[[[[0.9707]], [[0.8225]]]]])
print (np.array2string(model.predict([in0Thr4705],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe97073.png')

LThr4705 = thresholded_relu_layer([[[[[0.9707]], [[0.8225]]]]], 4.67988451354483, Thr4705), 
LGlo10083 = global_average_pooling3D_layer(Thr4705, Glo10083), 
LRes74707 = reshape_layer(Glo10083, [1, 1], Res74707), 
LLST2631 = lstm_layer(Res74707,[[6, 4, 9, 10, 9, 10, 6, 8, 5, 2, 5, 8]],[[10, 6, 4, 1, 4, 3, 3, 10, 10, 7, 10, 10], [8, 4, 3, 9, 10, 3, 1, 3, 3, 4, 6, 2], [9, 7, 8, 8, 4, 6, 5, 4, 8, 4, 9, 1]],[6, 9, 8, 7, 5, 2, 6, 6, 1, 10, 6, 1], LST2631), 
LRes458 = reshape_layer(LST2631, [3, 1], Res458), 
LPRe97073 = prelu_layer(Res458, [[0.6664], [0.642], [0.0773]], PRe97073), 
exec_layers([LThr4705,LGlo10083,LRes74707,LLST2631,LRes458,LPRe97073],["Thr4705","Glo10083","Res74707","LST2631","Res458","PRe97073"],PRe97073,"PRe97073")

Actual (Unparsed): [[[0.7605141], [0.7596542], [0.4692408]]]

Expected (Unparsed): [[[0.760514065812315],[0.759654172922239],[0.469240796568727]]]

Actual:   [[[0.7606], [0.7597], [0.4693]]]

Expected: [[[0.7606], [0.7597], [0.4693]]]