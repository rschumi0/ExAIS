import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL67341 = tf.keras.layers.Input(shape=([1, 2]))
in0Dot34943 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot34943 = tf.keras.layers.Input(shape=([3, 2]))

ReL67341 = keras.layers.ReLU(max_value=0.9175281428407575, negative_slope=0.7601147817484106, threshold=1.7836174293485263, name = 'ReL67341', input_shape=(1, 2))(in0ReL67341)
Res14573 = keras.layers.Reshape((1, 2, 1), name = 'Res14573', )(ReL67341)
Zer50669 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer50669', )(Res14573)
Dot34943 = keras.layers.Dot(axes=(2, 2), name = 'Dot34943', )([in0Dot34943,in1Dot34943])
Res91639 = keras.layers.Reshape((3, 3, 1), name = 'Res91639', )(Dot34943)
Dep50241 = keras.layers.DepthwiseConv2D((1, 1),strides=(2, 2), padding='same', name = 'Dep50241', )(Res91639)
Lea85798 = keras.layers.LeakyReLU(alpha=0.9100334294995626, name = 'Lea85798', )(Dep50241)
Ave25621 = keras.layers.Average(name = 'Ave25621', )([Zer50669,Lea85798])
model = tf.keras.models.Model(inputs=[in0ReL67341,in0Dot34943,in1Dot34943], outputs=Ave25621)
w = model.get_layer('Dep50241').get_weights() 
w[0] = np.array([[[[0.8403]]]])
w[1] = np.array([0])
model.get_layer('Dep50241').set_weights(w) 
in0ReL67341 = tf.constant([[[0.4454, 0.2642]]])
in0Dot34943 = tf.constant([[[0.0594, 0.578], [0.33, 0.7762], [0.1544, 0.426]]])
in1Dot34943 = tf.constant([[[0.5127, 0.7263], [0.1598, 0.8585], [0.5463, 0.2106]]])
print (np.array2string(model.predict([in0ReL67341,in0Dot34943,in1Dot34943],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave25621.png')

LReL67341 = relu_layer([[[0.4454, 0.2642]]], 0.9175281428407575, 0.7601147817484106, 1.7836174293485263, ReL67341), 
LRes14573 = reshape_layer(ReL67341, [1, 2, 1], Res14573), 
LZer50669 = zero_padding2D_layer(Res14573, 1, 0, 0, 0, Zer50669), 
LDot34943 = dot_layer([[[0.0594, 0.578], [0.33, 0.7762], [0.1544, 0.426]]], [[[0.5127, 0.7263], [0.1598, 0.8585], [0.5463, 0.2106]]], 2, 2, Dot34943), 
LRes91639 = reshape_layer(Dot34943, [3, 3, 1], Res91639), 
LDep50241 = depthwise_conv2D_layer(Res91639, 1, 1,[[[[0.8403]]]],[0], 2, 2, true, Dep50241), 
LLea85798 = leaky_relu_layer(Dep50241, 0.9100334294995626, Lea85798), 
LAve25621 = average_layer([Zer50669,Lea85798], Ave25621), 
exec_layers([LReL67341,LRes14573,LZer50669,LDot34943,LRes91639,LDep50241,LLea85798,LAve25621],["ReL67341","Res14573","Zer50669","Dot34943","Res91639","Dep50241","Lea85798","Ave25621"],Ave25621,"Ave25621")

Actual (Unparsed): [[[[0.1891750], [0.0647775]], [[-0.3453440], [-0.5043327]]]]

Expected (Unparsed): [[[[0.18917496596699998],[0.064777474953]],[[-0.34534397431858715],[-0.5043326997989932]]]]

Actual:   [[[[0.1892], [0.0648]], [[-0.3453], [-0.5043]]]]

Expected: [[[[0.1892], [0.0648]], [[-0.3453], [-0.5043]]]]