import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub40895 = tf.keras.layers.Input(shape=([3, 2, 2, 2]))
in1Sub40895 = tf.keras.layers.Input(shape=([3, 2, 2, 2]))

Sub40895 = keras.layers.Subtract(name = 'Sub40895', )([in0Sub40895,in1Sub40895])
Res32842 = keras.layers.Reshape((3, 2, 4), name = 'Res32842', )(Sub40895)
Res75742 = keras.layers.Reshape((3, 8), name = 'Res75742', )(Res32842)
Res2833 = keras.layers.Reshape((3, 8, 1), name = 'Res2833', )(Res75742)
Max71394 = keras.layers.MaxPool2D(pool_size=(1, 2), name = 'Max71394', )(Res2833)
model = tf.keras.models.Model(inputs=[in0Sub40895,in1Sub40895], outputs=Max71394)
in0Sub40895 = tf.constant([[[[[0.5215, 0.6363], [0.5712, 0.9885]], [[0.8684, 0.556], [0.1093, 0.933]]], [[[0.3847, 0.1488], [0.2351, 0.7559]], [[0.9359, 0.0962], [0.3465, 0.2391]]], [[[0.1883, 0.0951], [0.113, 0.8562]], [[0.3297, 0.5205], [0.133, 0.038]]]]])
in1Sub40895 = tf.constant([[[[[0.1489, 0.915], [0.02, 0.6876]], [[0.1107, 0.8904], [0.4265, 0.2976]]], [[[0.6275, 0.6953], [0.8431, 0.0796]], [[0.0715, 0.3973], [0.6204, 0.1017]]], [[[0.1999, 0.3554], [0.5547, 0.5482]], [[0.571, 0.4181], [0.5485, 0.8651]]]]])
print (np.array2string(model.predict([in0Sub40895,in1Sub40895],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max71394.png')

LSub40895 = subtract_layer([[[[[0.5215, 0.6363], [0.5712, 0.9885]], [[0.8684, 0.556], [0.1093, 0.933]]], [[[0.3847, 0.1488], [0.2351, 0.7559]], [[0.9359, 0.0962], [0.3465, 0.2391]]], [[[0.1883, 0.0951], [0.113, 0.8562]], [[0.3297, 0.5205], [0.133, 0.038]]]]], [[[[[0.1489, 0.915], [0.02, 0.6876]], [[0.1107, 0.8904], [0.4265, 0.2976]]], [[[0.6275, 0.6953], [0.8431, 0.0796]], [[0.0715, 0.3973], [0.6204, 0.1017]]], [[[0.1999, 0.3554], [0.5547, 0.5482]], [[0.571, 0.4181], [0.5485, 0.8651]]]]], Sub40895), 
LRes32842 = reshape_layer(Sub40895, [3, 2, 4], Res32842), 
LRes75742 = reshape_layer(Res32842, [3, 8], Res75742), 
LRes2833 = reshape_layer(Res75742, [3, 8, 1], Res2833), 
LMax71394 = max_pool2D_layer(Res2833, 1, 2, Max71394), 
exec_layers([LSub40895,LRes32842,LRes75742,LRes2833,LMax71394],["Sub40895","Res32842","Res75742","Res2833","Max71394"],Max71394,"Max71394")

Actual (Unparsed): [[[[0.3726000], [0.5512000], [0.7577000], [0.6354000]], [[-0.2428000], [0.6763000], [0.8644000], [0.1374000]], [[-0.0116000], [0.3080000], [0.1024000], [-0.4155000]]]]

Expected (Unparsed): [[[[0.37259999999999993],[0.5512],[0.7576999999999999],[0.6354000000000001]],[[-0.24279999999999996],[0.6763],[0.8644],[0.13740000000000002]],[[-0.0116],[0.30799999999999994],[0.10239999999999994],[-0.4155]]]]

Actual:   [[[[0.3726], [0.5512], [0.7577], [0.6354]], [[-0.2428], [0.6763], [0.8644], [0.1374]], [[-0.0116], [0.308], [0.1024], [-0.4155]]]]

Expected: [[[[0.3726], [0.5512], [0.7577], [0.6355]], [[-0.2427], [0.6763], [0.8644], [0.1375]], [[-0.0116], [0.308], [0.1024], [-0.4155]]]]