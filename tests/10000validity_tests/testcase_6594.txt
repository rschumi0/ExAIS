import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min65979 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min65979 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Min65979 = keras.layers.Minimum(name = 'Min65979', )([in0Min65979,in1Min65979])
Res26804 = keras.layers.Reshape((2, 1, 2), name = 'Res26804', )(Min65979)
Sep42399 = keras.layers.SeparableConv2D(2, (2, 1),strides=(2, 2), padding='same', name = 'Sep42399', )(Res26804)
model = tf.keras.models.Model(inputs=[in0Min65979,in1Min65979], outputs=Sep42399)
w = model.get_layer('Sep42399').get_weights() 
w[0] = np.array([[[[0.0945], [0.5104]]], [[[0.5463], [0.846]]]])
w[1] = np.array([[[[0.2615, 0.6209], [0.8816, 0.234]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep42399').set_weights(w) 
in0Min65979 = tf.constant([[[[[0.5826], [0.5062]]], [[[0.0393], [0.3268]]]]])
in1Min65979 = tf.constant([[[[[0.2968], [0.8916]]], [[[0.2885], [0.5263]]]]])
print (np.array2string(model.predict([in0Min65979,in1Min65979],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep42399.png')

LMin65979 = minimum_layer([[[[[[0.5826], [0.5062]]], [[[0.0393], [0.3268]]]]], [[[[[0.2968], [0.8916]]], [[[0.2885], [0.5263]]]]]], Min65979), 
LRes26804 = reshape_layer(Min65979, [2, 1, 2], Res26804), 
LSep42399 = separable_conv2D_layer(Res26804, 2, 1,[[[[[0.0945], [0.5104]]], [[[0.5463], [0.846]]]],[[[[0.2615, 0.6209], [0.8816, 0.234]]]]],[0, 0], 2, 2, true, Sep42399), 
exec_layers([LMin65979,LRes26804,LSep42399],["Min65979","Res26804","Sep42399"],Sep42399,"Sep42399")

Actual (Unparsed): [[[[0.4844613, 0.1558971]]]]

Expected (Unparsed): [[[[0.48446129123299997,0.15589714679099997]]]]

Actual:   [[[[0.4845, 0.1559]]]]

Expected: [[[[0.4845, 0.1559]]]]