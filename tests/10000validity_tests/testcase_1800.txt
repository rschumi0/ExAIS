import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con59480 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con60133 = tf.keras.layers.Input(shape=([2, 4]))
in0Mul45941 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Mul45941 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Add29598 = tf.keras.layers.Input(shape=([1, 1]))
in1Add29598 = tf.keras.layers.Input(shape=([1, 1]))
in0Con99272 = tf.keras.layers.Input(shape=([1, 7]))

Con59480 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 1), padding='valid', name = 'Con59480', )(in0Con59480)
Con33586 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con33586', )(Con59480)
Res78908 = keras.layers.Reshape((2, 4), name = 'Res78908', )(Con33586)
Con60133 = keras.layers.Concatenate(axis=2, name = 'Con60133', )([Res78908,in0Con60133])
Mul45941 = keras.layers.Multiply(name = 'Mul45941', )([in0Mul45941,in1Mul45941])
Res96981 = keras.layers.Reshape((1, 2, 4), name = 'Res96981', )(Mul45941)
Res36698 = keras.layers.Reshape((1, 8), name = 'Res36698', )(Res96981)
Add29598 = keras.layers.Add(name = 'Add29598', )([in0Add29598,in1Add29598])
Thr81777 = keras.layers.ThresholdedReLU(theta=1.175306929226216, name = 'Thr81777', )(Add29598)
Con99272 = keras.layers.Concatenate(axis=2, name = 'Con99272', )([Thr81777,in0Con99272])
Mul24987 = keras.layers.Multiply(name = 'Mul24987', )([Res36698,Con99272])
Zer22834 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer22834', )(Mul24987)
Max67568 = keras.layers.Maximum(name = 'Max67568', )([Con60133,Zer22834])
model = tf.keras.models.Model(inputs=[in0Con59480,in0Con60133,in0Mul45941,in1Mul45941,in0Add29598,in1Add29598,in0Con99272], outputs=Max67568)
w = model.get_layer('Con59480').get_weights() 
w[0] = np.array([[[[0.6542], [0.0843], [0.3376]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con59480').set_weights(w) 
w = model.get_layer('Con33586').get_weights() 
w[0] = np.array([[[[0.5596, 0.7549, 0.5637, 0.7614], [0.8722, 0.8778, 0.3423, 0.7634], [0.8213, 0.5054, 0.666, 0.217]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con33586').set_weights(w) 
in0Con59480 = tf.constant([[[[0.7414]], [[0.199]]]])
in0Con60133 = tf.constant([[[0.7262, 0.9482, 0.5474, 0.0343], [0.808, 0.3754, 0.2254, 0.45]]])
in0Mul45941 = tf.constant([[[[[0.8996, 0.6583], [0.8336, 0.7886]], [[0.9371, 0.1573], [0.3484, 0.4965]]]]])
in1Mul45941 = tf.constant([[[[[0.9172, 0.5603], [0.5113, 0.4941]], [[0.601, 0.6018], [0.0316, 0.3861]]]]])
in0Add29598 = tf.constant([[[0.6418]]])
in1Add29598 = tf.constant([[[0.418]]])
in0Con99272 = tf.constant([[[0.6312, 0.7764, 0.1666, 0.343, 0.0842, 0.8831, 0.5441]]])
print (np.array2string(model.predict([in0Con59480,in0Con60133,in0Mul45941,in1Mul45941,in0Add29598,in1Add29598,in0Con99272],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max67568.png')

LCon59480 = conv2D_transpose_layer([[[[0.7414]], [[0.199]]]], 1, 1,[[[[0.6542], [0.0843], [0.3376]]]],[0, 0, 0], 1, 1, false, Con59480), 
LCon33586 = conv2D_layer(Con59480, 1, 1,[[[[0.5596, 0.7549, 0.5637, 0.7614], [0.8722, 0.8778, 0.3423, 0.7634], [0.8213, 0.5054, 0.666, 0.217]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con33586), 
LRes78908 = reshape_layer(Con33586, [2, 4], Res78908), 
LCon60133 = concatenate_layer([Res78908,[[[0.7262, 0.9482, 0.5474, 0.0343], [0.808, 0.3754, 0.2254, 0.45]]]], 2, Con60133), 
LMul45941 = multiply_layer([[[[[[0.8996, 0.6583], [0.8336, 0.7886]], [[0.9371, 0.1573], [0.3484, 0.4965]]]]], [[[[[0.9172, 0.5603], [0.5113, 0.4941]], [[0.601, 0.6018], [0.0316, 0.3861]]]]]], Mul45941), 
LRes96981 = reshape_layer(Mul45941, [1, 2, 4], Res96981), 
LRes36698 = reshape_layer(Res96981, [1, 8], Res36698), 
LAdd29598 = add_layer([[[[0.6418]]], [[[0.418]]]], Add29598), 
LThr81777 = thresholded_relu_layer(Add29598, 1.175306929226216, Thr81777), 
LCon99272 = concatenate_layer([Thr81777,[[[0.6312, 0.7764, 0.1666, 0.343, 0.0842, 0.8831, 0.5441]]]], 2, Con99272), 
LMul24987 = multiply_layer([Res36698,Con99272], Mul24987), 
LZer22834 = zero_padding1D_layer(Mul24987, 1, 0, Zer22834), 
LMax67568 = maximum_layer([Con60133,Zer22834], Max67568), 
exec_layers([LCon59480,LCon33586,LRes78908,LCon60133,LMul45941,LRes96981,LRes36698,LAdd29598,LThr81777,LCon99272,LMul24987,LZer22834,LMax67568],["Con59480","Con33586","Res78908","Con60133","Mul45941","Res96981","Res36698","Add29598","Thr81777","Con99272","Mul24987","Zer22834","Max67568"],Max67568,"Max67568")

Actual (Unparsed): [[[0.5315005, 0.5475070, 0.4614993, 0.4713241, 0.7262000, 0.9482000, 0.5474000, 0.0343000], [0.1426606, 0.2328153, 0.3309170, 0.1265086, 0.8080000, 0.3754000, 0.2254000, 0.4500000]]]

Expected (Unparsed): [[[0.531500511124,0.547506966424,0.46149928024199993,0.47132406837999996,0.7262,0.9482,0.5474,0.0343],[0.14266064434000003,0.232815273288,0.33091695955199996,0.12650861830000001,0.808,0.3754,0.2254,0.45]]]

Actual:   [[[0.5316, 0.5476, 0.4615, 0.4714, 0.7262, 0.9482, 0.5474, 0.0343], [0.1427, 0.2329, 0.331, 0.1266, 0.808, 0.3754, 0.2254, 0.45]]]

Expected: [[[0.5316, 0.5476, 0.4615, 0.4714, 0.7262, 0.9482, 0.5474, 0.0343], [0.1427, 0.2329, 0.331, 0.1266, 0.808, 0.3754, 0.2254, 0.45]]]