import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave44880 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave44880 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Max71435 = tf.keras.layers.Input(shape=([2, 1]))
in1Max71435 = tf.keras.layers.Input(shape=([2, 1]))
in0Con86633 = tf.keras.layers.Input(shape=([2, 1]))
in0Up_89492 = tf.keras.layers.Input(shape=([1, 1]))
in0Con99354 = tf.keras.layers.Input(shape=([1]))
in0Loc87105 = tf.keras.layers.Input(shape=([1, 1]))
in0Con64421 = tf.keras.layers.Input(shape=([3]))

Ave44880 = keras.layers.Average(name = 'Ave44880', )([in0Ave44880,in1Ave44880])
Lay6377 = keras.layers.LayerNormalization(axis=1, epsilon=2.99050060645935, name = 'Lay6377', )(Ave44880)
Res13515 = keras.layers.Reshape((1, 2, 1), name = 'Res13515', )(Lay6377)
Res52234 = keras.layers.Reshape((1, 2), name = 'Res52234', )(Res13515)
Zer56989 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer56989', )(Res52234)
Max71435 = keras.layers.Maximum(name = 'Max71435', )([in0Max71435,in1Max71435])
Con86633 = keras.layers.Concatenate(axis=2, name = 'Con86633', )([Max71435,in0Con86633])
Sub41731 = keras.layers.Subtract(name = 'Sub41731', )([Zer56989,Con86633])
Fla39884 = keras.layers.Flatten(name = 'Fla39884', )(Sub41731)
Up_89492 = keras.layers.UpSampling1D(size=(2), name = 'Up_89492', )(in0Up_89492)
Fla70870 = keras.layers.Flatten(name = 'Fla70870', )(Up_89492)
Con99354 = keras.layers.Concatenate(axis=1, name = 'Con99354', )([Fla70870,in0Con99354])
Loc87105 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc87105', )(in0Loc87105)
Fla33976 = keras.layers.Flatten(name = 'Fla33976', )(Loc87105)
Dot2993 = keras.layers.Dot(axes=(1, 1), name = 'Dot2993', )([Con99354,Fla33976])
Con64421 = keras.layers.Concatenate(axis=1, name = 'Con64421', )([Dot2993,in0Con64421])
Mul32305 = keras.layers.Multiply(name = 'Mul32305', )([Fla39884,Con64421])
model = tf.keras.models.Model(inputs=[in0Ave44880,in1Ave44880,in0Max71435,in1Max71435,in0Con86633,in0Up_89492,in0Con99354,in0Loc87105,in0Con64421], outputs=Mul32305)
w = model.get_layer('Loc87105').get_weights() 
w[0] = np.array([[[0.5644, 0.3242, 0.6571]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc87105').set_weights(w) 
in0Ave44880 = tf.constant([[[[[0.5249]], [[0.2542]]]]])
in1Ave44880 = tf.constant([[[[[0.2473]], [[0.628]]]]])
in0Max71435 = tf.constant([[[0.3023], [0.4104]]])
in1Max71435 = tf.constant([[[0.7267], [0.491]]])
in0Con86633 = tf.constant([[[0.4913], [0.6499]]])
in0Up_89492 = tf.constant([[[1.4915]]])
in0Con99354 = tf.constant([[0.3535]])
in0Loc87105 = tf.constant([[[0.4278]]])
in0Con64421 = tf.constant([[0.9142, 0.9118, 0.9164]])
print (np.array2string(model.predict([in0Ave44880,in1Ave44880,in0Max71435,in1Max71435,in0Con86633,in0Up_89492,in0Con99354,in0Loc87105,in0Con64421],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul32305.png')

LAve44880 = average_layer([[[[[[0.5249]], [[0.2542]]]]], [[[[[0.2473]], [[0.628]]]]]], Ave44880), 
LLay6377 = layer_normalization_layer(Ave44880, 1, 2.99050060645935, Lay6377), 
LRes13515 = reshape_layer(Lay6377, [1, 2, 1], Res13515), 
LRes52234 = reshape_layer(Res13515, [1, 2], Res52234), 
LZer56989 = zero_padding1D_layer(Res52234, 1, 0, Zer56989), 
LMax71435 = maximum_layer([[[[0.3023], [0.4104]]], [[[0.7267], [0.491]]]], Max71435), 
LCon86633 = concatenate_layer([Max71435,[[[0.4913], [0.6499]]]], 2, Con86633), 
LSub41731 = subtract_layer(Zer56989,Con86633, Sub41731), 
LFla39884 = flatten_layer(Sub41731, Fla39884), 
LUp_89492 = up_sampling1D_layer([[[1.4915]]], 2, Up_89492), 
LFla70870 = flatten_layer(Up_89492, Fla70870), 
LCon99354 = concatenate_layer([Fla70870,[[0.3535]]], 1, Con99354), 
LLoc87105 = locally_connected1D_layer([[[0.4278]]], 1,[[[0.5644, 0.3242, 0.6571]]],[[0, 0, 0]], 1, Loc87105), 
LFla33976 = flatten_layer(Loc87105, Fla33976), 
LDot2993 = dot_layer(Con99354,Fla33976, 1, 1, Dot2993), 
LCon64421 = concatenate_layer([Dot2993,[[0.9142, 0.9118, 0.9164]]], 1, Con64421), 
LMul32305 = multiply_layer([Fla39884,Con64421], Mul32305), 
exec_layers([LAve44880,LLay6377,LRes13515,LRes52234,LZer56989,LMax71435,LCon86633,LSub41731,LFla39884,LUp_89492,LFla70870,LCon99354,LLoc87105,LFla33976,LDot2993,LCon64421,LMul32305],["Ave44880","Lay6377","Res13515","Res52234","Zer56989","Max71435","Con86633","Sub41731","Fla39884","Up_89492","Fla70870","Con99354","Loc87105","Fla33976","Dot2993","Con64421","Mul32305"],Mul32305,"Mul32305")

Actual (Unparsed): [[-0.4842401, -0.4491465, -0.4476938, -0.5955684]]

Expected (Unparsed): [[-0.484240078687755,-0.44914646,-0.44769380000000003,-0.59556836]]

Actual:   [[-0.4842, -0.4491, -0.4476, -0.5955]]

Expected: [[-0.4842, -0.4491, -0.4476, -0.5955]]