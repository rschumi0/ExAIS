import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot12073 = tf.keras.layers.Input(shape=([3]))
in1Dot12073 = tf.keras.layers.Input(shape=([3]))
in0Con36337 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Mul35289 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul35289 = tf.keras.layers.Input(shape=([1, 2, 2]))

Dot12073 = keras.layers.Dot(axes=(1, 1), name = 'Dot12073', )([in0Dot12073,in1Dot12073])
Res69313 = keras.layers.Reshape((1, 1), name = 'Res69313', )(Dot12073)
Glo15473 = keras.layers.GlobalMaxPool1D(name = 'Glo15473', )(Res69313)
Res84910 = keras.layers.Reshape((1, 1), name = 'Res84910', )(Glo15473)
Res95577 = keras.layers.Reshape((1, 1, 1), name = 'Res95577', )(Res84910)
Zer53777 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer53777', )(Res95577)
Con36337 = keras.layers.Concatenate(axis=3, name = 'Con36337', )([Zer53777,in0Con36337])
Mul35289 = keras.layers.Multiply(name = 'Mul35289', )([in0Mul35289,in1Mul35289])
Ave49920 = keras.layers.Average(name = 'Ave49920', )([Con36337,Mul35289])
model = tf.keras.models.Model(inputs=[in0Dot12073,in1Dot12073,in0Con36337,in0Mul35289,in1Mul35289], outputs=Ave49920)
in0Dot12073 = tf.constant([[0.2823, 0.3216, 0.0221]])
in1Dot12073 = tf.constant([[0.2274, 0.6556, 0.2956]])
in0Con36337 = tf.constant([[[[0.187], [0.0454]]]])
in0Mul35289 = tf.constant([[[[0.4199, 0.8433], [0.1625, 0.2419]]]])
in1Mul35289 = tf.constant([[[[0.7541, 0.1093], [0.2106, 0.1532]]]])
print (np.array2string(model.predict([in0Dot12073,in1Dot12073,in0Con36337,in0Mul35289,in1Mul35289],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave49920.png')

LDot12073 = dot_layer([[0.2823, 0.3216, 0.0221]], [[0.2274, 0.6556, 0.2956]], 1, 1, Dot12073), 
LRes69313 = reshape_layer(Dot12073, [1, 1], Res69313), 
LGlo15473 = global_max_pool1D_layer(Res69313, Glo15473), 
LRes84910 = reshape_layer(Glo15473, [1, 1], Res84910), 
LRes95577 = reshape_layer(Res84910, [1, 1, 1], Res95577), 
LZer53777 = zero_padding2D_layer(Res95577, 0, 0, 1, 0, Zer53777), 
LCon36337 = concatenate_layer([Zer53777,[[[[0.187], [0.0454]]]]], 3, Con36337), 
LMul35289 = multiply_layer([[[[[0.4199, 0.8433], [0.1625, 0.2419]]]], [[[[0.7541, 0.1093], [0.2106, 0.1532]]]]], Mul35289), 
LAve49920 = average_layer([Con36337,Mul35289], Ave49920), 
exec_layers([LDot12073,LRes69313,LGlo15473,LRes84910,LRes95577,LZer53777,LCon36337,LMul35289,LAve49920],["Dot12073","Res69313","Glo15473","Res84910","Res95577","Zer53777","Con36337","Mul35289","Ave49920"],Ave49920,"Ave49920")

Actual (Unparsed): [[[[0.1583233, 0.1395863], [0.1578956, 0.0412295]]]]

Expected (Unparsed): [[[[0.158323295,0.139586345],[0.15789562,0.04122954]]]]

Actual:   [[[[0.1584, 0.1396], [0.1579, 0.0413]]]]

Expected: [[[[0.1584, 0.1396], [0.1579, 0.0413]]]]