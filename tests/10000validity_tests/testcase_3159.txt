import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max63300 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Max63300 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Max63300 = keras.layers.Maximum(name = 'Max63300', )([in0Max63300,in1Max63300])
Res29581 = keras.layers.Reshape((2, 2, 4), name = 'Res29581', )(Max63300)
Res30001 = keras.layers.Reshape((2, 8), name = 'Res30001', )(Res29581)
Con4649 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con4649', )(Res30001)
Lay47588 = keras.layers.LayerNormalization(axis=1, epsilon=1.7757649959143804, name = 'Lay47588', )(Con4649)
Res97461 = keras.layers.Reshape((2, 2, 1), name = 'Res97461', )(Lay47588)
Con95337 = keras.layers.Conv2DTranspose(2, (1, 2),strides=(1, 1), padding='same', name = 'Con95337', )(Res97461)
model = tf.keras.models.Model(inputs=[in0Max63300,in1Max63300], outputs=Con95337)
w = model.get_layer('Con4649').get_weights() 
w[0] = np.array([[[0.2591, 0.967], [0.9407, 0.4533], [0.1801, 0.6177], [0.8814, 0.226], [0.828, 0.2334], [0.2073, 0.2047], [0.64, 0.3214], [0.1457, 0.4592]]])
w[1] = np.array([0, 0])
model.get_layer('Con4649').set_weights(w) 
w = model.get_layer('Con95337').get_weights() 
w[0] = np.array([[[[0.7799], [0.0468]], [[0.6782], [0.6199]]]])
w[1] = np.array([0, 0])
model.get_layer('Con95337').set_weights(w) 
in0Max63300 = tf.constant([[[[[0.0292, 0.3788], [0.9294, 0.2006]], [[0.4794, 0.0855], [0.2678, 0.6385]]], [[[0.5888, 0.6028], [0.4791, 0.1052]], [[0.0963, 0.5944], [0.3014, 0.3977]]]]])
in1Max63300 = tf.constant([[[[[0.8028, 0.1414], [0.209, 0.1988]], [[0.3056, 0.9054], [0.7533, 0.1348]]], [[[0.83, 0.4321], [0.4139, 0.7734]], [[0.9052, 0.0411], [0.4734, 0.9064]]]]])
print (np.array2string(model.predict([in0Max63300,in1Max63300],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con95337.png')

LMax63300 = maximum_layer([[[[[[0.0292, 0.3788], [0.9294, 0.2006]], [[0.4794, 0.0855], [0.2678, 0.6385]]], [[[0.5888, 0.6028], [0.4791, 0.1052]], [[0.0963, 0.5944], [0.3014, 0.3977]]]]], [[[[[0.8028, 0.1414], [0.209, 0.1988]], [[0.3056, 0.9054], [0.7533, 0.1348]]], [[[0.83, 0.4321], [0.4139, 0.7734]], [[0.9052, 0.0411], [0.4734, 0.9064]]]]]], Max63300), 
LRes29581 = reshape_layer(Max63300, [2, 2, 4], Res29581), 
LRes30001 = reshape_layer(Res29581, [2, 8], Res30001), 
LCon4649 = conv1D_layer(Res30001, 1,[[[0.2591, 0.967], [0.9407, 0.4533], [0.1801, 0.6177], [0.8814, 0.226], [0.828, 0.2334], [0.2073, 0.2047], [0.64, 0.3214], [0.1457, 0.4592]]],[0, 0], 1, false, 1, Con4649), 
LLay47588 = layer_normalization_layer(Con4649, 1, 1.7757649959143804, Lay47588), 
LRes97461 = reshape_layer(Lay47588, [2, 2, 1], Res97461), 
LCon95337 = conv2D_transpose_layer(Res97461, 1, 2,[[[[0.7799], [0.0468]], [[0.6782], [0.6199]]]],[0, 0], 1, 1, true, Con95337), 
exec_layers([LMax63300,LRes29581,LRes30001,LCon4649,LLay47588,LRes97461,LCon95337],["Max63300","Res29581","Res30001","Con4649","Lay47588","Res97461","Con95337"],Con95337,"Con95337")

Actual (Unparsed): [[[[-0.2215203, -0.0132929], [-0.2066554, -0.1769158]], [[0.2215203, 0.0132929], [0.2066554, 0.1769158]]]]

Expected (Unparsed): [[[[-0.22152032669613395,-0.013292923822770955],[-0.20665540748434033,-0.17691583876470995]],[[0.22152032669613395,0.013292923822770955],[0.20665540748434058,0.17691583876470995]]]]

Actual:   [[[[-0.2215, -0.0132], [-0.2066, -0.1769]], [[0.2216, 0.0133], [0.2067, 0.177]]]]

Expected: [[[[-0.2215, -0.0132], [-0.2066, -0.1769]], [[0.2216, 0.0133], [0.2067, 0.177]]]]