import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo48176 = tf.keras.layers.Input(shape=([2, 1, 1]))

Glo48176 = keras.layers.GlobalAveragePooling2D(name = 'Glo48176', )(in0Glo48176)
Res30178 = keras.layers.Reshape((1, 1), name = 'Res30178', )(Glo48176)
Res27427 = keras.layers.Reshape((1, 1, 1), name = 'Res27427', )(Res30178)
Res15922 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res15922', )(Res27427)
Con56270 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con56270', )(Res15922)
Fla71643 = keras.layers.Flatten(name = 'Fla71643', )(Con56270)
Res15296 = keras.layers.Reshape((3, 1), name = 'Res15296', )(Fla71643)
GRU13239 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU13239', )(Res15296)
model = tf.keras.models.Model(inputs=[in0Glo48176], outputs=GRU13239)
w = model.get_layer('Con56270').get_weights() 
w[0] = np.array([[[[[0.8476, 0.3586, 0.9256]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con56270').set_weights(w) 
w = model.get_layer('GRU13239').get_weights() 
w[0] = np.array([[8, 9, 6, 4, 4, 1, 2, 1, 7]])
w[1] = np.array([[5, 8, 5, 6, 9, 2, 7, 5, 1], [1, 1, 9, 1, 6, 6, 10, 8, 5], [3, 10, 8, 10, 6, 3, 1, 10, 6]])
w[2] = np.array([6, 10, 9, 1, 2, 6, 10, 7, 10])
model.get_layer('GRU13239').set_weights(w) 
in0Glo48176 = tf.constant([[[[1.0115]], [[1.5496]]]])
print (np.array2string(model.predict([in0Glo48176],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU13239.png')

LGlo48176 = global_average_pooling2D_layer([[[[1.0115]], [[1.5496]]]], Glo48176), 
LRes30178 = reshape_layer(Glo48176, [1, 1], Res30178), 
LRes27427 = reshape_layer(Res30178, [1, 1, 1], Res27427), 
LRes15922 = reshape_layer(Res27427, [1, 1, 1, 1], Res15922), 
LCon56270 = conv3D_layer(Res15922, 1, 1, 1,[[[[[0.8476, 0.3586, 0.9256]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con56270), 
LFla71643 = flatten_layer(Con56270, Fla71643), 
LRes15296 = reshape_layer(Fla71643, [3, 1], Res15296), 
LGRU13239 = gru_layer(Res15296,[[8, 9, 6, 4, 4, 1, 2, 1, 7]],[[5, 8, 5, 6, 9, 2, 7, 5, 1], [1, 1, 9, 1, 6, 6, 10, 8, 5], [3, 10, 8, 10, 6, 3, 1, 10, 6]],[6, 10, 9, 1, 2, 6, 10, 7, 10], false, GRU13239), 
exec_layers([LGlo48176,LRes30178,LRes27427,LRes15922,LCon56270,LFla71643,LRes15296,LGRU13239],["Glo48176","Res30178","Res27427","Res15922","Con56270","Fla71643","Res15296","GRU13239"],GRU13239,"GRU13239")

Actual (Unparsed): [[0.0000635, 0.0000007, 0.0000081]]

Expected (Unparsed): [[6.352487164288791e-5,7.31735579223321e-7,8.131933940476622e-6]]

Actual:   [[0.0001, 0, 0]]

Expected: [[0.0001, 0, 0]]