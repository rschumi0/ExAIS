import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max78841 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max78841 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con38036 = tf.keras.layers.Input(shape=([2, 2, 3, 1]))
in0Sof14904 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Max78841 = keras.layers.Maximum(name = 'Max78841', )([in0Max78841,in1Max78841])
Res12525 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res12525', )(Max78841)
Zer15777 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer15777', )(Res12525)
Con38036 = keras.layers.Concatenate(axis=4, name = 'Con38036', )([Zer15777,in0Con38036])
Sof14904 = keras.layers.Softmax(axis=1, name = 'Sof14904', input_shape=(2, 2, 1, 2))(in0Sof14904)
Zer81584 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer81584', )(Sof14904)
Add23970 = keras.layers.Add(name = 'Add23970', )([Con38036,Zer81584])
model = tf.keras.models.Model(inputs=[in0Max78841,in1Max78841,in0Con38036,in0Sof14904], outputs=Add23970)
in0Max78841 = tf.constant([[[[0.6237, 0.8573]]]])
in1Max78841 = tf.constant([[[[0.994, 0.9536]]]])
in0Con38036 = tf.constant([[[[[0.6006], [0.1107], [0.5123]], [[0.8939], [0.0999], [0.7444]]], [[[0.2982], [0.1435], [0.447]], [[0.3072], [0.482], [0.6424]]]]])
in0Sof14904 = tf.constant([[[[[0.6909, 0.5748]], [[0.8685, 0.7198]]], [[[0.996, 0.0549]], [[0.0949, 0.2765]]]]])
print (np.array2string(model.predict([in0Max78841,in1Max78841,in0Con38036,in0Sof14904],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add23970.png')

LMax78841 = maximum_layer([[[[[0.6237, 0.8573]]]], [[[[0.994, 0.9536]]]]], Max78841), 
LRes12525 = reshape_layer(Max78841, [1, 1, 2, 1], Res12525), 
LZer15777 = zero_padding3D_layer(Res12525, 1, 0, 1, 0, 1, 0, Zer15777), 
LCon38036 = concatenate_layer([Zer15777,[[[[[0.6006], [0.1107], [0.5123]], [[0.8939], [0.0999], [0.7444]]], [[[0.2982], [0.1435], [0.447]], [[0.3072], [0.482], [0.6424]]]]]], 4, Con38036), 
LSof14904 = softmax_layer([[[[[0.6909, 0.5748]], [[0.8685, 0.7198]]], [[[0.996, 0.0549]], [[0.0949, 0.2765]]]]], 1, Sof14904), 
LZer81584 = zero_padding3D_layer(Sof14904, 0, 0, 0, 0, 2, 0, Zer81584), 
LAdd23970 = add_layer([Con38036,Zer81584], Add23970), 
exec_layers([LMax78841,LRes12525,LZer15777,LCon38036,LSof14904,LZer81584,LAdd23970],["Max78841","Res12525","Zer15777","Con38036","Sof14904","Zer81584","Add23970"],Add23970,"Add23970")

Actual (Unparsed): [[[[[0.0000000, 0.6006000], [0.0000000, 0.1107000], [0.4243112, 1.1394244]], [[0.0000000, 0.8939000], [0.0000000, 0.0999000], [0.6842991, 1.3534451]]], [[[0.0000000, 0.2982000], [0.0000000, 0.1435000], [0.5756888, 0.8198756]], [[0.0000000, 0.3072000], [0.9940000, 0.4820000], [1.2693009, 1.0333550]]]]]

Expected (Unparsed): [[[[[0,0.6006],[0,0.1107],[0.42431122165170043,1.139424382671345]],[[0,0.8939],[0,0.0999],[0.6842991310273521,1.3534450731572196]]],[[[0,0.2982],[0,0.1435],[0.5756887783482996,0.8198756173286549]],[[0,0.3072],[0.994,0.482],[1.269300868972648,1.0333549268427804]]]]]

Actual:   [[[[[0, 0.6006], [0, 0.1107], [0.4244, 1.1395]], [[0, 0.8939], [0, 0.0999], [0.6843, 1.3535]]], [[[0, 0.2982], [0, 0.1435], [0.5757, 0.8199]], [[0, 0.3072], [0.994, 0.482], [1.2694, 1.0334]]]]]

Expected: [[[[[0, 0.6006], [0, 0.1107], [0.4244, 1.1395]], [[0, 0.8939], [0, 0.0999], [0.6843, 1.3535]]], [[[0, 0.2982], [0, 0.1435], [0.5757, 0.8199]], [[0, 0.3072], [0.994, 0.482], [1.2694, 1.0334]]]]]