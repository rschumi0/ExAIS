import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min12876 = tf.keras.layers.Input(shape=([1, 1]))
in1Min12876 = tf.keras.layers.Input(shape=([1, 1]))

Min12876 = keras.layers.Minimum(name = 'Min12876', )([in0Min12876,in1Min12876])
PRe88721 = keras.layers.PReLU(name = 'PRe88721', )(Min12876)
Sof21511 = keras.layers.Softmax(axis=1, name = 'Sof21511', )(PRe88721)
Res21543 = keras.layers.Reshape((1, 1, 1), name = 'Res21543', )(Sof21511)
Up_90214 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_90214', )(Res21543)
model = tf.keras.models.Model(inputs=[in0Min12876,in1Min12876], outputs=Up_90214)
w = model.get_layer('PRe88721').get_weights() 
w[0] = np.array([[0.778]])
model.get_layer('PRe88721').set_weights(w) 
in0Min12876 = tf.constant([[[0.1864]]])
in1Min12876 = tf.constant([[[0.5559]]])
print (np.array2string(model.predict([in0Min12876,in1Min12876],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_90214.png')

LMin12876 = minimum_layer([[[[0.1864]]], [[[0.5559]]]], Min12876), 
LPRe88721 = prelu_layer(Min12876, [[0.778]], PRe88721), 
LSof21511 = softmax_layer(PRe88721, 1, Sof21511), 
LRes21543 = reshape_layer(Sof21511, [1, 1, 1], Res21543), 
LUp_90214 = up_sampling2D_layer(Res21543, 2, 2, Up_90214), 
exec_layers([LMin12876,LPRe88721,LSof21511,LRes21543,LUp_90214],["Min12876","PRe88721","Sof21511","Res21543","Up_90214"],Up_90214,"Up_90214")

Actual (Unparsed): [[[[1.0000000], [1.0000000]], [[1.0000000], [1.0000000]]]]

Expected (Unparsed): [[[[1.0],[1.0]],[[1.0],[1.0]]]]

Actual:   [[[[1], [1]], [[1], [1]]]]

Expected: [[[[1], [1]], [[1], [1]]]]