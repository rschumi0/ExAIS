import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul50283 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul50283 = tf.keras.layers.Input(shape=([2, 1]))

Mul50283 = keras.layers.Multiply(name = 'Mul50283', )([in0Mul50283,in1Mul50283])
Ave83104 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='valid', name = 'Ave83104', )(Mul50283)
Res40744 = keras.layers.Reshape((2, 1, 1), name = 'Res40744', )(Ave83104)
Up_78233 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_78233', )(Res40744)
Res75958 = keras.layers.Reshape((2, 2), name = 'Res75958', )(Up_78233)
LST97349 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST97349', )(Res75958)
model = tf.keras.models.Model(inputs=[in0Mul50283,in1Mul50283], outputs=LST97349)
w = model.get_layer('LST97349').get_weights() 
w[0] = np.array([[1, 10, 7, 4, 10, 10, 9, 6, 10, 6, 4, 1], [8, 7, 6, 4, 5, 4, 1, 1, 2, 7, 1, 7]])
w[1] = np.array([[4, 5, 4, 3, 1, 8, 2, 6, 9, 8, 5, 1], [8, 10, 10, 7, 6, 3, 4, 6, 5, 10, 8, 2], [7, 10, 8, 9, 4, 4, 2, 10, 10, 3, 5, 8]])
w[2] = np.array([7, 6, 3, 9, 6, 10, 5, 3, 6, 8, 10, 1])
model.get_layer('LST97349').set_weights(w) 
in0Mul50283 = tf.constant([[[0.6302], [0.1391]]])
in1Mul50283 = tf.constant([[[0.7861], [0.786]]])
print (np.array2string(model.predict([in0Mul50283,in1Mul50283],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST97349.png')

LMul50283 = multiply_layer([[[[0.6302], [0.1391]]], [[[0.7861], [0.786]]]], Mul50283), 
LAve83104 = average_pooling1D_layer(Mul50283, 1, 1, false, Ave83104), 
LRes40744 = reshape_layer(Ave83104, [2, 1, 1], Res40744), 
LUp_78233 = up_sampling2D_layer(Res40744, 1, 2, Up_78233), 
LRes75958 = reshape_layer(Up_78233, [2, 2], Res75958), 
LLST97349 = lstm_layer(Res75958,[[1, 10, 7, 4, 10, 10, 9, 6, 10, 6, 4, 1], [8, 7, 6, 4, 5, 4, 1, 1, 2, 7, 1, 7]],[[4, 5, 4, 3, 1, 8, 2, 6, 9, 8, 5, 1], [8, 10, 10, 7, 6, 3, 4, 6, 5, 10, 8, 2], [7, 10, 8, 9, 4, 4, 2, 10, 10, 3, 5, 8]],[7, 6, 3, 9, 6, 10, 5, 3, 6, 8, 10, 1], LST97349), 
exec_layers([LMul50283,LAve83104,LRes40744,LUp_78233,LRes75958,LLST97349],["Mul50283","Ave83104","Res40744","Up_78233","Res75958","LST97349"],LST97349,"LST97349")

Actual (Unparsed): [[0.9640268, 0.9640272, 0.9639865]]

Expected (Unparsed): [[0.9640268337792343,0.9640271929014919,0.9639864771932627]]

Actual:   [[0.9641, 0.9641, 0.964]]

Expected: [[0.9641, 0.9641, 0.964]]