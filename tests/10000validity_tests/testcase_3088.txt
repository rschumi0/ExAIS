import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max87031 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max87031 = tf.keras.layers.Input(shape=([1, 1, 2]))

Max87031 = keras.layers.Maximum(name = 'Max87031', )([in0Max87031,in1Max87031])
Den7736 = keras.layers.Dense(1,name = 'Den7736', )(Max87031)
Thr24961 = keras.layers.ThresholdedReLU(theta=1.1637842666345393, name = 'Thr24961', )(Den7736)
model = tf.keras.models.Model(inputs=[in0Max87031,in1Max87031], outputs=Thr24961)
w = model.get_layer('Den7736').get_weights() 
w[0] = np.array([[0.6835], [0.014]])
w[1] = np.array([0.0823])
model.get_layer('Den7736').set_weights(w) 
in0Max87031 = tf.constant([[[[0.8094, 0.8407]]]])
in1Max87031 = tf.constant([[[[0.6054, 0.6874]]]])
print (np.array2string(model.predict([in0Max87031,in1Max87031],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr24961.png')

LMax87031 = maximum_layer([[[[[0.8094, 0.8407]]]], [[[[0.6054, 0.6874]]]]], Max87031), 
LDen7736 = dense_layer(Max87031, [[0.6835], [0.014]],[0.0823], Den7736), 
LThr24961 = thresholded_relu_layer(Den7736, 1.1637842666345393, Thr24961), 
exec_layers([LMax87031,LDen7736,LThr24961],["Max87031","Den7736","Thr24961"],Thr24961,"Thr24961")

Actual (Unparsed): [[[[0.0000000]]]]

Expected (Unparsed): [[[[0]]]]

Actual:   [[[[0]]]]

Expected: [[[[0]]]]