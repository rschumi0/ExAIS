import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave46852 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Ave46852 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Glo33301 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Zer68809 = tf.keras.layers.Input(shape=([4, 1, 1]))
in0Con23464 = tf.keras.layers.Input(shape=([6, 3, 1]))

Ave46852 = keras.layers.Average(name = 'Ave46852', )([in0Ave46852,in1Ave46852])
Res11957 = keras.layers.Reshape((2, 1, 2), name = 'Res11957', )(Ave46852)
Cro84560 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro84560', )(Res11957)
Glo33301 = keras.layers.GlobalMaxPool3D(name = 'Glo33301', )(in0Glo33301)
Res27259 = keras.layers.Reshape((1, 1), name = 'Res27259', )(Glo33301)
Res69712 = keras.layers.Reshape((1, 1, 1), name = 'Res69712', )(Res27259)
Loc69475 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 3), name = 'Loc69475', )(Res69712)
Min29932 = keras.layers.Minimum(name = 'Min29932', )([Cro84560,Loc69475])
Zer93395 = keras.layers.ZeroPadding2D(padding=((5, 0), (2, 0)), name = 'Zer93395', )(Min29932)
Zer68809 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer68809', )(in0Zer68809)
PRe51982 = keras.layers.PReLU(name = 'PRe51982', )(Zer68809)
Con23464 = keras.layers.Concatenate(axis=3, name = 'Con23464', )([PRe51982,in0Con23464])
Max56479 = keras.layers.Maximum(name = 'Max56479', )([Zer93395,Con23464])
model = tf.keras.models.Model(inputs=[in0Ave46852,in1Ave46852,in0Glo33301,in0Zer68809,in0Con23464], outputs=Max56479)
w = model.get_layer('Loc69475').get_weights() 
w[0] = np.array([[[0.9257, 0.5557]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc69475').set_weights(w) 
w = model.get_layer('PRe51982').get_weights() 
w[0] = np.array([[[0.6865], [0.1134], [0.911]], [[0.4212], [0.3941], [0.6684]], [[0.6213], [0.487], [0.8025]], [[0.5074], [0.5514], [0.6613]], [[0.3553], [0.3629], [0.94]], [[0.6206], [0.3142], [0.106]]])
model.get_layer('PRe51982').set_weights(w) 
in0Ave46852 = tf.constant([[[[[0.1668, 0.6423]]], [[[0.767, 0.961]]]]])
in1Ave46852 = tf.constant([[[[[0.2087, 0.9671]]], [[[0.3731, 0.253]]]]])
in0Glo33301 = tf.constant([[[[[1.1693]]], [[[1.1695]]]]])
in0Zer68809 = tf.constant([[[[1.4894]], [[1.6814]], [[1.0224]], [[1.0804]]]])
in0Con23464 = tf.constant([[[[0.7008], [0.366], [0.5626]], [[0.9127], [0.9487], [0.877]], [[0.9898], [0.7641], [0.4521]], [[0.9993], [0.35], [0.1037]], [[0.2139], [0.3306], [0.3672]], [[0.1552], [0.3426], [0.9384]]]])
print (np.array2string(model.predict([in0Ave46852,in1Ave46852,in0Glo33301,in0Zer68809,in0Con23464],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max56479.png')

LAve46852 = average_layer([[[[[[0.1668, 0.6423]]], [[[0.767, 0.961]]]]], [[[[[0.2087, 0.9671]]], [[[0.3731, 0.253]]]]]], Ave46852), 
LRes11957 = reshape_layer(Ave46852, [2, 1, 2], Res11957), 
LCro84560 = cropping2D_layer(Res11957, 1, 0, 0, 0, Cro84560), 
LGlo33301 = global_max_pool3D_layer([[[[[1.1693]]], [[[1.1695]]]]], Glo33301), 
LRes27259 = reshape_layer(Glo33301, [1, 1], Res27259), 
LRes69712 = reshape_layer(Res27259, [1, 1, 1], Res69712), 
LLoc69475 = locally_connected2D_layer(Res69712, 1, 1,[[[0.9257, 0.5557]]],[[[0, 0]]], 1, 3, Loc69475), 
LMin29932 = minimum_layer([Cro84560,Loc69475], Min29932), 
LZer93395 = zero_padding2D_layer(Min29932, 5, 0, 2, 0, Zer93395), 
LZer68809 = zero_padding2D_layer([[[[1.4894]], [[1.6814]], [[1.0224]], [[1.0804]]]], 1, 1, 1, 1, Zer68809), 
LPRe51982 = prelu_layer(Zer68809, [[[0.6865], [0.1134], [0.911]], [[0.4212], [0.3941], [0.6684]], [[0.6213], [0.487], [0.8025]], [[0.5074], [0.5514], [0.6613]], [[0.3553], [0.3629], [0.94]], [[0.6206], [0.3142], [0.106]]], PRe51982), 
LCon23464 = concatenate_layer([PRe51982,[[[[0.7008], [0.366], [0.5626]], [[0.9127], [0.9487], [0.877]], [[0.9898], [0.7641], [0.4521]], [[0.9993], [0.35], [0.1037]], [[0.2139], [0.3306], [0.3672]], [[0.1552], [0.3426], [0.9384]]]]], 3, Con23464), 
LMax56479 = maximum_layer([Zer93395,Con23464], Max56479), 
exec_layers([LAve46852,LRes11957,LCro84560,LGlo33301,LRes27259,LRes69712,LLoc69475,LMin29932,LZer93395,LZer68809,LPRe51982,LCon23464,LMax56479],["Ave46852","Res11957","Cro84560","Glo33301","Res27259","Res69712","Loc69475","Min29932","Zer93395","Zer68809","PRe51982","Con23464","Max56479"],Max56479,"Max56479")

Actual (Unparsed): [[[[0.0000000, 0.7008000], [0.0000000, 0.3660000], [0.0000000, 0.5626000]], [[0.0000000, 0.9127000], [1.4894000, 0.9487000], [0.0000000, 0.8770000]], [[0.0000000, 0.9898000], [1.6813999, 0.7641000], [0.0000000, 0.4521000]], [[0.0000000, 0.9993000], [1.0224000, 0.3500000], [0.0000000, 0.1037000]], [[0.0000000, 0.2139000], [1.0804000, 0.3306000], [0.0000000, 0.3672000]], [[0.0000000, 0.1552000], [0.0000000, 0.3426000], [0.5700500, 0.9384000]]]]

Expected (Unparsed): [[[[0,0.7008],[0,0.366],[0,0.5626]],[[0,0.9127],[1.4894,0.9487],[0,0.877]],[[0,0.9898],[1.6814,0.7641],[0,0.4521]],[[0,0.9993],[1.0224,0.35],[0,0.1037]],[[0,0.2139],[1.0804,0.3306],[0,0.3672]],[[0,0.1552],[0,0.3426],[0.57005,0.9384]]]]

Actual:   [[[[0, 0.7008], [0, 0.366], [0, 0.5626]], [[0, 0.9127], [1.4894, 0.9487], [0, 0.877]], [[0, 0.9898], [1.6814, 0.7641], [0, 0.4521]], [[0, 0.9993], [1.0224, 0.35], [0, 0.1037]], [[0, 0.2139], [1.0804, 0.3306], [0, 0.3672]], [[0, 0.1552], [0, 0.3426], [0.5701, 0.9384]]]]

Expected: [[[[0, 0.7008], [0, 0.366], [0, 0.5626]], [[0, 0.9127], [1.4894, 0.9487], [0, 0.877]], [[0, 0.9898], [1.6814, 0.7641], [0, 0.4521]], [[0, 0.9993], [1.0224, 0.35], [0, 0.1037]], [[0, 0.2139], [1.0804, 0.3306], [0, 0.3672]], [[0, 0.1552], [0, 0.3426], [0.5701, 0.9384]]]]