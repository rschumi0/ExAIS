import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den72228 = tf.keras.layers.Input(shape=([3, 3]))
in0Mul9964 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul9964 = tf.keras.layers.Input(shape=([2, 1]))

Den72228 = keras.layers.Dense(2,name = 'Den72228', )(in0Den72228)
Res20919 = keras.layers.Reshape((3, 2, 1), name = 'Res20919', )(Den72228)
Mul9964 = keras.layers.Multiply(name = 'Mul9964', )([in0Mul9964,in1Mul9964])
Res8590 = keras.layers.Reshape((2, 1, 1), name = 'Res8590', )(Mul9964)
Ave90140 = keras.layers.AveragePooling2D(pool_size=(2, 1), strides=(1, 1), padding='same', name = 'Ave90140', )(Res8590)
Zer66949 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer66949', )(Ave90140)
Max59923 = keras.layers.Maximum(name = 'Max59923', )([Res20919,Zer66949])
model = tf.keras.models.Model(inputs=[in0Den72228,in0Mul9964,in1Mul9964], outputs=Max59923)
w = model.get_layer('Den72228').get_weights() 
w[0] = np.array([[0.32, 0.05], [0.7311, 0.7281], [0.9405, 0.2194]])
w[1] = np.array([0.9783, 0.1068])
model.get_layer('Den72228').set_weights(w) 
in0Den72228 = tf.constant([[[0.0677, 0.3181, 0.1864], [0.4132, 0.3409, 0.2187], [0.6102, 0.0388, 0.4444]]])
in0Mul9964 = tf.constant([[[0.7627], [0.6276]]])
in1Mul9964 = tf.constant([[[0.4322], [0.6188]]])
print (np.array2string(model.predict([in0Den72228,in0Mul9964,in1Mul9964],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max59923.png')

LDen72228 = dense_layer([[[0.0677, 0.3181, 0.1864], [0.4132, 0.3409, 0.2187], [0.6102, 0.0388, 0.4444]]], [[0.32, 0.05], [0.7311, 0.7281], [0.9405, 0.2194]],[0.9783, 0.1068], Den72228), 
LRes20919 = reshape_layer(Den72228, [3, 2, 1], Res20919), 
LMul9964 = multiply_layer([[[[0.7627], [0.6276]]], [[[0.4322], [0.6188]]]], Mul9964), 
LRes8590 = reshape_layer(Mul9964, [2, 1, 1], Res8590), 
LAve90140 = average_pooling2D_layer(Res8590, 2, 1, 1, 1, true, Ave90140), 
LZer66949 = zero_padding2D_layer(Ave90140, 1, 0, 1, 0, Zer66949), 
LMax59923 = maximum_layer([Res20919,Zer66949], Max59923), 
exec_layers([LDen72228,LRes20919,LMul9964,LRes8590,LAve90140,LZer66949,LMax59923],["Den72228","Res20919","Mul9964","Res8590","Ave90140","Zer66949","Max59923"],Max59923,"Max59923")

Actual (Unparsed): [[[[1.4078361], [0.3826898]], [[1.5654433], [0.4236521]], [[1.6198889], [0.3883589]]]]

Expected (Unparsed): [[[[1.40783611],[0.38268977]],[[1.5654433399999998],[0.42365207]],[[1.6198888799999998],[0.38835888]]]]

Actual:   [[[[1.4079], [0.3827]], [[1.5655], [0.4237]], [[1.6199], [0.3884]]]]

Expected: [[[[1.4079], [0.3827]], [[1.5655], [0.4237]], [[1.6199], [0.3884]]]]