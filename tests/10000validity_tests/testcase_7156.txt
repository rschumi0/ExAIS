import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave81441 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Ave81441 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Ave81441 = keras.layers.Average(name = 'Ave81441', )([in0Ave81441,in1Ave81441])
Thr57269 = keras.layers.ThresholdedReLU(theta=7.040761210255264, name = 'Thr57269', )(Ave81441)
Res91471 = keras.layers.Reshape((1, 2, 4), name = 'Res91471', )(Thr57269)
Res61955 = keras.layers.Reshape((1, 8), name = 'Res61955', )(Res91471)
Sim74465 = keras.layers.SimpleRNN(2,name = 'Sim74465', )(Res61955)
Res23212 = keras.layers.Reshape((2, 1), name = 'Res23212', )(Sim74465)
Res34740 = keras.layers.Reshape((2, 1, 1), name = 'Res34740', )(Res23212)
Res44826 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res44826', )(Res34740)
Cro87524 = keras.layers.Cropping3D(cropping=((1, 0), (0, 0), (0, 0)), name = 'Cro87524', )(Res44826)
model = tf.keras.models.Model(inputs=[in0Ave81441,in1Ave81441], outputs=Cro87524)
w = model.get_layer('Sim74465').get_weights() 
w[0] = np.array([[3, 6], [6, 1], [7, 1], [9, 10], [9, 7], [3, 6], [2, 8], [3, 8]])
w[1] = np.array([[5, 2], [1, 1]])
w[2] = np.array([9, 1])
model.get_layer('Sim74465').set_weights(w) 
in0Ave81441 = tf.constant([[[[[0.9111, 0.5232], [0.7817, 0.7424]], [[0.9897, 0.5241], [0.555, 0.2337]]]]])
in1Ave81441 = tf.constant([[[[[0.1156, 0.929], [0.7412, 0.3438]], [[0.8516, 0.5903], [0.876, 0.6144]]]]])
print (np.array2string(model.predict([in0Ave81441,in1Ave81441],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro87524.png')

LAve81441 = average_layer([[[[[[0.9111, 0.5232], [0.7817, 0.7424]], [[0.9897, 0.5241], [0.555, 0.2337]]]]], [[[[[0.1156, 0.929], [0.7412, 0.3438]], [[0.8516, 0.5903], [0.876, 0.6144]]]]]], Ave81441), 
LThr57269 = thresholded_relu_layer(Ave81441, 7.040761210255264, Thr57269), 
LRes91471 = reshape_layer(Thr57269, [1, 2, 4], Res91471), 
LRes61955 = reshape_layer(Res91471, [1, 8], Res61955), 
LSim74465 = simple_rnn_layer(Res61955,[[3, 6], [6, 1], [7, 1], [9, 10], [9, 7], [3, 6], [2, 8], [3, 8]],[[5, 2], [1, 1]],[9, 1], Sim74465), 
LRes23212 = reshape_layer(Sim74465, [2, 1], Res23212), 
LRes34740 = reshape_layer(Res23212, [2, 1, 1], Res34740), 
LRes44826 = reshape_layer(Res34740, [2, 1, 1, 1], Res44826), 
LCro87524 = cropping3D_layer(Res44826, 1, 0, 0, 0, 0, 0, Cro87524), 
exec_layers([LAve81441,LThr57269,LRes91471,LRes61955,LSim74465,LRes23212,LRes34740,LRes44826,LCro87524],["Ave81441","Thr57269","Res91471","Res61955","Sim74465","Res23212","Res34740","Res44826","Cro87524"],Cro87524,"Cro87524")

Actual (Unparsed): [[[[[0.7615942]]]]]

Expected (Unparsed): [[[[[0.7615941559557649]]]]]

Actual:   [[[[[0.7616]]]]]

Expected: [[[[[0.7616]]]]]