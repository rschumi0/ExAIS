import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo33180 = tf.keras.layers.Input(shape=([2, 1]))
in0Glo65483 = tf.keras.layers.Input(shape=([1, 1]))

Glo33180 = keras.layers.GlobalMaxPool1D(name = 'Glo33180', )(in0Glo33180)
Glo65483 = keras.layers.GlobalMaxPool1D(name = 'Glo65483', )(in0Glo65483)
Lea44399 = keras.layers.LeakyReLU(alpha=6.302104664083138, name = 'Lea44399', )(Glo65483)
Max12060 = keras.layers.Maximum(name = 'Max12060', )([Glo33180,Lea44399])
Mas94282 = keras.layers.Masking(mask_value=2, name = 'Mas94282', )(Max12060)
model = tf.keras.models.Model(inputs=[in0Glo33180,in0Glo65483], outputs=Mas94282)
in0Glo33180 = tf.constant([[[1.0228], [1.9494]]])
in0Glo65483 = tf.constant([[[1.871]]])
print (np.array2string(model.predict([in0Glo33180,in0Glo65483],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas94282.png')

LGlo33180 = global_max_pool1D_layer([[[1.0228], [1.9494]]], Glo33180), 
LGlo65483 = global_max_pool1D_layer([[[1.871]]], Glo65483), 
LLea44399 = leaky_relu_layer(Glo65483, 6.302104664083138, Lea44399), 
LMax12060 = maximum_layer([Glo33180,Lea44399], Max12060), 
LMas94282 = masking_layer(Max12060, 2, Mas94282), 
exec_layers([LGlo33180,LGlo65483,LLea44399,LMax12060,LMas94282],["Glo33180","Glo65483","Lea44399","Max12060","Mas94282"],Mas94282,"Mas94282")

Actual (Unparsed): [[1.9493999]]

Expected (Unparsed): [[1.9494]]

Actual:   [[1.9494]]

Expected: [[1.9494]]