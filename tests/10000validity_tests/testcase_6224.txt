import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer9339 = tf.keras.layers.Input(shape=([3, 1]))
in0Min5664 = tf.keras.layers.Input(shape=([2, 1]))
in1Min5664 = tf.keras.layers.Input(shape=([2, 1]))

Zer9339 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer9339', )(in0Zer9339)
Min5664 = keras.layers.Minimum(name = 'Min5664', )([in0Min5664,in1Min5664])
Thr8481 = keras.layers.ThresholdedReLU(theta=1.8361132805203955, name = 'Thr8481', )(Min5664)
Sep33213 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep33213', )(Thr8481)
Zer39911 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer39911', )(Sep33213)
Dot18037 = keras.layers.Dot(axes=(1, 1), name = 'Dot18037', )([Zer9339,Zer39911])
Res55695 = keras.layers.Reshape((1, 4, 1), name = 'Res55695', )(Dot18037)
Cro21360 = keras.layers.Cropping2D(cropping=((0, 0), (2, 1)), name = 'Cro21360', )(Res55695)
model = tf.keras.models.Model(inputs=[in0Zer9339,in0Min5664,in1Min5664], outputs=Cro21360)
w = model.get_layer('Sep33213').get_weights() 
w[0] = np.array([[[0.123]]])
w[1] = np.array([[[0.7052, 0.6162, 0.7489, 0.1799]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep33213').set_weights(w) 
in0Zer9339 = tf.constant([[[1.5064], [1.2606], [1.3601]]])
in0Min5664 = tf.constant([[[0.9732], [0.9233]]])
in1Min5664 = tf.constant([[[0.3099], [0.2639]]])
print (np.array2string(model.predict([in0Zer9339,in0Min5664,in1Min5664],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro21360.png')

LZer9339 = zero_padding1D_layer([[[1.5064], [1.2606], [1.3601]]], 1, 1, Zer9339), 
LMin5664 = minimum_layer([[[[0.9732], [0.9233]]], [[[0.3099], [0.2639]]]], Min5664), 
LThr8481 = thresholded_relu_layer(Min5664, 1.8361132805203955, Thr8481), 
LSep33213 = separable_conv1D_layer(Thr8481, 1,[[[[0.123]]],[[[0.7052, 0.6162, 0.7489, 0.1799]]]],[0, 0, 0, 0], 1, true, Sep33213), 
LZer39911 = zero_padding1D_layer(Sep33213, 3, 0, Zer39911), 
LDot18037 = dot_layer(Zer9339,Zer39911, 1, 1, Dot18037), 
LRes55695 = reshape_layer(Dot18037, [1, 4, 1], Res55695), 
LCro21360 = cropping2D_layer(Res55695, 0, 0, 2, 1, Cro21360), 
exec_layers([LZer9339,LMin5664,LThr8481,LSep33213,LZer39911,LDot18037,LRes55695,LCro21360],["Zer9339","Min5664","Thr8481","Sep33213","Zer39911","Dot18037","Res55695","Cro21360"],Cro21360,"Cro21360")

Actual (Unparsed): [[[[0.0000000]]]]

Expected (Unparsed): [[[[0.0]]]]

Actual:   [[[[0]]]]

Expected: [[[[0]]]]