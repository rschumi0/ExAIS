import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul78851 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul78851 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Add54250 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Add54250 = tf.keras.layers.Input(shape=([1, 1, 2]))

Mul78851 = keras.layers.Multiply(name = 'Mul78851', )([in0Mul78851,in1Mul78851])
Lay73006 = keras.layers.LayerNormalization(axis=2, epsilon=1.588696211535113, name = 'Lay73006', )(Mul78851)
Res64294 = keras.layers.Reshape((1, 2), name = 'Res64294', )(Lay73006)
Add54250 = keras.layers.Add(name = 'Add54250', )([in0Add54250,in1Add54250])
Con18242 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con18242', )(Add54250)
Res3323 = keras.layers.Reshape((1, 2), name = 'Res3323', )(Con18242)
Ave94516 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave94516', )(Res3323)
Dot85572 = keras.layers.Dot(axes=(2, 2), name = 'Dot85572', )([Res64294,Ave94516])
model = tf.keras.models.Model(inputs=[in0Mul78851,in1Mul78851,in0Add54250,in1Add54250], outputs=Dot85572)
w = model.get_layer('Con18242').get_weights() 
w[0] = np.array([[[[0.6722, 0.2853], [0.7549, 0.648]]]])
w[1] = np.array([0, 0])
model.get_layer('Con18242').set_weights(w) 
in0Mul78851 = tf.constant([[[[0.0857], [0.6666]]]])
in1Mul78851 = tf.constant([[[[0.5525], [0.2634]]]])
in0Add54250 = tf.constant([[[[0.554, 0.0642]]]])
in1Add54250 = tf.constant([[[[0.8772, 0.1846]]]])
print (np.array2string(model.predict([in0Mul78851,in1Mul78851,in0Add54250,in1Add54250],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot85572.png')

LMul78851 = multiply_layer([[[[[0.0857], [0.6666]]]], [[[[0.5525], [0.2634]]]]], Mul78851), 
LLay73006 = layer_normalization_layer(Mul78851, 2, 1.588696211535113, Lay73006), 
LRes64294 = reshape_layer(Lay73006, [1, 2], Res64294), 
LAdd54250 = add_layer([[[[[0.554, 0.0642]]]], [[[[0.8772, 0.1846]]]]], Add54250), 
LCon18242 = conv2D_layer(Add54250, 1, 1,[[[[0.6722, 0.2853], [0.7549, 0.648]]]],[0, 0], 1, 1, true, 1, 1, Con18242), 
LRes3323 = reshape_layer(Con18242, [1, 2], Res3323), 
LAve94516 = average_pooling1D_layer(Res3323, 1, Ave94516), 
LDot85572 = dot_layer(Res64294,Ave94516, 2, 2, Dot85572), 
exec_layers([LMul78851,LLay73006,LRes64294,LAdd54250,LCon18242,LRes3323,LAve94516,LDot85572],["Mul78851","Lay73006","Res64294","Add54250","Con18242","Res3323","Ave94516","Dot85572"],Dot85572,"Dot85572")

Actual (Unparsed): [[[-0.0294824]]]

Expected (Unparsed): [[[-0.02948236899826905]]]

Actual:   [[[-0.0294]]]

Expected: [[[-0.0294]]]