import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max61120 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con31961 = tf.keras.layers.Input(shape=([1, 23]))
in0Up_49012 = tf.keras.layers.Input(shape=([3, 4, 1, 3]))
in0Cro98853 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con29717 = tf.keras.layers.Input(shape=([3, 4, 5]))
in0Mul77173 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul77173 = tf.keras.layers.Input(shape=([1, 1]))

Max61120 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 9), padding='valid', name = 'Max61120', )(in0Max61120)
Res12426 = keras.layers.Reshape((1, 1), name = 'Res12426', )(Max61120)
Con31961 = keras.layers.Concatenate(axis=2, name = 'Con31961', )([Res12426,in0Con31961])
Up_49012 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_49012', )(in0Up_49012)
Res61431 = keras.layers.Reshape((3, 4, 6), name = 'Res61431', )(Up_49012)
Cro98853 = keras.layers.Cropping2D(cropping=((0, 1), (0, 0)), name = 'Cro98853', )(in0Cro98853)
Zer97917 = keras.layers.ZeroPadding2D(padding=((2, 0), (3, 0)), name = 'Zer97917', )(Cro98853)
Con29717 = keras.layers.Concatenate(axis=3, name = 'Con29717', )([Zer97917,in0Con29717])
Add32738 = keras.layers.Add(name = 'Add32738', )([Res61431,Con29717])
Res68414 = keras.layers.Reshape((3, 24), name = 'Res68414', )(Add32738)
Zer12030 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer12030', )(Res68414)
Dot95446 = keras.layers.Dot(axes=(2, 2), name = 'Dot95446', )([Con31961,Zer12030])
Mul77173 = keras.layers.Multiply(name = 'Mul77173', )([in0Mul77173,in1Mul77173])
Dot99278 = keras.layers.Dot(axes=(1, 2), name = 'Dot99278', )([Dot95446,Mul77173])
Sim76291 = keras.layers.SimpleRNN(1,name = 'Sim76291', )(Dot99278)
model = tf.keras.models.Model(inputs=[in0Max61120,in0Con31961,in0Up_49012,in0Cro98853,in0Con29717,in0Mul77173,in1Mul77173], outputs=Sim76291)
w = model.get_layer('Sim76291').get_weights() 
w[0] = np.array([[8]])
w[1] = np.array([[9]])
w[2] = np.array([9])
model.get_layer('Sim76291').set_weights(w) 
in0Max61120 = tf.constant([[[[1.769]]]])
in0Con31961 = tf.constant([[[0.2414, 0.9753, 0.5257, 0.2743, 0.9547, 0.9993, 0.0773, 0.5989, 0.3807, 0.8234, 0.4788, 0.1036, 0.7655, 0.072, 0.59, 0.2459, 0.308, 0.8112, 0.8699, 0.1498, 0.993, 0.035, 0.5361]]])
in0Up_49012 = tf.constant([[[[[1.5313, 1.4808, 1.1154]], [[1.7017, 1.7933, 1.1401]], [[1.9694, 1.7404, 1.5815]], [[1.1294, 1.6518, 1.4566]]], [[[1.6518, 1.1414, 1.919]], [[1.9166, 1.2125, 1.1521]], [[1.1242, 1.1042, 1.7709]], [[1.9982, 1.5893, 1.722]]], [[[1.3331, 1.0803, 1.5483]], [[1.6867, 1.9863, 1.5148]], [[1.0166, 1.1928, 1.1423]], [[1.3262, 1.0225, 1.4378]]]]])
in0Cro98853 = tf.constant([[[[1.8877]], [[1.6839]]]])
in0Con29717 = tf.constant([[[[0.1973, 0.6546, 0.9079, 0.8383, 0.1652], [0.2195, 0.5755, 0.4217, 0.0632, 0.644], [0.4683, 0.5859, 0.0645, 0.3296, 0.1388], [0.4222, 0.5943, 0.1502, 0.7006, 0.0706]], [[0.2842, 0.2414, 0.1567, 0.4956, 0.6324], [0.2945, 0.9352, 0.6813, 0.8889, 0.1813], [0.9061, 0.9411, 0.2044, 0.2956, 0.8203], [0.3686, 0.1414, 0.3448, 0.8046, 0.064]], [[0.2304, 0.4519, 0.2801, 0.664, 0.3727], [0.3302, 0.4239, 0.8746, 0.5415, 0.9897], [0.0867, 0.1608, 0.4134, 0.8944, 0.9028], [0.4838, 0.2729, 0.7503, 0.1754, 0.9901]]]])
in0Mul77173 = tf.constant([[[0.1261]]])
in1Mul77173 = tf.constant([[[0.9692]]])
print (np.array2string(model.predict([in0Max61120,in0Con31961,in0Up_49012,in0Cro98853,in0Con29717,in0Mul77173,in1Mul77173],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim76291.png')

LMax61120 = max_pool2D_layer([[[[1.769]]]], 1, 1, 1, 9, false, Max61120), 
LRes12426 = reshape_layer(Max61120, [1, 1], Res12426), 
LCon31961 = concatenate_layer([Res12426,[[[0.2414, 0.9753, 0.5257, 0.2743, 0.9547, 0.9993, 0.0773, 0.5989, 0.3807, 0.8234, 0.4788, 0.1036, 0.7655, 0.072, 0.59, 0.2459, 0.308, 0.8112, 0.8699, 0.1498, 0.993, 0.035, 0.5361]]]], 2, Con31961), 
LUp_49012 = up_sampling3D_layer([[[[[1.5313, 1.4808, 1.1154]], [[1.7017, 1.7933, 1.1401]], [[1.9694, 1.7404, 1.5815]], [[1.1294, 1.6518, 1.4566]]], [[[1.6518, 1.1414, 1.919]], [[1.9166, 1.2125, 1.1521]], [[1.1242, 1.1042, 1.7709]], [[1.9982, 1.5893, 1.722]]], [[[1.3331, 1.0803, 1.5483]], [[1.6867, 1.9863, 1.5148]], [[1.0166, 1.1928, 1.1423]], [[1.3262, 1.0225, 1.4378]]]]], 1, 1, 2, Up_49012), 
LRes61431 = reshape_layer(Up_49012, [3, 4, 6], Res61431), 
LCro98853 = cropping2D_layer([[[[1.8877]], [[1.6839]]]], 0, 1, 0, 0, Cro98853), 
LZer97917 = zero_padding2D_layer(Cro98853, 2, 0, 3, 0, Zer97917), 
LCon29717 = concatenate_layer([Zer97917,[[[[0.1973, 0.6546, 0.9079, 0.8383, 0.1652], [0.2195, 0.5755, 0.4217, 0.0632, 0.644], [0.4683, 0.5859, 0.0645, 0.3296, 0.1388], [0.4222, 0.5943, 0.1502, 0.7006, 0.0706]], [[0.2842, 0.2414, 0.1567, 0.4956, 0.6324], [0.2945, 0.9352, 0.6813, 0.8889, 0.1813], [0.9061, 0.9411, 0.2044, 0.2956, 0.8203], [0.3686, 0.1414, 0.3448, 0.8046, 0.064]], [[0.2304, 0.4519, 0.2801, 0.664, 0.3727], [0.3302, 0.4239, 0.8746, 0.5415, 0.9897], [0.0867, 0.1608, 0.4134, 0.8944, 0.9028], [0.4838, 0.2729, 0.7503, 0.1754, 0.9901]]]]], 3, Con29717), 
LAdd32738 = add_layer([Res61431,Con29717], Add32738), 
LRes68414 = reshape_layer(Add32738, [3, 24], Res68414), 
LZer12030 = zero_padding1D_layer(Res68414, 2, 0, Zer12030), 
LDot95446 = dot_layer(Con31961,Zer12030, 2, 2, Dot95446), 
LMul77173 = multiply_layer([[[[0.1261]]], [[[0.9692]]]], Mul77173), 
LDot99278 = dot_layer(Dot95446,Mul77173, 1, 2, Dot99278), 
LSim76291 = simple_rnn_layer(Dot99278,[[8]],[[9]],[9], Sim76291), 
exec_layers([LMax61120,LRes12426,LCon31961,LUp_49012,LRes61431,LCro98853,LZer97917,LCon29717,LAdd32738,LRes68414,LZer12030,LDot95446,LMul77173,LDot99278,LSim76291],["Max61120","Res12426","Con31961","Up_49012","Res61431","Cro98853","Zer97917","Con29717","Add32738","Res68414","Zer12030","Dot95446","Mul77173","Dot99278","Sim76291"],Sim76291,"Sim76291")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[1.0]]

Actual:   [[1]]

Expected: [[1]]