import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max62936 = tf.keras.layers.Input(shape=([1, 1]))
in1Max62936 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot55510 = tf.keras.layers.Input(shape=([2]))
in1Dot55510 = tf.keras.layers.Input(shape=([2]))

Max62936 = keras.layers.Maximum(name = 'Max62936', )([in0Max62936,in1Max62936])
Lea39128 = keras.layers.LeakyReLU(alpha=1.3854043680432429, name = 'Lea39128', )(Max62936)
Fla60081 = keras.layers.Flatten(name = 'Fla60081', )(Lea39128)
Dot55510 = keras.layers.Dot(axes=(1, 1), name = 'Dot55510', )([in0Dot55510,in1Dot55510])
Sub39256 = keras.layers.Subtract(name = 'Sub39256', )([Fla60081,Dot55510])
model = tf.keras.models.Model(inputs=[in0Max62936,in1Max62936,in0Dot55510,in1Dot55510], outputs=Sub39256)
in0Max62936 = tf.constant([[[0.3292]]])
in1Max62936 = tf.constant([[[0.232]]])
in0Dot55510 = tf.constant([[0.1442, 0.4236]])
in1Dot55510 = tf.constant([[0.4653, 0.5622]])
print (np.array2string(model.predict([in0Max62936,in1Max62936,in0Dot55510,in1Dot55510],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub39256.png')

LMax62936 = maximum_layer([[[[0.3292]]], [[[0.232]]]], Max62936), 
LLea39128 = leaky_relu_layer(Max62936, 1.3854043680432429, Lea39128), 
LFla60081 = flatten_layer(Lea39128, Fla60081), 
LDot55510 = dot_layer([[0.1442, 0.4236]], [[0.4653, 0.5622]], 1, 1, Dot55510), 
LSub39256 = subtract_layer(Fla60081,Dot55510, Sub39256), 
exec_layers([LMax62936,LLea39128,LFla60081,LDot55510,LSub39256],["Max62936","Lea39128","Fla60081","Dot55510","Sub39256"],Sub39256,"Sub39256")

Actual (Unparsed): [[0.0239558]]

Expected (Unparsed): [[0.023955820000000017]]

Actual:   [[0.024]]

Expected: [[0.024]]