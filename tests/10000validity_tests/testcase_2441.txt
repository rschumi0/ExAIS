import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max28408 = tf.keras.layers.Input(shape=([2, 2]))
in1Max28408 = tf.keras.layers.Input(shape=([2, 2]))
in0Add30209 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add30209 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Up_4541 = tf.keras.layers.Input(shape=([2, 2]))

Max28408 = keras.layers.Maximum(name = 'Max28408', )([in0Max28408,in1Max28408])
Zer27099 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer27099', )(Max28408)
Add30209 = keras.layers.Add(name = 'Add30209', )([in0Add30209,in1Add30209])
Res74247 = keras.layers.Reshape((2, 2), name = 'Res74247', )(Add30209)
Cro30556 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro30556', )(Res74247)
Zer1107 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer1107', )(Cro30556)
Up_4541 = keras.layers.UpSampling1D(size=(2), name = 'Up_4541', )(in0Up_4541)
Lay79529 = keras.layers.LayerNormalization(axis=1, epsilon=1.221284223665042, name = 'Lay79529', )(Up_4541)
Min49927 = keras.layers.Minimum(name = 'Min49927', )([Zer1107,Lay79529])
Min71202 = keras.layers.Minimum(name = 'Min71202', )([Zer27099,Min49927])
model = tf.keras.models.Model(inputs=[in0Max28408,in1Max28408,in0Add30209,in1Add30209,in0Up_4541], outputs=Min71202)
in0Max28408 = tf.constant([[[0.5451, 0.1421], [0.755, 0.5142]]])
in1Max28408 = tf.constant([[[0.4861, 0.6599], [0.9924, 0.9122]]])
in0Add30209 = tf.constant([[[[0.8128], [0.756]], [[0.7158], [0.4638]]]])
in1Add30209 = tf.constant([[[[0.1847], [0.6765]], [[0.469], [0.0982]]]])
in0Up_4541 = tf.constant([[[1.3813, 1.3892], [1.9281, 1.8558]]])
print (np.array2string(model.predict([in0Max28408,in1Max28408,in0Add30209,in1Add30209,in0Up_4541],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min71202.png')

LMax28408 = maximum_layer([[[[0.5451, 0.1421], [0.755, 0.5142]]], [[[0.4861, 0.6599], [0.9924, 0.9122]]]], Max28408), 
LZer27099 = zero_padding1D_layer(Max28408, 2, 0, Zer27099), 
LAdd30209 = add_layer([[[[[0.8128], [0.756]], [[0.7158], [0.4638]]]], [[[[0.1847], [0.6765]], [[0.469], [0.0982]]]]], Add30209), 
LRes74247 = reshape_layer(Add30209, [2, 2], Res74247), 
LCro30556 = cropping1D_layer(Res74247, 1, 0, Cro30556), 
LZer1107 = zero_padding1D_layer(Cro30556, 3, 0, Zer1107), 
LUp_4541 = up_sampling1D_layer([[[1.3813, 1.3892], [1.9281, 1.8558]]], 2, Up_4541), 
LLay79529 = layer_normalization_layer(Up_4541, 1, 1.221284223665042, Lay79529), 
LMin49927 = minimum_layer([Zer1107,Lay79529], Min49927), 
LMin71202 = minimum_layer([Zer27099,Min49927], Min71202), 
exec_layers([LMax28408,LZer27099,LAdd30209,LRes74247,LCro30556,LZer1107,LUp_4541,LLay79529,LMin49927,LMin71202],["Max28408","Zer27099","Add30209","Res74247","Cro30556","Zer1107","Up_4541","Lay79529","Min49927","Min71202"],Min71202,"Min71202")

Actual (Unparsed): [[[-0.2401545, -0.2065562], [-0.2401545, -0.2065562], [0.0000000, 0.0000000], [0.2401545, 0.2065562]]]

Expected (Unparsed): [[[-0.2401544752724624,-0.20655619693130384],[-0.2401544752724624,-0.20655619693130384],[0,0],[0.2401544752724626,0.20655619693130362]]]

Actual:   [[[-0.2401, -0.2065], [-0.2401, -0.2065], [0, 0], [0.2402, 0.2066]]]

Expected: [[[-0.2401, -0.2065], [-0.2401, -0.2065], [0, 0], [0.2402, 0.2066]]]