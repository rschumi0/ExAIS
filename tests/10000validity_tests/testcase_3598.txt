import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave98439 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave98439 = tf.keras.layers.Input(shape=([1, 2]))

Ave98439 = keras.layers.Average(name = 'Ave98439', )([in0Ave98439,in1Ave98439])
Res51577 = keras.layers.Reshape((1, 2, 1), name = 'Res51577', )(Ave98439)
Con49270 = keras.layers.Conv2DTranspose(2, (1, 1),strides=(1, 1), padding='same', name = 'Con49270', )(Res51577)
Res74411 = keras.layers.Reshape((1, 4), name = 'Res74411', )(Con49270)
Ave89238 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave89238', )(Res74411)
Sim65298 = keras.layers.SimpleRNN(1,name = 'Sim65298', )(Ave89238)
model = tf.keras.models.Model(inputs=[in0Ave98439,in1Ave98439], outputs=Sim65298)
w = model.get_layer('Con49270').get_weights() 
w[0] = np.array([[[[0.3758], [0.9368]]]])
w[1] = np.array([0, 0])
model.get_layer('Con49270').set_weights(w) 
w = model.get_layer('Sim65298').get_weights() 
w[0] = np.array([[4], [5], [1], [9]])
w[1] = np.array([[9]])
w[2] = np.array([1])
model.get_layer('Sim65298').set_weights(w) 
in0Ave98439 = tf.constant([[[0.924, 0.1752]]])
in1Ave98439 = tf.constant([[[0.9765, 0.3006]]])
print (np.array2string(model.predict([in0Ave98439,in1Ave98439],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim65298.png')

LAve98439 = average_layer([[[[0.924, 0.1752]]], [[[0.9765, 0.3006]]]], Ave98439), 
LRes51577 = reshape_layer(Ave98439, [1, 2, 1], Res51577), 
LCon49270 = conv2D_transpose_layer(Res51577, 1, 1,[[[[0.3758], [0.9368]]]],[0, 0], 1, 1, true, Con49270), 
LRes74411 = reshape_layer(Con49270, [1, 4], Res74411), 
LAve89238 = average_pooling1D_layer(Res74411, 1, Ave89238), 
LSim65298 = simple_rnn_layer(Ave89238,[[4], [5], [1], [9]],[[9]],[1], Sim65298), 
exec_layers([LAve98439,LRes51577,LCon49270,LRes74411,LAve89238,LSim65298],["Ave98439","Res51577","Con49270","Res74411","Ave89238","Sim65298"],Sim65298,"Sim65298")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[0.9999999679509096]]

Actual:   [[1]]

Expected: [[1]]