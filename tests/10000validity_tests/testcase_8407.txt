import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave7212 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Ave7212 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Ave7212 = keras.layers.Average(name = 'Ave7212', )([in0Ave7212,in1Ave7212])
Res59077 = keras.layers.Reshape((2, 1, 2), name = 'Res59077', )(Ave7212)
Loc18985 = keras.layers.LocallyConnected2D(4, (2, 1),strides=(1, 1), name = 'Loc18985', )(Res59077)
model = tf.keras.models.Model(inputs=[in0Ave7212,in1Ave7212], outputs=Loc18985)
w = model.get_layer('Loc18985').get_weights() 
w[0] = np.array([[[0.7512, 0.3495, 0.1672, 0.4416], [0.5098, 0.4013, 0.2616, 0.0803], [0.3441, 0.8683, 0.3864, 0.6133], [0.1943, 0.4291, 0.7629, 0.7351]]])
w[1] = np.array([[[0, 0, 0, 0]]])
model.get_layer('Loc18985').set_weights(w) 
in0Ave7212 = tf.constant([[[[[0.1392, 0.583]]], [[[0.6886, 0.6331]]]]])
in1Ave7212 = tf.constant([[[[[0.5842, 0.7859]]], [[[0.47, 0.1737]]]]])
print (np.array2string(model.predict([in0Ave7212,in1Ave7212],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc18985.png')

LAve7212 = average_layer([[[[[[0.1392, 0.583]]], [[[0.6886, 0.6331]]]]], [[[[[0.5842, 0.7859]]], [[[0.47, 0.1737]]]]]], Ave7212), 
LRes59077 = reshape_layer(Ave7212, [2, 1, 2], Res59077), 
LLoc18985 = locally_connected2D_layer(Res59077, 2, 1,[[[0.7512, 0.3495, 0.1672, 0.4416], [0.5098, 0.4013, 0.2616, 0.0803], [0.3441, 0.8683, 0.3864, 0.6133], [0.1943, 0.4291, 0.7629, 0.7351]]],[[[0, 0, 0, 0]]], 1, 1, Loc18985), 
exec_layers([LAve7212,LRes59077,LLoc18985],["Ave7212","Res59077","Loc18985"],Loc18985,"Loc18985")

Actual (Unparsed): [[[[0.8983594, 1.0771891, 0.7711237, 0.8665121]]]]

Expected (Unparsed): [[[[0.8983594,1.077189065,0.77112374,0.8665120849999999]]]]

Actual:   [[[[0.8984, 1.0772, 0.7712, 0.8666]]]]

Expected: [[[[0.8984, 1.0772, 0.7712, 0.8666]]]]