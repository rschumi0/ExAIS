import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul27777 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul27777 = tf.keras.layers.Input(shape=([2, 1, 2]))

Mul27777 = keras.layers.Multiply(name = 'Mul27777', )([in0Mul27777,in1Mul27777])
Mas55722 = keras.layers.Masking(mask_value=1, name = 'Mas55722', )(Mul27777)
Sof75214 = keras.layers.Softmax(axis=1, name = 'Sof75214', )(Mas55722)
model = tf.keras.models.Model(inputs=[in0Mul27777,in1Mul27777], outputs=Sof75214)
in0Mul27777 = tf.constant([[[[0.8328, 0.3204]], [[0.3343, 0.1663]]]])
in1Mul27777 = tf.constant([[[[0.8865, 0.0624]], [[0.8799, 0.2884]]]])
print (np.array2string(model.predict([in0Mul27777,in1Mul27777],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof75214.png')

LMul27777 = multiply_layer([[[[[0.8328, 0.3204]], [[0.3343, 0.1663]]]], [[[[0.8865, 0.0624]], [[0.8799, 0.2884]]]]], Mul27777), 
LMas55722 = masking_layer(Mul27777, 1, Mas55722), 
LSof75214 = softmax_layer(Mas55722, 1, Sof75214), 
exec_layers([LMul27777,LMas55722,LSof75214],["Mul27777","Mas55722","Sof75214"],Sof75214,"Sof75214")

Actual (Unparsed): [[[[0.6092419, 0.4930085], [0.6092419, 0.4930085]], [[0.3907581, 0.5069915], [0.3907581, 0.5069915]]]]

Expected (Unparsed): [[[[0.6092418835904012,0.4930084657295217]],[[0.39075811640959873,0.5069915342704783]]]]

Actual:   [[[[0.6093, 0.4931], [0.6093, 0.4931]], [[0.3908, 0.507], [0.3908, 0.507]]]]

Expected: [[[[0.6093, 0.4931]], [[0.3908, 0.507]]]]