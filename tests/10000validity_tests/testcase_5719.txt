import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min62350 = tf.keras.layers.Input(shape=([2, 2]))
in1Min62350 = tf.keras.layers.Input(shape=([2, 2]))
in0Max52238 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max52238 = tf.keras.layers.Input(shape=([2, 1, 1]))

Min62350 = keras.layers.Minimum(name = 'Min62350', )([in0Min62350,in1Min62350])
ReL46689 = keras.layers.ReLU(max_value=9.02709388567402, negative_slope=8.342243590981537, threshold=8.45966856772668, name = 'ReL46689', )(Min62350)
Res73853 = keras.layers.Reshape((2, 2, 1), name = 'Res73853', )(ReL46689)
Max52238 = keras.layers.Maximum(name = 'Max52238', )([in0Max52238,in1Max52238])
Zer15063 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer15063', )(Max52238)
Min67272 = keras.layers.Minimum(name = 'Min67272', )([Res73853,Zer15063])
model = tf.keras.models.Model(inputs=[in0Min62350,in1Min62350,in0Max52238,in1Max52238], outputs=Min67272)
in0Min62350 = tf.constant([[[0.5866, 0.5287], [0.2077, 0.3566]]])
in1Min62350 = tf.constant([[[0.2224, 0.5359], [0.0886, 0.2898]]])
in0Max52238 = tf.constant([[[[0.8339]], [[0.7035]]]])
in1Max52238 = tf.constant([[[[0.6758]], [[0.5967]]]])
print (np.array2string(model.predict([in0Min62350,in1Min62350,in0Max52238,in1Max52238],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min67272.png')

LMin62350 = minimum_layer([[[[0.5866, 0.5287], [0.2077, 0.3566]]], [[[0.2224, 0.5359], [0.0886, 0.2898]]]], Min62350), 
LReL46689 = relu_layer(Min62350, 9.02709388567402, 8.342243590981537, 8.45966856772668, ReL46689), 
LRes73853 = reshape_layer(ReL46689, [2, 2, 1], Res73853), 
LMax52238 = maximum_layer([[[[[0.8339]], [[0.7035]]]], [[[[0.6758]], [[0.5967]]]]], Max52238), 
LZer15063 = zero_padding2D_layer(Max52238, 0, 0, 1, 0, Zer15063), 
LMin67272 = minimum_layer([Res73853,Zer15063], Min67272), 
exec_layers([LMin62350,LReL46689,LRes73853,LMax52238,LZer15063,LMin67272],["Min62350","ReL46689","Res73853","Max52238","Zer15063","Min67272"],Min67272,"Min67272")

Actual (Unparsed): [[[[-68.7173010], [-66.1620718]], [[-69.8334931], [-68.1550338]]]]

Expected (Unparsed): [[[[-68.71730091631157],[-66.16207170439392]],[[-69.83349310878491],[-68.15503369827942]]]]

Actual:   [[[[-68.7173], [-66.162]], [[-69.8334], [-68.155]]]]

Expected: [[[[-68.7173], [-66.162]], [[-69.8334], [-68.155]]]]