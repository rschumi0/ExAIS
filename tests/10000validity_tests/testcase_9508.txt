import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max47253 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max47253 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con71008 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Sof42464 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con5191 = tf.keras.layers.Input(shape=([2, 3, 2, 1]))
in0Add88929 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Add88929 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Max47253 = keras.layers.Maximum(name = 'Max47253', )([in0Max47253,in1Max47253])
Zer54005 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer54005', )(Max47253)
Con71008 = keras.layers.Concatenate(axis=3, name = 'Con71008', )([Zer54005,in0Con71008])
Sof42464 = keras.layers.Softmax(axis=1, name = 'Sof42464', input_shape=(1, 2, 2))(in0Sof42464)
ELU7281 = keras.layers.ELU(alpha=-0.038413399023228934, name = 'ELU7281', )(Sof42464)
Zer86549 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer86549', )(ELU7281)
Min43754 = keras.layers.Minimum(name = 'Min43754', )([Con71008,Zer86549])
Res67627 = keras.layers.Reshape((2, 3, 2, 1), name = 'Res67627', )(Min43754)
Con5191 = keras.layers.Concatenate(axis=4, name = 'Con5191', )([Res67627,in0Con5191])
Add88929 = keras.layers.Add(name = 'Add88929', )([in0Add88929,in1Add88929])
ReL37731 = keras.layers.ReLU(max_value=3.0779654524765316, negative_slope=3.915128136298888, threshold=8.682964524483506, name = 'ReL37731', )(Add88929)
Zer76996 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer76996', )(ReL37731)
Add78321 = keras.layers.Add(name = 'Add78321', )([Con5191,Zer76996])
model = tf.keras.models.Model(inputs=[in0Max47253,in1Max47253,in0Con71008,in0Sof42464,in0Con5191,in0Add88929,in1Add88929], outputs=Add78321)
in0Max47253 = tf.constant([[[[0.5736]], [[0.259]]]])
in1Max47253 = tf.constant([[[[0.2587]], [[0.5415]]]])
in0Con71008 = tf.constant([[[[0.9214], [0.8145], [0.5355]], [[0.8638], [0.1684], [0.3403]]]])
in0Sof42464 = tf.constant([[[[0.1895, 0.987], [0.6413, 0.817]]]])
in0Con5191 = tf.constant([[[[[0.7138], [0.5409]], [[0.312], [0.9038]], [[0.4117], [0.8319]]], [[[0.3868], [0.6633]], [[0.2372], [0.9697]], [[0.1874], [0.0081]]]]])
in0Add88929 = tf.constant([[[[[0.327, 0.4013], [0.5772, 0.0302]], [[0.0075, 0.8288], [0.9909, 0.1381]]]]])
in1Add88929 = tf.constant([[[[[0.6446, 0.4712], [0.2242, 0.6015]], [[0.8402, 0.3866], [0.9041, 0.2187]]]]])
print (np.array2string(model.predict([in0Max47253,in1Max47253,in0Con71008,in0Sof42464,in0Con5191,in0Add88929,in1Add88929],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add78321.png')

LMax47253 = maximum_layer([[[[[0.5736]], [[0.259]]]], [[[[0.2587]], [[0.5415]]]]], Max47253), 
LZer54005 = zero_padding2D_layer(Max47253, 0, 0, 2, 0, Zer54005), 
LCon71008 = concatenate_layer([Zer54005,[[[[0.9214], [0.8145], [0.5355]], [[0.8638], [0.1684], [0.3403]]]]], 3, Con71008), 
LSof42464 = softmax_layer([[[[0.1895, 0.987], [0.6413, 0.817]]]], 1, Sof42464), 
LELU7281 = elu_layer(Sof42464, -0.038413399023228934, ELU7281), 
LZer86549 = zero_padding2D_layer(ELU7281, 1, 0, 1, 0, Zer86549), 
LMin43754 = minimum_layer([Con71008,Zer86549], Min43754), 
LRes67627 = reshape_layer(Min43754, [2, 3, 2, 1], Res67627), 
LCon5191 = concatenate_layer([Res67627,[[[[[0.7138], [0.5409]], [[0.312], [0.9038]], [[0.4117], [0.8319]]], [[[0.3868], [0.6633]], [[0.2372], [0.9697]], [[0.1874], [0.0081]]]]]], 4, Con5191), 
LAdd88929 = add_layer([[[[[[0.327, 0.4013], [0.5772, 0.0302]], [[0.0075, 0.8288], [0.9909, 0.1381]]]]], [[[[[0.6446, 0.4712], [0.2242, 0.6015]], [[0.8402, 0.3866], [0.9041, 0.2187]]]]]], Add88929), 
LReL37731 = relu_layer(Add88929, 3.0779654524765316, 3.915128136298888, 8.682964524483506, ReL37731), 
LZer76996 = zero_padding3D_layer(ReL37731, 1, 0, 1, 0, 0, 0, Zer76996), 
LAdd78321 = add_layer([Con5191,Zer76996], Add78321), 
exec_layers([LMax47253,LZer54005,LCon71008,LSof42464,LELU7281,LZer86549,LMin43754,LRes67627,LCon5191,LAdd88929,LReL37731,LZer76996,LAdd78321],["Max47253","Zer54005","Con71008","Sof42464","ELU7281","Zer86549","Min43754","Res67627","Con5191","Add88929","ReL37731","Zer76996","Add78321"],Add78321,"Add78321")

Actual (Unparsed): [[[[[0.0000000, 0.7138000], [0.0000000, 0.5409000]], [[0.0000000, 0.3120000], [0.0000000, 0.9038000]], [[0.0000000, 0.4117000], [0.0000000, 0.8319000]]], [[[0.0000000, 0.3868000], [0.0000000, 0.6633000]], [[-30.1909804, -30.3417694], [-30.6889351, -30.5520324]], [[-30.1345646, -29.0490719], [-26.2354510, -32.5899010]]]]]

Expected (Unparsed): [[[[[0,0.7138],[0,0.5409]],[[0,0.312],[0,0.9038]],[[0,0.4117],[0,0.8319]]],[[[0,0.3868],[0,0.6633]],[[-30.190980219062464,-30.341769417369683],[-30.688935027860538,-30.552032272590456]],[[-30.134564595149897,-29.049071979432796],[-26.23545089800407,-32.58990099725902]]]]]

Actual:   [[[[[0, 0.7138], [0, 0.5409]], [[0, 0.312], [0, 0.9038]], [[0, 0.4117], [0, 0.8319]]], [[[0, 0.3868], [0, 0.6633]], [[-30.1909, -30.3417], [-30.6889, -30.552]], [[-30.1345, -29.049], [-26.2354, -32.5899]]]]]

Expected: [[[[[0, 0.7138], [0, 0.5409]], [[0, 0.312], [0, 0.9038]], [[0, 0.4117], [0, 0.8319]]], [[[0, 0.3868], [0, 0.6633]], [[-30.1909, -30.3417], [-30.6889, -30.552]], [[-30.1345, -29.049], [-26.2354, -32.5899]]]]]