import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave96634 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Ave96634 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con99181 = tf.keras.layers.Input(shape=([3, 2]))
in0Sub23098 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub23098 = tf.keras.layers.Input(shape=([3, 3]))

Ave96634 = keras.layers.Average(name = 'Ave96634', )([in0Ave96634,in1Ave96634])
Res92636 = keras.layers.Reshape((2, 2, 1), name = 'Res92636', )(Ave96634)
Dep2065 = keras.layers.DepthwiseConv2D((1, 2),strides=(2, 2), padding='same', name = 'Dep2065', )(Res92636)
Res34001 = keras.layers.Reshape((1, 1), name = 'Res34001', )(Dep2065)
Zer51295 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer51295', )(Res34001)
Con99181 = keras.layers.Concatenate(axis=2, name = 'Con99181', )([Zer51295,in0Con99181])
Sub23098 = keras.layers.Subtract(name = 'Sub23098', )([in0Sub23098,in1Sub23098])
Cro45789 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro45789', )(Sub23098)
Min27084 = keras.layers.Minimum(name = 'Min27084', )([Con99181,Cro45789])
model = tf.keras.models.Model(inputs=[in0Ave96634,in1Ave96634,in0Con99181,in0Sub23098,in1Sub23098], outputs=Min27084)
w = model.get_layer('Dep2065').get_weights() 
w[0] = np.array([[[[0.529]], [[0.4046]]]])
w[1] = np.array([0])
model.get_layer('Dep2065').set_weights(w) 
in0Ave96634 = tf.constant([[[[[0.8246]], [[0.1889]]], [[[0.8782]], [[0.5543]]]]])
in1Ave96634 = tf.constant([[[[[0.7846]], [[0.95]]], [[[0.8681]], [[0.7805]]]]])
in0Con99181 = tf.constant([[[0.6766, 0.6811], [0.7585, 0.313], [0.434, 0.9829]]])
in0Sub23098 = tf.constant([[[0.1067, 0.223, 0.525], [0.6, 0.2314, 0.8839], [0.1426, 0.5226, 0.7823]]])
in1Sub23098 = tf.constant([[[0.9373, 0.8104, 0.8176], [0.3066, 0.7814, 0.0523], [0.8427, 0.7121, 0.1533]]])
print (np.array2string(model.predict([in0Ave96634,in1Ave96634,in0Con99181,in0Sub23098,in1Sub23098],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min27084.png')

LAve96634 = average_layer([[[[[[0.8246]], [[0.1889]]], [[[0.8782]], [[0.5543]]]]], [[[[[0.7846]], [[0.95]]], [[[0.8681]], [[0.7805]]]]]], Ave96634), 
LRes92636 = reshape_layer(Ave96634, [2, 2, 1], Res92636), 
LDep2065 = depthwise_conv2D_layer(Res92636, 1, 2,[[[[0.529]], [[0.4046]]]],[0], 2, 2, true, Dep2065), 
LRes34001 = reshape_layer(Dep2065, [1, 1], Res34001), 
LZer51295 = zero_padding1D_layer(Res34001, 2, 0, Zer51295), 
LCon99181 = concatenate_layer([Zer51295,[[[0.6766, 0.6811], [0.7585, 0.313], [0.434, 0.9829]]]], 2, Con99181), 
LSub23098 = subtract_layer([[[0.1067, 0.223, 0.525], [0.6, 0.2314, 0.8839], [0.1426, 0.5226, 0.7823]]], [[[0.9373, 0.8104, 0.8176], [0.3066, 0.7814, 0.0523], [0.8427, 0.7121, 0.1533]]], Sub23098), 
LCro45789 = cropping1D_layer(Sub23098, 0, 0, Cro45789), 
LMin27084 = minimum_layer([Con99181,Cro45789], Min27084), 
exec_layers([LAve96634,LRes92636,LDep2065,LRes34001,LZer51295,LCon99181,LSub23098,LCro45789,LMin27084],["Ave96634","Res92636","Dep2065","Res34001","Zer51295","Con99181","Sub23098","Cro45789","Min27084"],Min27084,"Min27084")

Actual (Unparsed): [[[-0.8306000, -0.5874000, -0.2926000], [0.0000000, -0.5500000, 0.3130000], [-0.7001000, -0.1895000, 0.6290000]]]

Expected (Unparsed): [[[-0.8306,-0.5874,-0.29259999999999997],[0,-0.55,0.313],[-0.7001,-0.1895,0.629]]]

Actual:   [[[-0.8306, -0.5874, -0.2926], [0, -0.55, 0.313], [-0.7001, -0.1895, 0.629]]]

Expected: [[[-0.8306, -0.5874, -0.2925], [0, -0.55, 0.313], [-0.7001, -0.1895, 0.629]]]