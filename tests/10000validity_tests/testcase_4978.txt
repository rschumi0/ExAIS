import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min87436 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Min87436 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con39773 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Sep11496 = tf.keras.layers.Input(shape=([2, 2, 2]))

Min87436 = keras.layers.Minimum(name = 'Min87436', )([in0Min87436,in1Min87436])
Res39238 = keras.layers.Reshape((1, 1, 1), name = 'Res39238', )(Min87436)
Con39773 = keras.layers.Concatenate(axis=3, name = 'Con39773', )([Res39238,in0Con39773])
Sep11496 = keras.layers.SeparableConv2D(2, (1, 2),strides=(2, 2), padding='valid', name = 'Sep11496', )(in0Sep11496)
Min99883 = keras.layers.Minimum(name = 'Min99883', )([Con39773,Sep11496])
Res16053 = keras.layers.Reshape((1, 2), name = 'Res16053', )(Min99883)
Glo94297 = keras.layers.GlobalAveragePooling1D(name = 'Glo94297', )(Res16053)
Res1006 = keras.layers.Reshape((2, 1), name = 'Res1006', )(Glo94297)
Glo93335 = keras.layers.GlobalMaxPool1D(name = 'Glo93335', )(Res1006)
model = tf.keras.models.Model(inputs=[in0Min87436,in1Min87436,in0Con39773,in0Sep11496], outputs=Glo93335)
w = model.get_layer('Sep11496').get_weights() 
w[0] = np.array([[[[0.6304], [0.8742]], [[0.7556], [0.7483]]]])
w[1] = np.array([[[[0.4231, 0.616], [0.7811, 0.8735]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep11496').set_weights(w) 
in0Min87436 = tf.constant([[[[[0.0156]]]]])
in1Min87436 = tf.constant([[[[[0.6419]]]]])
in0Con39773 = tf.constant([[[[0.239]]]])
in0Sep11496 = tf.constant([[[[0.2213, 0.1042], [0.0882, 0.2413]], [[0.8921, 0.9909], [0.222, 0.5067]]]])
print (np.array2string(model.predict([in0Min87436,in1Min87436,in0Con39773,in0Sep11496],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo93335.png')

LMin87436 = minimum_layer([[[[[[0.0156]]]]], [[[[[0.6419]]]]]], Min87436), 
LRes39238 = reshape_layer(Min87436, [1, 1, 1], Res39238), 
LCon39773 = concatenate_layer([Res39238,[[[[0.239]]]]], 3, Con39773), 
LSep11496 = separable_conv2D_layer([[[[0.2213, 0.1042], [0.0882, 0.2413]], [[0.8921, 0.9909], [0.222, 0.5067]]]], 1, 2,[[[[[0.6304], [0.8742]], [[0.7556], [0.7483]]]],[[[[0.4231, 0.616], [0.7811, 0.8735]]]]],[0, 0], 2, 2, false, Sep11496), 
LMin99883 = minimum_layer([Con39773,Sep11496], Min99883), 
LRes16053 = reshape_layer(Min99883, [1, 2], Res16053), 
LGlo94297 = global_average_pooling1D_layer(Res16053, Glo94297), 
LRes1006 = reshape_layer(Glo94297, [2, 1], Res1006), 
LGlo93335 = global_max_pool1D_layer(Res1006, Glo93335), 
exec_layers([LMin87436,LRes39238,LCon39773,LSep11496,LMin99883,LRes16053,LGlo94297,LRes1006,LGlo93335],["Min87436","Res39238","Con39773","Sep11496","Min99883","Res16053","Glo94297","Res1006","Glo93335"],Glo93335,"Glo93335")

Actual (Unparsed): [[0.2390000]]

Expected (Unparsed): [[0.239]]

Actual:   [[0.239]]

Expected: [[0.239]]