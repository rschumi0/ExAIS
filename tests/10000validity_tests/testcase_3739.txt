import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub66974 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in1Sub66974 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in0Con10640 = tf.keras.layers.Input(shape=([2, 2]))
in0Cro39623 = tf.keras.layers.Input(shape=([2, 4]))

Sub66974 = keras.layers.Subtract(name = 'Sub66974', )([in0Sub66974,in1Sub66974])
Res92734 = keras.layers.Reshape((2, 2, 6), name = 'Res92734', )(Sub66974)
Dep17739 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='valid', name = 'Dep17739', )(Res92734)
Con47710 = keras.layers.Conv2D(2, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con47710', )(Dep17739)
Res48888 = keras.layers.Reshape((1, 2), name = 'Res48888', )(Con47710)
Zer982 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer982', )(Res48888)
Con10640 = keras.layers.Concatenate(axis=2, name = 'Con10640', )([Zer982,in0Con10640])
Cro39623 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro39623', )(in0Cro39623)
Min16413 = keras.layers.Minimum(name = 'Min16413', )([Con10640,Cro39623])
Con35238 = keras.layers.Conv1D(3, (2),strides=(8), padding='same', dilation_rate=(1), name = 'Con35238', )(Min16413)
model = tf.keras.models.Model(inputs=[in0Sub66974,in1Sub66974,in0Con10640,in0Cro39623], outputs=Con35238)
w = model.get_layer('Dep17739').get_weights() 
w[0] = np.array([[[[0.1855], [0.5573], [0.6424], [0.7431], [0.875], [0.5484]]], [[[0.1017], [0.6411], [0.8312], [0.0049], [0.0285], [0.4731]]]])
w[1] = np.array([0, 0, 0, 0, 0, 0])
model.get_layer('Dep17739').set_weights(w) 
w = model.get_layer('Con47710').get_weights() 
w[0] = np.array([[[[0.9117, 0.8899], [0.7537, 0.4425], [0.6262, 0.1495], [0.1315, 0.7667], [0.3695, 0.8186], [0.5398, 0.846]], [[0.8283, 0.8499], [0.6635, 0.6253], [0.1082, 0.3], [0.3821, 0.4026], [0.989, 0.5938], [0.3669, 0.8927]]]])
w[1] = np.array([0, 0])
model.get_layer('Con47710').set_weights(w) 
w = model.get_layer('Con35238').get_weights() 
w[0] = np.array([[[0.816, 0.9407, 0.2283], [0.8976, 0.2672, 0.1058], [0.4007, 0.3536, 0.89], [0.7603, 0.3523, 0.3524]], [[0.7899, 0.9845, 0.8684], [0.8814, 0.2601, 0.5534], [0.0652, 0.9114, 0.3282], [0.9405, 0.1356, 0.7991]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con35238').set_weights(w) 
in0Sub66974 = tf.constant([[[[[0.4973, 0.1629], [0.131, 0.7838], [0.9156, 0.4749]], [[0.1477, 0.4221], [0.4091, 0.1876], [0.4508, 0.7325]]], [[[0.3864, 0.4398], [0.8134, 0.3301], [0.642, 0.282]], [[0.3662, 0.0829], [0.099, 0.6831], [0.6748, 0.3287]]]]])
in1Sub66974 = tf.constant([[[[[0.4924, 0.8665], [0.9572, 0.5659], [0.5248, 0.2571]], [[0.5365, 0.4696], [0.567, 0.9394], [0.6218, 0.28]]], [[[0.6784, 0.5445], [0.1602, 0.7062], [0.5771, 0.9126]], [[0.8181, 0.4946], [0.2033, 0.7083], [0.1087, 0.7207]]]]])
in0Con10640 = tf.constant([[[0.3356, 0.3377], [0.6377, 0.2926]]])
in0Cro39623 = tf.constant([[[1.6886, 1.4078, 1.3121, 1.6841], [1.8669, 1.7206, 1.1063, 1.0049]]])
print (np.array2string(model.predict([in0Sub66974,in1Sub66974,in0Con10640,in0Cro39623],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con35238.png')

LSub66974 = subtract_layer([[[[[0.4973, 0.1629], [0.131, 0.7838], [0.9156, 0.4749]], [[0.1477, 0.4221], [0.4091, 0.1876], [0.4508, 0.7325]]], [[[0.3864, 0.4398], [0.8134, 0.3301], [0.642, 0.282]], [[0.3662, 0.0829], [0.099, 0.6831], [0.6748, 0.3287]]]]], [[[[[0.4924, 0.8665], [0.9572, 0.5659], [0.5248, 0.2571]], [[0.5365, 0.4696], [0.567, 0.9394], [0.6218, 0.28]]], [[[0.6784, 0.5445], [0.1602, 0.7062], [0.5771, 0.9126]], [[0.8181, 0.4946], [0.2033, 0.7083], [0.1087, 0.7207]]]]], Sub66974), 
LRes92734 = reshape_layer(Sub66974, [2, 2, 6], Res92734), 
LDep17739 = depthwise_conv2D_layer(Res92734, 2, 1,[[[[0.1855], [0.5573], [0.6424], [0.7431], [0.875], [0.5484]]], [[[0.1017], [0.6411], [0.8312], [0.0049], [0.0285], [0.4731]]]],[0, 0, 0, 0, 0, 0], 1, 1, false, Dep17739), 
LCon47710 = conv2D_layer(Dep17739, 1, 2,[[[[0.9117, 0.8899], [0.7537, 0.4425], [0.6262, 0.1495], [0.1315, 0.7667], [0.3695, 0.8186], [0.5398, 0.846]], [[0.8283, 0.8499], [0.6635, 0.6253], [0.1082, 0.3], [0.3821, 0.4026], [0.989, 0.5938], [0.3669, 0.8927]]]],[0, 0], 1, 1, false, 1, 1, Con47710), 
LRes48888 = reshape_layer(Con47710, [1, 2], Res48888), 
LZer982 = zero_padding1D_layer(Res48888, 1, 0, Zer982), 
LCon10640 = concatenate_layer([Zer982,[[[0.3356, 0.3377], [0.6377, 0.2926]]]], 2, Con10640), 
LCro39623 = cropping1D_layer([[[1.6886, 1.4078, 1.3121, 1.6841], [1.8669, 1.7206, 1.1063, 1.0049]]], 0, 0, Cro39623), 
LMin16413 = minimum_layer([Con10640,Cro39623], Min16413), 
LCon35238 = conv1D_layer(Min16413, 2,[[[0.816, 0.9407, 0.2283], [0.8976, 0.2672, 0.1058], [0.4007, 0.3536, 0.89], [0.7603, 0.3523, 0.3524]], [[0.7899, 0.9845, 0.8684], [0.8814, 0.2601, 0.5534], [0.0652, 0.9114, 0.3282], [0.9405, 0.1356, 0.7991]]],[0, 0, 0], 8, true, 1, Con35238), 
exec_layers([LSub66974,LRes92734,LDep17739,LCon47710,LRes48888,LZer982,LCon10640,LCro39623,LMin16413,LCon35238],["Sub66974","Res92734","Dep17739","Con47710","Res48888","Zer982","Con10640","Cro39623","Min16413","Con35238"],Con35238,"Con35238")

Actual (Unparsed): [[[-0.5340566, -0.2192942, -0.2716057]]]

Expected (Unparsed): [[[-0.5340566240814232,-0.21929425971280095,-0.2716056875764201]]]

Actual:   [[[-0.534, -0.2192, -0.2716]]]

Expected: [[[-0.534, -0.2192, -0.2716]]]