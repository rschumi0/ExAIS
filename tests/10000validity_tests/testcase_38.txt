import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave14214 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave14214 = tf.keras.layers.Input(shape=([1, 1]))
in0Con68065 = tf.keras.layers.Input(shape=([1, 1]))
in0Add22477 = tf.keras.layers.Input(shape=([2, 2]))
in1Add22477 = tf.keras.layers.Input(shape=([2, 2]))

Ave14214 = keras.layers.Average(name = 'Ave14214', )([in0Ave14214,in1Ave14214])
Con68065 = keras.layers.Concatenate(axis=2, name = 'Con68065', )([Ave14214,in0Con68065])
Add22477 = keras.layers.Add(name = 'Add22477', )([in0Add22477,in1Add22477])
Dot48440 = keras.layers.Dot(axes=(2, 2), name = 'Dot48440', )([Con68065,Add22477])
Res54572 = keras.layers.Reshape((1, 2, 1), name = 'Res54572', )(Dot48440)
Glo9197 = keras.layers.GlobalMaxPool2D(name = 'Glo9197', )(Res54572)
model = tf.keras.models.Model(inputs=[in0Ave14214,in1Ave14214,in0Con68065,in0Add22477,in1Add22477], outputs=Glo9197)
in0Ave14214 = tf.constant([[[0.3754]]])
in1Ave14214 = tf.constant([[[0.4354]]])
in0Con68065 = tf.constant([[[0.0844]]])
in0Add22477 = tf.constant([[[0.5494, 0.4019], [0.5344, 0.9519]]])
in1Add22477 = tf.constant([[[0.7265, 0.164], [0.7886, 0.7858]]])
print (np.array2string(model.predict([in0Ave14214,in1Ave14214,in0Con68065,in0Add22477,in1Add22477],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo9197.png')

LAve14214 = average_layer([[[[0.3754]]], [[[0.4354]]]], Ave14214), 
LCon68065 = concatenate_layer([Ave14214,[[[0.0844]]]], 2, Con68065), 
LAdd22477 = add_layer([[[[0.5494, 0.4019], [0.5344, 0.9519]]], [[[0.7265, 0.164], [0.7886, 0.7858]]]], Add22477), 
LDot48440 = dot_layer(Con68065,Add22477, 2, 2, Dot48440), 
LRes54572 = reshape_layer(Dot48440, [1, 2, 1], Res54572), 
LGlo9197 = global_max_pool2D_layer(Res54572, Glo9197), 
exec_layers([LAve14214,LCon68065,LAdd22477,LDot48440,LRes54572,LGlo9197],["Ave14214","Con68065","Add22477","Dot48440","Res54572","Glo9197"],Glo9197,"Glo9197")

Actual (Unparsed): [[0.6830061]]

Expected (Unparsed): [[0.68300608]]

Actual:   [[0.6831]]

Expected: [[0.6831]]