import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe11237 = tf.keras.layers.Input(shape=([1, 2]))
in0Glo75417 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Glo71488 = tf.keras.layers.Input(shape=([2, 1]))
in0Con43037 = tf.keras.layers.Input(shape=([1]))

PRe11237 = keras.layers.PReLU(name = 'PRe11237', input_shape=(1, 2))(in0PRe11237)
Zer38838 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer38838', )(PRe11237)
Ave36264 = keras.layers.AveragePooling1D(pool_size=(2), name = 'Ave36264', )(Zer38838)
Per34458 = keras.layers.Permute((1,2), name = 'Per34458',)(Ave36264)
Res4326 = keras.layers.Reshape((1, 2, 1), name = 'Res4326', )(Per34458)
Glo75417 = keras.layers.GlobalAveragePooling3D(name = 'Glo75417', )(in0Glo75417)
Glo71488 = keras.layers.GlobalMaxPool1D(name = 'Glo71488', )(in0Glo71488)
Con43037 = keras.layers.Concatenate(axis=1, name = 'Con43037', )([Glo71488,in0Con43037])
Sub20439 = keras.layers.Subtract(name = 'Sub20439', )([Glo75417,Con43037])
Res40292 = keras.layers.Reshape((2, 1), name = 'Res40292', )(Sub20439)
Res76061 = keras.layers.Reshape((2, 1, 1), name = 'Res76061', )(Res40292)
Max2023 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max2023', )(Res76061)
Zer84322 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer84322', )(Max2023)
Sub9705 = keras.layers.Subtract(name = 'Sub9705', )([Res4326,Zer84322])
model = tf.keras.models.Model(inputs=[in0PRe11237,in0Glo75417,in0Glo71488,in0Con43037], outputs=Sub9705)
w = model.get_layer('PRe11237').get_weights() 
w[0] = np.array([[0.7668, 0.9672]])
model.get_layer('PRe11237').set_weights(w) 
in0PRe11237 = tf.constant([[[0.9113, 0.0427]]])
in0Glo75417 = tf.constant([[[[[1.949, 1.2154]]]]])
in0Glo71488 = tf.constant([[[1.5819], [1.0409]]])
in0Con43037 = tf.constant([[0.9561]])
print (np.array2string(model.predict([in0PRe11237,in0Glo75417,in0Glo71488,in0Con43037],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub9705.png')

LPRe11237 = prelu_layer([[[0.9113, 0.0427]]], [[0.7668, 0.9672]], PRe11237), 
LZer38838 = zero_padding1D_layer(PRe11237, 1, 1, Zer38838), 
LAve36264 = average_pooling1D_layer(Zer38838, 2, Ave36264), 
LPer34458 = permute_layer(Ave36264, 1,2, Per34458), 
LRes4326 = reshape_layer(Per34458, [1, 2, 1], Res4326), 
LGlo75417 = global_average_pooling3D_layer([[[[[1.949, 1.2154]]]]], Glo75417), 
LGlo71488 = global_max_pool1D_layer([[[1.5819], [1.0409]]], Glo71488), 
LCon43037 = concatenate_layer([Glo71488,[[0.9561]]], 1, Con43037), 
LSub20439 = subtract_layer(Glo75417,Con43037, Sub20439), 
LRes40292 = reshape_layer(Sub20439, [2, 1], Res40292), 
LRes76061 = reshape_layer(Res40292, [2, 1, 1], Res76061), 
LMax2023 = max_pool2D_layer(Res76061, 2, 1, Max2023), 
LZer84322 = zero_padding2D_layer(Max2023, 0, 0, 1, 0, Zer84322), 
LSub9705 = subtract_layer(Res4326,Zer84322, Sub9705), 
exec_layers([LPRe11237,LZer38838,LAve36264,LPer34458,LRes4326,LGlo75417,LGlo71488,LCon43037,LSub20439,LRes40292,LRes76061,LMax2023,LZer84322,LSub9705],["PRe11237","Zer38838","Ave36264","Per34458","Res4326","Glo75417","Glo71488","Con43037","Sub20439","Res40292","Res76061","Max2023","Zer84322","Sub9705"],Sub9705,"Sub9705")

Actual (Unparsed): [[[[0.4556500], [-0.3457500]]]]

Expected (Unparsed): [[[[0.45565],[-0.34575]]]]

Actual:   [[[[0.4557], [-0.3457]]]]

Expected: [[[[0.4557], [-0.3457]]]]