import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub82430 = tf.keras.layers.Input(shape=([3, 3, 2]))
in1Sub82430 = tf.keras.layers.Input(shape=([3, 3, 2]))
in0Con39540 = tf.keras.layers.Input(shape=([3, 3, 2, 1]))
in0Max37456 = tf.keras.layers.Input(shape=([2, 1]))
in1Max37456 = tf.keras.layers.Input(shape=([2, 1]))
in0Con40094 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Mul29010 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Mul29010 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Sub82430 = keras.layers.Subtract(name = 'Sub82430', )([in0Sub82430,in1Sub82430])
Res52398 = keras.layers.Reshape((3, 3, 2, 1), name = 'Res52398', )(Sub82430)
Con39540 = keras.layers.Concatenate(axis=4, name = 'Con39540', )([Res52398,in0Con39540])
Max37456 = keras.layers.Maximum(name = 'Max37456', )([in0Max37456,in1Max37456])
Res21095 = keras.layers.Reshape((2, 1, 1), name = 'Res21095', )(Max37456)
Res72740 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res72740', )(Res21095)
Zer52892 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer52892', )(Res72740)
Con40094 = keras.layers.Concatenate(axis=4, name = 'Con40094', )([Zer52892,in0Con40094])
Mul29010 = keras.layers.Multiply(name = 'Mul29010', )([in0Mul29010,in1Mul29010])
Sub26347 = keras.layers.Subtract(name = 'Sub26347', )([Con40094,Mul29010])
Zer74000 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer74000', )(Sub26347)
Min99511 = keras.layers.Minimum(name = 'Min99511', )([Con39540,Zer74000])
Res20456 = keras.layers.Reshape((3, 3, 4), name = 'Res20456', )(Min99511)
Zer22046 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer22046', )(Res20456)
model = tf.keras.models.Model(inputs=[in0Sub82430,in1Sub82430,in0Con39540,in0Max37456,in1Max37456,in0Con40094,in0Mul29010,in1Mul29010], outputs=Zer22046)
in0Sub82430 = tf.constant([[[[0.2853, 0.2418], [0.7991, 0.7741], [0.6216, 0.6598]], [[0.4234, 0.3502], [0.7596, 0.1141], [0.548, 0.0871]], [[0.9597, 0.4069], [0.2086, 0.6232], [0.6216, 0.0267]]]])
in1Sub82430 = tf.constant([[[[0.6932, 0.3739], [0.2946, 0.9486], [0.6635, 0.9984]], [[0.4908, 0.3713], [0.2373, 0.9247], [0.5156, 0.8247]], [[0.8908, 0.755], [0.0823, 0.9295], [0.2413, 0.4834]]]])
in0Con39540 = tf.constant([[[[[0.1808], [0.2559]], [[0.3117], [0.7579]], [[0.049], [0.2396]]], [[[0.7955], [0.0756]], [[0.2782], [0.6534]], [[0.1285], [0.2786]]], [[[0.0592], [0.499]], [[0.8077], [0.1112]], [[0.6964], [0.7856]]]]])
in0Max37456 = tf.constant([[[0.5676], [0.7128]]])
in1Max37456 = tf.constant([[[0.9946], [0.8504]]])
in0Con40094 = tf.constant([[[[[0.3771]], [[0.8456]]], [[[0.4451]], [[0.0542]]]]])
in0Mul29010 = tf.constant([[[[[0.3803, 0.7928]], [[0.602, 0.8308]]], [[[0.0681, 0.9347]], [[0.462, 0.2062]]]]])
in1Mul29010 = tf.constant([[[[[0.4647, 0.4476]], [[0.8209, 0.4084]]], [[[0.3932, 0.6449]], [[0.8829, 0.3355]]]]])
print (np.array2string(model.predict([in0Sub82430,in1Sub82430,in0Con39540,in0Max37456,in1Max37456,in0Con40094,in0Mul29010,in1Mul29010],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer22046.png')

LSub82430 = subtract_layer([[[[0.2853, 0.2418], [0.7991, 0.7741], [0.6216, 0.6598]], [[0.4234, 0.3502], [0.7596, 0.1141], [0.548, 0.0871]], [[0.9597, 0.4069], [0.2086, 0.6232], [0.6216, 0.0267]]]], [[[[0.6932, 0.3739], [0.2946, 0.9486], [0.6635, 0.9984]], [[0.4908, 0.3713], [0.2373, 0.9247], [0.5156, 0.8247]], [[0.8908, 0.755], [0.0823, 0.9295], [0.2413, 0.4834]]]], Sub82430), 
LRes52398 = reshape_layer(Sub82430, [3, 3, 2, 1], Res52398), 
LCon39540 = concatenate_layer([Res52398,[[[[[0.1808], [0.2559]], [[0.3117], [0.7579]], [[0.049], [0.2396]]], [[[0.7955], [0.0756]], [[0.2782], [0.6534]], [[0.1285], [0.2786]]], [[[0.0592], [0.499]], [[0.8077], [0.1112]], [[0.6964], [0.7856]]]]]], 4, Con39540), 
LMax37456 = maximum_layer([[[[0.5676], [0.7128]]], [[[0.9946], [0.8504]]]], Max37456), 
LRes21095 = reshape_layer(Max37456, [2, 1, 1], Res21095), 
LRes72740 = reshape_layer(Res21095, [2, 1, 1, 1], Res72740), 
LZer52892 = zero_padding3D_layer(Res72740, 0, 0, 1, 0, 0, 0, Zer52892), 
LCon40094 = concatenate_layer([Zer52892,[[[[[0.3771]], [[0.8456]]], [[[0.4451]], [[0.0542]]]]]], 4, Con40094), 
LMul29010 = multiply_layer([[[[[[0.3803, 0.7928]], [[0.602, 0.8308]]], [[[0.0681, 0.9347]], [[0.462, 0.2062]]]]], [[[[[0.4647, 0.4476]], [[0.8209, 0.4084]]], [[[0.3932, 0.6449]], [[0.8829, 0.3355]]]]]], Mul29010), 
LSub26347 = subtract_layer(Con40094,Mul29010, Sub26347), 
LZer74000 = zero_padding3D_layer(Sub26347, 1, 0, 1, 0, 1, 0, Zer74000), 
LMin99511 = minimum_layer([Con39540,Zer74000], Min99511), 
LRes20456 = reshape_layer(Min99511, [3, 3, 4], Res20456), 
LZer22046 = zero_padding2D_layer(Res20456, 1, 1, 1, 1, Zer22046), 
exec_layers([LSub82430,LRes52398,LCon39540,LMax37456,LRes21095,LRes72740,LZer52892,LCon40094,LMul29010,LSub26347,LZer74000,LMin99511,LRes20456,LZer22046],["Sub82430","Res52398","Con39540","Max37456","Res21095","Res72740","Zer52892","Con40094","Mul29010","Sub26347","Zer74000","Min99511","Res20456","Zer22046"],Zer22046,"Zer22046")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.4079000, 0.0000000, -0.1321000, 0.0000000], [0.0000000, 0.0000000, -0.1745000, 0.0000000], [-0.0419000, 0.0000000, -0.3386000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.0674000, 0.0000000, -0.0211000, 0.0000000], [0.0000000, 0.0000000, -0.8106000, 0.0222427], [0.0000000, 0.0000000, -0.7376000, 0.2786000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, -0.3481000, 0.0000000], [0.0000000, 0.0000000, -0.3063000, -0.1576881], [0.0000000, 0.0000000, -0.4567000, -0.0149801], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[-0.40790000000000004,0,-0.13210000000000002,0],[0,0,-0.1745,0],[-0.04189999999999994,0,-0.3385999999999999,0],[0,0,0,0]],[[0,0,0,0],[-0.06740000000000002,0,-0.021100000000000008,0],[0,0,-0.8106,0.022242719999999994],[0,0,-0.7376,0.2786],[0,0,0,0]],[[0,0,0,0],[0,0,-0.3481,0],[0,0,-0.3063,-0.15768803000000003],[0,0,-0.4567,-0.01498010000000001],[0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]]]

Actual:   [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [-0.4079, 0, -0.1321, 0], [0, 0, -0.1745, 0], [-0.0419, 0, -0.3386, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [-0.0674, 0, -0.0211, 0], [0, 0, -0.8106, 0.0223], [0, 0, -0.7376, 0.2786], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, -0.3481, 0], [0, 0, -0.3063, -0.1576], [0, 0, -0.4567, -0.0149], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]]

Expected: [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [-0.4079, 0, -0.1321, 0], [0, 0, -0.1745, 0], [-0.0418, 0, -0.3385, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [-0.0674, 0, -0.0211, 0], [0, 0, -0.8106, 0.0223], [0, 0, -0.7376, 0.2786], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, -0.3481, 0], [0, 0, -0.3063, -0.1576], [0, 0, -0.4567, -0.0149], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]]