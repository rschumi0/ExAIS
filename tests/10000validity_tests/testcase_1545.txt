import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul43360 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Mul43360 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Max68355 = tf.keras.layers.Input(shape=([1, 2]))
in1Max68355 = tf.keras.layers.Input(shape=([1, 2]))
in0Con84326 = tf.keras.layers.Input(shape=([1, 1]))

Mul43360 = keras.layers.Multiply(name = 'Mul43360', )([in0Mul43360,in1Mul43360])
Res29454 = keras.layers.Reshape((2, 2, 2), name = 'Res29454', )(Mul43360)
Res43006 = keras.layers.Reshape((2, 4), name = 'Res43006', )(Res29454)
Sep90099 = keras.layers.SeparableConv1D(3, (2),strides=(2), padding='same', name = 'Sep90099', )(Res43006)
Max68355 = keras.layers.Maximum(name = 'Max68355', )([in0Max68355,in1Max68355])
Con84326 = keras.layers.Concatenate(axis=2, name = 'Con84326', )([Max68355,in0Con84326])
Max42052 = keras.layers.Maximum(name = 'Max42052', )([Sep90099,Con84326])
model = tf.keras.models.Model(inputs=[in0Mul43360,in1Mul43360,in0Max68355,in1Max68355,in0Con84326], outputs=Max42052)
w = model.get_layer('Sep90099').get_weights() 
w[0] = np.array([[[0.7827], [0.9079], [0.4098], [0.5416]], [[0.8962], [0.4407], [0.4543], [0.4768]]])
w[1] = np.array([[[0.216, 0.1515, 0.0612], [0.5302, 0.1884, 0.5059], [0.6011, 0.6792, 0.0144], [0.2361, 0.3336, 0.8075]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep90099').set_weights(w) 
in0Mul43360 = tf.constant([[[[[0.2194], [0.8815]], [[0.3637], [0.1117]]], [[[0.4455], [0.067]], [[0.908], [0.7192]]]]])
in1Mul43360 = tf.constant([[[[[0.9202], [0.6157]], [[0.6779], [0.7244]]], [[[0.9607], [0.6609]], [[0.2078], [0.192]]]]])
in0Max68355 = tf.constant([[[0.3543, 0.9567]]])
in1Max68355 = tf.constant([[[0.2983, 0.3498]]])
in0Con84326 = tf.constant([[[0.3254]]])
print (np.array2string(model.predict([in0Mul43360,in1Mul43360,in0Max68355,in1Max68355,in0Con84326],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max42052.png')

LMul43360 = multiply_layer([[[[[[0.2194], [0.8815]], [[0.3637], [0.1117]]], [[[0.4455], [0.067]], [[0.908], [0.7192]]]]], [[[[[0.9202], [0.6157]], [[0.6779], [0.7244]]], [[[0.9607], [0.6609]], [[0.2078], [0.192]]]]]], Mul43360), 
LRes29454 = reshape_layer(Mul43360, [2, 2, 2], Res29454), 
LRes43006 = reshape_layer(Res29454, [2, 4], Res43006), 
LSep90099 = separable_conv1D_layer(Res43006, 2,[[[[0.7827], [0.9079], [0.4098], [0.5416]], [[0.8962], [0.4407], [0.4543], [0.4768]]],[[[0.216, 0.1515, 0.0612], [0.5302, 0.1884, 0.5059], [0.6011, 0.6792, 0.0144], [0.2361, 0.3336, 0.8075]]]],[0, 0, 0], 2, true, Sep90099), 
LMax68355 = maximum_layer([[[[0.3543, 0.9567]]], [[[0.2983, 0.3498]]]], Max68355), 
LCon84326 = concatenate_layer([Max68355,[[[0.3254]]]], 2, Con84326), 
LMax42052 = maximum_layer([Sep90099,Con84326], Max42052), 
exec_layers([LMul43360,LRes29454,LRes43006,LSep90099,LMax68355,LCon84326,LMax42052],["Mul43360","Res29454","Res43006","Sep90099","Max68355","Con84326","Max42052"],Max42052,"Max42052")

Actual (Unparsed): [[[0.5267373, 0.9567000, 0.3835438]]]

Expected (Unparsed): [[[0.5267373458421251,0.9567,0.38354378087442537]]]

Actual:   [[[0.5268, 0.9567, 0.3836]]]

Expected: [[[0.5268, 0.9567, 0.3836]]]