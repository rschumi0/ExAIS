import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max63608 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Max63608 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Max63608 = keras.layers.Maximum(name = 'Max63608', )([in0Max63608,in1Max63608])
Res74865 = keras.layers.Reshape((2, 2, 1), name = 'Res74865', )(Max63608)
Loc85793 = keras.layers.LocallyConnected2D(2, (1, 2),strides=(1, 1), name = 'Loc85793', )(Res74865)
model = tf.keras.models.Model(inputs=[in0Max63608,in1Max63608], outputs=Loc85793)
w = model.get_layer('Loc85793').get_weights() 
w[0] = np.array([[[0.5278, 0.9773], [0.5374, 0.0089]], [[0.1315, 0.9752], [0.5411, 0.4906]]])
w[1] = np.array([[[0, 0]], [[0, 0]]])
model.get_layer('Loc85793').set_weights(w) 
in0Max63608 = tf.constant([[[[[0.4387]], [[0.4651]]], [[[0.4928]], [[0.0901]]]]])
in1Max63608 = tf.constant([[[[[0.5447]], [[0.3601]]], [[[0.5088]], [[0.6662]]]]])
print (np.array2string(model.predict([in0Max63608,in1Max63608],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc85793.png')

LMax63608 = maximum_layer([[[[[[0.4387]], [[0.4651]]], [[[0.4928]], [[0.0901]]]]], [[[[[0.5447]], [[0.3601]]], [[[0.5088]], [[0.6662]]]]]], Max63608), 
LRes74865 = reshape_layer(Max63608, [2, 2, 1], Res74865), 
LLoc85793 = locally_connected2D_layer(Res74865, 1, 2,[[[0.5278, 0.9773], [0.5374, 0.0089]], [[0.1315, 0.9752], [0.5411, 0.4906]]],[[[0, 0]], [[0, 0]]], 1, 1, Loc85793), 
exec_layers([LMax63608,LRes74865,LLoc85793],["Max63608","Res74865","Loc85793"],Loc85793,"Loc85793")

Actual (Unparsed): [[[[0.5374374, 0.5364747]], [[0.4273880, 0.8230195]]]]

Expected (Unparsed): [[[[0.5374374,0.5364746999999999]],[[0.42738802000000004,0.82301948]]]]

Actual:   [[[[0.5375, 0.5365]], [[0.4274, 0.8231]]]]

Expected: [[[[0.5375, 0.5365]], [[0.4274, 0.8231]]]]