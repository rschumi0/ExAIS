import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max45674 = tf.keras.layers.Input(shape=([2, 1]))
in1Max45674 = tf.keras.layers.Input(shape=([2, 1]))

Max45674 = keras.layers.Maximum(name = 'Max45674', )([in0Max45674,in1Max45674])
Sep34067 = keras.layers.SeparableConv1D(4, (2),strides=(1), padding='valid', name = 'Sep34067', )(Max45674)
model = tf.keras.models.Model(inputs=[in0Max45674,in1Max45674], outputs=Sep34067)
w = model.get_layer('Sep34067').get_weights() 
w[0] = np.array([[[0.3134]], [[0.0133]]])
w[1] = np.array([[[0.6094, 0.0749, 0.9345, 0.3972]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep34067').set_weights(w) 
in0Max45674 = tf.constant([[[0.5634], [0.923]]])
in1Max45674 = tf.constant([[[0.731], [0.719]]])
print (np.array2string(model.predict([in0Max45674,in1Max45674],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep34067.png')

LMax45674 = maximum_layer([[[[0.5634], [0.923]]], [[[0.731], [0.719]]]], Max45674), 
LSep34067 = separable_conv1D_layer(Max45674, 2,[[[[0.3134]], [[0.0133]]],[[[0.6094, 0.0749, 0.9345, 0.3972]]]],[0, 0, 0, 0], 1, false, Sep34067), 
exec_layers([LMax45674,LSep34067],["Max45674","Sep34067"],Sep34067,"Sep34067")

Actual (Unparsed): [[[0.1470917, 0.0180787, 0.2255615, 0.0958727]]]

Expected (Unparsed): [[[0.14709167022000003,0.01807871037,0.22556147985000002,0.09587268036]]]

Actual:   [[[0.1471, 0.0181, 0.2256, 0.0959]]]

Expected: [[[0.1471, 0.0181, 0.2256, 0.0959]]]