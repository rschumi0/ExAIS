import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot79830 = tf.keras.layers.Input(shape=([3]))
in1Dot79830 = tf.keras.layers.Input(shape=([3]))
in0Con70908 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Max92776 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max92776 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Ave82833 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave82833 = tf.keras.layers.Input(shape=([2, 2]))

Dot79830 = keras.layers.Dot(axes=(1, 1), name = 'Dot79830', )([in0Dot79830,in1Dot79830])
Bat33209 = keras.layers.BatchNormalization(axis=1, epsilon=0.6400982770586129,  name = 'Bat33209', )(Dot79830)
Res2148 = keras.layers.Reshape((1, 1), name = 'Res2148', )(Bat33209)
Res89989 = keras.layers.Reshape((1, 1, 1), name = 'Res89989', )(Res2148)
Con70908 = keras.layers.Concatenate(axis=3, name = 'Con70908', )([Res89989,in0Con70908])
Max92776 = keras.layers.Maximum(name = 'Max92776', )([in0Max92776,in1Max92776])
Ave78723 = keras.layers.Average(name = 'Ave78723', )([Con70908,Max92776])
Res10374 = keras.layers.Reshape((1, 2), name = 'Res10374', )(Ave78723)
Zer23162 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer23162', )(Res10374)
Ave82833 = keras.layers.Average(name = 'Ave82833', )([in0Ave82833,in1Ave82833])
Max53649 = keras.layers.Maximum(name = 'Max53649', )([Zer23162,Ave82833])
Res69903 = keras.layers.Reshape((2, 2, 1), name = 'Res69903', )(Max53649)
Sep58487 = keras.layers.SeparableConv2D(3, (2, 1),strides=(1, 1), padding='valid', name = 'Sep58487', )(Res69903)
model = tf.keras.models.Model(inputs=[in0Dot79830,in1Dot79830,in0Con70908,in0Max92776,in1Max92776,in0Ave82833,in1Ave82833], outputs=Sep58487)
w = model.get_layer('Bat33209').get_weights() 
w[0] = np.array([0.106])
w[1] = np.array([0.3973])
w[2] = np.array([0.6295])
w[3] = np.array([0.6681])
model.get_layer('Bat33209').set_weights(w) 
w = model.get_layer('Sep58487').get_weights() 
w[0] = np.array([[[[0.1691]]], [[[0.766]]]])
w[1] = np.array([[[[0.6055, 0.2082, 0.775]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep58487').set_weights(w) 
in0Dot79830 = tf.constant([[0.0669, 0.5031, 0.3578]])
in1Dot79830 = tf.constant([[0.7414, 0.4773, 0.7208]])
in0Con70908 = tf.constant([[[[0.9488]]]])
in0Max92776 = tf.constant([[[[0.9526, 0.6984]]]])
in1Max92776 = tf.constant([[[[0.1991, 0.2263]]]])
in0Ave82833 = tf.constant([[[0.7399, 0.577], [0.2192, 0.1672]]])
in1Ave82833 = tf.constant([[[0.9489, 0.6208], [0.5399, 0.4939]]])
print (np.array2string(model.predict([in0Dot79830,in1Dot79830,in0Con70908,in0Max92776,in1Max92776,in0Ave82833,in1Ave82833],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep58487.png')

LDot79830 = dot_layer([[0.0669, 0.5031, 0.3578]], [[0.7414, 0.4773, 0.7208]], 1, 1, Dot79830), 
LBat33209 = batch_normalization_layer(Dot79830, 1, 0.6400982770586129, [0.106], [0.3973], [0.6295], [0.6681], Bat33209), 
LRes2148 = reshape_layer(Bat33209, [1, 1], Res2148), 
LRes89989 = reshape_layer(Res2148, [1, 1, 1], Res89989), 
LCon70908 = concatenate_layer([Res89989,[[[[0.9488]]]]], 3, Con70908), 
LMax92776 = maximum_layer([[[[[0.9526, 0.6984]]]], [[[[0.1991, 0.2263]]]]], Max92776), 
LAve78723 = average_layer([Con70908,Max92776], Ave78723), 
LRes10374 = reshape_layer(Ave78723, [1, 2], Res10374), 
LZer23162 = zero_padding1D_layer(Res10374, 1, 0, Zer23162), 
LAve82833 = average_layer([[[[0.7399, 0.577], [0.2192, 0.1672]]], [[[0.9489, 0.6208], [0.5399, 0.4939]]]], Ave82833), 
LMax53649 = maximum_layer([Zer23162,Ave82833], Max53649), 
LRes69903 = reshape_layer(Max53649, [2, 2, 1], Res69903), 
LSep58487 = separable_conv2D_layer(Res69903, 2, 1,[[[[[0.1691]]], [[[0.766]]]],[[[[0.6055, 0.2082, 0.775]]]]],[0, 0, 0], 1, 1, false, Sep58487), 
exec_layers([LDot79830,LBat33209,LRes2148,LRes89989,LCon70908,LMax92776,LAve78723,LRes10374,LZer23162,LAve82833,LMax53649,LRes69903,LSep58487],["Dot79830","Bat33209","Res2148","Res89989","Con70908","Max92776","Ave78723","Res10374","Zer23162","Ave82833","Max53649","Res69903","Sep58487"],Sep58487,"Sep58487")

Actual (Unparsed): [[[[0.3977492, 0.1367653, 0.5090927], [0.4433178, 0.1524340, 0.5674175]]]]

Expected (Unparsed): [[[[0.3977492044731514,0.13676529210786142,0.5090927059730673],[0.443317787745,0.152433961038,0.5674174822500001]]]]

Actual:   [[[[0.3978, 0.1368, 0.5091], [0.4434, 0.1525, 0.5675]]]]

Expected: [[[[0.3978, 0.1368, 0.5091], [0.4434, 0.1525, 0.5675]]]]