import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave47693 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave47693 = tf.keras.layers.Input(shape=([2, 2, 2]))

Ave47693 = keras.layers.Average(name = 'Ave47693', )([in0Ave47693,in1Ave47693])
ELU98432 = keras.layers.ELU(alpha=-7.665543874933358, name = 'ELU98432', )(Ave47693)
Res84941 = keras.layers.Reshape((2, 4), name = 'Res84941', )(ELU98432)
LST76477 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST76477', )(Res84941)
Res60301 = keras.layers.Reshape((1, 1), name = 'Res60301', )(LST76477)
Con21812 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con21812', )(Res60301)
Res8982 = keras.layers.Reshape((1, 4, 1), name = 'Res8982', )(Con21812)
Res32643 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res32643', )(Res8982)
Glo48748 = keras.layers.GlobalAveragePooling3D(name = 'Glo48748', )(Res32643)
model = tf.keras.models.Model(inputs=[in0Ave47693,in1Ave47693], outputs=Glo48748)
w = model.get_layer('LST76477').get_weights() 
w[0] = np.array([[5, 5, 10, 4], [4, 2, 9, 6], [5, 3, 6, 8], [10, 1, 4, 10]])
w[1] = np.array([[10, 7, 3, 6]])
w[2] = np.array([2, 6, 8, 6])
model.get_layer('LST76477').set_weights(w) 
w = model.get_layer('Con21812').get_weights() 
w[0] = np.array([[[0.9388, 0.0752, 0.7388, 0.422]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con21812').set_weights(w) 
in0Ave47693 = tf.constant([[[[0.333, 0.5043], [0.1039, 0.2615]], [[0.9218, 0.0489], [0.2759, 0.0947]]]])
in1Ave47693 = tf.constant([[[[0.4359, 0.9657], [0.6831, 0.8121]], [[0.7831, 0.4531], [0.1094, 0.8237]]]])
print (np.array2string(model.predict([in0Ave47693,in1Ave47693],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo48748.png')

LAve47693 = average_layer([[[[[0.333, 0.5043], [0.1039, 0.2615]], [[0.9218, 0.0489], [0.2759, 0.0947]]]], [[[[0.4359, 0.9657], [0.6831, 0.8121]], [[0.7831, 0.4531], [0.1094, 0.8237]]]]], Ave47693), 
LELU98432 = elu_layer(Ave47693, -7.665543874933358, ELU98432), 
LRes84941 = reshape_layer(ELU98432, [2, 4], Res84941), 
LLST76477 = lstm_layer(Res84941,[[5, 5, 10, 4], [4, 2, 9, 6], [5, 3, 6, 8], [10, 1, 4, 10]],[[10, 7, 3, 6]],[2, 6, 8, 6], LST76477), 
LRes60301 = reshape_layer(LST76477, [1, 1], Res60301), 
LCon21812 = conv1D_layer(Res60301, 1,[[[0.9388, 0.0752, 0.7388, 0.422]]],[0, 0, 0, 0], 1, true, 1, Con21812), 
LRes8982 = reshape_layer(Con21812, [1, 4, 1], Res8982), 
LRes32643 = reshape_layer(Res8982, [1, 4, 1, 1], Res32643), 
LGlo48748 = global_average_pooling3D_layer(Res32643, Glo48748), 
exec_layers([LAve47693,LELU98432,LRes84941,LLST76477,LRes60301,LCon21812,LRes8982,LRes32643,LGlo48748],["Ave47693","ELU98432","Res84941","LST76477","Res60301","Con21812","Res8982","Res32643","Glo48748"],Glo48748,"Glo48748")

Actual (Unparsed): [[0.5241418]]

Expected (Unparsed): [[0.5241417674188475]]

Actual:   [[0.5242]]

Expected: [[0.5242]]