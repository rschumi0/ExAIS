import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo47681 = tf.keras.layers.Input(shape=([1, 2]))

Glo47681 = keras.layers.GlobalMaxPool1D(name = 'Glo47681', )(in0Glo47681)
Res96018 = keras.layers.Reshape((2, 1), name = 'Res96018', )(Glo47681)
PRe30483 = keras.layers.PReLU(name = 'PRe30483', )(Res96018)
Loc17837 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc17837', )(PRe30483)
Sim41390 = keras.layers.SimpleRNN(3,name = 'Sim41390', )(Loc17837)
model = tf.keras.models.Model(inputs=[in0Glo47681], outputs=Sim41390)
w = model.get_layer('PRe30483').get_weights() 
w[0] = np.array([[0.7878], [0.1876]])
model.get_layer('PRe30483').set_weights(w) 
w = model.get_layer('Loc17837').get_weights() 
w[0] = np.array([[[0.2517, 0.6204, 0.7515], [0.2344, 0.2009, 0.5999]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc17837').set_weights(w) 
w = model.get_layer('Sim41390').get_weights() 
w[0] = np.array([[3, 6, 10], [9, 5, 4], [5, 7, 5]])
w[1] = np.array([[1, 4, 9], [1, 3, 1], [9, 9, 4]])
w[2] = np.array([1, 5, 5])
model.get_layer('Sim41390').set_weights(w) 
in0Glo47681 = tf.constant([[[1.5835, 1.149]]])
print (np.array2string(model.predict([in0Glo47681],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim41390.png')

LGlo47681 = global_max_pool1D_layer([[[1.5835, 1.149]]], Glo47681), 
LRes96018 = reshape_layer(Glo47681, [2, 1], Res96018), 
LPRe30483 = prelu_layer(Res96018, [[0.7878], [0.1876]], PRe30483), 
LLoc17837 = locally_connected1D_layer(PRe30483, 2,[[[0.2517, 0.6204, 0.7515], [0.2344, 0.2009, 0.5999]]],[[0, 0, 0]], 1, Loc17837), 
LSim41390 = simple_rnn_layer(Loc17837,[[3, 6, 10], [9, 5, 4], [5, 7, 5]],[[1, 4, 9], [1, 3, 1], [9, 9, 4]],[1, 5, 5], Sim41390), 
exec_layers([LGlo47681,LRes96018,LPRe30483,LLoc17837,LSim41390],["Glo47681","Res96018","PRe30483","Loc17837","Sim41390"],Sim41390,"Sim41390")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0,1.0]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]