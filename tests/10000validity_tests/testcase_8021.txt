import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max1869 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max1869 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con64907 = tf.keras.layers.Input(shape=([1, 2, 1]))

Max1869 = keras.layers.Maximum(name = 'Max1869', )([in0Max1869,in1Max1869])
Res7116 = keras.layers.Reshape((1, 1), name = 'Res7116', )(Max1869)
Con64907 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con64907', )(in0Con64907)
Bat9400 = keras.layers.BatchNormalization(axis=3, epsilon=0.19053998255925486,  name = 'Bat9400', )(Con64907)
Res50414 = keras.layers.Reshape((1, 8), name = 'Res50414', )(Bat9400)
Dot56208 = keras.layers.Dot(axes=(1, 1), name = 'Dot56208', )([Res7116,Res50414])
model = tf.keras.models.Model(inputs=[in0Max1869,in1Max1869,in0Con64907], outputs=Dot56208)
w = model.get_layer('Con64907').get_weights() 
w[0] = np.array([[[[0.9777, 0.0982, 0.7905, 0.6281]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con64907').set_weights(w) 
w = model.get_layer('Bat9400').get_weights() 
w[0] = np.array([0.4946, 0.8133, 0.2042, 0.4427])
w[1] = np.array([0.4192, 0.67, 0.9984, 0.3072])
w[2] = np.array([0.9077, 0.7984, 0.2327, 0.2981])
w[3] = np.array([0.3165, 0.0032, 0.7461, 0.5576])
model.get_layer('Bat9400').set_weights(w) 
in0Max1869 = tf.constant([[[[0.9086]]]])
in1Max1869 = tf.constant([[[[0.2631]]]])
in0Con64907 = tf.constant([[[[0.8572], [0.4218]]]])
print (np.array2string(model.predict([in0Max1869,in1Max1869,in0Con64907],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot56208.png')

LMax1869 = maximum_layer([[[[[0.9086]]]], [[[[0.2631]]]]], Max1869), 
LRes7116 = reshape_layer(Max1869, [1, 1], Res7116), 
LCon64907 = conv2D_layer([[[[0.8572], [0.4218]]]], 1, 1,[[[[0.9777, 0.0982, 0.7905, 0.6281]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con64907), 
LBat9400 = batch_normalization_layer(Con64907, 3, 0.19053998255925486, [0.4946, 0.8133, 0.2042, 0.4427], [0.4192, 0.67, 0.9984, 0.3072], [0.9077, 0.7984, 0.2327, 0.2981], [0.3165, 0.0032, 0.7461, 0.5576], Bat9400), 
LRes50414 = reshape_layer(Bat9400, [1, 8], Res50414), 
LDot56208 = dot_layer(Res7116,Res50414, 1, 1, Dot56208), 
exec_layers([LMax1869,LRes7116,LCon64907,LBat9400,LRes50414,LDot56208],["Max1869","Res7116","Con64907","Bat9400","Res50414","Dot56208"],Dot56208,"Dot56208")

Actual (Unparsed): [[[0.3369500, -0.5903167, 0.9924407, 0.3908746, 0.0682920, -0.6620984, 0.9264576, 0.2636977]]]

Expected (Unparsed): [[[0.33694997519917835,-0.5903166875687205,0.9924406822475892,0.3908745678174715,0.0682919729846486,-0.6620983957732857,0.9264576267216511,0.26369772482244913]]]

Actual:   [[[0.337, -0.5903, 0.9925, 0.3909, 0.0683, -0.662, 0.9265, 0.2637]]]

Expected: [[[0.337, -0.5903, 0.9925, 0.3909, 0.0683, -0.662, 0.9265, 0.2637]]]