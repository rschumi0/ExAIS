import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con15345 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Thr81124 = tf.keras.layers.Input(shape=([2, 1, 2]))

Con15345 = keras.layers.Conv2D(4, (2, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con15345', )(in0Con15345)
Sep70928 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep70928', )(Con15345)
Res30399 = keras.layers.Reshape((2, 4), name = 'Res30399', )(Sep70928)
Thr81124 = keras.layers.ThresholdedReLU(theta=9.070126579953248, name = 'Thr81124', input_shape=(2, 1, 2))(in0Thr81124)
Res49409 = keras.layers.Reshape((2, 2), name = 'Res49409', )(Thr81124)
Dot61307 = keras.layers.Dot(axes=(1, 1), name = 'Dot61307', )([Res30399,Res49409])
model = tf.keras.models.Model(inputs=[in0Con15345,in0Thr81124], outputs=Dot61307)
w = model.get_layer('Con15345').get_weights() 
w[0] = np.array([[[[0.8119, 0.9633, 0.1214, 0.7706], [0.1881, 0.3947, 0.6171, 0.4699]]], [[[0.8723, 0.1608, 0.585, 0.5943], [0.1346, 0.7676, 0.8706, 0.6053]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con15345').set_weights(w) 
w = model.get_layer('Sep70928').get_weights() 
w[0] = np.array([[[[0.2746], [0.8747], [0.1901], [0.8219]]]])
w[1] = np.array([[[[0.8102, 0.5505, 0.9236, 0.4968], [0.9276, 0.7683, 0.7735, 0.8357], [0.4146, 0.1829, 0.4432, 0.1018], [0.7041, 0.3007, 0.0731, 0.5259]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep70928').set_weights(w) 
in0Con15345 = tf.constant([[[[0.2698, 0.3049]], [[0.8691, 0.1455]]]])
in0Thr81124 = tf.constant([[[[0.6452, 0.3957]], [[0.7565, 0.5115]]]])
print (np.array2string(model.predict([in0Con15345,in0Thr81124],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot61307.png')

LCon15345 = conv2D_layer([[[[0.2698, 0.3049]], [[0.8691, 0.1455]]]], 2, 1,[[[[0.8119, 0.9633, 0.1214, 0.7706], [0.1881, 0.3947, 0.6171, 0.4699]]], [[[0.8723, 0.1608, 0.585, 0.5943], [0.1346, 0.7676, 0.8706, 0.6053]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con15345), 
LSep70928 = separable_conv2D_layer(Con15345, 1, 1,[[[[[0.2746], [0.8747], [0.1901], [0.8219]]]],[[[[0.8102, 0.5505, 0.9236, 0.4968], [0.9276, 0.7683, 0.7735, 0.8357], [0.4146, 0.1829, 0.4432, 0.1018], [0.7041, 0.3007, 0.0731, 0.5259]]]]],[0, 0, 0, 0], 1, 1, false, Sep70928), 
LRes30399 = reshape_layer(Sep70928, [2, 4], Res30399), 
LThr81124 = thresholded_relu_layer([[[[0.6452, 0.3957]], [[0.7565, 0.5115]]]], 9.070126579953248, Thr81124), 
LRes49409 = reshape_layer(Thr81124, [2, 2], Res49409), 
LDot61307 = dot_layer(Res30399,Res49409, 1, 1, Dot61307), 
exec_layers([LCon15345,LSep70928,LRes30399,LThr81124,LRes49409,LDot61307],["Con15345","Sep70928","Res30399","Thr81124","Res49409","Dot61307"],Dot61307,"Dot61307")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0]]]

Actual:   [[[0, 0], [0, 0], [0, 0], [0, 0]]]

Expected: [[[0, 0], [0, 0], [0, 0], [0, 0]]]