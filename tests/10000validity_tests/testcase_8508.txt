import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul33912 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul33912 = tf.keras.layers.Input(shape=([2, 1, 2]))

Mul33912 = keras.layers.Multiply(name = 'Mul33912', )([in0Mul33912,in1Mul33912])
Bat99475 = keras.layers.BatchNormalization(axis=3, epsilon=0.22532734520364278,  name = 'Bat99475', )(Mul33912)
model = tf.keras.models.Model(inputs=[in0Mul33912,in1Mul33912], outputs=Bat99475)
w = model.get_layer('Bat99475').get_weights() 
w[0] = np.array([0.7956, 0.2541])
w[1] = np.array([0.2214, 0.2783])
w[2] = np.array([0.6013, 0.5855])
w[3] = np.array([0.1598, 0.249])
model.get_layer('Bat99475').set_weights(w) 
in0Mul33912 = tf.constant([[[[0.392, 0.4385]], [[0.7691, 0.692]]]])
in1Mul33912 = tf.constant([[[[0.3285, 0.0719]], [[0.8815, 0.9398]]]])
print (np.array2string(model.predict([in0Mul33912,in1Mul33912],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat99475.png')

LMul33912 = multiply_layer([[[[[0.392, 0.4385]], [[0.7691, 0.692]]]], [[[[0.3285, 0.0719]], [[0.8815, 0.9398]]]]], Mul33912), 
LBat99475 = batch_normalization_layer(Mul33912, 3, 0.22532734520364278, [0.7956, 0.2541], [0.2214, 0.2783], [0.6013, 0.5855], [0.1598, 0.249], Bat99475), 
exec_layers([LMul33912,LBat99475],["Mul33912","Bat99475"],Bat99475,"Bat99475")

Actual (Unparsed): [[[[-0.3843873, 0.0739130]], [[0.3196813, 0.3022232]]]]

Expected (Unparsed): [[[[-0.38438727236856896,0.0739129946909721]],[[0.3196812697845925,0.3022232019523119]]]]

Actual:   [[[[-0.3843, 0.074]], [[0.3197, 0.3023]]]]

Expected: [[[[-0.3843, 0.074]], [[0.3197, 0.3023]]]]