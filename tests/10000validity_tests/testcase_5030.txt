import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot8467 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot8467 = tf.keras.layers.Input(shape=([3, 2]))
in0Bat79678 = tf.keras.layers.Input(shape=([3, 4, 1]))

Dot8467 = keras.layers.Dot(axes=(2, 2), name = 'Dot8467', )([in0Dot8467,in1Dot8467])
Res53801 = keras.layers.Reshape((3, 3, 1), name = 'Res53801', )(Dot8467)
Zer98602 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer98602', )(Res53801)
Bat79678 = keras.layers.BatchNormalization(axis=3, epsilon=0.9926413439669551,  name = 'Bat79678', )(in0Bat79678)
Max9586 = keras.layers.Maximum(name = 'Max9586', )([Zer98602,Bat79678])
ELU16264 = keras.layers.ELU(alpha=2.7827673959741475, name = 'ELU16264', )(Max9586)
model = tf.keras.models.Model(inputs=[in0Dot8467,in1Dot8467,in0Bat79678], outputs=ELU16264)
w = model.get_layer('Bat79678').get_weights() 
w[0] = np.array([0.2022])
w[1] = np.array([0.952])
w[2] = np.array([0.5966])
w[3] = np.array([0.488])
model.get_layer('Bat79678').set_weights(w) 
in0Dot8467 = tf.constant([[[0.7004, 0.1842], [0.0703, 0.9259], [0.0592, 0.8988]]])
in1Dot8467 = tf.constant([[[0.0634, 0.6861], [0.6346, 0.3628], [0.5542, 0.7498]]])
in0Bat79678 = tf.constant([[[[1.753], [1.7224], [1.5176], [1.7043]], [[1.713], [1.1573], [1.4803], [1.225]], [[1.6115], [1.6691], [1.4343], [1.6736]]]])
print (np.array2string(model.predict([in0Dot8467,in1Dot8467,in0Bat79678],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU16264.png')

LDot8467 = dot_layer([[[0.7004, 0.1842], [0.0703, 0.9259], [0.0592, 0.8988]]], [[[0.0634, 0.6861], [0.6346, 0.3628], [0.5542, 0.7498]]], 2, 2, Dot8467), 
LRes53801 = reshape_layer(Dot8467, [3, 3, 1], Res53801), 
LZer98602 = zero_padding2D_layer(Res53801, 0, 0, 1, 0, Zer98602), 
LBat79678 = batch_normalization_layer([[[[1.753], [1.7224], [1.5176], [1.7043]], [[1.713], [1.1573], [1.4803], [1.225]], [[1.6115], [1.6691], [1.4343], [1.6736]]]], 3, 0.9926413439669551, [0.2022], [0.952], [0.5966], [0.488], Bat79678), 
LMax9586 = maximum_layer([Zer98602,Bat79678], Max9586), 
LELU16264 = elu_layer(Max9586, 2.7827673959741475, ELU16264), 
exec_layers([LDot8467,LRes53801,LZer98602,LBat79678,LMax9586,LELU16264],["Dot8467","Res53801","Zer98602","Bat79678","Max9586","ELU16264"],ELU16264,"ELU16264")

Actual (Unparsed): [[[[1.1441606], [1.1390757], [1.1050438], [1.1360680]], [[1.1375137], [1.0451723], [1.0988456], [1.0564221]], [[1.1206473], [1.1302188], [1.0912018], [1.1309666]]]]

Expected (Unparsed): [[[[1.1441605788252385],[1.1390757347297245],[1.1050438369924287],[1.1360680328300905]],[[1.1375137237984227],[1.0451722903383873],[1.098845644679923],[1.0564220924712728]],[[1.1206473291678782],[1.1302188004064928],[1.0912017613990852],[1.1309665715970094]]]]

Actual:   [[[[1.1442], [1.1391], [1.1051], [1.1361]], [[1.1376], [1.0452], [1.0989], [1.0565]], [[1.1207], [1.1303], [1.0913], [1.131]]]]

Expected: [[[[1.1442], [1.1391], [1.1051], [1.1361]], [[1.1376], [1.0452], [1.0989], [1.0565]], [[1.1207], [1.1303], [1.0913], [1.131]]]]