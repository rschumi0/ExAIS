import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max56396 = tf.keras.layers.Input(shape=([1, 1]))
in1Max56396 = tf.keras.layers.Input(shape=([1, 1]))
in0Glo37634 = tf.keras.layers.Input(shape=([1, 1]))
in0Con62618 = tf.keras.layers.Input(shape=([1]))

Max56396 = keras.layers.Maximum(name = 'Max56396', )([in0Max56396,in1Max56396])
LST84264 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST84264', )(Max56396)
Lea18721 = keras.layers.LeakyReLU(alpha=4.65060517074578, name = 'Lea18721', )(LST84264)
Glo37634 = keras.layers.GlobalAveragePooling1D(name = 'Glo37634', )(in0Glo37634)
Res41606 = keras.layers.Reshape((1, 1), name = 'Res41606', )(Glo37634)
Glo75195 = keras.layers.GlobalAveragePooling1D(name = 'Glo75195', )(Res41606)
Con62618 = keras.layers.Concatenate(axis=1, name = 'Con62618', )([Glo75195,in0Con62618])
Max6034 = keras.layers.Maximum(name = 'Max6034', )([Lea18721,Con62618])
model = tf.keras.models.Model(inputs=[in0Max56396,in1Max56396,in0Glo37634,in0Con62618], outputs=Max6034)
w = model.get_layer('LST84264').get_weights() 
w[0] = np.array([[5, 2, 2, 8, 6, 2, 2, 10]])
w[1] = np.array([[1, 7, 7, 4, 2, 5, 6, 9], [7, 8, 10, 2, 5, 7, 10, 8]])
w[2] = np.array([8, 9, 4, 1, 10, 6, 8, 10])
model.get_layer('LST84264').set_weights(w) 
in0Max56396 = tf.constant([[[0.9794]]])
in1Max56396 = tf.constant([[[0.5645]]])
in0Glo37634 = tf.constant([[[1.729]]])
in0Con62618 = tf.constant([[0.7126]])
print (np.array2string(model.predict([in0Max56396,in1Max56396,in0Glo37634,in0Con62618],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max6034.png')

LMax56396 = maximum_layer([[[[0.9794]]], [[[0.5645]]]], Max56396), 
LLST84264 = lstm_layer(Max56396,[[5, 2, 2, 8, 6, 2, 2, 10]],[[1, 7, 7, 4, 2, 5, 6, 9], [7, 8, 10, 2, 5, 7, 10, 8]],[8, 9, 4, 1, 10, 6, 8, 10], LST84264), 
LLea18721 = leaky_relu_layer(LST84264, 4.65060517074578, Lea18721), 
LGlo37634 = global_average_pooling1D_layer([[[1.729]]], Glo37634), 
LRes41606 = reshape_layer(Glo37634, [1, 1], Res41606), 
LGlo75195 = global_average_pooling1D_layer(Res41606, Glo75195), 
LCon62618 = concatenate_layer([Glo75195,[[0.7126]]], 1, Con62618), 
LMax6034 = maximum_layer([Lea18721,Con62618], Max6034), 
exec_layers([LMax56396,LLST84264,LLea18721,LGlo37634,LRes41606,LGlo75195,LCon62618,LMax6034],["Max56396","LST84264","Lea18721","Glo37634","Res41606","Glo75195","Con62618","Max6034"],Max6034,"Max6034")

Actual (Unparsed): [[1.7290000, 0.7615867]]

Expected (Unparsed): [[1.729,0.7615867421037558]]

Actual:   [[1.729, 0.7616]]

Expected: [[1.729, 0.7616]]