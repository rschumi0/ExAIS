import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot25189 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot25189 = tf.keras.layers.Input(shape=([2, 3]))

Dot25189 = keras.layers.Dot(axes=(1, 1), name = 'Dot25189', )([in0Dot25189,in1Dot25189])
Res28669 = keras.layers.Reshape((3, 3, 1), name = 'Res28669', )(Dot25189)
Zer6768 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer6768', )(Res28669)
Sep74063 = keras.layers.SeparableConv2D(3, (5, 3),strides=(4, 4), padding='same', name = 'Sep74063', )(Zer6768)
model = tf.keras.models.Model(inputs=[in0Dot25189,in1Dot25189], outputs=Sep74063)
w = model.get_layer('Sep74063').get_weights() 
w[0] = np.array([[[[0.8455]], [[0.848]], [[0.0869]]], [[[0.9216]], [[0.3596]], [[0.7329]]], [[[0.5693]], [[0.4128]], [[0.3493]]], [[[0.0152]], [[0.0754]], [[0.9986]]], [[[0.8004]], [[0.386]], [[0.4188]]]])
w[1] = np.array([[[[0.5626, 0.7035, 0.0327]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep74063').set_weights(w) 
in0Dot25189 = tf.constant([[[0.365, 0.7866, 0.6774], [0.0924, 0.9939, 0.2]]])
in1Dot25189 = tf.constant([[[0.7351, 0.5623, 0.1281], [0.7845, 0.3506, 0.4707]]])
print (np.array2string(model.predict([in0Dot25189,in1Dot25189],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep74063.png')

LDot25189 = dot_layer([[[0.365, 0.7866, 0.6774], [0.0924, 0.9939, 0.2]]], [[[0.7351, 0.5623, 0.1281], [0.7845, 0.3506, 0.4707]]], 1, 1, Dot25189), 
LRes28669 = reshape_layer(Dot25189, [3, 3, 1], Res28669), 
LZer6768 = zero_padding2D_layer(Res28669, 1, 1, 1, 1, Zer6768), 
LSep74063 = separable_conv2D_layer(Zer6768, 5, 3,[[[[[0.8455]], [[0.848]], [[0.0869]]], [[[0.9216]], [[0.3596]], [[0.7329]]], [[[0.5693]], [[0.4128]], [[0.3493]]], [[[0.0152]], [[0.0754]], [[0.9986]]], [[[0.8004]], [[0.386]], [[0.4188]]]],[[[[0.5626, 0.7035, 0.0327]]]]],[0, 0, 0], 4, 4, true, Sep74063), 
exec_layers([LDot25189,LRes28669,LZer6768,LSep74063],["Dot25189","Res28669","Zer6768","Sep74063"],Sep74063,"Sep74063")

Actual (Unparsed): [[[[0.5114198, 0.6395020, 0.0297253], [0.2568117, 0.3211287, 0.0149267]], [[0.3364066, 0.4206577, 0.0195530], [0.3642699, 0.4554993, 0.0211725]]]]

Expected (Unparsed): [[[[0.5114198369936127,0.6395020535460479,0.029725255367385593],[0.25681169652939123,0.32112873890584204,0.014926666328672402]],[[0.336406589320347,0.4206577241145825,0.0195529603106565],[0.3642699443493474,0.45549929941302153,0.021172462104912304]]]]

Actual:   [[[[0.5115, 0.6396, 0.0298], [0.2569, 0.3212, 0.015]], [[0.3365, 0.4207, 0.0196], [0.3643, 0.4555, 0.0212]]]]

Expected: [[[[0.5115, 0.6396, 0.0298], [0.2569, 0.3212, 0.015]], [[0.3365, 0.4207, 0.0196], [0.3643, 0.4555, 0.0212]]]]