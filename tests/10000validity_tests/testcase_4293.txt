import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe142 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Con29441 = tf.keras.layers.Input(shape=([2, 3, 4]))
in0Sub27463 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))
in1Sub27463 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))

PRe142 = keras.layers.PReLU(name = 'PRe142', input_shape=(1, 2, 1, 2))(in0PRe142)
Res32563 = keras.layers.Reshape((1, 2, 2), name = 'Res32563', )(PRe142)
Zer69655 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer69655', )(Res32563)
Con29441 = keras.layers.Concatenate(axis=3, name = 'Con29441', )([Zer69655,in0Con29441])
Sub27463 = keras.layers.Subtract(name = 'Sub27463', )([in0Sub27463,in1Sub27463])
Res90194 = keras.layers.Reshape((3, 2, 6), name = 'Res90194', )(Sub27463)
Max17656 = keras.layers.MaxPool2D(pool_size=(3, 2), strides=(2, 2), padding='same', name = 'Max17656', )(Res90194)
Zer38743 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer38743', )(Max17656)
Add41469 = keras.layers.Add(name = 'Add41469', )([Con29441,Zer38743])
model = tf.keras.models.Model(inputs=[in0PRe142,in0Con29441,in0Sub27463,in1Sub27463], outputs=Add41469)
w = model.get_layer('PRe142').get_weights() 
w[0] = np.array([[[[0.8759, 0.1298]], [[0.4602, 0.1103]]]])
model.get_layer('PRe142').set_weights(w) 
in0PRe142 = tf.constant([[[[[0.7425, 0.7596]], [[0.557, 0.3338]]]]])
in0Con29441 = tf.constant([[[[0.2536, 0.928, 0.9128, 0.3424], [0.5135, 0.1976, 0.9949, 0.0076], [0.4121, 0.8859, 0.6616, 0.5744]], [[0.8764, 0.5837, 0.2952, 0.167], [0.1134, 0.5721, 0.1118, 0.9517], [0.5135, 0.3234, 0.7949, 0.5102]]]])
in0Sub27463 = tf.constant([[[[[0.5356, 0.3109], [0.0775, 0.4485], [0.5126, 0.7452]], [[0.9902, 0.1283], [0.6167, 0.9453], [0.0841, 0.2922]]], [[[0.6244, 0.6728], [0.8185, 0.0101], [0.5689, 0.0003]], [[0.9815, 0.281], [0.3858, 0.9088], [0.731, 0.4431]]], [[[0.9325, 0.1884], [0.7812, 0.2523], [0.9809, 0.3696]], [[0.0335, 0.4621], [0.6563, 0.66], [0.3909, 0.6854]]]]])
in1Sub27463 = tf.constant([[[[[0.0585, 0.7639], [0.8466, 0.4279], [0.4828, 0.0236]], [[0.1903, 0.443], [0.7394, 0.5347], [0.837, 0.9792]]], [[[0.5587, 0.7618], [0.3523, 0.064], [0.9676, 0.7082]], [[0.219, 0.7018], [0.8206, 0.8775], [0.2722, 0.7506]]], [[[0.381, 0.1074], [0.0152, 0.2834], [0.9578, 0.851]], [[0.7196, 0.4461], [0.1286, 0.6362], [0.8151, 0.174]]]]])
print (np.array2string(model.predict([in0PRe142,in0Con29441,in0Sub27463,in1Sub27463],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add41469.png')

LPRe142 = prelu_layer([[[[[0.7425, 0.7596]], [[0.557, 0.3338]]]]], [[[[0.8759, 0.1298]], [[0.4602, 0.1103]]]], PRe142), 
LRes32563 = reshape_layer(PRe142, [1, 2, 2], Res32563), 
LZer69655 = zero_padding2D_layer(Res32563, 1, 0, 1, 0, Zer69655), 
LCon29441 = concatenate_layer([Zer69655,[[[[0.2536, 0.928, 0.9128, 0.3424], [0.5135, 0.1976, 0.9949, 0.0076], [0.4121, 0.8859, 0.6616, 0.5744]], [[0.8764, 0.5837, 0.2952, 0.167], [0.1134, 0.5721, 0.1118, 0.9517], [0.5135, 0.3234, 0.7949, 0.5102]]]]], 3, Con29441), 
LSub27463 = subtract_layer([[[[[0.5356, 0.3109], [0.0775, 0.4485], [0.5126, 0.7452]], [[0.9902, 0.1283], [0.6167, 0.9453], [0.0841, 0.2922]]], [[[0.6244, 0.6728], [0.8185, 0.0101], [0.5689, 0.0003]], [[0.9815, 0.281], [0.3858, 0.9088], [0.731, 0.4431]]], [[[0.9325, 0.1884], [0.7812, 0.2523], [0.9809, 0.3696]], [[0.0335, 0.4621], [0.6563, 0.66], [0.3909, 0.6854]]]]], [[[[[0.0585, 0.7639], [0.8466, 0.4279], [0.4828, 0.0236]], [[0.1903, 0.443], [0.7394, 0.5347], [0.837, 0.9792]]], [[[0.5587, 0.7618], [0.3523, 0.064], [0.9676, 0.7082]], [[0.219, 0.7018], [0.8206, 0.8775], [0.2722, 0.7506]]], [[[0.381, 0.1074], [0.0152, 0.2834], [0.9578, 0.851]], [[0.7196, 0.4461], [0.1286, 0.6362], [0.8151, 0.174]]]]], Sub27463), 
LRes90194 = reshape_layer(Sub27463, [3, 2, 6], Res90194), 
LMax17656 = max_pool2D_layer(Res90194, 3, 2, 2, 2, true, Max17656), 
LZer38743 = zero_padding2D_layer(Max17656, 0, 0, 2, 0, Zer38743), 
LAdd41469 = add_layer([Con29441,Zer38743], Add41469), 
exec_layers([LPRe142,LRes32563,LZer69655,LCon29441,LSub27463,LRes90194,LMax17656,LZer38743,LAdd41469],["PRe142","Res32563","Zer69655","Con29441","Sub27463","Res90194","Max17656","Zer38743","Add41469"],Add41469,"Add41469")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.2536000, 0.9280000, 0.9128000, 0.3424000], [0.0000000, 0.0000000, 0.5135000, 0.1976000, 0.9949000, 0.0076000], [0.7999000, -0.0890000, 0.8783000, 1.2965000, 1.1204000, 1.2960000]], [[0.0000000, 0.0000000, 0.8764000, 0.5837000, 0.2952000, 0.1670000], [0.7425000, 0.7596000, 0.1134000, 0.5721000, 0.1118000, 0.9517000], [1.3195000, 0.4148000, 1.2795000, 0.3547000, 1.2537000, 1.0216000]]]]

Expected (Unparsed): [[[[0,0,0.2536,0.928,0.9128,0.3424],[0,0,0.5135,0.1976,0.9949,0.0076],[0.7998999999999999,-0.08900000000000008,0.8783000000000001,1.2965,1.1204,1.296]],[[0,0,0.8764,0.5837,0.2952,0.167],[0.7425,0.7596,0.1134,0.5721,0.1118,0.9517],[1.3195000000000001,0.4148,1.2795,0.3547000000000001,1.2537,1.0216]]]]

Actual:   [[[[0, 0, 0.2536, 0.928, 0.9128, 0.3424], [0, 0, 0.5135, 0.1976, 0.9949, 0.0076], [0.7999, -0.089, 0.8783, 1.2965, 1.1204, 1.296]], [[0, 0, 0.8764, 0.5837, 0.2952, 0.167], [0.7425, 0.7596, 0.1134, 0.5721, 0.1118, 0.9517], [1.3195, 0.4148, 1.2795, 0.3547, 1.2537, 1.0216]]]]

Expected: [[[[0, 0, 0.2536, 0.928, 0.9128, 0.3424], [0, 0, 0.5135, 0.1976, 0.9949, 0.0076], [0.7999, -0.089, 0.8784, 1.2965, 1.1204, 1.296]], [[0, 0, 0.8764, 0.5837, 0.2952, 0.167], [0.7425, 0.7596, 0.1134, 0.5721, 0.1118, 0.9517], [1.3196, 0.4148, 1.2795, 0.3548, 1.2537, 1.0216]]]]