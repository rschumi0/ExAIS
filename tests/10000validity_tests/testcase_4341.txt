import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub72687 = tf.keras.layers.Input(shape=([2]))
in1Sub72687 = tf.keras.layers.Input(shape=([2]))
in0Con99857 = tf.keras.layers.Input(shape=([3, 1]))
in0Sub22584 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub22584 = tf.keras.layers.Input(shape=([3, 2]))

Sub72687 = keras.layers.Subtract(name = 'Sub72687', )([in0Sub72687,in1Sub72687])
Res83308 = keras.layers.Reshape((2, 1), name = 'Res83308', )(Sub72687)
Zer68368 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer68368', )(Res83308)
Con99857 = keras.layers.Concatenate(axis=2, name = 'Con99857', )([Zer68368,in0Con99857])
Sub22584 = keras.layers.Subtract(name = 'Sub22584', )([in0Sub22584,in1Sub22584])
Mul31194 = keras.layers.Multiply(name = 'Mul31194', )([Con99857,Sub22584])
Max85089 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max85089', )(Mul31194)
model = tf.keras.models.Model(inputs=[in0Sub72687,in1Sub72687,in0Con99857,in0Sub22584,in1Sub22584], outputs=Max85089)
in0Sub72687 = tf.constant([[0.9304, 0.0308]])
in1Sub72687 = tf.constant([[0.0295, 0.5412]])
in0Con99857 = tf.constant([[[0.4377], [0.2496], [0.1001]]])
in0Sub22584 = tf.constant([[[0.7367, 0.9104], [0.928, 0.3872], [0.2524, 0.4672]]])
in1Sub22584 = tf.constant([[[0.4226, 0.4027], [0.093, 0.3505], [0.3024, 0.2567]]])
print (np.array2string(model.predict([in0Sub72687,in1Sub72687,in0Con99857,in0Sub22584,in1Sub22584],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max85089.png')

LSub72687 = subtract_layer([[0.9304, 0.0308]], [[0.0295, 0.5412]], Sub72687), 
LRes83308 = reshape_layer(Sub72687, [2, 1], Res83308), 
LZer68368 = zero_padding1D_layer(Res83308, 1, 0, Zer68368), 
LCon99857 = concatenate_layer([Zer68368,[[[0.4377], [0.2496], [0.1001]]]], 2, Con99857), 
LSub22584 = subtract_layer([[[0.7367, 0.9104], [0.928, 0.3872], [0.2524, 0.4672]]], [[[0.4226, 0.4027], [0.093, 0.3505], [0.3024, 0.2567]]], Sub22584), 
LMul31194 = multiply_layer([Con99857,Sub22584], Mul31194), 
LMax85089 = max_pool1D_layer(Mul31194, 1, Max85089), 
exec_layers([LSub72687,LRes83308,LZer68368,LCon99857,LSub22584,LMul31194,LMax85089],["Sub72687","Res83308","Zer68368","Con99857","Sub22584","Mul31194","Max85089"],Max85089,"Max85089")

Actual (Unparsed): [[[0.0000000, 0.2222203], [0.7522515, 0.0091603], [0.0255200, 0.0210711]]]

Expected (Unparsed): [[[0.0,0.22222029000000001],[0.7522515000000001,0.009160320000000001],[0.025519999999999994,0.02107105]]]

Actual:   [[[0, 0.2223], [0.7523, 0.0092], [0.0256, 0.0211]]]

Expected: [[[0, 0.2223], [0.7523, 0.0092], [0.0256, 0.0211]]]