import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave44770 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave44770 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con35371 = tf.keras.layers.Input(shape=([3, 2]))
in0Mul2760 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Mul2760 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con73717 = tf.keras.layers.Input(shape=([1, 1]))
in0Con46781 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Glo5023 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con34743 = tf.keras.layers.Input(shape=([3]))

Ave44770 = keras.layers.Average(name = 'Ave44770', )([in0Ave44770,in1Ave44770])
Res37323 = keras.layers.Reshape((1, 1), name = 'Res37323', )(Ave44770)
Zer13702 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer13702', )(Res37323)
Con35371 = keras.layers.Concatenate(axis=2, name = 'Con35371', )([Zer13702,in0Con35371])
Mul2760 = keras.layers.Multiply(name = 'Mul2760', )([in0Mul2760,in1Mul2760])
Res99197 = keras.layers.Reshape((1, 1, 2), name = 'Res99197', )(Mul2760)
Res34381 = keras.layers.Reshape((1, 2), name = 'Res34381', )(Res99197)
Con73717 = keras.layers.Concatenate(axis=2, name = 'Con73717', )([Res34381,in0Con73717])
Con46781 = keras.layers.Conv2D(3, (1, 2),strides=(2, 2), padding='valid', dilation_rate=(1, 1), name = 'Con46781', )(in0Con46781)
Res50087 = keras.layers.Reshape((1, 3), name = 'Res50087', )(Con46781)
Dot1500 = keras.layers.Dot(axes=(1, 1), name = 'Dot1500', )([Con73717,Res50087])
Max65164 = keras.layers.Maximum(name = 'Max65164', )([Con35371,Dot1500])
Con98916 = keras.layers.Conv1D(4, (1),strides=(10), padding='valid', dilation_rate=(1), name = 'Con98916', )(Max65164)
Fla49955 = keras.layers.Flatten(name = 'Fla49955', )(Con98916)
Glo5023 = keras.layers.GlobalMaxPool2D(name = 'Glo5023', )(in0Glo5023)
Con34743 = keras.layers.Concatenate(axis=1, name = 'Con34743', )([Glo5023,in0Con34743])
Mul90557 = keras.layers.Multiply(name = 'Mul90557', )([Fla49955,Con34743])
Fla29089 = keras.layers.Flatten(name = 'Fla29089', )(Mul90557)
model = tf.keras.models.Model(inputs=[in0Ave44770,in1Ave44770,in0Con35371,in0Mul2760,in1Mul2760,in0Con73717,in0Con46781,in0Glo5023,in0Con34743], outputs=Fla29089)
w = model.get_layer('Con46781').get_weights() 
w[0] = np.array([[[[0.8097, 0.2659, 0.0032], [0.4995, 0.0831, 0.3596]], [[0.6236, 0.4647, 0.9616], [0.5256, 0.3099, 0.3478]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con46781').set_weights(w) 
w = model.get_layer('Con98916').get_weights() 
w[0] = np.array([[[0.6652, 0.2086, 0.731, 0.1719], [0.4591, 0.6848, 0.2238, 0.4689], [0.9834, 0.1953, 0.0654, 0.7274]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con98916').set_weights(w) 
in0Ave44770 = tf.constant([[[[0.0139]]]])
in1Ave44770 = tf.constant([[[[0.6201]]]])
in0Con35371 = tf.constant([[[0.0417, 0.1328], [0.2007, 0.3677], [0.4031, 0.428]]])
in0Mul2760 = tf.constant([[[[[0.7673], [0.2614]]]]])
in1Mul2760 = tf.constant([[[[[0.2926], [0.9825]]]]])
in0Con73717 = tf.constant([[[0.9445]]])
in0Con46781 = tf.constant([[[[0.3157, 0.1302], [0.8808, 0.7465]], [[0.6432, 0.247], [0.8497, 0.4529]]]])
in0Glo5023 = tf.constant([[[[1.5938], [1.3938]], [[1.1061], [1.7952]]]])
in0Con34743 = tf.constant([[0.9009, 0.7052, 0.9446]])
print (np.array2string(model.predict([in0Ave44770,in1Ave44770,in0Con35371,in0Mul2760,in1Mul2760,in0Con73717,in0Con46781,in0Glo5023,in0Con34743],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla29089.png')

LAve44770 = average_layer([[[[[0.0139]]]], [[[[0.6201]]]]], Ave44770), 
LRes37323 = reshape_layer(Ave44770, [1, 1], Res37323), 
LZer13702 = zero_padding1D_layer(Res37323, 2, 0, Zer13702), 
LCon35371 = concatenate_layer([Zer13702,[[[0.0417, 0.1328], [0.2007, 0.3677], [0.4031, 0.428]]]], 2, Con35371), 
LMul2760 = multiply_layer([[[[[[0.7673], [0.2614]]]]], [[[[[0.2926], [0.9825]]]]]], Mul2760), 
LRes99197 = reshape_layer(Mul2760, [1, 1, 2], Res99197), 
LRes34381 = reshape_layer(Res99197, [1, 2], Res34381), 
LCon73717 = concatenate_layer([Res34381,[[[0.9445]]]], 2, Con73717), 
LCon46781 = conv2D_layer([[[[0.3157, 0.1302], [0.8808, 0.7465]], [[0.6432, 0.247], [0.8497, 0.4529]]]], 1, 2,[[[[0.8097, 0.2659, 0.0032], [0.4995, 0.0831, 0.3596]], [[0.6236, 0.4647, 0.9616], [0.5256, 0.3099, 0.3478]]]],[0, 0, 0], 2, 2, false, 1, 1, Con46781), 
LRes50087 = reshape_layer(Con46781, [1, 3], Res50087), 
LDot1500 = dot_layer(Con73717,Res50087, 1, 1, Dot1500), 
LMax65164 = maximum_layer([Con35371,Dot1500], Max65164), 
LCon98916 = conv1D_layer(Max65164, 1,[[[0.6652, 0.2086, 0.731, 0.1719], [0.4591, 0.6848, 0.2238, 0.4689], [0.9834, 0.1953, 0.0654, 0.7274]]],[0, 0, 0, 0], 10, false, 1, Con98916), 
LFla49955 = flatten_layer(Con98916, Fla49955), 
LGlo5023 = global_max_pool2D_layer([[[[1.5938], [1.3938]], [[1.1061], [1.7952]]]], Glo5023), 
LCon34743 = concatenate_layer([Glo5023,[[0.9009, 0.7052, 0.9446]]], 1, Con34743), 
LMul90557 = multiply_layer([Fla49955,Con34743], Mul90557), 
LFla29089 = flatten_layer(Mul90557, Fla29089), 
exec_layers([LAve44770,LRes37323,LZer13702,LCon35371,LMul2760,LRes99197,LRes34381,LCon73717,LCon46781,LRes50087,LDot1500,LMax65164,LCon98916,LFla49955,LGlo5023,LCon34743,LMul90557,LFla29089],["Ave44770","Res37323","Zer13702","Con35371","Mul2760","Res99197","Res34381","Con73717","Con46781","Res50087","Dot1500","Max65164","Con98916","Fla49955","Glo5023","Con34743","Mul90557","Fla29089"],Fla29089,"Fla29089")

Actual (Unparsed): [[0.9320697, 0.2007226, 0.1841038, 0.2972347]]

Expected (Unparsed): [[0.9320696157747075,0.20072262820649478,0.18410376927323083,0.2972347369264816]]

Actual:   [[0.9321, 0.2008, 0.1842, 0.2973]]

Expected: [[0.9321, 0.2008, 0.1842, 0.2973]]