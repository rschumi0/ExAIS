import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla42724 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con61134 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Mul47446 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Mul47446 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Fla42724 = keras.layers.Flatten(name = 'Fla42724', )(in0Fla42724)
Res30515 = keras.layers.Reshape((2, 1), name = 'Res30515', )(Fla42724)
Res56069 = keras.layers.Reshape((2, 1, 1), name = 'Res56069', )(Res30515)
Res31383 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res31383', )(Res56069)
Zer3867 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer3867', )(Res31383)
Con61134 = keras.layers.Concatenate(axis=4, name = 'Con61134', )([Zer3867,in0Con61134])
Mul47446 = keras.layers.Multiply(name = 'Mul47446', )([in0Mul47446,in1Mul47446])
Ave52956 = keras.layers.Average(name = 'Ave52956', )([Con61134,Mul47446])
model = tf.keras.models.Model(inputs=[in0Fla42724,in0Con61134,in0Mul47446,in1Mul47446], outputs=Ave52956)
in0Fla42724 = tf.constant([[[[1.1318]], [[1.0983]]]])
in0Con61134 = tf.constant([[[[[0.6047]], [[0.5178]]], [[[0.4486]], [[0.2358]]]]])
in0Mul47446 = tf.constant([[[[[0.3723, 0.9945]], [[0.0366, 0.7841]]], [[[0.2145, 0.9829]], [[0.6219, 0.0366]]]]])
in1Mul47446 = tf.constant([[[[[0.1987, 0.312]], [[0.4476, 0.1667]]], [[[0.2501, 0.7954]], [[0.3694, 0.935]]]]])
print (np.array2string(model.predict([in0Fla42724,in0Con61134,in0Mul47446,in1Mul47446],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave52956.png')

LFla42724 = flatten_layer([[[[1.1318]], [[1.0983]]]], Fla42724), 
LRes30515 = reshape_layer(Fla42724, [2, 1], Res30515), 
LRes56069 = reshape_layer(Res30515, [2, 1, 1], Res56069), 
LRes31383 = reshape_layer(Res56069, [2, 1, 1, 1], Res31383), 
LZer3867 = zero_padding3D_layer(Res31383, 0, 0, 1, 0, 0, 0, Zer3867), 
LCon61134 = concatenate_layer([Zer3867,[[[[[0.6047]], [[0.5178]]], [[[0.4486]], [[0.2358]]]]]], 4, Con61134), 
LMul47446 = multiply_layer([[[[[[0.3723, 0.9945]], [[0.0366, 0.7841]]], [[[0.2145, 0.9829]], [[0.6219, 0.0366]]]]], [[[[[0.1987, 0.312]], [[0.4476, 0.1667]]], [[[0.2501, 0.7954]], [[0.3694, 0.935]]]]]], Mul47446), 
LAve52956 = average_layer([Con61134,Mul47446], Ave52956), 
exec_layers([LFla42724,LRes30515,LRes56069,LRes31383,LZer3867,LCon61134,LMul47446,LAve52956],["Fla42724","Res30515","Res56069","Res31383","Zer3867","Con61134","Mul47446","Ave52956"],Ave52956,"Ave52956")

Actual (Unparsed): [[[[[0.0369880, 0.4574920]], [[0.5740911, 0.3242547]]], [[[0.0268232, 0.6151993]], [[0.6640149, 0.1350105]]]]]

Expected (Unparsed): [[[[[0.036988005,0.457492]],[[0.57409108,0.324254735]]],[[[0.026823225,0.61519933]],[[0.66401493,0.1350105]]]]]

Actual:   [[[[[0.037, 0.4575]], [[0.5741, 0.3243]]], [[[0.0269, 0.6152]], [[0.6641, 0.1351]]]]]

Expected: [[[[[0.037, 0.4575]], [[0.5741, 0.3243]]], [[[0.0269, 0.6152]], [[0.6641, 0.1351]]]]]