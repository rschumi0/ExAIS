import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min57688 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Min57688 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Min57688 = keras.layers.Minimum(name = 'Min57688', )([in0Min57688,in1Min57688])
Res22370 = keras.layers.Reshape((1, 1, 2), name = 'Res22370', )(Min57688)
Res1424 = keras.layers.Reshape((1, 2), name = 'Res1424', )(Res22370)
LST65486 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST65486', )(Res1424)
Res74407 = keras.layers.Reshape((2, 1), name = 'Res74407', )(LST65486)
Ave66777 = keras.layers.AveragePooling1D(pool_size=(2), strides=(1), padding='same', name = 'Ave66777', )(Res74407)
model = tf.keras.models.Model(inputs=[in0Min57688,in1Min57688], outputs=Ave66777)
w = model.get_layer('LST65486').get_weights() 
w[0] = np.array([[3, 7, 3, 6, 9, 4, 2, 4], [5, 4, 9, 4, 3, 9, 2, 4]])
w[1] = np.array([[7, 10, 2, 7, 3, 8, 6, 4], [7, 7, 3, 2, 6, 9, 2, 2]])
w[2] = np.array([3, 10, 7, 3, 5, 10, 3, 6])
model.get_layer('LST65486').set_weights(w) 
in0Min57688 = tf.constant([[[[[0.266, 0.8747]]]]])
in1Min57688 = tf.constant([[[[[0.1917, 0.7478]]]]])
print (np.array2string(model.predict([in0Min57688,in1Min57688],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave66777.png')

LMin57688 = minimum_layer([[[[[[0.266, 0.8747]]]]], [[[[[0.1917, 0.7478]]]]]], Min57688), 
LRes22370 = reshape_layer(Min57688, [1, 1, 2], Res22370), 
LRes1424 = reshape_layer(Res22370, [1, 2], Res1424), 
LLST65486 = lstm_layer(Res1424,[[3, 7, 3, 6, 9, 4, 2, 4], [5, 4, 9, 4, 3, 9, 2, 4]],[[7, 10, 2, 7, 3, 8, 6, 4], [7, 7, 3, 2, 6, 9, 2, 2]],[3, 10, 7, 3, 5, 10, 3, 6], LST65486), 
LRes74407 = reshape_layer(LST65486, [2, 1], Res74407), 
LAve66777 = average_pooling1D_layer(Res74407, 2, 1, true, Ave66777), 
exec_layers([LMin57688,LRes22370,LRes1424,LLST65486,LRes74407,LAve66777],["Min57688","Res22370","Res1424","LST65486","Res74407","Ave66777"],Ave66777,"Ave66777")

Actual (Unparsed): [[[0.7585593], [0.7615499]]]

Expected (Unparsed): [[[0.7585592533353178],[0.7615498651140307]]]

Actual:   [[[0.7586], [0.7616]]]

Expected: [[[0.7586], [0.7616]]]