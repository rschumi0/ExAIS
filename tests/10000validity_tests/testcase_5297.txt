import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep40386 = tf.keras.layers.Input(shape=([2, 1, 1]))

Sep40386 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep40386', )(in0Sep40386)
Res27860 = keras.layers.Reshape((2, 3), name = 'Res27860', )(Sep40386)
LST93640 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST93640', )(Res27860)
Mas98574 = keras.layers.Masking(mask_value=2, name = 'Mas98574', )(LST93640)
Res9568 = keras.layers.Reshape((1, 1), name = 'Res9568', )(Mas98574)
Res98800 = keras.layers.Reshape((1, 1, 1), name = 'Res98800', )(Res9568)
Res94571 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res94571', )(Res98800)
Cro59963 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro59963', )(Res94571)
ReL85622 = keras.layers.ReLU(max_value=2.0372587356481606, negative_slope=1.03881715132467, threshold=2.7786374342097417, name = 'ReL85622', )(Cro59963)
model = tf.keras.models.Model(inputs=[in0Sep40386], outputs=ReL85622)
w = model.get_layer('Sep40386').get_weights() 
w[0] = np.array([[[[0.4854]]]])
w[1] = np.array([[[[0.3497, 0.7596, 0.3517]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep40386').set_weights(w) 
w = model.get_layer('LST93640').get_weights() 
w[0] = np.array([[1, 7, 6, 9], [4, 3, 10, 8], [10, 6, 1, 8]])
w[1] = np.array([[6, 3, 5, 1]])
w[2] = np.array([8, 1, 10, 1])
model.get_layer('LST93640').set_weights(w) 
in0Sep40386 = tf.constant([[[[0.6754]], [[0.174]]]])
print (np.array2string(model.predict([in0Sep40386],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL85622.png')

LSep40386 = separable_conv2D_layer([[[[0.6754]], [[0.174]]]], 1, 1,[[[[[0.4854]]]],[[[[0.3497, 0.7596, 0.3517]]]]],[0, 0, 0], 1, 1, true, Sep40386), 
LRes27860 = reshape_layer(Sep40386, [2, 3], Res27860), 
LLST93640 = lstm_layer(Res27860,[[1, 7, 6, 9], [4, 3, 10, 8], [10, 6, 1, 8]],[[6, 3, 5, 1]],[8, 1, 10, 1], LST93640), 
LMas98574 = masking_layer(LST93640, 2, Mas98574), 
LRes9568 = reshape_layer(Mas98574, [1, 1], Res9568), 
LRes98800 = reshape_layer(Res9568, [1, 1, 1], Res98800), 
LRes94571 = reshape_layer(Res98800, [1, 1, 1, 1], Res94571), 
LCro59963 = cropping3D_layer(Res94571, 0, 0, 0, 0, 0, 0, Cro59963), 
LReL85622 = relu_layer(Cro59963, 2.0372587356481606, 1.03881715132467, 2.7786374342097417, ReL85622), 
exec_layers([LSep40386,LRes27860,LLST93640,LMas98574,LRes9568,LRes98800,LRes94571,LCro59963,LReL85622],["Sep40386","Res27860","LST93640","Mas98574","Res9568","Res98800","Res94571","Cro59963","ReL85622"],ReL85622,"ReL85622")

Actual (Unparsed): [[[[[-1.9454161]]]]]

Expected (Unparsed): [[[[[-1.9454161427822305]]]]]

Actual:   [[[[[-1.9454]]]]]

Expected: [[[[[-1.9454]]]]]