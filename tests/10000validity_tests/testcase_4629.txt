import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max14757 = tf.keras.layers.Input(shape=([1, 2]))
in1Max14757 = tf.keras.layers.Input(shape=([1, 2]))
in0Cro32497 = tf.keras.layers.Input(shape=([4, 2]))

Max14757 = keras.layers.Maximum(name = 'Max14757', )([in0Max14757,in1Max14757])
Cro32497 = keras.layers.Cropping1D(cropping=((0, 3)), name = 'Cro32497', )(in0Cro32497)
Sub5330 = keras.layers.Subtract(name = 'Sub5330', )([Max14757,Cro32497])
Sof94633 = keras.layers.Softmax(axis=1, name = 'Sof94633', )(Sub5330)
model = tf.keras.models.Model(inputs=[in0Max14757,in1Max14757,in0Cro32497], outputs=Sof94633)
in0Max14757 = tf.constant([[[0.3611, 0.7373]]])
in1Max14757 = tf.constant([[[0.7772, 0.2006]]])
in0Cro32497 = tf.constant([[[1.5619, 1.3003], [1.2502, 1.0393], [1.1782, 1.7742], [1.2842, 1.743]]])
print (np.array2string(model.predict([in0Max14757,in1Max14757,in0Cro32497],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof94633.png')

LMax14757 = maximum_layer([[[[0.3611, 0.7373]]], [[[0.7772, 0.2006]]]], Max14757), 
LCro32497 = cropping1D_layer([[[1.5619, 1.3003], [1.2502, 1.0393], [1.1782, 1.7742], [1.2842, 1.743]]], 0, 3, Cro32497), 
LSub5330 = subtract_layer(Max14757,Cro32497, Sub5330), 
LSof94633 = softmax_layer(Sub5330, 1, Sof94633), 
exec_layers([LMax14757,LCro32497,LSub5330,LSof94633],["Max14757","Cro32497","Sub5330","Sof94633"],Sof94633,"Sof94633")

Actual (Unparsed): [[[1.0000000, 1.0000000]]]

Expected (Unparsed): [[[1.0,1.0]]]

Actual:   [[[1, 1]]]

Expected: [[[1, 1]]]