import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub61190 = tf.keras.layers.Input(shape=([3]))
in1Sub61190 = tf.keras.layers.Input(shape=([3]))
in0Con79155 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Sub52236 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub52236 = tf.keras.layers.Input(shape=([2, 2, 2]))

Sub61190 = keras.layers.Subtract(name = 'Sub61190', )([in0Sub61190,in1Sub61190])
Res56540 = keras.layers.Reshape((3, 1), name = 'Res56540', )(Sub61190)
Res68197 = keras.layers.Reshape((3, 1, 1), name = 'Res68197', )(Res56540)
Zer70949 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer70949', )(Res68197)
Con79155 = keras.layers.Concatenate(axis=3, name = 'Con79155', )([Zer70949,in0Con79155])
Sub52236 = keras.layers.Subtract(name = 'Sub52236', )([in0Sub52236,in1Sub52236])
ReL73227 = keras.layers.ReLU(max_value=1.7454803509241301, negative_slope=4.157235581722307, threshold=6.309116213323244, name = 'ReL73227', )(Sub52236)
Zer84044 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer84044', )(ReL73227)
Max24621 = keras.layers.Maximum(name = 'Max24621', )([Con79155,Zer84044])
model = tf.keras.models.Model(inputs=[in0Sub61190,in1Sub61190,in0Con79155,in0Sub52236,in1Sub52236], outputs=Max24621)
in0Sub61190 = tf.constant([[0.6201, 0.0226, 0.2862]])
in1Sub61190 = tf.constant([[0.646, 0.991, 0.1599]])
in0Con79155 = tf.constant([[[[0.0993], [0.0257], [0.0368]], [[0.7287], [0.345], [0.9496]], [[0.9918], [0.9892], [0.5415]]]])
in0Sub52236 = tf.constant([[[[0.079, 0.6665], [0.7451, 0.9858]], [[0.1731, 0.8753], [0.8872, 0.5229]]]])
in1Sub52236 = tf.constant([[[[0.1597, 0.2587], [0.1832, 0.6889]], [[0.5719, 0.1126], [0.9771, 0.8925]]]])
print (np.array2string(model.predict([in0Sub61190,in1Sub61190,in0Con79155,in0Sub52236,in1Sub52236],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max24621.png')

LSub61190 = subtract_layer([[0.6201, 0.0226, 0.2862]], [[0.646, 0.991, 0.1599]], Sub61190), 
LRes56540 = reshape_layer(Sub61190, [3, 1], Res56540), 
LRes68197 = reshape_layer(Res56540, [3, 1, 1], Res68197), 
LZer70949 = zero_padding2D_layer(Res68197, 0, 0, 2, 0, Zer70949), 
LCon79155 = concatenate_layer([Zer70949,[[[[0.0993], [0.0257], [0.0368]], [[0.7287], [0.345], [0.9496]], [[0.9918], [0.9892], [0.5415]]]]], 3, Con79155), 
LSub52236 = subtract_layer([[[[0.079, 0.6665], [0.7451, 0.9858]], [[0.1731, 0.8753], [0.8872, 0.5229]]]], [[[[0.1597, 0.2587], [0.1832, 0.6889]], [[0.5719, 0.1126], [0.9771, 0.8925]]]], Sub52236), 
LReL73227 = relu_layer(Sub52236, 1.7454803509241301, 4.157235581722307, 6.309116213323244, ReL73227), 
LZer84044 = zero_padding2D_layer(ReL73227, 1, 0, 1, 0, Zer84044), 
LMax24621 = maximum_layer([Con79155,Zer84044], Max24621), 
exec_layers([LSub61190,LRes56540,LRes68197,LZer70949,LCon79155,LSub52236,LReL73227,LZer84044,LMax24621],["Sub61190","Res56540","Res68197","Zer70949","Con79155","Sub52236","ReL73227","Zer84044","Max24621"],Max24621,"Max24621")

Actual (Unparsed): [[[[0.0000000, 0.0993000], [0.0000000, 0.0257000], [0.0000000, 0.0368000]], [[0.0000000, 0.7287000], [0.0000000, 0.3450000], [-0.9684000, 0.9496000]], [[0.0000000, 0.9918000], [0.0000000, 0.9892000], [0.1263000, 0.5415000]]]]

Expected (Unparsed): [[[[0,0.0993],[0,0.0257],[0,0.0368]],[[0,0.7287],[0,0.345],[-0.9684,0.9496]],[[0,0.9918],[0,0.9892],[0.12630000000000002,0.5415]]]]

Actual:   [[[[0, 0.0993], [0, 0.0257], [0, 0.0368]], [[0, 0.7287], [0, 0.345], [-0.9684, 0.9496]], [[0, 0.9918], [0, 0.9892], [0.1263, 0.5415]]]]

Expected: [[[[0, 0.0993], [0, 0.0257], [0, 0.0368]], [[0, 0.7287], [0, 0.345], [-0.9684, 0.9496]], [[0, 0.9918], [0, 0.9892], [0.1264, 0.5415]]]]