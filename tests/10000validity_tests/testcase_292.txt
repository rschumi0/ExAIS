import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dep41053 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min26829 = tf.keras.layers.Input(shape=([2, 1]))
in1Min26829 = tf.keras.layers.Input(shape=([2, 1]))
in0Con77160 = tf.keras.layers.Input(shape=([2, 1]))
in0Sim53186 = tf.keras.layers.Input(shape=([2, 3]))
in0Con31426 = tf.keras.layers.Input(shape=([1]))
in0Add45944 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add45944 = tf.keras.layers.Input(shape=([2, 1, 1]))

Dep41053 = keras.layers.DepthwiseConv2D((1, 1),strides=(2, 2), padding='same', name = 'Dep41053', )(in0Dep41053)
Res45922 = keras.layers.Reshape((1, 2), name = 'Res45922', )(Dep41053)
Zer79795 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer79795', )(Res45922)
Min26829 = keras.layers.Minimum(name = 'Min26829', )([in0Min26829,in1Min26829])
Con77160 = keras.layers.Concatenate(axis=2, name = 'Con77160', )([Min26829,in0Con77160])
Ave179 = keras.layers.Average(name = 'Ave179', )([Zer79795,Con77160])
Fla65643 = keras.layers.Flatten(name = 'Fla65643', )(Ave179)
Sim53186 = keras.layers.SimpleRNN(3,name = 'Sim53186', )(in0Sim53186)
Con31426 = keras.layers.Concatenate(axis=1, name = 'Con31426', )([Sim53186,in0Con31426])
Ave62884 = keras.layers.Average(name = 'Ave62884', )([Fla65643,Con31426])
Res48280 = keras.layers.Reshape((4, 1), name = 'Res48280', )(Ave62884)
Res17829 = keras.layers.Reshape((4, 1, 1), name = 'Res17829', )(Res48280)
Add45944 = keras.layers.Add(name = 'Add45944', )([in0Add45944,in1Add45944])
Zer70703 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer70703', )(Add45944)
Max85346 = keras.layers.Maximum(name = 'Max85346', )([Res17829,Zer70703])
model = tf.keras.models.Model(inputs=[in0Dep41053,in0Min26829,in1Min26829,in0Con77160,in0Sim53186,in0Con31426,in0Add45944,in1Add45944], outputs=Max85346)
w = model.get_layer('Dep41053').get_weights() 
w[0] = np.array([[[[0.4898], [0.5062]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep41053').set_weights(w) 
w = model.get_layer('Sim53186').get_weights() 
w[0] = np.array([[2, 10, 8], [1, 10, 10], [5, 5, 4]])
w[1] = np.array([[6, 7, 5], [5, 10, 10], [3, 3, 5]])
w[2] = np.array([1, 3, 2])
model.get_layer('Sim53186').set_weights(w) 
in0Dep41053 = tf.constant([[[[0.749, 0.4465], [0.3031, 0.752]], [[0.8726, 0.8227], [0.2609, 0.54]]]])
in0Min26829 = tf.constant([[[0.7511], [0.2315]]])
in1Min26829 = tf.constant([[[0.0008], [0.3406]]])
in0Con77160 = tf.constant([[[0.8307], [0.0814]]])
in0Sim53186 = tf.constant([[[9, 1, 10], [5, 2, 2]]])
in0Con31426 = tf.constant([[0.4604]])
in0Add45944 = tf.constant([[[[0.7525]], [[0.3965]]]])
in1Add45944 = tf.constant([[[[0.9358]], [[0.534]]]])
print (np.array2string(model.predict([in0Dep41053,in0Min26829,in1Min26829,in0Con77160,in0Sim53186,in0Con31426,in0Add45944,in1Add45944],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max85346.png')

LDep41053 = depthwise_conv2D_layer([[[[0.749, 0.4465], [0.3031, 0.752]], [[0.8726, 0.8227], [0.2609, 0.54]]]], 1, 1,[[[[0.4898], [0.5062]]]],[0, 0], 2, 2, true, Dep41053), 
LRes45922 = reshape_layer(Dep41053, [1, 2], Res45922), 
LZer79795 = zero_padding1D_layer(Res45922, 1, 0, Zer79795), 
LMin26829 = minimum_layer([[[[0.7511], [0.2315]]], [[[0.0008], [0.3406]]]], Min26829), 
LCon77160 = concatenate_layer([Min26829,[[[0.8307], [0.0814]]]], 2, Con77160), 
LAve179 = average_layer([Zer79795,Con77160], Ave179), 
LFla65643 = flatten_layer(Ave179, Fla65643), 
LSim53186 = simple_rnn_layer([[[9, 1, 10], [5, 2, 2]]],[[2, 10, 8], [1, 10, 10], [5, 5, 4]],[[6, 7, 5], [5, 10, 10], [3, 3, 5]],[1, 3, 2], Sim53186), 
LCon31426 = concatenate_layer([Sim53186,[[0.4604]]], 1, Con31426), 
LAve62884 = average_layer([Fla65643,Con31426], Ave62884), 
LRes48280 = reshape_layer(Ave62884, [4, 1], Res48280), 
LRes17829 = reshape_layer(Res48280, [4, 1, 1], Res17829), 
LAdd45944 = add_layer([[[[[0.7525]], [[0.3965]]]], [[[[0.9358]], [[0.534]]]]], Add45944), 
LZer70703 = zero_padding2D_layer(Add45944, 2, 0, 0, 0, Zer70703), 
LMax85346 = maximum_layer([Res17829,Zer70703], Max85346), 
exec_layers([LDep41053,LRes45922,LZer79795,LMin26829,LCon77160,LAve179,LFla65643,LSim53186,LCon31426,LAve62884,LRes48280,LRes17829,LAdd45944,LZer70703,LMax85346],["Dep41053","Res45922","Zer79795","Min26829","Con77160","Ave179","Fla65643","Sim53186","Con31426","Ave62884","Res48280","Res17829","Add45944","Zer70703","Max85346"],Max85346,"Max85346")

Actual (Unparsed): [[[[0.5002000]], [[0.7076750]], [[1.6883000]], [[0.9305000]]]]

Expected (Unparsed): [[[[0.5002]],[[0.707675]],[[1.6883]],[[0.9305000000000001]]]]

Actual:   [[[[0.5002]], [[0.7077]], [[1.6883]], [[0.9305]]]]

Expected: [[[[0.5002]], [[0.7077]], [[1.6883]], [[0.9306]]]]