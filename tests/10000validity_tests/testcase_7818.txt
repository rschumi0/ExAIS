import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo86624 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con76382 = tf.keras.layers.Input(shape=([3, 1, 1, 1]))
in0Ave77454 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Ave77454 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Glo86624 = keras.layers.GlobalAveragePooling2D(name = 'Glo86624', )(in0Glo86624)
Res4504 = keras.layers.Reshape((2, 1), name = 'Res4504', )(Glo86624)
LST29527 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST29527', )(Res4504)
Res32599 = keras.layers.Reshape((3, 1), name = 'Res32599', )(LST29527)
Res95790 = keras.layers.Reshape((3, 1, 1), name = 'Res95790', )(Res32599)
Res84762 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res84762', )(Res95790)
Con76382 = keras.layers.Concatenate(axis=4, name = 'Con76382', )([Res84762,in0Con76382])
Ave77454 = keras.layers.Average(name = 'Ave77454', )([in0Ave77454,in1Ave77454])
Zer66939 = keras.layers.ZeroPadding3D(padding=((2, 0), (0, 0), (0, 0)), name = 'Zer66939', )(Ave77454)
Min34783 = keras.layers.Minimum(name = 'Min34783', )([Con76382,Zer66939])
model = tf.keras.models.Model(inputs=[in0Glo86624,in0Con76382,in0Ave77454,in1Ave77454], outputs=Min34783)
w = model.get_layer('LST29527').get_weights() 
w[0] = np.array([[9, 7, 10, 3, 7, 3, 1, 3, 8, 10, 1, 10]])
w[1] = np.array([[10, 2, 3, 9, 10, 1, 2, 6, 2, 6, 9, 6], [8, 6, 3, 4, 6, 8, 4, 9, 10, 2, 4, 6], [5, 8, 5, 6, 9, 10, 3, 6, 9, 8, 2, 8]])
w[2] = np.array([7, 4, 7, 9, 4, 8, 4, 6, 1, 10, 1, 6])
model.get_layer('LST29527').set_weights(w) 
in0Glo86624 = tf.constant([[[[1.8311, 1.196]]]])
in0Con76382 = tf.constant([[[[[0.7285]]], [[[0.8906]]], [[[0.4346]]]]])
in0Ave77454 = tf.constant([[[[[0.9944, 0.0998]]]]])
in1Ave77454 = tf.constant([[[[[0.5034, 0.5727]]]]])
print (np.array2string(model.predict([in0Glo86624,in0Con76382,in0Ave77454,in1Ave77454],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min34783.png')

LGlo86624 = global_average_pooling2D_layer([[[[1.8311, 1.196]]]], Glo86624), 
LRes4504 = reshape_layer(Glo86624, [2, 1], Res4504), 
LLST29527 = lstm_layer(Res4504,[[9, 7, 10, 3, 7, 3, 1, 3, 8, 10, 1, 10]],[[10, 2, 3, 9, 10, 1, 2, 6, 2, 6, 9, 6], [8, 6, 3, 4, 6, 8, 4, 9, 10, 2, 4, 6], [5, 8, 5, 6, 9, 10, 3, 6, 9, 8, 2, 8]],[7, 4, 7, 9, 4, 8, 4, 6, 1, 10, 1, 6], LST29527), 
LRes32599 = reshape_layer(LST29527, [3, 1], Res32599), 
LRes95790 = reshape_layer(Res32599, [3, 1, 1], Res95790), 
LRes84762 = reshape_layer(Res95790, [3, 1, 1, 1], Res84762), 
LCon76382 = concatenate_layer([Res84762,[[[[[0.7285]]], [[[0.8906]]], [[[0.4346]]]]]], 4, Con76382), 
LAve77454 = average_layer([[[[[[0.9944, 0.0998]]]]], [[[[[0.5034, 0.5727]]]]]], Ave77454), 
LZer66939 = zero_padding3D_layer(Ave77454, 2, 0, 0, 0, 0, 0, Zer66939), 
LMin34783 = minimum_layer([Con76382,Zer66939], Min34783), 
exec_layers([LGlo86624,LRes4504,LLST29527,LRes32599,LRes95790,LRes84762,LCon76382,LAve77454,LZer66939,LMin34783],["Glo86624","Res4504","LST29527","Res32599","Res95790","Res84762","Con76382","Ave77454","Zer66939","Min34783"],Min34783,"Min34783")

Actual (Unparsed): [[[[[0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000]]], [[[0.7489000, 0.3362500]]]]]

Expected (Unparsed): [[[[[0,0]]],[[[0,0]]],[[[0.7488999999999999,0.33625]]]]]

Actual:   [[[[[0, 0]]], [[[0, 0]]], [[[0.7489, 0.3363]]]]]

Expected: [[[[[0, 0]]], [[[0, 0]]], [[[0.7489, 0.3363]]]]]