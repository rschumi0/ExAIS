import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub41442 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub41442 = tf.keras.layers.Input(shape=([2, 3]))

Sub41442 = keras.layers.Subtract(name = 'Sub41442', )([in0Sub41442,in1Sub41442])
Fla67714 = keras.layers.Flatten(name = 'Fla67714', )(Sub41442)
Res26395 = keras.layers.Reshape((6, 1), name = 'Res26395', )(Fla67714)
Res61157 = keras.layers.Reshape((6, 1, 1), name = 'Res61157', )(Res26395)
Con39994 = keras.layers.Conv2D(2, (3, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con39994', )(Res61157)
model = tf.keras.models.Model(inputs=[in0Sub41442,in1Sub41442], outputs=Con39994)
w = model.get_layer('Con39994').get_weights() 
w[0] = np.array([[[[0.0233, 0.0071]]], [[[0.7733, 0.4534]]], [[[0.7695, 0.3082]]]])
w[1] = np.array([0, 0])
model.get_layer('Con39994').set_weights(w) 
in0Sub41442 = tf.constant([[[0.0984, 0.1051, 0.983], [0.5007, 0.9512, 0.8069]]])
in1Sub41442 = tf.constant([[[0.4875, 0.765, 0.0661], [0.4521, 0.32, 0.9366]]])
print (np.array2string(model.predict([in0Sub41442,in1Sub41442],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con39994.png')

LSub41442 = subtract_layer([[[0.0984, 0.1051, 0.983], [0.5007, 0.9512, 0.8069]]], [[[0.4875, 0.765, 0.0661], [0.4521, 0.32, 0.9366]]], Sub41442), 
LFla67714 = flatten_layer(Sub41442, Fla67714), 
LRes26395 = reshape_layer(Fla67714, [6, 1], Res26395), 
LRes61157 = reshape_layer(Res26395, [6, 1, 1], Res61157), 
LCon39994 = conv2D_layer(Res61157, 3, 1,[[[[0.0233, 0.0071]]], [[[0.7733, 0.4534]]], [[[0.7695, 0.3082]]]],[0, 0], 1, 1, true, 1, 1, Con39994), 
exec_layers([LSub41442,LFla67714,LRes26395,LRes61157,LCon39994],["Sub41442","Fla67714","Res26395","Res61157","Con39994"],Con39994,"Con39994")

Actual (Unparsed): [[[[-0.8086841, -0.3797991]], [[0.1861878, -0.0193727]], [[0.7310608, 0.4260157]], [[0.5446546, 0.2230811]], [[0.3894352, 0.2465576]], [[-0.0855901, -0.0543245]]]]

Expected (Unparsed): [[[[-0.8086840799999999,-0.37979912000000005]],[[0.18618784999999993,-0.01937269000000008]],[[0.7310608,0.42601569]],[[0.54465455,0.22308107]],[[0.38943518999999993,0.24655760000000002]],[[-0.08559005000000003,-0.05432446000000002]]]]

Actual:   [[[[-0.8086, -0.3797]], [[0.1862, -0.0193]], [[0.7311, 0.4261]], [[0.5447, 0.2231]], [[0.3895, 0.2466]], [[-0.0855, -0.0543]]]]

Expected: [[[[-0.8086, -0.3797]], [[0.1862, -0.0193]], [[0.7311, 0.4261]], [[0.5447, 0.2231]], [[0.3895, 0.2466]], [[-0.0855, -0.0543]]]]