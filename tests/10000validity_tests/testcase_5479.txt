import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max53865 = tf.keras.layers.Input(shape=([2, 2]))
in1Max53865 = tf.keras.layers.Input(shape=([2, 2]))

Max53865 = keras.layers.Maximum(name = 'Max53865', )([in0Max53865,in1Max53865])
Res51185 = keras.layers.Reshape((2, 2, 1), name = 'Res51185', )(Max53865)
Loc12812 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc12812', )(Res51185)
Res93611 = keras.layers.Reshape((2, 8), name = 'Res93611', )(Loc12812)
Up_37893 = keras.layers.UpSampling1D(size=(2), name = 'Up_37893', )(Res93611)
model = tf.keras.models.Model(inputs=[in0Max53865,in1Max53865], outputs=Up_37893)
w = model.get_layer('Loc12812').get_weights() 
w[0] = np.array([[[0.8997, 0.2105, 0.0546, 0.7095]], [[0.0635, 0.7885, 0.4732, 0.2969]], [[0.9116, 0.5411, 0.8922, 0.9741]], [[0.3144, 0.4687, 0.2584, 0.1039]]])
w[1] = np.array([[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0]]])
model.get_layer('Loc12812').set_weights(w) 
in0Max53865 = tf.constant([[[0.0434, 0.6881], [0.2508, 0.6438]]])
in1Max53865 = tf.constant([[[0.3444, 0.4073], [0.0222, 0.47]]])
print (np.array2string(model.predict([in0Max53865,in1Max53865],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_37893.png')

LMax53865 = maximum_layer([[[[0.0434, 0.6881], [0.2508, 0.6438]]], [[[0.3444, 0.4073], [0.0222, 0.47]]]], Max53865), 
LRes51185 = reshape_layer(Max53865, [2, 2, 1], Res51185), 
LLoc12812 = locally_connected2D_layer(Res51185, 1, 1,[[[0.8997, 0.2105, 0.0546, 0.7095]], [[0.0635, 0.7885, 0.4732, 0.2969]], [[0.9116, 0.5411, 0.8922, 0.9741]], [[0.3144, 0.4687, 0.2584, 0.1039]]],[[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0]]], 1, 1, Loc12812), 
LRes93611 = reshape_layer(Loc12812, [2, 8], Res93611), 
LUp_37893 = up_sampling1D_layer(Res93611, 2, Up_37893), 
exec_layers([LMax53865,LRes51185,LLoc12812,LRes93611,LUp_37893],["Max53865","Res51185","Loc12812","Res93611","Up_37893"],Up_37893,"Up_37893")

Actual (Unparsed): [[[0.3098567, 0.0724962, 0.0188042, 0.2443518, 0.0436943, 0.5425668, 0.3256089, 0.2042969], [0.3098567, 0.0724962, 0.0188042, 0.2443518, 0.0436943, 0.5425668, 0.3256089, 0.2042969], [0.2286293, 0.1357079, 0.2237638, 0.2443043, 0.2024107, 0.3017491, 0.1663579, 0.0668908], [0.2286293, 0.1357079, 0.2237638, 0.2443043, 0.2024107, 0.3017491, 0.1663579, 0.0668908]]]

Expected (Unparsed): [[[0.30985668,0.0724962,0.01880424,0.2443518,0.04369435000000001,0.54256685,0.32560892,0.20429689],[0.30985668,0.0724962,0.01880424,0.2443518,0.04369435000000001,0.54256685,0.32560892,0.20429689],[0.22862928000000002,0.13570788000000003,0.22376376,0.24430428,0.20241072000000002,0.30174906,0.16635792000000002,0.06689082],[0.22862928000000002,0.13570788000000003,0.22376376,0.24430428,0.20241072000000002,0.30174906,0.16635792000000002,0.06689082]]]

Actual:   [[[0.3099, 0.0725, 0.0189, 0.2444, 0.0437, 0.5426, 0.3257, 0.2043], [0.3099, 0.0725, 0.0189, 0.2444, 0.0437, 0.5426, 0.3257, 0.2043], [0.2287, 0.1358, 0.2238, 0.2444, 0.2025, 0.3018, 0.1664, 0.0669], [0.2287, 0.1358, 0.2238, 0.2444, 0.2025, 0.3018, 0.1664, 0.0669]]]

Expected: [[[0.3099, 0.0725, 0.0189, 0.2444, 0.0437, 0.5426, 0.3257, 0.2043], [0.3099, 0.0725, 0.0189, 0.2444, 0.0437, 0.5426, 0.3257, 0.2043], [0.2287, 0.1358, 0.2238, 0.2444, 0.2025, 0.3018, 0.1664, 0.0669], [0.2287, 0.1358, 0.2238, 0.2444, 0.2025, 0.3018, 0.1664, 0.0669]]]