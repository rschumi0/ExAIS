import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave11860 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Ave11860 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Add53334 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add53334 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con47680 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave59104 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave59104 = tf.keras.layers.Input(shape=([2, 1, 2]))

Ave11860 = keras.layers.Average(name = 'Ave11860', )([in0Ave11860,in1Ave11860])
Res27359 = keras.layers.Reshape((2, 2, 2), name = 'Res27359', )(Ave11860)
Add53334 = keras.layers.Add(name = 'Add53334', )([in0Add53334,in1Add53334])
Zer33815 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer33815', )(Add53334)
Con47680 = keras.layers.Concatenate(axis=3, name = 'Con47680', )([Zer33815,in0Con47680])
Mul54952 = keras.layers.Multiply(name = 'Mul54952', )([Res27359,Con47680])
Ave59104 = keras.layers.Average(name = 'Ave59104', )([in0Ave59104,in1Ave59104])
Zer53623 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer53623', )(Ave59104)
Max68419 = keras.layers.Maximum(name = 'Max68419', )([Mul54952,Zer53623])
model = tf.keras.models.Model(inputs=[in0Ave11860,in1Ave11860,in0Add53334,in1Add53334,in0Con47680,in0Ave59104,in1Ave59104], outputs=Max68419)
in0Ave11860 = tf.constant([[[[[0.5341, 0.5772]], [[0.8442, 0.8893]]], [[[0.5579, 0.9614]], [[0.9429, 0.3055]]]]])
in1Ave11860 = tf.constant([[[[[0.3274, 0.9965]], [[0.1799, 0.2677]]], [[[0.7381, 0.3502]], [[0.9183, 0.2639]]]]])
in0Add53334 = tf.constant([[[[0.3859], [0.1212]]]])
in1Add53334 = tf.constant([[[[0.6716], [0.0761]]]])
in0Con47680 = tf.constant([[[[0.893], [0.076]], [[0.0247], [0.8302]]]])
in0Ave59104 = tf.constant([[[[0.7019, 0.8009]], [[0.6832, 0.8421]]]])
in1Ave59104 = tf.constant([[[[0.7123, 0.2491]], [[0.0456, 0.939]]]])
print (np.array2string(model.predict([in0Ave11860,in1Ave11860,in0Add53334,in1Add53334,in0Con47680,in0Ave59104,in1Ave59104],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max68419.png')

LAve11860 = average_layer([[[[[[0.5341, 0.5772]], [[0.8442, 0.8893]]], [[[0.5579, 0.9614]], [[0.9429, 0.3055]]]]], [[[[[0.3274, 0.9965]], [[0.1799, 0.2677]]], [[[0.7381, 0.3502]], [[0.9183, 0.2639]]]]]], Ave11860), 
LRes27359 = reshape_layer(Ave11860, [2, 2, 2], Res27359), 
LAdd53334 = add_layer([[[[[0.3859], [0.1212]]]], [[[[0.6716], [0.0761]]]]], Add53334), 
LZer33815 = zero_padding2D_layer(Add53334, 1, 0, 0, 0, Zer33815), 
LCon47680 = concatenate_layer([Zer33815,[[[[0.893], [0.076]], [[0.0247], [0.8302]]]]], 3, Con47680), 
LMul54952 = multiply_layer([Res27359,Con47680], Mul54952), 
LAve59104 = average_layer([[[[[0.7019, 0.8009]], [[0.6832, 0.8421]]]], [[[[0.7123, 0.2491]], [[0.0456, 0.939]]]]], Ave59104), 
LZer53623 = zero_padding2D_layer(Ave59104, 0, 0, 1, 0, Zer53623), 
LMax68419 = maximum_layer([Mul54952,Zer53623], Max68419), 
exec_layers([LAve11860,LRes27359,LAdd53334,LZer33815,LCon47680,LMul54952,LAve59104,LZer53623,LMax68419],["Ave11860","Res27359","Add53334","Zer33815","Con47680","Mul54952","Ave59104","Zer53623","Max68419"],Max68419,"Max68419")

Actual (Unparsed): [[[[0.0000000, 0.7026571], [0.7071000, 0.5250000]], [[0.6852600, 0.0161983], [0.3644000, 0.8905500]]]]

Expected (Unparsed): [[[[0.0,0.70265705],[0.7071000000000001,0.5249999999999999]],[[0.68526,0.016198260000000003],[0.3644,0.89055]]]]

Actual:   [[[[0, 0.7027], [0.7071, 0.525]], [[0.6853, 0.0162], [0.3644, 0.8906]]]]

Expected: [[[[0, 0.7027], [0.7072, 0.525]], [[0.6853, 0.0162], [0.3644, 0.8906]]]]