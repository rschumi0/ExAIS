import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max47171 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max47171 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Zer67187 = tf.keras.layers.Input(shape=([3, 1]))
in0Con64664 = tf.keras.layers.Input(shape=([5, 1]))

Max47171 = keras.layers.Maximum(name = 'Max47171', )([in0Max47171,in1Max47171])
Res2006 = keras.layers.Reshape((2, 2), name = 'Res2006', )(Max47171)
Zer26209 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer26209', )(Res2006)
Zer67187 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer67187', )(in0Zer67187)
Mas46964 = keras.layers.Masking(mask_value=2, name = 'Mas46964', )(Zer67187)
Con64664 = keras.layers.Concatenate(axis=2, name = 'Con64664', )([Mas46964,in0Con64664])
Mul63176 = keras.layers.Multiply(name = 'Mul63176', )([Zer26209,Con64664])
Cro52696 = keras.layers.Cropping1D(cropping=((3, 0)), name = 'Cro52696', )(Mul63176)
model = tf.keras.models.Model(inputs=[in0Max47171,in1Max47171,in0Zer67187,in0Con64664], outputs=Cro52696)
in0Max47171 = tf.constant([[[[0.5018], [0.7714]], [[0.9613], [0.1496]]]])
in1Max47171 = tf.constant([[[[0.6725], [0.8232]], [[0.3407], [0.5702]]]])
in0Zer67187 = tf.constant([[[1.7053], [1.4216], [1.3502]]])
in0Con64664 = tf.constant([[[0.0595], [0.7726], [0.2963], [0.2917], [0.6437]]])
print (np.array2string(model.predict([in0Max47171,in1Max47171,in0Zer67187,in0Con64664],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro52696.png')

LMax47171 = maximum_layer([[[[[0.5018], [0.7714]], [[0.9613], [0.1496]]]], [[[[0.6725], [0.8232]], [[0.3407], [0.5702]]]]], Max47171), 
LRes2006 = reshape_layer(Max47171, [2, 2], Res2006), 
LZer26209 = zero_padding1D_layer(Res2006, 3, 0, Zer26209), 
LZer67187 = zero_padding1D_layer([[[1.7053], [1.4216], [1.3502]]], 1, 1, Zer67187), 
LMas46964 = masking_layer(Zer67187, 2, Mas46964), 
LCon64664 = concatenate_layer([Mas46964,[[[0.0595], [0.7726], [0.2963], [0.2917], [0.6437]]]], 2, Con64664), 
LMul63176 = multiply_layer([Zer26209,Con64664], Mul63176), 
LCro52696 = cropping1D_layer(Mul63176, 3, 0, Cro52696), 
exec_layers([LMax47171,LRes2006,LZer26209,LZer67187,LMas46964,LCon64664,LMul63176,LCro52696],["Max47171","Res2006","Zer26209","Zer67187","Mas46964","Con64664","Mul63176","Cro52696"],Cro52696,"Cro52696")

Actual (Unparsed): [[[0.9080096, 0.2401274], [0.0000000, 0.3670378]]]

Expected (Unparsed): [[[0.9080095,0.24012744000000003],[0.0,0.36703774000000006]]]

Actual:   [[[0.9081, 0.2402], [0, 0.3671]]]

Expected: [[[0.9081, 0.2402], [0, 0.3671]]]