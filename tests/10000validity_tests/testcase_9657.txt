import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub59348 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub59348 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Ave59310 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave59310 = tf.keras.layers.Input(shape=([2, 1]))
in0Con76545 = tf.keras.layers.Input(shape=([3, 8]))
in0Con31030 = tf.keras.layers.Input(shape=([4, 17, 3]))
in0Lay93206 = tf.keras.layers.Input(shape=([4, 1, 4]))

Sub59348 = keras.layers.Subtract(name = 'Sub59348', )([in0Sub59348,in1Sub59348])
Res79062 = keras.layers.Reshape((3, 9), name = 'Res79062', )(Sub59348)
Ave59310 = keras.layers.Average(name = 'Ave59310', )([in0Ave59310,in1Ave59310])
Zer4664 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer4664', )(Ave59310)
Con76545 = keras.layers.Concatenate(axis=2, name = 'Con76545', )([Zer4664,in0Con76545])
Min33534 = keras.layers.Minimum(name = 'Min33534', )([Res79062,Con76545])
Res89612 = keras.layers.Reshape((3, 9, 1), name = 'Res89612', )(Min33534)
Zer94476 = keras.layers.ZeroPadding2D(padding=((1, 0), (8, 0)), name = 'Zer94476', )(Res89612)
Con31030 = keras.layers.Concatenate(axis=3, name = 'Con31030', )([Zer94476,in0Con31030])
Lay93206 = keras.layers.LayerNormalization(axis=1, epsilon=2.247767397363047, name = 'Lay93206', )(in0Lay93206)
Zer15828 = keras.layers.ZeroPadding2D(padding=((0, 0), (16, 0)), name = 'Zer15828', )(Lay93206)
Ave35122 = keras.layers.Average(name = 'Ave35122', )([Con31030,Zer15828])
model = tf.keras.models.Model(inputs=[in0Sub59348,in1Sub59348,in0Ave59310,in1Ave59310,in0Con76545,in0Con31030,in0Lay93206], outputs=Ave35122)
in0Sub59348 = tf.constant([[[[0.1155, 0.6208, 0.3978], [0.4591, 0.0467, 0.2611], [0.4391, 0.1307, 0.5125]], [[0.9944, 0.7653, 0.0244], [0.2029, 0.3589, 0.909], [0.3548, 0.2216, 0.8092]], [[0.7168, 0.1791, 0.4897], [0.5233, 0.4536, 0.8211], [0.4653, 0.2304, 0.2024]]]])
in1Sub59348 = tf.constant([[[[0.4037, 0.5491, 0.9503], [0.2533, 0.7219, 0.2616], [0.6042, 0.1583, 0.6538]], [[0.7837, 0.5602, 0.399], [0.7953, 0.7293, 0.31], [0.1597, 0.0344, 0.0875]], [[0.6388, 0.5261, 0.3312], [0.112, 0.8469, 0.5453], [0.0607, 0.5637, 0.8077]]]])
in0Ave59310 = tf.constant([[[0.9679], [0.8911]]])
in1Ave59310 = tf.constant([[[0.1203], [0.908]]])
in0Con76545 = tf.constant([[[0.1849, 0.1339, 0.319, 0.0296, 0.7655, 0.8336, 0.4248, 0.3927], [0.9507, 0.439, 0.2675, 0.4962, 0.3926, 0.6748, 0.4321, 0.655], [0.5118, 0.0466, 0.9792, 0.4006, 0.6022, 0.5636, 0.6553, 0.9025]]])
in0Con31030 = tf.constant([[[[0.1043, 0.5725, 0.6295], [0.9545, 0.5944, 0.9308], [0.9926, 0.4268, 0.6814], [0.3922, 0.2763, 0.5489], [0.6397, 0.6556, 0.4691], [0.5833, 0.609, 0.4159], [0.4384, 0.225, 0.6529], [0.0182, 0.6328, 0.1092], [0.2862, 0.2181, 0.2175], [0.5215, 0.4986, 0.556], [0.4393, 0.9199, 0.0399], [0.5638, 0.2731, 0.7298], [0.748, 0.2655, 0.4308], [0.7579, 0.9985, 0.2088], [0.6298, 0.4843, 0.9328], [0.5697, 0.6104, 0.44], [0.9851, 0.7077, 0.7691]], [[0.8544, 0.3658, 0.9212], [0.4316, 0.7641, 0.5868], [0.047, 0.7277, 0.8177], [0.8129, 0.9824, 0.7492], [0.0799, 0.8133, 0.1696], [0.1756, 0.2415, 0.5519], [0.5726, 0.8299, 0.777], [0.0023, 0.7062, 0.6964], [0.7535, 0.6037, 0.8259], [0.7705, 0.1948, 0.8844], [0.4815, 0.7425, 0.1288], [0.1698, 0.2492, 0.9205], [0.707, 0.9657, 0.6101], [0.9874, 0.0737, 0.5627], [0.6231, 0.1579, 0.9859], [0.6392, 0.2498, 0.049], [0.5339, 0.1634, 0.9363]], [[0.1149, 0.7002, 0.6847], [0.3272, 0.8048, 0.9069], [0.1917, 0.795, 0.7017], [0.1488, 0.068, 0.8044], [0.7733, 0.7871, 0.3237], [0.9993, 0.5253, 0.5868], [0.1988, 0.2999, 0.2833], [0.1224, 0.4429, 0.2269], [0.0527, 0.2453, 0.0579], [0.1335, 0.4038, 0.9118], [0.0586, 0.0172, 0.6135], [0.3011, 0.8538, 0.1093], [0.8577, 0.8219, 0.1783], [0.495, 0.5926, 0.2977], [0.1191, 0.6035, 0.3915], [0.3525, 0.6676, 0.5271], [0.4076, 0.7747, 0.4056]], [[0.7752, 0.3238, 0.4289], [0.3839, 0.2529, 0.121], [0.1057, 0.9905, 0.9636], [0.2447, 0.5508, 0.6194], [0.1785, 0.7839, 0.8024], [0.2516, 0.591, 0.0903], [0.8759, 0.6366, 0.2791], [0.8582, 0.7858, 0.6235], [0.136, 0.0634, 0.8683], [0.3343, 0.7975, 0.3164], [0.3804, 0.2927, 0.9938], [0.1231, 0.3888, 0.3262], [0.6834, 0.2653, 0.034], [0.0452, 0.2911, 0.0173], [0.358, 0.9701, 0.8619], [0.192, 0.0176, 0.9226], [0.9698, 0.0794, 0.3694]]]])
in0Lay93206 = tf.constant([[[[1.1715, 1.3215, 1.9523, 1.2033]], [[1.7147, 1.6819, 1.4384, 1.446]], [[1.209, 1.612, 1.7406, 1.9929]], [[1.7116, 1.7768, 1.4941, 1.9853]]]])
print (np.array2string(model.predict([in0Sub59348,in1Sub59348,in0Ave59310,in1Ave59310,in0Con76545,in0Con31030,in0Lay93206],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave35122.png')

LSub59348 = subtract_layer([[[[0.1155, 0.6208, 0.3978], [0.4591, 0.0467, 0.2611], [0.4391, 0.1307, 0.5125]], [[0.9944, 0.7653, 0.0244], [0.2029, 0.3589, 0.909], [0.3548, 0.2216, 0.8092]], [[0.7168, 0.1791, 0.4897], [0.5233, 0.4536, 0.8211], [0.4653, 0.2304, 0.2024]]]], [[[[0.4037, 0.5491, 0.9503], [0.2533, 0.7219, 0.2616], [0.6042, 0.1583, 0.6538]], [[0.7837, 0.5602, 0.399], [0.7953, 0.7293, 0.31], [0.1597, 0.0344, 0.0875]], [[0.6388, 0.5261, 0.3312], [0.112, 0.8469, 0.5453], [0.0607, 0.5637, 0.8077]]]], Sub59348), 
LRes79062 = reshape_layer(Sub59348, [3, 9], Res79062), 
LAve59310 = average_layer([[[[0.9679], [0.8911]]], [[[0.1203], [0.908]]]], Ave59310), 
LZer4664 = zero_padding1D_layer(Ave59310, 1, 0, Zer4664), 
LCon76545 = concatenate_layer([Zer4664,[[[0.1849, 0.1339, 0.319, 0.0296, 0.7655, 0.8336, 0.4248, 0.3927], [0.9507, 0.439, 0.2675, 0.4962, 0.3926, 0.6748, 0.4321, 0.655], [0.5118, 0.0466, 0.9792, 0.4006, 0.6022, 0.5636, 0.6553, 0.9025]]]], 2, Con76545), 
LMin33534 = minimum_layer([Res79062,Con76545], Min33534), 
LRes89612 = reshape_layer(Min33534, [3, 9, 1], Res89612), 
LZer94476 = zero_padding2D_layer(Res89612, 1, 0, 8, 0, Zer94476), 
LCon31030 = concatenate_layer([Zer94476,[[[[0.1043, 0.5725, 0.6295], [0.9545, 0.5944, 0.9308], [0.9926, 0.4268, 0.6814], [0.3922, 0.2763, 0.5489], [0.6397, 0.6556, 0.4691], [0.5833, 0.609, 0.4159], [0.4384, 0.225, 0.6529], [0.0182, 0.6328, 0.1092], [0.2862, 0.2181, 0.2175], [0.5215, 0.4986, 0.556], [0.4393, 0.9199, 0.0399], [0.5638, 0.2731, 0.7298], [0.748, 0.2655, 0.4308], [0.7579, 0.9985, 0.2088], [0.6298, 0.4843, 0.9328], [0.5697, 0.6104, 0.44], [0.9851, 0.7077, 0.7691]], [[0.8544, 0.3658, 0.9212], [0.4316, 0.7641, 0.5868], [0.047, 0.7277, 0.8177], [0.8129, 0.9824, 0.7492], [0.0799, 0.8133, 0.1696], [0.1756, 0.2415, 0.5519], [0.5726, 0.8299, 0.777], [0.0023, 0.7062, 0.6964], [0.7535, 0.6037, 0.8259], [0.7705, 0.1948, 0.8844], [0.4815, 0.7425, 0.1288], [0.1698, 0.2492, 0.9205], [0.707, 0.9657, 0.6101], [0.9874, 0.0737, 0.5627], [0.6231, 0.1579, 0.9859], [0.6392, 0.2498, 0.049], [0.5339, 0.1634, 0.9363]], [[0.1149, 0.7002, 0.6847], [0.3272, 0.8048, 0.9069], [0.1917, 0.795, 0.7017], [0.1488, 0.068, 0.8044], [0.7733, 0.7871, 0.3237], [0.9993, 0.5253, 0.5868], [0.1988, 0.2999, 0.2833], [0.1224, 0.4429, 0.2269], [0.0527, 0.2453, 0.0579], [0.1335, 0.4038, 0.9118], [0.0586, 0.0172, 0.6135], [0.3011, 0.8538, 0.1093], [0.8577, 0.8219, 0.1783], [0.495, 0.5926, 0.2977], [0.1191, 0.6035, 0.3915], [0.3525, 0.6676, 0.5271], [0.4076, 0.7747, 0.4056]], [[0.7752, 0.3238, 0.4289], [0.3839, 0.2529, 0.121], [0.1057, 0.9905, 0.9636], [0.2447, 0.5508, 0.6194], [0.1785, 0.7839, 0.8024], [0.2516, 0.591, 0.0903], [0.8759, 0.6366, 0.2791], [0.8582, 0.7858, 0.6235], [0.136, 0.0634, 0.8683], [0.3343, 0.7975, 0.3164], [0.3804, 0.2927, 0.9938], [0.1231, 0.3888, 0.3262], [0.6834, 0.2653, 0.034], [0.0452, 0.2911, 0.0173], [0.358, 0.9701, 0.8619], [0.192, 0.0176, 0.9226], [0.9698, 0.0794, 0.3694]]]]], 3, Con31030), 
LLay93206 = layer_normalization_layer([[[[1.1715, 1.3215, 1.9523, 1.2033]], [[1.7147, 1.6819, 1.4384, 1.446]], [[1.209, 1.612, 1.7406, 1.9929]], [[1.7116, 1.7768, 1.4941, 1.9853]]]], 1, 2.247767397363047, Lay93206), 
LZer15828 = zero_padding2D_layer(Lay93206, 0, 0, 16, 0, Zer15828), 
LAve35122 = average_layer([Con31030,Zer15828], Ave35122), 
exec_layers([LSub59348,LRes79062,LAve59310,LZer4664,LCon76545,LMin33534,LRes89612,LZer94476,LCon31030,LLay93206,LZer15828,LAve35122],["Sub59348","Res79062","Ave59310","Zer4664","Con76545","Min33534","Res89612","Zer94476","Con31030","Lay93206","Zer15828","Ave35122"],Ave35122,"Ave35122")

Actual (Unparsed): [[[[0.0000000, 0.0521500, 0.2862500, 0.3147500], [0.0000000, 0.4772500, 0.2972000, 0.4654000], [0.0000000, 0.4963000, 0.2134000, 0.3407000], [0.0000000, 0.1961000, 0.1381500, 0.2744500], [0.0000000, 0.3198500, 0.3278000, 0.2345500], [0.0000000, 0.2916500, 0.3045000, 0.2079500], [0.0000000, 0.2192000, 0.1125000, 0.3264500], [0.0000000, 0.0091000, 0.3164000, 0.0546000], [0.0000000, 0.1431000, 0.1090500, 0.1087500], [0.0000000, 0.2607500, 0.2493000, 0.2780000], [0.0000000, 0.2196500, 0.4599500, 0.0199500], [0.0000000, 0.2819000, 0.1365500, 0.3649000], [0.0000000, 0.3740000, 0.1327500, 0.2154000], [0.0000000, 0.3789500, 0.4992500, 0.1044000], [0.0000000, 0.3149000, 0.2421500, 0.4664000], [0.0000000, 0.2848500, 0.3052000, 0.2200000], [-0.0920536, 0.4009084, 0.4516369, 0.2370960]], [[0.0000000, 0.4272000, 0.1829000, 0.4606000], [0.0000000, 0.2158000, 0.3820500, 0.2934000], [0.0000000, 0.0235000, 0.3638500, 0.4088500], [0.0000000, 0.4064500, 0.4912000, 0.3746000], [0.0000000, 0.0399500, 0.4066500, 0.0848000], [0.0000000, 0.0878000, 0.1207500, 0.2759500], [0.0000000, 0.2863000, 0.4149500, 0.3885000], [0.0000000, 0.0011500, 0.3531000, 0.3482000], [-0.1441000, 0.3767500, 0.3018500, 0.4129500], [0.0358500, 0.3852500, 0.0974000, 0.4422000], [-0.2762500, 0.2407500, 0.3712500, 0.0644000], [0.1029000, 0.0849000, 0.1246000, 0.4602500], [-0.3376000, 0.3535000, 0.4828500, 0.3050500], [-0.0002500, 0.4937000, 0.0368500, 0.2813500], [-0.0825500, 0.3115500, 0.0789500, 0.4929500], [-0.0138000, 0.3196000, 0.1249000, 0.0245000], [0.0157529, 0.2947358, 0.0096857, 0.3995960]], [[0.0000000, 0.0574500, 0.3501000, 0.3423500], [0.0000000, 0.1636000, 0.4024000, 0.4534500], [0.0000000, 0.0958500, 0.3975000, 0.3508500], [0.0000000, 0.0744000, 0.0340000, 0.4022000], [0.0000000, 0.3866500, 0.3935500, 0.1618500], [0.0000000, 0.4996500, 0.2626500, 0.2934000], [0.0000000, 0.0994000, 0.1499500, 0.1416500], [0.0000000, 0.0612000, 0.2214500, 0.1134500], [0.1053500, 0.0263500, 0.1226500, 0.0289500], [0.1025500, 0.0667500, 0.2019000, 0.4559000], [-0.1873000, 0.0293000, 0.0086000, 0.3067500], [-0.2962000, 0.1505500, 0.4269000, 0.0546500], [-0.1852000, 0.4288500, 0.4109500, 0.0891500], [0.1963000, 0.2475000, 0.2963000, 0.1488500], [0.0975500, 0.0595500, 0.3017500, 0.1957500], [0.0936000, 0.1762500, 0.3338000, 0.2635500], [0.2477662, 0.2084227, 0.4151876, 0.3120394]], [[0.0000000, 0.3876000, 0.1619000, 0.2144500], [0.0000000, 0.1919500, 0.1264500, 0.0605000], [0.0000000, 0.0528500, 0.4952500, 0.4818000], [0.0000000, 0.1223500, 0.2754000, 0.3097000], [0.0000000, 0.0892500, 0.3919500, 0.4012000], [0.0000000, 0.1258000, 0.2955000, 0.0451500], [0.0000000, 0.4379500, 0.3183000, 0.1395500], [0.0000000, 0.4291000, 0.3929000, 0.3117500], [0.0390000, 0.0680000, 0.0317000, 0.4341500], [-0.1735000, 0.1671500, 0.3987500, 0.1582000], [0.0233000, 0.1902000, 0.1463500, 0.4969000], [0.2056500, 0.0615500, 0.1944000, 0.1631000], [-0.1966500, 0.3417000, 0.1326500, 0.0170000], [0.1379000, 0.0226000, 0.1455500, 0.0086500], [0.2023000, 0.1790000, 0.4850500, 0.4309500], [-0.1666500, 0.0960000, 0.0088000, 0.4613000], [-0.2172655, 0.5441332, -0.0139101, 0.2914686]]]]

Expected (Unparsed): [[[[0,0.05215,0.28625,0.31475],[0,0.47725,0.2972,0.4654],[0,0.4963,0.2134,0.3407],[0,0.1961,0.13815,0.27445],[0,0.31985,0.3278,0.23455],[0,0.29165,0.3045,0.20795],[0,0.2192,0.1125,0.32645],[0,0.0091,0.3164,0.0546],[0,0.1431,0.10905,0.10875],[0,0.26075,0.2493,0.278],[0,0.21965,0.45995,0.01995],[0,0.2819,0.13655,0.3649],[0,0.374,0.13275,0.2154],[0,0.37895,0.49925,0.1044],[0,0.3149,0.24215,0.4664],[0,0.28485,0.3052,0.22],[-0.09205358072626589,0.40090843094133133,0.45163686722368374,0.23709597578473135]],[[0,0.4272,0.1829,0.4606],[0,0.2158,0.38205,0.2934],[0,0.0235,0.36385,0.40885],[0,0.40645,0.4912,0.3746],[0,0.03995,0.40665,0.0848],[0,0.0878,0.12075,0.27595],[0,0.2863,0.41495,0.3885],[0,0.00115,0.3531,0.3482],[-0.1441,0.37675,0.30185,0.41295],[0.03584999999999999,0.38525,0.0974,0.4422],[-0.27625,0.24075,0.37125,0.0644],[0.10289999999999999,0.0849,0.1246,0.46025],[-0.3376,0.3535,0.48285,0.30505],[-0.0002500000000000002,0.4937,0.03685,0.28135],[-0.08254999999999998,0.31155,0.07895,0.49295],[-0.013799999999999993,0.3196,0.1249,0.0245],[0.015752896970049626,0.29473573699356126,0.009685647199182815,0.3995960290880345]],[[0,0.05745,0.3501,0.34235],[0,0.1636,0.4024,0.45345],[0,0.09585,0.3975,0.35085],[0,0.0744,0.034,0.4022],[0,0.38665,0.39355,0.16185],[0,0.49965,0.26265,0.2934],[0,0.0994,0.14995,0.14165],[0,0.0612,0.22145,0.11345],[0.10535,0.02635,0.12265,0.02895],[0.10254999999999997,0.06675,0.2019,0.4559],[-0.18730000000000002,0.0293,0.0086,0.30675],[-0.2962,0.15055,0.4269,0.05465],[-0.18519999999999998,0.42885,0.41095,0.08915],[0.1963,0.2475,0.2963,0.14885],[0.09755,0.05955,0.30175,0.19575],[0.09359999999999999,0.17625,0.3338,0.26355],[0.24776622397478687,0.2084226718075156,0.4151876197452116,0.3120393506849709]],[[0,0.3876,0.1619,0.21445],[0,0.19195,0.12645,0.0605],[0,0.05285,0.49525,0.4818],[0,0.12235,0.2754,0.3097],[0,0.08925,0.39195,0.4012],[0,0.1258,0.2955,0.04515],[0,0.43795,0.3183,0.13955],[0,0.4291,0.3929,0.31175],[0.03899999999999998,0.068,0.0317,0.43415],[-0.1735,0.16715,0.39875,0.1582],[0.0233,0.1902,0.14635,0.4969],[0.20565,0.06155,0.1944,0.1631],[-0.19665,0.3417,0.13265,0.017],[0.13790000000000002,0.0226,0.14555,0.00865],[0.2023,0.179,0.48505,0.43095],[-0.16665,0.096,0.0088,0.4613],[-0.2172655402185706,0.5441331602575918,-0.01391013416807791,0.2914686444422635]]]]

Actual:   [[[[0, 0.0522, 0.2863, 0.3148], [0, 0.4773, 0.2972, 0.4654], [0, 0.4963, 0.2134, 0.3407], [0, 0.1961, 0.1382, 0.2745], [0, 0.3199, 0.3278, 0.2346], [0, 0.2917, 0.3045, 0.208], [0, 0.2192, 0.1125, 0.3265], [0, 0.0091, 0.3164, 0.0546], [0, 0.1431, 0.1091, 0.1088], [0, 0.2608, 0.2493, 0.278], [0, 0.2197, 0.46, 0.02], [0, 0.2819, 0.1366, 0.3649], [0, 0.374, 0.1328, 0.2154], [0, 0.379, 0.4993, 0.1044], [0, 0.3149, 0.2422, 0.4664], [0, 0.2849, 0.3052, 0.22], [-0.092, 0.401, 0.4517, 0.2371]], [[0, 0.4272, 0.1829, 0.4606], [0, 0.2158, 0.3821, 0.2934], [0, 0.0235, 0.3639, 0.4089], [0, 0.4065, 0.4912, 0.3746], [0, 0.04, 0.4067, 0.0848], [0, 0.0878, 0.1208, 0.276], [0, 0.2863, 0.415, 0.3885], [0, 0.0012, 0.3531, 0.3482], [-0.1441, 0.3768, 0.3019, 0.413], [0.0359, 0.3853, 0.0974, 0.4422], [-0.2762, 0.2408, 0.3713, 0.0644], [0.1029, 0.0849, 0.1246, 0.4603], [-0.3376, 0.3535, 0.4829, 0.3051], [-0.0002, 0.4937, 0.0369, 0.2814], [-0.0825, 0.3116, 0.079, 0.493], [-0.0138, 0.3196, 0.1249, 0.0245], [0.0158, 0.2948, 0.0097, 0.3996]], [[0, 0.0575, 0.3501, 0.3424], [0, 0.1636, 0.4024, 0.4535], [0, 0.0959, 0.3975, 0.3509], [0, 0.0744, 0.034, 0.4022], [0, 0.3867, 0.3936, 0.1619], [0, 0.4997, 0.2627, 0.2934], [0, 0.0994, 0.15, 0.1417], [0, 0.0612, 0.2215, 0.1135], [0.1054, 0.0264, 0.1227, 0.029], [0.1026, 0.0668, 0.2019, 0.4559], [-0.1873, 0.0293, 0.0086, 0.3068], [-0.2962, 0.1506, 0.4269, 0.0547], [-0.1852, 0.4289, 0.411, 0.0892], [0.1963, 0.2475, 0.2963, 0.1489], [0.0976, 0.0596, 0.3018, 0.1958], [0.0936, 0.1763, 0.3338, 0.2636], [0.2478, 0.2085, 0.4152, 0.3121]], [[0, 0.3876, 0.1619, 0.2145], [0, 0.192, 0.1265, 0.0605], [0, 0.0529, 0.4953, 0.4818], [0, 0.1224, 0.2754, 0.3097], [0, 0.0893, 0.392, 0.4012], [0, 0.1258, 0.2955, 0.0452], [0, 0.438, 0.3183, 0.1396], [0, 0.4291, 0.3929, 0.3118], [0.039, 0.068, 0.0317, 0.4342], [-0.1735, 0.1672, 0.3988, 0.1582], [0.0233, 0.1902, 0.1464, 0.4969], [0.2057, 0.0616, 0.1944, 0.1631], [-0.1966, 0.3417, 0.1327, 0.017], [0.1379, 0.0226, 0.1456, 0.0087], [0.2023, 0.179, 0.4851, 0.431], [-0.1666, 0.096, 0.0088, 0.4613], [-0.2172, 0.5442, -0.0139, 0.2915]]]]

Expected: [[[[0, 0.0522, 0.2863, 0.3148], [0, 0.4773, 0.2972, 0.4654], [0, 0.4963, 0.2134, 0.3407], [0, 0.1961, 0.1382, 0.2745], [0, 0.3199, 0.3278, 0.2346], [0, 0.2917, 0.3045, 0.208], [0, 0.2192, 0.1125, 0.3265], [0, 0.0091, 0.3164, 0.0546], [0, 0.1431, 0.1091, 0.1088], [0, 0.2608, 0.2493, 0.278], [0, 0.2197, 0.46, 0.02], [0, 0.2819, 0.1366, 0.3649], [0, 0.374, 0.1328, 0.2154], [0, 0.379, 0.4993, 0.1044], [0, 0.3149, 0.2422, 0.4664], [0, 0.2849, 0.3052, 0.22], [-0.092, 0.401, 0.4517, 0.2371]], [[0, 0.4272, 0.1829, 0.4606], [0, 0.2158, 0.3821, 0.2934], [0, 0.0235, 0.3639, 0.4089], [0, 0.4065, 0.4912, 0.3746], [0, 0.04, 0.4067, 0.0848], [0, 0.0878, 0.1208, 0.276], [0, 0.2863, 0.415, 0.3885], [0, 0.0012, 0.3531, 0.3482], [-0.1441, 0.3768, 0.3019, 0.413], [0.0359, 0.3853, 0.0974, 0.4422], [-0.2762, 0.2408, 0.3713, 0.0644], [0.1029, 0.0849, 0.1246, 0.4603], [-0.3376, 0.3535, 0.4829, 0.3051], [-0.0002, 0.4937, 0.0369, 0.2814], [-0.0825, 0.3116, 0.079, 0.493], [-0.0137, 0.3196, 0.1249, 0.0245], [0.0158, 0.2948, 0.0097, 0.3996]], [[0, 0.0575, 0.3501, 0.3424], [0, 0.1636, 0.4024, 0.4535], [0, 0.0959, 0.3975, 0.3509], [0, 0.0744, 0.034, 0.4022], [0, 0.3867, 0.3936, 0.1619], [0, 0.4997, 0.2627, 0.2934], [0, 0.0994, 0.15, 0.1417], [0, 0.0612, 0.2215, 0.1135], [0.1054, 0.0264, 0.1227, 0.029], [0.1026, 0.0668, 0.2019, 0.4559], [-0.1873, 0.0293, 0.0086, 0.3068], [-0.2962, 0.1506, 0.4269, 0.0547], [-0.1851, 0.4289, 0.411, 0.0892], [0.1963, 0.2475, 0.2963, 0.1489], [0.0976, 0.0596, 0.3018, 0.1958], [0.0936, 0.1763, 0.3338, 0.2636], [0.2478, 0.2085, 0.4152, 0.3121]], [[0, 0.3876, 0.1619, 0.2145], [0, 0.192, 0.1265, 0.0605], [0, 0.0529, 0.4953, 0.4818], [0, 0.1224, 0.2754, 0.3097], [0, 0.0893, 0.392, 0.4012], [0, 0.1258, 0.2955, 0.0452], [0, 0.438, 0.3183, 0.1396], [0, 0.4291, 0.3929, 0.3118], [0.039, 0.068, 0.0317, 0.4342], [-0.1735, 0.1672, 0.3988, 0.1582], [0.0233, 0.1902, 0.1464, 0.4969], [0.2057, 0.0616, 0.1944, 0.1631], [-0.1966, 0.3417, 0.1327, 0.017], [0.138, 0.0226, 0.1456, 0.0087], [0.2023, 0.179, 0.4851, 0.431], [-0.1666, 0.096, 0.0088, 0.4613], [-0.2172, 0.5442, -0.0139, 0.2915]]]]