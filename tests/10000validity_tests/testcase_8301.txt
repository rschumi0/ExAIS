import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave89983 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Ave89983 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Glo36901 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con94327 = tf.keras.layers.Input(shape=([7]))

Ave89983 = keras.layers.Average(name = 'Ave89983', )([in0Ave89983,in1Ave89983])
Res3926 = keras.layers.Reshape((2, 2, 2), name = 'Res3926', )(Ave89983)
Res86858 = keras.layers.Reshape((2, 4), name = 'Res86858', )(Res3926)
Fla9328 = keras.layers.Flatten(name = 'Fla9328', )(Res86858)
Glo36901 = keras.layers.GlobalAveragePooling2D(name = 'Glo36901', )(in0Glo36901)
Con94327 = keras.layers.Concatenate(axis=1, name = 'Con94327', )([Glo36901,in0Con94327])
Mul69960 = keras.layers.Multiply(name = 'Mul69960', )([Fla9328,Con94327])
model = tf.keras.models.Model(inputs=[in0Ave89983,in1Ave89983,in0Glo36901,in0Con94327], outputs=Mul69960)
in0Ave89983 = tf.constant([[[[[0.025, 0.1843]], [[0.7911, 0.0961]]], [[[0.9654, 0.4061]], [[0.7063, 0.142]]]]])
in1Ave89983 = tf.constant([[[[[0.8977, 0.1999]], [[0.1427, 0.2923]]], [[[0.2026, 0.53]], [[0.8145, 0.3793]]]]])
in0Glo36901 = tf.constant([[[[1.2741]]]])
in0Con94327 = tf.constant([[0.3579, 0.7216, 0.9594, 0.3955, 0.6342, 0.7267, 0.7755]])
print (np.array2string(model.predict([in0Ave89983,in1Ave89983,in0Glo36901,in0Con94327],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul69960.png')

LAve89983 = average_layer([[[[[[0.025, 0.1843]], [[0.7911, 0.0961]]], [[[0.9654, 0.4061]], [[0.7063, 0.142]]]]], [[[[[0.8977, 0.1999]], [[0.1427, 0.2923]]], [[[0.2026, 0.53]], [[0.8145, 0.3793]]]]]], Ave89983), 
LRes3926 = reshape_layer(Ave89983, [2, 2, 2], Res3926), 
LRes86858 = reshape_layer(Res3926, [2, 4], Res86858), 
LFla9328 = flatten_layer(Res86858, Fla9328), 
LGlo36901 = global_average_pooling2D_layer([[[[1.2741]]]], Glo36901), 
LCon94327 = concatenate_layer([Glo36901,[[0.3579, 0.7216, 0.9594, 0.3955, 0.6342, 0.7267, 0.7755]]], 1, Con94327), 
LMul69960 = multiply_layer([Fla9328,Con94327], Mul69960), 
exec_layers([LAve89983,LRes3926,LRes86858,LFla9328,LGlo36901,LCon94327,LMul69960],["Ave89983","Res3926","Res86858","Fla9328","Glo36901","Con94327","Mul69960"],Mul69960,"Mul69960")

Actual (Unparsed): [[0.5878060, 0.0687526, 0.3369150, 0.1863155, 0.2309720, 0.2968373, 0.5525827, 0.2021341]]

Expected (Unparsed): [[0.5878060350000001,0.06875259,0.33691504,0.18631548,0.23097200000000004,0.29683731,0.55258268,0.202134075]]

Actual:   [[0.5879, 0.0688, 0.337, 0.1864, 0.231, 0.2969, 0.5526, 0.2022]]

Expected: [[0.5879, 0.0688, 0.337, 0.1864, 0.231, 0.2969, 0.5526, 0.2022]]