import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min5268 = tf.keras.layers.Input(shape=([1, 2]))
in1Min5268 = tf.keras.layers.Input(shape=([1, 2]))

Min5268 = keras.layers.Minimum(name = 'Min5268', )([in0Min5268,in1Min5268])
Res4235 = keras.layers.Reshape((1, 2, 1), name = 'Res4235', )(Min5268)
PRe71622 = keras.layers.PReLU(name = 'PRe71622', )(Res4235)
Glo4618 = keras.layers.GlobalMaxPool2D(name = 'Glo4618', )(PRe71622)
model = tf.keras.models.Model(inputs=[in0Min5268,in1Min5268], outputs=Glo4618)
w = model.get_layer('PRe71622').get_weights() 
w[0] = np.array([[[0.5244], [0.4213]]])
model.get_layer('PRe71622').set_weights(w) 
in0Min5268 = tf.constant([[[0.6949, 0.2756]]])
in1Min5268 = tf.constant([[[0.2495, 0.1221]]])
print (np.array2string(model.predict([in0Min5268,in1Min5268],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo4618.png')

LMin5268 = minimum_layer([[[[0.6949, 0.2756]]], [[[0.2495, 0.1221]]]], Min5268), 
LRes4235 = reshape_layer(Min5268, [1, 2, 1], Res4235), 
LPRe71622 = prelu_layer(Res4235, [[[0.5244], [0.4213]]], PRe71622), 
LGlo4618 = global_max_pool2D_layer(PRe71622, Glo4618), 
exec_layers([LMin5268,LRes4235,LPRe71622,LGlo4618],["Min5268","Res4235","PRe71622","Glo4618"],Glo4618,"Glo4618")

Actual (Unparsed): [[0.2495000]]

Expected (Unparsed): [[0.2495]]

Actual:   [[0.2495]]

Expected: [[0.2495]]