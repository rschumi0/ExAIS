import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot8732 = tf.keras.layers.Input(shape=([3]))
in1Dot8732 = tf.keras.layers.Input(shape=([3]))

Dot8732 = keras.layers.Dot(axes=(1, 1), name = 'Dot8732', )([in0Dot8732,in1Dot8732])
Bat52943 = keras.layers.BatchNormalization(axis=1, epsilon=0.7004835760317382,  name = 'Bat52943', )(Dot8732)
Res82309 = keras.layers.Reshape((1, 1), name = 'Res82309', )(Bat52943)
Ave17677 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='same', name = 'Ave17677', )(Res82309)
Res83174 = keras.layers.Reshape((1, 1, 1), name = 'Res83174', )(Ave17677)
PRe49051 = keras.layers.PReLU(name = 'PRe49051', )(Res83174)
model = tf.keras.models.Model(inputs=[in0Dot8732,in1Dot8732], outputs=PRe49051)
w = model.get_layer('Bat52943').get_weights() 
w[0] = np.array([0.77])
w[1] = np.array([0.4777])
w[2] = np.array([0.9736])
w[3] = np.array([0.9208])
model.get_layer('Bat52943').set_weights(w) 
w = model.get_layer('PRe49051').get_weights() 
w[0] = np.array([[[0.0183]]])
model.get_layer('PRe49051').set_weights(w) 
in0Dot8732 = tf.constant([[0.5742, 0.8718, 0.2348]])
in1Dot8732 = tf.constant([[0.5209, 0.1088, 0.1975]])
print (np.array2string(model.predict([in0Dot8732,in1Dot8732],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe49051.png')

LDot8732 = dot_layer([[0.5742, 0.8718, 0.2348]], [[0.5209, 0.1088, 0.1975]], 1, 1, Dot8732), 
LBat52943 = batch_normalization_layer(Dot8732, 1, 0.7004835760317382, [0.77], [0.4777], [0.9736], [0.9208], Bat52943), 
LRes82309 = reshape_layer(Bat52943, [1, 1], Res82309), 
LAve17677 = average_pooling1D_layer(Res82309, 1, 1, true, Ave17677), 
LRes83174 = reshape_layer(Ave17677, [1, 1, 1], Res83174), 
LPRe49051 = prelu_layer(Res83174, [[[0.0183]]], PRe49051), 
exec_layers([LDot8732,LBat52943,LRes82309,LAve17677,LRes83174,LPRe49051],["Dot8732","Bat52943","Res82309","Ave17677","Res83174","PRe49051"],PRe49051,"PRe49051")

Actual (Unparsed): [[[[0.1552132]]]]

Expected (Unparsed): [[[[0.15521319243762172]]]]

Actual:   [[[[0.1553]]]]

Expected: [[[[0.1553]]]]