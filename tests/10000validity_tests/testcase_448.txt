import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe10836 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Loc94598 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Ave49857 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave49857 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Ave94974 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave94974 = tf.keras.layers.Input(shape=([2, 2]))
in0Ave41842 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave41842 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con77364 = tf.keras.layers.Input(shape=([2, 3, 6]))

PRe10836 = keras.layers.PReLU(name = 'PRe10836', input_shape=(2, 1, 1))(in0PRe10836)
Res51959 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res51959', )(PRe10836)
Zer61869 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (6, 0)), name = 'Zer61869', )(Res51959)
Loc94598 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc94598', )(in0Loc94598)
Res71610 = keras.layers.Reshape((1, 2, 4, 1), name = 'Res71610', )(Loc94598)
Ave49857 = keras.layers.Average(name = 'Ave49857', )([in0Ave49857,in1Ave49857])
Zer85784 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (3, 0)), name = 'Zer85784', )(Ave49857)
Max89698 = keras.layers.Maximum(name = 'Max89698', )([Res71610,Zer85784])
Zer52620 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (3, 0)), name = 'Zer52620', )(Max89698)
Add80518 = keras.layers.Add(name = 'Add80518', )([Zer61869,Zer52620])
Res58133 = keras.layers.Reshape((2, 3, 7), name = 'Res58133', )(Add80518)
Ave94974 = keras.layers.Average(name = 'Ave94974', )([in0Ave94974,in1Ave94974])
Ave41842 = keras.layers.Average(name = 'Ave41842', )([in0Ave41842,in1Ave41842])
Mas57895 = keras.layers.Masking(mask_value=1, name = 'Mas57895', )(Ave41842)
Res60614 = keras.layers.Reshape((2, 1), name = 'Res60614', )(Mas57895)
Dot5203 = keras.layers.Dot(axes=(1, 1), name = 'Dot5203', )([Ave94974,Res60614])
Res25565 = keras.layers.Reshape((2, 1, 1), name = 'Res25565', )(Dot5203)
Up_51204 = keras.layers.UpSampling2D(size=(1, 1), name = 'Up_51204', )(Res25565)
Zer30855 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer30855', )(Up_51204)
Con77364 = keras.layers.Concatenate(axis=3, name = 'Con77364', )([Zer30855,in0Con77364])
Add43075 = keras.layers.Add(name = 'Add43075', )([Res58133,Con77364])
model = tf.keras.models.Model(inputs=[in0PRe10836,in0Loc94598,in0Ave49857,in1Ave49857,in0Ave94974,in1Ave94974,in0Ave41842,in1Ave41842,in0Con77364], outputs=Add43075)
w = model.get_layer('PRe10836').get_weights() 
w[0] = np.array([[[0.4942]], [[0.6989]]])
model.get_layer('PRe10836').set_weights(w) 
w = model.get_layer('Loc94598').get_weights() 
w[0] = np.array([[[0.662, 0.3601, 0.9686, 0.1041]], [[0.4939, 0.2568, 0.0657, 0.4219]]])
w[1] = np.array([[[0, 0, 0, 0], [0, 0, 0, 0]]])
model.get_layer('Loc94598').set_weights(w) 
in0PRe10836 = tf.constant([[[[0.2258]], [[0.4404]]]])
in0Loc94598 = tf.constant([[[[0.3413], [0.1659]]]])
in0Ave49857 = tf.constant([[[[[0.2363]], [[0.437]]]]])
in1Ave49857 = tf.constant([[[[[0.4429]], [[0.9248]]]]])
in0Ave94974 = tf.constant([[[0.4012, 0.5138], [0.5038, 0.5598]]])
in1Ave94974 = tf.constant([[[0.0045, 0.3117], [0.9657, 0.1071]]])
in0Ave41842 = tf.constant([[[[0.7697]], [[0.988]]]])
in1Ave41842 = tf.constant([[[[0.4561]], [[0.8736]]]])
in0Con77364 = tf.constant([[[[0.8169, 0.1404, 0.3032, 0.4915, 0.0144, 0.1521], [0.4375, 0.7494, 0.5049, 0.9473, 0.5759, 0.191], [0.4036, 0.0161, 0.0661, 0.5186, 0.2315, 0.825]], [[0.6783, 0.4752, 0.3919, 0.7202, 0.3304, 0.0048], [0.6907, 0.7059, 0.1439, 0.3365, 0.5427, 0.4217], [0.3771, 0.5692, 0.1654, 0.5599, 0.7708, 0.7018]]]])
print (np.array2string(model.predict([in0PRe10836,in0Loc94598,in0Ave49857,in1Ave49857,in0Ave94974,in1Ave94974,in0Ave41842,in1Ave41842,in0Con77364],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add43075.png')

LPRe10836 = prelu_layer([[[[0.2258]], [[0.4404]]]], [[[0.4942]], [[0.6989]]], PRe10836), 
LRes51959 = reshape_layer(PRe10836, [2, 1, 1, 1], Res51959), 
LZer61869 = zero_padding3D_layer(Res51959, 0, 0, 2, 0, 6, 0, Zer61869), 
LLoc94598 = locally_connected2D_layer([[[[0.3413], [0.1659]]]], 1, 1,[[[0.662, 0.3601, 0.9686, 0.1041]], [[0.4939, 0.2568, 0.0657, 0.4219]]],[[[0, 0, 0, 0], [0, 0, 0, 0]]], 1, 1, Loc94598), 
LRes71610 = reshape_layer(Loc94598, [1, 2, 4, 1], Res71610), 
LAve49857 = average_layer([[[[[[0.2363]], [[0.437]]]]], [[[[[0.4429]], [[0.9248]]]]]], Ave49857), 
LZer85784 = zero_padding3D_layer(Ave49857, 0, 0, 0, 0, 3, 0, Zer85784), 
LMax89698 = maximum_layer([Res71610,Zer85784], Max89698), 
LZer52620 = zero_padding3D_layer(Max89698, 1, 0, 1, 0, 3, 0, Zer52620), 
LAdd80518 = add_layer([Zer61869,Zer52620], Add80518), 
LRes58133 = reshape_layer(Add80518, [2, 3, 7], Res58133), 
LAve94974 = average_layer([[[[0.4012, 0.5138], [0.5038, 0.5598]]], [[[0.0045, 0.3117], [0.9657, 0.1071]]]], Ave94974), 
LAve41842 = average_layer([[[[[0.7697]], [[0.988]]]], [[[[0.4561]], [[0.8736]]]]], Ave41842), 
LMas57895 = masking_layer(Ave41842, 1, Mas57895), 
LRes60614 = reshape_layer(Mas57895, [2, 1], Res60614), 
LDot5203 = dot_layer(Ave94974,Res60614, 1, 1, Dot5203), 
LRes25565 = reshape_layer(Dot5203, [2, 1, 1], Res25565), 
LUp_51204 = up_sampling2D_layer(Res25565, 1, 1, Up_51204), 
LZer30855 = zero_padding2D_layer(Up_51204, 0, 0, 2, 0, Zer30855), 
LCon77364 = concatenate_layer([Zer30855,[[[[0.8169, 0.1404, 0.3032, 0.4915, 0.0144, 0.1521], [0.4375, 0.7494, 0.5049, 0.9473, 0.5759, 0.191], [0.4036, 0.0161, 0.0661, 0.5186, 0.2315, 0.825]], [[0.6783, 0.4752, 0.3919, 0.7202, 0.3304, 0.0048], [0.6907, 0.7059, 0.1439, 0.3365, 0.5427, 0.4217], [0.3771, 0.5692, 0.1654, 0.5599, 0.7708, 0.7018]]]]], 3, Con77364), 
LAdd43075 = add_layer([Res58133,Con77364], Add43075), 
exec_layers([LPRe10836,LRes51959,LZer61869,LLoc94598,LRes71610,LAve49857,LZer85784,LMax89698,LZer52620,LAdd80518,LRes58133,LAve94974,LAve41842,LMas57895,LRes60614,LDot5203,LRes25565,LUp_51204,LZer30855,LCon77364,LAdd43075],["PRe10836","Res51959","Zer61869","Loc94598","Res71610","Ave49857","Zer85784","Max89698","Zer52620","Add80518","Res58133","Ave94974","Ave41842","Mas57895","Res60614","Dot5203","Res25565","Up_51204","Zer30855","Con77364","Add43075"],Add43075,"Add43075")

Actual (Unparsed): [[[[0.0000000, 0.8169000, 0.1404000, 0.3032000, 0.4915000, 0.0144000, 0.1521000], [0.0000000, 0.4375000, 0.7494000, 0.5049000, 0.9473000, 0.5759000, 0.1910000], [0.8082320, 0.4036000, 0.0161000, 0.0661000, 0.5186000, 0.2315000, 1.0508000]], [[0.0000000, 0.6783000, 0.4752000, 0.3919000, 0.7202000, 0.3304000, 0.0048000], [0.0000000, 0.6907000, 0.7059000, 0.3698406, 0.4594021, 0.8732832, 0.7613000], [0.5633497, 0.3771000, 0.5692000, 0.2473380, 0.6025031, 0.7816996, 1.8231000]]]]

Expected (Unparsed): [[[[0,0.8169,0.1404,0.3032,0.4915,0.0144,0.1521],[0,0.4375,0.7494,0.5049,0.9473,0.5759,0.191],[0.8082320650000001,0.4036,0.0161,0.0661,0.5186,0.2315,1.0508]],[[0,0.6783,0.4752,0.3919,0.7202,0.3304,0.0048],[0,0.6907,0.7059,0.3698406,0.45940213,0.8732831799999999,0.7613000000000001],[0.563349735,0.3771,0.5692,0.24733801,0.60250312,0.7816996300000001,1.8231]]]]

Actual:   [[[[0, 0.8169, 0.1404, 0.3032, 0.4915, 0.0144, 0.1521], [0, 0.4375, 0.7494, 0.5049, 0.9473, 0.5759, 0.191], [0.8083, 0.4036, 0.0161, 0.0661, 0.5186, 0.2315, 1.0508]], [[0, 0.6783, 0.4752, 0.3919, 0.7202, 0.3304, 0.0048], [0, 0.6907, 0.7059, 0.3699, 0.4595, 0.8733, 0.7613], [0.5634, 0.3771, 0.5692, 0.2474, 0.6026, 0.7817, 1.8231]]]]

Expected: [[[[0, 0.8169, 0.1404, 0.3032, 0.4915, 0.0144, 0.1521], [0, 0.4375, 0.7494, 0.5049, 0.9473, 0.5759, 0.191], [0.8083, 0.4036, 0.0161, 0.0661, 0.5186, 0.2315, 1.0508]], [[0, 0.6783, 0.4752, 0.3919, 0.7202, 0.3304, 0.0048], [0, 0.6907, 0.7059, 0.3699, 0.4595, 0.8733, 0.7614], [0.5634, 0.3771, 0.5692, 0.2474, 0.6026, 0.7817, 1.8231]]]]