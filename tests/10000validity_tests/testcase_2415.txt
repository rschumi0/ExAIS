import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul26146 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul26146 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Up_53431 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Cro43417 = tf.keras.layers.Input(shape=([3, 4]))

Mul26146 = keras.layers.Multiply(name = 'Mul26146', )([in0Mul26146,in1Mul26146])
Up_53431 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_53431', )(in0Up_53431)
Ave58399 = keras.layers.Average(name = 'Ave58399', )([Mul26146,Up_53431])
Res79859 = keras.layers.Reshape((1, 4), name = 'Res79859', )(Ave58399)
Cro43417 = keras.layers.Cropping1D(cropping=((1, 1)), name = 'Cro43417', )(in0Cro43417)
Res91634 = keras.layers.Reshape((1, 4, 1), name = 'Res91634', )(Cro43417)
Cro29588 = keras.layers.Cropping2D(cropping=((0, 0), (0, 3)), name = 'Cro29588', )(Res91634)
Res76850 = keras.layers.Reshape((1, 1), name = 'Res76850', )(Cro29588)
Dot52485 = keras.layers.Dot(axes=(1, 1), name = 'Dot52485', )([Res79859,Res76850])
model = tf.keras.models.Model(inputs=[in0Mul26146,in1Mul26146,in0Up_53431,in0Cro43417], outputs=Dot52485)
in0Mul26146 = tf.constant([[[[0.6415, 0.5116], [0.6864, 0.4892]]]])
in1Mul26146 = tf.constant([[[[0.1856, 0.9275], [0.1457, 0.9501]]]])
in0Up_53431 = tf.constant([[[[1.8783, 1.7771]]]])
in0Cro43417 = tf.constant([[[1.0367, 1.8901, 1.3024, 1.9387], [1.5787, 1.2227, 1.4065, 1.869], [1.748, 1.2888, 1.5807, 1.1504]]])
print (np.array2string(model.predict([in0Mul26146,in1Mul26146,in0Up_53431,in0Cro43417],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot52485.png')

LMul26146 = multiply_layer([[[[[0.6415, 0.5116], [0.6864, 0.4892]]]], [[[[0.1856, 0.9275], [0.1457, 0.9501]]]]], Mul26146), 
LUp_53431 = up_sampling2D_layer([[[[1.8783, 1.7771]]]], 1, 2, Up_53431), 
LAve58399 = average_layer([Mul26146,Up_53431], Ave58399), 
LRes79859 = reshape_layer(Ave58399, [1, 4], Res79859), 
LCro43417 = cropping1D_layer([[[1.0367, 1.8901, 1.3024, 1.9387], [1.5787, 1.2227, 1.4065, 1.869], [1.748, 1.2888, 1.5807, 1.1504]]], 1, 1, Cro43417), 
LRes91634 = reshape_layer(Cro43417, [1, 4, 1], Res91634), 
LCro29588 = cropping2D_layer(Res91634, 0, 0, 0, 3, Cro29588), 
LRes76850 = reshape_layer(Cro29588, [1, 1], Res76850), 
LDot52485 = dot_layer(Res79859,Res76850, 1, 1, Dot52485), 
exec_layers([LMul26146,LUp_53431,LAve58399,LRes79859,LCro43417,LRes91634,LCro29588,LRes76850,LDot52485],["Mul26146","Up_53431","Ave58399","Res79859","Cro43417","Res91634","Cro29588","Res76850","Dot52485"],Dot52485,"Dot52485")

Actual (Unparsed): [[[1.5766179], [1.7773075], [1.5615777], [1.7696349]]]

Expected (Unparsed): [[[1.57661801044],[1.7773075641500002],[1.5615777986880002],[1.769635019002]]]

Actual:   [[[1.5767], [1.7774], [1.5616], [1.7697]]]

Expected: [[[1.5767], [1.7774], [1.5616], [1.7697]]]