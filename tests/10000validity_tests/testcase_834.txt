import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max42050 = tf.keras.layers.Input(shape=([2, 1]))
in1Max42050 = tf.keras.layers.Input(shape=([2, 1]))
in0Con41108 = tf.keras.layers.Input(shape=([1]))
in0Fla22949 = tf.keras.layers.Input(shape=([3, 1]))

Max42050 = keras.layers.Maximum(name = 'Max42050', )([in0Max42050,in1Max42050])
Fla82541 = keras.layers.Flatten(name = 'Fla82541', )(Max42050)
Con41108 = keras.layers.Concatenate(axis=1, name = 'Con41108', )([Fla82541,in0Con41108])
Fla22949 = keras.layers.Flatten(name = 'Fla22949', )(in0Fla22949)
Max17976 = keras.layers.Maximum(name = 'Max17976', )([Con41108,Fla22949])
Res66477 = keras.layers.Reshape((3, 1), name = 'Res66477', )(Max17976)
Max46116 = keras.layers.MaxPool1D(pool_size=(1), strides=(2), padding='valid', name = 'Max46116', )(Res66477)
Bat59890 = keras.layers.BatchNormalization(axis=2, epsilon=0.6920901590166095,  name = 'Bat59890', )(Max46116)
model = tf.keras.models.Model(inputs=[in0Max42050,in1Max42050,in0Con41108,in0Fla22949], outputs=Bat59890)
w = model.get_layer('Bat59890').get_weights() 
w[0] = np.array([0.5212])
w[1] = np.array([0.7])
w[2] = np.array([0.0371])
w[3] = np.array([0.924])
model.get_layer('Bat59890').set_weights(w) 
in0Max42050 = tf.constant([[[0.7536], [0.0215]]])
in1Max42050 = tf.constant([[[0.0162], [0.7826]]])
in0Con41108 = tf.constant([[0.9826]])
in0Fla22949 = tf.constant([[[1.9229], [1.4089], [1.4334]]])
print (np.array2string(model.predict([in0Max42050,in1Max42050,in0Con41108,in0Fla22949],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat59890.png')

LMax42050 = maximum_layer([[[[0.7536], [0.0215]]], [[[0.0162], [0.7826]]]], Max42050), 
LFla82541 = flatten_layer(Max42050, Fla82541), 
LCon41108 = concatenate_layer([Fla82541,[[0.9826]]], 1, Con41108), 
LFla22949 = flatten_layer([[[1.9229], [1.4089], [1.4334]]], Fla22949), 
LMax17976 = maximum_layer([Con41108,Fla22949], Max17976), 
LRes66477 = reshape_layer(Max17976, [3, 1], Res66477), 
LMax46116 = max_pool1D_layer(Res66477, 1, 2, false, Max46116), 
LBat59890 = batch_normalization_layer(Max46116, 2, 0.6920901590166095, [0.5212], [0.7], [0.0371], [0.924], Bat59890), 
exec_layers([LMax42050,LFla82541,LCon41108,LFla22949,LMax17976,LRes66477,LMax46116,LBat59890],["Max42050","Fla82541","Con41108","Fla22949","Max17976","Res66477","Max46116","Bat59890"],Bat59890,"Bat59890")

Actual (Unparsed): [[[1.4731562], [1.2724669]]]

Expected (Unparsed): [[[1.4731562048412945],[1.272466862244087]]]

Actual:   [[[1.4732], [1.2725]]]

Expected: [[[1.4732], [1.2725]]]