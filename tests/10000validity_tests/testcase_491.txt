import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer54991 = tf.keras.layers.Input(shape=([1, 4, 1]))
in0Sub48625 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub48625 = tf.keras.layers.Input(shape=([3, 3]))
in0Con81037 = tf.keras.layers.Input(shape=([3, 3]))

Zer54991 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer54991', )(in0Zer54991)
Res52527 = keras.layers.Reshape((3, 6), name = 'Res52527', )(Zer54991)
Sub48625 = keras.layers.Subtract(name = 'Sub48625', )([in0Sub48625,in1Sub48625])
Con81037 = keras.layers.Concatenate(axis=2, name = 'Con81037', )([Sub48625,in0Con81037])
Ave98539 = keras.layers.Average(name = 'Ave98539', )([Res52527,Con81037])
model = tf.keras.models.Model(inputs=[in0Zer54991,in0Sub48625,in1Sub48625,in0Con81037], outputs=Ave98539)
in0Zer54991 = tf.constant([[[[1.8079], [1.1183], [1.7762], [1.6906]]]])
in0Sub48625 = tf.constant([[[0.1978, 0.3201, 0.2323], [0.5532, 0.5025, 0.2614], [0.8328, 0.9272, 0.4725]]])
in1Sub48625 = tf.constant([[[0.1735, 0.1582, 0.7395], [0.2497, 0.858, 0.129], [0.4378, 0.2089, 0.5441]]])
in0Con81037 = tf.constant([[[0.4935, 0.3315, 0.5382], [0.1824, 0.4074, 0.024], [0.4486, 0.3016, 0.4211]]])
print (np.array2string(model.predict([in0Zer54991,in0Sub48625,in1Sub48625,in0Con81037],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave98539.png')

LZer54991 = zero_padding2D_layer([[[[1.8079], [1.1183], [1.7762], [1.6906]]]], 1, 1, 1, 1, Zer54991), 
LRes52527 = reshape_layer(Zer54991, [3, 6], Res52527), 
LSub48625 = subtract_layer([[[0.1978, 0.3201, 0.2323], [0.5532, 0.5025, 0.2614], [0.8328, 0.9272, 0.4725]]], [[[0.1735, 0.1582, 0.7395], [0.2497, 0.858, 0.129], [0.4378, 0.2089, 0.5441]]], Sub48625), 
LCon81037 = concatenate_layer([Sub48625,[[[0.4935, 0.3315, 0.5382], [0.1824, 0.4074, 0.024], [0.4486, 0.3016, 0.4211]]]], 2, Con81037), 
LAve98539 = average_layer([Res52527,Con81037], Ave98539), 
exec_layers([LZer54991,LRes52527,LSub48625,LCon81037,LAve98539],["Zer54991","Res52527","Sub48625","Con81037","Ave98539"],Ave98539,"Ave98539")

Actual (Unparsed): [[[0.0121500, 0.0809500, -0.2536000, 0.2467500, 0.1657500, 0.2691000], [0.1517500, 0.7262000, 0.6253500, 0.9793000, 1.0490000, 0.0120000], [0.1975000, 0.3591500, -0.0358000, 0.2243000, 0.1508000, 0.2105500]]]

Expected (Unparsed): [[[0.012150000000000008,0.08095,-0.25360000000000005,0.24675,0.16575,0.2691],[0.15175,0.7262,0.6253500000000001,0.9793000000000001,1.049,0.012],[0.19749999999999998,0.35915,-0.035800000000000026,0.2243,0.1508,0.21055]]]

Actual:   [[[0.0122, 0.081, -0.2536, 0.2468, 0.1658, 0.2691], [0.1518, 0.7262, 0.6254, 0.9793, 1.049, 0.012], [0.1975, 0.3592, -0.0358, 0.2243, 0.1508, 0.2106]]]

Expected: [[[0.0122, 0.081, -0.2536, 0.2468, 0.1658, 0.2691], [0.1518, 0.7262, 0.6254, 0.9794, 1.049, 0.012], [0.1975, 0.3592, -0.0358, 0.2243, 0.1508, 0.2106]]]