import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc9645 = tf.keras.layers.Input(shape=([1, 2, 1]))

Loc9645 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc9645', )(in0Loc9645)
Res80596 = keras.layers.Reshape((1, 6), name = 'Res80596', )(Loc9645)
PRe14381 = keras.layers.PReLU(name = 'PRe14381', )(Res80596)
model = tf.keras.models.Model(inputs=[in0Loc9645], outputs=PRe14381)
w = model.get_layer('Loc9645').get_weights() 
w[0] = np.array([[[0.6337, 0.1214, 0.5879]], [[0.562, 0.9816, 0.7866]]])
w[1] = np.array([[[0, 0, 0], [0, 0, 0]]])
model.get_layer('Loc9645').set_weights(w) 
w = model.get_layer('PRe14381').get_weights() 
w[0] = np.array([[0.293, 0.0148, 0.6617, 0.9697, 0.7516, 0.2083]])
model.get_layer('PRe14381').set_weights(w) 
in0Loc9645 = tf.constant([[[[0.7604], [0.5812]]]])
print (np.array2string(model.predict([in0Loc9645],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe14381.png')

LLoc9645 = locally_connected2D_layer([[[[0.7604], [0.5812]]]], 1, 1,[[[0.6337, 0.1214, 0.5879]], [[0.562, 0.9816, 0.7866]]],[[[0, 0, 0], [0, 0, 0]]], 1, 1, Loc9645), 
LRes80596 = reshape_layer(Loc9645, [1, 6], Res80596), 
LPRe14381 = prelu_layer(Res80596, [[0.293, 0.0148, 0.6617, 0.9697, 0.7516, 0.2083]], PRe14381), 
exec_layers([LLoc9645,LRes80596,LPRe14381],["Loc9645","Res80596","PRe14381"],PRe14381,"PRe14381")

Actual (Unparsed): [[[0.4818655, 0.0923126, 0.4470392, 0.3266344, 0.5705059, 0.4571719]]]

Expected (Unparsed): [[[0.48186548,0.09231255999999999,0.44703915999999994,0.32663440000000005,0.5705059200000001,0.45717192]]]

Actual:   [[[0.4819, 0.0924, 0.4471, 0.3267, 0.5706, 0.4572]]]

Expected: [[[0.4819, 0.0924, 0.4471, 0.3267, 0.5706, 0.4572]]]