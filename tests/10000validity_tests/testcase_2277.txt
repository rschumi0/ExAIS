import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave41441 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Ave41441 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Ave41441 = keras.layers.Average(name = 'Ave41441', )([in0Ave41441,in1Ave41441])
Res57498 = keras.layers.Reshape((1, 1, 4), name = 'Res57498', )(Ave41441)
Res60413 = keras.layers.Reshape((1, 4), name = 'Res60413', )(Res57498)
GRU49229 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU49229', )(Res60413)
Res20851 = keras.layers.Reshape((2, 1), name = 'Res20851', )(GRU49229)
Res43511 = keras.layers.Reshape((2, 1, 1), name = 'Res43511', )(Res20851)
Zer58281 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer58281', )(Res43511)
Res7554 = keras.layers.Reshape((4, 3, 1, 1), name = 'Res7554', )(Zer58281)
Up_54269 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_54269', )(Res7554)
Cro59424 = keras.layers.Cropping3D(cropping=((2, 0), (0, 0), (0, 0)), name = 'Cro59424', )(Up_54269)
model = tf.keras.models.Model(inputs=[in0Ave41441,in1Ave41441], outputs=Cro59424)
w = model.get_layer('GRU49229').get_weights() 
w[0] = np.array([[10, 2, 6, 1, 2, 10], [6, 4, 3, 9, 3, 10], [6, 5, 9, 8, 2, 6], [6, 3, 4, 9, 8, 2]])
w[1] = np.array([[1, 4, 9, 3, 10, 1], [5, 2, 5, 10, 1, 6]])
w[2] = np.array([7, 8, 1, 7, 1, 1])
model.get_layer('GRU49229').set_weights(w) 
in0Ave41441 = tf.constant([[[[[0.7499, 0.7836], [0.864, 0.4351]]]]])
in1Ave41441 = tf.constant([[[[[0.5721, 0.9013], [0.339, 0.8652]]]]])
print (np.array2string(model.predict([in0Ave41441,in1Ave41441],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro59424.png')

LAve41441 = average_layer([[[[[[0.7499, 0.7836], [0.864, 0.4351]]]]], [[[[[0.5721, 0.9013], [0.339, 0.8652]]]]]], Ave41441), 
LRes57498 = reshape_layer(Ave41441, [1, 1, 4], Res57498), 
LRes60413 = reshape_layer(Res57498, [1, 4], Res60413), 
LGRU49229 = gru_layer(Res60413,[[10, 2, 6, 1, 2, 10], [6, 4, 3, 9, 3, 10], [6, 5, 9, 8, 2, 6], [6, 3, 4, 9, 8, 2]],[[1, 4, 9, 3, 10, 1], [5, 2, 5, 10, 1, 6]],[7, 8, 1, 7, 1, 1], false, GRU49229), 
LRes20851 = reshape_layer(GRU49229, [2, 1], Res20851), 
LRes43511 = reshape_layer(Res20851, [2, 1, 1], Res43511), 
LZer58281 = zero_padding2D_layer(Res43511, 1, 1, 1, 1, Zer58281), 
LRes7554 = reshape_layer(Zer58281, [4, 3, 1, 1], Res7554), 
LUp_54269 = up_sampling3D_layer(Res7554, 1, 1, 2, Up_54269), 
LCro59424 = cropping3D_layer(Up_54269, 2, 0, 0, 0, 0, 0, Cro59424), 
exec_layers([LAve41441,LRes57498,LRes60413,LGRU49229,LRes20851,LRes43511,LZer58281,LRes7554,LUp_54269,LCro59424],["Ave41441","Res57498","Res60413","GRU49229","Res20851","Res43511","Zer58281","Res7554","Up_54269","Cro59424"],Cro59424,"Cro59424")

Actual (Unparsed): [[[[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0]],[[2.1617773349191793e-8],[2.1617773349191793e-8]],[[0],[0]]],[[[0],[0]],[[0],[0]],[[0],[0]]]]]

Actual:   [[[[[0], [0]], [[0], [0]], [[0], [0]]], [[[0], [0]], [[0], [0]], [[0], [0]]]]]

Expected: [[[[[0], [0]], [[0], [0]], [[0], [0]]], [[[0], [0]], [[0], [0]], [[0], [0]]]]]