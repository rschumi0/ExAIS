import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul8802 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Mul8802 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con9139 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Loc40613 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Glo94954 = tf.keras.layers.Input(shape=([1, 2]))
in0Con4270 = tf.keras.layers.Input(shape=([10]))
in0Con79449 = tf.keras.layers.Input(shape=([12, 3]))
in0Dot82310 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot82310 = tf.keras.layers.Input(shape=([2, 2]))

Mul8802 = keras.layers.Multiply(name = 'Mul8802', )([in0Mul8802,in1Mul8802])
Res34565 = keras.layers.Reshape((2, 2, 1), name = 'Res34565', )(Mul8802)
Con9139 = keras.layers.Concatenate(axis=3, name = 'Con9139', )([Res34565,in0Con9139])
Loc40613 = keras.layers.LocallyConnected2D(3, (2, 1),strides=(1, 1), name = 'Loc40613', )(in0Loc40613)
Zer67435 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer67435', )(Loc40613)
Mul32035 = keras.layers.Multiply(name = 'Mul32035', )([Con9139,Zer67435])
Res98089 = keras.layers.Reshape((2, 6), name = 'Res98089', )(Mul32035)
Fla9060 = keras.layers.Flatten(name = 'Fla9060', )(Res98089)
Glo94954 = keras.layers.GlobalAveragePooling1D(name = 'Glo94954', )(in0Glo94954)
Con4270 = keras.layers.Concatenate(axis=1, name = 'Con4270', )([Glo94954,in0Con4270])
Add27408 = keras.layers.Add(name = 'Add27408', )([Fla9060,Con4270])
Res27965 = keras.layers.Reshape((12, 1), name = 'Res27965', )(Add27408)
Con79449 = keras.layers.Concatenate(axis=2, name = 'Con79449', )([Res27965,in0Con79449])
Dot82310 = keras.layers.Dot(axes=(2, 1), name = 'Dot82310', )([in0Dot82310,in1Dot82310])
Res52717 = keras.layers.Reshape((2, 2, 1), name = 'Res52717', )(Dot82310)
Sep50570 = keras.layers.SeparableConv2D(2, (2, 1),strides=(1, 1), padding='valid', name = 'Sep50570', )(Res52717)
Res46615 = keras.layers.Reshape((1, 4), name = 'Res46615', )(Sep50570)
Up_13050 = keras.layers.UpSampling1D(size=(2), name = 'Up_13050', )(Res46615)
Zer96859 = keras.layers.ZeroPadding1D(padding=((10, 0)), name = 'Zer96859', )(Up_13050)
Max91880 = keras.layers.Maximum(name = 'Max91880', )([Con79449,Zer96859])
Glo70465 = keras.layers.GlobalMaxPool1D(name = 'Glo70465', )(Max91880)
model = tf.keras.models.Model(inputs=[in0Mul8802,in1Mul8802,in0Con9139,in0Loc40613,in0Glo94954,in0Con4270,in0Con79449,in0Dot82310,in1Dot82310], outputs=Glo70465)
w = model.get_layer('Loc40613').get_weights() 
w[0] = np.array([[[0.979, 0.6683, 0.3476], [0.8382, 0.4929, 0.3614], [0.4354, 0.2132, 0.7034], [0.008, 0.6168, 0.0998]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc40613').set_weights(w) 
w = model.get_layer('Sep50570').get_weights() 
w[0] = np.array([[[[0.6349]]], [[[0.8924]]]])
w[1] = np.array([[[[0.6053, 0.9167]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep50570').set_weights(w) 
in0Mul8802 = tf.constant([[[[[0.6269]], [[0.8502]]], [[[0.2648]], [[0.0228]]]]])
in1Mul8802 = tf.constant([[[[[0.438]], [[0.2135]]], [[[0.4623]], [[0.3876]]]]])
in0Con9139 = tf.constant([[[[0.9178, 0.9589], [0.9047, 0.2842]], [[0.8915, 0.6755], [0.3052, 0.3642]]]])
in0Loc40613 = tf.constant([[[[0.3955, 0.9662]], [[0.3777, 0.9488]]]])
in0Glo94954 = tf.constant([[[1.1049, 1.4968]]])
in0Con4270 = tf.constant([[0.7473, 0.8115, 0.1737, 0.1643, 0.9865, 0.1534, 0.4289, 0.502, 0.256, 0.9069]])
in0Con79449 = tf.constant([[[0.1506, 0.3048, 0.5371], [0.6362, 0.4508, 0.6585], [0.7913, 0.0187, 0.7933], [0.9658, 0.0179, 0.2512], [0.2947, 0.6564, 0.4051], [0.0342, 0.243, 0.8721], [0.7052, 0.5197, 0.5834], [0.0658, 0.245, 0.7076], [0.1157, 0.5519, 0.6787], [0.4675, 0.3948, 0.6209], [0.1512, 0.051, 0.3753], [0.3496, 0.1043, 0.6315]]])
in0Dot82310 = tf.constant([[[0.3268, 0.392], [0.8562, 0.357]]])
in1Dot82310 = tf.constant([[[0.9033, 0.1656], [0.1953, 0.9096]]])
print (np.array2string(model.predict([in0Mul8802,in1Mul8802,in0Con9139,in0Loc40613,in0Glo94954,in0Con4270,in0Con79449,in0Dot82310,in1Dot82310],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo70465.png')

LMul8802 = multiply_layer([[[[[[0.6269]], [[0.8502]]], [[[0.2648]], [[0.0228]]]]], [[[[[0.438]], [[0.2135]]], [[[0.4623]], [[0.3876]]]]]], Mul8802), 
LRes34565 = reshape_layer(Mul8802, [2, 2, 1], Res34565), 
LCon9139 = concatenate_layer([Res34565,[[[[0.9178, 0.9589], [0.9047, 0.2842]], [[0.8915, 0.6755], [0.3052, 0.3642]]]]], 3, Con9139), 
LLoc40613 = locally_connected2D_layer([[[[0.3955, 0.9662]], [[0.3777, 0.9488]]]], 2, 1,[[[0.979, 0.6683, 0.3476], [0.8382, 0.4929, 0.3614], [0.4354, 0.2132, 0.7034], [0.008, 0.6168, 0.0998]]],[[[0, 0, 0]]], 1, 1, Loc40613), 
LZer67435 = zero_padding2D_layer(Loc40613, 1, 0, 1, 0, Zer67435), 
LMul32035 = multiply_layer([Con9139,Zer67435], Mul32035), 
LRes98089 = reshape_layer(Mul32035, [2, 6], Res98089), 
LFla9060 = flatten_layer(Res98089, Fla9060), 
LGlo94954 = global_average_pooling1D_layer([[[1.1049, 1.4968]]], Glo94954), 
LCon4270 = concatenate_layer([Glo94954,[[0.7473, 0.8115, 0.1737, 0.1643, 0.9865, 0.1534, 0.4289, 0.502, 0.256, 0.9069]]], 1, Con4270), 
LAdd27408 = add_layer([Fla9060,Con4270], Add27408), 
LRes27965 = reshape_layer(Add27408, [12, 1], Res27965), 
LCon79449 = concatenate_layer([Res27965,[[[0.1506, 0.3048, 0.5371], [0.6362, 0.4508, 0.6585], [0.7913, 0.0187, 0.7933], [0.9658, 0.0179, 0.2512], [0.2947, 0.6564, 0.4051], [0.0342, 0.243, 0.8721], [0.7052, 0.5197, 0.5834], [0.0658, 0.245, 0.7076], [0.1157, 0.5519, 0.6787], [0.4675, 0.3948, 0.6209], [0.1512, 0.051, 0.3753], [0.3496, 0.1043, 0.6315]]]], 2, Con79449), 
LDot82310 = dot_layer([[[0.3268, 0.392], [0.8562, 0.357]]], [[[0.9033, 0.1656], [0.1953, 0.9096]]], 2, 1, Dot82310), 
LRes52717 = reshape_layer(Dot82310, [2, 2, 1], Res52717), 
LSep50570 = separable_conv2D_layer(Res52717, 2, 1,[[[[[0.6349]]], [[[0.8924]]]],[[[[0.6053, 0.9167]]]]],[0, 0], 1, 1, false, Sep50570), 
LRes46615 = reshape_layer(Sep50570, [1, 4], Res46615), 
LUp_13050 = up_sampling1D_layer(Res46615, 2, Up_13050), 
LZer96859 = zero_padding1D_layer(Up_13050, 10, 0, Zer96859), 
LMax91880 = maximum_layer([Con79449,Zer96859], Max91880), 
LGlo70465 = global_max_pool1D_layer(Max91880, Glo70465), 
exec_layers([LMul8802,LRes34565,LCon9139,LLoc40613,LZer67435,LMul32035,LRes98089,LFla9060,LGlo94954,LCon4270,LAdd27408,LRes27965,LCon79449,LDot82310,LRes52717,LSep50570,LRes46615,LUp_13050,LZer96859,LMax91880,LGlo70465],["Mul8802","Res34565","Con9139","Loc40613","Zer67435","Mul32035","Res98089","Fla9060","Glo94954","Con4270","Add27408","Res27965","Con79449","Dot82310","Res52717","Sep50570","Res46615","Up_13050","Zer96859","Max91880","Glo70465"],Glo70465,"Glo70465")

Actual (Unparsed): [[1.4967999, 0.9658000, 0.6564000, 0.8721000]]

Expected (Unparsed): [[1.4968,0.9658,0.6564,0.8721]]

Actual:   [[1.4968, 0.9658, 0.6564, 0.8721]]

Expected: [[1.4968, 0.9658, 0.6564, 0.8721]]