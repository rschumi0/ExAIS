import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot80240 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot80240 = tf.keras.layers.Input(shape=([3, 2]))
in0Con99018 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Add40353 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add40353 = tf.keras.layers.Input(shape=([2, 1, 2]))

Dot80240 = keras.layers.Dot(axes=(1, 1), name = 'Dot80240', )([in0Dot80240,in1Dot80240])
Res64616 = keras.layers.Reshape((2, 2, 1), name = 'Res64616', )(Dot80240)
Con99018 = keras.layers.Concatenate(axis=3, name = 'Con99018', )([Res64616,in0Con99018])
Add40353 = keras.layers.Add(name = 'Add40353', )([in0Add40353,in1Add40353])
Zer18356 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer18356', )(Add40353)
Ave32733 = keras.layers.Average(name = 'Ave32733', )([Con99018,Zer18356])
model = tf.keras.models.Model(inputs=[in0Dot80240,in1Dot80240,in0Con99018,in0Add40353,in1Add40353], outputs=Ave32733)
in0Dot80240 = tf.constant([[[0.9361, 0.7453], [0.6233, 0.1527], [0.8694, 0.2706]]])
in1Dot80240 = tf.constant([[[0.47, 0.4716], [0.0187, 0.3767], [0.4601, 0.2447]]])
in0Con99018 = tf.constant([[[[0.6624], [0.6677]], [[0.6698], [0.634]]]])
in0Add40353 = tf.constant([[[[0.0275, 0.3357]], [[0.0101, 0.3161]]]])
in1Add40353 = tf.constant([[[[0.3652, 0.8321]], [[0.2689, 0.277]]]])
print (np.array2string(model.predict([in0Dot80240,in1Dot80240,in0Con99018,in0Add40353,in1Add40353],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave32733.png')

LDot80240 = dot_layer([[[0.9361, 0.7453], [0.6233, 0.1527], [0.8694, 0.2706]]], [[[0.47, 0.4716], [0.0187, 0.3767], [0.4601, 0.2447]]], 1, 1, Dot80240), 
LRes64616 = reshape_layer(Dot80240, [2, 2, 1], Res64616), 
LCon99018 = concatenate_layer([Res64616,[[[[0.6624], [0.6677]], [[0.6698], [0.634]]]]], 3, Con99018), 
LAdd40353 = add_layer([[[[[0.0275, 0.3357]], [[0.0101, 0.3161]]]], [[[[0.3652, 0.8321]], [[0.2689, 0.277]]]]], Add40353), 
LZer18356 = zero_padding2D_layer(Add40353, 0, 0, 1, 0, Zer18356), 
LAve32733 = average_layer([Con99018,Zer18356], Ave32733), 
exec_layers([LDot80240,LRes64616,LCon99018,LAdd40353,LZer18356,LAve32733],["Dot80240","Res64616","Con99018","Add40353","Zer18356","Ave32733"],Ave32733,"Ave32733")

Actual (Unparsed): [[[[0.4258168, 0.3312000], [0.6408520, 0.9177500]], [[0.2388248, 0.3349000], [0.3771107, 0.6135500]]]]

Expected (Unparsed): [[[[0.42581682499999995,0.3312],[0.640852025,0.91775]],[[0.238824775,0.3349],[0.37711069500000005,0.61355]]]]

Actual:   [[[[0.4259, 0.3312], [0.6409, 0.9178]], [[0.2389, 0.3349], [0.3772, 0.6136]]]]

Expected: [[[[0.4259, 0.3312], [0.6409, 0.9178]], [[0.2389, 0.3349], [0.3772, 0.6136]]]]