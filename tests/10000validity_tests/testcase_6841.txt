import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof57630 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Sof57630 = keras.layers.Softmax(axis=1, name = 'Sof57630', input_shape=(1, 2, 1, 1))(in0Sof57630)
Res15712 = keras.layers.Reshape((1, 2, 1), name = 'Res15712', )(Sof57630)
Con62617 = keras.layers.Conv2D(4, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con62617', )(Res15712)
Res48624 = keras.layers.Reshape((1, 4), name = 'Res48624', )(Con62617)
GRU47094 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU47094', )(Res48624)
model = tf.keras.models.Model(inputs=[in0Sof57630], outputs=GRU47094)
w = model.get_layer('Con62617').get_weights() 
w[0] = np.array([[[[0.6804, 0.727, 0.5957, 0.9773]], [[0.7648, 0.594, 0.7134, 0.6339]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con62617').set_weights(w) 
w = model.get_layer('GRU47094').get_weights() 
w[0] = np.array([[6, 5, 10], [1, 5, 1], [9, 2, 9], [4, 2, 2]])
w[1] = np.array([[9, 7, 4]])
w[2] = np.array([[5, 7, 7], [3, 3, 8]])
model.get_layer('GRU47094').set_weights(w) 
in0Sof57630 = tf.constant([[[[[0.883]], [[0.1092]]]]])
print (np.array2string(model.predict([in0Sof57630],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU47094.png')

LSof57630 = softmax_layer([[[[[0.883]], [[0.1092]]]]], 1, Sof57630), 
LRes15712 = reshape_layer(Sof57630, [1, 2, 1], Res15712), 
LCon62617 = conv2D_layer(Res15712, 1, 2,[[[[0.6804, 0.727, 0.5957, 0.9773]], [[0.7648, 0.594, 0.7134, 0.6339]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con62617), 
LRes48624 = reshape_layer(Con62617, [1, 4], Res48624), 
LGRU47094 = gru_layer(Res48624,[[6, 5, 10], [1, 5, 1], [9, 2, 9], [4, 2, 2]],[[9, 7, 4]],[[5, 7, 7], [3, 3, 8]], true, GRU47094), 
exec_layers([LSof57630,LRes15712,LCon62617,LRes48624,LGRU47094],["Sof57630","Res15712","Con62617","Res48624","GRU47094"],GRU47094,"GRU47094")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[2.220446049250313e-16]]

Actual:   [[0]]

Expected: [[0]]