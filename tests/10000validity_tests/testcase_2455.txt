import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo58959 = tf.keras.layers.Input(shape=([2, 2]))
in0Con44763 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Ave6378 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Ave6378 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Con97351 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Min97934 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Min97934 = tf.keras.layers.Input(shape=([2, 2, 2]))

Glo58959 = keras.layers.GlobalMaxPool1D(name = 'Glo58959', )(in0Glo58959)
Res44427 = keras.layers.Reshape((2, 1), name = 'Res44427', )(Glo58959)
Res86001 = keras.layers.Reshape((2, 1, 1), name = 'Res86001', )(Res44427)
Res93330 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res93330', )(Res86001)
Zer24925 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer24925', )(Res93330)
Con44763 = keras.layers.Concatenate(axis=4, name = 'Con44763', )([Zer24925,in0Con44763])
Ave6378 = keras.layers.Average(name = 'Ave6378', )([in0Ave6378,in1Ave6378])
Add41992 = keras.layers.Add(name = 'Add41992', )([Con44763,Ave6378])
Res54758 = keras.layers.Reshape((2, 1, 4), name = 'Res54758', )(Add41992)
Res53595 = keras.layers.Reshape((2, 4), name = 'Res53595', )(Res54758)
Sim96089 = keras.layers.SimpleRNN(3,name = 'Sim96089', )(Res53595)
Res99925 = keras.layers.Reshape((3, 1), name = 'Res99925', )(Sim96089)
Res87294 = keras.layers.Reshape((3, 1, 1), name = 'Res87294', )(Res99925)
Zer17494 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer17494', )(Res87294)
Con97351 = keras.layers.Concatenate(axis=3, name = 'Con97351', )([Zer17494,in0Con97351])
Min97934 = keras.layers.Minimum(name = 'Min97934', )([in0Min97934,in1Min97934])
Zer60995 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer60995', )(Min97934)
Add56452 = keras.layers.Add(name = 'Add56452', )([Con97351,Zer60995])
model = tf.keras.models.Model(inputs=[in0Glo58959,in0Con44763,in0Ave6378,in1Ave6378,in0Con97351,in0Min97934,in1Min97934], outputs=Add56452)
w = model.get_layer('Sim96089').get_weights() 
w[0] = np.array([[8, 2, 4], [4, 6, 1], [2, 4, 7], [5, 4, 2]])
w[1] = np.array([[3, 9, 4], [5, 8, 2], [3, 4, 1]])
w[2] = np.array([9, 6, 9])
model.get_layer('Sim96089').set_weights(w) 
in0Glo58959 = tf.constant([[[1.2127, 1.7502], [1.2713, 1.2264]]])
in0Con44763 = tf.constant([[[[[0.3615], [0.5531]]], [[[0.4024], [0.4578]]]]])
in0Ave6378 = tf.constant([[[[[0.0962, 0.7655], [0.0846, 0.8555]]], [[[0.0711, 0.5222], [0.7055, 0.0355]]]]])
in1Ave6378 = tf.constant([[[[[0.3731, 0.3852], [0.9135, 0.3704]]], [[[0.7231, 0.8275], [0.2805, 0.9134]]]]])
in0Con97351 = tf.constant([[[[0.0716], [0.3076], [0.7487]], [[0.837], [0.6901], [0.0366]], [[0.3313], [0.5925], [0.724]]]])
in0Min97934 = tf.constant([[[[0.1057, 0.4361], [0.7834, 0.3621]], [[0.1082, 0.8274], [0.0701, 0.1443]]]])
in1Min97934 = tf.constant([[[[0.2299, 0.4634], [0.7367, 0.3548]], [[0.5375, 0.6808], [0.209, 0.7137]]]])
print (np.array2string(model.predict([in0Glo58959,in0Con44763,in0Ave6378,in1Ave6378,in0Con97351,in0Min97934,in1Min97934],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add56452.png')

LGlo58959 = global_max_pool1D_layer([[[1.2127, 1.7502], [1.2713, 1.2264]]], Glo58959), 
LRes44427 = reshape_layer(Glo58959, [2, 1], Res44427), 
LRes86001 = reshape_layer(Res44427, [2, 1, 1], Res86001), 
LRes93330 = reshape_layer(Res86001, [2, 1, 1, 1], Res93330), 
LZer24925 = zero_padding3D_layer(Res93330, 0, 0, 0, 0, 1, 0, Zer24925), 
LCon44763 = concatenate_layer([Zer24925,[[[[[0.3615], [0.5531]]], [[[0.4024], [0.4578]]]]]], 4, Con44763), 
LAve6378 = average_layer([[[[[[0.0962, 0.7655], [0.0846, 0.8555]]], [[[0.0711, 0.5222], [0.7055, 0.0355]]]]], [[[[[0.3731, 0.3852], [0.9135, 0.3704]]], [[[0.7231, 0.8275], [0.2805, 0.9134]]]]]], Ave6378), 
LAdd41992 = add_layer([Con44763,Ave6378], Add41992), 
LRes54758 = reshape_layer(Add41992, [2, 1, 4], Res54758), 
LRes53595 = reshape_layer(Res54758, [2, 4], Res53595), 
LSim96089 = simple_rnn_layer(Res53595,[[8, 2, 4], [4, 6, 1], [2, 4, 7], [5, 4, 2]],[[3, 9, 4], [5, 8, 2], [3, 4, 1]],[9, 6, 9], Sim96089), 
LRes99925 = reshape_layer(Sim96089, [3, 1], Res99925), 
LRes87294 = reshape_layer(Res99925, [3, 1, 1], Res87294), 
LZer17494 = zero_padding2D_layer(Res87294, 0, 0, 2, 0, Zer17494), 
LCon97351 = concatenate_layer([Zer17494,[[[[0.0716], [0.3076], [0.7487]], [[0.837], [0.6901], [0.0366]], [[0.3313], [0.5925], [0.724]]]]], 3, Con97351), 
LMin97934 = minimum_layer([[[[[0.1057, 0.4361], [0.7834, 0.3621]], [[0.1082, 0.8274], [0.0701, 0.1443]]]], [[[[0.2299, 0.4634], [0.7367, 0.3548]], [[0.5375, 0.6808], [0.209, 0.7137]]]]], Min97934), 
LZer60995 = zero_padding2D_layer(Min97934, 1, 0, 1, 0, Zer60995), 
LAdd56452 = add_layer([Con97351,Zer60995], Add56452), 
exec_layers([LGlo58959,LRes44427,LRes86001,LRes93330,LZer24925,LCon44763,LAve6378,LAdd41992,LRes54758,LRes53595,LSim96089,LRes99925,LRes87294,LZer17494,LCon97351,LMin97934,LZer60995,LAdd56452],["Glo58959","Res44427","Res86001","Res93330","Zer24925","Con44763","Ave6378","Add41992","Res54758","Res53595","Sim96089","Res99925","Res87294","Zer17494","Con97351","Min97934","Zer60995","Add56452"],Add56452,"Add56452")

Actual (Unparsed): [[[[0.0000000, 0.0716000], [0.0000000, 0.3076000], [1.0000000, 0.7487000]], [[0.0000000, 0.8370000], [0.1057000, 1.1262000], [1.7367000, 0.3914000]], [[0.0000000, 0.3313000], [0.1082000, 1.2733000], [1.0701000, 0.8683000]]]]

Expected (Unparsed): [[[[0,0.0716],[0,0.3076],[1.0,0.7487]],[[0,0.837],[0.1057,1.1262],[1.7367,0.3914]],[[0,0.3313],[0.1082,1.2732999999999999],[1.0701,0.8683]]]]

Actual:   [[[[0, 0.0716], [0, 0.3076], [1, 0.7487]], [[0, 0.837], [0.1057, 1.1262], [1.7367, 0.3914]], [[0, 0.3313], [0.1082, 1.2733], [1.0701, 0.8683]]]]

Expected: [[[[0, 0.0716], [0, 0.3076], [1, 0.7487]], [[0, 0.837], [0.1057, 1.1262], [1.7367, 0.3914]], [[0, 0.3313], [0.1082, 1.2733], [1.0701, 0.8683]]]]