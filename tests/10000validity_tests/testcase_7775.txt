import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con68786 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0ELU89141 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Dot55888 = tf.keras.layers.Input(shape=([3]))
in1Dot55888 = tf.keras.layers.Input(shape=([3]))
in0Con41291 = tf.keras.layers.Input(shape=([1]))
in0Ave94557 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave94557 = tf.keras.layers.Input(shape=([2, 2, 1]))

Con68786 = keras.layers.Conv3D(2, (1, 1, 1),strides=(3, 1, 2), padding='valid', dilation_rate=(1, 1, 1), name = 'Con68786', )(in0Con68786)
Res99014 = keras.layers.Reshape((1, 1, 2), name = 'Res99014', )(Con68786)
Res2076 = keras.layers.Reshape((1, 2), name = 'Res2076', )(Res99014)
Fla17393 = keras.layers.Flatten(name = 'Fla17393', )(Res2076)
ELU89141 = keras.layers.ELU(alpha=-3.2944118643434024, name = 'ELU89141', input_shape=(1, 1, 1, 1))(in0ELU89141)
Res74644 = keras.layers.Reshape((1, 1, 1), name = 'Res74644', )(ELU89141)
Res47036 = keras.layers.Reshape((1, 1), name = 'Res47036', )(Res74644)
Glo71988 = keras.layers.GlobalMaxPool1D(name = 'Glo71988', )(Res47036)
Dot55888 = keras.layers.Dot(axes=(1, 1), name = 'Dot55888', )([in0Dot55888,in1Dot55888])
Max3247 = keras.layers.Maximum(name = 'Max3247', )([Glo71988,Dot55888])
Con41291 = keras.layers.Concatenate(axis=1, name = 'Con41291', )([Max3247,in0Con41291])
Min94806 = keras.layers.Minimum(name = 'Min94806', )([Fla17393,Con41291])
Res95593 = keras.layers.Reshape((2, 1), name = 'Res95593', )(Min94806)
Res27118 = keras.layers.Reshape((2, 1, 1), name = 'Res27118', )(Res95593)
Zer80812 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer80812', )(Res27118)
Ave94557 = keras.layers.Average(name = 'Ave94557', )([in0Ave94557,in1Ave94557])
Sub75024 = keras.layers.Subtract(name = 'Sub75024', )([Zer80812,Ave94557])
model = tf.keras.models.Model(inputs=[in0Con68786,in0ELU89141,in0Dot55888,in1Dot55888,in0Con41291,in0Ave94557,in1Ave94557], outputs=Sub75024)
w = model.get_layer('Con68786').get_weights() 
w[0] = np.array([[[[[0.8634, 0.1878]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con68786').set_weights(w) 
in0Con68786 = tf.constant([[[[[0.6615]]], [[[0.5303]]]]])
in0ELU89141 = tf.constant([[[[[0.6177]]]]])
in0Dot55888 = tf.constant([[0.7515, 0.7592, 0.6532]])
in1Dot55888 = tf.constant([[0.2631, 0.0137, 0.5431]])
in0Con41291 = tf.constant([[0.203]])
in0Ave94557 = tf.constant([[[[0.8757], [0.9974]], [[0.079], [0.5768]]]])
in1Ave94557 = tf.constant([[[[0.237], [0.0279]], [[0.1562], [0.8818]]]])
print (np.array2string(model.predict([in0Con68786,in0ELU89141,in0Dot55888,in1Dot55888,in0Con41291,in0Ave94557,in1Ave94557],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub75024.png')

LCon68786 = conv3D_layer([[[[[0.6615]]], [[[0.5303]]]]], 1, 1, 1,[[[[[0.8634, 0.1878]]]]],[0, 0], 3, 1, 2, false, 1, 1, 1, Con68786), 
LRes99014 = reshape_layer(Con68786, [1, 1, 2], Res99014), 
LRes2076 = reshape_layer(Res99014, [1, 2], Res2076), 
LFla17393 = flatten_layer(Res2076, Fla17393), 
LELU89141 = elu_layer([[[[[0.6177]]]]], -3.2944118643434024, ELU89141), 
LRes74644 = reshape_layer(ELU89141, [1, 1, 1], Res74644), 
LRes47036 = reshape_layer(Res74644, [1, 1], Res47036), 
LGlo71988 = global_max_pool1D_layer(Res47036, Glo71988), 
LDot55888 = dot_layer([[0.7515, 0.7592, 0.6532]], [[0.2631, 0.0137, 0.5431]], 1, 1, Dot55888), 
LMax3247 = maximum_layer([Glo71988,Dot55888], Max3247), 
LCon41291 = concatenate_layer([Max3247,[[0.203]]], 1, Con41291), 
LMin94806 = minimum_layer([Fla17393,Con41291], Min94806), 
LRes95593 = reshape_layer(Min94806, [2, 1], Res95593), 
LRes27118 = reshape_layer(Res95593, [2, 1, 1], Res27118), 
LZer80812 = zero_padding2D_layer(Res27118, 0, 0, 1, 0, Zer80812), 
LAve94557 = average_layer([[[[[0.8757], [0.9974]], [[0.079], [0.5768]]]], [[[[0.237], [0.0279]], [[0.1562], [0.8818]]]]], Ave94557), 
LSub75024 = subtract_layer(Zer80812,Ave94557, Sub75024), 
exec_layers([LCon68786,LRes99014,LRes2076,LFla17393,LELU89141,LRes74644,LRes47036,LGlo71988,LDot55888,LMax3247,LCon41291,LMin94806,LRes95593,LRes27118,LZer80812,LAve94557,LSub75024],["Con68786","Res99014","Res2076","Fla17393","ELU89141","Res74644","Res47036","Glo71988","Dot55888","Max3247","Con41291","Min94806","Res95593","Res27118","Zer80812","Ave94557","Sub75024"],Sub75024,"Sub75024")

Actual (Unparsed): [[[[-0.5563500], [0.0584891]], [[-0.1176000], [-0.6050703]]]]

Expected (Unparsed): [[[[-0.55635],[0.05848909999999996]],[[-0.11760000000000001],[-0.6050703000000001]]]]

Actual:   [[[[-0.5563], [0.0585]], [[-0.1176], [-0.605]]]]

Expected: [[[[-0.5563], [0.0585]], [[-0.1176], [-0.605]]]]