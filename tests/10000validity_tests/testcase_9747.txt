import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot61027 = tf.keras.layers.Input(shape=([3]))
in1Dot61027 = tf.keras.layers.Input(shape=([3]))
in0Con53214 = tf.keras.layers.Input(shape=([4, 2]))
in0Bat9445 = tf.keras.layers.Input(shape=([4, 1]))
in0Add13596 = tf.keras.layers.Input(shape=([2, 1]))
in1Add13596 = tf.keras.layers.Input(shape=([2, 1]))
in0Con13939 = tf.keras.layers.Input(shape=([4, 2]))
in0Dot70764 = tf.keras.layers.Input(shape=([2]))
in1Dot70764 = tf.keras.layers.Input(shape=([2]))
in0Glo59537 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con52668 = tf.keras.layers.Input(shape=([4, 2]))

Dot61027 = keras.layers.Dot(axes=(1, 1), name = 'Dot61027', )([in0Dot61027,in1Dot61027])
Res80688 = keras.layers.Reshape((1, 1), name = 'Res80688', )(Dot61027)
Zer38196 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer38196', )(Res80688)
Con53214 = keras.layers.Concatenate(axis=2, name = 'Con53214', )([Zer38196,in0Con53214])
Bat9445 = keras.layers.BatchNormalization(axis=1, epsilon=0.8269716513041167,  name = 'Bat9445', )(in0Bat9445)
Sep92677 = keras.layers.SeparableConv1D(3, (2),strides=(1), padding='same', name = 'Sep92677', )(Bat9445)
Add13596 = keras.layers.Add(name = 'Add13596', )([in0Add13596,in1Add13596])
Zer33658 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer33658', )(Add13596)
Con13939 = keras.layers.Concatenate(axis=2, name = 'Con13939', )([Zer33658,in0Con13939])
Ave84258 = keras.layers.Average(name = 'Ave84258', )([Sep92677,Con13939])
Add19035 = keras.layers.Add(name = 'Add19035', )([Con53214,Ave84258])
Dot70764 = keras.layers.Dot(axes=(1, 1), name = 'Dot70764', )([in0Dot70764,in1Dot70764])
Res92171 = keras.layers.Reshape((1, 1), name = 'Res92171', )(Dot70764)
Zer80717 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer80717', )(Res92171)
Glo59537 = keras.layers.GlobalMaxPool2D(name = 'Glo59537', )(in0Glo59537)
Res73682 = keras.layers.Reshape((1, 1), name = 'Res73682', )(Glo59537)
Zer72879 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer72879', )(Res73682)
Ave9824 = keras.layers.Average(name = 'Ave9824', )([Zer80717,Zer72879])
Zer56406 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer56406', )(Ave9824)
Con52668 = keras.layers.Concatenate(axis=2, name = 'Con52668', )([Zer56406,in0Con52668])
Mul16068 = keras.layers.Multiply(name = 'Mul16068', )([Add19035,Con52668])
model = tf.keras.models.Model(inputs=[in0Dot61027,in1Dot61027,in0Con53214,in0Bat9445,in0Add13596,in1Add13596,in0Con13939,in0Dot70764,in1Dot70764,in0Glo59537,in0Con52668], outputs=Mul16068)
w = model.get_layer('Bat9445').get_weights() 
w[0] = np.array([0.5255, 0.607, 0.496, 0.4432])
w[1] = np.array([0.9745, 0.0004, 0.7432, 0.5721])
w[2] = np.array([0.0282, 0.6155, 0.8456, 0.6688])
w[3] = np.array([0.7155, 0.4201, 0.0561, 0.408])
model.get_layer('Bat9445').set_weights(w) 
w = model.get_layer('Sep92677').get_weights() 
w[0] = np.array([[[0.5883]], [[0.453]]])
w[1] = np.array([[[0.4161, 0.3644, 0.9187]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep92677').set_weights(w) 
in0Dot61027 = tf.constant([[0.6768, 0.5744, 0.2021]])
in1Dot61027 = tf.constant([[0.9032, 0.4246, 0.9869]])
in0Con53214 = tf.constant([[[0.6873, 0.0123], [0.6608, 0.0596], [0.2541, 0.7309], [0.7538, 0.7908]]])
in0Bat9445 = tf.constant([[[1.2125], [1.85], [1.0445], [1.1373]]])
in0Add13596 = tf.constant([[[0.8659], [0.7082]]])
in1Add13596 = tf.constant([[[0.4311], [0.7863]]])
in0Con13939 = tf.constant([[[0.4354, 0.1623], [0.6401, 0.3411], [0.5445, 0.1798], [0.1963, 0.2707]]])
in0Dot70764 = tf.constant([[0.9735, 0.3758]])
in1Dot70764 = tf.constant([[0.1616, 0.8929]])
in0Glo59537 = tf.constant([[[[1.9968]], [[1.6568]]]])
in0Con52668 = tf.constant([[[0.971, 0.6904], [0.7707, 0.6303], [0.412, 0.2306], [0.2549, 0.9569]]])
print (np.array2string(model.predict([in0Dot61027,in1Dot61027,in0Con53214,in0Bat9445,in0Add13596,in1Add13596,in0Con13939,in0Dot70764,in1Dot70764,in0Glo59537,in0Con52668],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul16068.png')

LDot61027 = dot_layer([[0.6768, 0.5744, 0.2021]], [[0.9032, 0.4246, 0.9869]], 1, 1, Dot61027), 
LRes80688 = reshape_layer(Dot61027, [1, 1], Res80688), 
LZer38196 = zero_padding1D_layer(Res80688, 3, 0, Zer38196), 
LCon53214 = concatenate_layer([Zer38196,[[[0.6873, 0.0123], [0.6608, 0.0596], [0.2541, 0.7309], [0.7538, 0.7908]]]], 2, Con53214), 
LBat9445 = batch_normalization_layer([[[1.2125], [1.85], [1.0445], [1.1373]]], 1, 0.8269716513041167, [0.5255, 0.607, 0.496, 0.4432], [0.9745, 0.0004, 0.7432, 0.5721], [0.0282, 0.6155, 0.8456, 0.6688], [0.7155, 0.4201, 0.0561, 0.408], Bat9445), 
LSep92677 = separable_conv1D_layer(Bat9445, 2,[[[[0.5883]], [[0.453]]],[[[0.4161, 0.3644, 0.9187]]]],[0, 0, 0], 1, true, Sep92677), 
LAdd13596 = add_layer([[[[0.8659], [0.7082]]], [[[0.4311], [0.7863]]]], Add13596), 
LZer33658 = zero_padding1D_layer(Add13596, 2, 0, Zer33658), 
LCon13939 = concatenate_layer([Zer33658,[[[0.4354, 0.1623], [0.6401, 0.3411], [0.5445, 0.1798], [0.1963, 0.2707]]]], 2, Con13939), 
LAve84258 = average_layer([Sep92677,Con13939], Ave84258), 
LAdd19035 = add_layer([Con53214,Ave84258], Add19035), 
LDot70764 = dot_layer([[0.9735, 0.3758]], [[0.1616, 0.8929]], 1, 1, Dot70764), 
LRes92171 = reshape_layer(Dot70764, [1, 1], Res92171), 
LZer80717 = zero_padding1D_layer(Res92171, 2, 0, Zer80717), 
LGlo59537 = global_max_pool2D_layer([[[[1.9968]], [[1.6568]]]], Glo59537), 
LRes73682 = reshape_layer(Glo59537, [1, 1], Res73682), 
LZer72879 = zero_padding1D_layer(Res73682, 1, 1, Zer72879), 
LAve9824 = average_layer([Zer80717,Zer72879], Ave9824), 
LZer56406 = zero_padding1D_layer(Ave9824, 1, 0, Zer56406), 
LCon52668 = concatenate_layer([Zer56406,[[[0.971, 0.6904], [0.7707, 0.6303], [0.412, 0.2306], [0.2549, 0.9569]]]], 2, Con52668), 
LMul16068 = multiply_layer([Add19035,Con52668], Mul16068), 
exec_layers([LDot61027,LRes80688,LZer38196,LCon53214,LBat9445,LSep92677,LAdd13596,LZer33658,LCon13939,LAve84258,LAdd19035,LDot70764,LRes92171,LZer80717,LGlo59537,LRes73682,LZer72879,LAve9824,LZer56406,LCon52668,LMul16068],["Dot61027","Res80688","Zer38196","Con53214","Bat9445","Sep92677","Add13596","Zer33658","Con13939","Ave84258","Add19035","Dot70764","Res92171","Zer80717","Glo59537","Res73682","Zer72879","Ave9824","Zer56406","Con52668","Mul16068"],Mul16068,"Mul16068")

Actual (Unparsed): [[[0.0000000, 1.0861448, 0.4362793], [0.0000000, 0.8653606, 0.3706704], [0.8225239, 0.2801213, 0.2785497], [0.4669371, 0.2378982, 1.0824873]]]

Expected (Unparsed): [[[0.0,1.0861447956119044,0.4362792710141199],[0.0,0.8653606446401627,0.37067036245250495],[0.8225238861003545,0.2801212574984077,0.2785497292797398],[0.4669371321246225,0.23789816108653897,1.0824872766563771]]]

Actual:   [[[0, 1.0862, 0.4363], [0, 0.8654, 0.3707], [0.8226, 0.2802, 0.2786], [0.467, 0.2379, 1.0825]]]

Expected: [[[0, 1.0862, 0.4363], [0, 0.8654, 0.3707], [0.8226, 0.2802, 0.2786], [0.467, 0.2379, 1.0825]]]