import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max91421 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Max91421 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Con24303 = tf.keras.layers.Input(shape=([1]))
in0Bat86752 = tf.keras.layers.Input(shape=([1, 3, 3]))

Max91421 = keras.layers.Maximum(name = 'Max91421', )([in0Max91421,in1Max91421])
Res40350 = keras.layers.Reshape((2, 1, 1), name = 'Res40350', )(Max91421)
Res8510 = keras.layers.Reshape((2, 1), name = 'Res8510', )(Res40350)
Fla90153 = keras.layers.Flatten(name = 'Fla90153', )(Res8510)
Con24303 = keras.layers.Concatenate(axis=1, name = 'Con24303', )([Fla90153,in0Con24303])
Bat86752 = keras.layers.BatchNormalization(axis=1, epsilon=0.599801497366041,  name = 'Bat86752', )(in0Bat86752)
Zer33601 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer33601', )(Bat86752)
Max45676 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(2, 2), padding='valid', name = 'Max45676', )(Zer33601)
Glo6575 = keras.layers.GlobalMaxPool2D(name = 'Glo6575', )(Max45676)
Sub64470 = keras.layers.Subtract(name = 'Sub64470', )([Con24303,Glo6575])
Res36357 = keras.layers.Reshape((3, 1), name = 'Res36357', )(Sub64470)
Up_32582 = keras.layers.UpSampling1D(size=(1), name = 'Up_32582', )(Res36357)
model = tf.keras.models.Model(inputs=[in0Max91421,in1Max91421,in0Con24303,in0Bat86752], outputs=Up_32582)
w = model.get_layer('Bat86752').get_weights() 
w[0] = np.array([0.1156])
w[1] = np.array([0.547])
w[2] = np.array([0.5249])
w[3] = np.array([0.8615])
model.get_layer('Bat86752').set_weights(w) 
in0Max91421 = tf.constant([[[[[0.0676]]], [[[0.1358]]]]])
in1Max91421 = tf.constant([[[[[0.2184]]], [[[0.516]]]]])
in0Con24303 = tf.constant([[0.2319]])
in0Bat86752 = tf.constant([[[[1.842, 1.5973, 1.6657], [1.1301, 1.0995, 1.1942], [1.1915, 1.7968, 1.9801]]]])
print (np.array2string(model.predict([in0Max91421,in1Max91421,in0Con24303,in0Bat86752],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_32582.png')

LMax91421 = maximum_layer([[[[[[0.0676]]], [[[0.1358]]]]], [[[[[0.2184]]], [[[0.516]]]]]], Max91421), 
LRes40350 = reshape_layer(Max91421, [2, 1, 1], Res40350), 
LRes8510 = reshape_layer(Res40350, [2, 1], Res8510), 
LFla90153 = flatten_layer(Res8510, Fla90153), 
LCon24303 = concatenate_layer([Fla90153,[[0.2319]]], 1, Con24303), 
LBat86752 = batch_normalization_layer([[[[1.842, 1.5973, 1.6657], [1.1301, 1.0995, 1.1942], [1.1915, 1.7968, 1.9801]]]], 1, 0.599801497366041, [0.1156], [0.547], [0.5249], [0.8615], Bat86752), 
LZer33601 = zero_padding2D_layer(Bat86752, 1, 1, 1, 1, Zer33601), 
LMax45676 = max_pool2D_layer(Zer33601, 2, 1, 2, 2, false, Max45676), 
LGlo6575 = global_max_pool2D_layer(Max45676, Glo6575), 
LSub64470 = subtract_layer(Con24303,Glo6575, Sub64470), 
LRes36357 = reshape_layer(Sub64470, [3, 1], Res36357), 
LUp_32582 = up_sampling1D_layer(Res36357, 1, Up_32582), 
exec_layers([LMax91421,LRes40350,LRes8510,LFla90153,LCon24303,LBat86752,LZer33601,LMax45676,LGlo6575,LSub64470,LRes36357,LUp_32582],["Max91421","Res40350","Res8510","Fla90153","Con24303","Bat86752","Zer33601","Max45676","Glo6575","Sub64470","Res36357","Up_32582"],Up_32582,"Up_32582")

Actual (Unparsed): [[[-0.3864744], [-0.0859482], [-0.3791042]]]

Expected (Unparsed): [[[-0.38647444493364025],[-0.08594820895384947],[-0.37910423991091446]]]

Actual:   [[[-0.3864], [-0.0859], [-0.3791]]]

Expected: [[[-0.3864], [-0.0859], [-0.3791]]]