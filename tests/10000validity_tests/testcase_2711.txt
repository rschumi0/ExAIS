import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla1227 = tf.keras.layers.Input(shape=([4, 1]))
in0Con15752 = tf.keras.layers.Input(shape=([4, 3]))
in0Add76784 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Add76784 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Fla1227 = keras.layers.Flatten(name = 'Fla1227', )(in0Fla1227)
Res40084 = keras.layers.Reshape((4, 1), name = 'Res40084', )(Fla1227)
Con15752 = keras.layers.Concatenate(axis=2, name = 'Con15752', )([Res40084,in0Con15752])
Add76784 = keras.layers.Add(name = 'Add76784', )([in0Add76784,in1Add76784])
ReL87951 = keras.layers.ReLU(max_value=6.285327980599921, negative_slope=2.836044845862273, threshold=3.191591625325836, name = 'ReL87951', )(Add76784)
Res74372 = keras.layers.Reshape((2, 1, 4), name = 'Res74372', )(ReL87951)
Res53102 = keras.layers.Reshape((2, 4), name = 'Res53102', )(Res74372)
Dot5438 = keras.layers.Dot(axes=(1, 2), name = 'Dot5438', )([Con15752,Res53102])
model = tf.keras.models.Model(inputs=[in0Fla1227,in0Con15752,in0Add76784,in1Add76784], outputs=Dot5438)
in0Fla1227 = tf.constant([[[1.9387], [1.5783], [1.8284], [1.4617]]])
in0Con15752 = tf.constant([[[0.8131, 0.1362, 0.5911], [0.9449, 0.0661, 0.4751], [0.738, 0.9704, 0.9276], [0.9246, 0.4543, 0.8889]]])
in0Add76784 = tf.constant([[[[[0.6576, 0.9298], [0.0208, 0.2599]]], [[[0.599, 0.8939], [0.7387, 0.737]]]]])
in1Add76784 = tf.constant([[[[[0.6907, 0.0917], [0.0364, 0.7222]]], [[[0.5241, 0.1896], [0.3052, 0.3904]]]]])
print (np.array2string(model.predict([in0Fla1227,in0Con15752,in0Add76784,in1Add76784],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot5438.png')

LFla1227 = flatten_layer([[[1.9387], [1.5783], [1.8284], [1.4617]]], Fla1227), 
LRes40084 = reshape_layer(Fla1227, [4, 1], Res40084), 
LCon15752 = concatenate_layer([Res40084,[[[0.8131, 0.1362, 0.5911], [0.9449, 0.0661, 0.4751], [0.738, 0.9704, 0.9276], [0.9246, 0.4543, 0.8889]]]], 2, Con15752), 
LAdd76784 = add_layer([[[[[[0.6576, 0.9298], [0.0208, 0.2599]]], [[[0.599, 0.8939], [0.7387, 0.737]]]]], [[[[[0.6907, 0.0917], [0.0364, 0.7222]]], [[[0.5241, 0.1896], [0.3052, 0.3904]]]]]], Add76784), 
LReL87951 = relu_layer(Add76784, 6.285327980599921, 2.836044845862273, 3.191591625325836, ReL87951), 
LRes74372 = reshape_layer(ReL87951, [2, 1, 4], Res74372), 
LRes53102 = reshape_layer(Res74372, [2, 4], Res53102), 
LDot5438 = dot_layer(Con15752,Res53102, 1, 2, Dot5438), 
exec_layers([LFla1227,LRes40084,LCon15752,LAdd76784,LReL87951,LRes74372,LRes53102,LDot5438],["Fla1227","Res40084","Con15752","Add76784","ReL87951","Res74372","Res53102","Dot5438"],Dot5438,"Dot5438")

Actual (Unparsed): [[[-45.2609520, -40.5028440], [-22.4200033, -20.3269948], [-12.5917128, -9.7643764], [-19.8297930, -17.1617538]]]

Expected (Unparsed): [[[-45.260952006071676,-40.50284398757341],[-22.420003620546947,-20.3269949804213],[-12.59171312476662,-9.764376553126706],[-19.82979285580916,-17.16175369007021]]]

Actual:   [[[-45.2609, -40.5028], [-22.42, -20.3269], [-12.5917, -9.7643], [-19.8297, -17.1617]]]

Expected: [[[-45.2609, -40.5028], [-22.42, -20.3269], [-12.5917, -9.7643], [-19.8297, -17.1617]]]