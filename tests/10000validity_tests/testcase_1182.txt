import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min19146 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min19146 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con15427 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Dot80293 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot80293 = tf.keras.layers.Input(shape=([3, 2]))
in0Con37050 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave89090 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave89090 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con21898 = tf.keras.layers.Input(shape=([1, 2]))
in0Dot88702 = tf.keras.layers.Input(shape=([2]))
in1Dot88702 = tf.keras.layers.Input(shape=([2]))
in0Con39344 = tf.keras.layers.Input(shape=([3]))
in0Per24593 = tf.keras.layers.Input(shape=([1, 2]))
in0Con16446 = tf.keras.layers.Input(shape=([3]))
in0Con30056 = tf.keras.layers.Input(shape=([4]))

Min19146 = keras.layers.Minimum(name = 'Min19146', )([in0Min19146,in1Min19146])
Zer30432 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer30432', )(Min19146)
Con15427 = keras.layers.Concatenate(axis=3, name = 'Con15427', )([Zer30432,in0Con15427])
Dot80293 = keras.layers.Dot(axes=(1, 1), name = 'Dot80293', )([in0Dot80293,in1Dot80293])
Res16428 = keras.layers.Reshape((2, 2, 1), name = 'Res16428', )(Dot80293)
Con37050 = keras.layers.Concatenate(axis=3, name = 'Con37050', )([Res16428,in0Con37050])
Ave89090 = keras.layers.Average(name = 'Ave89090', )([in0Ave89090,in1Ave89090])
Zer5974 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer5974', )(Ave89090)
Min98171 = keras.layers.Minimum(name = 'Min98171', )([Con37050,Zer5974])
Ave3047 = keras.layers.Average(name = 'Ave3047', )([Con15427,Min98171])
Res74451 = keras.layers.Reshape((2, 4), name = 'Res74451', )(Ave3047)
Fla93923 = keras.layers.Flatten(name = 'Fla93923', )(Res74451)
Con21898 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con21898', )(in0Con21898)
Res83444 = keras.layers.Reshape((1, 4, 1), name = 'Res83444', )(Con21898)
Up_41106 = keras.layers.UpSampling2D(size=(1, 1), name = 'Up_41106', )(Res83444)
Res10701 = keras.layers.Reshape((1, 4), name = 'Res10701', )(Up_41106)
Fla34801 = keras.layers.Flatten(name = 'Fla34801', )(Res10701)
Dot88702 = keras.layers.Dot(axes=(1, 1), name = 'Dot88702', )([in0Dot88702,in1Dot88702])
Con39344 = keras.layers.Concatenate(axis=1, name = 'Con39344', )([Dot88702,in0Con39344])
Max86938 = keras.layers.Maximum(name = 'Max86938', )([Fla34801,Con39344])
Per24593 = keras.layers.Permute((1,2), name = 'Per24593',)(in0Per24593)
Res92732 = keras.layers.Reshape((1, 2, 1), name = 'Res92732', )(Per24593)
Res7328 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res7328', )(Res92732)
Glo50861 = keras.layers.GlobalAveragePooling3D(name = 'Glo50861', )(Res7328)
Con16446 = keras.layers.Concatenate(axis=1, name = 'Con16446', )([Glo50861,in0Con16446])
Add50936 = keras.layers.Add(name = 'Add50936', )([Max86938,Con16446])
Con30056 = keras.layers.Concatenate(axis=1, name = 'Con30056', )([Add50936,in0Con30056])
Ave63669 = keras.layers.Average(name = 'Ave63669', )([Fla93923,Con30056])
model = tf.keras.models.Model(inputs=[in0Min19146,in1Min19146,in0Con15427,in0Dot80293,in1Dot80293,in0Con37050,in0Ave89090,in1Ave89090,in0Con21898,in0Dot88702,in1Dot88702,in0Con39344,in0Per24593,in0Con16446,in0Con30056], outputs=Ave63669)
w = model.get_layer('Con21898').get_weights() 
w[0] = np.array([[[0.1201, 0.6919, 0.2827, 0.0356], [0.2588, 0.5536, 0.2476, 0.9252]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con21898').set_weights(w) 
in0Min19146 = tf.constant([[[[0.3602]]]])
in1Min19146 = tf.constant([[[[0.6601]]]])
in0Con15427 = tf.constant([[[[0.7419], [0.8115]], [[0.7902], [0.2417]]]])
in0Dot80293 = tf.constant([[[0.7494, 0.2503], [0.5549, 0.0794], [0.2414, 0.179]]])
in1Dot80293 = tf.constant([[[0.1544, 0.6813], [0.0966, 0.1966], [0.7892, 0.8141]]])
in0Con37050 = tf.constant([[[[0.0536], [0.6865]], [[0.0681], [0.4552]]]])
in0Ave89090 = tf.constant([[[[0.3954, 0.8682], [0.6523, 0.5096]]]])
in1Ave89090 = tf.constant([[[[0.2655, 0.065], [0.2571, 0.0316]]]])
in0Con21898 = tf.constant([[[0.8123, 0.054]]])
in0Dot88702 = tf.constant([[0.6773, 0.1453]])
in1Dot88702 = tf.constant([[0.3678, 0.8641]])
in0Con39344 = tf.constant([[0.0194, 0.2537, 0.9101]])
in0Per24593 = tf.constant([[[1.8558, 1.8326]]])
in0Con16446 = tf.constant([[0.3848, 0.2194, 0.5528]])
in0Con30056 = tf.constant([[0.3443, 0.4677, 0.0116, 0.1091]])
print (np.array2string(model.predict([in0Min19146,in1Min19146,in0Con15427,in0Dot80293,in1Dot80293,in0Con37050,in0Ave89090,in1Ave89090,in0Con21898,in0Dot88702,in1Dot88702,in0Con39344,in0Per24593,in0Con16446,in0Con30056],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave63669.png')

LMin19146 = minimum_layer([[[[[0.3602]]]], [[[[0.6601]]]]], Min19146), 
LZer30432 = zero_padding2D_layer(Min19146, 1, 0, 1, 0, Zer30432), 
LCon15427 = concatenate_layer([Zer30432,[[[[0.7419], [0.8115]], [[0.7902], [0.2417]]]]], 3, Con15427), 
LDot80293 = dot_layer([[[0.7494, 0.2503], [0.5549, 0.0794], [0.2414, 0.179]]], [[[0.1544, 0.6813], [0.0966, 0.1966], [0.7892, 0.8141]]], 1, 1, Dot80293), 
LRes16428 = reshape_layer(Dot80293, [2, 2, 1], Res16428), 
LCon37050 = concatenate_layer([Res16428,[[[[0.0536], [0.6865]], [[0.0681], [0.4552]]]]], 3, Con37050), 
LAve89090 = average_layer([[[[[0.3954, 0.8682], [0.6523, 0.5096]]]], [[[[0.2655, 0.065], [0.2571, 0.0316]]]]], Ave89090), 
LZer5974 = zero_padding2D_layer(Ave89090, 1, 0, 0, 0, Zer5974), 
LMin98171 = minimum_layer([Con37050,Zer5974], Min98171), 
LAve3047 = average_layer([Con15427,Min98171], Ave3047), 
LRes74451 = reshape_layer(Ave3047, [2, 4], Res74451), 
LFla93923 = flatten_layer(Res74451, Fla93923), 
LCon21898 = conv1D_layer([[[0.8123, 0.054]]], 1,[[[0.1201, 0.6919, 0.2827, 0.0356], [0.2588, 0.5536, 0.2476, 0.9252]]],[0, 0, 0, 0], 1, true, 1, Con21898), 
LRes83444 = reshape_layer(Con21898, [1, 4, 1], Res83444), 
LUp_41106 = up_sampling2D_layer(Res83444, 1, 1, Up_41106), 
LRes10701 = reshape_layer(Up_41106, [1, 4], Res10701), 
LFla34801 = flatten_layer(Res10701, Fla34801), 
LDot88702 = dot_layer([[0.6773, 0.1453]], [[0.3678, 0.8641]], 1, 1, Dot88702), 
LCon39344 = concatenate_layer([Dot88702,[[0.0194, 0.2537, 0.9101]]], 1, Con39344), 
LMax86938 = maximum_layer([Fla34801,Con39344], Max86938), 
LPer24593 = permute_layer([[[1.8558, 1.8326]]], 1,2, Per24593), 
LRes92732 = reshape_layer(Per24593, [1, 2, 1], Res92732), 
LRes7328 = reshape_layer(Res92732, [1, 2, 1, 1], Res7328), 
LGlo50861 = global_average_pooling3D_layer(Res7328, Glo50861), 
LCon16446 = concatenate_layer([Glo50861,[[0.3848, 0.2194, 0.5528]]], 1, Con16446), 
LAdd50936 = add_layer([Max86938,Con16446], Add50936), 
LCon30056 = concatenate_layer([Add50936,[[0.3443, 0.4677, 0.0116, 0.1091]]], 1, Con30056), 
LAve63669 = average_layer([Fla93923,Con30056], Ave63669), 
exec_layers([LMin19146,LZer30432,LCon15427,LDot80293,LRes16428,LCon37050,LAve89090,LZer5974,LMin98171,LAve3047,LRes74451,LFla93923,LCon21898,LRes83444,LUp_41106,LRes10701,LFla34801,LDot88702,LCon39344,LMax86938,LPer24593,LRes92732,LRes7328,LGlo50861,LCon16446,LAdd50936,LCon30056,LAve63669],["Min19146","Zer30432","Con15427","Dot80293","Res16428","Con37050","Ave89090","Zer5974","Min98171","Ave3047","Res74451","Fla93923","Con21898","Res83444","Up_41106","Res10701","Fla34801","Dot88702","Con39344","Max86938","Per24593","Res92732","Res7328","Glo50861","Con16446","Add50936","Con30056","Ave63669"],Ave63669,"Ave63669")

Actual (Unparsed): [[1.1094323, 0.6738374, 0.2365500, 0.9343250, 0.2190458, 0.4484250, 0.1788158, 0.1826250]]

Expected (Unparsed): [[1.109432335,0.6738373849999999,0.23654999999999998,0.934325,0.21904579,0.448425,0.17881583250000002,0.18262499999999998]]

Actual:   [[1.1095, 0.6739, 0.2366, 0.9344, 0.2191, 0.4485, 0.1789, 0.1827]]

Expected: [[1.1095, 0.6739, 0.2366, 0.9344, 0.2191, 0.4485, 0.1789, 0.1827]]