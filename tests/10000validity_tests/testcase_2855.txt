import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea89435 = tf.keras.layers.Input(shape=([1, 1]))
in0Cro62982 = tf.keras.layers.Input(shape=([1, 2, 1, 3]))
in0Con50342 = tf.keras.layers.Input(shape=([9]))

Lea89435 = keras.layers.LeakyReLU(alpha=0.2992091937791221, name = 'Lea89435', input_shape=(1, 1))(in0Lea89435)
Res86423 = keras.layers.Reshape((1, 1, 1), name = 'Res86423', )(Lea89435)
Glo33694 = keras.layers.GlobalAveragePooling2D(name = 'Glo33694', )(Res86423)
Res68506 = keras.layers.Reshape((1, 1), name = 'Res68506', )(Glo33694)
Res26146 = keras.layers.Reshape((1, 1, 1), name = 'Res26146', )(Res68506)
Res43684 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res43684', )(Res26146)
Con62702 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 4, 1), padding='same', name = 'Con62702', )(Res43684)
Res22823 = keras.layers.Reshape((1, 4, 3), name = 'Res22823', )(Con62702)
Res25245 = keras.layers.Reshape((1, 12), name = 'Res25245', )(Res22823)
Fla56905 = keras.layers.Flatten(name = 'Fla56905', )(Res25245)
Cro62982 = keras.layers.Cropping3D(cropping=((0, 0), (0, 1), (0, 0)), name = 'Cro62982', )(in0Cro62982)
Fla97133 = keras.layers.Flatten(name = 'Fla97133', )(Cro62982)
Con50342 = keras.layers.Concatenate(axis=1, name = 'Con50342', )([Fla97133,in0Con50342])
Ave51868 = keras.layers.Average(name = 'Ave51868', )([Fla56905,Con50342])
model = tf.keras.models.Model(inputs=[in0Lea89435,in0Cro62982,in0Con50342], outputs=Ave51868)
w = model.get_layer('Con62702').get_weights() 
w[0] = np.array([[[[[0.0501], [0.7638], [0.5802]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con62702').set_weights(w) 
in0Lea89435 = tf.constant([[[0.0308]]])
in0Cro62982 = tf.constant([[[[[1.7909, 1.7893, 1.1887]], [[1.6627, 1.2137, 1.8261]]]]])
in0Con50342 = tf.constant([[0.4557, 0.6043, 0.9531, 0.4334, 0.0984, 0.0782, 0.5642, 0.5916, 0.5193]])
print (np.array2string(model.predict([in0Lea89435,in0Cro62982,in0Con50342],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave51868.png')

LLea89435 = leaky_relu_layer([[[0.0308]]], 0.2992091937791221, Lea89435), 
LRes86423 = reshape_layer(Lea89435, [1, 1, 1], Res86423), 
LGlo33694 = global_average_pooling2D_layer(Res86423, Glo33694), 
LRes68506 = reshape_layer(Glo33694, [1, 1], Res68506), 
LRes26146 = reshape_layer(Res68506, [1, 1, 1], Res26146), 
LRes43684 = reshape_layer(Res26146, [1, 1, 1, 1], Res43684), 
LCon62702 = conv3D_transpose_layer(Res43684, 1, 1, 1,[[[[[0.0501], [0.7638], [0.5802]]]]],[0, 0, 0], 1, 4, 1, true, Con62702), 
LRes22823 = reshape_layer(Con62702, [1, 4, 3], Res22823), 
LRes25245 = reshape_layer(Res22823, [1, 12], Res25245), 
LFla56905 = flatten_layer(Res25245, Fla56905), 
LCro62982 = cropping3D_layer([[[[[1.7909, 1.7893, 1.1887]], [[1.6627, 1.2137, 1.8261]]]]], 0, 0, 0, 1, 0, 0, Cro62982), 
LFla97133 = flatten_layer(Cro62982, Fla97133), 
LCon50342 = concatenate_layer([Fla97133,[[0.4557, 0.6043, 0.9531, 0.4334, 0.0984, 0.0782, 0.5642, 0.5916, 0.5193]]], 1, Con50342), 
LAve51868 = average_layer([Fla56905,Con50342], Ave51868), 
exec_layers([LLea89435,LRes86423,LGlo33694,LRes68506,LRes26146,LRes43684,LCon62702,LRes22823,LRes25245,LFla56905,LCro62982,LFla97133,LCon50342,LAve51868],["Lea89435","Res86423","Glo33694","Res68506","Res26146","Res43684","Con62702","Res22823","Res25245","Fla56905","Cro62982","Fla97133","Con50342","Ave51868"],Ave51868,"Ave51868")

Actual (Unparsed): [[0.8962215, 0.9064125, 0.6032851, 0.2278500, 0.3021500, 0.4765500, 0.2167000, 0.0492000, 0.0391000, 0.2821000, 0.2958000, 0.2596500]]

Expected (Unparsed): [[0.89622154,0.9064125199999999,0.60328508,0.22785,0.30215,0.47655,0.2167,0.0492,0.0391,0.2821,0.2958,0.25965]]

Actual:   [[0.8963, 0.9065, 0.6033, 0.2279, 0.3022, 0.4766, 0.2167, 0.0492, 0.0391, 0.2821, 0.2958, 0.2597]]

Expected: [[0.8963, 0.9065, 0.6033, 0.2279, 0.3022, 0.4766, 0.2167, 0.0492, 0.0391, 0.2821, 0.2958, 0.2597]]