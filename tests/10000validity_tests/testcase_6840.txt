import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc16222 = tf.keras.layers.Input(shape=([2, 2, 1]))

Loc16222 = keras.layers.LocallyConnected2D(3, (1, 2),strides=(1, 2), name = 'Loc16222', )(in0Loc16222)
Sep25561 = keras.layers.SeparableConv2D(3, (2, 1),strides=(1, 1), padding='valid', name = 'Sep25561', )(Loc16222)
model = tf.keras.models.Model(inputs=[in0Loc16222], outputs=Sep25561)
w = model.get_layer('Loc16222').get_weights() 
w[0] = np.array([[[0.4123, 0.1736, 0.0786], [0.5558, 0.3377, 0.9523]], [[0.7752, 0.4486, 0.0891], [0.2507, 0.7205, 0.6316]]])
w[1] = np.array([[[0, 0, 0]], [[0, 0, 0]]])
model.get_layer('Loc16222').set_weights(w) 
w = model.get_layer('Sep25561').get_weights() 
w[0] = np.array([[[[0.3269], [0.6543], [0.8526]]], [[[0.3391], [0.3512], [0.1968]]]])
w[1] = np.array([[[[0.2781, 0.6425, 0.7024], [0.543, 0.3726, 0.4549], [0.4032, 0.4566, 0.7523]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep25561').set_weights(w) 
in0Loc16222 = tf.constant([[[[0.4304], [0.1102]], [[0.1759], [0.4687]]]])
print (np.array2string(model.predict([in0Loc16222],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep25561.png')

LLoc16222 = locally_connected2D_layer([[[[0.4304], [0.1102]], [[0.1759], [0.4687]]]], 1, 2,[[[0.4123, 0.1736, 0.0786], [0.5558, 0.3377, 0.9523]], [[0.7752, 0.4486, 0.0891], [0.2507, 0.7205, 0.6316]]],[[[0, 0, 0]], [[0, 0, 0]]], 1, 2, Loc16222), 
LSep25561 = separable_conv2D_layer(Loc16222, 2, 1,[[[[[0.3269], [0.6543], [0.8526]]], [[[0.3391], [0.3512], [0.1968]]]],[[[[0.2781, 0.6425, 0.7024], [0.543, 0.3726, 0.4549], [0.4032, 0.4566, 0.7523]]]]],[0, 0, 0], 1, 1, false, Sep25561), 
exec_layers([LLoc16222,LSep25561],["Loc16222","Sep25561"],Sep25561,"Sep25561")

Actual (Unparsed): [[[[0.2372954, 0.2692821, 0.3503073]]]]

Expected (Unparsed): [[[[0.23729543617760557,0.2692820524200755,0.35030730946033184]]]]

Actual:   [[[[0.2373, 0.2693, 0.3504]]]]

Expected: [[[[0.2373, 0.2693, 0.3504]]]]