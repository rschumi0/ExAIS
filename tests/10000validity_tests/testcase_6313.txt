import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave48971 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave48971 = tf.keras.layers.Input(shape=([1, 2]))
in0Con33769 = tf.keras.layers.Input(shape=([1]))
in0Sub26265 = tf.keras.layers.Input(shape=([3]))
in1Sub26265 = tf.keras.layers.Input(shape=([3]))
in0Con18158 = tf.keras.layers.Input(shape=([4, 2]))
in0Sub53837 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub53837 = tf.keras.layers.Input(shape=([2, 3]))

Ave48971 = keras.layers.Average(name = 'Ave48971', )([in0Ave48971,in1Ave48971])
Fla86534 = keras.layers.Flatten(name = 'Fla86534', )(Ave48971)
Con33769 = keras.layers.Concatenate(axis=1, name = 'Con33769', )([Fla86534,in0Con33769])
Sub26265 = keras.layers.Subtract(name = 'Sub26265', )([in0Sub26265,in1Sub26265])
Mul18853 = keras.layers.Multiply(name = 'Mul18853', )([Con33769,Sub26265])
Res74319 = keras.layers.Reshape((3, 1), name = 'Res74319', )(Mul18853)
Zer14036 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer14036', )(Res74319)
Con18158 = keras.layers.Concatenate(axis=2, name = 'Con18158', )([Zer14036,in0Con18158])
Sub53837 = keras.layers.Subtract(name = 'Sub53837', )([in0Sub53837,in1Sub53837])
Zer42800 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer42800', )(Sub53837)
Sub69303 = keras.layers.Subtract(name = 'Sub69303', )([Con18158,Zer42800])
model = tf.keras.models.Model(inputs=[in0Ave48971,in1Ave48971,in0Con33769,in0Sub26265,in1Sub26265,in0Con18158,in0Sub53837,in1Sub53837], outputs=Sub69303)
in0Ave48971 = tf.constant([[[0.8548, 0.0425]]])
in1Ave48971 = tf.constant([[[0.1779, 0.6966]]])
in0Con33769 = tf.constant([[0.4657]])
in0Sub26265 = tf.constant([[0.0939, 0.3173, 0.3128]])
in1Sub26265 = tf.constant([[0.4444, 0.3849, 0.8658]])
in0Con18158 = tf.constant([[[0.5602, 0.8374], [0.6794, 0.8394], [0.6788, 0.8902], [0.8755, 0.0784]]])
in0Sub53837 = tf.constant([[[0.964, 0.9053, 0.2136], [0.7642, 0.8119, 0.2897]]])
in1Sub53837 = tf.constant([[[0.131, 0.0668, 0.5509], [0.0413, 0.8846, 0.8597]]])
print (np.array2string(model.predict([in0Ave48971,in1Ave48971,in0Con33769,in0Sub26265,in1Sub26265,in0Con18158,in0Sub53837,in1Sub53837],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub69303.png')

LAve48971 = average_layer([[[[0.8548, 0.0425]]], [[[0.1779, 0.6966]]]], Ave48971), 
LFla86534 = flatten_layer(Ave48971, Fla86534), 
LCon33769 = concatenate_layer([Fla86534,[[0.4657]]], 1, Con33769), 
LSub26265 = subtract_layer([[0.0939, 0.3173, 0.3128]], [[0.4444, 0.3849, 0.8658]], Sub26265), 
LMul18853 = multiply_layer([Con33769,Sub26265], Mul18853), 
LRes74319 = reshape_layer(Mul18853, [3, 1], Res74319), 
LZer14036 = zero_padding1D_layer(Res74319, 1, 0, Zer14036), 
LCon18158 = concatenate_layer([Zer14036,[[[0.5602, 0.8374], [0.6794, 0.8394], [0.6788, 0.8902], [0.8755, 0.0784]]]], 2, Con18158), 
LSub53837 = subtract_layer([[[0.964, 0.9053, 0.2136], [0.7642, 0.8119, 0.2897]]], [[[0.131, 0.0668, 0.5509], [0.0413, 0.8846, 0.8597]]], Sub53837), 
LZer42800 = zero_padding1D_layer(Sub53837, 1, 1, Zer42800), 
LSub69303 = subtract_layer(Con18158,Zer42800, Sub69303), 
exec_layers([LAve48971,LFla86534,LCon33769,LSub26265,LMul18853,LRes74319,LZer14036,LCon18158,LSub53837,LZer42800,LSub69303],["Ave48971","Fla86534","Con33769","Sub26265","Mul18853","Res74319","Zer14036","Con18158","Sub53837","Zer42800","Sub69303"],Sub69303,"Sub69303")

Actual (Unparsed): [[[0.0000000, 0.5602000, 0.8374000], [-1.0139807, -0.1591000, 1.1767000], [-0.7478816, 0.7515000, 1.4602000], [-0.2575321, 0.8755000, 0.0784000]]]

Expected (Unparsed): [[[0,0.5602,0.8374],[-1.013980675,-0.15910000000000002,1.1766999999999999],[-0.7478815799999999,0.7515000000000001,1.4602],[-0.2575321,0.8755,0.0784]]]

Actual:   [[[0, 0.5602, 0.8374], [-1.0139, -0.1591, 1.1767], [-0.7478, 0.7515, 1.4602], [-0.2575, 0.8755, 0.0784]]]

Expected: [[[0, 0.5602, 0.8374], [-1.0139, -0.1591, 1.1767], [-0.7478, 0.7516, 1.4602], [-0.2575, 0.8755, 0.0784]]]