import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot78462 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot78462 = tf.keras.layers.Input(shape=([2, 2]))

Dot78462 = keras.layers.Dot(axes=(2, 1), name = 'Dot78462', )([in0Dot78462,in1Dot78462])
Res46179 = keras.layers.Reshape((2, 2, 1), name = 'Res46179', )(Dot78462)
Res30423 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res30423', )(Res46179)
Glo7607 = keras.layers.GlobalMaxPool3D(name = 'Glo7607', )(Res30423)
model = tf.keras.models.Model(inputs=[in0Dot78462,in1Dot78462], outputs=Glo7607)
in0Dot78462 = tf.constant([[[0.0545, 0.1427], [0.0688, 0.3656]]])
in1Dot78462 = tf.constant([[[0.1047, 0.8753], [0.1918, 0.5056]]])
print (np.array2string(model.predict([in0Dot78462,in1Dot78462],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo7607.png')

LDot78462 = dot_layer([[[0.0545, 0.1427], [0.0688, 0.3656]]], [[[0.1047, 0.8753], [0.1918, 0.5056]]], 2, 1, Dot78462), 
LRes46179 = reshape_layer(Dot78462, [2, 2, 1], Res46179), 
LRes30423 = reshape_layer(Res46179, [2, 2, 1, 1], Res30423), 
LGlo7607 = global_max_pool3D_layer(Res30423, Glo7607), 
exec_layers([LDot78462,LRes46179,LRes30423,LGlo7607],["Dot78462","Res46179","Res30423","Glo7607"],Glo7607,"Glo7607")

Actual (Unparsed): [[0.2450680]]

Expected (Unparsed): [[0.245068]]

Actual:   [[0.2451]]

Expected: [[0.2451]]