import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe80659 = tf.keras.layers.Input(shape=([2, 1, 1]))

PRe80659 = keras.layers.PReLU(name = 'PRe80659', input_shape=(2, 1, 1))(in0PRe80659)
ELU61919 = keras.layers.ELU(alpha=4.026897248379678, name = 'ELU61919', )(PRe80659)
Res36705 = keras.layers.Reshape((2, 1), name = 'Res36705', )(ELU61919)
GRU409 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU409', )(Res36705)
model = tf.keras.models.Model(inputs=[in0PRe80659], outputs=GRU409)
w = model.get_layer('PRe80659').get_weights() 
w[0] = np.array([[[0.1419]], [[0.3983]]])
model.get_layer('PRe80659').set_weights(w) 
w = model.get_layer('GRU409').get_weights() 
w[0] = np.array([[7, 8, 4, 10, 7, 4, 1, 3, 2]])
w[1] = np.array([[9, 3, 5, 9, 3, 4, 1, 9, 7], [5, 4, 8, 5, 1, 6, 4, 5, 9], [8, 4, 10, 10, 2, 6, 10, 2, 9]])
w[2] = np.array([1, 9, 10, 2, 5, 6, 9, 5, 1])
model.get_layer('GRU409').set_weights(w) 
in0PRe80659 = tf.constant([[[[0.2919]], [[0.8025]]]])
print (np.array2string(model.predict([in0PRe80659],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU409.png')

LPRe80659 = prelu_layer([[[[0.2919]], [[0.8025]]]], [[[0.1419]], [[0.3983]]], PRe80659), 
LELU61919 = elu_layer(PRe80659, 4.026897248379678, ELU61919), 
LRes36705 = reshape_layer(ELU61919, [2, 1], Res36705), 
LGRU409 = gru_layer(Res36705,[[7, 8, 4, 10, 7, 4, 1, 3, 2]],[[9, 3, 5, 9, 3, 4, 1, 9, 7], [5, 4, 8, 5, 1, 6, 4, 5, 9], [8, 4, 10, 10, 2, 6, 10, 2, 9]],[1, 9, 10, 2, 5, 6, 9, 5, 1], false, GRU409), 
exec_layers([LPRe80659,LELU61919,LRes36705,LGRU409],["PRe80659","ELU61919","Res36705","GRU409"],GRU409,"GRU409")

Actual (Unparsed): [[0.0463539, 0.0000121, 0.0000144]]

Expected (Unparsed): [[0.046353864673351446,1.2119965709552083e-5,1.4433530735408013e-5]]

Actual:   [[0.0464, 0.0001, 0.0001]]

Expected: [[0.0464, 0.0001, 0.0001]]