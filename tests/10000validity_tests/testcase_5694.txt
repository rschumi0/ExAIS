import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave86472 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave86472 = tf.keras.layers.Input(shape=([2, 1]))
in0Con25656 = tf.keras.layers.Input(shape=([2]))
in0GRU24624 = tf.keras.layers.Input(shape=([2, 3]))

Ave86472 = keras.layers.Average(name = 'Ave86472', )([in0Ave86472,in1Ave86472])
Max56049 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max56049', )(Ave86472)
Glo27324 = keras.layers.GlobalMaxPool1D(name = 'Glo27324', )(Max56049)
Con25656 = keras.layers.Concatenate(axis=1, name = 'Con25656', )([Glo27324,in0Con25656])
GRU24624 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU24624', )(in0GRU24624)
Min35271 = keras.layers.Minimum(name = 'Min35271', )([Con25656,GRU24624])
model = tf.keras.models.Model(inputs=[in0Ave86472,in1Ave86472,in0Con25656,in0GRU24624], outputs=Min35271)
w = model.get_layer('GRU24624').get_weights() 
w[0] = np.array([[3, 6, 8, 2, 5, 6, 4, 7, 2], [10, 4, 5, 5, 2, 6, 10, 10, 4], [6, 4, 1, 6, 1, 6, 2, 1, 10]])
w[1] = np.array([[9, 2, 3, 7, 4, 9, 3, 5, 6], [5, 7, 10, 5, 7, 6, 1, 3, 6], [2, 5, 5, 6, 4, 9, 9, 3, 4]])
w[2] = np.array([3, 4, 7, 5, 9, 5, 3, 10, 8])
model.get_layer('GRU24624').set_weights(w) 
in0Ave86472 = tf.constant([[[0.0903], [0.0471]]])
in1Ave86472 = tf.constant([[[0.2867], [0.394]]])
in0Con25656 = tf.constant([[0.6984, 0.477]])
in0GRU24624 = tf.constant([[[9, 2, 1], [3, 2, 1]]])
print (np.array2string(model.predict([in0Ave86472,in1Ave86472,in0Con25656,in0GRU24624],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min35271.png')

LAve86472 = average_layer([[[[0.0903], [0.0471]]], [[[0.2867], [0.394]]]], Ave86472), 
LMax56049 = max_pool1D_layer(Ave86472, 1, Max56049), 
LGlo27324 = global_max_pool1D_layer(Max56049, Glo27324), 
LCon25656 = concatenate_layer([Glo27324,[[0.6984, 0.477]]], 1, Con25656), 
LGRU24624 = gru_layer([[[9, 2, 1], [3, 2, 1]]],[[3, 6, 8, 2, 5, 6, 4, 7, 2], [10, 4, 5, 5, 2, 6, 10, 10, 4], [6, 4, 1, 6, 1, 6, 2, 1, 10]],[[9, 2, 3, 7, 4, 9, 3, 5, 6], [5, 7, 10, 5, 7, 6, 1, 3, 6], [2, 5, 5, 6, 4, 9, 9, 3, 4]],[3, 4, 7, 5, 9, 5, 3, 10, 8], false, GRU24624), 
LMin35271 = minimum_layer([Con25656,GRU24624], Min35271), 
exec_layers([LAve86472,LMax56049,LGlo27324,LCon25656,LGRU24624,LMin35271],["Ave86472","Max56049","Glo27324","Con25656","GRU24624","Min35271"],Min35271,"Min35271")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,1.7763568394002505e-15,0.0]]

Actual:   [[0, 0, 0]]

Expected: [[0, 0, 0]]