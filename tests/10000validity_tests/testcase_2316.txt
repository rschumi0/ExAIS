import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat5435 = tf.keras.layers.Input(shape=([2]))

Bat5435 = keras.layers.BatchNormalization(axis=1, epsilon=0.5000977258000537,  name = 'Bat5435', )(in0Bat5435)
Res69302 = keras.layers.Reshape((2, 1), name = 'Res69302', )(Bat5435)
Sep48982 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep48982', )(Res69302)
Res44711 = keras.layers.Reshape((2, 4, 1), name = 'Res44711', )(Sep48982)
Glo65930 = keras.layers.GlobalAveragePooling2D(name = 'Glo65930', )(Res44711)
model = tf.keras.models.Model(inputs=[in0Bat5435], outputs=Glo65930)
w = model.get_layer('Bat5435').get_weights() 
w[0] = np.array([0.4033, 0.2747])
w[1] = np.array([0.2314, 0.3574])
w[2] = np.array([0.436, 0.7493])
w[3] = np.array([0.8532, 0.1256])
model.get_layer('Bat5435').set_weights(w) 
w = model.get_layer('Sep48982').get_weights() 
w[0] = np.array([[[0.536]]])
w[1] = np.array([[[0.3519, 0.3834, 0.8374, 0.3863]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep48982').set_weights(w) 
in0Bat5435 = tf.constant([[1.4215, 1.5925]])
print (np.array2string(model.predict([in0Bat5435],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo65930.png')

LBat5435 = batch_normalization_layer([[1.4215, 1.5925]], 1, 0.5000977258000537, [0.4033, 0.2747], [0.2314, 0.3574], [0.436, 0.7493], [0.8532, 0.1256], Bat5435), 
LRes69302 = reshape_layer(Bat5435, [2, 1], Res69302), 
LSep48982 = separable_conv1D_layer(Res69302, 1,[[[[0.536]]],[[[0.3519, 0.3834, 0.8374, 0.3863]]]],[0, 0, 0, 0], 1, false, Sep48982), 
LRes44711 = reshape_layer(Sep48982, [2, 4, 1], Res44711), 
LGlo65930 = global_average_pooling2D_layer(Res44711, Glo65930), 
exec_layers([LBat5435,LRes69302,LSep48982,LRes44711,LGlo65930],["Bat5435","Res69302","Sep48982","Res44711","Glo65930"],Glo65930,"Glo65930")

Actual (Unparsed): [[0.1605591]]

Expected (Unparsed): [[0.16055910581527247]]

Actual:   [[0.1606]]

Expected: [[0.1606]]