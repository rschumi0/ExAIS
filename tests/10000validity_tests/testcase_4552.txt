import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave16849 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave16849 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con27628 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave66379 = tf.keras.layers.Input(shape=([2, 2, 1]))

Ave16849 = keras.layers.Average(name = 'Ave16849', )([in0Ave16849,in1Ave16849])
Res86764 = keras.layers.Reshape((2, 2), name = 'Res86764', )(Ave16849)
Con27628 = keras.layers.Concatenate(axis=2, name = 'Con27628', )([Res86764,in0Con27628])
Ave66379 = keras.layers.AveragePooling2D(pool_size=(1, 2), strides=(1, 6), padding='same', name = 'Ave66379', )(in0Ave66379)
Res95104 = keras.layers.Reshape((2, 1), name = 'Res95104', )(Ave66379)
Sep37638 = keras.layers.SeparableConv1D(3, (1),strides=(2), padding='same', name = 'Sep37638', )(Res95104)
Zer75064 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer75064', )(Sep37638)
Sub4851 = keras.layers.Subtract(name = 'Sub4851', )([Con27628,Zer75064])
model = tf.keras.models.Model(inputs=[in0Ave16849,in1Ave16849,in0Con27628,in0Ave66379], outputs=Sub4851)
w = model.get_layer('Sep37638').get_weights() 
w[0] = np.array([[[0.4238]]])
w[1] = np.array([[[0.6182, 0.9585, 0.4344]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep37638').set_weights(w) 
in0Ave16849 = tf.constant([[[[0.6576, 0.5927]], [[0.2536, 0.0114]]]])
in1Ave16849 = tf.constant([[[[0.5282, 0.089]], [[0.3409, 0.9441]]]])
in0Con27628 = tf.constant([[[0.1609], [0.8907]]])
in0Ave66379 = tf.constant([[[[1.3734], [1.1129]], [[1.5111], [1.2052]]]])
print (np.array2string(model.predict([in0Ave16849,in1Ave16849,in0Con27628,in0Ave66379],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub4851.png')

LAve16849 = average_layer([[[[[0.6576, 0.5927]], [[0.2536, 0.0114]]]], [[[[0.5282, 0.089]], [[0.3409, 0.9441]]]]], Ave16849), 
LRes86764 = reshape_layer(Ave16849, [2, 2], Res86764), 
LCon27628 = concatenate_layer([Res86764,[[[0.1609], [0.8907]]]], 2, Con27628), 
LAve66379 = average_pooling2D_layer([[[[1.3734], [1.1129]], [[1.5111], [1.2052]]]], 1, 2, 1, 6, true, Ave66379), 
LRes95104 = reshape_layer(Ave66379, [2, 1], Res95104), 
LSep37638 = separable_conv1D_layer(Res95104, 1,[[[[0.4238]]],[[[0.6182, 0.9585, 0.4344]]]],[0, 0, 0], 2, true, Sep37638), 
LZer75064 = zero_padding1D_layer(Sep37638, 1, 0, Zer75064), 
LSub4851 = subtract_layer(Con27628,Zer75064, Sub4851), 
exec_layers([LAve16849,LRes86764,LCon27628,LAve66379,LRes95104,LSep37638,LZer75064,LSub4851],["Ave16849","Res86764","Con27628","Ave66379","Res95104","Sep37638","Zer75064","Sub4851"],Sub4851,"Sub4851")

Actual (Unparsed): [[[0.5929000, 0.3408500, 0.1609000], [-0.0284468, -0.0272328, 0.6618377]]]

Expected (Unparsed): [[[0.5929,0.34085,0.1609],[-0.028446796853999978,-0.027232820744999997,0.6618376762320001]]]

Actual:   [[[0.5929, 0.3409, 0.1609], [-0.0284, -0.0272, 0.6619]]]

Expected: [[[0.5929, 0.3409, 0.1609], [-0.0284, -0.0272, 0.6619]]]