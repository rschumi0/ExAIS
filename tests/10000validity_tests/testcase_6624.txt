import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul51896 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul51896 = tf.keras.layers.Input(shape=([2, 1]))
in0Con63398 = tf.keras.layers.Input(shape=([1, 2]))
in0Min9132 = tf.keras.layers.Input(shape=([2, 1]))
in1Min9132 = tf.keras.layers.Input(shape=([2, 1]))

Mul51896 = keras.layers.Multiply(name = 'Mul51896', )([in0Mul51896,in1Mul51896])
Glo3006 = keras.layers.GlobalMaxPool1D(name = 'Glo3006', )(Mul51896)
Res49172 = keras.layers.Reshape((1, 1), name = 'Res49172', )(Glo3006)
Con63398 = keras.layers.Concatenate(axis=2, name = 'Con63398', )([Res49172,in0Con63398])
Min9132 = keras.layers.Minimum(name = 'Min9132', )([in0Min9132,in1Min9132])
Res89537 = keras.layers.Reshape((2, 1, 1), name = 'Res89537', )(Min9132)
Glo93333 = keras.layers.GlobalAveragePooling2D(name = 'Glo93333', )(Res89537)
Res11893 = keras.layers.Reshape((1, 1), name = 'Res11893', )(Glo93333)
Con68900 = keras.layers.Conv1D(3, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con68900', )(Res11893)
Min83909 = keras.layers.Minimum(name = 'Min83909', )([Con63398,Con68900])
model = tf.keras.models.Model(inputs=[in0Mul51896,in1Mul51896,in0Con63398,in0Min9132,in1Min9132], outputs=Min83909)
w = model.get_layer('Con68900').get_weights() 
w[0] = np.array([[[0.7385, 0.9173, 0.6058]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con68900').set_weights(w) 
in0Mul51896 = tf.constant([[[0.176], [0.4923]]])
in1Mul51896 = tf.constant([[[0.3755], [0.4063]]])
in0Con63398 = tf.constant([[[0.9239, 0.94]]])
in0Min9132 = tf.constant([[[0.4964], [0.5482]]])
in1Min9132 = tf.constant([[[0.833], [0.3118]]])
print (np.array2string(model.predict([in0Mul51896,in1Mul51896,in0Con63398,in0Min9132,in1Min9132],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min83909.png')

LMul51896 = multiply_layer([[[[0.176], [0.4923]]], [[[0.3755], [0.4063]]]], Mul51896), 
LGlo3006 = global_max_pool1D_layer(Mul51896, Glo3006), 
LRes49172 = reshape_layer(Glo3006, [1, 1], Res49172), 
LCon63398 = concatenate_layer([Res49172,[[[0.9239, 0.94]]]], 2, Con63398), 
LMin9132 = minimum_layer([[[[0.4964], [0.5482]]], [[[0.833], [0.3118]]]], Min9132), 
LRes89537 = reshape_layer(Min9132, [2, 1, 1], Res89537), 
LGlo93333 = global_average_pooling2D_layer(Res89537, Glo93333), 
LRes11893 = reshape_layer(Glo93333, [1, 1], Res11893), 
LCon68900 = conv1D_layer(Res11893, 1,[[[0.7385, 0.9173, 0.6058]]],[0, 0, 0], 1, false, 1, Con68900), 
LMin83909 = minimum_layer([Con63398,Con68900], Min83909), 
exec_layers([LMul51896,LGlo3006,LRes49172,LCon63398,LMin9132,LRes89537,LGlo93333,LRes11893,LCon68900,LMin83909],["Mul51896","Glo3006","Res49172","Con63398","Min9132","Res89537","Glo93333","Res11893","Con68900","Min83909"],Min83909,"Min83909")

Actual (Unparsed): [[[0.2000215, 0.3706809, 0.2448038]]]

Expected (Unparsed): [[[0.20002149,0.37068093,0.24480378]]]

Actual:   [[[0.2001, 0.3707, 0.2449]]]

Expected: [[[0.2001, 0.3707, 0.2449]]]