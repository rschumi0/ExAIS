import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub88214 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub88214 = tf.keras.layers.Input(shape=([3, 3]))

Sub88214 = keras.layers.Subtract(name = 'Sub88214', )([in0Sub88214,in1Sub88214])
Glo36794 = keras.layers.GlobalMaxPool1D(name = 'Glo36794', )(Sub88214)
Res91117 = keras.layers.Reshape((3, 1), name = 'Res91117', )(Glo36794)
Res98153 = keras.layers.Reshape((3, 1, 1), name = 'Res98153', )(Res91117)
Sep7322 = keras.layers.SeparableConv2D(2, (3, 1),strides=(3, 3), padding='same', name = 'Sep7322', )(Res98153)
Res4187 = keras.layers.Reshape((1, 2), name = 'Res4187', )(Sep7322)
GRU91531 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU91531', )(Res4187)
model = tf.keras.models.Model(inputs=[in0Sub88214,in1Sub88214], outputs=GRU91531)
w = model.get_layer('Sep7322').get_weights() 
w[0] = np.array([[[[0.1435]]], [[[0.9032]]], [[[0.9494]]]])
w[1] = np.array([[[[0.8654, 0.9653]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep7322').set_weights(w) 
w = model.get_layer('GRU91531').get_weights() 
w[0] = np.array([[9, 6, 5], [7, 6, 4]])
w[1] = np.array([[5, 5, 5]])
w[2] = np.array([6, 5, 5])
model.get_layer('GRU91531').set_weights(w) 
in0Sub88214 = tf.constant([[[0.4202, 0.0334, 0.9162], [0.0543, 0.2898, 0.0342], [0.6236, 0.9315, 0.3534]]])
in1Sub88214 = tf.constant([[[0.0282, 0.9059, 0.259], [0.6405, 0.3233, 0.618], [0.459, 0.4687, 0.5177]]])
print (np.array2string(model.predict([in0Sub88214,in1Sub88214],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU91531.png')

LSub88214 = subtract_layer([[[0.4202, 0.0334, 0.9162], [0.0543, 0.2898, 0.0342], [0.6236, 0.9315, 0.3534]]], [[[0.0282, 0.9059, 0.259], [0.6405, 0.3233, 0.618], [0.459, 0.4687, 0.5177]]], Sub88214), 
LGlo36794 = global_max_pool1D_layer(Sub88214, Glo36794), 
LRes91117 = reshape_layer(Glo36794, [3, 1], Res91117), 
LRes98153 = reshape_layer(Res91117, [3, 1, 1], Res98153), 
LSep7322 = separable_conv2D_layer(Res98153, 3, 1,[[[[[0.1435]]], [[[0.9032]]], [[[0.9494]]]],[[[[0.8654, 0.9653]]]]],[0, 0], 3, 3, true, Sep7322), 
LRes4187 = reshape_layer(Sep7322, [1, 2], Res4187), 
LGRU91531 = gru_layer(Res4187,[[9, 6, 5], [7, 6, 4]],[[5, 5, 5]],[6, 5, 5], false, GRU91531), 
exec_layers([LSub88214,LGlo36794,LRes91117,LRes98153,LSep7322,LRes4187,LGRU91531],["Sub88214","Glo36794","Res91117","Res98153","Sep7322","Res4187","GRU91531"],GRU91531,"GRU91531")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[2.862750037020832e-10]]

Actual:   [[0]]

Expected: [[0]]