import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave46830 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Ave46830 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Add54932 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Add54932 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Ave60287 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave60287 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Ave93954 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave93954 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0PRe79546 = tf.keras.layers.Input(shape=([1, 1]))

Ave46830 = keras.layers.Average(name = 'Ave46830', )([in0Ave46830,in1Ave46830])
Res16757 = keras.layers.Reshape((2, 2, 2), name = 'Res16757', )(Ave46830)
Up_97768 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_97768', )(Res16757)
Res84848 = keras.layers.Reshape((4, 4, 2, 1), name = 'Res84848', )(Up_97768)
Add54932 = keras.layers.Add(name = 'Add54932', )([in0Add54932,in1Add54932])
Zer35788 = keras.layers.ZeroPadding3D(padding=((2, 0), (2, 0), (1, 0)), name = 'Zer35788', )(Add54932)
Add27714 = keras.layers.Add(name = 'Add27714', )([Res84848,Zer35788])
Zer50459 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer50459', )(Add27714)
Ave60287 = keras.layers.Average(name = 'Ave60287', )([in0Ave60287,in1Ave60287])
Res1962 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res1962', )(Ave60287)
Zer33219 = keras.layers.ZeroPadding3D(padding=((2, 0), (2, 0), (1, 0)), name = 'Zer33219', )(Res1962)
Ave93954 = keras.layers.Average(name = 'Ave93954', )([in0Ave93954,in1Ave93954])
Res66347 = keras.layers.Reshape((1, 2, 1), name = 'Res66347', )(Ave93954)
Res26851 = keras.layers.Reshape((1, 2), name = 'Res26851', )(Res66347)
PRe79546 = keras.layers.PReLU(name = 'PRe79546', input_shape=(1, 1))(in0PRe79546)
Dot43487 = keras.layers.Dot(axes=(1, 1), name = 'Dot43487', )([Res26851,PRe79546])
Res11475 = keras.layers.Reshape((2, 1, 1), name = 'Res11475', )(Dot43487)
Res23299 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res23299', )(Res11475)
Zer82314 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer82314', )(Res23299)
Min87496 = keras.layers.Minimum(name = 'Min87496', )([Zer33219,Zer82314])
Zer46420 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer46420', )(Min87496)
Mul8102 = keras.layers.Multiply(name = 'Mul8102', )([Zer50459,Zer46420])
model = tf.keras.models.Model(inputs=[in0Ave46830,in1Ave46830,in0Add54932,in1Add54932,in0Ave60287,in1Ave60287,in0Ave93954,in1Ave93954,in0PRe79546], outputs=Mul8102)
w = model.get_layer('PRe79546').get_weights() 
w[0] = np.array([[0.425]])
model.get_layer('PRe79546').set_weights(w) 
in0Ave46830 = tf.constant([[[[[0.1476], [0.2091]], [[0.3085], [0.404]]], [[[0.8097], [0.2798]], [[0.7655], [0.6313]]]]])
in1Ave46830 = tf.constant([[[[[0.4585], [0.269]], [[0.5833], [0.6137]]], [[[0.5429], [0.6868]], [[0.6548], [0.1669]]]]])
in0Add54932 = tf.constant([[[[[0.3377]], [[0.4585]]], [[[0.3353]], [[0.7759]]]]])
in1Add54932 = tf.constant([[[[[0.7254]], [[0.4837]]], [[[0.2918]], [[0.9]]]]])
in0Ave60287 = tf.constant([[[[0.0031, 0.3857]], [[0.0808, 0.3841]]]])
in1Ave60287 = tf.constant([[[[0.9184, 0.6064]], [[0.9419, 0.3761]]]])
in0Ave93954 = tf.constant([[[[[0.1523]], [[0.2473]]]]])
in1Ave93954 = tf.constant([[[[[0.3285]], [[0.0323]]]]])
in0PRe79546 = tf.constant([[[0.7647]]])
print (np.array2string(model.predict([in0Ave46830,in1Ave46830,in0Add54932,in1Add54932,in0Ave60287,in1Ave60287,in0Ave93954,in1Ave93954,in0PRe79546],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul8102.png')

LAve46830 = average_layer([[[[[[0.1476], [0.2091]], [[0.3085], [0.404]]], [[[0.8097], [0.2798]], [[0.7655], [0.6313]]]]], [[[[[0.4585], [0.269]], [[0.5833], [0.6137]]], [[[0.5429], [0.6868]], [[0.6548], [0.1669]]]]]], Ave46830), 
LRes16757 = reshape_layer(Ave46830, [2, 2, 2], Res16757), 
LUp_97768 = up_sampling2D_layer(Res16757, 2, 2, Up_97768), 
LRes84848 = reshape_layer(Up_97768, [4, 4, 2, 1], Res84848), 
LAdd54932 = add_layer([[[[[[0.3377]], [[0.4585]]], [[[0.3353]], [[0.7759]]]]], [[[[[0.7254]], [[0.4837]]], [[[0.2918]], [[0.9]]]]]], Add54932), 
LZer35788 = zero_padding3D_layer(Add54932, 2, 0, 2, 0, 1, 0, Zer35788), 
LAdd27714 = add_layer([Res84848,Zer35788], Add27714), 
LZer50459 = zero_padding3D_layer(Add27714, 0, 0, 0, 0, 2, 0, Zer50459), 
LAve60287 = average_layer([[[[[0.0031, 0.3857]], [[0.0808, 0.3841]]]], [[[[0.9184, 0.6064]], [[0.9419, 0.3761]]]]], Ave60287), 
LRes1962 = reshape_layer(Ave60287, [2, 1, 2, 1], Res1962), 
LZer33219 = zero_padding3D_layer(Res1962, 2, 0, 2, 0, 1, 0, Zer33219), 
LAve93954 = average_layer([[[[[[0.1523]], [[0.2473]]]]], [[[[[0.3285]], [[0.0323]]]]]], Ave93954), 
LRes66347 = reshape_layer(Ave93954, [1, 2, 1], Res66347), 
LRes26851 = reshape_layer(Res66347, [1, 2], Res26851), 
LPRe79546 = prelu_layer([[[0.7647]]], [[0.425]], PRe79546), 
LDot43487 = dot_layer(Res26851,PRe79546, 1, 1, Dot43487), 
LRes11475 = reshape_layer(Dot43487, [2, 1, 1], Res11475), 
LRes23299 = reshape_layer(Res11475, [2, 1, 1, 1], Res23299), 
LZer82314 = zero_padding3D_layer(Res23299, 1, 1, 1, 1, 1, 1, Zer82314), 
LMin87496 = minimum_layer([Zer33219,Zer82314], Min87496), 
LZer46420 = zero_padding3D_layer(Min87496, 0, 0, 1, 0, 1, 0, Zer46420), 
LMul8102 = multiply_layer([Zer50459,Zer46420], Mul8102), 
exec_layers([LAve46830,LRes16757,LUp_97768,LRes84848,LAdd54932,LZer35788,LAdd27714,LZer50459,LAve60287,LRes1962,LZer33219,LAve93954,LRes66347,LRes26851,LPRe79546,LDot43487,LRes11475,LRes23299,LZer82314,LMin87496,LZer46420,LMul8102],["Ave46830","Res16757","Up_97768","Res84848","Add54932","Zer35788","Add27714","Zer50459","Ave60287","Res1962","Zer33219","Ave93954","Res66347","Res26851","PRe79546","Dot43487","Res11475","Res23299","Zer82314","Min87496","Zer46420","Mul8102"],Mul8102,"Mul8102")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]]],[[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]]],[[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]]],[[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]],[[0],[0],[0.0],[0.0]]]]]

Actual:   [[[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]]

Expected: [[[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]]