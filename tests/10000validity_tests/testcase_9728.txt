import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST29524 = tf.keras.layers.Input(shape=([1, 3]))

LST29524 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST29524', )(in0LST29524)
Res78546 = keras.layers.Reshape((3, 1), name = 'Res78546', )(LST29524)
PRe61311 = keras.layers.PReLU(name = 'PRe61311', )(Res78546)
ELU36663 = keras.layers.ELU(alpha=9.323401082981686, name = 'ELU36663', )(PRe61311)
ELU18877 = keras.layers.ELU(alpha=5.95850084423121, name = 'ELU18877', )(ELU36663)
model = tf.keras.models.Model(inputs=[in0LST29524], outputs=ELU18877)
w = model.get_layer('LST29524').get_weights() 
w[0] = np.array([[8, 10, 8, 9, 7, 6, 8, 2, 2, 5, 8, 7], [1, 7, 5, 3, 5, 4, 4, 6, 6, 5, 1, 1], [1, 4, 10, 5, 5, 3, 2, 1, 5, 1, 5, 4]])
w[1] = np.array([[8, 1, 6, 9, 6, 3, 3, 1, 3, 10, 1, 9], [6, 3, 10, 3, 10, 6, 4, 7, 6, 10, 1, 5], [8, 8, 7, 3, 1, 9, 3, 10, 6, 2, 1, 7]])
w[2] = np.array([5, 3, 2, 7, 1, 1, 1, 9, 6, 10, 2, 3])
model.get_layer('LST29524').set_weights(w) 
w = model.get_layer('PRe61311').get_weights() 
w[0] = np.array([[0.7698], [0.2014], [0.6491]])
model.get_layer('PRe61311').set_weights(w) 
in0LST29524 = tf.constant([[[4, 3, 1]]])
print (np.array2string(model.predict([in0LST29524],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU18877.png')

LLST29524 = lstm_layer([[[4, 3, 1]]],[[8, 10, 8, 9, 7, 6, 8, 2, 2, 5, 8, 7], [1, 7, 5, 3, 5, 4, 4, 6, 6, 5, 1, 1], [1, 4, 10, 5, 5, 3, 2, 1, 5, 1, 5, 4]],[[8, 1, 6, 9, 6, 3, 3, 1, 3, 10, 1, 9], [6, 3, 10, 3, 10, 6, 4, 7, 6, 10, 1, 5], [8, 8, 7, 3, 1, 9, 3, 10, 6, 2, 1, 7]],[5, 3, 2, 7, 1, 1, 1, 9, 6, 10, 2, 3], LST29524), 
LRes78546 = reshape_layer(LST29524, [3, 1], Res78546), 
LPRe61311 = prelu_layer(Res78546, [[0.7698], [0.2014], [0.6491]], PRe61311), 
LELU36663 = elu_layer(PRe61311, 9.323401082981686, ELU36663), 
LELU18877 = elu_layer(ELU36663, 5.95850084423121, ELU18877), 
exec_layers([LLST29524,LRes78546,LPRe61311,LELU36663,LELU18877],["LST29524","Res78546","PRe61311","ELU36663","ELU18877"],ELU18877,"ELU18877")

Actual (Unparsed): [[[0.7615942], [0.7615942], [0.7615942]]]

Expected (Unparsed): [[[0.7615941559557649],[0.7615941559557649],[0.7615941559557649]]]

Actual:   [[[0.7616], [0.7616], [0.7616]]]

Expected: [[[0.7616], [0.7616], [0.7616]]]