import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max29512 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max29512 = tf.keras.layers.Input(shape=([2, 2, 2]))

Max29512 = keras.layers.Maximum(name = 'Max29512', )([in0Max29512,in1Max29512])
Thr53171 = keras.layers.ThresholdedReLU(theta=2.0099611640384003, name = 'Thr53171', )(Max29512)
Bat1234 = keras.layers.BatchNormalization(axis=3, epsilon=0.4425717377471241,  name = 'Bat1234', )(Thr53171)
Sep31170 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='same', name = 'Sep31170', )(Bat1234)
model = tf.keras.models.Model(inputs=[in0Max29512,in1Max29512], outputs=Sep31170)
w = model.get_layer('Bat1234').get_weights() 
w[0] = np.array([0.985, 0.2393])
w[1] = np.array([0.8934, 0.8626])
w[2] = np.array([0.1952, 0.4899])
w[3] = np.array([0.2473, 0.2979])
model.get_layer('Bat1234').set_weights(w) 
w = model.get_layer('Sep31170').get_weights() 
w[0] = np.array([[[[0.193], [0.6131]]]])
w[1] = np.array([[[[0.0542, 0.9871], [0.0348, 0.997]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep31170').set_weights(w) 
in0Max29512 = tf.constant([[[[0.8429, 0.819], [0.7373, 0.9639]], [[0.812, 0.7225], [0.4572, 0.1466]]]])
in1Max29512 = tf.constant([[[[0.8253, 0.1817], [0.7657, 0.7479]], [[0.2251, 0.595], [0.1823, 0.4697]]]])
print (np.array2string(model.predict([in0Max29512,in1Max29512],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep31170.png')

LMax29512 = maximum_layer([[[[[0.8429, 0.819], [0.7373, 0.9639]], [[0.812, 0.7225], [0.4572, 0.1466]]]], [[[[0.8253, 0.1817], [0.7657, 0.7479]], [[0.2251, 0.595], [0.1823, 0.4697]]]]], Max29512), 
LThr53171 = thresholded_relu_layer(Max29512, 2.0099611640384003, Thr53171), 
LBat1234 = batch_normalization_layer(Thr53171, 3, 0.4425717377471241, [0.985, 0.2393], [0.8934, 0.8626], [0.1952, 0.4899], [0.2473, 0.2979], Bat1234), 
LSep31170 = separable_conv2D_layer(Bat1234, 1, 1,[[[[[0.193], [0.6131]]]],[[[[0.0542, 0.9871], [0.0348, 0.997]]]]],[0, 0], 1, 1, true, Sep31170), 
exec_layers([LMax29512,LThr53171,LBat1234,LSep31170],["Max29512","Thr53171","Bat1234","Sep31170"],Sep31170,"Sep31170")

Actual (Unparsed): [[[[0.0224216, 0.5700977], [0.0224216, 0.5700977]], [[0.0224216, 0.5700977], [0.0224216, 0.5700977]]]]

Expected (Unparsed): [[[[0.022421566093924778,0.5700977080757572],[0.022421566093924778,0.5700977080757572]],[[0.022421566093924778,0.5700977080757572],[0.022421566093924778,0.5700977080757572]]]]

Actual:   [[[[0.0225, 0.5701], [0.0225, 0.5701]], [[0.0225, 0.5701], [0.0225, 0.5701]]]]

Expected: [[[[0.0225, 0.5701], [0.0225, 0.5701]], [[0.0225, 0.5701], [0.0225, 0.5701]]]]