import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_79877 = tf.keras.layers.Input(shape=([1, 2, 2, 4]))

Up_79877 = keras.layers.UpSampling3D(size=(2, 1, 1), name = 'Up_79877', )(in0Up_79877)
Res46558 = keras.layers.Reshape((2, 2, 8), name = 'Res46558', )(Up_79877)
Ave84293 = keras.layers.AveragePooling2D(pool_size=(2, 1), name = 'Ave84293', )(Res46558)
Res46999 = keras.layers.Reshape((1, 16), name = 'Res46999', )(Ave84293)
GRU92503 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU92503', )(Res46999)
Res66318 = keras.layers.Reshape((1, 1), name = 'Res66318', )(GRU92503)
Res44002 = keras.layers.Reshape((1, 1, 1), name = 'Res44002', )(Res66318)
Cro26695 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro26695', )(Res44002)
Sof93352 = keras.layers.Softmax(axis=1, name = 'Sof93352', )(Cro26695)
model = tf.keras.models.Model(inputs=[in0Up_79877], outputs=Sof93352)
w = model.get_layer('GRU92503').get_weights() 
w[0] = np.array([[8, 4, 1], [6, 6, 5], [10, 1, 8], [5, 4, 4], [4, 4, 10], [3, 9, 1], [9, 2, 4], [2, 6, 8], [7, 2, 9], [10, 3, 10], [2, 7, 8], [3, 5, 2], [4, 8, 4], [1, 4, 8], [5, 6, 5], [6, 6, 4]])
w[1] = np.array([[2, 2, 7]])
w[2] = np.array([[9, 5, 8], [9, 7, 8]])
model.get_layer('GRU92503').set_weights(w) 
in0Up_79877 = tf.constant([[[[[1.2926, 1.5294, 1.5362, 1.03], [1.1523, 1.7703, 1.268, 1.0644]], [[1.2661, 1.6719, 1.6641, 1.0104], [1.0975, 1.9961, 1.7958, 1.7888]]]]])
print (np.array2string(model.predict([in0Up_79877],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof93352.png')

LUp_79877 = up_sampling3D_layer([[[[[1.2926, 1.5294, 1.5362, 1.03], [1.1523, 1.7703, 1.268, 1.0644]], [[1.2661, 1.6719, 1.6641, 1.0104], [1.0975, 1.9961, 1.7958, 1.7888]]]]], 2, 1, 1, Up_79877), 
LRes46558 = reshape_layer(Up_79877, [2, 2, 8], Res46558), 
LAve84293 = average_pooling2D_layer(Res46558, 2, 1, Ave84293), 
LRes46999 = reshape_layer(Ave84293, [1, 16], Res46999), 
LGRU92503 = gru_layer(Res46999,[[8, 4, 1], [6, 6, 5], [10, 1, 8], [5, 4, 4], [4, 4, 10], [3, 9, 1], [9, 2, 4], [2, 6, 8], [7, 2, 9], [10, 3, 10], [2, 7, 8], [3, 5, 2], [4, 8, 4], [1, 4, 8], [5, 6, 5], [6, 6, 4]],[[2, 2, 7]],[[9, 5, 8], [9, 7, 8]], true, GRU92503), 
LRes66318 = reshape_layer(GRU92503, [1, 1], Res66318), 
LRes44002 = reshape_layer(Res66318, [1, 1, 1], Res44002), 
LCro26695 = cropping2D_layer(Res44002, 0, 0, 0, 0, Cro26695), 
LSof93352 = softmax_layer(Cro26695, 1, Sof93352), 
exec_layers([LUp_79877,LRes46558,LAve84293,LRes46999,LGRU92503,LRes66318,LRes44002,LCro26695,LSof93352],["Up_79877","Res46558","Ave84293","Res46999","GRU92503","Res66318","Res44002","Cro26695","Sof93352"],Sof93352,"Sof93352")

Actual (Unparsed): [[[[1.0000000]]]]

Expected (Unparsed): [[[[1.0]]]]

Actual:   [[[[1]]]]

Expected: [[[[1]]]]