import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot72138 = tf.keras.layers.Input(shape=([2]))
in1Dot72138 = tf.keras.layers.Input(shape=([2]))
in0Con54406 = tf.keras.layers.Input(shape=([5, 1]))
in0Max53121 = tf.keras.layers.Input(shape=([2, 1, 2]))

Dot72138 = keras.layers.Dot(axes=(1, 1), name = 'Dot72138', )([in0Dot72138,in1Dot72138])
Res91896 = keras.layers.Reshape((1, 1), name = 'Res91896', )(Dot72138)
Zer66704 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer66704', )(Res91896)
Con54406 = keras.layers.Concatenate(axis=2, name = 'Con54406', )([Zer66704,in0Con54406])
Max53121 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(5, 1), padding='same', name = 'Max53121', )(in0Max53121)
Res49110 = keras.layers.Reshape((1, 2), name = 'Res49110', )(Max53121)
Zer23907 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer23907', )(Res49110)
Sof99678 = keras.layers.Softmax(axis=1, name = 'Sof99678', )(Zer23907)
Zer57269 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer57269', )(Sof99678)
Add70545 = keras.layers.Add(name = 'Add70545', )([Con54406,Zer57269])
Cro87286 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro87286', )(Add70545)
model = tf.keras.models.Model(inputs=[in0Dot72138,in1Dot72138,in0Con54406,in0Max53121], outputs=Cro87286)
in0Dot72138 = tf.constant([[0.4973, 0.2631]])
in1Dot72138 = tf.constant([[0.3515, 0.4227]])
in0Con54406 = tf.constant([[[0.5656], [0.3847], [0.5191], [0.6872], [0.7137]]])
in0Max53121 = tf.constant([[[[1.2091, 1.0845]], [[1.3702, 1.9464]]]])
print (np.array2string(model.predict([in0Dot72138,in1Dot72138,in0Con54406,in0Max53121],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro87286.png')

LDot72138 = dot_layer([[0.4973, 0.2631]], [[0.3515, 0.4227]], 1, 1, Dot72138), 
LRes91896 = reshape_layer(Dot72138, [1, 1], Res91896), 
LZer66704 = zero_padding1D_layer(Res91896, 4, 0, Zer66704), 
LCon54406 = concatenate_layer([Zer66704,[[[0.5656], [0.3847], [0.5191], [0.6872], [0.7137]]]], 2, Con54406), 
LMax53121 = max_pool2D_layer([[[[1.2091, 1.0845]], [[1.3702, 1.9464]]]], 2, 1, 5, 1, true, Max53121), 
LRes49110 = reshape_layer(Max53121, [1, 2], Res49110), 
LZer23907 = zero_padding1D_layer(Res49110, 1, 1, Zer23907), 
LSof99678 = softmax_layer(Zer23907, 1, Sof99678), 
LZer57269 = zero_padding1D_layer(Sof99678, 1, 1, Zer57269), 
LAdd70545 = add_layer([Con54406,Zer57269], Add70545), 
LCro87286 = cropping1D_layer(Add70545, 0, 0, Cro87286), 
exec_layers([LDot72138,LRes91896,LZer66704,LCon54406,LMax53121,LRes49110,LZer23907,LSof99678,LZer57269,LAdd70545,LCro87286],["Dot72138","Res91896","Zer66704","Con54406","Max53121","Res49110","Zer23907","Sof99678","Zer57269","Add70545","Cro87286"],Cro87286,"Cro87286")

Actual (Unparsed): [[[0.0000000, 0.5656000], [0.1684597, 0.4957688], [0.6630806, 1.2969625], [0.1684597, 0.7982688], [0.2860133, 0.7137000]]]

Expected (Unparsed): [[[0,0.5656],[0.16845969993040896,0.49576878407369607],[0.663080600139182,1.2969624318526078],[0.16845969993040896,0.7982687840736962],[0.28601332,0.7137]]]

Actual:   [[[0, 0.5656], [0.1685, 0.4958], [0.6631, 1.297], [0.1685, 0.7983], [0.2861, 0.7137]]]

Expected: [[[0, 0.5656], [0.1685, 0.4958], [0.6631, 1.297], [0.1685, 0.7983], [0.2861, 0.7137]]]