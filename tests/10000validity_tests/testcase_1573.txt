import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add90627 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Add90627 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Max55167 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max55167 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Glo589 = tf.keras.layers.Input(shape=([2, 2]))
in0Dot12402 = tf.keras.layers.Input(shape=([2]))
in1Dot12402 = tf.keras.layers.Input(shape=([2]))
in0Con72968 = tf.keras.layers.Input(shape=([1]))
in0Con29520 = tf.keras.layers.Input(shape=([2]))

Add90627 = keras.layers.Add(name = 'Add90627', )([in0Add90627,in1Add90627])
Res86157 = keras.layers.Reshape((2, 1, 2), name = 'Res86157', )(Add90627)
Max55167 = keras.layers.Maximum(name = 'Max55167', )([in0Max55167,in1Max55167])
Res80565 = keras.layers.Reshape((1, 4), name = 'Res80565', )(Max55167)
Fla30057 = keras.layers.Flatten(name = 'Fla30057', )(Res80565)
Glo589 = keras.layers.GlobalAveragePooling1D(name = 'Glo589', )(in0Glo589)
Dot12402 = keras.layers.Dot(axes=(1, 1), name = 'Dot12402', )([in0Dot12402,in1Dot12402])
Con72968 = keras.layers.Concatenate(axis=1, name = 'Con72968', )([Dot12402,in0Con72968])
Max68085 = keras.layers.Maximum(name = 'Max68085', )([Glo589,Con72968])
Con29520 = keras.layers.Concatenate(axis=1, name = 'Con29520', )([Max68085,in0Con29520])
Sub70412 = keras.layers.Subtract(name = 'Sub70412', )([Fla30057,Con29520])
Res40243 = keras.layers.Reshape((2, 1, 2), name = 'Res40243', )(Sub70412)
Mul84787 = keras.layers.Multiply(name = 'Mul84787', )([Res86157,Res40243])
model = tf.keras.models.Model(inputs=[in0Add90627,in1Add90627,in0Max55167,in1Max55167,in0Glo589,in0Dot12402,in1Dot12402,in0Con72968,in0Con29520], outputs=Mul84787)
in0Add90627 = tf.constant([[[[[0.2519], [0.3965]]], [[[0.0814], [0.37]]]]])
in1Add90627 = tf.constant([[[[[0.5398], [0.8701]]], [[[0.5654], [0.859]]]]])
in0Max55167 = tf.constant([[[[0.8396, 0.1309], [0.5568, 0.642]]]])
in1Max55167 = tf.constant([[[[0.8845, 0.511], [0.4909, 0.2186]]]])
in0Glo589 = tf.constant([[[1.9873, 1.4806], [1.595, 1.8068]]])
in0Dot12402 = tf.constant([[0.8675, 0.4722]])
in1Dot12402 = tf.constant([[0.7803, 0.0318]])
in0Con72968 = tf.constant([[0.7071]])
in0Con29520 = tf.constant([[0.267, 0.3225]])
print (np.array2string(model.predict([in0Add90627,in1Add90627,in0Max55167,in1Max55167,in0Glo589,in0Dot12402,in1Dot12402,in0Con72968,in0Con29520],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul84787.png')

LAdd90627 = add_layer([[[[[[0.2519], [0.3965]]], [[[0.0814], [0.37]]]]], [[[[[0.5398], [0.8701]]], [[[0.5654], [0.859]]]]]], Add90627), 
LRes86157 = reshape_layer(Add90627, [2, 1, 2], Res86157), 
LMax55167 = maximum_layer([[[[[0.8396, 0.1309], [0.5568, 0.642]]]], [[[[0.8845, 0.511], [0.4909, 0.2186]]]]], Max55167), 
LRes80565 = reshape_layer(Max55167, [1, 4], Res80565), 
LFla30057 = flatten_layer(Res80565, Fla30057), 
LGlo589 = global_average_pooling1D_layer([[[1.9873, 1.4806], [1.595, 1.8068]]], Glo589), 
LDot12402 = dot_layer([[0.8675, 0.4722]], [[0.7803, 0.0318]], 1, 1, Dot12402), 
LCon72968 = concatenate_layer([Dot12402,[[0.7071]]], 1, Con72968), 
LMax68085 = maximum_layer([Glo589,Con72968], Max68085), 
LCon29520 = concatenate_layer([Max68085,[[0.267, 0.3225]]], 1, Con29520), 
LSub70412 = subtract_layer(Fla30057,Con29520, Sub70412), 
LRes40243 = reshape_layer(Sub70412, [2, 1, 2], Res40243), 
LMul84787 = multiply_layer([Res86157,Res40243], Mul84787), 
exec_layers([LAdd90627,LRes86157,LMax55167,LRes80565,LFla30057,LGlo589,LDot12402,LCon72968,LMax68085,LCon29520,LSub70412,LRes40243,LMul84787],["Add90627","Res86157","Max55167","Res80565","Fla30057","Glo589","Dot12402","Con72968","Max68085","Con29520","Sub70412","Res40243","Mul84787"],Mul84787,"Mul84787")

Actual (Unparsed): [[[[-0.7177948, -1.4346779]], [[0.1874427, 0.3926655]]]]

Expected (Unparsed): [[[[-0.717794805,-1.4346778199999997]],[[0.18744263999999997,0.39266550000000006]]]]

Actual:   [[[[-0.7177, -1.4346]], [[0.1875, 0.3927]]]]

Expected: [[[[-0.7177, -1.4346]], [[0.1875, 0.3927]]]]