import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep27942 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot26218 = tf.keras.layers.Input(shape=([3]))
in1Dot26218 = tf.keras.layers.Input(shape=([3]))
in0Con29024 = tf.keras.layers.Input(shape=([3]))

Sep27942 = keras.layers.SeparableConv1D(2, (2),strides=(1), padding='same', name = 'Sep27942', )(in0Sep27942)
Fla18438 = keras.layers.Flatten(name = 'Fla18438', )(Sep27942)
Dot26218 = keras.layers.Dot(axes=(1, 1), name = 'Dot26218', )([in0Dot26218,in1Dot26218])
Con29024 = keras.layers.Concatenate(axis=1, name = 'Con29024', )([Dot26218,in0Con29024])
Min78931 = keras.layers.Minimum(name = 'Min78931', )([Fla18438,Con29024])
Res18995 = keras.layers.Reshape((4, 1), name = 'Res18995', )(Min78931)
Res67102 = keras.layers.Reshape((4, 1, 1), name = 'Res67102', )(Res18995)
Glo39682 = keras.layers.GlobalMaxPool2D(name = 'Glo39682', )(Res67102)
model = tf.keras.models.Model(inputs=[in0Sep27942,in0Dot26218,in1Dot26218,in0Con29024], outputs=Glo39682)
w = model.get_layer('Sep27942').get_weights() 
w[0] = np.array([[[0.5087]], [[0.4714]]])
w[1] = np.array([[[0.5012, 0.444]]])
w[2] = np.array([0, 0])
model.get_layer('Sep27942').set_weights(w) 
in0Sep27942 = tf.constant([[[0.2383], [0.6743]]])
in0Dot26218 = tf.constant([[0.0359, 0.4736, 0.5568]])
in1Dot26218 = tf.constant([[0.4756, 0.5914, 0.4543]])
in0Con29024 = tf.constant([[0.8205, 0.5498, 0.3166]])
print (np.array2string(model.predict([in0Sep27942,in0Dot26218,in1Dot26218,in0Con29024],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo39682.png')

LSep27942 = separable_conv1D_layer([[[0.2383], [0.6743]]], 2,[[[[0.5087]], [[0.4714]]],[[[0.5012, 0.444]]]],[0, 0], 1, true, Sep27942), 
LFla18438 = flatten_layer(Sep27942, Fla18438), 
LDot26218 = dot_layer([[0.0359, 0.4736, 0.5568]], [[0.4756, 0.5914, 0.4543]], 1, 1, Dot26218), 
LCon29024 = concatenate_layer([Dot26218,[[0.8205, 0.5498, 0.3166]]], 1, Con29024), 
LMin78931 = minimum_layer([Fla18438,Con29024], Min78931), 
LRes18995 = reshape_layer(Min78931, [4, 1], Res18995), 
LRes67102 = reshape_layer(Res18995, [4, 1, 1], Res67102), 
LGlo39682 = global_max_pool2D_layer(Res67102, Glo39682), 
exec_layers([LSep27942,LFla18438,LDot26218,LCon29024,LMin78931,LRes18995,LRes67102,LGlo39682],["Sep27942","Fla18438","Dot26218","Con29024","Min78931","Res18995","Res67102","Glo39682"],Glo39682,"Glo39682")

Actual (Unparsed): [[0.2200710]]

Expected (Unparsed): [[0.22007102087599997]]

Actual:   [[0.2201]]

Expected: [[0.2201]]