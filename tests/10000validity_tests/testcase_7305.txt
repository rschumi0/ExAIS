import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max92562 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Max92562 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con66048 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Max92813 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max92813 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Max92562 = keras.layers.Maximum(name = 'Max92562', )([in0Max92562,in1Max92562])
Zer66869 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer66869', )(Max92562)
Con66048 = keras.layers.Concatenate(axis=4, name = 'Con66048', )([Zer66869,in0Con66048])
Max92813 = keras.layers.Maximum(name = 'Max92813', )([in0Max92813,in1Max92813])
Sof74475 = keras.layers.Softmax(axis=1, name = 'Sof74475', )(Max92813)
Max20248 = keras.layers.Maximum(name = 'Max20248', )([Con66048,Sof74475])
Res8101 = keras.layers.Reshape((2, 2, 2), name = 'Res8101', )(Max20248)
Res22136 = keras.layers.Reshape((2, 4), name = 'Res22136', )(Res8101)
Zer71872 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer71872', )(Res22136)
model = tf.keras.models.Model(inputs=[in0Max92562,in1Max92562,in0Con66048,in0Max92813,in1Max92813], outputs=Zer71872)
in0Max92562 = tf.constant([[[[[0.6236]]]]])
in1Max92562 = tf.constant([[[[[0.044]]]]])
in0Con66048 = tf.constant([[[[[0.2351]], [[0.8582]]], [[[0.6156]], [[0.3499]]]]])
in0Max92813 = tf.constant([[[[[0.3878, 0.5863]], [[0.6657, 0.2443]]], [[[0.535, 0.3956]], [[0.5476, 0.7806]]]]])
in1Max92813 = tf.constant([[[[[0.8934, 0.2879]], [[0.129, 0.9394]]], [[[0.8388, 0.5741]], [[0.4421, 0.5027]]]]])
print (np.array2string(model.predict([in0Max92562,in1Max92562,in0Con66048,in0Max92813,in1Max92813],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer71872.png')

LMax92562 = maximum_layer([[[[[[0.6236]]]]], [[[[[0.044]]]]]], Max92562), 
LZer66869 = zero_padding3D_layer(Max92562, 1, 0, 1, 0, 0, 0, Zer66869), 
LCon66048 = concatenate_layer([Zer66869,[[[[[0.2351]], [[0.8582]]], [[[0.6156]], [[0.3499]]]]]], 4, Con66048), 
LMax92813 = maximum_layer([[[[[[0.3878, 0.5863]], [[0.6657, 0.2443]]], [[[0.535, 0.3956]], [[0.5476, 0.7806]]]]], [[[[[0.8934, 0.2879]], [[0.129, 0.9394]]], [[[0.8388, 0.5741]], [[0.4421, 0.5027]]]]]], Max92813), 
LSof74475 = softmax_layer(Max92813, 1, Sof74475), 
LMax20248 = maximum_layer([Con66048,Sof74475], Max20248), 
LRes8101 = reshape_layer(Max20248, [2, 2, 2], Res8101), 
LRes22136 = reshape_layer(Res8101, [2, 4], Res22136), 
LZer71872 = zero_padding1D_layer(Res22136, 1, 1, Zer71872), 
exec_layers([LMax92562,LZer66869,LCon66048,LMax92813,LSof74475,LMax20248,LRes8101,LRes22136,LZer71872],["Max92562","Zer66869","Con66048","Max92813","Sof74475","Max20248","Res8101","Res22136","Zer71872"],Zer71872,"Zer71872")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.5136466, 0.5030500, 0.5294907, 0.8582000], [0.4863534, 0.6156000, 0.6236000, 0.4603832], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0],[0.5136466099411272,0.5030499621703964,0.5294907308643562,0.8582],[0.4863533900588728,0.6156,0.6236,0.46038321784951886],[0,0,0,0]]]

Actual:   [[[0, 0, 0, 0], [0.5137, 0.5031, 0.5295, 0.8582], [0.4864, 0.6156, 0.6236, 0.4604], [0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0], [0.5137, 0.5031, 0.5295, 0.8582], [0.4864, 0.6156, 0.6236, 0.4604], [0, 0, 0, 0]]]