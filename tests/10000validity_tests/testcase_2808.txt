import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof55673 = tf.keras.layers.Input(shape=([1, 1]))
in0Con1115 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Ave69082 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Ave69082 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Sof55673 = keras.layers.Softmax(axis=1, name = 'Sof55673', input_shape=(1, 1))(in0Sof55673)
Res39397 = keras.layers.Reshape((1, 1, 1), name = 'Res39397', )(Sof55673)
Res16932 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res16932', )(Res39397)
Con1115 = keras.layers.Concatenate(axis=4, name = 'Con1115', )([Res16932,in0Con1115])
Ave69082 = keras.layers.Average(name = 'Ave69082', )([in0Ave69082,in1Ave69082])
Mul95021 = keras.layers.Multiply(name = 'Mul95021', )([Con1115,Ave69082])
model = tf.keras.models.Model(inputs=[in0Sof55673,in0Con1115,in0Ave69082,in1Ave69082], outputs=Mul95021)
in0Sof55673 = tf.constant([[[0.8406]]])
in0Con1115 = tf.constant([[[[[0.4563]]]]])
in0Ave69082 = tf.constant([[[[[0.6917, 0.2616]]]]])
in1Ave69082 = tf.constant([[[[[0.6632, 0.3622]]]]])
print (np.array2string(model.predict([in0Sof55673,in0Con1115,in0Ave69082,in1Ave69082],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul95021.png')

LSof55673 = softmax_layer([[[0.8406]]], 1, Sof55673), 
LRes39397 = reshape_layer(Sof55673, [1, 1, 1], Res39397), 
LRes16932 = reshape_layer(Res39397, [1, 1, 1, 1], Res16932), 
LCon1115 = concatenate_layer([Res16932,[[[[[0.4563]]]]]], 4, Con1115), 
LAve69082 = average_layer([[[[[[0.6917, 0.2616]]]]], [[[[[0.6632, 0.3622]]]]]], Ave69082), 
LMul95021 = multiply_layer([Con1115,Ave69082], Mul95021), 
exec_layers([LSof55673,LRes39397,LRes16932,LCon1115,LAve69082,LMul95021],["Sof55673","Res39397","Res16932","Con1115","Ave69082","Mul95021"],Mul95021,"Mul95021")

Actual (Unparsed): [[[[[0.6774500, 0.1423200]]]]]

Expected (Unparsed): [[[[[0.67745,0.14231997]]]]]

Actual:   [[[[[0.6775, 0.1424]]]]]

Expected: [[[[[0.6775, 0.1424]]]]]