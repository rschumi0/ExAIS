import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul67485 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Mul67485 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Mul67485 = keras.layers.Multiply(name = 'Mul67485', )([in0Mul67485,in1Mul67485])
Res79032 = keras.layers.Reshape((1, 2, 4), name = 'Res79032', )(Mul67485)
Res56414 = keras.layers.Reshape((1, 8), name = 'Res56414', )(Res79032)
Glo25754 = keras.layers.GlobalAveragePooling1D(name = 'Glo25754', )(Res56414)
Res31279 = keras.layers.Reshape((8, 1), name = 'Res31279', )(Glo25754)
Res42121 = keras.layers.Reshape((8, 1, 1), name = 'Res42121', )(Res31279)
Con17829 = keras.layers.Conv2D(3, (3, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con17829', )(Res42121)
model = tf.keras.models.Model(inputs=[in0Mul67485,in1Mul67485], outputs=Con17829)
w = model.get_layer('Con17829').get_weights() 
w[0] = np.array([[[[0.0546, 0.9373, 0.1114]]], [[[0.1908, 0.7763, 0.7999]]], [[[0.6399, 0.9967, 0.2972]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con17829').set_weights(w) 
in0Mul67485 = tf.constant([[[[[0.671, 0.3353], [0.1015, 0.7111]], [[0.6354, 0.4184], [0.3218, 0.1253]]]]])
in1Mul67485 = tf.constant([[[[[0.4366, 0.9153], [0.4295, 0.4988]], [[0.8806, 0.86], [0.0353, 0.0928]]]]])
print (np.array2string(model.predict([in0Mul67485,in1Mul67485],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con17829.png')

LMul67485 = multiply_layer([[[[[[0.671, 0.3353], [0.1015, 0.7111]], [[0.6354, 0.4184], [0.3218, 0.1253]]]]], [[[[[0.4366, 0.9153], [0.4295, 0.4988]], [[0.8806, 0.86], [0.0353, 0.0928]]]]]], Mul67485), 
LRes79032 = reshape_layer(Mul67485, [1, 2, 4], Res79032), 
LRes56414 = reshape_layer(Res79032, [1, 8], Res56414), 
LGlo25754 = global_average_pooling1D_layer(Res56414, Glo25754), 
LRes31279 = reshape_layer(Glo25754, [8, 1], Res31279), 
LRes42121 = reshape_layer(Res31279, [8, 1, 1], Res42121), 
LCon17829 = conv2D_layer(Res42121, 3, 1,[[[[0.0546, 0.9373, 0.1114]]], [[[0.1908, 0.7763, 0.7999]]], [[[0.6399, 0.9967, 0.2972]]]],[0, 0, 0], 1, 1, true, 1, 1, Con17829), 
exec_layers([LMul67485,LRes79032,LRes56414,LGlo25754,LRes31279,LRes42121,LCon17829],["Mul67485","Res79032","Res56414","Glo25754","Res31279","Res42121","Con17829"],Con17829,"Con17829")

Actual (Unparsed): [[[[0.2522819, 0.5333111, 0.3255483]], [[0.1024480, 0.5562870, 0.2910812]], [[0.2520449, 0.6750259, 0.1744756]], [[0.4281017, 0.8738987, 0.4548715]], [[0.3563768, 1.1254594, 0.5940235]], [[0.1064739, 0.8151039, 0.3535313]], [[0.0292544, 0.3576709, 0.0526267]], [[0.0028388, 0.0196740, 0.0105666]]]]

Expected (Unparsed): [[[[0.252281868471,0.533311080883,0.325548290888]],[[0.10244803730700001,0.556287024622,0.29108118113100007]],[[0.25204493334600003,0.6750258515880001,0.174475563897]],[[0.42810169287000005,0.8738987035169999,0.45487155271]],[[0.35637675852,1.125459433176,0.5940235416280001]],[[0.10647390375,0.81510393057,0.353531275824]],[[0.029254445447999995,0.35767091422999997,0.052626683694]],[[0.0028388227559999995,0.019673989033999997,0.010566561972]]]]

Actual:   [[[[0.2523, 0.5334, 0.3256]], [[0.1025, 0.5563, 0.2911]], [[0.2521, 0.6751, 0.1745]], [[0.4282, 0.8739, 0.4549]], [[0.3564, 1.1255, 0.5941]], [[0.1065, 0.8152, 0.3536]], [[0.0293, 0.3577, 0.0527]], [[0.0029, 0.0197, 0.0106]]]]

Expected: [[[[0.2523, 0.5334, 0.3256]], [[0.1025, 0.5563, 0.2911]], [[0.2521, 0.6751, 0.1745]], [[0.4282, 0.8739, 0.4549]], [[0.3564, 1.1255, 0.5941]], [[0.1065, 0.8152, 0.3536]], [[0.0293, 0.3577, 0.0527]], [[0.0029, 0.0197, 0.0106]]]]