import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul58965 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul58965 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max82698 = tf.keras.layers.Input(shape=([1, 1]))
in1Max82698 = tf.keras.layers.Input(shape=([1, 1]))

Mul58965 = keras.layers.Multiply(name = 'Mul58965', )([in0Mul58965,in1Mul58965])
Dep6828 = keras.layers.DepthwiseConv2D((1, 2),strides=(1, 1), padding='valid', name = 'Dep6828', )(Mul58965)
Res87355 = keras.layers.Reshape((2, 1), name = 'Res87355', )(Dep6828)
Max82698 = keras.layers.Maximum(name = 'Max82698', )([in0Max82698,in1Max82698])
Sof80969 = keras.layers.Softmax(axis=1, name = 'Sof80969', )(Max82698)
Zer19927 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer19927', )(Sof80969)
Ave45748 = keras.layers.Average(name = 'Ave45748', )([Res87355,Zer19927])
model = tf.keras.models.Model(inputs=[in0Mul58965,in1Mul58965,in0Max82698,in1Max82698], outputs=Ave45748)
w = model.get_layer('Dep6828').get_weights() 
w[0] = np.array([[[[0.0235]], [[0.9936]]]])
w[1] = np.array([0])
model.get_layer('Dep6828').set_weights(w) 
in0Mul58965 = tf.constant([[[[0.6091], [0.7073]], [[0.5603], [0.0065]]]])
in1Mul58965 = tf.constant([[[[0.8272], [0.3867]], [[0.5523], [0.5672]]]])
in0Max82698 = tf.constant([[[0.7332]]])
in1Max82698 = tf.constant([[[0.3102]]])
print (np.array2string(model.predict([in0Mul58965,in1Mul58965,in0Max82698,in1Max82698],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave45748.png')

LMul58965 = multiply_layer([[[[[0.6091], [0.7073]], [[0.5603], [0.0065]]]], [[[[0.8272], [0.3867]], [[0.5523], [0.5672]]]]], Mul58965), 
LDep6828 = depthwise_conv2D_layer(Mul58965, 1, 2,[[[[0.0235]], [[0.9936]]]],[0], 1, 1, false, Dep6828), 
LRes87355 = reshape_layer(Dep6828, [2, 1], Res87355), 
LMax82698 = maximum_layer([[[[0.7332]]], [[[0.3102]]]], Max82698), 
LSof80969 = softmax_layer(Max82698, 1, Sof80969), 
LZer19927 = zero_padding1D_layer(Sof80969, 1, 0, Zer19927), 
LAve45748 = average_layer([Res87355,Zer19927], Ave45748), 
exec_layers([LMul58965,LDep6828,LRes87355,LMax82698,LSof80969,LZer19927,LAve45748],["Mul58965","Dep6828","Res87355","Max82698","Sof80969","Zer19927","Ave45748"],Ave45748,"Ave45748")

Actual (Unparsed): [[[0.1418014], [0.5054677]]]

Expected (Unparsed): [[[0.141801422048],[0.5054676830975]]]

Actual:   [[[0.1419], [0.5055]]]

Expected: [[[0.1419], [0.5055]]]