import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add45032 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Add45032 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Con53770 = tf.keras.layers.Input(shape=([2, 4]))
in0Max26537 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max26537 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con14343 = tf.keras.layers.Input(shape=([2, 23]))
in0Dot85212 = tf.keras.layers.Input(shape=([2]))
in1Dot85212 = tf.keras.layers.Input(shape=([2]))

Add45032 = keras.layers.Add(name = 'Add45032', )([in0Add45032,in1Add45032])
Res71994 = keras.layers.Reshape((1, 2, 4), name = 'Res71994', )(Add45032)
Sep72166 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep72166', )(Res71994)
Res95365 = keras.layers.Reshape((1, 4), name = 'Res95365', )(Sep72166)
Zer82701 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer82701', )(Res95365)
Con53770 = keras.layers.Concatenate(axis=2, name = 'Con53770', )([Zer82701,in0Con53770])
Max26537 = keras.layers.Maximum(name = 'Max26537', )([in0Max26537,in1Max26537])
Res92790 = keras.layers.Reshape((2, 2), name = 'Res92790', )(Max26537)
Con14343 = keras.layers.Concatenate(axis=2, name = 'Con14343', )([Res92790,in0Con14343])
Dot85212 = keras.layers.Dot(axes=(1, 1), name = 'Dot85212', )([in0Dot85212,in1Dot85212])
Res39857 = keras.layers.Reshape((1, 1), name = 'Res39857', )(Dot85212)
Res18839 = keras.layers.Reshape((1, 1, 1), name = 'Res18839', )(Res39857)
Res16137 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res16137', )(Res18839)
Zer79840 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer79840', )(Res16137)
Zer59397 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer59397', )(Zer79840)
Res9214 = keras.layers.Reshape((5, 5, 5), name = 'Res9214', )(Zer59397)
Res41388 = keras.layers.Reshape((5, 25), name = 'Res41388', )(Res9214)
Zer9258 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer9258', )(Res41388)
Dot74772 = keras.layers.Dot(axes=(2, 2), name = 'Dot74772', )([Con14343,Zer9258])
Max88495 = keras.layers.Maximum(name = 'Max88495', )([Con53770,Dot74772])
model = tf.keras.models.Model(inputs=[in0Add45032,in1Add45032,in0Con53770,in0Max26537,in1Max26537,in0Con14343,in0Dot85212,in1Dot85212], outputs=Max88495)
w = model.get_layer('Sep72166').get_weights() 
w[0] = np.array([[[[0.0883], [0.0623], [0.3205], [0.5542]]]])
w[1] = np.array([[[[0.2506, 0.6865], [0.8741, 0.2646], [0.4368, 0.4582], [0.8484, 0.288]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep72166').set_weights(w) 
in0Add45032 = tf.constant([[[[[0.3461, 0.0319], [0.924, 0.4459]], [[0.47, 0.643], [0.3131, 0.3222]]]]])
in1Add45032 = tf.constant([[[[[0.2334, 0.4139], [0.5894, 0.8086]], [[0.8688, 0.6778], [0.4526, 0.4738]]]]])
in0Con53770 = tf.constant([[[0.6438, 0.6131, 0.0572, 0.9657], [0.3863, 0.7392, 0.742, 0.3508]]])
in0Max26537 = tf.constant([[[[0.8036, 0.4343]], [[0.6753, 0.9833]]]])
in1Max26537 = tf.constant([[[[0.1119, 0.3305]], [[0.4632, 0.1476]]]])
in0Con14343 = tf.constant([[[0.2233, 0.3107, 0.6843, 0.6953, 0.5832, 0.3833, 0.1812, 0.4635, 0.0252, 0.4828, 0.0588, 0.5263, 0.8593, 0.9675, 0.8089, 0.1785, 0.7133, 0.0371, 0.5758, 0.6745, 0.3197, 0.2645, 0.9748], [0.8632, 0.5139, 0.2093, 0.2963, 0.7586, 0.1646, 0.0364, 0.2031, 0.0792, 0.1323, 0.4512, 0.2359, 0.133, 0.6418, 0.8058, 0.0571, 0.4225, 0.6441, 0.9318, 0.3823, 0.9937, 0.8426, 0.1122]]])
in0Dot85212 = tf.constant([[0.8637, 0.8631]])
in1Dot85212 = tf.constant([[0.262, 0.5983]])
print (np.array2string(model.predict([in0Add45032,in1Add45032,in0Con53770,in0Max26537,in1Max26537,in0Con14343,in0Dot85212,in1Dot85212],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max88495.png')

LAdd45032 = add_layer([[[[[[0.3461, 0.0319], [0.924, 0.4459]], [[0.47, 0.643], [0.3131, 0.3222]]]]], [[[[[0.2334, 0.4139], [0.5894, 0.8086]], [[0.8688, 0.6778], [0.4526, 0.4738]]]]]], Add45032), 
LRes71994 = reshape_layer(Add45032, [1, 2, 4], Res71994), 
LSep72166 = separable_conv2D_layer(Res71994, 1, 1,[[[[[0.0883], [0.0623], [0.3205], [0.5542]]]],[[[[0.2506, 0.6865], [0.8741, 0.2646], [0.4368, 0.4582], [0.8484, 0.288]]]]],[0, 0], 1, 1, false, Sep72166), 
LRes95365 = reshape_layer(Sep72166, [1, 4], Res95365), 
LZer82701 = zero_padding1D_layer(Res95365, 1, 0, Zer82701), 
LCon53770 = concatenate_layer([Zer82701,[[[0.6438, 0.6131, 0.0572, 0.9657], [0.3863, 0.7392, 0.742, 0.3508]]]], 2, Con53770), 
LMax26537 = maximum_layer([[[[[0.8036, 0.4343]], [[0.6753, 0.9833]]]], [[[[0.1119, 0.3305]], [[0.4632, 0.1476]]]]], Max26537), 
LRes92790 = reshape_layer(Max26537, [2, 2], Res92790), 
LCon14343 = concatenate_layer([Res92790,[[[0.2233, 0.3107, 0.6843, 0.6953, 0.5832, 0.3833, 0.1812, 0.4635, 0.0252, 0.4828, 0.0588, 0.5263, 0.8593, 0.9675, 0.8089, 0.1785, 0.7133, 0.0371, 0.5758, 0.6745, 0.3197, 0.2645, 0.9748], [0.8632, 0.5139, 0.2093, 0.2963, 0.7586, 0.1646, 0.0364, 0.2031, 0.0792, 0.1323, 0.4512, 0.2359, 0.133, 0.6418, 0.8058, 0.0571, 0.4225, 0.6441, 0.9318, 0.3823, 0.9937, 0.8426, 0.1122]]]], 2, Con14343), 
LDot85212 = dot_layer([[0.8637, 0.8631]], [[0.262, 0.5983]], 1, 1, Dot85212), 
LRes39857 = reshape_layer(Dot85212, [1, 1], Res39857), 
LRes18839 = reshape_layer(Res39857, [1, 1, 1], Res18839), 
LRes16137 = reshape_layer(Res18839, [1, 1, 1, 1], Res16137), 
LZer79840 = zero_padding3D_layer(Res16137, 1, 1, 1, 1, 1, 1, Zer79840), 
LZer59397 = zero_padding3D_layer(Zer79840, 1, 1, 1, 1, 1, 1, Zer59397), 
LRes9214 = reshape_layer(Zer59397, [5, 5, 5], Res9214), 
LRes41388 = reshape_layer(Res9214, [5, 25], Res41388), 
LZer9258 = zero_padding1D_layer(Res41388, 3, 0, Zer9258), 
LDot74772 = dot_layer(Con14343,Zer9258, 2, 2, Dot74772), 
LMax88495 = maximum_layer([Con53770,Dot74772], Max88495), 
exec_layers([LAdd45032,LRes71994,LSep72166,LRes95365,LZer82701,LCon53770,LMax26537,LRes92790,LCon14343,LDot85212,LRes39857,LRes18839,LRes16137,LZer79840,LZer59397,LRes9214,LRes41388,LZer9258,LDot74772,LMax88495],["Add45032","Res71994","Sep72166","Res95365","Zer82701","Con53770","Max26537","Res92790","Con14343","Dot85212","Res39857","Res18839","Res16137","Zer79840","Zer59397","Res9214","Res41388","Zer9258","Dot74772","Max88495"],Max88495,"Max88495")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.6438000, 0.6131000, 0.0572000, 0.9657000], [0.8388123, 0.4649547, 0.5830106, 0.3424228, 0.3863000, 0.7392000, 0.7420000, 0.3508000]]]

Expected (Unparsed): [[[0,0,0,0,0.6438,0.6131,0.0572,0.9657],[0.8388122906240001,0.464954652529,0.583010595328,0.342422804994,0.3863,0.7392,0.742,0.3508]]]

Actual:   [[[0, 0, 0, 0, 0.6438, 0.6131, 0.0572, 0.9657], [0.8389, 0.465, 0.5831, 0.3425, 0.3863, 0.7392, 0.742, 0.3508]]]

Expected: [[[0, 0, 0, 0, 0.6438, 0.6131, 0.0572, 0.9657], [0.8389, 0.465, 0.5831, 0.3425, 0.3863, 0.7392, 0.742, 0.3508]]]