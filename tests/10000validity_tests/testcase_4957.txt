import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave32645 = tf.keras.layers.Input(shape=([2, 2]))

Ave32645 = keras.layers.AveragePooling1D(pool_size=(2), name = 'Ave32645', )(in0Ave32645)
Res1781 = keras.layers.Reshape((1, 2, 1), name = 'Res1781', )(Ave32645)
Res20938 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res20938', )(Res1781)
Con39353 = keras.layers.Conv3D(4, (1, 2, 1),strides=(12, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con39353', )(Res20938)
Bat25196 = keras.layers.BatchNormalization(axis=1, epsilon=0.8399549013897991,  name = 'Bat25196', )(Con39353)
Res72130 = keras.layers.Reshape((1, 1, 4), name = 'Res72130', )(Bat25196)
Res74792 = keras.layers.Reshape((1, 4), name = 'Res74792', )(Res72130)
Cro10183 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro10183', )(Res74792)
Res5929 = keras.layers.Reshape((1, 4, 1), name = 'Res5929', )(Cro10183)
Glo20025 = keras.layers.GlobalMaxPool2D(name = 'Glo20025', )(Res5929)
model = tf.keras.models.Model(inputs=[in0Ave32645], outputs=Glo20025)
w = model.get_layer('Con39353').get_weights() 
w[0] = np.array([[[[[0.2803, 0.1963, 0.1477, 0.5657]]], [[[0.4388, 0.383, 0.7214, 0.5327]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con39353').set_weights(w) 
w = model.get_layer('Bat25196').get_weights() 
w[0] = np.array([0.7358])
w[1] = np.array([0.7709])
w[2] = np.array([0.2028])
w[3] = np.array([0.3324])
model.get_layer('Bat25196').set_weights(w) 
in0Ave32645 = tf.constant([[[1.5214, 1.3011], [1.3472, 1.4919]]])
print (np.array2string(model.predict([in0Ave32645],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo20025.png')

LAve32645 = average_pooling1D_layer([[[1.5214, 1.3011], [1.3472, 1.4919]]], 2, Ave32645), 
LRes1781 = reshape_layer(Ave32645, [1, 2, 1], Res1781), 
LRes20938 = reshape_layer(Res1781, [1, 2, 1, 1], Res20938), 
LCon39353 = conv3D_layer(Res20938, 1, 2, 1,[[[[[0.2803, 0.1963, 0.1477, 0.5657]]], [[[0.4388, 0.383, 0.7214, 0.5327]]]]],[0, 0, 0, 0], 12, 1, 1, false, 1, 1, 1, Con39353), 
LBat25196 = batch_normalization_layer(Con39353, 1, 0.8399549013897991, [0.7358], [0.7709], [0.2028], [0.3324], Bat25196), 
LRes72130 = reshape_layer(Bat25196, [1, 1, 4], Res72130), 
LRes74792 = reshape_layer(Res72130, [1, 4], Res74792), 
LCro10183 = cropping1D_layer(Res74792, 0, 0, Cro10183), 
LRes5929 = reshape_layer(Cro10183, [1, 4, 1], Res5929), 
LGlo20025 = global_max_pool2D_layer(Res5929, Glo20025), 
exec_layers([LAve32645,LRes1781,LRes20938,LCon39353,LBat25196,LRes72130,LRes74792,LCro10183,LRes5929,LGlo20025],["Ave32645","Res1781","Res20938","Con39353","Bat25196","Res72130","Res74792","Cro10183","Res5929","Glo20025"],Glo20025,"Glo20025")

Actual (Unparsed): [[1.6900094]]

Expected (Unparsed): [[1.6900093913523677]]

Actual:   [[1.6901]]

Expected: [[1.6901]]