import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add75397 = tf.keras.layers.Input(shape=([2, 1]))
in1Add75397 = tf.keras.layers.Input(shape=([2, 1]))

Add75397 = keras.layers.Add(name = 'Add75397', )([in0Add75397,in1Add75397])
GRU46374 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU46374', )(Add75397)
Res47348 = keras.layers.Reshape((2, 1), name = 'Res47348', )(GRU46374)
Res55963 = keras.layers.Reshape((2, 1, 1), name = 'Res55963', )(Res47348)
Sep88089 = keras.layers.SeparableConv2D(2, (2, 1),strides=(2, 2), padding='same', name = 'Sep88089', )(Res55963)
model = tf.keras.models.Model(inputs=[in0Add75397,in1Add75397], outputs=Sep88089)
w = model.get_layer('GRU46374').get_weights() 
w[0] = np.array([[2, 9, 2, 10, 1, 7]])
w[1] = np.array([[9, 2, 1, 1, 4, 5], [8, 7, 9, 6, 3, 8]])
w[2] = np.array([6, 7, 4, 9, 6, 6])
model.get_layer('GRU46374').set_weights(w) 
w = model.get_layer('Sep88089').get_weights() 
w[0] = np.array([[[[0.9388]]], [[[0.7194]]]])
w[1] = np.array([[[[0.522, 0.9616]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep88089').set_weights(w) 
in0Add75397 = tf.constant([[[0.5124], [0.1546]]])
in1Add75397 = tf.constant([[[0.5781], [0.2664]]])
print (np.array2string(model.predict([in0Add75397,in1Add75397],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep88089.png')

LAdd75397 = add_layer([[[[0.5124], [0.1546]]], [[[0.5781], [0.2664]]]], Add75397), 
LGRU46374 = gru_layer(Add75397,[[2, 9, 2, 10, 1, 7]],[[9, 2, 1, 1, 4, 5], [8, 7, 9, 6, 3, 8]],[6, 7, 4, 9, 6, 6], false, GRU46374), 
LRes47348 = reshape_layer(GRU46374, [2, 1], Res47348), 
LRes55963 = reshape_layer(Res47348, [2, 1, 1], Res55963), 
LSep88089 = separable_conv2D_layer(Res55963, 2, 1,[[[[[0.9388]]], [[[0.7194]]]],[[[[0.522, 0.9616]]]]],[0, 0], 2, 2, true, Sep88089), 
exec_layers([LAdd75397,LGRU46374,LRes47348,LRes55963,LSep88089],["Add75397","GRU46374","Res47348","Res55963","Sep88089"],Sep88089,"Sep88089")

Actual (Unparsed): [[[[0.0006662, 0.0012273]]]]

Expected (Unparsed): [[[[0.0006662370130530535,0.0012273055780686135]]]]

Actual:   [[[[0.0007, 0.0013]]]]

Expected: [[[[0.0007, 0.0013]]]]