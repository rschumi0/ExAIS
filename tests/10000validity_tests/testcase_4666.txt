import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min49977 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min49977 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con9134 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Max96989 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Max96989 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Max17479 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max17479 = tf.keras.layers.Input(shape=([2, 1, 2]))

Min49977 = keras.layers.Minimum(name = 'Min49977', )([in0Min49977,in1Min49977])
Res73091 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res73091', )(Min49977)
Con9134 = keras.layers.Concatenate(axis=4, name = 'Con9134', )([Res73091,in0Con9134])
Max96989 = keras.layers.Maximum(name = 'Max96989', )([in0Max96989,in1Max96989])
Zer4283 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer4283', )(Max96989)
Mul22103 = keras.layers.Multiply(name = 'Mul22103', )([Con9134,Zer4283])
Res35534 = keras.layers.Reshape((2, 2, 2), name = 'Res35534', )(Mul22103)
Max17479 = keras.layers.Maximum(name = 'Max17479', )([in0Max17479,in1Max17479])
Zer41010 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer41010', )(Max17479)
Ave62651 = keras.layers.Average(name = 'Ave62651', )([Res35534,Zer41010])
Fla45354 = keras.layers.Flatten(name = 'Fla45354', )(Ave62651)
model = tf.keras.models.Model(inputs=[in0Min49977,in1Min49977,in0Con9134,in0Max96989,in1Max96989,in0Max17479,in1Max17479], outputs=Fla45354)
in0Min49977 = tf.constant([[[[0.6733], [0.2933]], [[0.5121], [0.255]]]])
in1Min49977 = tf.constant([[[[0.6302], [0.7414]], [[0.228], [0.9058]]]])
in0Con9134 = tf.constant([[[[[0.445]], [[0.2177]]], [[[0.1058]], [[0.6119]]]]])
in0Max96989 = tf.constant([[[[[0.2334, 0.7635]], [[0.3584, 0.6643]]]]])
in1Max96989 = tf.constant([[[[[0.0788, 0.9249]], [[0.311, 0.6115]]]]])
in0Max17479 = tf.constant([[[[0.42, 0.2781]], [[0.6465, 0.6094]]]])
in1Max17479 = tf.constant([[[[0.8768, 0.0862]], [[0.2874, 0.3682]]]])
print (np.array2string(model.predict([in0Min49977,in1Min49977,in0Con9134,in0Max96989,in1Max96989,in0Max17479,in1Max17479],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla45354.png')

LMin49977 = minimum_layer([[[[[0.6733], [0.2933]], [[0.5121], [0.255]]]], [[[[0.6302], [0.7414]], [[0.228], [0.9058]]]]], Min49977), 
LRes73091 = reshape_layer(Min49977, [2, 2, 1, 1], Res73091), 
LCon9134 = concatenate_layer([Res73091,[[[[[0.445]], [[0.2177]]], [[[0.1058]], [[0.6119]]]]]], 4, Con9134), 
LMax96989 = maximum_layer([[[[[[0.2334, 0.7635]], [[0.3584, 0.6643]]]]], [[[[[0.0788, 0.9249]], [[0.311, 0.6115]]]]]], Max96989), 
LZer4283 = zero_padding3D_layer(Max96989, 1, 0, 0, 0, 0, 0, Zer4283), 
LMul22103 = multiply_layer([Con9134,Zer4283], Mul22103), 
LRes35534 = reshape_layer(Mul22103, [2, 2, 2], Res35534), 
LMax17479 = maximum_layer([[[[[0.42, 0.2781]], [[0.6465, 0.6094]]]], [[[[0.8768, 0.0862]], [[0.2874, 0.3682]]]]], Max17479), 
LZer41010 = zero_padding2D_layer(Max17479, 0, 0, 1, 0, Zer41010), 
LAve62651 = average_layer([Res35534,Zer41010], Ave62651), 
LFla45354 = flatten_layer(Ave62651, Fla45354), 
exec_layers([LMin49977,LRes73091,LCon9134,LMax96989,LZer4283,LMul22103,LRes35534,LMax17479,LZer41010,LAve62651,LFla45354],["Min49977","Res73091","Con9134","Max96989","Zer4283","Mul22103","Res35534","Max17479","Zer41010","Ave62651","Fla45354"],Fla45354,"Fla45354")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.4384000, 0.1390500, 0.0266076, 0.0489272, 0.3689460, 0.5079426]]

Expected (Unparsed): [[0.0,0.0,0.4384,0.13905,0.026607600000000002,0.048927210000000006,0.368946,0.507942585]]

Actual:   [[0, 0, 0.4384, 0.1391, 0.0267, 0.049, 0.369, 0.508]]

Expected: [[0, 0, 0.4384, 0.1391, 0.0267, 0.049, 0.369, 0.508]]