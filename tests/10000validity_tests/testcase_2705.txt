import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub61533 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub61533 = tf.keras.layers.Input(shape=([3, 2]))

Sub61533 = keras.layers.Subtract(name = 'Sub61533', )([in0Sub61533,in1Sub61533])
Sep40445 = keras.layers.SeparableConv1D(4, (2),strides=(3), padding='valid', name = 'Sep40445', )(Sub61533)
model = tf.keras.models.Model(inputs=[in0Sub61533,in1Sub61533], outputs=Sep40445)
w = model.get_layer('Sep40445').get_weights() 
w[0] = np.array([[[0.6311], [0.7756]], [[0.8563], [0.6093]]])
w[1] = np.array([[[0.4228, 0.7396, 0.7534, 0.0785], [0.3852, 0.4494, 0.2433, 0.3201]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep40445').set_weights(w) 
in0Sub61533 = tf.constant([[[0.1777, 0.6123], [0.815, 0.9667], [0.2827, 0.1988]]])
in1Sub61533 = tf.constant([[[0.8569, 0.8785], [0.9114, 0.0013], [0.3342, 0.7848]]])
print (np.array2string(model.predict([in0Sub61533,in1Sub61533],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep40445.png')

LSub61533 = subtract_layer([[[0.1777, 0.6123], [0.815, 0.9667], [0.2827, 0.1988]]], [[[0.8569, 0.8785], [0.9114, 0.0013], [0.3342, 0.7848]]], Sub61533), 
LSep40445 = separable_conv1D_layer(Sub61533, 2,[[[[0.6311], [0.7756]], [[0.8563], [0.6093]]],[[[0.4228, 0.7396, 0.7534, 0.0785], [0.3852, 0.4494, 0.2433, 0.3201]]]],[0, 0, 0, 0], 3, false, Sep40445), 
exec_layers([LSub61533,LSep40445],["Sub61533","Sep40445"],Sep40445,"Sep40445")

Actual (Unparsed): [[[-0.0690799, -0.2065164, -0.2922503, 0.0820708]]]

Expected (Unparsed): [[[-0.06907986983200001,-0.20651642652400004,-0.292250250946,0.08207084581]]]

Actual:   [[[-0.069, -0.2065, -0.2922, 0.0821]]]

Expected: [[[-0.069, -0.2065, -0.2922, 0.0821]]]