import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub85977 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub85977 = tf.keras.layers.Input(shape=([2, 3]))

Sub85977 = keras.layers.Subtract(name = 'Sub85977', )([in0Sub85977,in1Sub85977])
Sim25626 = keras.layers.SimpleRNN(2,name = 'Sim25626', )(Sub85977)
Res79389 = keras.layers.Reshape((2, 1), name = 'Res79389', )(Sim25626)
Res15294 = keras.layers.Reshape((2, 1, 1), name = 'Res15294', )(Res79389)
Zer90925 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer90925', )(Res15294)
Res39995 = keras.layers.Reshape((4, 3, 1, 1), name = 'Res39995', )(Zer90925)
Glo83959 = keras.layers.GlobalAveragePooling3D(name = 'Glo83959', )(Res39995)
model = tf.keras.models.Model(inputs=[in0Sub85977,in1Sub85977], outputs=Glo83959)
w = model.get_layer('Sim25626').get_weights() 
w[0] = np.array([[4, 5], [1, 2], [5, 10]])
w[1] = np.array([[2, 7], [3, 10]])
w[2] = np.array([9, 8])
model.get_layer('Sim25626').set_weights(w) 
in0Sub85977 = tf.constant([[[0.2597, 0.7333, 0.1763], [0.0757, 0.7558, 0.1074]]])
in1Sub85977 = tf.constant([[[0.8088, 0.3999, 0.5659], [0.3071, 0.6288, 0.0306]]])
print (np.array2string(model.predict([in0Sub85977,in1Sub85977],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo83959.png')

LSub85977 = subtract_layer([[[0.2597, 0.7333, 0.1763], [0.0757, 0.7558, 0.1074]]], [[[0.8088, 0.3999, 0.5659], [0.3071, 0.6288, 0.0306]]], Sub85977), 
LSim25626 = simple_rnn_layer(Sub85977,[[4, 5], [1, 2], [5, 10]],[[2, 7], [3, 10]],[9, 8], Sim25626), 
LRes79389 = reshape_layer(Sim25626, [2, 1], Res79389), 
LRes15294 = reshape_layer(Res79389, [2, 1, 1], Res15294), 
LZer90925 = zero_padding2D_layer(Res15294, 1, 1, 1, 1, Zer90925), 
LRes39995 = reshape_layer(Zer90925, [4, 3, 1, 1], Res39995), 
LGlo83959 = global_average_pooling3D_layer(Res39995, Glo83959), 
exec_layers([LSub85977,LSim25626,LRes79389,LRes15294,LZer90925,LRes39995,LGlo83959],["Sub85977","Sim25626","Res79389","Res15294","Zer90925","Res39995","Glo83959"],Glo83959,"Glo83959")

Actual (Unparsed): [[0.1666667]]

Expected (Unparsed): [[0.1666666666663423]]

Actual:   [[0.1667]]

Expected: [[0.1667]]