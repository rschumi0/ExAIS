import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave26762 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave26762 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Sub22440 = tf.keras.layers.Input(shape=([2, 3, 2]))
in1Sub22440 = tf.keras.layers.Input(shape=([2, 3, 2]))
in0Add65140 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Add65140 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Ave26762 = keras.layers.Average(name = 'Ave26762', )([in0Ave26762,in1Ave26762])
Loc10804 = keras.layers.LocallyConnected2D(2, (2, 1),strides=(1, 1), name = 'Loc10804', )(Ave26762)
Res40168 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res40168', )(Loc10804)
Zer66219 = keras.layers.ZeroPadding3D(padding=((1, 0), (2, 0), (0, 0)), name = 'Zer66219', )(Res40168)
Sub22440 = keras.layers.Subtract(name = 'Sub22440', )([in0Sub22440,in1Sub22440])
Res86831 = keras.layers.Reshape((2, 3, 2, 1), name = 'Res86831', )(Sub22440)
Add65140 = keras.layers.Add(name = 'Add65140', )([in0Add65140,in1Add65140])
Zer95503 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer95503', )(Add65140)
Ave84634 = keras.layers.Average(name = 'Ave84634', )([Res86831,Zer95503])
Min48705 = keras.layers.Minimum(name = 'Min48705', )([Zer66219,Ave84634])
Res46523 = keras.layers.Reshape((2, 3, 2), name = 'Res46523', )(Min48705)
Res22028 = keras.layers.Reshape((2, 6), name = 'Res22028', )(Res46523)
Cro71836 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro71836', )(Res22028)
model = tf.keras.models.Model(inputs=[in0Ave26762,in1Ave26762,in0Sub22440,in1Sub22440,in0Add65140,in1Add65140], outputs=Cro71836)
w = model.get_layer('Loc10804').get_weights() 
w[0] = np.array([[[0.7162, 0.7606], [0.8555, 0.9411], [0.7169, 0.8746], [0.3525, 0.3757]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc10804').set_weights(w) 
in0Ave26762 = tf.constant([[[[0.2926, 0.9933]], [[0.743, 0.9272]]]])
in1Ave26762 = tf.constant([[[[0.9517, 0.5769]], [[0.8415, 0.7629]]]])
in0Sub22440 = tf.constant([[[[0.4098, 0.1977], [0.3645, 0.2835], [0.1427, 0.2218]], [[0.1802, 0.7563], [0.153, 0.1712], [0.688, 0.9439]]]])
in1Sub22440 = tf.constant([[[[0.2277, 0.3529], [0.1924, 0.0174], [0.83, 0.7199]], [[0.5694, 0.3836], [0.846, 0.9296], [0.1693, 0.1625]]]])
in0Add65140 = tf.constant([[[[[0.2369], [0.3035]], [[0.6125], [0.3032]]]]])
in1Add65140 = tf.constant([[[[[0.4925], [0.4051]], [[0.3779], [0.3577]]]]])
print (np.array2string(model.predict([in0Ave26762,in1Ave26762,in0Sub22440,in1Sub22440,in0Add65140,in1Add65140],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro71836.png')

LAve26762 = average_layer([[[[[0.2926, 0.9933]], [[0.743, 0.9272]]]], [[[[0.9517, 0.5769]], [[0.8415, 0.7629]]]]], Ave26762), 
LLoc10804 = locally_connected2D_layer(Ave26762, 2, 1,[[[0.7162, 0.7606], [0.8555, 0.9411], [0.7169, 0.8746], [0.3525, 0.3757]]],[[[0, 0]]], 1, 1, Loc10804), 
LRes40168 = reshape_layer(Loc10804, [1, 1, 2, 1], Res40168), 
LZer66219 = zero_padding3D_layer(Res40168, 1, 0, 2, 0, 0, 0, Zer66219), 
LSub22440 = subtract_layer([[[[0.4098, 0.1977], [0.3645, 0.2835], [0.1427, 0.2218]], [[0.1802, 0.7563], [0.153, 0.1712], [0.688, 0.9439]]]], [[[[0.2277, 0.3529], [0.1924, 0.0174], [0.83, 0.7199]], [[0.5694, 0.3836], [0.846, 0.9296], [0.1693, 0.1625]]]], Sub22440), 
LRes86831 = reshape_layer(Sub22440, [2, 3, 2, 1], Res86831), 
LAdd65140 = add_layer([[[[[[0.2369], [0.3035]], [[0.6125], [0.3032]]]]], [[[[[0.4925], [0.4051]], [[0.3779], [0.3577]]]]]], Add65140), 
LZer95503 = zero_padding3D_layer(Add65140, 1, 0, 1, 0, 0, 0, Zer95503), 
LAve84634 = average_layer([Res86831,Zer95503], Ave84634), 
LMin48705 = minimum_layer([Zer66219,Ave84634], Min48705), 
LRes46523 = reshape_layer(Min48705, [2, 3, 2], Res46523), 
LRes22028 = reshape_layer(Res46523, [2, 6], Res22028), 
LCro71836 = cropping1D_layer(Res22028, 1, 0, Cro71836), 
exec_layers([LAve26762,LLoc10804,LRes40168,LZer66219,LSub22440,LRes86831,LAdd65140,LZer95503,LAve84634,LMin48705,LRes46523,LRes22028,LCro71836],["Ave26762","Loc10804","Res40168","Zer66219","Sub22440","Res86831","Add65140","Zer95503","Ave84634","Min48705","Res46523","Res22028","Cro71836"],Cro71836,"Cro71836")

Actual (Unparsed): [[[-0.1946000, 0.0000000, 0.0000000, -0.0249000, 0.7545500, 0.7211500]]]

Expected (Unparsed): [[[-0.1946,0,0,-0.024899999999999978,0.75455,0.72115]]]

Actual:   [[[-0.1946, 0, 0, -0.0249, 0.7546, 0.7212]]]

Expected: [[[-0.1946, 0, 0, -0.0248, 0.7546, 0.7212]]]