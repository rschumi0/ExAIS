import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr65387 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Thr65387 = keras.layers.ThresholdedReLU(theta=9.584696589413326, name = 'Thr65387', input_shape=(2, 1, 1, 2))(in0Thr65387)
Res61208 = keras.layers.Reshape((2, 1, 2), name = 'Res61208', )(Thr65387)
Sep64632 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep64632', )(Res61208)
Res64462 = keras.layers.Reshape((2, 4), name = 'Res64462', )(Sep64632)
Cro95338 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro95338', )(Res64462)
Res44771 = keras.layers.Reshape((2, 4, 1), name = 'Res44771', )(Cro95338)
Sep16402 = keras.layers.SeparableConv2D(2, (1, 2),strides=(1, 1), padding='same', name = 'Sep16402', )(Res44771)
model = tf.keras.models.Model(inputs=[in0Thr65387], outputs=Sep16402)
w = model.get_layer('Sep64632').get_weights() 
w[0] = np.array([[[[0.3045], [0.8005]]]])
w[1] = np.array([[[[0.0609, 0.7262, 0.2835, 0.3875], [0.9947, 0.9815, 0.4079, 0.9485]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep64632').set_weights(w) 
w = model.get_layer('Sep16402').get_weights() 
w[0] = np.array([[[[0.5417]], [[0.4969]]]])
w[1] = np.array([[[[0.6366, 0.6301]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep16402').set_weights(w) 
in0Thr65387 = tf.constant([[[[[0.1859, 0.9883]]], [[[0.4131, 0.348]]]]])
print (np.array2string(model.predict([in0Thr65387],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep16402.png')

LThr65387 = thresholded_relu_layer([[[[[0.1859, 0.9883]]], [[[0.4131, 0.348]]]]], 9.584696589413326, Thr65387), 
LRes61208 = reshape_layer(Thr65387, [2, 1, 2], Res61208), 
LSep64632 = separable_conv2D_layer(Res61208, 1, 1,[[[[[0.3045], [0.8005]]]],[[[[0.0609, 0.7262, 0.2835, 0.3875], [0.9947, 0.9815, 0.4079, 0.9485]]]]],[0, 0, 0, 0], 1, 1, false, Sep64632), 
LRes64462 = reshape_layer(Sep64632, [2, 4], Res64462), 
LCro95338 = cropping1D_layer(Res64462, 0, 0, Cro95338), 
LRes44771 = reshape_layer(Cro95338, [2, 4, 1], Res44771), 
LSep16402 = separable_conv2D_layer(Res44771, 1, 2,[[[[[0.5417]], [[0.4969]]]],[[[[0.6366, 0.6301]]]]],[0, 0], 1, 1, true, Sep16402), 
exec_layers([LThr65387,LRes61208,LSep64632,LRes64462,LCro95338,LRes44771,LSep16402],["Thr65387","Res61208","Sep64632","Res64462","Cro95338","Res44771","Sep16402"],Sep16402,"Sep16402")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0]],[[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0]]]]

Expected: [[[[0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0]]]]