import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul69326 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul69326 = tf.keras.layers.Input(shape=([1, 1]))
in0Con80024 = tf.keras.layers.Input(shape=([3]))
in0Mul92945 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul92945 = tf.keras.layers.Input(shape=([2, 2]))
in0Sub47715 = tf.keras.layers.Input(shape=([2]))
in1Sub47715 = tf.keras.layers.Input(shape=([2]))
in0Loc47786 = tf.keras.layers.Input(shape=([2, 2]))
in0Ave562 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave562 = tf.keras.layers.Input(shape=([1, 1, 1]))

Mul69326 = keras.layers.Multiply(name = 'Mul69326', )([in0Mul69326,in1Mul69326])
Fla25257 = keras.layers.Flatten(name = 'Fla25257', )(Mul69326)
Con80024 = keras.layers.Concatenate(axis=1, name = 'Con80024', )([Fla25257,in0Con80024])
Mul92945 = keras.layers.Multiply(name = 'Mul92945', )([in0Mul92945,in1Mul92945])
Fla66393 = keras.layers.Flatten(name = 'Fla66393', )(Mul92945)
Add11664 = keras.layers.Add(name = 'Add11664', )([Con80024,Fla66393])
Res42154 = keras.layers.Reshape((4, 1), name = 'Res42154', )(Add11664)
Sub47715 = keras.layers.Subtract(name = 'Sub47715', )([in0Sub47715,in1Sub47715])
Res44162 = keras.layers.Reshape((2, 1), name = 'Res44162', )(Sub47715)
Loc47786 = keras.layers.LocallyConnected1D(2, (2),strides=(1), name = 'Loc47786', )(in0Loc47786)
Res18260 = keras.layers.Reshape((1, 2, 1), name = 'Res18260', )(Loc47786)
Ave562 = keras.layers.Average(name = 'Ave562', )([in0Ave562,in1Ave562])
Zer31672 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer31672', )(Ave562)
Sub10787 = keras.layers.Subtract(name = 'Sub10787', )([Res18260,Zer31672])
Res32244 = keras.layers.Reshape((2, 1), name = 'Res32244', )(Sub10787)
Ave41811 = keras.layers.Average(name = 'Ave41811', )([Res44162,Res32244])
Zer13712 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer13712', )(Ave41811)
Mul91041 = keras.layers.Multiply(name = 'Mul91041', )([Res42154,Zer13712])
model = tf.keras.models.Model(inputs=[in0Mul69326,in1Mul69326,in0Con80024,in0Mul92945,in1Mul92945,in0Sub47715,in1Sub47715,in0Loc47786,in0Ave562,in1Ave562], outputs=Mul91041)
w = model.get_layer('Loc47786').get_weights() 
w[0] = np.array([[[0.808, 0.6262], [0.0257, 0.6305], [0.0301, 0.1404], [0.2065, 0.1008]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc47786').set_weights(w) 
in0Mul69326 = tf.constant([[[0.4176]]])
in1Mul69326 = tf.constant([[[0.143]]])
in0Con80024 = tf.constant([[0.3707, 0.343, 0.3715]])
in0Mul92945 = tf.constant([[[0.522, 0.6648], [0.1044, 0.3004]]])
in1Mul92945 = tf.constant([[[0.9925, 0.4631], [0.3828, 0.4557]]])
in0Sub47715 = tf.constant([[0.3085, 0.7171]])
in1Sub47715 = tf.constant([[0.4317, 0.9193]])
in0Loc47786 = tf.constant([[[0.766, 0.582], [0.7659, 0.9769]]])
in0Ave562 = tf.constant([[[[0.914]]]])
in1Ave562 = tf.constant([[[[0.2282]]]])
print (np.array2string(model.predict([in0Mul69326,in1Mul69326,in0Con80024,in0Mul92945,in1Mul92945,in0Sub47715,in1Sub47715,in0Loc47786,in0Ave562,in1Ave562],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul91041.png')

LMul69326 = multiply_layer([[[[0.4176]]], [[[0.143]]]], Mul69326), 
LFla25257 = flatten_layer(Mul69326, Fla25257), 
LCon80024 = concatenate_layer([Fla25257,[[0.3707, 0.343, 0.3715]]], 1, Con80024), 
LMul92945 = multiply_layer([[[[0.522, 0.6648], [0.1044, 0.3004]]], [[[0.9925, 0.4631], [0.3828, 0.4557]]]], Mul92945), 
LFla66393 = flatten_layer(Mul92945, Fla66393), 
LAdd11664 = add_layer([Con80024,Fla66393], Add11664), 
LRes42154 = reshape_layer(Add11664, [4, 1], Res42154), 
LSub47715 = subtract_layer([[0.3085, 0.7171]], [[0.4317, 0.9193]], Sub47715), 
LRes44162 = reshape_layer(Sub47715, [2, 1], Res44162), 
LLoc47786 = locally_connected1D_layer([[[0.766, 0.582], [0.7659, 0.9769]]], 2,[[[0.808, 0.6262], [0.0257, 0.6305], [0.0301, 0.1404], [0.2065, 0.1008]]],[[0, 0]], 1, Loc47786), 
LRes18260 = reshape_layer(Loc47786, [1, 2, 1], Res18260), 
LAve562 = average_layer([[[[[0.914]]]], [[[[0.2282]]]]], Ave562), 
LZer31672 = zero_padding2D_layer(Ave562, 0, 0, 1, 0, Zer31672), 
LSub10787 = subtract_layer(Res18260,Zer31672, Sub10787), 
LRes32244 = reshape_layer(Sub10787, [2, 1], Res32244), 
LAve41811 = average_layer([Res44162,Res32244], Ave41811), 
LZer13712 = zero_padding1D_layer(Ave41811, 2, 0, Zer13712), 
LMul91041 = multiply_layer([Res42154,Zer13712], Mul91041), 
exec_layers([LMul69326,LFla25257,LCon80024,LMul92945,LFla66393,LAdd11664,LRes42154,LSub47715,LRes44162,LLoc47786,LRes18260,LAve562,LZer31672,LSub10787,LRes32244,LAve41811,LZer13712,LMul91041],["Mul69326","Fla25257","Con80024","Mul92945","Fla66393","Add11664","Res42154","Sub47715","Res44162","Loc47786","Res18260","Ave562","Zer31672","Sub10787","Res32244","Ave41811","Zer13712","Mul91041"],Mul91041,"Mul91041")

Actual (Unparsed): [[[0.0000000], [0.0000000], [0.1408292], [0.0710031]]]

Expected (Unparsed): [[[0.0],[0.0],[0.1408291620958944],[0.07100310294505117]]]

Actual:   [[[0], [0], [0.1409], [0.0711]]]

Expected: [[[0], [0], [0.1409], [0.0711]]]