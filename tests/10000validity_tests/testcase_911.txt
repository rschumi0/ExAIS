import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add17583 = tf.keras.layers.Input(shape=([2, 1]))
in1Add17583 = tf.keras.layers.Input(shape=([2, 1]))
in0Con94418 = tf.keras.layers.Input(shape=([2, 1]))
in0Add19702 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add19702 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Dot16950 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot16950 = tf.keras.layers.Input(shape=([2, 2]))

Add17583 = keras.layers.Add(name = 'Add17583', )([in0Add17583,in1Add17583])
Den94446 = keras.layers.Dense(1,name = 'Den94446', )(Add17583)
Con94418 = keras.layers.Concatenate(axis=2, name = 'Con94418', )([Den94446,in0Con94418])
Add19702 = keras.layers.Add(name = 'Add19702', )([in0Add19702,in1Add19702])
Res26507 = keras.layers.Reshape((2, 2), name = 'Res26507', )(Add19702)
Dot16950 = keras.layers.Dot(axes=(2, 2), name = 'Dot16950', )([in0Dot16950,in1Dot16950])
Sub64144 = keras.layers.Subtract(name = 'Sub64144', )([Res26507,Dot16950])
Sub1020 = keras.layers.Subtract(name = 'Sub1020', )([Con94418,Sub64144])
model = tf.keras.models.Model(inputs=[in0Add17583,in1Add17583,in0Con94418,in0Add19702,in1Add19702,in0Dot16950,in1Dot16950], outputs=Sub1020)
w = model.get_layer('Den94446').get_weights() 
w[0] = np.array([[0.3936]])
w[1] = np.array([0.779])
model.get_layer('Den94446').set_weights(w) 
in0Add17583 = tf.constant([[[0.6359], [0.7114]]])
in1Add17583 = tf.constant([[[0.9], [0.6808]]])
in0Con94418 = tf.constant([[[0.2894], [0.1159]]])
in0Add19702 = tf.constant([[[[0.898, 0.101]], [[0.5202, 0.2544]]]])
in1Add19702 = tf.constant([[[[0.1379, 0.1635]], [[0.3863, 0.2712]]]])
in0Dot16950 = tf.constant([[[0.6955, 0.9503], [0.7005, 0.1431]]])
in1Dot16950 = tf.constant([[[0.2496, 0.207], [0.0086, 0.294]]])
print (np.array2string(model.predict([in0Add17583,in1Add17583,in0Con94418,in0Add19702,in1Add19702,in0Dot16950,in1Dot16950],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub1020.png')

LAdd17583 = add_layer([[[[0.6359], [0.7114]]], [[[0.9], [0.6808]]]], Add17583), 
LDen94446 = dense_layer(Add17583, [[0.3936]],[0.779], Den94446), 
LCon94418 = concatenate_layer([Den94446,[[[0.2894], [0.1159]]]], 2, Con94418), 
LAdd19702 = add_layer([[[[[0.898, 0.101]], [[0.5202, 0.2544]]]], [[[[0.1379, 0.1635]], [[0.3863, 0.2712]]]]], Add19702), 
LRes26507 = reshape_layer(Add19702, [2, 2], Res26507), 
LDot16950 = dot_layer([[[0.6955, 0.9503], [0.7005, 0.1431]]], [[[0.2496, 0.207], [0.0086, 0.294]]], 2, 2, Dot16950), 
LSub64144 = subtract_layer(Res26507,Dot16950, Sub64144), 
LSub1020 = subtract_layer(Con94418,Sub64144, Sub1020), 
exec_layers([LAdd17583,LDen94446,LCon94418,LAdd19702,LRes26507,LDot16950,LSub64144,LSub1020],["Add17583","Den94446","Con94418","Add19702","Res26507","Dot16950","Sub64144","Sub1020"],Sub1020,"Sub1020")

Actual (Unparsed): [[[0.7179391, 0.3102695], [0.6249364, -0.3616043]]]

Expected (Unparsed): [[[0.7179391399999999,0.3102695],[0.62493642,-0.36160430000000005]]]

Actual:   [[[0.718, 0.3103], [0.625, -0.3616]]]

Expected: [[[0.718, 0.3103], [0.625, -0.3616]]]