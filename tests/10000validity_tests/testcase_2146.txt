import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof72167 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Sof72167 = keras.layers.Softmax(axis=1, name = 'Sof72167', input_shape=(2, 2, 1, 1))(in0Sof72167)
Res89121 = keras.layers.Reshape((2, 2, 1), name = 'Res89121', )(Sof72167)
Res97843 = keras.layers.Reshape((2, 2), name = 'Res97843', )(Res89121)
GRU90604 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU90604', )(Res97843)
Res82048 = keras.layers.Reshape((1, 1), name = 'Res82048', )(GRU90604)
Res83176 = keras.layers.Reshape((1, 1, 1), name = 'Res83176', )(Res82048)
Cro9654 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro9654', )(Res83176)
model = tf.keras.models.Model(inputs=[in0Sof72167], outputs=Cro9654)
w = model.get_layer('GRU90604').get_weights() 
w[0] = np.array([[9, 4, 5], [3, 10, 4]])
w[1] = np.array([[7, 2, 10]])
w[2] = np.array([10, 9, 5])
model.get_layer('GRU90604').set_weights(w) 
in0Sof72167 = tf.constant([[[[[0.7781]], [[0.3565]]], [[[0.3184]], [[0.6765]]]]])
print (np.array2string(model.predict([in0Sof72167],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro9654.png')

LSof72167 = softmax_layer([[[[[0.7781]], [[0.3565]]], [[[0.3184]], [[0.6765]]]]], 1, Sof72167), 
LRes89121 = reshape_layer(Sof72167, [2, 2, 1], Res89121), 
LRes97843 = reshape_layer(Res89121, [2, 2], Res97843), 
LGRU90604 = gru_layer(Res97843,[[9, 4, 5], [3, 10, 4]],[[7, 2, 10]],[10, 9, 5], false, GRU90604), 
LRes82048 = reshape_layer(GRU90604, [1, 1], Res82048), 
LRes83176 = reshape_layer(Res82048, [1, 1, 1], Res83176), 
LCro9654 = cropping2D_layer(Res83176, 0, 0, 0, 0, Cro9654), 
exec_layers([LSof72167,LRes89121,LRes97843,LGRU90604,LRes82048,LRes83176,LCro9654],["Sof72167","Res89121","Res97843","GRU90604","Res82048","Res83176","Cro9654"],Cro9654,"Cro9654")

Actual (Unparsed): [[[[0.0000003]]]]

Expected (Unparsed): [[[[2.967912348296697e-7]]]]

Actual:   [[[[0]]]]

Expected: [[[[0]]]]