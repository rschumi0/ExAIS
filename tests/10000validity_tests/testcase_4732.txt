import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc81211 = tf.keras.layers.Input(shape=([2, 2]))
in0Sub96566 = tf.keras.layers.Input(shape=([3]))
in1Sub96566 = tf.keras.layers.Input(shape=([3]))
in0Add38945 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Add38945 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Loc81211 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc81211', )(in0Loc81211)
Res95964 = keras.layers.Reshape((1, 3, 1), name = 'Res95964', )(Loc81211)
Res96094 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res96094', )(Res95964)
Zer4363 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer4363', )(Res96094)
Sub96566 = keras.layers.Subtract(name = 'Sub96566', )([in0Sub96566,in1Sub96566])
Res43487 = keras.layers.Reshape((3, 1), name = 'Res43487', )(Sub96566)
Res90722 = keras.layers.Reshape((3, 1, 1), name = 'Res90722', )(Res43487)
Res40392 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res40392', )(Res90722)
Zer38294 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer38294', )(Res40392)
Add38945 = keras.layers.Add(name = 'Add38945', )([in0Add38945,in1Add38945])
Zer35379 = keras.layers.ZeroPadding3D(padding=((2, 0), (1, 0), (0, 0)), name = 'Zer35379', )(Add38945)
Add57218 = keras.layers.Add(name = 'Add57218', )([Zer38294,Zer35379])
Zer83116 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (2, 0)), name = 'Zer83116', )(Add57218)
Max46665 = keras.layers.Maximum(name = 'Max46665', )([Zer4363,Zer83116])
model = tf.keras.models.Model(inputs=[in0Loc81211,in0Sub96566,in1Sub96566,in0Add38945,in1Add38945], outputs=Max46665)
w = model.get_layer('Loc81211').get_weights() 
w[0] = np.array([[[0.3454, 0.55, 0.7014], [0.6825, 0.1171, 0.1124], [0.0847, 0.7445, 0.1021], [0.629, 0.1076, 0.4191]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc81211').set_weights(w) 
in0Loc81211 = tf.constant([[[0.9693, 0.799], [0.8001, 0.905]]])
in0Sub96566 = tf.constant([[0.814, 0.6281, 0.5016]])
in1Sub96566 = tf.constant([[0.9932, 0.471, 0.7835]])
in0Add38945 = tf.constant([[[[[0.6318]], [[0.277]]]]])
in1Add38945 = tf.constant([[[[[0.8798]], [[0.0495]]]]])
print (np.array2string(model.predict([in0Loc81211,in0Sub96566,in1Sub96566,in0Add38945,in1Add38945],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max46665.png')

LLoc81211 = locally_connected1D_layer([[[0.9693, 0.799], [0.8001, 0.905]]], 2,[[[0.3454, 0.55, 0.7014], [0.6825, 0.1171, 0.1124], [0.0847, 0.7445, 0.1021], [0.629, 0.1076, 0.4191]]],[[0, 0, 0]], 1, Loc81211), 
LRes95964 = reshape_layer(Loc81211, [1, 3, 1], Res95964), 
LRes96094 = reshape_layer(Res95964, [1, 3, 1, 1], Res96094), 
LZer4363 = zero_padding3D_layer(Res96094, 1, 1, 1, 1, 1, 1, Zer4363), 
LSub96566 = subtract_layer([[0.814, 0.6281, 0.5016]], [[0.9932, 0.471, 0.7835]], Sub96566), 
LRes43487 = reshape_layer(Sub96566, [3, 1], Res43487), 
LRes90722 = reshape_layer(Res43487, [3, 1, 1], Res90722), 
LRes40392 = reshape_layer(Res90722, [3, 1, 1, 1], Res40392), 
LZer38294 = zero_padding3D_layer(Res40392, 0, 0, 2, 0, 0, 0, Zer38294), 
LAdd38945 = add_layer([[[[[[0.6318]], [[0.277]]]]], [[[[[0.8798]], [[0.0495]]]]]], Add38945), 
LZer35379 = zero_padding3D_layer(Add38945, 2, 0, 1, 0, 0, 0, Zer35379), 
LAdd57218 = add_layer([Zer38294,Zer35379], Add57218), 
LZer83116 = zero_padding3D_layer(Add57218, 0, 0, 2, 0, 2, 0, Zer83116), 
LMax46665 = maximum_layer([Zer4363,Zer83116], Max46665), 
exec_layers([LLoc81211,LRes95964,LRes96094,LZer4363,LSub96566,LRes43487,LRes90722,LRes40392,LZer38294,LAdd38945,LZer35379,LAdd57218,LZer83116,LMax46665],["Loc81211","Res95964","Res96094","Zer4363","Sub96566","Res43487","Res90722","Res40392","Zer38294","Add38945","Zer35379","Add57218","Zer83116","Max46665"],Max46665,"Max46665")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.5171272], [0.0000000]], [[0.0000000], [1.3197304], [0.0000000]], [[0.0000000], [1.2306503], [0.0000000]], [[0.0000000], [0.0000000], [0.1571000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [1.5116000]], [[0.0000000], [0.0000000], [0.0446000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[1.51712719],[0]],[[0],[1.3197303500000002],[0]],[[0],[1.23065033],[0]],[[0],[0],[0.15710000000000002]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[1.5116]],[[0],[0],[0.044600000000000084]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [1.5172], [0]], [[0], [1.3198], [0]], [[0], [1.2307], [0]], [[0], [0], [0.1571]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [1.5116]], [[0], [0], [0.0446]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [1.5172], [0]], [[0], [1.3198], [0]], [[0], [1.2307], [0]], [[0], [0], [0.1572]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [1.5116]], [[0], [0], [0.0447]]]]]