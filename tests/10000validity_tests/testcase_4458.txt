import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub25846 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub25846 = tf.keras.layers.Input(shape=([2, 3]))

Sub25846 = keras.layers.Subtract(name = 'Sub25846', )([in0Sub25846,in1Sub25846])
LST20610 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST20610', )(Sub25846)
Res40372 = keras.layers.Reshape((2, 1), name = 'Res40372', )(LST20610)
Res58354 = keras.layers.Reshape((2, 1, 1), name = 'Res58354', )(Res40372)
Sep15448 = keras.layers.SeparableConv2D(3, (2, 1),strides=(1, 1), padding='valid', name = 'Sep15448', )(Res58354)
model = tf.keras.models.Model(inputs=[in0Sub25846,in1Sub25846], outputs=Sep15448)
w = model.get_layer('LST20610').get_weights() 
w[0] = np.array([[1, 4, 7, 4, 7, 2, 9, 10], [4, 2, 10, 9, 9, 4, 2, 2], [5, 4, 8, 10, 6, 6, 9, 8]])
w[1] = np.array([[7, 6, 4, 3, 7, 6, 7, 8], [9, 9, 2, 6, 1, 7, 5, 5]])
w[2] = np.array([10, 10, 7, 1, 8, 4, 10, 8])
model.get_layer('LST20610').set_weights(w) 
w = model.get_layer('Sep15448').get_weights() 
w[0] = np.array([[[[0.1768]]], [[[0.6873]]]])
w[1] = np.array([[[[0.5028, 0.8991, 0.6823]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep15448').set_weights(w) 
in0Sub25846 = tf.constant([[[0.2982, 0.6623, 0.5675], [0.6259, 0.1361, 0.0307]]])
in1Sub25846 = tf.constant([[[0.4552, 0.6918, 0.1792], [0.5811, 0.7908, 0.4423]]])
print (np.array2string(model.predict([in0Sub25846,in1Sub25846],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep15448.png')

LSub25846 = subtract_layer([[[0.2982, 0.6623, 0.5675], [0.6259, 0.1361, 0.0307]]], [[[0.4552, 0.6918, 0.1792], [0.5811, 0.7908, 0.4423]]], Sub25846), 
LLST20610 = lstm_layer(Sub25846,[[1, 4, 7, 4, 7, 2, 9, 10], [4, 2, 10, 9, 9, 4, 2, 2], [5, 4, 8, 10, 6, 6, 9, 8]],[[7, 6, 4, 3, 7, 6, 7, 8], [9, 9, 2, 6, 1, 7, 5, 5]],[10, 10, 7, 1, 8, 4, 10, 8], LST20610), 
LRes40372 = reshape_layer(LST20610, [2, 1], Res40372), 
LRes58354 = reshape_layer(Res40372, [2, 1, 1], Res58354), 
LSep15448 = separable_conv2D_layer(Res58354, 2, 1,[[[[[0.1768]]], [[[0.6873]]]],[[[[0.5028, 0.8991, 0.6823]]]]],[0, 0, 0], 1, 1, false, Sep15448), 
exec_layers([LSub25846,LLST20610,LRes40372,LRes58354,LSep15448],["Sub25846","LST20610","Res40372","Res58354","Sep15448"],Sep15448,"Sep15448")

Actual (Unparsed): [[[[0.3641848, 0.6512302, 0.4941991]]]]

Expected (Unparsed): [[[[0.36418480929809594,0.6512302347651513,0.49419907594290147]]]]

Actual:   [[[[0.3642, 0.6513, 0.4942]]]]

Expected: [[[[0.3642, 0.6513, 0.4942]]]]