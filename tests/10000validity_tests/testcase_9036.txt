import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro21965 = tf.keras.layers.Input(shape=([2, 2]))
in0Ave33678 = tf.keras.layers.Input(shape=([2, 1]))
in0Con33386 = tf.keras.layers.Input(shape=([1, 1]))
in0Glo70517 = tf.keras.layers.Input(shape=([2, 2, 2]))

Cro21965 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro21965', )(in0Cro21965)
Ave33678 = keras.layers.AveragePooling1D(pool_size=(2), strides=(7), padding='same', name = 'Ave33678', )(in0Ave33678)
Con33386 = keras.layers.Concatenate(axis=2, name = 'Con33386', )([Ave33678,in0Con33386])
Add67651 = keras.layers.Add(name = 'Add67651', )([Cro21965,Con33386])
Res36361 = keras.layers.Reshape((1, 2, 1), name = 'Res36361', )(Add67651)
Glo70517 = keras.layers.GlobalAveragePooling2D(name = 'Glo70517', )(in0Glo70517)
Res89799 = keras.layers.Reshape((2, 1), name = 'Res89799', )(Glo70517)
Res66454 = keras.layers.Reshape((2, 1, 1), name = 'Res66454', )(Res89799)
Cro32272 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro32272', )(Res66454)
Zer70404 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer70404', )(Cro32272)
Max71023 = keras.layers.Maximum(name = 'Max71023', )([Res36361,Zer70404])
model = tf.keras.models.Model(inputs=[in0Cro21965,in0Ave33678,in0Con33386,in0Glo70517], outputs=Max71023)
in0Cro21965 = tf.constant([[[1.7211, 1.8069], [1.9104, 1.9264]]])
in0Ave33678 = tf.constant([[[1.081], [1.4317]]])
in0Con33386 = tf.constant([[[0.0543]]])
in0Glo70517 = tf.constant([[[[1.0618, 1.3505], [1.4617, 1.6539]], [[1.8342, 1.176], [1.8906, 1.3949]]]])
print (np.array2string(model.predict([in0Cro21965,in0Ave33678,in0Con33386,in0Glo70517],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max71023.png')

LCro21965 = cropping1D_layer([[[1.7211, 1.8069], [1.9104, 1.9264]]], 1, 0, Cro21965), 
LAve33678 = average_pooling1D_layer([[[1.081], [1.4317]]], 2, 7, true, Ave33678), 
LCon33386 = concatenate_layer([Ave33678,[[[0.0543]]]], 2, Con33386), 
LAdd67651 = add_layer([Cro21965,Con33386], Add67651), 
LRes36361 = reshape_layer(Add67651, [1, 2, 1], Res36361), 
LGlo70517 = global_average_pooling2D_layer([[[[1.0618, 1.3505], [1.4617, 1.6539]], [[1.8342, 1.176], [1.8906, 1.3949]]]], Glo70517), 
LRes89799 = reshape_layer(Glo70517, [2, 1], Res89799), 
LRes66454 = reshape_layer(Res89799, [2, 1, 1], Res66454), 
LCro32272 = cropping2D_layer(Res66454, 1, 0, 0, 0, Cro32272), 
LZer70404 = zero_padding2D_layer(Cro32272, 0, 0, 1, 0, Zer70404), 
LMax71023 = maximum_layer([Res36361,Zer70404], Max71023), 
exec_layers([LCro21965,LAve33678,LCon33386,LAdd67651,LRes36361,LGlo70517,LRes89799,LRes66454,LCro32272,LZer70404,LMax71023],["Cro21965","Ave33678","Con33386","Add67651","Res36361","Glo70517","Res89799","Res66454","Cro32272","Zer70404","Max71023"],Max71023,"Max71023")

Actual (Unparsed): [[[[3.1667500], [1.9806999]]]]

Expected (Unparsed): [[[[3.16675],[1.9807]]]]

Actual:   [[[[3.1668], [1.9807]]]]

Expected: [[[[3.1668], [1.9807]]]]