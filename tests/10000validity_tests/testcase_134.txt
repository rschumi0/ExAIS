import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr81438 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Add90253 = tf.keras.layers.Input(shape=([1, 1]))
in1Add90253 = tf.keras.layers.Input(shape=([1, 1]))
in0Con56130 = tf.keras.layers.Input(shape=([1, 1]))
in0Add75996 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Add75996 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Con62198 = tf.keras.layers.Input(shape=([12]))
in0Min67706 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Min67706 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Mul59335 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul59335 = tf.keras.layers.Input(shape=([1, 2]))
in0Con86749 = tf.keras.layers.Input(shape=([2, 6]))
in0Bat23723 = tf.keras.layers.Input(shape=([1]))
in0Con28388 = tf.keras.layers.Input(shape=([15]))

Thr81438 = keras.layers.ThresholdedReLU(theta=7.983694524367621, name = 'Thr81438', input_shape=(2, 1, 1, 2))(in0Thr81438)
Res29977 = keras.layers.Reshape((2, 1, 2), name = 'Res29977', )(Thr81438)
Res42511 = keras.layers.Reshape((2, 2), name = 'Res42511', )(Res29977)
Add90253 = keras.layers.Add(name = 'Add90253', )([in0Add90253,in1Add90253])
Con56130 = keras.layers.Concatenate(axis=2, name = 'Con56130', )([Add90253,in0Con56130])
Add75996 = keras.layers.Add(name = 'Add75996', )([in0Add75996,in1Add75996])
Res24442 = keras.layers.Reshape((2, 1, 2), name = 'Res24442', )(Add75996)
Res34617 = keras.layers.Reshape((2, 2), name = 'Res34617', )(Res24442)
Dot70472 = keras.layers.Dot(axes=(2, 2), name = 'Dot70472', )([Con56130,Res34617])
Zer54359 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer54359', )(Dot70472)
Add35084 = keras.layers.Add(name = 'Add35084', )([Res42511,Zer54359])
Fla51654 = keras.layers.Flatten(name = 'Fla51654', )(Add35084)
Con62198 = keras.layers.Concatenate(axis=1, name = 'Con62198', )([Fla51654,in0Con62198])
Min67706 = keras.layers.Minimum(name = 'Min67706', )([in0Min67706,in1Min67706])
Res6326 = keras.layers.Reshape((2, 2, 4), name = 'Res6326', )(Min67706)
Res16121 = keras.layers.Reshape((2, 8), name = 'Res16121', )(Res6326)
Mul59335 = keras.layers.Multiply(name = 'Mul59335', )([in0Mul59335,in1Mul59335])
Zer3735 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer3735', )(Mul59335)
Con86749 = keras.layers.Concatenate(axis=2, name = 'Con86749', )([Zer3735,in0Con86749])
Mul57275 = keras.layers.Multiply(name = 'Mul57275', )([Res16121,Con86749])
Fla20646 = keras.layers.Flatten(name = 'Fla20646', )(Mul57275)
Bat23723 = keras.layers.BatchNormalization(axis=1, epsilon=0.453187336080366,  name = 'Bat23723', )(in0Bat23723)
Con28388 = keras.layers.Concatenate(axis=1, name = 'Con28388', )([Bat23723,in0Con28388])
Add62185 = keras.layers.Add(name = 'Add62185', )([Fla20646,Con28388])
Mul8956 = keras.layers.Multiply(name = 'Mul8956', )([Con62198,Add62185])
model = tf.keras.models.Model(inputs=[in0Thr81438,in0Add90253,in1Add90253,in0Con56130,in0Add75996,in1Add75996,in0Con62198,in0Min67706,in1Min67706,in0Mul59335,in1Mul59335,in0Con86749,in0Bat23723,in0Con28388], outputs=Mul8956)
w = model.get_layer('Bat23723').get_weights() 
w[0] = np.array([0.782])
w[1] = np.array([0.2009])
w[2] = np.array([0.122])
w[3] = np.array([0.4652])
model.get_layer('Bat23723').set_weights(w) 
in0Thr81438 = tf.constant([[[[[0.4108, 0.2271]]], [[[0.8118, 0.937]]]]])
in0Add90253 = tf.constant([[[0.2572]]])
in1Add90253 = tf.constant([[[0.5933]]])
in0Con56130 = tf.constant([[[0.55]]])
in0Add75996 = tf.constant([[[[[0.6119], [0.1022]]], [[[0.2789], [0.0926]]]]])
in1Add75996 = tf.constant([[[[[0.666], [0.855]]], [[[0.7149], [0.7294]]]]])
in0Con62198 = tf.constant([[0.5715, 0.7193, 0.1852, 0.6144, 0.1498, 0.6567, 0.6118, 0.3784, 0.2155, 0.2798, 0.8047, 0.4728]])
in0Min67706 = tf.constant([[[[[0.3118, 0.5546], [0.5454, 0.8514]], [[0.9958, 0.672], [0.743, 0.5555]]], [[[0.4758, 0.0629], [0.7294, 0.7559]], [[0.8008, 0.8019], [0.5858, 0.2236]]]]])
in1Min67706 = tf.constant([[[[[0.4039, 0.0411], [0.6554, 0.5355]], [[0.8781, 0.7481], [0.7914, 0.2767]]], [[[0.2592, 0.8522], [0.6564, 0.028]], [[0.9319, 0.2811], [0.1568, 0.6415]]]]])
in0Mul59335 = tf.constant([[[0.5959, 0.6045]]])
in1Mul59335 = tf.constant([[[0.3097, 0.0573]]])
in0Con86749 = tf.constant([[[0.5588, 0.7439, 0.6654, 0.1092, 0.1182, 0.4258], [0.533, 0.6328, 0.902, 0.1288, 0.8434, 0.2556]]])
in0Bat23723 = tf.constant([[1.0829]])
in0Con28388 = tf.constant([[0.92, 0.7147, 0.8037, 0.6463, 0.1351, 0.3694, 0.908, 0.0428, 0.8706, 0.7846, 0.6355, 0.5092, 0.223, 0.5624, 0.3787]])
print (np.array2string(model.predict([in0Thr81438,in0Add90253,in1Add90253,in0Con56130,in0Add75996,in1Add75996,in0Con62198,in0Min67706,in1Min67706,in0Mul59335,in1Mul59335,in0Con86749,in0Bat23723,in0Con28388],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul8956.png')

LThr81438 = thresholded_relu_layer([[[[[0.4108, 0.2271]]], [[[0.8118, 0.937]]]]], 7.983694524367621, Thr81438), 
LRes29977 = reshape_layer(Thr81438, [2, 1, 2], Res29977), 
LRes42511 = reshape_layer(Res29977, [2, 2], Res42511), 
LAdd90253 = add_layer([[[[0.2572]]], [[[0.5933]]]], Add90253), 
LCon56130 = concatenate_layer([Add90253,[[[0.55]]]], 2, Con56130), 
LAdd75996 = add_layer([[[[[[0.6119], [0.1022]]], [[[0.2789], [0.0926]]]]], [[[[[0.666], [0.855]]], [[[0.7149], [0.7294]]]]]], Add75996), 
LRes24442 = reshape_layer(Add75996, [2, 1, 2], Res24442), 
LRes34617 = reshape_layer(Res24442, [2, 2], Res34617), 
LDot70472 = dot_layer(Con56130,Res34617, 2, 2, Dot70472), 
LZer54359 = zero_padding1D_layer(Dot70472, 1, 0, Zer54359), 
LAdd35084 = add_layer([Res42511,Zer54359], Add35084), 
LFla51654 = flatten_layer(Add35084, Fla51654), 
LCon62198 = concatenate_layer([Fla51654,[[0.5715, 0.7193, 0.1852, 0.6144, 0.1498, 0.6567, 0.6118, 0.3784, 0.2155, 0.2798, 0.8047, 0.4728]]], 1, Con62198), 
LMin67706 = minimum_layer([[[[[[0.3118, 0.5546], [0.5454, 0.8514]], [[0.9958, 0.672], [0.743, 0.5555]]], [[[0.4758, 0.0629], [0.7294, 0.7559]], [[0.8008, 0.8019], [0.5858, 0.2236]]]]], [[[[[0.4039, 0.0411], [0.6554, 0.5355]], [[0.8781, 0.7481], [0.7914, 0.2767]]], [[[0.2592, 0.8522], [0.6564, 0.028]], [[0.9319, 0.2811], [0.1568, 0.6415]]]]]], Min67706), 
LRes6326 = reshape_layer(Min67706, [2, 2, 4], Res6326), 
LRes16121 = reshape_layer(Res6326, [2, 8], Res16121), 
LMul59335 = multiply_layer([[[[0.5959, 0.6045]]], [[[0.3097, 0.0573]]]], Mul59335), 
LZer3735 = zero_padding1D_layer(Mul59335, 1, 0, Zer3735), 
LCon86749 = concatenate_layer([Zer3735,[[[0.5588, 0.7439, 0.6654, 0.1092, 0.1182, 0.4258], [0.533, 0.6328, 0.902, 0.1288, 0.8434, 0.2556]]]], 2, Con86749), 
LMul57275 = multiply_layer([Res16121,Con86749], Mul57275), 
LFla20646 = flatten_layer(Mul57275, Fla20646), 
LBat23723 = batch_normalization_layer([[1.0829]], 1, 0.453187336080366, [0.782], [0.2009], [0.122], [0.4652], Bat23723), 
LCon28388 = concatenate_layer([Bat23723,[[0.92, 0.7147, 0.8037, 0.6463, 0.1351, 0.3694, 0.908, 0.0428, 0.8706, 0.7846, 0.6355, 0.5092, 0.223, 0.5624, 0.3787]]], 1, Con28388), 
LAdd62185 = add_layer([Fla20646,Con28388], Add62185), 
LMul8956 = multiply_layer([Con62198,Add62185], Mul8956), 
exec_layers([LThr81438,LRes29977,LRes42511,LAdd90253,LCon56130,LAdd75996,LRes24442,LRes34617,LDot70472,LZer54359,LAdd35084,LFla51654,LCon62198,LMin67706,LRes6326,LRes16121,LMul59335,LZer3735,LCon86749,LMul57275,LFla20646,LBat23723,LCon28388,LAdd62185,LMul8956],["Thr81438","Res29977","Res42511","Add90253","Con56130","Add75996","Res24442","Res34617","Dot70472","Zer54359","Add35084","Fla51654","Con62198","Min67706","Res6326","Res16121","Mul59335","Zer3735","Con86749","Mul57275","Fla20646","Bat23723","Con28388","Add62185","Mul8956"],Mul8956,"Mul8956")

Actual (Unparsed): [[0.0000000, 0.0000000, 1.6447244, 1.5594627, 0.7032809, 0.1499614, 0.0846776, 0.6302631, 0.0135772, 0.5731538, 0.6940634, 0.2471778, 0.2653929, 0.0725258, 0.5589809, 0.2060709]]

Expected (Unparsed): [[0.0,0.0,1.644724398215804,1.559462762557305,0.7032808934099999,0.14996139032000003,0.08467762552000001,0.630263107584,0.013577185858476799,0.5731537859263756,0.6940633621600001,0.24717784256,0.2653929048,0.072525749264,0.558980928064,0.20607090124799998]]

Actual:   [[0, 0, 1.6448, 1.5595, 0.7033, 0.15, 0.0847, 0.6303, 0.0136, 0.5732, 0.6941, 0.2472, 0.2654, 0.0726, 0.559, 0.2061]]

Expected: [[0, 0, 1.6448, 1.5595, 0.7033, 0.15, 0.0847, 0.6303, 0.0136, 0.5732, 0.6941, 0.2472, 0.2654, 0.0726, 0.559, 0.2061]]