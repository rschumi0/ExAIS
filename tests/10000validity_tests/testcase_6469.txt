import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub90630 = tf.keras.layers.Input(shape=([3]))
in1Sub90630 = tf.keras.layers.Input(shape=([3]))
in0Mas95907 = tf.keras.layers.Input(shape=([2]))
in0Con22850 = tf.keras.layers.Input(shape=([1]))

Sub90630 = keras.layers.Subtract(name = 'Sub90630', )([in0Sub90630,in1Sub90630])
Mas95907 = keras.layers.Masking(mask_value=1, name = 'Mas95907', )(in0Mas95907)
Lay93323 = keras.layers.LayerNormalization(axis=1, epsilon=1.8162652972519617, name = 'Lay93323', )(Mas95907)
Fla71533 = keras.layers.Flatten(name = 'Fla71533', )(Lay93323)
Con22850 = keras.layers.Concatenate(axis=1, name = 'Con22850', )([Fla71533,in0Con22850])
Ave66162 = keras.layers.Average(name = 'Ave66162', )([Sub90630,Con22850])
Bat26244 = keras.layers.BatchNormalization(axis=1, epsilon=0.4320876040549283,  name = 'Bat26244', )(Ave66162)
model = tf.keras.models.Model(inputs=[in0Sub90630,in1Sub90630,in0Mas95907,in0Con22850], outputs=Bat26244)
w = model.get_layer('Bat26244').get_weights() 
w[0] = np.array([0.81, 0.8928, 0.18])
w[1] = np.array([0.8624, 0.6652, 0.7444])
w[2] = np.array([0.6139, 0.5442, 0.846])
w[3] = np.array([0.5427, 0.6606, 0.6854])
model.get_layer('Bat26244').set_weights(w) 
in0Sub90630 = tf.constant([[0.7425, 0.9389, 0.4611]])
in1Sub90630 = tf.constant([[0.4532, 0.8321, 0.5396]])
in0Mas95907 = tf.constant([[1.6775, 1.3281]])
in0Con22850 = tf.constant([[0.5887]])
print (np.array2string(model.predict([in0Sub90630,in1Sub90630,in0Mas95907,in0Con22850],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat26244.png')

LSub90630 = subtract_layer([[0.7425, 0.9389, 0.4611]], [[0.4532, 0.8321, 0.5396]], Sub90630), 
LMas95907 = masking_layer([[1.6775, 1.3281]], 1, Mas95907), 
LLay93323 = layer_normalization_layer(Mas95907, 1, 1.8162652972519617, Lay93323), 
LFla71533 = flatten_layer(Lay93323, Fla71533), 
LCon22850 = concatenate_layer([Fla71533,[[0.5887]]], 1, Con22850), 
LAve66162 = average_layer([Sub90630,Con22850], Ave66162), 
LBat26244 = batch_normalization_layer(Ave66162, 1, 0.4320876040549283, [0.81, 0.8928, 0.18], [0.8624, 0.6652, 0.7444], [0.6139, 0.5442, 0.846], [0.5427, 0.6606, 0.6854], Bat26244), 
exec_layers([LSub90630,LMas95907,LLay93323,LFla71533,LCon22850,LAve66162,LBat26244],["Sub90630","Mas95907","Lay93323","Fla71533","Con22850","Ave66162","Bat26244"],Bat26244,"Bat26244")

Actual (Unparsed): [[0.5301567, 0.1911116, 0.6437844]]

Expected (Unparsed): [[0.53015669921867,0.19111163052154845,0.6437844425004511]]

Actual:   [[0.5302, 0.1912, 0.6438]]

Expected: [[0.5302, 0.1912, 0.6438]]