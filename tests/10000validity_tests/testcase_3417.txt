import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add94428 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Add94428 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con99323 = tf.keras.layers.Input(shape=([3, 11]))
in0Dot17646 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot17646 = tf.keras.layers.Input(shape=([3, 3]))

Add94428 = keras.layers.Add(name = 'Add94428', )([in0Add94428,in1Add94428])
Res15168 = keras.layers.Reshape((1, 1, 1), name = 'Res15168', )(Add94428)
Res57540 = keras.layers.Reshape((1, 1), name = 'Res57540', )(Res15168)
Sim73661 = keras.layers.SimpleRNN(2,name = 'Sim73661', )(Res57540)
Res736 = keras.layers.Reshape((2, 1), name = 'Res736', )(Sim73661)
Zer27260 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer27260', )(Res736)
Con99323 = keras.layers.Concatenate(axis=2, name = 'Con99323', )([Zer27260,in0Con99323])
Dot17646 = keras.layers.Dot(axes=(2, 2), name = 'Dot17646', )([in0Dot17646,in1Dot17646])
Res91963 = keras.layers.Reshape((3, 3, 1), name = 'Res91963', )(Dot17646)
Res34459 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res34459', )(Res91963)
Con20642 = keras.layers.Conv3DTranspose(4, (2, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con20642', )(Res34459)
Res10015 = keras.layers.Reshape((3, 3, 4), name = 'Res10015', )(Con20642)
Res82249 = keras.layers.Reshape((3, 12), name = 'Res82249', )(Res10015)
Dot31945 = keras.layers.Dot(axes=(2, 2), name = 'Dot31945', )([Con99323,Res82249])
ReL89593 = keras.layers.ReLU(max_value=2.8781754151009427, negative_slope=6.074164230087244, threshold=2.0856465447455164, name = 'ReL89593', )(Dot31945)
model = tf.keras.models.Model(inputs=[in0Add94428,in1Add94428,in0Con99323,in0Dot17646,in1Dot17646], outputs=ReL89593)
w = model.get_layer('Sim73661').get_weights() 
w[0] = np.array([[8, 5]])
w[1] = np.array([[9, 7], [8, 5]])
w[2] = np.array([7, 9])
model.get_layer('Sim73661').set_weights(w) 
w = model.get_layer('Con20642').get_weights() 
w[0] = np.array([[[[[0.3553], [0.5327], [0.7169], [0.5944]]]], [[[[0.6367], [0.8349], [0.7346], [0.8928]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con20642').set_weights(w) 
in0Add94428 = tf.constant([[[[[0.7383]]]]])
in1Add94428 = tf.constant([[[[[0.6781]]]]])
in0Con99323 = tf.constant([[[0.0106, 0.999, 0.5107, 0.849, 0.4803, 0.1342, 0.7591, 0.8197, 0.6652, 0.8513, 0.4401], [0.9632, 0.1001, 0.7922, 0.7917, 0.6855, 0.5662, 0.8664, 0.8951, 0.5492, 0.7582, 0.5047], [0.217, 0.884, 0.7093, 0.5478, 0.9772, 0.039, 0.414, 0.8253, 0.443, 0.7462, 0.3235]]])
in0Dot17646 = tf.constant([[[0.8502, 0.7929, 0.8519], [0.4303, 0.5891, 0.2145], [0.0474, 0.9629, 0.7037]]])
in1Dot17646 = tf.constant([[[0.5986, 0.5807, 0.1053], [0.0013, 0.6063, 0.2528], [0.038, 0.6722, 0.0639]]])
print (np.array2string(model.predict([in0Add94428,in1Add94428,in0Con99323,in0Dot17646,in1Dot17646],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL89593.png')

LAdd94428 = add_layer([[[[[[0.7383]]]]], [[[[[0.6781]]]]]], Add94428), 
LRes15168 = reshape_layer(Add94428, [1, 1, 1], Res15168), 
LRes57540 = reshape_layer(Res15168, [1, 1], Res57540), 
LSim73661 = simple_rnn_layer(Res57540,[[8, 5]],[[9, 7], [8, 5]],[7, 9], Sim73661), 
LRes736 = reshape_layer(Sim73661, [2, 1], Res736), 
LZer27260 = zero_padding1D_layer(Res736, 1, 0, Zer27260), 
LCon99323 = concatenate_layer([Zer27260,[[[0.0106, 0.999, 0.5107, 0.849, 0.4803, 0.1342, 0.7591, 0.8197, 0.6652, 0.8513, 0.4401], [0.9632, 0.1001, 0.7922, 0.7917, 0.6855, 0.5662, 0.8664, 0.8951, 0.5492, 0.7582, 0.5047], [0.217, 0.884, 0.7093, 0.5478, 0.9772, 0.039, 0.414, 0.8253, 0.443, 0.7462, 0.3235]]]], 2, Con99323), 
LDot17646 = dot_layer([[[0.8502, 0.7929, 0.8519], [0.4303, 0.5891, 0.2145], [0.0474, 0.9629, 0.7037]]], [[[0.5986, 0.5807, 0.1053], [0.0013, 0.6063, 0.2528], [0.038, 0.6722, 0.0639]]], 2, 2, Dot17646), 
LRes91963 = reshape_layer(Dot17646, [3, 3, 1], Res91963), 
LRes34459 = reshape_layer(Res91963, [3, 3, 1, 1], Res34459), 
LCon20642 = conv3D_transpose_layer(Res34459, 2, 1, 1,[[[[[0.3553], [0.5327], [0.7169], [0.5944]]]], [[[[0.6367], [0.8349], [0.7346], [0.8928]]]]],[0, 0, 0, 0], 1, 1, 1, true, Con20642), 
LRes10015 = reshape_layer(Con20642, [3, 3, 4], Res10015), 
LRes82249 = reshape_layer(Res10015, [3, 12], Res82249), 
LDot31945 = dot_layer(Con99323,Res82249, 2, 2, Dot31945), 
LReL89593 = relu_layer(Dot31945, 2.8781754151009427, 6.074164230087244, 2.0856465447455164, ReL89593), 
exec_layers([LAdd94428,LRes15168,LRes57540,LSim73661,LRes736,LZer27260,LCon99323,LDot17646,LRes91963,LRes34459,LCon20642,LRes10015,LRes82249,LDot31945,LReL89593],["Add94428","Res15168","Res57540","Sim73661","Res736","Zer27260","Con99323","Dot17646","Res91963","Res34459","Con20642","Res10015","Res82249","Dot31945","ReL89593"],ReL89593,"ReL89593")

Actual (Unparsed): [[[2.7967468, 2.8781754, 2.8781754], [2.8781754, 2.8781754, 2.8781754], [2.8781754, 2.8781754, 2.8781754]]]

Expected (Unparsed): [[[2.796746750655952,2.8781754151009427,2.8781754151009427],[2.8781754151009427,2.8781754151009427,2.8781754151009427],[2.8781754151009427,2.8781754151009427,2.8781754151009427]]]

Actual:   [[[2.7968, 2.8782, 2.8782], [2.8782, 2.8782, 2.8782], [2.8782, 2.8782, 2.8782]]]

Expected: [[[2.7968, 2.8782, 2.8782], [2.8782, 2.8782, 2.8782], [2.8782, 2.8782, 2.8782]]]