import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub18807 = tf.keras.layers.Input(shape=([2, 3, 2]))
in1Sub18807 = tf.keras.layers.Input(shape=([2, 3, 2]))
in0Con86087 = tf.keras.layers.Input(shape=([1, 1]))
in0Con36981 = tf.keras.layers.Input(shape=([2, 5]))

Sub18807 = keras.layers.Subtract(name = 'Sub18807', )([in0Sub18807,in1Sub18807])
Res41555 = keras.layers.Reshape((2, 6), name = 'Res41555', )(Sub18807)
Con86087 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con86087', )(in0Con86087)
Den86889 = keras.layers.Dense(1,name = 'Den86889', )(Con86087)
Zer54068 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer54068', )(Den86889)
Con36981 = keras.layers.Concatenate(axis=2, name = 'Con36981', )([Zer54068,in0Con36981])
Add30583 = keras.layers.Add(name = 'Add30583', )([Res41555,Con36981])
model = tf.keras.models.Model(inputs=[in0Sub18807,in1Sub18807,in0Con86087,in0Con36981], outputs=Add30583)
w = model.get_layer('Con86087').get_weights() 
w[0] = np.array([[[0.0325, 0.8467, 0.444, 0.2812]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con86087').set_weights(w) 
w = model.get_layer('Den86889').get_weights() 
w[0] = np.array([[0.3906], [0.8993], [0.9678], [0.4584]])
w[1] = np.array([0.5698])
model.get_layer('Den86889').set_weights(w) 
in0Sub18807 = tf.constant([[[[0.25, 0.2401], [0.3494, 0.2638], [0.2995, 0.8611]], [[0.3086, 0.1616], [0.4893, 0.0174], [0.1936, 0.3469]]]])
in1Sub18807 = tf.constant([[[[0.3338, 0.4712], [0.0918, 0.9018], [0.1115, 0.8707]], [[0.2877, 0.2715], [0.5061, 0.9432], [0.2516, 0.0655]]]])
in0Con86087 = tf.constant([[[0.4653]]])
in0Con36981 = tf.constant([[[0.1224, 0.5866, 0.1527, 0.6239, 0.3152], [0.0615, 0.8643, 0.531, 0.6189, 0.5554]]])
print (np.array2string(model.predict([in0Sub18807,in1Sub18807,in0Con86087,in0Con36981],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add30583.png')

LSub18807 = subtract_layer([[[[0.25, 0.2401], [0.3494, 0.2638], [0.2995, 0.8611]], [[0.3086, 0.1616], [0.4893, 0.0174], [0.1936, 0.3469]]]], [[[[0.3338, 0.4712], [0.0918, 0.9018], [0.1115, 0.8707]], [[0.2877, 0.2715], [0.5061, 0.9432], [0.2516, 0.0655]]]], Sub18807), 
LRes41555 = reshape_layer(Sub18807, [2, 6], Res41555), 
LCon86087 = conv1D_layer([[[0.4653]]], 1,[[[0.0325, 0.8467, 0.444, 0.2812]]],[0, 0, 0, 0], 1, false, 1, Con86087), 
LDen86889 = dense_layer(Con86087, [[0.3906], [0.8993], [0.9678], [0.4584]],[0.5698], Den86889), 
LZer54068 = zero_padding1D_layer(Den86889, 1, 0, Zer54068), 
LCon36981 = concatenate_layer([Zer54068,[[[0.1224, 0.5866, 0.1527, 0.6239, 0.3152], [0.0615, 0.8643, 0.531, 0.6189, 0.5554]]]], 2, Con36981), 
LAdd30583 = add_layer([Res41555,Con36981], Add30583), 
exec_layers([LSub18807,LRes41555,LCon86087,LDen86889,LZer54068,LCon36981,LAdd30583],["Sub18807","Res41555","Con86087","Den86889","Zer54068","Con36981","Add30583"],Add30583,"Add30583")

Actual (Unparsed): [[[-0.0838000, -0.1087000, 0.8442000, -0.4853000, 0.8119000, 0.3056000], [1.2108226, -0.0484000, 0.8475000, -0.3948000, 0.5609000, 0.8368000]]]

Expected (Unparsed): [[[-0.08379999999999999,-0.1087,0.8442000000000001,-0.4853000000000001,0.8119000000000001,0.3055999999999999],[1.210822567977,-0.048400000000000026,0.8474999999999999,-0.39480000000000004,0.5609,0.8368]]]

Actual:   [[[-0.0838, -0.1087, 0.8442, -0.4853, 0.8119, 0.3056], [1.2109, -0.0484, 0.8475, -0.3948, 0.5609, 0.8368]]]

Expected: [[[-0.0837, -0.1087, 0.8443, -0.4853, 0.812, 0.3056], [1.2109, -0.0484, 0.8475, -0.3948, 0.5609, 0.8368]]]