import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub30289 = tf.keras.layers.Input(shape=([3, 2, 2, 2]))
in1Sub30289 = tf.keras.layers.Input(shape=([3, 2, 2, 2]))

Sub30289 = keras.layers.Subtract(name = 'Sub30289', )([in0Sub30289,in1Sub30289])
Res34891 = keras.layers.Reshape((3, 2, 4), name = 'Res34891', )(Sub30289)
Con7751 = keras.layers.Conv2DTranspose(3, (2, 2),strides=(1, 1), padding='same', name = 'Con7751', )(Res34891)
Thr85368 = keras.layers.ThresholdedReLU(theta=7.669983817463953, name = 'Thr85368', )(Con7751)
model = tf.keras.models.Model(inputs=[in0Sub30289,in1Sub30289], outputs=Thr85368)
w = model.get_layer('Con7751').get_weights() 
w[0] = np.array([[[[0.3636, 0.4961, 0.6433, 0.3473], [0.6114, 0.1323, 0.5228, 0.7006], [0.4048, 0.7098, 0.9254, 0.8519]], [[0.034, 0.7926, 0.361, 0.0809], [0.232, 0.6381, 0.389, 0.2256], [0.428, 0.0981, 0.5001, 0.7411]]], [[[0.8224, 0.5464, 0.9859, 0.6318], [0.2868, 0.926, 0.3698, 0.5321], [0.245, 0.1996, 0.2656, 0.171]], [[0.3692, 0.4549, 0.8522, 0.6849], [0.1378, 0.6683, 0.5016, 0.7661], [0.0464, 0.6622, 0.4852, 0.4259]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con7751').set_weights(w) 
in0Sub30289 = tf.constant([[[[[0.2907, 0.3923], [0.8149, 0.306]], [[0.0731, 0.9352], [0.7703, 0.254]]], [[[0.2129, 0.1168], [0.7577, 0.8935]], [[0.9681, 0.9491], [0.4024, 0.4825]]], [[[0.5378, 0.1091], [0.4895, 0.2729]], [[0.9801, 0.9267], [0.5602, 0.3608]]]]])
in1Sub30289 = tf.constant([[[[[0.7205, 0.9366], [0.1631, 0.2558]], [[0.7401, 0.856], [0.0878, 0.3567]]], [[[0.7072, 0.5041], [0.5994, 0.3075]], [[0.7671, 0.3557], [0.1587, 0.0301]]], [[[0.4434, 0.1366], [0.3672, 0.0834]], [[0.1189, 0.1104], [0.9056, 0.8806]]]]])
print (np.array2string(model.predict([in0Sub30289,in1Sub30289],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr85368.png')

LSub30289 = subtract_layer([[[[[0.2907, 0.3923], [0.8149, 0.306]], [[0.0731, 0.9352], [0.7703, 0.254]]], [[[0.2129, 0.1168], [0.7577, 0.8935]], [[0.9681, 0.9491], [0.4024, 0.4825]]], [[[0.5378, 0.1091], [0.4895, 0.2729]], [[0.9801, 0.9267], [0.5602, 0.3608]]]]], [[[[[0.7205, 0.9366], [0.1631, 0.2558]], [[0.7401, 0.856], [0.0878, 0.3567]]], [[[0.7072, 0.5041], [0.5994, 0.3075]], [[0.7671, 0.3557], [0.1587, 0.0301]]], [[[0.4434, 0.1366], [0.3672, 0.0834]], [[0.1189, 0.1104], [0.9056, 0.8806]]]]], Sub30289), 
LRes34891 = reshape_layer(Sub30289, [3, 2, 4], Res34891), 
LCon7751 = conv2D_transpose_layer(Res34891, 2, 2,[[[[0.3636, 0.4961, 0.6433, 0.3473], [0.6114, 0.1323, 0.5228, 0.7006], [0.4048, 0.7098, 0.9254, 0.8519]], [[0.034, 0.7926, 0.361, 0.0809], [0.232, 0.6381, 0.389, 0.2256], [0.428, 0.0981, 0.5001, 0.7411]]], [[[0.8224, 0.5464, 0.9859, 0.6318], [0.2868, 0.926, 0.3698, 0.5321], [0.245, 0.1996, 0.2656, 0.171]], [[0.3692, 0.4549, 0.8522, 0.6849], [0.1378, 0.6683, 0.5016, 0.7661], [0.0464, 0.6622, 0.4852, 0.4259]]]],[0, 0, 0], 1, 1, true, Con7751), 
LThr85368 = thresholded_relu_layer(Con7751, 7.669983817463953, Thr85368), 
exec_layers([LSub30289,LRes34891,LCon7751,LThr85368],["Sub30289","Res34891","Con7751","Thr85368"],Thr85368,"Thr85368")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000], [-0.0000000, -0.0000000, 0.0000000]], [[-0.0000000, -0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]]

Actual:   [[[[0, 0, 0], [-0, -0, 0]], [[-0, -0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0]]]]

Expected: [[[[0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0]]]]