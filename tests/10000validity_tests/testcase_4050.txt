import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul87633 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Mul87633 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Mul87633 = keras.layers.Multiply(name = 'Mul87633', )([in0Mul87633,in1Mul87633])
Res52625 = keras.layers.Reshape((2, 1, 2), name = 'Res52625', )(Mul87633)
Res23443 = keras.layers.Reshape((2, 2), name = 'Res23443', )(Res52625)
Con98551 = keras.layers.Conv1D(3, (2),strides=(1), padding='same', dilation_rate=(1), name = 'Con98551', )(Res23443)
model = tf.keras.models.Model(inputs=[in0Mul87633,in1Mul87633], outputs=Con98551)
w = model.get_layer('Con98551').get_weights() 
w[0] = np.array([[[0.5201, 0.7566, 0.7597], [0.3192, 0.8842, 0.3274]], [[0.5306, 0.1205, 0.3399], [0.2275, 0.4699, 0.0699]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con98551').set_weights(w) 
in0Mul87633 = tf.constant([[[[[0.7741], [0.5901]]], [[[0.6276], [0.1483]]]]])
in1Mul87633 = tf.constant([[[[[0.3348], [0.6981]]], [[[0.1487], [0.0728]]]]])
print (np.array2string(model.predict([in0Mul87633,in1Mul87633],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con98551.png')

LMul87633 = multiply_layer([[[[[[0.7741], [0.5901]]], [[[0.6276], [0.1483]]]]], [[[[[0.3348], [0.6981]]], [[[0.1487], [0.0728]]]]]], Mul87633), 
LRes52625 = reshape_layer(Mul87633, [2, 1, 2], Res52625), 
LRes23443 = reshape_layer(Res52625, [2, 2], Res23443), 
LCon98551 = conv1D_layer(Res23443, 2,[[[0.5201, 0.7566, 0.7597], [0.3192, 0.8842, 0.3274]], [[0.5306, 0.1205, 0.3399], [0.2275, 0.4699, 0.0699]]],[0, 0, 0], 1, true, 1, Con98551), 
exec_layers([LMul87633,LRes52625,LRes23443,LCon98551],["Mul87633","Res52625","Res23443","Con98551"],Con98551,"Con98551")

Actual (Unparsed): [[[0.3182616, 0.5766509, 0.3642380], [0.0519840, 0.0801551, 0.0744330]]]

Expected (Unparsed): [[[0.318261613292,0.5766508707260001,0.364238012154],[0.05198403462,0.08015506460000002,0.07443302294000001]]]

Actual:   [[[0.3183, 0.5767, 0.3643], [0.052, 0.0802, 0.0745]]]

Expected: [[[0.3183, 0.5767, 0.3643], [0.052, 0.0802, 0.0745]]]