import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max35949 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max35949 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con36561 = tf.keras.layers.Input(shape=([1, 3]))
in0PRe76111 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con44864 = tf.keras.layers.Input(shape=([1, 2]))
in0Up_34833 = tf.keras.layers.Input(shape=([1, 4]))
in0Con69805 = tf.keras.layers.Input(shape=([4, 7, 1]))
in0Mul46639 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Mul46639 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Max35949 = keras.layers.Maximum(name = 'Max35949', )([in0Max35949,in1Max35949])
Sof68132 = keras.layers.Softmax(axis=1, name = 'Sof68132', )(Max35949)
Res34329 = keras.layers.Reshape((1, 1), name = 'Res34329', )(Sof68132)
Con36561 = keras.layers.Concatenate(axis=2, name = 'Con36561', )([Res34329,in0Con36561])
PRe76111 = keras.layers.PReLU(name = 'PRe76111', input_shape=(1, 1, 1, 2))(in0PRe76111)
Res10171 = keras.layers.Reshape((1, 1, 2), name = 'Res10171', )(PRe76111)
Res47122 = keras.layers.Reshape((1, 2), name = 'Res47122', )(Res10171)
Con44864 = keras.layers.Concatenate(axis=2, name = 'Con44864', )([Res47122,in0Con44864])
Up_34833 = keras.layers.UpSampling1D(size=(1), name = 'Up_34833', )(in0Up_34833)
Max47592 = keras.layers.Maximum(name = 'Max47592', )([Con44864,Up_34833])
Mul54122 = keras.layers.Multiply(name = 'Mul54122', )([Con36561,Max47592])
Res83325 = keras.layers.Reshape((1, 4, 1), name = 'Res83325', )(Mul54122)
Zer91611 = keras.layers.ZeroPadding2D(padding=((3, 0), (3, 0)), name = 'Zer91611', )(Res83325)
Con69805 = keras.layers.Concatenate(axis=3, name = 'Con69805', )([Zer91611,in0Con69805])
Mul46639 = keras.layers.Multiply(name = 'Mul46639', )([in0Mul46639,in1Mul46639])
Res50750 = keras.layers.Reshape((2, 2, 1), name = 'Res50750', )(Mul46639)
Zer84069 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer84069', )(Res50750)
Loc34564 = keras.layers.LocallyConnected2D(2, (1, 4),strides=(1, 1), name = 'Loc34564', )(Zer84069)
Zer21061 = keras.layers.ZeroPadding2D(padding=((0, 0), (6, 0)), name = 'Zer21061', )(Loc34564)
Add87192 = keras.layers.Add(name = 'Add87192', )([Con69805,Zer21061])
model = tf.keras.models.Model(inputs=[in0Max35949,in1Max35949,in0Con36561,in0PRe76111,in0Con44864,in0Up_34833,in0Con69805,in0Mul46639,in1Mul46639], outputs=Add87192)
w = model.get_layer('PRe76111').get_weights() 
w[0] = np.array([[[[0.0478, 0.9254]]]])
model.get_layer('PRe76111').set_weights(w) 
w = model.get_layer('Loc34564').get_weights() 
w[0] = np.array([[[0.2184, 0.2767], [0.1374, 0.2351], [0.5992, 0.2484], [0.5903, 0.2544]], [[0.1861, 0.672], [0.1782, 0.2623], [0.3566, 0.1741], [0.0247, 0.6928]], [[0.2432, 0.2032], [0.7688, 0.8666], [0.1269, 0.2892], [0.4956, 0.7646]], [[0.3087, 0.338], [0.7375, 0.2191], [0.5166, 0.8436], [0.2276, 0.9253]]])
w[1] = np.array([[[0, 0]], [[0, 0]], [[0, 0]], [[0, 0]]])
model.get_layer('Loc34564').set_weights(w) 
in0Max35949 = tf.constant([[[[0.095]]]])
in1Max35949 = tf.constant([[[[0.5583]]]])
in0Con36561 = tf.constant([[[0.3809, 0.8908, 0.3585]]])
in0PRe76111 = tf.constant([[[[[0.8127, 0.6342]]]]])
in0Con44864 = tf.constant([[[0.4744, 0.0634]]])
in0Up_34833 = tf.constant([[[1.9663, 1.2748, 1.1444, 1.166]]])
in0Con69805 = tf.constant([[[[0.0068], [0.9593], [0.1704], [0.1954], [0.0994], [0.5786], [0.3534]], [[0.3366], [0.4437], [0.3901], [0.8237], [0.6825], [0.6255], [0.0796]], [[0.4947], [0.0851], [0.2896], [0.0536], [0.5648], [0.7391], [0.1238]], [[0.1465], [0.3011], [0.4158], [0.4068], [0.2799], [0.137], [0.8084]]]])
in0Mul46639 = tf.constant([[[[[0.5127]], [[0.1296]]], [[[0.0403]], [[0.9897]]]]])
in1Mul46639 = tf.constant([[[[[0.3486]], [[0.9874]]], [[[0.8917]], [[0.9058]]]]])
print (np.array2string(model.predict([in0Max35949,in1Max35949,in0Con36561,in0PRe76111,in0Con44864,in0Up_34833,in0Con69805,in0Mul46639,in1Mul46639],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add87192.png')

LMax35949 = maximum_layer([[[[[0.095]]]], [[[[0.5583]]]]], Max35949), 
LSof68132 = softmax_layer(Max35949, 1, Sof68132), 
LRes34329 = reshape_layer(Sof68132, [1, 1], Res34329), 
LCon36561 = concatenate_layer([Res34329,[[[0.3809, 0.8908, 0.3585]]]], 2, Con36561), 
LPRe76111 = prelu_layer([[[[[0.8127, 0.6342]]]]], [[[[0.0478, 0.9254]]]], PRe76111), 
LRes10171 = reshape_layer(PRe76111, [1, 1, 2], Res10171), 
LRes47122 = reshape_layer(Res10171, [1, 2], Res47122), 
LCon44864 = concatenate_layer([Res47122,[[[0.4744, 0.0634]]]], 2, Con44864), 
LUp_34833 = up_sampling1D_layer([[[1.9663, 1.2748, 1.1444, 1.166]]], 1, Up_34833), 
LMax47592 = maximum_layer([Con44864,Up_34833], Max47592), 
LMul54122 = multiply_layer([Con36561,Max47592], Mul54122), 
LRes83325 = reshape_layer(Mul54122, [1, 4, 1], Res83325), 
LZer91611 = zero_padding2D_layer(Res83325, 3, 0, 3, 0, Zer91611), 
LCon69805 = concatenate_layer([Zer91611,[[[[0.0068], [0.9593], [0.1704], [0.1954], [0.0994], [0.5786], [0.3534]], [[0.3366], [0.4437], [0.3901], [0.8237], [0.6825], [0.6255], [0.0796]], [[0.4947], [0.0851], [0.2896], [0.0536], [0.5648], [0.7391], [0.1238]], [[0.1465], [0.3011], [0.4158], [0.4068], [0.2799], [0.137], [0.8084]]]]], 3, Con69805), 
LMul46639 = multiply_layer([[[[[[0.5127]], [[0.1296]]], [[[0.0403]], [[0.9897]]]]], [[[[[0.3486]], [[0.9874]]], [[[0.8917]], [[0.9058]]]]]], Mul46639), 
LRes50750 = reshape_layer(Mul46639, [2, 2, 1], Res50750), 
LZer84069 = zero_padding2D_layer(Res50750, 1, 1, 1, 1, Zer84069), 
LLoc34564 = locally_connected2D_layer(Zer84069, 1, 4,[[[0.2184, 0.2767], [0.1374, 0.2351], [0.5992, 0.2484], [0.5903, 0.2544]], [[0.1861, 0.672], [0.1782, 0.2623], [0.3566, 0.1741], [0.0247, 0.6928]], [[0.2432, 0.2032], [0.7688, 0.8666], [0.1269, 0.2892], [0.4956, 0.7646]], [[0.3087, 0.338], [0.7375, 0.2191], [0.5166, 0.8436], [0.2276, 0.9253]]],[[[0, 0]], [[0, 0]], [[0, 0]], [[0, 0]]], 1, 1, Loc34564), 
LZer21061 = zero_padding2D_layer(Loc34564, 0, 0, 6, 0, Zer21061), 
LAdd87192 = add_layer([Con69805,Zer21061], Add87192), 
exec_layers([LMax35949,LSof68132,LRes34329,LCon36561,LPRe76111,LRes10171,LRes47122,LCon44864,LUp_34833,LMax47592,LMul54122,LRes83325,LZer91611,LCon69805,LMul46639,LRes50750,LZer84069,LLoc34564,LZer21061,LAdd87192],["Max35949","Sof68132","Res34329","Con36561","PRe76111","Res10171","Res47122","Con44864","Up_34833","Max47592","Mul54122","Res83325","Zer91611","Con69805","Mul46639","Res50750","Zer84069","Loc34564","Zer21061","Add87192"],Add87192,"Add87192")

Actual (Unparsed): [[[[0.0000000, 0.0068000], [0.0000000, 0.9593000], [0.0000000, 0.1704000], [0.0000000, 0.1954000], [0.0000000, 0.0994000], [0.0000000, 0.5786000], [0.0000000, 0.3534000]], [[0.0000000, 0.3366000], [0.0000000, 0.4437000], [0.0000000, 0.3901000], [0.0000000, 0.8237000], [0.0000000, 0.6825000], [0.0000000, 0.6255000], [0.0774822, 0.1487592]], [[0.0000000, 0.4947000], [0.0000000, 0.0851000], [0.0000000, 0.2896000], [0.0000000, 0.0536000], [0.0000000, 0.5648000], [0.0000000, 0.7391000], [0.1413893, 0.4142009]], [[0.0000000, 0.1465000], [0.0000000, 0.3011000], [0.0000000, 0.4158000], [1.9663000, 0.4068000], [0.4855713, 0.2799000], [1.0194315, 0.1370000], [0.4180110, 0.8084000]]]]

Expected (Unparsed): [[[[0,0.0068],[0,0.9593],[0,0.1704],[0,0.1954],[0,0.0994],[0,0.5786],[0.0,0.3534]],[[0,0.3366],[0,0.4437],[0,0.3901],[0,0.8237],[0,0.6825],[0,0.6255],[0.077482237068,0.14875921146999999]],[[0,0.4947],[0,0.0851],[0,0.2896],[0,0.0536],[0,0.5648],[0,0.7391],[0.14138929608200002,0.41420091215800003]],[[0,0.1465],[0,0.3011],[0,0.4158],[1.9663,0.4068],[0.48557132,0.2799],[1.0194315200000001,0.137],[0.41801099999999997,0.8084]]]]

Actual:   [[[[0, 0.0068], [0, 0.9593], [0, 0.1704], [0, 0.1954], [0, 0.0994], [0, 0.5786], [0, 0.3534]], [[0, 0.3366], [0, 0.4437], [0, 0.3901], [0, 0.8237], [0, 0.6825], [0, 0.6255], [0.0775, 0.1488]], [[0, 0.4947], [0, 0.0851], [0, 0.2896], [0, 0.0536], [0, 0.5648], [0, 0.7391], [0.1414, 0.4143]], [[0, 0.1465], [0, 0.3011], [0, 0.4158], [1.9663, 0.4068], [0.4856, 0.2799], [1.0195, 0.137], [0.4181, 0.8084]]]]

Expected: [[[[0, 0.0068], [0, 0.9593], [0, 0.1704], [0, 0.1954], [0, 0.0994], [0, 0.5786], [0, 0.3534]], [[0, 0.3366], [0, 0.4437], [0, 0.3901], [0, 0.8237], [0, 0.6825], [0, 0.6255], [0.0775, 0.1488]], [[0, 0.4947], [0, 0.0851], [0, 0.2896], [0, 0.0536], [0, 0.5648], [0, 0.7391], [0.1414, 0.4143]], [[0, 0.1465], [0, 0.3011], [0, 0.4158], [1.9663, 0.4068], [0.4856, 0.2799], [1.0195, 0.137], [0.4181, 0.8084]]]]