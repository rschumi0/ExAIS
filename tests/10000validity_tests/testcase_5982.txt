import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul54341 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul54341 = tf.keras.layers.Input(shape=([2, 2, 2]))

Mul54341 = keras.layers.Multiply(name = 'Mul54341', )([in0Mul54341,in1Mul54341])
Res35756 = keras.layers.Reshape((2, 4), name = 'Res35756', )(Mul54341)
Zer36584 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer36584', )(Res35756)
Sep22718 = keras.layers.SeparableConv1D(4, (3),strides=(2), padding='same', name = 'Sep22718', )(Zer36584)
model = tf.keras.models.Model(inputs=[in0Mul54341,in1Mul54341], outputs=Sep22718)
w = model.get_layer('Sep22718').get_weights() 
w[0] = np.array([[[0.8076], [0.4345], [0.987], [0.3968]], [[0.1439], [0.1136], [0.4044], [0.22]], [[0.7202], [0.1085], [0.3613], [0.3389]]])
w[1] = np.array([[[0.8599, 0.9996, 0.64, 0.5986], [0.0812, 0.1012, 0.5518, 0.1742], [0.1299, 0.7798, 0.1499, 0.471], [0.3927, 0.6784, 0.9284, 0.1042]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep22718').set_weights(w) 
in0Mul54341 = tf.constant([[[[0.6283, 0.9397], [0.752, 0.4713]], [[0.2025, 0.4386], [0.2146, 0.2063]]]])
in1Mul54341 = tf.constant([[[[0.1249, 0.5881], [0.3258, 0.7692]], [[0.1378, 0.138], [0.4823, 0.534]]]])
print (np.array2string(model.predict([in0Mul54341,in1Mul54341],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep22718.png')

LMul54341 = multiply_layer([[[[[0.6283, 0.9397], [0.752, 0.4713]], [[0.2025, 0.4386], [0.2146, 0.2063]]]], [[[[0.1249, 0.5881], [0.3258, 0.7692]], [[0.1378, 0.138], [0.4823, 0.534]]]]], Mul54341), 
LRes35756 = reshape_layer(Mul54341, [2, 4], Res35756), 
LZer36584 = zero_padding1D_layer(Res35756, 1, 1, Zer36584), 
LSep22718 = separable_conv1D_layer(Zer36584, 3,[[[[0.8076], [0.4345], [0.987], [0.3968]], [[0.1439], [0.1136], [0.4044], [0.22]], [[0.7202], [0.1085], [0.3613], [0.3389]]],[[[0.8599, 0.9996, 0.64, 0.5986], [0.0812, 0.1012, 0.5518, 0.1742], [0.1299, 0.7798, 0.1499, 0.471], [0.3927, 0.6784, 0.9284, 0.1042]]]],[0, 0, 0, 0], 2, true, Sep22718), 
exec_layers([LMul54341,LRes35756,LZer36584,LSep22718],["Mul54341","Res35756","Zer36584","Sep22718"],Sep22718,"Sep22718")

Actual (Unparsed): [[[0.0963318, 0.2242507, 0.1875184, 0.1073498], [0.0519501, 0.1345044, 0.0848310, 0.0707415]]]

Expected (Unparsed): [[[0.09633179383144769,0.2242507098691504,0.1875184231792562,0.10734977476363018],[0.051950124405666,0.134504407284252,0.08483104753483801,0.070741536726252]]]

Actual:   [[[0.0964, 0.2243, 0.1876, 0.1074], [0.052, 0.1346, 0.0849, 0.0708]]]

Expected: [[[0.0964, 0.2243, 0.1876, 0.1074], [0.052, 0.1346, 0.0849, 0.0708]]]