import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof40102 = tf.keras.layers.Input(shape=([1, 2]))

Sof40102 = keras.layers.Softmax(axis=1, name = 'Sof40102', input_shape=(1, 2))(in0Sof40102)
Res31976 = keras.layers.Reshape((1, 2, 1), name = 'Res31976', )(Sof40102)
PRe50072 = keras.layers.PReLU(name = 'PRe50072', )(Res31976)
Glo73605 = keras.layers.GlobalAveragePooling2D(name = 'Glo73605', )(PRe50072)
Res45484 = keras.layers.Reshape((1, 1), name = 'Res45484', )(Glo73605)
Res77082 = keras.layers.Reshape((1, 1, 1), name = 'Res77082', )(Res45484)
Sep33949 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep33949', )(Res77082)
model = tf.keras.models.Model(inputs=[in0Sof40102], outputs=Sep33949)
w = model.get_layer('PRe50072').get_weights() 
w[0] = np.array([[[0.6616], [0.6943]]])
model.get_layer('PRe50072').set_weights(w) 
w = model.get_layer('Sep33949').get_weights() 
w[0] = np.array([[[[0.9847]]]])
w[1] = np.array([[[[0.1584, 0.2908]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep33949').set_weights(w) 
in0Sof40102 = tf.constant([[[0.5874, 0.7404]]])
print (np.array2string(model.predict([in0Sof40102],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep33949.png')

LSof40102 = softmax_layer([[[0.5874, 0.7404]]], 1, Sof40102), 
LRes31976 = reshape_layer(Sof40102, [1, 2, 1], Res31976), 
LPRe50072 = prelu_layer(Res31976, [[[0.6616], [0.6943]]], PRe50072), 
LGlo73605 = global_average_pooling2D_layer(PRe50072, Glo73605), 
LRes45484 = reshape_layer(Glo73605, [1, 1], Res45484), 
LRes77082 = reshape_layer(Res45484, [1, 1, 1], Res77082), 
LSep33949 = separable_conv2D_layer(Res77082, 1, 1,[[[[[0.9847]]]],[[[[0.1584, 0.2908]]]]],[0, 0], 1, 1, false, Sep33949), 
exec_layers([LSof40102,LRes31976,LPRe50072,LGlo73605,LRes45484,LRes77082,LSep33949],["Sof40102","Res31976","PRe50072","Glo73605","Res45484","Res77082","Sep33949"],Sep33949,"Sep33949")

Actual (Unparsed): [[[[0.1559765, 0.2863508]]]]

Expected (Unparsed): [[[[0.15597648000000003,0.28635076]]]]

Actual:   [[[[0.156, 0.2864]]]]

Expected: [[[[0.156, 0.2864]]]]