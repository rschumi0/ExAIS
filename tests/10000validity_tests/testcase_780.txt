import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep11354 = tf.keras.layers.Input(shape=([1, 1]))
in0Con94245 = tf.keras.layers.Input(shape=([2, 4, 15]))
in0Up_64973 = tf.keras.layers.Input(shape=([1, 2, 4, 2]))
in0Ave727 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave727 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con99020 = tf.keras.layers.Input(shape=([2, 4, 15]))

Sep11354 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep11354', )(in0Sep11354)
Res52572 = keras.layers.Reshape((1, 3, 1), name = 'Res52572', )(Sep11354)
Zer88139 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer88139', )(Res52572)
Con94245 = keras.layers.Concatenate(axis=3, name = 'Con94245', )([Zer88139,in0Con94245])
Up_64973 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_64973', )(in0Up_64973)
Res52659 = keras.layers.Reshape((1, 2, 16), name = 'Res52659', )(Up_64973)
Up_9960 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_9960', )(Res52659)
Mul38612 = keras.layers.Multiply(name = 'Mul38612', )([Con94245,Up_9960])
Ave727 = keras.layers.Average(name = 'Ave727', )([in0Ave727,in1Ave727])
Zer60886 = keras.layers.ZeroPadding2D(padding=((1, 0), (3, 0)), name = 'Zer60886', )(Ave727)
Con99020 = keras.layers.Concatenate(axis=3, name = 'Con99020', )([Zer60886,in0Con99020])
Ave87499 = keras.layers.Average(name = 'Ave87499', )([Mul38612,Con99020])
model = tf.keras.models.Model(inputs=[in0Sep11354,in0Con94245,in0Up_64973,in0Ave727,in1Ave727,in0Con99020], outputs=Ave87499)
w = model.get_layer('Sep11354').get_weights() 
w[0] = np.array([[[0.0248]]])
w[1] = np.array([[[0.5472, 0.1967, 0.7808]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep11354').set_weights(w) 
in0Sep11354 = tf.constant([[[0.0509]]])
in0Con94245 = tf.constant([[[[0.7371, 0.4985, 0.9367, 0.9144, 0.5133, 0.3845, 0.0403, 0.2817, 0.618, 0.0686, 0.1646, 0.4095, 0.941, 0.7504, 0.5623], [0.2016, 0.2759, 0.5299, 0.8263, 0.3768, 0.2785, 0.1688, 0.9298, 0.0947, 0.0629, 0.5879, 0.1379, 0.8995, 0.8886, 0.0837], [0.2056, 0.3729, 0.1076, 0.9112, 0.1994, 0.8729, 0.9138, 0.4449, 0.3521, 0.1346, 0.4616, 0.6068, 0.5937, 0.3084, 0.6109], [0.6262, 0.7889, 0.2193, 0.891, 0.4854, 0.253, 0.2462, 0.2769, 0.5969, 0.8229, 0.24, 0.0214, 0.3548, 0.6119, 0.3257]], [[0.1006, 0.2104, 0.5922, 0.2676, 0.7906, 0.8312, 0.3175, 0.3153, 0.5202, 0.7215, 0.4217, 0.0938, 0.4193, 0.4046, 0.0149], [0.1528, 0.9197, 0.8981, 0.7312, 0.2487, 0.354, 0.749, 0.9789, 0.2961, 0.7463, 0.3382, 0.8949, 0.1976, 0.8915, 0.5127], [0.6096, 0.4356, 0.38, 0.8571, 0.692, 0.3944, 0.4397, 0.0803, 0.0639, 0.8695, 0.3389, 0.0571, 0.2473, 0.1159, 0.6243], [0.0415, 0.5403, 0.0913, 0.6499, 0.4441, 0.6038, 0.2538, 0.6957, 0.3579, 0.9877, 0.3928, 0.47, 0.7029, 0.3219, 0.4895]]]])
in0Up_64973 = tf.constant([[[[[1.953, 1.9925], [1.0986, 1.9562], [1.4904, 1.1654], [1.5786, 1.9868]], [[1.6021, 1.4518], [1.9477, 1.7051], [1.3949, 1.4681], [1.1294, 1.4996]]]]])
in0Ave727 = tf.constant([[[[0.6975]]]])
in1Ave727 = tf.constant([[[[0.3933]]]])
in0Con99020 = tf.constant([[[[0.2827, 0.3964, 0.8676, 0.3189, 0.8179, 0.4482, 0.5961, 0.7714, 0.6947, 0.825, 0.8226, 0.4295, 0.9861, 0.0711, 0.5902], [0.3852, 0.2497, 0.0933, 0.5959, 0.0165, 0.13, 0.0296, 0.4736, 0.9543, 0.0095, 0.9275, 0.3996, 0.0501, 0.2834, 0.536], [0.2642, 0.8824, 0.2074, 0.0795, 0.7254, 0.7294, 0.2924, 0.3572, 0.6934, 0.7429, 0.907, 0.8912, 0.182, 0.2618, 0.0895], [0.1319, 0.0074, 0.821, 0.5665, 0.9236, 0.5145, 0.4304, 0.6311, 0.5284, 0.3673, 0.1262, 0.8399, 0.5159, 0.4529, 0.6278]], [[0.4577, 0.7325, 0.1185, 0.1777, 0.1975, 0.3863, 0.2826, 0.2799, 0.0832, 0.0026, 0.4487, 0.1117, 0.1979, 0.6387, 0.2815], [0.8367, 0.6692, 0.2807, 0.2036, 0.912, 0.4925, 0.7878, 0.4196, 0.756, 0.6935, 0.0981, 0.8803, 0.815, 0.8957, 0.6667], [0.9638, 0.1549, 0.5674, 0.2632, 0.0678, 0.1896, 0.1025, 0.3302, 0.8837, 0.0554, 0.4112, 0.0704, 0.8541, 0.4425, 0.8852], [0.3163, 0.2025, 0.4001, 0.4426, 0.0178, 0.9693, 0.7505, 0.8512, 0.8794, 0.6872, 0.263, 0.6876, 0.2728, 0.685, 0.6694]]]])
print (np.array2string(model.predict([in0Sep11354,in0Con94245,in0Up_64973,in0Ave727,in1Ave727,in0Con99020],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave87499.png')

LSep11354 = separable_conv1D_layer([[[0.0509]]], 1,[[[[0.0248]]],[[[0.5472, 0.1967, 0.7808]]]],[0, 0, 0], 1, false, Sep11354), 
LRes52572 = reshape_layer(Sep11354, [1, 3, 1], Res52572), 
LZer88139 = zero_padding2D_layer(Res52572, 1, 0, 1, 0, Zer88139), 
LCon94245 = concatenate_layer([Zer88139,[[[[0.7371, 0.4985, 0.9367, 0.9144, 0.5133, 0.3845, 0.0403, 0.2817, 0.618, 0.0686, 0.1646, 0.4095, 0.941, 0.7504, 0.5623], [0.2016, 0.2759, 0.5299, 0.8263, 0.3768, 0.2785, 0.1688, 0.9298, 0.0947, 0.0629, 0.5879, 0.1379, 0.8995, 0.8886, 0.0837], [0.2056, 0.3729, 0.1076, 0.9112, 0.1994, 0.8729, 0.9138, 0.4449, 0.3521, 0.1346, 0.4616, 0.6068, 0.5937, 0.3084, 0.6109], [0.6262, 0.7889, 0.2193, 0.891, 0.4854, 0.253, 0.2462, 0.2769, 0.5969, 0.8229, 0.24, 0.0214, 0.3548, 0.6119, 0.3257]], [[0.1006, 0.2104, 0.5922, 0.2676, 0.7906, 0.8312, 0.3175, 0.3153, 0.5202, 0.7215, 0.4217, 0.0938, 0.4193, 0.4046, 0.0149], [0.1528, 0.9197, 0.8981, 0.7312, 0.2487, 0.354, 0.749, 0.9789, 0.2961, 0.7463, 0.3382, 0.8949, 0.1976, 0.8915, 0.5127], [0.6096, 0.4356, 0.38, 0.8571, 0.692, 0.3944, 0.4397, 0.0803, 0.0639, 0.8695, 0.3389, 0.0571, 0.2473, 0.1159, 0.6243], [0.0415, 0.5403, 0.0913, 0.6499, 0.4441, 0.6038, 0.2538, 0.6957, 0.3579, 0.9877, 0.3928, 0.47, 0.7029, 0.3219, 0.4895]]]]], 3, Con94245), 
LUp_64973 = up_sampling3D_layer([[[[[1.953, 1.9925], [1.0986, 1.9562], [1.4904, 1.1654], [1.5786, 1.9868]], [[1.6021, 1.4518], [1.9477, 1.7051], [1.3949, 1.4681], [1.1294, 1.4996]]]]], 1, 1, 2, Up_64973), 
LRes52659 = reshape_layer(Up_64973, [1, 2, 16], Res52659), 
LUp_9960 = up_sampling2D_layer(Res52659, 2, 2, Up_9960), 
LMul38612 = multiply_layer([Con94245,Up_9960], Mul38612), 
LAve727 = average_layer([[[[[0.6975]]]], [[[[0.3933]]]]], Ave727), 
LZer60886 = zero_padding2D_layer(Ave727, 1, 0, 3, 0, Zer60886), 
LCon99020 = concatenate_layer([Zer60886,[[[[0.2827, 0.3964, 0.8676, 0.3189, 0.8179, 0.4482, 0.5961, 0.7714, 0.6947, 0.825, 0.8226, 0.4295, 0.9861, 0.0711, 0.5902], [0.3852, 0.2497, 0.0933, 0.5959, 0.0165, 0.13, 0.0296, 0.4736, 0.9543, 0.0095, 0.9275, 0.3996, 0.0501, 0.2834, 0.536], [0.2642, 0.8824, 0.2074, 0.0795, 0.7254, 0.7294, 0.2924, 0.3572, 0.6934, 0.7429, 0.907, 0.8912, 0.182, 0.2618, 0.0895], [0.1319, 0.0074, 0.821, 0.5665, 0.9236, 0.5145, 0.4304, 0.6311, 0.5284, 0.3673, 0.1262, 0.8399, 0.5159, 0.4529, 0.6278]], [[0.4577, 0.7325, 0.1185, 0.1777, 0.1975, 0.3863, 0.2826, 0.2799, 0.0832, 0.0026, 0.4487, 0.1117, 0.1979, 0.6387, 0.2815], [0.8367, 0.6692, 0.2807, 0.2036, 0.912, 0.4925, 0.7878, 0.4196, 0.756, 0.6935, 0.0981, 0.8803, 0.815, 0.8957, 0.6667], [0.9638, 0.1549, 0.5674, 0.2632, 0.0678, 0.1896, 0.1025, 0.3302, 0.8837, 0.0554, 0.4112, 0.0704, 0.8541, 0.4425, 0.8852], [0.3163, 0.2025, 0.4001, 0.4426, 0.0178, 0.9693, 0.7505, 0.8512, 0.8794, 0.6872, 0.263, 0.6876, 0.2728, 0.685, 0.6694]]]]], 3, Con99020), 
LAve87499 = average_layer([Mul38612,Con99020], Ave87499), 
exec_layers([LSep11354,LRes52572,LZer88139,LCon94245,LUp_64973,LRes52659,LUp_9960,LMul38612,LAve727,LZer60886,LCon99020,LAve87499],["Sep11354","Res52572","Zer88139","Con94245","Up_64973","Res52659","Up_9960","Mul38612","Ave727","Zer60886","Con99020","Ave87499"],Ave87499,"Ave87499")

Actual (Unparsed): [[[[0.0000000, 0.8756859, 0.6849852, 1.3669873, 0.6617299, 0.9110087, 0.4353058, 0.3374674, 0.5956228, 0.7074586, 0.4636207, 0.5072124, 0.5379684, 1.4278394, 0.6278407, 0.8536888], [0.0000000, 0.3934440, 0.3942663, 0.5745629, 0.7518366, 0.3767981, 0.2179800, 0.1799033, 0.9296869, 0.5323317, 0.0516231, 0.8063193, 0.3086445, 0.9186133, 0.8430720, 0.3511476], [0.0000000, 0.2813450, 0.7399115, 0.1818068, 0.9271221, 0.5326985, 1.2147737, 0.9252602, 0.4888955, 0.6051590, 0.4653268, 0.7923375, 0.7882600, 0.5361563, 0.3050535, 0.5028028], [0.0000000, 0.5205086, 0.6356484, 0.5696899, 1.1509503, 0.8756278, 0.5036341, 0.4250978, 0.5086739, 0.7023544, 0.7575816, 0.2392720, 0.4320346, 0.5239790, 0.5719899, 0.5581099]], [[0.0000000, 0.3290728, 0.5717056, 0.6492292, 0.2358427, 0.8720359, 0.6497282, 0.4518467, 0.3749116, 0.3447206, 0.5389618, 0.4700746, 0.1298863, 0.5154826, 0.6387008, 0.1555517], [0.0006745, 0.5705770, 1.2326871, 1.0350821, 0.5034482, 0.6992535, 0.4407022, 1.1264969, 0.9392763, 0.5505375, 0.9028927, 0.2461191, 1.1464946, 0.6037958, 1.1515110, 0.8426662], [0.0001989, 0.9244086, 0.4263874, 0.5595420, 0.9662869, 0.6238646, 0.4788864, 0.4261163, 0.2211052, 0.4887558, 0.6341327, 0.4543695, 0.0674444, 0.6124755, 0.2866987, 0.9107002], [0.2734895, 0.1882749, 0.5340573, 0.2663247, 0.8542051, 0.3875175, 1.0726606, 0.5916272, 0.9108159, 0.7024165, 1.0324713, 0.4198348, 0.6092090, 0.6634344, 0.5242769, 0.7017271]]]]

Expected (Unparsed): [[[[0.0,0.875685875,0.68498525,1.366987375,0.66172992,0.91100873,0.43530585,0.33746743,0.59562284,0.7074586,0.46362072,0.50721242,0.53796835,1.4278393999999999,0.6278407199999999,0.8536888199999999],[0.0,0.393444,0.39426635,0.574562875,0.75183659,0.37679808,0.21798005,0.17990328,0.92968696,0.53233169,0.051623079999999995,0.80631933,0.30864447,0.9186133,0.8430719799999999,0.35114758],[0.0,0.28134504,0.739911545,0.18180684,0.9271221199999999,0.53269847,1.214773665,0.9252601899999999,0.488895505,0.605159005,0.46532677,0.79233748,0.78825996,0.53615626,0.30505348,0.50280282],[0.0,0.52050858,0.6356483450000001,0.5696898699999999,1.15095035,0.87562777,0.5036340499999999,0.42509781,0.508673905,0.702354445,0.7575816049999999,0.23927199999999998,0.43203458,0.52397904,0.57198993,0.5581098600000001]],[[0.0,0.32907274999999997,0.5717056,0.64922925,0.23584268000000003,0.87203586,0.64972816,0.45184674999999996,0.37491156000000003,0.34472053999999996,0.5389617999999999,0.47007459,0.12988634,0.51548262,0.63870078,0.15555165999999998],[0.000674509078656,0.570577,1.23268705,1.035082125,0.50344816,0.69925347,0.4407022,1.1264969,0.93927628,0.55053747,0.90289276,0.24611914000000001,1.14649457,0.60379584,1.15151095,0.8426661799999999],[0.00019889938846120002,0.92440864,0.42638738000000004,0.559542,0.966286835,0.6238646,0.47888643999999997,0.426116235,0.221105235,0.488755795,0.634132775,0.454369545,0.06744437,0.6124755399999999,0.28669873,0.91070014],[0.2734895304652288,0.18827485000000002,0.5340573150000001,0.26632467000000004,0.8542051150000001,0.387517455,1.0726606300000001,0.59162719,0.9108159650000001,0.702416495,1.0324713650000001,0.41983484,0.6092089999999999,0.66343442,0.5242769300000001,0.7017271]]]]

Actual:   [[[[0, 0.8757, 0.685, 1.367, 0.6618, 0.9111, 0.4354, 0.3375, 0.5957, 0.7075, 0.4637, 0.5073, 0.538, 1.4279, 0.6279, 0.8537], [0, 0.3935, 0.3943, 0.5746, 0.7519, 0.3768, 0.218, 0.18, 0.9297, 0.5324, 0.0517, 0.8064, 0.3087, 0.9187, 0.8431, 0.3512], [0, 0.2814, 0.74, 0.1819, 0.9272, 0.5327, 1.2148, 0.9253, 0.4889, 0.6052, 0.4654, 0.7924, 0.7883, 0.5362, 0.3051, 0.5029], [0, 0.5206, 0.6357, 0.5697, 1.151, 0.8757, 0.5037, 0.4251, 0.5087, 0.7024, 0.7576, 0.2393, 0.4321, 0.524, 0.572, 0.5582]], [[0, 0.3291, 0.5718, 0.6493, 0.2359, 0.8721, 0.6498, 0.4519, 0.375, 0.3448, 0.539, 0.4701, 0.1299, 0.5155, 0.6388, 0.1556], [0.0007, 0.5706, 1.2327, 1.0351, 0.5035, 0.6993, 0.4408, 1.1265, 0.9393, 0.5506, 0.9029, 0.2462, 1.1465, 0.6038, 1.1516, 0.8427], [0.0002, 0.9245, 0.4264, 0.5596, 0.9663, 0.6239, 0.4789, 0.4262, 0.2212, 0.4888, 0.6342, 0.4544, 0.0675, 0.6125, 0.2867, 0.9108], [0.2735, 0.1883, 0.5341, 0.2664, 0.8543, 0.3876, 1.0727, 0.5917, 0.9109, 0.7025, 1.0325, 0.4199, 0.6093, 0.6635, 0.5243, 0.7018]]]]

Expected: [[[[0, 0.8757, 0.685, 1.367, 0.6618, 0.9111, 0.4354, 0.3375, 0.5957, 0.7075, 0.4637, 0.5073, 0.538, 1.4279, 0.6279, 0.8537], [0, 0.3935, 0.3943, 0.5746, 0.7519, 0.3768, 0.218, 0.18, 0.9297, 0.5324, 0.0517, 0.8064, 0.3087, 0.9187, 0.8431, 0.3512], [0, 0.2814, 0.74, 0.1819, 0.9272, 0.5327, 1.2148, 0.9253, 0.4889, 0.6052, 0.4654, 0.7924, 0.7883, 0.5362, 0.3051, 0.5029], [0, 0.5206, 0.6357, 0.5697, 1.151, 0.8757, 0.5037, 0.4251, 0.5087, 0.7024, 0.7576, 0.2393, 0.4321, 0.524, 0.572, 0.5582]], [[0, 0.3291, 0.5718, 0.6493, 0.2359, 0.8721, 0.6498, 0.4519, 0.375, 0.3448, 0.539, 0.4701, 0.1299, 0.5155, 0.6388, 0.1556], [0.0007, 0.5706, 1.2327, 1.0351, 0.5035, 0.6993, 0.4408, 1.1265, 0.9393, 0.5506, 0.9029, 0.2462, 1.1465, 0.6038, 1.1516, 0.8427], [0.0002, 0.9245, 0.4264, 0.5596, 0.9663, 0.6239, 0.4789, 0.4262, 0.2212, 0.4888, 0.6342, 0.4544, 0.0675, 0.6125, 0.2867, 0.9108], [0.2735, 0.1883, 0.5341, 0.2664, 0.8543, 0.3876, 1.0727, 0.5917, 0.9109, 0.7025, 1.0325, 0.4199, 0.6093, 0.6635, 0.5243, 0.7018]]]]