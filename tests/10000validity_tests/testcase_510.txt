import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add4018 = tf.keras.layers.Input(shape=([2, 2]))
in1Add4018 = tf.keras.layers.Input(shape=([2, 2]))
in0Max73479 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Max73479 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Add4018 = keras.layers.Add(name = 'Add4018', )([in0Add4018,in1Add4018])
Res45822 = keras.layers.Reshape((2, 2, 1), name = 'Res45822', )(Add4018)
Res55546 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res55546', )(Res45822)
Max73479 = keras.layers.Maximum(name = 'Max73479', )([in0Max73479,in1Max73479])
Zer76658 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer76658', )(Max73479)
Mul50798 = keras.layers.Multiply(name = 'Mul50798', )([Res55546,Zer76658])
model = tf.keras.models.Model(inputs=[in0Add4018,in1Add4018,in0Max73479,in1Max73479], outputs=Mul50798)
in0Add4018 = tf.constant([[[0.2361, 0.1482], [0.2799, 0.3175]]])
in1Add4018 = tf.constant([[[0.3903, 0.741], [0.7549, 0.0475]]])
in0Max73479 = tf.constant([[[[[0.1066]]], [[[0.1697]]]]])
in1Max73479 = tf.constant([[[[[0.9063]]], [[[0.5341]]]]])
print (np.array2string(model.predict([in0Add4018,in1Add4018,in0Max73479,in1Max73479],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul50798.png')

LAdd4018 = add_layer([[[[0.2361, 0.1482], [0.2799, 0.3175]]], [[[0.3903, 0.741], [0.7549, 0.0475]]]], Add4018), 
LRes45822 = reshape_layer(Add4018, [2, 2, 1], Res45822), 
LRes55546 = reshape_layer(Res45822, [2, 2, 1, 1], Res55546), 
LMax73479 = maximum_layer([[[[[[0.1066]]], [[[0.1697]]]]], [[[[[0.9063]]], [[[0.5341]]]]]], Max73479), 
LZer76658 = zero_padding3D_layer(Max73479, 0, 0, 1, 0, 0, 0, Zer76658), 
LMul50798 = multiply_layer([Res55546,Zer76658], Mul50798), 
exec_layers([LAdd4018,LRes45822,LRes55546,LMax73479,LZer76658,LMul50798],["Add4018","Res45822","Res55546","Max73479","Zer76658","Mul50798"],Mul50798,"Mul50798")

Actual (Unparsed): [[[[[0.0000000]], [[0.8058820]]], [[[0.0000000]], [[0.1949465]]]]]

Expected (Unparsed): [[[[[0.0]],[[0.80588196]]],[[[0.0]],[[0.1949465]]]]]

Actual:   [[[[[0]], [[0.8059]]], [[[0]], [[0.195]]]]]

Expected: [[[[[0]], [[0.8059]]], [[[0]], [[0.195]]]]]