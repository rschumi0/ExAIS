import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con87291 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con81725 = tf.keras.layers.Input(shape=([3, 4, 1]))
in0Sub60379 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub60379 = tf.keras.layers.Input(shape=([3, 2, 2]))

Con87291 = keras.layers.Conv3D(2, (1, 1, 2),strides=(3, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con87291', )(in0Con87291)
Res96369 = keras.layers.Reshape((1, 1, 2), name = 'Res96369', )(Con87291)
Cro27026 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro27026', )(Res96369)
Zer96529 = keras.layers.ZeroPadding2D(padding=((2, 0), (3, 0)), name = 'Zer96529', )(Cro27026)
Con81725 = keras.layers.Concatenate(axis=3, name = 'Con81725', )([Zer96529,in0Con81725])
Sub60379 = keras.layers.Subtract(name = 'Sub60379', )([in0Sub60379,in1Sub60379])
Con60891 = keras.layers.Conv2D(3, (2, 1),strides=(7, 1), padding='same', dilation_rate=(1, 1), name = 'Con60891', )(Sub60379)
Zer14745 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer14745', )(Con60891)
Max34158 = keras.layers.Maximum(name = 'Max34158', )([Con81725,Zer14745])
Dep3829 = keras.layers.DepthwiseConv2D((2, 3),strides=(2, 2), padding='valid', name = 'Dep3829', )(Max34158)
model = tf.keras.models.Model(inputs=[in0Con87291,in0Con81725,in0Sub60379,in1Sub60379], outputs=Dep3829)
w = model.get_layer('Con87291').get_weights() 
w[0] = np.array([[[[[0.1483, 0.9089]], [[0.5221, 0.9662]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con87291').set_weights(w) 
w = model.get_layer('Con60891').get_weights() 
w[0] = np.array([[[[0.2883, 0.4091, 0.3966], [0.3843, 0.6683, 0.6447]]], [[[0.9987, 0.734, 0.9111], [0.7488, 0.6042, 0.6101]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con60891').set_weights(w) 
w = model.get_layer('Dep3829').get_weights() 
w[0] = np.array([[[[0.3461], [0.6845], [0.097]], [[0.8685], [0.9366], [0.4442]], [[0.0045], [0.4753], [0.2465]]], [[[0.3914], [0.7634], [0.9052]], [[0.0658], [0.982], [0.0975]], [[0.4944], [0.8198], [0.6207]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Dep3829').set_weights(w) 
in0Con87291 = tf.constant([[[[[0.2191], [0.158]]]]])
in0Con81725 = tf.constant([[[[0.2572], [0.2229], [0.3825], [0.8474]], [[0.3892], [0.7809], [0.4781], [0.3607]], [[0.4948], [0.2419], [0.6624], [0.262]]]])
in0Sub60379 = tf.constant([[[[0.4299, 0.4162], [0.0243, 0.0742]], [[0.9141, 0.6255], [0.3011, 0.9875]], [[0.0726, 0.9259], [0.7618, 0.6001]]]])
in1Sub60379 = tf.constant([[[[0.8486, 0.4611], [0.8805, 0.4553]], [[0.3052, 0.5673], [0.6492, 0.9843]], [[0.072, 0.2271], [0.6585, 0.1975]]]])
print (np.array2string(model.predict([in0Con87291,in0Con81725,in0Sub60379,in1Sub60379],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep3829.png')

LCon87291 = conv3D_layer([[[[[0.2191], [0.158]]]]], 1, 1, 2,[[[[[0.1483, 0.9089]], [[0.5221, 0.9662]]]]],[0, 0], 3, 1, 1, false, 1, 1, 1, Con87291), 
LRes96369 = reshape_layer(Con87291, [1, 1, 2], Res96369), 
LCro27026 = cropping2D_layer(Res96369, 0, 0, 0, 0, Cro27026), 
LZer96529 = zero_padding2D_layer(Cro27026, 2, 0, 3, 0, Zer96529), 
LCon81725 = concatenate_layer([Zer96529,[[[[0.2572], [0.2229], [0.3825], [0.8474]], [[0.3892], [0.7809], [0.4781], [0.3607]], [[0.4948], [0.2419], [0.6624], [0.262]]]]], 3, Con81725), 
LSub60379 = subtract_layer([[[[0.4299, 0.4162], [0.0243, 0.0742]], [[0.9141, 0.6255], [0.3011, 0.9875]], [[0.0726, 0.9259], [0.7618, 0.6001]]]], [[[[0.8486, 0.4611], [0.8805, 0.4553]], [[0.3052, 0.5673], [0.6492, 0.9843]], [[0.072, 0.2271], [0.6585, 0.1975]]]], Sub60379), 
LCon60891 = conv2D_layer(Sub60379, 2, 1,[[[[0.2883, 0.4091, 0.3966], [0.3843, 0.6683, 0.6447]]], [[[0.9987, 0.734, 0.9111], [0.7488, 0.6042, 0.6101]]]],[0, 0, 0], 7, 1, true, 1, 1, Con60891), 
LZer14745 = zero_padding2D_layer(Con60891, 1, 1, 1, 1, Zer14745), 
LMax34158 = maximum_layer([Con81725,Zer14745], Max34158), 
LDep3829 = depthwise_conv2D_layer(Max34158, 2, 3,[[[[0.3461], [0.6845], [0.097]], [[0.8685], [0.9366], [0.4442]], [[0.0045], [0.4753], [0.2465]]], [[[0.3914], [0.7634], [0.9052]], [[0.0658], [0.982], [0.0975]], [[0.4944], [0.8198], [0.6207]]]],[0, 0, 0], 2, 2, false, Dep3829), 
exec_layers([LCon87291,LRes96369,LCro27026,LZer96529,LCon81725,LSub60379,LCon60891,LZer14745,LMax34158,LDep3829],["Con87291","Res96369","Cro27026","Zer96529","Con81725","Sub60379","Con60891","Zer14745","Max34158","Dep3829"],Dep3829,"Dep3829")

Actual (Unparsed): [[[[0.0338029, 0.2757458, 0.9434451]]]]

Expected (Unparsed): [[[[0.033802927998,0.27574579639999997,0.94344509]]]]

Actual:   [[[[0.0339, 0.2758, 0.9435]]]]

Expected: [[[[0.0339, 0.2758, 0.9435]]]]