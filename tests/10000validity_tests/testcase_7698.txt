import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub82642 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in1Sub82642 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))

Sub82642 = keras.layers.Subtract(name = 'Sub82642', )([in0Sub82642,in1Sub82642])
Res26992 = keras.layers.Reshape((2, 2, 6), name = 'Res26992', )(Sub82642)
Loc33860 = keras.layers.LocallyConnected2D(3, (2, 1),strides=(1, 12), name = 'Loc33860', )(Res26992)
Res19915 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res19915', )(Loc33860)
Glo48305 = keras.layers.GlobalAveragePooling3D(name = 'Glo48305', )(Res19915)
model = tf.keras.models.Model(inputs=[in0Sub82642,in1Sub82642], outputs=Glo48305)
w = model.get_layer('Loc33860').get_weights() 
w[0] = np.array([[[0.3179, 0.3951, 0.2469], [0.2256, 0.4997, 0.289], [0.0057, 0.9521, 0.5594], [0.3936, 0.4501, 0.829], [0.2357, 0.5537, 0.0053], [0.7127, 0.3225, 0.6554], [0.531, 0.7495, 0.4138], [0.5949, 0.7267, 0.6247], [0.8363, 0.1177, 0.2683], [0.1307, 0.148, 0.8383], [0.2654, 0.2265, 0.3289], [0.1061, 0.1523, 0.5029]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc33860').set_weights(w) 
in0Sub82642 = tf.constant([[[[[0.9668, 0.0278], [0.2787, 0.5735], [0.7392, 0.1273]], [[0.1255, 0.7905], [0.2491, 0.5884], [0.8439, 0.2366]]], [[[0.631, 0.6599], [0.6441, 0.0225], [0.684, 0.277]], [[0.035, 0.5846], [0.2357, 0.6123], [0.3399, 0.1682]]]]])
in1Sub82642 = tf.constant([[[[[0.1758, 0.8857], [0.2309, 0.4883], [0.9355, 0.3288]], [[0.9373, 0.4594], [0.9592, 0.0112], [0.7026, 0.4634]]], [[[0.025, 0.8327], [0.008, 0.4883], [0.1048, 0.3594]], [[0.0593, 0.6096], [0.8232, 0.341], [0.0436, 0.7085]]]]])
print (np.array2string(model.predict([in0Sub82642,in1Sub82642],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo48305.png')

LSub82642 = subtract_layer([[[[[0.9668, 0.0278], [0.2787, 0.5735], [0.7392, 0.1273]], [[0.1255, 0.7905], [0.2491, 0.5884], [0.8439, 0.2366]]], [[[0.631, 0.6599], [0.6441, 0.0225], [0.684, 0.277]], [[0.035, 0.5846], [0.2357, 0.6123], [0.3399, 0.1682]]]]], [[[[[0.1758, 0.8857], [0.2309, 0.4883], [0.9355, 0.3288]], [[0.9373, 0.4594], [0.9592, 0.0112], [0.7026, 0.4634]]], [[[0.025, 0.8327], [0.008, 0.4883], [0.1048, 0.3594]], [[0.0593, 0.6096], [0.8232, 0.341], [0.0436, 0.7085]]]]], Sub82642), 
LRes26992 = reshape_layer(Sub82642, [2, 2, 6], Res26992), 
LLoc33860 = locally_connected2D_layer(Res26992, 2, 1,[[[0.3179, 0.3951, 0.2469], [0.2256, 0.4997, 0.289], [0.0057, 0.9521, 0.5594], [0.3936, 0.4501, 0.829], [0.2357, 0.5537, 0.0053], [0.7127, 0.3225, 0.6554], [0.531, 0.7495, 0.4138], [0.5949, 0.7267, 0.6247], [0.8363, 0.1177, 0.2683], [0.1307, 0.148, 0.8383], [0.2654, 0.2265, 0.3289], [0.1061, 0.1523, 0.5029]]],[[[0, 0, 0]]], 1, 12, Loc33860), 
LRes19915 = reshape_layer(Loc33860, [1, 1, 3, 1], Res19915), 
LGlo48305 = global_average_pooling3D_layer(Res19915, Glo48305), 
exec_layers([LSub82642,LRes26992,LLoc33860,LRes19915,LGlo48305],["Sub82642","Res26992","Loc33860","Res19915","Glo48305"],Glo48305,"Glo48305")

Actual (Unparsed): [[0.3226005]]

Expected (Unparsed): [[0.3226004833333334]]

Actual:   [[0.3227]]

Expected: [[0.3227]]