import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con51963 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Ave73324 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave73324 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con14081 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Con48432 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Max95887 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Max95887 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con41977 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Con51963 = keras.layers.Conv3D(3, (1, 1, 2),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con51963', )(in0Con51963)
Zer26875 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer26875', )(Con51963)
Ave73324 = keras.layers.Average(name = 'Ave73324', )([in0Ave73324,in1Ave73324])
Glo47092 = keras.layers.GlobalAveragePooling2D(name = 'Glo47092', )(Ave73324)
Res66883 = keras.layers.Reshape((2, 1), name = 'Res66883', )(Glo47092)
Res61456 = keras.layers.Reshape((2, 1, 1), name = 'Res61456', )(Res66883)
Res80007 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res80007', )(Res61456)
Zer76567 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer76567', )(Res80007)
Con14081 = keras.layers.Concatenate(axis=4, name = 'Con14081', )([Zer76567,in0Con14081])
Con48432 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con48432', )(in0Con48432)
Zer11428 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer11428', )(Con48432)
Max95887 = keras.layers.Maximum(name = 'Max95887', )([in0Max95887,in1Max95887])
Con41977 = keras.layers.Concatenate(axis=4, name = 'Con41977', )([Max95887,in0Con41977])
Sub41582 = keras.layers.Subtract(name = 'Sub41582', )([Zer11428,Con41977])
Max59448 = keras.layers.Maximum(name = 'Max59448', )([Con14081,Sub41582])
Add70501 = keras.layers.Add(name = 'Add70501', )([Zer26875,Max59448])
model = tf.keras.models.Model(inputs=[in0Con51963,in0Ave73324,in1Ave73324,in0Con14081,in0Con48432,in0Max95887,in1Max95887,in0Con41977], outputs=Add70501)
w = model.get_layer('Con51963').get_weights() 
w[0] = np.array([[[[[0.3961, 0.4338, 0.2124], [0.1183, 0.2189, 0.2589]], [[0.8724, 0.1763, 0.099], [0.1134, 0.5606, 0.5771]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con51963').set_weights(w) 
w = model.get_layer('Con48432').get_weights() 
w[0] = np.array([[[[[0.3713, 0.6833], [0.771, 0.2076], [0.3543, 0.8277]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con48432').set_weights(w) 
in0Con51963 = tf.constant([[[[[0.9226, 0.3319], [0.0182, 0.2755]]]]])
in0Ave73324 = tf.constant([[[[0.4022, 0.6384]], [[0.8992, 0.8703]]]])
in1Ave73324 = tf.constant([[[[0.6226, 0.6048]], [[0.6345, 0.1564]]]])
in0Con14081 = tf.constant([[[[[0.4412, 0.8804], [0.2164, 0.8455]], [[0.8378, 0.7718], [0.2159, 0.2482]]], [[[0.6831, 0.1721], [0.7661, 0.2878]], [[0.2349, 0.398], [0.7302, 0.8596]]]]])
in0Con48432 = tf.constant([[[[[0.6111, 0.4397], [0.2791, 0.9314]]], [[[0.9837, 0.3564], [0.4059, 0.4481]]]]])
in0Max95887 = tf.constant([[[[[0.4684], [0.018]], [[0.7989], [0.5243]]], [[[0.6041], [0.7316]], [[0.4083], [0.0432]]]]])
in1Max95887 = tf.constant([[[[[0.2133], [0.8277]], [[0.2382], [0.9651]]], [[[0.3972], [0.8514]], [[0.1264], [0.929]]]]])
in0Con41977 = tf.constant([[[[[0.8938, 0.0178], [0.3521, 0.5911]], [[0.7561, 0.7764], [0.4239, 0.3529]]], [[[0.815, 0.9048], [0.0526, 0.7073]], [[0.59, 0.4153], [0.6112, 0.5267]]]]])
print (np.array2string(model.predict([in0Con51963,in0Ave73324,in1Ave73324,in0Con14081,in0Con48432,in0Max95887,in1Max95887,in0Con41977],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add70501.png')

LCon51963 = conv3D_layer([[[[[0.9226, 0.3319], [0.0182, 0.2755]]]]], 1, 1, 2,[[[[[0.3961, 0.4338, 0.2124], [0.1183, 0.2189, 0.2589]], [[0.8724, 0.1763, 0.099], [0.1134, 0.5606, 0.5771]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con51963), 
LZer26875 = zero_padding3D_layer(Con51963, 1, 0, 1, 0, 0, 0, Zer26875), 
LAve73324 = average_layer([[[[[0.4022, 0.6384]], [[0.8992, 0.8703]]]], [[[[0.6226, 0.6048]], [[0.6345, 0.1564]]]]], Ave73324), 
LGlo47092 = global_average_pooling2D_layer(Ave73324, Glo47092), 
LRes66883 = reshape_layer(Glo47092, [2, 1], Res66883), 
LRes61456 = reshape_layer(Res66883, [2, 1, 1], Res61456), 
LRes80007 = reshape_layer(Res61456, [2, 1, 1, 1], Res80007), 
LZer76567 = zero_padding3D_layer(Res80007, 0, 0, 1, 0, 1, 0, Zer76567), 
LCon14081 = concatenate_layer([Zer76567,[[[[[0.4412, 0.8804], [0.2164, 0.8455]], [[0.8378, 0.7718], [0.2159, 0.2482]]], [[[0.6831, 0.1721], [0.7661, 0.2878]], [[0.2349, 0.398], [0.7302, 0.8596]]]]]], 4, Con14081), 
LCon48432 = conv3D_transpose_layer([[[[[0.6111, 0.4397], [0.2791, 0.9314]]], [[[0.9837, 0.3564], [0.4059, 0.4481]]]]], 1, 1, 1,[[[[[0.3713, 0.6833], [0.771, 0.2076], [0.3543, 0.8277]]]]],[0, 0, 0], 1, 1, 1, false, Con48432), 
LZer11428 = zero_padding3D_layer(Con48432, 0, 0, 1, 0, 0, 0, Zer11428), 
LMax95887 = maximum_layer([[[[[[0.4684], [0.018]], [[0.7989], [0.5243]]], [[[0.6041], [0.7316]], [[0.4083], [0.0432]]]]], [[[[[0.2133], [0.8277]], [[0.2382], [0.9651]]], [[[0.3972], [0.8514]], [[0.1264], [0.929]]]]]], Max95887), 
LCon41977 = concatenate_layer([Max95887,[[[[[0.8938, 0.0178], [0.3521, 0.5911]], [[0.7561, 0.7764], [0.4239, 0.3529]]], [[[0.815, 0.9048], [0.0526, 0.7073]], [[0.59, 0.4153], [0.6112, 0.5267]]]]]], 4, Con41977), 
LSub41582 = subtract_layer(Zer11428,Con41977, Sub41582), 
LMax59448 = maximum_layer([Con14081,Sub41582], Max59448), 
LAdd70501 = add_layer([Zer26875,Max59448], Add70501), 
exec_layers([LCon51963,LZer26875,LAve73324,LGlo47092,LRes66883,LRes61456,LRes80007,LZer76567,LCon14081,LCon48432,LZer11428,LMax95887,LCon41977,LSub41582,LMax59448,LAdd70501],["Con51963","Zer26875","Ave73324","Glo47092","Res66883","Res61456","Res80007","Zer76567","Con14081","Con48432","Zer11428","Max95887","Con41977","Sub41582","Max59448","Add70501"],Add70501,"Add70501")

Actual (Unparsed): [[[[[0.0000000, 0.4412000, 0.8804000], [0.0000000, 0.2164000, 0.8455000]], [[0.0000000, 0.8378000, 0.7718000], [0.6396250, 0.2159000, 0.5169049]]], [[[0.0000000, 0.6831000, 0.1721000], [0.0000000, 0.7661000, 0.2878000]], [[0.6523009, 0.8729521, 0.8406820], [0.6072757, 0.7984021, 0.9347926]]]]]

Expected (Unparsed): [[[[[0,0.4412,0.8804],[0,0.2164,0.8455]],[[0,0.8378,0.7718],[0.639625,0.2159,0.5169049099999999]]],[[[0,0.6831,0.1721],[0,0.7661,0.2878]],[[0.6523009399999999,0.8729520900000001,0.840682],[0.6072756699999999,0.7984021099999999,0.93479263]]]]]

Actual:   [[[[[0, 0.4412, 0.8804], [0, 0.2164, 0.8455]], [[0, 0.8378, 0.7718], [0.6397, 0.2159, 0.517]]], [[[0, 0.6831, 0.1721], [0, 0.7661, 0.2878]], [[0.6524, 0.873, 0.8407], [0.6073, 0.7985, 0.9348]]]]]

Expected: [[[[[0, 0.4412, 0.8804], [0, 0.2164, 0.8455]], [[0, 0.8378, 0.7718], [0.6397, 0.2159, 0.517]]], [[[0, 0.6831, 0.1721], [0, 0.7661, 0.2878]], [[0.6524, 0.873, 0.8407], [0.6073, 0.7985, 0.9348]]]]]