import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub40244 = tf.keras.layers.Input(shape=([2, 2, 3, 3]))
in1Sub40244 = tf.keras.layers.Input(shape=([2, 2, 3, 3]))

Sub40244 = keras.layers.Subtract(name = 'Sub40244', )([in0Sub40244,in1Sub40244])
Fla67943 = keras.layers.Flatten(name = 'Fla67943', )(Sub40244)
Res85197 = keras.layers.Reshape((36, 1), name = 'Res85197', )(Fla67943)
Res19528 = keras.layers.Reshape((36, 1, 1), name = 'Res19528', )(Res85197)
Zer43732 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer43732', )(Res19528)
Sof70728 = keras.layers.Softmax(axis=1, name = 'Sof70728', )(Zer43732)
model = tf.keras.models.Model(inputs=[in0Sub40244,in1Sub40244], outputs=Sof70728)
in0Sub40244 = tf.constant([[[[[0.203, 0.694, 0.346], [0.7751, 0.8818, 0.911], [0.1046, 0.1748, 0.7349]], [[0.1379, 0.6568, 0.8038], [0.4253, 0.0874, 0.8363], [0.2164, 0.6729, 0.0966]]], [[[0.1259, 0.3287, 0.9448], [0.3717, 0.1674, 0.0753], [0.0598, 0.0254, 0.3967]], [[0.5339, 0.3345, 0.6354], [0.2628, 0.7086, 0.2184], [0.7005, 0.7605, 0.8848]]]]])
in1Sub40244 = tf.constant([[[[[0.8507, 0.4225, 0.9476], [0.0995, 0.6077, 0.6987], [0.7042, 0.8062, 0.5029]], [[0.0754, 0.2402, 0.2564], [0.2539, 0.6828, 0.7619], [0.4681, 0.9351, 0.8482]]], [[[0.2633, 0.9066, 0.399], [0.1677, 0.6308, 0.1652], [0.0665, 0.3067, 0.1146]], [[0.9977, 0.2634, 0.6924], [0.7549, 0.0318, 0.011], [0.567, 0.5295, 0.3706]]]]])
print (np.array2string(model.predict([in0Sub40244,in1Sub40244],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof70728.png')

LSub40244 = subtract_layer([[[[[0.203, 0.694, 0.346], [0.7751, 0.8818, 0.911], [0.1046, 0.1748, 0.7349]], [[0.1379, 0.6568, 0.8038], [0.4253, 0.0874, 0.8363], [0.2164, 0.6729, 0.0966]]], [[[0.1259, 0.3287, 0.9448], [0.3717, 0.1674, 0.0753], [0.0598, 0.0254, 0.3967]], [[0.5339, 0.3345, 0.6354], [0.2628, 0.7086, 0.2184], [0.7005, 0.7605, 0.8848]]]]], [[[[[0.8507, 0.4225, 0.9476], [0.0995, 0.6077, 0.6987], [0.7042, 0.8062, 0.5029]], [[0.0754, 0.2402, 0.2564], [0.2539, 0.6828, 0.7619], [0.4681, 0.9351, 0.8482]]], [[[0.2633, 0.9066, 0.399], [0.1677, 0.6308, 0.1652], [0.0665, 0.3067, 0.1146]], [[0.9977, 0.2634, 0.6924], [0.7549, 0.0318, 0.011], [0.567, 0.5295, 0.3706]]]]], Sub40244), 
LFla67943 = flatten_layer(Sub40244, Fla67943), 
LRes85197 = reshape_layer(Fla67943, [36, 1], Res85197), 
LRes19528 = reshape_layer(Res85197, [36, 1, 1], Res19528), 
LZer43732 = zero_padding2D_layer(Res19528, 1, 1, 1, 1, Zer43732), 
LSof70728 = softmax_layer(Zer43732, 1, Sof70728), 
exec_layers([LSub40244,LFla67943,LRes85197,LRes19528,LZer43732,LSof70728],["Sub40244","Fla67943","Res85197","Res19528","Zer43732","Sof70728"],Sof70728,"Sof70728")

Actual (Unparsed): [[[[0.0263158], [0.0250501], [0.0263158]], [[0.0263158], [0.0131074], [0.0263158]], [[0.0263158], [0.0328640], [0.0263158]], [[0.0263158], [0.0137258], [0.0263158]], [[0.0263158], [0.0492288], [0.0263158]], [[0.0263158], [0.0329496], [0.0263158]], [[0.0263158], [0.0309750], [0.0263158]], [[0.0263158], [0.0137533], [0.0263158]], [[0.0263158], [0.0133228], [0.0263158]], [[0.0263158], [0.0315912], [0.0263158]], [[0.0263158], [0.0266657], [0.0263158]], [[0.0263158], [0.0379959], [0.0263158]], [[0.0263158], [0.0433055], [0.0263158]], [[0.0263158], [0.0297336], [0.0263158]], [[0.0263158], [0.0138112], [0.0263158]], [[0.0263158], [0.0269849], [0.0263158]], [[0.0263158], [0.0194759], [0.0263158]], [[0.0263158], [0.0192725], [0.0263158]], [[0.0263158], [0.0118139], [0.0263158]], [[0.0263158], [0.0218342], [0.0263158]], [[0.0263158], [0.0140550], [0.0263158]], [[0.0263158], [0.0432362], [0.0263158]], [[0.0263158], [0.0307189], [0.0263158]], [[0.0263158], [0.0157601], [0.0263158]], [[0.0263158], [0.0228964], [0.0263158]], [[0.0263158], [0.0248829], [0.0263158]], [[0.0263158], [0.0189079], [0.0263158]], [[0.0263158], [0.0332143], [0.0263158]], [[0.0263158], [0.0157538], [0.0263158]], [[0.0263158], [0.0268960], [0.0263158]], [[0.0263158], [0.0236622], [0.0263158]], [[0.0263158], [0.0153142], [0.0263158]], [[0.0263158], [0.0492879], [0.0263158]], [[0.0263158], [0.0308236], [0.0263158]], [[0.0263158], [0.0286278], [0.0263158]], [[0.0263158], [0.0315596], [0.0263158]], [[0.0263158], [0.0418913], [0.0263158]], [[0.0263158], [0.0250501], [0.0263158]]]]

Expected (Unparsed): [[[[0.02631578947368421],[0.02505013523530168],[0.02631578947368421]],[[0.02631578947368421],[0.013107429752725544],[0.02631578947368421]],[[0.02631578947368421],[0.032864045759372205],[0.02631578947368421]],[[0.02631578947368421],[0.013725826801547839],[0.02631578947368421]],[[0.02631578947368421],[0.0492288200872734],[0.02631578947368421]],[[0.02631578947368421],[0.03294960345515359],[0.02631578947368421]],[[0.02631578947368421],[0.030974962787150874],[0.02631578947368421]],[[0.02631578947368421],[0.013753305925114794],[0.02631578947368421]],[[0.02631578947368421],[0.013322831613706376],[0.02631578947368421]],[[0.02631578947368421],[0.03159121975505663],[0.02631578947368421]],[[0.02631578947368421],[0.026665730153121663],[0.02631578947368421]],[[0.02631578947368421],[0.03799593674063396],[0.02631578947368421]],[[0.02631578947368421],[0.04330548174257533],[0.02631578947368421]],[[0.02631578947368421],[0.029733644797972997],[0.02631578947368421]],[[0.02631578947368421],[0.013811191284162824],[0.02631578947368421]],[[0.02631578947368421],[0.026984947920633735],[0.02631578947368421]],[[0.02631578947368421],[0.01947592770153508],[0.02631578947368421]],[[0.02631578947368421],[0.019272500323389827],[0.02631578947368421]],[[0.02631578947368421],[0.011813928611121065],[0.02631578947368421]],[[0.02631578947368421],[0.02183423664413642],[0.02631578947368421]],[[0.02631578947368421],[0.014055014361021844],[0.02631578947368421]],[[0.02631578947368421],[0.043236248373252455],[0.02631578947368421]],[[0.02631578947368421],[0.030718934582878804],[0.02631578947368421]],[[0.02631578947368421],[0.015760065273349326],[0.02631578947368421]],[[0.02631578947368421],[0.022896389311256815],[0.02631578947368421]],[[0.02631578947368421],[0.02488286032591868],[0.02631578947368421]],[[0.02631578947368421],[0.01890788869271604],[0.02631578947368421]],[[0.02631578947368421],[0.03321425748743729],[0.02631578947368421]],[[0.02631578947368421],[0.01575376250787712],[0.02631578947368421]],[[0.02631578947368421],[0.026896044364043976],[0.02631578947368421]],[[0.02631578947368421],[0.023662209180095345],[0.02631578947368421]],[[0.02631578947368421],[0.015314180452666507],[0.02631578947368421]],[[0.02631578947368421],[0.04928793013031075],[0.02631578947368421]],[[0.02631578947368421],[0.030823556717303146],[0.02631578947368421]],[[0.02631578947368421],[0.028627827266463183],[0.02631578947368421]],[[0.02631578947368421],[0.03155964432564757],[0.02631578947368421]],[[0.02631578947368421],[0.041891344320773564],[0.02631578947368421]],[[0.02631578947368421],[0.02505013523530168],[0.02631578947368421]]]]

Actual:   [[[[0.0264], [0.0251], [0.0264]], [[0.0264], [0.0132], [0.0264]], [[0.0264], [0.0329], [0.0264]], [[0.0264], [0.0138], [0.0264]], [[0.0264], [0.0493], [0.0264]], [[0.0264], [0.033], [0.0264]], [[0.0264], [0.031], [0.0264]], [[0.0264], [0.0138], [0.0264]], [[0.0264], [0.0134], [0.0264]], [[0.0264], [0.0316], [0.0264]], [[0.0264], [0.0267], [0.0264]], [[0.0264], [0.038], [0.0264]], [[0.0264], [0.0434], [0.0264]], [[0.0264], [0.0298], [0.0264]], [[0.0264], [0.0139], [0.0264]], [[0.0264], [0.027], [0.0264]], [[0.0264], [0.0195], [0.0264]], [[0.0264], [0.0193], [0.0264]], [[0.0264], [0.0119], [0.0264]], [[0.0264], [0.0219], [0.0264]], [[0.0264], [0.0141], [0.0264]], [[0.0264], [0.0433], [0.0264]], [[0.0264], [0.0308], [0.0264]], [[0.0264], [0.0158], [0.0264]], [[0.0264], [0.0229], [0.0264]], [[0.0264], [0.0249], [0.0264]], [[0.0264], [0.019], [0.0264]], [[0.0264], [0.0333], [0.0264]], [[0.0264], [0.0158], [0.0264]], [[0.0264], [0.0269], [0.0264]], [[0.0264], [0.0237], [0.0264]], [[0.0264], [0.0154], [0.0264]], [[0.0264], [0.0493], [0.0264]], [[0.0264], [0.0309], [0.0264]], [[0.0264], [0.0287], [0.0264]], [[0.0264], [0.0316], [0.0264]], [[0.0264], [0.0419], [0.0264]], [[0.0264], [0.0251], [0.0264]]]]

Expected: [[[[0.0264], [0.0251], [0.0264]], [[0.0264], [0.0132], [0.0264]], [[0.0264], [0.0329], [0.0264]], [[0.0264], [0.0138], [0.0264]], [[0.0264], [0.0493], [0.0264]], [[0.0264], [0.033], [0.0264]], [[0.0264], [0.031], [0.0264]], [[0.0264], [0.0138], [0.0264]], [[0.0264], [0.0134], [0.0264]], [[0.0264], [0.0316], [0.0264]], [[0.0264], [0.0267], [0.0264]], [[0.0264], [0.038], [0.0264]], [[0.0264], [0.0434], [0.0264]], [[0.0264], [0.0298], [0.0264]], [[0.0264], [0.0139], [0.0264]], [[0.0264], [0.027], [0.0264]], [[0.0264], [0.0195], [0.0264]], [[0.0264], [0.0193], [0.0264]], [[0.0264], [0.0119], [0.0264]], [[0.0264], [0.0219], [0.0264]], [[0.0264], [0.0141], [0.0264]], [[0.0264], [0.0433], [0.0264]], [[0.0264], [0.0308], [0.0264]], [[0.0264], [0.0158], [0.0264]], [[0.0264], [0.0229], [0.0264]], [[0.0264], [0.0249], [0.0264]], [[0.0264], [0.019], [0.0264]], [[0.0264], [0.0333], [0.0264]], [[0.0264], [0.0158], [0.0264]], [[0.0264], [0.0269], [0.0264]], [[0.0264], [0.0237], [0.0264]], [[0.0264], [0.0154], [0.0264]], [[0.0264], [0.0493], [0.0264]], [[0.0264], [0.0309], [0.0264]], [[0.0264], [0.0287], [0.0264]], [[0.0264], [0.0316], [0.0264]], [[0.0264], [0.0419], [0.0264]], [[0.0264], [0.0251], [0.0264]]]]