import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add14555 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add14555 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Sub88393 = tf.keras.layers.Input(shape=([3]))
in1Sub88393 = tf.keras.layers.Input(shape=([3]))
in0Con29978 = tf.keras.layers.Input(shape=([3, 1]))
in0Thr67782 = tf.keras.layers.Input(shape=([1, 2]))
in0Con66509 = tf.keras.layers.Input(shape=([5]))

Add14555 = keras.layers.Add(name = 'Add14555', )([in0Add14555,in1Add14555])
Res6131 = keras.layers.Reshape((2, 2), name = 'Res6131', )(Add14555)
Zer57830 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer57830', )(Res6131)
Sub88393 = keras.layers.Subtract(name = 'Sub88393', )([in0Sub88393,in1Sub88393])
Res32034 = keras.layers.Reshape((3, 1), name = 'Res32034', )(Sub88393)
PRe80296 = keras.layers.PReLU(name = 'PRe80296', )(Res32034)
Con29978 = keras.layers.Concatenate(axis=2, name = 'Con29978', )([PRe80296,in0Con29978])
Sub47053 = keras.layers.Subtract(name = 'Sub47053', )([Zer57830,Con29978])
Fla67110 = keras.layers.Flatten(name = 'Fla67110', )(Sub47053)
Thr67782 = keras.layers.ThresholdedReLU(theta=7.220154841527543, name = 'Thr67782', input_shape=(1, 2))(in0Thr67782)
Glo68059 = keras.layers.GlobalMaxPool1D(name = 'Glo68059', )(Thr67782)
Res64598 = keras.layers.Reshape((2, 1), name = 'Res64598', )(Glo68059)
Res16051 = keras.layers.Reshape((2, 1, 1), name = 'Res16051', )(Res64598)
Res5661 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res5661', )(Res16051)
Glo63771 = keras.layers.GlobalAveragePooling3D(name = 'Glo63771', )(Res5661)
Con66509 = keras.layers.Concatenate(axis=1, name = 'Con66509', )([Glo63771,in0Con66509])
Max54306 = keras.layers.Maximum(name = 'Max54306', )([Fla67110,Con66509])
model = tf.keras.models.Model(inputs=[in0Add14555,in1Add14555,in0Sub88393,in1Sub88393,in0Con29978,in0Thr67782,in0Con66509], outputs=Max54306)
w = model.get_layer('PRe80296').get_weights() 
w[0] = np.array([[0.9196], [0.5139], [0.1659]])
model.get_layer('PRe80296').set_weights(w) 
in0Add14555 = tf.constant([[[[0.099, 0.0662]], [[0.2541, 0.1772]]]])
in1Add14555 = tf.constant([[[[0.7772, 0.0386]], [[0.1701, 0.031]]]])
in0Sub88393 = tf.constant([[0.9317, 0.2367, 0.5033]])
in1Sub88393 = tf.constant([[0.1396, 0.5076, 0.0717]])
in0Con29978 = tf.constant([[[0.7538], [0.6857], [0.3019]]])
in0Thr67782 = tf.constant([[[0.1746, 0.1436]]])
in0Con66509 = tf.constant([[0.8089, 0.5835, 0.9986, 0.5559, 0.3115]])
print (np.array2string(model.predict([in0Add14555,in1Add14555,in0Sub88393,in1Sub88393,in0Con29978,in0Thr67782,in0Con66509],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max54306.png')

LAdd14555 = add_layer([[[[[0.099, 0.0662]], [[0.2541, 0.1772]]]], [[[[0.7772, 0.0386]], [[0.1701, 0.031]]]]], Add14555), 
LRes6131 = reshape_layer(Add14555, [2, 2], Res6131), 
LZer57830 = zero_padding1D_layer(Res6131, 1, 0, Zer57830), 
LSub88393 = subtract_layer([[0.9317, 0.2367, 0.5033]], [[0.1396, 0.5076, 0.0717]], Sub88393), 
LRes32034 = reshape_layer(Sub88393, [3, 1], Res32034), 
LPRe80296 = prelu_layer(Res32034, [[0.9196], [0.5139], [0.1659]], PRe80296), 
LCon29978 = concatenate_layer([PRe80296,[[[0.7538], [0.6857], [0.3019]]]], 2, Con29978), 
LSub47053 = subtract_layer(Zer57830,Con29978, Sub47053), 
LFla67110 = flatten_layer(Sub47053, Fla67110), 
LThr67782 = thresholded_relu_layer([[[0.1746, 0.1436]]], 7.220154841527543, Thr67782), 
LGlo68059 = global_max_pool1D_layer(Thr67782, Glo68059), 
LRes64598 = reshape_layer(Glo68059, [2, 1], Res64598), 
LRes16051 = reshape_layer(Res64598, [2, 1, 1], Res16051), 
LRes5661 = reshape_layer(Res16051, [2, 1, 1, 1], Res5661), 
LGlo63771 = global_average_pooling3D_layer(Res5661, Glo63771), 
LCon66509 = concatenate_layer([Glo63771,[[0.8089, 0.5835, 0.9986, 0.5559, 0.3115]]], 1, Con66509), 
LMax54306 = maximum_layer([Fla67110,Con66509], Max54306), 
exec_layers([LAdd14555,LRes6131,LZer57830,LSub88393,LRes32034,LPRe80296,LCon29978,LSub47053,LFla67110,LThr67782,LGlo68059,LRes64598,LRes16051,LRes5661,LGlo63771,LCon66509,LMax54306],["Add14555","Res6131","Zer57830","Sub88393","Res32034","PRe80296","Con29978","Sub47053","Fla67110","Thr67782","Glo68059","Res64598","Res16051","Res5661","Glo63771","Con66509","Max54306"],Max54306,"Max54306")

Actual (Unparsed): [[0.0000000, 0.8089000, 1.0154155, 0.9986000, 0.5559000, 0.3115000]]

Expected (Unparsed): [[0,0.8089,1.01541551,0.9986,0.5559,0.3115]]

Actual:   [[0, 0.8089, 1.0155, 0.9986, 0.5559, 0.3115]]

Expected: [[0, 0.8089, 1.0155, 0.9986, 0.5559, 0.3115]]