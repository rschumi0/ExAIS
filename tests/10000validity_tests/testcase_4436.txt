import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add33342 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add33342 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Add45130 = tf.keras.layers.Input(shape=([1, 1]))
in1Add45130 = tf.keras.layers.Input(shape=([1, 1]))
in0Con59867 = tf.keras.layers.Input(shape=([2, 1]))
in0Con56353 = tf.keras.layers.Input(shape=([4, 2]))
in0Thr99436 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Glo51294 = tf.keras.layers.Input(shape=([2, 2]))
in0Con48901 = tf.keras.layers.Input(shape=([2, 3]))
in0Add55354 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add55354 = tf.keras.layers.Input(shape=([1, 2, 2]))

Add33342 = keras.layers.Add(name = 'Add33342', )([in0Add33342,in1Add33342])
Res46769 = keras.layers.Reshape((2, 2), name = 'Res46769', )(Add33342)
Add45130 = keras.layers.Add(name = 'Add45130', )([in0Add45130,in1Add45130])
Zer33215 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer33215', )(Add45130)
Con59867 = keras.layers.Concatenate(axis=2, name = 'Con59867', )([Zer33215,in0Con59867])
Add70611 = keras.layers.Add(name = 'Add70611', )([Res46769,Con59867])
Zer68035 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer68035', )(Add70611)
Con56353 = keras.layers.Concatenate(axis=2, name = 'Con56353', )([Zer68035,in0Con56353])
Thr99436 = keras.layers.ThresholdedReLU(theta=1.337823673218799, name = 'Thr99436', input_shape=(1, 1, 1))(in0Thr99436)
Zer75220 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer75220', )(Thr99436)
Glo51294 = keras.layers.GlobalAveragePooling1D(name = 'Glo51294', )(in0Glo51294)
Res25348 = keras.layers.Reshape((2, 1), name = 'Res25348', )(Glo51294)
Res43543 = keras.layers.Reshape((2, 1, 1), name = 'Res43543', )(Res25348)
Ave1076 = keras.layers.AveragePooling2D(pool_size=(2, 1), strides=(1, 1), padding='same', name = 'Ave1076', )(Res43543)
Sub35380 = keras.layers.Subtract(name = 'Sub35380', )([Zer75220,Ave1076])
Res46730 = keras.layers.Reshape((2, 1), name = 'Res46730', )(Sub35380)
Con48901 = keras.layers.Concatenate(axis=2, name = 'Con48901', )([Res46730,in0Con48901])
Add55354 = keras.layers.Add(name = 'Add55354', )([in0Add55354,in1Add55354])
Res5971 = keras.layers.Reshape((1, 4), name = 'Res5971', )(Add55354)
Zer89399 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer89399', )(Res5971)
Dot79644 = keras.layers.Dot(axes=(1, 1), name = 'Dot79644', )([Con48901,Zer89399])
Max39414 = keras.layers.Maximum(name = 'Max39414', )([Con56353,Dot79644])
model = tf.keras.models.Model(inputs=[in0Add33342,in1Add33342,in0Add45130,in1Add45130,in0Con59867,in0Con56353,in0Thr99436,in0Glo51294,in0Con48901,in0Add55354,in1Add55354], outputs=Max39414)
in0Add33342 = tf.constant([[[[0.3572], [0.3856]], [[0.6009], [0.5997]]]])
in1Add33342 = tf.constant([[[[0.6692], [0.3077]], [[0.2813], [0.807]]]])
in0Add45130 = tf.constant([[[0.9075]]])
in1Add45130 = tf.constant([[[0.7546]]])
in0Con59867 = tf.constant([[[0.1862], [0.3612]]])
in0Con56353 = tf.constant([[[0.4446, 0.8427], [0.6639, 0.772], [0.7976, 0.538], [0.117, 0.2959]]])
in0Thr99436 = tf.constant([[[[0.4396]]]])
in0Glo51294 = tf.constant([[[1.9717, 1.3369], [1.2501, 1.9154]]])
in0Con48901 = tf.constant([[[0.8629, 0.4188, 0.1341], [0.7545, 0.1051, 0.0313]]])
in0Add55354 = tf.constant([[[[0.928, 0.9393], [0.1947, 0.5227]]]])
in1Add55354 = tf.constant([[[[0.9204, 0.0789], [0.2548, 0.4107]]]])
print (np.array2string(model.predict([in0Add33342,in1Add33342,in0Add45130,in1Add45130,in0Con59867,in0Con56353,in0Thr99436,in0Glo51294,in0Con48901,in0Add55354,in1Add55354],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max39414.png')

LAdd33342 = add_layer([[[[[0.3572], [0.3856]], [[0.6009], [0.5997]]]], [[[[0.6692], [0.3077]], [[0.2813], [0.807]]]]], Add33342), 
LRes46769 = reshape_layer(Add33342, [2, 2], Res46769), 
LAdd45130 = add_layer([[[[0.9075]]], [[[0.7546]]]], Add45130), 
LZer33215 = zero_padding1D_layer(Add45130, 1, 0, Zer33215), 
LCon59867 = concatenate_layer([Zer33215,[[[0.1862], [0.3612]]]], 2, Con59867), 
LAdd70611 = add_layer([Res46769,Con59867], Add70611), 
LZer68035 = zero_padding1D_layer(Add70611, 2, 0, Zer68035), 
LCon56353 = concatenate_layer([Zer68035,[[[0.4446, 0.8427], [0.6639, 0.772], [0.7976, 0.538], [0.117, 0.2959]]]], 2, Con56353), 
LThr99436 = thresholded_relu_layer([[[[0.4396]]]], 1.337823673218799, Thr99436), 
LZer75220 = zero_padding2D_layer(Thr99436, 1, 0, 0, 0, Zer75220), 
LGlo51294 = global_average_pooling1D_layer([[[1.9717, 1.3369], [1.2501, 1.9154]]], Glo51294), 
LRes25348 = reshape_layer(Glo51294, [2, 1], Res25348), 
LRes43543 = reshape_layer(Res25348, [2, 1, 1], Res43543), 
LAve1076 = average_pooling2D_layer(Res43543, 2, 1, 1, 1, true, Ave1076), 
LSub35380 = subtract_layer(Zer75220,Ave1076, Sub35380), 
LRes46730 = reshape_layer(Sub35380, [2, 1], Res46730), 
LCon48901 = concatenate_layer([Res46730,[[[0.8629, 0.4188, 0.1341], [0.7545, 0.1051, 0.0313]]]], 2, Con48901), 
LAdd55354 = add_layer([[[[[0.928, 0.9393], [0.1947, 0.5227]]]], [[[[0.9204, 0.0789], [0.2548, 0.4107]]]]], Add55354), 
LRes5971 = reshape_layer(Add55354, [1, 4], Res5971), 
LZer89399 = zero_padding1D_layer(Res5971, 1, 0, Zer89399), 
LDot79644 = dot_layer(Con48901,Zer89399, 1, 1, Dot79644), 
LMax39414 = maximum_layer([Con56353,Dot79644], Max39414), 
exec_layers([LAdd33342,LRes46769,LAdd45130,LZer33215,LCon59867,LAdd70611,LZer68035,LCon56353,LThr99436,LZer75220,LGlo51294,LRes25348,LRes43543,LAve1076,LSub35380,LRes46730,LCon48901,LAdd55354,LRes5971,LZer89399,LDot79644,LMax39414],["Add33342","Res46769","Add45130","Zer33215","Con59867","Add70611","Zer68035","Con56353","Thr99436","Zer75220","Glo51294","Res25348","Res43543","Ave1076","Sub35380","Res46730","Con48901","Add55354","Res5971","Zer89399","Dot79644","Max39414"],Max39414,"Max39414")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.4446000, 0.8427000], [1.3946177, 0.7682319, 0.6639000, 0.7720000], [1.0264000, 0.8795000, 0.7976000, 0.5380000], [2.5443000, 1.7679000, 0.1170000, 0.2959000]]]

Expected (Unparsed): [[[0,0,0.4446,0.8427],[1.3946178,0.7682319,0.6639,0.772],[1.0264,0.8795000000000001,0.7976,0.538],[2.5443000000000002,1.7679,0.117,0.2959]]]

Actual:   [[[0, 0, 0.4446, 0.8427], [1.3947, 0.7683, 0.6639, 0.772], [1.0264, 0.8795, 0.7976, 0.538], [2.5443, 1.7679, 0.117, 0.2959]]]

Expected: [[[0, 0, 0.4446, 0.8427], [1.3947, 0.7683, 0.6639, 0.772], [1.0264, 0.8796, 0.7976, 0.538], [2.5444, 1.7679, 0.117, 0.2959]]]