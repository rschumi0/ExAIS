import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot45217 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot45217 = tf.keras.layers.Input(shape=([3, 2]))

Dot45217 = keras.layers.Dot(axes=(1, 1), name = 'Dot45217', )([in0Dot45217,in1Dot45217])
GRU55720 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU55720', )(Dot45217)
model = tf.keras.models.Model(inputs=[in0Dot45217,in1Dot45217], outputs=GRU55720)
w = model.get_layer('GRU55720').get_weights() 
w[0] = np.array([[8, 7, 9, 3, 3, 6, 6, 9, 7], [4, 1, 2, 7, 8, 3, 1, 7, 9]])
w[1] = np.array([[7, 1, 1, 10, 5, 6, 2, 3, 9], [6, 10, 8, 7, 9, 6, 4, 5, 10], [5, 1, 1, 10, 7, 9, 10, 6, 3]])
w[2] = np.array([6, 7, 5, 9, 7, 2, 10, 1, 10])
model.get_layer('GRU55720').set_weights(w) 
in0Dot45217 = tf.constant([[[0.5902, 0.1479], [0.4761, 0.5624], [0.9444, 0.8679]]])
in1Dot45217 = tf.constant([[[0.2668, 0.9417], [0.5737, 0.6066], [0.0447, 0.9553]]])
print (np.array2string(model.predict([in0Dot45217,in1Dot45217],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU55720.png')

LDot45217 = dot_layer([[[0.5902, 0.1479], [0.4761, 0.5624], [0.9444, 0.8679]]], [[[0.2668, 0.9417], [0.5737, 0.6066], [0.0447, 0.9553]]], 1, 1, Dot45217), 
LGRU55720 = gru_layer(Dot45217,[[8, 7, 9, 3, 3, 6, 6, 9, 7], [4, 1, 2, 7, 8, 3, 1, 7, 9]],[[7, 1, 1, 10, 5, 6, 2, 3, 9], [6, 10, 8, 7, 9, 6, 4, 5, 10], [5, 1, 1, 10, 7, 9, 10, 6, 3]],[6, 7, 5, 9, 7, 2, 10, 1, 10], false, GRU55720), 
exec_layers([LDot45217,LGRU55720],["Dot45217","GRU55720"],GRU55720,"GRU55720")

Actual (Unparsed): [[0.0000006, 0.0000207, 0.0000162]]

Expected (Unparsed): [[5.847645175775478e-7,2.067991614503794e-5,1.6211805577284575e-5]]

Actual:   [[0, 0.0001, 0.0001]]

Expected: [[0, 0.0001, 0.0001]]