import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim89924 = tf.keras.layers.Input(shape=([2, 2]))

Sim89924 = keras.layers.SimpleRNN(1,name = 'Sim89924', )(in0Sim89924)
Res74288 = keras.layers.Reshape((1, 1), name = 'Res74288', )(Sim89924)
Res1562 = keras.layers.Reshape((1, 1, 1), name = 'Res1562', )(Res74288)
Cro35952 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro35952', )(Res1562)
Res91932 = keras.layers.Reshape((1, 1), name = 'Res91932', )(Cro35952)
Per45933 = keras.layers.Permute((2,1), name = 'Per45933',)(Res91932)
model = tf.keras.models.Model(inputs=[in0Sim89924], outputs=Per45933)
w = model.get_layer('Sim89924').get_weights() 
w[0] = np.array([[3], [2]])
w[1] = np.array([[8]])
w[2] = np.array([1])
model.get_layer('Sim89924').set_weights(w) 
in0Sim89924 = tf.constant([[[7, 6], [6, 2]]])
print (np.array2string(model.predict([in0Sim89924],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per45933.png')

LSim89924 = simple_rnn_layer([[[7, 6], [6, 2]]],[[3], [2]],[[8]],[1], Sim89924), 
LRes74288 = reshape_layer(Sim89924, [1, 1], Res74288), 
LRes1562 = reshape_layer(Res74288, [1, 1, 1], Res1562), 
LCro35952 = cropping2D_layer(Res1562, 0, 0, 0, 0, Cro35952), 
LRes91932 = reshape_layer(Cro35952, [1, 1], Res91932), 
LPer45933 = permute_layer(Res91932, 2,1, Per45933), 
exec_layers([LSim89924,LRes74288,LRes1562,LCro35952,LRes91932,LPer45933],["Sim89924","Res74288","Res1562","Cro35952","Res91932","Per45933"],Per45933,"Per45933")

Actual (Unparsed): [[[1.0000000]]]

Expected (Unparsed): [[[1.0]]]

Actual:   [[[1]]]

Expected: [[[1]]]