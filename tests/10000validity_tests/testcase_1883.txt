import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max35269 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max35269 = tf.keras.layers.Input(shape=([2, 2, 2]))

Max35269 = keras.layers.Maximum(name = 'Max35269', )([in0Max35269,in1Max35269])
Res3621 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res3621', )(Max35269)
Con26949 = keras.layers.Conv3D(3, (2, 1, 2),strides=(1, 2, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con26949', )(Res3621)
model = tf.keras.models.Model(inputs=[in0Max35269,in1Max35269], outputs=Con26949)
w = model.get_layer('Con26949').get_weights() 
w[0] = np.array([[[[[0.1829, 0.2434, 0.5561]], [[0.1579, 0.8061, 0.7008]]]], [[[[0.4735, 0.6398, 0.3463]], [[0.2569, 0.0863, 0.8848]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con26949').set_weights(w) 
in0Max35269 = tf.constant([[[[0.5237, 0.2039], [0.2877, 0.608]], [[0.832, 0.5781], [0.1484, 0.0649]]]])
in1Max35269 = tf.constant([[[[0.2636, 0.2201], [0.0238, 0.8799]], [[0.311, 0.685], [0.0238, 0.7446]]]])
print (np.array2string(model.predict([in0Max35269,in1Max35269],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con26949.png')

LMax35269 = maximum_layer([[[[[0.5237, 0.2039], [0.2877, 0.608]], [[0.832, 0.5781], [0.1484, 0.0649]]]], [[[[0.2636, 0.2201], [0.0238, 0.8799]], [[0.311, 0.685], [0.0238, 0.7446]]]]], Max35269), 
LRes3621 = reshape_layer(Max35269, [2, 2, 2, 1], Res3621), 
LCon26949 = conv3D_layer(Res3621, 2, 1, 2,[[[[[0.1829, 0.2434, 0.5561]], [[0.1579, 0.8061, 0.7008]]]], [[[[0.4735, 0.6398, 0.3463]], [[0.2569, 0.0863, 0.8848]]]]],[0, 0, 0], 1, 2, 1, false, 1, 1, 1, Con26949), 
exec_layers([LMax35269,LRes3621,LCon26949],["Max35269","Res3621","Con26949"],Con26949,"Con26949")

Actual (Unparsed): [[[[[0.7004670, 0.8963203, 1.3396853]]]]]

Expected (Unparsed): [[[[[0.70046702,0.8963202900000001,1.33968525]]]]]

Actual:   [[[[[0.7005, 0.8964, 1.3397]]]]]

Expected: [[[[[0.7005, 0.8964, 1.3397]]]]]