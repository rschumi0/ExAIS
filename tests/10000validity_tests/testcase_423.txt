import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub73350 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub73350 = tf.keras.layers.Input(shape=([3, 2]))

Sub73350 = keras.layers.Subtract(name = 'Sub73350', )([in0Sub73350,in1Sub73350])
Res23684 = keras.layers.Reshape((3, 2, 1), name = 'Res23684', )(Sub73350)
Res18144 = keras.layers.Reshape((3, 2, 1, 1), name = 'Res18144', )(Res23684)
Cro34000 = keras.layers.Cropping3D(cropping=((0, 2), (1, 0), (0, 0)), name = 'Cro34000', )(Res18144)
Sof92215 = keras.layers.Softmax(axis=1, name = 'Sof92215', )(Cro34000)
model = tf.keras.models.Model(inputs=[in0Sub73350,in1Sub73350], outputs=Sof92215)
in0Sub73350 = tf.constant([[[0.7855, 0.692], [0.603, 0.9762], [0.7032, 0.0521]]])
in1Sub73350 = tf.constant([[[0.9653, 0.3302], [0.757, 0.8694], [0.6704, 0.2996]]])
print (np.array2string(model.predict([in0Sub73350,in1Sub73350],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof92215.png')

LSub73350 = subtract_layer([[[0.7855, 0.692], [0.603, 0.9762], [0.7032, 0.0521]]], [[[0.9653, 0.3302], [0.757, 0.8694], [0.6704, 0.2996]]], Sub73350), 
LRes23684 = reshape_layer(Sub73350, [3, 2, 1], Res23684), 
LRes18144 = reshape_layer(Res23684, [3, 2, 1, 1], Res18144), 
LCro34000 = cropping3D_layer(Res18144, 0, 2, 1, 0, 0, 0, Cro34000), 
LSof92215 = softmax_layer(Cro34000, 1, Sof92215), 
exec_layers([LSub73350,LRes23684,LRes18144,LCro34000,LSof92215],["Sub73350","Res23684","Res18144","Cro34000","Sof92215"],Sof92215,"Sof92215")

Actual (Unparsed): [[[[[1.0000000]]]]]

Expected (Unparsed): [[[[[1.0]]]]]

Actual:   [[[[[1]]]]]

Expected: [[[[[1]]]]]