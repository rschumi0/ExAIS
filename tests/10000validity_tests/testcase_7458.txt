import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add5724 = tf.keras.layers.Input(shape=([2, 2]))
in1Add5724 = tf.keras.layers.Input(shape=([2, 2]))
in0Mas74105 = tf.keras.layers.Input(shape=([4, 3, 4]))
in0Con38272 = tf.keras.layers.Input(shape=([3]))

Add5724 = keras.layers.Add(name = 'Add5724', )([in0Add5724,in1Add5724])
Fla21604 = keras.layers.Flatten(name = 'Fla21604', )(Add5724)
Mas74105 = keras.layers.Masking(mask_value=1, name = 'Mas74105', )(in0Mas74105)
Res5252 = keras.layers.Reshape((4, 3, 4, 1), name = 'Res5252', )(Mas74105)
Glo5034 = keras.layers.GlobalMaxPool3D(name = 'Glo5034', )(Res5252)
Con38272 = keras.layers.Concatenate(axis=1, name = 'Con38272', )([Glo5034,in0Con38272])
Sub67420 = keras.layers.Subtract(name = 'Sub67420', )([Fla21604,Con38272])
Res61382 = keras.layers.Reshape((4, 1), name = 'Res61382', )(Sub67420)
Sep30014 = keras.layers.SeparableConv1D(4, (4),strides=(4), padding='valid', name = 'Sep30014', )(Res61382)
model = tf.keras.models.Model(inputs=[in0Add5724,in1Add5724,in0Mas74105,in0Con38272], outputs=Sep30014)
w = model.get_layer('Sep30014').get_weights() 
w[0] = np.array([[[0.2994]], [[0.3064]], [[0.6299]], [[0.8976]]])
w[1] = np.array([[[0.4232, 0.4113, 0.9152, 0.5307]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep30014').set_weights(w) 
in0Add5724 = tf.constant([[[0.4986, 0.1817], [0.7568, 0.706]]])
in1Add5724 = tf.constant([[[0.6002, 0.9702], [0.8137, 0.8062]]])
in0Mas74105 = tf.constant([[[[1.6392, 1.478, 1.8263, 1.6033], [1.7074, 1.8489, 1.476, 1.1468], [1.7548, 1.0693, 1.2389, 1.3239]], [[1.7073, 1.6999, 1.7594, 1.1916], [1.0495, 1.0937, 1.6051, 1.1151], [1.5826, 1.6753, 1.8729, 1.5664]], [[1.6613, 1.7991, 1.9785, 1.2757], [1.586, 1.684, 1.0994, 1.7936], [1.9893, 1.9288, 1.1698, 1.4245]], [[1.9897, 1.1555, 1.024, 1.9197], [1.6074, 1.3954, 1.2741, 1.2835], [1.4385, 1.9382, 1.7747, 1.5347]]]])
in0Con38272 = tf.constant([[0.0466, 0.4267, 0.1427]])
print (np.array2string(model.predict([in0Add5724,in1Add5724,in0Mas74105,in0Con38272],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep30014.png')

LAdd5724 = add_layer([[[[0.4986, 0.1817], [0.7568, 0.706]]], [[[0.6002, 0.9702], [0.8137, 0.8062]]]], Add5724), 
LFla21604 = flatten_layer(Add5724, Fla21604), 
LMas74105 = masking_layer([[[[1.6392, 1.478, 1.8263, 1.6033], [1.7074, 1.8489, 1.476, 1.1468], [1.7548, 1.0693, 1.2389, 1.3239]], [[1.7073, 1.6999, 1.7594, 1.1916], [1.0495, 1.0937, 1.6051, 1.1151], [1.5826, 1.6753, 1.8729, 1.5664]], [[1.6613, 1.7991, 1.9785, 1.2757], [1.586, 1.684, 1.0994, 1.7936], [1.9893, 1.9288, 1.1698, 1.4245]], [[1.9897, 1.1555, 1.024, 1.9197], [1.6074, 1.3954, 1.2741, 1.2835], [1.4385, 1.9382, 1.7747, 1.5347]]]], 1, Mas74105), 
LRes5252 = reshape_layer(Mas74105, [4, 3, 4, 1], Res5252), 
LGlo5034 = global_max_pool3D_layer(Res5252, Glo5034), 
LCon38272 = concatenate_layer([Glo5034,[[0.0466, 0.4267, 0.1427]]], 1, Con38272), 
LSub67420 = subtract_layer(Fla21604,Con38272, Sub67420), 
LRes61382 = reshape_layer(Sub67420, [4, 1], Res61382), 
LSep30014 = separable_conv1D_layer(Res61382, 4,[[[[0.2994]], [[0.3064]], [[0.6299]], [[0.8976]]],[[[0.4232, 0.4113, 0.9152, 0.5307]]]],[0, 0, 0, 0], 4, false, Sep30014), 
exec_layers([LAdd5724,LFla21604,LMas74105,LRes5252,LGlo5034,LCon38272,LSub67420,LRes61382,LSep30014],["Add5724","Fla21604","Mas74105","Res5252","Glo5034","Con38272","Sub67420","Res61382","Sep30014"],Sep30014,"Sep30014")

Actual (Unparsed): [[[0.8555713, 0.8315134, 1.8502336, 1.0729010]]]

Expected (Unparsed): [[[0.855571285696,0.8315133974639999,1.850233555456,1.072900948296]]]

Actual:   [[[0.8556, 0.8316, 1.8503, 1.073]]]

Expected: [[[0.8556, 0.8316, 1.8503, 1.073]]]