import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot7611 = tf.keras.layers.Input(shape=([2]))
in1Dot7611 = tf.keras.layers.Input(shape=([2]))
in0Con6113 = tf.keras.layers.Input(shape=([1]))
in0Dot83177 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot83177 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul26413 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Mul26413 = tf.keras.layers.Input(shape=([1, 1, 1]))

Dot7611 = keras.layers.Dot(axes=(1, 1), name = 'Dot7611', )([in0Dot7611,in1Dot7611])
Con6113 = keras.layers.Concatenate(axis=1, name = 'Con6113', )([Dot7611,in0Con6113])
Dot83177 = keras.layers.Dot(axes=(2, 2), name = 'Dot83177', )([in0Dot83177,in1Dot83177])
Res43827 = keras.layers.Reshape((2, 2, 1), name = 'Res43827', )(Dot83177)
Mul26413 = keras.layers.Multiply(name = 'Mul26413', )([in0Mul26413,in1Mul26413])
Zer54698 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer54698', )(Mul26413)
Max70315 = keras.layers.Maximum(name = 'Max70315', )([Res43827,Zer54698])
Res28010 = keras.layers.Reshape((2, 2), name = 'Res28010', )(Max70315)
Glo15993 = keras.layers.GlobalAveragePooling1D(name = 'Glo15993', )(Res28010)
Mul10311 = keras.layers.Multiply(name = 'Mul10311', )([Con6113,Glo15993])
model = tf.keras.models.Model(inputs=[in0Dot7611,in1Dot7611,in0Con6113,in0Dot83177,in1Dot83177,in0Mul26413,in1Mul26413], outputs=Mul10311)
in0Dot7611 = tf.constant([[0.9321, 0.2546]])
in1Dot7611 = tf.constant([[0.4893, 0.548]])
in0Con6113 = tf.constant([[0.606]])
in0Dot83177 = tf.constant([[[0.7621, 0.3247], [0.0743, 0.4166]]])
in1Dot83177 = tf.constant([[[0.5026, 0.1409], [0.6781, 0.1525]]])
in0Mul26413 = tf.constant([[[[0.2575]]]])
in1Mul26413 = tf.constant([[[[0.7007]]]])
print (np.array2string(model.predict([in0Dot7611,in1Dot7611,in0Con6113,in0Dot83177,in1Dot83177,in0Mul26413,in1Mul26413],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul10311.png')

LDot7611 = dot_layer([[0.9321, 0.2546]], [[0.4893, 0.548]], 1, 1, Dot7611), 
LCon6113 = concatenate_layer([Dot7611,[[0.606]]], 1, Con6113), 
LDot83177 = dot_layer([[[0.7621, 0.3247], [0.0743, 0.4166]]], [[[0.5026, 0.1409], [0.6781, 0.1525]]], 2, 2, Dot83177), 
LRes43827 = reshape_layer(Dot83177, [2, 2, 1], Res43827), 
LMul26413 = multiply_layer([[[[[0.2575]]]], [[[[0.7007]]]]], Mul26413), 
LZer54698 = zero_padding2D_layer(Mul26413, 1, 0, 1, 0, Zer54698), 
LMax70315 = maximum_layer([Res43827,Zer54698], Max70315), 
LRes28010 = reshape_layer(Max70315, [2, 2], Res28010), 
LGlo15993 = global_average_pooling1D_layer(Res28010, Glo15993), 
LMul10311 = multiply_layer([Con6113,Glo15993], Mul10311), 
exec_layers([LDot7611,LCon6113,LDot83177,LRes43827,LMul26413,LZer54698,LMax70315,LRes28010,LGlo15993,LMul10311],["Dot7611","Con6113","Dot83177","Res43827","Mul26413","Zer54698","Max70315","Res28010","Glo15993","Mul10311"],Mul10311,"Mul10311")

Actual (Unparsed): [[0.1562918, 0.2262583]]

Expected (Unparsed): [[0.15629182997821367,0.22625828403]]

Actual:   [[0.1563, 0.2263]]

Expected: [[0.1563, 0.2263]]