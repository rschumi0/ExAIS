import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add64660 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Add64660 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Add35452 = tf.keras.layers.Input(shape=([1, 1]))
in1Add35452 = tf.keras.layers.Input(shape=([1, 1]))
in0Con23253 = tf.keras.layers.Input(shape=([1, 1]))
in0Mul83952 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Mul83952 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Glo31079 = tf.keras.layers.Input(shape=([2, 1, 2]))

Add64660 = keras.layers.Add(name = 'Add64660', )([in0Add64660,in1Add64660])
Lea54385 = keras.layers.LeakyReLU(alpha=3.2498235724334266, name = 'Lea54385', )(Add64660)
Res83948 = keras.layers.Reshape((1, 2), name = 'Res83948', )(Lea54385)
Add35452 = keras.layers.Add(name = 'Add35452', )([in0Add35452,in1Add35452])
Con23253 = keras.layers.Concatenate(axis=2, name = 'Con23253', )([Add35452,in0Con23253])
Add34417 = keras.layers.Add(name = 'Add34417', )([Res83948,Con23253])
Ave39958 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave39958', )(Add34417)
Res95024 = keras.layers.Reshape((1, 2, 1), name = 'Res95024', )(Ave39958)
Zer89829 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer89829', )(Res95024)
Mul83952 = keras.layers.Multiply(name = 'Mul83952', )([in0Mul83952,in1Mul83952])
Res96142 = keras.layers.Reshape((2, 1, 1), name = 'Res96142', )(Mul83952)
Glo31079 = keras.layers.GlobalMaxPool2D(name = 'Glo31079', )(in0Glo31079)
Res99547 = keras.layers.Reshape((2, 1), name = 'Res99547', )(Glo31079)
Res45427 = keras.layers.Reshape((2, 1, 1), name = 'Res45427', )(Res99547)
Dep49092 = keras.layers.DepthwiseConv2D((1, 1),strides=(2, 2), padding='valid', name = 'Dep49092', )(Res45427)
Zer20544 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer20544', )(Dep49092)
Mul40568 = keras.layers.Multiply(name = 'Mul40568', )([Res96142,Zer20544])
Zer19993 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer19993', )(Mul40568)
Ave11565 = keras.layers.Average(name = 'Ave11565', )([Zer89829,Zer19993])
model = tf.keras.models.Model(inputs=[in0Add64660,in1Add64660,in0Add35452,in1Add35452,in0Con23253,in0Mul83952,in1Mul83952,in0Glo31079], outputs=Ave11565)
w = model.get_layer('Dep49092').get_weights() 
w[0] = np.array([[[[0.1735]]]])
w[1] = np.array([0])
model.get_layer('Dep49092').set_weights(w) 
in0Add64660 = tf.constant([[[[0.6494, 0.6237]]]])
in1Add64660 = tf.constant([[[[0.9286, 0.1807]]]])
in0Add35452 = tf.constant([[[0.0928]]])
in1Add35452 = tf.constant([[[0.4485]]])
in0Con23253 = tf.constant([[[0.3101]]])
in0Mul83952 = tf.constant([[[[[0.2596]]], [[[0.922]]]]])
in1Mul83952 = tf.constant([[[[[0.0135]]], [[[0.674]]]]])
in0Glo31079 = tf.constant([[[[1.1426, 1.865]], [[1.5068, 1.0256]]]])
print (np.array2string(model.predict([in0Add64660,in1Add64660,in0Add35452,in1Add35452,in0Con23253,in0Mul83952,in1Mul83952,in0Glo31079],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave11565.png')

LAdd64660 = add_layer([[[[[0.6494, 0.6237]]]], [[[[0.9286, 0.1807]]]]], Add64660), 
LLea54385 = leaky_relu_layer(Add64660, 3.2498235724334266, Lea54385), 
LRes83948 = reshape_layer(Lea54385, [1, 2], Res83948), 
LAdd35452 = add_layer([[[[0.0928]]], [[[0.4485]]]], Add35452), 
LCon23253 = concatenate_layer([Add35452,[[[0.3101]]]], 2, Con23253), 
LAdd34417 = add_layer([Res83948,Con23253], Add34417), 
LAve39958 = average_pooling1D_layer(Add34417, 1, Ave39958), 
LRes95024 = reshape_layer(Ave39958, [1, 2, 1], Res95024), 
LZer89829 = zero_padding2D_layer(Res95024, 1, 0, 1, 0, Zer89829), 
LMul83952 = multiply_layer([[[[[[0.2596]]], [[[0.922]]]]], [[[[[0.0135]]], [[[0.674]]]]]], Mul83952), 
LRes96142 = reshape_layer(Mul83952, [2, 1, 1], Res96142), 
LGlo31079 = global_max_pool2D_layer([[[[1.1426, 1.865]], [[1.5068, 1.0256]]]], Glo31079), 
LRes99547 = reshape_layer(Glo31079, [2, 1], Res99547), 
LRes45427 = reshape_layer(Res99547, [2, 1, 1], Res45427), 
LDep49092 = depthwise_conv2D_layer(Res45427, 1, 1,[[[[0.1735]]]],[0], 2, 2, false, Dep49092), 
LZer20544 = zero_padding2D_layer(Dep49092, 1, 0, 0, 0, Zer20544), 
LMul40568 = multiply_layer([Res96142,Zer20544], Mul40568), 
LZer19993 = zero_padding2D_layer(Mul40568, 0, 0, 2, 0, Zer19993), 
LAve11565 = average_layer([Zer89829,Zer19993], Ave11565), 
exec_layers([LAdd64660,LLea54385,LRes83948,LAdd35452,LCon23253,LAdd34417,LAve39958,LRes95024,LZer89829,LMul83952,LRes96142,LGlo31079,LRes99547,LRes45427,LDep49092,LZer20544,LMul40568,LZer19993,LAve11565],["Add64660","Lea54385","Res83948","Add35452","Con23253","Add34417","Ave39958","Res95024","Zer89829","Mul83952","Res96142","Glo31079","Res99547","Res45427","Dep49092","Zer20544","Mul40568","Zer19993","Ave11565"],Ave11565,"Ave11565")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.0596500], [0.6384799]]]]

Expected (Unparsed): [[[[0],[0],[0.0]],[[0],[1.05965],[0.6384798988772]]]]

Actual:   [[[[0], [0], [0]], [[0], [1.0597], [0.6385]]]]

Expected: [[[[0], [0], [0]], [[0], [1.0597], [0.6385]]]]