import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max18870 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max18870 = tf.keras.layers.Input(shape=([1, 1, 1]))

Max18870 = keras.layers.Maximum(name = 'Max18870', )([in0Max18870,in1Max18870])
Res47520 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res47520', )(Max18870)
Glo45594 = keras.layers.GlobalMaxPool3D(name = 'Glo45594', )(Res47520)
Lea18084 = keras.layers.LeakyReLU(alpha=0.31373742764715223, name = 'Lea18084', )(Glo45594)
model = tf.keras.models.Model(inputs=[in0Max18870,in1Max18870], outputs=Lea18084)
in0Max18870 = tf.constant([[[[0.1718]]]])
in1Max18870 = tf.constant([[[[0.3689]]]])
print (np.array2string(model.predict([in0Max18870,in1Max18870],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lea18084.png')

LMax18870 = maximum_layer([[[[[0.1718]]]], [[[[0.3689]]]]], Max18870), 
LRes47520 = reshape_layer(Max18870, [1, 1, 1, 1], Res47520), 
LGlo45594 = global_max_pool3D_layer(Res47520, Glo45594), 
LLea18084 = leaky_relu_layer(Glo45594, 0.31373742764715223, Lea18084), 
exec_layers([LMax18870,LRes47520,LGlo45594,LLea18084],["Max18870","Res47520","Glo45594","Lea18084"],Lea18084,"Lea18084")

Actual (Unparsed): [[0.3689000]]

Expected (Unparsed): [[0.3689]]

Actual:   [[0.3689]]

Expected: [[0.3689]]