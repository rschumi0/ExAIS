import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc71226 = tf.keras.layers.Input(shape=([2, 1]))

Loc71226 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc71226', )(in0Loc71226)
Res31354 = keras.layers.Reshape((2, 4, 1), name = 'Res31354', )(Loc71226)
Loc60805 = keras.layers.LocallyConnected2D(2, (1, 2),strides=(1, 1), name = 'Loc60805', )(Res31354)
Res19636 = keras.layers.Reshape((2, 3, 2, 1), name = 'Res19636', )(Loc60805)
Con29333 = keras.layers.Conv3DTranspose(3, (1, 3, 2),strides=(1, 1, 1), padding='same', name = 'Con29333', )(Res19636)
model = tf.keras.models.Model(inputs=[in0Loc71226], outputs=Con29333)
w = model.get_layer('Loc71226').get_weights() 
w[0] = np.array([[[0.9903, 0.2809, 0.7517, 0.7652]], [[0.3623, 0.4964, 0.7524, 0.5154]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc71226').set_weights(w) 
w = model.get_layer('Loc60805').get_weights() 
w[0] = np.array([[[0.7887, 0.8228], [0.2971, 0.9243]], [[0.939, 0.1806], [0.7481, 0.4368]], [[0.7219, 0.3657], [0.2228, 0.8251]], [[0.0985, 0.2711], [0.8576, 0.0695]], [[0.7292, 0.4867], [0.9609, 0.0191]], [[0.9956, 0.0444], [0.6057, 0.363]]])
w[1] = np.array([[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]])
model.get_layer('Loc60805').set_weights(w) 
w = model.get_layer('Con29333').get_weights() 
w[0] = np.array([[[[[0.3272], [0.2716], [0.9027]], [[0.6024], [0.5264], [0.6862]]], [[[0.6021], [0.9477], [0.2781]], [[0.085], [0.4228], [0.8022]]], [[[0.5692], [0.272], [0.1348]], [[0.1754], [0.5212], [0.8669]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con29333').set_weights(w) 
in0Loc71226 = tf.constant([[[0.9666], [0.5419]]])
print (np.array2string(model.predict([in0Loc71226],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con29333.png')

LLoc71226 = locally_connected1D_layer([[[0.9666], [0.5419]]], 1,[[[0.9903, 0.2809, 0.7517, 0.7652]], [[0.3623, 0.4964, 0.7524, 0.5154]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc71226), 
LRes31354 = reshape_layer(Loc71226, [2, 4, 1], Res31354), 
LLoc60805 = locally_connected2D_layer(Res31354, 1, 2,[[[0.7887, 0.8228], [0.2971, 0.9243]], [[0.939, 0.1806], [0.7481, 0.4368]], [[0.7219, 0.3657], [0.2228, 0.8251]], [[0.0985, 0.2711], [0.8576, 0.0695]], [[0.7292, 0.4867], [0.9609, 0.0191]], [[0.9956, 0.0444], [0.6057, 0.363]]],[[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], 1, 1, Loc60805), 
LRes19636 = reshape_layer(Loc60805, [2, 3, 2, 1], Res19636), 
LCon29333 = conv3D_transpose_layer(Res19636, 1, 3, 2,[[[[[0.3272], [0.2716], [0.9027]], [[0.6024], [0.5264], [0.6862]]], [[[0.6021], [0.9477], [0.2781]], [[0.085], [0.4228], [0.8022]]], [[[0.5692], [0.272], [0.1348]], [[0.1754], [0.5212], [0.8669]]]]],[0, 0, 0], 1, 1, 1, true, Con29333), 
exec_layers([LLoc71226,LRes31354,LLoc60805,LRes19636,LCon29333],["Loc71226","Res31354","Loc60805","Res19636","Con29333"],Con29333,"Con29333")

Actual (Unparsed): [[[[[0.7644088, 1.0088050, 0.9532126], [1.2972687, 1.8574137, 1.8378730]], [[1.1819751, 1.1712680, 0.9569605], [1.7280849, 2.0036620, 2.8706499]], [[0.8695570, 0.8704659, 0.2993403], [0.9346503, 1.6374766, 1.5382155]]], [[[0.3429176, 0.3966394, 0.6002653], [0.4641155, 0.5210366, 0.7492328]], [[0.6844885, 0.7813946, 0.7163532], [0.6038214, 0.8650999, 1.2391617]], [[0.6809222, 0.7049420, 0.2391895], [0.3029045, 0.7005527, 1.0229563]]]]]

Expected (Unparsed): [[[[[0.7644088007342422,1.008805015754107,0.9532126146956634],[1.2972686545680536,1.8574137124961672,1.837872959199939]],[[1.181975120033499,1.1712679560725958,0.956960456595948],[1.72808491831668,2.0036619594200986,2.8706499422179]],[[0.8695569768847758,0.8704658883215719,0.29934033940399507],[0.9346502997749394,1.637476573352942,1.5382155065432652]]],[[[0.34291760856729525,0.39663940926495134,0.6002653026762692],[0.46411552412292373,0.5210366605414638,0.7492328226055778]],[[0.6844885673701704,0.781394653531506,0.716353219445757],[0.6038213975625606,0.8650999274814691,1.2391617282604588]],[[0.680922261755347,0.7049419880037806,0.2391895054873006],[0.3029044870231384,0.7005526807421563,1.0229563823868868]]]]]

Actual:   [[[[[0.7645, 1.0089, 0.9533], [1.2973, 1.8575, 1.8379]], [[1.182, 1.1713, 0.957], [1.7281, 2.0037, 2.8707]], [[0.8696, 0.8705, 0.2994], [0.9347, 1.6375, 1.5383]]], [[[0.343, 0.3967, 0.6003], [0.4642, 0.5211, 0.7493]], [[0.6845, 0.7814, 0.7164], [0.6039, 0.8651, 1.2392]], [[0.681, 0.705, 0.2392], [0.303, 0.7006, 1.023]]]]]

Expected: [[[[[0.7645, 1.0089, 0.9533], [1.2973, 1.8575, 1.8379]], [[1.182, 1.1713, 0.957], [1.7281, 2.0037, 2.8707]], [[0.8696, 0.8705, 0.2994], [0.9347, 1.6375, 1.5383]]], [[[0.343, 0.3967, 0.6003], [0.4642, 0.5211, 0.7493]], [[0.6845, 0.7814, 0.7164], [0.6039, 0.8651, 1.2392]], [[0.681, 0.705, 0.2392], [0.303, 0.7006, 1.023]]]]]