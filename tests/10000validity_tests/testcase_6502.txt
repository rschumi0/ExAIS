import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con840 = tf.keras.layers.Input(shape=([1, 2]))

Con840 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con840', )(in0Con840)
Loc62712 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc62712', )(Con840)
Res72916 = keras.layers.Reshape((1, 3, 1), name = 'Res72916', )(Loc62712)
Con35843 = keras.layers.Conv2D(4, (1, 2),strides=(1, 3), padding='same', dilation_rate=(1, 1), name = 'Con35843', )(Res72916)
Res77141 = keras.layers.Reshape((1, 4), name = 'Res77141', )(Con35843)
Con27093 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con27093', )(Res77141)
ELU50937 = keras.layers.ELU(alpha=6.4264570537216095, name = 'ELU50937', )(Con27093)
Res48660 = keras.layers.Reshape((1, 3, 1), name = 'Res48660', )(ELU50937)
Loc34830 = keras.layers.LocallyConnected2D(4, (1, 3),strides=(1, 1), name = 'Loc34830', )(Res48660)
model = tf.keras.models.Model(inputs=[in0Con840], outputs=Loc34830)
w = model.get_layer('Con840').get_weights() 
w[0] = np.array([[[0.4952, 0.5486, 0.7856], [0.6562, 0.2701, 0.3362]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con840').set_weights(w) 
w = model.get_layer('Loc62712').get_weights() 
w[0] = np.array([[[0.0953, 0.0069, 0.0331], [0.5235, 0.5899, 0.1439], [0.4507, 0.2675, 0.639]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc62712').set_weights(w) 
w = model.get_layer('Con35843').get_weights() 
w[0] = np.array([[[[0.7009, 0.3002, 0.3823, 0.9507]], [[0.5569, 0.2389, 0.994, 0.4783]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con35843').set_weights(w) 
w = model.get_layer('Con27093').get_weights() 
w[0] = np.array([[[0.4539, 0.9966, 0.3458], [0.3989, 0.1511, 0.8583], [0.3674, 0.693, 0.0129], [0.6468, 0.1935, 0.1958]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con27093').set_weights(w) 
w = model.get_layer('Loc34830').get_weights() 
w[0] = np.array([[[0.3673, 0.9828, 0.3727, 0.8131], [0.8108, 0.1802, 0.2013, 0.6038], [0.408, 0.6802, 0.6617, 0.7653]]])
w[1] = np.array([[[0, 0, 0, 0]]])
model.get_layer('Loc34830').set_weights(w) 
in0Con840 = tf.constant([[[0.9499, 0.5398]]])
print (np.array2string(model.predict([in0Con840],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc34830.png')

LCon840 = conv1D_layer([[[0.9499, 0.5398]]], 1,[[[0.4952, 0.5486, 0.7856], [0.6562, 0.2701, 0.3362]]],[0, 0, 0], 1, true, 1, Con840), 
LLoc62712 = locally_connected1D_layer(Con840, 1,[[[0.0953, 0.0069, 0.0331], [0.5235, 0.5899, 0.1439], [0.4507, 0.2675, 0.639]]],[[0, 0, 0]], 1, Loc62712), 
LRes72916 = reshape_layer(Loc62712, [1, 3, 1], Res72916), 
LCon35843 = conv2D_layer(Res72916, 1, 2,[[[[0.7009, 0.3002, 0.3823, 0.9507]], [[0.5569, 0.2389, 0.994, 0.4783]]]],[0, 0, 0, 0], 1, 3, true, 1, 1, Con35843), 
LRes77141 = reshape_layer(Con35843, [1, 4], Res77141), 
LCon27093 = conv1D_layer(Res77141, 1,[[[0.4539, 0.9966, 0.3458], [0.3989, 0.1511, 0.8583], [0.3674, 0.693, 0.0129], [0.6468, 0.1935, 0.1958]]],[0, 0, 0], 1, true, 1, Con27093), 
LELU50937 = elu_layer(Con27093, 6.4264570537216095, ELU50937), 
LRes48660 = reshape_layer(ELU50937, [1, 3, 1], Res48660), 
LLoc34830 = locally_connected2D_layer(Res48660, 1, 3,[[[0.3673, 0.9828, 0.3727, 0.8131], [0.8108, 0.1802, 0.2013, 0.6038], [0.408, 0.6802, 0.6617, 0.7653]]],[[[0, 0, 0, 0]]], 1, 1, Loc34830), 
exec_layers([LCon840,LLoc62712,LRes72916,LCon35843,LRes77141,LCon27093,LELU50937,LRes48660,LLoc34830],["Con840","Loc62712","Res72916","Con35843","Res77141","Con27093","ELU50937","Res48660","Loc34830"],Loc34830,"Loc34830")

Actual (Unparsed): [[[[2.5237746, 2.6039308, 1.6074987, 3.2015207]]]]

Expected (Unparsed): [[[[2.523774671187093,2.6039309086255793,1.6074986985325506,3.2015207465185345]]]]

Actual:   [[[[2.5238, 2.604, 1.6075, 3.2016]]]]

Expected: [[[[2.5238, 2.604, 1.6075, 3.2016]]]]