import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add27268 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Add27268 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Con38198 = tf.keras.layers.Input(shape=([28]))
in0Con15272 = tf.keras.layers.Input(shape=([2, 1]))
in0Max298 = tf.keras.layers.Input(shape=([2, 1]))
in1Max298 = tf.keras.layers.Input(shape=([2, 1]))
in0Sub28739 = tf.keras.layers.Input(shape=([2]))
in1Sub28739 = tf.keras.layers.Input(shape=([2]))
in0Con79935 = tf.keras.layers.Input(shape=([30]))

Add27268 = keras.layers.Add(name = 'Add27268', )([in0Add27268,in1Add27268])
Res68126 = keras.layers.Reshape((1, 1, 4), name = 'Res68126', )(Add27268)
Res82778 = keras.layers.Reshape((1, 4), name = 'Res82778', )(Res68126)
Fla88166 = keras.layers.Flatten(name = 'Fla88166', )(Res82778)
Con38198 = keras.layers.Concatenate(axis=1, name = 'Con38198', )([Fla88166,in0Con38198])
Con15272 = keras.layers.Conv1D(4, (1),strides=(5), padding='valid', dilation_rate=(1), name = 'Con15272', )(in0Con15272)
Res80426 = keras.layers.Reshape((1, 4, 1), name = 'Res80426', )(Con15272)
Res90891 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res90891', )(Res80426)
Up_6672 = keras.layers.UpSampling3D(size=(2, 2, 2), name = 'Up_6672', )(Res90891)
Sof26502 = keras.layers.Softmax(axis=1, name = 'Sof26502', )(Up_6672)
Res68649 = keras.layers.Reshape((2, 8, 2), name = 'Res68649', )(Sof26502)
Res83154 = keras.layers.Reshape((2, 16), name = 'Res83154', )(Res68649)
Fla58918 = keras.layers.Flatten(name = 'Fla58918', )(Res83154)
Max298 = keras.layers.Maximum(name = 'Max298', )([in0Max298,in1Max298])
Fla74496 = keras.layers.Flatten(name = 'Fla74496', )(Max298)
Sub28739 = keras.layers.Subtract(name = 'Sub28739', )([in0Sub28739,in1Sub28739])
Sub86650 = keras.layers.Subtract(name = 'Sub86650', )([Fla74496,Sub28739])
Con79935 = keras.layers.Concatenate(axis=1, name = 'Con79935', )([Sub86650,in0Con79935])
Max42774 = keras.layers.Maximum(name = 'Max42774', )([Fla58918,Con79935])
Dot33928 = keras.layers.Dot(axes=(1, 1), name = 'Dot33928', )([Con38198,Max42774])
model = tf.keras.models.Model(inputs=[in0Add27268,in1Add27268,in0Con38198,in0Con15272,in0Max298,in1Max298,in0Sub28739,in1Sub28739,in0Con79935], outputs=Dot33928)
w = model.get_layer('Con15272').get_weights() 
w[0] = np.array([[[0.4493, 0.5617, 0.1055, 0.1504]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con15272').set_weights(w) 
in0Add27268 = tf.constant([[[[[0.7978, 0.1222], [0.926, 0.5585]]]]])
in1Add27268 = tf.constant([[[[[0.0675, 0.4094], [0.4914, 0.4648]]]]])
in0Con38198 = tf.constant([[0.9553, 0.9441, 0.7498, 0.9768, 0.6556, 0.5123, 0.7122, 0.7127, 0.6478, 0.4932, 0.374, 0.299, 0.9677, 0.7039, 0.2998, 0.8548, 0.7757, 0.4654, 0.6301, 0.8, 0.1637, 0.2491, 0.9649, 0.6247, 0.9788, 0.966, 0.6733, 0.2934]])
in0Con15272 = tf.constant([[[0.4519], [0.1505]]])
in0Max298 = tf.constant([[[0.4413], [0.5248]]])
in1Max298 = tf.constant([[[0.5416], [0.2869]]])
in0Sub28739 = tf.constant([[0.6603, 0.7906]])
in1Sub28739 = tf.constant([[0.0939, 0.8127]])
in0Con79935 = tf.constant([[0.8212, 0.1262, 0.8003, 0.9826, 0.5255, 0.6114, 0.6394, 0.4487, 0.6286, 0.3945, 0.9363, 0.2179, 0.9772, 0.8043, 0.7872, 0.5389, 0.1277, 0.9641, 0.8066, 0.6664, 0.2921, 0.1931, 0.2768, 0.3094, 0.3724, 0.5238, 0.1417, 0.0881, 0.0164, 0.4675]])
print (np.array2string(model.predict([in0Add27268,in1Add27268,in0Con38198,in0Con15272,in0Max298,in1Max298,in0Sub28739,in1Sub28739,in0Con79935],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot33928.png')

LAdd27268 = add_layer([[[[[[0.7978, 0.1222], [0.926, 0.5585]]]]], [[[[[0.0675, 0.4094], [0.4914, 0.4648]]]]]], Add27268), 
LRes68126 = reshape_layer(Add27268, [1, 1, 4], Res68126), 
LRes82778 = reshape_layer(Res68126, [1, 4], Res82778), 
LFla88166 = flatten_layer(Res82778, Fla88166), 
LCon38198 = concatenate_layer([Fla88166,[[0.9553, 0.9441, 0.7498, 0.9768, 0.6556, 0.5123, 0.7122, 0.7127, 0.6478, 0.4932, 0.374, 0.299, 0.9677, 0.7039, 0.2998, 0.8548, 0.7757, 0.4654, 0.6301, 0.8, 0.1637, 0.2491, 0.9649, 0.6247, 0.9788, 0.966, 0.6733, 0.2934]]], 1, Con38198), 
LCon15272 = conv1D_layer([[[0.4519], [0.1505]]], 1,[[[0.4493, 0.5617, 0.1055, 0.1504]]],[0, 0, 0, 0], 5, false, 1, Con15272), 
LRes80426 = reshape_layer(Con15272, [1, 4, 1], Res80426), 
LRes90891 = reshape_layer(Res80426, [1, 4, 1, 1], Res90891), 
LUp_6672 = up_sampling3D_layer(Res90891, 2, 2, 2, Up_6672), 
LSof26502 = softmax_layer(Up_6672, 1, Sof26502), 
LRes68649 = reshape_layer(Sof26502, [2, 8, 2], Res68649), 
LRes83154 = reshape_layer(Res68649, [2, 16], Res83154), 
LFla58918 = flatten_layer(Res83154, Fla58918), 
LMax298 = maximum_layer([[[[0.4413], [0.5248]]], [[[0.5416], [0.2869]]]], Max298), 
LFla74496 = flatten_layer(Max298, Fla74496), 
LSub28739 = subtract_layer([[0.6603, 0.7906]], [[0.0939, 0.8127]], Sub28739), 
LSub86650 = subtract_layer(Fla74496,Sub28739, Sub86650), 
LCon79935 = concatenate_layer([Sub86650,[[0.8212, 0.1262, 0.8003, 0.9826, 0.5255, 0.6114, 0.6394, 0.4487, 0.6286, 0.3945, 0.9363, 0.2179, 0.9772, 0.8043, 0.7872, 0.5389, 0.1277, 0.9641, 0.8066, 0.6664, 0.2921, 0.1931, 0.2768, 0.3094, 0.3724, 0.5238, 0.1417, 0.0881, 0.0164, 0.4675]]], 1, Con79935), 
LMax42774 = maximum_layer([Fla58918,Con79935], Max42774), 
LDot33928 = dot_layer(Con38198,Max42774, 1, 1, Dot33928), 
exec_layers([LAdd27268,LRes68126,LRes82778,LFla88166,LCon38198,LCon15272,LRes80426,LRes90891,LUp_6672,LSof26502,LRes68649,LRes83154,LFla58918,LMax298,LFla74496,LSub28739,LSub86650,LCon79935,LMax42774,LDot33928],["Add27268","Res68126","Res82778","Fla88166","Con38198","Con15272","Res80426","Res90891","Up_6672","Sof26502","Res68649","Res83154","Fla58918","Max298","Fla74496","Sub28739","Sub86650","Con79935","Max42774","Dot33928"],Dot33928,"Dot33928")

Actual (Unparsed): [[14.2587167]]

Expected (Unparsed): [[14.25871666]]

Actual:   [[14.2588]]

Expected: [[14.2588]]