import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add29765 = tf.keras.layers.Input(shape=([2, 1]))
in1Add29765 = tf.keras.layers.Input(shape=([2, 1]))
in0Glo50103 = tf.keras.layers.Input(shape=([1, 2]))
in0Con62826 = tf.keras.layers.Input(shape=([1]))
in0Sub12746 = tf.keras.layers.Input(shape=([3]))
in1Sub12746 = tf.keras.layers.Input(shape=([3]))
in0Con38560 = tf.keras.layers.Input(shape=([3]))

Add29765 = keras.layers.Add(name = 'Add29765', )([in0Add29765,in1Add29765])
Res82565 = keras.layers.Reshape((2, 1, 1), name = 'Res82565', )(Add29765)
Con70805 = keras.layers.Conv2DTranspose(2, (2, 1),strides=(1, 1), padding='valid', name = 'Con70805', )(Res82565)
Res75131 = keras.layers.Reshape((3, 2), name = 'Res75131', )(Con70805)
Fla38839 = keras.layers.Flatten(name = 'Fla38839', )(Res75131)
Glo50103 = keras.layers.GlobalMaxPool1D(name = 'Glo50103', )(in0Glo50103)
Con62826 = keras.layers.Concatenate(axis=1, name = 'Con62826', )([Glo50103,in0Con62826])
Sub12746 = keras.layers.Subtract(name = 'Sub12746', )([in0Sub12746,in1Sub12746])
Max58613 = keras.layers.Maximum(name = 'Max58613', )([Con62826,Sub12746])
Con38560 = keras.layers.Concatenate(axis=1, name = 'Con38560', )([Max58613,in0Con38560])
Ave81688 = keras.layers.Average(name = 'Ave81688', )([Fla38839,Con38560])
Res36335 = keras.layers.Reshape((6, 1), name = 'Res36335', )(Ave81688)
Res65892 = keras.layers.Reshape((6, 1, 1), name = 'Res65892', )(Res36335)
Res17217 = keras.layers.Reshape((6, 1, 1, 1), name = 'Res17217', )(Res65892)
Con50 = keras.layers.Conv3D(2, (5, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con50', )(Res17217)
model = tf.keras.models.Model(inputs=[in0Add29765,in1Add29765,in0Glo50103,in0Con62826,in0Sub12746,in1Sub12746,in0Con38560], outputs=Con50)
w = model.get_layer('Con70805').get_weights() 
w[0] = np.array([[[[0.6555], [0.8965]]], [[[0.7176], [0.3218]]]])
w[1] = np.array([0, 0])
model.get_layer('Con70805').set_weights(w) 
w = model.get_layer('Con50').get_weights() 
w[0] = np.array([[[[[0.6559, 0.0866]]]], [[[[0.0501, 0.82]]]], [[[[0.0742, 0.5201]]]], [[[[0.1488, 0.4121]]]], [[[[0.0948, 0.0433]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con50').set_weights(w) 
in0Add29765 = tf.constant([[[0.0922], [0.6607]]])
in1Add29765 = tf.constant([[[0.067], [0.364]]])
in0Glo50103 = tf.constant([[[1.7645, 1.1229]]])
in0Con62826 = tf.constant([[0.3377]])
in0Sub12746 = tf.constant([[0.0585, 0.6156, 0.3988]])
in1Sub12746 = tf.constant([[0.6509, 0.3481, 0.7837]])
in0Con38560 = tf.constant([[0.9562, 0.7786, 0.4008]])
print (np.array2string(model.predict([in0Add29765,in1Add29765,in0Glo50103,in0Con62826,in0Sub12746,in1Sub12746,in0Con38560],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con50.png')

LAdd29765 = add_layer([[[[0.0922], [0.6607]]], [[[0.067], [0.364]]]], Add29765), 
LRes82565 = reshape_layer(Add29765, [2, 1, 1], Res82565), 
LCon70805 = conv2D_transpose_layer(Res82565, 2, 1,[[[[0.6555], [0.8965]]], [[[0.7176], [0.3218]]]],[0, 0], 1, 1, false, Con70805), 
LRes75131 = reshape_layer(Con70805, [3, 2], Res75131), 
LFla38839 = flatten_layer(Res75131, Fla38839), 
LGlo50103 = global_max_pool1D_layer([[[1.7645, 1.1229]]], Glo50103), 
LCon62826 = concatenate_layer([Glo50103,[[0.3377]]], 1, Con62826), 
LSub12746 = subtract_layer([[0.0585, 0.6156, 0.3988]], [[0.6509, 0.3481, 0.7837]], Sub12746), 
LMax58613 = maximum_layer([Con62826,Sub12746], Max58613), 
LCon38560 = concatenate_layer([Max58613,[[0.9562, 0.7786, 0.4008]]], 1, Con38560), 
LAve81688 = average_layer([Fla38839,Con38560], Ave81688), 
LRes36335 = reshape_layer(Ave81688, [6, 1], Res36335), 
LRes65892 = reshape_layer(Res36335, [6, 1, 1], Res65892), 
LRes17217 = reshape_layer(Res65892, [6, 1, 1, 1], Res17217), 
LCon50 = conv3D_layer(Res17217, 5, 1, 1,[[[[[0.6559, 0.0866]]]], [[[[0.0501, 0.82]]]], [[[[0.0742, 0.5201]]]], [[[[0.1488, 0.4121]]]], [[[[0.0948, 0.0433]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con50), 
exec_layers([LAdd29765,LRes82565,LCon70805,LRes75131,LFla38839,LGlo50103,LCon62826,LSub12746,LMax58613,LCon38560,LAve81688,LRes36335,LRes65892,LRes17217,LCon50],["Add29765","Res82565","Con70805","Res75131","Fla38839","Glo50103","Con62826","Sub12746","Max58613","Con38560","Ave81688","Res36335","Res65892","Res17217","Con50"],Con50,"Con50")

Actual (Unparsed): [[[[[0.9013418, 1.3216716]]], [[[0.6619293, 1.3441271]]]]]

Expected (Unparsed): [[[[[0.901341766439,1.3216715378719999]]],[[[0.6619293438014999,1.3441270379605]]]]]

Actual:   [[[[[0.9014, 1.3217]]], [[[0.662, 1.3442]]]]]

Expected: [[[[[0.9014, 1.3217]]], [[[0.662, 1.3442]]]]]