import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub5520 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub5520 = tf.keras.layers.Input(shape=([2, 3]))
in0Min42119 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min42119 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Sub14247 = tf.keras.layers.Input(shape=([2]))
in1Sub14247 = tf.keras.layers.Input(shape=([2]))
in0Con25048 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Max74178 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max74178 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con33756 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Sub47195 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub47195 = tf.keras.layers.Input(shape=([2, 3]))
in0Con13851 = tf.keras.layers.Input(shape=([2, 3]))

Sub5520 = keras.layers.Subtract(name = 'Sub5520', )([in0Sub5520,in1Sub5520])
Res18125 = keras.layers.Reshape((2, 3, 1), name = 'Res18125', )(Sub5520)
Con11353 = keras.layers.Conv2D(2, (2, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con11353', )(Res18125)
Res55727 = keras.layers.Reshape((1, 6), name = 'Res55727', )(Con11353)
Zer58694 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer58694', )(Res55727)
Min42119 = keras.layers.Minimum(name = 'Min42119', )([in0Min42119,in1Min42119])
Den16598 = keras.layers.Dense(3,name = 'Den16598', )(Min42119)
Sub14247 = keras.layers.Subtract(name = 'Sub14247', )([in0Sub14247,in1Sub14247])
Res42109 = keras.layers.Reshape((2, 1), name = 'Res42109', )(Sub14247)
Res94810 = keras.layers.Reshape((2, 1, 1), name = 'Res94810', )(Res42109)
Con25048 = keras.layers.Concatenate(axis=3, name = 'Con25048', )([Res94810,in0Con25048])
Max74178 = keras.layers.Maximum(name = 'Max74178', )([in0Max74178,in1Max74178])
Mul12279 = keras.layers.Multiply(name = 'Mul12279', )([Con25048,Max74178])
Con33756 = keras.layers.Concatenate(axis=3, name = 'Con33756', )([Mul12279,in0Con33756])
Mul36162 = keras.layers.Multiply(name = 'Mul36162', )([Den16598,Con33756])
Res84184 = keras.layers.Reshape((2, 3), name = 'Res84184', )(Mul36162)
Sub47195 = keras.layers.Subtract(name = 'Sub47195', )([in0Sub47195,in1Sub47195])
Add30148 = keras.layers.Add(name = 'Add30148', )([Res84184,Sub47195])
Con13851 = keras.layers.Concatenate(axis=2, name = 'Con13851', )([Add30148,in0Con13851])
Max60390 = keras.layers.Maximum(name = 'Max60390', )([Zer58694,Con13851])
model = tf.keras.models.Model(inputs=[in0Sub5520,in1Sub5520,in0Min42119,in1Min42119,in0Sub14247,in1Sub14247,in0Con25048,in0Max74178,in1Max74178,in0Con33756,in0Sub47195,in1Sub47195,in0Con13851], outputs=Max60390)
w = model.get_layer('Con11353').get_weights() 
w[0] = np.array([[[[0.9742, 0.7988]]], [[[0.1772, 0.8796]]]])
w[1] = np.array([0, 0])
model.get_layer('Con11353').set_weights(w) 
w = model.get_layer('Den16598').get_weights() 
w[0] = np.array([[0.476, 0.6843, 0.2135]])
w[1] = np.array([0.0619, 0.6161, 0.4037])
model.get_layer('Den16598').set_weights(w) 
in0Sub5520 = tf.constant([[[0.7875, 0.2743, 0.9194], [0.2576, 0.0944, 0.6571]]])
in1Sub5520 = tf.constant([[[0.4391, 0.0113, 0.2268], [0.9911, 0.3492, 0.6285]]])
in0Min42119 = tf.constant([[[[0.7126]], [[0.8032]]]])
in1Min42119 = tf.constant([[[[0.7592]], [[0.9408]]]])
in0Sub14247 = tf.constant([[0.0825, 0.3777]])
in1Sub14247 = tf.constant([[0.5953, 0.0278]])
in0Con25048 = tf.constant([[[[0.8349]], [[0.0481]]]])
in0Max74178 = tf.constant([[[[0.0754, 0.2692]], [[0.6486, 0.2181]]]])
in1Max74178 = tf.constant([[[[0.9422, 0.3521]], [[0.1422, 0.3201]]]])
in0Con33756 = tf.constant([[[[0.403]], [[0.6041]]]])
in0Sub47195 = tf.constant([[[0.9974, 0.4467, 0.2281], [0.1084, 0.695, 0.7017]]])
in1Sub47195 = tf.constant([[[0.7853, 0.1853, 0.5435], [0.2035, 0.2514, 0.0826]]])
in0Con13851 = tf.constant([[[0.3576, 0.4385, 0.3546], [0.3338, 0.2247, 0.5343]]])
print (np.array2string(model.predict([in0Sub5520,in1Sub5520,in0Min42119,in1Min42119,in0Sub14247,in1Sub14247,in0Con25048,in0Max74178,in1Max74178,in0Con33756,in0Sub47195,in1Sub47195,in0Con13851],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max60390.png')

LSub5520 = subtract_layer([[[0.7875, 0.2743, 0.9194], [0.2576, 0.0944, 0.6571]]], [[[0.4391, 0.0113, 0.2268], [0.9911, 0.3492, 0.6285]]], Sub5520), 
LRes18125 = reshape_layer(Sub5520, [2, 3, 1], Res18125), 
LCon11353 = conv2D_layer(Res18125, 2, 1,[[[[0.9742, 0.7988]]], [[[0.1772, 0.8796]]]],[0, 0], 1, 1, false, 1, 1, Con11353), 
LRes55727 = reshape_layer(Con11353, [1, 6], Res55727), 
LZer58694 = zero_padding1D_layer(Res55727, 1, 0, Zer58694), 
LMin42119 = minimum_layer([[[[[0.7126]], [[0.8032]]]], [[[[0.7592]], [[0.9408]]]]], Min42119), 
LDen16598 = dense_layer(Min42119, [[0.476, 0.6843, 0.2135]],[0.0619, 0.6161, 0.4037], Den16598), 
LSub14247 = subtract_layer([[0.0825, 0.3777]], [[0.5953, 0.0278]], Sub14247), 
LRes42109 = reshape_layer(Sub14247, [2, 1], Res42109), 
LRes94810 = reshape_layer(Res42109, [2, 1, 1], Res94810), 
LCon25048 = concatenate_layer([Res94810,[[[[0.8349]], [[0.0481]]]]], 3, Con25048), 
LMax74178 = maximum_layer([[[[[0.0754, 0.2692]], [[0.6486, 0.2181]]]], [[[[0.9422, 0.3521]], [[0.1422, 0.3201]]]]], Max74178), 
LMul12279 = multiply_layer([Con25048,Max74178], Mul12279), 
LCon33756 = concatenate_layer([Mul12279,[[[[0.403]], [[0.6041]]]]], 3, Con33756), 
LMul36162 = multiply_layer([Den16598,Con33756], Mul36162), 
LRes84184 = reshape_layer(Mul36162, [2, 3], Res84184), 
LSub47195 = subtract_layer([[[0.9974, 0.4467, 0.2281], [0.1084, 0.695, 0.7017]]], [[[0.7853, 0.1853, 0.5435], [0.2035, 0.2514, 0.0826]]], Sub47195), 
LAdd30148 = add_layer([Res84184,Sub47195], Add30148), 
LCon13851 = concatenate_layer([Add30148,[[[0.3576, 0.4385, 0.3546], [0.3338, 0.2247, 0.5343]]]], 2, Con13851), 
LMax60390 = maximum_layer([Zer58694,Con13851], Max60390), 
exec_layers([LSub5520,LRes18125,LCon11353,LRes55727,LZer58694,LMin42119,LDen16598,LSub14247,LRes42109,LRes94810,LCon25048,LMax74178,LMul12279,LCon33756,LMul36162,LRes84184,LSub47195,LAdd30148,LCon13851,LMax60390],["Sub5520","Res18125","Con11353","Res55727","Zer58694","Min42119","Den16598","Sub14247","Res42109","Res94810","Con25048","Max74178","Mul12279","Con33756","Mul36162","Res84184","Sub47195","Add30148","Con13851","Max60390"],Max60390,"Max60390")

Actual (Unparsed): [[[0.0183056, 0.5858623, 0.0000000, 0.3576000, 0.4385000, 0.3546000], [0.2094351, 0.4615485, 0.9665681, 0.3338000, 0.6797988, 0.5784055]]]

Expected (Unparsed): [[[0.018305619408383933,0.5858622615725722,0,0.3576,0.4385,0.3546],[0.20943507999999997,0.4615485196260655,0.96656817112,0.3338,0.67979884,0.57840544]]]

Actual:   [[[0.0184, 0.5859, 0, 0.3576, 0.4385, 0.3546], [0.2095, 0.4616, 0.9666, 0.3338, 0.6798, 0.5785]]]

Expected: [[[0.0184, 0.5859, 0, 0.3576, 0.4385, 0.3546], [0.2095, 0.4616, 0.9666, 0.3338, 0.6798, 0.5785]]]