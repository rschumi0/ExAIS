import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU60207 = tf.keras.layers.Input(shape=([2, 3]))

GRU60207 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU60207', )(in0GRU60207)
Res91254 = keras.layers.Reshape((1, 1), name = 'Res91254', )(GRU60207)
Res31987 = keras.layers.Reshape((1, 1, 1), name = 'Res31987', )(Res91254)
Res34165 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res34165', )(Res31987)
Con11323 = keras.layers.Conv3DTranspose(4, (1, 1, 1),strides=(5, 1, 1), padding='valid', name = 'Con11323', )(Res34165)
Res26765 = keras.layers.Reshape((5, 1, 4), name = 'Res26765', )(Con11323)
Up_36955 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_36955', )(Res26765)
Sep97713 = keras.layers.SeparableConv2D(2, (5, 2),strides=(2, 2), padding='same', name = 'Sep97713', )(Up_36955)
model = tf.keras.models.Model(inputs=[in0GRU60207], outputs=Sep97713)
w = model.get_layer('GRU60207').get_weights() 
w[0] = np.array([[1, 4, 10], [4, 1, 1], [7, 2, 8]])
w[1] = np.array([[10, 10, 1]])
w[2] = np.array([8, 5, 8])
model.get_layer('GRU60207').set_weights(w) 
w = model.get_layer('Con11323').get_weights() 
w[0] = np.array([[[[[0.9027], [0.8457], [0.4348], [0.5722]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con11323').set_weights(w) 
w = model.get_layer('Sep97713').get_weights() 
w[0] = np.array([[[[0.8029], [0.0965], [0.3391], [0.9441]], [[0.5475], [0.3122], [0.5605], [0.4345]]], [[[0.0264], [0.3051], [0.406], [0.8222]], [[0.7243], [0.8593], [0.1712], [0.2601]]], [[[0.6016], [0.0445], [0.3807], [0.6887]], [[0.2165], [0.3642], [0.4519], [0.0534]]], [[[0.597], [0.6877], [0.7715], [0.9772]], [[0.8368], [0.6346], [0.707], [0.8694]]], [[[0.0491], [0.589], [0.9933], [0.8527]], [[0.7501], [0.0613], [0.1424], [0.8184]]]])
w[1] = np.array([[[[0.7595, 0.808], [0.9969, 0.2906], [0.3103, 0.6048], [0.5498, 0.1095]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep97713').set_weights(w) 
in0GRU60207 = tf.constant([[[5, 5, 3], [5, 9, 6]]])
print (np.array2string(model.predict([in0GRU60207],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep97713.png')

LGRU60207 = gru_layer([[[5, 5, 3], [5, 9, 6]]],[[1, 4, 10], [4, 1, 1], [7, 2, 8]],[[10, 10, 1]],[8, 5, 8], false, GRU60207), 
LRes91254 = reshape_layer(GRU60207, [1, 1], Res91254), 
LRes31987 = reshape_layer(Res91254, [1, 1, 1], Res31987), 
LRes34165 = reshape_layer(Res31987, [1, 1, 1, 1], Res34165), 
LCon11323 = conv3D_transpose_layer(Res34165, 1, 1, 1,[[[[[0.9027], [0.8457], [0.4348], [0.5722]]]]],[0, 0, 0, 0], 5, 1, 1, false, Con11323), 
LRes26765 = reshape_layer(Con11323, [5, 1, 4], Res26765), 
LUp_36955 = up_sampling2D_layer(Res26765, 1, 2, Up_36955), 
LSep97713 = separable_conv2D_layer(Up_36955, 5, 2,[[[[[0.8029], [0.0965], [0.3391], [0.9441]], [[0.5475], [0.3122], [0.5605], [0.4345]]], [[[0.0264], [0.3051], [0.406], [0.8222]], [[0.7243], [0.8593], [0.1712], [0.2601]]], [[[0.6016], [0.0445], [0.3807], [0.6887]], [[0.2165], [0.3642], [0.4519], [0.0534]]], [[[0.597], [0.6877], [0.7715], [0.9772]], [[0.8368], [0.6346], [0.707], [0.8694]]], [[[0.0491], [0.589], [0.9933], [0.8527]], [[0.7501], [0.0613], [0.1424], [0.8184]]]],[[[[0.7595, 0.808], [0.9969, 0.2906], [0.3103, 0.6048], [0.5498, 0.1095]]]]],[0, 0], 2, 2, true, Sep97713), 
exec_layers([LGRU60207,LRes91254,LRes31987,LRes34165,LCon11323,LRes26765,LUp_36955,LSep97713],["GRU60207","Res91254","Res31987","Res34165","Con11323","Res26765","Up_36955","Sep97713"],Sep97713,"Sep97713")

Actual (Unparsed): [[[[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0.0,0.0]],[[0.0,0.0]],[[0.0,0.0]]]]

Actual:   [[[[0, 0]], [[0, 0]], [[0, 0]]]]

Expected: [[[[0, 0]], [[0, 0]], [[0, 0]]]]