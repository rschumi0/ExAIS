import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add90968 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add90968 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Dot40248 = tf.keras.layers.Input(shape=([2]))
in1Dot40248 = tf.keras.layers.Input(shape=([2]))
in0Con38952 = tf.keras.layers.Input(shape=([1]))
in0Con45187 = tf.keras.layers.Input(shape=([2, 2]))
in0Sub85974 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub85974 = tf.keras.layers.Input(shape=([3, 3]))

Add90968 = keras.layers.Add(name = 'Add90968', )([in0Add90968,in1Add90968])
Res10732 = keras.layers.Reshape((2, 1), name = 'Res10732', )(Add90968)
Fla28183 = keras.layers.Flatten(name = 'Fla28183', )(Res10732)
Dot40248 = keras.layers.Dot(axes=(1, 1), name = 'Dot40248', )([in0Dot40248,in1Dot40248])
Con38952 = keras.layers.Concatenate(axis=1, name = 'Con38952', )([Dot40248,in0Con38952])
Ave43234 = keras.layers.Average(name = 'Ave43234', )([Fla28183,Con38952])
Res52749 = keras.layers.Reshape((2, 1), name = 'Res52749', )(Ave43234)
Con45187 = keras.layers.Concatenate(axis=2, name = 'Con45187', )([Res52749,in0Con45187])
Sub85974 = keras.layers.Subtract(name = 'Sub85974', )([in0Sub85974,in1Sub85974])
Dot73874 = keras.layers.Dot(axes=(2, 2), name = 'Dot73874', )([Con45187,Sub85974])
model = tf.keras.models.Model(inputs=[in0Add90968,in1Add90968,in0Dot40248,in1Dot40248,in0Con38952,in0Con45187,in0Sub85974,in1Sub85974], outputs=Dot73874)
in0Add90968 = tf.constant([[[[0.6579]], [[0.9999]]]])
in1Add90968 = tf.constant([[[[0.5176]], [[0.4162]]]])
in0Dot40248 = tf.constant([[0.101, 0.8073]])
in1Dot40248 = tf.constant([[0.747, 0.7542]])
in0Con38952 = tf.constant([[0.4235]])
in0Con45187 = tf.constant([[[0.7387, 0.9912], [0.2207, 0.364]]])
in0Sub85974 = tf.constant([[[0.395, 0.7139, 0.3868], [0.0537, 0.0014, 0.9497], [0.2707, 0.955, 0.1426]]])
in1Sub85974 = tf.constant([[[0.5832, 0.8955, 0.7742], [0.1775, 0.0395, 0.2221], [0.2199, 0.7723, 0.5771]]])
print (np.array2string(model.predict([in0Add90968,in1Add90968,in0Dot40248,in1Dot40248,in0Con38952,in0Con45187,in0Sub85974,in1Sub85974],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot73874.png')

LAdd90968 = add_layer([[[[[0.6579]], [[0.9999]]]], [[[[0.5176]], [[0.4162]]]]], Add90968), 
LRes10732 = reshape_layer(Add90968, [2, 1], Res10732), 
LFla28183 = flatten_layer(Res10732, Fla28183), 
LDot40248 = dot_layer([[0.101, 0.8073]], [[0.747, 0.7542]], 1, 1, Dot40248), 
LCon38952 = concatenate_layer([Dot40248,[[0.4235]]], 1, Con38952), 
LAve43234 = average_layer([Fla28183,Con38952], Ave43234), 
LRes52749 = reshape_layer(Ave43234, [2, 1], Res52749), 
LCon45187 = concatenate_layer([Res52749,[[[0.7387, 0.9912], [0.2207, 0.364]]]], 2, Con45187), 
LSub85974 = subtract_layer([[[0.395, 0.7139, 0.3868], [0.0537, 0.0014, 0.9497], [0.2707, 0.955, 0.1426]]], [[[0.5832, 0.8955, 0.7742], [0.1775, 0.0395, 0.2221], [0.2199, 0.7723, 0.5771]]], Sub85974), 
LDot73874 = dot_layer(Con45187,Sub85974, 2, 2, Dot73874), 
exec_layers([LAdd90968,LRes10732,LFla28183,LDot40248,LCon38952,LAve43234,LRes52749,LCon45187,LSub85974,LDot73874],["Add90968","Res10732","Fla28183","Dot40248","Con38952","Ave43234","Res52749","Con45187","Sub85974","Dot73874"],Dot73874,"Dot73874")

Actual (Unparsed): [[[-0.6931471, 0.5779302, -0.2484766], [-0.3541991, 0.1425665, -0.0711103]]]

Expected (Unparsed): [[[-0.693147171306,0.5779302463460001,-0.24847666843599991],[-0.35419908000000005,0.14256649,-0.07111026999999998]]]

Actual:   [[[-0.6931, 0.578, -0.2484], [-0.3541, 0.1426, -0.0711]]]

Expected: [[[-0.6931, 0.578, -0.2484], [-0.3541, 0.1426, -0.0711]]]