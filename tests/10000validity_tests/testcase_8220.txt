import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con59965 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Fla58756 = tf.keras.layers.Input(shape=([1, 4, 3]))
in0Con38439 = tf.keras.layers.Input(shape=([3, 23]))

Con59965 = keras.layers.Conv3D(3, (1, 2, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con59965', )(in0Con59965)
Res48239 = keras.layers.Reshape((1, 2, 3), name = 'Res48239', )(Con59965)
Res63523 = keras.layers.Reshape((1, 6), name = 'Res63523', )(Res48239)
Ave46560 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave46560', )(Res63523)
Res15814 = keras.layers.Reshape((1, 6, 1), name = 'Res15814', )(Ave46560)
Con76354 = keras.layers.Conv2D(4, (1, 6),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con76354', )(Res15814)
Res21527 = keras.layers.Reshape((1, 24), name = 'Res21527', )(Con76354)
Zer31953 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer31953', )(Res21527)
Fla58756 = keras.layers.Flatten(name = 'Fla58756', )(in0Fla58756)
Thr12699 = keras.layers.ThresholdedReLU(theta=2.8011955637721497, name = 'Thr12699', )(Fla58756)
Res66978 = keras.layers.Reshape((12, 1), name = 'Res66978', )(Thr12699)
Ave95533 = keras.layers.AveragePooling1D(pool_size=(4), name = 'Ave95533', )(Res66978)
Con38439 = keras.layers.Concatenate(axis=2, name = 'Con38439', )([Ave95533,in0Con38439])
Add57738 = keras.layers.Add(name = 'Add57738', )([Zer31953,Con38439])
model = tf.keras.models.Model(inputs=[in0Con59965,in0Fla58756,in0Con38439], outputs=Add57738)
w = model.get_layer('Con59965').get_weights() 
w[0] = np.array([[[[[0.436, 0.5827, 0.5873], [0.6086, 0.4314, 0.85]]], [[[0.1589, 0.2376, 0.9914], [0.0874, 0.288, 0.0211]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con59965').set_weights(w) 
w = model.get_layer('Con76354').get_weights() 
w[0] = np.array([[[[0.5849, 0.383, 0.3587, 0.5233]], [[0.7493, 0.6891, 0.0391, 0.4098]], [[0.8059, 0.4006, 0.7146, 0.0945]], [[0.0334, 0.0245, 0.0299, 0.5943]], [[0.4487, 0.8626, 0.8445, 0.8273]], [[0.442, 0.0178, 0.7944, 0.3677]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con76354').set_weights(w) 
in0Con59965 = tf.constant([[[[[0.8506, 0.7096]], [[0.0831, 0.9698]]]]])
in0Fla58756 = tf.constant([[[[1.771, 1.6509, 1.4247], [1.9788, 1.8093, 1.6972], [1.813, 1.7331, 1.7028], [1.7936, 1.1054, 1.4441]]]])
in0Con38439 = tf.constant([[[0.2959, 0.0244, 0.049, 0.1031, 0.1085, 0.3397, 0.0635, 0.1727, 0.2163, 0.1385, 0.92, 0.8444, 0.287, 0.2871, 0.114, 0.1119, 0.2864, 0.049, 0.4144, 0.7635, 0.9239, 0.461, 0.4503], [0.4633, 0.8466, 0.3884, 0.8824, 0.7228, 0.2343, 0.2811, 0.3996, 0.0194, 0.9448, 0.7571, 0.0478, 0.8155, 0.6458, 0.2727, 0.9474, 0.2512, 0.4285, 0.303, 0.284, 0.8424, 0.2466, 0.6546], [0.5657, 0.603, 0.1485, 0.7568, 0.5359, 0.6266, 0.6764, 0.0406, 0.7984, 0.3135, 0.9986, 0.8001, 0.1706, 0.109, 0.3067, 0.2571, 0.012, 0.8321, 0.7621, 0.8966, 0.2937, 0.4142, 0.81]]])
print (np.array2string(model.predict([in0Con59965,in0Fla58756,in0Con38439],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add57738.png')

LCon59965 = conv3D_layer([[[[[0.8506, 0.7096]], [[0.0831, 0.9698]]]]], 1, 2, 1,[[[[[0.436, 0.5827, 0.5873], [0.6086, 0.4314, 0.85]]], [[[0.1589, 0.2376, 0.9914], [0.0874, 0.288, 0.0211]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con59965), 
LRes48239 = reshape_layer(Con59965, [1, 2, 3], Res48239), 
LRes63523 = reshape_layer(Res48239, [1, 6], Res63523), 
LAve46560 = average_pooling1D_layer(Res63523, 1, Ave46560), 
LRes15814 = reshape_layer(Ave46560, [1, 6, 1], Res15814), 
LCon76354 = conv2D_layer(Res15814, 1, 6,[[[[0.5849, 0.383, 0.3587, 0.5233]], [[0.7493, 0.6891, 0.0391, 0.4098]], [[0.8059, 0.4006, 0.7146, 0.0945]], [[0.0334, 0.0245, 0.0299, 0.5943]], [[0.4487, 0.8626, 0.8445, 0.8273]], [[0.442, 0.0178, 0.7944, 0.3677]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con76354), 
LRes21527 = reshape_layer(Con76354, [1, 24], Res21527), 
LZer31953 = zero_padding1D_layer(Res21527, 2, 0, Zer31953), 
LFla58756 = flatten_layer([[[[1.771, 1.6509, 1.4247], [1.9788, 1.8093, 1.6972], [1.813, 1.7331, 1.7028], [1.7936, 1.1054, 1.4441]]]], Fla58756), 
LThr12699 = thresholded_relu_layer(Fla58756, 2.8011955637721497, Thr12699), 
LRes66978 = reshape_layer(Thr12699, [12, 1], Res66978), 
LAve95533 = average_pooling1D_layer(Res66978, 4, Ave95533), 
LCon38439 = concatenate_layer([Ave95533,[[[0.2959, 0.0244, 0.049, 0.1031, 0.1085, 0.3397, 0.0635, 0.1727, 0.2163, 0.1385, 0.92, 0.8444, 0.287, 0.2871, 0.114, 0.1119, 0.2864, 0.049, 0.4144, 0.7635, 0.9239, 0.461, 0.4503], [0.4633, 0.8466, 0.3884, 0.8824, 0.7228, 0.2343, 0.2811, 0.3996, 0.0194, 0.9448, 0.7571, 0.0478, 0.8155, 0.6458, 0.2727, 0.9474, 0.2512, 0.4285, 0.303, 0.284, 0.8424, 0.2466, 0.6546], [0.5657, 0.603, 0.1485, 0.7568, 0.5359, 0.6266, 0.6764, 0.0406, 0.7984, 0.3135, 0.9986, 0.8001, 0.1706, 0.109, 0.3067, 0.2571, 0.012, 0.8321, 0.7621, 0.8966, 0.2937, 0.4142, 0.81]]]], 2, Con38439), 
LAdd57738 = add_layer([Zer31953,Con38439], Add57738), 
exec_layers([LCon59965,LRes48239,LRes63523,LAve46560,LRes15814,LCon76354,LRes21527,LZer31953,LFla58756,LThr12699,LRes66978,LAve95533,LCon38439,LAdd57738],["Con59965","Res48239","Res63523","Ave46560","Res15814","Con76354","Res21527","Zer31953","Fla58756","Thr12699","Res66978","Ave95533","Con38439","Add57738"],Add57738,"Add57738")

Actual (Unparsed): [[[0.0000000, 0.2959000, 0.0244000, 0.0490000, 0.1031000, 0.1085000, 0.3397000, 0.0635000, 0.1727000, 0.2163000, 0.1385000, 0.9200000, 0.8444000, 0.2870000, 0.2871000, 0.1140000, 0.1119000, 0.2864000, 0.0490000, 0.4144000, 0.7635000, 0.9239000, 0.4610000, 0.4503000], [0.0000000, 0.4633000, 0.8466000, 0.3884000, 0.8824000, 0.7228000, 0.2343000, 0.2811000, 0.3996000, 0.0194000, 0.9448000, 0.7571000, 0.0478000, 0.8155000, 0.6458000, 0.2727000, 0.9474000, 0.2512000, 0.4285000, 0.3030000, 0.2840000, 0.8424000, 0.2466000, 0.6546000], [1.5804616, 2.0045577, 2.7953003, 2.1155390, 2.8465095, 2.1757733, 2.3843642, 2.5559007, 2.9801171, 2.8184302, 2.6476728, 3.1145005, 3.2595198, 2.4385256, 1.7499811, 2.4357559, 1.8369877, 1.1138091, 1.6487084, 2.2127083, 2.3164397, 1.2050766, 1.2811019, 1.4116257]]]

Expected (Unparsed): [[[0,0.2959,0.0244,0.049,0.1031,0.1085,0.3397,0.0635,0.1727,0.2163,0.1385,0.92,0.8444,0.287,0.2871,0.114,0.1119,0.2864,0.049,0.4144,0.7635,0.9239,0.461,0.4503],[0,0.4633,0.8466,0.3884,0.8824,0.7228,0.2343,0.2811,0.3996,0.0194,0.9448,0.7571,0.0478,0.8155,0.6458,0.2727,0.9474,0.2512,0.4285,0.303,0.284,0.8424,0.2466,0.6546],[1.580461608371,2.004557684316,2.7953002998620002,2.115539008227,2.846509516865,2.175773353009,2.384364180755,2.555900697103,2.980117093794,2.8184302313000003,2.6476728068199997,3.114500516729,3.259519765727,2.438525582881,1.749981093098,2.435755905012,1.8369877084069999,1.1138090878970002,1.6487083955089998,2.2127083586880003,2.316439714566,1.205076610237,1.281101944873,1.411625709421]]]

Actual:   [[[0, 0.2959, 0.0244, 0.049, 0.1031, 0.1085, 0.3397, 0.0635, 0.1727, 0.2163, 0.1385, 0.92, 0.8444, 0.287, 0.2871, 0.114, 0.1119, 0.2864, 0.049, 0.4144, 0.7635, 0.9239, 0.461, 0.4503], [0, 0.4633, 0.8466, 0.3884, 0.8824, 0.7228, 0.2343, 0.2811, 0.3996, 0.0194, 0.9448, 0.7571, 0.0478, 0.8155, 0.6458, 0.2727, 0.9474, 0.2512, 0.4285, 0.303, 0.284, 0.8424, 0.2466, 0.6546], [1.5805, 2.0046, 2.7954, 2.1156, 2.8466, 2.1758, 2.3844, 2.556, 2.9802, 2.8185, 2.6477, 3.1146, 3.2596, 2.4386, 1.75, 2.4358, 1.837, 1.1139, 1.6488, 2.2128, 2.3165, 1.2051, 1.2812, 1.4117]]]

Expected: [[[0, 0.2959, 0.0244, 0.049, 0.1031, 0.1085, 0.3397, 0.0635, 0.1727, 0.2163, 0.1385, 0.92, 0.8444, 0.287, 0.2871, 0.114, 0.1119, 0.2864, 0.049, 0.4144, 0.7635, 0.9239, 0.461, 0.4503], [0, 0.4633, 0.8466, 0.3884, 0.8824, 0.7228, 0.2343, 0.2811, 0.3996, 0.0194, 0.9448, 0.7571, 0.0478, 0.8155, 0.6458, 0.2727, 0.9474, 0.2512, 0.4285, 0.303, 0.284, 0.8424, 0.2466, 0.6546], [1.5805, 2.0046, 2.7954, 2.1156, 2.8466, 2.1758, 2.3844, 2.556, 2.9802, 2.8185, 2.6477, 3.1146, 3.2596, 2.4386, 1.75, 2.4358, 1.837, 1.1139, 1.6488, 2.2128, 2.3165, 1.2051, 1.2812, 1.4117]]]