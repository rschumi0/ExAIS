import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ELU40458 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Up_97777 = tf.keras.layers.Input(shape=([1, 1, 3]))
in0Con28120 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Min30177 = tf.keras.layers.Input(shape=([2, 1]))
in1Min30177 = tf.keras.layers.Input(shape=([2, 1]))
in0Con69133 = tf.keras.layers.Input(shape=([2, 7]))
in0Cro65588 = tf.keras.layers.Input(shape=([4, 3]))
in0Con32363 = tf.keras.layers.Input(shape=([4, 5]))

ELU40458 = keras.layers.ELU(alpha=-8.787914573690935, name = 'ELU40458', input_shape=(2, 1, 1, 2))(in0ELU40458)
Res77993 = keras.layers.Reshape((2, 1, 2), name = 'Res77993', )(ELU40458)
Loc70248 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc70248', )(Res77993)
Zer67702 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer67702', )(Loc70248)
Up_97777 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_97777', )(in0Up_97777)
Con28120 = keras.layers.Concatenate(axis=3, name = 'Con28120', )([Up_97777,in0Con28120])
Ave11071 = keras.layers.Average(name = 'Ave11071', )([Zer67702,Con28120])
Res58334 = keras.layers.Reshape((2, 8), name = 'Res58334', )(Ave11071)
Min30177 = keras.layers.Minimum(name = 'Min30177', )([in0Min30177,in1Min30177])
ReL50311 = keras.layers.ReLU(max_value=4.733095727923941, negative_slope=9.73724178519047, threshold=2.8344967689664458, name = 'ReL50311', )(Min30177)
Con69133 = keras.layers.Concatenate(axis=2, name = 'Con69133', )([ReL50311,in0Con69133])
Ave49431 = keras.layers.Average(name = 'Ave49431', )([Res58334,Con69133])
Zer64436 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer64436', )(Ave49431)
Cro65588 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro65588', )(in0Cro65588)
Con32363 = keras.layers.Concatenate(axis=2, name = 'Con32363', )([Cro65588,in0Con32363])
Min23338 = keras.layers.Minimum(name = 'Min23338', )([Zer64436,Con32363])
model = tf.keras.models.Model(inputs=[in0ELU40458,in0Up_97777,in0Con28120,in0Min30177,in1Min30177,in0Con69133,in0Cro65588,in0Con32363], outputs=Min23338)
w = model.get_layer('Loc70248').get_weights() 
w[0] = np.array([[[0.5232, 0.963, 0.8094, 0.6672], [0.8849, 0.205, 0.2349, 0.5719]], [[0.4066, 0.0777, 0.5005, 0.4112], [0.4553, 0.0419, 0.8031, 0.8149]]])
w[1] = np.array([[[0, 0, 0, 0]], [[0, 0, 0, 0]]])
model.get_layer('Loc70248').set_weights(w) 
in0ELU40458 = tf.constant([[[[[0.6226, 0.6157]]], [[[0.3452, 0.6473]]]]])
in0Up_97777 = tf.constant([[[[1.243, 1.3396, 1.5394]]]])
in0Con28120 = tf.constant([[[[0.9465], [0.7226]], [[0.8043], [0.6046]]]])
in0Min30177 = tf.constant([[[0.5846], [0.5154]]])
in1Min30177 = tf.constant([[[0.3459], [0.0128]]])
in0Con69133 = tf.constant([[[0.4032, 0.757, 0.7982, 0.533, 0.0216, 0.227, 0.7543], [0.1603, 0.3837, 0.9356, 0.4107, 0.2034, 0.7588, 0.5022]]])
in0Cro65588 = tf.constant([[[1.6985, 1.5917, 1.9714], [1.1429, 1.6432, 1.783], [1.6147, 1.9645, 1.8655], [1.8258, 1.466, 1.1243]]])
in0Con32363 = tf.constant([[[0.2321, 0.9766, 0.4961, 0.5456, 0.9099], [0.665, 0.8734, 0.0574, 0.67, 0.8469], [0.3478, 0.2204, 0.5053, 0.5974, 0.4583], [0.1891, 0.8719, 0.3389, 0.707, 0.0405]]])
print (np.array2string(model.predict([in0ELU40458,in0Up_97777,in0Con28120,in0Min30177,in1Min30177,in0Con69133,in0Cro65588,in0Con32363],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min23338.png')

LELU40458 = elu_layer([[[[[0.6226, 0.6157]]], [[[0.3452, 0.6473]]]]], -8.787914573690935, ELU40458), 
LRes77993 = reshape_layer(ELU40458, [2, 1, 2], Res77993), 
LLoc70248 = locally_connected2D_layer(Res77993, 1, 1,[[[0.5232, 0.963, 0.8094, 0.6672], [0.8849, 0.205, 0.2349, 0.5719]], [[0.4066, 0.0777, 0.5005, 0.4112], [0.4553, 0.0419, 0.8031, 0.8149]]],[[[0, 0, 0, 0]], [[0, 0, 0, 0]]], 1, 1, Loc70248), 
LZer67702 = zero_padding2D_layer(Loc70248, 0, 0, 1, 0, Zer67702), 
LUp_97777 = up_sampling2D_layer([[[[1.243, 1.3396, 1.5394]]]], 2, 2, Up_97777), 
LCon28120 = concatenate_layer([Up_97777,[[[[0.9465], [0.7226]], [[0.8043], [0.6046]]]]], 3, Con28120), 
LAve11071 = average_layer([Zer67702,Con28120], Ave11071), 
LRes58334 = reshape_layer(Ave11071, [2, 8], Res58334), 
LMin30177 = minimum_layer([[[[0.5846], [0.5154]]], [[[0.3459], [0.0128]]]], Min30177), 
LReL50311 = relu_layer(Min30177, 4.733095727923941, 9.73724178519047, 2.8344967689664458, ReL50311), 
LCon69133 = concatenate_layer([ReL50311,[[[0.4032, 0.757, 0.7982, 0.533, 0.0216, 0.227, 0.7543], [0.1603, 0.3837, 0.9356, 0.4107, 0.2034, 0.7588, 0.5022]]]], 2, Con69133), 
LAve49431 = average_layer([Res58334,Con69133], Ave49431), 
LZer64436 = zero_padding1D_layer(Ave49431, 2, 0, Zer64436), 
LCro65588 = cropping1D_layer([[[1.6985, 1.5917, 1.9714], [1.1429, 1.6432, 1.783], [1.6147, 1.9645, 1.8655], [1.8258, 1.466, 1.1243]]], 0, 0, Cro65588), 
LCon32363 = concatenate_layer([Cro65588,[[[0.2321, 0.9766, 0.4961, 0.5456, 0.9099], [0.665, 0.8734, 0.0574, 0.67, 0.8469], [0.3478, 0.2204, 0.5053, 0.5974, 0.4583], [0.1891, 0.8719, 0.3389, 0.707, 0.0405]]]], 2, Con32363), 
LMin23338 = minimum_layer([Zer64436,Con32363], Min23338), 
exec_layers([LELU40458,LRes77993,LLoc70248,LZer67702,LUp_97777,LCon28120,LAve11071,LRes58334,LMin30177,LReL50311,LCon69133,LAve49431,LZer64436,LCro65588,LCon32363,LMin23338],["ELU40458","Res77993","Loc70248","Zer67702","Up_97777","Con28120","Ave11071","Res58334","Min30177","ReL50311","Con69133","Ave49431","Zer64436","Cro65588","Con32363","Min23338"],Min23338,"Min23338")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [-11.8052842, 0.5365000, 0.7633500, 0.3478000, 0.2204000, 0.5053000, 0.5974000, 0.4583000], [-13.4270218, 0.4150500, 0.5767000, 0.1891000, 0.6248685, 0.3389000, 0.7070000, 0.0405000]]]

Expected (Unparsed): [[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[-11.805284222635036,0.5365,0.76335,0.3478,0.2204,0.5053,0.5974,0.4583],[-13.427021841958508,0.41505,0.5767,0.1891,0.6248685025,0.3389,0.707,0.0405]]]

Actual:   [[[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [-11.8052, 0.5365, 0.7634, 0.3478, 0.2204, 0.5053, 0.5974, 0.4583], [-13.427, 0.4151, 0.5767, 0.1891, 0.6249, 0.3389, 0.707, 0.0405]]]

Expected: [[[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [-11.8052, 0.5365, 0.7634, 0.3478, 0.2204, 0.5053, 0.5974, 0.4583], [-13.427, 0.4151, 0.5767, 0.1891, 0.6249, 0.3389, 0.707, 0.0405]]]