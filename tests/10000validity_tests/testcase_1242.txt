import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con69426 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Sep62645 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con12836 = tf.keras.layers.Input(shape=([2, 2, 4, 2]))
in0Con16336 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con59717 = tf.keras.layers.Input(shape=([2, 2, 4, 1]))

Con69426 = keras.layers.Conv3DTranspose(4, (2, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con69426', )(in0Con69426)
Mas79596 = keras.layers.Masking(mask_value=1, name = 'Mas79596', )(Con69426)
Zer49855 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (3, 0)), name = 'Zer49855', )(Mas79596)
Sep62645 = keras.layers.SeparableConv2D(3, (1, 1),strides=(2, 2), padding='valid', name = 'Sep62645', )(in0Sep62645)
Res79039 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res79039', )(Sep62645)
Zer18114 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer18114', )(Res79039)
Con12836 = keras.layers.Concatenate(axis=4, name = 'Con12836', )([Zer18114,in0Con12836])
Con16336 = keras.layers.Conv3DTranspose(3, (1, 2, 1),strides=(1, 1, 1), padding='same', name = 'Con16336', )(in0Con16336)
Mas24817 = keras.layers.Masking(mask_value=1, name = 'Mas24817', )(Con16336)
Zer54696 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer54696', )(Mas24817)
Add50374 = keras.layers.Add(name = 'Add50374', )([Con12836,Zer54696])
Con59717 = keras.layers.Concatenate(axis=4, name = 'Con59717', )([Add50374,in0Con59717])
Ave82977 = keras.layers.Average(name = 'Ave82977', )([Zer49855,Con59717])
model = tf.keras.models.Model(inputs=[in0Con69426,in0Sep62645,in0Con12836,in0Con16336,in0Con59717], outputs=Ave82977)
w = model.get_layer('Con69426').get_weights() 
w[0] = np.array([[[[[0.0075, 0.0528], [0.8712, 0.988], [0.9506, 0.3309], [0.9613, 0.3311]]]], [[[[0.7408, 0.5038], [0.0163, 0.7753], [0.8363, 0.304], [0.8635, 0.8205]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con69426').set_weights(w) 
w = model.get_layer('Sep62645').get_weights() 
w[0] = np.array([[[[0.9293], [0.1564]]]])
w[1] = np.array([[[[0.173, 0.6666, 0.6243], [0.3261, 0.8094, 0.8222]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep62645').set_weights(w) 
w = model.get_layer('Con16336').get_weights() 
w[0] = np.array([[[[[0.1768], [0.858], [0.7859]]], [[[0.1754], [0.752], [0.2073]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con16336').set_weights(w) 
in0Con69426 = tf.constant([[[[[0.143, 0.1103]]], [[[0.746, 0.6941]]]]])
in0Sep62645 = tf.constant([[[[0.3602, 0.1178]], [[0.7869, 0.1101]]]])
in0Con12836 = tf.constant([[[[[0.5211, 0.3868], [0.4335, 0.7684], [0.4945, 0.7309], [0.0566, 0.5207]], [[0.9928, 0.4951], [0.1684, 0.3088], [0.233, 0.7449], [0.1432, 0.3118]]], [[[0.6402, 0.45], [0.4012, 0.339], [0.9295, 0.3282], [0.276, 0.6784]], [[0.1031, 0.837], [0.2585, 0.9051], [0.177, 0.308], [0.9385, 0.2671]]]]])
in0Con16336 = tf.constant([[[[[0.3916], [0.6061]], [[0.4364], [0.5613]]], [[[0.7118], [0.4026]], [[0.4086], [0.7455]]]]])
in0Con59717 = tf.constant([[[[[0.8758], [0.9453], [0.7236], [0.4929]], [[0.9583], [0.8414], [0.3611], [0.5818]]], [[[0.247], [0.7826], [0.3431], [0.4506]], [[0.3358], [0.7647], [0.781], [0.5167]]]]])
print (np.array2string(model.predict([in0Con69426,in0Sep62645,in0Con12836,in0Con16336,in0Con59717],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave82977.png')

LCon69426 = conv3D_transpose_layer([[[[[0.143, 0.1103]]], [[[0.746, 0.6941]]]]], 2, 1, 1,[[[[[0.0075, 0.0528], [0.8712, 0.988], [0.9506, 0.3309], [0.9613, 0.3311]]]], [[[[0.7408, 0.5038], [0.0163, 0.7753], [0.8363, 0.304], [0.8635, 0.8205]]]]],[0, 0, 0, 0], 1, 1, 1, true, Con69426), 
LMas79596 = masking_layer(Con69426, 1, Mas79596), 
LZer49855 = zero_padding3D_layer(Mas79596, 0, 0, 1, 0, 3, 0, Zer49855), 
LSep62645 = separable_conv2D_layer([[[[0.3602, 0.1178]], [[0.7869, 0.1101]]]], 1, 1,[[[[[0.9293], [0.1564]]]],[[[[0.173, 0.6666, 0.6243], [0.3261, 0.8094, 0.8222]]]]],[0, 0, 0], 2, 2, false, Sep62645), 
LRes79039 = reshape_layer(Sep62645, [1, 1, 3, 1], Res79039), 
LZer18114 = zero_padding3D_layer(Res79039, 1, 0, 1, 0, 1, 0, Zer18114), 
LCon12836 = concatenate_layer([Zer18114,[[[[[0.5211, 0.3868], [0.4335, 0.7684], [0.4945, 0.7309], [0.0566, 0.5207]], [[0.9928, 0.4951], [0.1684, 0.3088], [0.233, 0.7449], [0.1432, 0.3118]]], [[[0.6402, 0.45], [0.4012, 0.339], [0.9295, 0.3282], [0.276, 0.6784]], [[0.1031, 0.837], [0.2585, 0.9051], [0.177, 0.308], [0.9385, 0.2671]]]]]], 4, Con12836), 
LCon16336 = conv3D_transpose_layer([[[[[0.3916], [0.6061]], [[0.4364], [0.5613]]], [[[0.7118], [0.4026]], [[0.4086], [0.7455]]]]], 1, 2, 1,[[[[[0.1768], [0.858], [0.7859]]], [[[0.1754], [0.752], [0.2073]]]]],[0, 0, 0], 1, 1, 1, true, Con16336), 
LMas24817 = masking_layer(Con16336, 1, Mas24817), 
LZer54696 = zero_padding3D_layer(Mas24817, 0, 0, 0, 0, 2, 0, Zer54696), 
LAdd50374 = add_layer([Con12836,Zer54696], Add50374), 
LCon59717 = concatenate_layer([Add50374,[[[[[0.8758], [0.9453], [0.7236], [0.4929]], [[0.9583], [0.8414], [0.3611], [0.5818]]], [[[0.247], [0.7826], [0.3431], [0.4506]], [[0.3358], [0.7647], [0.781], [0.5167]]]]]], 4, Con59717), 
LAve82977 = average_layer([Zer49855,Con59717], Ave82977), 
exec_layers([LCon69426,LMas79596,LZer49855,LSep62645,LRes79039,LZer18114,LCon12836,LCon16336,LMas24817,LZer54696,LAdd50374,LCon59717,LAve82977],["Con69426","Mas79596","Zer49855","Sep62645","Res79039","Zer18114","Con12836","Con16336","Mas24817","Zer54696","Add50374","Con59717","Ave82977"],Ave82977,"Ave82977")

Actual (Unparsed): [[[[[0.0000000, 0.2605500, 0.1934000, 0.4379000], [0.0000000, 0.2167500, 0.3842000, 0.4726500], [0.0346174, 0.4152464, 0.5193292, 0.3618000], [0.0535792, 0.2883169, 0.4985170, 0.2464500]], [[0.0000000, 0.4964000, 0.2475500, 0.4791500], [0.0000000, 0.0842000, 0.1544000, 0.4207000], [0.0729211, 0.4509572, 0.5845227, 0.1805500], [0.1062221, 0.6570703, 0.5255021, 0.3778931]]], [[[0.0000000, 0.3201000, 0.2250000, 0.1235000], [0.0000000, 0.2006000, 0.1695000, 0.3913000], [0.0629231, 0.7701122, 0.4438018, 0.1715500], [0.0355898, 0.3107154, 0.4974017, 0.2253000]], [[0.0000000, 0.0515500, 0.4185000, 0.1679000], [0.0319585, 0.1292500, 0.4525500, 0.3823500], [0.2175681, 0.5314262, 0.3883374, 0.3905000], [0.3151450, 1.6522134, 1.0141974, 0.8388140]]]]]

Expected (Unparsed): [[[[[0,0.26055,0.1934,0.4379],[0,0.21675,0.3842,0.47265],[0.034617440000000006,0.4152464,0.51932922,0.3618],[0.05357924,0.2883169,0.498516995,0.24645]],[[0,0.4964,0.24755,0.47915],[0,0.0842,0.1544,0.4207],[0.07292108,0.4509572,0.58452272,0.18055],[0.10622206000000001,0.6570703,0.525502135,0.377893115]]],[[[0,0.3201,0.225,0.1235],[0,0.2006,0.1695,0.3913],[0.06292312,0.7701122,0.44380180999999996,0.17155],[0.035589840000000005,0.3107154,0.49740167,0.2253]],[[0,0.05155,0.4185,0.1679],[0.031958499046000004,0.12925,0.45255,0.38235],[0.21756805596200002,0.5314262000000001,0.38833744000000003,0.3905],[0.31514497791100005,1.652213345,1.01419741,0.8388139800000001]]]]]

Actual:   [[[[[0, 0.2606, 0.1934, 0.4379], [0, 0.2168, 0.3842, 0.4727], [0.0347, 0.4153, 0.5194, 0.3618], [0.0536, 0.2884, 0.4986, 0.2465]], [[0, 0.4964, 0.2476, 0.4792], [0, 0.0842, 0.1544, 0.4207], [0.073, 0.451, 0.5846, 0.1806], [0.1063, 0.6571, 0.5256, 0.3779]]], [[[0, 0.3201, 0.225, 0.1235], [0, 0.2006, 0.1695, 0.3913], [0.063, 0.7702, 0.4439, 0.1716], [0.0356, 0.3108, 0.4975, 0.2253]], [[0, 0.0516, 0.4185, 0.1679], [0.032, 0.1293, 0.4526, 0.3824], [0.2176, 0.5315, 0.3884, 0.3905], [0.3152, 1.6523, 1.0142, 0.8389]]]]]

Expected: [[[[[0, 0.2606, 0.1934, 0.4379], [0, 0.2168, 0.3842, 0.4727], [0.0347, 0.4153, 0.5194, 0.3618], [0.0536, 0.2884, 0.4986, 0.2465]], [[0, 0.4964, 0.2476, 0.4792], [0, 0.0842, 0.1544, 0.4207], [0.073, 0.451, 0.5846, 0.1806], [0.1063, 0.6571, 0.5256, 0.3779]]], [[[0, 0.3201, 0.225, 0.1235], [0, 0.2006, 0.1695, 0.3913], [0.063, 0.7702, 0.4439, 0.1716], [0.0356, 0.3108, 0.4975, 0.2253]], [[0, 0.0516, 0.4185, 0.1679], [0.032, 0.1293, 0.4526, 0.3824], [0.2176, 0.5315, 0.3884, 0.3905], [0.3152, 1.6523, 1.0142, 0.8389]]]]]