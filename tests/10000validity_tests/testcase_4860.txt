import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas33588 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sub45217 = tf.keras.layers.Input(shape=([2, 2, 3]))
in1Sub45217 = tf.keras.layers.Input(shape=([2, 2, 3]))

Mas33588 = keras.layers.Masking(mask_value=1, name = 'Mas33588', )(in0Mas33588)
ELU11885 = keras.layers.ELU(alpha=8.120863241648127, name = 'ELU11885', )(Mas33588)
Res9287 = keras.layers.Reshape((2, 4), name = 'Res9287', )(ELU11885)
Sub45217 = keras.layers.Subtract(name = 'Sub45217', )([in0Sub45217,in1Sub45217])
Res68961 = keras.layers.Reshape((2, 6), name = 'Res68961', )(Sub45217)
Dot95377 = keras.layers.Dot(axes=(1, 1), name = 'Dot95377', )([Res9287,Res68961])
model = tf.keras.models.Model(inputs=[in0Mas33588,in0Sub45217,in1Sub45217], outputs=Dot95377)
in0Mas33588 = tf.constant([[[[1.3525, 1.3328], [1.2579, 1.2448]], [[1.3455, 1.1867], [1.5458, 1.69]]]])
in0Sub45217 = tf.constant([[[[0.36, 0.9727, 0.5605], [0.7259, 0.9043, 0.7099]], [[0.3293, 0.7271, 0.2239], [0.9224, 0.2904, 0.3975]]]])
in1Sub45217 = tf.constant([[[[0.7801, 0.1787, 0.2628], [0.9343, 0.9317, 0.9129]], [[0.7907, 0.1636, 0.0502], [0.6622, 0.9989, 0.8307]]]])
print (np.array2string(model.predict([in0Mas33588,in0Sub45217,in1Sub45217],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot95377.png')

LMas33588 = masking_layer([[[[1.3525, 1.3328], [1.2579, 1.2448]], [[1.3455, 1.1867], [1.5458, 1.69]]]], 1, Mas33588), 
LELU11885 = elu_layer(Mas33588, 8.120863241648127, ELU11885), 
LRes9287 = reshape_layer(ELU11885, [2, 4], Res9287), 
LSub45217 = subtract_layer([[[[0.36, 0.9727, 0.5605], [0.7259, 0.9043, 0.7099]], [[0.3293, 0.7271, 0.2239], [0.9224, 0.2904, 0.3975]]]], [[[[0.7801, 0.1787, 0.2628], [0.9343, 0.9317, 0.9129]], [[0.7907, 0.1636, 0.0502], [0.6622, 0.9989, 0.8307]]]], Sub45217), 
LRes68961 = reshape_layer(Sub45217, [2, 6], Res68961), 
LDot95377 = dot_layer(Res9287,Res68961, 1, 1, Dot95377), 
exec_layers([LMas33588,LELU11885,LRes9287,LSub45217,LRes68961,LDot95377],["Mas33588","ELU11885","Res9287","Sub45217","Res68961","Dot95377"],Dot95377,"Dot95377")

Actual (Unparsed): [[[-1.1889989, 1.8320742, 0.6363526, 0.0682381, -0.9903453, -0.8574280], [-1.1074527, 1.7269487, 0.6029044, 0.0310238, -0.8772957, -0.7846367], [-1.2416759, 1.8698309, 0.6429823, 0.1400708, -1.1296658, -0.9249941], [-1.3027065, 1.9406862, 0.6641300, 0.1803217, -1.2314726, -0.9848023]]]

Expected (Unparsed): [[[-1.18899895,1.8320742499999998,0.6363526,0.06823809999999991,-0.99034525,-0.8574281],[-1.10745266,1.72694865,0.60290435,0.03102381999999998,-0.8772956700000001,-0.7846368400000001],[-1.24167591,1.8698309000000002,0.64298229,0.1400708,-1.12966576,-0.9249942600000001],[-1.3027064799999999,1.9406862,0.6641299599999999,0.18032167999999993,-1.23147252,-0.9848024]]]

Actual:   [[[-1.1889, 1.8321, 0.6364, 0.0683, -0.9903, -0.8574], [-1.1074, 1.727, 0.603, 0.0311, -0.8772, -0.7846], [-1.2416, 1.8699, 0.643, 0.1401, -1.1296, -0.9249], [-1.3027, 1.9407, 0.6642, 0.1804, -1.2314, -0.9848]]]

Expected: [[[-1.1889, 1.8321, 0.6364, 0.0683, -0.9903, -0.8574], [-1.1074, 1.727, 0.603, 0.0311, -0.8772, -0.7846], [-1.2416, 1.8699, 0.643, 0.1401, -1.1296, -0.9249], [-1.3027, 1.9407, 0.6642, 0.1804, -1.2314, -0.9848]]]