import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot26664 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot26664 = tf.keras.layers.Input(shape=([3, 2]))
in0Add60458 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add60458 = tf.keras.layers.Input(shape=([1, 2, 1]))

Dot26664 = keras.layers.Dot(axes=(2, 2), name = 'Dot26664', )([in0Dot26664,in1Dot26664])
Lay36078 = keras.layers.LayerNormalization(axis=1, epsilon=2.0803967049309664, name = 'Lay36078', )(Dot26664)
Res45743 = keras.layers.Reshape((3, 3, 1), name = 'Res45743', )(Lay36078)
Add60458 = keras.layers.Add(name = 'Add60458', )([in0Add60458,in1Add60458])
Zer20159 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer20159', )(Add60458)
Ave57974 = keras.layers.Average(name = 'Ave57974', )([Res45743,Zer20159])
Sep154 = keras.layers.SeparableConv2D(2, (1, 2),strides=(3, 3), padding='valid', name = 'Sep154', )(Ave57974)
model = tf.keras.models.Model(inputs=[in0Dot26664,in1Dot26664,in0Add60458,in1Add60458], outputs=Sep154)
w = model.get_layer('Sep154').get_weights() 
w[0] = np.array([[[[0.4697]], [[0.3279]]]])
w[1] = np.array([[[[0.8976, 0.7135]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep154').set_weights(w) 
in0Dot26664 = tf.constant([[[0.9626, 0.8692], [0.5504, 0.5101], [0.3407, 0.9529]]])
in1Dot26664 = tf.constant([[[0.4783, 0.6203], [0.0175, 0.7335], [0.1991, 0.6686]]])
in0Add60458 = tf.constant([[[[0.3071], [0.677]]]])
in1Add60458 = tf.constant([[[[0.0085], [0.0688]]]])
print (np.array2string(model.predict([in0Dot26664,in1Dot26664,in0Add60458,in1Add60458],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep154.png')

LDot26664 = dot_layer([[[0.9626, 0.8692], [0.5504, 0.5101], [0.3407, 0.9529]]], [[[0.4783, 0.6203], [0.0175, 0.7335], [0.1991, 0.6686]]], 2, 2, Dot26664), 
LLay36078 = layer_normalization_layer(Dot26664, 1, 2.0803967049309664, Lay36078), 
LRes45743 = reshape_layer(Lay36078, [3, 3, 1], Res45743), 
LAdd60458 = add_layer([[[[[0.3071], [0.677]]]], [[[[0.0085], [0.0688]]]]], Add60458), 
LZer20159 = zero_padding2D_layer(Add60458, 2, 0, 1, 0, Zer20159), 
LAve57974 = average_layer([Res45743,Zer20159], Ave57974), 
LSep154 = separable_conv2D_layer(Ave57974, 1, 2,[[[[[0.4697]], [[0.3279]]]],[[[[0.8976, 0.7135]]]]],[0, 0], 3, 3, false, Sep154), 
exec_layers([LDot26664,LLay36078,LRes45743,LAdd60458,LZer20159,LAve57974,LSep154],["Dot26664","Lay36078","Res45743","Add60458","Zer20159","Ave57974","Sep154"],Sep154,"Sep154")

Actual (Unparsed): [[[[0.0396395, 0.0315094]]]]

Expected (Unparsed): [[[[0.03963951988488144,0.03150935543433925]]]]

Actual:   [[[[0.0397, 0.0316]]]]

Expected: [[[[0.0397, 0.0316]]]]