import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave42586 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave42586 = tf.keras.layers.Input(shape=([2, 2]))
in0Sim76474 = tf.keras.layers.Input(shape=([2, 2]))
in0Con53650 = tf.keras.layers.Input(shape=([1]))
in0Ave63480 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Ave63480 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Glo89203 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con18192 = tf.keras.layers.Input(shape=([2]))

Ave42586 = keras.layers.Average(name = 'Ave42586', )([in0Ave42586,in1Ave42586])
Max55451 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max55451', )(Ave42586)
Fla51029 = keras.layers.Flatten(name = 'Fla51029', )(Max55451)
Sim76474 = keras.layers.SimpleRNN(3,name = 'Sim76474', )(in0Sim76474)
Con53650 = keras.layers.Concatenate(axis=1, name = 'Con53650', )([Sim76474,in0Con53650])
Ave63480 = keras.layers.Average(name = 'Ave63480', )([in0Ave63480,in1Ave63480])
Res41383 = keras.layers.Reshape((1, 2, 4), name = 'Res41383', )(Ave63480)
Glo3761 = keras.layers.GlobalMaxPool2D(name = 'Glo3761', )(Res41383)
Max49432 = keras.layers.Maximum(name = 'Max49432', )([Con53650,Glo3761])
Glo89203 = keras.layers.GlobalMaxPool2D(name = 'Glo89203', )(in0Glo89203)
Lay97332 = keras.layers.LayerNormalization(axis=1, epsilon=2.417224436657429, name = 'Lay97332', )(Glo89203)
Con18192 = keras.layers.Concatenate(axis=1, name = 'Con18192', )([Lay97332,in0Con18192])
Ave28573 = keras.layers.Average(name = 'Ave28573', )([Max49432,Con18192])
Dot37602 = keras.layers.Dot(axes=(1, 1), name = 'Dot37602', )([Fla51029,Ave28573])
model = tf.keras.models.Model(inputs=[in0Ave42586,in1Ave42586,in0Sim76474,in0Con53650,in0Ave63480,in1Ave63480,in0Glo89203,in0Con18192], outputs=Dot37602)
w = model.get_layer('Sim76474').get_weights() 
w[0] = np.array([[1, 4, 8], [4, 7, 3]])
w[1] = np.array([[6, 8, 9], [4, 3, 10], [4, 9, 1]])
w[2] = np.array([1, 7, 8])
model.get_layer('Sim76474').set_weights(w) 
in0Ave42586 = tf.constant([[[0.4053, 0.2897], [0.284, 0.3039]]])
in1Ave42586 = tf.constant([[[0.9274, 0.2255], [0.7509, 0.6497]]])
in0Sim76474 = tf.constant([[[7, 9], [1, 4]]])
in0Con53650 = tf.constant([[0.6837]])
in0Ave63480 = tf.constant([[[[[0.4383, 0.4027], [0.5518, 0.3346]], [[0.5469, 0.1961], [0.5369, 0.194]]]]])
in1Ave63480 = tf.constant([[[[[0.5647, 0.5928], [0.3524, 0.2306]], [[0.7718, 0.6969], [0.5504, 0.236]]]]])
in0Glo89203 = tf.constant([[[[1.8301, 1.431]], [[1.5404, 1.2409]]]])
in0Con18192 = tf.constant([[0.8704, 0.8854]])
print (np.array2string(model.predict([in0Ave42586,in1Ave42586,in0Sim76474,in0Con53650,in0Ave63480,in1Ave63480,in0Glo89203,in0Con18192],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot37602.png')

LAve42586 = average_layer([[[[0.4053, 0.2897], [0.284, 0.3039]]], [[[0.9274, 0.2255], [0.7509, 0.6497]]]], Ave42586), 
LMax55451 = max_pool1D_layer(Ave42586, 1, Max55451), 
LFla51029 = flatten_layer(Max55451, Fla51029), 
LSim76474 = simple_rnn_layer([[[7, 9], [1, 4]]],[[1, 4, 8], [4, 7, 3]],[[6, 8, 9], [4, 3, 10], [4, 9, 1]],[1, 7, 8], Sim76474), 
LCon53650 = concatenate_layer([Sim76474,[[0.6837]]], 1, Con53650), 
LAve63480 = average_layer([[[[[[0.4383, 0.4027], [0.5518, 0.3346]], [[0.5469, 0.1961], [0.5369, 0.194]]]]], [[[[[0.5647, 0.5928], [0.3524, 0.2306]], [[0.7718, 0.6969], [0.5504, 0.236]]]]]], Ave63480), 
LRes41383 = reshape_layer(Ave63480, [1, 2, 4], Res41383), 
LGlo3761 = global_max_pool2D_layer(Res41383, Glo3761), 
LMax49432 = maximum_layer([Con53650,Glo3761], Max49432), 
LGlo89203 = global_max_pool2D_layer([[[[1.8301, 1.431]], [[1.5404, 1.2409]]]], Glo89203), 
LLay97332 = layer_normalization_layer(Glo89203, 1, 2.417224436657429, Lay97332), 
LCon18192 = concatenate_layer([Lay97332,[[0.8704, 0.8854]]], 1, Con18192), 
LAve28573 = average_layer([Max49432,Con18192], Ave28573), 
LDot37602 = dot_layer(Fla51029,Ave28573, 1, 1, Dot37602), 
exec_layers([LAve42586,LMax55451,LFla51029,LSim76474,LCon53650,LAve63480,LRes41383,LGlo3761,LMax49432,LGlo89203,LLay97332,LCon18192,LAve28573,LDot37602],["Ave42586","Max55451","Fla51029","Sim76474","Con53650","Ave63480","Res41383","Glo3761","Max49432","Glo89203","Lay97332","Con18192","Ave28573","Dot37602"],Dot37602,"Dot37602")

Actual (Unparsed): [[1.3459856]]

Expected (Unparsed): [[1.3459856242492132]]

Actual:   [[1.346]]

Expected: [[1.346]]