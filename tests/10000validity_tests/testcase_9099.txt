import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave24403 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave24403 = tf.keras.layers.Input(shape=([1, 2]))

Ave24403 = keras.layers.Average(name = 'Ave24403', )([in0Ave24403,in1Ave24403])
LST70346 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST70346', )(Ave24403)
ELU44402 = keras.layers.ELU(alpha=6.0617461689725864, name = 'ELU44402', )(LST70346)
model = tf.keras.models.Model(inputs=[in0Ave24403,in1Ave24403], outputs=ELU44402)
w = model.get_layer('LST70346').get_weights() 
w[0] = np.array([[1, 6, 4, 5, 5, 7, 3, 6], [2, 9, 8, 10, 9, 4, 1, 9]])
w[1] = np.array([[2, 4, 10, 3, 2, 5, 3, 3], [5, 7, 3, 8, 10, 10, 9, 3]])
w[2] = np.array([7, 8, 4, 10, 4, 1, 8, 10])
model.get_layer('LST70346').set_weights(w) 
in0Ave24403 = tf.constant([[[0.477, 0.5346]]])
in1Ave24403 = tf.constant([[[0.0942, 0.5307]]])
print (np.array2string(model.predict([in0Ave24403,in1Ave24403],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU44402.png')

LAve24403 = average_layer([[[[0.477, 0.5346]]], [[[0.0942, 0.5307]]]], Ave24403), 
LLST70346 = lstm_layer(Ave24403,[[1, 6, 4, 5, 5, 7, 3, 6], [2, 9, 8, 10, 9, 4, 1, 9]],[[2, 4, 10, 3, 2, 5, 3, 3], [5, 7, 3, 8, 10, 10, 9, 3]],[7, 8, 4, 10, 4, 1, 8, 10], LST70346), 
LELU44402 = elu_layer(LST70346, 6.0617461689725864, ELU44402), 
exec_layers([LAve24403,LLST70346,LELU44402],["Ave24403","LST70346","ELU44402"],ELU44402,"ELU44402")

Actual (Unparsed): [[0.7614313, 0.7615645]]

Expected (Unparsed): [[0.7614313125292435,0.7615644788277584]]

Actual:   [[0.7615, 0.7616]]

Expected: [[0.7615, 0.7616]]