import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot16961 = tf.keras.layers.Input(shape=([2]))
in1Dot16961 = tf.keras.layers.Input(shape=([2]))

Dot16961 = keras.layers.Dot(axes=(1, 1), name = 'Dot16961', )([in0Dot16961,in1Dot16961])
Res41715 = keras.layers.Reshape((1, 1), name = 'Res41715', )(Dot16961)
Per40278 = keras.layers.Permute((1,2), name = 'Per40278',)(Res41715)
model = tf.keras.models.Model(inputs=[in0Dot16961,in1Dot16961], outputs=Per40278)
in0Dot16961 = tf.constant([[0.8894, 0.1742]])
in1Dot16961 = tf.constant([[0.1489, 0.1037]])
print (np.array2string(model.predict([in0Dot16961,in1Dot16961],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per40278.png')

LDot16961 = dot_layer([[0.8894, 0.1742]], [[0.1489, 0.1037]], 1, 1, Dot16961), 
LRes41715 = reshape_layer(Dot16961, [1, 1], Res41715), 
LPer40278 = permute_layer(Res41715, 1,2, Per40278), 
exec_layers([LDot16961,LRes41715,LPer40278],["Dot16961","Res41715","Per40278"],Per40278,"Per40278")

Actual (Unparsed): [[[0.1504962]]]

Expected (Unparsed): [[[0.1504962]]]

Actual:   [[[0.1505]]]

Expected: [[[0.1505]]]