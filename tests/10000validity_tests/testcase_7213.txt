import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add49683 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add49683 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con16986 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Max3298 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max3298 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con54327 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Sub33891 = tf.keras.layers.Input(shape=([2, 2, 3]))
in1Sub33891 = tf.keras.layers.Input(shape=([2, 2, 3]))

Add49683 = keras.layers.Add(name = 'Add49683', )([in0Add49683,in1Add49683])
Con16986 = keras.layers.Concatenate(axis=3, name = 'Con16986', )([Add49683,in0Con16986])
Max3298 = keras.layers.Maximum(name = 'Max3298', )([in0Max3298,in1Max3298])
Zer16400 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer16400', )(Max3298)
Ave86594 = keras.layers.Average(name = 'Ave86594', )([Con16986,Zer16400])
Zer93914 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer93914', )(Ave86594)
Con54327 = keras.layers.Concatenate(axis=3, name = 'Con54327', )([Zer93914,in0Con54327])
Sub33891 = keras.layers.Subtract(name = 'Sub33891', )([in0Sub33891,in1Sub33891])
Mul78680 = keras.layers.Multiply(name = 'Mul78680', )([Con54327,Sub33891])
model = tf.keras.models.Model(inputs=[in0Add49683,in1Add49683,in0Con16986,in0Max3298,in1Max3298,in0Con54327,in0Sub33891,in1Sub33891], outputs=Mul78680)
in0Add49683 = tf.constant([[[[0.9406], [0.8892]]]])
in1Add49683 = tf.constant([[[[0.3421], [0.9287]]]])
in0Con16986 = tf.constant([[[[0.8731], [0.6064]]]])
in0Max3298 = tf.constant([[[[0.2718, 0.8553]]]])
in1Max3298 = tf.constant([[[[0.2217, 0.6989]]]])
in0Con54327 = tf.constant([[[[0.784], [0.8642]], [[0.0721], [0.5815]]]])
in0Sub33891 = tf.constant([[[[0.1465, 0.6805, 0.2442], [0.8846, 0.6978, 0.7713]], [[0.074, 0.7179, 0.0462], [0.767, 0.0901, 0.7069]]]])
in1Sub33891 = tf.constant([[[[0.7224, 0.1928, 0.7084], [0.1626, 0.6676, 0.5186]], [[0.4217, 0.284, 0.7729], [0.9504, 0.694, 0.8926]]]])
print (np.array2string(model.predict([in0Add49683,in1Add49683,in0Con16986,in0Max3298,in1Max3298,in0Con54327,in0Sub33891,in1Sub33891],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul78680.png')

LAdd49683 = add_layer([[[[[0.9406], [0.8892]]]], [[[[0.3421], [0.9287]]]]], Add49683), 
LCon16986 = concatenate_layer([Add49683,[[[[0.8731], [0.6064]]]]], 3, Con16986), 
LMax3298 = maximum_layer([[[[[0.2718, 0.8553]]]], [[[[0.2217, 0.6989]]]]], Max3298), 
LZer16400 = zero_padding2D_layer(Max3298, 0, 0, 1, 0, Zer16400), 
LAve86594 = average_layer([Con16986,Zer16400], Ave86594), 
LZer93914 = zero_padding2D_layer(Ave86594, 1, 0, 0, 0, Zer93914), 
LCon54327 = concatenate_layer([Zer93914,[[[[0.784], [0.8642]], [[0.0721], [0.5815]]]]], 3, Con54327), 
LSub33891 = subtract_layer([[[[0.1465, 0.6805, 0.2442], [0.8846, 0.6978, 0.7713]], [[0.074, 0.7179, 0.0462], [0.767, 0.0901, 0.7069]]]], [[[[0.7224, 0.1928, 0.7084], [0.1626, 0.6676, 0.5186]], [[0.4217, 0.284, 0.7729], [0.9504, 0.694, 0.8926]]]], Sub33891), 
LMul78680 = multiply_layer([Con54327,Sub33891], Mul78680), 
exec_layers([LAdd49683,LCon16986,LMax3298,LZer16400,LAve86594,LZer93914,LCon54327,LSub33891,LMul78680],["Add49683","Con16986","Max3298","Zer16400","Ave86594","Zer93914","Con54327","Sub33891","Mul78680"],Mul78680,"Mul78680")

Actual (Unparsed): [[[[-0.0000000, 0.0000000, -0.3639328], [0.0000000, 0.0000000, 0.2183834]], [[-0.2229974, 0.1894190, -0.0523951], [-0.1916255, -0.4413603, -0.1079845]]]]

Expected (Unparsed): [[[[-0.0,0.0,-0.36393280000000006],[0.0,0.0,0.21838334]],[[-0.222997395,0.189419045,-0.05239507],[-0.19162548999999998,-0.441360315,-0.10798454999999998]]]]

Actual:   [[[[-0, 0, -0.3639], [0, 0, 0.2184]], [[-0.2229, 0.1895, -0.0523], [-0.1916, -0.4413, -0.1079]]]]

Expected: [[[[-0, 0, -0.3639], [0, 0, 0.2184]], [[-0.2229, 0.1895, -0.0523], [-0.1916, -0.4413, -0.1079]]]]