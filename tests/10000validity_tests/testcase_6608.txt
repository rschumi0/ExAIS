import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim94418 = tf.keras.layers.Input(shape=([2, 3]))

Sim94418 = keras.layers.SimpleRNN(1,name = 'Sim94418', )(in0Sim94418)
ReL53466 = keras.layers.ReLU(max_value=1.5400314192967133, negative_slope=9.303740490809844, threshold=3.9667846650702776, name = 'ReL53466', )(Sim94418)
model = tf.keras.models.Model(inputs=[in0Sim94418], outputs=ReL53466)
w = model.get_layer('Sim94418').get_weights() 
w[0] = np.array([[2], [3], [3]])
w[1] = np.array([[2]])
w[2] = np.array([9])
model.get_layer('Sim94418').set_weights(w) 
in0Sim94418 = tf.constant([[[1, 9, 10], [9, 3, 3]]])
print (np.array2string(model.predict([in0Sim94418],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL53466.png')

LSim94418 = simple_rnn_layer([[[1, 9, 10], [9, 3, 3]]],[[2], [3], [3]],[[2]],[9], Sim94418), 
LReL53466 = relu_layer(Sim94418, 1.5400314192967133, 9.303740490809844, 3.9667846650702776, ReL53466), 
exec_layers([LSim94418,LReL53466],["Sim94418","ReL53466"],ReL53466,"ReL53466")

Actual (Unparsed): [[-27.6021946]]

Expected (Unparsed): [[-27.602194615928063]]

Actual:   [[-27.6021]]

Expected: [[-27.6021]]