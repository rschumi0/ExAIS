import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub93015 = tf.keras.layers.Input(shape=([2, 3, 2]))
in1Sub93015 = tf.keras.layers.Input(shape=([2, 3, 2]))
in0Cro70073 = tf.keras.layers.Input(shape=([3, 4, 2, 3]))

Sub93015 = keras.layers.Subtract(name = 'Sub93015', )([in0Sub93015,in1Sub93015])
Res4651 = keras.layers.Reshape((2, 6), name = 'Res4651', )(Sub93015)
Cro70073 = keras.layers.Cropping3D(cropping=((2, 0), (2, 0), (1, 0)), name = 'Cro70073', )(in0Cro70073)
Res62725 = keras.layers.Reshape((1, 2, 3), name = 'Res62725', )(Cro70073)
Res9384 = keras.layers.Reshape((1, 6), name = 'Res9384', )(Res62725)
Zer68331 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer68331', )(Res9384)
Dot64212 = keras.layers.Dot(axes=(1, 1), name = 'Dot64212', )([Res4651,Zer68331])
model = tf.keras.models.Model(inputs=[in0Sub93015,in1Sub93015,in0Cro70073], outputs=Dot64212)
in0Sub93015 = tf.constant([[[[0.2183, 0.3245], [0.8448, 0.6007], [0.8758, 0.0124]], [[0.6192, 0.4478], [0.5005, 0.602], [0.8854, 0.0422]]]])
in1Sub93015 = tf.constant([[[[0.573, 0.2156], [0.3472, 0.7087], [0.7428, 0.4065]], [[0.509, 0.05], [0.6747, 0.2615], [0.5786, 0.6117]]]])
in0Cro70073 = tf.constant([[[[[1.2728, 1.237, 1.8312], [1.862, 1.8693, 1.6355]], [[1.021, 1.6956, 1.8484], [1.9263, 1.2036, 1.4812]], [[1.0903, 1.6925, 1.6338], [1.2684, 1.5659, 1.8497]], [[1.2446, 1.1462, 1.3942], [1.9185, 1.5789, 1.9004]]], [[[1.6765, 1.5615, 1.945], [1.0588, 1.4683, 1.2942]], [[1.9984, 1.1293, 1.3171], [1.2691, 1.9148, 1.3406]], [[1.8973, 1.2952, 1.8097], [1.4744, 1.409, 1.8058]], [[1.0881, 1.4426, 1.5696], [1.3146, 1.9607, 1.1091]]], [[[1.2273, 1.0115, 1.451], [1.4788, 1.8489, 1.5417]], [[1.8358, 1.7871, 1.3961], [1.6818, 1.6109, 1.208]], [[1.3936, 1.5844, 1.7543], [1.8723, 1.3129, 1.4957]], [[1.272, 1.6355, 1.75], [1.3673, 1.7524, 1.5683]]]]])
print (np.array2string(model.predict([in0Sub93015,in1Sub93015,in0Cro70073],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot64212.png')

LSub93015 = subtract_layer([[[[0.2183, 0.3245], [0.8448, 0.6007], [0.8758, 0.0124]], [[0.6192, 0.4478], [0.5005, 0.602], [0.8854, 0.0422]]]], [[[[0.573, 0.2156], [0.3472, 0.7087], [0.7428, 0.4065]], [[0.509, 0.05], [0.6747, 0.2615], [0.5786, 0.6117]]]], Sub93015), 
LRes4651 = reshape_layer(Sub93015, [2, 6], Res4651), 
LCro70073 = cropping3D_layer([[[[[1.2728, 1.237, 1.8312], [1.862, 1.8693, 1.6355]], [[1.021, 1.6956, 1.8484], [1.9263, 1.2036, 1.4812]], [[1.0903, 1.6925, 1.6338], [1.2684, 1.5659, 1.8497]], [[1.2446, 1.1462, 1.3942], [1.9185, 1.5789, 1.9004]]], [[[1.6765, 1.5615, 1.945], [1.0588, 1.4683, 1.2942]], [[1.9984, 1.1293, 1.3171], [1.2691, 1.9148, 1.3406]], [[1.8973, 1.2952, 1.8097], [1.4744, 1.409, 1.8058]], [[1.0881, 1.4426, 1.5696], [1.3146, 1.9607, 1.1091]]], [[[1.2273, 1.0115, 1.451], [1.4788, 1.8489, 1.5417]], [[1.8358, 1.7871, 1.3961], [1.6818, 1.6109, 1.208]], [[1.3936, 1.5844, 1.7543], [1.8723, 1.3129, 1.4957]], [[1.272, 1.6355, 1.75], [1.3673, 1.7524, 1.5683]]]]], 2, 0, 2, 0, 1, 0, Cro70073), 
LRes62725 = reshape_layer(Cro70073, [1, 2, 3], Res62725), 
LRes9384 = reshape_layer(Res62725, [1, 6], Res9384), 
LZer68331 = zero_padding1D_layer(Res9384, 1, 0, Zer68331), 
LDot64212 = dot_layer(Res4651,Zer68331, 1, 1, Dot64212), 
exec_layers([LSub93015,LRes4651,LCro70073,LRes62725,LRes9384,LZer68331,LDot64212],["Sub93015","Res4651","Cro70073","Res62725","Res9384","Zer68331","Dot64212"],Dot64212,"Dot64212")

Actual (Unparsed): [[[0.2063274, 0.1446816, 0.1648261, 0.1506764, 0.1931145, 0.1728266], [0.7448010, 0.5222716, 0.5949895, 0.5439120, 0.6971048, 0.6238698], [-0.3261547, -0.2287072, -0.2605509, -0.2381837, -0.3052681, -0.2731979], [0.6375182, 0.4470424, 0.5092858, 0.4655657, 0.5966922, 0.5340061], [0.5744217, 0.4027977, 0.4588808, 0.4194877, 0.5376363, 0.4811545], [-1.0662749, -0.7476965, -0.8518011, -0.7786774, -0.9979918, -0.8931469]]]

Expected (Unparsed): [[[0.20632745999999993,0.14468157999999995,0.16482613999999995,0.15067645999999996,0.19311447999999992,0.17282665999999994],[0.74480094,0.5222716199999999,0.59498946,0.54391194,0.69710472,0.62386974],[-0.32615466000000004,-0.22870718,-0.26055094000000006,-0.23818366000000002,-0.30526808000000005,-0.27319786],[0.63751815,0.4470424499999999,0.5092858499999999,0.46556564999999994,0.5966921999999999,0.53400615],[0.57442164,0.4027977199999999,0.45888075999999994,0.41948763999999994,0.53763632,0.48115443999999996],[-1.06627485,-0.74769655,-0.85180115,-0.7786773499999999,-0.9979918,-0.89314685]]]

Actual:   [[[0.2064, 0.1447, 0.1649, 0.1507, 0.1932, 0.1729], [0.7449, 0.5223, 0.595, 0.544, 0.6972, 0.6239], [-0.3261, -0.2287, -0.2605, -0.2381, -0.3052, -0.2731], [0.6376, 0.4471, 0.5093, 0.4656, 0.5967, 0.5341], [0.5745, 0.4028, 0.4589, 0.4195, 0.5377, 0.4812], [-1.0662, -0.7476, -0.8518, -0.7786, -0.9979, -0.8931]]]

Expected: [[[0.2064, 0.1447, 0.1649, 0.1507, 0.1932, 0.1729], [0.7449, 0.5223, 0.595, 0.544, 0.6972, 0.6239], [-0.3261, -0.2287, -0.2605, -0.2381, -0.3052, -0.2731], [0.6376, 0.4471, 0.5093, 0.4656, 0.5967, 0.5341], [0.5745, 0.4028, 0.4589, 0.4195, 0.5377, 0.4812], [-1.0662, -0.7476, -0.8518, -0.7786, -0.9979, -0.8931]]]