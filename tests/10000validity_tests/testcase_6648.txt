import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot9762 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot9762 = tf.keras.layers.Input(shape=([2, 2]))
in0Con24045 = tf.keras.layers.Input(shape=([2, 1]))
in0Max86841 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con82648 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Mul55207 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul55207 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Min69233 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min69233 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con37038 = tf.keras.layers.Input(shape=([2, 1, 1]))

Dot9762 = keras.layers.Dot(axes=(1, 1), name = 'Dot9762', )([in0Dot9762,in1Dot9762])
Con24045 = keras.layers.Concatenate(axis=2, name = 'Con24045', )([Dot9762,in0Con24045])
Max86841 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='valid', name = 'Max86841', )(in0Max86841)
Res79042 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res79042', )(Max86841)
Zer80681 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer80681', )(Res79042)
Res39873 = keras.layers.Reshape((3, 3, 3), name = 'Res39873', )(Zer80681)
Res82640 = keras.layers.Reshape((3, 9), name = 'Res82640', )(Res39873)
Loc50293 = keras.layers.LocallyConnected1D(3, (3),strides=(3), name = 'Loc50293', )(Res82640)
Zer69814 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer69814', )(Loc50293)
Ave32360 = keras.layers.Average(name = 'Ave32360', )([Con24045,Zer69814])
Res12532 = keras.layers.Reshape((2, 3, 1), name = 'Res12532', )(Ave32360)
Con82648 = keras.layers.Concatenate(axis=3, name = 'Con82648', )([Res12532,in0Con82648])
Mul55207 = keras.layers.Multiply(name = 'Mul55207', )([in0Mul55207,in1Mul55207])
Zer61425 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer61425', )(Mul55207)
Min69233 = keras.layers.Minimum(name = 'Min69233', )([in0Min69233,in1Min69233])
Con37038 = keras.layers.Concatenate(axis=3, name = 'Con37038', )([Min69233,in0Con37038])
Min70291 = keras.layers.Minimum(name = 'Min70291', )([Zer61425,Con37038])
Zer71565 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer71565', )(Min70291)
Add99038 = keras.layers.Add(name = 'Add99038', )([Con82648,Zer71565])
model = tf.keras.models.Model(inputs=[in0Dot9762,in1Dot9762,in0Con24045,in0Max86841,in0Con82648,in0Mul55207,in1Mul55207,in0Min69233,in1Min69233,in0Con37038], outputs=Add99038)
w = model.get_layer('Loc50293').get_weights() 
w[0] = np.array([[[0.3457, 0.7217, 0.4784], [0.9686, 0.8029, 0.6053], [0.7679, 0.1752, 0.5907], [0.5729, 0.0718, 0.4088], [0.4741, 0.6037, 0.257], [0.6908, 0.7238, 0.8709], [0.4765, 0.3224, 0.2241], [0.8758, 0.0578, 0.1383], [0.9313, 0.9124, 0.271], [0.1728, 0.4496, 0.5179], [0.1809, 0.4244, 0.7168], [0.5411, 0.3381, 0.8414], [0.9202, 0.603, 0.0241], [0.7397, 0.8019, 0.0139], [0.1267, 0.6122, 0.4518], [0.6647, 0.4963, 0.6917], [0.5386, 0.0137, 0.8062], [0.6909, 0.6806, 0.0558], [0.5275, 0.8551, 0.323], [0.0771, 0.6143, 0.8397], [0.0515, 0.0757, 0.8927], [0.949, 0.7495, 0.9584], [0.9498, 0.9604, 0.3842], [0.0129, 0.5234, 0.0964], [0.492, 0.6981, 0.0106], [0.7069, 0.6296, 0.4946], [0.7339, 0.8735, 0.1513]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc50293').set_weights(w) 
in0Dot9762 = tf.constant([[[0.4788, 0.7976], [0.625, 0.5451]]])
in1Dot9762 = tf.constant([[[0.0416, 0.7007], [0.449, 0.0138]]])
in0Con24045 = tf.constant([[[0.3866], [0.3915]]])
in0Max86841 = tf.constant([[[[1.6934]]]])
in0Con82648 = tf.constant([[[[0.008], [0.8081], [0.5542]], [[0.6891], [0.8712], [0.5596]]]])
in0Mul55207 = tf.constant([[[[0.8208, 0.4079]]]])
in1Mul55207 = tf.constant([[[[0.4391, 0.9131]]]])
in0Min69233 = tf.constant([[[[0.0258]], [[0.4249]]]])
in1Min69233 = tf.constant([[[[0.9884]], [[0.5438]]]])
in0Con37038 = tf.constant([[[[0.1135]], [[0.541]]]])
print (np.array2string(model.predict([in0Dot9762,in1Dot9762,in0Con24045,in0Max86841,in0Con82648,in0Mul55207,in1Mul55207,in0Min69233,in1Min69233,in0Con37038],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add99038.png')

LDot9762 = dot_layer([[[0.4788, 0.7976], [0.625, 0.5451]]], [[[0.0416, 0.7007], [0.449, 0.0138]]], 1, 1, Dot9762), 
LCon24045 = concatenate_layer([Dot9762,[[[0.3866], [0.3915]]]], 2, Con24045), 
LMax86841 = max_pool2D_layer([[[[1.6934]]]], 1, 1, 1, 1, false, Max86841), 
LRes79042 = reshape_layer(Max86841, [1, 1, 1, 1], Res79042), 
LZer80681 = zero_padding3D_layer(Res79042, 1, 1, 1, 1, 1, 1, Zer80681), 
LRes39873 = reshape_layer(Zer80681, [3, 3, 3], Res39873), 
LRes82640 = reshape_layer(Res39873, [3, 9], Res82640), 
LLoc50293 = locally_connected1D_layer(Res82640, 3,[[[0.3457, 0.7217, 0.4784], [0.9686, 0.8029, 0.6053], [0.7679, 0.1752, 0.5907], [0.5729, 0.0718, 0.4088], [0.4741, 0.6037, 0.257], [0.6908, 0.7238, 0.8709], [0.4765, 0.3224, 0.2241], [0.8758, 0.0578, 0.1383], [0.9313, 0.9124, 0.271], [0.1728, 0.4496, 0.5179], [0.1809, 0.4244, 0.7168], [0.5411, 0.3381, 0.8414], [0.9202, 0.603, 0.0241], [0.7397, 0.8019, 0.0139], [0.1267, 0.6122, 0.4518], [0.6647, 0.4963, 0.6917], [0.5386, 0.0137, 0.8062], [0.6909, 0.6806, 0.0558], [0.5275, 0.8551, 0.323], [0.0771, 0.6143, 0.8397], [0.0515, 0.0757, 0.8927], [0.949, 0.7495, 0.9584], [0.9498, 0.9604, 0.3842], [0.0129, 0.5234, 0.0964], [0.492, 0.6981, 0.0106], [0.7069, 0.6296, 0.4946], [0.7339, 0.8735, 0.1513]]],[[0, 0, 0]], 3, Loc50293), 
LZer69814 = zero_padding1D_layer(Loc50293, 1, 0, Zer69814), 
LAve32360 = average_layer([Con24045,Zer69814], Ave32360), 
LRes12532 = reshape_layer(Ave32360, [2, 3, 1], Res12532), 
LCon82648 = concatenate_layer([Res12532,[[[[0.008], [0.8081], [0.5542]], [[0.6891], [0.8712], [0.5596]]]]], 3, Con82648), 
LMul55207 = multiply_layer([[[[[0.8208, 0.4079]]]], [[[[0.4391, 0.9131]]]]], Mul55207), 
LZer61425 = zero_padding2D_layer(Mul55207, 1, 0, 0, 0, Zer61425), 
LMin69233 = minimum_layer([[[[[0.0258]], [[0.4249]]]], [[[[0.9884]], [[0.5438]]]]], Min69233), 
LCon37038 = concatenate_layer([Min69233,[[[[0.1135]], [[0.541]]]]], 3, Con37038), 
LMin70291 = minimum_layer([Zer61425,Con37038], Min70291), 
LZer71565 = zero_padding2D_layer(Min70291, 0, 0, 2, 0, Zer71565), 
LAdd99038 = add_layer([Con82648,Zer71565], Add99038), 
exec_layers([LDot9762,LCon24045,LMax86841,LRes79042,LZer80681,LRes39873,LRes82640,LLoc50293,LZer69814,LAve32360,LRes12532,LCon82648,LMul55207,LZer61425,LMin69233,LCon37038,LMin70291,LZer71565,LAdd99038],["Dot9762","Con24045","Max86841","Res79042","Zer80681","Res39873","Res82640","Loc50293","Zer69814","Ave32360","Res12532","Con82648","Mul55207","Zer61425","Min69233","Con37038","Min70291","Zer71565","Add99038"],Add99038,"Add99038")

Actual (Unparsed): [[[[0.1502715, 0.0080000], [0.1720601, 0.8081000], [0.1933000, 0.5542000]], [[0.7652690, 0.6891000], [0.9621691, 0.8712000], [0.5679324, 0.9320535]]]]

Expected (Unparsed): [[[[0.15027154,0.008],[0.17206008,0.8081],[0.1933,0.5542]],[[0.7652690200000001,0.6891],[0.9621690799999999,0.8712],[0.56793241,0.9320534899999999]]]]

Actual:   [[[[0.1503, 0.008], [0.1721, 0.8081], [0.1933, 0.5542]], [[0.7653, 0.6891], [0.9622, 0.8712], [0.568, 0.9321]]]]

Expected: [[[[0.1503, 0.008], [0.1721, 0.8081], [0.1933, 0.5542]], [[0.7653, 0.6891], [0.9622, 0.8712], [0.568, 0.9321]]]]