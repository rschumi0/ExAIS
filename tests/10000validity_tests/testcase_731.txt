import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave40603 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con23984 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul63390 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul63390 = tf.keras.layers.Input(shape=([2, 2]))
in0Con99995 = tf.keras.layers.Input(shape=([2, 2]))
in0Sep99827 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Dot7696 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot7696 = tf.keras.layers.Input(shape=([2, 2]))
in0Con57044 = tf.keras.layers.Input(shape=([2, 2]))

Ave40603 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave40603', )(in0Ave40603)
Res12892 = keras.layers.Reshape((1, 1), name = 'Res12892', )(Ave40603)
Zer92798 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer92798', )(Res12892)
Con23984 = keras.layers.Concatenate(axis=2, name = 'Con23984', )([Zer92798,in0Con23984])
Mul63390 = keras.layers.Multiply(name = 'Mul63390', )([in0Mul63390,in1Mul63390])
Dot534 = keras.layers.Dot(axes=(2, 1), name = 'Dot534', )([Con23984,Mul63390])
Con99995 = keras.layers.Concatenate(axis=2, name = 'Con99995', )([Dot534,in0Con99995])
Sep99827 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='same', name = 'Sep99827', )(in0Sep99827)
Res87491 = keras.layers.Reshape((1, 4), name = 'Res87491', )(Sep99827)
Zer23664 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer23664', )(Res87491)
Dot7696 = keras.layers.Dot(axes=(1, 1), name = 'Dot7696', )([in0Dot7696,in1Dot7696])
Con57044 = keras.layers.Concatenate(axis=2, name = 'Con57044', )([Dot7696,in0Con57044])
Min33536 = keras.layers.Minimum(name = 'Min33536', )([Zer23664,Con57044])
ELU84815 = keras.layers.ELU(alpha=-6.271078542113335, name = 'ELU84815', )(Min33536)
Max29159 = keras.layers.Maximum(name = 'Max29159', )([Con99995,ELU84815])
model = tf.keras.models.Model(inputs=[in0Ave40603,in0Con23984,in0Mul63390,in1Mul63390,in0Con99995,in0Sep99827,in0Dot7696,in1Dot7696,in0Con57044], outputs=Max29159)
w = model.get_layer('Sep99827').get_weights() 
w[0] = np.array([[[[0.6156], [0.8522]]]])
w[1] = np.array([[[[0.5728, 0.1988, 0.8207, 0.486], [0.048, 0.5002, 0.5921, 0.8031]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep99827').set_weights(w) 
in0Ave40603 = tf.constant([[[[1.1841]]]])
in0Con23984 = tf.constant([[[0.6289], [0.7523]]])
in0Mul63390 = tf.constant([[[0.7376, 0.3739], [0.1973, 0.0576]]])
in1Mul63390 = tf.constant([[[0.8455, 0.4751], [0.0129, 0.1909]]])
in0Con99995 = tf.constant([[[0.2364, 0.2788], [0.9784, 0.1669]]])
in0Sep99827 = tf.constant([[[[0.2985, 0.737]]]])
in0Dot7696 = tf.constant([[[0.5277, 0.9984], [0.2511, 0.1023]]])
in1Dot7696 = tf.constant([[[0.7542, 0.4269], [0.2327, 0.4253]]])
in0Con57044 = tf.constant([[[0.8843, 0.2186], [0.9548, 0.783]]])
print (np.array2string(model.predict([in0Ave40603,in0Con23984,in0Mul63390,in1Mul63390,in0Con99995,in0Sep99827,in0Dot7696,in1Dot7696,in0Con57044],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max29159.png')

LAve40603 = average_pooling2D_layer([[[[1.1841]]]], 1, 1, Ave40603), 
LRes12892 = reshape_layer(Ave40603, [1, 1], Res12892), 
LZer92798 = zero_padding1D_layer(Res12892, 1, 0, Zer92798), 
LCon23984 = concatenate_layer([Zer92798,[[[0.6289], [0.7523]]]], 2, Con23984), 
LMul63390 = multiply_layer([[[[0.7376, 0.3739], [0.1973, 0.0576]]], [[[0.8455, 0.4751], [0.0129, 0.1909]]]], Mul63390), 
LDot534 = dot_layer(Con23984,Mul63390, 2, 1, Dot534), 
LCon99995 = concatenate_layer([Dot534,[[[0.2364, 0.2788], [0.9784, 0.1669]]]], 2, Con99995), 
LSep99827 = separable_conv2D_layer([[[[0.2985, 0.737]]]], 1, 1,[[[[[0.6156], [0.8522]]]],[[[[0.5728, 0.1988, 0.8207, 0.486], [0.048, 0.5002, 0.5921, 0.8031]]]]],[0, 0, 0, 0], 1, 1, true, Sep99827), 
LRes87491 = reshape_layer(Sep99827, [1, 4], Res87491), 
LZer23664 = zero_padding1D_layer(Res87491, 1, 0, Zer23664), 
LDot7696 = dot_layer([[[0.5277, 0.9984], [0.2511, 0.1023]]], [[[0.7542, 0.4269], [0.2327, 0.4253]]], 1, 1, Dot7696), 
LCon57044 = concatenate_layer([Dot7696,[[[0.8843, 0.2186], [0.9548, 0.783]]]], 2, Con57044), 
LMin33536 = minimum_layer([Zer23664,Con57044], Min33536), 
LELU84815 = elu_layer(Min33536, -6.271078542113335, ELU84815), 
LMax29159 = maximum_layer([Con99995,ELU84815], Max29159), 
exec_layers([LAve40603,LRes12892,LZer92798,LCon23984,LMul63390,LDot534,LCon99995,LSep99827,LRes87491,LZer23664,LDot7696,LCon57044,LMin33536,LELU84815,LMax29159],["Ave40603","Res12892","Zer92798","Con23984","Mul63390","Dot534","Con99995","Sep99827","Res87491","Zer23664","Dot7696","Con57044","Min33536","ELU84815","Max29159"],Max29159,"Max29159")

Actual (Unparsed): [[[0.0016007, 0.0069153, 0.2364000, 0.2788000], [0.7403678, 0.3506921, 0.9784000, 0.5937098]]]

Expected (Unparsed): [[[0.0016006574130000002,0.006915283776,0.2364,0.2788],[0.7403678026709999,0.3506921263599999,0.9784,0.59370984894]]]

Actual:   [[[0.0017, 0.007, 0.2364, 0.2788], [0.7404, 0.3507, 0.9784, 0.5938]]]

Expected: [[[0.0017, 0.007, 0.2364, 0.2788], [0.7404, 0.3507, 0.9784, 0.5938]]]