import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den18598 = tf.keras.layers.Input(shape=([2, 4]))

Den18598 = keras.layers.Dense(4,name = 'Den18598', )(in0Den18598)
ReL7962 = keras.layers.ReLU(max_value=1.055550330708029, negative_slope=9.825333245650516, threshold=9.81779242795753, name = 'ReL7962', )(Den18598)
Res96888 = keras.layers.Reshape((2, 4, 1), name = 'Res96888', )(ReL7962)
Glo15706 = keras.layers.GlobalAveragePooling2D(name = 'Glo15706', )(Res96888)
Res65996 = keras.layers.Reshape((1, 1), name = 'Res65996', )(Glo15706)
Res3021 = keras.layers.Reshape((1, 1, 1), name = 'Res3021', )(Res65996)
Ave39079 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='valid', name = 'Ave39079', )(Res3021)
Res69906 = keras.layers.Reshape((1, 1), name = 'Res69906', )(Ave39079)
GRU32136 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU32136', )(Res69906)
model = tf.keras.models.Model(inputs=[in0Den18598], outputs=GRU32136)
w = model.get_layer('Den18598').get_weights() 
w[0] = np.array([[0.9831, 0.0084, 0.3045, 0.4498], [0.0304, 0.9576, 0.0649, 0.1467], [0.2982, 0.2475, 0.3701, 0.4994], [0.6735, 0.6157, 0.9505, 0.4663]])
w[1] = np.array([0.644, 0.6815, 0.5916, 0.7241])
model.get_layer('Den18598').set_weights(w) 
w = model.get_layer('GRU32136').get_weights() 
w[0] = np.array([[4, 3, 8, 5, 2, 1, 10, 2, 9]])
w[1] = np.array([[8, 2, 8, 1, 9, 9, 10, 6, 6], [10, 4, 4, 7, 2, 1, 5, 5, 3], [3, 2, 5, 8, 5, 3, 4, 5, 5]])
w[2] = np.array([3, 9, 1, 10, 8, 1, 1, 7, 8])
model.get_layer('GRU32136').set_weights(w) 
in0Den18598 = tf.constant([[[0.0815, 0.5987, 0.1083, 0.7594], [0.9546, 0.4536, 0.2475, 0.9697]]])
print (np.array2string(model.predict([in0Den18598],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU32136.png')

LDen18598 = dense_layer([[[0.0815, 0.5987, 0.1083, 0.7594], [0.9546, 0.4536, 0.2475, 0.9697]]], [[0.9831, 0.0084, 0.3045, 0.4498], [0.0304, 0.9576, 0.0649, 0.1467], [0.2982, 0.2475, 0.3701, 0.4994], [0.6735, 0.6157, 0.9505, 0.4663]],[0.644, 0.6815, 0.5916, 0.7241], Den18598), 
LReL7962 = relu_layer(Den18598, 1.055550330708029, 9.825333245650516, 9.81779242795753, ReL7962), 
LRes96888 = reshape_layer(ReL7962, [2, 4, 1], Res96888), 
LGlo15706 = global_average_pooling2D_layer(Res96888, Glo15706), 
LRes65996 = reshape_layer(Glo15706, [1, 1], Res65996), 
LRes3021 = reshape_layer(Res65996, [1, 1, 1], Res3021), 
LAve39079 = average_pooling2D_layer(Res3021, 1, 1, 1, 1, false, Ave39079), 
LRes69906 = reshape_layer(Ave39079, [1, 1], Res69906), 
LGRU32136 = gru_layer(Res69906,[[4, 3, 8, 5, 2, 1, 10, 2, 9]],[[8, 2, 8, 1, 9, 9, 10, 6, 6], [10, 4, 4, 7, 2, 1, 5, 5, 3], [3, 2, 5, 8, 5, 3, 4, 5, 5]],[3, 9, 1, 10, 8, 1, 1, 7, 8], false, GRU32136), 
exec_layers([LDen18598,LReL7962,LRes96888,LGlo15706,LRes65996,LRes3021,LAve39079,LRes69906,LGRU32136],["Den18598","ReL7962","Res96888","Glo15706","Res65996","Res3021","Ave39079","Res69906","GRU32136"],GRU32136,"GRU32136")

Actual (Unparsed): [[-1.0000000, -1.0000000, -1.0000000]]

Expected (Unparsed): [[-1.0,-1.0,-1.0]]

Actual:   [[-1, -1, -1]]

Expected: [[-1, -1, -1]]