import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave57336 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave57336 = tf.keras.layers.Input(shape=([1, 1, 2]))

Ave57336 = keras.layers.Average(name = 'Ave57336', )([in0Ave57336,in1Ave57336])
Res60769 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res60769', )(Ave57336)
PRe91517 = keras.layers.PReLU(name = 'PRe91517', )(Res60769)
model = tf.keras.models.Model(inputs=[in0Ave57336,in1Ave57336], outputs=PRe91517)
w = model.get_layer('PRe91517').get_weights() 
w[0] = np.array([[[[0.2448], [0.2931]]]])
model.get_layer('PRe91517').set_weights(w) 
in0Ave57336 = tf.constant([[[[0.2957, 0.9175]]]])
in1Ave57336 = tf.constant([[[[0.4544, 0.3524]]]])
print (np.array2string(model.predict([in0Ave57336,in1Ave57336],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe91517.png')

LAve57336 = average_layer([[[[[0.2957, 0.9175]]]], [[[[0.4544, 0.3524]]]]], Ave57336), 
LRes60769 = reshape_layer(Ave57336, [1, 1, 2, 1], Res60769), 
LPRe91517 = prelu_layer(Res60769, [[[[0.2448], [0.2931]]]], PRe91517), 
exec_layers([LAve57336,LRes60769,LPRe91517],["Ave57336","Res60769","PRe91517"],PRe91517,"PRe91517")

Actual (Unparsed): [[[[[0.3750500], [0.6349500]]]]]

Expected (Unparsed): [[[[[0.37505],[0.63495]]]]]

Actual:   [[[[[0.3751], [0.635]]]]]

Expected: [[[[[0.3751], [0.635]]]]]