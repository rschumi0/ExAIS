import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max77 = tf.keras.layers.Input(shape=([2, 2]))
in1Max77 = tf.keras.layers.Input(shape=([2, 2]))

Max77 = keras.layers.Maximum(name = 'Max77', )([in0Max77,in1Max77])
Lay62693 = keras.layers.LayerNormalization(axis=1, epsilon=2.013966487481838, name = 'Lay62693', )(Max77)
model = tf.keras.models.Model(inputs=[in0Max77,in1Max77], outputs=Lay62693)
in0Max77 = tf.constant([[[0.5684, 0.4553], [0.9929, 0.981]]])
in1Max77 = tf.constant([[[0.8463, 0.0083], [0.1557, 0.2021]]])
print (np.array2string(model.predict([in0Max77,in1Max77],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay62693.png')

LMax77 = maximum_layer([[[[0.5684, 0.4553], [0.9929, 0.981]]], [[[0.8463, 0.0083], [0.1557, 0.2021]]]], Max77), 
LLay62693 = layer_normalization_layer(Max77, 1, 2.013966487481838, Lay62693), 
exec_layers([LMax77,LLay62693],["Max77","Lay62693"],Lay62693,"Lay62693")

Actual (Unparsed): [[[-0.0515821, -0.1821199], [0.0515821, 0.1821199]]]

Expected (Unparsed): [[[-0.051582135451194895,-0.18211991754961268],[0.05158213545119497,0.1821199175496127]]]

Actual:   [[[-0.0515, -0.1821], [0.0516, 0.1822]]]

Expected: [[[-0.0515, -0.1821], [0.0516, 0.1822]]]