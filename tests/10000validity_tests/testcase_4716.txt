import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add27855 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Add27855 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Dot93289 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot93289 = tf.keras.layers.Input(shape=([2, 2]))
in0Max56570 = tf.keras.layers.Input(shape=([1, 1]))
in1Max56570 = tf.keras.layers.Input(shape=([1, 1]))
in0Con146 = tf.keras.layers.Input(shape=([2, 1]))

Add27855 = keras.layers.Add(name = 'Add27855', )([in0Add27855,in1Add27855])
Res50379 = keras.layers.Reshape((1, 1, 2), name = 'Res50379', )(Add27855)
Res46456 = keras.layers.Reshape((1, 2), name = 'Res46456', )(Res50379)
Zer63932 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer63932', )(Res46456)
Dot93289 = keras.layers.Dot(axes=(1, 1), name = 'Dot93289', )([in0Dot93289,in1Dot93289])
Sub4279 = keras.layers.Subtract(name = 'Sub4279', )([Zer63932,Dot93289])
Max56570 = keras.layers.Maximum(name = 'Max56570', )([in0Max56570,in1Max56570])
Zer68704 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer68704', )(Max56570)
Con146 = keras.layers.Concatenate(axis=2, name = 'Con146', )([Zer68704,in0Con146])
Ave75536 = keras.layers.Average(name = 'Ave75536', )([Sub4279,Con146])
model = tf.keras.models.Model(inputs=[in0Add27855,in1Add27855,in0Dot93289,in1Dot93289,in0Max56570,in1Max56570,in0Con146], outputs=Ave75536)
in0Add27855 = tf.constant([[[[[0.8391], [0.9377]]]]])
in1Add27855 = tf.constant([[[[[0.2179], [0.8523]]]]])
in0Dot93289 = tf.constant([[[0.4897, 0.9946], [0.321, 0.2311]]])
in1Dot93289 = tf.constant([[[0.3388, 0.4828], [0.9681, 0.0263]]])
in0Max56570 = tf.constant([[[0.2591]]])
in1Max56570 = tf.constant([[[0.9168]]])
in0Con146 = tf.constant([[[0.6701], [0.2698]]])
print (np.array2string(model.predict([in0Add27855,in1Add27855,in0Dot93289,in1Dot93289,in0Max56570,in1Max56570,in0Con146],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave75536.png')

LAdd27855 = add_layer([[[[[[0.8391], [0.9377]]]]], [[[[[0.2179], [0.8523]]]]]], Add27855), 
LRes50379 = reshape_layer(Add27855, [1, 1, 2], Res50379), 
LRes46456 = reshape_layer(Res50379, [1, 2], Res46456), 
LZer63932 = zero_padding1D_layer(Res46456, 1, 0, Zer63932), 
LDot93289 = dot_layer([[[0.4897, 0.9946], [0.321, 0.2311]]], [[[0.3388, 0.4828], [0.9681, 0.0263]]], 1, 1, Dot93289), 
LSub4279 = subtract_layer(Zer63932,Dot93289, Sub4279), 
LMax56570 = maximum_layer([[[[0.2591]]], [[[0.9168]]]], Max56570), 
LZer68704 = zero_padding1D_layer(Max56570, 1, 0, Zer68704), 
LCon146 = concatenate_layer([Zer68704,[[[0.6701], [0.2698]]]], 2, Con146), 
LAve75536 = average_layer([Sub4279,Con146], Ave75536), 
exec_layers([LAdd27855,LRes50379,LRes46456,LZer63932,LDot93289,LSub4279,LMax56570,LZer68704,LCon146,LAve75536],["Add27855","Res50379","Res46456","Zer63932","Dot93289","Sub4279","Max56570","Zer68704","Con146","Ave75536"],Ave75536,"Ave75536")

Actual (Unparsed): [[[-0.2383352, 0.2126153], [0.7065508, 0.7867646]]]

Expected (Unparsed): [[[-0.23833523,0.21261527],[0.706550805,0.786764595]]]

Actual:   [[[-0.2383, 0.2127], [0.7066, 0.7868]]]

Expected: [[[-0.2383, 0.2127], [0.7066, 0.7868]]]