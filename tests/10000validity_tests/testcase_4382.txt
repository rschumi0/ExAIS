import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul26242 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Mul26242 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Add52282 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Add52282 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Mul26242 = keras.layers.Multiply(name = 'Mul26242', )([in0Mul26242,in1Mul26242])
Zer50287 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer50287', )(Mul26242)
Add52282 = keras.layers.Add(name = 'Add52282', )([in0Add52282,in1Add52282])
Min66072 = keras.layers.Minimum(name = 'Min66072', )([Zer50287,Add52282])
Res90897 = keras.layers.Reshape((1, 2, 4), name = 'Res90897', )(Min66072)
Res29319 = keras.layers.Reshape((1, 8), name = 'Res29319', )(Res90897)
Per91076 = keras.layers.Permute((1,2), name = 'Per91076',)(Res29319)
Loc55287 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc55287', )(Per91076)
model = tf.keras.models.Model(inputs=[in0Mul26242,in1Mul26242,in0Add52282,in1Add52282], outputs=Loc55287)
w = model.get_layer('Loc55287').get_weights() 
w[0] = np.array([[[0.7776, 0.3106, 0.3349], [0.0988, 0.8417, 0.5077], [0.0904, 0.1249, 0.3297], [0.9667, 0.6195, 0.9202], [0.7598, 0.5333, 0.9058], [0.5829, 0.1863, 0.4063], [0.6496, 0.9535, 0.1632], [0.9542, 0.416, 0.1255]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc55287').set_weights(w) 
in0Mul26242 = tf.constant([[[[[0.3625, 0.0965]], [[0.482, 0.2006]]]]])
in1Mul26242 = tf.constant([[[[[0.2547, 0.5033]], [[0.524, 0.7954]]]]])
in0Add52282 = tf.constant([[[[[0.9237, 0.6476], [0.8832, 0.6651]], [[0.7712, 0.8552], [0.751, 0.3094]]]]])
in1Add52282 = tf.constant([[[[[0.6111, 0.7906], [0.2207, 0.411]], [[0.2881, 0.4806], [0.8128, 0.0854]]]]])
print (np.array2string(model.predict([in0Mul26242,in1Mul26242,in0Add52282,in1Add52282],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc55287.png')

LMul26242 = multiply_layer([[[[[[0.3625, 0.0965]], [[0.482, 0.2006]]]]], [[[[[0.2547, 0.5033]], [[0.524, 0.7954]]]]]], Mul26242), 
LZer50287 = zero_padding3D_layer(Mul26242, 0, 0, 0, 0, 1, 0, Zer50287), 
LAdd52282 = add_layer([[[[[[0.9237, 0.6476], [0.8832, 0.6651]], [[0.7712, 0.8552], [0.751, 0.3094]]]]], [[[[[0.6111, 0.7906], [0.2207, 0.411]], [[0.2881, 0.4806], [0.8128, 0.0854]]]]]], Add52282), 
LMin66072 = minimum_layer([Zer50287,Add52282], Min66072), 
LRes90897 = reshape_layer(Min66072, [1, 2, 4], Res90897), 
LRes29319 = reshape_layer(Res90897, [1, 8], Res29319), 
LPer91076 = permute_layer(Res29319, 1,2, Per91076), 
LLoc55287 = locally_connected1D_layer(Per91076, 1,[[[0.7776, 0.3106, 0.3349], [0.0988, 0.8417, 0.5077], [0.0904, 0.1249, 0.3297], [0.9667, 0.6195, 0.9202], [0.7598, 0.5333, 0.9058], [0.5829, 0.1863, 0.4063], [0.6496, 0.9535, 0.1632], [0.9542, 0.416, 0.1255]]],[[0, 0, 0]], 1, Loc55287), 
exec_layers([LMul26242,LZer50287,LAdd52282,LMin66072,LRes90897,LRes29319,LPer91076,LLoc55287],["Mul26242","Zer50287","Add52282","Min66072","Res90897","Res29319","Per91076","Loc55287"],Loc55287,"Loc55287")

Actual (Unparsed): [[[0.3716153, 0.3488194, 0.1363770]]]

Expected (Unparsed): [[[0.371615330823,0.34881941548999995,0.136377007785]]]

Actual:   [[[0.3717, 0.3489, 0.1364]]]

Expected: [[[0.3717, 0.3489, 0.1364]]]