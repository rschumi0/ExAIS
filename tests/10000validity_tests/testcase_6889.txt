import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot21229 = tf.keras.layers.Input(shape=([3]))
in1Dot21229 = tf.keras.layers.Input(shape=([3]))
in0Mul6130 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Mul6130 = tf.keras.layers.Input(shape=([1, 1, 1]))

Dot21229 = keras.layers.Dot(axes=(1, 1), name = 'Dot21229', )([in0Dot21229,in1Dot21229])
Res41549 = keras.layers.Reshape((1, 1), name = 'Res41549', )(Dot21229)
Res27356 = keras.layers.Reshape((1, 1, 1), name = 'Res27356', )(Res41549)
Zer17433 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer17433', )(Res27356)
Mul6130 = keras.layers.Multiply(name = 'Mul6130', )([in0Mul6130,in1Mul6130])
Zer88285 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer88285', )(Mul6130)
Ave2485 = keras.layers.AveragePooling2D(pool_size=(1, 2), name = 'Ave2485', )(Zer88285)
Ave76909 = keras.layers.Average(name = 'Ave76909', )([Zer17433,Ave2485])
Mas46811 = keras.layers.Masking(mask_value=1, name = 'Mas46811', )(Ave76909)
model = tf.keras.models.Model(inputs=[in0Dot21229,in1Dot21229,in0Mul6130,in1Mul6130], outputs=Mas46811)
in0Dot21229 = tf.constant([[0.5808, 0.0864, 0.2669]])
in1Dot21229 = tf.constant([[0.0023, 0.1519, 0.4765]])
in0Mul6130 = tf.constant([[[[0.4988]]]])
in1Mul6130 = tf.constant([[[[0.3319]]]])
print (np.array2string(model.predict([in0Dot21229,in1Dot21229,in0Mul6130,in1Mul6130],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas46811.png')

LDot21229 = dot_layer([[0.5808, 0.0864, 0.2669]], [[0.0023, 0.1519, 0.4765]], 1, 1, Dot21229), 
LRes41549 = reshape_layer(Dot21229, [1, 1], Res41549), 
LRes27356 = reshape_layer(Res41549, [1, 1, 1], Res27356), 
LZer17433 = zero_padding2D_layer(Res27356, 2, 0, 0, 0, Zer17433), 
LMul6130 = multiply_layer([[[[[0.4988]]]], [[[[0.3319]]]]], Mul6130), 
LZer88285 = zero_padding2D_layer(Mul6130, 1, 1, 1, 1, Zer88285), 
LAve2485 = average_pooling2D_layer(Zer88285, 1, 2, Ave2485), 
LAve76909 = average_layer([Zer17433,Ave2485], Ave76909), 
LMas46811 = masking_layer(Ave76909, 1, Mas46811), 
exec_layers([LDot21229,LRes41549,LRes27356,LZer17433,LMul6130,LZer88285,LAve2485,LAve76909,LMas46811],["Dot21229","Res41549","Res27356","Zer17433","Mul6130","Zer88285","Ave2485","Ave76909","Mas46811"],Mas46811,"Mas46811")

Actual (Unparsed): [[[[0.0000000]], [[0.0413879]], [[0.0708189]]]]

Expected (Unparsed): [[[[0]],[[0.041387929999999996]],[[0.070818925]]]]

Actual:   [[[[0]], [[0.0414]], [[0.0709]]]]

Expected: [[[[0]], [[0.0414]], [[0.0709]]]]