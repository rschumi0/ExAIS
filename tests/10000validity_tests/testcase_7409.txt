import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof23778 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con42820 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Add49728 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Add49728 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Dot7065 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot7065 = tf.keras.layers.Input(shape=([2, 3]))
in0Con34664 = tf.keras.layers.Input(shape=([2, 2]))

Sof23778 = keras.layers.Softmax(axis=1, name = 'Sof23778', input_shape=(1, 1, 1, 2))(in0Sof23778)
Res5739 = keras.layers.Reshape((1, 1, 2), name = 'Res5739', )(Sof23778)
Res77742 = keras.layers.Reshape((1, 2), name = 'Res77742', )(Res5739)
Cro11962 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro11962', )(Res77742)
Res48961 = keras.layers.Reshape((1, 2, 1), name = 'Res48961', )(Cro11962)
Res88416 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res88416', )(Res48961)
Con42820 = keras.layers.Concatenate(axis=4, name = 'Con42820', )([Res88416,in0Con42820])
Add49728 = keras.layers.Add(name = 'Add49728', )([in0Add49728,in1Add49728])
Zer41500 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer41500', )(Add49728)
Sub12725 = keras.layers.Subtract(name = 'Sub12725', )([Con42820,Zer41500])
Res40584 = keras.layers.Reshape((1, 2, 2), name = 'Res40584', )(Sub12725)
Res97744 = keras.layers.Reshape((1, 4), name = 'Res97744', )(Res40584)
Zer90637 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer90637', )(Res97744)
Dot7065 = keras.layers.Dot(axes=(2, 2), name = 'Dot7065', )([in0Dot7065,in1Dot7065])
Con34664 = keras.layers.Concatenate(axis=2, name = 'Con34664', )([Dot7065,in0Con34664])
Min91653 = keras.layers.Minimum(name = 'Min91653', )([Zer90637,Con34664])
model = tf.keras.models.Model(inputs=[in0Sof23778,in0Con42820,in0Add49728,in1Add49728,in0Dot7065,in1Dot7065,in0Con34664], outputs=Min91653)
in0Sof23778 = tf.constant([[[[[0.5923, 0.3903]]]]])
in0Con42820 = tf.constant([[[[[0.2801]], [[0.0592]]]]])
in0Add49728 = tf.constant([[[[[0.1095, 0.5648]]]]])
in1Add49728 = tf.constant([[[[[0.6849, 0.1608]]]]])
in0Dot7065 = tf.constant([[[0.8691, 0.551, 0.1466], [0.899, 0.2707, 0.7156]]])
in1Dot7065 = tf.constant([[[0.9565, 0.7713, 0.2808], [0.8626, 0.3948, 0.2294]]])
in0Con34664 = tf.constant([[[0.8195, 0.4849], [0.4366, 0.5599]]])
print (np.array2string(model.predict([in0Sof23778,in0Con42820,in0Add49728,in1Add49728,in0Dot7065,in1Dot7065,in0Con34664],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min91653.png')

LSof23778 = softmax_layer([[[[[0.5923, 0.3903]]]]], 1, Sof23778), 
LRes5739 = reshape_layer(Sof23778, [1, 1, 2], Res5739), 
LRes77742 = reshape_layer(Res5739, [1, 2], Res77742), 
LCro11962 = cropping1D_layer(Res77742, 0, 0, Cro11962), 
LRes48961 = reshape_layer(Cro11962, [1, 2, 1], Res48961), 
LRes88416 = reshape_layer(Res48961, [1, 2, 1, 1], Res88416), 
LCon42820 = concatenate_layer([Res88416,[[[[[0.2801]], [[0.0592]]]]]], 4, Con42820), 
LAdd49728 = add_layer([[[[[[0.1095, 0.5648]]]]], [[[[[0.6849, 0.1608]]]]]], Add49728), 
LZer41500 = zero_padding3D_layer(Add49728, 0, 0, 1, 0, 0, 0, Zer41500), 
LSub12725 = subtract_layer(Con42820,Zer41500, Sub12725), 
LRes40584 = reshape_layer(Sub12725, [1, 2, 2], Res40584), 
LRes97744 = reshape_layer(Res40584, [1, 4], Res97744), 
LZer90637 = zero_padding1D_layer(Res97744, 1, 0, Zer90637), 
LDot7065 = dot_layer([[[0.8691, 0.551, 0.1466], [0.899, 0.2707, 0.7156]]], [[[0.9565, 0.7713, 0.2808], [0.8626, 0.3948, 0.2294]]], 2, 2, Dot7065), 
LCon34664 = concatenate_layer([Dot7065,[[[0.8195, 0.4849], [0.4366, 0.5599]]]], 2, Con34664), 
LMin91653 = minimum_layer([Zer90637,Con34664], Min91653), 
exec_layers([LSof23778,LRes5739,LRes77742,LCro11962,LRes48961,LRes88416,LCon42820,LAdd49728,LZer41500,LSub12725,LRes40584,LRes97744,LZer90637,LDot7065,LCon34664,LMin91653],["Sof23778","Res5739","Res77742","Cro11962","Res48961","Res88416","Con42820","Add49728","Zer41500","Sub12725","Res40584","Res97744","Zer90637","Dot7065","Con34664","Min91653"],Min91653,"Min91653")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [1.0000000, 0.2801000, 0.2056000, -0.6664000]]]

Expected (Unparsed): [[[0,0,0,0],[1.0,0.2801,0.2056,-0.6664]]]

Actual:   [[[0, 0, 0, 0], [1, 0.2801, 0.2056, -0.6664]]]

Expected: [[[0, 0, 0, 0], [1, 0.2801, 0.2056, -0.6664]]]