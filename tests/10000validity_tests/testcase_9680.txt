import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max83342 = tf.keras.layers.Input(shape=([1, 2]))
in1Max83342 = tf.keras.layers.Input(shape=([1, 2]))

Max83342 = keras.layers.Maximum(name = 'Max83342', )([in0Max83342,in1Max83342])
Sep62830 = keras.layers.SeparableConv1D(4, (2),strides=(2), padding='same', name = 'Sep62830', )(Max83342)
model = tf.keras.models.Model(inputs=[in0Max83342,in1Max83342], outputs=Sep62830)
w = model.get_layer('Sep62830').get_weights() 
w[0] = np.array([[[0.7841], [0.9671]], [[0.0385], [0.2452]]])
w[1] = np.array([[[0.7168, 0.6119, 0.7029, 0.2626], [0.076, 0.9905, 0.7528, 0.7808]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep62830').set_weights(w) 
in0Max83342 = tf.constant([[[0.8266, 0.0156]]])
in1Max83342 = tf.constant([[[0.263, 0.398]]])
print (np.array2string(model.predict([in0Max83342,in1Max83342],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep62830.png')

LMax83342 = maximum_layer([[[[0.8266, 0.0156]]], [[[0.263, 0.398]]]], Max83342), 
LSep62830 = separable_conv1D_layer(Max83342, 2,[[[[0.7841], [0.9671]], [[0.0385], [0.2452]]],[[[0.7168, 0.6119, 0.7029, 0.2626], [0.076, 0.9905, 0.7528, 0.7808]]]],[0, 0, 0, 0], 2, true, Sep62830), 
exec_layers([LMax83342,LSep62830],["Max83342","Sep62830"],Sep62830,"Sep62830")

Actual (Unparsed): [[[0.4938375, 0.7778443, 0.7453326, 0.4707352]]]

Expected (Unparsed): [[[0.49383748540800004,0.777844261914,0.745332625714,0.4707352405960001]]]

Actual:   [[[0.4939, 0.7779, 0.7454, 0.4708]]]

Expected: [[[0.4939, 0.7779, 0.7454, 0.4708]]]