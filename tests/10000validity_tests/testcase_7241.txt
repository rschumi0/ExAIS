import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo55690 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Min93107 = tf.keras.layers.Input(shape=([1, 1]))
in1Min93107 = tf.keras.layers.Input(shape=([1, 1]))
in0Con76228 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Mul32057 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul32057 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Min52665 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Min52665 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Ave91793 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave91793 = tf.keras.layers.Input(shape=([1, 1]))
in0Con53723 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Min47548 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Min47548 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Glo55690 = keras.layers.GlobalMaxPool2D(name = 'Glo55690', )(in0Glo55690)
Res88331 = keras.layers.Reshape((1, 1), name = 'Res88331', )(Glo55690)
Min93107 = keras.layers.Minimum(name = 'Min93107', )([in0Min93107,in1Min93107])
Max545 = keras.layers.Maximum(name = 'Max545', )([Res88331,Min93107])
Res41799 = keras.layers.Reshape((1, 1, 1), name = 'Res41799', )(Max545)
Zer38622 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer38622', )(Res41799)
Con76228 = keras.layers.Concatenate(axis=3, name = 'Con76228', )([Zer38622,in0Con76228])
Mul32057 = keras.layers.Multiply(name = 'Mul32057', )([in0Mul32057,in1Mul32057])
Mul23903 = keras.layers.Multiply(name = 'Mul23903', )([Con76228,Mul32057])
Res39151 = keras.layers.Reshape((2, 2), name = 'Res39151', )(Mul23903)
Min52665 = keras.layers.Minimum(name = 'Min52665', )([in0Min52665,in1Min52665])
Zer1097 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer1097', )(Min52665)
Ave91793 = keras.layers.Average(name = 'Ave91793', )([in0Ave91793,in1Ave91793])
Res25141 = keras.layers.Reshape((1, 1, 1), name = 'Res25141', )(Ave91793)
Res60149 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res60149', )(Res25141)
Zer60235 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer60235', )(Res60149)
Con53723 = keras.layers.Concatenate(axis=4, name = 'Con53723', )([Zer60235,in0Con53723])
Min47548 = keras.layers.Minimum(name = 'Min47548', )([in0Min47548,in1Min47548])
Max64022 = keras.layers.Maximum(name = 'Max64022', )([Con53723,Min47548])
Min37973 = keras.layers.Minimum(name = 'Min37973', )([Zer1097,Max64022])
Res92884 = keras.layers.Reshape((2, 2, 2), name = 'Res92884', )(Min37973)
Res24473 = keras.layers.Reshape((2, 4), name = 'Res24473', )(Res92884)
Dot83248 = keras.layers.Dot(axes=(1, 1), name = 'Dot83248', )([Res39151,Res24473])
model = tf.keras.models.Model(inputs=[in0Glo55690,in0Min93107,in1Min93107,in0Con76228,in0Mul32057,in1Mul32057,in0Min52665,in1Min52665,in0Ave91793,in1Ave91793,in0Con53723,in0Min47548,in1Min47548], outputs=Dot83248)
in0Glo55690 = tf.constant([[[[1.4991]]]])
in0Min93107 = tf.constant([[[0.2646]]])
in1Min93107 = tf.constant([[[0.9334]]])
in0Con76228 = tf.constant([[[[0.7162]], [[0.7744]]]])
in0Mul32057 = tf.constant([[[[0.9922, 0.7955]], [[0.8195, 0.8972]]]])
in1Mul32057 = tf.constant([[[[0.3704, 0.4206]], [[0.6867, 0.7101]]]])
in0Min52665 = tf.constant([[[[[0.9351, 0.744]]], [[[0.0316, 0.4741]]]]])
in1Min52665 = tf.constant([[[[[0.6872, 0.9872]]], [[[0.2167, 0.7978]]]]])
in0Ave91793 = tf.constant([[[0.7566]]])
in1Ave91793 = tf.constant([[[0.1815]]])
in0Con53723 = tf.constant([[[[[0.7946]], [[0.782]]], [[[0.8414]], [[0.7611]]]]])
in0Min47548 = tf.constant([[[[[0.7756, 0.8844]], [[0.4595, 0.5889]]], [[[0.5852, 0.4346]], [[0.2973, 0.6274]]]]])
in1Min47548 = tf.constant([[[[[0.0465, 0.6278]], [[0.1838, 0.6962]]], [[[0.0083, 0.2497]], [[0.6873, 0.8081]]]]])
print (np.array2string(model.predict([in0Glo55690,in0Min93107,in1Min93107,in0Con76228,in0Mul32057,in1Mul32057,in0Min52665,in1Min52665,in0Ave91793,in1Ave91793,in0Con53723,in0Min47548,in1Min47548],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot83248.png')

LGlo55690 = global_max_pool2D_layer([[[[1.4991]]]], Glo55690), 
LRes88331 = reshape_layer(Glo55690, [1, 1], Res88331), 
LMin93107 = minimum_layer([[[[0.2646]]], [[[0.9334]]]], Min93107), 
LMax545 = maximum_layer([Res88331,Min93107], Max545), 
LRes41799 = reshape_layer(Max545, [1, 1, 1], Res41799), 
LZer38622 = zero_padding2D_layer(Res41799, 1, 0, 0, 0, Zer38622), 
LCon76228 = concatenate_layer([Zer38622,[[[[0.7162]], [[0.7744]]]]], 3, Con76228), 
LMul32057 = multiply_layer([[[[[0.9922, 0.7955]], [[0.8195, 0.8972]]]], [[[[0.3704, 0.4206]], [[0.6867, 0.7101]]]]], Mul32057), 
LMul23903 = multiply_layer([Con76228,Mul32057], Mul23903), 
LRes39151 = reshape_layer(Mul23903, [2, 2], Res39151), 
LMin52665 = minimum_layer([[[[[[0.9351, 0.744]]], [[[0.0316, 0.4741]]]]], [[[[[0.6872, 0.9872]]], [[[0.2167, 0.7978]]]]]], Min52665), 
LZer1097 = zero_padding3D_layer(Min52665, 0, 0, 1, 0, 0, 0, Zer1097), 
LAve91793 = average_layer([[[[0.7566]]], [[[0.1815]]]], Ave91793), 
LRes25141 = reshape_layer(Ave91793, [1, 1, 1], Res25141), 
LRes60149 = reshape_layer(Res25141, [1, 1, 1, 1], Res60149), 
LZer60235 = zero_padding3D_layer(Res60149, 1, 0, 1, 0, 0, 0, Zer60235), 
LCon53723 = concatenate_layer([Zer60235,[[[[[0.7946]], [[0.782]]], [[[0.8414]], [[0.7611]]]]]], 4, Con53723), 
LMin47548 = minimum_layer([[[[[[0.7756, 0.8844]], [[0.4595, 0.5889]]], [[[0.5852, 0.4346]], [[0.2973, 0.6274]]]]], [[[[[0.0465, 0.6278]], [[0.1838, 0.6962]]], [[[0.0083, 0.2497]], [[0.6873, 0.8081]]]]]], Min47548), 
LMax64022 = maximum_layer([Con53723,Min47548], Max64022), 
LMin37973 = minimum_layer([Zer1097,Max64022], Min37973), 
LRes92884 = reshape_layer(Min37973, [2, 2, 2], Res92884), 
LRes24473 = reshape_layer(Res92884, [2, 4], Res24473), 
LDot83248 = dot_layer(Res39151,Res24473, 1, 1, Dot83248), 
exec_layers([LGlo55690,LRes88331,LMin93107,LMax545,LRes41799,LZer38622,LCon76228,LMul32057,LMul23903,LRes39151,LMin52665,LZer1097,LAve91793,LRes25141,LRes60149,LZer60235,LCon53723,LMin47548,LMax64022,LMin37973,LRes92884,LRes24473,LDot83248],["Glo55690","Res88331","Min93107","Max545","Res41799","Zer38622","Con76228","Mul32057","Mul23903","Res39151","Min52665","Zer1097","Ave91793","Res25141","Res60149","Zer60235","Con53723","Min47548","Max64022","Min37973","Res92884","Res24473","Dot83248"],Dot83248,"Dot83248")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0266584, 0.3999600], [0.0000000, 0.0000000, 0.0596348, 0.4121932]]]

Expected (Unparsed): [[[0.0,0.0,0.026658376181514003,0.3999600046726515],[0.0,0.0,0.0596347974531768,0.41219324191946877]]]

Actual:   [[[0, 0, 0.0267, 0.4], [0, 0, 0.0597, 0.4122]]]

Expected: [[[0, 0, 0.0267, 0.4], [0, 0, 0.0597, 0.4122]]]