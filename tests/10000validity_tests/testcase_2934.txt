import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo55464 = tf.keras.layers.Input(shape=([1, 2]))

Glo55464 = keras.layers.GlobalMaxPool1D(name = 'Glo55464', )(in0Glo55464)
Den71315 = keras.layers.Dense(4,name = 'Den71315', )(Glo55464)
model = tf.keras.models.Model(inputs=[in0Glo55464], outputs=Den71315)
w = model.get_layer('Den71315').get_weights() 
w[0] = np.array([[0.3966, 0.6846, 0.7058, 0.2294], [0.9525, 0.3185, 0.5635, 0.0842]])
w[1] = np.array([0.3915, 0.0872, 0.2846, 0.8153])
model.get_layer('Den71315').set_weights(w) 
in0Glo55464 = tf.constant([[[1.6702, 1.6344]]])
print (np.array2string(model.predict([in0Glo55464],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den71315.png')

LGlo55464 = global_max_pool1D_layer([[[1.6702, 1.6344]]], Glo55464), 
LDen71315 = dense_layer(Glo55464, [[0.3966, 0.6846, 0.7058, 0.2294], [0.9525, 0.3185, 0.5635, 0.0842]],[0.3915, 0.0872, 0.2846, 0.8153], Den71315), 
exec_layers([LGlo55464,LDen71315],["Glo55464","Den71315"],Den71315,"Den71315")

Actual (Unparsed): [[2.6106673, 1.7511753, 2.3844116, 1.3360604]]

Expected (Unparsed): [[2.61066732,1.75117532,2.38441156,1.33606036]]

Actual:   [[2.6107, 1.7512, 2.3845, 1.3361]]

Expected: [[2.6107, 1.7512, 2.3845, 1.3361]]