import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot68137 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot68137 = tf.keras.layers.Input(shape=([2, 3]))
in0Con67465 = tf.keras.layers.Input(shape=([3, 3, 1, 1]))
in0Ave22433 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Ave22433 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Dot68137 = keras.layers.Dot(axes=(1, 1), name = 'Dot68137', )([in0Dot68137,in1Dot68137])
Res92676 = keras.layers.Reshape((3, 3, 1), name = 'Res92676', )(Dot68137)
Res10615 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res10615', )(Res92676)
Con67465 = keras.layers.Concatenate(axis=4, name = 'Con67465', )([Res10615,in0Con67465])
Ave22433 = keras.layers.Average(name = 'Ave22433', )([in0Ave22433,in1Ave22433])
Zer69913 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer69913', )(Ave22433)
Ave51 = keras.layers.Average(name = 'Ave51', )([Con67465,Zer69913])
Res45216 = keras.layers.Reshape((3, 3, 2), name = 'Res45216', )(Ave51)
Zer42860 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer42860', )(Res45216)
model = tf.keras.models.Model(inputs=[in0Dot68137,in1Dot68137,in0Con67465,in0Ave22433,in1Ave22433], outputs=Zer42860)
in0Dot68137 = tf.constant([[[0.7704, 0.3517, 0.4986], [0.434, 0.7123, 0.7762]]])
in1Dot68137 = tf.constant([[[0.085, 0.4203, 0.7384], [0.0305, 0.8441, 0.3065]]])
in0Con67465 = tf.constant([[[[[0.1655]], [[0.6226]], [[0.2766]]], [[[0.9294]], [[0.5718]], [[0.3095]]], [[[0.6968]], [[0.2256]], [[0.7387]]]]])
in0Ave22433 = tf.constant([[[[[0.4955, 0.9094]], [[0.0758, 0.521]]], [[[0.602, 0.2468]], [[0.2244, 0.0203]]]]])
in1Ave22433 = tf.constant([[[[[0.97, 0.1739]], [[0.9259, 0.4762]]], [[[0.7946, 0.825]], [[0.2595, 0.3779]]]]])
print (np.array2string(model.predict([in0Dot68137,in1Dot68137,in0Con67465,in0Ave22433,in1Ave22433],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer42860.png')

LDot68137 = dot_layer([[[0.7704, 0.3517, 0.4986], [0.434, 0.7123, 0.7762]]], [[[0.085, 0.4203, 0.7384], [0.0305, 0.8441, 0.3065]]], 1, 1, Dot68137), 
LRes92676 = reshape_layer(Dot68137, [3, 3, 1], Res92676), 
LRes10615 = reshape_layer(Res92676, [3, 3, 1, 1], Res10615), 
LCon67465 = concatenate_layer([Res10615,[[[[[0.1655]], [[0.6226]], [[0.2766]]], [[[0.9294]], [[0.5718]], [[0.3095]]], [[[0.6968]], [[0.2256]], [[0.7387]]]]]], 4, Con67465), 
LAve22433 = average_layer([[[[[[0.4955, 0.9094]], [[0.0758, 0.521]]], [[[0.602, 0.2468]], [[0.2244, 0.0203]]]]], [[[[[0.97, 0.1739]], [[0.9259, 0.4762]]], [[[0.7946, 0.825]], [[0.2595, 0.3779]]]]]], Ave22433), 
LZer69913 = zero_padding3D_layer(Ave22433, 1, 0, 1, 0, 0, 0, Zer69913), 
LAve51 = average_layer([Con67465,Zer69913], Ave51), 
LRes45216 = reshape_layer(Ave51, [3, 3, 2], Res45216), 
LZer42860 = zero_padding2D_layer(Res45216, 1, 1, 1, 1, Zer42860), 
exec_layers([LDot68137,LRes92676,LRes10615,LCon67465,LAve22433,LZer69913,LAve51,LRes45216,LZer42860],["Dot68137","Res92676","Res10615","Con67465","Ave22433","Zer69913","Ave51","Res45216","Zer42860"],Zer42860,"Zer42860")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0393605, 0.0827500], [0.3450693, 0.3113000], [0.3509422, 0.1383000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0258098, 0.4647000], [0.7409110, 0.5567250], [0.4894326, 0.4040500], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0330276, 0.3484000], [0.7815260, 0.3807500], [0.4240108, 0.4689000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0.0393605,0.08275],[0.34506926,0.3113],[0.35094218,0.1383],[0,0]],[[0,0],[0.025809825,0.4647],[0.7409109700000001,0.5567249999999999],[0.489432615,0.40405],[0,0]],[[0,0],[0.03302755,0.3484],[0.7815259999999999,0.38075],[0.42401077,0.4689],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0.0394, 0.0828], [0.3451, 0.3113], [0.351, 0.1383], [0, 0]], [[0, 0], [0.0259, 0.4647], [0.741, 0.5568], [0.4895, 0.4041], [0, 0]], [[0, 0], [0.0331, 0.3484], [0.7816, 0.3808], [0.4241, 0.4689], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]]]

Expected: [[[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0.0394, 0.0828], [0.3451, 0.3113], [0.351, 0.1383], [0, 0]], [[0, 0], [0.0259, 0.4647], [0.741, 0.5568], [0.4895, 0.4041], [0, 0]], [[0, 0], [0.0331, 0.3484], [0.7816, 0.3808], [0.4241, 0.4689], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]]]