import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer70782 = tf.keras.layers.Input(shape=([1, 3, 1]))
in0Add68849 = tf.keras.layers.Input(shape=([1, 2]))
in1Add68849 = tf.keras.layers.Input(shape=([1, 2]))
in0Con41177 = tf.keras.layers.Input(shape=([3, 3]))

Zer70782 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer70782', )(in0Zer70782)
Res11906 = keras.layers.Reshape((3, 5), name = 'Res11906', )(Zer70782)
Add68849 = keras.layers.Add(name = 'Add68849', )([in0Add68849,in1Add68849])
Zer74085 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer74085', )(Add68849)
Con41177 = keras.layers.Concatenate(axis=2, name = 'Con41177', )([Zer74085,in0Con41177])
Max93566 = keras.layers.Maximum(name = 'Max93566', )([Res11906,Con41177])
Con3039 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con3039', )(Max93566)
PRe41199 = keras.layers.PReLU(name = 'PRe41199', )(Con3039)
model = tf.keras.models.Model(inputs=[in0Zer70782,in0Add68849,in1Add68849,in0Con41177], outputs=PRe41199)
w = model.get_layer('Con3039').get_weights() 
w[0] = np.array([[[0.5289, 0.601, 0.359], [0.5048, 0.2378, 0.8269], [0.1923, 0.3619, 0.2444], [0.921, 0.149, 0.6485], [0.6077, 0.1225, 0.302]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con3039').set_weights(w) 
w = model.get_layer('PRe41199').get_weights() 
w[0] = np.array([[0.5601, 0.1656, 0.8309], [0.4722, 0.7652, 0.9598], [0.0296, 0.7364, 0.8963]])
model.get_layer('PRe41199').set_weights(w) 
in0Zer70782 = tf.constant([[[[1.0255], [1.8174], [1.5572]]]])
in0Add68849 = tf.constant([[[0.1561, 0.2133]]])
in1Add68849 = tf.constant([[[0.9362, 0.8757]]])
in0Con41177 = tf.constant([[[0.1994, 0.8121, 0.2403], [0.6749, 0.1543, 0.1786], [0.4582, 0.8059, 0.9602]]])
print (np.array2string(model.predict([in0Zer70782,in0Add68849,in1Add68849,in0Con41177],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe41199.png')

LZer70782 = zero_padding2D_layer([[[[1.0255], [1.8174], [1.5572]]]], 1, 1, 1, 1, Zer70782), 
LRes11906 = reshape_layer(Zer70782, [3, 5], Res11906), 
LAdd68849 = add_layer([[[[0.1561, 0.2133]]], [[[0.9362, 0.8757]]]], Add68849), 
LZer74085 = zero_padding1D_layer(Add68849, 2, 0, Zer74085), 
LCon41177 = concatenate_layer([Zer74085,[[[0.1994, 0.8121, 0.2403], [0.6749, 0.1543, 0.1786], [0.4582, 0.8059, 0.9602]]]], 2, Con41177), 
LMax93566 = maximum_layer([Res11906,Con41177], Max93566), 
LCon3039 = conv1D_layer(Max93566, 1,[[[0.5289, 0.601, 0.359], [0.5048, 0.2378, 0.8269], [0.1923, 0.3619, 0.2444], [0.921, 0.149, 0.6485], [0.6077, 0.1225, 0.302]]],[0, 0, 0], 1, true, 1, Con3039), 
LPRe41199 = prelu_layer(Con3039, [[0.5601, 0.1656, 0.8309], [0.4722, 0.7652, 0.9598], [0.0296, 0.7364, 0.8963]], PRe41199), 
exec_layers([LZer70782,LRes11906,LAdd68849,LZer74085,LCon41177,LMax93566,LCon3039,LPRe41199],["Zer70782","Res11906","Add68849","Zer74085","Con41177","Max93566","Con3039","PRe41199"],PRe41199,"PRe41199")

Actual (Unparsed): [[[0.9323190, 0.2226025, 0.6479508], [2.4098748, 1.1554823, 2.3559399], [2.5413040, 1.3189627, 2.2172204]]]

Expected (Unparsed): [[[0.9323190300000002,0.22260251,0.64795081],[2.40987484,1.1554822599999999,2.35593991],[2.54130397,1.31896268,2.21722043]]]

Actual:   [[[0.9324, 0.2227, 0.648], [2.4099, 1.1555, 2.356], [2.5414, 1.319, 2.2173]]]

Expected: [[[0.9324, 0.2227, 0.648], [2.4099, 1.1555, 2.356], [2.5414, 1.319, 2.2173]]]