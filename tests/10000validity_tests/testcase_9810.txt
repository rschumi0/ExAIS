import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max59902 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max59902 = tf.keras.layers.Input(shape=([2, 2, 1]))

Max59902 = keras.layers.Maximum(name = 'Max59902', )([in0Max59902,in1Max59902])
Res45139 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res45139', )(Max59902)
Glo66440 = keras.layers.GlobalMaxPool3D(name = 'Glo66440', )(Res45139)
model = tf.keras.models.Model(inputs=[in0Max59902,in1Max59902], outputs=Glo66440)
in0Max59902 = tf.constant([[[[0.3005], [0.4731]], [[0.3001], [0.3106]]]])
in1Max59902 = tf.constant([[[[0.3444], [0.9625]], [[0.8434], [0.1083]]]])
print (np.array2string(model.predict([in0Max59902,in1Max59902],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo66440.png')

LMax59902 = maximum_layer([[[[[0.3005], [0.4731]], [[0.3001], [0.3106]]]], [[[[0.3444], [0.9625]], [[0.8434], [0.1083]]]]], Max59902), 
LRes45139 = reshape_layer(Max59902, [2, 2, 1, 1], Res45139), 
LGlo66440 = global_max_pool3D_layer(Res45139, Glo66440), 
exec_layers([LMax59902,LRes45139,LGlo66440],["Max59902","Res45139","Glo66440"],Glo66440,"Glo66440")

Actual (Unparsed): [[0.9625000]]

Expected (Unparsed): [[0.9625]]

Actual:   [[0.9625]]

Expected: [[0.9625]]