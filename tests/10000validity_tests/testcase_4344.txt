import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con79674 = tf.keras.layers.Input(shape=([1, 1]))
in0Con97996 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Sep38255 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Sub85789 = tf.keras.layers.Input(shape=([2]))
in1Sub85789 = tf.keras.layers.Input(shape=([2]))
in0Con39818 = tf.keras.layers.Input(shape=([13]))

Con79674 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con79674', )(in0Con79674)
Res66988 = keras.layers.Reshape((1, 2, 1), name = 'Res66988', )(Con79674)
Con97996 = keras.layers.Concatenate(axis=3, name = 'Con97996', )([Res66988,in0Con97996])
Sep38255 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='valid', name = 'Sep38255', )(in0Sep38255)
Mul13976 = keras.layers.Multiply(name = 'Mul13976', )([Con97996,Sep38255])
Res63416 = keras.layers.Reshape((1, 6), name = 'Res63416', )(Mul13976)
Con22357 = keras.layers.Conv1D(3, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con22357', )(Res63416)
Res394 = keras.layers.Reshape((1, 3, 1), name = 'Res394', )(Con22357)
Zer33147 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer33147', )(Res394)
Res37095 = keras.layers.Reshape((3, 5), name = 'Res37095', )(Zer33147)
Fla27417 = keras.layers.Flatten(name = 'Fla27417', )(Res37095)
Sub85789 = keras.layers.Subtract(name = 'Sub85789', )([in0Sub85789,in1Sub85789])
Con39818 = keras.layers.Concatenate(axis=1, name = 'Con39818', )([Sub85789,in0Con39818])
Mul48099 = keras.layers.Multiply(name = 'Mul48099', )([Fla27417,Con39818])
model = tf.keras.models.Model(inputs=[in0Con79674,in0Con97996,in0Sep38255,in0Sub85789,in1Sub85789,in0Con39818], outputs=Mul48099)
w = model.get_layer('Con79674').get_weights() 
w[0] = np.array([[[0.5361, 0.859]]])
w[1] = np.array([0, 0])
model.get_layer('Con79674').set_weights(w) 
w = model.get_layer('Sep38255').get_weights() 
w[0] = np.array([[[[0.4837]]]])
w[1] = np.array([[[[0.1166, 0.1966, 0.3917]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep38255').set_weights(w) 
w = model.get_layer('Con22357').get_weights() 
w[0] = np.array([[[0.4233, 0.5406, 0.0303], [0.9799, 0.2065, 0.1746], [0.5593, 0.0698, 0.2584], [0.9684, 0.5182, 0.7841], [0.085, 0.2322, 0.3074], [0.4861, 0.5072, 0.0475]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con22357').set_weights(w) 
in0Con79674 = tf.constant([[[0.1135]]])
in0Con97996 = tf.constant([[[[0.1617, 0.306], [0.3165, 0.2582]]]])
in0Sep38255 = tf.constant([[[[0.0605], [0.8891]]]])
in0Sub85789 = tf.constant([[0.7246, 0.3416]])
in1Sub85789 = tf.constant([[0.3164, 0.3957]])
in0Con39818 = tf.constant([[0.467, 0.281, 0.5753, 0.7648, 0.5307, 0.5986, 0.4162, 0.4375, 0.3305, 0.2482, 0.6414, 0.9259, 0.9674]])
print (np.array2string(model.predict([in0Con79674,in0Con97996,in0Sep38255,in0Sub85789,in1Sub85789,in0Con39818],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul48099.png')

LCon79674 = conv1D_layer([[[0.1135]]], 1,[[[0.5361, 0.859]]],[0, 0], 1, false, 1, Con79674), 
LRes66988 = reshape_layer(Con79674, [1, 2, 1], Res66988), 
LCon97996 = concatenate_layer([Res66988,[[[[0.1617, 0.306], [0.3165, 0.2582]]]]], 3, Con97996), 
LSep38255 = separable_conv2D_layer([[[[0.0605], [0.8891]]]], 1, 1,[[[[[0.4837]]]],[[[[0.1166, 0.1966, 0.3917]]]]],[0, 0, 0], 1, 1, false, Sep38255), 
LMul13976 = multiply_layer([Con97996,Sep38255], Mul13976), 
LRes63416 = reshape_layer(Mul13976, [1, 6], Res63416), 
LCon22357 = conv1D_layer(Res63416, 1,[[[0.4233, 0.5406, 0.0303], [0.9799, 0.2065, 0.1746], [0.5593, 0.0698, 0.2584], [0.9684, 0.5182, 0.7841], [0.085, 0.2322, 0.3074], [0.4861, 0.5072, 0.0475]]],[0, 0, 0], 1, false, 1, Con22357), 
LRes394 = reshape_layer(Con22357, [1, 3, 1], Res394), 
LZer33147 = zero_padding2D_layer(Res394, 1, 1, 1, 1, Zer33147), 
LRes37095 = reshape_layer(Zer33147, [3, 5], Res37095), 
LFla27417 = flatten_layer(Res37095, Fla27417), 
LSub85789 = subtract_layer([[0.7246, 0.3416]], [[0.3164, 0.3957]], Sub85789), 
LCon39818 = concatenate_layer([Sub85789,[[0.467, 0.281, 0.5753, 0.7648, 0.5307, 0.5986, 0.4162, 0.4375, 0.3305, 0.2482, 0.6414, 0.9259, 0.9674]]], 1, Con39818), 
LMul48099 = multiply_layer([Fla27417,Con39818], Mul48099), 
exec_layers([LCon79674,LRes66988,LCon97996,LSep38255,LMul13976,LRes63416,LCon22357,LRes394,LZer33147,LRes37095,LFla27417,LSub85789,LCon39818,LMul48099],["Con79674","Res66988","Con97996","Sep38255","Mul13976","Res63416","Con22357","Res394","Zer33147","Res37095","Fla27417","Sub85789","Con39818","Mul48099"],Mul48099,"Mul48099")

Actual (Unparsed): [[0.0000000, -0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0165117, 0.0187702, 0.0063264, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,-0.0,0.0,0.0,0.0,0.0,0.016511717248649756,0.01877017064428665,0.006326437309924159,0.0,0.0,0.0,0.0,0.0,0.0]]

Actual:   [[0, -0, 0, 0, 0, 0, 0.0166, 0.0188, 0.0064, 0, 0, 0, 0, 0, 0]]

Expected: [[0, -0, 0, 0, 0, 0, 0.0166, 0.0188, 0.0064, 0, 0, 0, 0, 0, 0]]