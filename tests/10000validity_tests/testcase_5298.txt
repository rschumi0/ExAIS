import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot59952 = tf.keras.layers.Input(shape=([3]))
in1Dot59952 = tf.keras.layers.Input(shape=([3]))
in0Mul91495 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Mul91495 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Dot59952 = keras.layers.Dot(axes=(1, 1), name = 'Dot59952', )([in0Dot59952,in1Dot59952])
Res39990 = keras.layers.Reshape((1, 1), name = 'Res39990', )(Dot59952)
Res16049 = keras.layers.Reshape((1, 1, 1), name = 'Res16049', )(Res39990)
Res22100 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res22100', )(Res16049)
Zer70003 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer70003', )(Res22100)
Mul91495 = keras.layers.Multiply(name = 'Mul91495', )([in0Mul91495,in1Mul91495])
Mul849 = keras.layers.Multiply(name = 'Mul849', )([Zer70003,Mul91495])
Res16728 = keras.layers.Reshape((2, 2, 2), name = 'Res16728', )(Mul849)
Sep76624 = keras.layers.SeparableConv2D(3, (1, 2),strides=(1, 1), padding='valid', name = 'Sep76624', )(Res16728)
model = tf.keras.models.Model(inputs=[in0Dot59952,in1Dot59952,in0Mul91495,in1Mul91495], outputs=Sep76624)
w = model.get_layer('Sep76624').get_weights() 
w[0] = np.array([[[[0.8451], [0.8669]], [[0.7621], [0.566]]]])
w[1] = np.array([[[[0.3342, 0.0612, 0.6842], [0.527, 0.4629, 0.7029]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep76624').set_weights(w) 
in0Dot59952 = tf.constant([[0.6698, 0.3411, 0.8324]])
in1Dot59952 = tf.constant([[0.9069, 0.3511, 0.9454]])
in0Mul91495 = tf.constant([[[[[0.8042], [0.6093]], [[0.6037], [0.5245]]], [[[0.1695], [0.1771]], [[0.7557], [0.5286]]]]])
in1Mul91495 = tf.constant([[[[[0.4533], [0.9852]], [[0.3163], [0.6067]]], [[[0.7129], [0.9718]], [[0.7085], [0.1419]]]]])
print (np.array2string(model.predict([in0Dot59952,in1Dot59952,in0Mul91495,in1Mul91495],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep76624.png')

LDot59952 = dot_layer([[0.6698, 0.3411, 0.8324]], [[0.9069, 0.3511, 0.9454]], 1, 1, Dot59952), 
LRes39990 = reshape_layer(Dot59952, [1, 1], Res39990), 
LRes16049 = reshape_layer(Res39990, [1, 1, 1], Res16049), 
LRes22100 = reshape_layer(Res16049, [1, 1, 1, 1], Res22100), 
LZer70003 = zero_padding3D_layer(Res22100, 1, 0, 1, 0, 1, 0, Zer70003), 
LMul91495 = multiply_layer([[[[[[0.8042], [0.6093]], [[0.6037], [0.5245]]], [[[0.1695], [0.1771]], [[0.7557], [0.5286]]]]], [[[[[0.4533], [0.9852]], [[0.3163], [0.6067]]], [[[0.7129], [0.9718]], [[0.7085], [0.1419]]]]]], Mul91495), 
LMul849 = multiply_layer([Zer70003,Mul91495], Mul849), 
LRes16728 = reshape_layer(Mul849, [2, 2, 2], Res16728), 
LSep76624 = separable_conv2D_layer(Res16728, 1, 2,[[[[[0.8451], [0.8669]], [[0.7621], [0.566]]]],[[[[0.3342, 0.0612, 0.6842], [0.527, 0.4629, 0.7029]]]]],[0, 0, 0], 1, 1, false, Sep76624), 
exec_layers([LDot59952,LRes39990,LRes16049,LRes22100,LZer70003,LMul91495,LMul849,LRes16728,LSep76624],["Dot59952","Res39990","Res16049","Res22100","Zer70003","Mul91495","Mul849","Res16728","Sep76624"],Sep76624,"Sep76624")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000]], [[0.0338771, 0.0297566, 0.0451845]]]]

Expected (Unparsed): [[[[0.0,0.0,0.0]],[[0.0338771059033262,0.02975656987220057,0.04518447388889561]]]]

Actual:   [[[[0, 0, 0]], [[0.0339, 0.0298, 0.0452]]]]

Expected: [[[[0, 0, 0]], [[0.0339, 0.0298, 0.0452]]]]