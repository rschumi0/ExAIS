import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc99355 = tf.keras.layers.Input(shape=([2, 1]))

Loc99355 = keras.layers.LocallyConnected1D(2, (2),strides=(1), name = 'Loc99355', )(in0Loc99355)
ReL3164 = keras.layers.ReLU(max_value=3.7326246646825476, negative_slope=1.6269259807054224, threshold=4.371531977081247, name = 'ReL3164', )(Loc99355)
model = tf.keras.models.Model(inputs=[in0Loc99355], outputs=ReL3164)
w = model.get_layer('Loc99355').get_weights() 
w[0] = np.array([[[0.4023, 0.1179], [0.5282, 0.9508]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc99355').set_weights(w) 
in0Loc99355 = tf.constant([[[0.7867], [0.29]]])
print (np.array2string(model.predict([in0Loc99355],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL3164.png')

LLoc99355 = locally_connected1D_layer([[[0.7867], [0.29]]], 2,[[[0.4023, 0.1179], [0.5282, 0.9508]]],[[0, 0]], 1, Loc99355), 
LReL3164 = relu_layer(Loc99355, 3.7326246646825476, 1.6269259807054224, 4.371531977081247, ReL3164), 
exec_layers([LLoc99355,LReL3164],["Loc99355","ReL3164"],ReL3164,"ReL3164")

Actual (Unparsed): [[[-6.3480448, -6.5126629]]]

Expected (Unparsed): [[[-6.348044837378397,-6.512662869808584]]]

Actual:   [[[-6.348, -6.5126]]]

Expected: [[[-6.348, -6.5126]]]