import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas82158 = tf.keras.layers.Input(shape=([4, 3, 1]))
in0Up_79292 = tf.keras.layers.Input(shape=([4, 2]))
in0Con40796 = tf.keras.layers.Input(shape=([4, 1]))
in0Sub62514 = tf.keras.layers.Input(shape=([2]))
in1Sub62514 = tf.keras.layers.Input(shape=([2]))
in0Con82929 = tf.keras.layers.Input(shape=([10]))

Mas82158 = keras.layers.Masking(mask_value=2, name = 'Mas82158', )(in0Mas82158)
Res45824 = keras.layers.Reshape((4, 3), name = 'Res45824', )(Mas82158)
Up_79292 = keras.layers.UpSampling1D(size=(1), name = 'Up_79292', )(in0Up_79292)
Con40796 = keras.layers.Concatenate(axis=2, name = 'Con40796', )([Up_79292,in0Con40796])
Max66218 = keras.layers.Maximum(name = 'Max66218', )([Res45824,Con40796])
Fla54016 = keras.layers.Flatten(name = 'Fla54016', )(Max66218)
Sub62514 = keras.layers.Subtract(name = 'Sub62514', )([in0Sub62514,in1Sub62514])
Fla26479 = keras.layers.Flatten(name = 'Fla26479', )(Sub62514)
Con82929 = keras.layers.Concatenate(axis=1, name = 'Con82929', )([Fla26479,in0Con82929])
Sub37796 = keras.layers.Subtract(name = 'Sub37796', )([Fla54016,Con82929])
model = tf.keras.models.Model(inputs=[in0Mas82158,in0Up_79292,in0Con40796,in0Sub62514,in1Sub62514,in0Con82929], outputs=Sub37796)
in0Mas82158 = tf.constant([[[[1.1315], [1.4318], [1.7605]], [[1.7394], [1.1483], [1.0938]], [[1.7688], [1.7383], [1.2799]], [[1.3812], [1.9514], [1.6862]]]])
in0Up_79292 = tf.constant([[[1.8232, 1.494], [1.8975, 1.4689], [1.7724, 1.9802], [1.581, 1.513]]])
in0Con40796 = tf.constant([[[0.6996], [0.1858], [0.1882], [0.1821]]])
in0Sub62514 = tf.constant([[0.0616, 0.5773]])
in1Sub62514 = tf.constant([[0.6229, 0.8055]])
in0Con82929 = tf.constant([[0.8255, 0.0286, 0.5649, 0.0895, 0.0665, 0.8627, 0.1682, 0.5449, 0.0907, 0.1094]])
print (np.array2string(model.predict([in0Mas82158,in0Up_79292,in0Con40796,in0Sub62514,in1Sub62514,in0Con82929],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub37796.png')

LMas82158 = masking_layer([[[[1.1315], [1.4318], [1.7605]], [[1.7394], [1.1483], [1.0938]], [[1.7688], [1.7383], [1.2799]], [[1.3812], [1.9514], [1.6862]]]], 2, Mas82158), 
LRes45824 = reshape_layer(Mas82158, [4, 3], Res45824), 
LUp_79292 = up_sampling1D_layer([[[1.8232, 1.494], [1.8975, 1.4689], [1.7724, 1.9802], [1.581, 1.513]]], 1, Up_79292), 
LCon40796 = concatenate_layer([Up_79292,[[[0.6996], [0.1858], [0.1882], [0.1821]]]], 2, Con40796), 
LMax66218 = maximum_layer([Res45824,Con40796], Max66218), 
LFla54016 = flatten_layer(Max66218, Fla54016), 
LSub62514 = subtract_layer([[0.0616, 0.5773]], [[0.6229, 0.8055]], Sub62514), 
LFla26479 = flatten_layer(Sub62514, Fla26479), 
LCon82929 = concatenate_layer([Fla26479,[[0.8255, 0.0286, 0.5649, 0.0895, 0.0665, 0.8627, 0.1682, 0.5449, 0.0907, 0.1094]]], 1, Con82929), 
LSub37796 = subtract_layer(Fla54016,Con82929, Sub37796), 
exec_layers([LMas82158,LRes45824,LUp_79292,LCon40796,LMax66218,LFla54016,LSub62514,LFla26479,LCon82929,LSub37796],["Mas82158","Res45824","Up_79292","Con40796","Max66218","Fla54016","Sub62514","Fla26479","Con82929","Sub37796"],Sub37796,"Sub37796")

Actual (Unparsed): [[2.3845000, 1.7221999, 0.9349999, 1.8689000, 0.9040000, 1.0042999, 1.7059000, 1.1175001, 1.1117000, 1.0361000, 1.8607000, 1.5768000]]

Expected (Unparsed): [[2.3845,1.7222,0.9349999999999999,1.8689,0.9040000000000001,1.0043000000000002,1.7059,1.1175,1.1117000000000001,1.0360999999999998,1.8607,1.5768]]

Actual:   [[2.3845, 1.7222, 0.935, 1.8689, 0.904, 1.0043, 1.7059, 1.1176, 1.1117, 1.0361, 1.8607, 1.5768]]

Expected: [[2.3845, 1.7222, 0.935, 1.8689, 0.9041, 1.0044, 1.7059, 1.1175, 1.1118, 1.0361, 1.8607, 1.5768]]