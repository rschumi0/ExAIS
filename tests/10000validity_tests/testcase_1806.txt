import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con41885 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Max9476 = tf.keras.layers.Input(shape=([1, 1]))
in0Con51504 = tf.keras.layers.Input(shape=([1, 7]))
in0Con53420 = tf.keras.layers.Input(shape=([1, 8, 1]))
in0Ave40107 = tf.keras.layers.Input(shape=([1, 2, 2]))

Con41885 = keras.layers.Conv2D(4, (1, 1),strides=(8, 1), padding='valid', dilation_rate=(1, 1), name = 'Con41885', )(in0Con41885)
Res7044 = keras.layers.Reshape((1, 8), name = 'Res7044', )(Con41885)
Max9476 = keras.layers.MaxPool1D(pool_size=(1), strides=(2), padding='valid', name = 'Max9476', )(in0Max9476)
Con51504 = keras.layers.Concatenate(axis=2, name = 'Con51504', )([Max9476,in0Con51504])
Min57772 = keras.layers.Minimum(name = 'Min57772', )([Res7044,Con51504])
Res80821 = keras.layers.Reshape((1, 8, 1), name = 'Res80821', )(Min57772)
Con53420 = keras.layers.Concatenate(axis=3, name = 'Con53420', )([Res80821,in0Con53420])
Ave40107 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 4), padding='valid', name = 'Ave40107', )(in0Ave40107)
Zer58849 = keras.layers.ZeroPadding2D(padding=((0, 0), (7, 0)), name = 'Zer58849', )(Ave40107)
Mul84947 = keras.layers.Multiply(name = 'Mul84947', )([Con53420,Zer58849])
model = tf.keras.models.Model(inputs=[in0Con41885,in0Max9476,in0Con51504,in0Con53420,in0Ave40107], outputs=Mul84947)
w = model.get_layer('Con41885').get_weights() 
w[0] = np.array([[[[0.5971, 0.6871, 0.0405, 0.2879], [0.624, 0.1414, 0.6591, 0.9507]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con41885').set_weights(w) 
in0Con41885 = tf.constant([[[[0.6797, 0.6001], [0.1512, 0.399]]]])
in0Max9476 = tf.constant([[[1.5379]]])
in0Con51504 = tf.constant([[[0.3007, 0.7873, 0.6194, 0.6256, 0.5381, 0.8039, 0.015]]])
in0Con53420 = tf.constant([[[[0.736], [0.4766], [0.0831], [0.2575], [0.0762], [0.0284], [0.0707], [0.238]]]])
in0Ave40107 = tf.constant([[[[1.5507, 1.1994], [1.6328, 1.5174]]]])
print (np.array2string(model.predict([in0Con41885,in0Max9476,in0Con51504,in0Con53420,in0Ave40107],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul84947.png')

LCon41885 = conv2D_layer([[[[0.6797, 0.6001], [0.1512, 0.399]]]], 1, 1,[[[[0.5971, 0.6871, 0.0405, 0.2879], [0.624, 0.1414, 0.6591, 0.9507]]]],[0, 0, 0, 0], 8, 1, false, 1, 1, Con41885), 
LRes7044 = reshape_layer(Con41885, [1, 8], Res7044), 
LMax9476 = max_pool1D_layer([[[1.5379]]], 1, 2, false, Max9476), 
LCon51504 = concatenate_layer([Max9476,[[[0.3007, 0.7873, 0.6194, 0.6256, 0.5381, 0.8039, 0.015]]]], 2, Con51504), 
LMin57772 = minimum_layer([Res7044,Con51504], Min57772), 
LRes80821 = reshape_layer(Min57772, [1, 8, 1], Res80821), 
LCon53420 = concatenate_layer([Res80821,[[[[0.736], [0.4766], [0.0831], [0.2575], [0.0762], [0.0284], [0.0707], [0.238]]]]], 3, Con53420), 
LAve40107 = average_pooling2D_layer([[[[1.5507, 1.1994], [1.6328, 1.5174]]]], 1, 1, 1, 4, false, Ave40107), 
LZer58849 = zero_padding2D_layer(Ave40107, 0, 0, 7, 0, Zer58849), 
LMul84947 = multiply_layer([Con53420,Zer58849], Mul84947), 
exec_layers([LCon41885,LRes7044,LMax9476,LCon51504,LMin57772,LRes80821,LCon53420,LAve40107,LZer58849,LMul84947],["Con41885","Res7044","Max9476","Con51504","Min57772","Res80821","Con53420","Ave40107","Zer58849","Mul84947"],Mul84947,"Mul84947")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0232605, 0.2854572]]]]

Expected (Unparsed): [[[[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0232605,0.28545719999999997]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0.0233, 0.2855]]]]

Expected: [[[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0.0233, 0.2855]]]]