import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max59074 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max59074 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Ave26356 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave26356 = tf.keras.layers.Input(shape=([2, 2]))
in0Con6956 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Ave83381 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Dep51979 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Mul82937 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul82937 = tf.keras.layers.Input(shape=([1, 1]))
in0Con91097 = tf.keras.layers.Input(shape=([2]))
in0LST63510 = tf.keras.layers.Input(shape=([3, 2]))
in0Con75380 = tf.keras.layers.Input(shape=([11]))

Max59074 = keras.layers.Maximum(name = 'Max59074', )([in0Max59074,in1Max59074])
Res57492 = keras.layers.Reshape((1, 2), name = 'Res57492', )(Max59074)
Zer33580 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer33580', )(Res57492)
Ave26356 = keras.layers.Average(name = 'Ave26356', )([in0Ave26356,in1Ave26356])
Add76889 = keras.layers.Add(name = 'Add76889', )([Zer33580,Ave26356])
Res700 = keras.layers.Reshape((2, 2, 1), name = 'Res700', )(Add76889)
Zer48015 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer48015', )(Res700)
Con6956 = keras.layers.Concatenate(axis=3, name = 'Con6956', )([Zer48015,in0Con6956])
Ave83381 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave83381', )(in0Ave83381)
Zer69506 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer69506', )(Ave83381)
Dep51979 = keras.layers.DepthwiseConv2D((1, 2),strides=(1, 1), padding='same', name = 'Dep51979', )(in0Dep51979)
Zer95468 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer95468', )(Dep51979)
Add20512 = keras.layers.Add(name = 'Add20512', )([Zer69506,Zer95468])
Min99707 = keras.layers.Minimum(name = 'Min99707', )([Con6956,Add20512])
Res35671 = keras.layers.Reshape((2, 6), name = 'Res35671', )(Min99707)
Fla18647 = keras.layers.Flatten(name = 'Fla18647', )(Res35671)
Mul82937 = keras.layers.Multiply(name = 'Mul82937', )([in0Mul82937,in1Mul82937])
Fla88920 = keras.layers.Flatten(name = 'Fla88920', )(Mul82937)
Con91097 = keras.layers.Concatenate(axis=1, name = 'Con91097', )([Fla88920,in0Con91097])
LST63510 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST63510', )(in0LST63510)
Dot44527 = keras.layers.Dot(axes=(1, 1), name = 'Dot44527', )([Con91097,LST63510])
Con75380 = keras.layers.Concatenate(axis=1, name = 'Con75380', )([Dot44527,in0Con75380])
Ave67671 = keras.layers.Average(name = 'Ave67671', )([Fla18647,Con75380])
model = tf.keras.models.Model(inputs=[in0Max59074,in1Max59074,in0Ave26356,in1Ave26356,in0Con6956,in0Ave83381,in0Dep51979,in0Mul82937,in1Mul82937,in0Con91097,in0LST63510,in0Con75380], outputs=Ave67671)
w = model.get_layer('Dep51979').get_weights() 
w[0] = np.array([[[[0.1296], [0.981]], [[0.9019], [0.126]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep51979').set_weights(w) 
w = model.get_layer('LST63510').get_weights() 
w[0] = np.array([[8, 1, 5, 7, 9, 2, 9, 2, 7, 8, 8, 9], [9, 8, 6, 7, 6, 2, 5, 9, 4, 7, 10, 3]])
w[1] = np.array([[5, 7, 4, 9, 2, 6, 2, 9, 6, 9, 3, 7], [8, 2, 2, 1, 1, 9, 2, 2, 8, 4, 2, 2], [9, 3, 4, 3, 2, 6, 5, 1, 3, 5, 4, 5]])
w[2] = np.array([8, 10, 10, 8, 6, 4, 5, 8, 8, 8, 8, 7])
model.get_layer('LST63510').set_weights(w) 
in0Max59074 = tf.constant([[[[0.0063], [0.4703]]]])
in1Max59074 = tf.constant([[[[0.1449], [0.8836]]]])
in0Ave26356 = tf.constant([[[0.1, 0.4374], [0.284, 0.4631]]])
in1Ave26356 = tf.constant([[[0.5176, 0.8873], [0.1953, 0.4988]]])
in0Con6956 = tf.constant([[[[0.4257], [0.2757], [0.2805]], [[0.8197], [0.4338], [0.8045]]]])
in0Ave83381 = tf.constant([[[[1.0925, 1.5082]], [[1.004, 1.1322]]]])
in0Dep51979 = tf.constant([[[[0.237, 0.8989], [0.3803, 0.2525]]]])
in0Mul82937 = tf.constant([[[0.3309]]])
in1Mul82937 = tf.constant([[[0.6145]]])
in0Con91097 = tf.constant([[0.6318, 0.9415]])
in0LST63510 = tf.constant([[[6, 1], [5, 9], [5, 4]]])
in0Con75380 = tf.constant([[0.1808, 0.9558, 0.0745, 0.6294, 0.9354, 0.6826, 0.3903, 0.5624, 0.029, 0.4925, 0.0726]])
print (np.array2string(model.predict([in0Max59074,in1Max59074,in0Ave26356,in1Ave26356,in0Con6956,in0Ave83381,in0Dep51979,in0Mul82937,in1Mul82937,in0Con91097,in0LST63510,in0Con75380],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave67671.png')

LMax59074 = maximum_layer([[[[[0.0063], [0.4703]]]], [[[[0.1449], [0.8836]]]]], Max59074), 
LRes57492 = reshape_layer(Max59074, [1, 2], Res57492), 
LZer33580 = zero_padding1D_layer(Res57492, 1, 0, Zer33580), 
LAve26356 = average_layer([[[[0.1, 0.4374], [0.284, 0.4631]]], [[[0.5176, 0.8873], [0.1953, 0.4988]]]], Ave26356), 
LAdd76889 = add_layer([Zer33580,Ave26356], Add76889), 
LRes700 = reshape_layer(Add76889, [2, 2, 1], Res700), 
LZer48015 = zero_padding2D_layer(Res700, 0, 0, 1, 0, Zer48015), 
LCon6956 = concatenate_layer([Zer48015,[[[[0.4257], [0.2757], [0.2805]], [[0.8197], [0.4338], [0.8045]]]]], 3, Con6956), 
LAve83381 = average_pooling2D_layer([[[[1.0925, 1.5082]], [[1.004, 1.1322]]]], 1, 1, Ave83381), 
LZer69506 = zero_padding2D_layer(Ave83381, 0, 0, 2, 0, Zer69506), 
LDep51979 = depthwise_conv2D_layer([[[[0.237, 0.8989], [0.3803, 0.2525]]]], 1, 2,[[[[0.1296], [0.981]], [[0.9019], [0.126]]]],[0, 0], 1, 1, true, Dep51979), 
LZer95468 = zero_padding2D_layer(Dep51979, 1, 0, 1, 0, Zer95468), 
LAdd20512 = add_layer([Zer69506,Zer95468], Add20512), 
LMin99707 = minimum_layer([Con6956,Add20512], Min99707), 
LRes35671 = reshape_layer(Min99707, [2, 6], Res35671), 
LFla18647 = flatten_layer(Res35671, Fla18647), 
LMul82937 = multiply_layer([[[[0.3309]]], [[[0.6145]]]], Mul82937), 
LFla88920 = flatten_layer(Mul82937, Fla88920), 
LCon91097 = concatenate_layer([Fla88920,[[0.6318, 0.9415]]], 1, Con91097), 
LLST63510 = lstm_layer([[[6, 1], [5, 9], [5, 4]]],[[8, 1, 5, 7, 9, 2, 9, 2, 7, 8, 8, 9], [9, 8, 6, 7, 6, 2, 5, 9, 4, 7, 10, 3]],[[5, 7, 4, 9, 2, 6, 2, 9, 6, 9, 3, 7], [8, 2, 2, 1, 1, 9, 2, 2, 8, 4, 2, 2], [9, 3, 4, 3, 2, 6, 5, 1, 3, 5, 4, 5]],[8, 10, 10, 8, 6, 4, 5, 8, 8, 8, 8, 7], LST63510), 
LDot44527 = dot_layer(Con91097,LST63510, 1, 1, Dot44527), 
LCon75380 = concatenate_layer([Dot44527,[[0.1808, 0.9558, 0.0745, 0.6294, 0.9354, 0.6826, 0.3903, 0.5624, 0.029, 0.4925, 0.0726]]], 1, Con75380), 
LAve67671 = average_layer([Fla18647,Con75380], Ave67671), 
exec_layers([LMax59074,LRes57492,LZer33580,LAve26356,LAdd76889,LRes700,LZer48015,LCon6956,LAve83381,LZer69506,LDep51979,LZer95468,LAdd20512,LMin99707,LRes35671,LFla18647,LMul82937,LFla88920,LCon91097,LLST63510,LDot44527,LCon75380,LAve67671],["Max59074","Res57492","Zer33580","Ave26356","Add76889","Res700","Zer48015","Con6956","Ave83381","Zer69506","Dep51979","Zer95468","Add20512","Min99707","Res35671","Fla18647","Mul82937","Fla88920","Con91097","LST63510","Dot44527","Con75380","Ave67671"],Ave67671,"Ave67671")

Actual (Unparsed): [[0.8839261, 0.0904000, 0.4779000, 0.0372500, 0.6458750, 0.6079500, 0.3413000, 0.1951500, 0.4680539, 0.2314000, 0.7728934, 0.4385500]]

Expected (Unparsed): [[0.8839260686164939,0.0904,0.4779,0.03725,0.645875,0.60795,0.3413,0.19515,0.468053885,0.23140000000000002,0.7728934399999999,0.43855]]

Actual:   [[0.884, 0.0904, 0.4779, 0.0373, 0.6459, 0.608, 0.3413, 0.1952, 0.4681, 0.2314, 0.7729, 0.4386]]

Expected: [[0.884, 0.0904, 0.4779, 0.0373, 0.6459, 0.608, 0.3413, 0.1952, 0.4681, 0.2315, 0.7729, 0.4386]]