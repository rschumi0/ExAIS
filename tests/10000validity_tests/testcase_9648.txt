import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max31750 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max31750 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Cro38081 = tf.keras.layers.Input(shape=([1, 4, 4]))
in0Con94227 = tf.keras.layers.Input(shape=([4]))
in0Min95951 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min95951 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Sof54803 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max31750 = keras.layers.Maximum(name = 'Max31750', )([in0Max31750,in1Max31750])
Res13633 = keras.layers.Reshape((2, 2), name = 'Res13633', )(Max31750)
Zer38254 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer38254', )(Res13633)
Fla40090 = keras.layers.Flatten(name = 'Fla40090', )(Zer38254)
Cro38081 = keras.layers.Cropping2D(cropping=((0, 0), (2, 1)), name = 'Cro38081', )(in0Cro38081)
Res74386 = keras.layers.Reshape((1, 4), name = 'Res74386', )(Cro38081)
Glo12643 = keras.layers.GlobalAveragePooling1D(name = 'Glo12643', )(Res74386)
Con94227 = keras.layers.Concatenate(axis=1, name = 'Con94227', )([Glo12643,in0Con94227])
Mul54423 = keras.layers.Multiply(name = 'Mul54423', )([Fla40090,Con94227])
Res47566 = keras.layers.Reshape((8, 1), name = 'Res47566', )(Mul54423)
Res74969 = keras.layers.Reshape((8, 1, 1), name = 'Res74969', )(Res47566)
Min95951 = keras.layers.Minimum(name = 'Min95951', )([in0Min95951,in1Min95951])
Zer86224 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer86224', )(Min95951)
Sof54803 = keras.layers.Softmax(axis=1, name = 'Sof54803', input_shape=(2, 1, 1))(in0Sof54803)
Mul13255 = keras.layers.Multiply(name = 'Mul13255', )([Zer86224,Sof54803])
Zer67603 = keras.layers.ZeroPadding2D(padding=((6, 0), (0, 0)), name = 'Zer67603', )(Mul13255)
Sub60618 = keras.layers.Subtract(name = 'Sub60618', )([Res74969,Zer67603])
model = tf.keras.models.Model(inputs=[in0Max31750,in1Max31750,in0Cro38081,in0Con94227,in0Min95951,in1Min95951,in0Sof54803], outputs=Sub60618)
in0Max31750 = tf.constant([[[[0.8446], [0.7622]], [[0.2113], [0.9824]]]])
in1Max31750 = tf.constant([[[[0.2061], [0.4104]], [[0.2414], [0.0822]]]])
in0Cro38081 = tf.constant([[[[1.0452, 1.4704, 1.3161, 1.099], [1.6202, 1.2907, 1.2619, 1.8624], [1.3548, 1.8547, 1.8142, 1.5033], [1.2513, 1.4424, 1.6957, 1.1535]]]])
in0Con94227 = tf.constant([[0.4333, 0.5467, 0.1272, 0.761]])
in0Min95951 = tf.constant([[[[0.008]]]])
in1Min95951 = tf.constant([[[[0.5344]]]])
in0Sof54803 = tf.constant([[[[0.7134]], [[0.0183]]]])
print (np.array2string(model.predict([in0Max31750,in1Max31750,in0Cro38081,in0Con94227,in0Min95951,in1Min95951,in0Sof54803],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub60618.png')

LMax31750 = maximum_layer([[[[[0.8446], [0.7622]], [[0.2113], [0.9824]]]], [[[[0.2061], [0.4104]], [[0.2414], [0.0822]]]]], Max31750), 
LRes13633 = reshape_layer(Max31750, [2, 2], Res13633), 
LZer38254 = zero_padding1D_layer(Res13633, 1, 1, Zer38254), 
LFla40090 = flatten_layer(Zer38254, Fla40090), 
LCro38081 = cropping2D_layer([[[[1.0452, 1.4704, 1.3161, 1.099], [1.6202, 1.2907, 1.2619, 1.8624], [1.3548, 1.8547, 1.8142, 1.5033], [1.2513, 1.4424, 1.6957, 1.1535]]]], 0, 0, 2, 1, Cro38081), 
LRes74386 = reshape_layer(Cro38081, [1, 4], Res74386), 
LGlo12643 = global_average_pooling1D_layer(Res74386, Glo12643), 
LCon94227 = concatenate_layer([Glo12643,[[0.4333, 0.5467, 0.1272, 0.761]]], 1, Con94227), 
LMul54423 = multiply_layer([Fla40090,Con94227], Mul54423), 
LRes47566 = reshape_layer(Mul54423, [8, 1], Res47566), 
LRes74969 = reshape_layer(Res47566, [8, 1, 1], Res74969), 
LMin95951 = minimum_layer([[[[[0.008]]]], [[[[0.5344]]]]], Min95951), 
LZer86224 = zero_padding2D_layer(Min95951, 1, 0, 0, 0, Zer86224), 
LSof54803 = softmax_layer([[[[0.7134]], [[0.0183]]]], 1, Sof54803), 
LMul13255 = multiply_layer([Zer86224,Sof54803], Mul13255), 
LZer67603 = zero_padding2D_layer(Mul13255, 6, 0, 0, 0, Zer67603), 
LSub60618 = subtract_layer(Res74969,Zer67603, Sub60618), 
exec_layers([LMax31750,LRes13633,LZer38254,LFla40090,LCro38081,LRes74386,LGlo12643,LCon94227,LMul54423,LRes47566,LRes74969,LMin95951,LZer86224,LSof54803,LMul13255,LZer67603,LSub60618],["Max31750","Res13633","Zer38254","Fla40090","Cro38081","Res74386","Glo12643","Con94227","Mul54423","Res47566","Res74969","Min95951","Zer86224","Sof54803","Mul13255","Zer67603","Sub60618"],Sub60618,"Sub60618")

Actual (Unparsed): [[[[0.0000000]], [[0.0000000]], [[1.5322734]], [[1.1458152]], [[0.1045986]], [[0.5370781]], [[0.0000000]], [[-0.0026632]]]]

Expected (Unparsed): [[[[0.0]],[[0.0]],[[1.53227332]],[[1.14581526]],[[0.10459862]],[[0.53707808]],[[0.0]],[[-0.002663196118324083]]]]

Actual:   [[[[0]], [[0]], [[1.5323]], [[1.1459]], [[0.1046]], [[0.5371]], [[0]], [[-0.0026]]]]

Expected: [[[[0]], [[0]], [[1.5323]], [[1.1459]], [[0.1046]], [[0.5371]], [[0]], [[-0.0026]]]]