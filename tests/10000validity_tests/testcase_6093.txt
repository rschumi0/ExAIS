import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave44361 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave44361 = tf.keras.layers.Input(shape=([1, 2]))
in0Max44986 = tf.keras.layers.Input(shape=([2, 2]))
in1Max44986 = tf.keras.layers.Input(shape=([2, 2]))
in0Con28811 = tf.keras.layers.Input(shape=([3]))

Ave44361 = keras.layers.Average(name = 'Ave44361', )([in0Ave44361,in1Ave44361])
Zer75892 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer75892', )(Ave44361)
Fla51096 = keras.layers.Flatten(name = 'Fla51096', )(Zer75892)
Max44986 = keras.layers.Maximum(name = 'Max44986', )([in0Max44986,in1Max44986])
Sim86392 = keras.layers.SimpleRNN(3,name = 'Sim86392', )(Max44986)
Con28811 = keras.layers.Concatenate(axis=1, name = 'Con28811', )([Sim86392,in0Con28811])
Ave66317 = keras.layers.Average(name = 'Ave66317', )([Fla51096,Con28811])
model = tf.keras.models.Model(inputs=[in0Ave44361,in1Ave44361,in0Max44986,in1Max44986,in0Con28811], outputs=Ave66317)
w = model.get_layer('Sim86392').get_weights() 
w[0] = np.array([[7, 1, 3], [5, 4, 2]])
w[1] = np.array([[2, 3, 9], [3, 6, 9], [1, 3, 9]])
w[2] = np.array([5, 5, 7])
model.get_layer('Sim86392').set_weights(w) 
in0Ave44361 = tf.constant([[[0.3637, 0.5199]]])
in1Ave44361 = tf.constant([[[0.7432, 0.326]]])
in0Max44986 = tf.constant([[[0.9069, 0.8045], [0.1325, 0.5557]]])
in1Max44986 = tf.constant([[[0.8499, 0.4818], [0.6468, 0.0745]]])
in0Con28811 = tf.constant([[0.0477, 0.7125, 0.8107]])
print (np.array2string(model.predict([in0Ave44361,in1Ave44361,in0Max44986,in1Max44986,in0Con28811],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave66317.png')

LAve44361 = average_layer([[[[0.3637, 0.5199]]], [[[0.7432, 0.326]]]], Ave44361), 
LZer75892 = zero_padding1D_layer(Ave44361, 1, 1, Zer75892), 
LFla51096 = flatten_layer(Zer75892, Fla51096), 
LMax44986 = maximum_layer([[[[0.9069, 0.8045], [0.1325, 0.5557]]], [[[0.8499, 0.4818], [0.6468, 0.0745]]]], Max44986), 
LSim86392 = simple_rnn_layer(Max44986,[[7, 1, 3], [5, 4, 2]],[[2, 3, 9], [3, 6, 9], [1, 3, 9]],[5, 5, 7], Sim86392), 
LCon28811 = concatenate_layer([Sim86392,[[0.0477, 0.7125, 0.8107]]], 1, Con28811), 
LAve66317 = average_layer([Fla51096,Con28811], Ave66317), 
exec_layers([LAve44361,LZer75892,LFla51096,LMax44986,LSim86392,LCon28811,LAve66317],["Ave44361","Zer75892","Fla51096","Max44986","Sim86392","Con28811","Ave66317"],Ave66317,"Ave66317")

Actual (Unparsed): [[0.5000000, 0.5000000, 0.7767250, 0.2353250, 0.3562500, 0.4053500]]

Expected (Unparsed): [[0.4999999999999999,0.5,0.776725,0.23532500000000003,0.35625,0.40535]]

Actual:   [[0.5, 0.5, 0.7768, 0.2354, 0.3563, 0.4054]]

Expected: [[0.5, 0.5, 0.7768, 0.2354, 0.3563, 0.4054]]