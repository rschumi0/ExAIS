import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con66666 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Sub34899 = tf.keras.layers.Input(shape=([2, 3, 2]))
in1Sub34899 = tf.keras.layers.Input(shape=([2, 3, 2]))
in0Con18303 = tf.keras.layers.Input(shape=([2, 3, 2]))

Con66666 = keras.layers.Conv3DTranspose(2, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con66666', )(in0Con66666)
Res68274 = keras.layers.Reshape((2, 1, 4), name = 'Res68274', )(Con66666)
Zer85971 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer85971', )(Res68274)
Sub34899 = keras.layers.Subtract(name = 'Sub34899', )([in0Sub34899,in1Sub34899])
Con18303 = keras.layers.Concatenate(axis=3, name = 'Con18303', )([Sub34899,in0Con18303])
Max45017 = keras.layers.Maximum(name = 'Max45017', )([Zer85971,Con18303])
model = tf.keras.models.Model(inputs=[in0Con66666,in0Sub34899,in1Sub34899,in0Con18303], outputs=Max45017)
w = model.get_layer('Con66666').get_weights() 
w[0] = np.array([[[[[0.952, 0.4806], [0.5984, 0.4948]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con66666').set_weights(w) 
in0Con66666 = tf.constant([[[[[0.2828, 0.6466], [0.1136, 0.4719]]], [[[0.1949, 0.5508], [0.7207, 0.0595]]]]])
in0Sub34899 = tf.constant([[[[0.2079, 0.4923], [0.2989, 0.3486], [0.8871, 0.2031]], [[0.858, 0.8327], [0.3172, 0.2946], [0.6094, 0.2253]]]])
in1Sub34899 = tf.constant([[[[0.0859, 0.0908], [0.2655, 0.167], [0.2579, 0.9975]], [[0.5511, 0.3775], [0.176, 0.2879], [0.9708, 0.9634]]]])
in0Con18303 = tf.constant([[[[0.2076, 0.0342], [0.6299, 0.7194], [0.4445, 0.0106]], [[0.6324, 0.5324], [0.3067, 0.1525], [0.2567, 0.7081]]]])
print (np.array2string(model.predict([in0Con66666,in0Sub34899,in1Sub34899,in0Con18303],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max45017.png')

LCon66666 = conv3D_transpose_layer([[[[[0.2828, 0.6466], [0.1136, 0.4719]]], [[[0.1949, 0.5508], [0.7207, 0.0595]]]]], 1, 1, 1,[[[[[0.952, 0.4806], [0.5984, 0.4948]]]]],[0, 0], 1, 1, 1, false, Con66666), 
LRes68274 = reshape_layer(Con66666, [2, 1, 4], Res68274), 
LZer85971 = zero_padding2D_layer(Res68274, 0, 0, 2, 0, Zer85971), 
LSub34899 = subtract_layer([[[[0.2079, 0.4923], [0.2989, 0.3486], [0.8871, 0.2031]], [[0.858, 0.8327], [0.3172, 0.2946], [0.6094, 0.2253]]]], [[[[0.0859, 0.0908], [0.2655, 0.167], [0.2579, 0.9975]], [[0.5511, 0.3775], [0.176, 0.2879], [0.9708, 0.9634]]]], Sub34899), 
LCon18303 = concatenate_layer([Sub34899,[[[[0.2076, 0.0342], [0.6299, 0.7194], [0.4445, 0.0106]], [[0.6324, 0.5324], [0.3067, 0.1525], [0.2567, 0.7081]]]]], 3, Con18303), 
LMax45017 = maximum_layer([Zer85971,Con18303], Max45017), 
exec_layers([LCon66666,LRes68274,LZer85971,LSub34899,LCon18303,LMax45017],["Con66666","Res68274","Zer85971","Sub34899","Con18303","Max45017"],Max45017,"Max45017")

Actual (Unparsed): [[[[0.1220000, 0.4015000, 0.2076000, 0.0342000], [0.0334000, 0.1816000, 0.6299000, 0.7194000], [0.6292000, 0.4891652, 0.4445000, 0.3014744]], [[0.3069000, 0.4552000, 0.6324000, 0.5324000], [0.1412000, 0.0067000, 0.3067000, 0.1525000], [0.4502593, 0.3891640, 0.7147021, 0.7081000]]]]

Expected (Unparsed): [[[[0.122,0.4015,0.2076,0.0342],[0.033399999999999985,0.1816,0.6299,0.7194],[0.6292,0.4891652,0.4445,0.30147436]],[[0.30689999999999995,0.4552,0.6324,0.5324],[0.1412,0.006699999999999984,0.3067,0.1525],[0.45025927999999993,0.38916399999999995,0.7147021,0.7081]]]]

Actual:   [[[[0.122, 0.4015, 0.2076, 0.0342], [0.0334, 0.1816, 0.6299, 0.7194], [0.6292, 0.4892, 0.4445, 0.3015]], [[0.3069, 0.4552, 0.6324, 0.5324], [0.1412, 0.0067, 0.3067, 0.1525], [0.4503, 0.3892, 0.7148, 0.7081]]]]

Expected: [[[[0.122, 0.4015, 0.2076, 0.0342], [0.0334, 0.1816, 0.6299, 0.7194], [0.6292, 0.4892, 0.4445, 0.3015]], [[0.3069, 0.4552, 0.6324, 0.5324], [0.1412, 0.0067, 0.3067, 0.1525], [0.4503, 0.3892, 0.7148, 0.7081]]]]