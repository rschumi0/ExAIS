import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub25318 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub25318 = tf.keras.layers.Input(shape=([2, 2]))

Sub25318 = keras.layers.Subtract(name = 'Sub25318', )([in0Sub25318,in1Sub25318])
Ave35071 = keras.layers.AveragePooling1D(pool_size=(2), name = 'Ave35071', )(Sub25318)
GRU96220 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU96220', )(Ave35071)
model = tf.keras.models.Model(inputs=[in0Sub25318,in1Sub25318], outputs=GRU96220)
w = model.get_layer('GRU96220').get_weights() 
w[0] = np.array([[3, 1, 4, 10, 3, 7], [8, 10, 7, 1, 10, 7]])
w[1] = np.array([[4, 6, 9, 2, 4, 10], [4, 9, 7, 7, 8, 5]])
w[2] = np.array([2, 5, 3, 1, 3, 2])
model.get_layer('GRU96220').set_weights(w) 
in0Sub25318 = tf.constant([[[0.3137, 0.524], [0.8499, 0.7399]]])
in1Sub25318 = tf.constant([[[0.8382, 0.2127], [0.7876, 0.6836]]])
print (np.array2string(model.predict([in0Sub25318,in1Sub25318],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU96220.png')

LSub25318 = subtract_layer([[[0.3137, 0.524], [0.8499, 0.7399]]], [[[0.8382, 0.2127], [0.7876, 0.6836]]], Sub25318), 
LAve35071 = average_pooling1D_layer(Sub25318, 2, Ave35071), 
LGRU96220 = gru_layer(Ave35071,[[3, 1, 4, 10, 3, 7], [8, 10, 7, 1, 10, 7]],[[4, 6, 9, 2, 4, 10], [4, 9, 7, 7, 8, 5]],[2, 5, 3, 1, 3, 2], false, GRU96220), 
exec_layers([LSub25318,LAve35071,LGRU96220],["Sub25318","Ave35071","GRU96220"],GRU96220,"GRU96220")

Actual (Unparsed): [[0.0585449, 0.0012566]]

Expected (Unparsed): [[0.0585448503756378,0.0012566447607822696]]

Actual:   [[0.0586, 0.0013]]

Expected: [[0.0586, 0.0013]]