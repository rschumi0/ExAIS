import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max27153 = tf.keras.layers.Input(shape=([2, 2]))
in1Max27153 = tf.keras.layers.Input(shape=([2, 2]))

Max27153 = keras.layers.Maximum(name = 'Max27153', )([in0Max27153,in1Max27153])
Lea2427 = keras.layers.LeakyReLU(alpha=7.474377119339443, name = 'Lea2427', )(Max27153)
Sim32086 = keras.layers.SimpleRNN(2,name = 'Sim32086', )(Lea2427)
model = tf.keras.models.Model(inputs=[in0Max27153,in1Max27153], outputs=Sim32086)
w = model.get_layer('Sim32086').get_weights() 
w[0] = np.array([[8, 1], [5, 10]])
w[1] = np.array([[6, 7], [9, 6]])
w[2] = np.array([10, 9])
model.get_layer('Sim32086').set_weights(w) 
in0Max27153 = tf.constant([[[0.2617, 0.5297], [0.4258, 0.7567]]])
in1Max27153 = tf.constant([[[0.5414, 0.1889], [0.687, 0.3821]]])
print (np.array2string(model.predict([in0Max27153,in1Max27153],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim32086.png')

LMax27153 = maximum_layer([[[[0.2617, 0.5297], [0.4258, 0.7567]]], [[[0.5414, 0.1889], [0.687, 0.3821]]]], Max27153), 
LLea2427 = leaky_relu_layer(Max27153, 7.474377119339443, Lea2427), 
LSim32086 = simple_rnn_layer(Lea2427,[[8, 1], [5, 10]],[[6, 7], [9, 6]],[10, 9], Sim32086), 
exec_layers([LMax27153,LLea2427,LSim32086],["Max27153","Lea2427","Sim32086"],Sim32086,"Sim32086")

Actual (Unparsed): [[1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0]]

Actual:   [[1, 1]]

Expected: [[1, 1]]