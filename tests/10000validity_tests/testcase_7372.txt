import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave45879 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave45879 = tf.keras.layers.Input(shape=([2, 2]))

Ave45879 = keras.layers.Average(name = 'Ave45879', )([in0Ave45879,in1Ave45879])
Res23496 = keras.layers.Reshape((2, 2, 1), name = 'Res23496', )(Ave45879)
Con99002 = keras.layers.Conv2D(4, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con99002', )(Res23496)
Con10996 = keras.layers.Conv2D(3, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con10996', )(Con99002)
model = tf.keras.models.Model(inputs=[in0Ave45879,in1Ave45879], outputs=Con10996)
w = model.get_layer('Con99002').get_weights() 
w[0] = np.array([[[[0.9897, 0.6911, 0.2551, 0.1661]], [[0.064, 0.7836, 0.1584, 0.6598]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con99002').set_weights(w) 
w = model.get_layer('Con10996').get_weights() 
w[0] = np.array([[[[0.5344, 0.6265, 0.5909], [0.5172, 0.7617, 0.301], [0.3817, 0.9758, 0.5908], [0.4527, 0.3229, 0.8504]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con10996').set_weights(w) 
in0Ave45879 = tf.constant([[[0.9926, 0.7214], [0.5352, 0.5147]]])
in1Ave45879 = tf.constant([[[0.1776, 0.9314], [0.7084, 0.6671]]])
print (np.array2string(model.predict([in0Ave45879,in1Ave45879],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con10996.png')

LAve45879 = average_layer([[[[0.9926, 0.7214], [0.5352, 0.5147]]], [[[0.1776, 0.9314], [0.7084, 0.6671]]]], Ave45879), 
LRes23496 = reshape_layer(Ave45879, [2, 2, 1], Res23496), 
LCon99002 = conv2D_layer(Res23496, 1, 2,[[[[0.9897, 0.6911, 0.2551, 0.1661]], [[0.064, 0.7836, 0.1584, 0.6598]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con99002), 
LCon10996 = conv2D_layer(Con99002, 1, 1,[[[[0.5344, 0.6265, 0.5909], [0.5172, 0.7617, 0.301], [0.3817, 0.9758, 0.5908], [0.4527, 0.3229, 0.8504]]]],[0, 0, 0], 1, 1, false, 1, 1, Con10996), 
exec_layers([LAve45879,LRes23496,LCon99002,LCon10996],["Ave45879","Res23496","Con99002","Con10996"],Con10996,"Con10996")

Actual (Unparsed): [[[[1.2795508, 1.6780057, 1.4019110]], [[1.1303344, 1.4946060, 1.2230949]]]]

Expected (Unparsed): [[[[1.2795507673380002,1.678005669833,1.401911018661]],[[1.130334417166,1.4946059861760002,1.223094883486]]]]

Actual:   [[[[1.2796, 1.6781, 1.402]], [[1.1304, 1.4947, 1.2231]]]]

Expected: [[[[1.2796, 1.6781, 1.402]], [[1.1304, 1.4947, 1.2231]]]]