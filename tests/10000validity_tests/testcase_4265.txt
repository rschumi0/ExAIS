import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU90127 = tf.keras.layers.Input(shape=([2, 2]))

GRU90127 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU90127', )(in0GRU90127)
Res60496 = keras.layers.Reshape((2, 1), name = 'Res60496', )(GRU90127)
Res41057 = keras.layers.Reshape((2, 1, 1), name = 'Res41057', )(Res60496)
Res42275 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res42275', )(Res41057)
Glo94821 = keras.layers.GlobalAveragePooling3D(name = 'Glo94821', )(Res42275)
model = tf.keras.models.Model(inputs=[in0GRU90127], outputs=Glo94821)
w = model.get_layer('GRU90127').get_weights() 
w[0] = np.array([[7, 10, 5, 2, 5, 4], [6, 6, 8, 6, 7, 5]])
w[1] = np.array([[6, 9, 10, 10, 1, 1], [2, 1, 5, 2, 3, 10]])
w[2] = np.array([2, 5, 3, 5, 6, 10])
model.get_layer('GRU90127').set_weights(w) 
in0GRU90127 = tf.constant([[[9, 1], [1, 10]]])
print (np.array2string(model.predict([in0GRU90127],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo94821.png')

LGRU90127 = gru_layer([[[9, 1], [1, 10]]],[[7, 10, 5, 2, 5, 4], [6, 6, 8, 6, 7, 5]],[[6, 9, 10, 10, 1, 1], [2, 1, 5, 2, 3, 10]],[2, 5, 3, 5, 6, 10], false, GRU90127), 
LRes60496 = reshape_layer(GRU90127, [2, 1], Res60496), 
LRes41057 = reshape_layer(Res60496, [2, 1, 1], Res41057), 
LRes42275 = reshape_layer(Res41057, [2, 1, 1, 1], Res42275), 
LGlo94821 = global_average_pooling3D_layer(Res42275, Glo94821), 
exec_layers([LGRU90127,LRes60496,LRes41057,LRes42275,LGlo94821],["GRU90127","Res60496","Res41057","Res42275","Glo94821"],Glo94821,"Glo94821")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0.0]]

Actual:   [[0]]

Expected: [[0]]