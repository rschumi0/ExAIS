import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave58402 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave58402 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Dot64520 = tf.keras.layers.Input(shape=([2]))
in1Dot64520 = tf.keras.layers.Input(shape=([2]))
in0Con83302 = tf.keras.layers.Input(shape=([1]))
in0Con84727 = tf.keras.layers.Input(shape=([2, 1]))
in0Con35068 = tf.keras.layers.Input(shape=([1, 1]))

Ave58402 = keras.layers.Average(name = 'Ave58402', )([in0Ave58402,in1Ave58402])
Res14365 = keras.layers.Reshape((1, 1, 2), name = 'Res14365', )(Ave58402)
Res27907 = keras.layers.Reshape((1, 2), name = 'Res27907', )(Res14365)
Fla35801 = keras.layers.Flatten(name = 'Fla35801', )(Res27907)
Dot64520 = keras.layers.Dot(axes=(1, 1), name = 'Dot64520', )([in0Dot64520,in1Dot64520])
Con83302 = keras.layers.Concatenate(axis=1, name = 'Con83302', )([Dot64520,in0Con83302])
Sub25291 = keras.layers.Subtract(name = 'Sub25291', )([Fla35801,Con83302])
Res2714 = keras.layers.Reshape((2, 1), name = 'Res2714', )(Sub25291)
Con84727 = keras.layers.Concatenate(axis=2, name = 'Con84727', )([Res2714,in0Con84727])
Con35068 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con35068', )(in0Con35068)
Dot69930 = keras.layers.Dot(axes=(2, 2), name = 'Dot69930', )([Con84727,Con35068])
model = tf.keras.models.Model(inputs=[in0Ave58402,in1Ave58402,in0Dot64520,in1Dot64520,in0Con83302,in0Con84727,in0Con35068], outputs=Dot69930)
w = model.get_layer('Con35068').get_weights() 
w[0] = np.array([[[0.2306, 0.0113]]])
w[1] = np.array([0, 0])
model.get_layer('Con35068').set_weights(w) 
in0Ave58402 = tf.constant([[[[[0.472], [0.1464]]]]])
in1Ave58402 = tf.constant([[[[[0.5537], [0.4169]]]]])
in0Dot64520 = tf.constant([[0.4179, 0.5101]])
in1Dot64520 = tf.constant([[0.4835, 0.8818]])
in0Con83302 = tf.constant([[0.1045]])
in0Con84727 = tf.constant([[[0.8442], [0.4957]]])
in0Con35068 = tf.constant([[[0.9759]]])
print (np.array2string(model.predict([in0Ave58402,in1Ave58402,in0Dot64520,in1Dot64520,in0Con83302,in0Con84727,in0Con35068],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot69930.png')

LAve58402 = average_layer([[[[[[0.472], [0.1464]]]]], [[[[[0.5537], [0.4169]]]]]], Ave58402), 
LRes14365 = reshape_layer(Ave58402, [1, 1, 2], Res14365), 
LRes27907 = reshape_layer(Res14365, [1, 2], Res27907), 
LFla35801 = flatten_layer(Res27907, Fla35801), 
LDot64520 = dot_layer([[0.4179, 0.5101]], [[0.4835, 0.8818]], 1, 1, Dot64520), 
LCon83302 = concatenate_layer([Dot64520,[[0.1045]]], 1, Con83302), 
LSub25291 = subtract_layer(Fla35801,Con83302, Sub25291), 
LRes2714 = reshape_layer(Sub25291, [2, 1], Res2714), 
LCon84727 = concatenate_layer([Res2714,[[[0.8442], [0.4957]]]], 2, Con84727), 
LCon35068 = conv1D_layer([[[0.9759]]], 1,[[[0.2306, 0.0113]]],[0, 0], 1, false, 1, Con35068), 
LDot69930 = dot_layer(Con84727,Con35068, 2, 2, Dot69930), 
exec_layers([LAve58402,LRes14365,LRes27907,LFla35801,LDot64520,LCon83302,LSub25291,LRes2714,LCon84727,LCon35068,LDot69930],["Ave58402","Res14365","Res27907","Fla35801","Dot64520","Con83302","Sub25291","Res2714","Con84727","Con35068","Dot69930"],Dot69930,"Dot69930")

Actual (Unparsed): [[[-0.0219738], [0.0453327]]]

Expected (Unparsed): [[[-0.021973791256708182],[0.04533270198]]]

Actual:   [[[-0.0219], [0.0454]]]

Expected: [[[-0.0219], [0.0454]]]