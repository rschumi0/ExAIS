import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo50362 = tf.keras.layers.Input(shape=([1, 2]))
in0Con29269 = tf.keras.layers.Input(shape=([7]))
in0Dot87124 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot87124 = tf.keras.layers.Input(shape=([3, 3]))
in0Con61085 = tf.keras.layers.Input(shape=([9, 1]))
in0Min83527 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min83527 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con37364 = tf.keras.layers.Input(shape=([2, 1]))
in0Con22085 = tf.keras.layers.Input(shape=([1, 2]))

Glo50362 = keras.layers.GlobalMaxPool1D(name = 'Glo50362', )(in0Glo50362)
Con29269 = keras.layers.Concatenate(axis=1, name = 'Con29269', )([Glo50362,in0Con29269])
Dot87124 = keras.layers.Dot(axes=(1, 1), name = 'Dot87124', )([in0Dot87124,in1Dot87124])
Fla23288 = keras.layers.Flatten(name = 'Fla23288', )(Dot87124)
Ave24196 = keras.layers.Average(name = 'Ave24196', )([Con29269,Fla23288])
Res97897 = keras.layers.Reshape((9, 1), name = 'Res97897', )(Ave24196)
Con61085 = keras.layers.Concatenate(axis=2, name = 'Con61085', )([Res97897,in0Con61085])
Min83527 = keras.layers.Minimum(name = 'Min83527', )([in0Min83527,in1Min83527])
Res34008 = keras.layers.Reshape((2, 1), name = 'Res34008', )(Min83527)
Con37364 = keras.layers.Concatenate(axis=2, name = 'Con37364', )([Res34008,in0Con37364])
Con22085 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con22085', )(in0Con22085)
Zer91132 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer91132', )(Con22085)
Add95535 = keras.layers.Add(name = 'Add95535', )([Con37364,Zer91132])
Zer51019 = keras.layers.ZeroPadding1D(padding=((7, 0)), name = 'Zer51019', )(Add95535)
Mul79569 = keras.layers.Multiply(name = 'Mul79569', )([Con61085,Zer51019])
model = tf.keras.models.Model(inputs=[in0Glo50362,in0Con29269,in0Dot87124,in1Dot87124,in0Con61085,in0Min83527,in1Min83527,in0Con37364,in0Con22085], outputs=Mul79569)
w = model.get_layer('Con22085').get_weights() 
w[0] = np.array([[[0.9152, 0.4719], [0.8147, 0.3003]]])
w[1] = np.array([0, 0])
model.get_layer('Con22085').set_weights(w) 
in0Glo50362 = tf.constant([[[1.5879, 1.8599]]])
in0Con29269 = tf.constant([[0.1899, 0.1767, 0.8658, 0.0413, 0.0262, 0.2092, 0.3147]])
in0Dot87124 = tf.constant([[[0.2057, 0.8154, 0.4559], [0.4175, 0.7774, 0.8416], [0.1297, 0.9746, 0.3865]]])
in1Dot87124 = tf.constant([[[0.6768, 0.9659, 0.3251], [0.5387, 0.9166, 0.3931], [0.9311, 0.4312, 0.8497]]])
in0Con61085 = tf.constant([[[0.0871], [0.9002], [0.3958], [0.8138], [0.1808], [0.2507], [0.7094], [0.6644], [0.1287]]])
in0Min83527 = tf.constant([[[[0.7597]], [[0.9264]]]])
in1Min83527 = tf.constant([[[[0.9899]], [[0.9884]]]])
in0Con37364 = tf.constant([[[0.4865], [0.5642]]])
in0Con22085 = tf.constant([[[0.1361, 0.7185]]])
print (np.array2string(model.predict([in0Glo50362,in0Con29269,in0Dot87124,in1Dot87124,in0Con61085,in0Min83527,in1Min83527,in0Con37364,in0Con22085],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul79569.png')

LGlo50362 = global_max_pool1D_layer([[[1.5879, 1.8599]]], Glo50362), 
LCon29269 = concatenate_layer([Glo50362,[[0.1899, 0.1767, 0.8658, 0.0413, 0.0262, 0.2092, 0.3147]]], 1, Con29269), 
LDot87124 = dot_layer([[[0.2057, 0.8154, 0.4559], [0.4175, 0.7774, 0.8416], [0.1297, 0.9746, 0.3865]]], [[[0.6768, 0.9659, 0.3251], [0.5387, 0.9166, 0.3931], [0.9311, 0.4312, 0.8497]]], 1, 1, Dot87124), 
LFla23288 = flatten_layer(Dot87124, Fla23288), 
LAve24196 = average_layer([Con29269,Fla23288], Ave24196), 
LRes97897 = reshape_layer(Ave24196, [9, 1], Res97897), 
LCon61085 = concatenate_layer([Res97897,[[[0.0871], [0.9002], [0.3958], [0.8138], [0.1808], [0.2507], [0.7094], [0.6644], [0.1287]]]], 2, Con61085), 
LMin83527 = minimum_layer([[[[[0.7597]], [[0.9264]]]], [[[[0.9899]], [[0.9884]]]]], Min83527), 
LRes34008 = reshape_layer(Min83527, [2, 1], Res34008), 
LCon37364 = concatenate_layer([Res34008,[[[0.4865], [0.5642]]]], 2, Con37364), 
LCon22085 = conv1D_layer([[[0.1361, 0.7185]]], 1,[[[0.9152, 0.4719], [0.8147, 0.3003]]],[0, 0], 1, true, 1, Con22085), 
LZer91132 = zero_padding1D_layer(Con22085, 1, 0, Zer91132), 
LAdd95535 = add_layer([Con37364,Zer91132], Add95535), 
LZer51019 = zero_padding1D_layer(Add95535, 7, 0, Zer51019), 
LMul79569 = multiply_layer([Con61085,Zer51019], Mul79569), 
exec_layers([LGlo50362,LCon29269,LDot87124,LFla23288,LAve24196,LRes97897,LCon61085,LMin83527,LRes34008,LCon37364,LCon22085,LZer91132,LAdd95535,LZer51019,LMul79569],["Glo50362","Con29269","Dot87124","Fla23288","Ave24196","Res97897","Con61085","Min83527","Res34008","Con37364","Con22085","Zer91132","Add95535","Zer51019","Mul79569"],Mul79569,"Mul79569")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.6030587, 0.3232306], [0.9181028, 0.1086474]]]

Expected (Unparsed): [[[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.6030586611245,0.3232306],[0.9181027925379586,0.10864739971800001]]]

Actual:   [[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0.6031, 0.3233], [0.9182, 0.1087]]]

Expected: [[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0.6031, 0.3233], [0.9182, 0.1087]]]