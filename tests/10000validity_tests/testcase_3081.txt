import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas99600 = tf.keras.layers.Input(shape=([2]))
in0Con49827 = tf.keras.layers.Input(shape=([2, 1]))
in0Max41655 = tf.keras.layers.Input(shape=([1, 1]))
in1Max41655 = tf.keras.layers.Input(shape=([1, 1]))
in0Glo81238 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con57560 = tf.keras.layers.Input(shape=([2, 1]))
in0Max29819 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con28676 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Max94315 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max94315 = tf.keras.layers.Input(shape=([2, 1, 2]))

Mas99600 = keras.layers.Masking(mask_value=1, name = 'Mas99600', )(in0Mas99600)
Thr88651 = keras.layers.ThresholdedReLU(theta=5.921281526359394, name = 'Thr88651', )(Mas99600)
Res44747 = keras.layers.Reshape((2, 1), name = 'Res44747', )(Thr88651)
Con49827 = keras.layers.Concatenate(axis=2, name = 'Con49827', )([Res44747,in0Con49827])
Max41655 = keras.layers.Maximum(name = 'Max41655', )([in0Max41655,in1Max41655])
Fla94567 = keras.layers.Flatten(name = 'Fla94567', )(Max41655)
Glo81238 = keras.layers.GlobalAveragePooling3D(name = 'Glo81238', )(in0Glo81238)
Add90331 = keras.layers.Add(name = 'Add90331', )([Fla94567,Glo81238])
Res17452 = keras.layers.Reshape((1, 1), name = 'Res17452', )(Add90331)
Zer64055 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer64055', )(Res17452)
Con57560 = keras.layers.Concatenate(axis=2, name = 'Con57560', )([Zer64055,in0Con57560])
Max29819 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max29819', )(in0Max29819)
Res29070 = keras.layers.Reshape((1, 2), name = 'Res29070', )(Max29819)
Dot45408 = keras.layers.Dot(axes=(1, 2), name = 'Dot45408', )([Con57560,Res29070])
Res14408 = keras.layers.Reshape((2, 1, 1), name = 'Res14408', )(Dot45408)
Con28676 = keras.layers.Concatenate(axis=3, name = 'Con28676', )([Res14408,in0Con28676])
Max94315 = keras.layers.Maximum(name = 'Max94315', )([in0Max94315,in1Max94315])
Mul2054 = keras.layers.Multiply(name = 'Mul2054', )([Con28676,Max94315])
Res34153 = keras.layers.Reshape((2, 2), name = 'Res34153', )(Mul2054)
Dot19135 = keras.layers.Dot(axes=(2, 2), name = 'Dot19135', )([Con49827,Res34153])
model = tf.keras.models.Model(inputs=[in0Mas99600,in0Con49827,in0Max41655,in1Max41655,in0Glo81238,in0Con57560,in0Max29819,in0Con28676,in0Max94315,in1Max94315], outputs=Dot19135)
in0Mas99600 = tf.constant([[1.5144, 1.5801]])
in0Con49827 = tf.constant([[[0.5884], [0.2079]]])
in0Max41655 = tf.constant([[[0.2382]]])
in1Max41655 = tf.constant([[[0.5155]]])
in0Glo81238 = tf.constant([[[[[1.5343]], [[1.6371]]], [[[1.3892]], [[1.3438]]]]])
in0Con57560 = tf.constant([[[0.1508], [0.5118]]])
in0Max29819 = tf.constant([[[[1.0676, 1.7019]]]])
in0Con28676 = tf.constant([[[[0.9749]], [[0.7317]]]])
in0Max94315 = tf.constant([[[[0.5736, 0.2682]], [[0.7524, 0.3395]]]])
in1Max94315 = tf.constant([[[[0.9251, 0.3008]], [[0.9263, 0.5792]]]])
print (np.array2string(model.predict([in0Mas99600,in0Con49827,in0Max41655,in1Max41655,in0Glo81238,in0Con57560,in0Max29819,in0Con28676,in0Max94315,in1Max94315],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot19135.png')

LMas99600 = masking_layer([[1.5144, 1.5801]], 1, Mas99600), 
LThr88651 = thresholded_relu_layer(Mas99600, 5.921281526359394, Thr88651), 
LRes44747 = reshape_layer(Thr88651, [2, 1], Res44747), 
LCon49827 = concatenate_layer([Res44747,[[[0.5884], [0.2079]]]], 2, Con49827), 
LMax41655 = maximum_layer([[[[0.2382]]], [[[0.5155]]]], Max41655), 
LFla94567 = flatten_layer(Max41655, Fla94567), 
LGlo81238 = global_average_pooling3D_layer([[[[[1.5343]], [[1.6371]]], [[[1.3892]], [[1.3438]]]]], Glo81238), 
LAdd90331 = add_layer([Fla94567,Glo81238], Add90331), 
LRes17452 = reshape_layer(Add90331, [1, 1], Res17452), 
LZer64055 = zero_padding1D_layer(Res17452, 1, 0, Zer64055), 
LCon57560 = concatenate_layer([Zer64055,[[[0.1508], [0.5118]]]], 2, Con57560), 
LMax29819 = max_pool2D_layer([[[[1.0676, 1.7019]]]], 1, 1, Max29819), 
LRes29070 = reshape_layer(Max29819, [1, 2], Res29070), 
LDot45408 = dot_layer(Con57560,Res29070, 1, 2, Dot45408), 
LRes14408 = reshape_layer(Dot45408, [2, 1, 1], Res14408), 
LCon28676 = concatenate_layer([Res14408,[[[[0.9749]], [[0.7317]]]]], 3, Con28676), 
LMax94315 = maximum_layer([[[[[0.5736, 0.2682]], [[0.7524, 0.3395]]]], [[[[0.9251, 0.3008]], [[0.9263, 0.5792]]]]], Max94315), 
LMul2054 = multiply_layer([Con28676,Max94315], Mul2054), 
LRes34153 = reshape_layer(Mul2054, [2, 2], Res34153), 
LDot19135 = dot_layer(Con49827,Res34153, 2, 2, Dot19135), 
exec_layers([LMas99600,LThr88651,LRes44747,LCon49827,LMax41655,LFla94567,LGlo81238,LAdd90331,LRes17452,LZer64055,LCon57560,LMax29819,LRes29070,LDot45408,LRes14408,LCon28676,LMax94315,LMul2054,LRes34153,LDot19135],["Mas99600","Thr88651","Res44747","Con49827","Max41655","Fla94567","Glo81238","Add90331","Res17452","Zer64055","Con57560","Max29819","Res29070","Dot45408","Res14408","Con28676","Max94315","Mul2054","Res34153","Dot19135"],Dot19135,"Dot19135")

Actual (Unparsed): [[[0.1725483, 0.2493643], [0.0609667, 0.0881082]]]

Expected (Unparsed): [[[0.172548252928,0.24936429657600004],[0.060966658368,0.08810815305600002]]]

Actual:   [[[0.1726, 0.2494], [0.061, 0.0882]]]

Expected: [[[0.1726, 0.2494], [0.061, 0.0882]]]