import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot8141 = tf.keras.layers.Input(shape=([2]))
in1Dot8141 = tf.keras.layers.Input(shape=([2]))

Dot8141 = keras.layers.Dot(axes=(1, 1), name = 'Dot8141', )([in0Dot8141,in1Dot8141])
Res74102 = keras.layers.Reshape((1, 1), name = 'Res74102', )(Dot8141)
Res14388 = keras.layers.Reshape((1, 1, 1), name = 'Res14388', )(Res74102)
Sep19820 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep19820', )(Res14388)
Res20942 = keras.layers.Reshape((1, 2), name = 'Res20942', )(Sep19820)
Glo48976 = keras.layers.GlobalAveragePooling1D(name = 'Glo48976', )(Res20942)
Res11899 = keras.layers.Reshape((2, 1), name = 'Res11899', )(Glo48976)
Res38331 = keras.layers.Reshape((2, 1, 1), name = 'Res38331', )(Res11899)
Dep17156 = keras.layers.DepthwiseConv2D((2, 1),strides=(2, 2), padding='valid', name = 'Dep17156', )(Res38331)
Res52932 = keras.layers.Reshape((1, 1), name = 'Res52932', )(Dep17156)
LST86699 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST86699', )(Res52932)
model = tf.keras.models.Model(inputs=[in0Dot8141,in1Dot8141], outputs=LST86699)
w = model.get_layer('Sep19820').get_weights() 
w[0] = np.array([[[[0.2332]]]])
w[1] = np.array([[[[0.7798, 0.944]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep19820').set_weights(w) 
w = model.get_layer('Dep17156').get_weights() 
w[0] = np.array([[[[0.2147]]], [[[0.2385]]]])
w[1] = np.array([0])
model.get_layer('Dep17156').set_weights(w) 
w = model.get_layer('LST86699').get_weights() 
w[0] = np.array([[4, 8, 10, 4, 6, 7, 10, 8, 8, 7, 8, 9]])
w[1] = np.array([[10, 5, 4, 6, 1, 5, 2, 2, 1, 1, 8, 9], [1, 6, 10, 4, 5, 4, 5, 10, 7, 7, 7, 9], [3, 6, 2, 9, 9, 1, 4, 9, 10, 3, 10, 6]])
w[2] = np.array([2, 7, 7, 3, 6, 4, 9, 6, 2, 4, 10, 1])
model.get_layer('LST86699').set_weights(w) 
in0Dot8141 = tf.constant([[0.8863, 0.0698]])
in1Dot8141 = tf.constant([[0.9959, 0.8873]])
print (np.array2string(model.predict([in0Dot8141,in1Dot8141],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST86699.png')

LDot8141 = dot_layer([[0.8863, 0.0698]], [[0.9959, 0.8873]], 1, 1, Dot8141), 
LRes74102 = reshape_layer(Dot8141, [1, 1], Res74102), 
LRes14388 = reshape_layer(Res74102, [1, 1, 1], Res14388), 
LSep19820 = separable_conv2D_layer(Res14388, 1, 1,[[[[[0.2332]]]],[[[[0.7798, 0.944]]]]],[0, 0], 1, 1, false, Sep19820), 
LRes20942 = reshape_layer(Sep19820, [1, 2], Res20942), 
LGlo48976 = global_average_pooling1D_layer(Res20942, Glo48976), 
LRes11899 = reshape_layer(Glo48976, [2, 1], Res11899), 
LRes38331 = reshape_layer(Res11899, [2, 1, 1], Res38331), 
LDep17156 = depthwise_conv2D_layer(Res38331, 2, 1,[[[[0.2147]]], [[[0.2385]]]],[0], 2, 2, false, Dep17156), 
LRes52932 = reshape_layer(Dep17156, [1, 1], Res52932), 
LLST86699 = lstm_layer(Res52932,[[4, 8, 10, 4, 6, 7, 10, 8, 8, 7, 8, 9]],[[10, 5, 4, 6, 1, 5, 2, 2, 1, 1, 8, 9], [1, 6, 10, 4, 5, 4, 5, 10, 7, 7, 7, 9], [3, 6, 2, 9, 9, 1, 4, 9, 10, 3, 10, 6]],[2, 7, 7, 3, 6, 4, 9, 6, 2, 4, 10, 1], LST86699), 
exec_layers([LDot8141,LRes74102,LRes14388,LSep19820,LRes20942,LGlo48976,LRes11899,LRes38331,LDep17156,LRes52932,LLST86699],["Dot8141","Res74102","Res14388","Sep19820","Res20942","Glo48976","Res11899","Res38331","Dep17156","Res52932","LST86699"],LST86699,"LST86699")

Actual (Unparsed): [[0.7152303, 0.7613838, 0.6480858]]

Expected (Unparsed): [[0.7152303429979914,0.7613838343822404,0.6480857683739002]]

Actual:   [[0.7153, 0.7614, 0.6481]]

Expected: [[0.7153, 0.7614, 0.6481]]