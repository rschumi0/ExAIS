import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot30597 = tf.keras.layers.Input(shape=([3]))
in1Dot30597 = tf.keras.layers.Input(shape=([3]))

Dot30597 = keras.layers.Dot(axes=(1, 1), name = 'Dot30597', )([in0Dot30597,in1Dot30597])
Res21493 = keras.layers.Reshape((1, 1), name = 'Res21493', )(Dot30597)
Loc798 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc798', )(Res21493)
Res696 = keras.layers.Reshape((1, 2, 1), name = 'Res696', )(Loc798)
Glo83368 = keras.layers.GlobalAveragePooling2D(name = 'Glo83368', )(Res696)
Res54525 = keras.layers.Reshape((1, 1), name = 'Res54525', )(Glo83368)
Glo25561 = keras.layers.GlobalAveragePooling1D(name = 'Glo25561', )(Res54525)
model = tf.keras.models.Model(inputs=[in0Dot30597,in1Dot30597], outputs=Glo25561)
w = model.get_layer('Loc798').get_weights() 
w[0] = np.array([[[0.0121, 0.1743]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc798').set_weights(w) 
in0Dot30597 = tf.constant([[0.6361, 0.3135, 0.3689]])
in1Dot30597 = tf.constant([[0.1437, 0.1159, 0.4369]])
print (np.array2string(model.predict([in0Dot30597,in1Dot30597],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo25561.png')

LDot30597 = dot_layer([[0.6361, 0.3135, 0.3689]], [[0.1437, 0.1159, 0.4369]], 1, 1, Dot30597), 
LRes21493 = reshape_layer(Dot30597, [1, 1], Res21493), 
LLoc798 = locally_connected1D_layer(Res21493, 1,[[[0.0121, 0.1743]]],[[0, 0]], 1, Loc798), 
LRes696 = reshape_layer(Loc798, [1, 2, 1], Res696), 
LGlo83368 = global_average_pooling2D_layer(Res696, Glo83368), 
LRes54525 = reshape_layer(Glo83368, [1, 1], Res54525), 
LGlo25561 = global_average_pooling1D_layer(Res54525, Glo25561), 
exec_layers([LDot30597,LRes21493,LLoc798,LRes696,LGlo83368,LRes54525,LGlo25561],["Dot30597","Res21493","Loc798","Res696","Glo83368","Res54525","Glo25561"],Glo25561,"Glo25561")

Actual (Unparsed): [[0.0269268]]

Expected (Unparsed): [[0.026926843516000002]]

Actual:   [[0.027]]

Expected: [[0.027]]