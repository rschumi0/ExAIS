import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot47173 = tf.keras.layers.Input(shape=([2]))
in1Dot47173 = tf.keras.layers.Input(shape=([2]))
in0Con83707 = tf.keras.layers.Input(shape=([1, 2]))
in0Con7390 = tf.keras.layers.Input(shape=([1, 1]))

Dot47173 = keras.layers.Dot(axes=(1, 1), name = 'Dot47173', )([in0Dot47173,in1Dot47173])
Thr56293 = keras.layers.ThresholdedReLU(theta=8.832511174775334, name = 'Thr56293', )(Dot47173)
Res50220 = keras.layers.Reshape((1, 1), name = 'Res50220', )(Thr56293)
Con83707 = keras.layers.Concatenate(axis=2, name = 'Con83707', )([Res50220,in0Con83707])
Con7390 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con7390', )(in0Con7390)
Sub84488 = keras.layers.Subtract(name = 'Sub84488', )([Con83707,Con7390])
LST53450 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST53450', )(Sub84488)
model = tf.keras.models.Model(inputs=[in0Dot47173,in1Dot47173,in0Con83707,in0Con7390], outputs=LST53450)
w = model.get_layer('Con7390').get_weights() 
w[0] = np.array([[[0.9305, 0.3576, 0.6476]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con7390').set_weights(w) 
w = model.get_layer('LST53450').get_weights() 
w[0] = np.array([[5, 4, 9, 5, 8, 10, 1, 3], [5, 8, 3, 7, 5, 8, 6, 4], [3, 8, 4, 2, 4, 6, 4, 4]])
w[1] = np.array([[4, 3, 5, 3, 10, 4, 2, 2], [8, 9, 3, 1, 6, 7, 8, 10]])
w[2] = np.array([10, 1, 7, 4, 2, 9, 2, 4])
model.get_layer('LST53450').set_weights(w) 
in0Dot47173 = tf.constant([[0.8615, 0.17]])
in1Dot47173 = tf.constant([[0.0248, 0.0539]])
in0Con83707 = tf.constant([[[0.6489, 0.1289]]])
in0Con7390 = tf.constant([[[0.5093]]])
print (np.array2string(model.predict([in0Dot47173,in1Dot47173,in0Con83707,in0Con7390],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST53450.png')

LDot47173 = dot_layer([[0.8615, 0.17]], [[0.0248, 0.0539]], 1, 1, Dot47173), 
LThr56293 = thresholded_relu_layer(Dot47173, 8.832511174775334, Thr56293), 
LRes50220 = reshape_layer(Thr56293, [1, 1], Res50220), 
LCon83707 = concatenate_layer([Res50220,[[[0.6489, 0.1289]]]], 2, Con83707), 
LCon7390 = conv1D_layer([[[0.5093]]], 1,[[[0.9305, 0.3576, 0.6476]]],[0, 0, 0], 1, true, 1, Con7390), 
LSub84488 = subtract_layer(Con83707,Con7390, Sub84488), 
LLST53450 = lstm_layer(Sub84488,[[5, 4, 9, 5, 8, 10, 1, 3], [5, 8, 3, 7, 5, 8, 6, 4], [3, 8, 4, 2, 4, 6, 4, 4]],[[4, 3, 5, 3, 10, 4, 2, 2], [8, 9, 3, 1, 6, 7, 8, 10]],[10, 1, 7, 4, 2, 9, 2, 4], LST53450), 
exec_layers([LDot47173,LThr56293,LRes50220,LCon83707,LCon7390,LSub84488,LLST53450],["Dot47173","Thr56293","Res50220","Con83707","Con7390","Sub84488","LST53450"],LST53450,"LST53450")

Actual (Unparsed): [[-0.2426894, 0.6326833]]

Expected (Unparsed): [[-0.2426893926897602,0.6326833050593986]]

Actual:   [[-0.2426, 0.6327]]

Expected: [[-0.2426, 0.6327]]