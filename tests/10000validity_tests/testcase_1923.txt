import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul5546 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Mul5546 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Sub44178 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub44178 = tf.keras.layers.Input(shape=([2, 2]))
in0Con67295 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot7172 = tf.keras.layers.Input(shape=([3]))
in1Dot7172 = tf.keras.layers.Input(shape=([3]))
in0Con57250 = tf.keras.layers.Input(shape=([5]))
in0Mul37903 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul37903 = tf.keras.layers.Input(shape=([1, 2]))
in0Con52626 = tf.keras.layers.Input(shape=([4]))

Mul5546 = keras.layers.Multiply(name = 'Mul5546', )([in0Mul5546,in1Mul5546])
Res6293 = keras.layers.Reshape((1, 1, 1), name = 'Res6293', )(Mul5546)
Loc64449 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc64449', )(Res6293)
Res23901 = keras.layers.Reshape((1, 3), name = 'Res23901', )(Loc64449)
Zer12061 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer12061', )(Res23901)
Sub44178 = keras.layers.Subtract(name = 'Sub44178', )([in0Sub44178,in1Sub44178])
Con67295 = keras.layers.Concatenate(axis=2, name = 'Con67295', )([Sub44178,in0Con67295])
Sub51371 = keras.layers.Subtract(name = 'Sub51371', )([Zer12061,Con67295])
Fla39933 = keras.layers.Flatten(name = 'Fla39933', )(Sub51371)
Dot7172 = keras.layers.Dot(axes=(1, 1), name = 'Dot7172', )([in0Dot7172,in1Dot7172])
Con57250 = keras.layers.Concatenate(axis=1, name = 'Con57250', )([Dot7172,in0Con57250])
Min41273 = keras.layers.Minimum(name = 'Min41273', )([Fla39933,Con57250])
Mul37903 = keras.layers.Multiply(name = 'Mul37903', )([in0Mul37903,in1Mul37903])
Glo6952 = keras.layers.GlobalMaxPool1D(name = 'Glo6952', )(Mul37903)
Con52626 = keras.layers.Concatenate(axis=1, name = 'Con52626', )([Glo6952,in0Con52626])
Sub76796 = keras.layers.Subtract(name = 'Sub76796', )([Min41273,Con52626])
model = tf.keras.models.Model(inputs=[in0Mul5546,in1Mul5546,in0Sub44178,in1Sub44178,in0Con67295,in0Dot7172,in1Dot7172,in0Con57250,in0Mul37903,in1Mul37903,in0Con52626], outputs=Sub76796)
w = model.get_layer('Loc64449').get_weights() 
w[0] = np.array([[[0.0405, 0.8462, 0.8571]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc64449').set_weights(w) 
in0Mul5546 = tf.constant([[[[[0.7023]]]]])
in1Mul5546 = tf.constant([[[[[0.2444]]]]])
in0Sub44178 = tf.constant([[[0.186, 0.4712], [0.7009, 0.107]]])
in1Sub44178 = tf.constant([[[0.7659, 0.581], [0.8743, 0.6211]]])
in0Con67295 = tf.constant([[[0.9321], [0.6883]]])
in0Dot7172 = tf.constant([[0.5757, 0.9428, 0.1878]])
in1Dot7172 = tf.constant([[0.655, 0.7254, 0.2141]])
in0Con57250 = tf.constant([[0.5367, 0.431, 0.9813, 0.5582, 0.8476]])
in0Mul37903 = tf.constant([[[0.258, 0.5988]]])
in1Mul37903 = tf.constant([[[0.8053, 0.9903]]])
in0Con52626 = tf.constant([[0.6541, 0.3698, 0.4812, 0.2321]])
print (np.array2string(model.predict([in0Mul5546,in1Mul5546,in0Sub44178,in1Sub44178,in0Con67295,in0Dot7172,in1Dot7172,in0Con57250,in0Mul37903,in1Mul37903,in0Con52626],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub76796.png')

LMul5546 = multiply_layer([[[[[[0.7023]]]]], [[[[[0.2444]]]]]], Mul5546), 
LRes6293 = reshape_layer(Mul5546, [1, 1, 1], Res6293), 
LLoc64449 = locally_connected2D_layer(Res6293, 1, 1,[[[0.0405, 0.8462, 0.8571]]],[[[0, 0, 0]]], 1, 1, Loc64449), 
LRes23901 = reshape_layer(Loc64449, [1, 3], Res23901), 
LZer12061 = zero_padding1D_layer(Res23901, 1, 0, Zer12061), 
LSub44178 = subtract_layer([[[0.186, 0.4712], [0.7009, 0.107]]], [[[0.7659, 0.581], [0.8743, 0.6211]]], Sub44178), 
LCon67295 = concatenate_layer([Sub44178,[[[0.9321], [0.6883]]]], 2, Con67295), 
LSub51371 = subtract_layer(Zer12061,Con67295, Sub51371), 
LFla39933 = flatten_layer(Sub51371, Fla39933), 
LDot7172 = dot_layer([[0.5757, 0.9428, 0.1878]], [[0.655, 0.7254, 0.2141]], 1, 1, Dot7172), 
LCon57250 = concatenate_layer([Dot7172,[[0.5367, 0.431, 0.9813, 0.5582, 0.8476]]], 1, Con57250), 
LMin41273 = minimum_layer([Fla39933,Con57250], Min41273), 
LMul37903 = multiply_layer([[[[0.258, 0.5988]]], [[[0.8053, 0.9903]]]], Mul37903), 
LGlo6952 = global_max_pool1D_layer(Mul37903, Glo6952), 
LCon52626 = concatenate_layer([Glo6952,[[0.6541, 0.3698, 0.4812, 0.2321]]], 1, Con52626), 
LSub76796 = subtract_layer(Min41273,Con52626, Sub76796), 
exec_layers([LMul5546,LRes6293,LLoc64449,LRes23901,LZer12061,LSub44178,LCon67295,LSub51371,LFla39933,LDot7172,LCon57250,LMin41273,LMul37903,LGlo6952,LCon52626,LSub76796],["Mul5546","Res6293","Loc64449","Res23901","Zer12061","Sub44178","Con67295","Sub51371","Fla39933","Dot7172","Con57250","Min41273","Mul37903","Glo6952","Con52626","Sub76796"],Sub76796,"Sub76796")

Actual (Unparsed): [[0.3721326, -0.4831917, -1.5862000, -0.1894485, 0.0770000, -0.7732855]]

Expected (Unparsed): [[0.37213260000000004,-0.48319164,-1.5862,-0.18944849414,0.07700000000000001,-0.773285538948]]

Actual:   [[0.3722, -0.4831, -1.5862, -0.1894, 0.077, -0.7732]]

Expected: [[0.3722, -0.4831, -1.5862, -0.1894, 0.0771, -0.7732]]