import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add67285 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Add67285 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con2438 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave77812 = tf.keras.layers.Input(shape=([2, 2]))
in0Con37075 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Sep96105 = tf.keras.layers.Input(shape=([2, 2, 2]))

Add67285 = keras.layers.Add(name = 'Add67285', )([in0Add67285,in1Add67285])
Fla11238 = keras.layers.Flatten(name = 'Fla11238', )(Add67285)
Res93619 = keras.layers.Reshape((2, 1), name = 'Res93619', )(Fla11238)
Con2438 = keras.layers.Concatenate(axis=2, name = 'Con2438', )([Res93619,in0Con2438])
Ave77812 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='same', name = 'Ave77812', )(in0Ave77812)
Min85009 = keras.layers.Minimum(name = 'Min85009', )([Con2438,Ave77812])
Res39694 = keras.layers.Reshape((2, 2, 1), name = 'Res39694', )(Min85009)
Res17604 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res17604', )(Res39694)
Up_91413 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_91413', )(Res17604)
Res34871 = keras.layers.Reshape((2, 2, 2), name = 'Res34871', )(Up_91413)
Con37075 = keras.layers.Concatenate(axis=3, name = 'Con37075', )([Res34871,in0Con37075])
Sep96105 = keras.layers.SeparableConv2D(3, (1, 1),strides=(2, 2), padding='valid', name = 'Sep96105', )(in0Sep96105)
Zer22483 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer22483', )(Sep96105)
Max3619 = keras.layers.Maximum(name = 'Max3619', )([Con37075,Zer22483])
model = tf.keras.models.Model(inputs=[in0Add67285,in1Add67285,in0Con2438,in0Ave77812,in0Con37075,in0Sep96105], outputs=Max3619)
w = model.get_layer('Sep96105').get_weights() 
w[0] = np.array([[[[0.4224], [0.7425]]]])
w[1] = np.array([[[[0.559, 0.0049, 0.0667], [0.4509, 0.8276, 0.6288]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep96105').set_weights(w) 
in0Add67285 = tf.constant([[[[[0.2635, 0.8296]]]]])
in1Add67285 = tf.constant([[[[[0.1995, 0.8765]]]]])
in0Con2438 = tf.constant([[[0.4652], [0.5208]]])
in0Ave77812 = tf.constant([[[1.1356, 1.5609], [1.9512, 1.2659]]])
in0Con37075 = tf.constant([[[[0.4864], [0.4835]], [[0.7222], [0.8721]]]])
in0Sep96105 = tf.constant([[[[0.1018, 0.0406], [0.3644, 0.5367]], [[0.9773, 0.3832], [0.6505, 0.0871]]]])
print (np.array2string(model.predict([in0Add67285,in1Add67285,in0Con2438,in0Ave77812,in0Con37075,in0Sep96105],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max3619.png')

LAdd67285 = add_layer([[[[[[0.2635, 0.8296]]]]], [[[[[0.1995, 0.8765]]]]]], Add67285), 
LFla11238 = flatten_layer(Add67285, Fla11238), 
LRes93619 = reshape_layer(Fla11238, [2, 1], Res93619), 
LCon2438 = concatenate_layer([Res93619,[[[0.4652], [0.5208]]]], 2, Con2438), 
LAve77812 = average_pooling1D_layer([[[1.1356, 1.5609], [1.9512, 1.2659]]], 1, 1, true, Ave77812), 
LMin85009 = minimum_layer([Con2438,Ave77812], Min85009), 
LRes39694 = reshape_layer(Min85009, [2, 2, 1], Res39694), 
LRes17604 = reshape_layer(Res39694, [2, 2, 1, 1], Res17604), 
LUp_91413 = up_sampling3D_layer(Res17604, 1, 1, 2, Up_91413), 
LRes34871 = reshape_layer(Up_91413, [2, 2, 2], Res34871), 
LCon37075 = concatenate_layer([Res34871,[[[[0.4864], [0.4835]], [[0.7222], [0.8721]]]]], 3, Con37075), 
LSep96105 = separable_conv2D_layer([[[[0.1018, 0.0406], [0.3644, 0.5367]], [[0.9773, 0.3832], [0.6505, 0.0871]]]], 1, 1,[[[[[0.4224], [0.7425]]]],[[[[0.559, 0.0049, 0.0667], [0.4509, 0.8276, 0.6288]]]]],[0, 0, 0], 2, 2, false, Sep96105), 
LZer22483 = zero_padding2D_layer(Sep96105, 1, 0, 1, 0, Zer22483), 
LMax3619 = maximum_layer([Con37075,Zer22483], Max3619), 
exec_layers([LAdd67285,LFla11238,LRes93619,LCon2438,LAve77812,LMin85009,LRes39694,LRes17604,LUp_91413,LRes34871,LCon37075,LSep96105,LZer22483,LMax3619],["Add67285","Fla11238","Res93619","Con2438","Ave77812","Min85009","Res39694","Res17604","Up_91413","Res34871","Con37075","Sep96105","Zer22483","Max3619"],Max3619,"Max3619")

Actual (Unparsed): [[[[0.4630000, 0.4630000, 0.4864000], [0.4652000, 0.4652000, 0.4835000]], [[1.7061000, 1.7061000, 0.7222000], [0.5208000, 0.5208000, 0.8721000]]]]

Expected (Unparsed): [[[[0.463,0.463,0.4864],[0.4652,0.4652,0.4835]],[[1.7061,1.7061,0.7222],[0.5208,0.5208,0.8721]]]]

Actual:   [[[[0.463, 0.463, 0.4864], [0.4652, 0.4652, 0.4835]], [[1.7061, 1.7061, 0.7222], [0.5208, 0.5208, 0.8721]]]]

Expected: [[[[0.463, 0.463, 0.4864], [0.4652, 0.4652, 0.4835]], [[1.7061, 1.7061, 0.7222], [0.5208, 0.5208, 0.8721]]]]