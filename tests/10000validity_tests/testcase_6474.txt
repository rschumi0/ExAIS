import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea98035 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Lea98035 = keras.layers.LeakyReLU(alpha=5.002806735278554, name = 'Lea98035', input_shape=(2, 2, 1, 1))(in0Lea98035)
Res85835 = keras.layers.Reshape((2, 2, 1), name = 'Res85835', )(Lea98035)
Dep16468 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='valid', name = 'Dep16468', )(Res85835)
Thr15959 = keras.layers.ThresholdedReLU(theta=1.8812927762702478, name = 'Thr15959', )(Dep16468)
Bat56042 = keras.layers.BatchNormalization(axis=2, epsilon=0.39633710688723955,  name = 'Bat56042', )(Thr15959)
model = tf.keras.models.Model(inputs=[in0Lea98035], outputs=Bat56042)
w = model.get_layer('Dep16468').get_weights() 
w[0] = np.array([[[[0.445]]], [[[0.8908]]]])
w[1] = np.array([0])
model.get_layer('Dep16468').set_weights(w) 
w = model.get_layer('Bat56042').get_weights() 
w[0] = np.array([0.4123, 0.7095])
w[1] = np.array([0.2525, 0.3612])
w[2] = np.array([0.1059, 0.39])
w[3] = np.array([0.0885, 0.2246])
model.get_layer('Bat56042').set_weights(w) 
in0Lea98035 = tf.constant([[[[[0.461]], [[0.0969]]], [[[0.437]], [[0.3467]]]]])
print (np.array2string(model.predict([in0Lea98035],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat56042.png')

LLea98035 = leaky_relu_layer([[[[[0.461]], [[0.0969]]], [[[0.437]], [[0.3467]]]]], 5.002806735278554, Lea98035), 
LRes85835 = reshape_layer(Lea98035, [2, 2, 1], Res85835), 
LDep16468 = depthwise_conv2D_layer(Res85835, 2, 1,[[[[0.445]]], [[[0.8908]]]],[0], 1, 1, false, Dep16468), 
LThr15959 = thresholded_relu_layer(Dep16468, 1.8812927762702478, Thr15959), 
LBat56042 = batch_normalization_layer(Thr15959, 2, 0.39633710688723955, [0.4123, 0.7095], [0.2525, 0.3612], [0.1059, 0.39], [0.0885, 0.2246], Bat56042), 
exec_layers([LLea98035,LRes85835,LDep16468,LThr15959,LBat56042],["Lea98035","Res85835","Dep16468","Thr15959","Bat56042"],Bat56042,"Bat56042")

Actual (Unparsed): [[[[0.1897937], [0.0100496]]]]

Expected (Unparsed): [[[[0.18979367206110848],[0.01004957377299609]]]]

Actual:   [[[[0.1898], [0.0101]]]]

Expected: [[[[0.1898], [0.0101]]]]