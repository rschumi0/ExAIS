import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min6114 = tf.keras.layers.Input(shape=([2, 1]))
in1Min6114 = tf.keras.layers.Input(shape=([2, 1]))

Min6114 = keras.layers.Minimum(name = 'Min6114', )([in0Min6114,in1Min6114])
GRU29786 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU29786', )(Min6114)
Res24910 = keras.layers.Reshape((1, 1), name = 'Res24910', )(GRU29786)
Cro76797 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro76797', )(Res24910)
model = tf.keras.models.Model(inputs=[in0Min6114,in1Min6114], outputs=Cro76797)
w = model.get_layer('GRU29786').get_weights() 
w[0] = np.array([[2, 10, 4]])
w[1] = np.array([[6, 1, 7]])
w[2] = np.array([8, 5, 9])
model.get_layer('GRU29786').set_weights(w) 
in0Min6114 = tf.constant([[[0.2338], [0.4865]]])
in1Min6114 = tf.constant([[[0.8318], [0.8752]]])
print (np.array2string(model.predict([in0Min6114,in1Min6114],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro76797.png')

LMin6114 = minimum_layer([[[[0.2338], [0.4865]]], [[[0.8318], [0.8752]]]], Min6114), 
LGRU29786 = gru_layer(Min6114,[[2, 10, 4]],[[6, 1, 7]],[8, 5, 9], false, GRU29786), 
LRes24910 = reshape_layer(GRU29786, [1, 1], Res24910), 
LCro76797 = cropping1D_layer(Res24910, 0, 0, Cro76797), 
exec_layers([LMin6114,LGRU29786,LRes24910,LCro76797],["Min6114","GRU29786","Res24910","Cro76797"],Cro76797,"Cro76797")

Actual (Unparsed): [[[0.0003367]]]

Expected (Unparsed): [[[0.0003367094174031565]]]

Actual:   [[[0.0004]]]

Expected: [[[0.0004]]]