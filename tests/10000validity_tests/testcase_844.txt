import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul15386 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul15386 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Lay94197 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Con31488 = tf.keras.layers.Input(shape=([2, 3, 1]))

Mul15386 = keras.layers.Multiply(name = 'Mul15386', )([in0Mul15386,in1Mul15386])
Zer79962 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer79962', )(Mul15386)
Lay94197 = keras.layers.LayerNormalization(axis=1, epsilon=2.0512252249591527, name = 'Lay94197', )(in0Lay94197)
Con31488 = keras.layers.Concatenate(axis=3, name = 'Con31488', )([Lay94197,in0Con31488])
Min84014 = keras.layers.Minimum(name = 'Min84014', )([Zer79962,Con31488])
PRe89731 = keras.layers.PReLU(name = 'PRe89731', )(Min84014)
model = tf.keras.models.Model(inputs=[in0Mul15386,in1Mul15386,in0Lay94197,in0Con31488], outputs=PRe89731)
w = model.get_layer('PRe89731').get_weights() 
w[0] = np.array([[[0.1083, 0.4853], [0.8917, 0.5534], [0.885, 0.6973]], [[0.619, 0.9754], [0.7436, 0.6454], [0.5233, 0.9247]]])
model.get_layer('PRe89731').set_weights(w) 
in0Mul15386 = tf.constant([[[[0.4374, 0.6452]], [[0.0971, 0.3606]]]])
in1Mul15386 = tf.constant([[[[0.5242, 0.2032]], [[0.3501, 0.2044]]]])
in0Lay94197 = tf.constant([[[[1.1598], [1.856], [1.2302]], [[1.1941], [1.7296], [1.8742]]]])
in0Con31488 = tf.constant([[[[0.3868], [0.205], [0.9847]], [[0.6525], [0.7637], [0.1573]]]])
print (np.array2string(model.predict([in0Mul15386,in1Mul15386,in0Lay94197,in0Con31488],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe89731.png')

LMul15386 = multiply_layer([[[[[0.4374, 0.6452]], [[0.0971, 0.3606]]]], [[[[0.5242, 0.2032]], [[0.3501, 0.2044]]]]], Mul15386), 
LZer79962 = zero_padding2D_layer(Mul15386, 0, 0, 2, 0, Zer79962), 
LLay94197 = layer_normalization_layer([[[[1.1598], [1.856], [1.2302]], [[1.1941], [1.7296], [1.8742]]]], 1, 2.0512252249591527, Lay94197), 
LCon31488 = concatenate_layer([Lay94197,[[[[0.3868], [0.205], [0.9847]], [[0.6525], [0.7637], [0.1573]]]]], 3, Con31488), 
LMin84014 = minimum_layer([Zer79962,Con31488], Min84014), 
LPRe89731 = prelu_layer(Min84014, [[[0.1083, 0.4853], [0.8917, 0.5534], [0.885, 0.6973]], [[0.619, 0.9754], [0.7436, 0.6454], [0.5233, 0.9247]]], PRe89731), 
exec_layers([LMul15386,LZer79962,LLay94197,LCon31488,LMin84014,LPRe89731],["Mul15386","Zer79962","Lay94197","Con31488","Min84014","PRe89731"],PRe89731,"PRe89731")

Actual (Unparsed): [[[[-0.0012967, 0.0000000], [0.0000000, 0.0000000], [-0.1941264, 0.1311046]], [[0.0000000, 0.0000000], [-0.0327814, 0.0000000], [0.0339947, 0.0737066]]]]

Expected (Unparsed): [[[[-0.0012967455683870301,0],[0,0],[-0.1941264229922271,0.13110464]],[[0,0],[-0.03278138943528238,0],[0.033994710000000004,0.07370663999999999]]]]

Actual:   [[[[-0.0012, 0], [0, 0], [-0.1941, 0.1312]], [[0, 0], [-0.0327, 0], [0.034, 0.0738]]]]

Expected: [[[[-0.0012, 0], [0, 0], [-0.1941, 0.1312]], [[0, 0], [-0.0327, 0], [0.034, 0.0738]]]]