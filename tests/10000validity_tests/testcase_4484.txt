import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave63468 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Dot66354 = tf.keras.layers.Input(shape=([2]))
in1Dot66354 = tf.keras.layers.Input(shape=([2]))
in0Dot67661 = tf.keras.layers.Input(shape=([2]))
in1Dot67661 = tf.keras.layers.Input(shape=([2]))
in0Con8503 = tf.keras.layers.Input(shape=([2]))

Ave63468 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave63468', )(in0Ave63468)
Res1098 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res1098', )(Ave63468)
Cro70414 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro70414', )(Res1098)
Res66273 = keras.layers.Reshape((1, 1, 1), name = 'Res66273', )(Cro70414)
Loc4572 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc4572', )(Res66273)
Res42483 = keras.layers.Reshape((1, 3), name = 'Res42483', )(Loc4572)
Fla54169 = keras.layers.Flatten(name = 'Fla54169', )(Res42483)
Dot66354 = keras.layers.Dot(axes=(1, 1), name = 'Dot66354', )([in0Dot66354,in1Dot66354])
Dot67661 = keras.layers.Dot(axes=(1, 1), name = 'Dot67661', )([in0Dot67661,in1Dot67661])
Add52668 = keras.layers.Add(name = 'Add52668', )([Dot66354,Dot67661])
Con8503 = keras.layers.Concatenate(axis=1, name = 'Con8503', )([Add52668,in0Con8503])
Ave60582 = keras.layers.Average(name = 'Ave60582', )([Fla54169,Con8503])
model = tf.keras.models.Model(inputs=[in0Ave63468,in0Dot66354,in1Dot66354,in0Dot67661,in1Dot67661,in0Con8503], outputs=Ave60582)
w = model.get_layer('Loc4572').get_weights() 
w[0] = np.array([[[0.0344, 0.2369, 0.0943]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc4572').set_weights(w) 
in0Ave63468 = tf.constant([[[[1.4953]]]])
in0Dot66354 = tf.constant([[0.3859, 0.895]])
in1Dot66354 = tf.constant([[0.9393, 0.3732]])
in0Dot67661 = tf.constant([[0.9858, 0.8396]])
in1Dot67661 = tf.constant([[0.3537, 0.5913]])
in0Con8503 = tf.constant([[0.4173, 0.7063]])
print (np.array2string(model.predict([in0Ave63468,in0Dot66354,in1Dot66354,in0Dot67661,in1Dot67661,in0Con8503],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave60582.png')

LAve63468 = average_pooling2D_layer([[[[1.4953]]]], 1, 1, Ave63468), 
LRes1098 = reshape_layer(Ave63468, [1, 1, 1, 1], Res1098), 
LCro70414 = cropping3D_layer(Res1098, 0, 0, 0, 0, 0, 0, Cro70414), 
LRes66273 = reshape_layer(Cro70414, [1, 1, 1], Res66273), 
LLoc4572 = locally_connected2D_layer(Res66273, 1, 1,[[[0.0344, 0.2369, 0.0943]]],[[[0, 0, 0]]], 1, 1, Loc4572), 
LRes42483 = reshape_layer(Loc4572, [1, 3], Res42483), 
LFla54169 = flatten_layer(Res42483, Fla54169), 
LDot66354 = dot_layer([[0.3859, 0.895]], [[0.9393, 0.3732]], 1, 1, Dot66354), 
LDot67661 = dot_layer([[0.9858, 0.8396]], [[0.3537, 0.5913]], 1, 1, Dot67661), 
LAdd52668 = add_layer([Dot66354,Dot67661], Add52668), 
LCon8503 = concatenate_layer([Add52668,[[0.4173, 0.7063]]], 1, Con8503), 
LAve60582 = average_layer([Fla54169,Con8503], Ave60582), 
exec_layers([LAve63468,LRes1098,LCro70414,LRes66273,LLoc4572,LRes42483,LFla54169,LDot66354,LDot67661,LAdd52668,LCon8503,LAve60582],["Ave63468","Res1098","Cro70414","Res66273","Loc4572","Res42483","Fla54169","Dot66354","Dot67661","Add52668","Con8503","Ave60582"],Ave60582,"Ave60582")

Actual (Unparsed): [[0.7965306, 0.3857683, 0.4236534]]

Expected (Unparsed): [[0.796530565,0.38576828500000004,0.423653395]]

Actual:   [[0.7966, 0.3858, 0.4237]]

Expected: [[0.7966, 0.3858, 0.4237]]