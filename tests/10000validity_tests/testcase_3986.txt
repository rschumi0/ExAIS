import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add84911 = tf.keras.layers.Input(shape=([1, 2]))
in1Add84911 = tf.keras.layers.Input(shape=([1, 2]))
in0Con55688 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot69892 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot69892 = tf.keras.layers.Input(shape=([2, 2]))
in0Con96943 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Mul71446 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul71446 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Mul64159 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul64159 = tf.keras.layers.Input(shape=([2, 1]))
in0Con72818 = tf.keras.layers.Input(shape=([2, 3]))

Add84911 = keras.layers.Add(name = 'Add84911', )([in0Add84911,in1Add84911])
Con55688 = keras.layers.Concatenate(axis=2, name = 'Con55688', )([Add84911,in0Con55688])
Dot69892 = keras.layers.Dot(axes=(2, 1), name = 'Dot69892', )([in0Dot69892,in1Dot69892])
Res546 = keras.layers.Reshape((2, 2, 1), name = 'Res546', )(Dot69892)
Con96943 = keras.layers.Concatenate(axis=3, name = 'Con96943', )([Res546,in0Con96943])
Mul71446 = keras.layers.Multiply(name = 'Mul71446', )([in0Mul71446,in1Mul71446])
Zer54696 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer54696', )(Mul71446)
Max10935 = keras.layers.Maximum(name = 'Max10935', )([Con96943,Zer54696])
Res94496 = keras.layers.Reshape((2, 4), name = 'Res94496', )(Max10935)
Mul64159 = keras.layers.Multiply(name = 'Mul64159', )([in0Mul64159,in1Mul64159])
Con72818 = keras.layers.Concatenate(axis=2, name = 'Con72818', )([Mul64159,in0Con72818])
Add91524 = keras.layers.Add(name = 'Add91524', )([Res94496,Con72818])
Sep60479 = keras.layers.SeparableConv1D(3, (2),strides=(2), padding='valid', name = 'Sep60479', )(Add91524)
Ave73047 = keras.layers.Average(name = 'Ave73047', )([Con55688,Sep60479])
Res8331 = keras.layers.Reshape((1, 3, 1), name = 'Res8331', )(Ave73047)
Res48261 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res48261', )(Res8331)
Cro31777 = keras.layers.Cropping3D(cropping=((0, 0), (1, 1), (0, 0)), name = 'Cro31777', )(Res48261)
model = tf.keras.models.Model(inputs=[in0Add84911,in1Add84911,in0Con55688,in0Dot69892,in1Dot69892,in0Con96943,in0Mul71446,in1Mul71446,in0Mul64159,in1Mul64159,in0Con72818], outputs=Cro31777)
w = model.get_layer('Sep60479').get_weights() 
w[0] = np.array([[[0.0837], [0.529], [0.5056], [0.3245]], [[0.8029], [0.3886], [0.1727], [0.7963]]])
w[1] = np.array([[[0.5791, 0.8422, 0.31], [0.5757, 0.2427, 0.4834], [0.8962, 0.1046, 0.5527], [0.2419, 0.3893, 0.7326]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep60479').set_weights(w) 
in0Add84911 = tf.constant([[[0.4947, 0.207]]])
in1Add84911 = tf.constant([[[0.2364, 0.1918]]])
in0Con55688 = tf.constant([[[0.3336]]])
in0Dot69892 = tf.constant([[[0.2864, 0.1551], [0.7315, 0.8577]]])
in1Dot69892 = tf.constant([[[0.5131, 0.3877], [0.7444, 0.053]]])
in0Con96943 = tf.constant([[[[0.2877], [0.521]], [[0.1797], [0.1916]]]])
in0Mul71446 = tf.constant([[[[0.7129, 0.676]], [[0.1936, 0.8518]]]])
in1Mul71446 = tf.constant([[[[0.8333, 0.8645]], [[0.7155, 0.7376]]]])
in0Mul64159 = tf.constant([[[0.8552], [0.3566]]])
in1Mul64159 = tf.constant([[[0.6076], [0.1172]]])
in0Con72818 = tf.constant([[[0.7607, 0.7952, 0.9517], [0.9673, 0.4086, 0.0773]]])
print (np.array2string(model.predict([in0Add84911,in1Add84911,in0Con55688,in0Dot69892,in1Dot69892,in0Con96943,in0Mul71446,in1Mul71446,in0Mul64159,in1Mul64159,in0Con72818],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro31777.png')

LAdd84911 = add_layer([[[[0.4947, 0.207]]], [[[0.2364, 0.1918]]]], Add84911), 
LCon55688 = concatenate_layer([Add84911,[[[0.3336]]]], 2, Con55688), 
LDot69892 = dot_layer([[[0.2864, 0.1551], [0.7315, 0.8577]]], [[[0.5131, 0.3877], [0.7444, 0.053]]], 2, 1, Dot69892), 
LRes546 = reshape_layer(Dot69892, [2, 2, 1], Res546), 
LCon96943 = concatenate_layer([Res546,[[[[0.2877], [0.521]], [[0.1797], [0.1916]]]]], 3, Con96943), 
LMul71446 = multiply_layer([[[[[0.7129, 0.676]], [[0.1936, 0.8518]]]], [[[[0.8333, 0.8645]], [[0.7155, 0.7376]]]]], Mul71446), 
LZer54696 = zero_padding2D_layer(Mul71446, 0, 0, 1, 0, Zer54696), 
LMax10935 = maximum_layer([Con96943,Zer54696], Max10935), 
LRes94496 = reshape_layer(Max10935, [2, 4], Res94496), 
LMul64159 = multiply_layer([[[[0.8552], [0.3566]]], [[[0.6076], [0.1172]]]], Mul64159), 
LCon72818 = concatenate_layer([Mul64159,[[[0.7607, 0.7952, 0.9517], [0.9673, 0.4086, 0.0773]]]], 2, Con72818), 
LAdd91524 = add_layer([Res94496,Con72818], Add91524), 
LSep60479 = separable_conv1D_layer(Add91524, 2,[[[[0.0837], [0.529], [0.5056], [0.3245]], [[0.8029], [0.3886], [0.1727], [0.7963]]],[[[0.5791, 0.8422, 0.31], [0.5757, 0.2427, 0.4834], [0.8962, 0.1046, 0.5527], [0.2419, 0.3893, 0.7326]]]],[0, 0, 0], 2, false, Sep60479), 
LAve73047 = average_layer([Con55688,Sep60479], Ave73047), 
LRes8331 = reshape_layer(Ave73047, [1, 3, 1], Res8331), 
LRes48261 = reshape_layer(Res8331, [1, 3, 1, 1], Res48261), 
LCro31777 = cropping3D_layer(Res48261, 0, 0, 1, 1, 0, 0, Cro31777), 
exec_layers([LAdd84911,LCon55688,LDot69892,LRes546,LCon96943,LMul71446,LZer54696,LMax10935,LRes94496,LMul64159,LCon72818,LAdd91524,LSep60479,LAve73047,LRes8331,LRes48261,LCro31777],["Add84911","Con55688","Dot69892","Res546","Con96943","Mul71446","Zer54696","Max10935","Res94496","Mul64159","Con72818","Add91524","Sep60479","Ave73047","Res8331","Res48261","Cro31777"],Cro31777,"Cro31777")

Actual (Unparsed): [[[[[0.9550431]]]]]

Expected (Unparsed): [[[[[0.9550430492501992]]]]]

Actual:   [[[[[0.9551]]]]]

Expected: [[[[[0.9551]]]]]