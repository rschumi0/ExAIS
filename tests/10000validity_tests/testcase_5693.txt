import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min51751 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min51751 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Max60081 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max60081 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Min51751 = keras.layers.Minimum(name = 'Min51751', )([in0Min51751,in1Min51751])
Sof54112 = keras.layers.Softmax(axis=1, name = 'Sof54112', )(Min51751)
Res98395 = keras.layers.Reshape((1, 2, 2), name = 'Res98395', )(Sof54112)
Res56522 = keras.layers.Reshape((1, 4), name = 'Res56522', )(Res98395)
Max60081 = keras.layers.Maximum(name = 'Max60081', )([in0Max60081,in1Max60081])
Res69369 = keras.layers.Reshape((2, 2, 2), name = 'Res69369', )(Max60081)
Res55068 = keras.layers.Reshape((2, 4), name = 'Res55068', )(Res69369)
Dot30667 = keras.layers.Dot(axes=(2, 2), name = 'Dot30667', )([Res56522,Res55068])
model = tf.keras.models.Model(inputs=[in0Min51751,in1Min51751,in0Max60081,in1Max60081], outputs=Dot30667)
in0Min51751 = tf.constant([[[[[0.0003], [0.2744]], [[0.1862], [0.678]]]]])
in1Min51751 = tf.constant([[[[[0.868], [0.6725]], [[0.9427], [0.8315]]]]])
in0Max60081 = tf.constant([[[[[0.0579, 0.6599]], [[0.1273, 0.4364]]], [[[0.9793, 0.0414]], [[0.9278, 0.2306]]]]])
in1Max60081 = tf.constant([[[[[0.6542, 0.8576]], [[0.1585, 0.8139]]], [[[0.0215, 0.422]], [[0.219, 0.3422]]]]])
print (np.array2string(model.predict([in0Min51751,in1Min51751,in0Max60081,in1Max60081],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot30667.png')

LMin51751 = minimum_layer([[[[[[0.0003], [0.2744]], [[0.1862], [0.678]]]]], [[[[[0.868], [0.6725]], [[0.9427], [0.8315]]]]]], Min51751), 
LSof54112 = softmax_layer(Min51751, 1, Sof54112), 
LRes98395 = reshape_layer(Sof54112, [1, 2, 2], Res98395), 
LRes56522 = reshape_layer(Res98395, [1, 4], Res56522), 
LMax60081 = maximum_layer([[[[[[0.0579, 0.6599]], [[0.1273, 0.4364]]], [[[0.9793, 0.0414]], [[0.9278, 0.2306]]]]], [[[[[0.6542, 0.8576]], [[0.1585, 0.8139]]], [[[0.0215, 0.422]], [[0.219, 0.3422]]]]]], Max60081), 
LRes69369 = reshape_layer(Max60081, [2, 2, 2], Res69369), 
LRes55068 = reshape_layer(Res69369, [2, 4], Res55068), 
LDot30667 = dot_layer(Res56522,Res55068, 2, 2, Dot30667), 
exec_layers([LMin51751,LSof54112,LRes98395,LRes56522,LMax60081,LRes69369,LRes55068,LDot30667],["Min51751","Sof54112","Res98395","Res56522","Max60081","Res69369","Res55068","Dot30667"],Dot30667,"Dot30667")

Actual (Unparsed): [[[2.4842000, 2.6713000]]]

Expected (Unparsed): [[[2.4842,2.6713]]]

Actual:   [[[2.4842, 2.6713]]]

Expected: [[[2.4842, 2.6713]]]