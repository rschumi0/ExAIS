import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc2997 = tf.keras.layers.Input(shape=([2, 1]))

Loc2997 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc2997', )(in0Loc2997)
Den5491 = keras.layers.Dense(3,name = 'Den5491', )(Loc2997)
model = tf.keras.models.Model(inputs=[in0Loc2997], outputs=Den5491)
w = model.get_layer('Loc2997').get_weights() 
w[0] = np.array([[[0.4557, 0.151]], [[0.6841, 0.3081]]])
w[1] = np.array([[0, 0], [0, 0]])
model.get_layer('Loc2997').set_weights(w) 
w = model.get_layer('Den5491').get_weights() 
w[0] = np.array([[0.3063, 0.9399, 0.989], [0.5074, 0.6715, 0.1169]])
w[1] = np.array([0.8777, 0.558, 0.5318])
model.get_layer('Den5491').set_weights(w) 
in0Loc2997 = tf.constant([[[0.1147], [0.3662]]])
print (np.array2string(model.predict([in0Loc2997],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den5491.png')

LLoc2997 = locally_connected1D_layer([[[0.1147], [0.3662]]], 1,[[[0.4557, 0.151]], [[0.6841, 0.3081]]],[[0, 0], [0, 0]], 1, Loc2997), 
LDen5491 = dense_layer(Loc2997, [[0.3063, 0.9399, 0.989], [0.5074, 0.6715, 0.1169]],[0.8777, 0.558, 0.5318], Den5491), 
exec_layers([LLoc2997,LDen5491],["Loc2997","Den5491"],Den5491,"Den5491")

Actual (Unparsed): [[[0.9024979, 0.6187576, 0.5855185], [1.0116815, 0.8692241, 0.7927511]]]

Expected (Unparsed): [[[0.9024979461570001,0.6187576142710001,0.58551850624],[1.0116815097740002,0.8692241297880001,0.7927511134980001]]]

Actual:   [[[0.9025, 0.6188, 0.5856], [1.0117, 0.8693, 0.7928]]]

Expected: [[[0.9025, 0.6188, 0.5856], [1.0117, 0.8693, 0.7928]]]