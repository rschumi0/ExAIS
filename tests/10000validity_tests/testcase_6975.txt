import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min55830 = tf.keras.layers.Input(shape=([2, 1]))
in1Min55830 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul32161 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul32161 = tf.keras.layers.Input(shape=([2, 1, 1]))

Min55830 = keras.layers.Minimum(name = 'Min55830', )([in0Min55830,in1Min55830])
LST70046 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST70046', )(Min55830)
Res60253 = keras.layers.Reshape((2, 1), name = 'Res60253', )(LST70046)
Mul32161 = keras.layers.Multiply(name = 'Mul32161', )([in0Mul32161,in1Mul32161])
Res87962 = keras.layers.Reshape((2, 1), name = 'Res87962', )(Mul32161)
Per65542 = keras.layers.Permute((1,2), name = 'Per65542',)(Res87962)
Min72271 = keras.layers.Minimum(name = 'Min72271', )([Res60253,Per65542])
model = tf.keras.models.Model(inputs=[in0Min55830,in1Min55830,in0Mul32161,in1Mul32161], outputs=Min72271)
w = model.get_layer('LST70046').get_weights() 
w[0] = np.array([[1, 9, 5, 10, 9, 4, 9, 5]])
w[1] = np.array([[4, 8, 4, 1, 5, 6, 2, 1], [5, 1, 9, 9, 6, 2, 3, 7]])
w[2] = np.array([7, 2, 10, 9, 5, 3, 8, 8])
model.get_layer('LST70046').set_weights(w) 
in0Min55830 = tf.constant([[[0.3103], [0.4533]]])
in1Min55830 = tf.constant([[[0.4568], [0.3789]]])
in0Mul32161 = tf.constant([[[[0.9324]], [[0.0035]]]])
in1Mul32161 = tf.constant([[[[0.3803]], [[0.7936]]]])
print (np.array2string(model.predict([in0Min55830,in1Min55830,in0Mul32161,in1Mul32161],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min72271.png')

LMin55830 = minimum_layer([[[[0.3103], [0.4533]]], [[[0.4568], [0.3789]]]], Min55830), 
LLST70046 = lstm_layer(Min55830,[[1, 9, 5, 10, 9, 4, 9, 5]],[[4, 8, 4, 1, 5, 6, 2, 1], [5, 1, 9, 9, 6, 2, 3, 7]],[7, 2, 10, 9, 5, 3, 8, 8], LST70046), 
LRes60253 = reshape_layer(LST70046, [2, 1], Res60253), 
LMul32161 = multiply_layer([[[[[0.9324]], [[0.0035]]]], [[[[0.3803]], [[0.7936]]]]], Mul32161), 
LRes87962 = reshape_layer(Mul32161, [2, 1], Res87962), 
LPer65542 = permute_layer(Res87962, 1,2, Per65542), 
LMin72271 = minimum_layer([Res60253,Per65542], Min72271), 
exec_layers([LMin55830,LLST70046,LRes60253,LMul32161,LRes87962,LPer65542,LMin72271],["Min55830","LST70046","Res60253","Mul32161","Res87962","Per65542","Min72271"],Min72271,"Min72271")

Actual (Unparsed): [[[0.3545917], [0.0027776]]]

Expected (Unparsed): [[[0.35459172000000005],[0.0027776]]]

Actual:   [[[0.3546], [0.0028]]]

Expected: [[[0.3546], [0.0028]]]