import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min46037 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Min46037 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Min46037 = keras.layers.Minimum(name = 'Min46037', )([in0Min46037,in1Min46037])
Res80276 = keras.layers.Reshape((1, 2, 1), name = 'Res80276', )(Min46037)
Res12215 = keras.layers.Reshape((1, 2), name = 'Res12215', )(Res80276)
GRU96315 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU96315', )(Res12215)
Res31154 = keras.layers.Reshape((1, 1), name = 'Res31154', )(GRU96315)
Res52330 = keras.layers.Reshape((1, 1, 1), name = 'Res52330', )(Res31154)
Res87898 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res87898', )(Res52330)
Cro82 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro82', )(Res87898)
model = tf.keras.models.Model(inputs=[in0Min46037,in1Min46037], outputs=Cro82)
w = model.get_layer('GRU96315').get_weights() 
w[0] = np.array([[5, 7, 3], [7, 8, 1]])
w[1] = np.array([[2, 5, 2]])
w[2] = np.array([[8, 3, 3], [6, 10, 5]])
model.get_layer('GRU96315').set_weights(w) 
in0Min46037 = tf.constant([[[[[0.0173]], [[0.2875]]]]])
in1Min46037 = tf.constant([[[[[0.4641]], [[0.4344]]]]])
print (np.array2string(model.predict([in0Min46037,in1Min46037],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro82.png')

LMin46037 = minimum_layer([[[[[[0.0173]], [[0.2875]]]]], [[[[[0.4641]], [[0.4344]]]]]], Min46037), 
LRes80276 = reshape_layer(Min46037, [1, 2, 1], Res80276), 
LRes12215 = reshape_layer(Res80276, [1, 2], Res12215), 
LGRU96315 = gru_layer(Res12215,[[5, 7, 3], [7, 8, 1]],[[2, 5, 2]],[[8, 3, 3], [6, 10, 5]], true, GRU96315), 
LRes31154 = reshape_layer(GRU96315, [1, 1], Res31154), 
LRes52330 = reshape_layer(Res31154, [1, 1, 1], Res52330), 
LRes87898 = reshape_layer(Res52330, [1, 1, 1, 1], Res87898), 
LCro82 = cropping3D_layer(Res87898, 0, 0, 0, 0, 0, 0, Cro82), 
exec_layers([LMin46037,LRes80276,LRes12215,LGRU96315,LRes31154,LRes52330,LRes87898,LCro82],["Min46037","Res80276","Res12215","GRU96315","Res31154","Res52330","Res87898","Cro82"],Cro82,"Cro82")

Actual (Unparsed): [[[[[0.0000001]]]]]

Expected (Unparsed): [[[[[1.0192789181464238e-7]]]]]

Actual:   [[[[[0]]]]]

Expected: [[[[[0]]]]]