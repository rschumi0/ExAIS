import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con54166 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con67110 = tf.keras.layers.Input(shape=([3, 2]))
in0Ave15090 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con60534 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Mul68130 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Mul68130 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Dot19344 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot19344 = tf.keras.layers.Input(shape=([2, 3]))
in0Con33692 = tf.keras.layers.Input(shape=([3, 1]))

Con54166 = keras.layers.Conv2DTranspose(2, (1, 1),strides=(1, 1), padding='valid', name = 'Con54166', )(in0Con54166)
Res83354 = keras.layers.Reshape((1, 2), name = 'Res83354', )(Con54166)
Zer21604 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer21604', )(Res83354)
Con67110 = keras.layers.Concatenate(axis=2, name = 'Con67110', )([Zer21604,in0Con67110])
Ave15090 = keras.layers.AveragePooling2D(pool_size=(1, 2), name = 'Ave15090', )(in0Ave15090)
Res88406 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res88406', )(Ave15090)
Con60534 = keras.layers.Concatenate(axis=4, name = 'Con60534', )([Res88406,in0Con60534])
Mul68130 = keras.layers.Multiply(name = 'Mul68130', )([in0Mul68130,in1Mul68130])
Zer7653 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer7653', )(Mul68130)
Sub91887 = keras.layers.Subtract(name = 'Sub91887', )([Con60534,Zer7653])
Res3572 = keras.layers.Reshape((2, 1, 4), name = 'Res3572', )(Sub91887)
Res75710 = keras.layers.Reshape((2, 4), name = 'Res75710', )(Res3572)
Zer652 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer652', )(Res75710)
Dot19344 = keras.layers.Dot(axes=(1, 1), name = 'Dot19344', )([in0Dot19344,in1Dot19344])
Con33692 = keras.layers.Concatenate(axis=2, name = 'Con33692', )([Dot19344,in0Con33692])
Mul29605 = keras.layers.Multiply(name = 'Mul29605', )([Zer652,Con33692])
Min49057 = keras.layers.Minimum(name = 'Min49057', )([Con67110,Mul29605])
model = tf.keras.models.Model(inputs=[in0Con54166,in0Con67110,in0Ave15090,in0Con60534,in0Mul68130,in1Mul68130,in0Dot19344,in1Dot19344,in0Con33692], outputs=Min49057)
w = model.get_layer('Con54166').get_weights() 
w[0] = np.array([[[[0.1884], [0.7377]]]])
w[1] = np.array([0, 0])
model.get_layer('Con54166').set_weights(w) 
in0Con54166 = tf.constant([[[[0.1427]]]])
in0Con67110 = tf.constant([[[0.8549, 0.7925], [0.2148, 0.6222], [0.8734, 0.3246]]])
in0Ave15090 = tf.constant([[[[1.0005, 1.5864], [1.8917, 1.0752]], [[1.2278, 1.4918], [1.4811, 1.9217]]]])
in0Con60534 = tf.constant([[[[[0.1205], [0.0265]]], [[[0.6503], [0.9369]]]]])
in0Mul68130 = tf.constant([[[[[0.8947, 0.0368], [0.6476, 0.106]]]]])
in1Mul68130 = tf.constant([[[[[0.0121, 0.5092], [0.3953, 0.5713]]]]])
in0Dot19344 = tf.constant([[[0.1717, 0.0265, 0.6407], [0.6571, 0.2449, 0.2105]]])
in1Dot19344 = tf.constant([[[0.8124, 0.6835, 0.1628], [0.4587, 0.0463, 0.5962]]])
in0Con33692 = tf.constant([[[0.3776], [0.1994], [0.9352]]])
print (np.array2string(model.predict([in0Con54166,in0Con67110,in0Ave15090,in0Con60534,in0Mul68130,in1Mul68130,in0Dot19344,in1Dot19344,in0Con33692],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min49057.png')

LCon54166 = conv2D_transpose_layer([[[[0.1427]]]], 1, 1,[[[[0.1884], [0.7377]]]],[0, 0], 1, 1, false, Con54166), 
LRes83354 = reshape_layer(Con54166, [1, 2], Res83354), 
LZer21604 = zero_padding1D_layer(Res83354, 2, 0, Zer21604), 
LCon67110 = concatenate_layer([Zer21604,[[[0.8549, 0.7925], [0.2148, 0.6222], [0.8734, 0.3246]]]], 2, Con67110), 
LAve15090 = average_pooling2D_layer([[[[1.0005, 1.5864], [1.8917, 1.0752]], [[1.2278, 1.4918], [1.4811, 1.9217]]]], 1, 2, Ave15090), 
LRes88406 = reshape_layer(Ave15090, [2, 1, 2, 1], Res88406), 
LCon60534 = concatenate_layer([Res88406,[[[[[0.1205], [0.0265]]], [[[0.6503], [0.9369]]]]]], 4, Con60534), 
LMul68130 = multiply_layer([[[[[[0.8947, 0.0368], [0.6476, 0.106]]]]], [[[[[0.0121, 0.5092], [0.3953, 0.5713]]]]]], Mul68130), 
LZer7653 = zero_padding3D_layer(Mul68130, 1, 0, 0, 0, 0, 0, Zer7653), 
LSub91887 = subtract_layer(Con60534,Zer7653, Sub91887), 
LRes3572 = reshape_layer(Sub91887, [2, 1, 4], Res3572), 
LRes75710 = reshape_layer(Res3572, [2, 4], Res75710), 
LZer652 = zero_padding1D_layer(Res75710, 1, 0, Zer652), 
LDot19344 = dot_layer([[[0.1717, 0.0265, 0.6407], [0.6571, 0.2449, 0.2105]]], [[[0.8124, 0.6835, 0.1628], [0.4587, 0.0463, 0.5962]]], 1, 1, Dot19344), 
LCon33692 = concatenate_layer([Dot19344,[[[0.3776], [0.1994], [0.9352]]]], 2, Con33692), 
LMul29605 = multiply_layer([Zer652,Con33692], Mul29605), 
LMin49057 = minimum_layer([Con67110,Mul29605], Min49057), 
exec_layers([LCon54166,LRes83354,LZer21604,LCon67110,LAve15090,LRes88406,LCon60534,LMul68130,LZer7653,LSub91887,LRes3572,LRes75710,LZer652,LDot19344,LCon33692,LMul29605,LMin49057],["Con54166","Res83354","Zer21604","Con67110","Ave15090","Res88406","Con60534","Mul68130","Zer7653","Sub91887","Res3572","Res75710","Zer652","Dot19344","Con33692","Mul29605","Min49057"],Min49057,"Min49057")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.2000506, 0.0052841], [0.0268847, 0.1052698, 0.3333920, 0.3246000]]]

Expected (Unparsed): [[[0,0,0.0,0.0],[0,0,0.20005062026399997,0.0052841],[0.02688468,0.10526979,0.33339199642354317,0.3246]]]

Actual:   [[[0, 0, 0, 0], [0, 0, 0.2001, 0.0053], [0.0269, 0.1053, 0.3334, 0.3246]]]

Expected: [[[0, 0, 0, 0], [0, 0, 0.2001, 0.0053], [0.0269, 0.1053, 0.3334, 0.3246]]]