import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe35841 = tf.keras.layers.Input(shape=([1, 2]))
in0Add61270 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add61270 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con13580 = tf.keras.layers.Input(shape=([2, 1]))
in0Con32898 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Cro2569 = tf.keras.layers.Input(shape=([1, 2]))
in0Con14380 = tf.keras.layers.Input(shape=([2, 1]))
in0Con82431 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Sub91659 = tf.keras.layers.Input(shape=([3]))
in1Sub91659 = tf.keras.layers.Input(shape=([3]))
in0Con96744 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Max79658 = tf.keras.layers.Input(shape=([1, 2, 2]))

PRe35841 = keras.layers.PReLU(name = 'PRe35841', input_shape=(1, 2))(in0PRe35841)
Zer8369 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer8369', )(PRe35841)
Add61270 = keras.layers.Add(name = 'Add61270', )([in0Add61270,in1Add61270])
Res89434 = keras.layers.Reshape((1, 2), name = 'Res89434', )(Add61270)
Zer65555 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer65555', )(Res89434)
Con13580 = keras.layers.Concatenate(axis=2, name = 'Con13580', )([Zer65555,in0Con13580])
Con32898 = keras.layers.Conv2DTranspose(3, (2, 1),strides=(1, 1), padding='same', name = 'Con32898', )(in0Con32898)
Res92179 = keras.layers.Reshape((2, 3), name = 'Res92179', )(Con32898)
Cro2569 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro2569', )(in0Cro2569)
Zer17826 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer17826', )(Cro2569)
Con14380 = keras.layers.Concatenate(axis=2, name = 'Con14380', )([Zer17826,in0Con14380])
Min84014 = keras.layers.Minimum(name = 'Min84014', )([Res92179,Con14380])
Ave73971 = keras.layers.Average(name = 'Ave73971', )([Con13580,Min84014])
Dot88920 = keras.layers.Dot(axes=(1, 1), name = 'Dot88920', )([Zer8369,Ave73971])
Res57808 = keras.layers.Reshape((2, 3, 1), name = 'Res57808', )(Dot88920)
Con82431 = keras.layers.Concatenate(axis=3, name = 'Con82431', )([Res57808,in0Con82431])
Sub91659 = keras.layers.Subtract(name = 'Sub91659', )([in0Sub91659,in1Sub91659])
Fla60614 = keras.layers.Flatten(name = 'Fla60614', )(Sub91659)
Res72964 = keras.layers.Reshape((3, 1), name = 'Res72964', )(Fla60614)
Glo83832 = keras.layers.GlobalMaxPool1D(name = 'Glo83832', )(Res72964)
Res93533 = keras.layers.Reshape((1, 1), name = 'Res93533', )(Glo83832)
Cro63019 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro63019', )(Res93533)
Res25543 = keras.layers.Reshape((1, 1, 1), name = 'Res25543', )(Cro63019)
Con96744 = keras.layers.Concatenate(axis=3, name = 'Con96744', )([Res25543,in0Con96744])
Max79658 = keras.layers.MaxPool2D(pool_size=(1, 2), name = 'Max79658', )(in0Max79658)
Min13325 = keras.layers.Minimum(name = 'Min13325', )([Con96744,Max79658])
Zer98007 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer98007', )(Min13325)
Max18830 = keras.layers.Maximum(name = 'Max18830', )([Con82431,Zer98007])
model = tf.keras.models.Model(inputs=[in0PRe35841,in0Add61270,in1Add61270,in0Con13580,in0Con32898,in0Cro2569,in0Con14380,in0Con82431,in0Sub91659,in1Sub91659,in0Con96744,in0Max79658], outputs=Max18830)
w = model.get_layer('PRe35841').get_weights() 
w[0] = np.array([[0.7993, 0.9888]])
model.get_layer('PRe35841').set_weights(w) 
w = model.get_layer('Con32898').get_weights() 
w[0] = np.array([[[[0.6537], [0.0158], [0.4086]]], [[[0.2028], [0.4711], [0.8944]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con32898').set_weights(w) 
in0PRe35841 = tf.constant([[[0.0766, 0.2887]]])
in0Add61270 = tf.constant([[[[0.3883], [0.7143]]]])
in1Add61270 = tf.constant([[[[0.3905], [0.9769]]]])
in0Con13580 = tf.constant([[[0.8913], [0.653]]])
in0Con32898 = tf.constant([[[[0.6463]], [[0.0593]]]])
in0Cro2569 = tf.constant([[[1.3998, 1.3666]]])
in0Con14380 = tf.constant([[[0.8675], [0.3792]]])
in0Con82431 = tf.constant([[[[0.1181], [0.6605], [0.8876]], [[0.4692], [0.0721], [0.5026]]]])
in0Sub91659 = tf.constant([[0.2479, 0.0716, 0.538]])
in1Sub91659 = tf.constant([[0.9938, 0.9162, 0.1229]])
in0Con96744 = tf.constant([[[[0.5424]]]])
in0Max79658 = tf.constant([[[[1.5451, 1.1017], [1.252, 1.2406]]]])
print (np.array2string(model.predict([in0PRe35841,in0Add61270,in1Add61270,in0Con13580,in0Con32898,in0Cro2569,in0Con14380,in0Con82431,in0Sub91659,in1Sub91659,in0Con96744,in0Max79658],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max18830.png')

LPRe35841 = prelu_layer([[[0.0766, 0.2887]]], [[0.7993, 0.9888]], PRe35841), 
LZer8369 = zero_padding1D_layer(PRe35841, 1, 0, Zer8369), 
LAdd61270 = add_layer([[[[[0.3883], [0.7143]]]], [[[[0.3905], [0.9769]]]]], Add61270), 
LRes89434 = reshape_layer(Add61270, [1, 2], Res89434), 
LZer65555 = zero_padding1D_layer(Res89434, 1, 0, Zer65555), 
LCon13580 = concatenate_layer([Zer65555,[[[0.8913], [0.653]]]], 2, Con13580), 
LCon32898 = conv2D_transpose_layer([[[[0.6463]], [[0.0593]]]], 2, 1,[[[[0.6537], [0.0158], [0.4086]]], [[[0.2028], [0.4711], [0.8944]]]],[0, 0, 0], 1, 1, true, Con32898), 
LRes92179 = reshape_layer(Con32898, [2, 3], Res92179), 
LCro2569 = cropping1D_layer([[[1.3998, 1.3666]]], 0, 0, Cro2569), 
LZer17826 = zero_padding1D_layer(Cro2569, 1, 0, Zer17826), 
LCon14380 = concatenate_layer([Zer17826,[[[0.8675], [0.3792]]]], 2, Con14380), 
LMin84014 = minimum_layer([Res92179,Con14380], Min84014), 
LAve73971 = average_layer([Con13580,Min84014], Ave73971), 
LDot88920 = dot_layer(Zer8369,Ave73971, 1, 1, Dot88920), 
LRes57808 = reshape_layer(Dot88920, [2, 3, 1], Res57808), 
LCon82431 = concatenate_layer([Res57808,[[[[0.1181], [0.6605], [0.8876]], [[0.4692], [0.0721], [0.5026]]]]], 3, Con82431), 
LSub91659 = subtract_layer([[0.2479, 0.0716, 0.538]], [[0.9938, 0.9162, 0.1229]], Sub91659), 
LFla60614 = flatten_layer(Sub91659, Fla60614), 
LRes72964 = reshape_layer(Fla60614, [3, 1], Res72964), 
LGlo83832 = global_max_pool1D_layer(Res72964, Glo83832), 
LRes93533 = reshape_layer(Glo83832, [1, 1], Res93533), 
LCro63019 = cropping1D_layer(Res93533, 0, 0, Cro63019), 
LRes25543 = reshape_layer(Cro63019, [1, 1, 1], Res25543), 
LCon96744 = concatenate_layer([Res25543,[[[[0.5424]]]]], 3, Con96744), 
LMax79658 = max_pool2D_layer([[[[1.5451, 1.1017], [1.252, 1.2406]]]], 1, 2, Max79658), 
LMin13325 = minimum_layer([Con96744,Max79658], Min13325), 
LZer98007 = zero_padding2D_layer(Min13325, 1, 0, 2, 0, Zer98007), 
LMax18830 = maximum_layer([Con82431,Zer98007], Max18830), 
exec_layers([LPRe35841,LZer8369,LAdd61270,LRes89434,LZer65555,LCon13580,LCon32898,LRes92179,LCro2569,LZer17826,LCon14380,LMin84014,LAve73971,LDot88920,LRes57808,LCon82431,LSub91659,LFla60614,LRes72964,LGlo83832,LRes93533,LCro63019,LRes25543,LCon96744,LMax79658,LMin13325,LZer98007,LMax18830],["PRe35841","Zer8369","Add61270","Res89434","Zer65555","Con13580","Con32898","Res92179","Cro2569","Zer17826","Con14380","Min84014","Ave73971","Dot88920","Res57808","Con82431","Sub91659","Fla60614","Res72964","Glo83832","Res93533","Cro63019","Res25543","Con96744","Max79658","Min13325","Zer98007","Max18830"],Max18830,"Max18830")

Actual (Unparsed): [[[[0.0363327, 0.1181000], [0.0764701, 0.6605000], [0.0395333, 0.8876000]], [[0.1369353, 0.4692000], [0.2882105, 0.0721000], [0.4151000, 0.5424000]]]]

Expected (Unparsed): [[[[0.036332684115,0.1181],[0.076470119721,0.6605],[0.03953326,0.8876]],[[0.13693532511749998,0.4692],[0.28821049038450003,0.0721],[0.4151,0.5424]]]]

Actual:   [[[[0.0364, 0.1181], [0.0765, 0.6605], [0.0396, 0.8876]], [[0.137, 0.4692], [0.2883, 0.0721], [0.4151, 0.5424]]]]

Expected: [[[[0.0364, 0.1181], [0.0765, 0.6605], [0.0396, 0.8876]], [[0.137, 0.4692], [0.2883, 0.0721], [0.4151, 0.5424]]]]