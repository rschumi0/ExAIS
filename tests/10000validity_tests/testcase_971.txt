import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max81558 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Max81558 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con4388 = tf.keras.layers.Input(shape=([1, 1]))
in0Mul62643 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul62643 = tf.keras.layers.Input(shape=([1, 2]))

Max81558 = keras.layers.Maximum(name = 'Max81558', )([in0Max81558,in1Max81558])
Res97413 = keras.layers.Reshape((1, 1, 1), name = 'Res97413', )(Max81558)
Dep64292 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep64292', )(Res97413)
Res5206 = keras.layers.Reshape((1, 1), name = 'Res5206', )(Dep64292)
Con4388 = keras.layers.Concatenate(axis=2, name = 'Con4388', )([Res5206,in0Con4388])
Mul62643 = keras.layers.Multiply(name = 'Mul62643', )([in0Mul62643,in1Mul62643])
Ave26811 = keras.layers.Average(name = 'Ave26811', )([Con4388,Mul62643])
model = tf.keras.models.Model(inputs=[in0Max81558,in1Max81558,in0Con4388,in0Mul62643,in1Mul62643], outputs=Ave26811)
w = model.get_layer('Dep64292').get_weights() 
w[0] = np.array([[[[0.8774]]]])
w[1] = np.array([0])
model.get_layer('Dep64292').set_weights(w) 
in0Max81558 = tf.constant([[[[[0.8296]]]]])
in1Max81558 = tf.constant([[[[[0.8423]]]]])
in0Con4388 = tf.constant([[[0.1625]]])
in0Mul62643 = tf.constant([[[0.583, 0.1578]]])
in1Mul62643 = tf.constant([[[0.6131, 0.7395]]])
print (np.array2string(model.predict([in0Max81558,in1Max81558,in0Con4388,in0Mul62643,in1Mul62643],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave26811.png')

LMax81558 = maximum_layer([[[[[[0.8296]]]]], [[[[[0.8423]]]]]], Max81558), 
LRes97413 = reshape_layer(Max81558, [1, 1, 1], Res97413), 
LDep64292 = depthwise_conv2D_layer(Res97413, 1, 1,[[[[0.8774]]]],[0], 1, 1, true, Dep64292), 
LRes5206 = reshape_layer(Dep64292, [1, 1], Res5206), 
LCon4388 = concatenate_layer([Res5206,[[[0.1625]]]], 2, Con4388), 
LMul62643 = multiply_layer([[[[0.583, 0.1578]]], [[[0.6131, 0.7395]]]], Mul62643), 
LAve26811 = average_layer([Con4388,Mul62643], Ave26811), 
exec_layers([LMax81558,LRes97413,LDep64292,LRes5206,LCon4388,LMul62643,LAve26811],["Max81558","Res97413","Dep64292","Res5206","Con4388","Mul62643","Ave26811"],Ave26811,"Ave26811")

Actual (Unparsed): [[[0.5482357, 0.1395965]]]

Expected (Unparsed): [[[0.54823566,0.13959655]]]

Actual:   [[[0.5483, 0.1396]]]

Expected: [[[0.5483, 0.1396]]]