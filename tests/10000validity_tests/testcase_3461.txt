import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep36184 = tf.keras.layers.Input(shape=([2, 2]))
in0GRU11450 = tf.keras.layers.Input(shape=([3, 1]))
in0Con74380 = tf.keras.layers.Input(shape=([1]))

Sep36184 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='valid', name = 'Sep36184', )(in0Sep36184)
Fla36982 = keras.layers.Flatten(name = 'Fla36982', )(Sep36184)
GRU11450 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU11450', )(in0GRU11450)
Con74380 = keras.layers.Concatenate(axis=1, name = 'Con74380', )([GRU11450,in0Con74380])
Min35917 = keras.layers.Minimum(name = 'Min35917', )([Fla36982,Con74380])
Res3033 = keras.layers.Reshape((4, 1), name = 'Res3033', )(Min35917)
PRe50865 = keras.layers.PReLU(name = 'PRe50865', )(Res3033)
model = tf.keras.models.Model(inputs=[in0Sep36184,in0GRU11450,in0Con74380], outputs=PRe50865)
w = model.get_layer('Sep36184').get_weights() 
w[0] = np.array([[[0.8757], [0.2589]]])
w[1] = np.array([[[0.3558, 0.0832], [0.0257, 0.7277]]])
w[2] = np.array([0, 0])
model.get_layer('Sep36184').set_weights(w) 
w = model.get_layer('GRU11450').get_weights() 
w[0] = np.array([[1, 7, 2, 8, 3, 3, 3, 6, 1]])
w[1] = np.array([[1, 10, 5, 1, 4, 5, 2, 9, 3], [8, 10, 7, 2, 9, 3, 4, 1, 5], [1, 6, 2, 8, 5, 1, 9, 3, 4]])
w[2] = np.array([8, 9, 1, 8, 10, 2, 2, 4, 8])
model.get_layer('GRU11450').set_weights(w) 
w = model.get_layer('PRe50865').get_weights() 
w[0] = np.array([[0.5258], [0.1572], [0.3088], [0.4844]])
model.get_layer('PRe50865').set_weights(w) 
in0Sep36184 = tf.constant([[[0.8224, 0.8333], [0.7886, 0.8302]]])
in0GRU11450 = tf.constant([[[7], [5], [2]]])
in0Con74380 = tf.constant([[0.6146]])
print (np.array2string(model.predict([in0Sep36184,in0GRU11450,in0Con74380],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe50865.png')

LSep36184 = separable_conv1D_layer([[[0.8224, 0.8333], [0.7886, 0.8302]]], 1,[[[[0.8757], [0.2589]]],[[[0.3558, 0.0832], [0.0257, 0.7277]]]],[0, 0], 1, false, Sep36184), 
LFla36982 = flatten_layer(Sep36184, Fla36982), 
LGRU11450 = gru_layer([[[7], [5], [2]]],[[1, 7, 2, 8, 3, 3, 3, 6, 1]],[[1, 10, 5, 1, 4, 5, 2, 9, 3], [8, 10, 7, 2, 9, 3, 4, 1, 5], [1, 6, 2, 8, 5, 1, 9, 3, 4]],[8, 9, 1, 8, 10, 2, 2, 4, 8], false, GRU11450), 
LCon74380 = concatenate_layer([GRU11450,[[0.6146]]], 1, Con74380), 
LMin35917 = minimum_layer([Fla36982,Con74380], Min35917), 
LRes3033 = reshape_layer(Min35917, [4, 1], Res3033), 
LPRe50865 = prelu_layer(Res3033, [[0.5258], [0.1572], [0.3088], [0.4844]], PRe50865), 
exec_layers([LSep36184,LFla36982,LGRU11450,LCon74380,LMin35917,LRes3033,LPRe50865],["Sep36184","Fla36982","GRU11450","Con74380","Min35917","Res3033","PRe50865"],PRe50865,"PRe50865")

Actual (Unparsed): [[[0.0000480], [0.0000000], [0.0067094], [0.2138670]]]

Expected (Unparsed): [[[4.796307789342494e-5],[1.0260570171282974e-10],[0.006709432932393125],[0.21386695827000002]]]

Actual:   [[[0.0001], [0], [0.0068], [0.2139]]]

Expected: [[[0.0001], [0], [0.0068], [0.2139]]]