import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub31985 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub31985 = tf.keras.layers.Input(shape=([3, 2]))

Sub31985 = keras.layers.Subtract(name = 'Sub31985', )([in0Sub31985,in1Sub31985])
Bat29321 = keras.layers.BatchNormalization(axis=2, epsilon=0.46920154646499834,  name = 'Bat29321', )(Sub31985)
model = tf.keras.models.Model(inputs=[in0Sub31985,in1Sub31985], outputs=Bat29321)
w = model.get_layer('Bat29321').get_weights() 
w[0] = np.array([0.1625, 0.5861])
w[1] = np.array([0.2824, 0.4293])
w[2] = np.array([0.3306, 0.7801])
w[3] = np.array([0.2296, 0.378])
model.get_layer('Bat29321').set_weights(w) 
in0Sub31985 = tf.constant([[[0.4635, 0.677], [0.7276, 0.5765], [0.5779, 0.0586]]])
in1Sub31985 = tf.constant([[[0.2767, 0.0836], [0.4098, 0.1981], [0.6082, 0.5509]]])
print (np.array2string(model.predict([in0Sub31985,in1Sub31985],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat29321.png')

LSub31985 = subtract_layer([[[0.4635, 0.677], [0.7276, 0.5765], [0.5779, 0.0586]]], [[[0.2767, 0.0836], [0.4098, 0.1981], [0.6082, 0.5509]]], Sub31985), 
LBat29321 = batch_normalization_layer(Sub31985, 2, 0.46920154646499834, [0.1625, 0.5861], [0.2824, 0.4293], [0.3306, 0.7801], [0.2296, 0.378], Bat29321), 
exec_layers([LSub31985,LBat29321],["Sub31985","Bat29321"],Bat29321,"Bat29321")

Actual (Unparsed): [[[0.2544466, 0.3104162], [0.2799118, 0.1735120], [0.2122442, -0.3809182]]]

Expected (Unparsed): [[[0.2544465560034583,0.3104162024681334],[0.27991179358028,0.17351198999169354],[0.21224424243148882,-0.38091823234893984]]]

Actual:   [[[0.2545, 0.3105], [0.28, 0.1736], [0.2123, -0.3809]]]

Expected: [[[0.2545, 0.3105], [0.28, 0.1736], [0.2123, -0.3809]]]