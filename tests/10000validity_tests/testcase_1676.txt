import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave63097 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave63097 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Add10456 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Add10456 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Ave63097 = keras.layers.Average(name = 'Ave63097', )([in0Ave63097,in1Ave63097])
Res84079 = keras.layers.Reshape((2, 1), name = 'Res84079', )(Ave63097)
Add10456 = keras.layers.Add(name = 'Add10456', )([in0Add10456,in1Add10456])
Res40031 = keras.layers.Reshape((2, 2, 4), name = 'Res40031', )(Add10456)
Res40080 = keras.layers.Reshape((2, 8), name = 'Res40080', )(Res40031)
Dot39754 = keras.layers.Dot(axes=(1, 1), name = 'Dot39754', )([Res84079,Res40080])
Res87486 = keras.layers.Reshape((1, 8, 1), name = 'Res87486', )(Dot39754)
Ave75345 = keras.layers.AveragePooling2D(pool_size=(1, 3), strides=(1, 1), padding='valid', name = 'Ave75345', )(Res87486)
Max71079 = keras.layers.MaxPool2D(pool_size=(1, 2), strides=(1, 1), padding='same', name = 'Max71079', )(Ave75345)
ELU61671 = keras.layers.ELU(alpha=-6.526041758362934, name = 'ELU61671', )(Max71079)
model = tf.keras.models.Model(inputs=[in0Ave63097,in1Ave63097,in0Add10456,in1Add10456], outputs=ELU61671)
in0Ave63097 = tf.constant([[[[0.2314]], [[0.7367]]]])
in1Ave63097 = tf.constant([[[[0.8393]], [[0.1339]]]])
in0Add10456 = tf.constant([[[[[0.4978, 0.3882], [0.6565, 0.1287]], [[0.9589, 0.1323], [0.1168, 0.1751]]], [[[0.2906, 0.0755], [0.8449, 0.1171]], [[0.7019, 0.5245], [0.6577, 0.662]]]]])
in1Add10456 = tf.constant([[[[[0.6494, 0.7379], [0.6561, 0.1574]], [[0.4069, 0.1588], [0.4768, 0.9058]]], [[[0.4333, 0.9619], [0.0994, 0.7293]], [[0.5214, 0.4508], [0.038, 0.217]]]]])
print (np.array2string(model.predict([in0Ave63097,in1Ave63097,in0Add10456,in1Add10456],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU61671.png')

LAve63097 = average_layer([[[[[0.2314]], [[0.7367]]]], [[[[0.8393]], [[0.1339]]]]], Ave63097), 
LRes84079 = reshape_layer(Ave63097, [2, 1], Res84079), 
LAdd10456 = add_layer([[[[[[0.4978, 0.3882], [0.6565, 0.1287]], [[0.9589, 0.1323], [0.1168, 0.1751]]], [[[0.2906, 0.0755], [0.8449, 0.1171]], [[0.7019, 0.5245], [0.6577, 0.662]]]]], [[[[[0.6494, 0.7379], [0.6561, 0.1574]], [[0.4069, 0.1588], [0.4768, 0.9058]]], [[[0.4333, 0.9619], [0.0994, 0.7293]], [[0.5214, 0.4508], [0.038, 0.217]]]]]], Add10456), 
LRes40031 = reshape_layer(Add10456, [2, 2, 4], Res40031), 
LRes40080 = reshape_layer(Res40031, [2, 8], Res40080), 
LDot39754 = dot_layer(Res84079,Res40080, 1, 1, Dot39754), 
LRes87486 = reshape_layer(Dot39754, [1, 8, 1], Res87486), 
LAve75345 = average_pooling2D_layer(Res87486, 1, 3, 1, 1, false, Ave75345), 
LMax71079 = max_pool2D_layer(Ave75345, 1, 2, 1, 1, true, Max71079), 
LELU61671 = elu_layer(Max71079, -6.526041758362934, ELU61671), 
exec_layers([LAve63097,LRes84079,LAdd10456,LRes40031,LRes40080,LDot39754,LRes87486,LAve75345,LMax71079,LELU61671],["Ave63097","Res84079","Add10456","Res40031","Res40080","Dot39754","Res87486","Ave75345","Max71079","ELU61671"],ELU61671,"ELU61671")

Actual (Unparsed): [[[[1.0324864], [0.9663464], [0.9663464], [0.8215646], [0.8215646], [0.7207663]]]]

Expected (Unparsed): [[[[1.032486415],[0.9663464249999999],[0.9663464249999999],[0.8215646549999999],[0.8215646549999999],[0.7207663200000001]]]]

Actual:   [[[[1.0325], [0.9664], [0.9664], [0.8216], [0.8216], [0.7208]]]]

Expected: [[[[1.0325], [0.9664], [0.9664], [0.8216], [0.8216], [0.7208]]]]