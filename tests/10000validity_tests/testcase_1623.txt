import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max29578 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max29578 = tf.keras.layers.Input(shape=([2, 2, 1]))

Max29578 = keras.layers.Maximum(name = 'Max29578', )([in0Max29578,in1Max29578])
Res21334 = keras.layers.Reshape((2, 2), name = 'Res21334', )(Max29578)
Loc5297 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc5297', )(Res21334)
Res24450 = keras.layers.Reshape((1, 3, 1), name = 'Res24450', )(Loc5297)
Res3904 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res3904', )(Res24450)
Glo73697 = keras.layers.GlobalAveragePooling3D(name = 'Glo73697', )(Res3904)
model = tf.keras.models.Model(inputs=[in0Max29578,in1Max29578], outputs=Glo73697)
w = model.get_layer('Loc5297').get_weights() 
w[0] = np.array([[[0.4928, 0.573, 0.987], [0.505, 0.3112, 0.243], [0.3519, 0.7607, 0.6289], [0.6333, 0.0893, 0.4348]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc5297').set_weights(w) 
in0Max29578 = tf.constant([[[[0.1599], [0.448]], [[0.9417], [0.0586]]]])
in1Max29578 = tf.constant([[[[0.7242], [0.4222]], [[0.5855], [0.9225]]]])
print (np.array2string(model.predict([in0Max29578,in1Max29578],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo73697.png')

LMax29578 = maximum_layer([[[[[0.1599], [0.448]], [[0.9417], [0.0586]]]], [[[[0.7242], [0.4222]], [[0.5855], [0.9225]]]]], Max29578), 
LRes21334 = reshape_layer(Max29578, [2, 2], Res21334), 
LLoc5297 = locally_connected1D_layer(Res21334, 2,[[[0.4928, 0.573, 0.987], [0.505, 0.3112, 0.243], [0.3519, 0.7607, 0.6289], [0.6333, 0.0893, 0.4348]]],[[0, 0, 0]], 1, Loc5297), 
LRes24450 = reshape_layer(Loc5297, [1, 3, 1], Res24450), 
LRes3904 = reshape_layer(Res24450, [1, 3, 1, 1], Res3904), 
LGlo73697 = global_average_pooling3D_layer(Res3904, Glo73697), 
exec_layers([LMax29578,LRes21334,LLoc5297,LRes24450,LRes3904,LGlo73697],["Max29578","Res21334","Loc5297","Res24450","Res3904","Glo73697"],Glo73697,"Glo73697")

Actual (Unparsed): [[1.5562771]]

Expected (Unparsed): [[1.5562771366666663]]

Actual:   [[1.5563]]

Expected: [[1.5563]]