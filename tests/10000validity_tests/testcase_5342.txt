import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub44288 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub44288 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con85619 = tf.keras.layers.Input(shape=([2, 14]))
in0Sub492 = tf.keras.layers.Input(shape=([3, 2, 3]))
in1Sub492 = tf.keras.layers.Input(shape=([3, 2, 3]))

Sub44288 = keras.layers.Subtract(name = 'Sub44288', )([in0Sub44288,in1Sub44288])
Res2210 = keras.layers.Reshape((2, 4), name = 'Res2210', )(Sub44288)
Con85619 = keras.layers.Concatenate(axis=2, name = 'Con85619', )([Res2210,in0Con85619])
Sub492 = keras.layers.Subtract(name = 'Sub492', )([in0Sub492,in1Sub492])
Res53745 = keras.layers.Reshape((3, 2, 3, 1), name = 'Res53745', )(Sub492)
Con29583 = keras.layers.Conv3D(3, (3, 2, 2),strides=(7, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con29583', )(Res53745)
Res18557 = keras.layers.Reshape((1, 2, 9), name = 'Res18557', )(Con29583)
Res17231 = keras.layers.Reshape((1, 18), name = 'Res17231', )(Res18557)
Dot25635 = keras.layers.Dot(axes=(2, 2), name = 'Dot25635', )([Con85619,Res17231])
model = tf.keras.models.Model(inputs=[in0Sub44288,in1Sub44288,in0Con85619,in0Sub492,in1Sub492], outputs=Dot25635)
w = model.get_layer('Con29583').get_weights() 
w[0] = np.array([[[[[0.8672, 0.3275, 0.9289]], [[0.1608, 0.3099, 0.0626]]], [[[0.5516, 0.3732, 0.6997]], [[0.7214, 0.5095, 0.2201]]]], [[[[0.1148, 0.6537, 0.2962]], [[0.3253, 0.4092, 0.4155]]], [[[0.7445, 0.2724, 0.5982]], [[0.1826, 0.3265, 0.8958]]]], [[[[0.7999, 0.5869, 0.8123]], [[0.4606, 0.4526, 0.8513]]], [[[0.2219, 0.2633, 0.7413]], [[0.2599, 0.4186, 0.6703]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con29583').set_weights(w) 
in0Sub44288 = tf.constant([[[[0.0718, 0.3782], [0.149, 0.9282]], [[0.4731, 0.9674], [0.068, 0.1394]]]])
in1Sub44288 = tf.constant([[[[0.4123, 0.2525], [0.0032, 0.0576]], [[0.2242, 0.9105], [0.4631, 0.0518]]]])
in0Con85619 = tf.constant([[[0.4012, 0.8778, 0.9145, 0.2224, 0.9429, 0.823, 0.7693, 0.2632, 0.6846, 0.8985, 0.7557, 0.8146, 0.3957, 0.9822], [0.5582, 0.3796, 0.9791, 0.0043, 0.1232, 0.6446, 0.6641, 0.4505, 0.5282, 0.5274, 0.8459, 0.431, 0.9465, 0.9039]]])
in0Sub492 = tf.constant([[[[0.8964, 0.4678, 0.9688], [0.9891, 0.8411, 0.1395]], [[0.1601, 0.791, 0.5727], [0.5002, 0.819, 0.4339]], [[0.8053, 0.532, 0.2932], [0.349, 0.2048, 0.2596]]]])
in1Sub492 = tf.constant([[[[0.7159, 0.1595, 0.3956], [0.7474, 0.4956, 0.095]], [[0.857, 0.7078, 0.7806], [0.2186, 0.024, 0.3509]], [[0.9911, 0.8168, 0.2504], [0.3907, 0.0548, 0.9095]]]])
print (np.array2string(model.predict([in0Sub44288,in1Sub44288,in0Con85619,in0Sub492,in1Sub492],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot25635.png')

LSub44288 = subtract_layer([[[[0.0718, 0.3782], [0.149, 0.9282]], [[0.4731, 0.9674], [0.068, 0.1394]]]], [[[[0.4123, 0.2525], [0.0032, 0.0576]], [[0.2242, 0.9105], [0.4631, 0.0518]]]], Sub44288), 
LRes2210 = reshape_layer(Sub44288, [2, 4], Res2210), 
LCon85619 = concatenate_layer([Res2210,[[[0.4012, 0.8778, 0.9145, 0.2224, 0.9429, 0.823, 0.7693, 0.2632, 0.6846, 0.8985, 0.7557, 0.8146, 0.3957, 0.9822], [0.5582, 0.3796, 0.9791, 0.0043, 0.1232, 0.6446, 0.6641, 0.4505, 0.5282, 0.5274, 0.8459, 0.431, 0.9465, 0.9039]]]], 2, Con85619), 
LSub492 = subtract_layer([[[[0.8964, 0.4678, 0.9688], [0.9891, 0.8411, 0.1395]], [[0.1601, 0.791, 0.5727], [0.5002, 0.819, 0.4339]], [[0.8053, 0.532, 0.2932], [0.349, 0.2048, 0.2596]]]], [[[[0.7159, 0.1595, 0.3956], [0.7474, 0.4956, 0.095]], [[0.857, 0.7078, 0.7806], [0.2186, 0.024, 0.3509]], [[0.9911, 0.8168, 0.2504], [0.3907, 0.0548, 0.9095]]]], Sub492), 
LRes53745 = reshape_layer(Sub492, [3, 2, 3, 1], Res53745), 
LCon29583 = conv3D_layer(Res53745, 3, 2, 2,[[[[[0.8672, 0.3275, 0.9289]], [[0.1608, 0.3099, 0.0626]]], [[[0.5516, 0.3732, 0.6997]], [[0.7214, 0.5095, 0.2201]]]], [[[[0.1148, 0.6537, 0.2962]], [[0.3253, 0.4092, 0.4155]]], [[[0.7445, 0.2724, 0.5982]], [[0.1826, 0.3265, 0.8958]]]], [[[[0.7999, 0.5869, 0.8123]], [[0.4606, 0.4526, 0.8513]]], [[[0.2219, 0.2633, 0.7413]], [[0.2599, 0.4186, 0.6703]]]]],[0, 0, 0], 7, 1, 1, true, 1, 1, 1, Con29583), 
LRes18557 = reshape_layer(Con29583, [1, 2, 9], Res18557), 
LRes17231 = reshape_layer(Res18557, [1, 18], Res17231), 
LDot25635 = dot_layer(Con85619,Res17231, 2, 2, Dot25635), 
exec_layers([LSub44288,LRes2210,LCon85619,LSub492,LRes53745,LCon29583,LRes18557,LRes17231,LDot25635],["Sub44288","Res2210","Con85619","Sub492","Res53745","Con29583","Res18557","Res17231","Dot25635"],Dot25635,"Dot25635")

Actual (Unparsed): [[[2.6941770], [1.5319236]]]

Expected (Unparsed): [[[2.6941769695380002],[1.5319235514660001]]]

Actual:   [[[2.6942], [1.532]]]

Expected: [[[2.6942], [1.532]]]