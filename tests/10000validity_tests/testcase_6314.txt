import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr57105 = tf.keras.layers.Input(shape=([1, 2]))
in0Min83340 = tf.keras.layers.Input(shape=([2, 2]))
in1Min83340 = tf.keras.layers.Input(shape=([2, 2]))

Thr57105 = keras.layers.ThresholdedReLU(theta=3.9190568913083723, name = 'Thr57105', input_shape=(1, 2))(in0Thr57105)
Zer39738 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer39738', )(Thr57105)
Min83340 = keras.layers.Minimum(name = 'Min83340', )([in0Min83340,in1Min83340])
PRe37995 = keras.layers.PReLU(name = 'PRe37995', )(Min83340)
Ave46 = keras.layers.Average(name = 'Ave46', )([Zer39738,PRe37995])
model = tf.keras.models.Model(inputs=[in0Thr57105,in0Min83340,in1Min83340], outputs=Ave46)
w = model.get_layer('PRe37995').get_weights() 
w[0] = np.array([[0.0554, 0.0393], [0.1785, 0.6314]])
model.get_layer('PRe37995').set_weights(w) 
in0Thr57105 = tf.constant([[[0.1295, 0.6582]]])
in0Min83340 = tf.constant([[[0.523, 0.408], [0.9988, 0.0158]]])
in1Min83340 = tf.constant([[[0.7465, 0.1459], [0.5826, 0.7671]]])
print (np.array2string(model.predict([in0Thr57105,in0Min83340,in1Min83340],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave46.png')

LThr57105 = thresholded_relu_layer([[[0.1295, 0.6582]]], 3.9190568913083723, Thr57105), 
LZer39738 = zero_padding1D_layer(Thr57105, 1, 0, Zer39738), 
LMin83340 = minimum_layer([[[[0.523, 0.408], [0.9988, 0.0158]]], [[[0.7465, 0.1459], [0.5826, 0.7671]]]], Min83340), 
LPRe37995 = prelu_layer(Min83340, [[0.0554, 0.0393], [0.1785, 0.6314]], PRe37995), 
LAve46 = average_layer([Zer39738,PRe37995], Ave46), 
exec_layers([LThr57105,LZer39738,LMin83340,LPRe37995,LAve46],["Thr57105","Zer39738","Min83340","PRe37995","Ave46"],Ave46,"Ave46")

Actual (Unparsed): [[[0.2615000, 0.0729500], [0.2913000, 0.0079000]]]

Expected (Unparsed): [[[0.2615,0.07295],[0.2913,0.0079]]]

Actual:   [[[0.2615, 0.073], [0.2913, 0.0079]]]

Expected: [[[0.2615, 0.073], [0.2913, 0.0079]]]