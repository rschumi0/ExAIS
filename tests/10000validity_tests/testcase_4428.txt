import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea59837 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con18751 = tf.keras.layers.Input(shape=([4, 2]))
in0Con4108 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con88103 = tf.keras.layers.Input(shape=([1, 2]))
in0Min73868 = tf.keras.layers.Input(shape=([2, 2]))
in1Min73868 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul16476 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Mul16476 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Lea59837 = keras.layers.LeakyReLU(alpha=6.131718960148621, name = 'Lea59837', input_shape=(2, 1, 2))(in0Lea59837)
ReL24419 = keras.layers.ReLU(max_value=1.4665688633555591, negative_slope=6.5085154289027605, threshold=4.538712279476322, name = 'ReL24419', )(Lea59837)
Res14258 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res14258', )(ReL24419)
Up_37087 = keras.layers.UpSampling3D(size=(2, 1, 1), name = 'Up_37087', )(Res14258)
Res40589 = keras.layers.Reshape((4, 1, 2), name = 'Res40589', )(Up_37087)
Res36308 = keras.layers.Reshape((4, 2), name = 'Res36308', )(Res40589)
Con18751 = keras.layers.Concatenate(axis=2, name = 'Con18751', )([Res36308,in0Con18751])
Con4108 = keras.layers.Conv2D(2, (2, 2),strides=(1, 2), padding='valid', dilation_rate=(1, 1), name = 'Con4108', )(in0Con4108)
Res28647 = keras.layers.Reshape((1, 2), name = 'Res28647', )(Con4108)
Con88103 = keras.layers.Concatenate(axis=2, name = 'Con88103', )([Res28647,in0Con88103])
Min73868 = keras.layers.Minimum(name = 'Min73868', )([in0Min73868,in1Min73868])
Res17235 = keras.layers.Reshape((2, 2, 1), name = 'Res17235', )(Min73868)
Mul16476 = keras.layers.Multiply(name = 'Mul16476', )([in0Mul16476,in1Mul16476])
Res43249 = keras.layers.Reshape((2, 2, 1), name = 'Res43249', )(Mul16476)
Add7016 = keras.layers.Add(name = 'Add7016', )([Res17235,Res43249])
Res27750 = keras.layers.Reshape((2, 2), name = 'Res27750', )(Add7016)
Sep21957 = keras.layers.SeparableConv1D(4, (1),strides=(2), padding='same', name = 'Sep21957', )(Res27750)
Mul59778 = keras.layers.Multiply(name = 'Mul59778', )([Con88103,Sep21957])
Zer31168 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer31168', )(Mul59778)
Max84899 = keras.layers.Maximum(name = 'Max84899', )([Con18751,Zer31168])
model = tf.keras.models.Model(inputs=[in0Lea59837,in0Con18751,in0Con4108,in0Con88103,in0Min73868,in1Min73868,in0Mul16476,in1Mul16476], outputs=Max84899)
w = model.get_layer('Con4108').get_weights() 
w[0] = np.array([[[[0.2091, 0.159], [0.7874, 0.2376]], [[0.8264, 0.5009], [0.1701, 0.5033]]], [[[0.672, 0.856], [0.4875, 0.1278]], [[0.3892, 0.2084], [0.782, 0.3285]]]])
w[1] = np.array([0, 0])
model.get_layer('Con4108').set_weights(w) 
w = model.get_layer('Sep21957').get_weights() 
w[0] = np.array([[[0.7643], [0.0622]]])
w[1] = np.array([[[0.4635, 0.9141, 0.1534, 0.5548], [0.6174, 0.4838, 0.0389, 0.8245]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep21957').set_weights(w) 
in0Lea59837 = tf.constant([[[[0.1858, 0.5082]], [[0.6558, 0.5269]]]])
in0Con18751 = tf.constant([[[0.1594, 0.6271], [0.3928, 0.2242], [0.8063, 0.3664], [0.8823, 0.5214]]])
in0Con4108 = tf.constant([[[[0.0385, 0.5696], [0.4072, 0.5688]], [[0.7749, 0.6019], [0.1652, 0.2729]]]])
in0Con88103 = tf.constant([[[0.9564, 0.5623]]])
in0Min73868 = tf.constant([[[0.436, 0.3379], [0.8493, 0.571]]])
in1Min73868 = tf.constant([[[0.7298, 0.0103], [0.2147, 0.805]]])
in0Mul16476 = tf.constant([[[[[0.3798, 0.8867]]], [[[0.9496, 0.4627]]]]])
in1Mul16476 = tf.constant([[[[[0.3145, 0.7769]]], [[[0.8744, 0.9454]]]]])
print (np.array2string(model.predict([in0Lea59837,in0Con18751,in0Con4108,in0Con88103,in0Min73868,in1Min73868,in0Mul16476,in1Mul16476],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max84899.png')

LLea59837 = leaky_relu_layer([[[[0.1858, 0.5082]], [[0.6558, 0.5269]]]], 6.131718960148621, Lea59837), 
LReL24419 = relu_layer(Lea59837, 1.4665688633555591, 6.5085154289027605, 4.538712279476322, ReL24419), 
LRes14258 = reshape_layer(ReL24419, [2, 1, 2, 1], Res14258), 
LUp_37087 = up_sampling3D_layer(Res14258, 2, 1, 1, Up_37087), 
LRes40589 = reshape_layer(Up_37087, [4, 1, 2], Res40589), 
LRes36308 = reshape_layer(Res40589, [4, 2], Res36308), 
LCon18751 = concatenate_layer([Res36308,[[[0.1594, 0.6271], [0.3928, 0.2242], [0.8063, 0.3664], [0.8823, 0.5214]]]], 2, Con18751), 
LCon4108 = conv2D_layer([[[[0.0385, 0.5696], [0.4072, 0.5688]], [[0.7749, 0.6019], [0.1652, 0.2729]]]], 2, 2,[[[[0.2091, 0.159], [0.7874, 0.2376]], [[0.8264, 0.5009], [0.1701, 0.5033]]], [[[0.672, 0.856], [0.4875, 0.1278]], [[0.3892, 0.2084], [0.782, 0.3285]]]],[0, 0], 1, 2, false, 1, 1, Con4108), 
LRes28647 = reshape_layer(Con4108, [1, 2], Res28647), 
LCon88103 = concatenate_layer([Res28647,[[[0.9564, 0.5623]]]], 2, Con88103), 
LMin73868 = minimum_layer([[[[0.436, 0.3379], [0.8493, 0.571]]], [[[0.7298, 0.0103], [0.2147, 0.805]]]], Min73868), 
LRes17235 = reshape_layer(Min73868, [2, 2, 1], Res17235), 
LMul16476 = multiply_layer([[[[[[0.3798, 0.8867]]], [[[0.9496, 0.4627]]]]], [[[[[0.3145, 0.7769]]], [[[0.8744, 0.9454]]]]]], Mul16476), 
LRes43249 = reshape_layer(Mul16476, [2, 2, 1], Res43249), 
LAdd7016 = add_layer([Res17235,Res43249], Add7016), 
LRes27750 = reshape_layer(Add7016, [2, 2], Res27750), 
LSep21957 = separable_conv1D_layer(Res27750, 1,[[[[0.7643], [0.0622]]],[[[0.4635, 0.9141, 0.1534, 0.5548], [0.6174, 0.4838, 0.0389, 0.8245]]]],[0, 0, 0, 0], 2, true, Sep21957), 
LMul59778 = multiply_layer([Con88103,Sep21957], Mul59778), 
LZer31168 = zero_padding1D_layer(Mul59778, 3, 0, Zer31168), 
LMax84899 = maximum_layer([Con18751,Zer31168], Max84899), 
exec_layers([LLea59837,LReL24419,LRes14258,LUp_37087,LRes40589,LRes36308,LCon18751,LCon4108,LRes28647,LCon88103,LMin73868,LRes17235,LMul16476,LRes43249,LAdd7016,LRes27750,LSep21957,LMul59778,LZer31168,LMax84899],["Lea59837","ReL24419","Res14258","Up_37087","Res40589","Res36308","Con18751","Con4108","Res28647","Con88103","Min73868","Res17235","Mul16476","Res43249","Add7016","Res27750","Sep21957","Mul59778","Zer31168","Max84899"],Max84899,"Max84899")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.1594000, 0.6271000], [0.0000000, 0.0000000, 0.3928000, 0.2242000], [0.0000000, 0.0000000, 0.8063000, 0.3664000], [0.4431407, 0.6120212, 0.8823000, 0.5214000]]]

Expected (Unparsed): [[[0,0,0.1594,0.6271],[0,0,0.3928,0.2242],[0,0,0.8063,0.3664],[0.4431407464673032,0.612021245890512,0.8823,0.5214]]]

Actual:   [[[0, 0, 0.1594, 0.6271], [0, 0, 0.3928, 0.2242], [0, 0, 0.8063, 0.3664], [0.4432, 0.6121, 0.8823, 0.5214]]]

Expected: [[[0, 0, 0.1594, 0.6271], [0, 0, 0.3928, 0.2242], [0, 0, 0.8063, 0.3664], [0.4432, 0.6121, 0.8823, 0.5214]]]