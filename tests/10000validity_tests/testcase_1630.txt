import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub24075 = tf.keras.layers.Input(shape=([2]))
in1Sub24075 = tf.keras.layers.Input(shape=([2]))
in0Con89598 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot26680 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot26680 = tf.keras.layers.Input(shape=([2, 3]))
in0Max95076 = tf.keras.layers.Input(shape=([2, 1, 1]))

Sub24075 = keras.layers.Subtract(name = 'Sub24075', )([in0Sub24075,in1Sub24075])
Res85344 = keras.layers.Reshape((2, 1), name = 'Res85344', )(Sub24075)
Zer80794 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer80794', )(Res85344)
Con89598 = keras.layers.Concatenate(axis=2, name = 'Con89598', )([Zer80794,in0Con89598])
Dot26680 = keras.layers.Dot(axes=(1, 1), name = 'Dot26680', )([in0Dot26680,in1Dot26680])
Mul37593 = keras.layers.Multiply(name = 'Mul37593', )([Con89598,Dot26680])
Res81412 = keras.layers.Reshape((3, 3, 1), name = 'Res81412', )(Mul37593)
Max95076 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max95076', )(in0Max95076)
Zer47942 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer47942', )(Max95076)
Mul59531 = keras.layers.Multiply(name = 'Mul59531', )([Res81412,Zer47942])
model = tf.keras.models.Model(inputs=[in0Sub24075,in1Sub24075,in0Con89598,in0Dot26680,in1Dot26680,in0Max95076], outputs=Mul59531)
in0Sub24075 = tf.constant([[0.9731, 0.8864]])
in1Sub24075 = tf.constant([[0.6658, 0.6138]])
in0Con89598 = tf.constant([[[0.6431, 0.2567], [0.7878, 0.035], [0.2493, 0.0649]]])
in0Dot26680 = tf.constant([[[0.294, 0.0363, 0.7211], [0.7501, 0.8462, 0.9666]]])
in1Dot26680 = tf.constant([[[0.2284, 0.6696, 0.6633], [0.3554, 0.7496, 0.2719]]])
in0Max95076 = tf.constant([[[[1.7479]], [[1.5182]]]])
print (np.array2string(model.predict([in0Sub24075,in1Sub24075,in0Con89598,in0Dot26680,in1Dot26680,in0Max95076],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul59531.png')

LSub24075 = subtract_layer([[0.9731, 0.8864]], [[0.6658, 0.6138]], Sub24075), 
LRes85344 = reshape_layer(Sub24075, [2, 1], Res85344), 
LZer80794 = zero_padding1D_layer(Res85344, 1, 0, Zer80794), 
LCon89598 = concatenate_layer([Zer80794,[[[0.6431, 0.2567], [0.7878, 0.035], [0.2493, 0.0649]]]], 2, Con89598), 
LDot26680 = dot_layer([[[0.294, 0.0363, 0.7211], [0.7501, 0.8462, 0.9666]]], [[[0.2284, 0.6696, 0.6633], [0.3554, 0.7496, 0.2719]]], 1, 1, Dot26680), 
LMul37593 = multiply_layer([Con89598,Dot26680], Mul37593), 
LRes81412 = reshape_layer(Mul37593, [3, 3, 1], Res81412), 
LMax95076 = max_pool2D_layer([[[[1.7479]], [[1.5182]]]], 1, 1, Max95076), 
LZer47942 = zero_padding2D_layer(Max95076, 1, 0, 2, 0, Zer47942), 
LMul59531 = multiply_layer([Res81412,Zer47942], Mul59531), 
exec_layers([LSub24075,LRes85344,LZer80794,LCon89598,LDot26680,LMul37593,LRes81412,LMax95076,LZer47942,LMul59531],["Sub24075","Res85344","Zer80794","Con89598","Dot26680","Mul37593","Res81412","Max95076","Zer47942","Mul59531"],Mul59531,"Mul59531")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0155486]], [[0.0000000], [0.0000000], [0.0730238]]]]

Expected (Unparsed): [[[[0.0],[0.0],[0.0]],[[0.0],[0.0],[0.015548592934104998]],[[0.0],[0.0],[0.0730238389966206]]]]

Actual:   [[[[0], [0], [0]], [[0], [0], [0.0156]], [[0], [0], [0.0731]]]]

Expected: [[[[0], [0], [0]], [[0], [0], [0.0156]], [[0], [0], [0.0731]]]]