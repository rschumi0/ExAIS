import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min11348 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Min11348 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Dot31859 = tf.keras.layers.Input(shape=([2]))
in1Dot31859 = tf.keras.layers.Input(shape=([2]))
in0Con41946 = tf.keras.layers.Input(shape=([3]))
in0Min95333 = tf.keras.layers.Input(shape=([1, 1]))
in1Min95333 = tf.keras.layers.Input(shape=([1, 1]))
in0Con72754 = tf.keras.layers.Input(shape=([3]))
in0Con89077 = tf.keras.layers.Input(shape=([4, 1, 3]))
in0Sub99202 = tf.keras.layers.Input(shape=([3, 3, 2]))
in1Sub99202 = tf.keras.layers.Input(shape=([3, 3, 2]))

Min11348 = keras.layers.Minimum(name = 'Min11348', )([in0Min11348,in1Min11348])
Res11108 = keras.layers.Reshape((1, 1, 4), name = 'Res11108', )(Min11348)
Res55274 = keras.layers.Reshape((1, 4), name = 'Res55274', )(Res11108)
Fla17974 = keras.layers.Flatten(name = 'Fla17974', )(Res55274)
Dot31859 = keras.layers.Dot(axes=(1, 1), name = 'Dot31859', )([in0Dot31859,in1Dot31859])
Con41946 = keras.layers.Concatenate(axis=1, name = 'Con41946', )([Dot31859,in0Con41946])
Max14795 = keras.layers.Maximum(name = 'Max14795', )([Fla17974,Con41946])
Min95333 = keras.layers.Minimum(name = 'Min95333', )([in0Min95333,in1Min95333])
Glo81211 = keras.layers.GlobalMaxPool1D(name = 'Glo81211', )(Min95333)
Res28899 = keras.layers.Reshape((1, 1), name = 'Res28899', )(Glo81211)
Glo58454 = keras.layers.GlobalAveragePooling1D(name = 'Glo58454', )(Res28899)
Con72754 = keras.layers.Concatenate(axis=1, name = 'Con72754', )([Glo58454,in0Con72754])
Mul75988 = keras.layers.Multiply(name = 'Mul75988', )([Max14795,Con72754])
Res51889 = keras.layers.Reshape((4, 1), name = 'Res51889', )(Mul75988)
Res93989 = keras.layers.Reshape((4, 1, 1), name = 'Res93989', )(Res51889)
Con89077 = keras.layers.Concatenate(axis=3, name = 'Con89077', )([Res93989,in0Con89077])
Sub99202 = keras.layers.Subtract(name = 'Sub99202', )([in0Sub99202,in1Sub99202])
Con48448 = keras.layers.Conv2D(4, (2, 1),strides=(1, 3), padding='same', dilation_rate=(1, 1), name = 'Con48448', )(Sub99202)
Zer58226 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer58226', )(Con48448)
Min83090 = keras.layers.Minimum(name = 'Min83090', )([Con89077,Zer58226])
model = tf.keras.models.Model(inputs=[in0Min11348,in1Min11348,in0Dot31859,in1Dot31859,in0Con41946,in0Min95333,in1Min95333,in0Con72754,in0Con89077,in0Sub99202,in1Sub99202], outputs=Min83090)
w = model.get_layer('Con48448').get_weights() 
w[0] = np.array([[[[0.6074, 0.5271, 0.0619, 0.9751], [0.0278, 0.6955, 0.9008, 0.519]]], [[[0.4345, 0.9398, 0.5527, 0.4314], [0.2356, 0.3399, 0.1385, 0.3905]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con48448').set_weights(w) 
in0Min11348 = tf.constant([[[[[0.6487, 0.3912], [0.339, 0.6918]]]]])
in1Min11348 = tf.constant([[[[[0.7543, 0.4781], [0.1054, 0.7926]]]]])
in0Dot31859 = tf.constant([[0.6738, 0.9814]])
in1Dot31859 = tf.constant([[0.4775, 0.4799]])
in0Con41946 = tf.constant([[0.2483, 0.341, 0.731]])
in0Min95333 = tf.constant([[[0.1722]]])
in1Min95333 = tf.constant([[[0.8154]]])
in0Con72754 = tf.constant([[0.7615, 0.4978, 0.9156]])
in0Con89077 = tf.constant([[[[0.6057, 0.6776, 0.1802]], [[0.0003, 0.594, 0.8303]], [[0.4913, 0.9366, 0.4438]], [[0.4839, 0.6738, 0.8895]]]])
in0Sub99202 = tf.constant([[[[0.1726, 0.6285], [0.9266, 0.66], [0.1981, 0.3319]], [[0.8636, 0.5445], [0.6894, 0.3283], [0.4949, 0.9456]], [[0.0013, 0.3104], [0.0948, 0.2557], [0.585, 0.2584]]]])
in1Sub99202 = tf.constant([[[[0.2905, 0.9579], [0.2343, 0.8708], [0.2656, 0.4841]], [[0.7429, 0.7585], [0.3101, 0.525], [0.8789, 0.3134]], [[0.898, 0.5114], [0.8538, 0.069], [0.8166, 0.0926]]]])
print (np.array2string(model.predict([in0Min11348,in1Min11348,in0Dot31859,in1Dot31859,in0Con41946,in0Min95333,in1Min95333,in0Con72754,in0Con89077,in0Sub99202,in1Sub99202],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min83090.png')

LMin11348 = minimum_layer([[[[[[0.6487, 0.3912], [0.339, 0.6918]]]]], [[[[[0.7543, 0.4781], [0.1054, 0.7926]]]]]], Min11348), 
LRes11108 = reshape_layer(Min11348, [1, 1, 4], Res11108), 
LRes55274 = reshape_layer(Res11108, [1, 4], Res55274), 
LFla17974 = flatten_layer(Res55274, Fla17974), 
LDot31859 = dot_layer([[0.6738, 0.9814]], [[0.4775, 0.4799]], 1, 1, Dot31859), 
LCon41946 = concatenate_layer([Dot31859,[[0.2483, 0.341, 0.731]]], 1, Con41946), 
LMax14795 = maximum_layer([Fla17974,Con41946], Max14795), 
LMin95333 = minimum_layer([[[[0.1722]]], [[[0.8154]]]], Min95333), 
LGlo81211 = global_max_pool1D_layer(Min95333, Glo81211), 
LRes28899 = reshape_layer(Glo81211, [1, 1], Res28899), 
LGlo58454 = global_average_pooling1D_layer(Res28899, Glo58454), 
LCon72754 = concatenate_layer([Glo58454,[[0.7615, 0.4978, 0.9156]]], 1, Con72754), 
LMul75988 = multiply_layer([Max14795,Con72754], Mul75988), 
LRes51889 = reshape_layer(Mul75988, [4, 1], Res51889), 
LRes93989 = reshape_layer(Res51889, [4, 1, 1], Res93989), 
LCon89077 = concatenate_layer([Res93989,[[[[0.6057, 0.6776, 0.1802]], [[0.0003, 0.594, 0.8303]], [[0.4913, 0.9366, 0.4438]], [[0.4839, 0.6738, 0.8895]]]]], 3, Con89077), 
LSub99202 = subtract_layer([[[[0.1726, 0.6285], [0.9266, 0.66], [0.1981, 0.3319]], [[0.8636, 0.5445], [0.6894, 0.3283], [0.4949, 0.9456]], [[0.0013, 0.3104], [0.0948, 0.2557], [0.585, 0.2584]]]], [[[[0.2905, 0.9579], [0.2343, 0.8708], [0.2656, 0.4841]], [[0.7429, 0.7585], [0.3101, 0.525], [0.8789, 0.3134]], [[0.898, 0.5114], [0.8538, 0.069], [0.8166, 0.0926]]]], Sub99202), 
LCon48448 = conv2D_layer(Sub99202, 2, 1,[[[[0.6074, 0.5271, 0.0619, 0.9751], [0.0278, 0.6955, 0.9008, 0.519]]], [[[0.4345, 0.9398, 0.5527, 0.4314], [0.2356, 0.3399, 0.1385, 0.3905]]]],[0, 0, 0, 0], 1, 3, true, 1, 1, Con48448), 
LZer58226 = zero_padding2D_layer(Con48448, 1, 0, 0, 0, Zer58226), 
LMin83090 = minimum_layer([Con89077,Zer58226], Min83090), 
exec_layers([LMin11348,LRes11108,LRes55274,LFla17974,LDot31859,LCon41946,LMax14795,LMin95333,LGlo81211,LRes28899,LGlo58454,LCon72754,LMul75988,LRes51889,LRes93989,LCon89077,LSub99202,LCon48448,LZer58226,LMin83090],["Min11348","Res11108","Res55274","Fla17974","Dot31859","Con41946","Max14795","Min95333","Glo81211","Res28899","Glo58454","Con72754","Mul75988","Res51889","Res93989","Con89077","Sub99202","Con48448","Zer58226","Min83090"],Min83090,"Min83090")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[-0.0787440, -0.2505475, -0.2669496, -0.3174199]], [[-0.3696078, -0.9962546, -0.7087444, -0.4586983]], [[-0.5502434, -0.6124461, -0.2365665, -0.9786912]]]]

Expected (Unparsed): [[[[0,0,0,0]],[[-0.07874402999999996,-0.25054752999999996,-0.26694964,-0.31741990999999997]],[[-0.36960776999999995,-0.99625459,-0.70874446,-0.45869831000000005]],[[-0.5502433800000001,-0.6124460700000001,-0.23656652999999997,-0.9786911699999999]]]]

Actual:   [[[[0, 0, 0, 0]], [[-0.0787, -0.2505, -0.2669, -0.3174]], [[-0.3696, -0.9962, -0.7087, -0.4586]], [[-0.5502, -0.6124, -0.2365, -0.9786]]]]

Expected: [[[[0, 0, 0, 0]], [[-0.0787, -0.2505, -0.2669, -0.3174]], [[-0.3696, -0.9962, -0.7087, -0.4586]], [[-0.5502, -0.6124, -0.2365, -0.9786]]]]