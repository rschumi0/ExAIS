import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub61451 = tf.keras.layers.Input(shape=([2]))
in1Sub61451 = tf.keras.layers.Input(shape=([2]))
in0Con37895 = tf.keras.layers.Input(shape=([2, 1]))
in0Min62941 = tf.keras.layers.Input(shape=([2, 2]))
in1Min62941 = tf.keras.layers.Input(shape=([2, 2]))

Sub61451 = keras.layers.Subtract(name = 'Sub61451', )([in0Sub61451,in1Sub61451])
Res22372 = keras.layers.Reshape((2, 1), name = 'Res22372', )(Sub61451)
Con37895 = keras.layers.Concatenate(axis=2, name = 'Con37895', )([Res22372,in0Con37895])
Min62941 = keras.layers.Minimum(name = 'Min62941', )([in0Min62941,in1Min62941])
Ave98682 = keras.layers.Average(name = 'Ave98682', )([Con37895,Min62941])
model = tf.keras.models.Model(inputs=[in0Sub61451,in1Sub61451,in0Con37895,in0Min62941,in1Min62941], outputs=Ave98682)
in0Sub61451 = tf.constant([[0.2809, 0.4791]])
in1Sub61451 = tf.constant([[0.6486, 0.6364]])
in0Con37895 = tf.constant([[[0.373], [0.4867]]])
in0Min62941 = tf.constant([[[0.6123, 0.6115], [0.4378, 0.026]]])
in1Min62941 = tf.constant([[[0.8405, 0.8289], [0.8215, 0.4134]]])
print (np.array2string(model.predict([in0Sub61451,in1Sub61451,in0Con37895,in0Min62941,in1Min62941],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave98682.png')

LSub61451 = subtract_layer([[0.2809, 0.4791]], [[0.6486, 0.6364]], Sub61451), 
LRes22372 = reshape_layer(Sub61451, [2, 1], Res22372), 
LCon37895 = concatenate_layer([Res22372,[[[0.373], [0.4867]]]], 2, Con37895), 
LMin62941 = minimum_layer([[[[0.6123, 0.6115], [0.4378, 0.026]]], [[[0.8405, 0.8289], [0.8215, 0.4134]]]], Min62941), 
LAve98682 = average_layer([Con37895,Min62941], Ave98682), 
exec_layers([LSub61451,LRes22372,LCon37895,LMin62941,LAve98682],["Sub61451","Res22372","Con37895","Min62941","Ave98682"],Ave98682,"Ave98682")

Actual (Unparsed): [[[0.1223000, 0.4922500], [0.1402500, 0.2563500]]]

Expected (Unparsed): [[[0.12229999999999999,0.49225],[0.14025000000000004,0.25635]]]

Actual:   [[[0.1223, 0.4923], [0.1403, 0.2564]]]

Expected: [[[0.1223, 0.4923], [0.1403, 0.2564]]]