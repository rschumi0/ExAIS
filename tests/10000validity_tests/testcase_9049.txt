import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave59407 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave59407 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con91242 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Mul34671 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul34671 = tf.keras.layers.Input(shape=([1, 2, 2]))

Ave59407 = keras.layers.Average(name = 'Ave59407', )([in0Ave59407,in1Ave59407])
Res25812 = keras.layers.Reshape((1, 2), name = 'Res25812', )(Ave59407)
Glo92121 = keras.layers.GlobalAveragePooling1D(name = 'Glo92121', )(Res25812)
Res59319 = keras.layers.Reshape((2, 1), name = 'Res59319', )(Glo92121)
Res59885 = keras.layers.Reshape((2, 1, 1), name = 'Res59885', )(Res59319)
Zer13923 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer13923', )(Res59885)
Con91242 = keras.layers.Concatenate(axis=3, name = 'Con91242', )([Zer13923,in0Con91242])
Mul34671 = keras.layers.Multiply(name = 'Mul34671', )([in0Mul34671,in1Mul34671])
Zer90191 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer90191', )(Mul34671)
Max14736 = keras.layers.Maximum(name = 'Max14736', )([Con91242,Zer90191])
model = tf.keras.models.Model(inputs=[in0Ave59407,in1Ave59407,in0Con91242,in0Mul34671,in1Mul34671], outputs=Max14736)
in0Ave59407 = tf.constant([[[[0.1297], [0.0998]]]])
in1Ave59407 = tf.constant([[[[0.2558], [0.9979]]]])
in0Con91242 = tf.constant([[[[0.2789], [0.6522], [0.7972]], [[0.6565], [0.4563], [0.2378]]]])
in0Mul34671 = tf.constant([[[[0.9098, 0.6181], [0.7975, 0.618]]]])
in1Mul34671 = tf.constant([[[[0.487, 0.8124], [0.7705, 0.651]]]])
print (np.array2string(model.predict([in0Ave59407,in1Ave59407,in0Con91242,in0Mul34671,in1Mul34671],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max14736.png')

LAve59407 = average_layer([[[[[0.1297], [0.0998]]]], [[[[0.2558], [0.9979]]]]], Ave59407), 
LRes25812 = reshape_layer(Ave59407, [1, 2], Res25812), 
LGlo92121 = global_average_pooling1D_layer(Res25812, Glo92121), 
LRes59319 = reshape_layer(Glo92121, [2, 1], Res59319), 
LRes59885 = reshape_layer(Res59319, [2, 1, 1], Res59885), 
LZer13923 = zero_padding2D_layer(Res59885, 0, 0, 2, 0, Zer13923), 
LCon91242 = concatenate_layer([Zer13923,[[[[0.2789], [0.6522], [0.7972]], [[0.6565], [0.4563], [0.2378]]]]], 3, Con91242), 
LMul34671 = multiply_layer([[[[[0.9098, 0.6181], [0.7975, 0.618]]]], [[[[0.487, 0.8124], [0.7705, 0.651]]]]], Mul34671), 
LZer90191 = zero_padding2D_layer(Mul34671, 1, 0, 1, 0, Zer90191), 
LMax14736 = maximum_layer([Con91242,Zer90191], Max14736), 
exec_layers([LAve59407,LRes25812,LGlo92121,LRes59319,LRes59885,LZer13923,LCon91242,LMul34671,LZer90191,LMax14736],["Ave59407","Res25812","Glo92121","Res59319","Res59885","Zer13923","Con91242","Mul34671","Zer90191","Max14736"],Max14736,"Max14736")

Actual (Unparsed): [[[[0.0000000, 0.2789000], [0.0000000, 0.6522000], [0.1927500, 0.7972000]], [[0.0000000, 0.6565000], [0.4430726, 0.5021444], [0.6144738, 0.4023180]]]]

Expected (Unparsed): [[[[0,0.2789],[0,0.6522],[0.19275000000000003,0.7972]],[[0,0.6565],[0.44307260000000004,0.50214444],[0.6144737499999999,0.402318]]]]

Actual:   [[[[0, 0.2789], [0, 0.6522], [0.1928, 0.7972]], [[0, 0.6565], [0.4431, 0.5022], [0.6145, 0.4024]]]]

Expected: [[[[0, 0.2789], [0, 0.6522], [0.1928, 0.7972]], [[0, 0.6565], [0.4431, 0.5022], [0.6145, 0.4024]]]]