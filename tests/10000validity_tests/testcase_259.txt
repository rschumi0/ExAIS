import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe93896 = tf.keras.layers.Input(shape=([1, 2]))
in0Con28126 = tf.keras.layers.Input(shape=([1]))
in0Max95675 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Max95675 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Sub48138 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub48138 = tf.keras.layers.Input(shape=([2, 2]))
in0Con17665 = tf.keras.layers.Input(shape=([1]))

PRe93896 = keras.layers.PReLU(name = 'PRe93896', input_shape=(1, 2))(in0PRe93896)
Cro61334 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro61334', )(PRe93896)
Res39310 = keras.layers.Reshape((1, 2, 1), name = 'Res39310', )(Cro61334)
Res42671 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res42671', )(Res39310)
Glo17890 = keras.layers.GlobalAveragePooling3D(name = 'Glo17890', )(Res42671)
Con28126 = keras.layers.Concatenate(axis=1, name = 'Con28126', )([Glo17890,in0Con28126])
Max95675 = keras.layers.Maximum(name = 'Max95675', )([in0Max95675,in1Max95675])
Res86768 = keras.layers.Reshape((1, 2, 1), name = 'Res86768', )(Max95675)
Res94726 = keras.layers.Reshape((1, 2), name = 'Res94726', )(Res86768)
Fla30198 = keras.layers.Flatten(name = 'Fla30198', )(Res94726)
Sub48138 = keras.layers.Subtract(name = 'Sub48138', )([in0Sub48138,in1Sub48138])
Res43351 = keras.layers.Reshape((2, 2, 1), name = 'Res43351', )(Sub48138)
Glo15602 = keras.layers.GlobalMaxPool2D(name = 'Glo15602', )(Res43351)
Con17665 = keras.layers.Concatenate(axis=1, name = 'Con17665', )([Glo15602,in0Con17665])
Sub25334 = keras.layers.Subtract(name = 'Sub25334', )([Fla30198,Con17665])
Sub81681 = keras.layers.Subtract(name = 'Sub81681', )([Con28126,Sub25334])
model = tf.keras.models.Model(inputs=[in0PRe93896,in0Con28126,in0Max95675,in1Max95675,in0Sub48138,in1Sub48138,in0Con17665], outputs=Sub81681)
w = model.get_layer('PRe93896').get_weights() 
w[0] = np.array([[0.2185, 0.2565]])
model.get_layer('PRe93896').set_weights(w) 
in0PRe93896 = tf.constant([[[0.9113, 0.9776]]])
in0Con28126 = tf.constant([[0.977]])
in0Max95675 = tf.constant([[[[[0.8029]], [[0.1401]]]]])
in1Max95675 = tf.constant([[[[[0.3454]], [[0.5136]]]]])
in0Sub48138 = tf.constant([[[0.9642, 0.0256], [0.8095, 0.3254]]])
in1Sub48138 = tf.constant([[[0.1204, 0.0136], [0.9178, 0.445]]])
in0Con17665 = tf.constant([[0.2782]])
print (np.array2string(model.predict([in0PRe93896,in0Con28126,in0Max95675,in1Max95675,in0Sub48138,in1Sub48138,in0Con17665],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub81681.png')

LPRe93896 = prelu_layer([[[0.9113, 0.9776]]], [[0.2185, 0.2565]], PRe93896), 
LCro61334 = cropping1D_layer(PRe93896, 0, 0, Cro61334), 
LRes39310 = reshape_layer(Cro61334, [1, 2, 1], Res39310), 
LRes42671 = reshape_layer(Res39310, [1, 2, 1, 1], Res42671), 
LGlo17890 = global_average_pooling3D_layer(Res42671, Glo17890), 
LCon28126 = concatenate_layer([Glo17890,[[0.977]]], 1, Con28126), 
LMax95675 = maximum_layer([[[[[[0.8029]], [[0.1401]]]]], [[[[[0.3454]], [[0.5136]]]]]], Max95675), 
LRes86768 = reshape_layer(Max95675, [1, 2, 1], Res86768), 
LRes94726 = reshape_layer(Res86768, [1, 2], Res94726), 
LFla30198 = flatten_layer(Res94726, Fla30198), 
LSub48138 = subtract_layer([[[0.9642, 0.0256], [0.8095, 0.3254]]], [[[0.1204, 0.0136], [0.9178, 0.445]]], Sub48138), 
LRes43351 = reshape_layer(Sub48138, [2, 2, 1], Res43351), 
LGlo15602 = global_max_pool2D_layer(Res43351, Glo15602), 
LCon17665 = concatenate_layer([Glo15602,[[0.2782]]], 1, Con17665), 
LSub25334 = subtract_layer(Fla30198,Con17665, Sub25334), 
LSub81681 = subtract_layer(Con28126,Sub25334, Sub81681), 
exec_layers([LPRe93896,LCro61334,LRes39310,LRes42671,LGlo17890,LCon28126,LMax95675,LRes86768,LRes94726,LFla30198,LSub48138,LRes43351,LGlo15602,LCon17665,LSub25334,LSub81681],["PRe93896","Cro61334","Res39310","Res42671","Glo17890","Con28126","Max95675","Res86768","Res94726","Fla30198","Sub48138","Res43351","Glo15602","Con17665","Sub25334","Sub81681"],Sub81681,"Sub81681")

Actual (Unparsed): [[0.9853500, 0.7416000]]

Expected (Unparsed): [[0.9853500000000001,0.7416]]

Actual:   [[0.9854, 0.7416]]

Expected: [[0.9854, 0.7416]]