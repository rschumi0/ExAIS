import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min42715 = tf.keras.layers.Input(shape=([1, 2]))
in1Min42715 = tf.keras.layers.Input(shape=([1, 2]))
in0Add46061 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Add46061 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Add84152 = tf.keras.layers.Input(shape=([1, 2]))
in1Add84152 = tf.keras.layers.Input(shape=([1, 2]))
in0Con26819 = tf.keras.layers.Input(shape=([1]))

Min42715 = keras.layers.Minimum(name = 'Min42715', )([in0Min42715,in1Min42715])
Res36041 = keras.layers.Reshape((1, 2, 1), name = 'Res36041', )(Min42715)
Add46061 = keras.layers.Add(name = 'Add46061', )([in0Add46061,in1Add46061])
Sof36438 = keras.layers.Softmax(axis=1, name = 'Sof36438', )(Add46061)
Res86883 = keras.layers.Reshape((1, 2, 1), name = 'Res86883', )(Sof36438)
Min99979 = keras.layers.Minimum(name = 'Min99979', )([Res36041,Res86883])
Res81597 = keras.layers.Reshape((1, 2), name = 'Res81597', )(Min99979)
Fla26180 = keras.layers.Flatten(name = 'Fla26180', )(Res81597)
Add84152 = keras.layers.Add(name = 'Add84152', )([in0Add84152,in1Add84152])
Res54175 = keras.layers.Reshape((1, 2, 1), name = 'Res54175', )(Add84152)
Glo39664 = keras.layers.GlobalAveragePooling2D(name = 'Glo39664', )(Res54175)
Con26819 = keras.layers.Concatenate(axis=1, name = 'Con26819', )([Glo39664,in0Con26819])
Ave58082 = keras.layers.Average(name = 'Ave58082', )([Fla26180,Con26819])
model = tf.keras.models.Model(inputs=[in0Min42715,in1Min42715,in0Add46061,in1Add46061,in0Add84152,in1Add84152,in0Con26819], outputs=Ave58082)
in0Min42715 = tf.constant([[[0.9515, 0.7864]]])
in1Min42715 = tf.constant([[[0.6772, 0.5253]]])
in0Add46061 = tf.constant([[[[[0.0053], [0.3535]]]]])
in1Add46061 = tf.constant([[[[[0.7206], [0.064]]]]])
in0Add84152 = tf.constant([[[0.2912, 0.4024]]])
in1Add84152 = tf.constant([[[0.4289, 0.7889]]])
in0Con26819 = tf.constant([[0.6187]])
print (np.array2string(model.predict([in0Min42715,in1Min42715,in0Add46061,in1Add46061,in0Add84152,in1Add84152,in0Con26819],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave58082.png')

LMin42715 = minimum_layer([[[[0.9515, 0.7864]]], [[[0.6772, 0.5253]]]], Min42715), 
LRes36041 = reshape_layer(Min42715, [1, 2, 1], Res36041), 
LAdd46061 = add_layer([[[[[[0.0053], [0.3535]]]]], [[[[[0.7206], [0.064]]]]]], Add46061), 
LSof36438 = softmax_layer(Add46061, 1, Sof36438), 
LRes86883 = reshape_layer(Sof36438, [1, 2, 1], Res86883), 
LMin99979 = minimum_layer([Res36041,Res86883], Min99979), 
LRes81597 = reshape_layer(Min99979, [1, 2], Res81597), 
LFla26180 = flatten_layer(Res81597, Fla26180), 
LAdd84152 = add_layer([[[[0.2912, 0.4024]]], [[[0.4289, 0.7889]]]], Add84152), 
LRes54175 = reshape_layer(Add84152, [1, 2, 1], Res54175), 
LGlo39664 = global_average_pooling2D_layer(Res54175, Glo39664), 
LCon26819 = concatenate_layer([Glo39664,[[0.6187]]], 1, Con26819), 
LAve58082 = average_layer([Fla26180,Con26819], Ave58082), 
exec_layers([LMin42715,LRes36041,LAdd46061,LSof36438,LRes86883,LMin99979,LRes81597,LFla26180,LAdd84152,LRes54175,LGlo39664,LCon26819,LAve58082],["Min42715","Res36041","Add46061","Sof36438","Res86883","Min99979","Res81597","Fla26180","Add84152","Res54175","Glo39664","Con26819","Ave58082"],Ave58082,"Ave58082")

Actual (Unparsed): [[0.8164500, 0.5720000]]

Expected (Unparsed): [[0.81645,0.5720000000000001]]

Actual:   [[0.8165, 0.572]]

Expected: [[0.8165, 0.5721]]