import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo14846 = tf.keras.layers.Input(shape=([1, 1]))
in0LST8803 = tf.keras.layers.Input(shape=([1, 2]))

Glo14846 = keras.layers.GlobalAveragePooling1D(name = 'Glo14846', )(in0Glo14846)
Res35284 = keras.layers.Reshape((1, 1), name = 'Res35284', )(Glo14846)
Cro86522 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro86522', )(Res35284)
Up_18325 = keras.layers.UpSampling1D(size=(2), name = 'Up_18325', )(Cro86522)
Res79908 = keras.layers.Reshape((2, 1, 1), name = 'Res79908', )(Up_18325)
Zer13274 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer13274', )(Res79908)
LST8803 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST8803', )(in0LST8803)
Res8729 = keras.layers.Reshape((1, 1), name = 'Res8729', )(LST8803)
Res68755 = keras.layers.Reshape((1, 1, 1), name = 'Res68755', )(Res8729)
Zer45542 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer45542', )(Res68755)
Sub42931 = keras.layers.Subtract(name = 'Sub42931', )([Zer13274,Zer45542])
model = tf.keras.models.Model(inputs=[in0Glo14846,in0LST8803], outputs=Sub42931)
w = model.get_layer('LST8803').get_weights() 
w[0] = np.array([[8, 10, 1, 8], [1, 5, 8, 9]])
w[1] = np.array([[8, 5, 2, 2]])
w[2] = np.array([10, 3, 6, 10])
model.get_layer('LST8803').set_weights(w) 
in0Glo14846 = tf.constant([[[1.129]]])
in0LST8803 = tf.constant([[[4, 10]]])
print (np.array2string(model.predict([in0Glo14846,in0LST8803],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub42931.png')

LGlo14846 = global_average_pooling1D_layer([[[1.129]]], Glo14846), 
LRes35284 = reshape_layer(Glo14846, [1, 1], Res35284), 
LCro86522 = cropping1D_layer(Res35284, 0, 0, Cro86522), 
LUp_18325 = up_sampling1D_layer(Cro86522, 2, Up_18325), 
LRes79908 = reshape_layer(Up_18325, [2, 1, 1], Res79908), 
LZer13274 = zero_padding2D_layer(Res79908, 1, 0, 2, 0, Zer13274), 
LLST8803 = lstm_layer([[[4, 10]]],[[8, 10, 1, 8], [1, 5, 8, 9]],[[8, 5, 2, 2]],[10, 3, 6, 10], LST8803), 
LRes8729 = reshape_layer(LST8803, [1, 1], Res8729), 
LRes68755 = reshape_layer(Res8729, [1, 1, 1], Res68755), 
LZer45542 = zero_padding2D_layer(Res68755, 1, 1, 1, 1, Zer45542), 
LSub42931 = subtract_layer(Zer13274,Zer45542, Sub42931), 
exec_layers([LGlo14846,LRes35284,LCro86522,LUp_18325,LRes79908,LZer13274,LLST8803,LRes8729,LRes68755,LZer45542,LSub42931],["Glo14846","Res35284","Cro86522","Up_18325","Res79908","Zer13274","LST8803","Res8729","Res68755","Zer45542","Sub42931"],Sub42931,"Sub42931")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.7615942], [1.1289999]], [[0.0000000], [0.0000000], [1.1289999]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[-0.7615941559557649],[1.129]],[[0],[0],[1.129]]]]

Actual:   [[[[0], [0], [0]], [[0], [-0.7615], [1.129]], [[0], [0], [1.129]]]]

Expected: [[[[0], [0], [0]], [[0], [-0.7615], [1.129]], [[0], [0], [1.129]]]]