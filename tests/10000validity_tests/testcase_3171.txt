import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub9471 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub9471 = tf.keras.layers.Input(shape=([2, 2]))
in0Con86866 = tf.keras.layers.Input(shape=([2, 6]))
in0Con60546 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Sub9471 = keras.layers.Subtract(name = 'Sub9471', )([in0Sub9471,in1Sub9471])
Con86866 = keras.layers.Concatenate(axis=2, name = 'Con86866', )([Sub9471,in0Con86866])
Con60546 = keras.layers.Conv3D(4, (1, 1, 2),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con60546', )(in0Con60546)
Res68933 = keras.layers.Reshape((1, 1, 8), name = 'Res68933', )(Con60546)
Cro67347 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro67347', )(Res68933)
ELU18310 = keras.layers.ELU(alpha=2.9960254153718964, name = 'ELU18310', )(Cro67347)
Res80361 = keras.layers.Reshape((1, 8), name = 'Res80361', )(ELU18310)
Dot62751 = keras.layers.Dot(axes=(2, 2), name = 'Dot62751', )([Con86866,Res80361])
model = tf.keras.models.Model(inputs=[in0Sub9471,in1Sub9471,in0Con86866,in0Con60546], outputs=Dot62751)
w = model.get_layer('Con60546').get_weights() 
w[0] = np.array([[[[[0.2817, 0.6486, 0.8499, 0.78], [0.8194, 0.9914, 0.9726, 0.4259]], [[0.491, 0.6532, 0.5962, 0.4747], [0.9795, 0.0623, 0.603, 0.9706]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con60546').set_weights(w) 
in0Sub9471 = tf.constant([[[0.5604, 0.0672], [0.9095, 0.6574]]])
in1Sub9471 = tf.constant([[[0.0782, 0.9128], [0.358, 0.0298]]])
in0Con86866 = tf.constant([[[0.7047, 0.0856, 0.0717, 0.4292, 0.6675, 0.8344], [0.6723, 0.0393, 0.9657, 0.8599, 0.9185, 0.1552]]])
in0Con60546 = tf.constant([[[[[0.841, 0.5055], [0.8179, 0.7083]]]]])
print (np.array2string(model.predict([in0Sub9471,in1Sub9471,in0Con86866,in0Con60546],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot62751.png')

LSub9471 = subtract_layer([[[0.5604, 0.0672], [0.9095, 0.6574]]], [[[0.0782, 0.9128], [0.358, 0.0298]]], Sub9471), 
LCon86866 = concatenate_layer([Sub9471,[[[0.7047, 0.0856, 0.0717, 0.4292, 0.6675, 0.8344], [0.6723, 0.0393, 0.9657, 0.8599, 0.9185, 0.1552]]]], 2, Con86866), 
LCon60546 = conv3D_layer([[[[[0.841, 0.5055], [0.8179, 0.7083]]]]], 1, 1, 2,[[[[[0.2817, 0.6486, 0.8499, 0.78], [0.8194, 0.9914, 0.9726, 0.4259]], [[0.491, 0.6532, 0.5962, 0.4747], [0.9795, 0.0623, 0.603, 0.9706]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con60546), 
LRes68933 = reshape_layer(Con60546, [1, 1, 8], Res68933), 
LCro67347 = cropping2D_layer(Res68933, 0, 0, 0, 0, Cro67347), 
LELU18310 = elu_layer(Cro67347, 2.9960254153718964, ELU18310), 
LRes80361 = reshape_layer(ELU18310, [1, 8], Res80361), 
LDot62751 = dot_layer(Con86866,Res80361, 2, 2, Dot62751), 
exec_layers([LSub9471,LCon86866,LCon60546,LRes68933,LCro67347,LELU18310,LRes80361,LDot62751],["Sub9471","Con86866","Con60546","Res68933","Cro67347","ELU18310","Res80361","Dot62751"],Dot62751,"Dot62751")

Actual (Unparsed): [[[3.4245601], [6.7456362]]]

Expected (Unparsed): [[[3.424560091],[6.745636216277]]]

Actual:   [[[3.4246], [6.7457]]]

Expected: [[[3.4246], [6.7457]]]