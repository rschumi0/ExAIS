import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul47177 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul47177 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Loc25775 = tf.keras.layers.Input(shape=([1, 1]))
in0Con73960 = tf.keras.layers.Input(shape=([2, 1]))

Mul47177 = keras.layers.Multiply(name = 'Mul47177', )([in0Mul47177,in1Mul47177])
Res96999 = keras.layers.Reshape((2, 4), name = 'Res96999', )(Mul47177)
Loc25775 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc25775', )(in0Loc25775)
Zer82250 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer82250', )(Loc25775)
Con73960 = keras.layers.Concatenate(axis=2, name = 'Con73960', )([Zer82250,in0Con73960])
Max57832 = keras.layers.Maximum(name = 'Max57832', )([Res96999,Con73960])
model = tf.keras.models.Model(inputs=[in0Mul47177,in1Mul47177,in0Loc25775,in0Con73960], outputs=Max57832)
w = model.get_layer('Loc25775').get_weights() 
w[0] = np.array([[[0.7162, 0.8008, 0.19]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc25775').set_weights(w) 
in0Mul47177 = tf.constant([[[[0.1371, 0.8577], [0.2857, 0.2673]], [[0.5031, 0.627], [0.2962, 0.6615]]]])
in1Mul47177 = tf.constant([[[[0.1682, 0.1695], [0.7191, 0.2307]], [[0.4631, 0.2564], [0.3187, 0.688]]]])
in0Loc25775 = tf.constant([[[0.6477]]])
in0Con73960 = tf.constant([[[0.6933], [0.8307]]])
print (np.array2string(model.predict([in0Mul47177,in1Mul47177,in0Loc25775,in0Con73960],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max57832.png')

LMul47177 = multiply_layer([[[[[0.1371, 0.8577], [0.2857, 0.2673]], [[0.5031, 0.627], [0.2962, 0.6615]]]], [[[[0.1682, 0.1695], [0.7191, 0.2307]], [[0.4631, 0.2564], [0.3187, 0.688]]]]], Mul47177), 
LRes96999 = reshape_layer(Mul47177, [2, 4], Res96999), 
LLoc25775 = locally_connected1D_layer([[[0.6477]]], 1,[[[0.7162, 0.8008, 0.19]]],[[0, 0, 0]], 1, Loc25775), 
LZer82250 = zero_padding1D_layer(Loc25775, 1, 0, Zer82250), 
LCon73960 = concatenate_layer([Zer82250,[[[0.6933], [0.8307]]]], 2, Con73960), 
LMax57832 = maximum_layer([Res96999,Con73960], Max57832), 
exec_layers([LMul47177,LRes96999,LLoc25775,LZer82250,LCon73960,LMax57832],["Mul47177","Res96999","Loc25775","Zer82250","Con73960","Max57832"],Max57832,"Max57832")

Actual (Unparsed): [[[0.0230602, 0.1453801, 0.2054469, 0.6933000], [0.4638827, 0.5186782, 0.1230630, 0.8307000]]]

Expected (Unparsed): [[[0.02306022,0.14538015,0.20544687,0.6933],[0.46388274,0.51867816,0.123063,0.8307]]]

Actual:   [[[0.0231, 0.1454, 0.2055, 0.6933], [0.4639, 0.5187, 0.1231, 0.8307]]]

Expected: [[[0.0231, 0.1454, 0.2055, 0.6933], [0.4639, 0.5187, 0.1231, 0.8307]]]