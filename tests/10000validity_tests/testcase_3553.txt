import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub59918 = tf.keras.layers.Input(shape=([3]))
in1Sub59918 = tf.keras.layers.Input(shape=([3]))

Sub59918 = keras.layers.Subtract(name = 'Sub59918', )([in0Sub59918,in1Sub59918])
Res3943 = keras.layers.Reshape((3, 1), name = 'Res3943', )(Sub59918)
GRU96376 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU96376', )(Res3943)
Res68240 = keras.layers.Reshape((2, 1), name = 'Res68240', )(GRU96376)
Res47941 = keras.layers.Reshape((2, 1, 1), name = 'Res47941', )(Res68240)
Res87576 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res87576', )(Res47941)
Zer37195 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer37195', )(Res87576)
model = tf.keras.models.Model(inputs=[in0Sub59918,in1Sub59918], outputs=Zer37195)
w = model.get_layer('GRU96376').get_weights() 
w[0] = np.array([[4, 5, 1, 6, 2, 3]])
w[1] = np.array([[9, 2, 4, 7, 8, 6], [4, 6, 7, 9, 2, 10]])
w[2] = np.array([6, 8, 8, 9, 6, 1])
model.get_layer('GRU96376').set_weights(w) 
in0Sub59918 = tf.constant([[0.6362, 0.1624, 0.3454]])
in1Sub59918 = tf.constant([[0.6143, 0.8106, 0.811]])
print (np.array2string(model.predict([in0Sub59918,in1Sub59918],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer37195.png')

LSub59918 = subtract_layer([[0.6362, 0.1624, 0.3454]], [[0.6143, 0.8106, 0.811]], Sub59918), 
LRes3943 = reshape_layer(Sub59918, [3, 1], Res3943), 
LGRU96376 = gru_layer(Res3943,[[4, 5, 1, 6, 2, 3]],[[9, 2, 4, 7, 8, 6], [4, 6, 7, 9, 2, 10]],[6, 8, 8, 9, 6, 1], false, GRU96376), 
LRes68240 = reshape_layer(GRU96376, [2, 1], Res68240), 
LRes47941 = reshape_layer(Res68240, [2, 1, 1], Res47941), 
LRes87576 = reshape_layer(Res47941, [2, 1, 1, 1], Res87576), 
LZer37195 = zero_padding3D_layer(Res87576, 1, 1, 1, 1, 1, 1, Zer37195), 
exec_layers([LSub59918,LRes3943,LGRU96376,LRes68240,LRes47941,LRes87576,LZer37195],["Sub59918","Res3943","GRU96376","Res68240","Res47941","Res87576","Zer37195"],Zer37195,"Zer37195")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0451379], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0067425], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.04513788810343113],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[-0.006742541151210331],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.0452], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.0067], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.0452], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.0067], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]