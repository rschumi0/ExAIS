import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max20153 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Max20153 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Min82674 = tf.keras.layers.Input(shape=([1, 1]))
in1Min82674 = tf.keras.layers.Input(shape=([1, 1]))
in0Con70021 = tf.keras.layers.Input(shape=([3, 1]))

Max20153 = keras.layers.Maximum(name = 'Max20153', )([in0Max20153,in1Max20153])
Res99447 = keras.layers.Reshape((2, 2, 1), name = 'Res99447', )(Max20153)
Res39533 = keras.layers.Reshape((2, 2), name = 'Res39533', )(Res99447)
Zer20689 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer20689', )(Res39533)
Min82674 = keras.layers.Minimum(name = 'Min82674', )([in0Min82674,in1Min82674])
Zer60418 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer60418', )(Min82674)
Con70021 = keras.layers.Concatenate(axis=2, name = 'Con70021', )([Zer60418,in0Con70021])
Ave22915 = keras.layers.Average(name = 'Ave22915', )([Zer20689,Con70021])
model = tf.keras.models.Model(inputs=[in0Max20153,in1Max20153,in0Min82674,in1Min82674,in0Con70021], outputs=Ave22915)
in0Max20153 = tf.constant([[[[[0.5413]], [[0.3657]]], [[[0.6462]], [[0.2947]]]]])
in1Max20153 = tf.constant([[[[[0.3249]], [[0.7439]]], [[[0.6375]], [[0.8179]]]]])
in0Min82674 = tf.constant([[[0.2191]]])
in1Min82674 = tf.constant([[[0.1022]]])
in0Con70021 = tf.constant([[[0.1542], [0.211], [0.2826]]])
print (np.array2string(model.predict([in0Max20153,in1Max20153,in0Min82674,in1Min82674,in0Con70021],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave22915.png')

LMax20153 = maximum_layer([[[[[[0.5413]], [[0.3657]]], [[[0.6462]], [[0.2947]]]]], [[[[[0.3249]], [[0.7439]]], [[[0.6375]], [[0.8179]]]]]], Max20153), 
LRes99447 = reshape_layer(Max20153, [2, 2, 1], Res99447), 
LRes39533 = reshape_layer(Res99447, [2, 2], Res39533), 
LZer20689 = zero_padding1D_layer(Res39533, 1, 0, Zer20689), 
LMin82674 = minimum_layer([[[[0.2191]]], [[[0.1022]]]], Min82674), 
LZer60418 = zero_padding1D_layer(Min82674, 1, 1, Zer60418), 
LCon70021 = concatenate_layer([Zer60418,[[[0.1542], [0.211], [0.2826]]]], 2, Con70021), 
LAve22915 = average_layer([Zer20689,Con70021], Ave22915), 
exec_layers([LMax20153,LRes99447,LRes39533,LZer20689,LMin82674,LZer60418,LCon70021,LAve22915],["Max20153","Res99447","Res39533","Zer20689","Min82674","Zer60418","Con70021","Ave22915"],Ave22915,"Ave22915")

Actual (Unparsed): [[[0.0000000, 0.0771000], [0.3217500, 0.4774500], [0.3231000, 0.5502500]]]

Expected (Unparsed): [[[0,0.0771],[0.32175,0.47745],[0.3231,0.55025]]]

Actual:   [[[0, 0.0771], [0.3218, 0.4775], [0.3231, 0.5503]]]

Expected: [[[0, 0.0771], [0.3218, 0.4775], [0.3231, 0.5503]]]