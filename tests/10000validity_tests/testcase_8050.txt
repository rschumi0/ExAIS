import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max23014 = tf.keras.layers.Input(shape=([1, 1]))
in1Max23014 = tf.keras.layers.Input(shape=([1, 1]))

Max23014 = keras.layers.Maximum(name = 'Max23014', )([in0Max23014,in1Max23014])
Bat74516 = keras.layers.BatchNormalization(axis=1, epsilon=0.8002599634949538,  name = 'Bat74516', )(Max23014)
Res97472 = keras.layers.Reshape((1, 1, 1), name = 'Res97472', )(Bat74516)
Res27911 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res27911', )(Res97472)
Cro22521 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro22521', )(Res27911)
model = tf.keras.models.Model(inputs=[in0Max23014,in1Max23014], outputs=Cro22521)
w = model.get_layer('Bat74516').get_weights() 
w[0] = np.array([0.5831])
w[1] = np.array([0.1651])
w[2] = np.array([0.6147])
w[3] = np.array([0.4915])
model.get_layer('Bat74516').set_weights(w) 
in0Max23014 = tf.constant([[[0.839]]])
in1Max23014 = tf.constant([[[0.0109]]])
print (np.array2string(model.predict([in0Max23014,in1Max23014],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro22521.png')

LMax23014 = maximum_layer([[[[0.839]]], [[[0.0109]]]], Max23014), 
LBat74516 = batch_normalization_layer(Max23014, 1, 0.8002599634949538, [0.5831], [0.1651], [0.6147], [0.4915], Bat74516), 
LRes97472 = reshape_layer(Bat74516, [1, 1, 1], Res97472), 
LRes27911 = reshape_layer(Res97472, [1, 1, 1, 1], Res27911), 
LCro22521 = cropping3D_layer(Res27911, 0, 0, 0, 0, 0, 0, Cro22521), 
exec_layers([LMax23014,LBat74516,LRes97472,LRes27911,LCro22521],["Max23014","Bat74516","Res97472","Res27911","Cro22521"],Cro22521,"Cro22521")

Actual (Unparsed): [[[[[0.2801751]]]]]

Expected (Unparsed): [[[[[0.2801751116692002]]]]]

Actual:   [[[[[0.2802]]]]]

Expected: [[[[[0.2802]]]]]