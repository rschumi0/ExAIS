import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max27566 = tf.keras.layers.Input(shape=([2, 1]))
in1Max27566 = tf.keras.layers.Input(shape=([2, 1]))
in0Con20262 = tf.keras.layers.Input(shape=([2, 2]))

Max27566 = keras.layers.Maximum(name = 'Max27566', )([in0Max27566,in1Max27566])
Res43728 = keras.layers.Reshape((2, 1, 1), name = 'Res43728', )(Max27566)
Zer13638 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer13638', )(Res43728)
Con20262 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con20262', )(in0Con20262)
Den2533 = keras.layers.Dense(2,name = 'Den2533', )(Con20262)
Res36140 = keras.layers.Reshape((2, 2, 1), name = 'Res36140', )(Den2533)
PRe58550 = keras.layers.PReLU(name = 'PRe58550', )(Res36140)
Mul63383 = keras.layers.Multiply(name = 'Mul63383', )([Zer13638,PRe58550])
model = tf.keras.models.Model(inputs=[in0Max27566,in1Max27566,in0Con20262], outputs=Mul63383)
w = model.get_layer('Con20262').get_weights() 
w[0] = np.array([[[0.6442, 0.6149], [0.7205, 0.3782]]])
w[1] = np.array([0, 0])
model.get_layer('Con20262').set_weights(w) 
w = model.get_layer('Den2533').get_weights() 
w[0] = np.array([[0.2493, 0.9773], [0.3072, 0.843]])
w[1] = np.array([0.8898, 0.9216])
model.get_layer('Den2533').set_weights(w) 
w = model.get_layer('PRe58550').get_weights() 
w[0] = np.array([[[0.0458], [0.7176]], [[0.9289], [0.7546]]])
model.get_layer('PRe58550').set_weights(w) 
in0Max27566 = tf.constant([[[0.9442], [0.6189]]])
in1Max27566 = tf.constant([[[0.8873], [0.7393]]])
in0Con20262 = tf.constant([[[0.3143, 0.7084], [0.0356, 0.0712]]])
print (np.array2string(model.predict([in0Max27566,in1Max27566,in0Con20262],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul63383.png')

LMax27566 = maximum_layer([[[[0.9442], [0.6189]]], [[[0.8873], [0.7393]]]], Max27566), 
LRes43728 = reshape_layer(Max27566, [2, 1, 1], Res43728), 
LZer13638 = zero_padding2D_layer(Res43728, 0, 0, 1, 0, Zer13638), 
LCon20262 = conv1D_layer([[[0.3143, 0.7084], [0.0356, 0.0712]]], 1,[[[0.6442, 0.6149], [0.7205, 0.3782]]],[0, 0], 1, true, 1, Con20262), 
LDen2533 = dense_layer(Con20262, [[0.2493, 0.9773], [0.3072, 0.843]],[0.8898, 0.9216], Den2533), 
LRes36140 = reshape_layer(Den2533, [2, 2, 1], Res36140), 
LPRe58550 = prelu_layer(Res36140, [[[0.0458], [0.7176]], [[0.9289], [0.7546]]], PRe58550), 
LMul63383 = multiply_layer([Zer13638,PRe58550], Mul63383), 
exec_layers([LMax27566,LRes43728,LZer13638,LCon20262,LDen2533,LRes36140,LPRe58550,LMul63383],["Max27566","Res43728","Zer13638","Con20262","Den2533","Res36140","PRe58550","Mul63383"],Mul63383,"Mul63383")

Actual (Unparsed): [[[[0.0000000], [1.8950724]], [[0.0000000], [0.7653987]]]]

Expected (Unparsed): [[[[0.0],[1.8950723896101418]],[[0.0],[0.7653986489930887]]]]

Actual:   [[[[0], [1.8951]], [[0], [0.7654]]]]

Expected: [[[[0], [1.8951]], [[0], [0.7654]]]]