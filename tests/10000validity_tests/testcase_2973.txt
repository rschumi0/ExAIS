import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe59630 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot7944 = tf.keras.layers.Input(shape=([3]))
in1Dot7944 = tf.keras.layers.Input(shape=([3]))
in0Con59866 = tf.keras.layers.Input(shape=([1]))
in0Con87679 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con63218 = tf.keras.layers.Input(shape=([1, 1, 1]))

PRe59630 = keras.layers.PReLU(name = 'PRe59630', input_shape=(2, 1))(in0PRe59630)
Fla36224 = keras.layers.Flatten(name = 'Fla36224', )(PRe59630)
Dot7944 = keras.layers.Dot(axes=(1, 1), name = 'Dot7944', )([in0Dot7944,in1Dot7944])
Con59866 = keras.layers.Concatenate(axis=1, name = 'Con59866', )([Dot7944,in0Con59866])
Ave99360 = keras.layers.Average(name = 'Ave99360', )([Fla36224,Con59866])
Res64591 = keras.layers.Reshape((2, 1), name = 'Res64591', )(Ave99360)
Res92021 = keras.layers.Reshape((2, 1, 1), name = 'Res92021', )(Res64591)
Con87679 = keras.layers.Concatenate(axis=3, name = 'Con87679', )([Res92021,in0Con87679])
Con63218 = keras.layers.Conv2D(2, (1, 1),strides=(2, 1), padding='same', dilation_rate=(1, 1), name = 'Con63218', )(in0Con63218)
Zer6576 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer6576', )(Con63218)
Min84765 = keras.layers.Minimum(name = 'Min84765', )([Con87679,Zer6576])
model = tf.keras.models.Model(inputs=[in0PRe59630,in0Dot7944,in1Dot7944,in0Con59866,in0Con87679,in0Con63218], outputs=Min84765)
w = model.get_layer('PRe59630').get_weights() 
w[0] = np.array([[0.3823], [0.1305]])
model.get_layer('PRe59630').set_weights(w) 
w = model.get_layer('Con63218').get_weights() 
w[0] = np.array([[[[0.8196, 0.7118]]]])
w[1] = np.array([0, 0])
model.get_layer('Con63218').set_weights(w) 
in0PRe59630 = tf.constant([[[0.6814], [0.2042]]])
in0Dot7944 = tf.constant([[0.9831, 0.5951, 0.9592]])
in1Dot7944 = tf.constant([[0.6664, 0.0949, 0.2536]])
in0Con59866 = tf.constant([[0.9266]])
in0Con87679 = tf.constant([[[[0.7811]], [[0.2396]]]])
in0Con63218 = tf.constant([[[[0.0518]]]])
print (np.array2string(model.predict([in0PRe59630,in0Dot7944,in1Dot7944,in0Con59866,in0Con87679,in0Con63218],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min84765.png')

LPRe59630 = prelu_layer([[[0.6814], [0.2042]]], [[0.3823], [0.1305]], PRe59630), 
LFla36224 = flatten_layer(PRe59630, Fla36224), 
LDot7944 = dot_layer([[0.9831, 0.5951, 0.9592]], [[0.6664, 0.0949, 0.2536]], 1, 1, Dot7944), 
LCon59866 = concatenate_layer([Dot7944,[[0.9266]]], 1, Con59866), 
LAve99360 = average_layer([Fla36224,Con59866], Ave99360), 
LRes64591 = reshape_layer(Ave99360, [2, 1], Res64591), 
LRes92021 = reshape_layer(Res64591, [2, 1, 1], Res92021), 
LCon87679 = concatenate_layer([Res92021,[[[[0.7811]], [[0.2396]]]]], 3, Con87679), 
LCon63218 = conv2D_layer([[[[0.0518]]]], 1, 1,[[[[0.8196, 0.7118]]]],[0, 0], 2, 1, true, 1, 1, Con63218), 
LZer6576 = zero_padding2D_layer(Con63218, 1, 0, 0, 0, Zer6576), 
LMin84765 = minimum_layer([Con87679,Zer6576], Min84765), 
exec_layers([LPRe59630,LFla36224,LDot7944,LCon59866,LAve99360,LRes64591,LRes92021,LCon87679,LCon63218,LZer6576,LMin84765],["PRe59630","Fla36224","Dot7944","Con59866","Ave99360","Res64591","Res92021","Con87679","Con63218","Zer6576","Min84765"],Min84765,"Min84765")

Actual (Unparsed): [[[[0.0000000, 0.0000000]], [[0.0424553, 0.0368712]]]]

Expected (Unparsed): [[[[0,0]],[[0.04245528,0.03687124]]]]

Actual:   [[[[0, 0]], [[0.0425, 0.0369]]]]

Expected: [[[[0, 0]], [[0.0425, 0.0369]]]]