import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub43700 = tf.keras.layers.Input(shape=([3]))
in1Sub43700 = tf.keras.layers.Input(shape=([3]))

Sub43700 = keras.layers.Subtract(name = 'Sub43700', )([in0Sub43700,in1Sub43700])
Res34164 = keras.layers.Reshape((3, 1), name = 'Res34164', )(Sub43700)
LST84009 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST84009', )(Res34164)
model = tf.keras.models.Model(inputs=[in0Sub43700,in1Sub43700], outputs=LST84009)
w = model.get_layer('LST84009').get_weights() 
w[0] = np.array([[6, 5, 7, 6, 5, 7, 6, 1]])
w[1] = np.array([[9, 8, 8, 6, 8, 4, 4, 6], [4, 3, 10, 5, 1, 2, 7, 9]])
w[2] = np.array([5, 6, 7, 1, 1, 5, 2, 7])
model.get_layer('LST84009').set_weights(w) 
in0Sub43700 = tf.constant([[0.8025, 0.405, 0.3015]])
in1Sub43700 = tf.constant([[0.3057, 0.5659, 0.3402]])
print (np.array2string(model.predict([in0Sub43700,in1Sub43700],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST84009.png')

LSub43700 = subtract_layer([[0.8025, 0.405, 0.3015]], [[0.3057, 0.5659, 0.3402]], Sub43700), 
LRes34164 = reshape_layer(Sub43700, [3, 1], Res34164), 
LLST84009 = lstm_layer(Res34164,[[6, 5, 7, 6, 5, 7, 6, 1]],[[9, 8, 8, 6, 8, 4, 4, 6], [4, 3, 10, 5, 1, 2, 7, 9]],[5, 6, 7, 1, 1, 5, 2, 7], LST84009), 
exec_layers([LSub43700,LRes34164,LLST84009],["Sub43700","Res34164","LST84009"],LST84009,"LST84009")

Actual (Unparsed): [[0.9950285, 0.9950502]]

Expected (Unparsed): [[0.9950285326131435,0.9950501898290934]]

Actual:   [[0.9951, 0.9951]]

Expected: [[0.9951, 0.9951]]