import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min24929 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Min24929 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con2387 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Mul1229 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Mul1229 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Glo59497 = tf.keras.layers.Input(shape=([2, 1]))
in0Con48934 = tf.keras.layers.Input(shape=([2, 5]))

Min24929 = keras.layers.Minimum(name = 'Min24929', )([in0Min24929,in1Min24929])
Res26992 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res26992', )(Min24929)
Con2387 = keras.layers.Concatenate(axis=4, name = 'Con2387', )([Res26992,in0Con2387])
Mul1229 = keras.layers.Multiply(name = 'Mul1229', )([in0Mul1229,in1Mul1229])
Zer54611 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer54611', )(Mul1229)
Add70551 = keras.layers.Add(name = 'Add70551', )([Con2387,Zer54611])
Res17920 = keras.layers.Reshape((2, 2, 4), name = 'Res17920', )(Add70551)
Res27770 = keras.layers.Reshape((2, 8), name = 'Res27770', )(Res17920)
Glo59497 = keras.layers.GlobalAveragePooling1D(name = 'Glo59497', )(in0Glo59497)
Res70497 = keras.layers.Reshape((1, 1), name = 'Res70497', )(Glo59497)
Res87728 = keras.layers.Reshape((1, 1, 1), name = 'Res87728', )(Res70497)
Res4814 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res4814', )(Res87728)
Cro80260 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro80260', )(Res4814)
Res39233 = keras.layers.Reshape((1, 1, 1), name = 'Res39233', )(Cro80260)
Res26260 = keras.layers.Reshape((1, 1), name = 'Res26260', )(Res39233)
Sep83727 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep83727', )(Res26260)
Zer6875 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer6875', )(Sep83727)
Con48934 = keras.layers.Concatenate(axis=2, name = 'Con48934', )([Zer6875,in0Con48934])
Mul42539 = keras.layers.Multiply(name = 'Mul42539', )([Res27770,Con48934])
model = tf.keras.models.Model(inputs=[in0Min24929,in1Min24929,in0Con2387,in0Mul1229,in1Mul1229,in0Glo59497,in0Con48934], outputs=Mul42539)
w = model.get_layer('Sep83727').get_weights() 
w[0] = np.array([[[0.0047]]])
w[1] = np.array([[[0.3164, 0.753, 0.0142]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep83727').set_weights(w) 
in0Min24929 = tf.constant([[[[0.9011, 0.0163], [0.4713, 0.3516]], [[0.3772, 0.5111], [0.4985, 0.2747]]]])
in1Min24929 = tf.constant([[[[0.9794, 0.9808], [0.4994, 0.2871]], [[0.7849, 0.9219], [0.1401, 0.0261]]]])
in0Con2387 = tf.constant([[[[[0.7782], [0.4047]], [[0.4425], [0.3813]]], [[[0.3121], [0.3866]], [[0.2557], [0.4528]]]]])
in0Mul1229 = tf.constant([[[[[0.0443, 0.5339]]], [[[0.2944, 0.0936]]]]])
in1Mul1229 = tf.constant([[[[[0.1806, 0.5322]]], [[[0.4366, 0.9803]]]]])
in0Glo59497 = tf.constant([[[1.3977], [1.7767]]])
in0Con48934 = tf.constant([[[0.686, 0.4148, 0.8922, 0.936, 0.7499], [0.3313, 0.7638, 0.4991, 0.5125, 0.8907]]])
print (np.array2string(model.predict([in0Min24929,in1Min24929,in0Con2387,in0Mul1229,in1Mul1229,in0Glo59497,in0Con48934],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul42539.png')

LMin24929 = minimum_layer([[[[[0.9011, 0.0163], [0.4713, 0.3516]], [[0.3772, 0.5111], [0.4985, 0.2747]]]], [[[[0.9794, 0.9808], [0.4994, 0.2871]], [[0.7849, 0.9219], [0.1401, 0.0261]]]]], Min24929), 
LRes26992 = reshape_layer(Min24929, [2, 2, 2, 1], Res26992), 
LCon2387 = concatenate_layer([Res26992,[[[[[0.7782], [0.4047]], [[0.4425], [0.3813]]], [[[0.3121], [0.3866]], [[0.2557], [0.4528]]]]]], 4, Con2387), 
LMul1229 = multiply_layer([[[[[[0.0443, 0.5339]]], [[[0.2944, 0.0936]]]]], [[[[[0.1806, 0.5322]]], [[[0.4366, 0.9803]]]]]], Mul1229), 
LZer54611 = zero_padding3D_layer(Mul1229, 0, 0, 1, 0, 1, 0, Zer54611), 
LAdd70551 = add_layer([Con2387,Zer54611], Add70551), 
LRes17920 = reshape_layer(Add70551, [2, 2, 4], Res17920), 
LRes27770 = reshape_layer(Res17920, [2, 8], Res27770), 
LGlo59497 = global_average_pooling1D_layer([[[1.3977], [1.7767]]], Glo59497), 
LRes70497 = reshape_layer(Glo59497, [1, 1], Res70497), 
LRes87728 = reshape_layer(Res70497, [1, 1, 1], Res87728), 
LRes4814 = reshape_layer(Res87728, [1, 1, 1, 1], Res4814), 
LCro80260 = cropping3D_layer(Res4814, 0, 0, 0, 0, 0, 0, Cro80260), 
LRes39233 = reshape_layer(Cro80260, [1, 1, 1], Res39233), 
LRes26260 = reshape_layer(Res39233, [1, 1], Res26260), 
LSep83727 = separable_conv1D_layer(Res26260, 1,[[[[0.0047]]],[[[0.3164, 0.753, 0.0142]]]],[0, 0, 0], 1, false, Sep83727), 
LZer6875 = zero_padding1D_layer(Sep83727, 1, 0, Zer6875), 
LCon48934 = concatenate_layer([Zer6875,[[[0.686, 0.4148, 0.8922, 0.936, 0.7499], [0.3313, 0.7638, 0.4991, 0.5125, 0.8907]]]], 2, Con48934), 
LMul42539 = multiply_layer([Res27770,Con48934], Mul42539), 
exec_layers([LMin24929,LRes26992,LCon2387,LMul1229,LZer54611,LAdd70551,LRes17920,LRes27770,LGlo59497,LRes70497,LRes87728,LRes4814,LCro80260,LRes39233,LRes26260,LSep83727,LZer6875,LCon48934,LMul42539],["Min24929","Res26992","Con2387","Mul1229","Zer54611","Add70551","Res17920","Res27770","Glo59497","Res70497","Res87728","Res4814","Cro80260","Res39233","Res26260","Sep83727","Zer6875","Con48934","Mul42539"],Mul42539,"Mul42539")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.2776242, 0.1954952, 0.3947985, 0.2762141, 0.4990146], [0.0008903, 0.0017531, 0.0000541, 0.1280806, 0.1070084, 0.1276199, 0.0792505, 0.4850361]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.27762420000000004,0.19549524,0.3947985,0.27621414288,0.499014640842],[0.0008903026614271999,0.001753146696192,5.41406839808e-5,0.12808058,0.10700838,0.12761987,0.079250458,0.48503610045600004]]]

Actual:   [[[0, 0, 0, 0.2777, 0.1955, 0.3948, 0.2763, 0.4991], [0.0009, 0.0018, 0.0001, 0.1281, 0.1071, 0.1277, 0.0793, 0.4851]]]

Expected: [[[0, 0, 0, 0.2777, 0.1955, 0.3948, 0.2763, 0.4991], [0.0009, 0.0018, 0.0001, 0.1281, 0.1071, 0.1277, 0.0793, 0.4851]]]