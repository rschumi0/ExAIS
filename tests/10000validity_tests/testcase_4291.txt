import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro78985 = tf.keras.layers.Input(shape=([1, 2, 1]))

Cro78985 = keras.layers.Cropping2D(cropping=((0, 0), (0, 1)), name = 'Cro78985', )(in0Cro78985)
Zer29230 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer29230', )(Cro78985)
Res20632 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res20632', )(Zer29230)
PRe50291 = keras.layers.PReLU(name = 'PRe50291', )(Res20632)
Res91952 = keras.layers.Reshape((3, 3, 1), name = 'Res91952', )(PRe50291)
Res62530 = keras.layers.Reshape((3, 3), name = 'Res62530', )(Res91952)
Ave11304 = keras.layers.AveragePooling1D(pool_size=(3), strides=(1), padding='same', name = 'Ave11304', )(Res62530)
Res10445 = keras.layers.Reshape((3, 3, 1), name = 'Res10445', )(Ave11304)
Glo53064 = keras.layers.GlobalMaxPool2D(name = 'Glo53064', )(Res10445)
model = tf.keras.models.Model(inputs=[in0Cro78985], outputs=Glo53064)
w = model.get_layer('PRe50291').get_weights() 
w[0] = np.array([[[[0.3756]], [[0.146]], [[0.1415]]], [[[0.6321]], [[0.8293]], [[0.2536]]], [[[0.3891]], [[0.4921]], [[0.1973]]]])
model.get_layer('PRe50291').set_weights(w) 
in0Cro78985 = tf.constant([[[[1.5326], [1.5839]]]])
print (np.array2string(model.predict([in0Cro78985],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo53064.png')

LCro78985 = cropping2D_layer([[[[1.5326], [1.5839]]]], 0, 0, 0, 1, Cro78985), 
LZer29230 = zero_padding2D_layer(Cro78985, 1, 1, 1, 1, Zer29230), 
LRes20632 = reshape_layer(Zer29230, [3, 3, 1, 1], Res20632), 
LPRe50291 = prelu_layer(Res20632, [[[[0.3756]], [[0.146]], [[0.1415]]], [[[0.6321]], [[0.8293]], [[0.2536]]], [[[0.3891]], [[0.4921]], [[0.1973]]]], PRe50291), 
LRes91952 = reshape_layer(PRe50291, [3, 3, 1], Res91952), 
LRes62530 = reshape_layer(Res91952, [3, 3], Res62530), 
LAve11304 = average_pooling1D_layer(Res62530, 3, 1, true, Ave11304), 
LRes10445 = reshape_layer(Ave11304, [3, 3, 1], Res10445), 
LGlo53064 = global_max_pool2D_layer(Res10445, Glo53064), 
exec_layers([LCro78985,LZer29230,LRes20632,LPRe50291,LRes91952,LRes62530,LAve11304,LRes10445,LGlo53064],["Cro78985","Zer29230","Res20632","PRe50291","Res91952","Res62530","Ave11304","Res10445","Glo53064"],Glo53064,"Glo53064")

Actual (Unparsed): [[0.7663000]]

Expected (Unparsed): [[0.7663]]

Actual:   [[0.7663]]

Expected: [[0.7663]]