import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub29022 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub29022 = tf.keras.layers.Input(shape=([2, 2]))
in0Ave18047 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave18047 = tf.keras.layers.Input(shape=([1, 1]))
in0Con14852 = tf.keras.layers.Input(shape=([2, 1]))
in0Con26745 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Max78257 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con73444 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Min35973 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min35973 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Sub29022 = keras.layers.Subtract(name = 'Sub29022', )([in0Sub29022,in1Sub29022])
Ave18047 = keras.layers.Average(name = 'Ave18047', )([in0Ave18047,in1Ave18047])
Zer48946 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer48946', )(Ave18047)
Con14852 = keras.layers.Concatenate(axis=2, name = 'Con14852', )([Zer48946,in0Con14852])
Mul71804 = keras.layers.Multiply(name = 'Mul71804', )([Sub29022,Con14852])
Res13668 = keras.layers.Reshape((2, 2, 1), name = 'Res13668', )(Mul71804)
Res34948 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res34948', )(Res13668)
Con26745 = keras.layers.Concatenate(axis=4, name = 'Con26745', )([Res34948,in0Con26745])
Max78257 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max78257', )(in0Max78257)
Res72009 = keras.layers.Reshape((1, 1), name = 'Res72009', )(Max78257)
Per87718 = keras.layers.Permute((1,2), name = 'Per87718',)(Res72009)
Res31810 = keras.layers.Reshape((1, 1, 1), name = 'Res31810', )(Per87718)
Res77123 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res77123', )(Res31810)
Zer56115 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer56115', )(Res77123)
Con73444 = keras.layers.Concatenate(axis=4, name = 'Con73444', )([Zer56115,in0Con73444])
Min35973 = keras.layers.Minimum(name = 'Min35973', )([in0Min35973,in1Min35973])
Ave13163 = keras.layers.Average(name = 'Ave13163', )([Con73444,Min35973])
Sof49696 = keras.layers.Softmax(axis=1, name = 'Sof49696', )(Ave13163)
Zer88725 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer88725', )(Sof49696)
Add92261 = keras.layers.Add(name = 'Add92261', )([Con26745,Zer88725])
model = tf.keras.models.Model(inputs=[in0Sub29022,in1Sub29022,in0Ave18047,in1Ave18047,in0Con14852,in0Con26745,in0Max78257,in0Con73444,in0Min35973,in1Min35973], outputs=Add92261)
in0Sub29022 = tf.constant([[[0.2917, 0.4228], [0.3668, 0.4107]]])
in1Sub29022 = tf.constant([[[0.4403, 0.9345], [0.9425, 0.5303]]])
in0Ave18047 = tf.constant([[[0.8114]]])
in1Ave18047 = tf.constant([[[0.7001]]])
in0Con14852 = tf.constant([[[0.352], [0.9769]]])
in0Con26745 = tf.constant([[[[[0.2111]], [[0.0483]]], [[[0.8773]], [[0.5735]]]]])
in0Max78257 = tf.constant([[[[1.1029]]]])
in0Con73444 = tf.constant([[[[[0.4788]], [[0.9431]]]]])
in0Min35973 = tf.constant([[[[[0.2573, 0.0562]], [[0.0004, 0.0627]]]]])
in1Min35973 = tf.constant([[[[[0.887, 0.9321]], [[0.2844, 0.4099]]]]])
print (np.array2string(model.predict([in0Sub29022,in1Sub29022,in0Ave18047,in1Ave18047,in0Con14852,in0Con26745,in0Max78257,in0Con73444,in0Min35973,in1Min35973],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add92261.png')

LSub29022 = subtract_layer([[[0.2917, 0.4228], [0.3668, 0.4107]]], [[[0.4403, 0.9345], [0.9425, 0.5303]]], Sub29022), 
LAve18047 = average_layer([[[[0.8114]]], [[[0.7001]]]], Ave18047), 
LZer48946 = zero_padding1D_layer(Ave18047, 1, 0, Zer48946), 
LCon14852 = concatenate_layer([Zer48946,[[[0.352], [0.9769]]]], 2, Con14852), 
LMul71804 = multiply_layer([Sub29022,Con14852], Mul71804), 
LRes13668 = reshape_layer(Mul71804, [2, 2, 1], Res13668), 
LRes34948 = reshape_layer(Res13668, [2, 2, 1, 1], Res34948), 
LCon26745 = concatenate_layer([Res34948,[[[[[0.2111]], [[0.0483]]], [[[0.8773]], [[0.5735]]]]]], 4, Con26745), 
LMax78257 = max_pool2D_layer([[[[1.1029]]]], 1, 1, Max78257), 
LRes72009 = reshape_layer(Max78257, [1, 1], Res72009), 
LPer87718 = permute_layer(Res72009, 1,2, Per87718), 
LRes31810 = reshape_layer(Per87718, [1, 1, 1], Res31810), 
LRes77123 = reshape_layer(Res31810, [1, 1, 1, 1], Res77123), 
LZer56115 = zero_padding3D_layer(Res77123, 0, 0, 1, 0, 0, 0, Zer56115), 
LCon73444 = concatenate_layer([Zer56115,[[[[[0.4788]], [[0.9431]]]]]], 4, Con73444), 
LMin35973 = minimum_layer([[[[[[0.2573, 0.0562]], [[0.0004, 0.0627]]]]], [[[[[0.887, 0.9321]], [[0.2844, 0.4099]]]]]], Min35973), 
LAve13163 = average_layer([Con73444,Min35973], Ave13163), 
LSof49696 = softmax_layer(Ave13163, 1, Sof49696), 
LZer88725 = zero_padding3D_layer(Sof49696, 1, 0, 0, 0, 0, 0, Zer88725), 
LAdd92261 = add_layer([Con26745,Zer88725], Add92261), 
exec_layers([LSub29022,LAve18047,LZer48946,LCon14852,LMul71804,LRes13668,LRes34948,LCon26745,LMax78257,LRes72009,LPer87718,LRes31810,LRes77123,LZer56115,LCon73444,LMin35973,LAve13163,LSof49696,LZer88725,LAdd92261],["Sub29022","Ave18047","Zer48946","Con14852","Mul71804","Res13668","Res34948","Con26745","Max78257","Res72009","Per87718","Res31810","Res77123","Zer56115","Con73444","Min35973","Ave13163","Sof49696","Zer88725","Add92261"],Add92261,"Add92261")

Actual (Unparsed): [[[[[0.0000000, 0.2111000]], [[-0.1801184, 0.0483000]]], [[[0.5649147, 1.8773000]], [[0.8831627, 1.5735000]]]]]

Expected (Unparsed): [[[[[0.0,0.2111]],[[-0.1801184,0.0483]]],[[[0.5649147250000001,1.8773]],[[0.88316276,1.5735000000000001]]]]]

Actual:   [[[[[0, 0.2111]], [[-0.1801, 0.0483]]], [[[0.565, 1.8773]], [[0.8832, 1.5735]]]]]

Expected: [[[[[0, 0.2111]], [[-0.1801, 0.0483]]], [[[0.565, 1.8773]], [[0.8832, 1.5736]]]]]