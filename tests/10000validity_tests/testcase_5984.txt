import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub6409 = tf.keras.layers.Input(shape=([3]))
in1Sub6409 = tf.keras.layers.Input(shape=([3]))

Sub6409 = keras.layers.Subtract(name = 'Sub6409', )([in0Sub6409,in1Sub6409])
Res61061 = keras.layers.Reshape((3, 1), name = 'Res61061', )(Sub6409)
Res44497 = keras.layers.Reshape((3, 1, 1), name = 'Res44497', )(Res61061)
Sep11097 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep11097', )(Res44497)
model = tf.keras.models.Model(inputs=[in0Sub6409,in1Sub6409], outputs=Sep11097)
w = model.get_layer('Sep11097').get_weights() 
w[0] = np.array([[[[0.1283]]]])
w[1] = np.array([[[[0.3768, 0.9514]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep11097').set_weights(w) 
in0Sub6409 = tf.constant([[0.6744, 0.2657, 0.2978]])
in1Sub6409 = tf.constant([[0.6263, 0.7416, 0.4918]])
print (np.array2string(model.predict([in0Sub6409,in1Sub6409],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep11097.png')

LSub6409 = subtract_layer([[0.6744, 0.2657, 0.2978]], [[0.6263, 0.7416, 0.4918]], Sub6409), 
LRes61061 = reshape_layer(Sub6409, [3, 1], Res61061), 
LRes44497 = reshape_layer(Res61061, [3, 1, 1], Res44497), 
LSep11097 = separable_conv2D_layer(Res44497, 1, 1,[[[[[0.1283]]]],[[[[0.3768, 0.9514]]]]],[0, 0], 1, 1, false, Sep11097), 
exec_layers([LSub6409,LRes61061,LRes44497,LSep11097],["Sub6409","Res61061","Res44497","Sep11097"],Sep11097,"Sep11097")

Actual (Unparsed): [[[[0.0023253, 0.0058713]], [[-0.0230066, -0.0580905]], [[-0.0093786, -0.0236805]]]]

Expected (Unparsed): [[[[0.002325319464000002,0.005871308222000004]],[[-0.023006643096000003,-0.058090552658000005]],[[-0.00937862736,-0.02368053628]]]]

Actual:   [[[[0.0024, 0.0059]], [[-0.023, -0.058]], [[-0.0093, -0.0236]]]]

Expected: [[[[0.0024, 0.0059]], [[-0.023, -0.058]], [[-0.0093, -0.0236]]]]