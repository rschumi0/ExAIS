import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot26595 = tf.keras.layers.Input(shape=([3]))
in1Dot26595 = tf.keras.layers.Input(shape=([3]))

Dot26595 = keras.layers.Dot(axes=(1, 1), name = 'Dot26595', )([in0Dot26595,in1Dot26595])
Res9511 = keras.layers.Reshape((1, 1), name = 'Res9511', )(Dot26595)
Ave58611 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='valid', name = 'Ave58611', )(Res9511)
Glo50569 = keras.layers.GlobalAveragePooling1D(name = 'Glo50569', )(Ave58611)
Res27125 = keras.layers.Reshape((1, 1), name = 'Res27125', )(Glo50569)
Res62686 = keras.layers.Reshape((1, 1, 1), name = 'Res62686', )(Res27125)
Res37226 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res37226', )(Res62686)
Cro12583 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro12583', )(Res37226)
Res18233 = keras.layers.Reshape((1, 1, 1), name = 'Res18233', )(Cro12583)
Res31002 = keras.layers.Reshape((1, 1), name = 'Res31002', )(Res18233)
LST55913 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST55913', )(Res31002)
model = tf.keras.models.Model(inputs=[in0Dot26595,in1Dot26595], outputs=LST55913)
w = model.get_layer('LST55913').get_weights() 
w[0] = np.array([[1, 5, 6, 4]])
w[1] = np.array([[8, 3, 8, 5]])
w[2] = np.array([9, 9, 5, 4])
model.get_layer('LST55913').set_weights(w) 
in0Dot26595 = tf.constant([[0.4029, 0.482, 0.5609]])
in1Dot26595 = tf.constant([[0.9529, 0.1385, 0.0456]])
print (np.array2string(model.predict([in0Dot26595,in1Dot26595],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST55913.png')

LDot26595 = dot_layer([[0.4029, 0.482, 0.5609]], [[0.9529, 0.1385, 0.0456]], 1, 1, Dot26595), 
LRes9511 = reshape_layer(Dot26595, [1, 1], Res9511), 
LAve58611 = average_pooling1D_layer(Res9511, 1, 1, false, Ave58611), 
LGlo50569 = global_average_pooling1D_layer(Ave58611, Glo50569), 
LRes27125 = reshape_layer(Glo50569, [1, 1], Res27125), 
LRes62686 = reshape_layer(Res27125, [1, 1, 1], Res62686), 
LRes37226 = reshape_layer(Res62686, [1, 1, 1, 1], Res37226), 
LCro12583 = cropping3D_layer(Res37226, 0, 0, 0, 0, 0, 0, Cro12583), 
LRes18233 = reshape_layer(Cro12583, [1, 1, 1], Res18233), 
LRes31002 = reshape_layer(Res18233, [1, 1], Res31002), 
LLST55913 = lstm_layer(Res31002,[[1, 5, 6, 4]],[[8, 3, 8, 5]],[9, 9, 5, 4], LST55913), 
exec_layers([LDot26595,LRes9511,LAve58611,LGlo50569,LRes27125,LRes62686,LRes37226,LCro12583,LRes18233,LRes31002,LLST55913],["Dot26595","Res9511","Ave58611","Glo50569","Res27125","Res62686","Res37226","Cro12583","Res18233","Res31002","LST55913"],LST55913,"LST55913")

Actual (Unparsed): [[0.7594917]]

Expected (Unparsed): [[0.7594916927825922]]

Actual:   [[0.7595]]

Expected: [[0.7595]]