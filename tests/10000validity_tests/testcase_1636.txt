import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con18177 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Min42576 = tf.keras.layers.Input(shape=([2, 2]))
in1Min42576 = tf.keras.layers.Input(shape=([2, 2]))
in0Con35592 = tf.keras.layers.Input(shape=([3, 7]))

Con18177 = keras.layers.Conv2D(3, (2, 1),strides=(6, 8), padding='valid', dilation_rate=(1, 1), name = 'Con18177', )(in0Con18177)
Zer72033 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer72033', )(Con18177)
Res56522 = keras.layers.Reshape((3, 9), name = 'Res56522', )(Zer72033)
Min42576 = keras.layers.Minimum(name = 'Min42576', )([in0Min42576,in1Min42576])
Zer74520 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer74520', )(Min42576)
Con35592 = keras.layers.Concatenate(axis=2, name = 'Con35592', )([Zer74520,in0Con35592])
Min90621 = keras.layers.Minimum(name = 'Min90621', )([Res56522,Con35592])
model = tf.keras.models.Model(inputs=[in0Con18177,in0Min42576,in1Min42576,in0Con35592], outputs=Min90621)
w = model.get_layer('Con18177').get_weights() 
w[0] = np.array([[[[0.0129, 0.0047, 0.254]]], [[[0.9882, 0.0735, 0.8252]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con18177').set_weights(w) 
in0Con18177 = tf.constant([[[[0.8462]], [[0.2605]]]])
in0Min42576 = tf.constant([[[0.5055, 0.0297], [0.1536, 0.2839]]])
in1Min42576 = tf.constant([[[0.6649, 0.7805], [0.2937, 0.1687]]])
in0Con35592 = tf.constant([[[0.5727, 0.0122, 0.6171, 0.3707, 0.047, 0.5406, 0.1761], [0.5079, 0.8612, 0.4858, 0.704, 0.187, 0.0973, 0.4219], [0.6169, 0.3027, 0.1659, 0.8362, 0.5529, 0.8542, 0.0087]]])
print (np.array2string(model.predict([in0Con18177,in0Min42576,in1Min42576,in0Con35592],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min90621.png')

LCon18177 = conv2D_layer([[[[0.8462]], [[0.2605]]]], 2, 1,[[[[0.0129, 0.0047, 0.254]]], [[[0.9882, 0.0735, 0.8252]]]],[0, 0, 0], 6, 8, false, 1, 1, Con18177), 
LZer72033 = zero_padding2D_layer(Con18177, 1, 1, 1, 1, Zer72033), 
LRes56522 = reshape_layer(Zer72033, [3, 9], Res56522), 
LMin42576 = minimum_layer([[[[0.5055, 0.0297], [0.1536, 0.2839]]], [[[0.6649, 0.7805], [0.2937, 0.1687]]]], Min42576), 
LZer74520 = zero_padding1D_layer(Min42576, 1, 0, Zer74520), 
LCon35592 = concatenate_layer([Zer74520,[[[0.5727, 0.0122, 0.6171, 0.3707, 0.047, 0.5406, 0.1761], [0.5079, 0.8612, 0.4858, 0.704, 0.187, 0.0973, 0.4219], [0.6169, 0.3027, 0.1659, 0.8362, 0.5529, 0.8542, 0.0087]]]], 2, Con35592), 
LMin90621 = minimum_layer([Res56522,Con35592], Min90621), 
exec_layers([LCon18177,LZer72033,LRes56522,LMin42576,LZer74520,LCon35592,LMin90621],["Con18177","Zer72033","Res56522","Min42576","Zer74520","Con35592","Min90621"],Min90621,"Min90621")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.2683421, 0.0231239, 0.4298994, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0,0,0,0,0,0],[0,0,0,0.26834208,0.02312389,0.4298994,0,0,0],[0,0,0,0,0,0,0,0,0]]]

Actual:   [[[0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0.2684, 0.0232, 0.4299, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0.2684, 0.0232, 0.4299, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0]]]