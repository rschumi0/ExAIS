import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo35765 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Con90144 = tf.keras.layers.Input(shape=([2]))
in0Lay56959 = tf.keras.layers.Input(shape=([4]))

Glo35765 = keras.layers.GlobalMaxPool3D(name = 'Glo35765', )(in0Glo35765)
Con90144 = keras.layers.Concatenate(axis=1, name = 'Con90144', )([Glo35765,in0Con90144])
Lay56959 = keras.layers.LayerNormalization(axis=1, epsilon=2.5753149792623993, name = 'Lay56959', )(in0Lay56959)
Min96494 = keras.layers.Minimum(name = 'Min96494', )([Con90144,Lay56959])
Res21385 = keras.layers.Reshape((4, 1), name = 'Res21385', )(Min96494)
PRe11354 = keras.layers.PReLU(name = 'PRe11354', )(Res21385)
PRe70453 = keras.layers.PReLU(name = 'PRe70453', )(PRe11354)
model = tf.keras.models.Model(inputs=[in0Glo35765,in0Con90144,in0Lay56959], outputs=PRe70453)
w = model.get_layer('PRe11354').get_weights() 
w[0] = np.array([[0.2361], [0.6925], [0.7316], [0.273]])
model.get_layer('PRe11354').set_weights(w) 
w = model.get_layer('PRe70453').get_weights() 
w[0] = np.array([[0.3829], [0.0008], [0.6056], [0.8895]])
model.get_layer('PRe70453').set_weights(w) 
in0Glo35765 = tf.constant([[[[[1.2707, 1.2513]]], [[[1.534, 1.1555]]]]])
in0Con90144 = tf.constant([[0.4995, 0.6422]])
in0Lay56959 = tf.constant([[1.1918, 1.7593, 1.6165, 1.9517]])
print (np.array2string(model.predict([in0Glo35765,in0Con90144,in0Lay56959],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe70453.png')

LGlo35765 = global_max_pool3D_layer([[[[[1.2707, 1.2513]]], [[[1.534, 1.1555]]]]], Glo35765), 
LCon90144 = concatenate_layer([Glo35765,[[0.4995, 0.6422]]], 1, Con90144), 
LLay56959 = layer_normalization_layer([[1.1918, 1.7593, 1.6165, 1.9517]], 1, 2.5753149792623993, Lay56959), 
LMin96494 = minimum_layer([Con90144,Lay56959], Min96494), 
LRes21385 = reshape_layer(Min96494, [4, 1], Res21385), 
LPRe11354 = prelu_layer(Res21385, [[0.2361], [0.6925], [0.7316], [0.273]], PRe11354), 
LPRe70453 = prelu_layer(PRe11354, [[0.3829], [0.0008], [0.6056], [0.8895]], PRe70453), 
exec_layers([LGlo35765,LCon90144,LLay56959,LMin96494,LRes21385,LPRe11354,LPRe70453],["Glo35765","Con90144","Lay56959","Min96494","Res21385","PRe11354","PRe70453"],PRe70453,"PRe70453")

Actual (Unparsed): [[[-0.0243096], [0.0794846], [-0.0036243], [0.1975988]]]

Expected (Unparsed): [[[-0.02430957933012538],[0.07948462169168609],[-0.003624298613033163],[0.1975988616104379]]]

Actual:   [[[-0.0243], [0.0795], [-0.0036], [0.1976]]]

Expected: [[[-0.0243], [0.0795], [-0.0036], [0.1976]]]