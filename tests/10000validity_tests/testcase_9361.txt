import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min15663 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min15663 = tf.keras.layers.Input(shape=([1, 2, 2]))

Min15663 = keras.layers.Minimum(name = 'Min15663', )([in0Min15663,in1Min15663])
Res56216 = keras.layers.Reshape((1, 4), name = 'Res56216', )(Min15663)
GRU91752 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU91752', )(Res56216)
Res3004 = keras.layers.Reshape((1, 1), name = 'Res3004', )(GRU91752)
Res18195 = keras.layers.Reshape((1, 1, 1), name = 'Res18195', )(Res3004)
Res88152 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res88152', )(Res18195)
Zer74399 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer74399', )(Res88152)
model = tf.keras.models.Model(inputs=[in0Min15663,in1Min15663], outputs=Zer74399)
w = model.get_layer('GRU91752').get_weights() 
w[0] = np.array([[6, 10, 1], [4, 4, 4], [8, 5, 5], [5, 7, 8]])
w[1] = np.array([[4, 2, 8]])
w[2] = np.array([8, 10, 9])
model.get_layer('GRU91752').set_weights(w) 
in0Min15663 = tf.constant([[[[0.3868, 0.8297], [0.8323, 0.6555]]]])
in1Min15663 = tf.constant([[[[0.0392, 0.4574], [0.9689, 0.8367]]]])
print (np.array2string(model.predict([in0Min15663,in1Min15663],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer74399.png')

LMin15663 = minimum_layer([[[[[0.3868, 0.8297], [0.8323, 0.6555]]]], [[[[0.0392, 0.4574], [0.9689, 0.8367]]]]], Min15663), 
LRes56216 = reshape_layer(Min15663, [1, 4], Res56216), 
LGRU91752 = gru_layer(Res56216,[[6, 10, 1], [4, 4, 4], [8, 5, 5], [5, 7, 8]],[[4, 2, 8]],[8, 10, 9], false, GRU91752), 
LRes3004 = reshape_layer(GRU91752, [1, 1], Res3004), 
LRes18195 = reshape_layer(Res3004, [1, 1, 1], Res18195), 
LRes88152 = reshape_layer(Res18195, [1, 1, 1, 1], Res88152), 
LZer74399 = zero_padding3D_layer(Res88152, 1, 1, 1, 1, 1, 1, Zer74399), 
exec_layers([LMin15663,LRes56216,LGRU91752,LRes3004,LRes18195,LRes88152,LZer74399],["Min15663","Res56216","GRU91752","Res3004","Res18195","Res88152","Zer74399"],Zer74399,"Zer74399")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[2.0597112904141568e-9],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]