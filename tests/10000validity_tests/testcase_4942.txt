import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep38629 = tf.keras.layers.Input(shape=([2, 1, 1]))

Sep38629 = keras.layers.SeparableConv2D(4, (2, 1),strides=(1, 1), padding='valid', name = 'Sep38629', )(in0Sep38629)
Res21211 = keras.layers.Reshape((1, 4), name = 'Res21211', )(Sep38629)
GRU70752 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU70752', )(Res21211)
Mas77012 = keras.layers.Masking(mask_value=1, name = 'Mas77012', )(GRU70752)
model = tf.keras.models.Model(inputs=[in0Sep38629], outputs=Mas77012)
w = model.get_layer('Sep38629').get_weights() 
w[0] = np.array([[[[0.739]]], [[[0.0562]]]])
w[1] = np.array([[[[0.5386, 0.6128, 0.2999, 0.3458]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep38629').set_weights(w) 
w = model.get_layer('GRU70752').get_weights() 
w[0] = np.array([[4, 6, 9, 5, 10, 9, 6, 6, 4], [5, 8, 8, 5, 10, 9, 7, 4, 3], [3, 2, 3, 10, 10, 9, 4, 5, 3], [5, 8, 3, 1, 6, 6, 1, 4, 8]])
w[1] = np.array([[4, 2, 7, 4, 1, 5, 10, 4, 6], [1, 5, 10, 8, 3, 5, 6, 7, 8], [5, 9, 3, 5, 4, 8, 2, 1, 8]])
w[2] = np.array([8, 4, 9, 7, 9, 7, 3, 7, 2])
model.get_layer('GRU70752').set_weights(w) 
in0Sep38629 = tf.constant([[[[0.8192]], [[0.2112]]]])
print (np.array2string(model.predict([in0Sep38629],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas77012.png')

LSep38629 = separable_conv2D_layer([[[[0.8192]], [[0.2112]]]], 2, 1,[[[[[0.739]]], [[[0.0562]]]],[[[[0.5386, 0.6128, 0.2999, 0.3458]]]]],[0, 0, 0, 0], 1, 1, false, Sep38629), 
LRes21211 = reshape_layer(Sep38629, [1, 4], Res21211), 
LGRU70752 = gru_layer(Res21211,[[4, 6, 9, 5, 10, 9, 6, 6, 4], [5, 8, 8, 5, 10, 9, 7, 4, 3], [3, 2, 3, 10, 10, 9, 4, 5, 3], [5, 8, 3, 1, 6, 6, 1, 4, 8]],[[4, 2, 7, 4, 1, 5, 10, 4, 6], [1, 5, 10, 8, 3, 5, 6, 7, 8], [5, 9, 3, 5, 4, 8, 2, 1, 8]],[8, 4, 9, 7, 9, 7, 3, 7, 2], false, GRU70752), 
LMas77012 = masking_layer(GRU70752, 1, Mas77012), 
exec_layers([LSep38629,LRes21211,LGRU70752,LMas77012],["Sep38629","Res21211","GRU70752","Mas77012"],Mas77012,"Mas77012")

Actual (Unparsed): [[0.0000026, 0.0000151, 0.0000001]]

Expected (Unparsed): [[2.642751771063926e-6,1.5133369599041265e-5,9.086978553827507e-8]]

Actual:   [[0, 0.0001, 0]]

Expected: [[0, 0.0001, 0]]