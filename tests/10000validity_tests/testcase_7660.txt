import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave67043 = tf.keras.layers.Input(shape=([2, 1, 2]))

Ave67043 = keras.layers.AveragePooling2D(pool_size=(2, 1), name = 'Ave67043', )(in0Ave67043)
Res89940 = keras.layers.Reshape((1, 2), name = 'Res89940', )(Ave67043)
LST58172 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST58172', )(Res89940)
Res82026 = keras.layers.Reshape((3, 1), name = 'Res82026', )(LST58172)
Res9860 = keras.layers.Reshape((3, 1, 1), name = 'Res9860', )(Res82026)
Res86908 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res86908', )(Res9860)
Up_4939 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_4939', )(Res86908)
model = tf.keras.models.Model(inputs=[in0Ave67043], outputs=Up_4939)
w = model.get_layer('LST58172').get_weights() 
w[0] = np.array([[2, 6, 8, 8, 8, 2, 3, 5, 1, 4, 2, 4], [5, 8, 1, 9, 4, 1, 8, 2, 2, 5, 1, 5]])
w[1] = np.array([[3, 4, 2, 6, 4, 9, 6, 7, 7, 3, 9, 3], [1, 5, 5, 10, 4, 5, 3, 7, 8, 10, 8, 6], [7, 9, 10, 3, 10, 9, 2, 5, 10, 2, 9, 10]])
w[2] = np.array([6, 7, 3, 4, 2, 7, 2, 1, 10, 10, 7, 2])
model.get_layer('LST58172').set_weights(w) 
in0Ave67043 = tf.constant([[[[1.0224, 1.5732]], [[1.1004, 1.7223]]]])
print (np.array2string(model.predict([in0Ave67043],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_4939.png')

LAve67043 = average_pooling2D_layer([[[[1.0224, 1.5732]], [[1.1004, 1.7223]]]], 2, 1, Ave67043), 
LRes89940 = reshape_layer(Ave67043, [1, 2], Res89940), 
LLST58172 = lstm_layer(Res89940,[[2, 6, 8, 8, 8, 2, 3, 5, 1, 4, 2, 4], [5, 8, 1, 9, 4, 1, 8, 2, 2, 5, 1, 5]],[[3, 4, 2, 6, 4, 9, 6, 7, 7, 3, 9, 3], [1, 5, 5, 10, 4, 5, 3, 7, 8, 10, 8, 6], [7, 9, 10, 3, 10, 9, 2, 5, 10, 2, 9, 10]],[6, 7, 3, 4, 2, 7, 2, 1, 10, 10, 7, 2], LST58172), 
LRes82026 = reshape_layer(LST58172, [3, 1], Res82026), 
LRes9860 = reshape_layer(Res82026, [3, 1, 1], Res9860), 
LRes86908 = reshape_layer(Res9860, [3, 1, 1, 1], Res86908), 
LUp_4939 = up_sampling3D_layer(Res86908, 1, 1, 2, Up_4939), 
exec_layers([LAve67043,LRes89940,LLST58172,LRes82026,LRes9860,LRes86908,LUp_4939],["Ave67043","Res89940","LST58172","Res82026","Res9860","Res86908","Up_4939"],Up_4939,"Up_4939")

Actual (Unparsed): [[[[[0.7615941], [0.7615941]]], [[[0.7615782], [0.7615782]]], [[[0.7615929], [0.7615929]]]]]

Expected (Unparsed): [[[[[0.7615941229024494],[0.7615941229024494]]],[[[0.7615781519711016],[0.7615781519711016]]],[[[0.761592939658003],[0.761592939658003]]]]]

Actual:   [[[[[0.7616], [0.7616]]], [[[0.7616], [0.7616]]], [[[0.7616], [0.7616]]]]]

Expected: [[[[[0.7616], [0.7616]]], [[[0.7616], [0.7616]]], [[[0.7616], [0.7616]]]]]