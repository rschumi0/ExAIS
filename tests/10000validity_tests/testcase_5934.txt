import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul82581 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul82581 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con6429 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave45572 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave45572 = tf.keras.layers.Input(shape=([2, 2]))
in0Con97519 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Min65014 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Min65014 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Mul82581 = keras.layers.Multiply(name = 'Mul82581', )([in0Mul82581,in1Mul82581])
Zer5305 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer5305', )(Mul82581)
Con6429 = keras.layers.Concatenate(axis=3, name = 'Con6429', )([Zer5305,in0Con6429])
Ave45572 = keras.layers.Average(name = 'Ave45572', )([in0Ave45572,in1Ave45572])
Res78095 = keras.layers.Reshape((2, 2, 1), name = 'Res78095', )(Ave45572)
Con97519 = keras.layers.Concatenate(axis=3, name = 'Con97519', )([Res78095,in0Con97519])
Min65014 = keras.layers.Minimum(name = 'Min65014', )([in0Min65014,in1Min65014])
Res81547 = keras.layers.Reshape((2, 1, 2), name = 'Res81547', )(Min65014)
Ave8765 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Ave8765', )(Res81547)
Zer8920 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer8920', )(Ave8765)
Min11591 = keras.layers.Minimum(name = 'Min11591', )([Con97519,Zer8920])
Mul50050 = keras.layers.Multiply(name = 'Mul50050', )([Con6429,Min11591])
model = tf.keras.models.Model(inputs=[in0Mul82581,in1Mul82581,in0Con6429,in0Ave45572,in1Ave45572,in0Con97519,in0Min65014,in1Min65014], outputs=Mul50050)
in0Mul82581 = tf.constant([[[[0.4743], [0.057]]]])
in1Mul82581 = tf.constant([[[[0.6342], [0.3479]]]])
in0Con6429 = tf.constant([[[[0.7732], [0.2944]], [[0.6464], [0.6913]]]])
in0Ave45572 = tf.constant([[[0.2467, 0.9527], [0.6331, 0.1795]]])
in1Ave45572 = tf.constant([[[0.264, 0.7528], [0.4267, 0.7029]]])
in0Con97519 = tf.constant([[[[0.7712], [0.612]], [[0.0087], [0.0772]]]])
in0Min65014 = tf.constant([[[[[0.1624, 0.6949]]], [[[0.7329, 0.2058]]]]])
in1Min65014 = tf.constant([[[[[0.5328, 0.4362]]], [[[0.7775, 0.7332]]]]])
print (np.array2string(model.predict([in0Mul82581,in1Mul82581,in0Con6429,in0Ave45572,in1Ave45572,in0Con97519,in0Min65014,in1Min65014],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul50050.png')

LMul82581 = multiply_layer([[[[[0.4743], [0.057]]]], [[[[0.6342], [0.3479]]]]], Mul82581), 
LZer5305 = zero_padding2D_layer(Mul82581, 1, 0, 0, 0, Zer5305), 
LCon6429 = concatenate_layer([Zer5305,[[[[0.7732], [0.2944]], [[0.6464], [0.6913]]]]], 3, Con6429), 
LAve45572 = average_layer([[[[0.2467, 0.9527], [0.6331, 0.1795]]], [[[0.264, 0.7528], [0.4267, 0.7029]]]], Ave45572), 
LRes78095 = reshape_layer(Ave45572, [2, 2, 1], Res78095), 
LCon97519 = concatenate_layer([Res78095,[[[[0.7712], [0.612]], [[0.0087], [0.0772]]]]], 3, Con97519), 
LMin65014 = minimum_layer([[[[[[0.1624, 0.6949]]], [[[0.7329, 0.2058]]]]], [[[[[0.5328, 0.4362]]], [[[0.7775, 0.7332]]]]]], Min65014), 
LRes81547 = reshape_layer(Min65014, [2, 1, 2], Res81547), 
LAve8765 = average_pooling2D_layer(Res81547, 1, 1, 1, 1, true, Ave8765), 
LZer8920 = zero_padding2D_layer(Ave8765, 0, 0, 1, 0, Zer8920), 
LMin11591 = minimum_layer([Con97519,Zer8920], Min11591), 
LMul50050 = multiply_layer([Con6429,Min11591], Mul50050), 
exec_layers([LMul82581,LZer5305,LCon6429,LAve45572,LRes78095,LCon97519,LMin65014,LRes81547,LAve8765,LZer8920,LMin11591,LMul50050],["Mul82581","Zer5305","Con6429","Ave45572","Res78095","Con97519","Min65014","Res81547","Ave8765","Zer8920","Min11591","Mul50050"],Mul50050,"Mul50050")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.1284173]], [[0.0000000, 0.0000000], [0.0087491, 0.0533684]]]]

Expected (Unparsed): [[[[0,0.0],[0.0,0.12841728]],[[0.0,0.0],[0.008749128359999999,0.053368360000000004]]]]

Actual:   [[[[0, 0], [0, 0.1285]], [[0, 0], [0.0088, 0.0534]]]]

Expected: [[[[0, 0], [0, 0.1285]], [[0, 0], [0.0088, 0.0534]]]]