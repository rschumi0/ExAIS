import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max74427 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Max74427 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Max74427 = keras.layers.Maximum(name = 'Max74427', )([in0Max74427,in1Max74427])
Res66540 = keras.layers.Reshape((1, 2, 2), name = 'Res66540', )(Max74427)
Res17583 = keras.layers.Reshape((1, 4), name = 'Res17583', )(Res66540)
Fla80935 = keras.layers.Flatten(name = 'Fla80935', )(Res17583)
Res70436 = keras.layers.Reshape((4, 1), name = 'Res70436', )(Fla80935)
Res75872 = keras.layers.Reshape((4, 1, 1), name = 'Res75872', )(Res70436)
Glo28974 = keras.layers.GlobalMaxPool2D(name = 'Glo28974', )(Res75872)
Sof76007 = keras.layers.Softmax(axis=1, name = 'Sof76007', )(Glo28974)
model = tf.keras.models.Model(inputs=[in0Max74427,in1Max74427], outputs=Sof76007)
in0Max74427 = tf.constant([[[[[0.3649, 0.131]], [[0.9908, 0.2481]]]]])
in1Max74427 = tf.constant([[[[[0.3026, 0.8154]], [[0.8676, 0.3987]]]]])
print (np.array2string(model.predict([in0Max74427,in1Max74427],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof76007.png')

LMax74427 = maximum_layer([[[[[[0.3649, 0.131]], [[0.9908, 0.2481]]]]], [[[[[0.3026, 0.8154]], [[0.8676, 0.3987]]]]]], Max74427), 
LRes66540 = reshape_layer(Max74427, [1, 2, 2], Res66540), 
LRes17583 = reshape_layer(Res66540, [1, 4], Res17583), 
LFla80935 = flatten_layer(Res17583, Fla80935), 
LRes70436 = reshape_layer(Fla80935, [4, 1], Res70436), 
LRes75872 = reshape_layer(Res70436, [4, 1, 1], Res75872), 
LGlo28974 = global_max_pool2D_layer(Res75872, Glo28974), 
LSof76007 = softmax_layer(Glo28974, 1, Sof76007), 
exec_layers([LMax74427,LRes66540,LRes17583,LFla80935,LRes70436,LRes75872,LGlo28974,LSof76007],["Max74427","Res66540","Res17583","Fla80935","Res70436","Res75872","Glo28974","Sof76007"],Sof76007,"Sof76007")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[1.0]]

Actual:   [[1]]

Expected: [[1]]