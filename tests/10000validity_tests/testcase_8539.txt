import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro65422 = tf.keras.layers.Input(shape=([3, 4, 4, 1]))

Cro65422 = keras.layers.Cropping3D(cropping=((2, 0), (3, 0), (1, 1)), name = 'Cro65422', )(in0Cro65422)
Den77070 = keras.layers.Dense(4,name = 'Den77070', )(Cro65422)
Res59772 = keras.layers.Reshape((1, 1, 8), name = 'Res59772', )(Den77070)
Res82174 = keras.layers.Reshape((1, 8), name = 'Res82174', )(Res59772)
Fla17695 = keras.layers.Flatten(name = 'Fla17695', )(Res82174)
Res27512 = keras.layers.Reshape((8, 1), name = 'Res27512', )(Fla17695)
PRe73588 = keras.layers.PReLU(name = 'PRe73588', )(Res27512)
model = tf.keras.models.Model(inputs=[in0Cro65422], outputs=PRe73588)
w = model.get_layer('Den77070').get_weights() 
w[0] = np.array([[0.4653, 0.658, 0.9106, 0.0874]])
w[1] = np.array([0.8509, 0.1721, 0.3878, 0.4433])
model.get_layer('Den77070').set_weights(w) 
w = model.get_layer('PRe73588').get_weights() 
w[0] = np.array([[0.3599], [0.9495], [0.4495], [0.2207], [0.3801], [0.1996], [0.258], [0.7405]])
model.get_layer('PRe73588').set_weights(w) 
in0Cro65422 = tf.constant([[[[[1.9882], [1.9785], [1.8352], [1.7117]], [[1.1303], [1.2836], [1.6383], [1.3804]], [[1.9371], [1.3323], [1.9117], [1.3175]], [[1.439], [1.3664], [1.0492], [1.4592]]], [[[1.18], [1.8332], [1.0861], [1.5703]], [[1.2566], [1.2682], [1.2286], [1.1126]], [[1.3538], [1.5182], [1.445], [1.099]], [[1.3247], [1.5298], [1.3631], [1.6735]]], [[[1.7958], [1.5609], [1.3556], [1.6144]], [[1.8671], [1.2045], [1.4874], [1.8249]], [[1.2273], [1.0621], [1.953], [1.1416]], [[1.9054], [1.2474], [1.7338], [1.4729]]]]])
print (np.array2string(model.predict([in0Cro65422],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe73588.png')

LCro65422 = cropping3D_layer([[[[[1.9882], [1.9785], [1.8352], [1.7117]], [[1.1303], [1.2836], [1.6383], [1.3804]], [[1.9371], [1.3323], [1.9117], [1.3175]], [[1.439], [1.3664], [1.0492], [1.4592]]], [[[1.18], [1.8332], [1.0861], [1.5703]], [[1.2566], [1.2682], [1.2286], [1.1126]], [[1.3538], [1.5182], [1.445], [1.099]], [[1.3247], [1.5298], [1.3631], [1.6735]]], [[[1.7958], [1.5609], [1.3556], [1.6144]], [[1.8671], [1.2045], [1.4874], [1.8249]], [[1.2273], [1.0621], [1.953], [1.1416]], [[1.9054], [1.2474], [1.7338], [1.4729]]]]], 2, 0, 3, 0, 1, 1, Cro65422), 
LDen77070 = dense_layer(Cro65422, [[0.4653, 0.658, 0.9106, 0.0874]],[0.8509, 0.1721, 0.3878, 0.4433], Den77070), 
LRes59772 = reshape_layer(Den77070, [1, 1, 8], Res59772), 
LRes82174 = reshape_layer(Res59772, [1, 8], Res82174), 
LFla17695 = flatten_layer(Res82174, Fla17695), 
LRes27512 = reshape_layer(Fla17695, [8, 1], Res27512), 
LPRe73588 = prelu_layer(Res27512, [[0.3599], [0.9495], [0.4495], [0.2207], [0.3801], [0.1996], [0.258], [0.7405]], PRe73588), 
exec_layers([LCro65422,LDen77070,LRes59772,LRes82174,LFla17695,LRes27512,LPRe73588],["Cro65422","Den77070","Res59772","Res82174","Fla17695","Res27512","PRe73588"],PRe73588,"PRe73588")

Actual (Unparsed): [[[1.4313152], [0.9928892], [1.5236825], [0.5523228], [1.6576372], [1.3129404], [1.9665983], [0.5948341]]]

Expected (Unparsed): [[[1.43131522],[0.9928892000000001],[1.52368244],[0.55232276],[1.6576371399999998],[1.3129404],[1.96659828],[0.59483412]]]

Actual:   [[[1.4314], [0.9929], [1.5237], [0.5524], [1.6577], [1.313], [1.9666], [0.5949]]]

Expected: [[[1.4314], [0.9929], [1.5237], [0.5524], [1.6577], [1.313], [1.9666], [0.5949]]]