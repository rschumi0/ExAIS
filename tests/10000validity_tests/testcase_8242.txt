import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave75338 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave75338 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Mul71998 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul71998 = tf.keras.layers.Input(shape=([1, 2, 1]))

Ave75338 = keras.layers.Average(name = 'Ave75338', )([in0Ave75338,in1Ave75338])
Lea27544 = keras.layers.LeakyReLU(alpha=8.631928293199769, name = 'Lea27544', )(Ave75338)
Res13301 = keras.layers.Reshape((1, 1), name = 'Res13301', )(Lea27544)
Mul71998 = keras.layers.Multiply(name = 'Mul71998', )([in0Mul71998,in1Mul71998])
Con92808 = keras.layers.Conv2DTranspose(3, (1, 2),strides=(1, 9), padding='valid', name = 'Con92808', )(Mul71998)
Res86970 = keras.layers.Reshape((1, 54), name = 'Res86970', )(Con92808)
Dot42709 = keras.layers.Dot(axes=(1, 1), name = 'Dot42709', )([Res13301,Res86970])
model = tf.keras.models.Model(inputs=[in0Ave75338,in1Ave75338,in0Mul71998,in1Mul71998], outputs=Dot42709)
w = model.get_layer('Con92808').get_weights() 
w[0] = np.array([[[[0.9625], [0.8781], [0.5014]], [[0.4282], [0.8314], [0.2856]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con92808').set_weights(w) 
in0Ave75338 = tf.constant([[[[0.9373]]]])
in1Ave75338 = tf.constant([[[[0.74]]]])
in0Mul71998 = tf.constant([[[[0.8767], [0.9984]]]])
in1Mul71998 = tf.constant([[[[0.1211], [0.1426]]]])
print (np.array2string(model.predict([in0Ave75338,in1Ave75338,in0Mul71998,in1Mul71998],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot42709.png')

LAve75338 = average_layer([[[[[0.9373]]]], [[[[0.74]]]]], Ave75338), 
LLea27544 = leaky_relu_layer(Ave75338, 8.631928293199769, Lea27544), 
LRes13301 = reshape_layer(Lea27544, [1, 1], Res13301), 
LMul71998 = multiply_layer([[[[[0.8767], [0.9984]]]], [[[[0.1211], [0.1426]]]]], Mul71998), 
LCon92808 = conv2D_transpose_layer(Mul71998, 1, 2,[[[[0.9625], [0.8781], [0.5014]], [[0.4282], [0.8314], [0.2856]]]],[0, 0, 0], 1, 9, false, Con92808), 
LRes86970 = reshape_layer(Con92808, [1, 54], Res86970), 
LDot42709 = dot_layer(Res13301,Res86970, 1, 1, Dot42709), 
exec_layers([LAve75338,LLea27544,LRes13301,LMul71998,LCon92808,LRes86970,LDot42709],["Ave75338","Lea27544","Res13301","Mul71998","Con92808","Res86970","Dot42709"],Dot42709,"Dot42709")

Actual (Unparsed): [[[0.0856992, 0.0781844, 0.0446437, 0.0381261, 0.0740263, 0.0254293, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.1149226, 0.1048453, 0.0598672, 0.0511271, 0.0992693, 0.0341007, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.08569917461923125,0.07818435868378905,0.04464370509515069,0.0381261159189141,0.07402627925031571,0.025429282359742802,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.11492263823040001,0.1048452661092096,0.0598672320090624,0.0511271414963712,0.0992692794023424,0.034100681016729605,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]]]

Actual:   [[[0.0857, 0.0782, 0.0447, 0.0382, 0.0741, 0.0255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.115, 0.1049, 0.0599, 0.0512, 0.0993, 0.0342, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]

Expected: [[[0.0857, 0.0782, 0.0447, 0.0382, 0.0741, 0.0255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.115, 0.1049, 0.0599, 0.0512, 0.0993, 0.0342, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]