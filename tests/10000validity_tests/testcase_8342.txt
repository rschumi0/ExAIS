import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL32130 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

ReL32130 = keras.layers.ReLU(max_value=5.5092001844184635, negative_slope=9.401630764456515, threshold=0.778895367286152, name = 'ReL32130', input_shape=(2, 2, 1, 1))(in0ReL32130)
Res60783 = keras.layers.Reshape((2, 2, 1), name = 'Res60783', )(ReL32130)
Res67891 = keras.layers.Reshape((2, 2), name = 'Res67891', )(Res60783)
Sep2328 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep2328', )(Res67891)
model = tf.keras.models.Model(inputs=[in0ReL32130], outputs=Sep2328)
w = model.get_layer('Sep2328').get_weights() 
w[0] = np.array([[[0.7232], [0.3939]]])
w[1] = np.array([[[0.1241, 0.5456, 0.0626, 0.2233], [0.3705, 0.9174, 0.0058, 0.5192]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep2328').set_weights(w) 
in0ReL32130 = tf.constant([[[[[0.1648]], [[0.4013]]], [[[0.9679]], [[0.5584]]]]])
print (np.array2string(model.predict([in0ReL32130],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep2328.png')

LReL32130 = relu_layer([[[[[0.1648]], [[0.4013]]], [[[0.9679]], [[0.5584]]]]], 5.5092001844184635, 9.401630764456515, 0.778895367286152, ReL32130), 
LRes60783 = reshape_layer(ReL32130, [2, 2, 1], Res60783), 
LRes67891 = reshape_layer(Res60783, [2, 2], Res67891), 
LSep2328 = separable_conv1D_layer(Res67891, 1,[[[[0.7232], [0.3939]]],[[[0.1241, 0.5456, 0.0626, 0.2233], [0.3705, 0.9174, 0.0058, 0.5192]]]],[0, 0, 0, 0], 1, false, Sep2328), 
exec_layers([LReL32130,LRes60783,LRes67891,LSep2328],["ReL32130","Res60783","Res67891","Sep2328"],Sep2328,"Sep2328")

Actual (Unparsed): [[[-1.0362549, -3.5609409, -0.2694901, -1.6583886], [-0.2156677, -0.3672012, 0.0390830, -0.2676518]]]

Expected (Unparsed): [[[-1.0362549617311771,-3.560940910917906,-0.26949007325156105,-1.6583886320812984],[-0.215667682300142,-0.36720110513177195,0.03908302464897375,-0.2676517652502114]]]

Actual:   [[[-1.0362, -3.5609, -0.2694, -1.6583], [-0.2156, -0.3672, 0.0391, -0.2676]]]

Expected: [[[-1.0362, -3.5609, -0.2694, -1.6583], [-0.2156, -0.3672, 0.0391, -0.2676]]]