import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub79862 = tf.keras.layers.Input(shape=([3, 3, 2, 3]))
in1Sub79862 = tf.keras.layers.Input(shape=([3, 3, 2, 3]))

Sub79862 = keras.layers.Subtract(name = 'Sub79862', )([in0Sub79862,in1Sub79862])
Mas83652 = keras.layers.Masking(mask_value=2, name = 'Mas83652', )(Sub79862)
Res94384 = keras.layers.Reshape((3, 3, 6), name = 'Res94384', )(Mas83652)
Res6483 = keras.layers.Reshape((3, 18), name = 'Res6483', )(Res94384)
Zer37643 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer37643', )(Res6483)
Sof98088 = keras.layers.Softmax(axis=1, name = 'Sof98088', )(Zer37643)
model = tf.keras.models.Model(inputs=[in0Sub79862,in1Sub79862], outputs=Sof98088)
in0Sub79862 = tf.constant([[[[[0.7533, 0.9552, 0.5541], [0.0456, 0.2176, 0.8913]], [[0.8157, 0.7027, 0.5179], [0.7858, 0.8843, 0.3453]], [[0.7594, 0.3468, 0.9554], [0.7725, 0.2606, 0.3153]]], [[[0.1354, 0.7035, 0.0764], [0.1953, 0.8469, 0.2592]], [[0.1634, 0.3521, 0.6008], [0.9841, 0.2774, 0.7401]], [[0.6964, 0.6012, 0.0819], [0.1398, 0.8202, 0.9494]]], [[[0.6228, 0.9346, 0.6989], [0.8453, 0.274, 0.135]], [[0.935, 0.9316, 0.4981], [0.575, 0.9035, 0.9251]], [[0.2816, 0.9434, 0.1188], [0.0643, 0.8996, 0.5907]]]]])
in1Sub79862 = tf.constant([[[[[0.7972, 0.9696, 0.7493], [0.8564, 0.432, 0.5747]], [[0.3451, 0.9993, 0.078], [0.2688, 0.2165, 0.6794]], [[0.6952, 0.8924, 0.368], [0.3436, 0.3424, 0.7762]]], [[[0.1664, 0.7927, 0.2323], [0.5776, 0.0061, 0.6746]], [[0.6573, 0.2767, 0.869], [0.6368, 0.5792, 0.3239]], [[0.9444, 0.3995, 0.2418], [0.5993, 0.8018, 0.064]]], [[[0.5049, 0.5378, 0.2225], [0.5592, 0.7291, 0.5029]], [[0.6838, 0.2465, 0.9455], [0.2507, 0.6666, 0.3528]], [[0.7329, 0.1148, 0.408], [0.0835, 0.696, 0.3659]]]]])
print (np.array2string(model.predict([in0Sub79862,in1Sub79862],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof98088.png')

LSub79862 = subtract_layer([[[[[0.7533, 0.9552, 0.5541], [0.0456, 0.2176, 0.8913]], [[0.8157, 0.7027, 0.5179], [0.7858, 0.8843, 0.3453]], [[0.7594, 0.3468, 0.9554], [0.7725, 0.2606, 0.3153]]], [[[0.1354, 0.7035, 0.0764], [0.1953, 0.8469, 0.2592]], [[0.1634, 0.3521, 0.6008], [0.9841, 0.2774, 0.7401]], [[0.6964, 0.6012, 0.0819], [0.1398, 0.8202, 0.9494]]], [[[0.6228, 0.9346, 0.6989], [0.8453, 0.274, 0.135]], [[0.935, 0.9316, 0.4981], [0.575, 0.9035, 0.9251]], [[0.2816, 0.9434, 0.1188], [0.0643, 0.8996, 0.5907]]]]], [[[[[0.7972, 0.9696, 0.7493], [0.8564, 0.432, 0.5747]], [[0.3451, 0.9993, 0.078], [0.2688, 0.2165, 0.6794]], [[0.6952, 0.8924, 0.368], [0.3436, 0.3424, 0.7762]]], [[[0.1664, 0.7927, 0.2323], [0.5776, 0.0061, 0.6746]], [[0.6573, 0.2767, 0.869], [0.6368, 0.5792, 0.3239]], [[0.9444, 0.3995, 0.2418], [0.5993, 0.8018, 0.064]]], [[[0.5049, 0.5378, 0.2225], [0.5592, 0.7291, 0.5029]], [[0.6838, 0.2465, 0.9455], [0.2507, 0.6666, 0.3528]], [[0.7329, 0.1148, 0.408], [0.0835, 0.696, 0.3659]]]]], Sub79862), 
LMas83652 = masking_layer(Sub79862, 2, Mas83652), 
LRes94384 = reshape_layer(Mas83652, [3, 3, 6], Res94384), 
LRes6483 = reshape_layer(Res94384, [3, 18], Res6483), 
LZer37643 = zero_padding1D_layer(Res6483, 2, 0, Zer37643), 
LSof98088 = softmax_layer(Zer37643, 1, Sof98088), 
exec_layers([LSub79862,LMas83652,LRes94384,LRes6483,LZer37643,LSof98088],["Sub79862","Mas83652","Res94384","Res6483","Zer37643","Sof98088"],Sof98088,"Sof98088")

Actual (Unparsed): [[[0.1979549, 0.1856175, 0.1890866, 0.2243149, 0.1736222, 0.2116529, 0.1819252, 0.1722467, 0.2017514, 0.1544332, 0.1678770, 0.1665415, 0.2230418, 0.1641205, 0.1851716, 0.1942445, 0.1935796, 0.1585605], [0.1979549, 0.1856175, 0.1890866, 0.2243149, 0.1736222, 0.2116529, 0.1819252, 0.1722467, 0.2017514, 0.1544332, 0.1678770, 0.1665415, 0.2230418, 0.1641205, 0.1851716, 0.1942445, 0.1935796, 0.1585605], [0.1894526, 0.1829637, 0.1555559, 0.0997085, 0.1401176, 0.2904838, 0.2912540, 0.1280381, 0.3132295, 0.2589828, 0.3273505, 0.1192407, 0.2378307, 0.0951068, 0.3331801, 0.2982756, 0.1783751, 0.1000066], [0.1919124, 0.1697773, 0.1617910, 0.1530479, 0.4024947, 0.1397071, 0.1110184, 0.1857363, 0.1542904, 0.2185602, 0.1241427, 0.2525084, 0.1740529, 0.2007983, 0.1578086, 0.1226847, 0.1971744, 0.3843433], [0.2227253, 0.2760240, 0.3044799, 0.2986138, 0.1101433, 0.1465033, 0.2338771, 0.3417323, 0.1289773, 0.2135907, 0.2127529, 0.2951679, 0.1420329, 0.3758540, 0.1386681, 0.1905506, 0.2372913, 0.1985292]]]

Expected (Unparsed): [[[0.1979548561939677,0.18561745746245556,0.18908660732989324,0.22431491948056792,0.17362223835632654,0.21165292985344558,0.18192523807083671,0.1722466870046162,0.20175140750872633,0.1544331774972031,0.1678769742686515,0.16654148289932383,0.2230417591582301,0.16412046803091504,0.18517162090910283,0.19424453511533668,0.1935795738834704,0.15856047884237792],[0.1979548561939677,0.18561745746245556,0.18908660732989324,0.22431491948056792,0.17362223835632654,0.21165292985344558,0.18192523807083671,0.1722466870046162,0.20175140750872633,0.1544331774972031,0.1678769742686515,0.16654148289932383,0.2230417591582301,0.16412046803091504,0.18517162090910283,0.19424453511533668,0.1935795738834704,0.15856047884237792],[0.18945262735132878,0.18296371884945456,0.15555589959402114,0.09970850258777897,0.14011757549990256,0.2904838002824237,0.2912540245124912,0.1280380744160473,0.3132295422631953,0.2589827597132959,0.3273504845557851,0.11924073405815942,0.23783068542577196,0.09510682364877415,0.33318006368962666,0.29827558934299514,0.17837510464889483,0.10000659067051391],[0.19191239765182913,0.16977735047180387,0.16179096296453477,0.15304790164731447,0.4024946863485287,0.1397070611089575,0.11101838551349943,0.18573625360918603,0.15429036029380785,0.21856020070112778,0.12414266334527584,0.2525083771334303,0.1740528545253494,0.20079825937530127,0.1578086267241534,0.1226847252770113,0.1971744091052546,0.3843432719069567],[0.22272526260890685,0.27602401575383034,0.3044799227816577,0.2986137568037706,0.11014326143891573,0.1465032789017275,0.23387711383233595,0.3417322979655342,0.12897728242554413,0.2135906845911701,0.21275290356163606,0.2951679230097626,0.14203294173241843,0.3758539809140944,0.1386680677680143,0.19055061514932012,0.23729133847890985,0.1985291797377735]]]

Actual:   [[[0.198, 0.1857, 0.1891, 0.2244, 0.1737, 0.2117, 0.182, 0.1723, 0.2018, 0.1545, 0.1679, 0.1666, 0.2231, 0.1642, 0.1852, 0.1943, 0.1936, 0.1586], [0.198, 0.1857, 0.1891, 0.2244, 0.1737, 0.2117, 0.182, 0.1723, 0.2018, 0.1545, 0.1679, 0.1666, 0.2231, 0.1642, 0.1852, 0.1943, 0.1936, 0.1586], [0.1895, 0.183, 0.1556, 0.0998, 0.1402, 0.2905, 0.2913, 0.1281, 0.3133, 0.259, 0.3274, 0.1193, 0.2379, 0.0952, 0.3332, 0.2983, 0.1784, 0.1001], [0.192, 0.1698, 0.1618, 0.1531, 0.4025, 0.1398, 0.1111, 0.1858, 0.1543, 0.2186, 0.1242, 0.2526, 0.1741, 0.2008, 0.1579, 0.1227, 0.1972, 0.3844], [0.2228, 0.2761, 0.3045, 0.2987, 0.1102, 0.1466, 0.2339, 0.3418, 0.129, 0.2136, 0.2128, 0.2952, 0.1421, 0.3759, 0.1387, 0.1906, 0.2373, 0.1986]]]

Expected: [[[0.198, 0.1857, 0.1891, 0.2244, 0.1737, 0.2117, 0.182, 0.1723, 0.2018, 0.1545, 0.1679, 0.1666, 0.2231, 0.1642, 0.1852, 0.1943, 0.1936, 0.1586], [0.198, 0.1857, 0.1891, 0.2244, 0.1737, 0.2117, 0.182, 0.1723, 0.2018, 0.1545, 0.1679, 0.1666, 0.2231, 0.1642, 0.1852, 0.1943, 0.1936, 0.1586], [0.1895, 0.183, 0.1556, 0.0998, 0.1402, 0.2905, 0.2913, 0.1281, 0.3133, 0.259, 0.3274, 0.1193, 0.2379, 0.0952, 0.3332, 0.2983, 0.1784, 0.1001], [0.192, 0.1698, 0.1618, 0.1531, 0.4025, 0.1398, 0.1111, 0.1858, 0.1543, 0.2186, 0.1242, 0.2526, 0.1741, 0.2008, 0.1579, 0.1227, 0.1972, 0.3844], [0.2228, 0.2761, 0.3045, 0.2987, 0.1102, 0.1466, 0.2339, 0.3418, 0.129, 0.2136, 0.2128, 0.2952, 0.1421, 0.3759, 0.1387, 0.1906, 0.2373, 0.1986]]]