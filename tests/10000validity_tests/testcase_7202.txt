import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave91240 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Ave91240 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Add79214 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add79214 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con26340 = tf.keras.layers.Input(shape=([3, 3, 2]))

Ave91240 = keras.layers.Average(name = 'Ave91240', )([in0Ave91240,in1Ave91240])
Zer82433 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer82433', )(Ave91240)
Res45902 = keras.layers.Reshape((3, 3, 3), name = 'Res45902', )(Zer82433)
Add79214 = keras.layers.Add(name = 'Add79214', )([in0Add79214,in1Add79214])
Zer66547 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer66547', )(Add79214)
Con26340 = keras.layers.Concatenate(axis=3, name = 'Con26340', )([Zer66547,in0Con26340])
Max41573 = keras.layers.Maximum(name = 'Max41573', )([Res45902,Con26340])
model = tf.keras.models.Model(inputs=[in0Ave91240,in1Ave91240,in0Add79214,in1Add79214,in0Con26340], outputs=Max41573)
in0Ave91240 = tf.constant([[[[[0.1505]]]]])
in1Ave91240 = tf.constant([[[[[0.0777]]]]])
in0Add79214 = tf.constant([[[[0.4796]], [[0.1344]]]])
in1Add79214 = tf.constant([[[[0.8368]], [[0.5431]]]])
in0Con26340 = tf.constant([[[[0.2327, 0.9931], [0.063, 0.4302], [0.4052, 0.0636]], [[0.7954, 0.0724], [0.9167, 0.3788], [0.2788, 0.4298]], [[0.1816, 0.2751], [0.8038, 0.4385], [0.329, 0.9407]]]])
print (np.array2string(model.predict([in0Ave91240,in1Ave91240,in0Add79214,in1Add79214,in0Con26340],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max41573.png')

LAve91240 = average_layer([[[[[[0.1505]]]]], [[[[[0.0777]]]]]], Ave91240), 
LZer82433 = zero_padding3D_layer(Ave91240, 1, 1, 1, 1, 1, 1, Zer82433), 
LRes45902 = reshape_layer(Zer82433, [3, 3, 3], Res45902), 
LAdd79214 = add_layer([[[[[0.4796]], [[0.1344]]]], [[[[0.8368]], [[0.5431]]]]], Add79214), 
LZer66547 = zero_padding2D_layer(Add79214, 1, 0, 2, 0, Zer66547), 
LCon26340 = concatenate_layer([Zer66547,[[[[0.2327, 0.9931], [0.063, 0.4302], [0.4052, 0.0636]], [[0.7954, 0.0724], [0.9167, 0.3788], [0.2788, 0.4298]], [[0.1816, 0.2751], [0.8038, 0.4385], [0.329, 0.9407]]]]], 3, Con26340), 
LMax41573 = maximum_layer([Res45902,Con26340], Max41573), 
exec_layers([LAve91240,LZer82433,LRes45902,LAdd79214,LZer66547,LCon26340,LMax41573],["Ave91240","Zer82433","Res45902","Add79214","Zer66547","Con26340","Max41573"],Max41573,"Max41573")

Actual (Unparsed): [[[[0.0000000, 0.2327000, 0.9931000], [0.0000000, 0.0630000, 0.4302000], [0.0000000, 0.4052000, 0.0636000]], [[0.0000000, 0.7954000, 0.0724000], [0.0000000, 0.9167000, 0.3788000], [1.3164000, 0.2788000, 0.4298000]], [[0.0000000, 0.1816000, 0.2751000], [0.0000000, 0.8038000, 0.4385000], [0.6775000, 0.3290000, 0.9407000]]]]

Expected (Unparsed): [[[[0,0.2327,0.9931],[0,0.063,0.4302],[0,0.4052,0.0636]],[[0,0.7954,0.0724],[0,0.9167,0.3788],[1.3164,0.2788,0.4298]],[[0,0.1816,0.2751],[0,0.8038,0.4385],[0.6775,0.329,0.9407]]]]

Actual:   [[[[0, 0.2327, 0.9931], [0, 0.063, 0.4302], [0, 0.4052, 0.0636]], [[0, 0.7954, 0.0724], [0, 0.9167, 0.3788], [1.3164, 0.2788, 0.4298]], [[0, 0.1816, 0.2751], [0, 0.8038, 0.4385], [0.6775, 0.329, 0.9407]]]]

Expected: [[[[0, 0.2327, 0.9931], [0, 0.063, 0.4302], [0, 0.4052, 0.0636]], [[0, 0.7954, 0.0724], [0, 0.9167, 0.3788], [1.3164, 0.2788, 0.4298]], [[0, 0.1816, 0.2751], [0, 0.8038, 0.4385], [0.6775, 0.329, 0.9407]]]]