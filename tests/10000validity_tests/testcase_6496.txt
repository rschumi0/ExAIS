import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min20742 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Min20742 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Min20742 = keras.layers.Minimum(name = 'Min20742', )([in0Min20742,in1Min20742])
Res51344 = keras.layers.Reshape((2, 2, 4), name = 'Res51344', )(Min20742)
Res41142 = keras.layers.Reshape((2, 8), name = 'Res41142', )(Res51344)
Mas22599 = keras.layers.Masking(mask_value=1, name = 'Mas22599', )(Res41142)
Res76394 = keras.layers.Reshape((2, 8, 1), name = 'Res76394', )(Mas22599)
Max27067 = keras.layers.MaxPool2D(pool_size=(1, 7), strides=(1, 1), padding='same', name = 'Max27067', )(Res76394)
Dep71283 = keras.layers.DepthwiseConv2D((1, 3),strides=(2, 2), padding='same', name = 'Dep71283', )(Max27067)
model = tf.keras.models.Model(inputs=[in0Min20742,in1Min20742], outputs=Dep71283)
w = model.get_layer('Dep71283').get_weights() 
w[0] = np.array([[[[0.5307]], [[0.2365]], [[0.3854]]]])
w[1] = np.array([0])
model.get_layer('Dep71283').set_weights(w) 
in0Min20742 = tf.constant([[[[[0.6603, 0.3531], [0.542, 0.7091]], [[0.4542, 0.0855], [0.9111, 0.9465]]], [[[0.5023, 0.7317], [0.7497, 0.9706]], [[0.0244, 0.0376], [0.5193, 0.0886]]]]])
in1Min20742 = tf.constant([[[[[0.6011, 0.4325], [0.2458, 0.2032]], [[0.2235, 0.0786], [0.0375, 0.2315]]], [[[0.6591, 0.0954], [0.9062, 0.7001]], [[0.9892, 0.7209], [0.647, 0.3282]]]]])
print (np.array2string(model.predict([in0Min20742,in1Min20742],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep71283.png')

LMin20742 = minimum_layer([[[[[[0.6603, 0.3531], [0.542, 0.7091]], [[0.4542, 0.0855], [0.9111, 0.9465]]], [[[0.5023, 0.7317], [0.7497, 0.9706]], [[0.0244, 0.0376], [0.5193, 0.0886]]]]], [[[[[0.6011, 0.4325], [0.2458, 0.2032]], [[0.2235, 0.0786], [0.0375, 0.2315]]], [[[0.6591, 0.0954], [0.9062, 0.7001]], [[0.9892, 0.7209], [0.647, 0.3282]]]]]], Min20742), 
LRes51344 = reshape_layer(Min20742, [2, 2, 4], Res51344), 
LRes41142 = reshape_layer(Res51344, [2, 8], Res41142), 
LMas22599 = masking_layer(Res41142, 1, Mas22599), 
LRes76394 = reshape_layer(Mas22599, [2, 8, 1], Res76394), 
LMax27067 = max_pool2D_layer(Res76394, 1, 7, 1, 1, true, Max27067), 
LDep71283 = depthwise_conv2D_layer(Max27067, 1, 3,[[[[0.5307]], [[0.2365]], [[0.3854]]]],[0], 2, 2, true, Dep71283), 
exec_layers([LMin20742,LRes51344,LRes41142,LMas22599,LRes76394,LMax27067,LDep71283],["Min20742","Res51344","Res41142","Mas22599","Res76394","Max27067","Dep71283"],Dep71283,"Dep71283")

Actual (Unparsed): [[[[0.6928279], [0.5972487], [0.3347420], [0.1776068]]]]

Expected (Unparsed): [[[[0.69282786],[0.59724866],[0.33474197],[0.1776068]]]]

Actual:   [[[[0.6929], [0.5973], [0.3348], [0.1777]]]]

Expected: [[[[0.6929], [0.5973], [0.3348], [0.1777]]]]