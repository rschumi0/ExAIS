import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub94333 = tf.keras.layers.Input(shape=([3]))
in1Sub94333 = tf.keras.layers.Input(shape=([3]))
in0Min81406 = tf.keras.layers.Input(shape=([2, 1]))
in1Min81406 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave48079 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave48079 = tf.keras.layers.Input(shape=([1, 1]))

Sub94333 = keras.layers.Subtract(name = 'Sub94333', )([in0Sub94333,in1Sub94333])
Res30147 = keras.layers.Reshape((3, 1), name = 'Res30147', )(Sub94333)
Min81406 = keras.layers.Minimum(name = 'Min81406', )([in0Min81406,in1Min81406])
Ave48079 = keras.layers.Average(name = 'Ave48079', )([in0Ave48079,in1Ave48079])
Zer49598 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer49598', )(Ave48079)
Mul77782 = keras.layers.Multiply(name = 'Mul77782', )([Min81406,Zer49598])
Dot4702 = keras.layers.Dot(axes=(2, 2), name = 'Dot4702', )([Res30147,Mul77782])
Sep30775 = keras.layers.SeparableConv1D(4, (2),strides=(3), padding='same', name = 'Sep30775', )(Dot4702)
model = tf.keras.models.Model(inputs=[in0Sub94333,in1Sub94333,in0Min81406,in1Min81406,in0Ave48079,in1Ave48079], outputs=Sep30775)
w = model.get_layer('Sep30775').get_weights() 
w[0] = np.array([[[0.064], [0.3777]], [[0.0998], [0.7254]]])
w[1] = np.array([[[0.9827, 0.021, 0.1807, 0.3875], [0.1342, 0.4452, 0.4041, 0.4796]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep30775').set_weights(w) 
in0Sub94333 = tf.constant([[0.1232, 0.3738, 0.6932]])
in1Sub94333 = tf.constant([[0.7324, 0.0546, 0.0198]])
in0Min81406 = tf.constant([[[0.5201], [0.5878]]])
in1Min81406 = tf.constant([[[0.7939], [0.6102]]])
in0Ave48079 = tf.constant([[[0.212]]])
in1Ave48079 = tf.constant([[[0.9658]]])
print (np.array2string(model.predict([in0Sub94333,in1Sub94333,in0Min81406,in1Min81406,in0Ave48079,in1Ave48079],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep30775.png')

LSub94333 = subtract_layer([[0.1232, 0.3738, 0.6932]], [[0.7324, 0.0546, 0.0198]], Sub94333), 
LRes30147 = reshape_layer(Sub94333, [3, 1], Res30147), 
LMin81406 = minimum_layer([[[[0.5201], [0.5878]]], [[[0.7939], [0.6102]]]], Min81406), 
LAve48079 = average_layer([[[[0.212]]], [[[0.9658]]]], Ave48079), 
LZer49598 = zero_padding1D_layer(Ave48079, 1, 0, Zer49598), 
LMul77782 = multiply_layer([Min81406,Zer49598], Mul77782), 
LDot4702 = dot_layer(Res30147,Mul77782, 2, 2, Dot4702), 
LSep30775 = separable_conv1D_layer(Dot4702, 2,[[[[0.064], [0.3777]], [[0.0998], [0.7254]]],[[[0.9827, 0.021, 0.1807, 0.3875], [0.1342, 0.4452, 0.4041, 0.4796]]]],[0, 0, 0, 0], 3, true, Sep30775), 
exec_layers([LSub94333,LRes30147,LMin81406,LAve48079,LZer49598,LMul77782,LDot4702,LSep30775],["Sub94333","Res30147","Min81406","Ave48079","Zer49598","Mul77782","Dot4702","Sep30775"],Sep30775,"Sep30775")

Actual (Unparsed): [[[0.0000675, 0.0002239, 0.0002032, 0.0002412]]]

Expected (Unparsed): [[[6.749031270071419e-5,0.00022389483766287882,0.00020322530076272854,0.00024119488801238598]]]

Actual:   [[[0.0001, 0.0003, 0.0003, 0.0003]]]

Expected: [[[0.0001, 0.0003, 0.0003, 0.0003]]]