import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer12429 = tf.keras.layers.Input(shape=([1, 4]))

Zer12429 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer12429', )(in0Zer12429)
Per35383 = keras.layers.Permute((1,2), name = 'Per35383',)(Zer12429)
Res10099 = keras.layers.Reshape((3, 4, 1), name = 'Res10099', )(Per35383)
Res1985 = keras.layers.Reshape((3, 4, 1, 1), name = 'Res1985', )(Res10099)
Glo54826 = keras.layers.GlobalAveragePooling3D(name = 'Glo54826', )(Res1985)
Res21399 = keras.layers.Reshape((1, 1), name = 'Res21399', )(Glo54826)
LST43932 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST43932', )(Res21399)
model = tf.keras.models.Model(inputs=[in0Zer12429], outputs=LST43932)
w = model.get_layer('LST43932').get_weights() 
w[0] = np.array([[1, 5, 3, 5, 6, 4, 7, 9]])
w[1] = np.array([[2, 9, 2, 1, 4, 10, 4, 5], [2, 3, 1, 3, 5, 7, 5, 9]])
w[2] = np.array([5, 10, 5, 4, 1, 5, 7, 7])
model.get_layer('LST43932').set_weights(w) 
in0Zer12429 = tf.constant([[[1.0022, 1.3142, 1.7022, 1.999]]])
print (np.array2string(model.predict([in0Zer12429],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST43932.png')

LZer12429 = zero_padding1D_layer([[[1.0022, 1.3142, 1.7022, 1.999]]], 1, 1, Zer12429), 
LPer35383 = permute_layer(Zer12429, 1,2, Per35383), 
LRes10099 = reshape_layer(Per35383, [3, 4, 1], Res10099), 
LRes1985 = reshape_layer(Res10099, [3, 4, 1, 1], Res1985), 
LGlo54826 = global_average_pooling3D_layer(Res1985, Glo54826), 
LRes21399 = reshape_layer(Glo54826, [1, 1], Res21399), 
LLST43932 = lstm_layer(Res21399,[[1, 5, 3, 5, 6, 4, 7, 9]],[[2, 9, 2, 1, 4, 10, 4, 5], [2, 3, 1, 3, 5, 7, 5, 9]],[5, 10, 5, 4, 1, 5, 7, 7], LST43932), 
exec_layers([LZer12429,LPer35383,LRes10099,LRes1985,LGlo54826,LRes21399,LLST43932],["Zer12429","Per35383","Res10099","Res1985","Glo54826","Res21399","LST43932"],LST43932,"LST43932")

Actual (Unparsed): [[0.7595838, 0.7615843]]

Expected (Unparsed): [[0.7595838172228144,0.7615842982454493]]

Actual:   [[0.7596, 0.7616]]

Expected: [[0.7596, 0.7616]]