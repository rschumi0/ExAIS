import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub78884 = tf.keras.layers.Input(shape=([3]))
in1Sub78884 = tf.keras.layers.Input(shape=([3]))

Sub78884 = keras.layers.Subtract(name = 'Sub78884', )([in0Sub78884,in1Sub78884])
Res88496 = keras.layers.Reshape((3, 1), name = 'Res88496', )(Sub78884)
Max59423 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max59423', )(Res88496)
Res19179 = keras.layers.Reshape((1, 1, 1), name = 'Res19179', )(Max59423)
Con48407 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con48407', )(Res19179)
model = tf.keras.models.Model(inputs=[in0Sub78884,in1Sub78884], outputs=Con48407)
w = model.get_layer('Con48407').get_weights() 
w[0] = np.array([[[[0.8156, 0.7133]]]])
w[1] = np.array([0, 0])
model.get_layer('Con48407').set_weights(w) 
in0Sub78884 = tf.constant([[0.3998, 0.29, 0.6051]])
in1Sub78884 = tf.constant([[0.2075, 0.405, 0.4327]])
print (np.array2string(model.predict([in0Sub78884,in1Sub78884],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con48407.png')

LSub78884 = subtract_layer([[0.3998, 0.29, 0.6051]], [[0.2075, 0.405, 0.4327]], Sub78884), 
LRes88496 = reshape_layer(Sub78884, [3, 1], Res88496), 
LMax59423 = max_pool1D_layer(Res88496, 2, Max59423), 
LRes19179 = reshape_layer(Max59423, [1, 1, 1], Res19179), 
LCon48407 = conv2D_layer(Res19179, 1, 1,[[[[0.8156, 0.7133]]]],[0, 0], 1, 1, true, 1, 1, Con48407), 
exec_layers([LSub78884,LRes88496,LMax59423,LRes19179,LCon48407],["Sub78884","Res88496","Max59423","Res19179","Con48407"],Con48407,"Con48407")

Actual (Unparsed): [[[[0.1568399, 0.1371676]]]]

Expected (Unparsed): [[[[0.15683988,0.13716759]]]]

Actual:   [[[[0.1569, 0.1372]]]]

Expected: [[[[0.1569, 0.1372]]]]