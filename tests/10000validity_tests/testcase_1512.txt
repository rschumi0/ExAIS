import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro50418 = tf.keras.layers.Input(shape=([2, 4, 2, 4]))

Cro50418 = keras.layers.Cropping3D(cropping=((0, 0), (3, 0), (1, 0)), name = 'Cro50418', )(in0Cro50418)
Glo53667 = keras.layers.GlobalAveragePooling3D(name = 'Glo53667', )(Cro50418)
Res85203 = keras.layers.Reshape((4, 1), name = 'Res85203', )(Glo53667)
Res67438 = keras.layers.Reshape((4, 1, 1), name = 'Res67438', )(Res85203)
Con22110 = keras.layers.Conv2D(3, (4, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con22110', )(Res67438)
model = tf.keras.models.Model(inputs=[in0Cro50418], outputs=Con22110)
w = model.get_layer('Con22110').get_weights() 
w[0] = np.array([[[[0.8514, 0.0564, 0.6238]]], [[[0.3914, 0.2078, 0.4122]]], [[[0.0134, 0.7624, 0.0237]]], [[[0.855, 0.5405, 0.0135]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con22110').set_weights(w) 
in0Cro50418 = tf.constant([[[[[1.6982, 1.4648, 1.6159, 1.38], [1.376, 1.8896, 1.7567, 1.4262]], [[1.9748, 1.2264, 1.1845, 1.7149], [1.6972, 1.1123, 1.8164, 1.0628]], [[1.883, 1.6154, 1.9677, 1.0937], [1.8194, 1.7758, 1.3409, 1.4672]], [[1.3705, 1.9279, 1.7083, 1.1985], [1.6523, 1.5066, 1.2715, 1.0235]]], [[[1.9038, 1.0279, 1.0504, 1.3384], [1.7766, 1.3315, 1.6844, 1.7115]], [[1.4978, 1.9736, 1.7113, 1.3464], [1.7474, 1.8668, 1.7331, 1.1634]], [[1.6397, 1.8771, 1.8707, 1.3549], [1.8916, 1.1106, 1.5679, 1.3735]], [[1.1236, 1.0473, 1.1099, 1.312], [1.2476, 1.5122, 1.1902, 1.5496]]]]])
print (np.array2string(model.predict([in0Cro50418],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con22110.png')

LCro50418 = cropping3D_layer([[[[[1.6982, 1.4648, 1.6159, 1.38], [1.376, 1.8896, 1.7567, 1.4262]], [[1.9748, 1.2264, 1.1845, 1.7149], [1.6972, 1.1123, 1.8164, 1.0628]], [[1.883, 1.6154, 1.9677, 1.0937], [1.8194, 1.7758, 1.3409, 1.4672]], [[1.3705, 1.9279, 1.7083, 1.1985], [1.6523, 1.5066, 1.2715, 1.0235]]], [[[1.9038, 1.0279, 1.0504, 1.3384], [1.7766, 1.3315, 1.6844, 1.7115]], [[1.4978, 1.9736, 1.7113, 1.3464], [1.7474, 1.8668, 1.7331, 1.1634]], [[1.6397, 1.8771, 1.8707, 1.3549], [1.8916, 1.1106, 1.5679, 1.3735]], [[1.1236, 1.0473, 1.1099, 1.312], [1.2476, 1.5122, 1.1902, 1.5496]]]]], 0, 0, 3, 0, 1, 0, Cro50418), 
LGlo53667 = global_average_pooling3D_layer(Cro50418, Glo53667), 
LRes85203 = reshape_layer(Glo53667, [4, 1], Res85203), 
LRes67438 = reshape_layer(Res85203, [4, 1, 1], Res67438), 
LCon22110 = conv2D_layer(Res67438, 4, 1,[[[[0.8514, 0.0564, 0.6238]]], [[[0.3914, 0.2078, 0.4122]]], [[[0.0134, 0.7624, 0.0237]]], [[[0.855, 0.5405, 0.0135]]]],[0, 0, 0], 1, 1, false, 1, 1, Con22110), 
exec_layers([LCro50418,LGlo53667,LRes85203,LRes67438,LCon22110],["Cro50418","Glo53667","Res85203","Res67438","Con22110"],Con22110,"Con22110")

Actual (Unparsed): [[[[2.9417602, 2.0292108, 1.5731931]]]]

Expected (Unparsed): [[[[2.94176023,2.029210815,1.5731930600000001]]]]

Actual:   [[[[2.9418, 2.0293, 1.5732]]]]

Expected: [[[[2.9418, 2.0293, 1.5732]]]]