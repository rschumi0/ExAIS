import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr13753 = tf.keras.layers.Input(shape=([1, 2, 2]))

Thr13753 = keras.layers.ThresholdedReLU(theta=4.6360319571812125, name = 'Thr13753', input_shape=(1, 2, 2))(in0Thr13753)
Res34541 = keras.layers.Reshape((1, 4), name = 'Res34541', )(Thr13753)
LST21811 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST21811', )(Res34541)
model = tf.keras.models.Model(inputs=[in0Thr13753], outputs=LST21811)
w = model.get_layer('LST21811').get_weights() 
w[0] = np.array([[3, 6, 3, 5, 1, 9, 8, 3, 6, 5, 3, 9], [1, 4, 3, 6, 8, 4, 2, 5, 8, 8, 8, 10], [4, 5, 10, 6, 4, 6, 1, 7, 2, 9, 1, 7], [1, 2, 3, 2, 8, 10, 3, 5, 4, 5, 4, 3]])
w[1] = np.array([[6, 6, 7, 3, 6, 7, 7, 4, 5, 5, 5, 9], [6, 8, 8, 2, 10, 6, 4, 5, 10, 7, 6, 7], [2, 7, 2, 6, 5, 5, 2, 7, 6, 7, 2, 6]])
w[2] = np.array([4, 2, 3, 4, 2, 1, 2, 1, 6, 10, 5, 2])
model.get_layer('LST21811').set_weights(w) 
in0Thr13753 = tf.constant([[[[0.6218, 0.0294], [0.9458, 0.4725]]]])
print (np.array2string(model.predict([in0Thr13753],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST21811.png')

LThr13753 = thresholded_relu_layer([[[[0.6218, 0.0294], [0.9458, 0.4725]]]], 4.6360319571812125, Thr13753), 
LRes34541 = reshape_layer(Thr13753, [1, 4], Res34541), 
LLST21811 = lstm_layer(Res34541,[[3, 6, 3, 5, 1, 9, 8, 3, 6, 5, 3, 9], [1, 4, 3, 6, 8, 4, 2, 5, 8, 8, 8, 10], [4, 5, 10, 6, 4, 6, 1, 7, 2, 9, 1, 7], [1, 2, 3, 2, 8, 10, 3, 5, 4, 5, 4, 3]],[[6, 6, 7, 3, 6, 7, 7, 4, 5, 5, 5, 9], [6, 8, 8, 2, 10, 6, 4, 5, 10, 7, 6, 7], [2, 7, 2, 6, 5, 5, 2, 7, 6, 7, 2, 6]],[4, 2, 3, 4, 2, 1, 2, 1, 6, 10, 5, 2], LST21811), 
exec_layers([LThr13753,LRes34541,LLST21811],["Thr13753","Res34541","LST21811"],LST21811,"LST21811")

Actual (Unparsed): [[0.7382466, 0.5815936, 0.6526186]]

Expected (Unparsed): [[0.7382466173304558,0.5815936391116405,0.6526185936436868]]

Actual:   [[0.7383, 0.5816, 0.6527]]

Expected: [[0.7383, 0.5816, 0.6527]]