import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min21926 = tf.keras.layers.Input(shape=([1, 2]))
in1Min21926 = tf.keras.layers.Input(shape=([1, 2]))

Min21926 = keras.layers.Minimum(name = 'Min21926', )([in0Min21926,in1Min21926])
GRU92696 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU92696', )(Min21926)
model = tf.keras.models.Model(inputs=[in0Min21926,in1Min21926], outputs=GRU92696)
w = model.get_layer('GRU92696').get_weights() 
w[0] = np.array([[4, 8, 5, 6, 10, 3, 7, 6, 10], [7, 8, 7, 1, 6, 7, 3, 2, 6]])
w[1] = np.array([[8, 3, 8, 9, 9, 6, 1, 8, 9], [1, 4, 7, 10, 5, 2, 9, 7, 2], [10, 10, 10, 2, 5, 9, 7, 1, 8]])
w[2] = np.array([5, 3, 4, 10, 3, 6, 7, 6, 7])
model.get_layer('GRU92696').set_weights(w) 
in0Min21926 = tf.constant([[[0.4821, 0.0664]]])
in1Min21926 = tf.constant([[[0.384, 0.5287]]])
print (np.array2string(model.predict([in0Min21926,in1Min21926],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU92696.png')

LMin21926 = minimum_layer([[[[0.4821, 0.0664]]], [[[0.384, 0.5287]]]], Min21926), 
LGRU92696 = gru_layer(Min21926,[[4, 8, 5, 6, 10, 3, 7, 6, 10], [7, 8, 7, 1, 6, 7, 3, 2, 6]],[[8, 3, 8, 9, 9, 6, 1, 8, 9], [1, 4, 7, 10, 5, 2, 9, 7, 2], [10, 10, 10, 2, 5, 9, 7, 1, 8]],[5, 3, 4, 10, 3, 6, 7, 6, 7], false, GRU92696), 
exec_layers([LMin21926,LGRU92696],["Min21926","GRU92696"],GRU92696,"GRU92696")

Actual (Unparsed): [[0.0009103, 0.0013542, 0.0016842]]

Expected (Unparsed): [[0.0009103233034170267,0.00135418538515674,0.0016841646667894933]]

Actual:   [[0.001, 0.0014, 0.0017]]

Expected: [[0.001, 0.0014, 0.0017]]