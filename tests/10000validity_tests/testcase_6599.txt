import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc28448 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con54486 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con28555 = tf.keras.layers.Input(shape=([1, 1]))
in0Sub49988 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub49988 = tf.keras.layers.Input(shape=([3, 2]))
in0Con3031 = tf.keras.layers.Input(shape=([1, 5]))

Loc28448 = keras.layers.LocallyConnected2D(4, (2, 1),strides=(12, 1), name = 'Loc28448', )(in0Loc28448)
Res85348 = keras.layers.Reshape((1, 8), name = 'Res85348', )(Loc28448)
Con54486 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 1), padding='valid', name = 'Con54486', )(in0Con54486)
Res30351 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res30351', )(Con54486)
Cro10975 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (1, 1)), name = 'Cro10975', )(Res30351)
Res90855 = keras.layers.Reshape((1, 1, 1), name = 'Res90855', )(Cro10975)
Res53721 = keras.layers.Reshape((1, 1), name = 'Res53721', )(Res90855)
Con28555 = keras.layers.Concatenate(axis=2, name = 'Con28555', )([Res53721,in0Con28555])
Sub49988 = keras.layers.Subtract(name = 'Sub49988', )([in0Sub49988,in1Sub49988])
Dot91208 = keras.layers.Dot(axes=(2, 2), name = 'Dot91208', )([Con28555,Sub49988])
Con3031 = keras.layers.Concatenate(axis=2, name = 'Con3031', )([Dot91208,in0Con3031])
Min80118 = keras.layers.Minimum(name = 'Min80118', )([Res85348,Con3031])
model = tf.keras.models.Model(inputs=[in0Loc28448,in0Con54486,in0Con28555,in0Sub49988,in1Sub49988,in0Con3031], outputs=Min80118)
w = model.get_layer('Loc28448').get_weights() 
w[0] = np.array([[[0.2674, 0.994, 0.2644, 0.0822], [0.7704, 0.1607, 0.9698, 0.3729], [0.3849, 0.535, 0.5647, 0.091], [0.5253, 0.7684, 0.7032, 0.9825]], [[0.2328, 0.7466, 0.7856, 0.9565], [0.9669, 0.5061, 0.4009, 0.0622], [0.5009, 0.2205, 0.4682, 0.6361], [0.0577, 0.9686, 0.9393, 0.7187]]])
w[1] = np.array([[[0, 0, 0, 0], [0, 0, 0, 0]]])
model.get_layer('Loc28448').set_weights(w) 
w = model.get_layer('Con54486').get_weights() 
w[0] = np.array([[[[0.5498], [0.545], [0.1845]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con54486').set_weights(w) 
in0Loc28448 = tf.constant([[[[0.3378, 0.3437], [0.8146, 0.9233]], [[0.0734, 0.5209], [0.4461, 0.0809]]]])
in0Con54486 = tf.constant([[[[0.4636]]]])
in0Con28555 = tf.constant([[[0.916]]])
in0Sub49988 = tf.constant([[[0.0116, 0.1399], [0.1693, 0.1402], [0.0507, 0.9624]]])
in1Sub49988 = tf.constant([[[0.4987, 0.2345], [0.46, 0.8887], [0.6569, 0.2541]]])
in0Con3031 = tf.constant([[[0.1227, 0.7973, 0.2655, 0.5894, 0.6468]]])
print (np.array2string(model.predict([in0Loc28448,in0Con54486,in0Con28555,in0Sub49988,in1Sub49988,in0Con3031],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min80118.png')

LLoc28448 = locally_connected2D_layer([[[[0.3378, 0.3437], [0.8146, 0.9233]], [[0.0734, 0.5209], [0.4461, 0.0809]]]], 2, 1,[[[0.2674, 0.994, 0.2644, 0.0822], [0.7704, 0.1607, 0.9698, 0.3729], [0.3849, 0.535, 0.5647, 0.091], [0.5253, 0.7684, 0.7032, 0.9825]], [[0.2328, 0.7466, 0.7856, 0.9565], [0.9669, 0.5061, 0.4009, 0.0622], [0.5009, 0.2205, 0.4682, 0.6361], [0.0577, 0.9686, 0.9393, 0.7187]]],[[[0, 0, 0, 0], [0, 0, 0, 0]]], 12, 1, Loc28448), 
LRes85348 = reshape_layer(Loc28448, [1, 8], Res85348), 
LCon54486 = conv2D_transpose_layer([[[[0.4636]]]], 1, 1,[[[[0.5498], [0.545], [0.1845]]]],[0, 0, 0], 1, 1, false, Con54486), 
LRes30351 = reshape_layer(Con54486, [1, 1, 3, 1], Res30351), 
LCro10975 = cropping3D_layer(Res30351, 0, 0, 0, 0, 1, 1, Cro10975), 
LRes90855 = reshape_layer(Cro10975, [1, 1, 1], Res90855), 
LRes53721 = reshape_layer(Res90855, [1, 1], Res53721), 
LCon28555 = concatenate_layer([Res53721,[[[0.916]]]], 2, Con28555), 
LSub49988 = subtract_layer([[[0.0116, 0.1399], [0.1693, 0.1402], [0.0507, 0.9624]]], [[[0.4987, 0.2345], [0.46, 0.8887], [0.6569, 0.2541]]], Sub49988), 
LDot91208 = dot_layer(Con28555,Sub49988, 2, 2, Dot91208), 
LCon3031 = concatenate_layer([Dot91208,[[[0.1227, 0.7973, 0.2655, 0.5894, 0.6468]]]], 2, Con3031), 
LMin80118 = minimum_layer([Res85348,Con3031], Min80118), 
exec_layers([LLoc28448,LRes85348,LCon54486,LRes30351,LCro10975,LRes90855,LRes53721,LCon28555,LSub49988,LDot91208,LCon3031,LMin80118],["Loc28448","Res85348","Con54486","Res30351","Cro10975","Res90855","Res53721","Con28555","Sub49988","Dot91208","Con3031","Min80118"],Min80118,"Min80118")

Actual (Unparsed): [[[-0.2097253, -0.7590749, 0.4956391, 0.1227000, 0.7973000, 0.2655000, 0.5894000, 0.6468000]]]

Expected (Unparsed): [[[-0.20972526019999999,-0.7590748434000001,0.49563909559999997,0.1227,0.7973,0.2655,0.5894,0.6468]]]

Actual:   [[[-0.2097, -0.759, 0.4957, 0.1227, 0.7973, 0.2655, 0.5894, 0.6468]]]

Expected: [[[-0.2097, -0.759, 0.4957, 0.1227, 0.7973, 0.2655, 0.5894, 0.6468]]]