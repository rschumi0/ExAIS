import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo36516 = tf.keras.layers.Input(shape=([2, 2]))

Glo36516 = keras.layers.GlobalAveragePooling1D(name = 'Glo36516', )(in0Glo36516)
Res89745 = keras.layers.Reshape((2, 1), name = 'Res89745', )(Glo36516)
Res93467 = keras.layers.Reshape((2, 1, 1), name = 'Res93467', )(Res89745)
Zer92582 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer92582', )(Res93467)
Dep60559 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep60559', )(Zer92582)
model = tf.keras.models.Model(inputs=[in0Glo36516], outputs=Dep60559)
w = model.get_layer('Dep60559').get_weights() 
w[0] = np.array([[[[0.8564]]]])
w[1] = np.array([0])
model.get_layer('Dep60559').set_weights(w) 
in0Glo36516 = tf.constant([[[1.0669, 1.2471], [1.2561, 1.4821]]])
print (np.array2string(model.predict([in0Glo36516],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep60559.png')

LGlo36516 = global_average_pooling1D_layer([[[1.0669, 1.2471], [1.2561, 1.4821]]], Glo36516), 
LRes89745 = reshape_layer(Glo36516, [2, 1], Res89745), 
LRes93467 = reshape_layer(Res89745, [2, 1, 1], Res93467), 
LZer92582 = zero_padding2D_layer(Res93467, 1, 1, 1, 1, Zer92582), 
LDep60559 = depthwise_conv2D_layer(Zer92582, 1, 1,[[[[0.8564]]]],[0], 1, 1, false, Dep60559), 
exec_layers([LGlo36516,LRes89745,LRes93467,LZer92582,LDep60559],["Glo36516","Res89745","Res93467","Zer92582","Dep60559"],Dep60559,"Dep60559")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.9947086], [0.0000000]], [[0.0000000], [1.1686434], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0.0],[0.0],[0.0]],[[0.0],[0.9947086],[0.0]],[[0.0],[1.16864344],[0.0]],[[0.0],[0.0],[0.0]]]]

Actual:   [[[[0], [0], [0]], [[0], [0.9948], [0]], [[0], [1.1687], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [0.9948], [0]], [[0], [1.1687], [0]], [[0], [0], [0]]]]