import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot57891 = tf.keras.layers.Input(shape=([3]))
in1Dot57891 = tf.keras.layers.Input(shape=([3]))
in0Con40389 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Add60242 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Add60242 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Dot57891 = keras.layers.Dot(axes=(1, 1), name = 'Dot57891', )([in0Dot57891,in1Dot57891])
Res87578 = keras.layers.Reshape((1, 1), name = 'Res87578', )(Dot57891)
Res11753 = keras.layers.Reshape((1, 1, 1), name = 'Res11753', )(Res87578)
Res23183 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res23183', )(Res11753)
Cro14436 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro14436', )(Res23183)
Zer54678 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer54678', )(Cro14436)
Con40389 = keras.layers.Concatenate(axis=4, name = 'Con40389', )([Zer54678,in0Con40389])
Add60242 = keras.layers.Add(name = 'Add60242', )([in0Add60242,in1Add60242])
Thr20442 = keras.layers.ThresholdedReLU(theta=3.5526490313225954, name = 'Thr20442', )(Add60242)
Ave98951 = keras.layers.Average(name = 'Ave98951', )([Con40389,Thr20442])
model = tf.keras.models.Model(inputs=[in0Dot57891,in1Dot57891,in0Con40389,in0Add60242,in1Add60242], outputs=Ave98951)
in0Dot57891 = tf.constant([[0.4235, 0.5935, 0.3234]])
in1Dot57891 = tf.constant([[0.862, 0.9049, 0.833]])
in0Con40389 = tf.constant([[[[[0.1321], [0.8274]]]]])
in0Add60242 = tf.constant([[[[[0.3476, 0.3276], [0.7924, 0.0166]]]]])
in1Add60242 = tf.constant([[[[[0.818, 0.3533], [0.5732, 0.7904]]]]])
print (np.array2string(model.predict([in0Dot57891,in1Dot57891,in0Con40389,in0Add60242,in1Add60242],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave98951.png')

LDot57891 = dot_layer([[0.4235, 0.5935, 0.3234]], [[0.862, 0.9049, 0.833]], 1, 1, Dot57891), 
LRes87578 = reshape_layer(Dot57891, [1, 1], Res87578), 
LRes11753 = reshape_layer(Res87578, [1, 1, 1], Res11753), 
LRes23183 = reshape_layer(Res11753, [1, 1, 1, 1], Res23183), 
LCro14436 = cropping3D_layer(Res23183, 0, 0, 0, 0, 0, 0, Cro14436), 
LZer54678 = zero_padding3D_layer(Cro14436, 0, 0, 0, 0, 1, 0, Zer54678), 
LCon40389 = concatenate_layer([Zer54678,[[[[[0.1321], [0.8274]]]]]], 4, Con40389), 
LAdd60242 = add_layer([[[[[[0.3476, 0.3276], [0.7924, 0.0166]]]]], [[[[[0.818, 0.3533], [0.5732, 0.7904]]]]]], Add60242), 
LThr20442 = thresholded_relu_layer(Add60242, 3.5526490313225954, Thr20442), 
LAve98951 = average_layer([Con40389,Thr20442], Ave98951), 
exec_layers([LDot57891,LRes87578,LRes11753,LRes23183,LCro14436,LZer54678,LCon40389,LAdd60242,LThr20442,LAve98951],["Dot57891","Res87578","Res11753","Res23183","Cro14436","Zer54678","Con40389","Add60242","Thr20442","Ave98951"],Ave98951,"Ave98951")

Actual (Unparsed): [[[[[0.0000000, 0.0660500], [0.5857537, 0.4137000]]]]]

Expected (Unparsed): [[[[[0,0.06605],[0.585753675,0.4137]]]]]

Actual:   [[[[[0, 0.0661], [0.5858, 0.4137]]]]]

Expected: [[[[[0, 0.0661], [0.5858, 0.4137]]]]]