import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr84407 = tf.keras.layers.Input(shape=([1, 2, 2]))

Thr84407 = keras.layers.ThresholdedReLU(theta=6.764947779080879, name = 'Thr84407', input_shape=(1, 2, 2))(in0Thr84407)
Res68920 = keras.layers.Reshape((1, 4), name = 'Res68920', )(Thr84407)
LST44044 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST44044', )(Res68920)
model = tf.keras.models.Model(inputs=[in0Thr84407], outputs=LST44044)
w = model.get_layer('LST44044').get_weights() 
w[0] = np.array([[7, 5, 1, 1, 9, 3, 8, 5, 6, 4, 8, 4], [9, 7, 5, 1, 10, 5, 6, 2, 8, 1, 8, 9], [6, 5, 6, 8, 5, 5, 8, 10, 1, 7, 8, 9], [10, 6, 2, 4, 10, 5, 3, 9, 10, 1, 8, 10]])
w[1] = np.array([[10, 8, 5, 8, 3, 10, 2, 2, 8, 8, 8, 4], [5, 5, 9, 9, 2, 8, 2, 6, 8, 5, 6, 4], [9, 5, 4, 10, 1, 3, 4, 10, 2, 3, 9, 4]])
w[2] = np.array([8, 2, 8, 9, 8, 10, 10, 1, 6, 10, 3, 5])
model.get_layer('LST44044').set_weights(w) 
in0Thr84407 = tf.constant([[[[0.1821, 0.6471], [0.495, 0.5595]]]])
print (np.array2string(model.predict([in0Thr84407],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST44044.png')

LThr84407 = thresholded_relu_layer([[[[0.1821, 0.6471], [0.495, 0.5595]]]], 6.764947779080879, Thr84407), 
LRes68920 = reshape_layer(Thr84407, [1, 4], Res68920), 
LLST44044 = lstm_layer(Res68920,[[7, 5, 1, 1, 9, 3, 8, 5, 6, 4, 8, 4], [9, 7, 5, 1, 10, 5, 6, 2, 8, 1, 8, 9], [6, 5, 6, 8, 5, 5, 8, 10, 1, 7, 8, 9], [10, 6, 2, 4, 10, 5, 3, 9, 10, 1, 8, 10]],[[10, 8, 5, 8, 3, 10, 2, 2, 8, 8, 8, 4], [5, 5, 9, 9, 2, 8, 2, 6, 8, 5, 6, 4], [9, 5, 4, 10, 1, 3, 4, 10, 2, 3, 9, 4]],[8, 2, 8, 9, 8, 10, 10, 1, 6, 10, 3, 5], LST44044), 
exec_layers([LThr84407,LRes68920,LLST44044],["Thr84407","Res68920","LST44044"],LST44044,"LST44044")

Actual (Unparsed): [[0.7614187, 0.5577440, 0.7563519]]

Expected (Unparsed): [[0.7614187114437803,0.5577439500538847,0.7563518610343958]]

Actual:   [[0.7615, 0.5578, 0.7564]]

Expected: [[0.7615, 0.5578, 0.7564]]