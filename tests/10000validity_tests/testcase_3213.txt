import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add69237 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Add69237 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con18237 = tf.keras.layers.Input(shape=([1, 1, 3, 1]))
in0Cro95980 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Max83857 = tf.keras.layers.Input(shape=([2, 1]))
in1Max83857 = tf.keras.layers.Input(shape=([2, 1]))

Add69237 = keras.layers.Add(name = 'Add69237', )([in0Add69237,in1Add69237])
Con5759 = keras.layers.Conv2DTranspose(3, (1, 2),strides=(1, 1), padding='same', name = 'Con5759', )(Add69237)
Res3799 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res3799', )(Con5759)
Con18237 = keras.layers.Concatenate(axis=4, name = 'Con18237', )([Res3799,in0Con18237])
Cro95980 = keras.layers.Cropping3D(cropping=((1, 0), (0, 0), (0, 0)), name = 'Cro95980', )(in0Cro95980)
Zer12812 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer12812', )(Cro95980)
Add17608 = keras.layers.Add(name = 'Add17608', )([Con18237,Zer12812])
Res31374 = keras.layers.Reshape((1, 1, 6), name = 'Res31374', )(Add17608)
Res90512 = keras.layers.Reshape((1, 6), name = 'Res90512', )(Res31374)
Sim26554 = keras.layers.SimpleRNN(1,name = 'Sim26554', )(Res90512)
Res18913 = keras.layers.Reshape((1, 1), name = 'Res18913', )(Sim26554)
Zer84612 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer84612', )(Res18913)
Max83857 = keras.layers.Maximum(name = 'Max83857', )([in0Max83857,in1Max83857])
Thr92299 = keras.layers.ThresholdedReLU(theta=1.2551073504084547, name = 'Thr92299', )(Max83857)
Max52997 = keras.layers.Maximum(name = 'Max52997', )([Zer84612,Thr92299])
model = tf.keras.models.Model(inputs=[in0Add69237,in1Add69237,in0Con18237,in0Cro95980,in0Max83857,in1Max83857], outputs=Max52997)
w = model.get_layer('Con5759').get_weights() 
w[0] = np.array([[[[0.3439, 0.6446], [0.2062, 0.2025], [0.9781, 0.4851]], [[0.8283, 0.7727], [0.0179, 0.5814], [0.7399, 0.0565]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con5759').set_weights(w) 
w = model.get_layer('Sim26554').get_weights() 
w[0] = np.array([[6], [2], [2], [9], [9], [2]])
w[1] = np.array([[10]])
w[2] = np.array([3])
model.get_layer('Sim26554').set_weights(w) 
in0Add69237 = tf.constant([[[[0.4825, 0.9462]]]])
in1Add69237 = tf.constant([[[[0.3233, 0.6085]]]])
in0Con18237 = tf.constant([[[[[0.0531], [0.743], [0.5891]]]]])
in0Cro95980 = tf.constant([[[[[1.0639, 1.5509]]], [[[1.2686, 1.8459]]]]])
in0Max83857 = tf.constant([[[0.6927], [0.1108]]])
in1Max83857 = tf.constant([[[0.7827], [0.1187]]])
print (np.array2string(model.predict([in0Add69237,in1Add69237,in0Con18237,in0Cro95980,in0Max83857,in1Max83857],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max52997.png')

LAdd69237 = add_layer([[[[[0.4825, 0.9462]]]], [[[[0.3233, 0.6085]]]]], Add69237), 
LCon5759 = conv2D_transpose_layer(Add69237, 1, 2,[[[[0.3439, 0.6446], [0.2062, 0.2025], [0.9781, 0.4851]], [[0.8283, 0.7727], [0.0179, 0.5814], [0.7399, 0.0565]]]],[0, 0, 0], 1, 1, true, Con5759), 
LRes3799 = reshape_layer(Con5759, [1, 1, 3, 1], Res3799), 
LCon18237 = concatenate_layer([Res3799,[[[[[0.0531], [0.743], [0.5891]]]]]], 4, Con18237), 
LCro95980 = cropping3D_layer([[[[[1.0639, 1.5509]]], [[[1.2686, 1.8459]]]]], 1, 0, 0, 0, 0, 0, Cro95980), 
LZer12812 = zero_padding3D_layer(Cro95980, 0, 0, 0, 0, 2, 0, Zer12812), 
LAdd17608 = add_layer([Con18237,Zer12812], Add17608), 
LRes31374 = reshape_layer(Add17608, [1, 1, 6], Res31374), 
LRes90512 = reshape_layer(Res31374, [1, 6], Res90512), 
LSim26554 = simple_rnn_layer(Res90512,[[6], [2], [2], [9], [9], [2]],[[10]],[3], Sim26554), 
LRes18913 = reshape_layer(Sim26554, [1, 1], Res18913), 
LZer84612 = zero_padding1D_layer(Res18913, 1, 0, Zer84612), 
LMax83857 = maximum_layer([[[[0.6927], [0.1108]]], [[[0.7827], [0.1187]]]], Max83857), 
LThr92299 = thresholded_relu_layer(Max83857, 1.2551073504084547, Thr92299), 
LMax52997 = maximum_layer([Zer84612,Thr92299], Max52997), 
exec_layers([LAdd69237,LCon5759,LRes3799,LCon18237,LCro95980,LZer12812,LAdd17608,LRes31374,LRes90512,LSim26554,LRes18913,LZer84612,LMax83857,LThr92299,LMax52997],["Add69237","Con5759","Res3799","Con18237","Cro95980","Zer12812","Add17608","Res31374","Res90512","Sim26554","Res18913","Zer84612","Max83857","Thr92299","Max52997"],Max52997,"Max52997")

Actual (Unparsed): [[[0.0000000], [1.0000000]]]

Expected (Unparsed): [[[0],[1.0]]]

Actual:   [[[0], [1]]]

Expected: [[[0], [1]]]