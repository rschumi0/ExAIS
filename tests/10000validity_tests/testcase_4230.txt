import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul54122 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul54122 = tf.keras.layers.Input(shape=([1, 1]))

Mul54122 = keras.layers.Multiply(name = 'Mul54122', )([in0Mul54122,in1Mul54122])
Res12927 = keras.layers.Reshape((1, 1, 1), name = 'Res12927', )(Mul54122)
Sep7710 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='valid', name = 'Sep7710', )(Res12927)
Glo63620 = keras.layers.GlobalMaxPool2D(name = 'Glo63620', )(Sep7710)
Thr11238 = keras.layers.ThresholdedReLU(theta=6.2756837977114435, name = 'Thr11238', )(Glo63620)
Res7842 = keras.layers.Reshape((3, 1), name = 'Res7842', )(Thr11238)
LST67226 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST67226', )(Res7842)
Res50846 = keras.layers.Reshape((1, 1), name = 'Res50846', )(LST67226)
Res65902 = keras.layers.Reshape((1, 1, 1), name = 'Res65902', )(Res50846)
Res97651 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res97651', )(Res65902)
Glo40655 = keras.layers.GlobalMaxPool3D(name = 'Glo40655', )(Res97651)
model = tf.keras.models.Model(inputs=[in0Mul54122,in1Mul54122], outputs=Glo40655)
w = model.get_layer('Sep7710').get_weights() 
w[0] = np.array([[[[0.9225]]]])
w[1] = np.array([[[[0.1098, 0.2225, 0.0093]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep7710').set_weights(w) 
w = model.get_layer('LST67226').get_weights() 
w[0] = np.array([[9, 1, 4, 8]])
w[1] = np.array([[9, 1, 3, 6]])
w[2] = np.array([2, 4, 7, 1])
model.get_layer('LST67226').set_weights(w) 
in0Mul54122 = tf.constant([[[0.6507]]])
in1Mul54122 = tf.constant([[[0.0554]]])
print (np.array2string(model.predict([in0Mul54122,in1Mul54122],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo40655.png')

LMul54122 = multiply_layer([[[[0.6507]]], [[[0.0554]]]], Mul54122), 
LRes12927 = reshape_layer(Mul54122, [1, 1, 1], Res12927), 
LSep7710 = separable_conv2D_layer(Res12927, 1, 1,[[[[[0.9225]]]],[[[[0.1098, 0.2225, 0.0093]]]]],[0, 0, 0], 1, 1, false, Sep7710), 
LGlo63620 = global_max_pool2D_layer(Sep7710, Glo63620), 
LThr11238 = thresholded_relu_layer(Glo63620, 6.2756837977114435, Thr11238), 
LRes7842 = reshape_layer(Thr11238, [3, 1], Res7842), 
LLST67226 = lstm_layer(Res7842,[[9, 1, 4, 8]],[[9, 1, 3, 6]],[2, 4, 7, 1], LST67226), 
LRes50846 = reshape_layer(LST67226, [1, 1], Res50846), 
LRes65902 = reshape_layer(Res50846, [1, 1, 1], Res65902), 
LRes97651 = reshape_layer(Res65902, [1, 1, 1, 1], Res97651), 
LGlo40655 = global_max_pool3D_layer(Res97651, Glo40655), 
exec_layers([LMul54122,LRes12927,LSep7710,LGlo63620,LThr11238,LRes7842,LLST67226,LRes50846,LRes65902,LRes97651,LGlo40655],["Mul54122","Res12927","Sep7710","Glo63620","Thr11238","Res7842","LST67226","Res50846","Res65902","Res97651","Glo40655"],Glo40655,"Glo40655")

Actual (Unparsed): [[0.9921062]]

Expected (Unparsed): [[0.992106215689617]]

Actual:   [[0.9922]]

Expected: [[0.9922]]