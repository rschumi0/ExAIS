import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof13329 = tf.keras.layers.Input(shape=([2, 1]))

Sof13329 = keras.layers.Softmax(axis=1, name = 'Sof13329', input_shape=(2, 1))(in0Sof13329)
Loc73627 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc73627', )(Sof13329)
Bat4319 = keras.layers.BatchNormalization(axis=1, epsilon=0.7274255750593827,  name = 'Bat4319', )(Loc73627)
model = tf.keras.models.Model(inputs=[in0Sof13329], outputs=Bat4319)
w = model.get_layer('Loc73627').get_weights() 
w[0] = np.array([[[0.0571, 0.328, 0.0788, 0.2037]], [[0.0383, 0.9527, 0.7524, 0.9245]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc73627').set_weights(w) 
w = model.get_layer('Bat4319').get_weights() 
w[0] = np.array([0.2845, 0.7194])
w[1] = np.array([0.7852, 0.2526])
w[2] = np.array([0.54, 0.5183])
w[3] = np.array([0.1074, 0.2716])
model.get_layer('Bat4319').set_weights(w) 
in0Sof13329 = tf.constant([[[0.0394], [0.3706]]])
print (np.array2string(model.predict([in0Sof13329],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat4319.png')

LSof13329 = softmax_layer([[[0.0394], [0.3706]]], 1, Sof13329), 
LLoc73627 = locally_connected1D_layer(Sof13329, 1,[[[0.0571, 0.328, 0.0788, 0.2037]], [[0.0383, 0.9527, 0.7524, 0.9245]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc73627), 
LBat4319 = batch_normalization_layer(Loc73627, 1, 0.7274255750593827, [0.2845, 0.7194], [0.7852, 0.2526], [0.54, 0.5183], [0.1074, 0.2716], Bat4319), 
exec_layers([LSof13329,LLoc73627,LBat4319],["Sof13329","Loc73627","Bat4319"],Bat4319,"Bat4319")

Actual (Unparsed): [[[0.6244882, 0.6597428, 0.6273122, 0.6435666], [-0.1044017, 0.2786696, 0.1947575, 0.2668557]]]

Expected (Unparsed): [[[0.6244881803394939,0.6597428260119887,0.6273121958843191,0.6435665526377137],[-0.1044017262412526,0.278669587550977,0.19475753139110868,0.26685570845108547]]]

Actual:   [[[0.6245, 0.6598, 0.6274, 0.6436], [-0.1044, 0.2787, 0.1948, 0.2669]]]

Expected: [[[0.6245, 0.6598, 0.6274, 0.6436], [-0.1044, 0.2787, 0.1948, 0.2669]]]