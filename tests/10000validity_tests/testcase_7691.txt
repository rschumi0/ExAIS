import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max21952 = tf.keras.layers.Input(shape=([2, 1]))
in1Max21952 = tf.keras.layers.Input(shape=([2, 1]))
in0Glo72902 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con25357 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul74939 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul74939 = tf.keras.layers.Input(shape=([2, 2]))

Max21952 = keras.layers.Maximum(name = 'Max21952', )([in0Max21952,in1Max21952])
Fla90969 = keras.layers.Flatten(name = 'Fla90969', )(Max21952)
Glo72902 = keras.layers.GlobalMaxPool2D(name = 'Glo72902', )(in0Glo72902)
Dot77711 = keras.layers.Dot(axes=(1, 1), name = 'Dot77711', )([Fla90969,Glo72902])
Res13692 = keras.layers.Reshape((1, 1), name = 'Res13692', )(Dot77711)
Zer37360 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer37360', )(Res13692)
Con25357 = keras.layers.Concatenate(axis=2, name = 'Con25357', )([Zer37360,in0Con25357])
Mul74939 = keras.layers.Multiply(name = 'Mul74939', )([in0Mul74939,in1Mul74939])
Ave98788 = keras.layers.Average(name = 'Ave98788', )([Con25357,Mul74939])
model = tf.keras.models.Model(inputs=[in0Max21952,in1Max21952,in0Glo72902,in0Con25357,in0Mul74939,in1Mul74939], outputs=Ave98788)
in0Max21952 = tf.constant([[[0.3128], [0.4951]]])
in1Max21952 = tf.constant([[[0.0429], [0.0879]]])
in0Glo72902 = tf.constant([[[[1.8898, 1.565]]]])
in0Con25357 = tf.constant([[[0.5604], [0.9727]]])
in0Mul74939 = tf.constant([[[0.7543, 0.6147], [0.8683, 0.7562]]])
in1Mul74939 = tf.constant([[[0.5332, 0.079], [0.6775, 0.7042]]])
print (np.array2string(model.predict([in0Max21952,in1Max21952,in0Glo72902,in0Con25357,in0Mul74939,in1Mul74939],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave98788.png')

LMax21952 = maximum_layer([[[[0.3128], [0.4951]]], [[[0.0429], [0.0879]]]], Max21952), 
LFla90969 = flatten_layer(Max21952, Fla90969), 
LGlo72902 = global_max_pool2D_layer([[[[1.8898, 1.565]]]], Glo72902), 
LDot77711 = dot_layer(Fla90969,Glo72902, 1, 1, Dot77711), 
LRes13692 = reshape_layer(Dot77711, [1, 1], Res13692), 
LZer37360 = zero_padding1D_layer(Res13692, 1, 0, Zer37360), 
LCon25357 = concatenate_layer([Zer37360,[[[0.5604], [0.9727]]]], 2, Con25357), 
LMul74939 = multiply_layer([[[[0.7543, 0.6147], [0.8683, 0.7562]]], [[[0.5332, 0.079], [0.6775, 0.7042]]]], Mul74939), 
LAve98788 = average_layer([Con25357,Mul74939], Ave98788), 
exec_layers([LMax21952,LFla90969,LGlo72902,LDot77711,LRes13692,LZer37360,LCon25357,LMul74939,LAve98788],["Max21952","Fla90969","Glo72902","Dot77711","Res13692","Zer37360","Con25357","Mul74939","Ave98788"],Ave98788,"Ave98788")

Actual (Unparsed): [[[0.2010964, 0.3044807], [0.9771171, 0.7526080]]]

Expected (Unparsed): [[[0.20109638,0.30448065],[0.9771170949999999,0.75260802]]]

Actual:   [[[0.2011, 0.3045], [0.9772, 0.7527]]]

Expected: [[[0.2011, 0.3045], [0.9772, 0.7527]]]