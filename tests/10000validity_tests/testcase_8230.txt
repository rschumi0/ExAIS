import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub68845 = tf.keras.layers.Input(shape=([2]))
in1Sub68845 = tf.keras.layers.Input(shape=([2]))
in0Glo55604 = tf.keras.layers.Input(shape=([2, 1]))
in0Con11958 = tf.keras.layers.Input(shape=([11]))
in0Fla75111 = tf.keras.layers.Input(shape=([4, 3]))

Sub68845 = keras.layers.Subtract(name = 'Sub68845', )([in0Sub68845,in1Sub68845])
Res81461 = keras.layers.Reshape((2, 1), name = 'Res81461', )(Sub68845)
Res36840 = keras.layers.Reshape((2, 1, 1), name = 'Res36840', )(Res81461)
Res83925 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res83925', )(Res36840)
Glo44931 = keras.layers.GlobalMaxPool3D(name = 'Glo44931', )(Res83925)
Glo55604 = keras.layers.GlobalAveragePooling1D(name = 'Glo55604', )(in0Glo55604)
Add99132 = keras.layers.Add(name = 'Add99132', )([Glo44931,Glo55604])
Con11958 = keras.layers.Concatenate(axis=1, name = 'Con11958', )([Add99132,in0Con11958])
Fla75111 = keras.layers.Flatten(name = 'Fla75111', )(in0Fla75111)
Max57281 = keras.layers.Maximum(name = 'Max57281', )([Con11958,Fla75111])
model = tf.keras.models.Model(inputs=[in0Sub68845,in1Sub68845,in0Glo55604,in0Con11958,in0Fla75111], outputs=Max57281)
in0Sub68845 = tf.constant([[0.7683, 0.3765]])
in1Sub68845 = tf.constant([[0.2384, 0.0471]])
in0Glo55604 = tf.constant([[[1.4119], [1.07]]])
in0Con11958 = tf.constant([[0.9103, 0.9405, 0.2027, 0.6804, 0.2297, 0.8781, 0.8016, 0.1908, 0.2806, 0.4683, 0.2747]])
in0Fla75111 = tf.constant([[[1.9556, 1.4764, 1.3919], [1.3736, 1.1189, 1.6257], [1.8039, 1.754, 1.6309], [1.9445, 1.3509, 1.252]]])
print (np.array2string(model.predict([in0Sub68845,in1Sub68845,in0Glo55604,in0Con11958,in0Fla75111],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max57281.png')

LSub68845 = subtract_layer([[0.7683, 0.3765]], [[0.2384, 0.0471]], Sub68845), 
LRes81461 = reshape_layer(Sub68845, [2, 1], Res81461), 
LRes36840 = reshape_layer(Res81461, [2, 1, 1], Res36840), 
LRes83925 = reshape_layer(Res36840, [2, 1, 1, 1], Res83925), 
LGlo44931 = global_max_pool3D_layer(Res83925, Glo44931), 
LGlo55604 = global_average_pooling1D_layer([[[1.4119], [1.07]]], Glo55604), 
LAdd99132 = add_layer([Glo44931,Glo55604], Add99132), 
LCon11958 = concatenate_layer([Add99132,[[0.9103, 0.9405, 0.2027, 0.6804, 0.2297, 0.8781, 0.8016, 0.1908, 0.2806, 0.4683, 0.2747]]], 1, Con11958), 
LFla75111 = flatten_layer([[[1.9556, 1.4764, 1.3919], [1.3736, 1.1189, 1.6257], [1.8039, 1.754, 1.6309], [1.9445, 1.3509, 1.252]]], Fla75111), 
LMax57281 = maximum_layer([Con11958,Fla75111], Max57281), 
exec_layers([LSub68845,LRes81461,LRes36840,LRes83925,LGlo44931,LGlo55604,LAdd99132,LCon11958,LFla75111,LMax57281],["Sub68845","Res81461","Res36840","Res83925","Glo44931","Glo55604","Add99132","Con11958","Fla75111","Max57281"],Max57281,"Max57281")

Actual (Unparsed): [[1.9556000, 1.4764000, 1.3918999, 1.3736000, 1.1188999, 1.6257000, 1.8039000, 1.7539999, 1.6309000, 1.9445000, 1.3509001, 1.2520000]]

Expected (Unparsed): [[1.9556,1.4764,1.3919,1.3736,1.1189,1.6257,1.8039,1.754,1.6309,1.9445,1.3509,1.252]]

Actual:   [[1.9556, 1.4764, 1.3919, 1.3736, 1.1189, 1.6257, 1.8039, 1.754, 1.6309, 1.9445, 1.351, 1.252]]

Expected: [[1.9556, 1.4764, 1.3919, 1.3736, 1.1189, 1.6257, 1.8039, 1.754, 1.6309, 1.9445, 1.3509, 1.252]]