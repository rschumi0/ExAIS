import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den79088 = tf.keras.layers.Input(shape=([2, 3, 4]))

Den79088 = keras.layers.Dense(2,name = 'Den79088', )(in0Den79088)
Glo15995 = keras.layers.GlobalMaxPool2D(name = 'Glo15995', )(Den79088)
Den16797 = keras.layers.Dense(3,name = 'Den16797', )(Glo15995)
model = tf.keras.models.Model(inputs=[in0Den79088], outputs=Den16797)
w = model.get_layer('Den79088').get_weights() 
w[0] = np.array([[0.4004, 0.106], [0.781, 0.027], [0.0796, 0.4583], [0.2675, 0.9027]])
w[1] = np.array([0.8886, 0.7678])
model.get_layer('Den79088').set_weights(w) 
w = model.get_layer('Den16797').get_weights() 
w[0] = np.array([[0.1565, 0.5041, 0.1432], [0.4161, 0.9659, 0.511]])
w[1] = np.array([0.9642, 0.8104, 0.3519])
model.get_layer('Den16797').set_weights(w) 
in0Den79088 = tf.constant([[[[0.4121, 0.4507, 0.5386, 0.5382], [0.7541, 0.4723, 0.3775, 0.4381], [0.2136, 0.3355, 0.7202, 0.5449]], [[0.634, 0.7467, 0.9366, 0.026], [0.912, 0.404, 0.7491, 0.0633], [0.5932, 0.4731, 0.4501, 0.9484]]]])
print (np.array2string(model.predict([in0Den79088],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den16797.png')

LDen79088 = dense_layer([[[[0.4121, 0.4507, 0.5386, 0.5382], [0.7541, 0.4723, 0.3775, 0.4381], [0.2136, 0.3355, 0.7202, 0.5449]], [[0.634, 0.7467, 0.9366, 0.026], [0.912, 0.404, 0.7491, 0.0633], [0.5932, 0.4731, 0.4501, 0.9484]]]], [[0.4004, 0.106], [0.781, 0.027], [0.0796, 0.4583], [0.2675, 0.9027]],[0.8886, 0.7678], Den79088), 
LGlo15995 = global_max_pool2D_layer(Den79088, Glo15995), 
LDen16797 = dense_layer(Glo15995, [[0.1565, 0.5041, 0.1432], [0.4161, 0.9659, 0.511]],[0.9642, 0.8104, 0.3519], Den16797), 
exec_layers([LDen79088,LGlo15995,LDen16797],["Den79088","Glo15995","Den16797"],Den16797,"Den16797")

Actual (Unparsed): [[2.0400426, 3.5622414, 1.5845733]]

Expected (Unparsed): [[2.040042594291,3.562241356725,1.5845732868219997]]

Actual:   [[2.0401, 3.5623, 1.5846]]

Expected: [[2.0401, 3.5623, 1.5846]]