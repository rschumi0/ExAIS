import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max76684 = tf.keras.layers.Input(shape=([1, 1]))
in1Max76684 = tf.keras.layers.Input(shape=([1, 1]))
in0Con29247 = tf.keras.layers.Input(shape=([1]))
in0Sep35528 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot28566 = tf.keras.layers.Input(shape=([3]))
in1Dot28566 = tf.keras.layers.Input(shape=([3]))
in0Con41718 = tf.keras.layers.Input(shape=([3]))

Max76684 = keras.layers.Maximum(name = 'Max76684', )([in0Max76684,in1Max76684])
Res38122 = keras.layers.Reshape((1, 1, 1), name = 'Res38122', )(Max76684)
Res89348 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res89348', )(Res38122)
Con99240 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con99240', )(Res89348)
Res63169 = keras.layers.Reshape((1, 1, 3), name = 'Res63169', )(Con99240)
Res25379 = keras.layers.Reshape((1, 3), name = 'Res25379', )(Res63169)
Fla44973 = keras.layers.Flatten(name = 'Fla44973', )(Res25379)
Con29247 = keras.layers.Concatenate(axis=1, name = 'Con29247', )([Fla44973,in0Con29247])
Sep35528 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep35528', )(in0Sep35528)
Fla28100 = keras.layers.Flatten(name = 'Fla28100', )(Sep35528)
Dot28566 = keras.layers.Dot(axes=(1, 1), name = 'Dot28566', )([in0Dot28566,in1Dot28566])
Con41718 = keras.layers.Concatenate(axis=1, name = 'Con41718', )([Dot28566,in0Con41718])
Ave83362 = keras.layers.Average(name = 'Ave83362', )([Fla28100,Con41718])
Min14234 = keras.layers.Minimum(name = 'Min14234', )([Con29247,Ave83362])
model = tf.keras.models.Model(inputs=[in0Max76684,in1Max76684,in0Con29247,in0Sep35528,in0Dot28566,in1Dot28566,in0Con41718], outputs=Min14234)
w = model.get_layer('Con99240').get_weights() 
w[0] = np.array([[[[[0.1036], [0.254], [0.6798]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con99240').set_weights(w) 
w = model.get_layer('Sep35528').get_weights() 
w[0] = np.array([[[0.0477]]])
w[1] = np.array([[[0.6396, 0.741, 0.6644, 0.6955]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep35528').set_weights(w) 
in0Max76684 = tf.constant([[[0.1373]]])
in1Max76684 = tf.constant([[[0.1177]]])
in0Con29247 = tf.constant([[0.2166]])
in0Sep35528 = tf.constant([[[0.9093]]])
in0Dot28566 = tf.constant([[0.5551, 0.8177, 0.2646]])
in1Dot28566 = tf.constant([[0.2664, 0.6141, 0.1152]])
in0Con41718 = tf.constant([[0.5522, 0.8203, 0.64]])
print (np.array2string(model.predict([in0Max76684,in1Max76684,in0Con29247,in0Sep35528,in0Dot28566,in1Dot28566,in0Con41718],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min14234.png')

LMax76684 = maximum_layer([[[[0.1373]]], [[[0.1177]]]], Max76684), 
LRes38122 = reshape_layer(Max76684, [1, 1, 1], Res38122), 
LRes89348 = reshape_layer(Res38122, [1, 1, 1, 1], Res89348), 
LCon99240 = conv3D_transpose_layer(Res89348, 1, 1, 1,[[[[[0.1036], [0.254], [0.6798]]]]],[0, 0, 0], 1, 1, 1, false, Con99240), 
LRes63169 = reshape_layer(Con99240, [1, 1, 3], Res63169), 
LRes25379 = reshape_layer(Res63169, [1, 3], Res25379), 
LFla44973 = flatten_layer(Res25379, Fla44973), 
LCon29247 = concatenate_layer([Fla44973,[[0.2166]]], 1, Con29247), 
LSep35528 = separable_conv1D_layer([[[0.9093]]], 1,[[[[0.0477]]],[[[0.6396, 0.741, 0.6644, 0.6955]]]],[0, 0, 0, 0], 1, false, Sep35528), 
LFla28100 = flatten_layer(Sep35528, Fla28100), 
LDot28566 = dot_layer([[0.5551, 0.8177, 0.2646]], [[0.2664, 0.6141, 0.1152]], 1, 1, Dot28566), 
LCon41718 = concatenate_layer([Dot28566,[[0.5522, 0.8203, 0.64]]], 1, Con41718), 
LAve83362 = average_layer([Fla28100,Con41718], Ave83362), 
LMin14234 = minimum_layer([Con29247,Ave83362], Min14234), 
exec_layers([LMax76684,LRes38122,LRes89348,LCon99240,LRes63169,LRes25379,LFla44973,LCon29247,LSep35528,LFla28100,LDot28566,LCon41718,LAve83362,LMin14234],["Max76684","Res38122","Res89348","Con99240","Res63169","Res25379","Fla44973","Con29247","Sep35528","Fla28100","Dot28566","Con41718","Ave83362","Min14234"],Min14234,"Min14234")

Actual (Unparsed): [[0.0142243, 0.0348742, 0.0933365, 0.2166000]]

Expected (Unparsed): [[0.01422428,0.0348742,0.09333654,0.2166]]

Actual:   [[0.0143, 0.0349, 0.0934, 0.2166]]

Expected: [[0.0143, 0.0349, 0.0934, 0.2166]]