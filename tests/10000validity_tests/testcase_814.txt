import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub72979 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))
in1Sub72979 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))
in0Dot86862 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot86862 = tf.keras.layers.Input(shape=([3, 2]))
in0Con4120 = tf.keras.layers.Input(shape=([3, 10]))

Sub72979 = keras.layers.Subtract(name = 'Sub72979', )([in0Sub72979,in1Sub72979])
Res30355 = keras.layers.Reshape((3, 2, 6), name = 'Res30355', )(Sub72979)
Res10104 = keras.layers.Reshape((3, 12), name = 'Res10104', )(Res30355)
Dot86862 = keras.layers.Dot(axes=(1, 1), name = 'Dot86862', )([in0Dot86862,in1Dot86862])
Zer98191 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer98191', )(Dot86862)
Con4120 = keras.layers.Concatenate(axis=2, name = 'Con4120', )([Zer98191,in0Con4120])
Ave19633 = keras.layers.Average(name = 'Ave19633', )([Res10104,Con4120])
model = tf.keras.models.Model(inputs=[in0Sub72979,in1Sub72979,in0Dot86862,in1Dot86862,in0Con4120], outputs=Ave19633)
in0Sub72979 = tf.constant([[[[[0.3841, 0.062], [0.4236, 0.5555], [0.2677, 0.8906]], [[0.507, 0.0441], [0.5067, 0.8659], [0.9334, 0.7493]]], [[[0.3791, 0.7961], [0.2708, 0.795], [0.5455, 0.0502]], [[0.5591, 0.9841], [0.3316, 0.4727], [0.8521, 0.6238]]], [[[0.8751, 0.5696], [0.4501, 0.2997], [0.5693, 0.396]], [[0.4913, 0.138], [0.8718, 0.029], [0.16, 0.6389]]]]])
in1Sub72979 = tf.constant([[[[[0.3419, 0.377], [0.019, 0.6011], [0.7189, 0.3442]], [[0.8743, 0.0078], [0.9616, 0.0504], [0.1416, 0.0014]]], [[[0.4311, 0.8823], [0.8998, 0.2311], [0.8182, 0.6498]], [[0.6868, 0.9287], [0.9914, 0.0092], [0.6246, 0.0406]]], [[[0.6742, 0.6214], [0.6415, 0.6216], [0.7462, 0.2197]], [[0.4039, 0.4859], [0.0082, 0.8761], [0.0632, 0.8003]]]]])
in0Dot86862 = tf.constant([[[0.4517, 0.2751], [0.08, 0.9042], [0.4264, 0.7322]]])
in1Dot86862 = tf.constant([[[0.1967, 0.1463], [0.6181, 0.0253], [0.0922, 0.9385]]])
in0Con4120 = tf.constant([[[0.115, 0.8802, 0.104, 0.2027, 0.8926, 0.8719, 0.2654, 0.7587, 0.9652, 0.9713], [0.0203, 0.8156, 0.2974, 0.8651, 0.5078, 0.0386, 0.1354, 0.3101, 0.2453, 0.6935], [0.3329, 0.0929, 0.1694, 0.1515, 0.4858, 0.2822, 0.7248, 0.0704, 0.5074, 0.3941]]])
print (np.array2string(model.predict([in0Sub72979,in1Sub72979,in0Dot86862,in1Dot86862,in0Con4120],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave19633.png')

LSub72979 = subtract_layer([[[[[0.3841, 0.062], [0.4236, 0.5555], [0.2677, 0.8906]], [[0.507, 0.0441], [0.5067, 0.8659], [0.9334, 0.7493]]], [[[0.3791, 0.7961], [0.2708, 0.795], [0.5455, 0.0502]], [[0.5591, 0.9841], [0.3316, 0.4727], [0.8521, 0.6238]]], [[[0.8751, 0.5696], [0.4501, 0.2997], [0.5693, 0.396]], [[0.4913, 0.138], [0.8718, 0.029], [0.16, 0.6389]]]]], [[[[[0.3419, 0.377], [0.019, 0.6011], [0.7189, 0.3442]], [[0.8743, 0.0078], [0.9616, 0.0504], [0.1416, 0.0014]]], [[[0.4311, 0.8823], [0.8998, 0.2311], [0.8182, 0.6498]], [[0.6868, 0.9287], [0.9914, 0.0092], [0.6246, 0.0406]]], [[[0.6742, 0.6214], [0.6415, 0.6216], [0.7462, 0.2197]], [[0.4039, 0.4859], [0.0082, 0.8761], [0.0632, 0.8003]]]]], Sub72979), 
LRes30355 = reshape_layer(Sub72979, [3, 2, 6], Res30355), 
LRes10104 = reshape_layer(Res30355, [3, 12], Res10104), 
LDot86862 = dot_layer([[[0.4517, 0.2751], [0.08, 0.9042], [0.4264, 0.7322]]], [[[0.1967, 0.1463], [0.6181, 0.0253], [0.0922, 0.9385]]], 1, 1, Dot86862), 
LZer98191 = zero_padding1D_layer(Dot86862, 1, 0, Zer98191), 
LCon4120 = concatenate_layer([Zer98191,[[[0.115, 0.8802, 0.104, 0.2027, 0.8926, 0.8719, 0.2654, 0.7587, 0.9652, 0.9713], [0.0203, 0.8156, 0.2974, 0.8651, 0.5078, 0.0386, 0.1354, 0.3101, 0.2453, 0.6935], [0.3329, 0.0929, 0.1694, 0.1515, 0.4858, 0.2822, 0.7248, 0.0704, 0.5074, 0.3941]]]], 2, Con4120), 
LAve19633 = average_layer([Res10104,Con4120], Ave19633), 
exec_layers([LSub72979,LRes30355,LRes10104,LDot86862,LZer98191,LCon4120,LAve19633],["Sub72979","Res30355","Res10104","Dot86862","Zer98191","Con4120","Ave19633"],Ave19633,"Ave19633")

Actual (Unparsed): [[[0.0211000, -0.1575000, 0.2598000, 0.4173000, -0.1736000, 0.3745500, 0.2626500, 0.4541000, -0.0947500, 0.7871000, 0.8785000, 0.8596000], [0.0628057, 0.1910421, -0.3043500, 0.6897500, 0.0123500, 0.1327500, 0.1900500, 0.0470000, -0.2622000, 0.3868000, 0.2364000, 0.6383500], [0.4407035, 0.3492465, 0.0707500, -0.1145000, -0.0037500, 0.1639000, 0.2866000, -0.0328500, 0.7942000, -0.3883500, 0.3021000, 0.1163500]]]

Expected (Unparsed): [[[0.021100000000000008,-0.1575,0.2598,0.4173,-0.1736,0.37455,0.26265,0.4541,-0.09474999999999997,0.7871,0.8785000000000001,0.8596],[0.062805735,0.19104205500000002,-0.30435,0.6897500000000001,0.012349999999999972,0.13274999999999998,0.19005000000000005,0.047,-0.2622,0.38680000000000003,0.23639999999999994,0.63835],[0.440703515,0.349246545,0.07075000000000001,-0.11450000000000002,-0.0037499999999999756,0.1639,0.2866,-0.03284999999999999,0.7942,-0.38835,0.3021,0.11635000000000001]]]

Actual:   [[[0.0211, -0.1575, 0.2598, 0.4173, -0.1736, 0.3746, 0.2627, 0.4541, -0.0947, 0.7871, 0.8785, 0.8596], [0.0629, 0.1911, -0.3043, 0.6898, 0.0124, 0.1328, 0.1901, 0.047, -0.2622, 0.3868, 0.2364, 0.6384], [0.4408, 0.3493, 0.0708, -0.1145, -0.0037, 0.1639, 0.2866, -0.0328, 0.7942, -0.3883, 0.3021, 0.1164]]]

Expected: [[[0.0212, -0.1575, 0.2598, 0.4173, -0.1736, 0.3746, 0.2627, 0.4541, -0.0947, 0.7871, 0.8786, 0.8596], [0.0629, 0.1911, -0.3043, 0.6898, 0.0124, 0.1328, 0.1901, 0.047, -0.2622, 0.3869, 0.2364, 0.6384], [0.4408, 0.3493, 0.0708, -0.1145, -0.0037, 0.1639, 0.2866, -0.0328, 0.7942, -0.3883, 0.3021, 0.1164]]]