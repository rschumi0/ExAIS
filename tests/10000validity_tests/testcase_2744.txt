import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay13723 = tf.keras.layers.Input(shape=([3]))
in0ReL96050 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Ave71089 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave71089 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con64227 = tf.keras.layers.Input(shape=([3, 1, 1]))
in0Ave13221 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave13221 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con74945 = tf.keras.layers.Input(shape=([3, 1, 2]))

Lay13723 = keras.layers.LayerNormalization(axis=1, epsilon=2.1791062836020023, name = 'Lay13723', )(in0Lay13723)
Res4761 = keras.layers.Reshape((3, 1), name = 'Res4761', )(Lay13723)
Res6098 = keras.layers.Reshape((3, 1, 1), name = 'Res6098', )(Res4761)
Res13860 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res13860', )(Res6098)
Zer38691 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer38691', )(Res13860)
ReL96050 = keras.layers.ReLU(max_value=8.687841754307962, negative_slope=1.048696634239609, threshold=7.312710395237718, name = 'ReL96050', input_shape=(2, 1, 2, 1))(in0ReL96050)
Zer98440 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer98440', )(ReL96050)
Add33559 = keras.layers.Add(name = 'Add33559', )([Zer38691,Zer98440])
Res67878 = keras.layers.Reshape((3, 1, 3), name = 'Res67878', )(Add33559)
Ave71089 = keras.layers.Average(name = 'Ave71089', )([in0Ave71089,in1Ave71089])
Zer74422 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer74422', )(Ave71089)
Con64227 = keras.layers.Concatenate(axis=3, name = 'Con64227', )([Zer74422,in0Con64227])
Min75441 = keras.layers.Minimum(name = 'Min75441', )([Res67878,Con64227])
Ave13221 = keras.layers.Average(name = 'Ave13221', )([in0Ave13221,in1Ave13221])
Zer8390 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer8390', )(Ave13221)
Con74945 = keras.layers.Concatenate(axis=3, name = 'Con74945', )([Zer8390,in0Con74945])
Max12360 = keras.layers.Maximum(name = 'Max12360', )([Min75441,Con74945])
model = tf.keras.models.Model(inputs=[in0Lay13723,in0ReL96050,in0Ave71089,in1Ave71089,in0Con64227,in0Ave13221,in1Ave13221,in0Con74945], outputs=Max12360)
in0Lay13723 = tf.constant([[1.9074, 1.7633, 1.8855]])
in0ReL96050 = tf.constant([[[[[0.3123], [0.5206]]], [[[0.6566], [0.4513]]]]])
in0Ave71089 = tf.constant([[[[0.7691, 0.1276]]]])
in1Ave71089 = tf.constant([[[[0.6404, 0.0655]]]])
in0Con64227 = tf.constant([[[[0.5122]], [[0.1506]], [[0.9175]]]])
in0Ave13221 = tf.constant([[[[0.5493]]]])
in1Ave13221 = tf.constant([[[[0.5262]]]])
in0Con74945 = tf.constant([[[[0.3116, 0.1143]], [[0.2549, 0.7155]], [[0.1874, 0.8536]]]])
print (np.array2string(model.predict([in0Lay13723,in0ReL96050,in0Ave71089,in1Ave71089,in0Con64227,in0Ave13221,in1Ave13221,in0Con74945],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max12360.png')

LLay13723 = layer_normalization_layer([[1.9074, 1.7633, 1.8855]], 1, 2.1791062836020023, Lay13723), 
LRes4761 = reshape_layer(Lay13723, [3, 1], Res4761), 
LRes6098 = reshape_layer(Res4761, [3, 1, 1], Res6098), 
LRes13860 = reshape_layer(Res6098, [3, 1, 1, 1], Res13860), 
LZer38691 = zero_padding3D_layer(Res13860, 0, 0, 0, 0, 2, 0, Zer38691), 
LReL96050 = relu_layer([[[[[0.3123], [0.5206]]], [[[0.6566], [0.4513]]]]], 8.687841754307962, 1.048696634239609, 7.312710395237718, ReL96050), 
LZer98440 = zero_padding3D_layer(ReL96050, 1, 0, 0, 0, 1, 0, Zer98440), 
LAdd33559 = add_layer([Zer38691,Zer98440], Add33559), 
LRes67878 = reshape_layer(Add33559, [3, 1, 3], Res67878), 
LAve71089 = average_layer([[[[[0.7691, 0.1276]]]], [[[[0.6404, 0.0655]]]]], Ave71089), 
LZer74422 = zero_padding2D_layer(Ave71089, 2, 0, 0, 0, Zer74422), 
LCon64227 = concatenate_layer([Zer74422,[[[[0.5122]], [[0.1506]], [[0.9175]]]]], 3, Con64227), 
LMin75441 = minimum_layer([Res67878,Con64227], Min75441), 
LAve13221 = average_layer([[[[[0.5493]]]], [[[[0.5262]]]]], Ave13221), 
LZer8390 = zero_padding2D_layer(Ave13221, 2, 0, 0, 0, Zer8390), 
LCon74945 = concatenate_layer([Zer8390,[[[[0.3116, 0.1143]], [[0.2549, 0.7155]], [[0.1874, 0.8536]]]]], 3, Con74945), 
LMax12360 = maximum_layer([Min75441,Con74945], Max12360), 
exec_layers([LLay13723,LRes4761,LRes6098,LRes13860,LZer38691,LReL96050,LZer98440,LAdd33559,LRes67878,LAve71089,LZer74422,LCon64227,LMin75441,LAve13221,LZer8390,LCon74945,LMax12360],["Lay13723","Res4761","Res6098","Res13860","Zer38691","ReL96050","Zer98440","Add33559","Res67878","Ave71089","Zer74422","Con64227","Min75441","Ave13221","Zer8390","Con74945","Max12360"],Max12360,"Max12360")

Actual (Unparsed): [[[[0.0000000, 0.3116000, 0.1143000]], [[0.0000000, 0.2549000, 0.7155000]], [[0.5377500, 0.1874000, 0.8536000]]]]

Expected (Unparsed): [[[[0,0.3116,0.1143]],[[0,0.2549,0.7155]],[[0.53775,0.1874,0.8536]]]]

Actual:   [[[[0, 0.3116, 0.1143]], [[0, 0.2549, 0.7155]], [[0.5378, 0.1874, 0.8536]]]]

Expected: [[[[0, 0.3116, 0.1143]], [[0, 0.2549, 0.7155]], [[0.5378, 0.1874, 0.8536]]]]