import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo34829 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Con99496 = tf.keras.layers.Input(shape=([2]))
in0ReL42598 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Con34508 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Thr57376 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave33893 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave33893 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con95557 = tf.keras.layers.Input(shape=([1, 1, 2]))

Glo34829 = keras.layers.GlobalAveragePooling3D(name = 'Glo34829', )(in0Glo34829)
Con99496 = keras.layers.Concatenate(axis=1, name = 'Con99496', )([Glo34829,in0Con99496])
ReL42598 = keras.layers.ReLU(max_value=4.026828666345689, negative_slope=2.9548630043248605, threshold=5.909363215026763, name = 'ReL42598', input_shape=(2, 2, 2, 2))(in0ReL42598)
Res54180 = keras.layers.Reshape((2, 2, 4), name = 'Res54180', )(ReL42598)
Glo1457 = keras.layers.GlobalMaxPool2D(name = 'Glo1457', )(Res54180)
Max9719 = keras.layers.Maximum(name = 'Max9719', )([Con99496,Glo1457])
Res58841 = keras.layers.Reshape((4, 1), name = 'Res58841', )(Max9719)
Res77623 = keras.layers.Reshape((4, 1, 1), name = 'Res77623', )(Res58841)
Sep29956 = keras.layers.SeparableConv2D(2, (3, 1),strides=(2, 2), padding='same', name = 'Sep29956', )(Res77623)
Con34508 = keras.layers.Concatenate(axis=3, name = 'Con34508', )([Sep29956,in0Con34508])
Thr57376 = keras.layers.ThresholdedReLU(theta=3.1111909088052228, name = 'Thr57376', input_shape=(2, 1))(in0Thr57376)
Res23544 = keras.layers.Reshape((2, 1, 1), name = 'Res23544', )(Thr57376)
Res86263 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res86263', )(Res23544)
Glo27279 = keras.layers.GlobalAveragePooling3D(name = 'Glo27279', )(Res86263)
Res96960 = keras.layers.Reshape((1, 1), name = 'Res96960', )(Glo27279)
Res75682 = keras.layers.Reshape((1, 1, 1), name = 'Res75682', )(Res96960)
Res19508 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res19508', )(Res75682)
Con14462 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con14462', )(Res19508)
Res43477 = keras.layers.Reshape((1, 1, 4), name = 'Res43477', )(Con14462)
Ave33893 = keras.layers.Average(name = 'Ave33893', )([in0Ave33893,in1Ave33893])
Con95557 = keras.layers.Concatenate(axis=3, name = 'Con95557', )([Ave33893,in0Con95557])
Add13124 = keras.layers.Add(name = 'Add13124', )([Res43477,Con95557])
Zer14235 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer14235', )(Add13124)
Ave36498 = keras.layers.Average(name = 'Ave36498', )([Con34508,Zer14235])
model = tf.keras.models.Model(inputs=[in0Glo34829,in0Con99496,in0ReL42598,in0Con34508,in0Thr57376,in0Ave33893,in1Ave33893,in0Con95557], outputs=Ave36498)
w = model.get_layer('Sep29956').get_weights() 
w[0] = np.array([[[[0.5267]]], [[[0.977]]], [[[0.2331]]]])
w[1] = np.array([[[[0.3334, 0.25]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep29956').set_weights(w) 
w = model.get_layer('Con14462').get_weights() 
w[0] = np.array([[[[[0.5844, 0.1801, 0.2392, 0.4377]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con14462').set_weights(w) 
in0Glo34829 = tf.constant([[[[[1.5372, 1.4375], [1.7681, 1.3136]], [[1.1596, 1.0945], [1.2668, 1.1662]]], [[[1.9931, 1.5603], [1.1964, 1.2939]], [[1.7823, 1.9909], [1.2556, 1.2717]]]]])
in0Con99496 = tf.constant([[0.8493, 0.2352]])
in0ReL42598 = tf.constant([[[[[0.8503, 0.2529], [0.0387, 0.7774]], [[0.1637, 0.2277], [0.5343, 0.7665]]], [[[0.8436, 0.9065], [0.6335, 0.5166]], [[0.5321, 0.8197], [0.5957, 0.9883]]]]])
in0Con34508 = tf.constant([[[[0.4183, 0.8952]], [[0.1794, 0.7378]]]])
in0Thr57376 = tf.constant([[[0.6107], [0.4723]]])
in0Ave33893 = tf.constant([[[[0.1495, 0.8432]]]])
in1Ave33893 = tf.constant([[[[0.3852, 0.3651]]]])
in0Con95557 = tf.constant([[[[0.3811, 0.721]]]])
print (np.array2string(model.predict([in0Glo34829,in0Con99496,in0ReL42598,in0Con34508,in0Thr57376,in0Ave33893,in1Ave33893,in0Con95557],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave36498.png')

LGlo34829 = global_average_pooling3D_layer([[[[[1.5372, 1.4375], [1.7681, 1.3136]], [[1.1596, 1.0945], [1.2668, 1.1662]]], [[[1.9931, 1.5603], [1.1964, 1.2939]], [[1.7823, 1.9909], [1.2556, 1.2717]]]]], Glo34829), 
LCon99496 = concatenate_layer([Glo34829,[[0.8493, 0.2352]]], 1, Con99496), 
LReL42598 = relu_layer([[[[[0.8503, 0.2529], [0.0387, 0.7774]], [[0.1637, 0.2277], [0.5343, 0.7665]]], [[[0.8436, 0.9065], [0.6335, 0.5166]], [[0.5321, 0.8197], [0.5957, 0.9883]]]]], 4.026828666345689, 2.9548630043248605, 5.909363215026763, ReL42598), 
LRes54180 = reshape_layer(ReL42598, [2, 2, 4], Res54180), 
LGlo1457 = global_max_pool2D_layer(Res54180, Glo1457), 
LMax9719 = maximum_layer([Con99496,Glo1457], Max9719), 
LRes58841 = reshape_layer(Max9719, [4, 1], Res58841), 
LRes77623 = reshape_layer(Res58841, [4, 1, 1], Res77623), 
LSep29956 = separable_conv2D_layer(Res77623, 3, 1,[[[[[0.5267]]], [[[0.977]]], [[[0.2331]]]],[[[[0.3334, 0.25]]]]],[0, 0], 2, 2, true, Sep29956), 
LCon34508 = concatenate_layer([Sep29956,[[[[0.4183, 0.8952]], [[0.1794, 0.7378]]]]], 3, Con34508), 
LThr57376 = thresholded_relu_layer([[[0.6107], [0.4723]]], 3.1111909088052228, Thr57376), 
LRes23544 = reshape_layer(Thr57376, [2, 1, 1], Res23544), 
LRes86263 = reshape_layer(Res23544, [2, 1, 1, 1], Res86263), 
LGlo27279 = global_average_pooling3D_layer(Res86263, Glo27279), 
LRes96960 = reshape_layer(Glo27279, [1, 1], Res96960), 
LRes75682 = reshape_layer(Res96960, [1, 1, 1], Res75682), 
LRes19508 = reshape_layer(Res75682, [1, 1, 1, 1], Res19508), 
LCon14462 = conv3D_layer(Res19508, 1, 1, 1,[[[[[0.5844, 0.1801, 0.2392, 0.4377]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con14462), 
LRes43477 = reshape_layer(Con14462, [1, 1, 4], Res43477), 
LAve33893 = average_layer([[[[[0.1495, 0.8432]]]], [[[[0.3852, 0.3651]]]]], Ave33893), 
LCon95557 = concatenate_layer([Ave33893,[[[[0.3811, 0.721]]]]], 3, Con95557), 
LAdd13124 = add_layer([Res43477,Con95557], Add13124), 
LZer14235 = zero_padding2D_layer(Add13124, 1, 0, 0, 0, Zer14235), 
LAve36498 = average_layer([Con34508,Zer14235], Ave36498), 
exec_layers([LGlo34829,LCon99496,LReL42598,LRes54180,LGlo1457,LMax9719,LRes58841,LRes77623,LSep29956,LCon34508,LThr57376,LRes23544,LRes86263,LGlo27279,LRes96960,LRes75682,LRes19508,LCon14462,LRes43477,LAve33893,LCon95557,LAdd13124,LZer14235,LAve36498],["Glo34829","Con99496","ReL42598","Res54180","Glo1457","Max9719","Res58841","Res77623","Sep29956","Con34508","Thr57376","Res23544","Res86263","Glo27279","Res96960","Res75682","Res19508","Con14462","Res43477","Ave33893","Con95557","Add13124","Zer14235","Ave36498"],Ave36498,"Ave36498")

Actual (Unparsed): [[[[0.3908130, 0.2930512, 0.2091500, 0.4476000]], [[0.2465504, 0.3867146, 0.2802500, 0.7294000]]]]

Expected (Unparsed): [[[[0.39081303885337493,0.29305116890625,0.20915,0.4476]],[[0.24655035555699997,0.38671458875,0.28025,0.7294]]]]

Actual:   [[[[0.3909, 0.2931, 0.2092, 0.4476]], [[0.2466, 0.3868, 0.2803, 0.7294]]]]

Expected: [[[[0.3909, 0.2931, 0.2092, 0.4476]], [[0.2466, 0.3868, 0.2803, 0.7294]]]]