import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot54353 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot54353 = tf.keras.layers.Input(shape=([2, 3]))

Dot54353 = keras.layers.Dot(axes=(2, 2), name = 'Dot54353', )([in0Dot54353,in1Dot54353])
GRU54677 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU54677', )(Dot54353)
model = tf.keras.models.Model(inputs=[in0Dot54353,in1Dot54353], outputs=GRU54677)
w = model.get_layer('GRU54677').get_weights() 
w[0] = np.array([[5, 1, 8], [8, 10, 3]])
w[1] = np.array([[5, 3, 8]])
w[2] = np.array([3, 1, 1])
model.get_layer('GRU54677').set_weights(w) 
in0Dot54353 = tf.constant([[[0.0739, 0.9657, 0.5231], [0.7264, 0.2567, 0.9621]]])
in1Dot54353 = tf.constant([[[0.2693, 0.2931, 0.0918], [0.4304, 0.3233, 0.727]]])
print (np.array2string(model.predict([in0Dot54353,in1Dot54353],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU54677.png')

LDot54353 = dot_layer([[[0.0739, 0.9657, 0.5231], [0.7264, 0.2567, 0.9621]]], [[[0.2693, 0.2931, 0.0918], [0.4304, 0.3233, 0.727]]], 2, 2, Dot54353), 
LGRU54677 = gru_layer(Dot54353,[[5, 1, 8], [8, 10, 3]],[[5, 3, 8]],[3, 1, 1], false, GRU54677), 
exec_layers([LDot54353,LGRU54677],["Dot54353","GRU54677"],GRU54677,"GRU54677")

Actual (Unparsed): [[0.0000275]]

Expected (Unparsed): [[2.750537508034404e-5]]

Actual:   [[0.0001]]

Expected: [[0.0001]]