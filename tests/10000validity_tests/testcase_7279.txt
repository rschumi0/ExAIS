import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo36960 = tf.keras.layers.Input(shape=([2, 1]))
in0Con31205 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Ave23178 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave23178 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Dot51260 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot51260 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul40670 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul40670 = tf.keras.layers.Input(shape=([2, 1, 1]))

Glo36960 = keras.layers.GlobalMaxPool1D(name = 'Glo36960', )(in0Glo36960)
Res7530 = keras.layers.Reshape((1, 1), name = 'Res7530', )(Glo36960)
Res28799 = keras.layers.Reshape((1, 1, 1), name = 'Res28799', )(Res7530)
Con31205 = keras.layers.Concatenate(axis=3, name = 'Con31205', )([Res28799,in0Con31205])
Ave23178 = keras.layers.Average(name = 'Ave23178', )([in0Ave23178,in1Ave23178])
Max15981 = keras.layers.Maximum(name = 'Max15981', )([Con31205,Ave23178])
Res84729 = keras.layers.Reshape((1, 2), name = 'Res84729', )(Max15981)
Zer91676 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer91676', )(Res84729)
Dot51260 = keras.layers.Dot(axes=(2, 2), name = 'Dot51260', )([in0Dot51260,in1Dot51260])
Res51017 = keras.layers.Reshape((2, 2, 1), name = 'Res51017', )(Dot51260)
Max45777 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(11, 1), padding='same', name = 'Max45777', )(Res51017)
Res55507 = keras.layers.Reshape((1, 2), name = 'Res55507', )(Max45777)
Mul40670 = keras.layers.Multiply(name = 'Mul40670', )([in0Mul40670,in1Mul40670])
Res70978 = keras.layers.Reshape((1, 2), name = 'Res70978', )(Mul40670)
Dot19833 = keras.layers.Dot(axes=(1, 1), name = 'Dot19833', )([Res55507,Res70978])
Ave45772 = keras.layers.Average(name = 'Ave45772', )([Zer91676,Dot19833])
model = tf.keras.models.Model(inputs=[in0Glo36960,in0Con31205,in0Ave23178,in1Ave23178,in0Dot51260,in1Dot51260,in0Mul40670,in1Mul40670], outputs=Ave45772)
in0Glo36960 = tf.constant([[[1.4974], [1.4444]]])
in0Con31205 = tf.constant([[[[0.5298]]]])
in0Ave23178 = tf.constant([[[[0.4028, 0.6168]]]])
in1Ave23178 = tf.constant([[[[0.6595, 0.1874]]]])
in0Dot51260 = tf.constant([[[0.8225, 0.124], [0.2183, 0.6267]]])
in1Dot51260 = tf.constant([[[0.3462, 0.5427], [0.8293, 0.234]]])
in0Mul40670 = tf.constant([[[[0.4144]], [[0.7548]]]])
in1Mul40670 = tf.constant([[[[0.3029]], [[0.3339]]]])
print (np.array2string(model.predict([in0Glo36960,in0Con31205,in0Ave23178,in1Ave23178,in0Dot51260,in1Dot51260,in0Mul40670,in1Mul40670],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave45772.png')

LGlo36960 = global_max_pool1D_layer([[[1.4974], [1.4444]]], Glo36960), 
LRes7530 = reshape_layer(Glo36960, [1, 1], Res7530), 
LRes28799 = reshape_layer(Res7530, [1, 1, 1], Res28799), 
LCon31205 = concatenate_layer([Res28799,[[[[0.5298]]]]], 3, Con31205), 
LAve23178 = average_layer([[[[[0.4028, 0.6168]]]], [[[[0.6595, 0.1874]]]]], Ave23178), 
LMax15981 = maximum_layer([Con31205,Ave23178], Max15981), 
LRes84729 = reshape_layer(Max15981, [1, 2], Res84729), 
LZer91676 = zero_padding1D_layer(Res84729, 1, 0, Zer91676), 
LDot51260 = dot_layer([[[0.8225, 0.124], [0.2183, 0.6267]]], [[[0.3462, 0.5427], [0.8293, 0.234]]], 2, 2, Dot51260), 
LRes51017 = reshape_layer(Dot51260, [2, 2, 1], Res51017), 
LMax45777 = max_pool2D_layer(Res51017, 2, 1, 11, 1, true, Max45777), 
LRes55507 = reshape_layer(Max45777, [1, 2], Res55507), 
LMul40670 = multiply_layer([[[[[0.4144]], [[0.7548]]]], [[[[0.3029]], [[0.3339]]]]], Mul40670), 
LRes70978 = reshape_layer(Mul40670, [1, 2], Res70978), 
LDot19833 = dot_layer(Res55507,Res70978, 1, 1, Dot19833), 
LAve45772 = average_layer([Zer91676,Dot19833], Ave45772), 
exec_layers([LGlo36960,LRes7530,LRes28799,LCon31205,LAve23178,LMax15981,LRes84729,LZer91676,LDot51260,LRes51017,LMax45777,LRes55507,LMul40670,LRes70978,LDot19833,LAve45772],["Glo36960","Res7530","Res28799","Con31205","Ave23178","Max15981","Res84729","Zer91676","Dot51260","Res51017","Max45777","Res55507","Mul40670","Res70978","Dot19833","Ave45772"],Ave45772,"Ave45772")

Actual (Unparsed): [[[0.0260888, 0.0523821], [0.7933302, 0.3545104]]]

Expected (Unparsed): [[[0.026088790921284,0.052382140701723],[0.7933302188714201,0.35451037755736503]]]

Actual:   [[[0.0261, 0.0524], [0.7934, 0.3546]]]

Expected: [[[0.0261, 0.0524], [0.7934, 0.3546]]]