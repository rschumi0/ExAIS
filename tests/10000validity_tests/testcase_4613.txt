import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer89456 = tf.keras.layers.Input(shape=([2, 1]))
in0Thr49947 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Zer89456 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer89456', )(in0Zer89456)
Res40838 = keras.layers.Reshape((4, 1, 1), name = 'Res40838', )(Zer89456)
Res11231 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res11231', )(Res40838)
Zer37273 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer37273', )(Res11231)
Thr49947 = keras.layers.ThresholdedReLU(theta=8.9416247448085, name = 'Thr49947', input_shape=(1, 2, 1, 1))(in0Thr49947)
Zer406 = keras.layers.ZeroPadding3D(padding=((3, 0), (1, 0), (0, 0)), name = 'Zer406', )(Thr49947)
Sub33183 = keras.layers.Subtract(name = 'Sub33183', )([Zer37273,Zer406])
Res98607 = keras.layers.Reshape((4, 3, 1), name = 'Res98607', )(Sub33183)
Res87319 = keras.layers.Reshape((4, 3), name = 'Res87319', )(Res98607)
Con8153 = keras.layers.Conv1D(2, (1),strides=(8), padding='same', dilation_rate=(1), name = 'Con8153', )(Res87319)
Den27684 = keras.layers.Dense(4,name = 'Den27684', )(Con8153)
model = tf.keras.models.Model(inputs=[in0Zer89456,in0Thr49947], outputs=Den27684)
w = model.get_layer('Con8153').get_weights() 
w[0] = np.array([[[0.0475, 0.1088], [0.7664, 0.4745], [0.0842, 0.1132]]])
w[1] = np.array([0, 0])
model.get_layer('Con8153').set_weights(w) 
w = model.get_layer('Den27684').get_weights() 
w[0] = np.array([[0.2009, 0.638, 0.5721, 0.0784], [0.979, 0.7728, 0.715, 0.8546]])
w[1] = np.array([0.8797, 0.5798, 0.5616, 0.3498])
model.get_layer('Den27684').set_weights(w) 
in0Zer89456 = tf.constant([[[1.245], [1.6027]]])
in0Thr49947 = tf.constant([[[[[0.3609]], [[0.5691]]]]])
print (np.array2string(model.predict([in0Zer89456,in0Thr49947],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den27684.png')

LZer89456 = zero_padding1D_layer([[[1.245], [1.6027]]], 1, 1, Zer89456), 
LRes40838 = reshape_layer(Zer89456, [4, 1, 1], Res40838), 
LRes11231 = reshape_layer(Res40838, [4, 1, 1, 1], Res11231), 
LZer37273 = zero_padding3D_layer(Res11231, 0, 0, 2, 0, 0, 0, Zer37273), 
LThr49947 = thresholded_relu_layer([[[[[0.3609]], [[0.5691]]]]], 8.9416247448085, Thr49947), 
LZer406 = zero_padding3D_layer(Thr49947, 3, 0, 1, 0, 0, 0, Zer406), 
LSub33183 = subtract_layer(Zer37273,Zer406, Sub33183), 
LRes98607 = reshape_layer(Sub33183, [4, 3, 1], Res98607), 
LRes87319 = reshape_layer(Res98607, [4, 3], Res87319), 
LCon8153 = conv1D_layer(Res87319, 1,[[[0.0475, 0.1088], [0.7664, 0.4745], [0.0842, 0.1132]]],[0, 0], 8, true, 1, Con8153), 
LDen27684 = dense_layer(Con8153, [[0.2009, 0.638, 0.5721, 0.0784], [0.979, 0.7728, 0.715, 0.8546]],[0.8797, 0.5798, 0.5616, 0.3498], Den27684), 
exec_layers([LZer89456,LRes40838,LRes11231,LZer37273,LThr49947,LZer406,LSub33183,LRes98607,LRes87319,LCon8153,LDen27684],["Zer89456","Res40838","Res11231","Zer37273","Thr49947","Zer406","Sub33183","Res98607","Res87319","Con8153","Den27684"],Den27684,"Den27684")

Actual (Unparsed): [[[0.8797000, 0.5798000, 0.5616000, 0.3498000]]]

Expected (Unparsed): [[[0.8797,0.5798,0.5616,0.3498]]]

Actual:   [[[0.8797, 0.5798, 0.5616, 0.3498]]]

Expected: [[[0.8797, 0.5798, 0.5616, 0.3498]]]