import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof40499 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Sof40499 = keras.layers.Softmax(axis=1, name = 'Sof40499', input_shape=(2, 1, 1, 2))(in0Sof40499)
Res92842 = keras.layers.Reshape((2, 1, 2), name = 'Res92842', )(Sof40499)
Res54056 = keras.layers.Reshape((2, 2), name = 'Res54056', )(Res92842)
Glo88438 = keras.layers.GlobalMaxPool1D(name = 'Glo88438', )(Res54056)
Res54304 = keras.layers.Reshape((2, 1), name = 'Res54304', )(Glo88438)
Res38227 = keras.layers.Reshape((2, 1, 1), name = 'Res38227', )(Res54304)
Res68896 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res68896', )(Res38227)
Con99009 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con99009', )(Res68896)
model = tf.keras.models.Model(inputs=[in0Sof40499], outputs=Con99009)
w = model.get_layer('Con99009').get_weights() 
w[0] = np.array([[[[[0.4926, 0.0637, 0.2522]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con99009').set_weights(w) 
in0Sof40499 = tf.constant([[[[[0.5262, 0.2318]]], [[[0.8658, 0.5915]]]]])
print (np.array2string(model.predict([in0Sof40499],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con99009.png')

LSof40499 = softmax_layer([[[[[0.5262, 0.2318]]], [[[0.8658, 0.5915]]]]], 1, Sof40499), 
LRes92842 = reshape_layer(Sof40499, [2, 1, 2], Res92842), 
LRes54056 = reshape_layer(Res92842, [2, 2], Res54056), 
LGlo88438 = global_max_pool1D_layer(Res54056, Glo88438), 
LRes54304 = reshape_layer(Glo88438, [2, 1], Res54304), 
LRes38227 = reshape_layer(Res54304, [2, 1, 1], Res38227), 
LRes68896 = reshape_layer(Res38227, [2, 1, 1, 1], Res68896), 
LCon99009 = conv3D_layer(Res68896, 1, 1, 1,[[[[[0.4926, 0.0637, 0.2522]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con99009), 
exec_layers([LSof40499,LRes92842,LRes54056,LGlo88438,LRes54304,LRes38227,LRes68896,LCon99009],["Sof40499","Res92842","Res54056","Glo88438","Res54304","Res38227","Res68896","Con99009"],Con99009,"Con99009")

Actual (Unparsed): [[[[[0.2877244, 0.0372067, 0.1473083]]], [[[0.2901255, 0.0375172, 0.1485377]]]]]

Expected (Unparsed): [[[[[0.28772438661492844,0.03720674670599054,0.14730834410126867]]],[[[0.2901255434911913,0.037517249533879186,0.14853768182801144]]]]]

Actual:   [[[[[0.2878, 0.0373, 0.1474]]], [[[0.2902, 0.0376, 0.1486]]]]]

Expected: [[[[[0.2878, 0.0373, 0.1474]]], [[[0.2902, 0.0376, 0.1486]]]]]