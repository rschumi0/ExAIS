import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add55469 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add55469 = tf.keras.layers.Input(shape=([2, 2, 1]))

Add55469 = keras.layers.Add(name = 'Add55469', )([in0Add55469,in1Add55469])
Den55670 = keras.layers.Dense(1,name = 'Den55670', )(Add55469)
Mas9118 = keras.layers.Masking(mask_value=1, name = 'Mas9118', )(Den55670)
model = tf.keras.models.Model(inputs=[in0Add55469,in1Add55469], outputs=Mas9118)
w = model.get_layer('Den55670').get_weights() 
w[0] = np.array([[0.8277]])
w[1] = np.array([0.7902])
model.get_layer('Den55670').set_weights(w) 
in0Add55469 = tf.constant([[[[0.0589], [0.0625]], [[0.4366], [0.2339]]]])
in1Add55469 = tf.constant([[[[0.062], [0.146]], [[0.6586], [0.6279]]]])
print (np.array2string(model.predict([in0Add55469,in1Add55469],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas9118.png')

LAdd55469 = add_layer([[[[[0.0589], [0.0625]], [[0.4366], [0.2339]]]], [[[[0.062], [0.146]], [[0.6586], [0.6279]]]]], Add55469), 
LDen55670 = dense_layer(Add55469, [[0.8277]],[0.7902], Den55670), 
LMas9118 = masking_layer(Den55670, 1, Mas9118), 
exec_layers([LAdd55469,LDen55670,LMas9118],["Add55469","Den55670","Mas9118"],Mas9118,"Mas9118")

Actual (Unparsed): [[[[0.8902689], [0.9627754]], [[1.6966970], [1.5035119]]]]

Expected (Unparsed): [[[[0.89026893],[0.96277545]],[[1.69669704],[1.5035118600000001]]]]

Actual:   [[[[0.8903], [0.9628]], [[1.6967], [1.5036]]]]

Expected: [[[[0.8903], [0.9628]], [[1.6967], [1.5036]]]]