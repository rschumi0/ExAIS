import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer77606 = tf.keras.layers.Input(shape=([4, 1, 4]))
in0Con86373 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave96303 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave96303 = tf.keras.layers.Input(shape=([2, 2, 2]))

Zer77606 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer77606', )(in0Zer77606)
Res63184 = keras.layers.Reshape((6, 12), name = 'Res63184', )(Zer77606)
Sim5616 = keras.layers.SimpleRNN(2,name = 'Sim5616', )(Res63184)
Res76719 = keras.layers.Reshape((2, 1), name = 'Res76719', )(Sim5616)
Res54247 = keras.layers.Reshape((2, 1, 1), name = 'Res54247', )(Res76719)
Zer55186 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer55186', )(Res54247)
Con86373 = keras.layers.Concatenate(axis=3, name = 'Con86373', )([Zer55186,in0Con86373])
Ave96303 = keras.layers.Average(name = 'Ave96303', )([in0Ave96303,in1Ave96303])
Add94141 = keras.layers.Add(name = 'Add94141', )([Con86373,Ave96303])
Fla86032 = keras.layers.Flatten(name = 'Fla86032', )(Add94141)
Res66272 = keras.layers.Reshape((8, 1), name = 'Res66272', )(Fla86032)
Res62724 = keras.layers.Reshape((8, 1, 1), name = 'Res62724', )(Res66272)
Res50235 = keras.layers.Reshape((8, 1, 1, 1), name = 'Res50235', )(Res62724)
Con95309 = keras.layers.Conv3DTranspose(3, (4, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con95309', )(Res50235)
Zer23087 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer23087', )(Con95309)
model = tf.keras.models.Model(inputs=[in0Zer77606,in0Con86373,in0Ave96303,in1Ave96303], outputs=Zer23087)
w = model.get_layer('Sim5616').get_weights() 
w[0] = np.array([[4, 9], [5, 8], [6, 7], [7, 4], [10, 8], [7, 5], [9, 3], [5, 4], [8, 6], [7, 5], [8, 9], [9, 4]])
w[1] = np.array([[8, 3], [10, 2]])
w[2] = np.array([1, 9])
model.get_layer('Sim5616').set_weights(w) 
w = model.get_layer('Con95309').get_weights() 
w[0] = np.array([[[[[0.9935], [0.1421], [0.3006]]]], [[[[0.3754], [0.1816], [0.3974]]]], [[[[0.8663], [0.9589], [0.3]]]], [[[[0.9498], [0.7167], [0.042]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con95309').set_weights(w) 
in0Zer77606 = tf.constant([[[[1.3285, 1.6945, 1.3921, 1.0085]], [[1.5344, 1.4744, 1.5327, 1.536]], [[1.1917, 1.5553, 1.331, 1.5265]], [[1.0555, 1.1822, 1.5331, 1.8285]]]])
in0Con86373 = tf.constant([[[[0.4553], [0.8784]], [[0.8161], [0.3501]]]])
in0Ave96303 = tf.constant([[[[0.162, 0.526], [0.9548, 0.3774]], [[0.5355, 0.9499], [0.8833, 0.8902]]]])
in1Ave96303 = tf.constant([[[[0.8605, 0.7563], [0.3311, 0.024]], [[0.9666, 0.2216], [0.4987, 0.6323]]]])
print (np.array2string(model.predict([in0Zer77606,in0Con86373,in0Ave96303,in1Ave96303],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer23087.png')

LZer77606 = zero_padding2D_layer([[[[1.3285, 1.6945, 1.3921, 1.0085]], [[1.5344, 1.4744, 1.5327, 1.536]], [[1.1917, 1.5553, 1.331, 1.5265]], [[1.0555, 1.1822, 1.5331, 1.8285]]]], 1, 1, 1, 1, Zer77606), 
LRes63184 = reshape_layer(Zer77606, [6, 12], Res63184), 
LSim5616 = simple_rnn_layer(Res63184,[[4, 9], [5, 8], [6, 7], [7, 4], [10, 8], [7, 5], [9, 3], [5, 4], [8, 6], [7, 5], [8, 9], [9, 4]],[[8, 3], [10, 2]],[1, 9], Sim5616), 
LRes76719 = reshape_layer(Sim5616, [2, 1], Res76719), 
LRes54247 = reshape_layer(Res76719, [2, 1, 1], Res54247), 
LZer55186 = zero_padding2D_layer(Res54247, 0, 0, 1, 0, Zer55186), 
LCon86373 = concatenate_layer([Zer55186,[[[[0.4553], [0.8784]], [[0.8161], [0.3501]]]]], 3, Con86373), 
LAve96303 = average_layer([[[[[0.162, 0.526], [0.9548, 0.3774]], [[0.5355, 0.9499], [0.8833, 0.8902]]]], [[[[0.8605, 0.7563], [0.3311, 0.024]], [[0.9666, 0.2216], [0.4987, 0.6323]]]]], Ave96303), 
LAdd94141 = add_layer([Con86373,Ave96303], Add94141), 
LFla86032 = flatten_layer(Add94141, Fla86032), 
LRes66272 = reshape_layer(Fla86032, [8, 1], Res66272), 
LRes62724 = reshape_layer(Res66272, [8, 1, 1], Res62724), 
LRes50235 = reshape_layer(Res62724, [8, 1, 1, 1], Res50235), 
LCon95309 = conv3D_transpose_layer(Res50235, 4, 1, 1,[[[[[0.9935], [0.1421], [0.3006]]]], [[[[0.3754], [0.1816], [0.3974]]]], [[[[0.8663], [0.9589], [0.3]]]], [[[[0.9498], [0.7167], [0.042]]]]],[0, 0, 0], 1, 1, 1, false, Con95309), 
LZer23087 = zero_padding3D_layer(Con95309, 1, 1, 1, 1, 1, 1, Zer23087), 
exec_layers([LZer77606,LRes63184,LSim5616,LRes76719,LRes54247,LZer55186,LCon86373,LAve96303,LAdd94141,LFla86032,LRes66272,LRes62724,LRes50235,LCon95309,LZer23087],["Zer77606","Res63184","Sim5616","Res76719","Res54247","Zer55186","Con86373","Ave96303","Add94141","Fla86032","Res66272","Res62724","Res50235","Con95309","Zer23087"],Zer23087,"Zer23087")

Actual (Unparsed): [[[[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.5079269, 0.0726486, 0.1536817], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [1.2812463, 0.2486485, 0.5327636], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [2.4867740, 0.9228161, 1.0829750], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [3.1242892, 1.8694986, 1.3276933], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [3.6159581, 2.6639392, 1.1935359], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [4.1699804, 2.5478448, 1.1125973], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [3.8818268, 1.9884399, 1.3360470], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [3.6666976, 2.3475199, 1.4581743], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [3.2135912, 2.8280269, 1.0078282], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [2.5688743, 2.2776132, 0.4044270], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [1.0555603, 0.7965046, 0.0466767], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]]]

Expected (Unparsed): [[[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0.507926875,0.072648625,0.15368174999999998],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1.2812463250000001,0.248648545,0.5327636199999999],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[2.48677403,0.92281614,1.082975],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[3.1242891649999995,1.8694986099999997,1.32769329],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[3.6159581100000002,2.663939235,1.1935358699999998],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[4.169980385,2.54784482,1.1125972800000001],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[3.881826784998626,1.9884398749998033,1.3360469899995842],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[3.6666975699994806,2.347519934999749,1.4581743099994504],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[3.2135912199988015,2.828026954998674,1.0078281899995851],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[2.5688743049986864,2.277613214999009,0.4044269999999419],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[1.05556023,0.796504545,0.04667670000000001],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]]]]

Actual:   [[[[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0.508, 0.0727, 0.1537], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [1.2813, 0.2487, 0.5328], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [2.4868, 0.9229, 1.083], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.1243, 1.8695, 1.3277], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.616, 2.664, 1.1936], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [4.17, 2.5479, 1.1126], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.8819, 1.9885, 1.3361], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.6667, 2.3476, 1.4582], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.2136, 2.8281, 1.0079], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [2.5689, 2.2777, 0.4045], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [1.0556, 0.7966, 0.0467], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]]

Expected: [[[[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0.508, 0.0727, 0.1537], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [1.2813, 0.2487, 0.5328], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [2.4868, 0.9229, 1.083], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.1243, 1.8695, 1.3277], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.616, 2.664, 1.1936], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [4.17, 2.5479, 1.1126], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.8819, 1.9885, 1.3361], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.6667, 2.3476, 1.4582], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [3.2136, 2.8281, 1.0079], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [2.5689, 2.2777, 0.4045], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [1.0556, 0.7966, 0.0467], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]]