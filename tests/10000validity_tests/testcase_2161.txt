import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave37928 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Ave37928 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Ave37928 = keras.layers.Average(name = 'Ave37928', )([in0Ave37928,in1Ave37928])
Res41735 = keras.layers.Reshape((2, 2, 1), name = 'Res41735', )(Ave37928)
Res34006 = keras.layers.Reshape((2, 2), name = 'Res34006', )(Res41735)
Con53152 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con53152', )(Res34006)
Res22670 = keras.layers.Reshape((2, 4, 1), name = 'Res22670', )(Con53152)
Res54183 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res54183', )(Res22670)
Glo12628 = keras.layers.GlobalAveragePooling3D(name = 'Glo12628', )(Res54183)
model = tf.keras.models.Model(inputs=[in0Ave37928,in1Ave37928], outputs=Glo12628)
w = model.get_layer('Con53152').get_weights() 
w[0] = np.array([[[0.9426, 0.6084, 0.6123, 0.4508], [0.7823, 0.4757, 0.5734, 0.4184]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con53152').set_weights(w) 
in0Ave37928 = tf.constant([[[[[0.8784]], [[0.7459]]], [[[0.4282]], [[0.2646]]]]])
in1Ave37928 = tf.constant([[[[[0.1761]], [[0.7581]]], [[[0.1158]], [[0.1581]]]]])
print (np.array2string(model.predict([in0Ave37928,in1Ave37928],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo12628.png')

LAve37928 = average_layer([[[[[[0.8784]], [[0.7459]]], [[[0.4282]], [[0.2646]]]]], [[[[[0.1761]], [[0.7581]]], [[[0.1158]], [[0.1581]]]]]], Ave37928), 
LRes41735 = reshape_layer(Ave37928, [2, 2, 1], Res41735), 
LRes34006 = reshape_layer(Res41735, [2, 2], Res34006), 
LCon53152 = conv1D_layer(Res34006, 1,[[[0.9426, 0.6084, 0.6123, 0.4508], [0.7823, 0.4757, 0.5734, 0.4184]]],[0, 0, 0, 0], 1, false, 1, Con53152), 
LRes22670 = reshape_layer(Con53152, [2, 4, 1], Res22670), 
LRes54183 = reshape_layer(Res22670, [2, 4, 1, 1], Res54183), 
LGlo12628 = global_average_pooling3D_layer(Res54183, Glo12628), 
exec_layers([LAve37928,LRes41735,LRes34006,LCon53152,LRes22670,LRes54183,LGlo12628],["Ave37928","Res41735","Res34006","Con53152","Res22670","Res54183","Glo12628"],Glo12628,"Glo12628")

Actual (Unparsed): [[0.5320830]]

Expected (Unparsed): [[0.532083031875]]

Actual:   [[0.5321]]

Expected: [[0.5321]]