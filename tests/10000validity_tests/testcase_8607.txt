import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max35155 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max35155 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Cro80213 = tf.keras.layers.Input(shape=([1, 3, 3, 2]))
in0Max4397 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max4397 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con44325 = tf.keras.layers.Input(shape=([1, 6, 2]))
in0Ave5294 = tf.keras.layers.Input(shape=([1, 1, 2]))

Max35155 = keras.layers.Maximum(name = 'Max35155', )([in0Max35155,in1Max35155])
Res87670 = keras.layers.Reshape((1, 2), name = 'Res87670', )(Max35155)
Con79197 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con79197', )(Res87670)
Res25057 = keras.layers.Reshape((1, 4, 1), name = 'Res25057', )(Con79197)
Zer21576 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer21576', )(Res25057)
Cro80213 = keras.layers.Cropping3D(cropping=((0, 0), (2, 0), (0, 0)), name = 'Cro80213', )(in0Cro80213)
Res19595 = keras.layers.Reshape((1, 1, 6), name = 'Res19595', )(Cro80213)
Res60649 = keras.layers.Reshape((1, 6), name = 'Res60649', )(Res19595)
Ave5091 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave5091', )(Res60649)
Res16990 = keras.layers.Reshape((1, 6, 1), name = 'Res16990', )(Ave5091)
Max4397 = keras.layers.Maximum(name = 'Max4397', )([in0Max4397,in1Max4397])
Zer53687 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer53687', )(Max4397)
Sub91423 = keras.layers.Subtract(name = 'Sub91423', )([Res16990,Zer53687])
Mul86943 = keras.layers.Multiply(name = 'Mul86943', )([Zer21576,Sub91423])
Con44325 = keras.layers.Concatenate(axis=3, name = 'Con44325', )([Mul86943,in0Con44325])
Ave5294 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave5294', )(in0Ave5294)
Con55651 = keras.layers.Conv2D(3, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con55651', )(Ave5294)
Zer56945 = keras.layers.ZeroPadding2D(padding=((0, 0), (5, 0)), name = 'Zer56945', )(Con55651)
Ave80824 = keras.layers.Average(name = 'Ave80824', )([Con44325,Zer56945])
model = tf.keras.models.Model(inputs=[in0Max35155,in1Max35155,in0Cro80213,in0Max4397,in1Max4397,in0Con44325,in0Ave5294], outputs=Ave80824)
w = model.get_layer('Con79197').get_weights() 
w[0] = np.array([[[0.9425, 0.2208, 0.769, 0.7808], [0.825, 0.0185, 0.3608, 0.9053]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con79197').set_weights(w) 
w = model.get_layer('Con55651').get_weights() 
w[0] = np.array([[[[0.908, 0.3404, 0.7187], [0.495, 0.0493, 0.0944]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con55651').set_weights(w) 
in0Max35155 = tf.constant([[[[0.9453, 0.7541]]]])
in1Max35155 = tf.constant([[[[0.362, 0.2508]]]])
in0Cro80213 = tf.constant([[[[[1.2651, 1.9957], [1.6583, 1.8282], [1.5888, 1.0775]], [[1.9347, 1.5328], [1.3999, 1.6472], [1.9727, 1.4258]], [[1.7129, 1.8012], [1.3695, 1.0919], [1.9836, 1.3391]]]]])
in0Max4397 = tf.constant([[[[0.8068], [0.0237]]]])
in1Max4397 = tf.constant([[[[0.8182], [0.3768]]]])
in0Con44325 = tf.constant([[[[0.2926, 0.9298], [0.9691, 0.8844], [0.9208, 0.185], [0.2573, 0.6732], [0.8116, 0.4277], [0.0702, 0.3251]]]])
in0Ave5294 = tf.constant([[[[1.1485, 1.3383]]]])
print (np.array2string(model.predict([in0Max35155,in1Max35155,in0Cro80213,in0Max4397,in1Max4397,in0Con44325,in0Ave5294],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave80824.png')

LMax35155 = maximum_layer([[[[[0.9453, 0.7541]]]], [[[[0.362, 0.2508]]]]], Max35155), 
LRes87670 = reshape_layer(Max35155, [1, 2], Res87670), 
LCon79197 = conv1D_layer(Res87670, 1,[[[0.9425, 0.2208, 0.769, 0.7808], [0.825, 0.0185, 0.3608, 0.9053]]],[0, 0, 0, 0], 1, false, 1, Con79197), 
LRes25057 = reshape_layer(Con79197, [1, 4, 1], Res25057), 
LZer21576 = zero_padding2D_layer(Res25057, 0, 0, 2, 0, Zer21576), 
LCro80213 = cropping3D_layer([[[[[1.2651, 1.9957], [1.6583, 1.8282], [1.5888, 1.0775]], [[1.9347, 1.5328], [1.3999, 1.6472], [1.9727, 1.4258]], [[1.7129, 1.8012], [1.3695, 1.0919], [1.9836, 1.3391]]]]], 0, 0, 2, 0, 0, 0, Cro80213), 
LRes19595 = reshape_layer(Cro80213, [1, 1, 6], Res19595), 
LRes60649 = reshape_layer(Res19595, [1, 6], Res60649), 
LAve5091 = average_pooling1D_layer(Res60649, 1, Ave5091), 
LRes16990 = reshape_layer(Ave5091, [1, 6, 1], Res16990), 
LMax4397 = maximum_layer([[[[[0.8068], [0.0237]]]], [[[[0.8182], [0.3768]]]]], Max4397), 
LZer53687 = zero_padding2D_layer(Max4397, 0, 0, 4, 0, Zer53687), 
LSub91423 = subtract_layer(Res16990,Zer53687, Sub91423), 
LMul86943 = multiply_layer([Zer21576,Sub91423], Mul86943), 
LCon44325 = concatenate_layer([Mul86943,[[[[0.2926, 0.9298], [0.9691, 0.8844], [0.9208, 0.185], [0.2573, 0.6732], [0.8116, 0.4277], [0.0702, 0.3251]]]]], 3, Con44325), 
LAve5294 = average_pooling2D_layer([[[[1.1485, 1.3383]]]], 1, 1, Ave5294), 
LCon55651 = conv2D_layer(Ave5294, 1, 1,[[[[0.908, 0.3404, 0.7187], [0.495, 0.0493, 0.0944]]]],[0, 0, 0], 1, 1, false, 1, 1, Con55651), 
LZer56945 = zero_padding2D_layer(Con55651, 0, 0, 5, 0, Zer56945), 
LAve80824 = average_layer([Con44325,Zer56945], Ave80824), 
exec_layers([LMax35155,LRes87670,LCon79197,LRes25057,LZer21576,LCro80213,LRes19595,LRes60649,LAve5091,LRes16990,LMax4397,LZer53687,LSub91423,LMul86943,LCon44325,LAve5294,LCon55651,LZer56945,LAve80824],["Max35155","Res87670","Con79197","Res25057","Zer21576","Cro80213","Res19595","Res60649","Ave5091","Res16990","Max4397","Zer53687","Sub91423","Mul86943","Con44325","Ave5294","Con55651","Zer56945","Ave80824"],Ave80824,"Ave80824")

Actual (Unparsed): [[[[0.0000000, 0.1463000, 0.4649000], [0.0000000, 0.4845500, 0.4422000], [1.0360800, 0.4604000, 0.0925000], [0.1215684, 0.1286500, 0.3366000], [0.5821260, 0.4058000, 0.2138500], [1.5362551, 0.2635638, 0.6384312]]]]

Expected (Unparsed): [[[[0.0,0.1463,0.4649],[0.0,0.48455,0.4422],[1.0360799893125,0.4604,0.0925],[0.12156837348550001,0.12865,0.3366],[0.5821260288460001,0.4058,0.21385],[1.5362550891155,0.263563795,0.6384312350000001]]]]

Actual:   [[[[0, 0.1463, 0.4649], [0, 0.4846, 0.4422], [1.0361, 0.4604, 0.0925], [0.1216, 0.1287, 0.3366], [0.5822, 0.4058, 0.2139], [1.5363, 0.2636, 0.6385]]]]

Expected: [[[[0, 0.1463, 0.4649], [0, 0.4846, 0.4422], [1.0361, 0.4604, 0.0925], [0.1216, 0.1287, 0.3366], [0.5822, 0.4058, 0.2139], [1.5363, 0.2636, 0.6385]]]]