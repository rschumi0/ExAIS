import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den87504 = tf.keras.layers.Input(shape=([5, 3, 2]))

Den87504 = keras.layers.Dense(2,name = 'Den87504', )(in0Den87504)
Res73315 = keras.layers.Reshape((5, 6), name = 'Res73315', )(Den87504)
Sim96728 = keras.layers.SimpleRNN(3,name = 'Sim96728', )(Res73315)
model = tf.keras.models.Model(inputs=[in0Den87504], outputs=Sim96728)
w = model.get_layer('Den87504').get_weights() 
w[0] = np.array([[0.2535, 0.9355], [0.5046, 0.3408]])
w[1] = np.array([0.7425, 0.4172])
model.get_layer('Den87504').set_weights(w) 
w = model.get_layer('Sim96728').get_weights() 
w[0] = np.array([[1, 8, 5], [9, 7, 9], [5, 10, 1], [3, 2, 1], [10, 8, 7], [6, 3, 9]])
w[1] = np.array([[9, 7, 10], [6, 10, 8], [7, 5, 10]])
w[2] = np.array([6, 1, 8])
model.get_layer('Sim96728').set_weights(w) 
in0Den87504 = tf.constant([[[[0.0222, 0.5465], [0.0081, 0.9549], [0.3993, 0.9186]], [[0.7011, 0.1148], [0.9747, 0.635], [0.0246, 0.0697]], [[0.2004, 0.1734], [0.4896, 0.8338], [0.7236, 0.1206]], [[0.318, 0.6583], [0.3691, 0.9166], [0.5342, 0.9147]], [[0.6762, 0.4139], [0.0711, 0.7431], [0.2008, 0.7587]]]])
print (np.array2string(model.predict([in0Den87504],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim96728.png')

LDen87504 = dense_layer([[[[0.0222, 0.5465], [0.0081, 0.9549], [0.3993, 0.9186]], [[0.7011, 0.1148], [0.9747, 0.635], [0.0246, 0.0697]], [[0.2004, 0.1734], [0.4896, 0.8338], [0.7236, 0.1206]], [[0.318, 0.6583], [0.3691, 0.9166], [0.5342, 0.9147]], [[0.6762, 0.4139], [0.0711, 0.7431], [0.2008, 0.7587]]]], [[0.2535, 0.9355], [0.5046, 0.3408]],[0.7425, 0.4172], Den87504), 
LRes73315 = reshape_layer(Den87504, [5, 6], Res73315), 
LSim96728 = simple_rnn_layer(Res73315,[[1, 8, 5], [9, 7, 9], [5, 10, 1], [3, 2, 1], [10, 8, 7], [6, 3, 9]],[[9, 7, 10], [6, 10, 8], [7, 5, 10]],[6, 1, 8], Sim96728), 
exec_layers([LDen87504,LRes73315,LSim96728],["Den87504","Res73315","Sim96728"],Sim96728,"Sim96728")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0,1.0]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]