import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min43624 = tf.keras.layers.Input(shape=([2, 2]))
in1Min43624 = tf.keras.layers.Input(shape=([2, 2]))
in0Con62229 = tf.keras.layers.Input(shape=([2, 2]))
in0PRe25833 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Min38194 = tf.keras.layers.Input(shape=([2, 1]))
in1Min38194 = tf.keras.layers.Input(shape=([2, 1]))
in0Con99252 = tf.keras.layers.Input(shape=([2, 3]))

Min43624 = keras.layers.Minimum(name = 'Min43624', )([in0Min43624,in1Min43624])
Con62229 = keras.layers.Concatenate(axis=2, name = 'Con62229', )([Min43624,in0Con62229])
PRe25833 = keras.layers.PReLU(name = 'PRe25833', input_shape=(2, 1, 2, 2))(in0PRe25833)
Res18119 = keras.layers.Reshape((2, 1, 4), name = 'Res18119', )(PRe25833)
Res30031 = keras.layers.Reshape((2, 4), name = 'Res30031', )(Res18119)
Min38194 = keras.layers.Minimum(name = 'Min38194', )([in0Min38194,in1Min38194])
Con99252 = keras.layers.Concatenate(axis=2, name = 'Con99252', )([Min38194,in0Con99252])
Add99951 = keras.layers.Add(name = 'Add99951', )([Res30031,Con99252])
Min32420 = keras.layers.Minimum(name = 'Min32420', )([Con62229,Add99951])
model = tf.keras.models.Model(inputs=[in0Min43624,in1Min43624,in0Con62229,in0PRe25833,in0Min38194,in1Min38194,in0Con99252], outputs=Min32420)
w = model.get_layer('PRe25833').get_weights() 
w[0] = np.array([[[[0.0284, 0.5845], [0.9992, 0.3951]]], [[[0.4062, 0.1984], [0.0194, 0.4687]]]])
model.get_layer('PRe25833').set_weights(w) 
in0Min43624 = tf.constant([[[0.1811, 0.2836], [0.9945, 0.6668]]])
in1Min43624 = tf.constant([[[0.7362, 0.9418], [0.0277, 0.897]]])
in0Con62229 = tf.constant([[[0.893, 0.8305], [0.9196, 0.7622]]])
in0PRe25833 = tf.constant([[[[[0.4432, 0.2338], [0.7717, 0.745]]], [[[0.8524, 0.8359], [0.4049, 0.9145]]]]])
in0Min38194 = tf.constant([[[0.0195], [0.1953]]])
in1Min38194 = tf.constant([[[0.2459], [0.2885]]])
in0Con99252 = tf.constant([[[0.6205, 0.3403, 0.2371], [0.4519, 0.162, 0.9245]]])
print (np.array2string(model.predict([in0Min43624,in1Min43624,in0Con62229,in0PRe25833,in0Min38194,in1Min38194,in0Con99252],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min32420.png')

LMin43624 = minimum_layer([[[[0.1811, 0.2836], [0.9945, 0.6668]]], [[[0.7362, 0.9418], [0.0277, 0.897]]]], Min43624), 
LCon62229 = concatenate_layer([Min43624,[[[0.893, 0.8305], [0.9196, 0.7622]]]], 2, Con62229), 
LPRe25833 = prelu_layer([[[[[0.4432, 0.2338], [0.7717, 0.745]]], [[[0.8524, 0.8359], [0.4049, 0.9145]]]]], [[[[0.0284, 0.5845], [0.9992, 0.3951]]], [[[0.4062, 0.1984], [0.0194, 0.4687]]]], PRe25833), 
LRes18119 = reshape_layer(PRe25833, [2, 1, 4], Res18119), 
LRes30031 = reshape_layer(Res18119, [2, 4], Res30031), 
LMin38194 = minimum_layer([[[[0.0195], [0.1953]]], [[[0.2459], [0.2885]]]], Min38194), 
LCon99252 = concatenate_layer([Min38194,[[[0.6205, 0.3403, 0.2371], [0.4519, 0.162, 0.9245]]]], 2, Con99252), 
LAdd99951 = add_layer([Res30031,Con99252], Add99951), 
LMin32420 = minimum_layer([Con62229,Add99951], Min32420), 
exec_layers([LMin43624,LCon62229,LPRe25833,LRes18119,LRes30031,LMin38194,LCon99252,LAdd99951,LMin32420],["Min43624","Con62229","PRe25833","Res18119","Res30031","Min38194","Con99252","Add99951","Min32420"],Min32420,"Min32420")

Actual (Unparsed): [[[0.1811000, 0.2836000, 0.8930000, 0.8305000], [0.0277000, 0.6668000, 0.5669000, 0.7622000]]]

Expected (Unparsed): [[[0.1811,0.2836,0.893,0.8305],[0.0277,0.6668,0.5669,0.7622]]]

Actual:   [[[0.1811, 0.2836, 0.893, 0.8305], [0.0277, 0.6668, 0.5669, 0.7622]]]

Expected: [[[0.1811, 0.2836, 0.893, 0.8305], [0.0277, 0.6668, 0.5669, 0.7622]]]