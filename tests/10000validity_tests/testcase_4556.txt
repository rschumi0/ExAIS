import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe37521 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con41250 = tf.keras.layers.Input(shape=([2, 4]))
in0Mul95359 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Mul95359 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Mul51694 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul51694 = tf.keras.layers.Input(shape=([2, 1]))
in0Cro83485 = tf.keras.layers.Input(shape=([1, 1, 2, 3]))

PRe37521 = keras.layers.PReLU(name = 'PRe37521', input_shape=(2, 1, 2))(in0PRe37521)
Res89144 = keras.layers.Reshape((2, 2), name = 'Res89144', )(PRe37521)
Con41250 = keras.layers.Concatenate(axis=2, name = 'Con41250', )([Res89144,in0Con41250])
Mul95359 = keras.layers.Multiply(name = 'Mul95359', )([in0Mul95359,in1Mul95359])
Res61753 = keras.layers.Reshape((1, 2, 1), name = 'Res61753', )(Mul95359)
Res472 = keras.layers.Reshape((1, 2), name = 'Res472', )(Res61753)
Cro31917 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro31917', )(Res472)
Res19880 = keras.layers.Reshape((1, 2, 1), name = 'Res19880', )(Cro31917)
Mul51694 = keras.layers.Multiply(name = 'Mul51694', )([in0Mul51694,in1Mul51694])
Res64170 = keras.layers.Reshape((2, 1, 1), name = 'Res64170', )(Mul51694)
Cro17594 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro17594', )(Res64170)
Zer57156 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer57156', )(Cro17594)
Min91754 = keras.layers.Minimum(name = 'Min91754', )([Res19880,Zer57156])
Res79906 = keras.layers.Reshape((1, 2), name = 'Res79906', )(Min91754)
Cro83485 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro83485', )(in0Cro83485)
Res60339 = keras.layers.Reshape((1, 1, 6), name = 'Res60339', )(Cro83485)
Res13199 = keras.layers.Reshape((1, 6), name = 'Res13199', )(Res60339)
Dot12213 = keras.layers.Dot(axes=(1, 1), name = 'Dot12213', )([Res79906,Res13199])
Min90025 = keras.layers.Minimum(name = 'Min90025', )([Con41250,Dot12213])
model = tf.keras.models.Model(inputs=[in0PRe37521,in0Con41250,in0Mul95359,in1Mul95359,in0Mul51694,in1Mul51694,in0Cro83485], outputs=Min90025)
w = model.get_layer('PRe37521').get_weights() 
w[0] = np.array([[[0.518, 0.3506]], [[0.0516, 0.4702]]])
model.get_layer('PRe37521').set_weights(w) 
in0PRe37521 = tf.constant([[[[0.5831, 0.3486]], [[0.58, 0.0109]]]])
in0Con41250 = tf.constant([[[0.9026, 0.3952, 0.4581, 0.8842], [0.3273, 0.6356, 0.4965, 0.1869]]])
in0Mul95359 = tf.constant([[[[[0.0835]], [[0.4775]]]]])
in1Mul95359 = tf.constant([[[[[0.8072]], [[0.9112]]]]])
in0Mul51694 = tf.constant([[[0.5904], [0.7061]]])
in1Mul51694 = tf.constant([[[0.2173], [0.0224]]])
in0Cro83485 = tf.constant([[[[[1.7362, 1.9551, 1.2112], [1.0207, 1.9564, 1.0098]]]]])
print (np.array2string(model.predict([in0PRe37521,in0Con41250,in0Mul95359,in1Mul95359,in0Mul51694,in1Mul51694,in0Cro83485],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min90025.png')

LPRe37521 = prelu_layer([[[[0.5831, 0.3486]], [[0.58, 0.0109]]]], [[[0.518, 0.3506]], [[0.0516, 0.4702]]], PRe37521), 
LRes89144 = reshape_layer(PRe37521, [2, 2], Res89144), 
LCon41250 = concatenate_layer([Res89144,[[[0.9026, 0.3952, 0.4581, 0.8842], [0.3273, 0.6356, 0.4965, 0.1869]]]], 2, Con41250), 
LMul95359 = multiply_layer([[[[[[0.0835]], [[0.4775]]]]], [[[[[0.8072]], [[0.9112]]]]]], Mul95359), 
LRes61753 = reshape_layer(Mul95359, [1, 2, 1], Res61753), 
LRes472 = reshape_layer(Res61753, [1, 2], Res472), 
LCro31917 = cropping1D_layer(Res472, 0, 0, Cro31917), 
LRes19880 = reshape_layer(Cro31917, [1, 2, 1], Res19880), 
LMul51694 = multiply_layer([[[[0.5904], [0.7061]]], [[[0.2173], [0.0224]]]], Mul51694), 
LRes64170 = reshape_layer(Mul51694, [2, 1, 1], Res64170), 
LCro17594 = cropping2D_layer(Res64170, 1, 0, 0, 0, Cro17594), 
LZer57156 = zero_padding2D_layer(Cro17594, 0, 0, 1, 0, Zer57156), 
LMin91754 = minimum_layer([Res19880,Zer57156], Min91754), 
LRes79906 = reshape_layer(Min91754, [1, 2], Res79906), 
LCro83485 = cropping3D_layer([[[[[1.7362, 1.9551, 1.2112], [1.0207, 1.9564, 1.0098]]]]], 0, 0, 0, 0, 0, 0, Cro83485), 
LRes60339 = reshape_layer(Cro83485, [1, 1, 6], Res60339), 
LRes13199 = reshape_layer(Res60339, [1, 6], Res13199), 
LDot12213 = dot_layer(Res79906,Res13199, 1, 1, Dot12213), 
LMin90025 = minimum_layer([Con41250,Dot12213], Min90025), 
exec_layers([LPRe37521,LRes89144,LCon41250,LMul95359,LRes61753,LRes472,LCro31917,LRes19880,LMul51694,LRes64170,LCro17594,LZer57156,LMin91754,LRes79906,LCro83485,LRes60339,LRes13199,LDot12213,LMin90025],["PRe37521","Res89144","Con41250","Mul95359","Res61753","Res472","Cro31917","Res19880","Mul51694","Res64170","Cro17594","Zer57156","Min91754","Res79906","Cro83485","Res60339","Res13199","Dot12213","Min90025"],Min90025,"Min90025")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0274608, 0.0109000, 0.0191571, 0.0161440, 0.0309437, 0.0159716]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.0,0.0,0.0],[0.027460850368,0.0109,0.019157114368,0.016144044447999998,0.030943674496,0.015971643072]]]

Actual:   [[[0, 0, 0, 0, 0, 0], [0.0275, 0.0109, 0.0192, 0.0162, 0.031, 0.016]]]

Expected: [[[0, 0, 0, 0, 0, 0], [0.0275, 0.0109, 0.0192, 0.0162, 0.031, 0.016]]]