import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay46988 = tf.keras.layers.Input(shape=([4, 2, 2]))

Lay46988 = keras.layers.LayerNormalization(axis=3, epsilon=2.495849677128061, name = 'Lay46988', )(in0Lay46988)
Res51744 = keras.layers.Reshape((4, 4), name = 'Res51744', )(Lay46988)
Max64698 = keras.layers.MaxPool1D(pool_size=(4), strides=(3), padding='valid', name = 'Max64698', )(Res51744)
Res89278 = keras.layers.Reshape((1, 4, 1), name = 'Res89278', )(Max64698)
Con11494 = keras.layers.Conv2D(3, (1, 3),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con11494', )(Res89278)
model = tf.keras.models.Model(inputs=[in0Lay46988], outputs=Con11494)
w = model.get_layer('Con11494').get_weights() 
w[0] = np.array([[[[0.0833, 0.8611, 0.491]], [[0.4714, 0.0541, 0.6284]], [[0.7122, 0.3902, 0.4842]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con11494').set_weights(w) 
in0Lay46988 = tf.constant([[[[1.571, 1.2631], [1.936, 1.82]], [[1.449, 1.868], [1.3925, 1.6532]], [[1.7184, 1.4851], [1.5588, 1.2188]], [[1.1217, 1.652], [1.6247, 1.9798]]]])
print (np.array2string(model.predict([in0Lay46988],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con11494.png')

LLay46988 = layer_normalization_layer([[[[1.571, 1.2631], [1.936, 1.82]], [[1.449, 1.868], [1.3925, 1.6532]], [[1.7184, 1.4851], [1.5588, 1.2188]], [[1.1217, 1.652], [1.6247, 1.9798]]]], 3, 2.495849677128061, Lay46988), 
LRes51744 = reshape_layer(Lay46988, [4, 4], Res51744), 
LMax64698 = max_pool1D_layer(Res51744, 4, 3, false, Max64698), 
LRes89278 = reshape_layer(Max64698, [1, 4, 1], Res89278), 
LCon11494 = conv2D_layer(Res89278, 1, 3,[[[[0.0833, 0.8611, 0.491]], [[0.4714, 0.0541, 0.6284]], [[0.7122, 0.3902, 0.4842]]]],[0, 0, 0], 1, 1, true, 1, 1, Con11494), 
exec_layers([LLay46988,LRes51744,LMax64698,LRes89278,LCon11494],["Lay46988","Res51744","Max64698","Res89278","Con11494"],Con11494,"Con11494")

Actual (Unparsed): [[[[0.1636034, 0.0698329, 0.1410920], [0.1623029, 0.1342182, 0.2034380], [0.1437629, 0.1918959, 0.2025790], [0.0615594, 0.0981704, 0.1227131]]]]

Expected (Unparsed): [[[[0.16360344562086782,0.06983292405336729,0.14109202694579603],[0.1623028683628316,0.13421819624230402,0.20343799124049725],[0.1437629235557312,0.19189590661575004,0.2025790325040428],[0.061559426592652094,0.09817039629655107,0.12271309083402798]]]]

Actual:   [[[[0.1637, 0.0699, 0.1411], [0.1624, 0.1343, 0.2035], [0.1438, 0.1919, 0.2026], [0.0616, 0.0982, 0.1228]]]]

Expected: [[[[0.1637, 0.0699, 0.1411], [0.1624, 0.1343, 0.2035], [0.1438, 0.1919, 0.2026], [0.0616, 0.0982, 0.1228]]]]