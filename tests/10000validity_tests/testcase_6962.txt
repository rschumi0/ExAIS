import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub88386 = tf.keras.layers.Input(shape=([2]))
in1Sub88386 = tf.keras.layers.Input(shape=([2]))
in0Con43100 = tf.keras.layers.Input(shape=([2, 1]))
in0Max34769 = tf.keras.layers.Input(shape=([1, 2]))
in1Max34769 = tf.keras.layers.Input(shape=([1, 2]))

Sub88386 = keras.layers.Subtract(name = 'Sub88386', )([in0Sub88386,in1Sub88386])
Res69291 = keras.layers.Reshape((2, 1), name = 'Res69291', )(Sub88386)
Con43100 = keras.layers.Concatenate(axis=2, name = 'Con43100', )([Res69291,in0Con43100])
Max34769 = keras.layers.Maximum(name = 'Max34769', )([in0Max34769,in1Max34769])
Dot75394 = keras.layers.Dot(axes=(1, 2), name = 'Dot75394', )([Con43100,Max34769])
Per21099 = keras.layers.Permute((2,1), name = 'Per21099',)(Dot75394)
model = tf.keras.models.Model(inputs=[in0Sub88386,in1Sub88386,in0Con43100,in0Max34769,in1Max34769], outputs=Per21099)
in0Sub88386 = tf.constant([[0.0152, 0.5956]])
in1Sub88386 = tf.constant([[0.3521, 0.0524]])
in0Con43100 = tf.constant([[[0.9065], [0.4021]]])
in0Max34769 = tf.constant([[[0.0581, 0.923]]])
in1Max34769 = tf.constant([[[0.0592, 0.4567]]])
print (np.array2string(model.predict([in0Sub88386,in1Sub88386,in0Con43100,in0Max34769,in1Max34769],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per21099.png')

LSub88386 = subtract_layer([[0.0152, 0.5956]], [[0.3521, 0.0524]], Sub88386), 
LRes69291 = reshape_layer(Sub88386, [2, 1], Res69291), 
LCon43100 = concatenate_layer([Res69291,[[[0.9065], [0.4021]]]], 2, Con43100), 
LMax34769 = maximum_layer([[[[0.0581, 0.923]]], [[[0.0592, 0.4567]]]], Max34769), 
LDot75394 = dot_layer(Con43100,Max34769, 1, 2, Dot75394), 
LPer21099 = permute_layer(Dot75394, 2,1, Per21099), 
exec_layers([LSub88386,LRes69291,LCon43100,LMax34769,LDot75394,LPer21099],["Sub88386","Res69291","Con43100","Max34769","Dot75394","Per21099"],Per21099,"Per21099")

Actual (Unparsed): [[[0.4814291, 0.4248031]]]

Expected (Unparsed): [[[0.4814291200000001,0.42480310000000004]]]

Actual:   [[[0.4815, 0.4249]]]

Expected: [[[0.4815, 0.4249]]]