import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max4205 = tf.keras.layers.Input(shape=([2, 1]))
in1Max4205 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul41074 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul41074 = tf.keras.layers.Input(shape=([2, 1]))

Max4205 = keras.layers.Maximum(name = 'Max4205', )([in0Max4205,in1Max4205])
Mul41074 = keras.layers.Multiply(name = 'Mul41074', )([in0Mul41074,in1Mul41074])
Ave87962 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave87962', )(Mul41074)
Add16825 = keras.layers.Add(name = 'Add16825', )([Max4205,Ave87962])
Mas4209 = keras.layers.Masking(mask_value=1, name = 'Mas4209', )(Add16825)
model = tf.keras.models.Model(inputs=[in0Max4205,in1Max4205,in0Mul41074,in1Mul41074], outputs=Mas4209)
in0Max4205 = tf.constant([[[0.3221], [0.71]]])
in1Max4205 = tf.constant([[[0.1964], [0.6289]]])
in0Mul41074 = tf.constant([[[0.0114], [0.1337]]])
in1Mul41074 = tf.constant([[[0.9215], [0.0533]]])
print (np.array2string(model.predict([in0Max4205,in1Max4205,in0Mul41074,in1Mul41074],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas4209.png')

LMax4205 = maximum_layer([[[[0.3221], [0.71]]], [[[0.1964], [0.6289]]]], Max4205), 
LMul41074 = multiply_layer([[[[0.0114], [0.1337]]], [[[0.9215], [0.0533]]]], Mul41074), 
LAve87962 = average_pooling1D_layer(Mul41074, 1, Ave87962), 
LAdd16825 = add_layer([Max4205,Ave87962], Add16825), 
LMas4209 = masking_layer(Add16825, 1, Mas4209), 
exec_layers([LMax4205,LMul41074,LAve87962,LAdd16825,LMas4209],["Max4205","Mul41074","Ave87962","Add16825","Mas4209"],Mas4209,"Mas4209")

Actual (Unparsed): [[[0.3326051], [0.7171262]]]

Expected (Unparsed): [[[0.3326051],[0.71712621]]]

Actual:   [[[0.3327], [0.7172]]]

Expected: [[[0.3327], [0.7172]]]