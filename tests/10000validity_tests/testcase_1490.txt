import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer840 = tf.keras.layers.Input(shape=([4, 1]))

Zer840 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer840', )(in0Zer840)
Loc62137 = keras.layers.LocallyConnected1D(2, (6),strides=(1), name = 'Loc62137', )(Zer840)
Res11919 = keras.layers.Reshape((1, 2, 1), name = 'Res11919', )(Loc62137)
Con18828 = keras.layers.Conv2D(3, (1, 1),strides=(1, 8), padding='valid', dilation_rate=(1, 1), name = 'Con18828', )(Res11919)
Max25598 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='valid', name = 'Max25598', )(Con18828)
model = tf.keras.models.Model(inputs=[in0Zer840], outputs=Max25598)
w = model.get_layer('Loc62137').get_weights() 
w[0] = np.array([[[0.8166, 0.1516], [0.1349, 0.2081], [0.8802, 0.6116], [0.8375, 0.8244], [0.7931, 0.113], [0.4834, 0.5066]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc62137').set_weights(w) 
w = model.get_layer('Con18828').get_weights() 
w[0] = np.array([[[[0.5986, 0.2329, 0.4932]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con18828').set_weights(w) 
in0Zer840 = tf.constant([[[1.7828], [1.9459], [1.521], [1.7193]]])
print (np.array2string(model.predict([in0Zer840],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max25598.png')

LZer840 = zero_padding1D_layer([[[1.7828], [1.9459], [1.521], [1.7193]]], 1, 1, Zer840), 
LLoc62137 = locally_connected1D_layer(Zer840, 6,[[[0.8166, 0.1516], [0.1349, 0.2081], [0.8802, 0.6116], [0.8375, 0.8244], [0.7931, 0.113], [0.4834, 0.5066]]],[[0, 0]], 1, Loc62137), 
LRes11919 = reshape_layer(Loc62137, [1, 2, 1], Res11919), 
LCon18828 = conv2D_layer(Res11919, 1, 1,[[[[0.5986, 0.2329, 0.4932]]]],[0, 0, 0], 1, 8, false, 1, 1, Con18828), 
LMax25598 = max_pool2D_layer(Con18828, 1, 1, 1, 1, false, Max25598), 
exec_layers([LZer840,LLoc62137,LRes11919,LCon18828,LMax25598],["Zer840","Loc62137","Res11919","Con18828","Max25598"],Max25598,"Max25598")

Actual (Unparsed): [[[[2.7479902, 1.0691729, 2.2641309]]]]

Expected (Unparsed): [[[[2.747990164678,1.0691729190669998,2.264130887436]]]]

Actual:   [[[[2.748, 1.0692, 2.2642]]]]

Expected: [[[[2.748, 1.0692, 2.2642]]]]