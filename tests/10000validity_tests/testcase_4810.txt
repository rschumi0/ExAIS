import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave62258 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave62258 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con44223 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Dot67452 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot67452 = tf.keras.layers.Input(shape=([3, 3]))

Ave62258 = keras.layers.Average(name = 'Ave62258', )([in0Ave62258,in1Ave62258])
Res86957 = keras.layers.Reshape((1, 1, 2), name = 'Res86957', )(Ave62258)
Zer69044 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer69044', )(Res86957)
Con44223 = keras.layers.Concatenate(axis=3, name = 'Con44223', )([Zer69044,in0Con44223])
Dot67452 = keras.layers.Dot(axes=(1, 2), name = 'Dot67452', )([in0Dot67452,in1Dot67452])
Bat58847 = keras.layers.BatchNormalization(axis=1, epsilon=0.9399426548763895,  name = 'Bat58847', )(Dot67452)
Res26878 = keras.layers.Reshape((3, 3, 1), name = 'Res26878', )(Bat58847)
Loc52980 = keras.layers.LocallyConnected2D(3, (3, 2),strides=(1, 1), name = 'Loc52980', )(Res26878)
Ave96545 = keras.layers.Average(name = 'Ave96545', )([Con44223,Loc52980])
Res40771 = keras.layers.Reshape((1, 6), name = 'Res40771', )(Ave96545)
Zer15127 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer15127', )(Res40771)
model = tf.keras.models.Model(inputs=[in0Ave62258,in1Ave62258,in0Con44223,in0Dot67452,in1Dot67452], outputs=Zer15127)
w = model.get_layer('Bat58847').get_weights() 
w[0] = np.array([0.645, 0.7099, 0.623])
w[1] = np.array([0.4252, 0.1872, 0.2082])
w[2] = np.array([0.2083, 0.56, 0.4112])
w[3] = np.array([0.662, 0.4721, 0.7276])
model.get_layer('Bat58847').set_weights(w) 
w = model.get_layer('Loc52980').get_weights() 
w[0] = np.array([[[0.3192, 0.6864, 0.91], [0.4819, 0.0452, 0.9291], [0.5564, 0.3761, 0.885], [0.1826, 0.3532, 0.9891], [0.0879, 0.3814, 0.0896], [0.7657, 0.7435, 0.1903]], [[0.3914, 0.1593, 0.6705], [0.8514, 0.3286, 0.7739], [0.4383, 0.6983, 0.0333], [0.7175, 0.5, 0.6588], [0.7884, 0.646, 0.0137], [0.8313, 0.0405, 0.7598]]])
w[1] = np.array([[[0, 0, 0], [0, 0, 0]]])
model.get_layer('Loc52980').set_weights(w) 
in0Ave62258 = tf.constant([[[[[0.5791], [0.0671]]]]])
in1Ave62258 = tf.constant([[[[[0.4321], [0.7598]]]]])
in0Con44223 = tf.constant([[[[0.0148], [0.3406]]]])
in0Dot67452 = tf.constant([[[0.3039, 0.8297, 0.1882], [0.8661, 0.6714, 0.1312], [0.5257, 0.4534, 0.8832]]])
in1Dot67452 = tf.constant([[[0.7907, 0.0474, 0.9367], [0.4766, 0.9438, 0.8401], [0.417, 0.3452, 0.7876]]])
print (np.array2string(model.predict([in0Ave62258,in1Ave62258,in0Con44223,in0Dot67452,in1Dot67452],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer15127.png')

LAve62258 = average_layer([[[[[[0.5791], [0.0671]]]]], [[[[[0.4321], [0.7598]]]]]], Ave62258), 
LRes86957 = reshape_layer(Ave62258, [1, 1, 2], Res86957), 
LZer69044 = zero_padding2D_layer(Res86957, 0, 0, 1, 0, Zer69044), 
LCon44223 = concatenate_layer([Zer69044,[[[[0.0148], [0.3406]]]]], 3, Con44223), 
LDot67452 = dot_layer([[[0.3039, 0.8297, 0.1882], [0.8661, 0.6714, 0.1312], [0.5257, 0.4534, 0.8832]]], [[[0.7907, 0.0474, 0.9367], [0.4766, 0.9438, 0.8401], [0.417, 0.3452, 0.7876]]], 1, 2, Dot67452), 
LBat58847 = batch_normalization_layer(Dot67452, 1, 0.9399426548763895, [0.645, 0.7099, 0.623], [0.4252, 0.1872, 0.2082], [0.2083, 0.56, 0.4112], [0.662, 0.4721, 0.7276], Bat58847), 
LRes26878 = reshape_layer(Bat58847, [3, 3, 1], Res26878), 
LLoc52980 = locally_connected2D_layer(Res26878, 3, 2,[[[0.3192, 0.6864, 0.91], [0.4819, 0.0452, 0.9291], [0.5564, 0.3761, 0.885], [0.1826, 0.3532, 0.9891], [0.0879, 0.3814, 0.0896], [0.7657, 0.7435, 0.1903]], [[0.3914, 0.1593, 0.6705], [0.8514, 0.3286, 0.7739], [0.4383, 0.6983, 0.0333], [0.7175, 0.5, 0.6588], [0.7884, 0.646, 0.0137], [0.8313, 0.0405, 0.7598]]],[[[0, 0, 0], [0, 0, 0]]], 1, 1, Loc52980), 
LAve96545 = average_layer([Con44223,Loc52980], Ave96545), 
LRes40771 = reshape_layer(Ave96545, [1, 6], Res40771), 
LZer15127 = zero_padding1D_layer(Res40771, 1, 1, Zer15127), 
exec_layers([LAve62258,LRes86957,LZer69044,LCon44223,LDot67452,LBat58847,LRes26878,LLoc52980,LAve96545,LRes40771,LZer15127],["Ave62258","Res86957","Zer69044","Con44223","Dot67452","Bat58847","Res26878","Loc52980","Ave96545","Res40771","Zer15127"],Zer15127,"Zer15127")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.7719874, 0.7554915, 1.4516450, 1.4270264, 0.9175679, 1.1102930], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0,0,0],[0.7719873769140114,0.7554915144274977,1.451644984219878,1.4270264278533915,0.9175678659841587,1.1102930463096543],[0,0,0,0,0,0]]]

Actual:   [[[0, 0, 0, 0, 0, 0], [0.772, 0.7555, 1.4517, 1.4271, 0.9176, 1.1103], [0, 0, 0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0, 0, 0], [0.772, 0.7555, 1.4517, 1.4271, 0.9176, 1.1103], [0, 0, 0, 0, 0, 0]]]