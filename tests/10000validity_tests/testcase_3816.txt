import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL55712 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Ave98296 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave98296 = tf.keras.layers.Input(shape=([1, 1]))

ReL55712 = keras.layers.ReLU(max_value=9.115565047427037, negative_slope=2.186345034459579, threshold=3.7936642894022587, name = 'ReL55712', input_shape=(1, 1, 1, 2))(in0ReL55712)
Res42517 = keras.layers.Reshape((1, 1, 2), name = 'Res42517', )(ReL55712)
Res14466 = keras.layers.Reshape((1, 2), name = 'Res14466', )(Res42517)
Ave98296 = keras.layers.Average(name = 'Ave98296', )([in0Ave98296,in1Ave98296])
Dot41171 = keras.layers.Dot(axes=(1, 1), name = 'Dot41171', )([Res14466,Ave98296])
Res64139 = keras.layers.Reshape((2, 1, 1), name = 'Res64139', )(Dot41171)
Loc55277 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc55277', )(Res64139)
model = tf.keras.models.Model(inputs=[in0ReL55712,in0Ave98296,in1Ave98296], outputs=Loc55277)
w = model.get_layer('Loc55277').get_weights() 
w[0] = np.array([[[0.4411, 0.2824, 0.2594, 0.2078]], [[0.5786, 0.6408, 0.4576, 0.6188]]])
w[1] = np.array([[[0, 0, 0, 0]], [[0, 0, 0, 0]]])
model.get_layer('Loc55277').set_weights(w) 
in0ReL55712 = tf.constant([[[[[0.5595, 0.347]]]]])
in0Ave98296 = tf.constant([[[0.4568]]])
in1Ave98296 = tf.constant([[[0.4879]]])
print (np.array2string(model.predict([in0ReL55712,in0Ave98296,in1Ave98296],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc55277.png')

LReL55712 = relu_layer([[[[[0.5595, 0.347]]]]], 9.115565047427037, 2.186345034459579, 3.7936642894022587, ReL55712), 
LRes42517 = reshape_layer(ReL55712, [1, 1, 2], Res42517), 
LRes14466 = reshape_layer(Res42517, [1, 2], Res14466), 
LAve98296 = average_layer([[[[0.4568]]], [[[0.4879]]]], Ave98296), 
LDot41171 = dot_layer(Res14466,Ave98296, 1, 1, Dot41171), 
LRes64139 = reshape_layer(Dot41171, [2, 1, 1], Res64139), 
LLoc55277 = locally_connected2D_layer(Res64139, 1, 1,[[[0.4411, 0.2824, 0.2594, 0.2078]], [[0.5786, 0.6408, 0.4576, 0.6188]]],[[[0, 0, 0, 0]], [[0, 0, 0, 0]]], 1, 1, Loc55277), 
exec_layers([LReL55712,LRes42517,LRes14466,LAve98296,LDot41171,LRes64139,LLoc55277],["ReL55712","Res42517","Res14466","Ave98296","Dot41171","Res64139","Loc55277"],Loc55277,"Loc55277")

Actual (Unparsed): [[[[-1.4732680, -0.9432122, -0.8663925, -0.6940492]], [[-2.0594916, -2.2808888, -1.6287995, -2.2025811]]]]

Expected (Unparsed): [[[[-1.4732679984240193,-0.943212157685203,-0.8663924706216065,-0.6940491726876247]],[[-2.059491642879224,-2.280888774208446,-1.6287994742162684,-2.2025811071788177]]]]

Actual:   [[[[-1.4732, -0.9432, -0.8663, -0.694]], [[-2.0594, -2.2808, -1.6287, -2.2025]]]]

Expected: [[[[-1.4732, -0.9432, -0.8663, -0.694]], [[-2.0594, -2.2808, -1.6287, -2.2025]]]]