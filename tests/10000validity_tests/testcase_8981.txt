import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof13855 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min50159 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min50159 = tf.keras.layers.Input(shape=([2, 1, 1]))

Sof13855 = keras.layers.Softmax(axis=1, name = 'Sof13855', input_shape=(2, 2, 2))(in0Sof13855)
Res55633 = keras.layers.Reshape((2, 4), name = 'Res55633', )(Sof13855)
Glo18897 = keras.layers.GlobalMaxPool1D(name = 'Glo18897', )(Res55633)
Res69331 = keras.layers.Reshape((4, 1), name = 'Res69331', )(Glo18897)
Res26768 = keras.layers.Reshape((4, 1, 1), name = 'Res26768', )(Res69331)
Min50159 = keras.layers.Minimum(name = 'Min50159', )([in0Min50159,in1Min50159])
Zer87634 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer87634', )(Min50159)
Ave7516 = keras.layers.Average(name = 'Ave7516', )([Res26768,Zer87634])
model = tf.keras.models.Model(inputs=[in0Sof13855,in0Min50159,in1Min50159], outputs=Ave7516)
in0Sof13855 = tf.constant([[[[0.3498, 0.0794], [0.6875, 0.105]], [[0.4913, 0.5385], [0.0713, 0.9364]]]])
in0Min50159 = tf.constant([[[[0.8234]], [[0.3486]]]])
in1Min50159 = tf.constant([[[[0.9649]], [[0.455]]]])
print (np.array2string(model.predict([in0Sof13855,in0Min50159,in1Min50159],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave7516.png')

LSof13855 = softmax_layer([[[[0.3498, 0.0794], [0.6875, 0.105]], [[0.4913, 0.5385], [0.0713, 0.9364]]]], 1, Sof13855), 
LRes55633 = reshape_layer(Sof13855, [2, 4], Res55633), 
LGlo18897 = global_max_pool1D_layer(Res55633, Glo18897), 
LRes69331 = reshape_layer(Glo18897, [4, 1], Res69331), 
LRes26768 = reshape_layer(Res69331, [4, 1, 1], Res26768), 
LMin50159 = minimum_layer([[[[[0.8234]], [[0.3486]]]], [[[[0.9649]], [[0.455]]]]], Min50159), 
LZer87634 = zero_padding2D_layer(Min50159, 2, 0, 0, 0, Zer87634), 
LAve7516 = average_layer([Res26768,Zer87634], Ave7516), 
exec_layers([LSof13855,LRes55633,LGlo18897,LRes69331,LRes26768,LMin50159,LZer87634,LAve7516],["Sof13855","Res55633","Glo18897","Res69331","Res26768","Min50159","Zer87634","Ave7516"],Ave7516,"Ave7516")

Actual (Unparsed): [[[[0.2676580]], [[0.3064003]], [[0.7363769]], [[0.5226254]]]]

Expected (Unparsed): [[[[0.26765804700787227]],[[0.30640032470948214]],[[0.7363769026597329]],[[0.5226254355301578]]]]

Actual:   [[[[0.2677]], [[0.3065]], [[0.7364]], [[0.5227]]]]

Expected: [[[[0.2677]], [[0.3065]], [[0.7364]], [[0.5227]]]]