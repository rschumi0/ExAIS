import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot2260 = tf.keras.layers.Input(shape=([3]))
in1Dot2260 = tf.keras.layers.Input(shape=([3]))

Dot2260 = keras.layers.Dot(axes=(1, 1), name = 'Dot2260', )([in0Dot2260,in1Dot2260])
Res32322 = keras.layers.Reshape((1, 1), name = 'Res32322', )(Dot2260)
GRU20539 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU20539', )(Res32322)
model = tf.keras.models.Model(inputs=[in0Dot2260,in1Dot2260], outputs=GRU20539)
w = model.get_layer('GRU20539').get_weights() 
w[0] = np.array([[3, 8, 7, 9, 10, 8]])
w[1] = np.array([[3, 4, 9, 8, 4, 10], [7, 2, 8, 9, 4, 9]])
w[2] = np.array([3, 9, 9, 9, 4, 9])
model.get_layer('GRU20539').set_weights(w) 
in0Dot2260 = tf.constant([[0.5382, 0.4101, 0.1213]])
in1Dot2260 = tf.constant([[0.6787, 0.7568, 0.5607]])
print (np.array2string(model.predict([in0Dot2260,in1Dot2260],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU20539.png')

LDot2260 = dot_layer([[0.5382, 0.4101, 0.1213]], [[0.6787, 0.7568, 0.5607]], 1, 1, Dot2260), 
LRes32322 = reshape_layer(Dot2260, [1, 1], Res32322), 
LGRU20539 = gru_layer(Res32322,[[3, 8, 7, 9, 10, 8]],[[3, 4, 9, 8, 4, 10], [7, 2, 8, 9, 4, 9]],[3, 9, 9, 9, 4, 9], false, GRU20539), 
exec_layers([LDot2260,LRes32322,LGRU20539],["Dot2260","Res32322","GRU20539"],GRU20539,"GRU20539")

Actual (Unparsed): [[0.0053199, 0.0000003]]

Expected (Unparsed): [[0.005319941705937676,3.2183599218964517e-7]]

Actual:   [[0.0054, 0]]

Expected: [[0.0054, 0]]