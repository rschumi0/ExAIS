import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max38668 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Max38668 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Max38668 = keras.layers.Maximum(name = 'Max38668', )([in0Max38668,in1Max38668])
Res91212 = keras.layers.Reshape((2, 2, 2), name = 'Res91212', )(Max38668)
Res1010 = keras.layers.Reshape((2, 4), name = 'Res1010', )(Res91212)
Cro18685 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro18685', )(Res1010)
Res24722 = keras.layers.Reshape((1, 4, 1), name = 'Res24722', )(Cro18685)
Max93455 = keras.layers.MaxPool2D(pool_size=(1, 4), strides=(1, 1), padding='same', name = 'Max93455', )(Res24722)
Zer90816 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer90816', )(Max93455)
Ave83396 = keras.layers.AveragePooling2D(pool_size=(2, 2), name = 'Ave83396', )(Zer90816)
model = tf.keras.models.Model(inputs=[in0Max38668,in1Max38668], outputs=Ave83396)
in0Max38668 = tf.constant([[[[[0.7615], [0.3338]], [[0.0847], [0.4723]]], [[[0.9369], [0.4949]], [[0.3275], [0.6558]]]]])
in1Max38668 = tf.constant([[[[[0.1284], [0.0959]], [[0.6755], [0.2025]]], [[[0.2908], [0.0833]], [[0.1562], [0.3248]]]]])
print (np.array2string(model.predict([in0Max38668,in1Max38668],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave83396.png')

LMax38668 = maximum_layer([[[[[[0.7615], [0.3338]], [[0.0847], [0.4723]]], [[[0.9369], [0.4949]], [[0.3275], [0.6558]]]]], [[[[[0.1284], [0.0959]], [[0.6755], [0.2025]]], [[[0.2908], [0.0833]], [[0.1562], [0.3248]]]]]], Max38668), 
LRes91212 = reshape_layer(Max38668, [2, 2, 2], Res91212), 
LRes1010 = reshape_layer(Res91212, [2, 4], Res1010), 
LCro18685 = cropping1D_layer(Res1010, 1, 0, Cro18685), 
LRes24722 = reshape_layer(Cro18685, [1, 4, 1], Res24722), 
LMax93455 = max_pool2D_layer(Res24722, 1, 4, 1, 1, true, Max93455), 
LZer90816 = zero_padding2D_layer(Max93455, 1, 1, 1, 1, Zer90816), 
LAve83396 = average_pooling2D_layer(Zer90816, 2, 2, Ave83396), 
exec_layers([LMax38668,LRes91212,LRes1010,LCro18685,LRes24722,LMax93455,LZer90816,LAve83396],["Max38668","Res91212","Res1010","Cro18685","Res24722","Max93455","Zer90816","Ave83396"],Ave83396,"Ave83396")

Actual (Unparsed): [[[[0.2342250], [0.3981750], [0.1639500]]]]

Expected (Unparsed): [[[[0.234225],[0.398175],[0.16395]]]]

Actual:   [[[[0.2343], [0.3982], [0.164]]]]

Expected: [[[[0.2343], [0.3982], [0.164]]]]