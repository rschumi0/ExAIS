import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep19726 = tf.keras.layers.Input(shape=([2, 2, 1]))

Sep19726 = keras.layers.SeparableConv2D(2, (1, 1),strides=(2, 2), padding='valid', name = 'Sep19726', )(in0Sep19726)
Res53333 = keras.layers.Reshape((1, 2), name = 'Res53333', )(Sep19726)
LST58782 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST58782', )(Res53333)
model = tf.keras.models.Model(inputs=[in0Sep19726], outputs=LST58782)
w = model.get_layer('Sep19726').get_weights() 
w[0] = np.array([[[[0.3378]]]])
w[1] = np.array([[[[0.9276, 0.4345]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep19726').set_weights(w) 
w = model.get_layer('LST58782').get_weights() 
w[0] = np.array([[10, 4, 2, 2, 8, 1, 2, 7, 9, 6, 7, 9], [3, 9, 3, 3, 6, 3, 4, 3, 9, 10, 8, 3]])
w[1] = np.array([[4, 6, 9, 6, 4, 3, 6, 10, 8, 6, 10, 9], [6, 8, 7, 4, 2, 8, 6, 1, 8, 7, 10, 8], [4, 10, 7, 4, 1, 4, 2, 7, 1, 9, 8, 2]])
w[2] = np.array([4, 2, 5, 8, 4, 8, 10, 2, 3, 3, 9, 3])
model.get_layer('LST58782').set_weights(w) 
in0Sep19726 = tf.constant([[[[0.0504], [0.387]], [[0.2142], [0.8547]]]])
print (np.array2string(model.predict([in0Sep19726],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST58782.png')

LSep19726 = separable_conv2D_layer([[[[0.0504], [0.387]], [[0.2142], [0.8547]]]], 1, 1,[[[[[0.3378]]]],[[[[0.9276, 0.4345]]]]],[0, 0], 2, 2, false, Sep19726), 
LRes53333 = reshape_layer(Sep19726, [1, 2], Res53333), 
LLST58782 = lstm_layer(Res53333,[[10, 4, 2, 2, 8, 1, 2, 7, 9, 6, 7, 9], [3, 9, 3, 3, 6, 3, 4, 3, 9, 10, 8, 3]],[[4, 6, 9, 6, 4, 3, 6, 10, 8, 6, 10, 9], [6, 8, 7, 4, 2, 8, 6, 1, 8, 7, 10, 8], [4, 10, 7, 4, 1, 4, 2, 7, 1, 9, 8, 2]],[4, 2, 5, 8, 4, 8, 10, 2, 3, 3, 9, 3], LST58782), 
exec_layers([LSep19726,LRes53333,LLST58782],["Sep19726","Res53333","LST58782"],LST58782,"LST58782")

Actual (Unparsed): [[0.7247144, 0.7007941, 0.7268360]]

Expected (Unparsed): [[0.7247144362141533,0.700794098071342,0.7268360062121858]]

Actual:   [[0.7248, 0.7008, 0.7269]]

Expected: [[0.7248, 0.7008, 0.7269]]