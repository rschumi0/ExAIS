import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave35787 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Ave35787 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Con21772 = tf.keras.layers.Input(shape=([1, 2]))
in0Dot67402 = tf.keras.layers.Input(shape=([2]))
in1Dot67402 = tf.keras.layers.Input(shape=([2]))
in0Max17993 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max17993 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con52266 = tf.keras.layers.Input(shape=([1, 1]))

Ave35787 = keras.layers.Average(name = 'Ave35787', )([in0Ave35787,in1Ave35787])
Res52101 = keras.layers.Reshape((2, 2, 2), name = 'Res52101', )(Ave35787)
Res8417 = keras.layers.Reshape((2, 4), name = 'Res8417', )(Res52101)
Per87243 = keras.layers.Permute((1,2), name = 'Per87243',)(Res8417)
Res60113 = keras.layers.Reshape((2, 4, 1), name = 'Res60113', )(Per87243)
Res54766 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res54766', )(Res60113)
Glo72958 = keras.layers.GlobalMaxPool3D(name = 'Glo72958', )(Res54766)
Res70321 = keras.layers.Reshape((1, 1), name = 'Res70321', )(Glo72958)
Con21772 = keras.layers.Concatenate(axis=2, name = 'Con21772', )([Res70321,in0Con21772])
Dot67402 = keras.layers.Dot(axes=(1, 1), name = 'Dot67402', )([in0Dot67402,in1Dot67402])
Res97706 = keras.layers.Reshape((1, 1), name = 'Res97706', )(Dot67402)
Res10891 = keras.layers.Reshape((1, 1, 1), name = 'Res10891', )(Res97706)
Loc3638 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 6), name = 'Loc3638', )(Res10891)
Lay65684 = keras.layers.LayerNormalization(axis=2, epsilon=2.2308538975727523, name = 'Lay65684', )(Loc3638)
Res22332 = keras.layers.Reshape((1, 3), name = 'Res22332', )(Lay65684)
Max17993 = keras.layers.Maximum(name = 'Max17993', )([in0Max17993,in1Max17993])
Res94099 = keras.layers.Reshape((1, 2), name = 'Res94099', )(Max17993)
Loc97956 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc97956', )(Res94099)
Con52266 = keras.layers.Concatenate(axis=2, name = 'Con52266', )([Loc97956,in0Con52266])
Mul11562 = keras.layers.Multiply(name = 'Mul11562', )([Res22332,Con52266])
Min97189 = keras.layers.Minimum(name = 'Min97189', )([Con21772,Mul11562])
model = tf.keras.models.Model(inputs=[in0Ave35787,in1Ave35787,in0Con21772,in0Dot67402,in1Dot67402,in0Max17993,in1Max17993,in0Con52266], outputs=Min97189)
w = model.get_layer('Loc3638').get_weights() 
w[0] = np.array([[[0.1012, 0.4462, 0.0293]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc3638').set_weights(w) 
w = model.get_layer('Loc97956').get_weights() 
w[0] = np.array([[[0.2248, 0.0087], [0.9344, 0.645]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc97956').set_weights(w) 
in0Ave35787 = tf.constant([[[[[0.6262, 0.8571]], [[0.2178, 0.8592]]], [[[0.6287, 0.8182]], [[0.6255, 0.3637]]]]])
in1Ave35787 = tf.constant([[[[[0.6477, 0.7485]], [[0.9238, 0.2866]]], [[[0.6122, 0.006]], [[0.943, 0.3138]]]]])
in0Con21772 = tf.constant([[[0.062, 0.1395]]])
in0Dot67402 = tf.constant([[0.038, 0.9126]])
in1Dot67402 = tf.constant([[0.904, 0.6882]])
in0Max17993 = tf.constant([[[[0.4791, 0.6452]]]])
in1Max17993 = tf.constant([[[[0.3212, 0.892]]]])
in0Con52266 = tf.constant([[[0.3736]]])
print (np.array2string(model.predict([in0Ave35787,in1Ave35787,in0Con21772,in0Dot67402,in1Dot67402,in0Max17993,in1Max17993,in0Con52266],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min97189.png')

LAve35787 = average_layer([[[[[[0.6262, 0.8571]], [[0.2178, 0.8592]]], [[[0.6287, 0.8182]], [[0.6255, 0.3637]]]]], [[[[[0.6477, 0.7485]], [[0.9238, 0.2866]]], [[[0.6122, 0.006]], [[0.943, 0.3138]]]]]], Ave35787), 
LRes52101 = reshape_layer(Ave35787, [2, 2, 2], Res52101), 
LRes8417 = reshape_layer(Res52101, [2, 4], Res8417), 
LPer87243 = permute_layer(Res8417, 1,2, Per87243), 
LRes60113 = reshape_layer(Per87243, [2, 4, 1], Res60113), 
LRes54766 = reshape_layer(Res60113, [2, 4, 1, 1], Res54766), 
LGlo72958 = global_max_pool3D_layer(Res54766, Glo72958), 
LRes70321 = reshape_layer(Glo72958, [1, 1], Res70321), 
LCon21772 = concatenate_layer([Res70321,[[[0.062, 0.1395]]]], 2, Con21772), 
LDot67402 = dot_layer([[0.038, 0.9126]], [[0.904, 0.6882]], 1, 1, Dot67402), 
LRes97706 = reshape_layer(Dot67402, [1, 1], Res97706), 
LRes10891 = reshape_layer(Res97706, [1, 1, 1], Res10891), 
LLoc3638 = locally_connected2D_layer(Res10891, 1, 1,[[[0.1012, 0.4462, 0.0293]]],[[[0, 0, 0]]], 1, 6, Loc3638), 
LLay65684 = layer_normalization_layer(Loc3638, 2, 2.2308538975727523, Lay65684), 
LRes22332 = reshape_layer(Lay65684, [1, 3], Res22332), 
LMax17993 = maximum_layer([[[[[0.4791, 0.6452]]]], [[[[0.3212, 0.892]]]]], Max17993), 
LRes94099 = reshape_layer(Max17993, [1, 2], Res94099), 
LLoc97956 = locally_connected1D_layer(Res94099, 1,[[[0.2248, 0.0087], [0.9344, 0.645]]],[[0, 0]], 1, Loc97956), 
LCon52266 = concatenate_layer([Loc97956,[[[0.3736]]]], 2, Con52266), 
LMul11562 = multiply_layer([Res22332,Con52266], Mul11562), 
LMin97189 = minimum_layer([Con21772,Mul11562], Min97189), 
exec_layers([LAve35787,LRes52101,LRes8417,LPer87243,LRes60113,LRes54766,LGlo72958,LRes70321,LCon21772,LDot67402,LRes97706,LRes10891,LLoc3638,LLay65684,LRes22332,LMax17993,LRes94099,LLoc97956,LCon52266,LMul11562,LMin97189],["Ave35787","Res52101","Res8417","Per87243","Res60113","Res54766","Glo72958","Res70321","Con21772","Dot67402","Res97706","Res10891","Loc3638","Lay65684","Res22332","Max17993","Res94099","Loc97956","Con52266","Mul11562","Min97189"],Min97189,"Min97189")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0,0.0]]]

Actual:   [[[0, 0, 0]]]

Expected: [[[0, 0, 0]]]