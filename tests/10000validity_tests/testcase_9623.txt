import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min6915 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Min6915 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Min3704 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min3704 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Min52509 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min52509 = tf.keras.layers.Input(shape=([1, 2, 1]))

Min6915 = keras.layers.Minimum(name = 'Min6915', )([in0Min6915,in1Min6915])
Res42434 = keras.layers.Reshape((2, 2), name = 'Res42434', )(Min6915)
Min3704 = keras.layers.Minimum(name = 'Min3704', )([in0Min3704,in1Min3704])
Min52509 = keras.layers.Minimum(name = 'Min52509', )([in0Min52509,in1Min52509])
Zer77700 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer77700', )(Min52509)
Ave35552 = keras.layers.Average(name = 'Ave35552', )([Min3704,Zer77700])
Res17762 = keras.layers.Reshape((2, 2), name = 'Res17762', )(Ave35552)
Dot3182 = keras.layers.Dot(axes=(2, 1), name = 'Dot3182', )([Res42434,Res17762])
model = tf.keras.models.Model(inputs=[in0Min6915,in1Min6915,in0Min3704,in1Min3704,in0Min52509,in1Min52509], outputs=Dot3182)
in0Min6915 = tf.constant([[[[0.9407, 0.7156]], [[0.6397, 0.1094]]]])
in1Min6915 = tf.constant([[[[0.297, 0.9319]], [[0.6795, 0.3808]]]])
in0Min3704 = tf.constant([[[[0.6772], [0.4063]], [[0.1477], [0.5243]]]])
in1Min3704 = tf.constant([[[[0.3882], [0.2584]], [[0.375], [0.867]]]])
in0Min52509 = tf.constant([[[[0.5422], [0.3234]]]])
in1Min52509 = tf.constant([[[[0.8423], [0.5724]]]])
print (np.array2string(model.predict([in0Min6915,in1Min6915,in0Min3704,in1Min3704,in0Min52509,in1Min52509],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot3182.png')

LMin6915 = minimum_layer([[[[[0.9407, 0.7156]], [[0.6397, 0.1094]]]], [[[[0.297, 0.9319]], [[0.6795, 0.3808]]]]], Min6915), 
LRes42434 = reshape_layer(Min6915, [2, 2], Res42434), 
LMin3704 = minimum_layer([[[[[0.6772], [0.4063]], [[0.1477], [0.5243]]]], [[[[0.3882], [0.2584]], [[0.375], [0.867]]]]], Min3704), 
LMin52509 = minimum_layer([[[[[0.5422], [0.3234]]]], [[[[0.8423], [0.5724]]]]], Min52509), 
LZer77700 = zero_padding2D_layer(Min52509, 1, 0, 0, 0, Zer77700), 
LAve35552 = average_layer([Min3704,Zer77700], Ave35552), 
LRes17762 = reshape_layer(Ave35552, [2, 2], Res17762), 
LDot3182 = dot_layer(Res42434,Res17762, 2, 1, Dot3182), 
exec_layers([LMin6915,LRes42434,LMin3704,LMin52509,LZer77700,LAve35552,LRes17762,LDot3182],["Min6915","Res42434","Min3704","Min52509","Zer77700","Ave35552","Res17762","Dot3182"],Dot3182,"Dot3182")

Actual (Unparsed): [[[0.3044939, 0.3416795], [0.1619033, 0.1290184]]]

Expected (Unparsed): [[[0.30449392,0.34167946000000005],[0.1619033,0.12901843000000002]]]

Actual:   [[[0.3045, 0.3417], [0.162, 0.1291]]]

Expected: [[[0.3045, 0.3417], [0.162, 0.1291]]]