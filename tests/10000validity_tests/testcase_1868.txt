import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU82793 = tf.keras.layers.Input(shape=([2, 2]))
in0Con12876 = tf.keras.layers.Input(shape=([3]))
in0Max89346 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sim20945 = tf.keras.layers.Input(shape=([3, 1]))
in0Con80482 = tf.keras.layers.Input(shape=([1]))
in0Max50801 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max50801 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con38912 = tf.keras.layers.Input(shape=([1]))
in0Sep37724 = tf.keras.layers.Input(shape=([1, 1]))
in0Con10635 = tf.keras.layers.Input(shape=([1]))

GRU82793 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU82793', )(in0GRU82793)
Lea53207 = keras.layers.LeakyReLU(alpha=6.071381847943638, name = 'Lea53207', )(GRU82793)
Con12876 = keras.layers.Concatenate(axis=1, name = 'Con12876', )([Lea53207,in0Con12876])
Max89346 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(1, 2), padding='same', name = 'Max89346', )(in0Max89346)
Res32476 = keras.layers.Reshape((2, 2), name = 'Res32476', )(Max89346)
Fla70272 = keras.layers.Flatten(name = 'Fla70272', )(Res32476)
Sim20945 = keras.layers.SimpleRNN(3,name = 'Sim20945', )(in0Sim20945)
Con80482 = keras.layers.Concatenate(axis=1, name = 'Con80482', )([Sim20945,in0Con80482])
Sub94960 = keras.layers.Subtract(name = 'Sub94960', )([Fla70272,Con80482])
Ave48881 = keras.layers.Average(name = 'Ave48881', )([Con12876,Sub94960])
Max50801 = keras.layers.Maximum(name = 'Max50801', )([in0Max50801,in1Max50801])
Cro60963 = keras.layers.Cropping2D(cropping=((0, 0), (1, 0)), name = 'Cro60963', )(Max50801)
Res48406 = keras.layers.Reshape((1, 2), name = 'Res48406', )(Cro60963)
Fla91486 = keras.layers.Flatten(name = 'Fla91486', )(Res48406)
Con38912 = keras.layers.Concatenate(axis=1, name = 'Con38912', )([Fla91486,in0Con38912])
Sep37724 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep37724', )(in0Sep37724)
LST65265 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST65265', )(Sep37724)
Max30704 = keras.layers.Maximum(name = 'Max30704', )([Con38912,LST65265])
Con10635 = keras.layers.Concatenate(axis=1, name = 'Con10635', )([Max30704,in0Con10635])
Add71242 = keras.layers.Add(name = 'Add71242', )([Ave48881,Con10635])
model = tf.keras.models.Model(inputs=[in0GRU82793,in0Con12876,in0Max89346,in0Sim20945,in0Con80482,in0Max50801,in1Max50801,in0Con38912,in0Sep37724,in0Con10635], outputs=Add71242)
w = model.get_layer('GRU82793').get_weights() 
w[0] = np.array([[5, 4, 7], [10, 5, 8]])
w[1] = np.array([[2, 5, 6]])
w[2] = np.array([[4, 3, 4], [10, 5, 4]])
model.get_layer('GRU82793').set_weights(w) 
w = model.get_layer('Sim20945').get_weights() 
w[0] = np.array([[3, 10, 1]])
w[1] = np.array([[9, 7, 7], [5, 5, 2], [10, 1, 8]])
w[2] = np.array([7, 5, 10])
model.get_layer('Sim20945').set_weights(w) 
w = model.get_layer('Sep37724').get_weights() 
w[0] = np.array([[[0.6555]]])
w[1] = np.array([[[0.6812, 0.0025, 0.9644, 0.4512]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep37724').set_weights(w) 
w = model.get_layer('LST65265').get_weights() 
w[0] = np.array([[10, 6, 10, 3, 8, 3, 8, 8, 7, 9, 10, 6], [5, 5, 7, 4, 10, 3, 7, 4, 4, 3, 8, 9], [8, 3, 9, 8, 10, 3, 6, 8, 5, 5, 3, 10], [10, 1, 10, 9, 9, 8, 1, 8, 3, 6, 4, 4]])
w[1] = np.array([[7, 3, 8, 8, 5, 10, 4, 9, 9, 6, 2, 9], [9, 9, 8, 3, 1, 10, 10, 9, 2, 8, 9, 5], [7, 7, 10, 2, 10, 9, 7, 4, 1, 10, 4, 2]])
w[2] = np.array([4, 9, 4, 5, 8, 2, 5, 1, 3, 8, 3, 5])
model.get_layer('LST65265').set_weights(w) 
in0GRU82793 = tf.constant([[[10, 3], [5, 2]]])
in0Con12876 = tf.constant([[0.1975, 0.9982, 0.2516]])
in0Max89346 = tf.constant([[[[1.4832, 1.382], [1.3086, 1.3433]], [[1.6634, 1.3788], [1.4541, 1.8271]]]])
in0Sim20945 = tf.constant([[[2], [5], [5]]])
in0Con80482 = tf.constant([[0.9142]])
in0Max50801 = tf.constant([[[[0.6781, 0.5466], [0.3795, 0.9275]]]])
in1Max50801 = tf.constant([[[[0.0946, 0.2235], [0.9067, 0.7564]]]])
in0Con38912 = tf.constant([[0.5747]])
in0Sep37724 = tf.constant([[[0.788]]])
in0Con10635 = tf.constant([[0.1846]])
print (np.array2string(model.predict([in0GRU82793,in0Con12876,in0Max89346,in0Sim20945,in0Con80482,in0Max50801,in1Max50801,in0Con38912,in0Sep37724,in0Con10635],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add71242.png')

LGRU82793 = gru_layer([[[10, 3], [5, 2]]],[[5, 4, 7], [10, 5, 8]],[[2, 5, 6]],[[4, 3, 4], [10, 5, 4]], true, GRU82793), 
LLea53207 = leaky_relu_layer(GRU82793, 6.071381847943638, Lea53207), 
LCon12876 = concatenate_layer([Lea53207,[[0.1975, 0.9982, 0.2516]]], 1, Con12876), 
LMax89346 = max_pool2D_layer([[[[1.4832, 1.382], [1.3086, 1.3433]], [[1.6634, 1.3788], [1.4541, 1.8271]]]], 2, 1, 1, 2, true, Max89346), 
LRes32476 = reshape_layer(Max89346, [2, 2], Res32476), 
LFla70272 = flatten_layer(Res32476, Fla70272), 
LSim20945 = simple_rnn_layer([[[2], [5], [5]]],[[3, 10, 1]],[[9, 7, 7], [5, 5, 2], [10, 1, 8]],[7, 5, 10], Sim20945), 
LCon80482 = concatenate_layer([Sim20945,[[0.9142]]], 1, Con80482), 
LSub94960 = subtract_layer(Fla70272,Con80482, Sub94960), 
LAve48881 = average_layer([Con12876,Sub94960], Ave48881), 
LMax50801 = maximum_layer([[[[[0.6781, 0.5466], [0.3795, 0.9275]]]], [[[[0.0946, 0.2235], [0.9067, 0.7564]]]]], Max50801), 
LCro60963 = cropping2D_layer(Max50801, 0, 0, 1, 0, Cro60963), 
LRes48406 = reshape_layer(Cro60963, [1, 2], Res48406), 
LFla91486 = flatten_layer(Res48406, Fla91486), 
LCon38912 = concatenate_layer([Fla91486,[[0.5747]]], 1, Con38912), 
LSep37724 = separable_conv1D_layer([[[0.788]]], 1,[[[[0.6555]]],[[[0.6812, 0.0025, 0.9644, 0.4512]]]],[0, 0, 0, 0], 1, true, Sep37724), 
LLST65265 = lstm_layer(Sep37724,[[10, 6, 10, 3, 8, 3, 8, 8, 7, 9, 10, 6], [5, 5, 7, 4, 10, 3, 7, 4, 4, 3, 8, 9], [8, 3, 9, 8, 10, 3, 6, 8, 5, 5, 3, 10], [10, 1, 10, 9, 9, 8, 1, 8, 3, 6, 4, 4]],[[7, 3, 8, 8, 5, 10, 4, 9, 9, 6, 2, 9], [9, 9, 8, 3, 1, 10, 10, 9, 2, 8, 9, 5], [7, 7, 10, 2, 10, 9, 7, 4, 1, 10, 4, 2]],[4, 9, 4, 5, 8, 2, 5, 1, 3, 8, 3, 5], LST65265), 
LMax30704 = maximum_layer([Con38912,LST65265], Max30704), 
LCon10635 = concatenate_layer([Max30704,[[0.1846]]], 1, Con10635), 
LAdd71242 = add_layer([Ave48881,Con10635], Add71242), 
exec_layers([LGRU82793,LLea53207,LCon12876,LMax89346,LRes32476,LFla70272,LSim20945,LCon80482,LSub94960,LAve48881,LMax50801,LCro60963,LRes48406,LFla91486,LCon38912,LSep37724,LLST65265,LMax30704,LCon10635,LAdd71242],["GRU82793","Lea53207","Con12876","Max89346","Res32476","Fla70272","Sim20945","Con80482","Sub94960","Ave48881","Max50801","Cro60963","Res48406","Fla91486","Con38912","Sep37724","LST65265","Max30704","Con10635","Add71242"],Add71242,"Add71242")

Actual (Unparsed): [[1.2384000, 1.2172500, 1.5923922, 0.5427000]]

Expected (Unparsed): [[1.2384,1.21725,1.592392222678059,0.5427]]

Actual:   [[1.2384, 1.2173, 1.5924, 0.5427]]

Expected: [[1.2384, 1.2173, 1.5924, 0.5427]]