import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot95439 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot95439 = tf.keras.layers.Input(shape=([3, 2]))

Dot95439 = keras.layers.Dot(axes=(2, 2), name = 'Dot95439', )([in0Dot95439,in1Dot95439])
Bat84820 = keras.layers.BatchNormalization(axis=1, epsilon=0.9438566236125211,  name = 'Bat84820', )(Dot95439)
Res63200 = keras.layers.Reshape((3, 3, 1), name = 'Res63200', )(Bat84820)
Res40613 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res40613', )(Res63200)
Cro28997 = keras.layers.Cropping3D(cropping=((2, 0), (1, 1), (0, 0)), name = 'Cro28997', )(Res40613)
model = tf.keras.models.Model(inputs=[in0Dot95439,in1Dot95439], outputs=Cro28997)
w = model.get_layer('Bat84820').get_weights() 
w[0] = np.array([0.5238, 0.6578, 0.4202])
w[1] = np.array([0.2902, 0.203, 0.3368])
w[2] = np.array([0.7347, 0.3881, 0.7675])
w[3] = np.array([0.8763, 0.2522, 0.2336])
model.get_layer('Bat84820').set_weights(w) 
in0Dot95439 = tf.constant([[[0.7491, 0.8554], [0.915, 0.6361], [0.4873, 0.8028]]])
in1Dot95439 = tf.constant([[[0.5403, 0.2084], [0.6458, 0.7754], [0.5166, 0.0012]]])
print (np.array2string(model.predict([in0Dot95439,in1Dot95439],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro28997.png')

LDot95439 = dot_layer([[[0.7491, 0.8554], [0.915, 0.6361], [0.4873, 0.8028]]], [[[0.5403, 0.2084], [0.6458, 0.7754], [0.5166, 0.0012]]], 2, 2, Dot95439), 
LBat84820 = batch_normalization_layer(Dot95439, 1, 0.9438566236125211, [0.5238, 0.6578, 0.4202], [0.2902, 0.203, 0.3368], [0.7347, 0.3881, 0.7675], [0.8763, 0.2522, 0.2336], Bat84820), 
LRes63200 = reshape_layer(Bat84820, [3, 3, 1], Res63200), 
LRes40613 = reshape_layer(Res63200, [3, 3, 1, 1], Res40613), 
LCro28997 = cropping3D_layer(Res40613, 2, 0, 1, 1, 0, 0, Cro28997), 
exec_layers([LDot95439,LBat84820,LRes63200,LRes40613,LCro28997],["Dot95439","Bat84820","Res63200","Res40613","Cro28997"],Cro28997,"Cro28997")

Actual (Unparsed): [[[[[0.4025111]]]]]

Expected (Unparsed): [[[[[0.402511057608223]]]]]

Actual:   [[[[[0.4026]]]]]

Expected: [[[[[0.4026]]]]]