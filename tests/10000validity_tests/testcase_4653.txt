import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul38562 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Mul38562 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Con5186 = tf.keras.layers.Input(shape=([4, 3, 2]))
in0Min48145 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Min48145 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Dot43327 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot43327 = tf.keras.layers.Input(shape=([2, 2]))
in0Con90316 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min13345 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min13345 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con46748 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con87639 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con38895 = tf.keras.layers.Input(shape=([4, 3, 1]))
in0Sub72137 = tf.keras.layers.Input(shape=([2]))
in1Sub72137 = tf.keras.layers.Input(shape=([2]))
in0Con43755 = tf.keras.layers.Input(shape=([4, 3, 3]))

Mul38562 = keras.layers.Multiply(name = 'Mul38562', )([in0Mul38562,in1Mul38562])
Res74742 = keras.layers.Reshape((2, 1, 2), name = 'Res74742', )(Mul38562)
Zer48775 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer48775', )(Res74742)
Con5186 = keras.layers.Concatenate(axis=3, name = 'Con5186', )([Zer48775,in0Con5186])
Min48145 = keras.layers.Minimum(name = 'Min48145', )([in0Min48145,in1Min48145])
Res44612 = keras.layers.Reshape((2, 1, 4), name = 'Res44612', )(Min48145)
Zer30306 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer30306', )(Res44612)
Min95496 = keras.layers.Minimum(name = 'Min95496', )([Con5186,Zer30306])
Dot43327 = keras.layers.Dot(axes=(2, 2), name = 'Dot43327', )([in0Dot43327,in1Dot43327])
Res22490 = keras.layers.Reshape((2, 2, 1), name = 'Res22490', )(Dot43327)
Con90316 = keras.layers.Concatenate(axis=3, name = 'Con90316', )([Res22490,in0Con90316])
Min13345 = keras.layers.Minimum(name = 'Min13345', )([in0Min13345,in1Min13345])
Zer17673 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer17673', )(Min13345)
Con46748 = keras.layers.Concatenate(axis=3, name = 'Con46748', )([Zer17673,in0Con46748])
Con87639 = keras.layers.Conv2DTranspose(3, (1, 2),strides=(1, 1), padding='same', name = 'Con87639', )(in0Con87639)
Mul12645 = keras.layers.Multiply(name = 'Mul12645', )([Con46748,Con87639])
Max76655 = keras.layers.Maximum(name = 'Max76655', )([Con90316,Mul12645])
Zer23255 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer23255', )(Max76655)
Con38895 = keras.layers.Concatenate(axis=3, name = 'Con38895', )([Zer23255,in0Con38895])
Sub6566 = keras.layers.Subtract(name = 'Sub6566', )([Min95496,Con38895])
Sub72137 = keras.layers.Subtract(name = 'Sub72137', )([in0Sub72137,in1Sub72137])
Res6762 = keras.layers.Reshape((2, 1), name = 'Res6762', )(Sub72137)
Res72572 = keras.layers.Reshape((2, 1, 1), name = 'Res72572', )(Res6762)
Zer40245 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer40245', )(Res72572)
Con43755 = keras.layers.Concatenate(axis=3, name = 'Con43755', )([Zer40245,in0Con43755])
Sub63608 = keras.layers.Subtract(name = 'Sub63608', )([Sub6566,Con43755])
model = tf.keras.models.Model(inputs=[in0Mul38562,in1Mul38562,in0Con5186,in0Min48145,in1Min48145,in0Dot43327,in1Dot43327,in0Con90316,in0Min13345,in1Min13345,in0Con46748,in0Con87639,in0Con38895,in0Sub72137,in1Sub72137,in0Con43755], outputs=Sub63608)
w = model.get_layer('Con87639').get_weights() 
w[0] = np.array([[[[0.1846, 0.1646], [0.5941, 0.8254], [0.4282, 0.6734]], [[0.3922, 0.0087], [0.4972, 0.3155], [0.9147, 0.7527]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con87639').set_weights(w) 
in0Mul38562 = tf.constant([[[[[0.0191, 0.0472]]], [[[0.4452, 0.4404]]]]])
in1Mul38562 = tf.constant([[[[[0.2207, 0.6867]]], [[[0.1524, 0.5464]]]]])
in0Con5186 = tf.constant([[[[0.0305, 0.232], [0.7316, 0.9034], [0.3658, 0.4961]], [[0.8879, 0.7187], [0.1223, 0.5079], [0.025, 0.3203]], [[0.1727, 0.4988], [0.2777, 0.9911], [0.0891, 0.8007]], [[0.589, 0.1276], [0.9815, 0.9649], [0.3727, 0.535]]]])
in0Min48145 = tf.constant([[[[[0.9787, 0.2343], [0.2369, 0.5756]]], [[[0.1029, 0.6803], [1, 0.2595]]]]])
in1Min48145 = tf.constant([[[[[0.7868, 0.0082], [0.4053, 0.0155]]], [[[0.9108, 0.8695], [0.8477, 0.6994]]]]])
in0Dot43327 = tf.constant([[[0.4155, 0.5746], [0.8522, 0.4309]]])
in1Dot43327 = tf.constant([[[0.9156, 0.5254], [0.3701, 0.6014]]])
in0Con90316 = tf.constant([[[[0.9871, 0.1863], [0.0856, 0.0981]], [[0.0326, 0.975], [0.3354, 0.823]]]])
in0Min13345 = tf.constant([[[[0.4698], [0.7538]]]])
in1Min13345 = tf.constant([[[[0.7189], [0.9689]]]])
in0Con46748 = tf.constant([[[[0.0662, 0.5382], [0.4823, 0.5814]], [[0.2999, 0.9115], [0.6544, 0.4919]]]])
in0Con87639 = tf.constant([[[[0.6968, 0.5362], [0.6296, 0.8294]], [[0.2315, 0.1551], [0.3121, 0.6084]]]])
in0Con38895 = tf.constant([[[[0.1693], [0.5426], [0.5388]], [[0.6037], [0.8963], [0.1748]], [[0.2385], [0.5804], [0.3664]], [[0.0085], [0.1768], [0.6436]]]])
in0Sub72137 = tf.constant([[0.8548, 0.7517]])
in1Sub72137 = tf.constant([[0.9247, 0.8626]])
in0Con43755 = tf.constant([[[[0.8325, 0.8979, 0.2088], [0.5689, 0.2932, 0.0942], [0.6213, 0.518, 0.8584]], [[0.9743, 0.2144, 0.5182], [0.7194, 0.7233, 0.777], [0.5575, 0.5837, 0.7623]], [[0.2821, 0.9575, 0.2813], [0.0593, 0.7881, 0.0778], [0.8207, 0.677, 0.4979]], [[0.9522, 0.1871, 0.0769], [0.7279, 0.8712, 0.8223], [0.9752, 0.2637, 0.4018]]]])
print (np.array2string(model.predict([in0Mul38562,in1Mul38562,in0Con5186,in0Min48145,in1Min48145,in0Dot43327,in1Dot43327,in0Con90316,in0Min13345,in1Min13345,in0Con46748,in0Con87639,in0Con38895,in0Sub72137,in1Sub72137,in0Con43755],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub63608.png')

LMul38562 = multiply_layer([[[[[[0.0191, 0.0472]]], [[[0.4452, 0.4404]]]]], [[[[[0.2207, 0.6867]]], [[[0.1524, 0.5464]]]]]], Mul38562), 
LRes74742 = reshape_layer(Mul38562, [2, 1, 2], Res74742), 
LZer48775 = zero_padding2D_layer(Res74742, 2, 0, 2, 0, Zer48775), 
LCon5186 = concatenate_layer([Zer48775,[[[[0.0305, 0.232], [0.7316, 0.9034], [0.3658, 0.4961]], [[0.8879, 0.7187], [0.1223, 0.5079], [0.025, 0.3203]], [[0.1727, 0.4988], [0.2777, 0.9911], [0.0891, 0.8007]], [[0.589, 0.1276], [0.9815, 0.9649], [0.3727, 0.535]]]]], 3, Con5186), 
LMin48145 = minimum_layer([[[[[[0.9787, 0.2343], [0.2369, 0.5756]]], [[[0.1029, 0.6803], [1, 0.2595]]]]], [[[[[0.7868, 0.0082], [0.4053, 0.0155]]], [[[0.9108, 0.8695], [0.8477, 0.6994]]]]]], Min48145), 
LRes44612 = reshape_layer(Min48145, [2, 1, 4], Res44612), 
LZer30306 = zero_padding2D_layer(Res44612, 1, 1, 1, 1, Zer30306), 
LMin95496 = minimum_layer([Con5186,Zer30306], Min95496), 
LDot43327 = dot_layer([[[0.4155, 0.5746], [0.8522, 0.4309]]], [[[0.9156, 0.5254], [0.3701, 0.6014]]], 2, 2, Dot43327), 
LRes22490 = reshape_layer(Dot43327, [2, 2, 1], Res22490), 
LCon90316 = concatenate_layer([Res22490,[[[[0.9871, 0.1863], [0.0856, 0.0981]], [[0.0326, 0.975], [0.3354, 0.823]]]]], 3, Con90316), 
LMin13345 = minimum_layer([[[[[0.4698], [0.7538]]]], [[[[0.7189], [0.9689]]]]], Min13345), 
LZer17673 = zero_padding2D_layer(Min13345, 1, 0, 0, 0, Zer17673), 
LCon46748 = concatenate_layer([Zer17673,[[[[0.0662, 0.5382], [0.4823, 0.5814]], [[0.2999, 0.9115], [0.6544, 0.4919]]]]], 3, Con46748), 
LCon87639 = conv2D_transpose_layer([[[[0.6968, 0.5362], [0.6296, 0.8294]], [[0.2315, 0.1551], [0.3121, 0.6084]]]], 1, 2,[[[[0.1846, 0.1646], [0.5941, 0.8254], [0.4282, 0.6734]], [[0.3922, 0.0087], [0.4972, 0.3155], [0.9147, 0.7527]]]],[0, 0, 0], 1, 1, true, Con87639), 
LMul12645 = multiply_layer([Con46748,Con87639], Mul12645), 
LMax76655 = maximum_layer([Con90316,Mul12645], Max76655), 
LZer23255 = zero_padding2D_layer(Max76655, 2, 0, 1, 0, Zer23255), 
LCon38895 = concatenate_layer([Zer23255,[[[[0.1693], [0.5426], [0.5388]], [[0.6037], [0.8963], [0.1748]], [[0.2385], [0.5804], [0.3664]], [[0.0085], [0.1768], [0.6436]]]]], 3, Con38895), 
LSub6566 = subtract_layer(Min95496,Con38895, Sub6566), 
LSub72137 = subtract_layer([[0.8548, 0.7517]], [[0.9247, 0.8626]], Sub72137), 
LRes6762 = reshape_layer(Sub72137, [2, 1], Res6762), 
LRes72572 = reshape_layer(Res6762, [2, 1, 1], Res72572), 
LZer40245 = zero_padding2D_layer(Res72572, 1, 1, 1, 1, Zer40245), 
LCon43755 = concatenate_layer([Zer40245,[[[[0.8325, 0.8979, 0.2088], [0.5689, 0.2932, 0.0942], [0.6213, 0.518, 0.8584]], [[0.9743, 0.2144, 0.5182], [0.7194, 0.7233, 0.777], [0.5575, 0.5837, 0.7623]], [[0.2821, 0.9575, 0.2813], [0.0593, 0.7881, 0.0778], [0.8207, 0.677, 0.4979]], [[0.9522, 0.1871, 0.0769], [0.7279, 0.8712, 0.8223], [0.9752, 0.2637, 0.4018]]]]], 3, Con43755), 
LSub63608 = subtract_layer(Sub6566,Con43755, Sub63608), 
exec_layers([LMul38562,LRes74742,LZer48775,LCon5186,LMin48145,LRes44612,LZer30306,LMin95496,LDot43327,LRes22490,LCon90316,LMin13345,LZer17673,LCon46748,LCon87639,LMul12645,LMax76655,LZer23255,LCon38895,LSub6566,LSub72137,LRes6762,LRes72572,LZer40245,LCon43755,LSub63608],["Mul38562","Res74742","Zer48775","Con5186","Min48145","Res44612","Zer30306","Min95496","Dot43327","Res22490","Con90316","Min13345","Zer17673","Con46748","Con87639","Mul12645","Max76655","Zer23255","Con38895","Sub6566","Sub72137","Res6762","Res72572","Zer40245","Con43755","Sub63608"],Sub63608,"Sub63608")

Actual (Unparsed): [[[[0.0000000, -0.8325000, -0.8979000, -0.3781000], [0.0000000, -0.5689000, -0.2932000, -0.6368000], [0.0000000, -0.6213000, -0.5180000, -1.3972000]], [[0.0000000, -0.9743000, -0.2144000, -1.1219000], [0.0699000, -0.7194000, -0.6010000, -1.6578000], [0.0000000, -0.5575000, -0.5837000, -0.9371000]], [[0.0000000, -0.2821000, -0.9575000, -0.5198000], [-0.5714266, -1.0464000, -0.8653143, -0.3987000], [-0.4993410, -1.5799618, -1.7636792, -0.8643000]], [[0.0000000, -0.9522000, -0.1871000, -0.0854000], [-1.0066692, -0.8075396, -1.8462000, -0.9991000], [-0.5745425, -1.5325052, -1.0867000, -1.0454000]]]]

Expected (Unparsed): [[[[0,-0.8325,-0.8979,-0.3781],[0,-0.5689,-0.2932,-0.6368],[0,-0.6213,-0.518,-1.3972]],[[0,-0.9743,-0.2144,-1.1219000000000001],[0.06989999999999996,-0.7194,-0.6010000000000001,-1.6578],[0,-0.5575,-0.5837,-0.9371]],[[0,-0.2821,-0.9575,-0.5198],[-0.57142664,-1.0464,-0.865314289288,-0.3987],[-0.49934099,-1.5799618264139998,-1.763679263132,-0.8643000000000001]],[[0,-0.9522,-0.1871,-0.0854],[-1.00666918,-0.807539551631,-1.8462,-0.9991000000000001],[-0.5745424800000001,-1.532505245408,-1.0867,-1.0453999999999999]]]]

Actual:   [[[[0, -0.8325, -0.8979, -0.3781], [0, -0.5689, -0.2932, -0.6368], [0, -0.6213, -0.518, -1.3972]], [[0, -0.9743, -0.2144, -1.1219], [0.0699, -0.7194, -0.601, -1.6578], [0, -0.5575, -0.5837, -0.9371]], [[0, -0.2821, -0.9575, -0.5198], [-0.5714, -1.0464, -0.8653, -0.3987], [-0.4993, -1.5799, -1.7636, -0.8643]], [[0, -0.9522, -0.1871, -0.0854], [-1.0066, -0.8075, -1.8462, -0.9991], [-0.5745, -1.5325, -1.0867, -1.0454]]]]

Expected: [[[[0, -0.8325, -0.8979, -0.3781], [0, -0.5689, -0.2932, -0.6368], [0, -0.6213, -0.518, -1.3972]], [[0, -0.9743, -0.2144, -1.1219], [0.0699, -0.7194, -0.601, -1.6578], [0, -0.5575, -0.5837, -0.9371]], [[0, -0.2821, -0.9575, -0.5198], [-0.5714, -1.0464, -0.8653, -0.3987], [-0.4993, -1.5799, -1.7636, -0.8643]], [[0, -0.9522, -0.1871, -0.0854], [-1.0066, -0.8075, -1.8462, -0.9991], [-0.5745, -1.5325, -1.0867, -1.0453]]]]