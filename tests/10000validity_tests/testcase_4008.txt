import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_45930 = tf.keras.layers.Input(shape=([4, 1]))
in0Con4209 = tf.keras.layers.Input(shape=([8, 1]))
in0Add89096 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add89096 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Max69005 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max69005 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Glo27841 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Con24431 = tf.keras.layers.Input(shape=([14]))

Up_45930 = keras.layers.UpSampling1D(size=(2), name = 'Up_45930', )(in0Up_45930)
Con4209 = keras.layers.Concatenate(axis=2, name = 'Con4209', )([Up_45930,in0Con4209])
Add89096 = keras.layers.Add(name = 'Add89096', )([in0Add89096,in1Add89096])
Res94018 = keras.layers.Reshape((2, 2), name = 'Res94018', )(Add89096)
Dot81186 = keras.layers.Dot(axes=(2, 2), name = 'Dot81186', )([Con4209,Res94018])
Fla77874 = keras.layers.Flatten(name = 'Fla77874', )(Dot81186)
Max69005 = keras.layers.Maximum(name = 'Max69005', )([in0Max69005,in1Max69005])
Res57643 = keras.layers.Reshape((1, 2), name = 'Res57643', )(Max69005)
Fla98711 = keras.layers.Flatten(name = 'Fla98711', )(Res57643)
Glo27841 = keras.layers.GlobalMaxPool3D(name = 'Glo27841', )(in0Glo27841)
Add60425 = keras.layers.Add(name = 'Add60425', )([Fla98711,Glo27841])
Con24431 = keras.layers.Concatenate(axis=1, name = 'Con24431', )([Add60425,in0Con24431])
Ave40341 = keras.layers.Average(name = 'Ave40341', )([Fla77874,Con24431])
model = tf.keras.models.Model(inputs=[in0Up_45930,in0Con4209,in0Add89096,in1Add89096,in0Max69005,in1Max69005,in0Glo27841,in0Con24431], outputs=Ave40341)
in0Up_45930 = tf.constant([[[1.569], [1.9553], [1.9891], [1.4007]]])
in0Con4209 = tf.constant([[[0.5488], [0.7273], [0.0414], [0.8025], [0.5335], [0.2282], [0.0258], [0.8022]]])
in0Add89096 = tf.constant([[[[0.2376, 0.2711]], [[0.1249, 0.0289]]]])
in1Add89096 = tf.constant([[[[0.4035, 0.1642]], [[0.7457, 0.436]]]])
in0Max69005 = tf.constant([[[[0.6752, 0.613]]]])
in1Max69005 = tf.constant([[[[0.7399, 0.1361]]]])
in0Glo27841 = tf.constant([[[[[1.9564, 1.7353], [1.1713, 1.8597]]], [[[1.8223, 1.1594], [1.524, 1.6706]]]]])
in0Con24431 = tf.constant([[0.3698, 0.5162, 0.0704, 0.3834, 0.772, 0.7848, 0.5949, 0.03, 0.5229, 0.5727, 0.2882, 0.8545, 0.7119, 0.6708]])
print (np.array2string(model.predict([in0Up_45930,in0Con4209,in0Add89096,in1Add89096,in0Max69005,in1Max69005,in0Glo27841,in0Con24431],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave40341.png')

LUp_45930 = up_sampling1D_layer([[[1.569], [1.9553], [1.9891], [1.4007]]], 2, Up_45930), 
LCon4209 = concatenate_layer([Up_45930,[[[0.5488], [0.7273], [0.0414], [0.8025], [0.5335], [0.2282], [0.0258], [0.8022]]]], 2, Con4209), 
LAdd89096 = add_layer([[[[[0.2376, 0.2711]], [[0.1249, 0.0289]]]], [[[[0.4035, 0.1642]], [[0.7457, 0.436]]]]], Add89096), 
LRes94018 = reshape_layer(Add89096, [2, 2], Res94018), 
LDot81186 = dot_layer(Con4209,Res94018, 2, 2, Dot81186), 
LFla77874 = flatten_layer(Dot81186, Fla77874), 
LMax69005 = maximum_layer([[[[[0.6752, 0.613]]]], [[[[0.7399, 0.1361]]]]], Max69005), 
LRes57643 = reshape_layer(Max69005, [1, 2], Res57643), 
LFla98711 = flatten_layer(Res57643, Fla98711), 
LGlo27841 = global_max_pool3D_layer([[[[[1.9564, 1.7353], [1.1713, 1.8597]]], [[[1.8223, 1.1594], [1.524, 1.6706]]]]], Glo27841), 
LAdd60425 = add_layer([Fla98711,Glo27841], Add60425), 
LCon24431 = concatenate_layer([Add60425,[[0.3698, 0.5162, 0.0704, 0.3834, 0.772, 0.7848, 0.5949, 0.03, 0.5229, 0.5727, 0.2882, 0.8545, 0.7119, 0.6708]]], 1, Con24431), 
LAve40341 = average_layer([Fla77874,Con24431], Ave40341), 
exec_layers([LUp_45930,LCon4209,LAdd89096,LRes94018,LDot81186,LFla77874,LMax69005,LRes57643,LFla98711,LGlo27841,LAdd60425,LCon24431,LAve40341],["Up_45930","Con4209","Add89096","Res94018","Dot81186","Fla77874","Max69005","Res57643","Fla98711","Glo27841","Add60425","Con24431","Ave40341"],Ave40341,"Ave40341")

Actual (Unparsed): [[1.9705393, 2.0469042, 0.8461398, 1.1101466, 0.6709821, 1.0524655, 1.1874355, 1.4300832, 1.0511723, 1.0048673, 0.9487237, 1.2052503, 0.5987097, 1.0429719, 0.9795432, 1.1315961]]

Expected (Unparsed): [[1.97053927,2.04690426,0.846139795,1.110146585,0.670982125,1.0524655200000002,1.18743554,1.4300832150000002,1.05117228,1.004867305,0.9487237350000002,1.2052503200000002,0.598709755,1.04297192,0.979543215,1.1315961]]

Actual:   [[1.9706, 2.047, 0.8462, 1.1102, 0.671, 1.0525, 1.1875, 1.4301, 1.0512, 1.0049, 0.9488, 1.2053, 0.5988, 1.043, 0.9796, 1.1316]]

Expected: [[1.9706, 2.047, 0.8462, 1.1102, 0.671, 1.0525, 1.1875, 1.4301, 1.0512, 1.0049, 0.9488, 1.2053, 0.5988, 1.043, 0.9796, 1.1316]]