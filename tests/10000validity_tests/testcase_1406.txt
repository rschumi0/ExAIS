import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave82656 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave82656 = tf.keras.layers.Input(shape=([1, 2, 1]))

Ave82656 = keras.layers.Average(name = 'Ave82656', )([in0Ave82656,in1Ave82656])
Res86473 = keras.layers.Reshape((1, 2), name = 'Res86473', )(Ave82656)
Ave42555 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave42555', )(Res86473)
Den89453 = keras.layers.Dense(2,name = 'Den89453', )(Ave42555)
Loc20272 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc20272', )(Den89453)
Res60474 = keras.layers.Reshape((1, 4, 1), name = 'Res60474', )(Loc20272)
Dep87967 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep87967', )(Res60474)
model = tf.keras.models.Model(inputs=[in0Ave82656,in1Ave82656], outputs=Dep87967)
w = model.get_layer('Den89453').get_weights() 
w[0] = np.array([[0.8425, 0.6173], [0.2833, 0.1396]])
w[1] = np.array([0.7039, 0.5968])
model.get_layer('Den89453').set_weights(w) 
w = model.get_layer('Loc20272').get_weights() 
w[0] = np.array([[[0.7567, 0.268, 0.6739, 0.6546], [0.8048, 0.5118, 0.4131, 0.9878]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc20272').set_weights(w) 
w = model.get_layer('Dep87967').get_weights() 
w[0] = np.array([[[[0.5207]]]])
w[1] = np.array([0])
model.get_layer('Dep87967').set_weights(w) 
in0Ave82656 = tf.constant([[[[0.2934], [0.5342]]]])
in1Ave82656 = tf.constant([[[[0.5964], [0.9594]]]])
print (np.array2string(model.predict([in0Ave82656,in1Ave82656],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep87967.png')

LAve82656 = average_layer([[[[[0.2934], [0.5342]]]], [[[[0.5964], [0.9594]]]]], Ave82656), 
LRes86473 = reshape_layer(Ave82656, [1, 2], Res86473), 
LAve42555 = average_pooling1D_layer(Res86473, 1, Ave42555), 
LDen89453 = dense_layer(Ave42555, [[0.8425, 0.6173], [0.2833, 0.1396]],[0.7039, 0.5968], Den89453), 
LLoc20272 = locally_connected1D_layer(Den89453, 1,[[[0.7567, 0.268, 0.6739, 0.6546], [0.8048, 0.5118, 0.4131, 0.9878]]],[[0, 0, 0, 0]], 1, Loc20272), 
LRes60474 = reshape_layer(Loc20272, [1, 4, 1], Res60474), 
LDep87967 = depthwise_conv2D_layer(Res60474, 1, 1,[[[[0.5207]]]],[0], 1, 1, false, Dep87967), 
exec_layers([LAve82656,LRes86473,LAve42555,LDen89453,LLoc20272,LRes60474,LDep87967],["Ave82656","Res86473","Ave42555","Den89453","Loc20272","Res60474","Dep87967"],Dep87967,"Dep87967")

Actual (Unparsed): [[[[0.9172666], [0.4400736], [0.6626368], [0.9416416]]]]

Expected (Unparsed): [[[[0.9172666079330543],[0.44007360424155706],[0.6626368314532523],[0.9416416096165448]]]]

Actual:   [[[[0.9173], [0.4401], [0.6627], [0.9417]]]]

Expected: [[[[0.9173], [0.4401], [0.6627], [0.9417]]]]