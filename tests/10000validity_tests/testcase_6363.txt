import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max67937 = tf.keras.layers.Input(shape=([2, 1]))
in1Max67937 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot4601 = tf.keras.layers.Input(shape=([2]))
in1Dot4601 = tf.keras.layers.Input(shape=([2]))
in0Con97275 = tf.keras.layers.Input(shape=([11]))

Max67937 = keras.layers.Maximum(name = 'Max67937', )([in0Max67937,in1Max67937])
Res57336 = keras.layers.Reshape((2, 1, 1), name = 'Res57336', )(Max67937)
Zer17756 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer17756', )(Res57336)
Res41729 = keras.layers.Reshape((4, 3), name = 'Res41729', )(Zer17756)
Fla25650 = keras.layers.Flatten(name = 'Fla25650', )(Res41729)
Dot4601 = keras.layers.Dot(axes=(1, 1), name = 'Dot4601', )([in0Dot4601,in1Dot4601])
Con97275 = keras.layers.Concatenate(axis=1, name = 'Con97275', )([Dot4601,in0Con97275])
Sub15429 = keras.layers.Subtract(name = 'Sub15429', )([Fla25650,Con97275])
model = tf.keras.models.Model(inputs=[in0Max67937,in1Max67937,in0Dot4601,in1Dot4601,in0Con97275], outputs=Sub15429)
in0Max67937 = tf.constant([[[0.823], [0.1481]]])
in1Max67937 = tf.constant([[[0.1968], [0.8391]]])
in0Dot4601 = tf.constant([[0.5537, 0.5221]])
in1Dot4601 = tf.constant([[0.3264, 0.2978]])
in0Con97275 = tf.constant([[0.9132, 0.1491, 0.3774, 0.5627, 0.2943, 0.9326, 0.2536, 0.7745, 0.2987, 0.0575, 0.7228]])
print (np.array2string(model.predict([in0Max67937,in1Max67937,in0Dot4601,in1Dot4601,in0Con97275],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub15429.png')

LMax67937 = maximum_layer([[[[0.823], [0.1481]]], [[[0.1968], [0.8391]]]], Max67937), 
LRes57336 = reshape_layer(Max67937, [2, 1, 1], Res57336), 
LZer17756 = zero_padding2D_layer(Res57336, 1, 1, 1, 1, Zer17756), 
LRes41729 = reshape_layer(Zer17756, [4, 3], Res41729), 
LFla25650 = flatten_layer(Res41729, Fla25650), 
LDot4601 = dot_layer([[0.5537, 0.5221]], [[0.3264, 0.2978]], 1, 1, Dot4601), 
LCon97275 = concatenate_layer([Dot4601,[[0.9132, 0.1491, 0.3774, 0.5627, 0.2943, 0.9326, 0.2536, 0.7745, 0.2987, 0.0575, 0.7228]]], 1, Con97275), 
LSub15429 = subtract_layer(Fla25650,Con97275, Sub15429), 
exec_layers([LMax67937,LRes57336,LZer17756,LRes41729,LFla25650,LDot4601,LCon97275,LSub15429],["Max67937","Res57336","Zer17756","Res41729","Fla25650","Dot4601","Con97275","Sub15429"],Sub15429,"Sub15429")

Actual (Unparsed): [[-0.3362091, -0.9132000, -0.1491000, -0.3774000, 0.2603000, -0.2943000, -0.9326000, 0.5855000, -0.7745000, -0.2987000, -0.0575000, -0.7228000]]

Expected (Unparsed): [[-0.33620906,-0.9132,-0.1491,-0.3774,0.2603,-0.2943,-0.9326,0.5854999999999999,-0.7745,-0.2987,-0.0575,-0.7228]]

Actual:   [[-0.3362, -0.9132, -0.1491, -0.3774, 0.2603, -0.2943, -0.9326, 0.5855, -0.7745, -0.2987, -0.0575, -0.7228]]

Expected: [[-0.3362, -0.9132, -0.1491, -0.3774, 0.2603, -0.2943, -0.9326, 0.5855, -0.7745, -0.2987, -0.0575, -0.7228]]