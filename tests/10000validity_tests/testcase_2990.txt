import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer20000 = tf.keras.layers.Input(shape=([1, 2, 3, 3]))

Zer20000 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer20000', )(in0Zer20000)
Bat70565 = keras.layers.BatchNormalization(axis=1, epsilon=0.9325169052768051,  name = 'Bat70565', )(Zer20000)
model = tf.keras.models.Model(inputs=[in0Zer20000], outputs=Bat70565)
w = model.get_layer('Bat70565').get_weights() 
w[0] = np.array([0.6556, 0.317, 0.3701])
w[1] = np.array([0.746, 0.0333, 0.7424])
w[2] = np.array([0.2133, 0.4934, 0.9576])
w[3] = np.array([0.9129, 0.2148, 0.3566])
model.get_layer('Bat70565').set_weights(w) 
in0Zer20000 = tf.constant([[[[[1.575, 1.5727, 1.917], [1.4935, 1.3538, 1.4059], [1.453, 1.0069, 1.3562]], [[1.1875, 1.1039, 1.3387], [1.8098, 1.1057, 1.1195], [1.5135, 1.8987, 1.6465]]]]])
print (np.array2string(model.predict([in0Zer20000],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat70565.png')

LZer20000 = zero_padding3D_layer([[[[[1.575, 1.5727, 1.917], [1.4935, 1.3538, 1.4059], [1.453, 1.0069, 1.3562]], [[1.1875, 1.1039, 1.3387], [1.8098, 1.1057, 1.1195], [1.5135, 1.8987, 1.6465]]]]], 1, 1, 1, 1, 1, 1, Zer20000), 
LBat70565 = batch_normalization_layer(Zer20000, 1, 0.9325169052768051, [0.6556, 0.317, 0.3701], [0.746, 0.0333, 0.7424], [0.2133, 0.4934, 0.9576], [0.9129, 0.2148, 0.3566], Bat70565), 
exec_layers([LZer20000,LBat70565],["Zer20000","Bat70565"],Bat70565,"Bat70565")

Actual (Unparsed): [[[[[0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604]], [[0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604]], [[0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604]], [[0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604], [0.6430604, 0.6430604, 0.6430604]]], [[[-0.1127215, -0.1127215, -0.1127215], [-0.1127215, -0.1127215, -0.1127215], [-0.1127215, -0.1127215, -0.1127215], [-0.1127215, -0.1127215, -0.1127215], [-0.1127215, -0.1127215, -0.1127215]], [[-0.1127215, -0.1127215, -0.1127215], [0.3533990, 0.3527183, 0.4546137], [0.3292791, 0.2879349, 0.3033539], [0.3172931, 0.1852700, 0.2886452], [-0.1127215, -0.1127215, -0.1127215]], [[-0.1127215, -0.1127215, -0.1127215], [0.2387185, 0.2139771, 0.2834661], [0.4228879, 0.2145099, 0.2185940], [0.3351980, 0.4491978, 0.3745593], [-0.1127215, -0.1127215, -0.1127215]], [[-0.1127215, -0.1127215, -0.1127215], [-0.1127215, -0.1127215, -0.1127215], [-0.1127215, -0.1127215, -0.1127215], [-0.1127215, -0.1127215, -0.1127215], [-0.1127215, -0.1127215, -0.1127215]]], [[[0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545]], [[0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545]], [[0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545]], [[0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545], [0.4302545, 0.4302545, 0.4302545]]]]]

Expected (Unparsed): [[[[[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155]],[[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155]],[[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155]],[[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155],[0.6430603818349155,0.6430603818349155,0.6430603818349155]]],[[[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574]],[[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[0.35339894621110657,0.35271826243125676,0.45461366478007703],[0.3292790644468636,0.2879349235577256,0.30335389091867115],[0.31729311093211715,0.1852700525882056,0.2886452022845255],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574]],[[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[0.23871852677989003,0.21397715112969726,0.283466086568277],[0.42288788164968627,0.2145098601747971,0.2185939628538959],[0.3351980538368619,0.44919778948822864,0.3745593332803504],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574]],[[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574],[-0.1127214682512574,-0.1127214682512574,-0.1127214682512574]]],[[[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181]],[[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181]],[[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181]],[[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181],[0.4302545055568181,0.4302545055568181,0.4302545055568181]]]]]

Actual:   [[[[[0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431]], [[0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431]], [[0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431]], [[0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431]]], [[[-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127]], [[-0.1127, -0.1127, -0.1127], [0.3534, 0.3528, 0.4547], [0.3293, 0.288, 0.3034], [0.3173, 0.1853, 0.2887], [-0.1127, -0.1127, -0.1127]], [[-0.1127, -0.1127, -0.1127], [0.2388, 0.214, 0.2835], [0.4229, 0.2146, 0.2186], [0.3352, 0.4492, 0.3746], [-0.1127, -0.1127, -0.1127]], [[-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127]]], [[[0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303]], [[0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303]], [[0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303]], [[0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303]]]]]

Expected: [[[[[0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431]], [[0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431]], [[0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431]], [[0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431], [0.6431, 0.6431, 0.6431]]], [[[-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127]], [[-0.1127, -0.1127, -0.1127], [0.3534, 0.3528, 0.4547], [0.3293, 0.288, 0.3034], [0.3173, 0.1853, 0.2887], [-0.1127, -0.1127, -0.1127]], [[-0.1127, -0.1127, -0.1127], [0.2388, 0.214, 0.2835], [0.4229, 0.2146, 0.2186], [0.3352, 0.4492, 0.3746], [-0.1127, -0.1127, -0.1127]], [[-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127], [-0.1127, -0.1127, -0.1127]]], [[[0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303]], [[0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303]], [[0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303]], [[0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303], [0.4303, 0.4303, 0.4303]]]]]