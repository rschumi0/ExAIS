import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min61372 = tf.keras.layers.Input(shape=([2, 2]))
in1Min61372 = tf.keras.layers.Input(shape=([2, 2]))
in0Zer51786 = tf.keras.layers.Input(shape=([4, 2]))
in0Ave30522 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave30522 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul99288 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul99288 = tf.keras.layers.Input(shape=([2, 1, 2]))

Min61372 = keras.layers.Minimum(name = 'Min61372', )([in0Min61372,in1Min61372])
Zer51786 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer51786', )(in0Zer51786)
Ave30522 = keras.layers.Average(name = 'Ave30522', )([in0Ave30522,in1Ave30522])
Zer85212 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer85212', )(Ave30522)
Max78022 = keras.layers.Maximum(name = 'Max78022', )([Zer51786,Zer85212])
Mul99288 = keras.layers.Multiply(name = 'Mul99288', )([in0Mul99288,in1Mul99288])
Res77566 = keras.layers.Reshape((2, 2), name = 'Res77566', )(Mul99288)
Zer60506 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer60506', )(Res77566)
Dot40365 = keras.layers.Dot(axes=(1, 1), name = 'Dot40365', )([Max78022,Zer60506])
Add9209 = keras.layers.Add(name = 'Add9209', )([Min61372,Dot40365])
model = tf.keras.models.Model(inputs=[in0Min61372,in1Min61372,in0Zer51786,in0Ave30522,in1Ave30522,in0Mul99288,in1Mul99288], outputs=Add9209)
in0Min61372 = tf.constant([[[0.8463, 0.8888], [0.0741, 0.5885]]])
in1Min61372 = tf.constant([[[0.2524, 0.2791], [0.8993, 0.0781]]])
in0Zer51786 = tf.constant([[[1.8042, 1.9238], [1.8468, 1.3965], [1.3514, 1.6299], [1.9066, 1.6061]]])
in0Ave30522 = tf.constant([[[0.6954, 0.7883], [0.8124, 0.3146]]])
in1Ave30522 = tf.constant([[[0.55, 0.5812], [0.4498, 0.8199]]])
in0Mul99288 = tf.constant([[[[0.0622, 0.4816]], [[0.8671, 0.7499]]]])
in1Mul99288 = tf.constant([[[[0.9809, 0.0985]], [[0.9192, 0.4001]]]])
print (np.array2string(model.predict([in0Min61372,in1Min61372,in0Zer51786,in0Ave30522,in1Ave30522,in0Mul99288,in1Mul99288],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add9209.png')

LMin61372 = minimum_layer([[[[0.8463, 0.8888], [0.0741, 0.5885]]], [[[0.2524, 0.2791], [0.8993, 0.0781]]]], Min61372), 
LZer51786 = zero_padding1D_layer([[[1.8042, 1.9238], [1.8468, 1.3965], [1.3514, 1.6299], [1.9066, 1.6061]]], 1, 1, Zer51786), 
LAve30522 = average_layer([[[[0.6954, 0.7883], [0.8124, 0.3146]]], [[[0.55, 0.5812], [0.4498, 0.8199]]]], Ave30522), 
LZer85212 = zero_padding1D_layer(Ave30522, 4, 0, Zer85212), 
LMax78022 = maximum_layer([Zer51786,Zer85212], Max78022), 
LMul99288 = multiply_layer([[[[[0.0622, 0.4816]], [[0.8671, 0.7499]]]], [[[[0.9809, 0.0985]], [[0.9192, 0.4001]]]]], Mul99288), 
LRes77566 = reshape_layer(Mul99288, [2, 2], Res77566), 
LZer60506 = zero_padding1D_layer(Res77566, 4, 0, Zer60506), 
LDot40365 = dot_layer(Max78022,Zer60506, 1, 1, Dot40365), 
LAdd9209 = add_layer([Min61372,Dot40365], Add9209), 
exec_layers([LMin61372,LZer51786,LAve30522,LZer85212,LMax78022,LMul99288,LRes77566,LZer60506,LDot40365,LAdd9209],["Min61372","Zer51786","Ave30522","Zer85212","Max78022","Mul99288","Res77566","Zer60506","Dot40365","Add9209"],Add9209,"Add9209")

Actual (Unparsed): [[[0.8717363, 0.5588966], [0.6242113, 0.3244844]]]

Expected (Unparsed): [[[0.8717363248200001,0.5588966103490001],[0.624211328098,0.3244843774375]]]

Actual:   [[[0.8718, 0.5589], [0.6243, 0.3245]]]

Expected: [[[0.8718, 0.5589], [0.6243, 0.3245]]]