import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc53223 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con2983 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Sep69639 = tf.keras.layers.Input(shape=([2, 2, 1]))

Loc53223 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(9, 1), name = 'Loc53223', )(in0Loc53223)
Res19670 = keras.layers.Reshape((1, 4), name = 'Res19670', )(Loc53223)
Loc29208 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc29208', )(Res19670)
Fla5101 = keras.layers.Flatten(name = 'Fla5101', )(Loc29208)
Res34368 = keras.layers.Reshape((3, 1), name = 'Res34368', )(Fla5101)
Res79681 = keras.layers.Reshape((3, 1, 1), name = 'Res79681', )(Res34368)
Zer22727 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer22727', )(Res79681)
Con2983 = keras.layers.Concatenate(axis=3, name = 'Con2983', )([Zer22727,in0Con2983])
Sep69639 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='same', name = 'Sep69639', )(in0Sep69639)
Zer34960 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer34960', )(Sep69639)
Max84190 = keras.layers.Maximum(name = 'Max84190', )([Con2983,Zer34960])
Res74810 = keras.layers.Reshape((3, 3, 4, 1), name = 'Res74810', )(Max84190)
Zer4320 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer4320', )(Res74810)
model = tf.keras.models.Model(inputs=[in0Loc53223,in0Con2983,in0Sep69639], outputs=Zer4320)
w = model.get_layer('Loc53223').get_weights() 
w[0] = np.array([[[0.5668, 0.5383, 0.9447, 0.4004], [0.3367, 0.5501, 0.8542, 0.585]]])
w[1] = np.array([[[0, 0, 0, 0]]])
model.get_layer('Loc53223').set_weights(w) 
w = model.get_layer('Loc29208').get_weights() 
w[0] = np.array([[[0.1316, 0.4327, 0.2728], [0.7705, 0.6009, 0.25], [0.314, 0.826, 0.3463], [0.8181, 0.3123, 0.4198]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc29208').set_weights(w) 
w = model.get_layer('Sep69639').get_weights() 
w[0] = np.array([[[[0.5444]]]])
w[1] = np.array([[[[0.8195, 0.1757, 0.6326, 0.2845]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep69639').set_weights(w) 
in0Loc53223 = tf.constant([[[[0.8869, 0.4074]]]])
in0Con2983 = tf.constant([[[[0.3468, 0.0377, 0.5816], [0.0042, 0.7881, 0.4351], [0.5674, 0.2824, 0.4675]], [[0.479, 0.4269, 0.3856], [0.8679, 0.3812, 0.0566], [0.6482, 0.2057, 0.4931]], [[0.5481, 0.3002, 0.4513], [0.3834, 0.7975, 0.1364], [0.809, 0.4626, 0.2493]]]])
in0Sep69639 = tf.constant([[[[0.9559], [0.5504]], [[0.1196], [0.4821]]]])
print (np.array2string(model.predict([in0Loc53223,in0Con2983,in0Sep69639],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer4320.png')

LLoc53223 = locally_connected2D_layer([[[[0.8869, 0.4074]]]], 1, 1,[[[0.5668, 0.5383, 0.9447, 0.4004], [0.3367, 0.5501, 0.8542, 0.585]]],[[[0, 0, 0, 0]]], 9, 1, Loc53223), 
LRes19670 = reshape_layer(Loc53223, [1, 4], Res19670), 
LLoc29208 = locally_connected1D_layer(Res19670, 1,[[[0.1316, 0.4327, 0.2728], [0.7705, 0.6009, 0.25], [0.314, 0.826, 0.3463], [0.8181, 0.3123, 0.4198]]],[[0, 0, 0]], 1, Loc29208), 
LFla5101 = flatten_layer(Loc29208, Fla5101), 
LRes34368 = reshape_layer(Fla5101, [3, 1], Res34368), 
LRes79681 = reshape_layer(Res34368, [3, 1, 1], Res79681), 
LZer22727 = zero_padding2D_layer(Res79681, 0, 0, 2, 0, Zer22727), 
LCon2983 = concatenate_layer([Zer22727,[[[[0.3468, 0.0377, 0.5816], [0.0042, 0.7881, 0.4351], [0.5674, 0.2824, 0.4675]], [[0.479, 0.4269, 0.3856], [0.8679, 0.3812, 0.0566], [0.6482, 0.2057, 0.4931]], [[0.5481, 0.3002, 0.4513], [0.3834, 0.7975, 0.1364], [0.809, 0.4626, 0.2493]]]]], 3, Con2983), 
LSep69639 = separable_conv2D_layer([[[[0.9559], [0.5504]], [[0.1196], [0.4821]]]], 1, 1,[[[[[0.5444]]]],[[[[0.8195, 0.1757, 0.6326, 0.2845]]]]],[0, 0, 0, 0], 1, 1, true, Sep69639), 
LZer34960 = zero_padding2D_layer(Sep69639, 1, 0, 1, 0, Zer34960), 
LMax84190 = maximum_layer([Con2983,Zer34960], Max84190), 
LRes74810 = reshape_layer(Max84190, [3, 3, 4, 1], Res74810), 
LZer4320 = zero_padding3D_layer(Res74810, 1, 1, 1, 1, 1, 1, Zer4320), 
exec_layers([LLoc53223,LRes19670,LLoc29208,LFla5101,LRes34368,LRes79681,LZer22727,LCon2983,LSep69639,LZer34960,LMax84190,LRes74810,LZer4320],["Loc53223","Res19670","Loc29208","Fla5101","Res34368","Res79681","Zer22727","Con2983","Sep69639","Zer34960","Max84190","Res74810","Zer4320"],Zer4320,"Zer4320")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.3468000], [0.0377000], [0.5816000], [0.0000000]], [[0.0000000], [0.0000000], [0.0042000], [0.7881000], [0.4351000], [0.0000000]], [[0.0000000], [1.4825895], [0.5674000], [0.2824000], [0.4675000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.4790000], [0.4269000], [0.3856000], [0.0000000]], [[0.0000000], [0.4264612], [0.8679000], [0.3812000], [0.1480515], [0.0000000]], [[0.0000000], [1.8632682], [0.6482000], [0.2057000], [0.4931000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.5481000], [0.3002000], [0.4513000], [0.0000000]], [[0.0000000], [0.0533578], [0.3834000], [0.7975000], [0.1364000], [0.0000000]], [[0.0000000], [1.0097273], [0.8090000], [0.4626000], [0.2493000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0],[0]],[[0],[0],[0.3468],[0.0377],[0.5816],[0]],[[0],[0],[0.0042],[0.7881],[0.4351],[0]],[[0],[1.482589503801],[0.5674],[0.2824],[0.4675],[0]],[[0],[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0],[0]],[[0],[0],[0.479],[0.4269],[0.3856],[0]],[[0],[0.42646121121999997],[0.8679],[0.3812],[0.14805151262],[0]],[[0],[1.8632681541669998],[0.6482],[0.2057],[0.4931],[0]],[[0],[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0],[0]],[[0],[0],[0.5481],[0.3002],[0.4513],[0]],[[0],[0.05335784168],[0.3834],[0.7975],[0.1364],[0]],[[0],[1.009727287261],[0.809],[0.4626],[0.2493],[0]],[[0],[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0], [0]], [[0], [0], [0.3468], [0.0377], [0.5816], [0]], [[0], [0], [0.0042], [0.7881], [0.4351], [0]], [[0], [1.4826], [0.5674], [0.2824], [0.4675], [0]], [[0], [0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0], [0]], [[0], [0], [0.479], [0.4269], [0.3856], [0]], [[0], [0.4265], [0.8679], [0.3812], [0.1481], [0]], [[0], [1.8633], [0.6482], [0.2057], [0.4931], [0]], [[0], [0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0], [0]], [[0], [0], [0.5481], [0.3002], [0.4513], [0]], [[0], [0.0534], [0.3834], [0.7975], [0.1364], [0]], [[0], [1.0098], [0.809], [0.4626], [0.2493], [0]], [[0], [0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]]]]]

Expected: [[[[[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0], [0]], [[0], [0], [0.3468], [0.0377], [0.5816], [0]], [[0], [0], [0.0042], [0.7881], [0.4351], [0]], [[0], [1.4826], [0.5674], [0.2824], [0.4675], [0]], [[0], [0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0], [0]], [[0], [0], [0.479], [0.4269], [0.3856], [0]], [[0], [0.4265], [0.8679], [0.3812], [0.1481], [0]], [[0], [1.8633], [0.6482], [0.2057], [0.4931], [0]], [[0], [0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0], [0]], [[0], [0], [0.5481], [0.3002], [0.4513], [0]], [[0], [0.0534], [0.3834], [0.7975], [0.1364], [0]], [[0], [1.0098], [0.809], [0.4626], [0.2493], [0]], [[0], [0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]]]]]