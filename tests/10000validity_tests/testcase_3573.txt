import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro61569 = tf.keras.layers.Input(shape=([1, 4]))
in0Add23565 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Add23565 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Cro61569 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro61569', )(in0Cro61569)
Res86714 = keras.layers.Reshape((1, 4, 1), name = 'Res86714', )(Cro61569)
Sep32117 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='same', name = 'Sep32117', )(Res86714)
Res28413 = keras.layers.Reshape((1, 16), name = 'Res28413', )(Sep32117)
Sep20318 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep20318', )(Res28413)
Res91162 = keras.layers.Reshape((1, 2, 1), name = 'Res91162', )(Sep20318)
Res46399 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res46399', )(Res91162)
Zer13474 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer13474', )(Res46399)
Add23565 = keras.layers.Add(name = 'Add23565', )([in0Add23565,in1Add23565])
Min13074 = keras.layers.Minimum(name = 'Min13074', )([Zer13474,Add23565])
model = tf.keras.models.Model(inputs=[in0Cro61569,in0Add23565,in1Add23565], outputs=Min13074)
w = model.get_layer('Sep32117').get_weights() 
w[0] = np.array([[[[0.0998]]]])
w[1] = np.array([[[[0.0418, 0.9307, 0.9866, 0.2964]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep32117').set_weights(w) 
w = model.get_layer('Sep20318').get_weights() 
w[0] = np.array([[[0.7532], [0.0015], [0.4448], [0.3485], [0.0196], [0.2504], [0.8884], [0.1004], [0.3737], [0.4121], [0.6493], [0.6142], [0.5346], [0.9004], [0.625], [0.4913]]])
w[1] = np.array([[[0.1343, 0.7016], [0.5238, 0.8673], [0.9505, 0.6218], [0.6895, 0.8909], [0.2648, 0.7052], [0.7102, 0.2791], [0.024, 0.6397], [0.8752, 0.847], [0.1322, 0.8198], [0.8734, 0.5568], [0.9367, 0.4281], [0.9469, 0.0796], [0.0232, 0.0585], [0.8509, 0.3141], [0.5444, 0.3667], [0.2317, 0.8667]]])
w[2] = np.array([0, 0])
model.get_layer('Sep20318').set_weights(w) 
in0Cro61569 = tf.constant([[[1.0229, 1.5294, 1.4936, 1.9347]]])
in0Add23565 = tf.constant([[[[[0.454]], [[0.7426]]], [[[0.7187]], [[0.1955]]]]])
in1Add23565 = tf.constant([[[[[0.2043]], [[0.1241]]], [[[0.1018]], [[0.8144]]]]])
print (np.array2string(model.predict([in0Cro61569,in0Add23565,in1Add23565],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min13074.png')

LCro61569 = cropping1D_layer([[[1.0229, 1.5294, 1.4936, 1.9347]]], 0, 0, Cro61569), 
LRes86714 = reshape_layer(Cro61569, [1, 4, 1], Res86714), 
LSep32117 = separable_conv2D_layer(Res86714, 1, 1,[[[[[0.0998]]]],[[[[0.0418, 0.9307, 0.9866, 0.2964]]]]],[0, 0, 0, 0], 1, 1, true, Sep32117), 
LRes28413 = reshape_layer(Sep32117, [1, 16], Res28413), 
LSep20318 = separable_conv1D_layer(Res28413, 1,[[[[0.7532], [0.0015], [0.4448], [0.3485], [0.0196], [0.2504], [0.8884], [0.1004], [0.3737], [0.4121], [0.6493], [0.6142], [0.5346], [0.9004], [0.625], [0.4913]]],[[[0.1343, 0.7016], [0.5238, 0.8673], [0.9505, 0.6218], [0.6895, 0.8909], [0.2648, 0.7052], [0.7102, 0.2791], [0.024, 0.6397], [0.8752, 0.847], [0.1322, 0.8198], [0.8734, 0.5568], [0.9367, 0.4281], [0.9469, 0.0796], [0.0232, 0.0585], [0.8509, 0.3141], [0.5444, 0.3667], [0.2317, 0.8667]]]],[0, 0], 1, true, Sep20318), 
LRes91162 = reshape_layer(Sep20318, [1, 2, 1], Res91162), 
LRes46399 = reshape_layer(Res91162, [1, 2, 1, 1], Res46399), 
LZer13474 = zero_padding3D_layer(Res46399, 1, 0, 0, 0, 0, 0, Zer13474), 
LAdd23565 = add_layer([[[[[[0.454]], [[0.7426]]], [[[0.7187]], [[0.1955]]]]], [[[[[0.2043]], [[0.1241]]], [[[0.1018]], [[0.8144]]]]]], Add23565), 
LMin13074 = minimum_layer([Zer13474,Add23565], Min13074), 
exec_layers([LCro61569,LRes86714,LSep32117,LRes28413,LSep20318,LRes91162,LRes46399,LZer13474,LAdd23565,LMin13074],["Cro61569","Res86714","Sep32117","Res28413","Sep20318","Res91162","Res46399","Zer13474","Add23565","Min13074"],Min13074,"Min13074")

Actual (Unparsed): [[[[[0.0000000]], [[0.0000000]]], [[[0.4573311]], [[0.3349573]]]]]

Expected (Unparsed): [[[[[0]],[[0]]],[[[0.45733114649661644]],[[0.33495728435192795]]]]]

Actual:   [[[[[0]], [[0]]], [[[0.4574]], [[0.335]]]]]

Expected: [[[[[0]], [[0]]], [[[0.4574]], [[0.335]]]]]