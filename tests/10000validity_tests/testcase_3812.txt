import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub19493 = tf.keras.layers.Input(shape=([2]))
in1Sub19493 = tf.keras.layers.Input(shape=([2]))
in0Con26133 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Ave15495 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Ave15495 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Mul2010 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul2010 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Add93335 = tf.keras.layers.Input(shape=([2, 1]))
in1Add93335 = tf.keras.layers.Input(shape=([2, 1]))
in0Con41771 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot20837 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot20837 = tf.keras.layers.Input(shape=([2, 3]))

Sub19493 = keras.layers.Subtract(name = 'Sub19493', )([in0Sub19493,in1Sub19493])
Res20590 = keras.layers.Reshape((2, 1), name = 'Res20590', )(Sub19493)
Res72008 = keras.layers.Reshape((2, 1, 1), name = 'Res72008', )(Res20590)
Res75172 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res75172', )(Res72008)
Con26133 = keras.layers.Concatenate(axis=4, name = 'Con26133', )([Res75172,in0Con26133])
Ave15495 = keras.layers.Average(name = 'Ave15495', )([in0Ave15495,in1Ave15495])
Sub99371 = keras.layers.Subtract(name = 'Sub99371', )([Con26133,Ave15495])
Res14703 = keras.layers.Reshape((2, 1, 2), name = 'Res14703', )(Sub99371)
Res5710 = keras.layers.Reshape((2, 2), name = 'Res5710', )(Res14703)
Mul2010 = keras.layers.Multiply(name = 'Mul2010', )([in0Mul2010,in1Mul2010])
Res49072 = keras.layers.Reshape((1, 2), name = 'Res49072', )(Mul2010)
Zer50733 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer50733', )(Res49072)
Add93335 = keras.layers.Add(name = 'Add93335', )([in0Add93335,in1Add93335])
Con41771 = keras.layers.Concatenate(axis=2, name = 'Con41771', )([Add93335,in0Con41771])
Dot20837 = keras.layers.Dot(axes=(2, 2), name = 'Dot20837', )([in0Dot20837,in1Dot20837])
Ave35451 = keras.layers.Average(name = 'Ave35451', )([Con41771,Dot20837])
Ave64749 = keras.layers.Average(name = 'Ave64749', )([Zer50733,Ave35451])
Dot4276 = keras.layers.Dot(axes=(2, 2), name = 'Dot4276', )([Res5710,Ave64749])
model = tf.keras.models.Model(inputs=[in0Sub19493,in1Sub19493,in0Con26133,in0Ave15495,in1Ave15495,in0Mul2010,in1Mul2010,in0Add93335,in1Add93335,in0Con41771,in0Dot20837,in1Dot20837], outputs=Dot4276)
in0Sub19493 = tf.constant([[0.291, 0.9191]])
in1Sub19493 = tf.constant([[0.5755, 0.9911]])
in0Con26133 = tf.constant([[[[[0.2418]]], [[[0.3943]]]]])
in0Ave15495 = tf.constant([[[[[0.1231, 0.2389]]], [[[0.7421, 0.484]]]]])
in1Ave15495 = tf.constant([[[[[0.3911, 0.191]]], [[[0.7012, 0.2371]]]]])
in0Mul2010 = tf.constant([[[[0.5279, 0.6879]]]])
in1Mul2010 = tf.constant([[[[0.6887, 0.6842]]]])
in0Add93335 = tf.constant([[[0.1597], [0.4311]]])
in1Add93335 = tf.constant([[[0.285], [0.0599]]])
in0Con41771 = tf.constant([[[0.8135], [0.1994]]])
in0Dot20837 = tf.constant([[[0.5341, 0.3695, 0.6669], [0.4852, 0.9123, 0.629]]])
in1Dot20837 = tf.constant([[[0.6177, 0.101, 0.3677], [0.3409, 0.5439, 0.4754]]])
print (np.array2string(model.predict([in0Sub19493,in1Sub19493,in0Con26133,in0Ave15495,in1Ave15495,in0Mul2010,in1Mul2010,in0Add93335,in1Add93335,in0Con41771,in0Dot20837,in1Dot20837],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot4276.png')

LSub19493 = subtract_layer([[0.291, 0.9191]], [[0.5755, 0.9911]], Sub19493), 
LRes20590 = reshape_layer(Sub19493, [2, 1], Res20590), 
LRes72008 = reshape_layer(Res20590, [2, 1, 1], Res72008), 
LRes75172 = reshape_layer(Res72008, [2, 1, 1, 1], Res75172), 
LCon26133 = concatenate_layer([Res75172,[[[[[0.2418]]], [[[0.3943]]]]]], 4, Con26133), 
LAve15495 = average_layer([[[[[[0.1231, 0.2389]]], [[[0.7421, 0.484]]]]], [[[[[0.3911, 0.191]]], [[[0.7012, 0.2371]]]]]], Ave15495), 
LSub99371 = subtract_layer(Con26133,Ave15495, Sub99371), 
LRes14703 = reshape_layer(Sub99371, [2, 1, 2], Res14703), 
LRes5710 = reshape_layer(Res14703, [2, 2], Res5710), 
LMul2010 = multiply_layer([[[[[0.5279, 0.6879]]]], [[[[0.6887, 0.6842]]]]], Mul2010), 
LRes49072 = reshape_layer(Mul2010, [1, 2], Res49072), 
LZer50733 = zero_padding1D_layer(Res49072, 1, 0, Zer50733), 
LAdd93335 = add_layer([[[[0.1597], [0.4311]]], [[[0.285], [0.0599]]]], Add93335), 
LCon41771 = concatenate_layer([Add93335,[[[0.8135], [0.1994]]]], 2, Con41771), 
LDot20837 = dot_layer([[[0.5341, 0.3695, 0.6669], [0.4852, 0.9123, 0.629]]], [[[0.6177, 0.101, 0.3677], [0.3409, 0.5439, 0.4754]]], 2, 2, Dot20837), 
LAve35451 = average_layer([Con41771,Dot20837], Ave35451), 
LAve64749 = average_layer([Zer50733,Ave35451], Ave64749), 
LDot4276 = dot_layer(Res5710,Ave64749, 2, 2, Dot4276), 
exec_layers([LSub19493,LRes20590,LRes72008,LRes75172,LCon26133,LAve15495,LSub99371,LRes14703,LRes5710,LMul2010,LRes49072,LZer50733,LAdd93335,LCon41771,LDot20837,LAve35451,LAve64749,LDot4276],["Sub19493","Res20590","Res72008","Res75172","Con26133","Ave15495","Sub99371","Res14703","Res5710","Mul2010","Res49072","Zer50733","Add93335","Con41771","Dot20837","Ave35451","Ave64749","Dot4276"],Dot4276,"Dot4276")

Actual (Unparsed): [[[-0.1329784, -0.2352017], [-0.1969813, -0.3475995]]]

Expected (Unparsed): [[[-0.132978435005,-0.23520168763287502],[-0.1969812952575,-0.34759944374437496]]]

Actual:   [[[-0.1329, -0.2352], [-0.1969, -0.3475]]]

Expected: [[[-0.1329, -0.2352], [-0.1969, -0.3475]]]