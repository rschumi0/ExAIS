import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max78569 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max78569 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0PRe68789 = tf.keras.layers.Input(shape=([1, 1]))
in0Con97157 = tf.keras.layers.Input(shape=([1, 1]))

Max78569 = keras.layers.Maximum(name = 'Max78569', )([in0Max78569,in1Max78569])
Res46896 = keras.layers.Reshape((2, 2), name = 'Res46896', )(Max78569)
Cro59199 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro59199', )(Res46896)
PRe68789 = keras.layers.PReLU(name = 'PRe68789', input_shape=(1, 1))(in0PRe68789)
Con97157 = keras.layers.Concatenate(axis=2, name = 'Con97157', )([PRe68789,in0Con97157])
Add32210 = keras.layers.Add(name = 'Add32210', )([Cro59199,Con97157])
model = tf.keras.models.Model(inputs=[in0Max78569,in1Max78569,in0PRe68789,in0Con97157], outputs=Add32210)
w = model.get_layer('PRe68789').get_weights() 
w[0] = np.array([[0.4056]])
model.get_layer('PRe68789').set_weights(w) 
in0Max78569 = tf.constant([[[[0.7266, 0.6873]], [[0.3253, 0.9017]]]])
in1Max78569 = tf.constant([[[[0.3569, 0.2739]], [[0.1068, 0.7859]]]])
in0PRe68789 = tf.constant([[[0.6372]]])
in0Con97157 = tf.constant([[[0.4001]]])
print (np.array2string(model.predict([in0Max78569,in1Max78569,in0PRe68789,in0Con97157],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add32210.png')

LMax78569 = maximum_layer([[[[[0.7266, 0.6873]], [[0.3253, 0.9017]]]], [[[[0.3569, 0.2739]], [[0.1068, 0.7859]]]]], Max78569), 
LRes46896 = reshape_layer(Max78569, [2, 2], Res46896), 
LCro59199 = cropping1D_layer(Res46896, 1, 0, Cro59199), 
LPRe68789 = prelu_layer([[[0.6372]]], [[0.4056]], PRe68789), 
LCon97157 = concatenate_layer([PRe68789,[[[0.4001]]]], 2, Con97157), 
LAdd32210 = add_layer([Cro59199,Con97157], Add32210), 
exec_layers([LMax78569,LRes46896,LCro59199,LPRe68789,LCon97157,LAdd32210],["Max78569","Res46896","Cro59199","PRe68789","Con97157","Add32210"],Add32210,"Add32210")

Actual (Unparsed): [[[0.9625000, 1.3018000]]]

Expected (Unparsed): [[[0.9624999999999999,1.3018]]]

Actual:   [[[0.9625, 1.3018]]]

Expected: [[[0.9625, 1.3018]]]