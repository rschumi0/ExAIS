import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con25744 = tf.keras.layers.Input(shape=([2, 2]))
in0Dot43055 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot43055 = tf.keras.layers.Input(shape=([3, 2]))
in0Min88897 = tf.keras.layers.Input(shape=([2, 1]))
in1Min88897 = tf.keras.layers.Input(shape=([2, 1]))

Con25744 = keras.layers.Conv1D(3, (2),strides=(10), padding='valid', dilation_rate=(1), name = 'Con25744', )(in0Con25744)
Glo38846 = keras.layers.GlobalMaxPool1D(name = 'Glo38846', )(Con25744)
Res91325 = keras.layers.Reshape((3, 1), name = 'Res91325', )(Glo38846)
Res61227 = keras.layers.Reshape((3, 1, 1), name = 'Res61227', )(Res91325)
Zer67898 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer67898', )(Res61227)
Dot43055 = keras.layers.Dot(axes=(2, 2), name = 'Dot43055', )([in0Dot43055,in1Dot43055])
Up_48643 = keras.layers.UpSampling1D(size=(2), name = 'Up_48643', )(Dot43055)
Glo99850 = keras.layers.GlobalMaxPool1D(name = 'Glo99850', )(Up_48643)
Res53186 = keras.layers.Reshape((3, 1), name = 'Res53186', )(Glo99850)
PRe92776 = keras.layers.PReLU(name = 'PRe92776', )(Res53186)
Res90957 = keras.layers.Reshape((3, 1, 1), name = 'Res90957', )(PRe92776)
Zer59835 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer59835', )(Res90957)
Min88897 = keras.layers.Minimum(name = 'Min88897', )([in0Min88897,in1Min88897])
Res18195 = keras.layers.Reshape((2, 1, 1), name = 'Res18195', )(Min88897)
Max37907 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max37907', )(Res18195)
Up_84945 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_84945', )(Max37907)
Add3946 = keras.layers.Add(name = 'Add3946', )([Zer59835,Up_84945])
Add96640 = keras.layers.Add(name = 'Add96640', )([Zer67898,Add3946])
model = tf.keras.models.Model(inputs=[in0Con25744,in0Dot43055,in1Dot43055,in0Min88897,in1Min88897], outputs=Add96640)
w = model.get_layer('Con25744').get_weights() 
w[0] = np.array([[[0.8869, 0.8247, 0.4299], [0.8018, 0.9911, 0.1969]], [[0.3311, 0.5556, 0.8552], [0.5196, 0.5884, 0.3497]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con25744').set_weights(w) 
w = model.get_layer('PRe92776').get_weights() 
w[0] = np.array([[0.1005], [0.2529], [0.8785]])
model.get_layer('PRe92776').set_weights(w) 
in0Con25744 = tf.constant([[[0.1757, 0.4148], [0.4816, 0.9059]]])
in0Dot43055 = tf.constant([[[0.6652, 0.5838], [0.2662, 0.3966], [0.945, 0.6924]]])
in1Dot43055 = tf.constant([[[0.1584, 0.2465], [0.6716, 0.6179], [0.2873, 0.7419]]])
in0Min88897 = tf.constant([[[0.394], [0.042]]])
in1Min88897 = tf.constant([[[0.5322], [0.7926]]])
print (np.array2string(model.predict([in0Con25744,in0Dot43055,in1Dot43055,in0Min88897,in1Min88897],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add96640.png')

LCon25744 = conv1D_layer([[[0.1757, 0.4148], [0.4816, 0.9059]]], 2,[[[0.8869, 0.8247, 0.4299], [0.8018, 0.9911, 0.1969]], [[0.3311, 0.5556, 0.8552], [0.5196, 0.5884, 0.3497]]],[0, 0, 0], 10, false, 1, Con25744), 
LGlo38846 = global_max_pool1D_layer(Con25744, Glo38846), 
LRes91325 = reshape_layer(Glo38846, [3, 1], Res91325), 
LRes61227 = reshape_layer(Res91325, [3, 1, 1], Res61227), 
LZer67898 = zero_padding2D_layer(Res61227, 1, 0, 1, 0, Zer67898), 
LDot43055 = dot_layer([[[0.6652, 0.5838], [0.2662, 0.3966], [0.945, 0.6924]]], [[[0.1584, 0.2465], [0.6716, 0.6179], [0.2873, 0.7419]]], 2, 2, Dot43055), 
LUp_48643 = up_sampling1D_layer(Dot43055, 2, Up_48643), 
LGlo99850 = global_max_pool1D_layer(Up_48643, Glo99850), 
LRes53186 = reshape_layer(Glo99850, [3, 1], Res53186), 
LPRe92776 = prelu_layer(Res53186, [[0.1005], [0.2529], [0.8785]], PRe92776), 
LRes90957 = reshape_layer(PRe92776, [3, 1, 1], Res90957), 
LZer59835 = zero_padding2D_layer(Res90957, 1, 0, 1, 0, Zer59835), 
LMin88897 = minimum_layer([[[[0.394], [0.042]]], [[[0.5322], [0.7926]]]], Min88897), 
LRes18195 = reshape_layer(Min88897, [2, 1, 1], Res18195), 
LMax37907 = max_pool2D_layer(Res18195, 1, 1, Max37907), 
LUp_84945 = up_sampling2D_layer(Max37907, 2, 2, Up_84945), 
LAdd3946 = add_layer([Zer59835,Up_84945], Add3946), 
LAdd96640 = add_layer([Zer67898,Add3946], Add96640), 
exec_layers([LCon25744,LGlo38846,LRes91325,LRes61227,LZer67898,LDot43055,LUp_48643,LGlo99850,LRes53186,LPRe92776,LRes90957,LZer59835,LMin88897,LRes18195,LMax37907,LUp_84945,LAdd3946,LAdd96640],["Con25744","Glo38846","Res91325","Res61227","Zer67898","Dot43055","Up_48643","Glo99850","Res53186","PRe92776","Res90957","Zer59835","Min88897","Res18195","Max37907","Up_84945","Add3946","Add96640"],Add96640,"Add96640")

Actual (Unparsed): [[[[0.3940000], [0.3940000]], [[0.3940000], [1.8329429]], [[0.0420000], [2.4611125]], [[0.0420000], [1.7130551]]]]

Expected (Unparsed): [[[[0.394],[0.394]],[[0.394],[1.83294297]],[[0.042],[2.46111255]],[[0.042],[1.7130551600000001]]]]

Actual:   [[[[0.394], [0.394]], [[0.394], [1.833]], [[0.042], [2.4612]], [[0.042], [1.7131]]]]

Expected: [[[[0.394], [0.394]], [[0.394], [1.833]], [[0.042], [2.4612]], [[0.042], [1.7131]]]]