import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add57762 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Add57762 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Add57762 = keras.layers.Add(name = 'Add57762', )([in0Add57762,in1Add57762])
Res41315 = keras.layers.Reshape((1, 1, 2), name = 'Res41315', )(Add57762)
Res57752 = keras.layers.Reshape((1, 2), name = 'Res57752', )(Res41315)
GRU70362 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU70362', )(Res57752)
model = tf.keras.models.Model(inputs=[in0Add57762,in1Add57762], outputs=GRU70362)
w = model.get_layer('GRU70362').get_weights() 
w[0] = np.array([[6, 3, 3, 6, 1, 9], [6, 8, 2, 6, 1, 6]])
w[1] = np.array([[8, 5, 4, 4, 10, 4], [8, 1, 4, 4, 10, 4]])
w[2] = np.array([[6, 2, 3, 4, 3, 10], [8, 9, 2, 2, 6, 8]])
model.get_layer('GRU70362').set_weights(w) 
in0Add57762 = tf.constant([[[[[0.3773], [0.0713]]]]])
in1Add57762 = tf.constant([[[[[0.3869], [0.0538]]]]])
print (np.array2string(model.predict([in0Add57762,in1Add57762],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU70362.png')

LAdd57762 = add_layer([[[[[[0.3773], [0.0713]]]]], [[[[[0.3869], [0.0538]]]]]], Add57762), 
LRes41315 = reshape_layer(Add57762, [1, 1, 2], Res41315), 
LRes57752 = reshape_layer(Res41315, [1, 2], Res57752), 
LGRU70362 = gru_layer(Res57752,[[6, 3, 3, 6, 1, 9], [6, 8, 2, 6, 1, 6]],[[8, 5, 4, 4, 10, 4], [8, 1, 4, 4, 10, 4]],[[6, 2, 3, 4, 3, 10], [8, 9, 2, 2, 6, 8]], true, GRU70362), 
exec_layers([LAdd57762,LRes41315,LRes57752,LGRU70362],["Add57762","Res41315","Res57752","GRU70362"],GRU70362,"GRU70362")

Actual (Unparsed): [[0.0000000, 0.0000006]]

Expected (Unparsed): [[4.004688560150123e-9,6.200903647224365e-7]]

Actual:   [[0, 0]]

Expected: [[0, 0]]