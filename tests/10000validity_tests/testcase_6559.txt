import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep9427 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0PRe19036 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Sep9427 = keras.layers.SeparableConv2D(2, (1, 2),strides=(1, 1), padding='valid', name = 'Sep9427', )(in0Sep9427)
Res42630 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res42630', )(Sep9427)
Zer31333 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer31333', )(Res42630)
PRe19036 = keras.layers.PReLU(name = 'PRe19036', input_shape=(2, 1, 2, 1))(in0PRe19036)
Max5476 = keras.layers.Maximum(name = 'Max5476', )([Zer31333,PRe19036])
model = tf.keras.models.Model(inputs=[in0Sep9427,in0PRe19036], outputs=Max5476)
w = model.get_layer('Sep9427').get_weights() 
w[0] = np.array([[[[0.7594], [0.6436]], [[0.7063], [0.088]]]])
w[1] = np.array([[[[0.9028, 0.7673], [0.9857, 0.0625]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep9427').set_weights(w) 
w = model.get_layer('PRe19036').get_weights() 
w[0] = np.array([[[[0.5308], [0.7717]]], [[[0.0951], [0.3405]]]])
model.get_layer('PRe19036').set_weights(w) 
in0Sep9427 = tf.constant([[[[0.9674, 0.3394], [0.1653, 0.3293]]]])
in0PRe19036 = tf.constant([[[[[0.7814], [0.5797]]], [[[0.5122], [0.087]]]]])
print (np.array2string(model.predict([in0Sep9427,in0PRe19036],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max5476.png')

LSep9427 = separable_conv2D_layer([[[[0.9674, 0.3394], [0.1653, 0.3293]]]], 1, 2,[[[[[0.7594], [0.6436]], [[0.7063], [0.088]]]],[[[[0.9028, 0.7673], [0.9857, 0.0625]]]]],[0, 0], 1, 1, false, Sep9427), 
LRes42630 = reshape_layer(Sep9427, [1, 1, 2, 1], Res42630), 
LZer31333 = zero_padding3D_layer(Res42630, 1, 0, 0, 0, 0, 0, Zer31333), 
LPRe19036 = prelu_layer([[[[[0.7814], [0.5797]]], [[[0.5122], [0.087]]]]], [[[[0.5308], [0.7717]]], [[[0.0951], [0.3405]]]], PRe19036), 
LMax5476 = maximum_layer([Zer31333,PRe19036], Max5476), 
exec_layers([LSep9427,LRes42630,LZer31333,LPRe19036,LMax5476],["Sep9427","Res42630","Zer31333","PRe19036","Max5476"],Max5476,"Max5476")

Actual (Unparsed): [[[[[0.7814000], [0.5797000]]], [[[1.0125176], [0.6687389]]]]]

Expected (Unparsed): [[[[[0.7814],[0.5797]]],[[[1.012517548628],[0.668738860135]]]]]

Actual:   [[[[[0.7814], [0.5797]]], [[[1.0126], [0.6688]]]]]

Expected: [[[[[0.7814], [0.5797]]], [[[1.0126], [0.6688]]]]]