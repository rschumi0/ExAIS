import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul16663 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Mul16663 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Add45902 = tf.keras.layers.Input(shape=([2, 2]))
in1Add45902 = tf.keras.layers.Input(shape=([2, 2]))

Mul16663 = keras.layers.Multiply(name = 'Mul16663', )([in0Mul16663,in1Mul16663])
Res38 = keras.layers.Reshape((2, 1, 4), name = 'Res38', )(Mul16663)
Add45902 = keras.layers.Add(name = 'Add45902', )([in0Add45902,in1Add45902])
Res1414 = keras.layers.Reshape((2, 2, 1), name = 'Res1414', )(Add45902)
Sep73869 = keras.layers.SeparableConv2D(4, (1, 2),strides=(2, 2), padding='valid', name = 'Sep73869', )(Res1414)
Zer57537 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer57537', )(Sep73869)
Add41904 = keras.layers.Add(name = 'Add41904', )([Res38,Zer57537])
model = tf.keras.models.Model(inputs=[in0Mul16663,in1Mul16663,in0Add45902,in1Add45902], outputs=Add41904)
w = model.get_layer('Sep73869').get_weights() 
w[0] = np.array([[[[0.1859]], [[0.3563]]]])
w[1] = np.array([[[[0.9155, 0.5911, 0.6058, 0.5812]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep73869').set_weights(w) 
in0Mul16663 = tf.constant([[[[[0.5343, 0.9805], [0.8067, 0.7209]]], [[[0.9077, 0.0699], [0.5606, 0.8443]]]]])
in1Mul16663 = tf.constant([[[[[0.0086, 0.245], [0.0448, 0.6083]]], [[[0.6677, 0.8469], [0.1586, 0.5594]]]]])
in0Add45902 = tf.constant([[[0.0248, 0.5899], [0.9664, 0.2558]]])
in1Add45902 = tf.constant([[[0.9345, 0.0682], [0.483, 0.621]]])
print (np.array2string(model.predict([in0Mul16663,in1Mul16663,in0Add45902,in1Add45902],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add41904.png')

LMul16663 = multiply_layer([[[[[[0.5343, 0.9805], [0.8067, 0.7209]]], [[[0.9077, 0.0699], [0.5606, 0.8443]]]]], [[[[[0.0086, 0.245], [0.0448, 0.6083]]], [[[0.6677, 0.8469], [0.1586, 0.5594]]]]]], Mul16663), 
LRes38 = reshape_layer(Mul16663, [2, 1, 4], Res38), 
LAdd45902 = add_layer([[[[0.0248, 0.5899], [0.9664, 0.2558]]], [[[0.9345, 0.0682], [0.483, 0.621]]]], Add45902), 
LRes1414 = reshape_layer(Add45902, [2, 2, 1], Res1414), 
LSep73869 = separable_conv2D_layer(Res1414, 1, 2,[[[[[0.1859]], [[0.3563]]]],[[[[0.9155, 0.5911, 0.6058, 0.5812]]]]],[0, 0, 0, 0], 2, 2, false, Sep73869), 
LZer57537 = zero_padding2D_layer(Sep73869, 1, 0, 0, 0, Zer57537), 
LAdd41904 = add_layer([Res38,Zer57537], Add41904), 
exec_layers([LMul16663,LRes38,LAdd45902,LRes1414,LSep73869,LZer57537,LAdd41904],["Mul16663","Res38","Add45902","Res1414","Sep73869","Zer57537","Add41904"],Add41904,"Add41904")

Actual (Unparsed): [[[[0.0045950, 0.2402225, 0.0361402, 0.4385234]], [[0.9840033, 0.3032132, 0.3389944, 0.7122294]]]]

Expected (Unparsed): [[[[0.00459498,0.2402225,0.03614016,0.43852346999999997]],[[0.9840033309499999,0.30321319738999997,0.33899442642,0.71222943988]]]]

Actual:   [[[[0.0046, 0.2403, 0.0362, 0.4386]], [[0.9841, 0.3033, 0.339, 0.7123]]]]

Expected: [[[[0.0046, 0.2403, 0.0362, 0.4386]], [[0.9841, 0.3033, 0.339, 0.7123]]]]