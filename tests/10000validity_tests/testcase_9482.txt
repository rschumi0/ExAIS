import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave55382 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave55382 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Ave55382 = keras.layers.Average(name = 'Ave55382', )([in0Ave55382,in1Ave55382])
Res60600 = keras.layers.Reshape((1, 2, 1), name = 'Res60600', )(Ave55382)
Sep91267 = keras.layers.SeparableConv2D(2, (1, 2),strides=(1, 1), padding='valid', name = 'Sep91267', )(Res60600)
Bat50436 = keras.layers.BatchNormalization(axis=2, epsilon=0.6289247350528973,  name = 'Bat50436', )(Sep91267)
model = tf.keras.models.Model(inputs=[in0Ave55382,in1Ave55382], outputs=Bat50436)
w = model.get_layer('Sep91267').get_weights() 
w[0] = np.array([[[[0.0988]], [[0.6433]]]])
w[1] = np.array([[[[0.2146, 0.1292]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep91267').set_weights(w) 
w = model.get_layer('Bat50436').get_weights() 
w[0] = np.array([0.2273])
w[1] = np.array([0.1443])
w[2] = np.array([0.7067])
w[3] = np.array([0.463])
model.get_layer('Bat50436').set_weights(w) 
in0Ave55382 = tf.constant([[[[[0.9366]], [[0.7783]]]]])
in1Ave55382 = tf.constant([[[[[0.8169]], [[0.0067]]]]])
print (np.array2string(model.predict([in0Ave55382,in1Ave55382],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat50436.png')

LAve55382 = average_layer([[[[[[0.9366]], [[0.7783]]]]], [[[[[0.8169]], [[0.0067]]]]]], Ave55382), 
LRes60600 = reshape_layer(Ave55382, [1, 2, 1], Res60600), 
LSep91267 = separable_conv2D_layer(Res60600, 1, 2,[[[[[0.0988]], [[0.6433]]]],[[[[0.2146, 0.1292]]]]],[0, 0], 1, 1, false, Sep91267), 
LBat50436 = batch_normalization_layer(Sep91267, 2, 0.6289247350528973, [0.2273], [0.1443], [0.7067], [0.463], Bat50436), 
exec_layers([LAve55382,LRes60600,LSep91267,LBat50436],["Ave55382","Res60600","Sep91267","Bat50436"],Bat50436,"Bat50436")

Actual (Unparsed): [[[[0.0064073, 0.0001078]]]]

Expected (Unparsed): [[[[0.0064073458777236525,0.00010776017400493387]]]]

Actual:   [[[[0.0065, 0.0002]]]]

Expected: [[[[0.0065, 0.0002]]]]