import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub23897 = tf.keras.layers.Input(shape=([2]))
in1Sub23897 = tf.keras.layers.Input(shape=([2]))
in0Min30934 = tf.keras.layers.Input(shape=([1, 1]))
in1Min30934 = tf.keras.layers.Input(shape=([1, 1]))
in0Con51620 = tf.keras.layers.Input(shape=([1, 3]))

Sub23897 = keras.layers.Subtract(name = 'Sub23897', )([in0Sub23897,in1Sub23897])
Res76844 = keras.layers.Reshape((2, 1), name = 'Res76844', )(Sub23897)
Res25151 = keras.layers.Reshape((2, 1, 1), name = 'Res25151', )(Res76844)
Loc52159 = keras.layers.LocallyConnected2D(4, (2, 1),strides=(1, 1), name = 'Loc52159', )(Res25151)
Res44786 = keras.layers.Reshape((1, 4), name = 'Res44786', )(Loc52159)
Min30934 = keras.layers.Minimum(name = 'Min30934', )([in0Min30934,in1Min30934])
Con51620 = keras.layers.Concatenate(axis=2, name = 'Con51620', )([Min30934,in0Con51620])
Sub26843 = keras.layers.Subtract(name = 'Sub26843', )([Res44786,Con51620])
Lay94767 = keras.layers.LayerNormalization(axis=1, epsilon=1.7461154666704195, name = 'Lay94767', )(Sub26843)
Res79837 = keras.layers.Reshape((1, 4, 1), name = 'Res79837', )(Lay94767)
Res34083 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res34083', )(Res79837)
Zer1122 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer1122', )(Res34083)
model = tf.keras.models.Model(inputs=[in0Sub23897,in1Sub23897,in0Min30934,in1Min30934,in0Con51620], outputs=Zer1122)
w = model.get_layer('Loc52159').get_weights() 
w[0] = np.array([[[0.4083, 0.0643, 0.7058, 0.748], [0.7844, 0.6038, 0.1491, 0.6396]]])
w[1] = np.array([[[0, 0, 0, 0]]])
model.get_layer('Loc52159').set_weights(w) 
in0Sub23897 = tf.constant([[0.5389, 0.7937]])
in1Sub23897 = tf.constant([[0.2014, 0.0823]])
in0Min30934 = tf.constant([[[0.8265]]])
in1Min30934 = tf.constant([[[0.9878]]])
in0Con51620 = tf.constant([[[0.9748, 0.1877, 0.9933]]])
print (np.array2string(model.predict([in0Sub23897,in1Sub23897,in0Min30934,in1Min30934,in0Con51620],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer1122.png')

LSub23897 = subtract_layer([[0.5389, 0.7937]], [[0.2014, 0.0823]], Sub23897), 
LRes76844 = reshape_layer(Sub23897, [2, 1], Res76844), 
LRes25151 = reshape_layer(Res76844, [2, 1, 1], Res25151), 
LLoc52159 = locally_connected2D_layer(Res25151, 2, 1,[[[0.4083, 0.0643, 0.7058, 0.748], [0.7844, 0.6038, 0.1491, 0.6396]]],[[[0, 0, 0, 0]]], 1, 1, Loc52159), 
LRes44786 = reshape_layer(Loc52159, [1, 4], Res44786), 
LMin30934 = minimum_layer([[[[0.8265]]], [[[0.9878]]]], Min30934), 
LCon51620 = concatenate_layer([Min30934,[[[0.9748, 0.1877, 0.9933]]]], 2, Con51620), 
LSub26843 = subtract_layer(Res44786,Con51620, Sub26843), 
LLay94767 = layer_normalization_layer(Sub26843, 1, 1.7461154666704195, Lay94767), 
LRes79837 = reshape_layer(Lay94767, [1, 4, 1], Res79837), 
LRes34083 = reshape_layer(Res79837, [1, 4, 1, 1], Res34083), 
LZer1122 = zero_padding3D_layer(Res34083, 1, 1, 1, 1, 1, 1, Zer1122), 
exec_layers([LSub23897,LRes76844,LRes25151,LLoc52159,LRes44786,LMin30934,LCon51620,LSub26843,LLay94767,LRes79837,LRes34083,LZer1122],["Sub23897","Res76844","Res25151","Loc52159","Res44786","Min30934","Con51620","Sub26843","Lay94767","Res79837","Res34083","Zer1122"],Zer1122,"Zer1122")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.0],[0]],[[0],[0.0],[0]],[[0],[0.0],[0]],[[0],[0.0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]