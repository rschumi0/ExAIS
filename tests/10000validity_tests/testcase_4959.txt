import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay37436 = tf.keras.layers.Input(shape=([3, 1]))
in0Add13770 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add13770 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con16967 = tf.keras.layers.Input(shape=([10, 1, 2]))
in0Mul59685 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Mul59685 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con98907 = tf.keras.layers.Input(shape=([10, 1, 2]))
in0Dot67600 = tf.keras.layers.Input(shape=([3]))
in1Dot67600 = tf.keras.layers.Input(shape=([3]))

Lay37436 = keras.layers.LayerNormalization(axis=1, epsilon=2.530789442822824, name = 'Lay37436', )(in0Lay37436)
Res29712 = keras.layers.Reshape((3, 1, 1), name = 'Res29712', )(Lay37436)
Add13770 = keras.layers.Add(name = 'Add13770', )([in0Add13770,in1Add13770])
Zer33362 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer33362', )(Add13770)
Mul29566 = keras.layers.Multiply(name = 'Mul29566', )([Res29712,Zer33362])
Zer47084 = keras.layers.ZeroPadding2D(padding=((7, 0), (0, 0)), name = 'Zer47084', )(Mul29566)
Con16967 = keras.layers.Concatenate(axis=3, name = 'Con16967', )([Zer47084,in0Con16967])
Mul59685 = keras.layers.Multiply(name = 'Mul59685', )([in0Mul59685,in1Mul59685])
Mas68966 = keras.layers.Masking(mask_value=1, name = 'Mas68966', )(Mul59685)
Zer122 = keras.layers.ZeroPadding2D(padding=((9, 0), (0, 0)), name = 'Zer122', )(Mas68966)
Con98907 = keras.layers.Concatenate(axis=3, name = 'Con98907', )([Zer122,in0Con98907])
Dot67600 = keras.layers.Dot(axes=(1, 1), name = 'Dot67600', )([in0Dot67600,in1Dot67600])
Res82854 = keras.layers.Reshape((1, 1), name = 'Res82854', )(Dot67600)
Res98480 = keras.layers.Reshape((1, 1, 1), name = 'Res98480', )(Res82854)
Con74791 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(10, 1), padding='same', name = 'Con74791', )(Res98480)
Sub47483 = keras.layers.Subtract(name = 'Sub47483', )([Con98907,Con74791])
Min47307 = keras.layers.Minimum(name = 'Min47307', )([Con16967,Sub47483])
model = tf.keras.models.Model(inputs=[in0Lay37436,in0Add13770,in1Add13770,in0Con16967,in0Mul59685,in1Mul59685,in0Con98907,in0Dot67600,in1Dot67600], outputs=Min47307)
w = model.get_layer('Con74791').get_weights() 
w[0] = np.array([[[[0.9994], [0.8496], [0.2755]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con74791').set_weights(w) 
in0Lay37436 = tf.constant([[[1.3194], [1.6655], [1.3575]]])
in0Add13770 = tf.constant([[[[0.4834]]]])
in1Add13770 = tf.constant([[[[0.5207]]]])
in0Con16967 = tf.constant([[[[0.44, 0.2274]], [[0.9055, 0.0001]], [[0.0532, 0.172]], [[0.6674, 0.8463]], [[0.9356, 0.7947]], [[0.0781, 0.1333]], [[0.9495, 0.657]], [[0.5501, 0.7053]], [[0.2642, 0.0244]], [[0.0792, 0.7882]]]])
in0Mul59685 = tf.constant([[[[0.6316]]]])
in1Mul59685 = tf.constant([[[[0.9912]]]])
in0Con98907 = tf.constant([[[[0.64, 0.8515]], [[0.5393, 0.6532]], [[0.3365, 0.7184]], [[0.0898, 0.6172]], [[0.4151, 0.2057]], [[0.9072, 0.1388]], [[0.1118, 0.7933]], [[0.0473, 0.8605]], [[0.9335, 0.8158]], [[0.1203, 0.5388]]]])
in0Dot67600 = tf.constant([[0.1755, 0.9916, 0.4696]])
in1Dot67600 = tf.constant([[0.0161, 0.3132, 0.5994]])
print (np.array2string(model.predict([in0Lay37436,in0Add13770,in1Add13770,in0Con16967,in0Mul59685,in1Mul59685,in0Con98907,in0Dot67600,in1Dot67600],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min47307.png')

LLay37436 = layer_normalization_layer([[[1.3194], [1.6655], [1.3575]]], 1, 2.530789442822824, Lay37436), 
LRes29712 = reshape_layer(Lay37436, [3, 1, 1], Res29712), 
LAdd13770 = add_layer([[[[[0.4834]]]], [[[[0.5207]]]]], Add13770), 
LZer33362 = zero_padding2D_layer(Add13770, 2, 0, 0, 0, Zer33362), 
LMul29566 = multiply_layer([Res29712,Zer33362], Mul29566), 
LZer47084 = zero_padding2D_layer(Mul29566, 7, 0, 0, 0, Zer47084), 
LCon16967 = concatenate_layer([Zer47084,[[[[0.44, 0.2274]], [[0.9055, 0.0001]], [[0.0532, 0.172]], [[0.6674, 0.8463]], [[0.9356, 0.7947]], [[0.0781, 0.1333]], [[0.9495, 0.657]], [[0.5501, 0.7053]], [[0.2642, 0.0244]], [[0.0792, 0.7882]]]]], 3, Con16967), 
LMul59685 = multiply_layer([[[[[0.6316]]]], [[[[0.9912]]]]], Mul59685), 
LMas68966 = masking_layer(Mul59685, 1, Mas68966), 
LZer122 = zero_padding2D_layer(Mas68966, 9, 0, 0, 0, Zer122), 
LCon98907 = concatenate_layer([Zer122,[[[[0.64, 0.8515]], [[0.5393, 0.6532]], [[0.3365, 0.7184]], [[0.0898, 0.6172]], [[0.4151, 0.2057]], [[0.9072, 0.1388]], [[0.1118, 0.7933]], [[0.0473, 0.8605]], [[0.9335, 0.8158]], [[0.1203, 0.5388]]]]], 3, Con98907), 
LDot67600 = dot_layer([[0.1755, 0.9916, 0.4696]], [[0.0161, 0.3132, 0.5994]], 1, 1, Dot67600), 
LRes82854 = reshape_layer(Dot67600, [1, 1], Res82854), 
LRes98480 = reshape_layer(Res82854, [1, 1, 1], Res98480), 
LCon74791 = conv2D_transpose_layer(Res98480, 1, 1,[[[[0.9994], [0.8496], [0.2755]]]],[0, 0, 0], 10, 1, true, Con74791), 
LSub47483 = subtract_layer(Con98907,Con74791, Sub47483), 
LMin47307 = minimum_layer([Con16967,Sub47483], Min47307), 
exec_layers([LLay37436,LRes29712,LAdd13770,LZer33362,LMul29566,LZer47084,LCon16967,LMul59685,LMas68966,LZer122,LCon98907,LDot67600,LRes82854,LRes98480,LCon74791,LSub47483,LMin47307],["Lay37436","Res29712","Add13770","Zer33362","Mul29566","Zer47084","Con16967","Mul59685","Mas68966","Zer122","Con98907","Dot67600","Res82854","Res98480","Con74791","Sub47483","Min47307"],Min47307,"Min47307")

Actual (Unparsed): [[[[-0.5945160, 0.1345960, 0.2274000]], [[0.0000000, 0.5393000, 0.0001000]], [[0.0000000, 0.0532000, 0.1720000]], [[0.0000000, 0.0898000, 0.6172000]], [[0.0000000, 0.4151000, 0.2057000]], [[0.0000000, 0.0781000, 0.1333000]], [[0.0000000, 0.1118000, 0.6570000]], [[0.0000000, 0.0473000, 0.7053000]], [[0.0000000, 0.2642000, 0.0244000]], [[-0.0565171, 0.0792000, 0.5388000]]]]

Expected (Unparsed): [[[[-0.594515986254,0.13459597566399994,0.2274]],[[0,0.5393,0.0001]],[[0,0.0532,0.172]],[[0,0.0898,0.6172]],[[0,0.4151,0.2057]],[[0,0.0781,0.1333]],[[0,0.1118,0.657]],[[-0.0,0.0473,0.7053]],[[0.0,0.2642,0.0244]],[[-0.056517128509254215,0.0792,0.5388]]]]

Actual:   [[[[-0.5945, 0.1346, 0.2274]], [[0, 0.5393, 0.0001]], [[0, 0.0532, 0.172]], [[0, 0.0898, 0.6172]], [[0, 0.4151, 0.2057]], [[0, 0.0781, 0.1333]], [[0, 0.1118, 0.657]], [[0, 0.0473, 0.7053]], [[0, 0.2642, 0.0244]], [[-0.0565, 0.0792, 0.5388]]]]

Expected: [[[[-0.5945, 0.1346, 0.2274]], [[0, 0.5393, 0.0001]], [[0, 0.0532, 0.172]], [[0, 0.0898, 0.6172]], [[0, 0.4151, 0.2057]], [[0, 0.0781, 0.1333]], [[0, 0.1118, 0.657]], [[-0, 0.0473, 0.7053]], [[0, 0.2642, 0.0244]], [[-0.0565, 0.0792, 0.5388]]]]