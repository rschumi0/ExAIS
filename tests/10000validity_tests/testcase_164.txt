import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max46220 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Max46220 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Max46220 = keras.layers.Maximum(name = 'Max46220', )([in0Max46220,in1Max46220])
Res85870 = keras.layers.Reshape((2, 1, 2), name = 'Res85870', )(Max46220)
Res20610 = keras.layers.Reshape((2, 2), name = 'Res20610', )(Res85870)
Zer26151 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer26151', )(Res20610)
model = tf.keras.models.Model(inputs=[in0Max46220,in1Max46220], outputs=Zer26151)
in0Max46220 = tf.constant([[[[[0.1645], [0.5699]]], [[[0.0683], [0.5892]]]]])
in1Max46220 = tf.constant([[[[[0.9147], [0.442]]], [[[0.3916], [0.9222]]]]])
print (np.array2string(model.predict([in0Max46220,in1Max46220],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer26151.png')

LMax46220 = maximum_layer([[[[[[0.1645], [0.5699]]], [[[0.0683], [0.5892]]]]], [[[[[0.9147], [0.442]]], [[[0.3916], [0.9222]]]]]], Max46220), 
LRes85870 = reshape_layer(Max46220, [2, 1, 2], Res85870), 
LRes20610 = reshape_layer(Res85870, [2, 2], Res20610), 
LZer26151 = zero_padding1D_layer(Res20610, 1, 1, Zer26151), 
exec_layers([LMax46220,LRes85870,LRes20610,LZer26151],["Max46220","Res85870","Res20610","Zer26151"],Zer26151,"Zer26151")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.9147000, 0.5699000], [0.3916000, 0.9222000], [0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0],[0.9147,0.5699],[0.3916,0.9222],[0,0]]]

Actual:   [[[0, 0], [0.9147, 0.5699], [0.3916, 0.9222], [0, 0]]]

Expected: [[[0, 0], [0.9147, 0.5699], [0.3916, 0.9222], [0, 0]]]