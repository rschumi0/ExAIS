import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro51895 = tf.keras.layers.Input(shape=([1, 4]))
in0Glo34444 = tf.keras.layers.Input(shape=([1, 2]))
in0Con80084 = tf.keras.layers.Input(shape=([2]))
in0Con58733 = tf.keras.layers.Input(shape=([4, 2]))
in0Dot22276 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot22276 = tf.keras.layers.Input(shape=([2, 3]))
in0Sep48860 = tf.keras.layers.Input(shape=([2, 2]))

Cro51895 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro51895', )(in0Cro51895)
Glo1936 = keras.layers.GlobalMaxPool1D(name = 'Glo1936', )(Cro51895)
Glo34444 = keras.layers.GlobalMaxPool1D(name = 'Glo34444', )(in0Glo34444)
Con80084 = keras.layers.Concatenate(axis=1, name = 'Con80084', )([Glo34444,in0Con80084])
Min70343 = keras.layers.Minimum(name = 'Min70343', )([Glo1936,Con80084])
Res28028 = keras.layers.Reshape((4, 1), name = 'Res28028', )(Min70343)
Con58733 = keras.layers.Concatenate(axis=2, name = 'Con58733', )([Res28028,in0Con58733])
Dot22276 = keras.layers.Dot(axes=(1, 1), name = 'Dot22276', )([in0Dot22276,in1Dot22276])
Sep48860 = keras.layers.SeparableConv1D(3, (2),strides=(2), padding='same', name = 'Sep48860', )(in0Sep48860)
Zer19018 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer19018', )(Sep48860)
Add72426 = keras.layers.Add(name = 'Add72426', )([Dot22276,Zer19018])
Zer40072 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer40072', )(Add72426)
Min56844 = keras.layers.Minimum(name = 'Min56844', )([Con58733,Zer40072])
Thr60625 = keras.layers.ThresholdedReLU(theta=4.994457712245279, name = 'Thr60625', )(Min56844)
model = tf.keras.models.Model(inputs=[in0Cro51895,in0Glo34444,in0Con80084,in0Con58733,in0Dot22276,in1Dot22276,in0Sep48860], outputs=Thr60625)
w = model.get_layer('Sep48860').get_weights() 
w[0] = np.array([[[0.7768], [0.477]], [[0.4588], [0.324]]])
w[1] = np.array([[[0.4903, 0.5144, 0.7227], [0.488, 0.1675, 0.8468]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep48860').set_weights(w) 
in0Cro51895 = tf.constant([[[1.9968, 1.8858, 1.4779, 1.3245]]])
in0Glo34444 = tf.constant([[[1.4388, 1.867]]])
in0Con80084 = tf.constant([[0.6604, 0.741]])
in0Con58733 = tf.constant([[[0.598, 0.0888], [0.747, 0.8353], [0.0144, 0.9536], [0.3171, 0.9509]]])
in0Dot22276 = tf.constant([[[0.3275, 0.4188, 0.2031], [0.2377, 0.5385, 0.1178]]])
in1Dot22276 = tf.constant([[[0.288, 0.2574, 0.2427], [0.3297, 0.5183, 0.3007]]])
in0Sep48860 = tf.constant([[[0.2639, 0.5314], [0.8363, 0.3219]]])
print (np.array2string(model.predict([in0Cro51895,in0Glo34444,in0Con80084,in0Con58733,in0Dot22276,in1Dot22276,in0Sep48860],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr60625.png')

LCro51895 = cropping1D_layer([[[1.9968, 1.8858, 1.4779, 1.3245]]], 0, 0, Cro51895), 
LGlo1936 = global_max_pool1D_layer(Cro51895, Glo1936), 
LGlo34444 = global_max_pool1D_layer([[[1.4388, 1.867]]], Glo34444), 
LCon80084 = concatenate_layer([Glo34444,[[0.6604, 0.741]]], 1, Con80084), 
LMin70343 = minimum_layer([Glo1936,Con80084], Min70343), 
LRes28028 = reshape_layer(Min70343, [4, 1], Res28028), 
LCon58733 = concatenate_layer([Res28028,[[[0.598, 0.0888], [0.747, 0.8353], [0.0144, 0.9536], [0.3171, 0.9509]]]], 2, Con58733), 
LDot22276 = dot_layer([[[0.3275, 0.4188, 0.2031], [0.2377, 0.5385, 0.1178]]], [[[0.288, 0.2574, 0.2427], [0.3297, 0.5183, 0.3007]]], 1, 1, Dot22276), 
LSep48860 = separable_conv1D_layer([[[0.2639, 0.5314], [0.8363, 0.3219]]], 2,[[[[0.7768], [0.477]], [[0.4588], [0.324]]],[[[0.4903, 0.5144, 0.7227], [0.488, 0.1675, 0.8468]]]],[0, 0, 0], 2, true, Sep48860), 
LZer19018 = zero_padding1D_layer(Sep48860, 2, 0, Zer19018), 
LAdd72426 = add_layer([Dot22276,Zer19018], Add72426), 
LZer40072 = zero_padding1D_layer(Add72426, 1, 0, Zer40072), 
LMin56844 = minimum_layer([Con58733,Zer40072], Min56844), 
LThr60625 = thresholded_relu_layer(Min56844, 4.994457712245279, Thr60625), 
exec_layers([LCro51895,LGlo1936,LGlo34444,LCon80084,LMin70343,LRes28028,LCon58733,LDot22276,LSep48860,LZer19018,LAdd72426,LZer40072,LMin56844,LThr60625],["Cro51895","Glo1936","Glo34444","Con80084","Min70343","Res28028","Con58733","Dot22276","Sep48860","Zer19018","Add72426","Zer40072","Min56844","Thr60625"],Thr60625,"Thr60625")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0],[0,0,0],[0,0,0],[0,0,0]]]

Actual:   [[[0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0]]]

Expected: [[[0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0]]]