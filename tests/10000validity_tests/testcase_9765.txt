import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_1511 = tf.keras.layers.Input(shape=([2, 1]))
in0Con76167 = tf.keras.layers.Input(shape=([1, 1, 3]))
in0Con96476 = tf.keras.layers.Input(shape=([1, 1, 1]))

Up_1511 = keras.layers.UpSampling1D(size=(2), name = 'Up_1511', )(in0Up_1511)
Glo29865 = keras.layers.GlobalAveragePooling1D(name = 'Glo29865', )(Up_1511)
Res72137 = keras.layers.Reshape((1, 1), name = 'Res72137', )(Glo29865)
Res95077 = keras.layers.Reshape((1, 1, 1), name = 'Res95077', )(Res72137)
Con76167 = keras.layers.Concatenate(axis=3, name = 'Con76167', )([Res95077,in0Con76167])
Con96476 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con96476', )(in0Con96476)
Max55727 = keras.layers.Maximum(name = 'Max55727', )([Con76167,Con96476])
Res26424 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res26424', )(Max55727)
Con86742 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con86742', )(Res26424)
model = tf.keras.models.Model(inputs=[in0Up_1511,in0Con76167,in0Con96476], outputs=Con86742)
w = model.get_layer('Con96476').get_weights() 
w[0] = np.array([[[[0.7134, 0.3655, 0.2066, 0.7175]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con96476').set_weights(w) 
w = model.get_layer('Con86742').get_weights() 
w[0] = np.array([[[[[0.9521, 0.2919, 0.8923]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con86742').set_weights(w) 
in0Up_1511 = tf.constant([[[1.7236], [1.4381]]])
in0Con76167 = tf.constant([[[[0.3408, 0.8924, 0.4244]]]])
in0Con96476 = tf.constant([[[[0.3832]]]])
print (np.array2string(model.predict([in0Up_1511,in0Con76167,in0Con96476],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con86742.png')

LUp_1511 = up_sampling1D_layer([[[1.7236], [1.4381]]], 2, Up_1511), 
LGlo29865 = global_average_pooling1D_layer(Up_1511, Glo29865), 
LRes72137 = reshape_layer(Glo29865, [1, 1], Res72137), 
LRes95077 = reshape_layer(Res72137, [1, 1, 1], Res95077), 
LCon76167 = concatenate_layer([Res95077,[[[[0.3408, 0.8924, 0.4244]]]]], 3, Con76167), 
LCon96476 = conv2D_layer([[[[0.3832]]]], 1, 1,[[[[0.7134, 0.3655, 0.2066, 0.7175]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con96476), 
LMax55727 = maximum_layer([Con76167,Con96476], Max55727), 
LRes26424 = reshape_layer(Max55727, [1, 1, 4, 1], Res26424), 
LCon86742 = conv3D_layer(Res26424, 1, 1, 1,[[[[[0.9521, 0.2919, 0.8923]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con86742), 
exec_layers([LUp_1511,LGlo29865,LRes72137,LRes95077,LCon76167,LCon96476,LMax55727,LRes26424,LCon86742],["Up_1511","Glo29865","Res72137","Res95077","Con76167","Con96476","Max55727","Res26424","Con86742"],Con86742,"Con86742")

Actual (Unparsed): [[[[[1.5051273, 0.4614501, 1.4105925], [0.3244757, 0.0994795, 0.3040958], [0.8496541, 0.2604916, 0.7962885], [0.4040712, 0.1238824, 0.3786921]]]]]

Expected (Unparsed): [[[[[1.5051272849999997,0.46145011499999994,1.4105924549999997],[0.32447568,0.09947952,0.30409584],[0.8496540399999999,0.26049156,0.7962885199999999],[0.40407124,0.12388236,0.37869211999999997]]]]]

Actual:   [[[[[1.5052, 0.4615, 1.4106], [0.3245, 0.0995, 0.3041], [0.8497, 0.2605, 0.7963], [0.4041, 0.1239, 0.3787]]]]]

Expected: [[[[[1.5052, 0.4615, 1.4106], [0.3245, 0.0995, 0.3041], [0.8497, 0.2605, 0.7963], [0.4041, 0.1239, 0.3787]]]]]