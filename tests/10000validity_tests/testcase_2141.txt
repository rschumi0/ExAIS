import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul57295 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Mul57295 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Cro89381 = tf.keras.layers.Input(shape=([4, 3, 1]))
in0Con50772 = tf.keras.layers.Input(shape=([1]))
in0GRU19254 = tf.keras.layers.Input(shape=([1, 1]))

Mul57295 = keras.layers.Multiply(name = 'Mul57295', )([in0Mul57295,in1Mul57295])
Glo24319 = keras.layers.GlobalAveragePooling3D(name = 'Glo24319', )(Mul57295)
Res71314 = keras.layers.Reshape((1, 1), name = 'Res71314', )(Glo24319)
Res20454 = keras.layers.Reshape((1, 1, 1), name = 'Res20454', )(Res71314)
Zer89089 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer89089', )(Res20454)
Cro89381 = keras.layers.Cropping2D(cropping=((3, 0), (1, 0)), name = 'Cro89381', )(in0Cro89381)
Sub25034 = keras.layers.Subtract(name = 'Sub25034', )([Zer89089,Cro89381])
Res15050 = keras.layers.Reshape((1, 2), name = 'Res15050', )(Sub25034)
Fla28721 = keras.layers.Flatten(name = 'Fla28721', )(Res15050)
Con50772 = keras.layers.Concatenate(axis=1, name = 'Con50772', )([Fla28721,in0Con50772])
GRU19254 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU19254', )(in0GRU19254)
Sub99370 = keras.layers.Subtract(name = 'Sub99370', )([Con50772,GRU19254])
model = tf.keras.models.Model(inputs=[in0Mul57295,in1Mul57295,in0Cro89381,in0Con50772,in0GRU19254], outputs=Sub99370)
w = model.get_layer('GRU19254').get_weights() 
w[0] = np.array([[9, 6, 8, 6, 7, 1, 3, 2, 8]])
w[1] = np.array([[1, 9, 3, 10, 8, 1, 7, 2, 2], [10, 10, 8, 10, 1, 9, 4, 3, 7], [9, 1, 10, 9, 3, 9, 3, 8, 9]])
w[2] = np.array([[10, 8, 3, 8, 9, 3, 10, 9, 6], [1, 10, 9, 9, 5, 5, 2, 2, 1]])
model.get_layer('GRU19254').set_weights(w) 
in0Mul57295 = tf.constant([[[[[0.8252]], [[0.6461]]]]])
in1Mul57295 = tf.constant([[[[[0.6333]], [[0.8972]]]]])
in0Cro89381 = tf.constant([[[[1.4758], [1.331], [1.3342]], [[1.9981], [1.0079], [1.2095]], [[1.1213], [1.6291], [1.9659]], [[1.9665], [1.894], [1.8505]]]])
in0Con50772 = tf.constant([[0.1564]])
in0GRU19254 = tf.constant([[[5]]])
print (np.array2string(model.predict([in0Mul57295,in1Mul57295,in0Cro89381,in0Con50772,in0GRU19254],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub99370.png')

LMul57295 = multiply_layer([[[[[[0.8252]], [[0.6461]]]]], [[[[[0.6333]], [[0.8972]]]]]], Mul57295), 
LGlo24319 = global_average_pooling3D_layer(Mul57295, Glo24319), 
LRes71314 = reshape_layer(Glo24319, [1, 1], Res71314), 
LRes20454 = reshape_layer(Res71314, [1, 1, 1], Res20454), 
LZer89089 = zero_padding2D_layer(Res20454, 0, 0, 1, 0, Zer89089), 
LCro89381 = cropping2D_layer([[[[1.4758], [1.331], [1.3342]], [[1.9981], [1.0079], [1.2095]], [[1.1213], [1.6291], [1.9659]], [[1.9665], [1.894], [1.8505]]]], 3, 0, 1, 0, Cro89381), 
LSub25034 = subtract_layer(Zer89089,Cro89381, Sub25034), 
LRes15050 = reshape_layer(Sub25034, [1, 2], Res15050), 
LFla28721 = flatten_layer(Res15050, Fla28721), 
LCon50772 = concatenate_layer([Fla28721,[[0.1564]]], 1, Con50772), 
LGRU19254 = gru_layer([[[5]]],[[9, 6, 8, 6, 7, 1, 3, 2, 8]],[[1, 9, 3, 10, 8, 1, 7, 2, 2], [10, 10, 8, 10, 1, 9, 4, 3, 7], [9, 1, 10, 9, 3, 9, 3, 8, 9]],[[10, 8, 3, 8, 9, 3, 10, 9, 6], [1, 10, 9, 9, 5, 5, 2, 2, 1]], true, GRU19254), 
LSub99370 = subtract_layer(Con50772,GRU19254, Sub99370), 
exec_layers([LMul57295,LGlo24319,LRes71314,LRes20454,LZer89089,LCro89381,LSub25034,LRes15050,LFla28721,LCon50772,LGRU19254,LSub99370],["Mul57295","Glo24319","Res71314","Res20454","Zer89089","Cro89381","Sub25034","Res15050","Fla28721","Con50772","GRU19254","Sub99370"],Sub99370,"Sub99370")

Actual (Unparsed): [[-1.8940001, -1.2993599, 0.1564000]]

Expected (Unparsed): [[-1.894,-1.29935996,0.1564]]

Actual:   [[-1.894, -1.2993, 0.1564]]

Expected: [[-1.894, -1.2993, 0.1564]]