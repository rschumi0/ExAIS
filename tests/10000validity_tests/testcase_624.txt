import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add53645 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Add53645 = tf.keras.layers.Input(shape=([1, 1, 2]))

Add53645 = keras.layers.Add(name = 'Add53645', )([in0Add53645,in1Add53645])
Res82459 = keras.layers.Reshape((1, 2), name = 'Res82459', )(Add53645)
Cro19233 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro19233', )(Res82459)
GRU53192 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU53192', )(Cro19233)
Res78925 = keras.layers.Reshape((3, 1), name = 'Res78925', )(GRU53192)
Res57523 = keras.layers.Reshape((3, 1, 1), name = 'Res57523', )(Res78925)
Max63491 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(1, 1), padding='valid', name = 'Max63491', )(Res57523)
model = tf.keras.models.Model(inputs=[in0Add53645,in1Add53645], outputs=Max63491)
w = model.get_layer('GRU53192').get_weights() 
w[0] = np.array([[6, 9, 3, 8, 2, 5, 8, 7, 1], [4, 4, 2, 5, 5, 5, 2, 10, 5]])
w[1] = np.array([[7, 10, 8, 6, 2, 2, 4, 7, 10], [4, 9, 9, 7, 8, 6, 10, 4, 9], [4, 10, 2, 3, 9, 7, 8, 5, 2]])
w[2] = np.array([[2, 3, 7, 9, 7, 5, 3, 3, 5], [5, 9, 8, 7, 1, 8, 8, 8, 1]])
model.get_layer('GRU53192').set_weights(w) 
in0Add53645 = tf.constant([[[[0.4324, 0.861]]]])
in1Add53645 = tf.constant([[[[0.6026, 0.7203]]]])
print (np.array2string(model.predict([in0Add53645,in1Add53645],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max63491.png')

LAdd53645 = add_layer([[[[[0.4324, 0.861]]]], [[[[0.6026, 0.7203]]]]], Add53645), 
LRes82459 = reshape_layer(Add53645, [1, 2], Res82459), 
LCro19233 = cropping1D_layer(Res82459, 0, 0, Cro19233), 
LGRU53192 = gru_layer(Cro19233,[[6, 9, 3, 8, 2, 5, 8, 7, 1], [4, 4, 2, 5, 5, 5, 2, 10, 5]],[[7, 10, 8, 6, 2, 2, 4, 7, 10], [4, 9, 9, 7, 8, 6, 10, 4, 9], [4, 10, 2, 3, 9, 7, 8, 5, 2]],[[2, 3, 7, 9, 7, 5, 3, 3, 5], [5, 9, 8, 7, 1, 8, 8, 8, 1]], true, GRU53192), 
LRes78925 = reshape_layer(GRU53192, [3, 1], Res78925), 
LRes57523 = reshape_layer(Res78925, [3, 1, 1], Res57523), 
LMax63491 = max_pool2D_layer(Res57523, 2, 1, 1, 1, false, Max63491), 
exec_layers([LAdd53645,LRes82459,LCro19233,LGRU53192,LRes78925,LRes57523,LMax63491],["Add53645","Res82459","Cro19233","GRU53192","Res78925","Res57523","Max63491"],Max63491,"Max63491")

Actual (Unparsed): [[[[0.0000000]], [[0.0000000]]]]

Expected (Unparsed): [[[[3.2807296879155956e-9]],[[5.802280877985511e-10]]]]

Actual:   [[[[0]], [[0]]]]

Expected: [[[[0]], [[0]]]]