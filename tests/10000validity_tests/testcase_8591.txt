import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max17946 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Max17946 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con90318 = tf.keras.layers.Input(shape=([2, 40, 1, 1]))
in0Cro15856 = tf.keras.layers.Input(shape=([3, 1, 3, 4]))
in0Con23691 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con51014 = tf.keras.layers.Input(shape=([2, 2, 3, 1]))

Max17946 = keras.layers.Maximum(name = 'Max17946', )([in0Max17946,in1Max17946])
Zer47151 = keras.layers.ZeroPadding3D(padding=((0, 0), (38, 0), (0, 0)), name = 'Zer47151', )(Max17946)
Con90318 = keras.layers.Concatenate(axis=4, name = 'Con90318', )([Zer47151,in0Con90318])
Cro15856 = keras.layers.Cropping3D(cropping=((2, 0), (0, 0), (0, 1)), name = 'Cro15856', )(in0Cro15856)
Zer40573 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer40573', )(Cro15856)
Con23691 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con23691', )(in0Con23691)
Zer4768 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer4768', )(Con23691)
Con51014 = keras.layers.Concatenate(axis=4, name = 'Con51014', )([Zer4768,in0Con51014])
Sub92378 = keras.layers.Subtract(name = 'Sub92378', )([Zer40573,Con51014])
Res47513 = keras.layers.Reshape((2, 2, 12), name = 'Res47513', )(Sub92378)
PRe33993 = keras.layers.PReLU(name = 'PRe33993', )(Res47513)
Res34473 = keras.layers.Reshape((2, 24), name = 'Res34473', )(PRe33993)
Per58324 = keras.layers.Permute((1,2), name = 'Per58324',)(Res34473)
Res44714 = keras.layers.Reshape((2, 24, 1), name = 'Res44714', )(Per58324)
Res52848 = keras.layers.Reshape((2, 24, 1, 1), name = 'Res52848', )(Res44714)
Con97960 = keras.layers.Conv3D(2, (2, 4, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con97960', )(Res52848)
Zer62305 = keras.layers.ZeroPadding3D(padding=((1, 0), (19, 0), (0, 0)), name = 'Zer62305', )(Con97960)
Sub12179 = keras.layers.Subtract(name = 'Sub12179', )([Con90318,Zer62305])
model = tf.keras.models.Model(inputs=[in0Max17946,in1Max17946,in0Con90318,in0Cro15856,in0Con23691,in0Con51014], outputs=Sub12179)
w = model.get_layer('Con23691').get_weights() 
w[0] = np.array([[[[[0.8926, 0.5439, 0.3055]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con23691').set_weights(w) 
w = model.get_layer('PRe33993').get_weights() 
w[0] = np.array([[[0.5057, 0.0469, 0.7284, 0.9984, 0.3348, 0.8677, 0.2453, 0.858, 0.6305, 0.1068, 0.5246, 0.8146], [0.5764, 0.8082, 0.315, 0.8226, 0.2258, 0.5486, 0.3308, 0.8014, 0.1677, 0.2917, 0.6267, 0.0518]], [[0.0212, 0.765, 0.7324, 0.1012, 0.4476, 0.7602, 0.2506, 0.7035, 0.9306, 0.0149, 0.8797, 0.8074], [0.7912, 0.4918, 0.2449, 0.7924, 0.7748, 0.9423, 0.4942, 0.1691, 0.0772, 0.6119, 0.3503, 0.2419]]])
model.get_layer('PRe33993').set_weights(w) 
w = model.get_layer('Con97960').get_weights() 
w[0] = np.array([[[[[0.6153, 0.0649]]], [[[0.7334, 0.6027]]], [[[0.8518, 0.2474]]], [[[0.8733, 0.5791]]]], [[[[0.9386, 0.5054]]], [[[0.7683, 0.2485]]], [[[0.9247, 0.5582]]], [[[0.0612, 0.1758]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con97960').set_weights(w) 
in0Max17946 = tf.constant([[[[[0.6446]], [[0.7817]]], [[[0.0642]], [[0.6227]]]]])
in1Max17946 = tf.constant([[[[[0.1282]], [[0.005]]], [[[0.7437]], [[0.7257]]]]])
in0Con90318 = tf.constant([[[[[0.6927]], [[0.4094]], [[0.1935]], [[0.0089]], [[0.0865]], [[0.5845]], [[0.838]], [[0.4786]], [[0.2766]], [[0.7845]], [[0.735]], [[0.748]], [[0.9199]], [[0.9823]], [[0.2726]], [[0.5669]], [[0.3304]], [[0.9011]], [[0.8147]], [[0.0054]], [[0.9482]], [[0.6554]], [[0.2703]], [[0.6205]], [[0.9796]], [[0.3531]], [[0.4244]], [[0.7205]], [[0.6828]], [[0.9484]], [[0.4874]], [[0.4724]], [[0.8406]], [[0.2091]], [[0.2151]], [[0.125]], [[0.9347]], [[0.3927]], [[0.2534]], [[0.8047]]], [[[0.4177]], [[0.1164]], [[0.0706]], [[0.1815]], [[0.262]], [[0.946]], [[0.9535]], [[0.801]], [[0.6608]], [[0.4319]], [[0.0634]], [[0.0309]], [[0.3522]], [[0.676]], [[0.4774]], [[0.3786]], [[0.5441]], [[0.0248]], [[0.47]], [[0.4057]], [[0.8273]], [[0.1557]], [[0.0325]], [[0.5836]], [[0.7826]], [[0.6451]], [[0.7707]], [[0.2154]], [[0.2112]], [[0.0917]], [[0.8743]], [[0.9819]], [[0.0468]], [[0.0036]], [[0.81]], [[0.7623]], [[0.0456]], [[0.9537]], [[0.753]], [[0.1258]]]]])
in0Cro15856 = tf.constant([[[[[1.1549, 1.2702, 1.4584, 1.177], [1.5803, 1.9193, 1.4828, 1.0442], [1.3647, 1.4616, 1.4384, 1.8513]]], [[[1.2155, 1.6562, 1.1802, 1.9701], [1.8959, 1.4643, 1.4328, 1.9037], [1.0669, 1.5871, 1.3394, 1.4453]]], [[[1.2241, 1.5027, 1.6093, 1.8467], [1.8887, 1.2745, 1.8734, 1.9435], [1.7176, 1.9135, 1.1936, 1.6473]]]]])
in0Con23691 = tf.constant([[[[[0.6074]], [[0.7486]]], [[[0.4088]], [[0.3393]]]]])
in0Con51014 = tf.constant([[[[[0.4443], [0.5266], [0.5529]], [[0.97], [0.7034], [0.7051]]], [[[0.5055], [0.9735], [0.7712]], [[0.6118], [0.0035], [0.6933]]]]])
print (np.array2string(model.predict([in0Max17946,in1Max17946,in0Con90318,in0Cro15856,in0Con23691,in0Con51014],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub12179.png')

LMax17946 = maximum_layer([[[[[[0.6446]], [[0.7817]]], [[[0.0642]], [[0.6227]]]]], [[[[[0.1282]], [[0.005]]], [[[0.7437]], [[0.7257]]]]]], Max17946), 
LZer47151 = zero_padding3D_layer(Max17946, 0, 0, 38, 0, 0, 0, Zer47151), 
LCon90318 = concatenate_layer([Zer47151,[[[[[0.6927]], [[0.4094]], [[0.1935]], [[0.0089]], [[0.0865]], [[0.5845]], [[0.838]], [[0.4786]], [[0.2766]], [[0.7845]], [[0.735]], [[0.748]], [[0.9199]], [[0.9823]], [[0.2726]], [[0.5669]], [[0.3304]], [[0.9011]], [[0.8147]], [[0.0054]], [[0.9482]], [[0.6554]], [[0.2703]], [[0.6205]], [[0.9796]], [[0.3531]], [[0.4244]], [[0.7205]], [[0.6828]], [[0.9484]], [[0.4874]], [[0.4724]], [[0.8406]], [[0.2091]], [[0.2151]], [[0.125]], [[0.9347]], [[0.3927]], [[0.2534]], [[0.8047]]], [[[0.4177]], [[0.1164]], [[0.0706]], [[0.1815]], [[0.262]], [[0.946]], [[0.9535]], [[0.801]], [[0.6608]], [[0.4319]], [[0.0634]], [[0.0309]], [[0.3522]], [[0.676]], [[0.4774]], [[0.3786]], [[0.5441]], [[0.0248]], [[0.47]], [[0.4057]], [[0.8273]], [[0.1557]], [[0.0325]], [[0.5836]], [[0.7826]], [[0.6451]], [[0.7707]], [[0.2154]], [[0.2112]], [[0.0917]], [[0.8743]], [[0.9819]], [[0.0468]], [[0.0036]], [[0.81]], [[0.7623]], [[0.0456]], [[0.9537]], [[0.753]], [[0.1258]]]]]], 4, Con90318), 
LCro15856 = cropping3D_layer([[[[[1.1549, 1.2702, 1.4584, 1.177], [1.5803, 1.9193, 1.4828, 1.0442], [1.3647, 1.4616, 1.4384, 1.8513]]], [[[1.2155, 1.6562, 1.1802, 1.9701], [1.8959, 1.4643, 1.4328, 1.9037], [1.0669, 1.5871, 1.3394, 1.4453]]], [[[1.2241, 1.5027, 1.6093, 1.8467], [1.8887, 1.2745, 1.8734, 1.9435], [1.7176, 1.9135, 1.1936, 1.6473]]]]], 2, 0, 0, 0, 0, 1, Cro15856), 
LZer40573 = zero_padding3D_layer(Cro15856, 1, 0, 1, 0, 1, 0, Zer40573), 
LCon23691 = conv3D_layer([[[[[0.6074]], [[0.7486]]], [[[0.4088]], [[0.3393]]]]], 1, 1, 1,[[[[[0.8926, 0.5439, 0.3055]]]]],[0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con23691), 
LZer4768 = zero_padding3D_layer(Con23691, 0, 0, 0, 0, 2, 0, Zer4768), 
LCon51014 = concatenate_layer([Zer4768,[[[[[0.4443], [0.5266], [0.5529]], [[0.97], [0.7034], [0.7051]]], [[[0.5055], [0.9735], [0.7712]], [[0.6118], [0.0035], [0.6933]]]]]], 4, Con51014), 
LSub92378 = subtract_layer(Zer40573,Con51014, Sub92378), 
LRes47513 = reshape_layer(Sub92378, [2, 2, 12], Res47513), 
LPRe33993 = prelu_layer(Res47513, [[[0.5057, 0.0469, 0.7284, 0.9984, 0.3348, 0.8677, 0.2453, 0.858, 0.6305, 0.1068, 0.5246, 0.8146], [0.5764, 0.8082, 0.315, 0.8226, 0.2258, 0.5486, 0.3308, 0.8014, 0.1677, 0.2917, 0.6267, 0.0518]], [[0.0212, 0.765, 0.7324, 0.1012, 0.4476, 0.7602, 0.2506, 0.7035, 0.9306, 0.0149, 0.8797, 0.8074], [0.7912, 0.4918, 0.2449, 0.7924, 0.7748, 0.9423, 0.4942, 0.1691, 0.0772, 0.6119, 0.3503, 0.2419]]], PRe33993), 
LRes34473 = reshape_layer(PRe33993, [2, 24], Res34473), 
LPer58324 = permute_layer(Res34473, 1,2, Per58324), 
LRes44714 = reshape_layer(Per58324, [2, 24, 1], Res44714), 
LRes52848 = reshape_layer(Res44714, [2, 24, 1, 1], Res52848), 
LCon97960 = conv3D_layer(Res52848, 2, 4, 1,[[[[[0.6153, 0.0649]]], [[[0.7334, 0.6027]]], [[[0.8518, 0.2474]]], [[[0.8733, 0.5791]]]], [[[[0.9386, 0.5054]]], [[[0.7683, 0.2485]]], [[[0.9247, 0.5582]]], [[[0.0612, 0.1758]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con97960), 
LZer62305 = zero_padding3D_layer(Con97960, 1, 0, 19, 0, 0, 0, Zer62305), 
LSub12179 = subtract_layer(Con90318,Zer62305, Sub12179), 
exec_layers([LMax17946,LZer47151,LCon90318,LCro15856,LZer40573,LCon23691,LZer4768,LCon51014,LSub92378,LRes47513,LPRe33993,LRes34473,LPer58324,LRes44714,LRes52848,LCon97960,LZer62305,LSub12179],["Max17946","Zer47151","Con90318","Cro15856","Zer40573","Con23691","Zer4768","Con51014","Sub92378","Res47513","PRe33993","Res34473","Per58324","Res44714","Res52848","Con97960","Zer62305","Sub12179"],Sub12179,"Sub12179")

Actual (Unparsed): [[[[[0.0000000, 0.6927000]], [[0.0000000, 0.4094000]], [[0.0000000, 0.1935000]], [[0.0000000, 0.0089000]], [[0.0000000, 0.0865000]], [[0.0000000, 0.5845000]], [[0.0000000, 0.8380000]], [[0.0000000, 0.4786000]], [[0.0000000, 0.2766000]], [[0.0000000, 0.7845000]], [[0.0000000, 0.7350000]], [[0.0000000, 0.7480000]], [[0.0000000, 0.9199000]], [[0.0000000, 0.9823000]], [[0.0000000, 0.2726000]], [[0.0000000, 0.5669000]], [[0.0000000, 0.3304000]], [[0.0000000, 0.9011000]], [[0.0000000, 0.8147000]], [[0.0000000, 0.0054000]], [[0.0000000, 0.9482000]], [[0.0000000, 0.6554000]], [[0.0000000, 0.2703000]], [[0.0000000, 0.6205000]], [[0.0000000, 0.9796000]], [[0.0000000, 0.3531000]], [[0.0000000, 0.4244000]], [[0.0000000, 0.7205000]], [[0.0000000, 0.6828000]], [[0.0000000, 0.9484000]], [[0.0000000, 0.4874000]], [[0.0000000, 0.4724000]], [[0.0000000, 0.8406000]], [[0.0000000, 0.2091000]], [[0.0000000, 0.2151000]], [[0.0000000, 0.1250000]], [[0.0000000, 0.9347000]], [[0.0000000, 0.3927000]], [[0.6446000, 0.2534000]], [[0.7817000, 0.8047000]]], [[[0.0000000, 0.4177000]], [[0.0000000, 0.1164000]], [[0.0000000, 0.0706000]], [[0.0000000, 0.1815000]], [[0.0000000, 0.2620000]], [[0.0000000, 0.9460000]], [[0.0000000, 0.9535000]], [[0.0000000, 0.8010000]], [[0.0000000, 0.6608000]], [[0.0000000, 0.4319000]], [[0.0000000, 0.0634000]], [[0.0000000, 0.0309000]], [[0.0000000, 0.3522000]], [[0.0000000, 0.6760000]], [[0.0000000, 0.4774000]], [[0.0000000, 0.3786000]], [[0.0000000, 0.5441000]], [[0.0000000, 0.0248000]], [[0.0000000, 0.4700000]], [[0.3905172, 0.6715758]], [[0.4251537, 0.9655996]], [[0.3646319, 0.4357636]], [[0.3209560, 0.0871435]], [[0.4364901, 0.9656485]], [[1.3374566, 1.5343216]], [[1.4937347, 1.3827341]], [[1.5572608, 1.5228227]], [[1.1734196, 0.8869892]], [[1.1400451, 0.7601352]], [[0.9717278, 0.5797273]], [[0.8615615, 1.2182263]], [[0.7264945, 1.5292028]], [[1.0530407, 0.2996191]], [[-0.2662301, -0.3424893]], [[-1.4825262, -0.3191127]], [[-3.4121048, -1.1256855]], [[-3.8702966, -2.2170878]], [[-3.8471589, -0.9582585]], [[-2.6655548, -1.2756642]], [[-3.0031419, -2.0187293]]]]]

Expected (Unparsed): [[[[[0,0.6927]],[[0,0.4094]],[[0,0.1935]],[[0,0.0089]],[[0,0.0865]],[[0,0.5845]],[[0,0.838]],[[0,0.4786]],[[0,0.2766]],[[0,0.7845]],[[0,0.735]],[[0,0.748]],[[0,0.9199]],[[0,0.9823]],[[0,0.2726]],[[0,0.5669]],[[0,0.3304]],[[0,0.9011]],[[0,0.8147]],[[0,0.0054]],[[0,0.9482]],[[0,0.6554]],[[0,0.2703]],[[0,0.6205]],[[0,0.9796]],[[0,0.3531]],[[0,0.4244]],[[0,0.7205]],[[0,0.6828]],[[0,0.9484]],[[0,0.4874]],[[0,0.4724]],[[0,0.8406]],[[0,0.2091]],[[0,0.2151]],[[0,0.125]],[[0,0.9347]],[[0,0.3927]],[[0.6446,0.2534]],[[0.7817,0.8047]]],[[[0,0.4177]],[[0,0.1164]],[[0,0.0706]],[[0,0.1815]],[[0,0.262]],[[0,0.946]],[[0,0.9535]],[[0,0.801]],[[0,0.6608]],[[0,0.4319]],[[0,0.0634]],[[0,0.0309]],[[0,0.3522]],[[0,0.676]],[[0,0.4774]],[[0,0.3786]],[[0,0.5441]],[[0,0.0248]],[[0,0.47]],[[0.39051716241599993,0.6715757896719999]],[[0.42515372043599997,0.965599562408]],[[0.364631876388,0.435763577724]],[[0.320955970296,0.087143479528]],[[0.43649011493999995,0.96564848803]],[[1.3374565820750797,1.5343216452428243]],[[1.4937347103839778,1.3827340673451887]],[[1.557260777400328,1.5228226774988607]],[[1.1734195474415363,0.8869891867958307]],[[1.1400451024901512,0.7601351546627964]],[[0.971727828578794,0.57972731289057]],[[0.86156154037,1.218226304018]],[[0.7264944501839999,1.529202768456]],[[1.053040648504,0.29961907942400007]],[[-0.2662301123439999,-0.34248929608000006]],[[-1.4825262790479998,-0.319112764472]],[[-3.412104853092,-1.125685483484]],[[-3.8702966405311323,-2.217087803796575]],[[-3.8471588857562304,-0.9582585189996833]],[[-2.6655548743077597,-1.275664234465621]],[[-3.003141908496529,-2.018729266734655]]]]]

Actual:   [[[[[0, 0.6927]], [[0, 0.4094]], [[0, 0.1935]], [[0, 0.0089]], [[0, 0.0865]], [[0, 0.5845]], [[0, 0.838]], [[0, 0.4786]], [[0, 0.2766]], [[0, 0.7845]], [[0, 0.735]], [[0, 0.748]], [[0, 0.9199]], [[0, 0.9823]], [[0, 0.2726]], [[0, 0.5669]], [[0, 0.3304]], [[0, 0.9011]], [[0, 0.8147]], [[0, 0.0054]], [[0, 0.9482]], [[0, 0.6554]], [[0, 0.2703]], [[0, 0.6205]], [[0, 0.9796]], [[0, 0.3531]], [[0, 0.4244]], [[0, 0.7205]], [[0, 0.6828]], [[0, 0.9484]], [[0, 0.4874]], [[0, 0.4724]], [[0, 0.8406]], [[0, 0.2091]], [[0, 0.2151]], [[0, 0.125]], [[0, 0.9347]], [[0, 0.3927]], [[0.6446, 0.2534]], [[0.7817, 0.8047]]], [[[0, 0.4177]], [[0, 0.1164]], [[0, 0.0706]], [[0, 0.1815]], [[0, 0.262]], [[0, 0.946]], [[0, 0.9535]], [[0, 0.801]], [[0, 0.6608]], [[0, 0.4319]], [[0, 0.0634]], [[0, 0.0309]], [[0, 0.3522]], [[0, 0.676]], [[0, 0.4774]], [[0, 0.3786]], [[0, 0.5441]], [[0, 0.0248]], [[0, 0.47]], [[0.3906, 0.6716]], [[0.4252, 0.9656]], [[0.3647, 0.4358]], [[0.321, 0.0872]], [[0.4365, 0.9657]], [[1.3375, 1.5344]], [[1.4938, 1.3828]], [[1.5573, 1.5229]], [[1.1735, 0.887]], [[1.1401, 0.7602]], [[0.9718, 0.5798]], [[0.8616, 1.2183]], [[0.7265, 1.5293]], [[1.0531, 0.2997]], [[-0.2662, -0.3424]], [[-1.4825, -0.3191]], [[-3.4121, -1.1256]], [[-3.8702, -2.217]], [[-3.8471, -0.9582]], [[-2.6655, -1.2756]], [[-3.0031, -2.0187]]]]]

Expected: [[[[[0, 0.6927]], [[0, 0.4094]], [[0, 0.1935]], [[0, 0.0089]], [[0, 0.0865]], [[0, 0.5845]], [[0, 0.838]], [[0, 0.4786]], [[0, 0.2766]], [[0, 0.7845]], [[0, 0.735]], [[0, 0.748]], [[0, 0.9199]], [[0, 0.9823]], [[0, 0.2726]], [[0, 0.5669]], [[0, 0.3304]], [[0, 0.9011]], [[0, 0.8147]], [[0, 0.0054]], [[0, 0.9482]], [[0, 0.6554]], [[0, 0.2703]], [[0, 0.6205]], [[0, 0.9796]], [[0, 0.3531]], [[0, 0.4244]], [[0, 0.7205]], [[0, 0.6828]], [[0, 0.9484]], [[0, 0.4874]], [[0, 0.4724]], [[0, 0.8406]], [[0, 0.2091]], [[0, 0.2151]], [[0, 0.125]], [[0, 0.9347]], [[0, 0.3927]], [[0.6446, 0.2534]], [[0.7817, 0.8047]]], [[[0, 0.4177]], [[0, 0.1164]], [[0, 0.0706]], [[0, 0.1815]], [[0, 0.262]], [[0, 0.946]], [[0, 0.9535]], [[0, 0.801]], [[0, 0.6608]], [[0, 0.4319]], [[0, 0.0634]], [[0, 0.0309]], [[0, 0.3522]], [[0, 0.676]], [[0, 0.4774]], [[0, 0.3786]], [[0, 0.5441]], [[0, 0.0248]], [[0, 0.47]], [[0.3906, 0.6716]], [[0.4252, 0.9656]], [[0.3647, 0.4358]], [[0.321, 0.0872]], [[0.4365, 0.9657]], [[1.3375, 1.5344]], [[1.4938, 1.3828]], [[1.5573, 1.5229]], [[1.1735, 0.887]], [[1.1401, 0.7602]], [[0.9718, 0.5798]], [[0.8616, 1.2183]], [[0.7265, 1.5293]], [[1.0531, 0.2997]], [[-0.2662, -0.3424]], [[-1.4825, -0.3191]], [[-3.4121, -1.1256]], [[-3.8702, -2.217]], [[-3.8471, -0.9582]], [[-2.6655, -1.2756]], [[-3.0031, -2.0187]]]]]