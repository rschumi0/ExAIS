import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max49825 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max49825 = tf.keras.layers.Input(shape=([2, 1, 2]))

Max49825 = keras.layers.Maximum(name = 'Max49825', )([in0Max49825,in1Max49825])
Res48431 = keras.layers.Reshape((2, 2), name = 'Res48431', )(Max49825)
LST95260 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST95260', )(Res48431)
Res17696 = keras.layers.Reshape((3, 1), name = 'Res17696', )(LST95260)
Max69359 = keras.layers.MaxPool1D(pool_size=(3), name = 'Max69359', )(Res17696)
Bat44293 = keras.layers.BatchNormalization(axis=2, epsilon=0.995866747805722,  name = 'Bat44293', )(Max69359)
model = tf.keras.models.Model(inputs=[in0Max49825,in1Max49825], outputs=Bat44293)
w = model.get_layer('LST95260').get_weights() 
w[0] = np.array([[4, 8, 8, 1, 9, 1, 3, 9, 10, 8, 5, 1], [9, 6, 6, 5, 7, 9, 5, 6, 8, 8, 5, 8]])
w[1] = np.array([[3, 6, 6, 6, 3, 8, 3, 4, 3, 6, 3, 3], [10, 7, 1, 6, 3, 6, 8, 4, 7, 6, 1, 3], [7, 10, 1, 10, 10, 7, 2, 2, 10, 2, 9, 2]])
w[2] = np.array([2, 2, 8, 1, 7, 3, 9, 3, 5, 4, 8, 10])
model.get_layer('LST95260').set_weights(w) 
w = model.get_layer('Bat44293').get_weights() 
w[0] = np.array([0.843])
w[1] = np.array([0.0142])
w[2] = np.array([0.2717])
w[3] = np.array([0.2273])
model.get_layer('Bat44293').set_weights(w) 
in0Max49825 = tf.constant([[[[0.231, 0.5776]], [[0.9393, 0.3354]]]])
in1Max49825 = tf.constant([[[[0.3099, 0.7685]], [[0.6881, 0.8046]]]])
print (np.array2string(model.predict([in0Max49825,in1Max49825],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat44293.png')

LMax49825 = maximum_layer([[[[[0.231, 0.5776]], [[0.9393, 0.3354]]]], [[[[0.3099, 0.7685]], [[0.6881, 0.8046]]]]], Max49825), 
LRes48431 = reshape_layer(Max49825, [2, 2], Res48431), 
LLST95260 = lstm_layer(Res48431,[[4, 8, 8, 1, 9, 1, 3, 9, 10, 8, 5, 1], [9, 6, 6, 5, 7, 9, 5, 6, 8, 8, 5, 8]],[[3, 6, 6, 6, 3, 8, 3, 4, 3, 6, 3, 3], [10, 7, 1, 6, 3, 6, 8, 4, 7, 6, 1, 3], [7, 10, 1, 10, 10, 7, 2, 2, 10, 2, 9, 2]],[2, 2, 8, 1, 7, 3, 9, 3, 5, 4, 8, 10], LST95260), 
LRes17696 = reshape_layer(LST95260, [3, 1], Res17696), 
LMax69359 = max_pool1D_layer(Res17696, 3, Max69359), 
LBat44293 = batch_normalization_layer(Max69359, 2, 0.995866747805722, [0.843], [0.0142], [0.2717], [0.2273], Bat44293), 
exec_layers([LMax49825,LRes48431,LLST95260,LRes17696,LMax69359,LBat44293],["Max49825","Res48431","LST95260","Res17696","Max69359","Bat44293"],Bat44293,"Bat44293")

Actual (Unparsed): [[[0.5419113]]]

Expected (Unparsed): [[[0.541911261174368]]]

Actual:   [[[0.542]]]

Expected: [[[0.542]]]