import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add22084 = tf.keras.layers.Input(shape=([1, 2]))
in1Add22084 = tf.keras.layers.Input(shape=([1, 2]))
in0Max63943 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Max63943 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con3325 = tf.keras.layers.Input(shape=([1]))

Add22084 = keras.layers.Add(name = 'Add22084', )([in0Add22084,in1Add22084])
Fla3574 = keras.layers.Flatten(name = 'Fla3574', )(Add22084)
Max63943 = keras.layers.Maximum(name = 'Max63943', )([in0Max63943,in1Max63943])
Res93722 = keras.layers.Reshape((2, 2, 2), name = 'Res93722', )(Max63943)
Res90337 = keras.layers.Reshape((2, 4), name = 'Res90337', )(Res93722)
Sim72093 = keras.layers.SimpleRNN(1,name = 'Sim72093', )(Res90337)
Con3325 = keras.layers.Concatenate(axis=1, name = 'Con3325', )([Sim72093,in0Con3325])
Mul64929 = keras.layers.Multiply(name = 'Mul64929', )([Fla3574,Con3325])
model = tf.keras.models.Model(inputs=[in0Add22084,in1Add22084,in0Max63943,in1Max63943,in0Con3325], outputs=Mul64929)
w = model.get_layer('Sim72093').get_weights() 
w[0] = np.array([[9], [2], [1], [3]])
w[1] = np.array([[9]])
w[2] = np.array([8])
model.get_layer('Sim72093').set_weights(w) 
in0Add22084 = tf.constant([[[0.0049, 0.0701]]])
in1Add22084 = tf.constant([[[0.1943, 0.6706]]])
in0Max63943 = tf.constant([[[[[0.0937], [0.1418]], [[0.8254], [0.6996]]], [[[0.9716], [0.1925]], [[0.6162], [0.5499]]]]])
in1Max63943 = tf.constant([[[[[0.5366], [0.7337]], [[0.6398], [0.5814]]], [[[0.332], [0.9378]], [[0.3134], [0.9327]]]]])
in0Con3325 = tf.constant([[0.3108]])
print (np.array2string(model.predict([in0Add22084,in1Add22084,in0Max63943,in1Max63943,in0Con3325],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul64929.png')

LAdd22084 = add_layer([[[[0.0049, 0.0701]]], [[[0.1943, 0.6706]]]], Add22084), 
LFla3574 = flatten_layer(Add22084, Fla3574), 
LMax63943 = maximum_layer([[[[[[0.0937], [0.1418]], [[0.8254], [0.6996]]], [[[0.9716], [0.1925]], [[0.6162], [0.5499]]]]], [[[[[0.5366], [0.7337]], [[0.6398], [0.5814]]], [[[0.332], [0.9378]], [[0.3134], [0.9327]]]]]], Max63943), 
LRes93722 = reshape_layer(Max63943, [2, 2, 2], Res93722), 
LRes90337 = reshape_layer(Res93722, [2, 4], Res90337), 
LSim72093 = simple_rnn_layer(Res90337,[[9], [2], [1], [3]],[[9]],[8], Sim72093), 
LCon3325 = concatenate_layer([Sim72093,[[0.3108]]], 1, Con3325), 
LMul64929 = multiply_layer([Fla3574,Con3325], Mul64929), 
exec_layers([LAdd22084,LFla3574,LMax63943,LRes93722,LRes90337,LSim72093,LCon3325,LMul64929],["Add22084","Fla3574","Max63943","Res93722","Res90337","Sim72093","Con3325","Mul64929"],Mul64929,"Mul64929")

Actual (Unparsed): [[0.1992000, 0.2302095]]

Expected (Unparsed): [[0.1992,0.23020955999999998]]

Actual:   [[0.1992, 0.2303]]

Expected: [[0.1992, 0.2303]]