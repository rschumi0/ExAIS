import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub14226 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub14226 = tf.keras.layers.Input(shape=([2, 3]))

Sub14226 = keras.layers.Subtract(name = 'Sub14226', )([in0Sub14226,in1Sub14226])
Res83533 = keras.layers.Reshape((2, 3, 1), name = 'Res83533', )(Sub14226)
Res5366 = keras.layers.Reshape((2, 3, 1, 1), name = 'Res5366', )(Res83533)
Con27411 = keras.layers.Conv3D(2, (2, 3, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con27411', )(Res5366)
Bat37694 = keras.layers.BatchNormalization(axis=2, epsilon=0.4447199662801632,  name = 'Bat37694', )(Con27411)
model = tf.keras.models.Model(inputs=[in0Sub14226,in1Sub14226], outputs=Bat37694)
w = model.get_layer('Con27411').get_weights() 
w[0] = np.array([[[[[0.123, 0.7626]]], [[[0.0272, 0.3885]]], [[[0.1518, 0.2082]]]], [[[[0.2058, 0.98]]], [[[0.2172, 0.4262]]], [[[0.4159, 0.8158]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con27411').set_weights(w) 
w = model.get_layer('Bat37694').get_weights() 
w[0] = np.array([0.4208, 0.8274, 0.4465])
w[1] = np.array([0.2482, 0.9823, 0.5884])
w[2] = np.array([0.3089, 0.2519, 0.101])
w[3] = np.array([0.5407, 0.5402, 0.2403])
model.get_layer('Bat37694').set_weights(w) 
in0Sub14226 = tf.constant([[[0.4584, 0.1778, 0.6192], [0.149, 0.0832, 0.4779]]])
in1Sub14226 = tf.constant([[[0.2622, 0.8099, 0.3785], [0.7315, 0.1457, 0.8232]]])
print (np.array2string(model.predict([in0Sub14226,in1Sub14226],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat37694.png')

LSub14226 = subtract_layer([[[0.4584, 0.1778, 0.6192], [0.149, 0.0832, 0.4779]]], [[[0.2622, 0.8099, 0.3785], [0.7315, 0.1457, 0.8232]]], Sub14226), 
LRes83533 = reshape_layer(Sub14226, [2, 3, 1], Res83533), 
LRes5366 = reshape_layer(Res83533, [2, 3, 1, 1], Res5366), 
LCon27411 = conv3D_layer(Res5366, 2, 3, 1,[[[[[0.123, 0.7626]]], [[[0.0272, 0.3885]]], [[[0.1518, 0.2082]]]], [[[[0.2058, 0.98]]], [[[0.2172, 0.4262]]], [[[0.4159, 0.8158]]]]],[0, 0], 1, 1, 1, true, 1, 1, 1, Con27411), 
LBat37694 = batch_normalization_layer(Con27411, 2, 0.4447199662801632, [0.4208, 0.8274, 0.4465], [0.2482, 0.9823, 0.5884], [0.3089, 0.2519, 0.101], [0.5407, 0.5402, 0.2403], Bat37694), 
exec_layers([LSub14226,LRes83533,LRes5366,LCon27411,LBat37694],["Sub14226","Res83533","Res5366","Con27411","Bat37694"],Bat37694,"Bat37694")

Actual (Unparsed): [[[[[0.0141941, -0.0330708]], [[0.5775454, 0.0010914]], [[0.4481030, 0.2118777]]], [[[0.1065187, 0.0158113]], [[0.6674377, 0.3217622]], [[0.5246992, 0.4358308]]]]]

Expected (Unparsed): [[[[[0.014194072135580715,-0.03307079904659502]],[[0.5775454092367994,0.0010914232147928304]],[[0.44810303288710873,0.2118777402156462]]],[[[0.10651873350139943,0.01581131607299971]],[[0.6674376877802704,0.3217621767994686]],[[0.5246991918427996,0.43583075741249155]]]]]

Actual:   [[[[[0.0142, -0.033]], [[0.5776, 0.0011]], [[0.4482, 0.2119]]], [[[0.1066, 0.0159]], [[0.6675, 0.3218]], [[0.5247, 0.4359]]]]]

Expected: [[[[[0.0142, -0.033]], [[0.5776, 0.0011]], [[0.4482, 0.2119]]], [[[0.1066, 0.0159]], [[0.6675, 0.3218]], [[0.5247, 0.4359]]]]]