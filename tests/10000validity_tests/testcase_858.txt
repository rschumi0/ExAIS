import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe45238 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Dot65727 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot65727 = tf.keras.layers.Input(shape=([2, 3]))
in0Glo19303 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con18059 = tf.keras.layers.Input(shape=([3]))
in0Con80660 = tf.keras.layers.Input(shape=([4]))

PRe45238 = keras.layers.PReLU(name = 'PRe45238', input_shape=(2, 2, 2, 1))(in0PRe45238)
Res43321 = keras.layers.Reshape((2, 2, 2), name = 'Res43321', )(PRe45238)
Res80282 = keras.layers.Reshape((2, 4), name = 'Res80282', )(Res43321)
Fla15191 = keras.layers.Flatten(name = 'Fla15191', )(Res80282)
Dot65727 = keras.layers.Dot(axes=(2, 2), name = 'Dot65727', )([in0Dot65727,in1Dot65727])
Fla92360 = keras.layers.Flatten(name = 'Fla92360', )(Dot65727)
Glo19303 = keras.layers.GlobalAveragePooling2D(name = 'Glo19303', )(in0Glo19303)
Con18059 = keras.layers.Concatenate(axis=1, name = 'Con18059', )([Glo19303,in0Con18059])
Ave2085 = keras.layers.Average(name = 'Ave2085', )([Fla92360,Con18059])
Con80660 = keras.layers.Concatenate(axis=1, name = 'Con80660', )([Ave2085,in0Con80660])
Max93626 = keras.layers.Maximum(name = 'Max93626', )([Fla15191,Con80660])
model = tf.keras.models.Model(inputs=[in0PRe45238,in0Dot65727,in1Dot65727,in0Glo19303,in0Con18059,in0Con80660], outputs=Max93626)
w = model.get_layer('PRe45238').get_weights() 
w[0] = np.array([[[[0.4063], [0.4966]], [[0.3794], [0.9426]]], [[[0.8106], [0.3422]], [[0.6518], [0.269]]]])
model.get_layer('PRe45238').set_weights(w) 
in0PRe45238 = tf.constant([[[[[0.4163], [0.9574]], [[0.0375], [0.9717]]], [[[0.7281], [0.6849]], [[0.5407], [0.7413]]]]])
in0Dot65727 = tf.constant([[[0.5423, 0.1093, 0.3641], [0.7428, 0.5199, 0.6631]]])
in1Dot65727 = tf.constant([[[0.5222, 0.1925, 0.975], [0.3916, 0.6743, 0.5056]]])
in0Glo19303 = tf.constant([[[[1.6116]]]])
in0Con18059 = tf.constant([[0.029, 0.9889, 0.2442]])
in0Con80660 = tf.constant([[0.3623, 0.4081, 0.602, 0.5277]])
print (np.array2string(model.predict([in0PRe45238,in0Dot65727,in1Dot65727,in0Glo19303,in0Con18059,in0Con80660],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max93626.png')

LPRe45238 = prelu_layer([[[[[0.4163], [0.9574]], [[0.0375], [0.9717]]], [[[0.7281], [0.6849]], [[0.5407], [0.7413]]]]], [[[[0.4063], [0.4966]], [[0.3794], [0.9426]]], [[[0.8106], [0.3422]], [[0.6518], [0.269]]]], PRe45238), 
LRes43321 = reshape_layer(PRe45238, [2, 2, 2], Res43321), 
LRes80282 = reshape_layer(Res43321, [2, 4], Res80282), 
LFla15191 = flatten_layer(Res80282, Fla15191), 
LDot65727 = dot_layer([[[0.5423, 0.1093, 0.3641], [0.7428, 0.5199, 0.6631]]], [[[0.5222, 0.1925, 0.975], [0.3916, 0.6743, 0.5056]]], 2, 2, Dot65727), 
LFla92360 = flatten_layer(Dot65727, Fla92360), 
LGlo19303 = global_average_pooling2D_layer([[[[1.6116]]]], Glo19303), 
LCon18059 = concatenate_layer([Glo19303,[[0.029, 0.9889, 0.2442]]], 1, Con18059), 
LAve2085 = average_layer([Fla92360,Con18059], Ave2085), 
LCon80660 = concatenate_layer([Ave2085,[[0.3623, 0.4081, 0.602, 0.5277]]], 1, Con80660), 
LMax93626 = maximum_layer([Fla15191,Con80660], Max93626), 
exec_layers([LPRe45238,LRes43321,LRes80282,LFla15191,LDot65727,LFla92360,LGlo19303,LCon18059,LAve2085,LCon80660,LMax93626],["PRe45238","Res43321","Res80282","Fla15191","Dot65727","Fla92360","Glo19303","Con18059","Ave2085","Con80660","Max93626"],Max93626,"Max93626")

Actual (Unparsed): [[1.1354134, 0.9574000, 1.0616967, 0.9717000, 0.7281000, 0.6849000, 0.6020000, 0.7413000]]

Expected (Unparsed): [[1.135413405,0.9574,1.061696705,0.9717,0.7281,0.6849,0.602,0.7413]]

Actual:   [[1.1355, 0.9574, 1.0617, 0.9717, 0.7281, 0.6849, 0.602, 0.7413]]

Expected: [[1.1355, 0.9574, 1.0617, 0.9717, 0.7281, 0.6849, 0.602, 0.7413]]