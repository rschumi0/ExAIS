import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave39925 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave39925 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Min23538 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min23538 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Ave39925 = keras.layers.Average(name = 'Ave39925', )([in0Ave39925,in1Ave39925])
Res17827 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res17827', )(Ave39925)
Con96982 = keras.layers.Conv3D(2, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con96982', )(Res17827)
Res47026 = keras.layers.Reshape((1, 1, 2), name = 'Res47026', )(Con96982)
Res52390 = keras.layers.Reshape((1, 2), name = 'Res52390', )(Res47026)
Min23538 = keras.layers.Minimum(name = 'Min23538', )([in0Min23538,in1Min23538])
Res18559 = keras.layers.Reshape((2, 1, 2), name = 'Res18559', )(Min23538)
Res55054 = keras.layers.Reshape((2, 2), name = 'Res55054', )(Res18559)
Zer87572 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer87572', )(Res55054)
Dot28982 = keras.layers.Dot(axes=(2, 2), name = 'Dot28982', )([Res52390,Zer87572])
Thr64633 = keras.layers.ThresholdedReLU(theta=6.8570052911793065, name = 'Thr64633', )(Dot28982)
model = tf.keras.models.Model(inputs=[in0Ave39925,in1Ave39925,in0Min23538,in1Min23538], outputs=Thr64633)
w = model.get_layer('Con96982').get_weights() 
w[0] = np.array([[[[[0.2763, 0.5462]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con96982').set_weights(w) 
in0Ave39925 = tf.constant([[[[0.1167]]]])
in1Ave39925 = tf.constant([[[[0.0998]]]])
in0Min23538 = tf.constant([[[[[0.2465], [0.7842]]], [[[0.2017], [0.1303]]]]])
in1Min23538 = tf.constant([[[[[0.2], [0.7617]]], [[[0.523], [0.0113]]]]])
print (np.array2string(model.predict([in0Ave39925,in1Ave39925,in0Min23538,in1Min23538],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr64633.png')

LAve39925 = average_layer([[[[[0.1167]]]], [[[[0.0998]]]]], Ave39925), 
LRes17827 = reshape_layer(Ave39925, [1, 1, 1, 1], Res17827), 
LCon96982 = conv3D_layer(Res17827, 1, 1, 1,[[[[[0.2763, 0.5462]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con96982), 
LRes47026 = reshape_layer(Con96982, [1, 1, 2], Res47026), 
LRes52390 = reshape_layer(Res47026, [1, 2], Res52390), 
LMin23538 = minimum_layer([[[[[[0.2465], [0.7842]]], [[[0.2017], [0.1303]]]]], [[[[[0.2], [0.7617]]], [[[0.523], [0.0113]]]]]], Min23538), 
LRes18559 = reshape_layer(Min23538, [2, 1, 2], Res18559), 
LRes55054 = reshape_layer(Res18559, [2, 2], Res55054), 
LZer87572 = zero_padding1D_layer(Res55054, 1, 0, Zer87572), 
LDot28982 = dot_layer(Res52390,Zer87572, 2, 2, Dot28982), 
LThr64633 = thresholded_relu_layer(Dot28982, 6.8570052911793065, Thr64633), 
exec_layers([LAve39925,LRes17827,LCon96982,LRes47026,LRes52390,LMin23538,LRes18559,LRes55054,LZer87572,LDot28982,LThr64633],["Ave39925","Res17827","Con96982","Res47026","Res52390","Min23538","Res18559","Res55054","Zer87572","Dot28982","Thr64633"],Thr64633,"Thr64633")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0]]]

Actual:   [[[0, 0, 0]]]

Expected: [[[0, 0, 0]]]