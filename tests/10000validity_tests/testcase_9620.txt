import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con54455 = tf.keras.layers.Input(shape=([2, 2]))
in0Con90198 = tf.keras.layers.Input(shape=([1, 3, 2]))
in0Max46052 = tf.keras.layers.Input(shape=([1, 2]))
in1Max46052 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul52351 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul52351 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con20968 = tf.keras.layers.Input(shape=([1, 3, 1]))
in0Dep85846 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Min68370 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min68370 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con54031 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con78460 = tf.keras.layers.Input(shape=([2, 5, 1]))

Con54455 = keras.layers.Conv1D(3, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con54455', )(in0Con54455)
Res63672 = keras.layers.Reshape((1, 3, 1), name = 'Res63672', )(Con54455)
Con90198 = keras.layers.Concatenate(axis=3, name = 'Con90198', )([Res63672,in0Con90198])
Max46052 = keras.layers.Maximum(name = 'Max46052', )([in0Max46052,in1Max46052])
Res47921 = keras.layers.Reshape((1, 2, 1), name = 'Res47921', )(Max46052)
Loc23830 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc23830', )(Res47921)
Zer11556 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer11556', )(Loc23830)
Sub22427 = keras.layers.Subtract(name = 'Sub22427', )([Con90198,Zer11556])
Mul52351 = keras.layers.Multiply(name = 'Mul52351', )([in0Mul52351,in1Mul52351])
Zer48722 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer48722', )(Mul52351)
Con20968 = keras.layers.Concatenate(axis=3, name = 'Con20968', )([Zer48722,in0Con20968])
Min16310 = keras.layers.Minimum(name = 'Min16310', )([Sub22427,Con20968])
Zer46710 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer46710', )(Min16310)
Dep85846 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep85846', )(in0Dep85846)
Zer90905 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer90905', )(Dep85846)
Min68370 = keras.layers.Minimum(name = 'Min68370', )([in0Min68370,in1Min68370])
Con54031 = keras.layers.Concatenate(axis=3, name = 'Con54031', )([Min68370,in0Con54031])
Max79496 = keras.layers.Maximum(name = 'Max79496', )([Zer90905,Con54031])
Zer36113 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer36113', )(Max79496)
Con78460 = keras.layers.Concatenate(axis=3, name = 'Con78460', )([Zer36113,in0Con78460])
Mul45918 = keras.layers.Multiply(name = 'Mul45918', )([Zer46710,Con78460])
model = tf.keras.models.Model(inputs=[in0Con54455,in0Con90198,in0Max46052,in1Max46052,in0Mul52351,in1Mul52351,in0Con20968,in0Dep85846,in0Min68370,in1Min68370,in0Con54031,in0Con78460], outputs=Mul45918)
w = model.get_layer('Con54455').get_weights() 
w[0] = np.array([[[0.0972, 0.728, 0.5917], [0.1646, 0.8082, 0.1372]], [[0.0836, 0.5997, 0.504], [0.2071, 0.7321, 0.7048]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con54455').set_weights(w) 
w = model.get_layer('Loc23830').get_weights() 
w[0] = np.array([[[0.7449, 0.0775, 0.123]], [[0.5076, 0.5886, 0.7728]]])
w[1] = np.array([[[0, 0, 0], [0, 0, 0]]])
model.get_layer('Loc23830').set_weights(w) 
w = model.get_layer('Dep85846').get_weights() 
w[0] = np.array([[[[0.4741], [0.6464]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep85846').set_weights(w) 
in0Con54455 = tf.constant([[[0.7281, 0.2351], [0.2126, 0.5532]]])
in0Con90198 = tf.constant([[[[0.6777, 0.5996], [0.4566, 0.8499], [0.6847, 0.6409]]]])
in0Max46052 = tf.constant([[[0.7735, 0.4555]]])
in1Max46052 = tf.constant([[[0.4893, 0.6055]]])
in0Mul52351 = tf.constant([[[[0.3823, 0.7112]]]])
in1Mul52351 = tf.constant([[[[0.9547, 0.9451]]]])
in0Con20968 = tf.constant([[[[0.9129], [0.7349], [0.8403]]]])
in0Dep85846 = tf.constant([[[[0.3305, 0.2911]]]])
in0Min68370 = tf.constant([[[[0.2553]], [[0.1345]]]])
in1Min68370 = tf.constant([[[[0.8055]], [[0.1185]]]])
in0Con54031 = tf.constant([[[[0.6793]], [[0.0906]]]])
in0Con78460 = tf.constant([[[[0.7288], [0.4556], [0.8338], [0.1593], [0.4262]], [[0.5226], [0.7446], [0.5437], [0.5778], [0.4605]]]])
print (np.array2string(model.predict([in0Con54455,in0Con90198,in0Max46052,in1Max46052,in0Mul52351,in1Mul52351,in0Con20968,in0Dep85846,in0Min68370,in1Min68370,in0Con54031,in0Con78460],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul45918.png')

LCon54455 = conv1D_layer([[[0.7281, 0.2351], [0.2126, 0.5532]]], 2,[[[0.0972, 0.728, 0.5917], [0.1646, 0.8082, 0.1372]], [[0.0836, 0.5997, 0.504], [0.2071, 0.7321, 0.7048]]],[0, 0, 0], 1, false, 1, Con54455), 
LRes63672 = reshape_layer(Con54455, [1, 3, 1], Res63672), 
LCon90198 = concatenate_layer([Res63672,[[[[0.6777, 0.5996], [0.4566, 0.8499], [0.6847, 0.6409]]]]], 3, Con90198), 
LMax46052 = maximum_layer([[[[0.7735, 0.4555]]], [[[0.4893, 0.6055]]]], Max46052), 
LRes47921 = reshape_layer(Max46052, [1, 2, 1], Res47921), 
LLoc23830 = locally_connected2D_layer(Res47921, 1, 1,[[[0.7449, 0.0775, 0.123]], [[0.5076, 0.5886, 0.7728]]],[[[0, 0, 0], [0, 0, 0]]], 1, 1, Loc23830), 
LZer11556 = zero_padding2D_layer(Loc23830, 0, 0, 1, 0, Zer11556), 
LSub22427 = subtract_layer(Con90198,Zer11556, Sub22427), 
LMul52351 = multiply_layer([[[[[0.3823, 0.7112]]]], [[[[0.9547, 0.9451]]]]], Mul52351), 
LZer48722 = zero_padding2D_layer(Mul52351, 0, 0, 2, 0, Zer48722), 
LCon20968 = concatenate_layer([Zer48722,[[[[0.9129], [0.7349], [0.8403]]]]], 3, Con20968), 
LMin16310 = minimum_layer([Sub22427,Con20968], Min16310), 
LZer46710 = zero_padding2D_layer(Min16310, 1, 0, 2, 0, Zer46710), 
LDep85846 = depthwise_conv2D_layer([[[[0.3305, 0.2911]]]], 1, 1,[[[[0.4741], [0.6464]]]],[0, 0], 1, 1, true, Dep85846), 
LZer90905 = zero_padding2D_layer(Dep85846, 1, 0, 0, 0, Zer90905), 
LMin68370 = minimum_layer([[[[[0.2553]], [[0.1345]]]], [[[[0.8055]], [[0.1185]]]]], Min68370), 
LCon54031 = concatenate_layer([Min68370,[[[[0.6793]], [[0.0906]]]]], 3, Con54031), 
LMax79496 = maximum_layer([Zer90905,Con54031], Max79496), 
LZer36113 = zero_padding2D_layer(Max79496, 0, 0, 4, 0, Zer36113), 
LCon78460 = concatenate_layer([Zer36113,[[[[0.7288], [0.4556], [0.8338], [0.1593], [0.4262]], [[0.5226], [0.7446], [0.5437], [0.5778], [0.4605]]]]], 3, Con78460), 
LMul45918 = multiply_layer([Zer46710,Con78460], Mul45918), 
exec_layers([LCon54455,LRes63672,LCon90198,LMax46052,LRes47921,LLoc23830,LZer11556,LSub22427,LMul52351,LZer48722,LCon20968,LMin16310,LZer46710,LDep85846,LZer90905,LMin68370,LCon54031,LMax79496,LZer36113,LCon78460,LMul45918],["Con54455","Res63672","Con90198","Max46052","Res47921","Loc23830","Zer11556","Sub22427","Mul52351","Zer48722","Con20968","Min16310","Zer46710","Dep85846","Zer90905","Min68370","Con54031","Max79496","Zer36113","Con78460","Mul45918"],Mul45918,"Mul45918")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.3260025], [0.0000000, 0.0000000, 0.4246252], [0.0571890, 0.0617758, 0.0796525]]]]

Expected (Unparsed): [[[[0,0,0.0],[0,0,0.0],[0,0,0.0],[0,0,0.0],[0.0,0.0,0.0]],[[0,0,0.0],[0,0,0.0],[0,0,0.32600251999999996],[0,0,0.42462521999999997],[0.0571890180579905,0.06177574728300799,0.07965250079999998]]]]

Actual:   [[[[0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0.3261], [0, 0, 0.4247], [0.0572, 0.0618, 0.0797]]]]

Expected: [[[[0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0.3261], [0, 0, 0.4247], [0.0572, 0.0618, 0.0797]]]]