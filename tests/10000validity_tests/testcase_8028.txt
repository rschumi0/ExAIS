import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof51 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Min27039 = tf.keras.layers.Input(shape=([1, 1]))
in1Min27039 = tf.keras.layers.Input(shape=([1, 1]))
in0Con81370 = tf.keras.layers.Input(shape=([3]))

Sof51 = keras.layers.Softmax(axis=1, name = 'Sof51', input_shape=(2, 1, 2))(in0Sof51)
Res70630 = keras.layers.Reshape((2, 2), name = 'Res70630', )(Sof51)
Con86584 = keras.layers.Conv1D(2, (2),strides=(1), padding='same', dilation_rate=(1), name = 'Con86584', )(Res70630)
Fla57118 = keras.layers.Flatten(name = 'Fla57118', )(Con86584)
Min27039 = keras.layers.Minimum(name = 'Min27039', )([in0Min27039,in1Min27039])
Res79081 = keras.layers.Reshape((1, 1, 1), name = 'Res79081', )(Min27039)
Res24021 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res24021', )(Res79081)
Glo26809 = keras.layers.GlobalAveragePooling3D(name = 'Glo26809', )(Res24021)
Con81370 = keras.layers.Concatenate(axis=1, name = 'Con81370', )([Glo26809,in0Con81370])
Max39239 = keras.layers.Maximum(name = 'Max39239', )([Fla57118,Con81370])
Res48940 = keras.layers.Reshape((4, 1), name = 'Res48940', )(Max39239)
Up_3849 = keras.layers.UpSampling1D(size=(2), name = 'Up_3849', )(Res48940)
Thr19074 = keras.layers.ThresholdedReLU(theta=9.741270623911431, name = 'Thr19074', )(Up_3849)
model = tf.keras.models.Model(inputs=[in0Sof51,in0Min27039,in1Min27039,in0Con81370], outputs=Thr19074)
w = model.get_layer('Con86584').get_weights() 
w[0] = np.array([[[0.7415, 0.7047], [0.4197, 0.3402]], [[0.5519, 0.4113], [0.2235, 0.7186]]])
w[1] = np.array([0, 0])
model.get_layer('Con86584').set_weights(w) 
in0Sof51 = tf.constant([[[[0.2165, 0.1379]], [[0.6, 0.5298]]]])
in0Min27039 = tf.constant([[[0.5291]]])
in1Min27039 = tf.constant([[[0.6879]]])
in0Con81370 = tf.constant([[0.6017, 0.331, 0.3988]])
print (np.array2string(model.predict([in0Sof51,in0Min27039,in1Min27039,in0Con81370],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr19074.png')

LSof51 = softmax_layer([[[[0.2165, 0.1379]], [[0.6, 0.5298]]]], 1, Sof51), 
LRes70630 = reshape_layer(Sof51, [2, 2], Res70630), 
LCon86584 = conv1D_layer(Res70630, 2,[[[0.7415, 0.7047], [0.4197, 0.3402]], [[0.5519, 0.4113], [0.2235, 0.7186]]],[0, 0], 1, true, 1, Con86584), 
LFla57118 = flatten_layer(Con86584, Fla57118), 
LMin27039 = minimum_layer([[[[0.5291]]], [[[0.6879]]]], Min27039), 
LRes79081 = reshape_layer(Min27039, [1, 1, 1], Res79081), 
LRes24021 = reshape_layer(Res79081, [1, 1, 1, 1], Res24021), 
LGlo26809 = global_average_pooling3D_layer(Res24021, Glo26809), 
LCon81370 = concatenate_layer([Glo26809,[[0.6017, 0.331, 0.3988]]], 1, Con81370), 
LMax39239 = maximum_layer([Fla57118,Con81370], Max39239), 
LRes48940 = reshape_layer(Max39239, [4, 1], Res48940), 
LUp_3849 = up_sampling1D_layer(Res48940, 2, Up_3849), 
LThr19074 = thresholded_relu_layer(Up_3849, 9.741270623911431, Thr19074), 
exec_layers([LSof51,LRes70630,LCon86584,LFla57118,LMin27039,LRes79081,LRes24021,LGlo26809,LCon81370,LMax39239,LRes48940,LUp_3849,LThr19074],["Sof51","Res70630","Con86584","Fla57118","Min27039","Res79081","Res24021","Glo26809","Con81370","Max39239","Res48940","Up_3849","Thr19074"],Thr19074,"Thr19074")

Actual (Unparsed): [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]]

Expected (Unparsed): [[[0],[0],[0],[0],[0],[0],[0],[0]]]

Actual:   [[[0], [0], [0], [0], [0], [0], [0], [0]]]

Expected: [[[0], [0], [0], [0], [0], [0], [0], [0]]]