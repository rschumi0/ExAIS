import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot97068 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot97068 = tf.keras.layers.Input(shape=([3, 2]))
in0Con72729 = tf.keras.layers.Input(shape=([3, 3, 1, 1]))
in0Min39871 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Min39871 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Dot97068 = keras.layers.Dot(axes=(2, 2), name = 'Dot97068', )([in0Dot97068,in1Dot97068])
Max7448 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='valid', name = 'Max7448', )(Dot97068)
Res7367 = keras.layers.Reshape((3, 3, 1), name = 'Res7367', )(Max7448)
Res73848 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res73848', )(Res7367)
Con72729 = keras.layers.Concatenate(axis=4, name = 'Con72729', )([Res73848,in0Con72729])
Min39871 = keras.layers.Minimum(name = 'Min39871', )([in0Min39871,in1Min39871])
Zer99836 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer99836', )(Min39871)
Ave3262 = keras.layers.Average(name = 'Ave3262', )([Con72729,Zer99836])
Res86536 = keras.layers.Reshape((3, 3, 2), name = 'Res86536', )(Ave3262)
Cro6030 = keras.layers.Cropping2D(cropping=((2, 0), (2, 0)), name = 'Cro6030', )(Res86536)
model = tf.keras.models.Model(inputs=[in0Dot97068,in1Dot97068,in0Con72729,in0Min39871,in1Min39871], outputs=Cro6030)
in0Dot97068 = tf.constant([[[0.3856, 0.9387], [0.2949, 0.2925], [0.5173, 0.6859]]])
in1Dot97068 = tf.constant([[[0.4756, 0.8328], [0.8093, 0.413], [0.1861, 0.6168]]])
in0Con72729 = tf.constant([[[[[0.1081]], [[0.1765]], [[0.0366]]], [[[0.602]], [[0.6824]], [[0.4136]]], [[[0.6441]], [[0.5072]], [[0.3702]]]]])
in0Min39871 = tf.constant([[[[[0.9095, 0.9486]], [[0.341, 0.9015]]], [[[0.8488, 0.8233]], [[0.8669, 0.5825]]]]])
in1Min39871 = tf.constant([[[[[0.6529, 0.7902]], [[0.376, 0.6776]]], [[[0.3425, 0.9631]], [[0.0542, 0.4022]]]]])
print (np.array2string(model.predict([in0Dot97068,in1Dot97068,in0Con72729,in0Min39871,in1Min39871],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro6030.png')

LDot97068 = dot_layer([[[0.3856, 0.9387], [0.2949, 0.2925], [0.5173, 0.6859]]], [[[0.4756, 0.8328], [0.8093, 0.413], [0.1861, 0.6168]]], 2, 2, Dot97068), 
LMax7448 = max_pool1D_layer(Dot97068, 1, 1, false, Max7448), 
LRes7367 = reshape_layer(Max7448, [3, 3, 1], Res7367), 
LRes73848 = reshape_layer(Res7367, [3, 3, 1, 1], Res73848), 
LCon72729 = concatenate_layer([Res73848,[[[[[0.1081]], [[0.1765]], [[0.0366]]], [[[0.602]], [[0.6824]], [[0.4136]]], [[[0.6441]], [[0.5072]], [[0.3702]]]]]], 4, Con72729), 
LMin39871 = minimum_layer([[[[[[0.9095, 0.9486]], [[0.341, 0.9015]]], [[[0.8488, 0.8233]], [[0.8669, 0.5825]]]]], [[[[[0.6529, 0.7902]], [[0.376, 0.6776]]], [[[0.3425, 0.9631]], [[0.0542, 0.4022]]]]]], Min39871), 
LZer99836 = zero_padding3D_layer(Min39871, 1, 0, 1, 0, 0, 0, Zer99836), 
LAve3262 = average_layer([Con72729,Zer99836], Ave3262), 
LRes86536 = reshape_layer(Ave3262, [3, 3, 2], Res86536), 
LCro6030 = cropping2D_layer(Res86536, 2, 0, 2, 0, Cro6030), 
exec_layers([LDot97068,LMax7448,LRes7367,LRes73848,LCon72729,LMin39871,LZer99836,LAve3262,LRes86536,LCro6030],["Dot97068","Max7448","Res7367","Res73848","Con72729","Min39871","Zer99836","Ave3262","Res86536","Cro6030"],Cro6030,"Cro6030")

Actual (Unparsed): [[[[0.2867663, 0.3862000]]]]

Expected (Unparsed): [[[[0.286766325,0.3862]]]]

Actual:   [[[[0.2868, 0.3862]]]]

Expected: [[[[0.2868, 0.3862]]]]