import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ELU88029 = tf.keras.layers.Input(shape=([2, 2]))
in0Zer25685 = tf.keras.layers.Input(shape=([2, 2]))

ELU88029 = keras.layers.ELU(alpha=8.488886745923399, name = 'ELU88029', input_shape=(2, 2))(in0ELU88029)
Up_61123 = keras.layers.UpSampling1D(size=(2), name = 'Up_61123', )(ELU88029)
Res5199 = keras.layers.Reshape((4, 2, 1), name = 'Res5199', )(Up_61123)
Zer91637 = keras.layers.ZeroPadding2D(padding=((2, 0), (3, 0)), name = 'Zer91637', )(Res5199)
Zer25685 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer25685', )(in0Zer25685)
Con72163 = keras.layers.Conv1D(3, (2),strides=(1), padding='same', dilation_rate=(1), name = 'Con72163', )(Zer25685)
Lay67864 = keras.layers.LayerNormalization(axis=1, epsilon=2.071608880259664, name = 'Lay67864', )(Con72163)
Res90129 = keras.layers.Reshape((4, 3, 1), name = 'Res90129', )(Lay67864)
Zer51334 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer51334', )(Res90129)
Sub16944 = keras.layers.Subtract(name = 'Sub16944', )([Zer91637,Zer51334])
model = tf.keras.models.Model(inputs=[in0ELU88029,in0Zer25685], outputs=Sub16944)
w = model.get_layer('Con72163').get_weights() 
w[0] = np.array([[[0.6415, 0.8125, 0.2499], [0.5933, 0.4324, 0.5959]], [[0.3457, 0.2533, 0.1175], [0.6908, 0.4397, 0.7058]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con72163').set_weights(w) 
in0ELU88029 = tf.constant([[[0.3653, 0.6207], [0.1244, 0.2999]]])
in0Zer25685 = tf.constant([[[1.0564, 1.9203], [1.8131, 1.1704]]])
print (np.array2string(model.predict([in0ELU88029,in0Zer25685],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub16944.png')

LELU88029 = elu_layer([[[0.3653, 0.6207], [0.1244, 0.2999]]], 8.488886745923399, ELU88029), 
LUp_61123 = up_sampling1D_layer(ELU88029, 2, Up_61123), 
LRes5199 = reshape_layer(Up_61123, [4, 2, 1], Res5199), 
LZer91637 = zero_padding2D_layer(Res5199, 2, 0, 3, 0, Zer91637), 
LZer25685 = zero_padding1D_layer([[[1.0564, 1.9203], [1.8131, 1.1704]]], 1, 1, Zer25685), 
LCon72163 = conv1D_layer(Zer25685, 2,[[[0.6415, 0.8125, 0.2499], [0.5933, 0.4324, 0.5959]], [[0.3457, 0.2533, 0.1175], [0.6908, 0.4397, 0.7058]]],[0, 0, 0], 1, true, 1, Con72163), 
LLay67864 = layer_normalization_layer(Con72163, 1, 2.071608880259664, Lay67864), 
LRes90129 = reshape_layer(Lay67864, [4, 3, 1], Res90129), 
LZer51334 = zero_padding2D_layer(Res90129, 1, 1, 1, 1, Zer51334), 
LSub16944 = subtract_layer(Zer91637,Zer51334, Sub16944), 
exec_layers([LELU88029,LUp_61123,LRes5199,LZer91637,LZer25685,LCon72163,LLay67864,LRes90129,LZer51334,LSub16944],["ELU88029","Up_61123","Res5199","Zer91637","Zer25685","Con72163","Lay67864","Res90129","Zer51334","Sub16944"],Sub16944,"Sub16944")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0046859], [0.1865404], [-0.1247725], [0.0000000]], [[0.0000000], [-0.8413039], [-0.6994093], [-0.3342462], [0.6207000]], [[0.0000000], [-0.0851747], [-0.3089884], [0.4358568], [0.6207000]], [[0.0000000], [0.9217926], [0.8218573], [0.8781618], [0.2999000]], [[0.0000000], [0.0000000], [0.0000000], [0.1244000], [0.2999000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0],[0]],[[0],[0.004685901619785188],[0.18654042978378535],[-0.12477247712797992],[0]],[[0],[-0.8413038669685123],[-0.6994093494012964],[-0.3342461795341533],[0.6207]],[[0],[-0.08517465062533548],[-0.3089884079741551],[0.4358568441922873],[0.6207]],[[0],[0.9217926159740626],[0.8218573275916659],[0.8781618124698458],[0.2999]],[[0],[0],[0],[0.1244],[0.2999]]]]

Actual:   [[[[0], [0], [0], [0], [0]], [[0], [0.0047], [0.1866], [-0.1247], [0]], [[0], [-0.8413], [-0.6994], [-0.3342], [0.6207]], [[0], [-0.0851], [-0.3089], [0.4359], [0.6207]], [[0], [0.9218], [0.8219], [0.8782], [0.2999]], [[0], [0], [0], [0.1244], [0.2999]]]]

Expected: [[[[0], [0], [0], [0], [0]], [[0], [0.0047], [0.1866], [-0.1247], [0]], [[0], [-0.8413], [-0.6994], [-0.3342], [0.6207]], [[0], [-0.0851], [-0.3089], [0.4359], [0.6207]], [[0], [0.9218], [0.8219], [0.8782], [0.2999]], [[0], [0], [0], [0.1244], [0.2999]]]]