import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_86795 = tf.keras.layers.Input(shape=([2, 4, 3]))
in0Min58340 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min58340 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con33565 = tf.keras.layers.Input(shape=([4, 4, 1]))

Up_86795 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_86795', )(in0Up_86795)
Min58340 = keras.layers.Minimum(name = 'Min58340', )([in0Min58340,in1Min58340])
Zer78593 = keras.layers.ZeroPadding2D(padding=((3, 0), (2, 0)), name = 'Zer78593', )(Min58340)
Con33565 = keras.layers.Concatenate(axis=3, name = 'Con33565', )([Zer78593,in0Con33565])
Ave48599 = keras.layers.Average(name = 'Ave48599', )([Up_86795,Con33565])
Res80573 = keras.layers.Reshape((4, 4, 3, 1), name = 'Res80573', )(Ave48599)
Con55937 = keras.layers.Conv3D(2, (1, 4, 1),strides=(8, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con55937', )(Res80573)
Res65283 = keras.layers.Reshape((1, 4, 6), name = 'Res65283', )(Con55937)
Res4207 = keras.layers.Reshape((1, 24), name = 'Res4207', )(Res65283)
GRU36812 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU36812', )(Res4207)
model = tf.keras.models.Model(inputs=[in0Up_86795,in0Min58340,in1Min58340,in0Con33565], outputs=GRU36812)
w = model.get_layer('Con55937').get_weights() 
w[0] = np.array([[[[[0.368, 0.7712]]], [[[0.7095, 0.5772]]], [[[0.5726, 0.0792]]], [[[0.0041, 0.9794]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con55937').set_weights(w) 
w = model.get_layer('GRU36812').get_weights() 
w[0] = np.array([[8, 10, 10, 2, 1, 8], [6, 8, 7, 2, 4, 8], [1, 7, 4, 5, 3, 3], [3, 6, 1, 5, 9, 10], [5, 1, 9, 3, 2, 8], [1, 7, 8, 2, 5, 2], [4, 5, 9, 7, 4, 8], [9, 1, 1, 8, 2, 6], [3, 9, 8, 7, 9, 7], [4, 6, 2, 8, 2, 8], [3, 10, 5, 9, 7, 8], [6, 2, 7, 6, 3, 7], [5, 7, 2, 3, 3, 10], [6, 2, 2, 1, 9, 8], [5, 4, 3, 6, 10, 10], [3, 1, 1, 8, 4, 3], [4, 6, 6, 4, 10, 9], [4, 10, 2, 10, 4, 2], [7, 7, 3, 1, 3, 2], [5, 1, 4, 6, 4, 6], [2, 3, 1, 2, 5, 10], [4, 1, 4, 7, 5, 10], [7, 2, 7, 1, 8, 7], [1, 9, 4, 5, 9, 10]])
w[1] = np.array([[2, 8, 1, 6, 7, 1], [6, 7, 1, 2, 7, 10]])
w[2] = np.array([7, 10, 1, 8, 1, 8])
model.get_layer('GRU36812').set_weights(w) 
in0Up_86795 = tf.constant([[[[1.0748, 1.3434, 1.6395], [1.8732, 1.1071, 1.0299], [1.8199, 1.2559, 1.0158], [1.7993, 1.4178, 1.789]], [[1.2874, 1.534, 1.4598], [1.8332, 1.8298, 1.2605], [1.0467, 1.7358, 1.4514], [1.2368, 1.0639, 1.8304]]]])
in0Min58340 = tf.constant([[[[0.3736, 0.6235], [0.8526, 0.0986]]]])
in1Min58340 = tf.constant([[[[0.203, 0.2239], [0.9421, 0.8299]]]])
in0Con33565 = tf.constant([[[[0.7247], [0.1127], [0.3445], [0.7932]], [[0.1824], [0.2107], [0.99], [0.5966]], [[0.6118], [0.5027], [0.7142], [0.331]], [[0.0933], [0.2714], [0.4435], [0.8282]]]])
print (np.array2string(model.predict([in0Up_86795,in0Min58340,in1Min58340,in0Con33565],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU36812.png')

LUp_86795 = up_sampling2D_layer([[[[1.0748, 1.3434, 1.6395], [1.8732, 1.1071, 1.0299], [1.8199, 1.2559, 1.0158], [1.7993, 1.4178, 1.789]], [[1.2874, 1.534, 1.4598], [1.8332, 1.8298, 1.2605], [1.0467, 1.7358, 1.4514], [1.2368, 1.0639, 1.8304]]]], 2, 1, Up_86795), 
LMin58340 = minimum_layer([[[[[0.3736, 0.6235], [0.8526, 0.0986]]]], [[[[0.203, 0.2239], [0.9421, 0.8299]]]]], Min58340), 
LZer78593 = zero_padding2D_layer(Min58340, 3, 0, 2, 0, Zer78593), 
LCon33565 = concatenate_layer([Zer78593,[[[[0.7247], [0.1127], [0.3445], [0.7932]], [[0.1824], [0.2107], [0.99], [0.5966]], [[0.6118], [0.5027], [0.7142], [0.331]], [[0.0933], [0.2714], [0.4435], [0.8282]]]]], 3, Con33565), 
LAve48599 = average_layer([Up_86795,Con33565], Ave48599), 
LRes80573 = reshape_layer(Ave48599, [4, 4, 3, 1], Res80573), 
LCon55937 = conv3D_layer(Res80573, 1, 4, 1,[[[[[0.368, 0.7712]]], [[[0.7095, 0.5772]]], [[[0.5726, 0.0792]]], [[[0.0041, 0.9794]]]]],[0, 0], 8, 1, 1, true, 1, 1, 1, Con55937), 
LRes65283 = reshape_layer(Con55937, [1, 4, 6], Res65283), 
LRes4207 = reshape_layer(Res65283, [1, 24], Res4207), 
LGRU36812 = gru_layer(Res4207,[[8, 10, 10, 2, 1, 8], [6, 8, 7, 2, 4, 8], [1, 7, 4, 5, 3, 3], [3, 6, 1, 5, 9, 10], [5, 1, 9, 3, 2, 8], [1, 7, 8, 2, 5, 2], [4, 5, 9, 7, 4, 8], [9, 1, 1, 8, 2, 6], [3, 9, 8, 7, 9, 7], [4, 6, 2, 8, 2, 8], [3, 10, 5, 9, 7, 8], [6, 2, 7, 6, 3, 7], [5, 7, 2, 3, 3, 10], [6, 2, 2, 1, 9, 8], [5, 4, 3, 6, 10, 10], [3, 1, 1, 8, 4, 3], [4, 6, 6, 4, 10, 9], [4, 10, 2, 10, 4, 2], [7, 7, 3, 1, 3, 2], [5, 1, 4, 6, 4, 6], [2, 3, 1, 2, 5, 10], [4, 1, 4, 7, 5, 10], [7, 2, 7, 1, 8, 7], [1, 9, 4, 5, 9, 10]],[[2, 8, 1, 6, 7, 1], [6, 7, 1, 2, 7, 10]],[7, 10, 1, 8, 1, 8], false, GRU36812), 
exec_layers([LUp_86795,LMin58340,LZer78593,LCon33565,LAve48599,LRes80573,LCon55937,LRes65283,LRes4207,LGRU36812],["Up_86795","Min58340","Zer78593","Con33565","Ave48599","Res80573","Con55937","Res65283","Res4207","GRU36812"],GRU36812,"GRU36812")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0]]

Actual:   [[0, 0]]

Expected: [[0, 0]]