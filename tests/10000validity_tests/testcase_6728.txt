import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave72631 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con30974 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot96137 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot96137 = tf.keras.layers.Input(shape=([3, 3]))
in0Mul51247 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul51247 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con41279 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Min71712 = tf.keras.layers.Input(shape=([2, 1]))
in1Min71712 = tf.keras.layers.Input(shape=([2, 1]))
in0Con88973 = tf.keras.layers.Input(shape=([2, 3, 3]))
in0Sep41884 = tf.keras.layers.Input(shape=([1, 2, 2]))

Ave72631 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 12), padding='same', name = 'Ave72631', )(in0Ave72631)
Res67548 = keras.layers.Reshape((1, 1), name = 'Res67548', )(Ave72631)
Sim16061 = keras.layers.SimpleRNN(1,name = 'Sim16061', )(Res67548)
Res71008 = keras.layers.Reshape((1, 1), name = 'Res71008', )(Sim16061)
Zer33945 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer33945', )(Res71008)
Con30974 = keras.layers.Concatenate(axis=2, name = 'Con30974', )([Zer33945,in0Con30974])
Dot96137 = keras.layers.Dot(axes=(2, 1), name = 'Dot96137', )([in0Dot96137,in1Dot96137])
Ave51728 = keras.layers.Average(name = 'Ave51728', )([Con30974,Dot96137])
Res7289 = keras.layers.Reshape((3, 3, 1), name = 'Res7289', )(Ave51728)
Mul51247 = keras.layers.Multiply(name = 'Mul51247', )([in0Mul51247,in1Mul51247])
Zer80940 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer80940', )(Mul51247)
Min32203 = keras.layers.Minimum(name = 'Min32203', )([Res7289,Zer80940])
Con41279 = keras.layers.Concatenate(axis=3, name = 'Con41279', )([Min32203,in0Con41279])
Min71712 = keras.layers.Minimum(name = 'Min71712', )([in0Min71712,in1Min71712])
Res24038 = keras.layers.Reshape((2, 1, 1), name = 'Res24038', )(Min71712)
Zer12156 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer12156', )(Res24038)
Con88973 = keras.layers.Concatenate(axis=3, name = 'Con88973', )([Zer12156,in0Con88973])
Sep41884 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep41884', )(in0Sep41884)
Lay78768 = keras.layers.LayerNormalization(axis=1, epsilon=2.429462069216603, name = 'Lay78768', )(Sep41884)
Zer57030 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer57030', )(Lay78768)
Ave9986 = keras.layers.Average(name = 'Ave9986', )([Con88973,Zer57030])
ELU16198 = keras.layers.ELU(alpha=-6.568213226278255, name = 'ELU16198', )(Ave9986)
Zer63869 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer63869', )(ELU16198)
Min6130 = keras.layers.Minimum(name = 'Min6130', )([Con41279,Zer63869])
model = tf.keras.models.Model(inputs=[in0Ave72631,in0Con30974,in0Dot96137,in1Dot96137,in0Mul51247,in1Mul51247,in0Con41279,in0Min71712,in1Min71712,in0Con88973,in0Sep41884], outputs=Min6130)
w = model.get_layer('Sim16061').get_weights() 
w[0] = np.array([[9]])
w[1] = np.array([[5]])
w[2] = np.array([7])
model.get_layer('Sim16061').set_weights(w) 
w = model.get_layer('Sep41884').get_weights() 
w[0] = np.array([[[[0.7164], [0.4316]]]])
w[1] = np.array([[[[0.5987, 0.9814, 0.1628, 0.8031], [0.9956, 0.886, 0.0181, 0.8389]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep41884').set_weights(w) 
in0Ave72631 = tf.constant([[[[1.8297]]]])
in0Con30974 = tf.constant([[[0.5376, 0.1832], [0.0151, 0.0727], [0.6839, 0.3347]]])
in0Dot96137 = tf.constant([[[0.483, 0.004, 0.0589], [0.6569, 0.1595, 0.5329], [0.048, 0.8288, 0.3965]]])
in1Dot96137 = tf.constant([[[0.4516, 0.876, 0.3255], [0.9413, 0.7128, 0.6982], [0.3526, 0.6423, 0.0666]]])
in0Mul51247 = tf.constant([[[[0.0019], [0.6177]], [[0.0222], [0.0019]]]])
in1Mul51247 = tf.constant([[[[0.6308], [0.8283]], [[0.9173], [0.9808]]]])
in0Con41279 = tf.constant([[[[0.9711, 0.2331, 0.5746], [0.8868, 0.1213, 0.8442], [0.6801, 0.8506, 0.2931]], [[0.46, 0.4259, 0.6903], [0.226, 0.924, 0.4331], [0.4501, 0.5398, 0.5964]], [[0.9815, 0.4305, 0.6399], [0.6505, 0.6819, 0.2817], [0.8937, 0.8092, 0.9028]]]])
in0Min71712 = tf.constant([[[0.8799], [0.728]]])
in1Min71712 = tf.constant([[[0.0918], [0.8543]]])
in0Con88973 = tf.constant([[[[0.6927, 0.6453, 0.5981], [0.6053, 0.1504, 0.5331], [0.5988, 0.9475, 0.1699]], [[0.4764, 0.6154, 0.7083], [0.2556, 0.9987, 0.2943], [0.6013, 0.8938, 0.3108]]]])
in0Sep41884 = tf.constant([[[[0.7497, 0.1391], [0.9204, 0.6377]]]])
print (np.array2string(model.predict([in0Ave72631,in0Con30974,in0Dot96137,in1Dot96137,in0Mul51247,in1Mul51247,in0Con41279,in0Min71712,in1Min71712,in0Con88973,in0Sep41884],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min6130.png')

LAve72631 = average_pooling2D_layer([[[[1.8297]]]], 1, 1, 1, 12, true, Ave72631), 
LRes67548 = reshape_layer(Ave72631, [1, 1], Res67548), 
LSim16061 = simple_rnn_layer(Res67548,[[9]],[[5]],[7], Sim16061), 
LRes71008 = reshape_layer(Sim16061, [1, 1], Res71008), 
LZer33945 = zero_padding1D_layer(Res71008, 2, 0, Zer33945), 
LCon30974 = concatenate_layer([Zer33945,[[[0.5376, 0.1832], [0.0151, 0.0727], [0.6839, 0.3347]]]], 2, Con30974), 
LDot96137 = dot_layer([[[0.483, 0.004, 0.0589], [0.6569, 0.1595, 0.5329], [0.048, 0.8288, 0.3965]]], [[[0.4516, 0.876, 0.3255], [0.9413, 0.7128, 0.6982], [0.3526, 0.6423, 0.0666]]], 2, 1, Dot96137), 
LAve51728 = average_layer([Con30974,Dot96137], Ave51728), 
LRes7289 = reshape_layer(Ave51728, [3, 3, 1], Res7289), 
LMul51247 = multiply_layer([[[[[0.0019], [0.6177]], [[0.0222], [0.0019]]]], [[[[0.6308], [0.8283]], [[0.9173], [0.9808]]]]], Mul51247), 
LZer80940 = zero_padding2D_layer(Mul51247, 1, 0, 1, 0, Zer80940), 
LMin32203 = minimum_layer([Res7289,Zer80940], Min32203), 
LCon41279 = concatenate_layer([Min32203,[[[[0.9711, 0.2331, 0.5746], [0.8868, 0.1213, 0.8442], [0.6801, 0.8506, 0.2931]], [[0.46, 0.4259, 0.6903], [0.226, 0.924, 0.4331], [0.4501, 0.5398, 0.5964]], [[0.9815, 0.4305, 0.6399], [0.6505, 0.6819, 0.2817], [0.8937, 0.8092, 0.9028]]]]], 3, Con41279), 
LMin71712 = minimum_layer([[[[0.8799], [0.728]]], [[[0.0918], [0.8543]]]], Min71712), 
LRes24038 = reshape_layer(Min71712, [2, 1, 1], Res24038), 
LZer12156 = zero_padding2D_layer(Res24038, 0, 0, 2, 0, Zer12156), 
LCon88973 = concatenate_layer([Zer12156,[[[[0.6927, 0.6453, 0.5981], [0.6053, 0.1504, 0.5331], [0.5988, 0.9475, 0.1699]], [[0.4764, 0.6154, 0.7083], [0.2556, 0.9987, 0.2943], [0.6013, 0.8938, 0.3108]]]]], 3, Con88973), 
LSep41884 = separable_conv2D_layer([[[[0.7497, 0.1391], [0.9204, 0.6377]]]], 1, 1,[[[[[0.7164], [0.4316]]]],[[[[0.5987, 0.9814, 0.1628, 0.8031], [0.9956, 0.886, 0.0181, 0.8389]]]]],[0, 0, 0, 0], 1, 1, false, Sep41884), 
LLay78768 = layer_normalization_layer(Sep41884, 1, 2.429462069216603, Lay78768), 
LZer57030 = zero_padding2D_layer(Lay78768, 1, 0, 1, 0, Zer57030), 
LAve9986 = average_layer([Con88973,Zer57030], Ave9986), 
LELU16198 = elu_layer(Ave9986, -6.568213226278255, ELU16198), 
LZer63869 = zero_padding2D_layer(ELU16198, 1, 0, 0, 0, Zer63869), 
LMin6130 = minimum_layer([Con41279,Zer63869], Min6130), 
exec_layers([LAve72631,LRes67548,LSim16061,LRes71008,LZer33945,LCon30974,LDot96137,LAve51728,LRes7289,LMul51247,LZer80940,LMin32203,LCon41279,LMin71712,LRes24038,LZer12156,LCon88973,LSep41884,LLay78768,LZer57030,LAve9986,LELU16198,LZer63869,LMin6130],["Ave72631","Res67548","Sim16061","Res71008","Zer33945","Con30974","Dot96137","Ave51728","Res7289","Mul51247","Zer80940","Min32203","Con41279","Min71712","Res24038","Zer12156","Con88973","Sep41884","Lay78768","Zer57030","Ave9986","ELU16198","Zer63869","Min6130"],Min6130,"Min6130")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[-0.0000000, 0.3463500, 0.3226500, 0.2990500], [-0.0000000, 0.2260000, 0.0752000, 0.2665500], [0.0459000, 0.2994000, 0.4737500, 0.0849500]], [[-0.0000000, 0.2382000, 0.3077000, 0.3541500], [-0.0000000, 0.1278000, 0.4993500, 0.1471500], [0.0018635, 0.3006500, 0.4469000, 0.1554000]]]]

Expected (Unparsed): [[[[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0.34635,0.32265,0.29905],[0,0.226,0.0752,0.26655],[0.0459,0.2994,0.47375,0.08495]],[[0,0.2382,0.3077,0.35415],[0.0,0.1278,0.49935,0.14715],[0.00186352,0.30065,0.4469,0.1554]]]]

Actual:   [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[-0, 0.3464, 0.3227, 0.2991], [-0, 0.226, 0.0752, 0.2666], [0.0459, 0.2994, 0.4738, 0.085]], [[-0, 0.2382, 0.3077, 0.3542], [-0, 0.1278, 0.4994, 0.1472], [0.0019, 0.3007, 0.4469, 0.1554]]]]

Expected: [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0.3464, 0.3227, 0.2991], [0, 0.226, 0.0752, 0.2666], [0.0459, 0.2994, 0.4738, 0.085]], [[0, 0.2382, 0.3077, 0.3542], [0, 0.1278, 0.4994, 0.1472], [0.0019, 0.3007, 0.4469, 0.1554]]]]