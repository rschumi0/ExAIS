import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro65264 = tf.keras.layers.Input(shape=([2, 2, 4]))

Cro65264 = keras.layers.Cropping2D(cropping=((0, 1), (0, 1)), name = 'Cro65264', )(in0Cro65264)
Res76744 = keras.layers.Reshape((1, 4), name = 'Res76744', )(Cro65264)
Con73057 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con73057', )(Res76744)
Sim3938 = keras.layers.SimpleRNN(2,name = 'Sim3938', )(Con73057)
model = tf.keras.models.Model(inputs=[in0Cro65264], outputs=Sim3938)
w = model.get_layer('Con73057').get_weights() 
w[0] = np.array([[[0.6327, 0.0863, 0.4806, 0.2942], [0.5875, 0.9121, 0.0892, 0.1735], [0.2968, 0.3299, 0.994, 0.3703], [0.6132, 0.349, 0.2095, 0.7962]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con73057').set_weights(w) 
w = model.get_layer('Sim3938').get_weights() 
w[0] = np.array([[9, 2], [9, 6], [1, 5], [8, 2]])
w[1] = np.array([[8, 10], [3, 1]])
w[2] = np.array([3, 2])
model.get_layer('Sim3938').set_weights(w) 
in0Cro65264 = tf.constant([[[[1.6074, 1.7917, 1.3701, 1.9363], [1.8832, 1.7293, 1.7065, 1.1656]], [[1.7931, 1.8545, 1.0052, 1.9099], [1.4092, 1.2883, 1.5285, 1.7385]]]])
print (np.array2string(model.predict([in0Cro65264],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim3938.png')

LCro65264 = cropping2D_layer([[[[1.6074, 1.7917, 1.3701, 1.9363], [1.8832, 1.7293, 1.7065, 1.1656]], [[1.7931, 1.8545, 1.0052, 1.9099], [1.4092, 1.2883, 1.5285, 1.7385]]]], 0, 1, 0, 1, Cro65264), 
LRes76744 = reshape_layer(Cro65264, [1, 4], Res76744), 
LCon73057 = conv1D_layer(Res76744, 1,[[[0.6327, 0.0863, 0.4806, 0.2942], [0.5875, 0.9121, 0.0892, 0.1735], [0.2968, 0.3299, 0.994, 0.3703], [0.6132, 0.349, 0.2095, 0.7962]]],[0, 0, 0, 0], 1, true, 1, Con73057), 
LSim3938 = simple_rnn_layer(Con73057,[[9, 2], [9, 6], [1, 5], [8, 2]],[[8, 10], [3, 1]],[3, 2], Sim3938), 
exec_layers([LCro65264,LRes76744,LCon73057,LSim3938],["Cro65264","Res76744","Con73057","Sim3938"],Sim3938,"Sim3938")

Actual (Unparsed): [[1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0]]

Actual:   [[1, 1]]

Expected: [[1, 1]]