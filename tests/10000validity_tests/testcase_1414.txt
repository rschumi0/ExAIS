import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot65173 = tf.keras.layers.Input(shape=([2]))
in1Dot65173 = tf.keras.layers.Input(shape=([2]))
in0Glo96017 = tf.keras.layers.Input(shape=([1, 1, 1]))

Dot65173 = keras.layers.Dot(axes=(1, 1), name = 'Dot65173', )([in0Dot65173,in1Dot65173])
Res20393 = keras.layers.Reshape((1, 1), name = 'Res20393', )(Dot65173)
Zer96337 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer96337', )(Res20393)
Res53422 = keras.layers.Reshape((3, 1, 1), name = 'Res53422', )(Zer96337)
Ave62638 = keras.layers.AveragePooling2D(pool_size=(3, 1), name = 'Ave62638', )(Res53422)
Zer75137 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer75137', )(Ave62638)
Glo96017 = keras.layers.GlobalMaxPool2D(name = 'Glo96017', )(in0Glo96017)
Lea71433 = keras.layers.LeakyReLU(alpha=8.817415558215918, name = 'Lea71433', )(Glo96017)
Res56516 = keras.layers.Reshape((1, 1), name = 'Res56516', )(Lea71433)
Res25687 = keras.layers.Reshape((1, 1, 1), name = 'Res25687', )(Res56516)
Zer60067 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer60067', )(Res25687)
Max63241 = keras.layers.Maximum(name = 'Max63241', )([Zer75137,Zer60067])
model = tf.keras.models.Model(inputs=[in0Dot65173,in1Dot65173,in0Glo96017], outputs=Max63241)
in0Dot65173 = tf.constant([[0.27, 0.9775]])
in1Dot65173 = tf.constant([[0.9027, 0.4491]])
in0Glo96017 = tf.constant([[[[1.8057]]]])
print (np.array2string(model.predict([in0Dot65173,in1Dot65173,in0Glo96017],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max63241.png')

LDot65173 = dot_layer([[0.27, 0.9775]], [[0.9027, 0.4491]], 1, 1, Dot65173), 
LRes20393 = reshape_layer(Dot65173, [1, 1], Res20393), 
LZer96337 = zero_padding1D_layer(Res20393, 1, 1, Zer96337), 
LRes53422 = reshape_layer(Zer96337, [3, 1, 1], Res53422), 
LAve62638 = average_pooling2D_layer(Res53422, 3, 1, Ave62638), 
LZer75137 = zero_padding2D_layer(Ave62638, 2, 0, 2, 0, Zer75137), 
LGlo96017 = global_max_pool2D_layer([[[[1.8057]]]], Glo96017), 
LLea71433 = leaky_relu_layer(Glo96017, 8.817415558215918, Lea71433), 
LRes56516 = reshape_layer(Lea71433, [1, 1], Res56516), 
LRes25687 = reshape_layer(Res56516, [1, 1, 1], Res25687), 
LZer60067 = zero_padding2D_layer(Res25687, 1, 1, 1, 1, Zer60067), 
LMax63241 = maximum_layer([Zer75137,Zer60067], Max63241), 
exec_layers([LDot65173,LRes20393,LZer96337,LRes53422,LAve62638,LZer75137,LGlo96017,LLea71433,LRes56516,LRes25687,LZer60067,LMax63241],["Dot65173","Res20393","Zer96337","Res53422","Ave62638","Zer75137","Glo96017","Lea71433","Res56516","Res25687","Zer60067","Max63241"],Max63241,"Max63241")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.8056999], [0.0000000]], [[0.0000000], [0.0000000], [0.2275748]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[1.8057],[0]],[[0],[0],[0.22757475000000002]]]]

Actual:   [[[[0], [0], [0]], [[0], [1.8057], [0]], [[0], [0], [0.2276]]]]

Expected: [[[[0], [0], [0]], [[0], [1.8057], [0]], [[0], [0], [0.2276]]]]