import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot57643 = tf.keras.layers.Input(shape=([3]))
in1Dot57643 = tf.keras.layers.Input(shape=([3]))
in0Add4376 = tf.keras.layers.Input(shape=([1, 1]))
in1Add4376 = tf.keras.layers.Input(shape=([1, 1]))

Dot57643 = keras.layers.Dot(axes=(1, 1), name = 'Dot57643', )([in0Dot57643,in1Dot57643])
Res1384 = keras.layers.Reshape((1, 1), name = 'Res1384', )(Dot57643)
Per84980 = keras.layers.Permute((1,2), name = 'Per84980',)(Res1384)
Glo84447 = keras.layers.GlobalAveragePooling1D(name = 'Glo84447', )(Per84980)
Res86130 = keras.layers.Reshape((1, 1), name = 'Res86130', )(Glo84447)
Add4376 = keras.layers.Add(name = 'Add4376', )([in0Add4376,in1Add4376])
Dot38750 = keras.layers.Dot(axes=(2, 1), name = 'Dot38750', )([Res86130,Add4376])
model = tf.keras.models.Model(inputs=[in0Dot57643,in1Dot57643,in0Add4376,in1Add4376], outputs=Dot38750)
in0Dot57643 = tf.constant([[0.3918, 0.4527, 0.3938]])
in1Dot57643 = tf.constant([[0.3547, 0.1945, 0.8219]])
in0Add4376 = tf.constant([[[0.5573]]])
in1Add4376 = tf.constant([[[0.9976]]])
print (np.array2string(model.predict([in0Dot57643,in1Dot57643,in0Add4376,in1Add4376],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot38750.png')

LDot57643 = dot_layer([[0.3918, 0.4527, 0.3938]], [[0.3547, 0.1945, 0.8219]], 1, 1, Dot57643), 
LRes1384 = reshape_layer(Dot57643, [1, 1], Res1384), 
LPer84980 = permute_layer(Res1384, 1,2, Per84980), 
LGlo84447 = global_average_pooling1D_layer(Per84980, Glo84447), 
LRes86130 = reshape_layer(Glo84447, [1, 1], Res86130), 
LAdd4376 = add_layer([[[[0.5573]]], [[[0.9976]]]], Add4376), 
LDot38750 = dot_layer(Res86130,Add4376, 2, 1, Dot38750), 
exec_layers([LDot57643,LRes1384,LPer84980,LGlo84447,LRes86130,LAdd4376,LDot38750],["Dot57643","Res1384","Per84980","Glo84447","Res86130","Add4376","Dot38750"],Dot38750,"Dot38750")

Actual (Unparsed): [[[0.8562614]]]

Expected (Unparsed): [[[0.8562613970669999]]]

Actual:   [[[0.8563]]]

Expected: [[[0.8563]]]