import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub1971 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub1971 = tf.keras.layers.Input(shape=([2, 3]))

Sub1971 = keras.layers.Subtract(name = 'Sub1971', )([in0Sub1971,in1Sub1971])
Sim84837 = keras.layers.SimpleRNN(1,name = 'Sim84837', )(Sub1971)
Fla62852 = keras.layers.Flatten(name = 'Fla62852', )(Sim84837)
Thr69877 = keras.layers.ThresholdedReLU(theta=8.065699981812184, name = 'Thr69877', )(Fla62852)
model = tf.keras.models.Model(inputs=[in0Sub1971,in1Sub1971], outputs=Thr69877)
w = model.get_layer('Sim84837').get_weights() 
w[0] = np.array([[3], [5], [5]])
w[1] = np.array([[7]])
w[2] = np.array([7])
model.get_layer('Sim84837').set_weights(w) 
in0Sub1971 = tf.constant([[[0.7083, 0.1445, 0.2872], [0.023, 0.3498, 0.4762]]])
in1Sub1971 = tf.constant([[[0.7786, 0.7018, 0.4093], [0.0448, 0.7748, 0.5194]]])
print (np.array2string(model.predict([in0Sub1971,in1Sub1971],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr69877.png')

LSub1971 = subtract_layer([[[0.7083, 0.1445, 0.2872], [0.023, 0.3498, 0.4762]]], [[[0.7786, 0.7018, 0.4093], [0.0448, 0.7748, 0.5194]]], Sub1971), 
LSim84837 = simple_rnn_layer(Sub1971,[[3], [5], [5]],[[7]],[7], Sim84837), 
LFla62852 = flatten_layer(Sim84837, Fla62852), 
LThr69877 = thresholded_relu_layer(Fla62852, 8.065699981812184, Thr69877), 
exec_layers([LSub1971,LSim84837,LFla62852,LThr69877],["Sub1971","Sim84837","Fla62852","Thr69877"],Thr69877,"Thr69877")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0]]

Actual:   [[0]]

Expected: [[0]]