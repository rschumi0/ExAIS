import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer84571 = tf.keras.layers.Input(shape=([1, 4]))
in0Max582 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max582 = tf.keras.layers.Input(shape=([2, 2, 1]))

Zer84571 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer84571', )(in0Zer84571)
Zer65381 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer65381', )(Zer84571)
Max582 = keras.layers.Maximum(name = 'Max582', )([in0Max582,in1Max582])
Res44751 = keras.layers.Reshape((2, 2), name = 'Res44751', )(Max582)
Res44181 = keras.layers.Reshape((2, 2, 1), name = 'Res44181', )(Res44751)
Zer64169 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer64169', )(Res44181)
Res76548 = keras.layers.Reshape((4, 4), name = 'Res76548', )(Zer64169)
Dot61079 = keras.layers.Dot(axes=(2, 2), name = 'Dot61079', )([Zer65381,Res76548])
model = tf.keras.models.Model(inputs=[in0Zer84571,in0Max582,in1Max582], outputs=Dot61079)
in0Zer84571 = tf.constant([[[1.4433, 1.498, 1.1706, 1.5519]]])
in0Max582 = tf.constant([[[[0.1178], [0.1942]], [[0.8483], [0.1276]]]])
in1Max582 = tf.constant([[[[0.4495], [0.3548]], [[0.1814], [0.3942]]]])
print (np.array2string(model.predict([in0Zer84571,in0Max582,in1Max582],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot61079.png')

LZer84571 = zero_padding1D_layer([[[1.4433, 1.498, 1.1706, 1.5519]]], 1, 1, Zer84571), 
LZer65381 = zero_padding1D_layer(Zer84571, 1, 0, Zer65381), 
LMax582 = maximum_layer([[[[[0.1178], [0.1942]], [[0.8483], [0.1276]]]], [[[[0.4495], [0.3548]], [[0.1814], [0.3942]]]]], Max582), 
LRes44751 = reshape_layer(Max582, [2, 2], Res44751), 
LRes44181 = reshape_layer(Res44751, [2, 2, 1], Res44181), 
LZer64169 = zero_padding2D_layer(Res44181, 1, 1, 1, 1, Zer64169), 
LRes76548 = reshape_layer(Zer64169, [4, 4], Res76548), 
LDot61079 = dot_layer(Zer65381,Res76548, 2, 2, Dot61079), 
exec_layers([LZer84571,LZer65381,LMax582,LRes44751,LRes44181,LZer64169,LRes76548,LDot61079],["Zer84571","Zer65381","Max582","Res44751","Res44181","Zer64169","Res76548","Dot61079"],Dot61079,"Dot61079")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 1.0886799, 1.7322039, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0.0,0.0,0],[0,0.0,0.0,0],[0.0,1.08867988,1.7322039200000001,0.0],[0,0.0,0.0,0]]]

Actual:   [[[0, 0, 0, 0], [0, 0, 0, 0], [0, 1.0887, 1.7323, 0], [0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0], [0, 0, 0, 0], [0, 1.0887, 1.7323, 0], [0, 0, 0, 0]]]