import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add78432 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add78432 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Dep50618 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con43943 = tf.keras.layers.Input(shape=([3, 3, 3]))

Add78432 = keras.layers.Add(name = 'Add78432', )([in0Add78432,in1Add78432])
Con17449 = keras.layers.Conv2D(2, (2, 1),strides=(2, 1), padding='valid', dilation_rate=(1, 1), name = 'Con17449', )(Add78432)
Res37561 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res37561', )(Con17449)
Zer75014 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer75014', )(Res37561)
Res32585 = keras.layers.Reshape((3, 3, 4), name = 'Res32585', )(Zer75014)
Dep50618 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep50618', )(in0Dep50618)
Zer29858 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer29858', )(Dep50618)
Con43943 = keras.layers.Concatenate(axis=3, name = 'Con43943', )([Zer29858,in0Con43943])
Add16112 = keras.layers.Add(name = 'Add16112', )([Res32585,Con43943])
model = tf.keras.models.Model(inputs=[in0Add78432,in1Add78432,in0Dep50618,in0Con43943], outputs=Add16112)
w = model.get_layer('Con17449').get_weights() 
w[0] = np.array([[[[0.0082, 0.4427], [0.3692, 0.6706]]], [[[0.0689, 0.5457], [0.0845, 0.2991]]]])
w[1] = np.array([0, 0])
model.get_layer('Con17449').set_weights(w) 
w = model.get_layer('Dep50618').get_weights() 
w[0] = np.array([[[[0.4568]]]])
w[1] = np.array([0])
model.get_layer('Dep50618').set_weights(w) 
in0Add78432 = tf.constant([[[[0.5027, 0.8549]], [[0.1479, 0.3069]]]])
in1Add78432 = tf.constant([[[[0.5826, 0.5712]], [[0.2043, 0.5257]]]])
in0Dep50618 = tf.constant([[[[0.5069]], [[0.6907]]]])
in0Con43943 = tf.constant([[[[0.832, 0.6354, 0.3092], [0.1454, 0.3191, 0.4864], [0.238, 0.9655, 0.1386]], [[0.3197, 0.676, 0.7965], [0.6995, 0.5806, 0.182], [0.9574, 0.3955, 0.1919]], [[0.9841, 0.2787, 0.3306], [0.4005, 0.3964, 0.4877], [0.5767, 0.7824, 0.4749]]]])
print (np.array2string(model.predict([in0Add78432,in1Add78432,in0Dep50618,in0Con43943],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add16112.png')

LAdd78432 = add_layer([[[[[0.5027, 0.8549]], [[0.1479, 0.3069]]]], [[[[0.5826, 0.5712]], [[0.2043, 0.5257]]]]], Add78432), 
LCon17449 = conv2D_layer(Add78432, 2, 1,[[[[0.0082, 0.4427], [0.3692, 0.6706]]], [[[0.0689, 0.5457], [0.0845, 0.2991]]]],[0, 0], 2, 1, false, 1, 1, Con17449), 
LRes37561 = reshape_layer(Con17449, [1, 1, 2, 1], Res37561), 
LZer75014 = zero_padding3D_layer(Res37561, 1, 1, 1, 1, 1, 1, Zer75014), 
LRes32585 = reshape_layer(Zer75014, [3, 3, 4], Res32585), 
LDep50618 = depthwise_conv2D_layer([[[[0.5069]], [[0.6907]]]], 1, 1,[[[[0.4568]]]],[0], 1, 1, false, Dep50618), 
LZer29858 = zero_padding2D_layer(Dep50618, 1, 0, 2, 0, Zer29858), 
LCon43943 = concatenate_layer([Zer29858,[[[[0.832, 0.6354, 0.3092], [0.1454, 0.3191, 0.4864], [0.238, 0.9655, 0.1386]], [[0.3197, 0.676, 0.7965], [0.6995, 0.5806, 0.182], [0.9574, 0.3955, 0.1919]], [[0.9841, 0.2787, 0.3306], [0.4005, 0.3964, 0.4877], [0.5767, 0.7824, 0.4749]]]]], 3, Con43943), 
LAdd16112 = add_layer([Res32585,Con43943], Add16112), 
exec_layers([LAdd78432,LCon17449,LRes37561,LZer75014,LRes32585,LDep50618,LZer29858,LCon43943,LAdd16112],["Add78432","Con17449","Res37561","Zer75014","Res32585","Dep50618","Zer29858","Con43943","Add16112"],Add16112,"Add16112")

Actual (Unparsed): [[[[0.0000000, 0.8320000, 0.6354000, 0.3092000], [0.0000000, 0.1454000, 0.3191000, 0.4864000], [0.0000000, 0.2380000, 0.9655000, 0.1386000]], [[0.0000000, 0.3197000, 0.6760000, 0.7965000], [0.0000000, 1.3295369, 2.4586312, 0.1820000], [0.2315519, 0.9574000, 0.3955000, 0.1919000]], [[0.0000000, 0.9841000, 0.2787000, 0.3306000], [0.0000000, 0.4005000, 0.3964000, 0.4877000], [0.3155118, 0.5767000, 0.7824000, 0.4749000]]]]

Expected (Unparsed): [[[[0,0.832,0.6354,0.3092],[0,0.1454,0.3191,0.4864],[0,0.238,0.9655,0.1386]],[[0,0.3197,0.676,0.7965],[0,1.32953686,2.4586311700000003,0.182],[0.23155192,0.9574,0.3955,0.1919]],[[0,0.9841,0.2787,0.3306],[0,0.4005,0.3964,0.4877],[0.31551176,0.5767,0.7824,0.4749]]]]

Actual:   [[[[0, 0.832, 0.6354, 0.3092], [0, 0.1454, 0.3191, 0.4864], [0, 0.238, 0.9655, 0.1386]], [[0, 0.3197, 0.676, 0.7965], [0, 1.3296, 2.4587, 0.182], [0.2316, 0.9574, 0.3955, 0.1919]], [[0, 0.9841, 0.2787, 0.3306], [0, 0.4005, 0.3964, 0.4877], [0.3156, 0.5767, 0.7824, 0.4749]]]]

Expected: [[[[0, 0.832, 0.6354, 0.3092], [0, 0.1454, 0.3191, 0.4864], [0, 0.238, 0.9655, 0.1386]], [[0, 0.3197, 0.676, 0.7965], [0, 1.3296, 2.4587, 0.182], [0.2316, 0.9574, 0.3955, 0.1919]], [[0, 0.9841, 0.2787, 0.3306], [0, 0.4005, 0.3964, 0.4877], [0.3156, 0.5767, 0.7824, 0.4749]]]]