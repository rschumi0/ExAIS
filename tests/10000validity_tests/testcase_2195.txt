import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat28795 = tf.keras.layers.Input(shape=([3, 4]))

Bat28795 = keras.layers.BatchNormalization(axis=2, epsilon=0.20168257469572537,  name = 'Bat28795', )(in0Bat28795)
Res18510 = keras.layers.Reshape((3, 4, 1), name = 'Res18510', )(Bat28795)
Cro76047 = keras.layers.Cropping2D(cropping=((0, 2), (3, 0)), name = 'Cro76047', )(Res18510)
Res5111 = keras.layers.Reshape((1, 1), name = 'Res5111', )(Cro76047)
Sep21645 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='valid', name = 'Sep21645', )(Res5111)
Res28214 = keras.layers.Reshape((1, 2, 1), name = 'Res28214', )(Sep21645)
Cro39161 = keras.layers.Cropping2D(cropping=((0, 0), (1, 0)), name = 'Cro39161', )(Res28214)
model = tf.keras.models.Model(inputs=[in0Bat28795], outputs=Cro39161)
w = model.get_layer('Bat28795').get_weights() 
w[0] = np.array([0.7343, 0.0485, 0.9109, 0.8695])
w[1] = np.array([0.8723, 0.4803, 0.0911, 0.5069])
w[2] = np.array([0.1926, 0.2347, 0.3922, 0.8391])
w[3] = np.array([0.8073, 0.5843, 0.3095, 0.8982])
model.get_layer('Bat28795').set_weights(w) 
w = model.get_layer('Sep21645').get_weights() 
w[0] = np.array([[[0.0641]]])
w[1] = np.array([[[0.5128, 0.8467]]])
w[2] = np.array([0, 0])
model.get_layer('Sep21645').set_weights(w) 
in0Bat28795 = tf.constant([[[1.5653, 1.8036, 1.1784, 1.7357], [1.0493, 1.1231, 1.9971, 1.295], [1.4456, 1.9785, 1.5862, 1.4614]]])
print (np.array2string(model.predict([in0Bat28795],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro39161.png')

LBat28795 = batch_normalization_layer([[[1.5653, 1.8036, 1.1784, 1.7357], [1.0493, 1.1231, 1.9971, 1.295], [1.4456, 1.9785, 1.5862, 1.4614]]], 2, 0.20168257469572537, [0.7343, 0.0485, 0.9109, 0.8695], [0.8723, 0.4803, 0.0911, 0.5069], [0.1926, 0.2347, 0.3922, 0.8391], [0.8073, 0.5843, 0.3095, 0.8982], Bat28795), 
LRes18510 = reshape_layer(Bat28795, [3, 4, 1], Res18510), 
LCro76047 = cropping2D_layer(Res18510, 0, 2, 3, 0, Cro76047), 
LRes5111 = reshape_layer(Cro76047, [1, 1], Res5111), 
LSep21645 = separable_conv1D_layer(Res5111, 1,[[[[0.0641]]],[[[0.5128, 0.8467]]]],[0, 0], 1, false, Sep21645), 
LRes28214 = reshape_layer(Sep21645, [1, 2, 1], Res28214), 
LCro39161 = cropping2D_layer(Res28214, 0, 0, 1, 0, Cro39161), 
exec_layers([LBat28795,LRes18510,LCro76047,LRes5111,LSep21645,LRes28214,LCro39161],["Bat28795","Res18510","Cro76047","Res5111","Sep21645","Res28214","Cro39161"],Cro39161,"Cro39161")

Actual (Unparsed): [[[[0.0678556]]]]

Expected (Unparsed): [[[[0.06785557440807814]]]]

Actual:   [[[[0.0679]]]]

Expected: [[[[0.0679]]]]