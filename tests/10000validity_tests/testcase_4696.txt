import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave81653 = tf.keras.layers.Input(shape=([2, 2]))
in0Glo20612 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Ave81653 = keras.layers.AveragePooling1D(pool_size=(2), name = 'Ave81653', )(in0Ave81653)
Bat30591 = keras.layers.BatchNormalization(axis=1, epsilon=0.8799496486258458,  name = 'Bat30591', )(Ave81653)
Fla8782 = keras.layers.Flatten(name = 'Fla8782', )(Bat30591)
Glo20612 = keras.layers.GlobalMaxPool3D(name = 'Glo20612', )(in0Glo20612)
Mul66129 = keras.layers.Multiply(name = 'Mul66129', )([Fla8782,Glo20612])
Res24327 = keras.layers.Reshape((2, 1), name = 'Res24327', )(Mul66129)
Res2346 = keras.layers.Reshape((2, 1, 1), name = 'Res2346', )(Res24327)
Res71567 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res71567', )(Res2346)
Glo79643 = keras.layers.GlobalMaxPool3D(name = 'Glo79643', )(Res71567)
Thr81615 = keras.layers.ThresholdedReLU(theta=3.726664834806166, name = 'Thr81615', )(Glo79643)
model = tf.keras.models.Model(inputs=[in0Ave81653,in0Glo20612], outputs=Thr81615)
w = model.get_layer('Bat30591').get_weights() 
w[0] = np.array([0.6686])
w[1] = np.array([0.348])
w[2] = np.array([0.0962])
w[3] = np.array([0.3169])
model.get_layer('Bat30591').set_weights(w) 
in0Ave81653 = tf.constant([[[1.0275, 1.1186], [1.8026, 1.0931]]])
in0Glo20612 = tf.constant([[[[[1.0737, 1.9652]]]]])
print (np.array2string(model.predict([in0Ave81653,in0Glo20612],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr81615.png')

LAve81653 = average_pooling1D_layer([[[1.0275, 1.1186], [1.8026, 1.0931]]], 2, Ave81653), 
LBat30591 = batch_normalization_layer(Ave81653, 1, 0.8799496486258458, [0.6686], [0.348], [0.0962], [0.3169], Bat30591), 
LFla8782 = flatten_layer(Bat30591, Fla8782), 
LGlo20612 = global_max_pool3D_layer([[[[[1.0737, 1.9652]]]]], Glo20612), 
LMul66129 = multiply_layer([Fla8782,Glo20612], Mul66129), 
LRes24327 = reshape_layer(Mul66129, [2, 1], Res24327), 
LRes2346 = reshape_layer(Res24327, [2, 1, 1], Res2346), 
LRes71567 = reshape_layer(Res2346, [2, 1, 1, 1], Res71567), 
LGlo79643 = global_max_pool3D_layer(Res71567, Glo79643), 
LThr81615 = thresholded_relu_layer(Glo79643, 3.726664834806166, Thr81615), 
exec_layers([LAve81653,LBat30591,LFla8782,LGlo20612,LMul66129,LRes24327,LRes2346,LRes71567,LGlo79643,LThr81615],["Ave81653","Bat30591","Fla8782","Glo20612","Mul66129","Res24327","Res2346","Res71567","Glo79643","Thr81615"],Thr81615,"Thr81615")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0]]

Actual:   [[0]]

Expected: [[0]]