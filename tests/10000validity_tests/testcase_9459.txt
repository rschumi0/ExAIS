import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave38901 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Ave38901 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Dot95344 = tf.keras.layers.Input(shape=([2]))
in1Dot95344 = tf.keras.layers.Input(shape=([2]))

Ave38901 = keras.layers.Average(name = 'Ave38901', )([in0Ave38901,in1Ave38901])
Res56575 = keras.layers.Reshape((1, 1, 1), name = 'Res56575', )(Ave38901)
Res74218 = keras.layers.Reshape((1, 1), name = 'Res74218', )(Res56575)
Max87017 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max87017', )(Res74218)
Dot95344 = keras.layers.Dot(axes=(1, 1), name = 'Dot95344', )([in0Dot95344,in1Dot95344])
Res1761 = keras.layers.Reshape((1, 1), name = 'Res1761', )(Dot95344)
Per51711 = keras.layers.Permute((1,2), name = 'Per51711',)(Res1761)
Ave79667 = keras.layers.Average(name = 'Ave79667', )([Max87017,Per51711])
model = tf.keras.models.Model(inputs=[in0Ave38901,in1Ave38901,in0Dot95344,in1Dot95344], outputs=Ave79667)
in0Ave38901 = tf.constant([[[[[0.9743]]]]])
in1Ave38901 = tf.constant([[[[[0.7487]]]]])
in0Dot95344 = tf.constant([[0.9114, 0.5564]])
in1Dot95344 = tf.constant([[0.8206, 0.1937]])
print (np.array2string(model.predict([in0Ave38901,in1Ave38901,in0Dot95344,in1Dot95344],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave79667.png')

LAve38901 = average_layer([[[[[[0.9743]]]]], [[[[[0.7487]]]]]], Ave38901), 
LRes56575 = reshape_layer(Ave38901, [1, 1, 1], Res56575), 
LRes74218 = reshape_layer(Res56575, [1, 1], Res74218), 
LMax87017 = max_pool1D_layer(Res74218, 1, Max87017), 
LDot95344 = dot_layer([[0.9114, 0.5564]], [[0.8206, 0.1937]], 1, 1, Dot95344), 
LRes1761 = reshape_layer(Dot95344, [1, 1], Res1761), 
LPer51711 = permute_layer(Res1761, 1,2, Per51711), 
LAve79667 = average_layer([Max87017,Per51711], Ave79667), 
exec_layers([LAve38901,LRes56575,LRes74218,LMax87017,LDot95344,LRes1761,LPer51711,LAve79667],["Ave38901","Res56575","Res74218","Max87017","Dot95344","Res1761","Per51711","Ave79667"],Ave79667,"Ave79667")

Actual (Unparsed): [[[0.8585848]]]

Expected (Unparsed): [[[0.8585847600000001]]]

Actual:   [[[0.8586]]]

Expected: [[[0.8586]]]