import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul6952 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Mul6952 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Mul6952 = keras.layers.Multiply(name = 'Mul6952', )([in0Mul6952,in1Mul6952])
Res83776 = keras.layers.Reshape((2, 1, 2), name = 'Res83776', )(Mul6952)
Res96938 = keras.layers.Reshape((2, 2), name = 'Res96938', )(Res83776)
LST59088 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST59088', )(Res96938)
model = tf.keras.models.Model(inputs=[in0Mul6952,in1Mul6952], outputs=LST59088)
w = model.get_layer('LST59088').get_weights() 
w[0] = np.array([[7, 5, 1, 5, 10, 10, 1, 2, 1, 8, 9, 2], [4, 9, 7, 1, 1, 3, 6, 4, 8, 3, 4, 10]])
w[1] = np.array([[3, 1, 9, 2, 4, 9, 6, 3, 3, 4, 4, 9], [1, 6, 8, 8, 9, 6, 2, 7, 8, 7, 7, 7], [7, 3, 1, 8, 5, 1, 2, 7, 8, 2, 10, 6]])
w[2] = np.array([7, 8, 8, 4, 8, 9, 3, 3, 5, 3, 7, 9])
model.get_layer('LST59088').set_weights(w) 
in0Mul6952 = tf.constant([[[[[0.6489, 0.9938]]], [[[0.5711, 0.6354]]]]])
in1Mul6952 = tf.constant([[[[[0.5001, 0.2029]]], [[[0.5322, 0.2146]]]]])
print (np.array2string(model.predict([in0Mul6952,in1Mul6952],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST59088.png')

LMul6952 = multiply_layer([[[[[[0.6489, 0.9938]]], [[[0.5711, 0.6354]]]]], [[[[[0.5001, 0.2029]]], [[[0.5322, 0.2146]]]]]], Mul6952), 
LRes83776 = reshape_layer(Mul6952, [2, 1, 2], Res83776), 
LRes96938 = reshape_layer(Res83776, [2, 2], Res96938), 
LLST59088 = lstm_layer(Res96938,[[7, 5, 1, 5, 10, 10, 1, 2, 1, 8, 9, 2], [4, 9, 7, 1, 1, 3, 6, 4, 8, 3, 4, 10]],[[3, 1, 9, 2, 4, 9, 6, 3, 3, 4, 4, 9], [1, 6, 8, 8, 9, 6, 2, 7, 8, 7, 7, 7], [7, 3, 1, 8, 5, 1, 2, 7, 8, 2, 10, 6]],[7, 8, 8, 4, 8, 9, 3, 3, 5, 3, 7, 9], LST59088), 
exec_layers([LMul6952,LRes83776,LRes96938,LLST59088],["Mul6952","Res83776","Res96938","LST59088"],LST59088,"LST59088")

Actual (Unparsed): [[0.9640082, 0.9640078, 0.9640233]]

Expected (Unparsed): [[0.9640081887623959,0.9640077573540818,0.964023270372921]]

Actual:   [[0.9641, 0.9641, 0.9641]]

Expected: [[0.9641, 0.9641, 0.9641]]