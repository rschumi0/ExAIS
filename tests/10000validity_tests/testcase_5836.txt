import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul65380 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul65380 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave40726 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave40726 = tf.keras.layers.Input(shape=([2, 2]))
in0Add4099 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Add4099 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con75939 = tf.keras.layers.Input(shape=([2, 3]))
in0Ave51080 = tf.keras.layers.Input(shape=([2, 1, 1]))

Mul65380 = keras.layers.Multiply(name = 'Mul65380', )([in0Mul65380,in1Mul65380])
Res31169 = keras.layers.Reshape((1, 1, 1), name = 'Res31169', )(Mul65380)
Res14504 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res14504', )(Res31169)
Zer67479 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer67479', )(Res14504)
Ave40726 = keras.layers.Average(name = 'Ave40726', )([in0Ave40726,in1Ave40726])
Res78934 = keras.layers.Reshape((2, 2, 1), name = 'Res78934', )(Ave40726)
Res16615 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res16615', )(Res78934)
Zer20078 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer20078', )(Res16615)
Add4099 = keras.layers.Add(name = 'Add4099', )([in0Add4099,in1Add4099])
Ave82277 = keras.layers.Average(name = 'Ave82277', )([Zer20078,Add4099])
Ave66813 = keras.layers.Average(name = 'Ave66813', )([Zer67479,Ave82277])
Res40301 = keras.layers.Reshape((2, 2, 2), name = 'Res40301', )(Ave66813)
Res69761 = keras.layers.Reshape((2, 4), name = 'Res69761', )(Res40301)
Con75939 = keras.layers.Concatenate(axis=2, name = 'Con75939', )([Res69761,in0Con75939])
Ave51080 = keras.layers.AveragePooling2D(pool_size=(2, 1), name = 'Ave51080', )(in0Ave51080)
Lea72824 = keras.layers.LeakyReLU(alpha=8.619940131100266, name = 'Lea72824', )(Ave51080)
Res53877 = keras.layers.Reshape((1, 1), name = 'Res53877', )(Lea72824)
Zer2127 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer2127', )(Res53877)
Dot55265 = keras.layers.Dot(axes=(1, 1), name = 'Dot55265', )([Con75939,Zer2127])
model = tf.keras.models.Model(inputs=[in0Mul65380,in1Mul65380,in0Ave40726,in1Ave40726,in0Add4099,in1Add4099,in0Con75939,in0Ave51080], outputs=Dot55265)
in0Mul65380 = tf.constant([[[0.6876]]])
in1Mul65380 = tf.constant([[[0.9113]]])
in0Ave40726 = tf.constant([[[0.6432, 0.7033], [0.9519, 0.501]]])
in1Ave40726 = tf.constant([[[0.8265, 0.2491], [0.6152, 0.4002]]])
in0Add4099 = tf.constant([[[[[0.8368], [0.3625]], [[0.9218], [0.8891]]], [[[0.4833], [0.8844]], [[0.1705], [0.8354]]]]])
in1Add4099 = tf.constant([[[[[0.5472], [0.9708]], [[0.9031], [0.6986]]], [[[0.8764], [0.4248]], [[0.4681], [0.4338]]]]])
in0Con75939 = tf.constant([[[0.9268, 0.5068, 0.2514], [0.2494, 0.0481, 0.3624]]])
in0Ave51080 = tf.constant([[[[1.6526]], [[1.6867]]]])
print (np.array2string(model.predict([in0Mul65380,in1Mul65380,in0Ave40726,in1Ave40726,in0Add4099,in1Add4099,in0Con75939,in0Ave51080],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot55265.png')

LMul65380 = multiply_layer([[[[0.6876]]], [[[0.9113]]]], Mul65380), 
LRes31169 = reshape_layer(Mul65380, [1, 1, 1], Res31169), 
LRes14504 = reshape_layer(Res31169, [1, 1, 1, 1], Res14504), 
LZer67479 = zero_padding3D_layer(Res14504, 1, 0, 1, 0, 1, 0, Zer67479), 
LAve40726 = average_layer([[[[0.6432, 0.7033], [0.9519, 0.501]]], [[[0.8265, 0.2491], [0.6152, 0.4002]]]], Ave40726), 
LRes78934 = reshape_layer(Ave40726, [2, 2, 1], Res78934), 
LRes16615 = reshape_layer(Res78934, [2, 2, 1, 1], Res16615), 
LZer20078 = zero_padding3D_layer(Res16615, 0, 0, 0, 0, 1, 0, Zer20078), 
LAdd4099 = add_layer([[[[[[0.8368], [0.3625]], [[0.9218], [0.8891]]], [[[0.4833], [0.8844]], [[0.1705], [0.8354]]]]], [[[[[0.5472], [0.9708]], [[0.9031], [0.6986]]], [[[0.8764], [0.4248]], [[0.4681], [0.4338]]]]]], Add4099), 
LAve82277 = average_layer([Zer20078,Add4099], Ave82277), 
LAve66813 = average_layer([Zer67479,Ave82277], Ave66813), 
LRes40301 = reshape_layer(Ave66813, [2, 2, 2], Res40301), 
LRes69761 = reshape_layer(Res40301, [2, 4], Res69761), 
LCon75939 = concatenate_layer([Res69761,[[[0.9268, 0.5068, 0.2514], [0.2494, 0.0481, 0.3624]]]], 2, Con75939), 
LAve51080 = average_pooling2D_layer([[[[1.6526]], [[1.6867]]]], 2, 1, Ave51080), 
LLea72824 = leaky_relu_layer(Ave51080, 8.619940131100266, Lea72824), 
LRes53877 = reshape_layer(Lea72824, [1, 1], Res53877), 
LZer2127 = zero_padding1D_layer(Res53877, 1, 0, Zer2127), 
LDot55265 = dot_layer(Con75939,Zer2127, 1, 1, Dot55265), 
exec_layers([LMul65380,LRes31169,LRes14504,LZer67479,LAve40726,LRes78934,LRes16615,LZer20078,LAdd4099,LAve82277,LAve66813,LRes40301,LRes69761,LCon75939,LAve51080,LLea72824,LRes53877,LZer2127,LDot55265],["Mul65380","Res31169","Res14504","Zer67479","Ave40726","Res78934","Res16615","Zer20078","Add4099","Ave82277","Ave66813","Res40301","Res69761","Con75939","Ave51080","Lea72824","Res53877","Zer2127","Dot55265"],Dot55265,"Dot55265")

Actual (Unparsed): [[[0.5675558], [0.8735400], [0.2665596], [1.2409756], [0.4164107], [0.0803102], [0.6050812]]]

Expected (Unparsed): [[[0.56755577625],[0.8735400093749999],[0.26655962250000004],[1.2409756105710001],[0.41641071],[0.080310165],[0.60508116]]]

Actual:   [[[0.5676], [0.8736], [0.2666], [1.241], [0.4165], [0.0804], [0.6051]]]

Expected: [[[0.5676], [0.8736], [0.2666], [1.241], [0.4165], [0.0804], [0.6051]]]