import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max51600 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max51600 = tf.keras.layers.Input(shape=([2, 2, 2]))

Max51600 = keras.layers.Maximum(name = 'Max51600', )([in0Max51600,in1Max51600])
Lea78964 = keras.layers.LeakyReLU(alpha=9.54664307232792, name = 'Lea78964', )(Max51600)
Mas50940 = keras.layers.Masking(mask_value=2, name = 'Mas50940', )(Lea78964)
model = tf.keras.models.Model(inputs=[in0Max51600,in1Max51600], outputs=Mas50940)
in0Max51600 = tf.constant([[[[0.6484, 0.6545], [0.6869, 0.1388]], [[0.2819, 0.4156], [0.1252, 0.5587]]]])
in1Max51600 = tf.constant([[[[0.832, 0.7586], [0.0803, 0.5049]], [[0.3914, 0.7817], [0.9446, 0.5463]]]])
print (np.array2string(model.predict([in0Max51600,in1Max51600],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas50940.png')

LMax51600 = maximum_layer([[[[[0.6484, 0.6545], [0.6869, 0.1388]], [[0.2819, 0.4156], [0.1252, 0.5587]]]], [[[[0.832, 0.7586], [0.0803, 0.5049]], [[0.3914, 0.7817], [0.9446, 0.5463]]]]], Max51600), 
LLea78964 = leaky_relu_layer(Max51600, 9.54664307232792, Lea78964), 
LMas50940 = masking_layer(Lea78964, 2, Mas50940), 
exec_layers([LMax51600,LLea78964,LMas50940],["Max51600","Lea78964","Mas50940"],Mas50940,"Mas50940")

Actual (Unparsed): [[[[0.8320000, 0.7586000], [0.6869000, 0.5049000]], [[0.3914000, 0.7817000], [0.9446000, 0.5587000]]]]

Expected (Unparsed): [[[[0.832,0.7586],[0.6869,0.5049]],[[0.3914,0.7817],[0.9446,0.5587]]]]

Actual:   [[[[0.832, 0.7586], [0.6869, 0.5049]], [[0.3914, 0.7817], [0.9446, 0.5587]]]]

Expected: [[[[0.832, 0.7586], [0.6869, 0.5049]], [[0.3914, 0.7817], [0.9446, 0.5587]]]]