import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub73828 = tf.keras.layers.Input(shape=([2]))
in1Sub73828 = tf.keras.layers.Input(shape=([2]))
in0Den81623 = tf.keras.layers.Input(shape=([5, 4]))

Sub73828 = keras.layers.Subtract(name = 'Sub73828', )([in0Sub73828,in1Sub73828])
Res13263 = keras.layers.Reshape((2, 1), name = 'Res13263', )(Sub73828)
Zer16860 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer16860', )(Res13263)
Den81623 = keras.layers.Dense(1,name = 'Den81623', )(in0Den81623)
Min15945 = keras.layers.Minimum(name = 'Min15945', )([Zer16860,Den81623])
Res56194 = keras.layers.Reshape((5, 1, 1), name = 'Res56194', )(Min15945)
Glo48076 = keras.layers.GlobalMaxPool2D(name = 'Glo48076', )(Res56194)
Mas40553 = keras.layers.Masking(mask_value=1, name = 'Mas40553', )(Glo48076)
model = tf.keras.models.Model(inputs=[in0Sub73828,in1Sub73828,in0Den81623], outputs=Mas40553)
w = model.get_layer('Den81623').get_weights() 
w[0] = np.array([[0.3434], [0.6387], [0.1548], [0.3525]])
w[1] = np.array([0.6044])
model.get_layer('Den81623').set_weights(w) 
in0Sub73828 = tf.constant([[0.8634, 0.7945]])
in1Sub73828 = tf.constant([[0.3731, 0.3991]])
in0Den81623 = tf.constant([[[0.6367, 0.3791, 0.9256, 0.0864], [0.1933, 0.3235, 0.7883, 0.5183], [0.2031, 0.4329, 0.6857, 0.2949], [0.4144, 0.3387, 0.3696, 0.0138], [0.5073, 0.6013, 0.286, 0.3077]]])
print (np.array2string(model.predict([in0Sub73828,in1Sub73828,in0Den81623],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas40553.png')

LSub73828 = subtract_layer([[0.8634, 0.7945]], [[0.3731, 0.3991]], Sub73828), 
LRes13263 = reshape_layer(Sub73828, [2, 1], Res13263), 
LZer16860 = zero_padding1D_layer(Res13263, 3, 0, Zer16860), 
LDen81623 = dense_layer([[[0.6367, 0.3791, 0.9256, 0.0864], [0.1933, 0.3235, 0.7883, 0.5183], [0.2031, 0.4329, 0.6857, 0.2949], [0.4144, 0.3387, 0.3696, 0.0138], [0.5073, 0.6013, 0.286, 0.3077]]], [[0.3434], [0.6387], [0.1548], [0.3525]],[0.6044], Den81623), 
LMin15945 = minimum_layer([Zer16860,Den81623], Min15945), 
LRes56194 = reshape_layer(Min15945, [5, 1, 1], Res56194), 
LGlo48076 = global_max_pool2D_layer(Res56194, Glo48076), 
LMas40553 = masking_layer(Glo48076, 1, Mas40553), 
exec_layers([LSub73828,LRes13263,LZer16860,LDen81623,LMin15945,LRes56194,LGlo48076,LMas40553],["Sub73828","Res13263","Zer16860","Den81623","Min15945","Res56194","Glo48076","Mas40553"],Mas40553,"Mas40553")

Actual (Unparsed): [[0.4903000]]

Expected (Unparsed): [[0.49029999999999996]]

Actual:   [[0.4903]]

Expected: [[0.4903]]