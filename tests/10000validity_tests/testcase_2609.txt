import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST16544 = tf.keras.layers.Input(shape=([1, 2]))

LST16544 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST16544', )(in0LST16544)
Res48275 = keras.layers.Reshape((3, 1), name = 'Res48275', )(LST16544)
Res60865 = keras.layers.Reshape((3, 1, 1), name = 'Res60865', )(Res48275)
Res4120 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res4120', )(Res60865)
Con64532 = keras.layers.Conv3DTranspose(4, (1, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con64532', )(Res4120)
model = tf.keras.models.Model(inputs=[in0LST16544], outputs=Con64532)
w = model.get_layer('LST16544').get_weights() 
w[0] = np.array([[5, 2, 4, 6, 6, 4, 10, 9, 1, 6, 10, 2], [5, 1, 6, 1, 1, 2, 8, 2, 1, 3, 8, 7]])
w[1] = np.array([[10, 3, 3, 6, 10, 5, 6, 3, 10, 2, 3, 9], [7, 1, 7, 10, 3, 6, 2, 3, 9, 6, 2, 2], [9, 2, 4, 7, 5, 1, 4, 8, 2, 6, 2, 1]])
w[2] = np.array([5, 9, 7, 6, 4, 10, 7, 1, 5, 1, 2, 9])
model.get_layer('LST16544').set_weights(w) 
w = model.get_layer('Con64532').get_weights() 
w[0] = np.array([[[[[0.5432], [0.4601], [0.8299], [0.6657]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con64532').set_weights(w) 
in0LST16544 = tf.constant([[[8, 6]]])
print (np.array2string(model.predict([in0LST16544],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con64532.png')

LLST16544 = lstm_layer([[[8, 6]]],[[5, 2, 4, 6, 6, 4, 10, 9, 1, 6, 10, 2], [5, 1, 6, 1, 1, 2, 8, 2, 1, 3, 8, 7]],[[10, 3, 3, 6, 10, 5, 6, 3, 10, 2, 3, 9], [7, 1, 7, 10, 3, 6, 2, 3, 9, 6, 2, 2], [9, 2, 4, 7, 5, 1, 4, 8, 2, 6, 2, 1]],[5, 9, 7, 6, 4, 10, 7, 1, 5, 1, 2, 9], LST16544), 
LRes48275 = reshape_layer(LST16544, [3, 1], Res48275), 
LRes60865 = reshape_layer(Res48275, [3, 1, 1], Res60865), 
LRes4120 = reshape_layer(Res60865, [3, 1, 1, 1], Res4120), 
LCon64532 = conv3D_transpose_layer(Res4120, 1, 1, 1,[[[[[0.5432], [0.4601], [0.8299], [0.6657]]]]],[0, 0, 0, 0], 1, 1, 1, true, Con64532), 
exec_layers([LLST16544,LRes48275,LRes60865,LRes4120,LCon64532],["LST16544","Res48275","Res60865","Res4120","Con64532"],Con64532,"Con64532")

Actual (Unparsed): [[[[[0.4136979, 0.3504095, 0.6320470, 0.5069932]]], [[[0.4136979, 0.3504095, 0.6320470, 0.5069932]]], [[[0.4136979, 0.3504095, 0.6320470, 0.5069932]]]]]

Expected (Unparsed): [[[[[0.4136979455151715,0.3504094711552474,0.6320469900276893,0.5069932296197527]]],[[[0.4136979455151636,0.35040947115524074,0.6320469900276772,0.5069932296197429]]],[[[0.4136979455151715,0.3504094711552474,0.6320469900276893,0.5069932296197527]]]]]

Actual:   [[[[[0.4137, 0.3505, 0.6321, 0.507]]], [[[0.4137, 0.3505, 0.6321, 0.507]]], [[[0.4137, 0.3505, 0.6321, 0.507]]]]]

Expected: [[[[[0.4137, 0.3505, 0.6321, 0.507]]], [[[0.4137, 0.3505, 0.6321, 0.507]]], [[[0.4137, 0.3505, 0.6321, 0.507]]]]]