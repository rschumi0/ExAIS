import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave59992 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave59992 = tf.keras.layers.Input(shape=([1, 2, 2]))

Ave59992 = keras.layers.Average(name = 'Ave59992', )([in0Ave59992,in1Ave59992])
Res79542 = keras.layers.Reshape((1, 4), name = 'Res79542', )(Ave59992)
PRe52780 = keras.layers.PReLU(name = 'PRe52780', )(Res79542)
model = tf.keras.models.Model(inputs=[in0Ave59992,in1Ave59992], outputs=PRe52780)
w = model.get_layer('PRe52780').get_weights() 
w[0] = np.array([[0.4755, 0.0989, 0.1937, 0.4872]])
model.get_layer('PRe52780').set_weights(w) 
in0Ave59992 = tf.constant([[[[0.9668, 0.4397], [0.8974, 0.9852]]]])
in1Ave59992 = tf.constant([[[[0.6144, 0.4935], [0.8505, 0.1977]]]])
print (np.array2string(model.predict([in0Ave59992,in1Ave59992],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe52780.png')

LAve59992 = average_layer([[[[[0.9668, 0.4397], [0.8974, 0.9852]]]], [[[[0.6144, 0.4935], [0.8505, 0.1977]]]]], Ave59992), 
LRes79542 = reshape_layer(Ave59992, [1, 4], Res79542), 
LPRe52780 = prelu_layer(Res79542, [[0.4755, 0.0989, 0.1937, 0.4872]], PRe52780), 
exec_layers([LAve59992,LRes79542,LPRe52780],["Ave59992","Res79542","PRe52780"],PRe52780,"PRe52780")

Actual (Unparsed): [[[0.7906000, 0.4666000, 0.8739500, 0.5914500]]]

Expected (Unparsed): [[[0.7906,0.4666,0.87395,0.59145]]]

Actual:   [[[0.7906, 0.4666, 0.874, 0.5915]]]

Expected: [[[0.7906, 0.4666, 0.874, 0.5915]]]