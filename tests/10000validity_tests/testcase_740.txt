import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add96830 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Add96830 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Min93154 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min93154 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con4253 = tf.keras.layers.Input(shape=([1, 1, 1]))

Add96830 = keras.layers.Add(name = 'Add96830', )([in0Add96830,in1Add96830])
Res89593 = keras.layers.Reshape((2, 1, 2), name = 'Res89593', )(Add96830)
Loc65943 = keras.layers.LocallyConnected2D(2, (2, 1),strides=(1, 1), name = 'Loc65943', )(Res89593)
Min93154 = keras.layers.Minimum(name = 'Min93154', )([in0Min93154,in1Min93154])
Cro92506 = keras.layers.Cropping2D(cropping=((0, 0), (1, 0)), name = 'Cro92506', )(Min93154)
Con4253 = keras.layers.Concatenate(axis=3, name = 'Con4253', )([Cro92506,in0Con4253])
Max22689 = keras.layers.Maximum(name = 'Max22689', )([Loc65943,Con4253])
model = tf.keras.models.Model(inputs=[in0Add96830,in1Add96830,in0Min93154,in1Min93154,in0Con4253], outputs=Max22689)
w = model.get_layer('Loc65943').get_weights() 
w[0] = np.array([[[0.7144, 0.2518], [0.6458, 0.0471], [0.0127, 0.5945], [0.6407, 0.5298]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc65943').set_weights(w) 
in0Add96830 = tf.constant([[[[[0.6254], [0.9684]]], [[[0.479], [0.2802]]]]])
in1Add96830 = tf.constant([[[[[0.6113], [0.816]]], [[[0.652], [0.7295]]]]])
in0Min93154 = tf.constant([[[[0.5166], [0.5535]]]])
in1Min93154 = tf.constant([[[[0.0477], [0.0636]]]])
in0Con4253 = tf.constant([[[[0.2739]]]])
print (np.array2string(model.predict([in0Add96830,in1Add96830,in0Min93154,in1Min93154,in0Con4253],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max22689.png')

LAdd96830 = add_layer([[[[[[0.6254], [0.9684]]], [[[0.479], [0.2802]]]]], [[[[[0.6113], [0.816]]], [[[0.652], [0.7295]]]]]], Add96830), 
LRes89593 = reshape_layer(Add96830, [2, 1, 2], Res89593), 
LLoc65943 = locally_connected2D_layer(Res89593, 2, 1,[[[0.7144, 0.2518], [0.6458, 0.0471], [0.0127, 0.5945], [0.6407, 0.5298]]],[[[0, 0]]], 1, 1, Loc65943), 
LMin93154 = minimum_layer([[[[[0.5166], [0.5535]]]], [[[[0.0477], [0.0636]]]]], Min93154), 
LCro92506 = cropping2D_layer(Min93154, 0, 0, 1, 0, Cro92506), 
LCon4253 = concatenate_layer([Cro92506,[[[[0.2739]]]]], 3, Con4253), 
LMax22689 = maximum_layer([Loc65943,Con4253], Max22689), 
exec_layers([LAdd96830,LRes89593,LLoc65943,LMin93154,LCro92506,LCon4253,LMax22689],["Add96830","Res89593","Loc65943","Min93154","Cro92506","Con4253","Max22689"],Max22689,"Max22689")

Actual (Unparsed): [[[[2.6971425, 1.6027649]]]]

Expected (Unparsed): [[[[2.69714249,1.6027648600000002]]]]

Actual:   [[[[2.6972, 1.6028]]]]

Expected: [[[[2.6972, 1.6028]]]]