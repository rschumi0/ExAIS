import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave96985 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave96985 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min26788 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min26788 = tf.keras.layers.Input(shape=([1, 2, 2]))

Ave96985 = keras.layers.Average(name = 'Ave96985', )([in0Ave96985,in1Ave96985])
Sep90777 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep90777', )(Ave96985)
Ave73467 = keras.layers.AveragePooling2D(pool_size=(2, 1), name = 'Ave73467', )(Sep90777)
Res68518 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res68518', )(Ave73467)
Min26788 = keras.layers.Minimum(name = 'Min26788', )([in0Min26788,in1Min26788])
Res89989 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res89989', )(Min26788)
Cro24750 = keras.layers.Cropping3D(cropping=((0, 0), (1, 0), (1, 0)), name = 'Cro24750', )(Res89989)
Zer25100 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer25100', )(Cro24750)
Add34278 = keras.layers.Add(name = 'Add34278', )([Res68518,Zer25100])
model = tf.keras.models.Model(inputs=[in0Ave96985,in1Ave96985,in0Min26788,in1Min26788], outputs=Add34278)
w = model.get_layer('Sep90777').get_weights() 
w[0] = np.array([[[[0.5884], [0.6453]]]])
w[1] = np.array([[[[0.4778, 0.3333], [0.4883, 0.578]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep90777').set_weights(w) 
in0Ave96985 = tf.constant([[[[0.6861, 0.8135], [0.1218, 0.4605]], [[0.3965, 0.7859], [0.7024, 0.4616]]]])
in1Ave96985 = tf.constant([[[[0.9675, 0.1108], [0.6919, 0.0509]], [[0.5478, 0.2247], [0.9312, 0.4551]]]])
in0Min26788 = tf.constant([[[[0.8517, 0.5426], [0.7176, 0.6661]]]])
in1Min26788 = tf.constant([[[[0.476, 0.7862], [0.778, 0.0167]]]])
print (np.array2string(model.predict([in0Ave96985,in1Ave96985,in0Min26788,in1Min26788],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add34278.png')

LAve96985 = average_layer([[[[[0.6861, 0.8135], [0.1218, 0.4605]], [[0.3965, 0.7859], [0.7024, 0.4616]]]], [[[[0.9675, 0.1108], [0.6919, 0.0509]], [[0.5478, 0.2247], [0.9312, 0.4551]]]]], Ave96985), 
LSep90777 = separable_conv2D_layer(Ave96985, 1, 1,[[[[[0.5884], [0.6453]]]],[[[[0.4778, 0.3333], [0.4883, 0.578]]]]],[0, 0], 1, 1, false, Sep90777), 
LAve73467 = average_pooling2D_layer(Sep90777, 2, 1, Ave73467), 
LRes68518 = reshape_layer(Ave73467, [1, 2, 2, 1], Res68518), 
LMin26788 = minimum_layer([[[[[0.8517, 0.5426], [0.7176, 0.6661]]]], [[[[0.476, 0.7862], [0.778, 0.0167]]]]], Min26788), 
LRes89989 = reshape_layer(Min26788, [1, 2, 2, 1], Res89989), 
LCro24750 = cropping3D_layer(Res89989, 0, 0, 1, 0, 1, 0, Cro24750), 
LZer25100 = zero_padding3D_layer(Cro24750, 0, 0, 1, 0, 1, 0, Zer25100), 
LAdd34278 = add_layer([Res68518,Zer25100], Add34278), 
exec_layers([LAve96985,LSep90777,LAve73467,LRes68518,LMin26788,LRes89989,LCro24750,LZer25100,LAdd34278],["Ave96985","Sep90777","Ave73467","Res68518","Min26788","Res89989","Cro24750","Zer25100","Add34278"],Add34278,"Add34278")

Actual (Unparsed): [[[[[0.3350135], [0.3077924]], [[0.2845055], [0.2698517]]]]]

Expected (Unparsed): [[[[[0.33501353346475],[0.30779235346199996]],[[0.28450553710375004],[0.269851675124]]]]]

Actual:   [[[[[0.3351], [0.3078]], [[0.2846], [0.2699]]]]]

Expected: [[[[[0.3351], [0.3078]], [[0.2846], [0.2699]]]]]