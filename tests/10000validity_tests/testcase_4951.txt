import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul66558 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul66558 = tf.keras.layers.Input(shape=([2, 2]))
in0Ave23614 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Ave23614 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Mul66558 = keras.layers.Multiply(name = 'Mul66558', )([in0Mul66558,in1Mul66558])
Thr36666 = keras.layers.ThresholdedReLU(theta=1.474084394493965, name = 'Thr36666', )(Mul66558)
Ave23614 = keras.layers.Average(name = 'Ave23614', )([in0Ave23614,in1Ave23614])
Res58595 = keras.layers.Reshape((2, 2, 1), name = 'Res58595', )(Ave23614)
Res17746 = keras.layers.Reshape((2, 2), name = 'Res17746', )(Res58595)
Dot68000 = keras.layers.Dot(axes=(2, 1), name = 'Dot68000', )([Thr36666,Res17746])
model = tf.keras.models.Model(inputs=[in0Mul66558,in1Mul66558,in0Ave23614,in1Ave23614], outputs=Dot68000)
in0Mul66558 = tf.constant([[[0.1757, 0.2052], [0.0903, 0.0042]]])
in1Mul66558 = tf.constant([[[0.2407, 0.5882], [0.5761, 0.67]]])
in0Ave23614 = tf.constant([[[[[0.4531]], [[0.2588]]], [[[0.0289]], [[0.691]]]]])
in1Ave23614 = tf.constant([[[[[0.0303]], [[0.8328]]], [[[0.2451]], [[0.3012]]]]])
print (np.array2string(model.predict([in0Mul66558,in1Mul66558,in0Ave23614,in1Ave23614],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot68000.png')

LMul66558 = multiply_layer([[[[0.1757, 0.2052], [0.0903, 0.0042]]], [[[0.2407, 0.5882], [0.5761, 0.67]]]], Mul66558), 
LThr36666 = thresholded_relu_layer(Mul66558, 1.474084394493965, Thr36666), 
LAve23614 = average_layer([[[[[[0.4531]], [[0.2588]]], [[[0.0289]], [[0.691]]]]], [[[[[0.0303]], [[0.8328]]], [[[0.2451]], [[0.3012]]]]]], Ave23614), 
LRes58595 = reshape_layer(Ave23614, [2, 2, 1], Res58595), 
LRes17746 = reshape_layer(Res58595, [2, 2], Res17746), 
LDot68000 = dot_layer(Thr36666,Res17746, 2, 1, Dot68000), 
exec_layers([LMul66558,LThr36666,LAve23614,LRes58595,LRes17746,LDot68000],["Mul66558","Thr36666","Ave23614","Res58595","Res17746","Dot68000"],Dot68000,"Dot68000")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0],[0.0,0.0]]]

Actual:   [[[0, 0], [0, 0]]]

Expected: [[[0, 0], [0, 0]]]