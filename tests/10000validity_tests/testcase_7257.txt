import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay38165 = tf.keras.layers.Input(shape=([3, 2, 4]))
in0Ave28736 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave28736 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Min11304 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min11304 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con25129 = tf.keras.layers.Input(shape=([6]))

Lay38165 = keras.layers.LayerNormalization(axis=2, epsilon=2.2968594387965426, name = 'Lay38165', )(in0Lay38165)
Res34763 = keras.layers.Reshape((3, 2, 4, 1), name = 'Res34763', )(Lay38165)
Ave28736 = keras.layers.Average(name = 'Ave28736', )([in0Ave28736,in1Ave28736])
Zer99098 = keras.layers.ZeroPadding3D(padding=((2, 0), (1, 0), (2, 0)), name = 'Zer99098', )(Ave28736)
Min85898 = keras.layers.Minimum(name = 'Min85898', )([Res34763,Zer99098])
Res48353 = keras.layers.Reshape((3, 2, 4), name = 'Res48353', )(Min85898)
Res57754 = keras.layers.Reshape((3, 8), name = 'Res57754', )(Res48353)
Glo49577 = keras.layers.GlobalMaxPool1D(name = 'Glo49577', )(Res57754)
Min11304 = keras.layers.Minimum(name = 'Min11304', )([in0Min11304,in1Min11304])
Res94496 = keras.layers.Reshape((1, 2), name = 'Res94496', )(Min11304)
Glo90544 = keras.layers.GlobalAveragePooling1D(name = 'Glo90544', )(Res94496)
Con25129 = keras.layers.Concatenate(axis=1, name = 'Con25129', )([Glo90544,in0Con25129])
Mul54350 = keras.layers.Multiply(name = 'Mul54350', )([Glo49577,Con25129])
model = tf.keras.models.Model(inputs=[in0Lay38165,in0Ave28736,in1Ave28736,in0Min11304,in1Min11304,in0Con25129], outputs=Mul54350)
in0Lay38165 = tf.constant([[[[1.3227, 1.4729, 1.0538, 1.5551], [1.4965, 1.4747, 1.4185, 1.758]], [[1.2463, 1.2342, 1.5451, 1.8991], [1.3424, 1.615, 1.4958, 1.1877]], [[1.1043, 1.8753, 1.022, 1.5741], [1.0324, 1.4726, 1.2055, 1.5386]]]])
in0Ave28736 = tf.constant([[[[[0.486], [0.6478]]]]])
in1Ave28736 = tf.constant([[[[[0.0807], [0.795]]]]])
in0Min11304 = tf.constant([[[[0.7192], [0.6585]]]])
in1Min11304 = tf.constant([[[[0.2057], [0.7798]]]])
in0Con25129 = tf.constant([[0.5745, 0.5499, 0.7473, 0.2742, 0.6103, 0.7867]])
print (np.array2string(model.predict([in0Lay38165,in0Ave28736,in1Ave28736,in0Min11304,in1Min11304,in0Con25129],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul54350.png')

LLay38165 = layer_normalization_layer([[[[1.3227, 1.4729, 1.0538, 1.5551], [1.4965, 1.4747, 1.4185, 1.758]], [[1.2463, 1.2342, 1.5451, 1.8991], [1.3424, 1.615, 1.4958, 1.1877]], [[1.1043, 1.8753, 1.022, 1.5741], [1.0324, 1.4726, 1.2055, 1.5386]]]], 2, 2.2968594387965426, Lay38165), 
LRes34763 = reshape_layer(Lay38165, [3, 2, 4, 1], Res34763), 
LAve28736 = average_layer([[[[[[0.486], [0.6478]]]]], [[[[[0.0807], [0.795]]]]]], Ave28736), 
LZer99098 = zero_padding3D_layer(Ave28736, 2, 0, 1, 0, 2, 0, Zer99098), 
LMin85898 = minimum_layer([Res34763,Zer99098], Min85898), 
LRes48353 = reshape_layer(Min85898, [3, 2, 4], Res48353), 
LRes57754 = reshape_layer(Res48353, [3, 8], Res57754), 
LGlo49577 = global_max_pool1D_layer(Res57754, Glo49577), 
LMin11304 = minimum_layer([[[[[0.7192], [0.6585]]]], [[[[0.2057], [0.7798]]]]], Min11304), 
LRes94496 = reshape_layer(Min11304, [1, 2], Res94496), 
LGlo90544 = global_average_pooling1D_layer(Res94496, Glo90544), 
LCon25129 = concatenate_layer([Glo90544,[[0.5745, 0.5499, 0.7473, 0.2742, 0.6103, 0.7867]]], 1, Con25129), 
LMul54350 = multiply_layer([Glo49577,Con25129], Mul54350), 
exec_layers([LLay38165,LRes34763,LAve28736,LZer99098,LMin85898,LRes48353,LRes57754,LGlo49577,LMin11304,LRes94496,LGlo90544,LCon25129,LMul54350],["Lay38165","Res34763","Ave28736","Zer99098","Min85898","Res48353","Res57754","Glo49577","Min11304","Res94496","Glo90544","Con25129","Mul54350"],Mul54350,"Mul54350")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0368797, 0.0000000]]

Expected (Unparsed): [[0.0,0.0,0.0,0.0,0.0,0.0,0.03687973884274626,0.0]]

Actual:   [[0, 0, 0, 0, 0, 0, 0.0369, 0]]

Expected: [[0, 0, 0, 0, 0, 0, 0.0369, 0]]