import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den83409 = tf.keras.layers.Input(shape=([4, 4]))
in0Min71722 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Min71722 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Den83409 = keras.layers.Dense(2,name = 'Den83409', )(in0Den83409)
Glo99254 = keras.layers.GlobalAveragePooling1D(name = 'Glo99254', )(Den83409)
Res31391 = keras.layers.Reshape((2, 1), name = 'Res31391', )(Glo99254)
Min71722 = keras.layers.Minimum(name = 'Min71722', )([in0Min71722,in1Min71722])
ReL3280 = keras.layers.ReLU(max_value=8.45351482396676, negative_slope=3.279340868812172, threshold=5.832754642921056, name = 'ReL3280', )(Min71722)
Res94756 = keras.layers.Reshape((2, 1), name = 'Res94756', )(ReL3280)
Min50175 = keras.layers.Minimum(name = 'Min50175', )([Res31391,Res94756])
model = tf.keras.models.Model(inputs=[in0Den83409,in0Min71722,in1Min71722], outputs=Min50175)
w = model.get_layer('Den83409').get_weights() 
w[0] = np.array([[0.2665, 0.3644], [0.8545, 0.6141], [0.7921, 0.8163], [0.1855, 0.8184]])
w[1] = np.array([0.7827, 0.0367])
model.get_layer('Den83409').set_weights(w) 
in0Den83409 = tf.constant([[[0.0654, 0.0742, 0.4248, 0.0133], [0.2376, 0.6665, 0.2279, 0.0781], [0.4285, 0.9059, 0.8096, 0.5803], [0.4924, 0.5763, 0.8772, 0.8412]]])
in0Min71722 = tf.constant([[[[[0.9854]], [[0.4312]]]]])
in1Min71722 = tf.constant([[[[[0.7053]], [[0.9054]]]]])
print (np.array2string(model.predict([in0Den83409,in0Min71722,in1Min71722],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min50175.png')

LDen83409 = dense_layer([[[0.0654, 0.0742, 0.4248, 0.0133], [0.2376, 0.6665, 0.2279, 0.0781], [0.4285, 0.9059, 0.8096, 0.5803], [0.4924, 0.5763, 0.8772, 0.8412]]], [[0.2665, 0.3644], [0.8545, 0.6141], [0.7921, 0.8163], [0.1855, 0.8184]],[0.7827, 0.0367], Den83409), 
LGlo99254 = global_average_pooling1D_layer(Den83409, Glo99254), 
LRes31391 = reshape_layer(Glo99254, [2, 1], Res31391), 
LMin71722 = minimum_layer([[[[[[0.9854]], [[0.4312]]]]], [[[[[0.7053]], [[0.9054]]]]]], Min71722), 
LReL3280 = relu_layer(Min71722, 8.45351482396676, 3.279340868812172, 5.832754642921056, ReL3280), 
LRes94756 = reshape_layer(ReL3280, [2, 1], Res94756), 
LMin50175 = minimum_layer([Res31391,Res94756], Min50175), 
exec_layers([LDen83409,LGlo99254,LRes31391,LMin71722,LReL3280,LRes94756,LMin50175],["Den83409","Glo99254","Res31391","Min71722","ReL3280","Res94756","Min50175"],Min50175,"Min50175")

Actual (Unparsed): [[[-16.8146717], [-17.7135389]]]

Expected (Unparsed): [[[-16.81467156351174],[-17.71353889565316]]]

Actual:   [[[-16.8146], [-17.7135]]]

Expected: [[[-16.8146], [-17.7135]]]