import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub76599 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub76599 = tf.keras.layers.Input(shape=([3, 2]))
in0Bat86216 = tf.keras.layers.Input(shape=([1]))
in0Fla40530 = tf.keras.layers.Input(shape=([4]))
in0Add99989 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Add99989 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Sub76599 = keras.layers.Subtract(name = 'Sub76599', )([in0Sub76599,in1Sub76599])
Sep67936 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep67936', )(Sub76599)
Res14980 = keras.layers.Reshape((3, 3, 1), name = 'Res14980', )(Sep67936)
Res51167 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res51167', )(Res14980)
Zer23555 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer23555', )(Res51167)
Bat86216 = keras.layers.BatchNormalization(axis=1, epsilon=0.23421836337951848,  name = 'Bat86216', )(in0Bat86216)
Res63132 = keras.layers.Reshape((1, 1), name = 'Res63132', )(Bat86216)
Glo9317 = keras.layers.GlobalAveragePooling1D(name = 'Glo9317', )(Res63132)
Res28699 = keras.layers.Reshape((1, 1), name = 'Res28699', )(Glo9317)
Sep81613 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep81613', )(Res28699)
Res71113 = keras.layers.Reshape((1, 2, 1), name = 'Res71113', )(Sep81613)
Res33257 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res33257', )(Res71113)
Zer73076 = keras.layers.ZeroPadding3D(padding=((3, 0), (1, 0), (0, 0)), name = 'Zer73076', )(Res33257)
Fla40530 = keras.layers.Flatten(name = 'Fla40530', )(in0Fla40530)
Bat2220 = keras.layers.BatchNormalization(axis=1, epsilon=0.9008361250172446,  name = 'Bat2220', )(Fla40530)
Res44165 = keras.layers.Reshape((4, 1), name = 'Res44165', )(Bat2220)
Res18584 = keras.layers.Reshape((4, 1, 1), name = 'Res18584', )(Res44165)
Res28807 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res28807', )(Res18584)
Zer3465 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer3465', )(Res28807)
Add99989 = keras.layers.Add(name = 'Add99989', )([in0Add99989,in1Add99989])
Zer90407 = keras.layers.ZeroPadding3D(padding=((3, 0), (1, 0), (0, 0)), name = 'Zer90407', )(Add99989)
Sub32607 = keras.layers.Subtract(name = 'Sub32607', )([Zer3465,Zer90407])
Sub60989 = keras.layers.Subtract(name = 'Sub60989', )([Zer73076,Sub32607])
Max79105 = keras.layers.Maximum(name = 'Max79105', )([Zer23555,Sub60989])
model = tf.keras.models.Model(inputs=[in0Sub76599,in1Sub76599,in0Bat86216,in0Fla40530,in0Add99989,in1Add99989], outputs=Max79105)
w = model.get_layer('Sep67936').get_weights() 
w[0] = np.array([[[0.3764], [0.3642]]])
w[1] = np.array([[[0.3864, 0.5411, 0.1688], [0.4066, 0.4473, 0.5644]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep67936').set_weights(w) 
w = model.get_layer('Bat86216').get_weights() 
w[0] = np.array([0.5563])
w[1] = np.array([0.6093])
w[2] = np.array([0.3608])
w[3] = np.array([0.4825])
model.get_layer('Bat86216').set_weights(w) 
w = model.get_layer('Sep81613').get_weights() 
w[0] = np.array([[[0.4419]]])
w[1] = np.array([[[0.6929, 0.4333]]])
w[2] = np.array([0, 0])
model.get_layer('Sep81613').set_weights(w) 
w = model.get_layer('Bat2220').get_weights() 
w[0] = np.array([0.1836, 0.3193, 0.5557, 0.2171])
w[1] = np.array([0.629, 0.0334, 0.7465, 0.3308])
w[2] = np.array([0.3554, 0.4292, 0.7813, 0.9682])
w[3] = np.array([0.2039, 0.2027, 0.9447, 0.9043])
model.get_layer('Bat2220').set_weights(w) 
in0Sub76599 = tf.constant([[[0.4537, 0.8018], [0.8979, 0.0959], [0.82, 0.6985]]])
in1Sub76599 = tf.constant([[[0.5796, 0.3427], [0.4941, 0.5297], [0.2617, 0.512]]])
in0Bat86216 = tf.constant([[1.8993]])
in0Fla40530 = tf.constant([[1.7822, 1.4359, 1.9579, 1.6738]])
in0Add99989 = tf.constant([[[[[0.0379]], [[0.055]]]]])
in1Add99989 = tf.constant([[[[[0.2314]], [[0.0505]]]]])
print (np.array2string(model.predict([in0Sub76599,in1Sub76599,in0Bat86216,in0Fla40530,in0Add99989,in1Add99989],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max79105.png')

LSub76599 = subtract_layer([[[0.4537, 0.8018], [0.8979, 0.0959], [0.82, 0.6985]]], [[[0.5796, 0.3427], [0.4941, 0.5297], [0.2617, 0.512]]], Sub76599), 
LSep67936 = separable_conv1D_layer(Sub76599, 1,[[[[0.3764], [0.3642]]],[[[0.3864, 0.5411, 0.1688], [0.4066, 0.4473, 0.5644]]]],[0, 0, 0], 1, false, Sep67936), 
LRes14980 = reshape_layer(Sep67936, [3, 3, 1], Res14980), 
LRes51167 = reshape_layer(Res14980, [3, 3, 1, 1], Res51167), 
LZer23555 = zero_padding3D_layer(Res51167, 1, 0, 0, 0, 0, 0, Zer23555), 
LBat86216 = batch_normalization_layer([[1.8993]], 1, 0.23421836337951848, [0.5563], [0.6093], [0.3608], [0.4825], Bat86216), 
LRes63132 = reshape_layer(Bat86216, [1, 1], Res63132), 
LGlo9317 = global_average_pooling1D_layer(Res63132, Glo9317), 
LRes28699 = reshape_layer(Glo9317, [1, 1], Res28699), 
LSep81613 = separable_conv1D_layer(Res28699, 1,[[[[0.4419]]],[[[0.6929, 0.4333]]]],[0, 0], 1, true, Sep81613), 
LRes71113 = reshape_layer(Sep81613, [1, 2, 1], Res71113), 
LRes33257 = reshape_layer(Res71113, [1, 2, 1, 1], Res33257), 
LZer73076 = zero_padding3D_layer(Res33257, 3, 0, 1, 0, 0, 0, Zer73076), 
LFla40530 = flatten_layer([[1.7822, 1.4359, 1.9579, 1.6738]], Fla40530), 
LBat2220 = batch_normalization_layer(Fla40530, 1, 0.9008361250172446, [0.1836, 0.3193, 0.5557, 0.2171], [0.629, 0.0334, 0.7465, 0.3308], [0.3554, 0.4292, 0.7813, 0.9682], [0.2039, 0.2027, 0.9447, 0.9043], Bat2220), 
LRes44165 = reshape_layer(Bat2220, [4, 1], Res44165), 
LRes18584 = reshape_layer(Res44165, [4, 1, 1], Res18584), 
LRes28807 = reshape_layer(Res18584, [4, 1, 1, 1], Res28807), 
LZer3465 = zero_padding3D_layer(Res28807, 0, 0, 2, 0, 0, 0, Zer3465), 
LAdd99989 = add_layer([[[[[[0.0379]], [[0.055]]]]], [[[[[0.2314]], [[0.0505]]]]]], Add99989), 
LZer90407 = zero_padding3D_layer(Add99989, 3, 0, 1, 0, 0, 0, Zer90407), 
LSub32607 = subtract_layer(Zer3465,Zer90407, Sub32607), 
LSub60989 = subtract_layer(Zer73076,Sub32607, Sub60989), 
LMax79105 = maximum_layer([Zer23555,Sub60989], Max79105), 
exec_layers([LSub76599,LSep67936,LRes14980,LRes51167,LZer23555,LBat86216,LRes63132,LGlo9317,LRes28699,LSep81613,LRes71113,LRes33257,LZer73076,LFla40530,LBat2220,LRes44165,LRes18584,LRes28807,LZer3465,LAdd99989,LZer90407,LSub32607,LSub60989,LMax79105],["Sub76599","Sep67936","Res14980","Res51167","Zer23555","Bat86216","Res63132","Glo9317","Res28699","Sep81613","Res71113","Res33257","Zer73076","Fla40530","Bat2220","Res44165","Res18584","Res28807","Zer3465","Add99989","Zer90407","Sub32607","Sub60989","Max79105"],Max79105,"Max79105")

Actual (Unparsed): [[[[[0.0000000]], [[0.0000000]], [[0.0000000]]], [[[0.0496742]], [[0.0491484]], [[0.0863708]]], [[[0.0000000]], [[0.0115731]], [[-0.0635136]]], [[[0.1088173]], [[0.7654103]], [[0.0738082]]]]]

Expected (Unparsed): [[[[[0]],[[0]],[[0]]],[[[0.049674218988]],[[0.04914838956999999]],[[0.08637083907999998]]],[[[0]],[[0.011573053044000026]],[[-0.06351356740799999]]],[[[0.10881730174800001]],[[0.7654102803152918]],[[0.073808237976]]]]]

Actual:   [[[[[0]], [[0]], [[0]]], [[[0.0497]], [[0.0492]], [[0.0864]]], [[[0]], [[0.0116]], [[-0.0635]]], [[[0.1089]], [[0.7655]], [[0.0739]]]]]

Expected: [[[[[0]], [[0]], [[0]]], [[[0.0497]], [[0.0492]], [[0.0864]]], [[[0]], [[0.0116]], [[-0.0635]]], [[[0.1089]], [[0.7655]], [[0.0739]]]]]