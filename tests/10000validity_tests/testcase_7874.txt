import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul5991 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul5991 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con18361 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con34759 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0LST92494 = tf.keras.layers.Input(shape=([2, 2]))
in0Con67161 = tf.keras.layers.Input(shape=([9]))
in0Sub47741 = tf.keras.layers.Input(shape=([2]))
in1Sub47741 = tf.keras.layers.Input(shape=([2]))
in0Con55654 = tf.keras.layers.Input(shape=([10]))

Mul5991 = keras.layers.Multiply(name = 'Mul5991', )([in0Mul5991,in1Mul5991])
Glo29713 = keras.layers.GlobalAveragePooling2D(name = 'Glo29713', )(Mul5991)
Res13615 = keras.layers.Reshape((2, 1), name = 'Res13615', )(Glo29713)
Res67327 = keras.layers.Reshape((2, 1, 1), name = 'Res67327', )(Res13615)
Con18361 = keras.layers.Concatenate(axis=3, name = 'Con18361', )([Res67327,in0Con18361])
Con34759 = keras.layers.Conv3D(3, (1, 1, 2),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con34759', )(in0Con34759)
Res49374 = keras.layers.Reshape((2, 1, 6), name = 'Res49374', )(Con34759)
Res33747 = keras.layers.Reshape((2, 6), name = 'Res33747', )(Res49374)
Fla4054 = keras.layers.Flatten(name = 'Fla4054', )(Res33747)
LST92494 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST92494', )(in0LST92494)
Con67161 = keras.layers.Concatenate(axis=1, name = 'Con67161', )([LST92494,in0Con67161])
Add83324 = keras.layers.Add(name = 'Add83324', )([Fla4054,Con67161])
Sub47741 = keras.layers.Subtract(name = 'Sub47741', )([in0Sub47741,in1Sub47741])
Con55654 = keras.layers.Concatenate(axis=1, name = 'Con55654', )([Sub47741,in0Con55654])
Sub38764 = keras.layers.Subtract(name = 'Sub38764', )([Add83324,Con55654])
Res68623 = keras.layers.Reshape((12, 1), name = 'Res68623', )(Sub38764)
Res69103 = keras.layers.Reshape((12, 1, 1), name = 'Res69103', )(Res68623)
Sep42204 = keras.layers.SeparableConv2D(3, (12, 1),strides=(10, 10), padding='same', name = 'Sep42204', )(Res69103)
Sub7302 = keras.layers.Subtract(name = 'Sub7302', )([Con18361,Sep42204])
model = tf.keras.models.Model(inputs=[in0Mul5991,in1Mul5991,in0Con18361,in0Con34759,in0LST92494,in0Con67161,in0Sub47741,in1Sub47741,in0Con55654], outputs=Sub7302)
w = model.get_layer('Con34759').get_weights() 
w[0] = np.array([[[[[0.4924, 0.4754, 0.2728], [0.5858, 0.8735, 0.5782]], [[0.8534, 0.0814, 0.6029], [0.3183, 0.9662, 0.3898]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con34759').set_weights(w) 
w = model.get_layer('LST92494').get_weights() 
w[0] = np.array([[4, 1, 2, 9, 2, 6, 7, 3, 7, 2, 3, 10], [4, 6, 9, 1, 10, 6, 8, 7, 4, 9, 9, 1]])
w[1] = np.array([[10, 6, 2, 10, 8, 5, 6, 5, 9, 1, 9, 4], [9, 1, 2, 6, 4, 7, 5, 5, 6, 3, 8, 4], [2, 2, 9, 9, 6, 1, 1, 10, 2, 7, 6, 5]])
w[2] = np.array([10, 3, 6, 3, 8, 6, 6, 7, 1, 6, 2, 7])
model.get_layer('LST92494').set_weights(w) 
w = model.get_layer('Sep42204').get_weights() 
w[0] = np.array([[[[0.4212]]], [[[0.0019]]], [[[0.4612]]], [[[0.8204]]], [[[0.6755]]], [[[0.9957]]], [[[0.8051]]], [[[0.8779]]], [[[0.5335]]], [[[0.0358]]], [[[0.1415]]], [[[0.053]]]])
w[1] = np.array([[[[0.8432, 0.5427, 0.5722]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep42204').set_weights(w) 
in0Mul5991 = tf.constant([[[[0.1237, 0.9563]]]])
in1Mul5991 = tf.constant([[[[0.4046, 0.5892]]]])
in0Con18361 = tf.constant([[[[0.9987, 0.3613]], [[0.0741, 0.1577]]]])
in0Con34759 = tf.constant([[[[[0.899, 0.4963], [0.135, 0.8023]]], [[[0.364, 0.326], [0.8945, 0.1948]]]]])
in0LST92494 = tf.constant([[[5, 8], [9, 3]]])
in0Con67161 = tf.constant([[0.6445, 0.7745, 0.9857, 0.7208, 0.8446, 0.1276, 0.7909, 0.7937, 0.4689]])
in0Sub47741 = tf.constant([[0.6623, 0.2661]])
in1Sub47741 = tf.constant([[0.9414, 0.461]])
in0Con55654 = tf.constant([[0.4987, 0.2844, 0.0636, 0.5625, 0.5216, 0.2143, 0.8938, 0.8302, 0.328, 0.5752]])
print (np.array2string(model.predict([in0Mul5991,in1Mul5991,in0Con18361,in0Con34759,in0LST92494,in0Con67161,in0Sub47741,in1Sub47741,in0Con55654],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub7302.png')

LMul5991 = multiply_layer([[[[[0.1237, 0.9563]]]], [[[[0.4046, 0.5892]]]]], Mul5991), 
LGlo29713 = global_average_pooling2D_layer(Mul5991, Glo29713), 
LRes13615 = reshape_layer(Glo29713, [2, 1], Res13615), 
LRes67327 = reshape_layer(Res13615, [2, 1, 1], Res67327), 
LCon18361 = concatenate_layer([Res67327,[[[[0.9987, 0.3613]], [[0.0741, 0.1577]]]]], 3, Con18361), 
LCon34759 = conv3D_layer([[[[[0.899, 0.4963], [0.135, 0.8023]]], [[[0.364, 0.326], [0.8945, 0.1948]]]]], 1, 1, 2,[[[[[0.4924, 0.4754, 0.2728], [0.5858, 0.8735, 0.5782]], [[0.8534, 0.0814, 0.6029], [0.3183, 0.9662, 0.3898]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con34759), 
LRes49374 = reshape_layer(Con34759, [2, 1, 6], Res49374), 
LRes33747 = reshape_layer(Res49374, [2, 6], Res33747), 
LFla4054 = flatten_layer(Res33747, Fla4054), 
LLST92494 = lstm_layer([[[5, 8], [9, 3]]],[[4, 1, 2, 9, 2, 6, 7, 3, 7, 2, 3, 10], [4, 6, 9, 1, 10, 6, 8, 7, 4, 9, 9, 1]],[[10, 6, 2, 10, 8, 5, 6, 5, 9, 1, 9, 4], [9, 1, 2, 6, 4, 7, 5, 5, 6, 3, 8, 4], [2, 2, 9, 9, 6, 1, 1, 10, 2, 7, 6, 5]],[10, 3, 6, 3, 8, 6, 6, 7, 1, 6, 2, 7], LST92494), 
LCon67161 = concatenate_layer([LST92494,[[0.6445, 0.7745, 0.9857, 0.7208, 0.8446, 0.1276, 0.7909, 0.7937, 0.4689]]], 1, Con67161), 
LAdd83324 = add_layer([Fla4054,Con67161], Add83324), 
LSub47741 = subtract_layer([[0.6623, 0.2661]], [[0.9414, 0.461]], Sub47741), 
LCon55654 = concatenate_layer([Sub47741,[[0.4987, 0.2844, 0.0636, 0.5625, 0.5216, 0.2143, 0.8938, 0.8302, 0.328, 0.5752]]], 1, Con55654), 
LSub38764 = subtract_layer(Add83324,Con55654, Sub38764), 
LRes68623 = reshape_layer(Sub38764, [12, 1], Res68623), 
LRes69103 = reshape_layer(Res68623, [12, 1, 1], Res69103), 
LSep42204 = separable_conv2D_layer(Res69103, 12, 1,[[[[[0.4212]]], [[[0.0019]]], [[[0.4612]]], [[[0.8204]]], [[[0.6755]]], [[[0.9957]]], [[[0.8051]]], [[[0.8779]]], [[[0.5335]]], [[[0.0358]]], [[[0.1415]]], [[[0.053]]]],[[[[0.8432, 0.5427, 0.5722]]]]],[0, 0, 0], 10, 10, true, Sep42204), 
LSub7302 = subtract_layer(Con18361,Sep42204, Sub7302), 
exec_layers([LMul5991,LGlo29713,LRes13615,LRes67327,LCon18361,LCon34759,LRes49374,LRes33747,LFla4054,LLST92494,LCon67161,LAdd83324,LSub47741,LCon55654,LSub38764,LRes68623,LRes69103,LSep42204,LSub7302],["Mul5991","Glo29713","Res13615","Res67327","Con18361","Con34759","Res49374","Res33747","Fla4054","LST92494","Con67161","Add83324","Sub47741","Con55654","Sub38764","Res68623","Res69103","Sep42204","Sub7302"],Sub7302,"Sub7302")

Actual (Unparsed): [[[[-5.4760133, -2.5579817, -3.3887152]], [[-1.7405358, -1.4087916, -1.4057983]]]]

Expected (Unparsed): [[[[-5.476013246785398,-2.5579816795356227,-3.3887152147232045]],[[-1.7405358453845823,-1.408791582047216,-1.4057983660354108]]]]

Actual:   [[[[-5.476, -2.5579, -3.3887]], [[-1.7405, -1.4087, -1.4057]]]]

Expected: [[[[-5.476, -2.5579, -3.3887]], [[-1.7405, -1.4087, -1.4057]]]]