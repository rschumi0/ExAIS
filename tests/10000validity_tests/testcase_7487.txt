import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add8931 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add8931 = tf.keras.layers.Input(shape=([2, 2, 1]))

Add8931 = keras.layers.Add(name = 'Add8931', )([in0Add8931,in1Add8931])
Res74910 = keras.layers.Reshape((2, 2), name = 'Res74910', )(Add8931)
Max43488 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='same', name = 'Max43488', )(Res74910)
Res14490 = keras.layers.Reshape((2, 2, 1), name = 'Res14490', )(Max43488)
Res25125 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res25125', )(Res14490)
Con5019 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con5019', )(Res25125)
Res17082 = keras.layers.Reshape((2, 2, 3), name = 'Res17082', )(Con5019)
Glo85458 = keras.layers.GlobalMaxPool2D(name = 'Glo85458', )(Res17082)
model = tf.keras.models.Model(inputs=[in0Add8931,in1Add8931], outputs=Glo85458)
w = model.get_layer('Con5019').get_weights() 
w[0] = np.array([[[[[0.6174, 0.4689, 0.9596]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con5019').set_weights(w) 
in0Add8931 = tf.constant([[[[0.9145], [0.1185]], [[0.5184], [0.5288]]]])
in1Add8931 = tf.constant([[[[0.4685], [0.8556]], [[0.0255], [0.2703]]]])
print (np.array2string(model.predict([in0Add8931,in1Add8931],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo85458.png')

LAdd8931 = add_layer([[[[[0.9145], [0.1185]], [[0.5184], [0.5288]]]], [[[[0.4685], [0.8556]], [[0.0255], [0.2703]]]]], Add8931), 
LRes74910 = reshape_layer(Add8931, [2, 2], Res74910), 
LMax43488 = max_pool1D_layer(Res74910, 2, 1, true, Max43488), 
LRes14490 = reshape_layer(Max43488, [2, 2, 1], Res14490), 
LRes25125 = reshape_layer(Res14490, [2, 2, 1, 1], Res25125), 
LCon5019 = conv3D_layer(Res25125, 1, 1, 1,[[[[[0.6174, 0.4689, 0.9596]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con5019), 
LRes17082 = reshape_layer(Con5019, [2, 2, 3], Res17082), 
LGlo85458 = global_max_pool2D_layer(Res17082, Glo85458), 
exec_layers([LAdd8931,LRes74910,LMax43488,LRes14490,LRes25125,LCon5019,LRes17082,LGlo85458],["Add8931","Res74910","Max43488","Res14490","Res25125","Con5019","Res17082","Glo85458"],Glo85458,"Glo85458")

Actual (Unparsed): [[0.8538642, 0.6484887, 1.3271268]]

Expected (Unparsed): [[0.8538642,0.6484887,1.3271268]]

Actual:   [[0.8539, 0.6485, 1.3272]]

Expected: [[0.8539, 0.6485, 1.3272]]