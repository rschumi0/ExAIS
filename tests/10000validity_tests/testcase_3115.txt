import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof69102 = tf.keras.layers.Input(shape=([2, 1]))
in0Con94645 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot96620 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot96620 = tf.keras.layers.Input(shape=([3, 3]))

Sof69102 = keras.layers.Softmax(axis=1, name = 'Sof69102', input_shape=(2, 1))(in0Sof69102)
Zer12393 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer12393', )(Sof69102)
Con94645 = keras.layers.Concatenate(axis=2, name = 'Con94645', )([Zer12393,in0Con94645])
Dot96620 = keras.layers.Dot(axes=(1, 2), name = 'Dot96620', )([in0Dot96620,in1Dot96620])
Up_79432 = keras.layers.UpSampling1D(size=(1), name = 'Up_79432', )(Dot96620)
Sub92624 = keras.layers.Subtract(name = 'Sub92624', )([Con94645,Up_79432])
Res91960 = keras.layers.Reshape((3, 3, 1), name = 'Res91960', )(Sub92624)
Sep2178 = keras.layers.SeparableConv2D(2, (3, 3),strides=(3, 3), padding='valid', name = 'Sep2178', )(Res91960)
model = tf.keras.models.Model(inputs=[in0Sof69102,in0Con94645,in0Dot96620,in1Dot96620], outputs=Sep2178)
w = model.get_layer('Sep2178').get_weights() 
w[0] = np.array([[[[0.057]], [[0.7684]], [[0.3394]]], [[[0.128]], [[0.1873]], [[0.5421]]], [[[0.4265]], [[0.5264]], [[0.5756]]]])
w[1] = np.array([[[[0.3127, 0.3031]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep2178').set_weights(w) 
in0Sof69102 = tf.constant([[[0.1068], [0.1167]]])
in0Con94645 = tf.constant([[[0.1486, 0.6557], [0.2423, 0.1305], [0.8386, 0.8873]]])
in0Dot96620 = tf.constant([[[0.8332, 0.2861, 0.4677], [0.7866, 0.7467, 0.9555], [0.8484, 0.4833, 0.6684]]])
in1Dot96620 = tf.constant([[[0.2112, 0.3285, 0.6413], [0.7671, 0.5576, 0.6829], [0.4096, 0.0695, 0.9251]]])
print (np.array2string(model.predict([in0Sof69102,in0Con94645,in0Dot96620,in1Dot96620],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep2178.png')

LSof69102 = softmax_layer([[[0.1068], [0.1167]]], 1, Sof69102), 
LZer12393 = zero_padding1D_layer(Sof69102, 1, 0, Zer12393), 
LCon94645 = concatenate_layer([Zer12393,[[[0.1486, 0.6557], [0.2423, 0.1305], [0.8386, 0.8873]]]], 2, Con94645), 
LDot96620 = dot_layer([[[0.8332, 0.2861, 0.4677], [0.7866, 0.7467, 0.9555], [0.8484, 0.4833, 0.6684]]], [[[0.2112, 0.3285, 0.6413], [0.7671, 0.5576, 0.6829], [0.4096, 0.0695, 0.9251]]], 1, 2, Dot96620), 
LUp_79432 = up_sampling1D_layer(Dot96620, 1, Up_79432), 
LSub92624 = subtract_layer(Con94645,Up_79432, Sub92624), 
LRes91960 = reshape_layer(Sub92624, [3, 3, 1], Res91960), 
LSep2178 = separable_conv2D_layer(Res91960, 3, 3,[[[[[0.057]], [[0.7684]], [[0.3394]]], [[[0.128]], [[0.1873]], [[0.5421]]], [[[0.4265]], [[0.5264]], [[0.5756]]]],[[[[0.3127, 0.3031]]]]],[0, 0], 3, 3, false, Sep2178), 
exec_layers([LSof69102,LZer12393,LCon94645,LDot96620,LUp_79432,LSub92624,LRes91960,LSep2178],["Sof69102","Zer12393","Con94645","Dot96620","Up_79432","Sub92624","Res91960","Sep2178"],Sep2178,"Sep2178")

Actual (Unparsed): [[[[-0.6921364, -0.6708876]]]]

Expected (Unparsed): [[[[-0.6921363796217789,-0.6708875492912094]]]]

Actual:   [[[[-0.6921, -0.6708]]]]

Expected: [[[[-0.6921, -0.6708]]]]