import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min5236 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min5236 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Zer66020 = tf.keras.layers.Input(shape=([3, 2, 1]))

Min5236 = keras.layers.Minimum(name = 'Min5236', )([in0Min5236,in1Min5236])
Res64165 = keras.layers.Reshape((1, 2, 2), name = 'Res64165', )(Min5236)
Res59655 = keras.layers.Reshape((1, 4), name = 'Res59655', )(Res64165)
Per47441 = keras.layers.Permute((2,1), name = 'Per47441',)(Res59655)
Res12591 = keras.layers.Reshape((4, 1, 1), name = 'Res12591', )(Per47441)
Zer80582 = keras.layers.ZeroPadding2D(padding=((1, 0), (3, 0)), name = 'Zer80582', )(Res12591)
Zer66020 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer66020', )(in0Zer66020)
Max78514 = keras.layers.Maximum(name = 'Max78514', )([Zer80582,Zer66020])
model = tf.keras.models.Model(inputs=[in0Min5236,in1Min5236,in0Zer66020], outputs=Max78514)
in0Min5236 = tf.constant([[[[[0.3932, 0.2546]], [[0.2675, 0.1683]]]]])
in1Min5236 = tf.constant([[[[[0.5509, 0.0873]], [[0.3383, 0.9095]]]]])
in0Zer66020 = tf.constant([[[[1.0739], [1.0083]], [[1.7042], [1.5218]], [[1.694], [1.8657]]]])
print (np.array2string(model.predict([in0Min5236,in1Min5236,in0Zer66020],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max78514.png')

LMin5236 = minimum_layer([[[[[[0.3932, 0.2546]], [[0.2675, 0.1683]]]]], [[[[[0.5509, 0.0873]], [[0.3383, 0.9095]]]]]], Min5236), 
LRes64165 = reshape_layer(Min5236, [1, 2, 2], Res64165), 
LRes59655 = reshape_layer(Res64165, [1, 4], Res59655), 
LPer47441 = permute_layer(Res59655, 2,1, Per47441), 
LRes12591 = reshape_layer(Per47441, [4, 1, 1], Res12591), 
LZer80582 = zero_padding2D_layer(Res12591, 1, 0, 3, 0, Zer80582), 
LZer66020 = zero_padding2D_layer([[[[1.0739], [1.0083]], [[1.7042], [1.5218]], [[1.694], [1.8657]]]], 1, 1, 1, 1, Zer66020), 
LMax78514 = maximum_layer([Zer80582,Zer66020], Max78514), 
exec_layers([LMin5236,LRes64165,LRes59655,LPer47441,LRes12591,LZer80582,LZer66020,LMax78514],["Min5236","Res64165","Res59655","Per47441","Res12591","Zer80582","Zer66020","Max78514"],Max78514,"Max78514")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.0739000], [1.0082999], [0.3932000]], [[0.0000000], [1.7042000], [1.5218000], [0.0873000]], [[0.0000000], [1.6940000], [1.8657000], [0.2675000]], [[0.0000000], [0.0000000], [0.0000000], [0.1683000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[1.0739],[1.0083],[0.3932]],[[0],[1.7042],[1.5218],[0.0873]],[[0],[1.694],[1.8657],[0.2675]],[[0],[0],[0],[0.1683]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [1.0739], [1.0083], [0.3932]], [[0], [1.7042], [1.5218], [0.0873]], [[0], [1.694], [1.8657], [0.2675]], [[0], [0], [0], [0.1683]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [1.0739], [1.0083], [0.3932]], [[0], [1.7042], [1.5218], [0.0873]], [[0], [1.694], [1.8657], [0.2675]], [[0], [0], [0], [0.1683]]]]