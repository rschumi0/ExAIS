import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add17614 = tf.keras.layers.Input(shape=([1, 1]))
in1Add17614 = tf.keras.layers.Input(shape=([1, 1]))
in0Con90905 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sep23261 = tf.keras.layers.Input(shape=([2, 2, 2]))

Add17614 = keras.layers.Add(name = 'Add17614', )([in0Add17614,in1Add17614])
Res74375 = keras.layers.Reshape((1, 1, 1), name = 'Res74375', )(Add17614)
Zer94455 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer94455', )(Res74375)
Con90905 = keras.layers.Concatenate(axis=3, name = 'Con90905', )([Zer94455,in0Con90905])
Sep23261 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep23261', )(in0Sep23261)
Den72425 = keras.layers.Dense(3,name = 'Den72425', )(Sep23261)
Ave76739 = keras.layers.Average(name = 'Ave76739', )([Con90905,Den72425])
model = tf.keras.models.Model(inputs=[in0Add17614,in1Add17614,in0Con90905,in0Sep23261], outputs=Ave76739)
w = model.get_layer('Sep23261').get_weights() 
w[0] = np.array([[[[0.3239], [0.0729]]]])
w[1] = np.array([[[[0.7974, 0.4855], [0.1272, 0.0205]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep23261').set_weights(w) 
w = model.get_layer('Den72425').get_weights() 
w[0] = np.array([[0.8122, 0.7002, 0.2352], [0.208, 0.1753, 0.5362]])
w[1] = np.array([0.8255, 0.518, 0.7128])
model.get_layer('Den72425').set_weights(w) 
in0Add17614 = tf.constant([[[0.6557]]])
in1Add17614 = tf.constant([[[0.7811]]])
in0Con90905 = tf.constant([[[[0.812, 0.6082], [0.9303, 0.7124]], [[0.9023, 0.4144], [0.2158, 0.0758]]]])
in0Sep23261 = tf.constant([[[[0.1603, 0.0627], [0.8119, 0.5958]], [[0.1048, 0.97], [0.4291, 0.4197]]]])
print (np.array2string(model.predict([in0Add17614,in1Add17614,in0Con90905,in0Sep23261],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave76739.png')

LAdd17614 = add_layer([[[[0.6557]]], [[[0.7811]]]], Add17614), 
LRes74375 = reshape_layer(Add17614, [1, 1, 1], Res74375), 
LZer94455 = zero_padding2D_layer(Res74375, 1, 0, 1, 0, Zer94455), 
LCon90905 = concatenate_layer([Zer94455,[[[[0.812, 0.6082], [0.9303, 0.7124]], [[0.9023, 0.4144], [0.2158, 0.0758]]]]], 3, Con90905), 
LSep23261 = separable_conv2D_layer([[[[0.1603, 0.0627], [0.8119, 0.5958]], [[0.1048, 0.97], [0.4291, 0.4197]]]], 1, 1,[[[[[0.3239], [0.0729]]]],[[[[0.7974, 0.4855], [0.1272, 0.0205]]]]],[0, 0], 1, 1, false, Sep23261), 
LDen72425 = dense_layer(Sep23261, [[0.8122, 0.7002, 0.2352], [0.208, 0.1753, 0.5362]],[0.8255, 0.518, 0.7128], Den72425), 
LAve76739 = average_layer([Con90905,Den72425], Ave76739), 
exec_layers([LAdd17614,LRes74375,LZer94455,LCon90905,LSep23261,LDen72425,LAve76739],["Add17614","Res74375","Zer94455","Con90905","Sep23261","Den72425","Ave76739"],Ave76739,"Ave76739")

Actual (Unparsed): [[[[0.4324308, 0.6819160, 0.6722206], [0.5135218, 0.8107674, 0.7723781]], [[0.4292596, 0.7243469, 0.5726479], [1.1848202, 0.4130324, 0.4260498]]]]

Expected (Unparsed): [[[[0.4324307873770574,0.681916041365836,0.6722205554192033],[0.5135217809054318,0.810767399550786,0.7723780740258652]],[[0.4292595617507408,0.7243469259330918,0.5726478897852587],[1.1848202143255582,0.4130324468541052,0.42604980128921716]]]]

Actual:   [[[[0.4325, 0.682, 0.6723], [0.5136, 0.8108, 0.7724]], [[0.4293, 0.7244, 0.5727], [1.1849, 0.4131, 0.4261]]]]

Expected: [[[[0.4325, 0.682, 0.6723], [0.5136, 0.8108, 0.7724]], [[0.4293, 0.7244, 0.5727], [1.1849, 0.4131, 0.4261]]]]