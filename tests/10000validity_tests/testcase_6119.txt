import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer51488 = tf.keras.layers.Input(shape=([4, 3]))
in0Con38112 = tf.keras.layers.Input(shape=([29]))
in0Con56205 = tf.keras.layers.Input(shape=([2, 2, 1]))

Zer51488 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer51488', )(in0Zer51488)
Res53046 = keras.layers.Reshape((6, 3, 1), name = 'Res53046', )(Zer51488)
Res21939 = keras.layers.Reshape((6, 3, 1, 1), name = 'Res21939', )(Res53046)
Glo17759 = keras.layers.GlobalMaxPool3D(name = 'Glo17759', )(Res21939)
Res50918 = keras.layers.Reshape((1, 1), name = 'Res50918', )(Glo17759)
PRe67689 = keras.layers.PReLU(name = 'PRe67689', )(Res50918)
Fla65908 = keras.layers.Flatten(name = 'Fla65908', )(PRe67689)
Con38112 = keras.layers.Concatenate(axis=1, name = 'Con38112', )([Fla65908,in0Con38112])
Con56205 = keras.layers.Conv2DTranspose(3, (2, 2),strides=(2, 5), padding='same', name = 'Con56205', )(in0Con56205)
Res71986 = keras.layers.Reshape((4, 30), name = 'Res71986', )(Con56205)
Glo23627 = keras.layers.GlobalAveragePooling1D(name = 'Glo23627', )(Res71986)
Max45605 = keras.layers.Maximum(name = 'Max45605', )([Con38112,Glo23627])
Res2765 = keras.layers.Reshape((30, 1), name = 'Res2765', )(Max45605)
Res64139 = keras.layers.Reshape((30, 1, 1), name = 'Res64139', )(Res2765)
Res77862 = keras.layers.Reshape((30, 1, 1, 1), name = 'Res77862', )(Res64139)
Glo67566 = keras.layers.GlobalAveragePooling3D(name = 'Glo67566', )(Res77862)
model = tf.keras.models.Model(inputs=[in0Zer51488,in0Con38112,in0Con56205], outputs=Glo67566)
w = model.get_layer('PRe67689').get_weights() 
w[0] = np.array([[0.9085]])
model.get_layer('PRe67689').set_weights(w) 
w = model.get_layer('Con56205').get_weights() 
w[0] = np.array([[[[0.9107], [0.3507], [0.572]], [[0.3277], [0.1173], [0.9952]]], [[[0.1973], [0.6465], [0.0664]], [[0.1894], [0.4516], [0.3816]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con56205').set_weights(w) 
in0Zer51488 = tf.constant([[[1.4497, 1.0582, 1.5747], [1.4823, 1.1111, 1.5866], [1.2236, 1.782, 1.1726], [1.9068, 1.6371, 1.4498]]])
in0Con38112 = tf.constant([[0.5108, 0.903, 0.9115, 0.6506, 0.2587, 0.8704, 0.8359, 0.3975, 0.9892, 0.0405, 0.8944, 0.1728, 0.2172, 0.6214, 0.0618, 0.0011, 0.716, 0.6425, 0.4233, 0.3082, 0.7968, 0.3145, 0.2294, 0.0969, 0.3417, 0.7922, 0.8678, 0.9628, 0.527]])
in0Con56205 = tf.constant([[[[0.9448], [0.724]], [[0.6616], [0.0981]]]])
print (np.array2string(model.predict([in0Zer51488,in0Con38112,in0Con56205],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo67566.png')

LZer51488 = zero_padding1D_layer([[[1.4497, 1.0582, 1.5747], [1.4823, 1.1111, 1.5866], [1.2236, 1.782, 1.1726], [1.9068, 1.6371, 1.4498]]], 1, 1, Zer51488), 
LRes53046 = reshape_layer(Zer51488, [6, 3, 1], Res53046), 
LRes21939 = reshape_layer(Res53046, [6, 3, 1, 1], Res21939), 
LGlo17759 = global_max_pool3D_layer(Res21939, Glo17759), 
LRes50918 = reshape_layer(Glo17759, [1, 1], Res50918), 
LPRe67689 = prelu_layer(Res50918, [[0.9085]], PRe67689), 
LFla65908 = flatten_layer(PRe67689, Fla65908), 
LCon38112 = concatenate_layer([Fla65908,[[0.5108, 0.903, 0.9115, 0.6506, 0.2587, 0.8704, 0.8359, 0.3975, 0.9892, 0.0405, 0.8944, 0.1728, 0.2172, 0.6214, 0.0618, 0.0011, 0.716, 0.6425, 0.4233, 0.3082, 0.7968, 0.3145, 0.2294, 0.0969, 0.3417, 0.7922, 0.8678, 0.9628, 0.527]]], 1, Con38112), 
LCon56205 = conv2D_transpose_layer([[[[0.9448], [0.724]], [[0.6616], [0.0981]]]], 2, 2,[[[[0.9107], [0.3507], [0.572]], [[0.3277], [0.1173], [0.9952]]], [[[0.1973], [0.6465], [0.0664]], [[0.1894], [0.4516], [0.3816]]]],[0, 0, 0], 2, 5, true, Con56205), 
LRes71986 = reshape_layer(Con56205, [4, 30], Res71986), 
LGlo23627 = global_average_pooling1D_layer(Res71986, Glo23627), 
LMax45605 = maximum_layer([Con38112,Glo23627], Max45605), 
LRes2765 = reshape_layer(Max45605, [30, 1], Res2765), 
LRes64139 = reshape_layer(Res2765, [30, 1, 1], Res64139), 
LRes77862 = reshape_layer(Res64139, [30, 1, 1, 1], Res77862), 
LGlo67566 = global_average_pooling3D_layer(Res77862, Glo67566), 
exec_layers([LZer51488,LRes53046,LRes21939,LGlo17759,LRes50918,LPRe67689,LFla65908,LCon38112,LCon56205,LRes71986,LGlo23627,LMax45605,LRes2765,LRes64139,LRes77862,LGlo67566],["Zer51488","Res53046","Res21939","Glo17759","Res50918","PRe67689","Fla65908","Con38112","Con56205","Res71986","Glo23627","Max45605","Res2765","Res64139","Res77862","Glo67566"],Glo67566,"Glo67566")

Actual (Unparsed): [[0.5975565]]

Expected (Unparsed): [[0.5975564703333333]]

Actual:   [[0.5976]]

Expected: [[0.5976]]