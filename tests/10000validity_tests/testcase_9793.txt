import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot7123 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot7123 = tf.keras.layers.Input(shape=([2, 2]))

Dot7123 = keras.layers.Dot(axes=(2, 1), name = 'Dot7123', )([in0Dot7123,in1Dot7123])
Res63909 = keras.layers.Reshape((2, 2, 1), name = 'Res63909', )(Dot7123)
Res76087 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res76087', )(Res63909)
Up_98136 = keras.layers.UpSampling3D(size=(1, 2, 1), name = 'Up_98136', )(Res76087)
Res98515 = keras.layers.Reshape((2, 4, 1), name = 'Res98515', )(Up_98136)
Res89986 = keras.layers.Reshape((2, 4), name = 'Res89986', )(Res98515)
Sep7085 = keras.layers.SeparableConv1D(4, (2),strides=(1), padding='valid', name = 'Sep7085', )(Res89986)
model = tf.keras.models.Model(inputs=[in0Dot7123,in1Dot7123], outputs=Sep7085)
w = model.get_layer('Sep7085').get_weights() 
w[0] = np.array([[[0.7239], [0.4415], [0.975], [0.4634]], [[0.5067], [0.2896], [0.4909], [0.7772]]])
w[1] = np.array([[[0.8542, 0.1454, 0.6502, 0.0047], [0.9411, 0.4955, 0.0447, 0.3405], [0.9624, 0.8589, 0.4073, 0.7213], [0.7071, 0.4761, 0.36, 0.6544]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep7085').set_weights(w) 
in0Dot7123 = tf.constant([[[0.8625, 0.2539], [0.4234, 0.5424]]])
in1Dot7123 = tf.constant([[[0.2714, 0.7604], [0.8868, 0.6626]]])
print (np.array2string(model.predict([in0Dot7123,in1Dot7123],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep7085.png')

LDot7123 = dot_layer([[[0.8625, 0.2539], [0.4234, 0.5424]]], [[[0.2714, 0.7604], [0.8868, 0.6626]]], 2, 1, Dot7123), 
LRes63909 = reshape_layer(Dot7123, [2, 2, 1], Res63909), 
LRes76087 = reshape_layer(Res63909, [2, 2, 1, 1], Res76087), 
LUp_98136 = up_sampling3D_layer(Res76087, 1, 2, 1, Up_98136), 
LRes98515 = reshape_layer(Up_98136, [2, 4, 1], Res98515), 
LRes89986 = reshape_layer(Res98515, [2, 4], Res89986), 
LSep7085 = separable_conv1D_layer(Res89986, 2,[[[[0.7239], [0.4415], [0.975], [0.4634]], [[0.5067], [0.2896], [0.4909], [0.7772]]],[[[0.8542, 0.1454, 0.6502, 0.0047], [0.9411, 0.4955, 0.0447, 0.3405], [0.9624, 0.8589, 0.4073, 0.7213], [0.7071, 0.4761, 0.36, 0.6544]]]],[0, 0, 0, 0], 1, false, Sep7085), 
exec_layers([LDot7123,LRes63909,LRes76087,LUp_98136,LRes98515,LRes89986,LSep7085],["Dot7123","Res63909","Res76087","Up_98136","Res98515","Res89986","Sep7085"],Sep7085,"Sep7085")

Actual (Unparsed): [[[2.6347520, 1.6895308, 1.2208585, 1.5480199]]]

Expected (Unparsed): [[[2.6347520230070143,1.6895307844078762,1.2208585361589455,1.5480199214544594]]]

Actual:   [[[2.6348, 1.6896, 1.2209, 1.5481]]]

Expected: [[[2.6348, 1.6896, 1.2209, 1.5481]]]