import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max71932 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Add29483 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add29483 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con72224 = tf.keras.layers.Input(shape=([1]))

Max71932 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(7, 1), padding='valid', name = 'Max71932', )(in0Max71932)
Res56265 = keras.layers.Reshape((1, 2), name = 'Res56265', )(Max71932)
Fla33400 = keras.layers.Flatten(name = 'Fla33400', )(Res56265)
Add29483 = keras.layers.Add(name = 'Add29483', )([in0Add29483,in1Add29483])
Res75523 = keras.layers.Reshape((2, 2), name = 'Res75523', )(Add29483)
LST53455 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST53455', )(Res75523)
Con72224 = keras.layers.Concatenate(axis=1, name = 'Con72224', )([LST53455,in0Con72224])
Ave20041 = keras.layers.Average(name = 'Ave20041', )([Fla33400,Con72224])
Res52105 = keras.layers.Reshape((2, 1), name = 'Res52105', )(Ave20041)
Res4198 = keras.layers.Reshape((2, 1, 1), name = 'Res4198', )(Res52105)
Glo91074 = keras.layers.GlobalMaxPool2D(name = 'Glo91074', )(Res4198)
model = tf.keras.models.Model(inputs=[in0Max71932,in0Add29483,in1Add29483,in0Con72224], outputs=Glo91074)
w = model.get_layer('LST53455').get_weights() 
w[0] = np.array([[3, 3, 6, 9], [6, 10, 7, 9]])
w[1] = np.array([[6, 7, 6, 6]])
w[2] = np.array([4, 5, 4, 5])
model.get_layer('LST53455').set_weights(w) 
in0Max71932 = tf.constant([[[[1.9438, 1.5179]], [[1.0787, 1.8434]]]])
in0Add29483 = tf.constant([[[[0.136, 0.6805]], [[0.6923, 0.2377]]]])
in1Add29483 = tf.constant([[[[0.405, 0.1653]], [[0.5416, 0.593]]]])
in0Con72224 = tf.constant([[0.6638]])
print (np.array2string(model.predict([in0Max71932,in0Add29483,in1Add29483,in0Con72224],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo91074.png')

LMax71932 = max_pool2D_layer([[[[1.9438, 1.5179]], [[1.0787, 1.8434]]]], 1, 1, 7, 1, false, Max71932), 
LRes56265 = reshape_layer(Max71932, [1, 2], Res56265), 
LFla33400 = flatten_layer(Res56265, Fla33400), 
LAdd29483 = add_layer([[[[[0.136, 0.6805]], [[0.6923, 0.2377]]]], [[[[0.405, 0.1653]], [[0.5416, 0.593]]]]], Add29483), 
LRes75523 = reshape_layer(Add29483, [2, 2], Res75523), 
LLST53455 = lstm_layer(Res75523,[[3, 3, 6, 9], [6, 10, 7, 9]],[[6, 7, 6, 6]],[4, 5, 4, 5], LST53455), 
LCon72224 = concatenate_layer([LST53455,[[0.6638]]], 1, Con72224), 
LAve20041 = average_layer([Fla33400,Con72224], Ave20041), 
LRes52105 = reshape_layer(Ave20041, [2, 1], Res52105), 
LRes4198 = reshape_layer(Res52105, [2, 1, 1], Res4198), 
LGlo91074 = global_max_pool2D_layer(Res4198, Glo91074), 
exec_layers([LMax71932,LRes56265,LFla33400,LAdd29483,LRes75523,LLST53455,LCon72224,LAve20041,LRes52105,LRes4198,LGlo91074],["Max71932","Res56265","Fla33400","Add29483","Res75523","LST53455","Con72224","Ave20041","Res52105","Res4198","Glo91074"],Glo91074,"Glo91074")

Actual (Unparsed): [[1.4539130]]

Expected (Unparsed): [[1.4539129907348738]]

Actual:   [[1.454]]

Expected: [[1.454]]