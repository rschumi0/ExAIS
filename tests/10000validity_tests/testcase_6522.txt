import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr41930 = tf.keras.layers.Input(shape=([1, 1]))
in0Con54827 = tf.keras.layers.Input(shape=([20]))
in0Den76713 = tf.keras.layers.Input(shape=([2, 4]))
in0Fla65790 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con62195 = tf.keras.layers.Input(shape=([23]))

Thr41930 = keras.layers.ThresholdedReLU(theta=7.471993491295571, name = 'Thr41930', input_shape=(1, 1))(in0Thr41930)
Res43744 = keras.layers.Reshape((1, 1, 1), name = 'Res43744', )(Thr41930)
Con20041 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 4), padding='valid', name = 'Con20041', )(Res43744)
Res10019 = keras.layers.Reshape((1, 12), name = 'Res10019', )(Con20041)
Sep47838 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep47838', )(Res10019)
Sep47086 = keras.layers.SeparableConv1D(4, (2),strides=(2), padding='same', name = 'Sep47086', )(Sep47838)
Fla76744 = keras.layers.Flatten(name = 'Fla76744', )(Sep47086)
Con54827 = keras.layers.Concatenate(axis=1, name = 'Con54827', )([Fla76744,in0Con54827])
Den76713 = keras.layers.Dense(4,name = 'Den76713', )(in0Den76713)
Res5463 = keras.layers.Reshape((2, 4, 1), name = 'Res5463', )(Den76713)
Zer69757 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer69757', )(Res5463)
Res40210 = keras.layers.Reshape((4, 6), name = 'Res40210', )(Zer69757)
Fla89753 = keras.layers.Flatten(name = 'Fla89753', )(Res40210)
Fla65790 = keras.layers.Flatten(name = 'Fla65790', )(in0Fla65790)
Con62195 = keras.layers.Concatenate(axis=1, name = 'Con62195', )([Fla65790,in0Con62195])
Ave98857 = keras.layers.Average(name = 'Ave98857', )([Fla89753,Con62195])
Max51269 = keras.layers.Maximum(name = 'Max51269', )([Con54827,Ave98857])
Res21473 = keras.layers.Reshape((24, 1), name = 'Res21473', )(Max51269)
Res88024 = keras.layers.Reshape((24, 1, 1), name = 'Res88024', )(Res21473)
Loc58636 = keras.layers.LocallyConnected2D(3, (7, 1),strides=(2, 1), name = 'Loc58636', )(Res88024)
model = tf.keras.models.Model(inputs=[in0Thr41930,in0Con54827,in0Den76713,in0Fla65790,in0Con62195], outputs=Loc58636)
w = model.get_layer('Con20041').get_weights() 
w[0] = np.array([[[[0.8836], [0.3964], [0.6889]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con20041').set_weights(w) 
w = model.get_layer('Sep47838').get_weights() 
w[0] = np.array([[[0.4159], [0.5807], [0.1781], [0.7308], [0.0089], [0.4306], [0.6563], [0.4096], [0.3245], [0.322], [0.4506], [0.1522]]])
w[1] = np.array([[[0.4455, 0.8001], [0.3741, 0.4221], [0.0307, 0.0646], [0.7675, 0.3521], [0.4679, 0.7969], [0.207, 0.427], [0.0414, 0.839], [0.5405, 0.5875], [0.0746, 0.033], [0.6332, 0.8612], [0.4662, 0.7225], [0.7947, 0.9695]]])
w[2] = np.array([0, 0])
model.get_layer('Sep47838').set_weights(w) 
w = model.get_layer('Sep47086').get_weights() 
w[0] = np.array([[[0.2295], [0.5342]], [[0.2937], [0.2761]]])
w[1] = np.array([[[0.3909, 0.7137, 0.6878, 0.5748], [0.5152, 0.6088, 0.0044, 0.3071]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep47086').set_weights(w) 
w = model.get_layer('Den76713').get_weights() 
w[0] = np.array([[0.7425, 0.0514, 0.7419, 0.8203], [0.3563, 0.0906, 0.2868, 0.1906], [0.0766, 0.6128, 0.1085, 0.2417], [0.8273, 0.881, 0.9691, 0.9458]])
w[1] = np.array([0.6447, 0.8698, 0.2327, 0.4613])
model.get_layer('Den76713').set_weights(w) 
w = model.get_layer('Loc58636').get_weights() 
w[0] = np.array([[[0.3415, 0.7615, 0.2555], [0.7458, 0.7577, 0.8052], [0.3882, 0.5052, 0.2574], [0.0524, 0.6628, 0.7795], [0.4668, 0.8575, 0.7723], [0.4529, 0.5454, 0.9934], [0.1956, 0.0286, 0.7144]], [[0.9704, 0.567, 0.7711], [0.9137, 0.9659, 0.9505], [0.0129, 0.7667, 0.1583], [0.4564, 0.1981, 0.6223], [0.2009, 0.5002, 0.0752], [0.8243, 0.5529, 0.1455], [0.8151, 0.5115, 0.3902]], [[0.3945, 0.7337, 0.1921], [0.8616, 0.9939, 0.727], [0.0562, 0.524, 0.3111], [0.4886, 0.4905, 0.8971], [0.0988, 0.0739, 0.5409], [0.2073, 0.5177, 0.3985], [0.1329, 0.5582, 0.6132]], [[0.8143, 0.7058, 0.9619], [0.5544, 0.9938, 0.5388], [0.8899, 0.3331, 0.9719], [0.4593, 0.2651, 0.297], [0.3421, 0.808, 0.1023], [0.8395, 0.2873, 0.5067], [0.3304, 0.8117, 0.3339]], [[0.8274, 0.6768, 0.7304], [0.4657, 0.9902, 0.8842], [0.6608, 0.5031, 0.0328], [0.939, 0.7277, 0.4629], [0.4906, 0.4419, 0.5698], [0.9503, 0.2985, 0.7262], [0.695, 0.4995, 0.9867]], [[0.8371, 0.616, 0.1844], [0.6786, 0.0298, 0.8496], [0.7461, 0.6201, 0.0087], [0.3492, 0.949, 0.9702], [0.7405, 0.7061, 0.8702], [0.3636, 0.2993, 0.5034], [0.3498, 0.3234, 0.8753]], [[0.5349, 0.8868, 0.9407], [0.7681, 0.2118, 0.8511], [0.3703, 0.916, 0.3724], [0.0028, 0.5938, 0.2739], [0.8824, 0.9545, 0.5938], [0.1365, 0.8663, 0.3986], [0.5486, 0.3306, 0.1476]], [[0.6296, 0.9122, 0.0498], [0.4923, 0.1361, 0.2726], [0.9891, 0.5446, 0.8113], [0.6985, 0.3522, 0.9278], [0.6367, 0.8753, 0.2511], [0.8398, 0.5302, 0.7109], [0.9939, 0.6162, 0.4185]], [[0.2476, 0.7669, 0.1556], [0.4926, 0.6533, 0.2555], [0.8081, 0.0361, 0.7883], [0.822, 0.3094, 0.1778], [0.3416, 0.9581, 0.6144], [0.4134, 0.8153, 0.8663], [0.027, 0.7663, 0.6971]]])
w[1] = np.array([[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]])
model.get_layer('Loc58636').set_weights(w) 
in0Thr41930 = tf.constant([[[0.6768]]])
in0Con54827 = tf.constant([[0.5572, 0.7668, 0.9541, 0.8888, 0.0919, 0.1581, 0.3503, 0.3425, 0.8889, 0.4644, 0.328, 0.0045, 0.1589, 0.5822, 0.443, 0.0957, 0.604, 0.1903, 0.4121, 0.8603]])
in0Den76713 = tf.constant([[[0.2884, 0.1311, 0.3999, 0.2817], [0.9813, 0.0415, 0.9128, 0.4559]]])
in0Fla65790 = tf.constant([[[[1.8945]]]])
in0Con62195 = tf.constant([[0.1342, 0.366, 0.7131, 0.138, 0.6812, 0.4531, 0.1273, 0.609, 0.3981, 0.1383, 0.3869, 0.5857, 0.832, 0.5661, 0.7903, 0.1474, 0.4516, 0.9236, 0.2387, 0.4006, 0.9774, 0.2438, 0.297]])
print (np.array2string(model.predict([in0Thr41930,in0Con54827,in0Den76713,in0Fla65790,in0Con62195],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc58636.png')

LThr41930 = thresholded_relu_layer([[[0.6768]]], 7.471993491295571, Thr41930), 
LRes43744 = reshape_layer(Thr41930, [1, 1, 1], Res43744), 
LCon20041 = conv2D_transpose_layer(Res43744, 1, 1,[[[[0.8836], [0.3964], [0.6889]]]],[0, 0, 0], 1, 4, false, Con20041), 
LRes10019 = reshape_layer(Con20041, [1, 12], Res10019), 
LSep47838 = separable_conv1D_layer(Res10019, 1,[[[[0.4159], [0.5807], [0.1781], [0.7308], [0.0089], [0.4306], [0.6563], [0.4096], [0.3245], [0.322], [0.4506], [0.1522]]],[[[0.4455, 0.8001], [0.3741, 0.4221], [0.0307, 0.0646], [0.7675, 0.3521], [0.4679, 0.7969], [0.207, 0.427], [0.0414, 0.839], [0.5405, 0.5875], [0.0746, 0.033], [0.6332, 0.8612], [0.4662, 0.7225], [0.7947, 0.9695]]]],[0, 0], 1, true, Sep47838), 
LSep47086 = separable_conv1D_layer(Sep47838, 2,[[[[0.2295], [0.5342]], [[0.2937], [0.2761]]],[[[0.3909, 0.7137, 0.6878, 0.5748], [0.5152, 0.6088, 0.0044, 0.3071]]]],[0, 0, 0, 0], 2, true, Sep47086), 
LFla76744 = flatten_layer(Sep47086, Fla76744), 
LCon54827 = concatenate_layer([Fla76744,[[0.5572, 0.7668, 0.9541, 0.8888, 0.0919, 0.1581, 0.3503, 0.3425, 0.8889, 0.4644, 0.328, 0.0045, 0.1589, 0.5822, 0.443, 0.0957, 0.604, 0.1903, 0.4121, 0.8603]]], 1, Con54827), 
LDen76713 = dense_layer([[[0.2884, 0.1311, 0.3999, 0.2817], [0.9813, 0.0415, 0.9128, 0.4559]]], [[0.7425, 0.0514, 0.7419, 0.8203], [0.3563, 0.0906, 0.2868, 0.1906], [0.0766, 0.6128, 0.1085, 0.2417], [0.8273, 0.881, 0.9691, 0.9458]],[0.6447, 0.8698, 0.2327, 0.4613], Den76713), 
LRes5463 = reshape_layer(Den76713, [2, 4, 1], Res5463), 
LZer69757 = zero_padding2D_layer(Res5463, 1, 1, 1, 1, Zer69757), 
LRes40210 = reshape_layer(Zer69757, [4, 6], Res40210), 
LFla89753 = flatten_layer(Res40210, Fla89753), 
LFla65790 = flatten_layer([[[[1.8945]]]], Fla65790), 
LCon62195 = concatenate_layer([Fla65790,[[0.1342, 0.366, 0.7131, 0.138, 0.6812, 0.4531, 0.1273, 0.609, 0.3981, 0.1383, 0.3869, 0.5857, 0.832, 0.5661, 0.7903, 0.1474, 0.4516, 0.9236, 0.2387, 0.4006, 0.9774, 0.2438, 0.297]]], 1, Con62195), 
LAve98857 = average_layer([Fla89753,Con62195], Ave98857), 
LMax51269 = maximum_layer([Con54827,Ave98857], Max51269), 
LRes21473 = reshape_layer(Max51269, [24, 1], Res21473), 
LRes88024 = reshape_layer(Res21473, [24, 1, 1], Res88024), 
LLoc58636 = locally_connected2D_layer(Res88024, 7, 1,[[[0.3415, 0.7615, 0.2555], [0.7458, 0.7577, 0.8052], [0.3882, 0.5052, 0.2574], [0.0524, 0.6628, 0.7795], [0.4668, 0.8575, 0.7723], [0.4529, 0.5454, 0.9934], [0.1956, 0.0286, 0.7144]], [[0.9704, 0.567, 0.7711], [0.9137, 0.9659, 0.9505], [0.0129, 0.7667, 0.1583], [0.4564, 0.1981, 0.6223], [0.2009, 0.5002, 0.0752], [0.8243, 0.5529, 0.1455], [0.8151, 0.5115, 0.3902]], [[0.3945, 0.7337, 0.1921], [0.8616, 0.9939, 0.727], [0.0562, 0.524, 0.3111], [0.4886, 0.4905, 0.8971], [0.0988, 0.0739, 0.5409], [0.2073, 0.5177, 0.3985], [0.1329, 0.5582, 0.6132]], [[0.8143, 0.7058, 0.9619], [0.5544, 0.9938, 0.5388], [0.8899, 0.3331, 0.9719], [0.4593, 0.2651, 0.297], [0.3421, 0.808, 0.1023], [0.8395, 0.2873, 0.5067], [0.3304, 0.8117, 0.3339]], [[0.8274, 0.6768, 0.7304], [0.4657, 0.9902, 0.8842], [0.6608, 0.5031, 0.0328], [0.939, 0.7277, 0.4629], [0.4906, 0.4419, 0.5698], [0.9503, 0.2985, 0.7262], [0.695, 0.4995, 0.9867]], [[0.8371, 0.616, 0.1844], [0.6786, 0.0298, 0.8496], [0.7461, 0.6201, 0.0087], [0.3492, 0.949, 0.9702], [0.7405, 0.7061, 0.8702], [0.3636, 0.2993, 0.5034], [0.3498, 0.3234, 0.8753]], [[0.5349, 0.8868, 0.9407], [0.7681, 0.2118, 0.8511], [0.3703, 0.916, 0.3724], [0.0028, 0.5938, 0.2739], [0.8824, 0.9545, 0.5938], [0.1365, 0.8663, 0.3986], [0.5486, 0.3306, 0.1476]], [[0.6296, 0.9122, 0.0498], [0.4923, 0.1361, 0.2726], [0.9891, 0.5446, 0.8113], [0.6985, 0.3522, 0.9278], [0.6367, 0.8753, 0.2511], [0.8398, 0.5302, 0.7109], [0.9939, 0.6162, 0.4185]], [[0.2476, 0.7669, 0.1556], [0.4926, 0.6533, 0.2555], [0.8081, 0.0361, 0.7883], [0.822, 0.3094, 0.1778], [0.3416, 0.9581, 0.6144], [0.4134, 0.8153, 0.8663], [0.027, 0.7663, 0.6971]]],[[[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]], [[0, 0, 0]]], 2, 1, Loc58636), 
exec_layers([LThr41930,LRes43744,LCon20041,LRes10019,LSep47838,LSep47086,LFla76744,LCon54827,LDen76713,LRes5463,LZer69757,LRes40210,LFla89753,LFla65790,LCon62195,LAve98857,LMax51269,LRes21473,LRes88024,LLoc58636],["Thr41930","Res43744","Con20041","Res10019","Sep47838","Sep47086","Fla76744","Con54827","Den76713","Res5463","Zer69757","Res40210","Fla89753","Fla65790","Con62195","Ave98857","Max51269","Res21473","Res88024","Loc58636"],Loc58636,"Loc58636")

Actual (Unparsed): [[[[1.2572595, 2.0242445, 2.4947600]], [[2.5994205, 2.5070965, 1.6364190]], [[1.6727177, 2.8326824, 2.9134289]], [[3.2249345, 3.3629944, 3.0789038]], [[4.3872757, 3.2301179, 4.1227331]], [[3.5627154, 3.7494547, 4.2592066]], [[3.2044456, 4.5238863, 3.6589240]], [[3.7653177, 2.8840348, 2.2098493]], [[1.4342446, 2.5219100, 1.7770521]]]]

Expected (Unparsed): [[[[1.2572595149999999,2.024244465,2.4947599400000002]],[[2.5994204716920004,2.50709650758,1.6364189475839999]],[[1.6727176695764998,2.8326823972360002,2.9134289199250003]],[[3.2249344941505003,3.3629943900850003,3.0789038111085]],[[4.387275709064499,3.2301179480579996,4.1227331433779995]],[[3.5627154312644995,3.7494546598909997,4.2592065412724995]],[[3.2044455712295,4.5238862587165,3.658924040114499]],[[3.7653177399205005,2.884034807415,2.2098492703875]],[[1.4342446526259998,2.5219100683315,1.777052086206]]]]

Actual:   [[[[1.2573, 2.0243, 2.4948]], [[2.5995, 2.5071, 1.6365]], [[1.6728, 2.8327, 2.9135]], [[3.225, 3.363, 3.079]], [[4.3873, 3.2302, 4.1228]], [[3.5628, 3.7495, 4.2593]], [[3.2045, 4.5239, 3.659]], [[3.7654, 2.8841, 2.2099]], [[1.4343, 2.522, 1.7771]]]]

Expected: [[[[1.2573, 2.0243, 2.4948]], [[2.5995, 2.5071, 1.6365]], [[1.6728, 2.8327, 2.9135]], [[3.225, 3.363, 3.079]], [[4.3873, 3.2302, 4.1228]], [[3.5628, 3.7495, 4.2593]], [[3.2045, 4.5239, 3.659]], [[3.7654, 2.8841, 2.2099]], [[1.4343, 2.522, 1.7771]]]]