import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul38248 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul38248 = tf.keras.layers.Input(shape=([2, 1]))

Mul38248 = keras.layers.Multiply(name = 'Mul38248', )([in0Mul38248,in1Mul38248])
GRU10245 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU10245', )(Mul38248)
Res92644 = keras.layers.Reshape((1, 1), name = 'Res92644', )(GRU10245)
Loc25647 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc25647', )(Res92644)
Glo79981 = keras.layers.GlobalAveragePooling1D(name = 'Glo79981', )(Loc25647)
model = tf.keras.models.Model(inputs=[in0Mul38248,in1Mul38248], outputs=Glo79981)
w = model.get_layer('GRU10245').get_weights() 
w[0] = np.array([[8, 6, 5]])
w[1] = np.array([[1, 7, 1]])
w[2] = np.array([[10, 2, 7], [9, 5, 1]])
model.get_layer('GRU10245').set_weights(w) 
w = model.get_layer('Loc25647').get_weights() 
w[0] = np.array([[[0.4067, 0.0849, 0.5917, 0.0717]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc25647').set_weights(w) 
in0Mul38248 = tf.constant([[[0.3118], [0.1459]]])
in1Mul38248 = tf.constant([[[0.7489], [0.405]]])
print (np.array2string(model.predict([in0Mul38248,in1Mul38248],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo79981.png')

LMul38248 = multiply_layer([[[[0.3118], [0.1459]]], [[[0.7489], [0.405]]]], Mul38248), 
LGRU10245 = gru_layer(Mul38248,[[8, 6, 5]],[[1, 7, 1]],[[10, 2, 7], [9, 5, 1]], true, GRU10245), 
LRes92644 = reshape_layer(GRU10245, [1, 1], Res92644), 
LLoc25647 = locally_connected1D_layer(Res92644, 1,[[[0.4067, 0.0849, 0.5917, 0.0717]]],[[0, 0, 0, 0]], 1, Loc25647), 
LGlo79981 = global_average_pooling1D_layer(Loc25647, Glo79981), 
exec_layers([LMul38248,LGRU10245,LRes92644,LLoc25647,LGlo79981],["Mul38248","GRU10245","Res92644","Loc25647","Glo79981"],Glo79981,"Glo79981")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[1.7721813939466559e-9,3.699488575020189e-10,2.578312591094754e-9,3.124303072190195e-10]]

Actual:   [[0, 0, 0, 0]]

Expected: [[0, 0, 0, 0]]