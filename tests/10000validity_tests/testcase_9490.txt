import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max42345 = tf.keras.layers.Input(shape=([2, 2]))
in1Max42345 = tf.keras.layers.Input(shape=([2, 2]))
in0Con73444 = tf.keras.layers.Input(shape=([4]))
in0Fla38711 = tf.keras.layers.Input(shape=([2, 4]))

Max42345 = keras.layers.Maximum(name = 'Max42345', )([in0Max42345,in1Max42345])
Fla84328 = keras.layers.Flatten(name = 'Fla84328', )(Max42345)
Con73444 = keras.layers.Concatenate(axis=1, name = 'Con73444', )([Fla84328,in0Con73444])
Fla38711 = keras.layers.Flatten(name = 'Fla38711', )(in0Fla38711)
Sub80329 = keras.layers.Subtract(name = 'Sub80329', )([Con73444,Fla38711])
model = tf.keras.models.Model(inputs=[in0Max42345,in1Max42345,in0Con73444,in0Fla38711], outputs=Sub80329)
in0Max42345 = tf.constant([[[0.5238, 0.2716], [0.602, 0.9863]]])
in1Max42345 = tf.constant([[[0.5036, 0.3207], [0.6527, 0.6524]]])
in0Con73444 = tf.constant([[0.3606, 0.9825, 0.2328, 0.9696]])
in0Fla38711 = tf.constant([[[1.0428, 1.5499, 1.9374, 1.3547], [1.602, 1.2277, 1.0691, 1.5417]]])
print (np.array2string(model.predict([in0Max42345,in1Max42345,in0Con73444,in0Fla38711],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub80329.png')

LMax42345 = maximum_layer([[[[0.5238, 0.2716], [0.602, 0.9863]]], [[[0.5036, 0.3207], [0.6527, 0.6524]]]], Max42345), 
LFla84328 = flatten_layer(Max42345, Fla84328), 
LCon73444 = concatenate_layer([Fla84328,[[0.3606, 0.9825, 0.2328, 0.9696]]], 1, Con73444), 
LFla38711 = flatten_layer([[[1.0428, 1.5499, 1.9374, 1.3547], [1.602, 1.2277, 1.0691, 1.5417]]], Fla38711), 
LSub80329 = subtract_layer(Con73444,Fla38711, Sub80329), 
exec_layers([LMax42345,LFla84328,LCon73444,LFla38711,LSub80329],["Max42345","Fla84328","Con73444","Fla38711","Sub80329"],Sub80329,"Sub80329")

Actual (Unparsed): [[-0.5189999, -1.2292001, -1.2847000, -0.3684000, -1.2414000, -0.2452000, -0.8363000, -0.5721000]]

Expected (Unparsed): [[-0.5189999999999999,-1.2292,-1.2847,-0.36840000000000006,-1.2414,-0.24519999999999997,-0.8362999999999999,-0.5721]]

Actual:   [[-0.5189, -1.2292, -1.2847, -0.3684, -1.2414, -0.2452, -0.8363, -0.5721]]

Expected: [[-0.5189, -1.2292, -1.2847, -0.3684, -1.2414, -0.2451, -0.8362, -0.5721]]