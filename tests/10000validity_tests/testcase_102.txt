import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min74377 = tf.keras.layers.Input(shape=([1, 1]))
in1Min74377 = tf.keras.layers.Input(shape=([1, 1]))
in0Con59608 = tf.keras.layers.Input(shape=([3, 1]))
in0ReL4523 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Dot65332 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot65332 = tf.keras.layers.Input(shape=([3, 3]))
in0Con96684 = tf.keras.layers.Input(shape=([3, 1]))
in0Con83457 = tf.keras.layers.Input(shape=([3, 4, 1, 1]))
in0Mul45286 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Mul45286 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Min74377 = keras.layers.Minimum(name = 'Min74377', )([in0Min74377,in1Min74377])
Res18587 = keras.layers.Reshape((1, 1, 1), name = 'Res18587', )(Min74377)
Res25760 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res25760', )(Res18587)
Con71007 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con71007', )(Res25760)
Res7447 = keras.layers.Reshape((1, 1, 3), name = 'Res7447', )(Con71007)
Res2332 = keras.layers.Reshape((1, 3), name = 'Res2332', )(Res7447)
Con55680 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con55680', )(Res2332)
Zer19511 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer19511', )(Con55680)
Con59608 = keras.layers.Concatenate(axis=2, name = 'Con59608', )([Zer19511,in0Con59608])
ReL4523 = keras.layers.ReLU(max_value=2.4362332149798913, negative_slope=3.9667843364309108, threshold=6.077326101601176, name = 'ReL4523', input_shape=(2, 2, 1, 2))(in0ReL4523)
Res30875 = keras.layers.Reshape((2, 2, 2), name = 'Res30875', )(ReL4523)
Res23344 = keras.layers.Reshape((2, 4), name = 'Res23344', )(Res30875)
Zer81308 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer81308', )(Res23344)
Dot65332 = keras.layers.Dot(axes=(2, 2), name = 'Dot65332', )([in0Dot65332,in1Dot65332])
Con96684 = keras.layers.Concatenate(axis=2, name = 'Con96684', )([Dot65332,in0Con96684])
Min54065 = keras.layers.Minimum(name = 'Min54065', )([Zer81308,Con96684])
Ave28798 = keras.layers.Average(name = 'Ave28798', )([Con59608,Min54065])
Res29894 = keras.layers.Reshape((3, 4, 1), name = 'Res29894', )(Ave28798)
Res48608 = keras.layers.Reshape((3, 4, 1, 1), name = 'Res48608', )(Res29894)
Con83457 = keras.layers.Concatenate(axis=4, name = 'Con83457', )([Res48608,in0Con83457])
Mul45286 = keras.layers.Multiply(name = 'Mul45286', )([in0Mul45286,in1Mul45286])
Zer46189 = keras.layers.ZeroPadding3D(padding=((1, 0), (2, 0), (0, 0)), name = 'Zer46189', )(Mul45286)
Mul74153 = keras.layers.Multiply(name = 'Mul74153', )([Con83457,Zer46189])
model = tf.keras.models.Model(inputs=[in0Min74377,in1Min74377,in0Con59608,in0ReL4523,in0Dot65332,in1Dot65332,in0Con96684,in0Con83457,in0Mul45286,in1Mul45286], outputs=Mul74153)
w = model.get_layer('Con71007').get_weights() 
w[0] = np.array([[[[[0.412], [0.2337], [0.1258]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con71007').set_weights(w) 
w = model.get_layer('Con55680').get_weights() 
w[0] = np.array([[[0.9717, 0.158, 0.1335], [0.4211, 0.5226, 0.6979], [0.8312, 0.6404, 0.4582]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con55680').set_weights(w) 
in0Min74377 = tf.constant([[[0.4657]]])
in1Min74377 = tf.constant([[[0.6242]]])
in0Con59608 = tf.constant([[[0.6649], [0.0406], [0.111]]])
in0ReL4523 = tf.constant([[[[[0.2861, 0.6668]], [[0.7078, 0.5405]]], [[[0.8941, 0.2009]], [[0.4505, 0.0339]]]]])
in0Dot65332 = tf.constant([[[0.7833, 0.0574, 0.9047], [0.5806, 0.4328, 0.5691], [0.487, 0.0634, 0.312]]])
in1Dot65332 = tf.constant([[[0.7097, 0.2329, 0.5949], [0.6868, 0.8564, 0.8535], [0.8056, 0.8196, 0.809]]])
in0Con96684 = tf.constant([[[0.3508], [0.0853], [0.7094]]])
in0Con83457 = tf.constant([[[[[0.3212]], [[0.404]], [[0.6696]], [[0.1166]]], [[[0.8045]], [[0.1554]], [[0.9093]], [[0.555]]], [[[0.2935]], [[0.9835]], [[0.0274]], [[0.2352]]]]])
in0Mul45286 = tf.constant([[[[[0.3064, 0.7957]], [[0.0551, 0.7792]]], [[[0.8167, 0.11]], [[0.1147, 0.6164]]]]])
in1Mul45286 = tf.constant([[[[[0.1264, 0.2969]], [[0.032, 0.6286]]], [[[0.3797, 0.8342]], [[0.5522, 0.9693]]]]])
print (np.array2string(model.predict([in0Min74377,in1Min74377,in0Con59608,in0ReL4523,in0Dot65332,in1Dot65332,in0Con96684,in0Con83457,in0Mul45286,in1Mul45286],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul74153.png')

LMin74377 = minimum_layer([[[[0.4657]]], [[[0.6242]]]], Min74377), 
LRes18587 = reshape_layer(Min74377, [1, 1, 1], Res18587), 
LRes25760 = reshape_layer(Res18587, [1, 1, 1, 1], Res25760), 
LCon71007 = conv3D_transpose_layer(Res25760, 1, 1, 1,[[[[[0.412], [0.2337], [0.1258]]]]],[0, 0, 0], 1, 1, 1, true, Con71007), 
LRes7447 = reshape_layer(Con71007, [1, 1, 3], Res7447), 
LRes2332 = reshape_layer(Res7447, [1, 3], Res2332), 
LCon55680 = conv1D_layer(Res2332, 1,[[[0.9717, 0.158, 0.1335], [0.4211, 0.5226, 0.6979], [0.8312, 0.6404, 0.4582]]],[0, 0, 0], 1, true, 1, Con55680), 
LZer19511 = zero_padding1D_layer(Con55680, 2, 0, Zer19511), 
LCon59608 = concatenate_layer([Zer19511,[[[0.6649], [0.0406], [0.111]]]], 2, Con59608), 
LReL4523 = relu_layer([[[[[0.2861, 0.6668]], [[0.7078, 0.5405]]], [[[0.8941, 0.2009]], [[0.4505, 0.0339]]]]], 2.4362332149798913, 3.9667843364309108, 6.077326101601176, ReL4523), 
LRes30875 = reshape_layer(ReL4523, [2, 2, 2], Res30875), 
LRes23344 = reshape_layer(Res30875, [2, 4], Res23344), 
LZer81308 = zero_padding1D_layer(Res23344, 1, 0, Zer81308), 
LDot65332 = dot_layer([[[0.7833, 0.0574, 0.9047], [0.5806, 0.4328, 0.5691], [0.487, 0.0634, 0.312]]], [[[0.7097, 0.2329, 0.5949], [0.6868, 0.8564, 0.8535], [0.8056, 0.8196, 0.809]]], 2, 2, Dot65332), 
LCon96684 = concatenate_layer([Dot65332,[[[0.3508], [0.0853], [0.7094]]]], 2, Con96684), 
LMin54065 = minimum_layer([Zer81308,Con96684], Min54065), 
LAve28798 = average_layer([Con59608,Min54065], Ave28798), 
LRes29894 = reshape_layer(Ave28798, [3, 4, 1], Res29894), 
LRes48608 = reshape_layer(Res29894, [3, 4, 1, 1], Res48608), 
LCon83457 = concatenate_layer([Res48608,[[[[[0.3212]], [[0.404]], [[0.6696]], [[0.1166]]], [[[0.8045]], [[0.1554]], [[0.9093]], [[0.555]]], [[[0.2935]], [[0.9835]], [[0.0274]], [[0.2352]]]]]], 4, Con83457), 
LMul45286 = multiply_layer([[[[[[0.3064, 0.7957]], [[0.0551, 0.7792]]], [[[0.8167, 0.11]], [[0.1147, 0.6164]]]]], [[[[[0.1264, 0.2969]], [[0.032, 0.6286]]], [[[0.3797, 0.8342]], [[0.5522, 0.9693]]]]]], Mul45286), 
LZer46189 = zero_padding3D_layer(Mul45286, 1, 0, 2, 0, 0, 0, Zer46189), 
LMul74153 = multiply_layer([Con83457,Zer46189], Mul74153), 
exec_layers([LMin74377,LRes18587,LRes25760,LCon71007,LRes7447,LRes2332,LCon55680,LZer19511,LCon59608,LReL4523,LRes30875,LRes23344,LZer81308,LDot65332,LCon96684,LMin54065,LAve28798,LRes29894,LRes48608,LCon83457,LMul45286,LZer46189,LMul74153],["Min74377","Res18587","Res25760","Con71007","Res7447","Res2332","Con55680","Zer19511","Con59608","ReL4523","Res30875","Res23344","Zer81308","Dot65332","Con96684","Min54065","Ave28798","Res29894","Res48608","Con83457","Mul45286","Zer46189","Mul74153"],Mul74153,"Mul74153")

Actual (Unparsed): [[[[[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]]], [[[-0.0000000, 0.0000000]], [[-0.0000000, 0.0000000]], [[-0.4124586, 0.2148161]], [[-0.0193271, 0.2718419]]], [[[-0.0000000, 0.0000000]], [[-0.0000000, 0.0000000]], [[-3.4408793, 0.0025143]], [[-0.7556768, 0.1405265]]]]]

Expected (Unparsed): [[[[[0,0.0]],[[0,0.0]],[[0,0.0]],[[0.0,0.0]]],[[[-0.0,0.0]],[[-0.0,0.0]],[[-0.41245862226519275,0.21481605996899997]],[[-0.01932713611905396,0.2718418416]]],[[[-0.0,0.0]],[[-0.0,0.0]],[[-3.440879379731587,0.0025142788000000003]],[[-0.7556767900858498,0.140526477504]]]]]

Actual:   [[[[[0, 0]], [[0, 0]], [[0, 0]], [[0, 0]]], [[[-0, 0]], [[-0, 0]], [[-0.4124, 0.2149]], [[-0.0193, 0.2719]]], [[[-0, 0]], [[-0, 0]], [[-3.4408, 0.0026]], [[-0.7556, 0.1406]]]]]

Expected: [[[[[0, 0]], [[0, 0]], [[0, 0]], [[0, 0]]], [[[-0, 0]], [[-0, 0]], [[-0.4124, 0.2149]], [[-0.0193, 0.2719]]], [[[-0, 0]], [[-0, 0]], [[-3.4408, 0.0026]], [[-0.7556, 0.1406]]]]]