import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add68145 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Add68145 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con948 = tf.keras.layers.Input(shape=([1, 4, 1]))
in0Dot50446 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot50446 = tf.keras.layers.Input(shape=([2, 2]))
in0Con32040 = tf.keras.layers.Input(shape=([2, 1]))
in0Den34219 = tf.keras.layers.Input(shape=([2, 4]))
in0Con32529 = tf.keras.layers.Input(shape=([2, 1]))
in0Sep25446 = tf.keras.layers.Input(shape=([1, 1]))

Add68145 = keras.layers.Add(name = 'Add68145', )([in0Add68145,in1Add68145])
Res62567 = keras.layers.Reshape((1, 1, 1), name = 'Res62567', )(Add68145)
Res71936 = keras.layers.Reshape((1, 1), name = 'Res71936', )(Res62567)
Loc23790 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc23790', )(Res71936)
Res79282 = keras.layers.Reshape((1, 4, 1), name = 'Res79282', )(Loc23790)
Con948 = keras.layers.Concatenate(axis=3, name = 'Con948', )([Res79282,in0Con948])
Dot50446 = keras.layers.Dot(axes=(1, 1), name = 'Dot50446', )([in0Dot50446,in1Dot50446])
Con32040 = keras.layers.Concatenate(axis=2, name = 'Con32040', )([Dot50446,in0Con32040])
Den34219 = keras.layers.Dense(2,name = 'Den34219', )(in0Den34219)
Con32529 = keras.layers.Concatenate(axis=2, name = 'Con32529', )([Den34219,in0Con32529])
Sep25446 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep25446', )(in0Sep25446)
Zer58013 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer58013', )(Sep25446)
Add37830 = keras.layers.Add(name = 'Add37830', )([Con32529,Zer58013])
Min25525 = keras.layers.Minimum(name = 'Min25525', )([Con32040,Add37830])
Res45309 = keras.layers.Reshape((2, 3, 1), name = 'Res45309', )(Min25525)
Con85311 = keras.layers.Conv2D(2, (2, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con85311', )(Res45309)
Zer2263 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer2263', )(Con85311)
Min90622 = keras.layers.Minimum(name = 'Min90622', )([Con948,Zer2263])
model = tf.keras.models.Model(inputs=[in0Add68145,in1Add68145,in0Con948,in0Dot50446,in1Dot50446,in0Con32040,in0Den34219,in0Con32529,in0Sep25446], outputs=Min90622)
w = model.get_layer('Loc23790').get_weights() 
w[0] = np.array([[[0.4425, 0.127, 0.2829, 0.1712]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc23790').set_weights(w) 
w = model.get_layer('Den34219').get_weights() 
w[0] = np.array([[0.0908, 0.4742], [0.604, 0.4301], [0.6134, 0.2391], [0.8937, 0.7071]])
w[1] = np.array([0.8035, 0.0914])
model.get_layer('Den34219').set_weights(w) 
w = model.get_layer('Sep25446').get_weights() 
w[0] = np.array([[[0.4991]]])
w[1] = np.array([[[0.8922, 0.7114, 0.9136]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep25446').set_weights(w) 
w = model.get_layer('Con85311').get_weights() 
w[0] = np.array([[[[0.2016, 0.1909]], [[0.1361, 0.874]]], [[[0.3783, 0.1523]], [[0.0924, 0.3732]]]])
w[1] = np.array([0, 0])
model.get_layer('Con85311').set_weights(w) 
in0Add68145 = tf.constant([[[[[0.625]]]]])
in1Add68145 = tf.constant([[[[[0.8082]]]]])
in0Con948 = tf.constant([[[[0.9501], [0.9779], [0.2819], [0.316]]]])
in0Dot50446 = tf.constant([[[0.8065, 0.3633], [0.4752, 0.9855]]])
in1Dot50446 = tf.constant([[[0.2496, 0.959], [0.2023, 0.2702]]])
in0Con32040 = tf.constant([[[0.9479], [0.2698]]])
in0Den34219 = tf.constant([[[0.4297, 0.1923, 0.4613, 0.1633], [0.3663, 0.7359, 0.2639, 0.6377]]])
in0Con32529 = tf.constant([[[0.8251], [0.6463]]])
in0Sep25446 = tf.constant([[[0.9944]]])
print (np.array2string(model.predict([in0Add68145,in1Add68145,in0Con948,in0Dot50446,in1Dot50446,in0Con32040,in0Den34219,in0Con32529,in0Sep25446],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min90622.png')

LAdd68145 = add_layer([[[[[[0.625]]]]], [[[[[0.8082]]]]]], Add68145), 
LRes62567 = reshape_layer(Add68145, [1, 1, 1], Res62567), 
LRes71936 = reshape_layer(Res62567, [1, 1], Res71936), 
LLoc23790 = locally_connected1D_layer(Res71936, 1,[[[0.4425, 0.127, 0.2829, 0.1712]]],[[0, 0, 0, 0]], 1, Loc23790), 
LRes79282 = reshape_layer(Loc23790, [1, 4, 1], Res79282), 
LCon948 = concatenate_layer([Res79282,[[[[0.9501], [0.9779], [0.2819], [0.316]]]]], 3, Con948), 
LDot50446 = dot_layer([[[0.8065, 0.3633], [0.4752, 0.9855]]], [[[0.2496, 0.959], [0.2023, 0.2702]]], 1, 1, Dot50446), 
LCon32040 = concatenate_layer([Dot50446,[[[0.9479], [0.2698]]]], 2, Con32040), 
LDen34219 = dense_layer([[[0.4297, 0.1923, 0.4613, 0.1633], [0.3663, 0.7359, 0.2639, 0.6377]]], [[0.0908, 0.4742], [0.604, 0.4301], [0.6134, 0.2391], [0.8937, 0.7071]],[0.8035, 0.0914], Den34219), 
LCon32529 = concatenate_layer([Den34219,[[[0.8251], [0.6463]]]], 2, Con32529), 
LSep25446 = separable_conv1D_layer([[[0.9944]]], 1,[[[[0.4991]]],[[[0.8922, 0.7114, 0.9136]]]],[0, 0, 0], 1, false, Sep25446), 
LZer58013 = zero_padding1D_layer(Sep25446, 1, 0, Zer58013), 
LAdd37830 = add_layer([Con32529,Zer58013], Add37830), 
LMin25525 = minimum_layer([Con32040,Add37830], Min25525), 
LRes45309 = reshape_layer(Min25525, [2, 3, 1], Res45309), 
LCon85311 = conv2D_layer(Res45309, 2, 2,[[[[0.2016, 0.1909]], [[0.1361, 0.874]]], [[[0.3783, 0.1523]], [[0.0924, 0.3732]]]],[0, 0], 1, 1, false, 1, 1, Con85311), 
LZer2263 = zero_padding2D_layer(Con85311, 0, 0, 2, 0, Zer2263), 
LMin90622 = minimum_layer([Con948,Zer2263], Min90622), 
exec_layers([LAdd68145,LRes62567,LRes71936,LLoc23790,LRes79282,LCon948,LDot50446,LCon32040,LDen34219,LCon32529,LSep25446,LZer58013,LAdd37830,LMin25525,LRes45309,LCon85311,LZer2263,LMin90622],["Add68145","Res62567","Res71936","Loc23790","Res79282","Con948","Dot50446","Con32040","Den34219","Con32529","Sep25446","Zer58013","Add37830","Min25525","Res45309","Con85311","Zer2263","Min90622"],Min90622,"Min90622")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.3086397, 0.2819000], [0.2453638, 0.3160000]]]]

Expected (Unparsed): [[[[0,0],[0,0],[0.308639718638,0.2819],[0.24536384,0.316]]]]

Actual:   [[[[0, 0], [0, 0], [0.3087, 0.2819], [0.2454, 0.316]]]]

Expected: [[[[0, 0], [0, 0], [0.3087, 0.2819], [0.2454, 0.316]]]]