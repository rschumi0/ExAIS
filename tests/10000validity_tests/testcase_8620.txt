import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep20181 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Ave551 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Ave551 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Dot60031 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot60031 = tf.keras.layers.Input(shape=([2, 2]))
in0Sub46472 = tf.keras.layers.Input(shape=([3]))
in1Sub46472 = tf.keras.layers.Input(shape=([3]))
in0Con15188 = tf.keras.layers.Input(shape=([1]))
in0Con40000 = tf.keras.layers.Input(shape=([6, 11]))

Sep20181 = keras.layers.SeparableConv2D(4, (2, 1),strides=(1, 1), padding='same', name = 'Sep20181', )(in0Sep20181)
Res18773 = keras.layers.Reshape((2, 1, 4, 1), name = 'Res18773', )(Sep20181)
Zer82046 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (2, 0)), name = 'Zer82046', )(Res18773)
Ave551 = keras.layers.Average(name = 'Ave551', )([in0Ave551,in1Ave551])
ELU4352 = keras.layers.ELU(alpha=-7.249435220343745, name = 'ELU4352', )(Ave551)
Zer673 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (4, 0)), name = 'Zer673', )(ELU4352)
Sub37483 = keras.layers.Subtract(name = 'Sub37483', )([Zer82046,Zer673])
Res7333 = keras.layers.Reshape((2, 2, 6), name = 'Res7333', )(Sub37483)
Res19279 = keras.layers.Reshape((2, 12), name = 'Res19279', )(Res7333)
Zer47352 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer47352', )(Res19279)
Dot60031 = keras.layers.Dot(axes=(1, 1), name = 'Dot60031', )([in0Dot60031,in1Dot60031])
Fla85167 = keras.layers.Flatten(name = 'Fla85167', )(Dot60031)
Sub46472 = keras.layers.Subtract(name = 'Sub46472', )([in0Sub46472,in1Sub46472])
Con15188 = keras.layers.Concatenate(axis=1, name = 'Con15188', )([Sub46472,in0Con15188])
Min27911 = keras.layers.Minimum(name = 'Min27911', )([Fla85167,Con15188])
Res3205 = keras.layers.Reshape((4, 1), name = 'Res3205', )(Min27911)
Zer50395 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer50395', )(Res3205)
Con40000 = keras.layers.Concatenate(axis=2, name = 'Con40000', )([Zer50395,in0Con40000])
Sub49000 = keras.layers.Subtract(name = 'Sub49000', )([Zer47352,Con40000])
model = tf.keras.models.Model(inputs=[in0Sep20181,in0Ave551,in1Ave551,in0Dot60031,in1Dot60031,in0Sub46472,in1Sub46472,in0Con15188,in0Con40000], outputs=Sub49000)
w = model.get_layer('Sep20181').get_weights() 
w[0] = np.array([[[[0.6251], [0.7147]]], [[[0.1335], [0.5825]]]])
w[1] = np.array([[[[0.8367, 0.0096, 0.9465, 0.8762], [0.1926, 0.5051, 0.717, 0.4083]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep20181').set_weights(w) 
in0Sep20181 = tf.constant([[[[0.7168, 0.6922]], [[0.1698, 0.2056]]]])
in0Ave551 = tf.constant([[[[[0.1467], [0.5388]], [[0.2921], [0.364]]], [[[0.6726], [0.1684]], [[0.9215], [0.3483]]]]])
in1Ave551 = tf.constant([[[[[0.0361], [0.1273]], [[0.452], [0.7332]]], [[[0.0109], [0.3152]], [[0.8769], [0.0351]]]]])
in0Dot60031 = tf.constant([[[0.1095, 0.2622], [0.5335, 0.3611]]])
in1Dot60031 = tf.constant([[[0.3065, 0.8553], [0.5094, 0.8262]]])
in0Sub46472 = tf.constant([[0.5198, 0.9702, 0.4799]])
in1Sub46472 = tf.constant([[0.367, 0.9641, 0.4423]])
in0Con15188 = tf.constant([[0.93]])
in0Con40000 = tf.constant([[[0.8202, 0.1044, 0.2458, 0.2856, 0.8422, 0.9737, 0.2266, 0.8838, 0.5705, 0.6712, 0.869], [0.089, 0.8837, 0.8881, 0.3985, 0.6613, 0.0419, 0.613, 0.949, 0.5231, 0.2283, 0.278], [0.9809, 0.3458, 0.3002, 0.5648, 0.7005, 0.9652, 0.1236, 0.9163, 0.5324, 0.3402, 0.9787], [0.7062, 0.4538, 0.9417, 0.1755, 0.7107, 0.7912, 0.915, 0.1998, 0.9912, 0.9016, 0.0912], [0.4189, 0.5529, 0.0117, 0.9409, 0.6241, 0.1726, 0.372, 0.8627, 0.4557, 0.6046, 0.8003], [0.7769, 0.0685, 0.9677, 0.632, 0.8539, 0.226, 0.4923, 0.0757, 0.3514, 0.3848, 0.9633]]])
print (np.array2string(model.predict([in0Sep20181,in0Ave551,in1Ave551,in0Dot60031,in1Dot60031,in0Sub46472,in1Sub46472,in0Con15188,in0Con40000],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub49000.png')

LSep20181 = separable_conv2D_layer([[[[0.7168, 0.6922]], [[0.1698, 0.2056]]]], 2, 1,[[[[[0.6251], [0.7147]]], [[[0.1335], [0.5825]]]],[[[[0.8367, 0.0096, 0.9465, 0.8762], [0.1926, 0.5051, 0.717, 0.4083]]]]],[0, 0, 0, 0], 1, 1, true, Sep20181), 
LRes18773 = reshape_layer(Sep20181, [2, 1, 4, 1], Res18773), 
LZer82046 = zero_padding3D_layer(Res18773, 0, 0, 1, 0, 2, 0, Zer82046), 
LAve551 = average_layer([[[[[[0.1467], [0.5388]], [[0.2921], [0.364]]], [[[0.6726], [0.1684]], [[0.9215], [0.3483]]]]], [[[[[0.0361], [0.1273]], [[0.452], [0.7332]]], [[[0.0109], [0.3152]], [[0.8769], [0.0351]]]]]], Ave551), 
LELU4352 = elu_layer(Ave551, -7.249435220343745, ELU4352), 
LZer673 = zero_padding3D_layer(ELU4352, 0, 0, 0, 0, 4, 0, Zer673), 
LSub37483 = subtract_layer(Zer82046,Zer673, Sub37483), 
LRes7333 = reshape_layer(Sub37483, [2, 2, 6], Res7333), 
LRes19279 = reshape_layer(Res7333, [2, 12], Res19279), 
LZer47352 = zero_padding1D_layer(Res19279, 4, 0, Zer47352), 
LDot60031 = dot_layer([[[0.1095, 0.2622], [0.5335, 0.3611]]], [[[0.3065, 0.8553], [0.5094, 0.8262]]], 1, 1, Dot60031), 
LFla85167 = flatten_layer(Dot60031, Fla85167), 
LSub46472 = subtract_layer([[0.5198, 0.9702, 0.4799]], [[0.367, 0.9641, 0.4423]], Sub46472), 
LCon15188 = concatenate_layer([Sub46472,[[0.93]]], 1, Con15188), 
LMin27911 = minimum_layer([Fla85167,Con15188], Min27911), 
LRes3205 = reshape_layer(Min27911, [4, 1], Res3205), 
LZer50395 = zero_padding1D_layer(Res3205, 1, 1, Zer50395), 
LCon40000 = concatenate_layer([Zer50395,[[[0.8202, 0.1044, 0.2458, 0.2856, 0.8422, 0.9737, 0.2266, 0.8838, 0.5705, 0.6712, 0.869], [0.089, 0.8837, 0.8881, 0.3985, 0.6613, 0.0419, 0.613, 0.949, 0.5231, 0.2283, 0.278], [0.9809, 0.3458, 0.3002, 0.5648, 0.7005, 0.9652, 0.1236, 0.9163, 0.5324, 0.3402, 0.9787], [0.7062, 0.4538, 0.9417, 0.1755, 0.7107, 0.7912, 0.915, 0.1998, 0.9912, 0.9016, 0.0912], [0.4189, 0.5529, 0.0117, 0.9409, 0.6241, 0.1726, 0.372, 0.8627, 0.4557, 0.6046, 0.8003], [0.7769, 0.0685, 0.9677, 0.632, 0.8539, 0.226, 0.4923, 0.0757, 0.3514, 0.3848, 0.9633]]]], 2, Con40000), 
LSub49000 = subtract_layer(Zer47352,Con40000, Sub49000), 
exec_layers([LSep20181,LRes18773,LZer82046,LAve551,LELU4352,LZer673,LSub37483,LRes7333,LRes19279,LZer47352,LDot60031,LFla85167,LSub46472,LCon15188,LMin27911,LRes3205,LZer50395,LCon40000,LSub49000],["Sep20181","Res18773","Zer82046","Ave551","ELU4352","Zer673","Sub37483","Res7333","Res19279","Zer47352","Dot60031","Fla85167","Sub46472","Con15188","Min27911","Res3205","Zer50395","Con40000","Sub49000"],Sub49000,"Sub49000")

Actual (Unparsed): [[[0.0000000, -0.8202000, -0.1044000, -0.2458000, -0.2856000, -0.8422000, -0.9737000, -0.2266000, -0.8838000, -0.5705000, -0.6712000, -0.8690000], [-0.1528000, -0.0890000, -0.8837000, -0.8881000, -0.3985000, -0.6613000, -0.0419000, -0.6130000, -0.9490000, -0.5231000, -0.2283000, -0.2780000], [-0.0061000, -0.9809000, -0.3458000, -0.3002000, -0.5648000, -0.7005000, -0.9652000, -0.1236000, -0.9163000, -0.5324000, -0.3402000, -0.9787000], [-0.0376000, -0.7062000, -0.4538000, -0.9417000, -0.1755000, -0.7107000, -0.7912000, -0.9150000, -0.1998000, -0.9912000, -0.9016000, -0.0912000], [-0.5226005, -0.4189000, -0.5529000, -0.0117000, -1.0323000, -0.9571500, -0.1726000, -0.3720000, -0.3504835, -0.1408084, -0.0905144, -0.6855466], [0.0000000, -0.7769000, -0.0685000, -0.9677000, -0.9737500, -1.0957000, -0.2260000, -0.4923000, 0.0414101, -0.2761605, -1.0781790, -1.0020018]]]

Expected (Unparsed): [[[0,-0.8202,-0.1044,-0.2458,-0.2856,-0.8422,-0.9737,-0.2266,-0.8838,-0.5705,-0.6712,-0.869],[-0.15280000000000005,-0.089,-0.8837,-0.8881,-0.3985,-0.6613,-0.0419,-0.613,-0.949,-0.5231,-0.2283,-0.278],[-0.006099999999999994,-0.9809,-0.3458,-0.3002,-0.5648,-0.7005,-0.9652,-0.1236,-0.9163,-0.5324,-0.3402,-0.9787],[-0.03759999999999997,-0.7062,-0.4538,-0.9417,-0.1755,-0.7107,-0.7912,-0.915,-0.1998,-0.9912,-0.9016,-0.0912],[-0.5226004799999999,-0.4189,-0.5529,-0.0117,-1.0323,-0.95715,-0.1726,-0.372,-0.35048352304999997,-0.14080839175799997,-0.09051435615000014,-0.685546531602],[0,-0.7769,-0.0685,-0.9677,-0.97375,-1.0957,-0.226,-0.4923,0.04141008549799999,-0.27616047116,-1.07817897249,-1.002001847868]]]

Actual:   [[[0, -0.8202, -0.1044, -0.2458, -0.2856, -0.8422, -0.9737, -0.2266, -0.8838, -0.5705, -0.6712, -0.869], [-0.1528, -0.089, -0.8837, -0.8881, -0.3985, -0.6613, -0.0419, -0.613, -0.949, -0.5231, -0.2283, -0.278], [-0.0061, -0.9809, -0.3458, -0.3002, -0.5648, -0.7005, -0.9652, -0.1236, -0.9163, -0.5324, -0.3402, -0.9787], [-0.0376, -0.7062, -0.4538, -0.9417, -0.1755, -0.7107, -0.7912, -0.915, -0.1998, -0.9912, -0.9016, -0.0912], [-0.5226, -0.4189, -0.5529, -0.0117, -1.0323, -0.9571, -0.1726, -0.372, -0.3504, -0.1408, -0.0905, -0.6855], [0, -0.7769, -0.0685, -0.9677, -0.9737, -1.0957, -0.226, -0.4923, 0.0415, -0.2761, -1.0781, -1.002]]]

Expected: [[[0, -0.8202, -0.1044, -0.2458, -0.2856, -0.8422, -0.9737, -0.2266, -0.8838, -0.5705, -0.6712, -0.869], [-0.1528, -0.089, -0.8837, -0.8881, -0.3985, -0.6613, -0.0419, -0.613, -0.949, -0.5231, -0.2283, -0.278], [-0.006, -0.9809, -0.3458, -0.3002, -0.5648, -0.7005, -0.9652, -0.1236, -0.9163, -0.5324, -0.3402, -0.9787], [-0.0375, -0.7062, -0.4538, -0.9417, -0.1755, -0.7107, -0.7912, -0.915, -0.1998, -0.9912, -0.9016, -0.0912], [-0.5226, -0.4189, -0.5529, -0.0117, -1.0323, -0.9571, -0.1726, -0.372, -0.3504, -0.1408, -0.0905, -0.6855], [0, -0.7769, -0.0685, -0.9677, -0.9737, -1.0957, -0.226, -0.4923, 0.0415, -0.2761, -1.0781, -1.002]]]