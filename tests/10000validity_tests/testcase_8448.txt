import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep18341 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave1046 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Ave1046 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con37367 = tf.keras.layers.Input(shape=([2, 4, 2, 1]))
in0Sub71187 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))
in1Sub71187 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))
in0Ave72704 = tf.keras.layers.Input(shape=([2, 1, 2]))

Sep18341 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep18341', )(in0Sep18341)
Res23114 = keras.layers.Reshape((1, 3, 1), name = 'Res23114', )(Sep18341)
Res31181 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res31181', )(Res23114)
Zer48362 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer48362', )(Res31181)
Ave1046 = keras.layers.Average(name = 'Ave1046', )([in0Ave1046,in1Ave1046])
Zer67268 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer67268', )(Ave1046)
Sub36879 = keras.layers.Subtract(name = 'Sub36879', )([Zer48362,Zer67268])
Con37367 = keras.layers.Concatenate(axis=4, name = 'Con37367', )([Sub36879,in0Con37367])
Sub71187 = keras.layers.Subtract(name = 'Sub71187', )([in0Sub71187,in1Sub71187])
Zer11172 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer11172', )(Sub71187)
Sub24856 = keras.layers.Subtract(name = 'Sub24856', )([Con37367,Zer11172])
Res24119 = keras.layers.Reshape((2, 4, 4), name = 'Res24119', )(Sub24856)
Sep91142 = keras.layers.SeparableConv2D(2, (2, 1),strides=(2, 2), padding='same', name = 'Sep91142', )(Res24119)
Zer45168 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer45168', )(Sep91142)
Ave72704 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave72704', )(in0Ave72704)
Zer9509 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer9509', )(Ave72704)
Max93412 = keras.layers.Maximum(name = 'Max93412', )([Zer45168,Zer9509])
model = tf.keras.models.Model(inputs=[in0Sep18341,in0Ave1046,in1Ave1046,in0Con37367,in0Sub71187,in1Sub71187,in0Ave72704], outputs=Max93412)
w = model.get_layer('Sep18341').get_weights() 
w[0] = np.array([[[0.7846]]])
w[1] = np.array([[[0.4794, 0.7842, 0.6264]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep18341').set_weights(w) 
w = model.get_layer('Sep91142').get_weights() 
w[0] = np.array([[[[0.2031], [0.8346], [0.1091], [0.4448]]], [[[0.8065], [0.1473], [0.9768], [0.2355]]]])
w[1] = np.array([[[[0.39, 0.2326], [0.6097, 0.3576], [0.1779, 0.3044], [0.2902, 0.9721]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep91142').set_weights(w) 
in0Sep18341 = tf.constant([[[0.6361]]])
in0Ave1046 = tf.constant([[[[[0.3448], [0.0098]], [[0.4527], [0.1253]]], [[[0.5933], [0.7376]], [[0.5843], [0.1734]]]]])
in1Ave1046 = tf.constant([[[[[0.6719], [0.3332]], [[0.3354], [0.3938]]], [[[0.592], [0.6016]], [[0.2864], [0.8269]]]]])
in0Con37367 = tf.constant([[[[[0.9859], [0.179]], [[0.4318], [0.1226]], [[0.2724], [0.9918]], [[0.7112], [0.4645]]], [[[0.1545], [0.0909]], [[0.7667], [0.403]], [[0.2391], [0.9561]], [[0.2802], [0.0806]]]]])
in0Sub71187 = tf.constant([[[[[0.0742, 0.3825], [0.0013, 0.9514]], [[0.9959, 0.2192], [0.5891, 0.0739]], [[0.43, 0.5778], [0.9256, 0.6018]]], [[[0.6873, 0.244], [0.5795, 0.3683]], [[0.5146, 0.6518], [0.8045, 0.0078]], [[0.7478, 0.6733], [0.1827, 0.3601]]]]])
in1Sub71187 = tf.constant([[[[[0.2664, 0.8345], [0.6348, 0.0177]], [[0.0612, 0.014], [0.5485, 0.4283]], [[0.5824, 0.4263], [0.7182, 0.4099]]], [[[0.3147, 0.0969], [0.6393, 0.5478]], [[0.6947, 0.0939], [0.4539, 0.6996]], [[0.0752, 0.4986], [0.5062, 0.7595]]]]])
in0Ave72704 = tf.constant([[[[1.4272, 1.4686]], [[1.0334, 1.9023]]]])
print (np.array2string(model.predict([in0Sep18341,in0Ave1046,in1Ave1046,in0Con37367,in0Sub71187,in1Sub71187,in0Ave72704],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max93412.png')

LSep18341 = separable_conv1D_layer([[[0.6361]]], 1,[[[[0.7846]]],[[[0.4794, 0.7842, 0.6264]]]],[0, 0, 0], 1, false, Sep18341), 
LRes23114 = reshape_layer(Sep18341, [1, 3, 1], Res23114), 
LRes31181 = reshape_layer(Res23114, [1, 3, 1, 1], Res31181), 
LZer48362 = zero_padding3D_layer(Res31181, 1, 0, 1, 0, 1, 0, Zer48362), 
LAve1046 = average_layer([[[[[[0.3448], [0.0098]], [[0.4527], [0.1253]]], [[[0.5933], [0.7376]], [[0.5843], [0.1734]]]]], [[[[[0.6719], [0.3332]], [[0.3354], [0.3938]]], [[[0.592], [0.6016]], [[0.2864], [0.8269]]]]]], Ave1046), 
LZer67268 = zero_padding3D_layer(Ave1046, 0, 0, 2, 0, 0, 0, Zer67268), 
LSub36879 = subtract_layer(Zer48362,Zer67268, Sub36879), 
LCon37367 = concatenate_layer([Sub36879,[[[[[0.9859], [0.179]], [[0.4318], [0.1226]], [[0.2724], [0.9918]], [[0.7112], [0.4645]]], [[[0.1545], [0.0909]], [[0.7667], [0.403]], [[0.2391], [0.9561]], [[0.2802], [0.0806]]]]]], 4, Con37367), 
LSub71187 = subtract_layer([[[[[0.0742, 0.3825], [0.0013, 0.9514]], [[0.9959, 0.2192], [0.5891, 0.0739]], [[0.43, 0.5778], [0.9256, 0.6018]]], [[[0.6873, 0.244], [0.5795, 0.3683]], [[0.5146, 0.6518], [0.8045, 0.0078]], [[0.7478, 0.6733], [0.1827, 0.3601]]]]], [[[[[0.2664, 0.8345], [0.6348, 0.0177]], [[0.0612, 0.014], [0.5485, 0.4283]], [[0.5824, 0.4263], [0.7182, 0.4099]]], [[[0.3147, 0.0969], [0.6393, 0.5478]], [[0.6947, 0.0939], [0.4539, 0.6996]], [[0.0752, 0.4986], [0.5062, 0.7595]]]]], Sub71187), 
LZer11172 = zero_padding3D_layer(Sub71187, 0, 0, 1, 0, 0, 0, Zer11172), 
LSub24856 = subtract_layer(Con37367,Zer11172, Sub24856), 
LRes24119 = reshape_layer(Sub24856, [2, 4, 4], Res24119), 
LSep91142 = separable_conv2D_layer(Res24119, 2, 1,[[[[[0.2031], [0.8346], [0.1091], [0.4448]]], [[[0.8065], [0.1473], [0.9768], [0.2355]]]],[[[[0.39, 0.2326], [0.6097, 0.3576], [0.1779, 0.3044], [0.2902, 0.9721]]]]],[0, 0], 2, 2, true, Sep91142), 
LZer45168 = zero_padding2D_layer(Sep91142, 1, 0, 1, 0, Zer45168), 
LAve72704 = average_pooling2D_layer([[[[1.4272, 1.4686]], [[1.0334, 1.9023]]]], 1, 1, Ave72704), 
LZer9509 = zero_padding2D_layer(Ave72704, 0, 0, 2, 0, Zer9509), 
LMax93412 = maximum_layer([Zer45168,Zer9509], Max93412), 
exec_layers([LSep18341,LRes23114,LRes31181,LZer48362,LAve1046,LZer67268,LSub36879,LCon37367,LSub71187,LZer11172,LSub24856,LRes24119,LSep91142,LZer45168,LAve72704,LZer9509,LMax93412],["Sep18341","Res23114","Res31181","Zer48362","Ave1046","Zer67268","Sub36879","Con37367","Sub71187","Zer11172","Sub24856","Res24119","Sep91142","Zer45168","Ave72704","Zer9509","Max93412"],Max93412,"Max93412")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [1.4272000, 1.4686000]], [[0.0000000, 0.0000000], [0.5448740, 0.4005905], [1.0334001, 1.9023000]]]]

Expected (Unparsed): [[[[0,0],[0,0],[1.4272,1.4686]],[[0,0],[0.5448740056330001,0.400590500839],[1.0334,1.9023]]]]

Actual:   [[[[0, 0], [0, 0], [1.4272, 1.4686]], [[0, 0], [0.5449, 0.4006], [1.0335, 1.9023]]]]

Expected: [[[[0, 0], [0, 0], [1.4272, 1.4686]], [[0, 0], [0.5449, 0.4006], [1.0334, 1.9023]]]]