import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul81451 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul81451 = tf.keras.layers.Input(shape=([2, 2]))

Mul81451 = keras.layers.Multiply(name = 'Mul81451', )([in0Mul81451,in1Mul81451])
Sim77493 = keras.layers.SimpleRNN(1,name = 'Sim77493', )(Mul81451)
Res64736 = keras.layers.Reshape((1, 1), name = 'Res64736', )(Sim77493)
Sep3248 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='valid', name = 'Sep3248', )(Res64736)
Bat85811 = keras.layers.BatchNormalization(axis=1, epsilon=0.4571665449757609,  name = 'Bat85811', )(Sep3248)
Res94041 = keras.layers.Reshape((1, 2, 1), name = 'Res94041', )(Bat85811)
Glo46756 = keras.layers.GlobalMaxPool2D(name = 'Glo46756', )(Res94041)
model = tf.keras.models.Model(inputs=[in0Mul81451,in1Mul81451], outputs=Glo46756)
w = model.get_layer('Sim77493').get_weights() 
w[0] = np.array([[6], [6]])
w[1] = np.array([[1]])
w[2] = np.array([8])
model.get_layer('Sim77493').set_weights(w) 
w = model.get_layer('Sep3248').get_weights() 
w[0] = np.array([[[0.428]]])
w[1] = np.array([[[0.4907, 0.0291]]])
w[2] = np.array([0, 0])
model.get_layer('Sep3248').set_weights(w) 
w = model.get_layer('Bat85811').get_weights() 
w[0] = np.array([0.9496])
w[1] = np.array([0.8962])
w[2] = np.array([0.4862])
w[3] = np.array([0.3378])
model.get_layer('Bat85811').set_weights(w) 
in0Mul81451 = tf.constant([[[0.3558, 0.6654], [0.3459, 0.6362]]])
in1Mul81451 = tf.constant([[[0.9073, 0.5955], [0.7751, 0.3713]]])
print (np.array2string(model.predict([in0Mul81451,in1Mul81451],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo46756.png')

LMul81451 = multiply_layer([[[[0.3558, 0.6654], [0.3459, 0.6362]]], [[[0.9073, 0.5955], [0.7751, 0.3713]]]], Mul81451), 
LSim77493 = simple_rnn_layer(Mul81451,[[6], [6]],[[1]],[8], Sim77493), 
LRes64736 = reshape_layer(Sim77493, [1, 1], Res64736), 
LSep3248 = separable_conv1D_layer(Res64736, 1,[[[[0.428]]],[[[0.4907, 0.0291]]]],[0, 0], 1, false, Sep3248), 
LBat85811 = batch_normalization_layer(Sep3248, 1, 0.4571665449757609, [0.9496], [0.8962], [0.4862], [0.3378], Bat85811), 
LRes94041 = reshape_layer(Bat85811, [1, 2, 1], Res94041), 
LGlo46756 = global_max_pool2D_layer(Res94041, Glo46756), 
exec_layers([LMul81451,LSim77493,LRes64736,LSep3248,LBat85811,LRes94041,LGlo46756],["Mul81451","Sim77493","Res64736","Sep3248","Bat85811","Res94041","Glo46756"],Glo46756,"Glo46756")

Actual (Unparsed): [[0.6020566]]

Expected (Unparsed): [[0.602056582430726]]

Actual:   [[0.6021]]

Expected: [[0.6021]]