import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con46521 = tf.keras.layers.Input(shape=([2, 2, 1]))

Con46521 = keras.layers.Conv2DTranspose(3, (1, 2),strides=(7, 1), padding='valid', name = 'Con46521', )(in0Con46521)
Res27914 = keras.layers.Reshape((14, 9), name = 'Res27914', )(Con46521)
Per78670 = keras.layers.Permute((2,1), name = 'Per78670',)(Res27914)
Lay20929 = keras.layers.LayerNormalization(axis=1, epsilon=2.1692831196270257, name = 'Lay20929', )(Per78670)
model = tf.keras.models.Model(inputs=[in0Con46521], outputs=Lay20929)
w = model.get_layer('Con46521').get_weights() 
w[0] = np.array([[[[0.2979], [0.7702], [0.8124]], [[0.9355], [0.6368], [0.5885]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con46521').set_weights(w) 
in0Con46521 = tf.constant([[[[0.1689], [0.2985]], [[0.0331], [0.1235]]]])
print (np.array2string(model.predict([in0Con46521],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay20929.png')

LCon46521 = conv2D_transpose_layer([[[[0.1689], [0.2985]], [[0.0331], [0.1235]]]], 1, 2,[[[[0.2979], [0.7702], [0.8124]], [[0.9355], [0.6368], [0.5885]]]],[0, 0, 0], 7, 1, false, Con46521), 
LRes27914 = reshape_layer(Con46521, [14, 9], Res27914), 
LPer78670 = permute_layer(Res27914, 2,1, Per78670), 
LLay20929 = layer_normalization_layer(Per78670, 1, 2.1692831196270257, Lay20929), 
exec_layers([LCon46521,LRes27914,LPer78670,LLay20929],["Con46521","Res27914","Per78670","Lay20929"],Lay20929,"Lay20929")

Actual (Unparsed): [[[-0.1081189, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, -0.0410335, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.0540662, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, -0.0304231, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.0492366, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, -0.0294751, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0251055, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, -0.0017395, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0864489, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0311386, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0894566, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0335908, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0470038, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0306883, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.0134119, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0056511, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.0231811, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0016025, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[-0.10811891959993536,0.0,0.0,0.0,0.0,0.0,0.0,-0.041033481859525586,0.0,0.0,0.0,0.0,0.0,0.0],[-0.05406621202894059,0.0,0.0,0.0,0.0,0.0,0.0,-0.030423134561939555,0.0,0.0,0.0,0.0,0.0,0.0],[-0.04923660317970073,0.0,0.0,0.0,0.0,0.0,0.0,-0.02947510014322659,0.0,0.0,0.0,0.0,0.0,0.0],[0.025105498795450588,0.0,0.0,0.0,0.0,0.0,0.0,-0.0017394770782261238,0.0,0.0,0.0,0.0,0.0,0.0],[0.08644888579126044,0.0,0.0,0.0,0.0,0.0,0.0,0.031138602526910312,0.0,0.0,0.0,0.0,0.0,0.0],[0.08945661248787713,0.0,0.0,0.0,0.0,0.0,0.0,0.03359075807578372,0.0,0.0,0.0,0.0,0.0,0.0],[0.047003759976193,0.0,0.0,0.0,0.0,0.0,0.0,0.030688258690303873,0.0,0.0,0.0,0.0,0.0,0.0],[-0.013411884988224192,0.0,0.0,0.0,0.0,0.0,0.0,0.005651053977176351,0.0,0.0,0.0,0.0,0.0,0.0],[-0.023181137253980307,0.0,0.0,0.0,0.0,0.0,0.0,0.0016025203727436123,0.0,0.0,0.0,0.0,0.0,0.0]]]

Actual:   [[[-0.1081, 0, 0, 0, 0, 0, 0, -0.041, 0, 0, 0, 0, 0, 0], [-0.054, 0, 0, 0, 0, 0, 0, -0.0304, 0, 0, 0, 0, 0, 0], [-0.0492, 0, 0, 0, 0, 0, 0, -0.0294, 0, 0, 0, 0, 0, 0], [0.0252, 0, 0, 0, 0, 0, 0, -0.0017, 0, 0, 0, 0, 0, 0], [0.0865, 0, 0, 0, 0, 0, 0, 0.0312, 0, 0, 0, 0, 0, 0], [0.0895, 0, 0, 0, 0, 0, 0, 0.0336, 0, 0, 0, 0, 0, 0], [0.0471, 0, 0, 0, 0, 0, 0, 0.0307, 0, 0, 0, 0, 0, 0], [-0.0134, 0, 0, 0, 0, 0, 0, 0.0057, 0, 0, 0, 0, 0, 0], [-0.0231, 0, 0, 0, 0, 0, 0, 0.0017, 0, 0, 0, 0, 0, 0]]]

Expected: [[[-0.1081, 0, 0, 0, 0, 0, 0, -0.041, 0, 0, 0, 0, 0, 0], [-0.054, 0, 0, 0, 0, 0, 0, -0.0304, 0, 0, 0, 0, 0, 0], [-0.0492, 0, 0, 0, 0, 0, 0, -0.0294, 0, 0, 0, 0, 0, 0], [0.0252, 0, 0, 0, 0, 0, 0, -0.0017, 0, 0, 0, 0, 0, 0], [0.0865, 0, 0, 0, 0, 0, 0, 0.0312, 0, 0, 0, 0, 0, 0], [0.0895, 0, 0, 0, 0, 0, 0, 0.0336, 0, 0, 0, 0, 0, 0], [0.0471, 0, 0, 0, 0, 0, 0, 0.0307, 0, 0, 0, 0, 0, 0], [-0.0134, 0, 0, 0, 0, 0, 0, 0.0057, 0, 0, 0, 0, 0, 0], [-0.0231, 0, 0, 0, 0, 0, 0, 0.0017, 0, 0, 0, 0, 0, 0]]]