import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub39122 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub39122 = tf.keras.layers.Input(shape=([3, 2, 2]))
in0Glo97975 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con94489 = tf.keras.layers.Input(shape=([10]))

Sub39122 = keras.layers.Subtract(name = 'Sub39122', )([in0Sub39122,in1Sub39122])
Res62510 = keras.layers.Reshape((3, 4), name = 'Res62510', )(Sub39122)
Fla25547 = keras.layers.Flatten(name = 'Fla25547', )(Res62510)
Glo97975 = keras.layers.GlobalMaxPool2D(name = 'Glo97975', )(in0Glo97975)
Con94489 = keras.layers.Concatenate(axis=1, name = 'Con94489', )([Glo97975,in0Con94489])
Ave25107 = keras.layers.Average(name = 'Ave25107', )([Fla25547,Con94489])
Res72850 = keras.layers.Reshape((12, 1), name = 'Res72850', )(Ave25107)
Res23806 = keras.layers.Reshape((12, 1, 1), name = 'Res23806', )(Res72850)
Con13691 = keras.layers.Conv2D(2, (5, 1),strides=(2, 1), padding='same', dilation_rate=(1, 1), name = 'Con13691', )(Res23806)
model = tf.keras.models.Model(inputs=[in0Sub39122,in1Sub39122,in0Glo97975,in0Con94489], outputs=Con13691)
w = model.get_layer('Con13691').get_weights() 
w[0] = np.array([[[[0.623, 0.7787]]], [[[0.069, 0.7194]]], [[[0.8642, 0.1983]]], [[[0.2487, 0.2086]]], [[[0.7703, 0.6107]]]])
w[1] = np.array([0, 0])
model.get_layer('Con13691').set_weights(w) 
in0Sub39122 = tf.constant([[[[0.4024, 0.6415], [0.7756, 0.9674]], [[0.6655, 0.1287], [0.24, 0.6339]], [[0.8095, 0.4185], [0.865, 0.7698]]]])
in1Sub39122 = tf.constant([[[[0.9062, 0.2929], [0.384, 0.0102]], [[0.9419, 0.9123], [0.1116, 0.8305]], [[0.2127, 0.9606], [0.0956, 0.0429]]]])
in0Glo97975 = tf.constant([[[[1.6059, 1.4538]]]])
in0Con94489 = tf.constant([[0.1456, 0.5034, 0.0154, 0.7276, 0.3874, 0.2708, 0.6056, 0.3661, 0.5596, 0.671]])
print (np.array2string(model.predict([in0Sub39122,in1Sub39122,in0Glo97975,in0Con94489],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con13691.png')

LSub39122 = subtract_layer([[[[0.4024, 0.6415], [0.7756, 0.9674]], [[0.6655, 0.1287], [0.24, 0.6339]], [[0.8095, 0.4185], [0.865, 0.7698]]]], [[[[0.9062, 0.2929], [0.384, 0.0102]], [[0.9419, 0.9123], [0.1116, 0.8305]], [[0.2127, 0.9606], [0.0956, 0.0429]]]], Sub39122), 
LRes62510 = reshape_layer(Sub39122, [3, 4], Res62510), 
LFla25547 = flatten_layer(Res62510, Fla25547), 
LGlo97975 = global_max_pool2D_layer([[[[1.6059, 1.4538]]]], Glo97975), 
LCon94489 = concatenate_layer([Glo97975,[[0.1456, 0.5034, 0.0154, 0.7276, 0.3874, 0.2708, 0.6056, 0.3661, 0.5596, 0.671]]], 1, Con94489), 
LAve25107 = average_layer([Fla25547,Con94489], Ave25107), 
LRes72850 = reshape_layer(Ave25107, [12, 1], Res72850), 
LRes23806 = reshape_layer(Res72850, [12, 1, 1], Res23806), 
LCon13691 = conv2D_layer(Res23806, 5, 1,[[[[0.623, 0.7787]]], [[[0.069, 0.7194]]], [[[0.8642, 0.1983]]], [[[0.2487, 0.2086]]], [[[0.7703, 0.6107]]]],[0, 0], 2, 1, true, 1, 1, Con13691), 
exec_layers([LSub39122,LRes62510,LFla25547,LGlo97975,LCon94489,LAve25107,LRes72850,LRes23806,LCon13691],["Sub39122","Res62510","Fla25547","Glo97975","Con94489","Ave25107","Res72850","Res23806","Con13691"],Con13691,"Con13691")

Actual (Unparsed): [[[[1.4461904, 1.0771575]], [[1.1570825, 0.9954919]], [[0.5144927, 0.5457054]], [[0.1141449, 0.2427553]], [[0.6922088, 1.0094061]], [[0.5950591, 0.5481175]]]]

Expected (Unparsed): [[[[1.4461903999999999,1.0771575000000002]],[[1.15708251,0.9954918699999998]],[[0.5144926599999999,0.54570542]],[[0.11414496,0.24275531000000006]],[[0.692208835,1.009406115]],[[0.59505909,0.548117485]]]]

Actual:   [[[[1.4462, 1.0772]], [[1.1571, 0.9955]], [[0.5145, 0.5458]], [[0.1142, 0.2428]], [[0.6923, 1.0095]], [[0.5951, 0.5482]]]]

Expected: [[[[1.4462, 1.0772]], [[1.1571, 0.9955]], [[0.5145, 0.5458]], [[0.1142, 0.2428]], [[0.6923, 1.0095]], [[0.5951, 0.5482]]]]