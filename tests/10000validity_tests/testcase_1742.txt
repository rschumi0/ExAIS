import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min1767 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Min1767 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Ave13663 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave13663 = tf.keras.layers.Input(shape=([1, 1]))
in0Con29464 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Ave8323 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Ave8323 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Min1767 = keras.layers.Minimum(name = 'Min1767', )([in0Min1767,in1Min1767])
Res66105 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res66105', )(Min1767)
Cro84529 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 1)), name = 'Cro84529', )(Res66105)
Res22286 = keras.layers.Reshape((2, 2, 1), name = 'Res22286', )(Cro84529)
Res94260 = keras.layers.Reshape((2, 2), name = 'Res94260', )(Res22286)
Ave13663 = keras.layers.Average(name = 'Ave13663', )([in0Ave13663,in1Ave13663])
Res90034 = keras.layers.Reshape((1, 1, 1), name = 'Res90034', )(Ave13663)
Res38999 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res38999', )(Res90034)
Zer23097 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer23097', )(Res38999)
Con29464 = keras.layers.Concatenate(axis=4, name = 'Con29464', )([Zer23097,in0Con29464])
Ave8323 = keras.layers.Average(name = 'Ave8323', )([in0Ave8323,in1Ave8323])
Min42676 = keras.layers.Minimum(name = 'Min42676', )([Con29464,Ave8323])
Res97811 = keras.layers.Reshape((2, 2, 1), name = 'Res97811', )(Min42676)
Res42819 = keras.layers.Reshape((2, 2), name = 'Res42819', )(Res97811)
Dot56875 = keras.layers.Dot(axes=(2, 1), name = 'Dot56875', )([Res94260,Res42819])
model = tf.keras.models.Model(inputs=[in0Min1767,in1Min1767,in0Ave13663,in1Ave13663,in0Con29464,in0Ave8323,in1Ave8323], outputs=Dot56875)
in0Min1767 = tf.constant([[[[0.6291, 0.5699], [0.6653, 0.1028]], [[0.7982, 0.839], [0.4513, 0.0748]]]])
in1Min1767 = tf.constant([[[[0.1786, 0.0135], [0.7357, 0.5476]], [[0.8017, 0.8828], [0.3503, 0.7824]]]])
in0Ave13663 = tf.constant([[[0.7388]]])
in1Ave13663 = tf.constant([[[0.2625]]])
in0Con29464 = tf.constant([[[[[0.6333]], [[0.5247]]]]])
in0Ave8323 = tf.constant([[[[[0.2969, 0.5453]], [[0.8624, 0.2071]]]]])
in1Ave8323 = tf.constant([[[[[0.556, 0.5001]], [[0.4489, 0.2919]]]]])
print (np.array2string(model.predict([in0Min1767,in1Min1767,in0Ave13663,in1Ave13663,in0Con29464,in0Ave8323,in1Ave8323],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot56875.png')

LMin1767 = minimum_layer([[[[[0.6291, 0.5699], [0.6653, 0.1028]], [[0.7982, 0.839], [0.4513, 0.0748]]]], [[[[0.1786, 0.0135], [0.7357, 0.5476]], [[0.8017, 0.8828], [0.3503, 0.7824]]]]], Min1767), 
LRes66105 = reshape_layer(Min1767, [2, 2, 2, 1], Res66105), 
LCro84529 = cropping3D_layer(Res66105, 0, 0, 0, 0, 0, 1, Cro84529), 
LRes22286 = reshape_layer(Cro84529, [2, 2, 1], Res22286), 
LRes94260 = reshape_layer(Res22286, [2, 2], Res94260), 
LAve13663 = average_layer([[[[0.7388]]], [[[0.2625]]]], Ave13663), 
LRes90034 = reshape_layer(Ave13663, [1, 1, 1], Res90034), 
LRes38999 = reshape_layer(Res90034, [1, 1, 1, 1], Res38999), 
LZer23097 = zero_padding3D_layer(Res38999, 0, 0, 1, 0, 0, 0, Zer23097), 
LCon29464 = concatenate_layer([Zer23097,[[[[[0.6333]], [[0.5247]]]]]], 4, Con29464), 
LAve8323 = average_layer([[[[[[0.2969, 0.5453]], [[0.8624, 0.2071]]]]], [[[[[0.556, 0.5001]], [[0.4489, 0.2919]]]]]], Ave8323), 
LMin42676 = minimum_layer([Con29464,Ave8323], Min42676), 
LRes97811 = reshape_layer(Min42676, [2, 2, 1], Res97811), 
LRes42819 = reshape_layer(Res97811, [2, 2], Res42819), 
LDot56875 = dot_layer(Res94260,Res42819, 2, 1, Dot56875), 
exec_layers([LMin1767,LRes66105,LCro84529,LRes22286,LRes94260,LAve13663,LRes90034,LRes38999,LZer23097,LCon29464,LAve8323,LMin42676,LRes97811,LRes42819,LDot56875],["Min1767","Res66105","Cro84529","Res22286","Res94260","Ave13663","Res90034","Res38999","Zer23097","Con29464","Ave8323","Min42676","Res97811","Res42819","Dot56875"],Dot56875,"Dot56875")

Actual (Unparsed): [[[0.3330824, 0.2593466], [0.1753777, 0.5046190]]]

Expected (Unparsed): [[[0.333082445,0.25934657],[0.175377695,0.50461899]]]

Actual:   [[[0.3331, 0.2594], [0.1754, 0.5047]]]

Expected: [[[0.3331, 0.2594], [0.1754, 0.5047]]]