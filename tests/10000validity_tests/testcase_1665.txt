import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add56529 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add56529 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con57448 = tf.keras.layers.Input(shape=([1, 4, 3]))
in0Lay99407 = tf.keras.layers.Input(shape=([1, 4, 4]))

Add56529 = keras.layers.Add(name = 'Add56529', )([in0Add56529,in1Add56529])
Zer82978 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer82978', )(Add56529)
Con57448 = keras.layers.Concatenate(axis=3, name = 'Con57448', )([Zer82978,in0Con57448])
Lay99407 = keras.layers.LayerNormalization(axis=2, epsilon=1.2771942803903105, name = 'Lay99407', )(in0Lay99407)
Add98412 = keras.layers.Add(name = 'Add98412', )([Con57448,Lay99407])
model = tf.keras.models.Model(inputs=[in0Add56529,in1Add56529,in0Con57448,in0Lay99407], outputs=Add98412)
in0Add56529 = tf.constant([[[[0.0931], [0.8033]]]])
in1Add56529 = tf.constant([[[[0.0026], [0.1714]]]])
in0Con57448 = tf.constant([[[[0.5258, 0.9934, 0.1094], [0.2774, 0.1107, 0.6653], [0.0566, 0.2254, 0.7799], [0.7068, 0.0675, 0.2146]]]])
in0Lay99407 = tf.constant([[[[1.0883, 1.9546, 1.9205, 1.1488], [1.0245, 1.4691, 1.1407, 1.2117], [1.2094, 1.1207, 1.7877, 1.7607], [1.1559, 1.2604, 1.6555, 1.3864]]]])
print (np.array2string(model.predict([in0Add56529,in1Add56529,in0Con57448,in0Lay99407],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add98412.png')

LAdd56529 = add_layer([[[[[0.0931], [0.8033]]]], [[[[0.0026], [0.1714]]]]], Add56529), 
LZer82978 = zero_padding2D_layer(Add56529, 0, 0, 2, 0, Zer82978), 
LCon57448 = concatenate_layer([Zer82978,[[[[0.5258, 0.9934, 0.1094], [0.2774, 0.1107, 0.6653], [0.0566, 0.2254, 0.7799], [0.7068, 0.0675, 0.2146]]]]], 3, Con57448), 
LLay99407 = layer_normalization_layer([[[[1.0883, 1.9546, 1.9205, 1.1488], [1.0245, 1.4691, 1.1407, 1.2117], [1.2094, 1.1207, 1.7877, 1.7607], [1.1559, 1.2604, 1.6555, 1.3864]]]], 2, 1.2771942803903105, Lay99407), 
LAdd98412 = add_layer([Con57448,Lay99407], Add98412), 
exec_layers([LAdd56529,LZer82978,LCon57448,LLay99407,LAdd98412],["Add56529","Zer82978","Con57448","Lay99407","Add98412"],Add98412,"Add98412")

Actual (Unparsed): [[[[-0.0275773, 0.9547834, 1.2454283, -0.0881004], [-0.0839240, 0.2926539, -0.3048387, 0.5222615], [0.1750757, -0.2250429, 0.3637417, 1.1122134], [1.0068256, 0.5442056, 0.0926686, 0.2228256]]]]

Expected (Unparsed): [[[[-0.02757723406930887,0.9547834768894943,1.2454283649482674,-0.08810045797106944],[-0.08392399255199637,0.2926538820745371,-0.3048386153053294,0.5222615271511588],[0.17507562568387997,-0.22504290646002767,0.3637416568466032,1.1122133527807823],[1.0068256009374257,0.5442055474959961,0.09266859351045866,0.22282557803912834]]]]

Actual:   [[[[-0.0275, 0.9548, 1.2455, -0.0881], [-0.0839, 0.2927, -0.3048, 0.5223], [0.1751, -0.225, 0.3638, 1.1123], [1.0069, 0.5443, 0.0927, 0.2229]]]]

Expected: [[[[-0.0275, 0.9548, 1.2455, -0.0881], [-0.0839, 0.2927, -0.3048, 0.5223], [0.1751, -0.225, 0.3638, 1.1123], [1.0069, 0.5443, 0.0927, 0.2229]]]]