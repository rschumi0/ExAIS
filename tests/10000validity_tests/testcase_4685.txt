import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot58671 = tf.keras.layers.Input(shape=([2]))
in1Dot58671 = tf.keras.layers.Input(shape=([2]))
in0Ave59818 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave59818 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Sub23043 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub23043 = tf.keras.layers.Input(shape=([3, 3]))
in0Con43919 = tf.keras.layers.Input(shape=([3, 3]))

Dot58671 = keras.layers.Dot(axes=(1, 1), name = 'Dot58671', )([in0Dot58671,in1Dot58671])
Thr15883 = keras.layers.ThresholdedReLU(theta=6.439395008052858, name = 'Thr15883', )(Dot58671)
Res12305 = keras.layers.Reshape((1, 1), name = 'Res12305', )(Thr15883)
Res52263 = keras.layers.Reshape((1, 1, 1), name = 'Res52263', )(Res12305)
Cro28516 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro28516', )(Res52263)
Res237 = keras.layers.Reshape((1, 1), name = 'Res237', )(Cro28516)
Ave59818 = keras.layers.Average(name = 'Ave59818', )([in0Ave59818,in1Ave59818])
Con32270 = keras.layers.Conv2DTranspose(2, (1, 2),strides=(1, 1), padding='valid', name = 'Con32270', )(Ave59818)
Res17128 = keras.layers.Reshape((1, 6), name = 'Res17128', )(Con32270)
Dot49586 = keras.layers.Dot(axes=(1, 1), name = 'Dot49586', )([Res237,Res17128])
Zer34224 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer34224', )(Dot49586)
Sub23043 = keras.layers.Subtract(name = 'Sub23043', )([in0Sub23043,in1Sub23043])
Con43919 = keras.layers.Concatenate(axis=2, name = 'Con43919', )([Sub23043,in0Con43919])
Mul78677 = keras.layers.Multiply(name = 'Mul78677', )([Zer34224,Con43919])
model = tf.keras.models.Model(inputs=[in0Dot58671,in1Dot58671,in0Ave59818,in1Ave59818,in0Sub23043,in1Sub23043,in0Con43919], outputs=Mul78677)
w = model.get_layer('Con32270').get_weights() 
w[0] = np.array([[[[0.8711], [0.4857]], [[0.3971], [0.2998]]]])
w[1] = np.array([0, 0])
model.get_layer('Con32270').set_weights(w) 
in0Dot58671 = tf.constant([[0.1449, 0.1334]])
in1Dot58671 = tf.constant([[0.5618, 0.7146]])
in0Ave59818 = tf.constant([[[[0.1617], [0.7914]]]])
in1Ave59818 = tf.constant([[[[0.1327], [0.4392]]]])
in0Sub23043 = tf.constant([[[0.8141, 0.3953, 0.0015], [0.5585, 0.1488, 0.411], [0.0951, 0.7205, 0.4488]]])
in1Sub23043 = tf.constant([[[0.2041, 0.4557, 0.5782], [0.9735, 0.9272, 0.1712], [0.276, 0.3353, 0.8977]]])
in0Con43919 = tf.constant([[[0.7657, 0.0199, 0.9922], [0.5573, 0.7379, 0.0447], [0.8102, 0.7692, 0.9442]]])
print (np.array2string(model.predict([in0Dot58671,in1Dot58671,in0Ave59818,in1Ave59818,in0Sub23043,in1Sub23043,in0Con43919],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul78677.png')

LDot58671 = dot_layer([[0.1449, 0.1334]], [[0.5618, 0.7146]], 1, 1, Dot58671), 
LThr15883 = thresholded_relu_layer(Dot58671, 6.439395008052858, Thr15883), 
LRes12305 = reshape_layer(Thr15883, [1, 1], Res12305), 
LRes52263 = reshape_layer(Res12305, [1, 1, 1], Res52263), 
LCro28516 = cropping2D_layer(Res52263, 0, 0, 0, 0, Cro28516), 
LRes237 = reshape_layer(Cro28516, [1, 1], Res237), 
LAve59818 = average_layer([[[[[0.1617], [0.7914]]]], [[[[0.1327], [0.4392]]]]], Ave59818), 
LCon32270 = conv2D_transpose_layer(Ave59818, 1, 2,[[[[0.8711], [0.4857]], [[0.3971], [0.2998]]]],[0, 0], 1, 1, false, Con32270), 
LRes17128 = reshape_layer(Con32270, [1, 6], Res17128), 
LDot49586 = dot_layer(Res237,Res17128, 1, 1, Dot49586), 
LZer34224 = zero_padding1D_layer(Dot49586, 2, 0, Zer34224), 
LSub23043 = subtract_layer([[[0.8141, 0.3953, 0.0015], [0.5585, 0.1488, 0.411], [0.0951, 0.7205, 0.4488]]], [[[0.2041, 0.4557, 0.5782], [0.9735, 0.9272, 0.1712], [0.276, 0.3353, 0.8977]]], Sub23043), 
LCon43919 = concatenate_layer([Sub23043,[[[0.7657, 0.0199, 0.9922], [0.5573, 0.7379, 0.0447], [0.8102, 0.7692, 0.9442]]]], 2, Con43919), 
LMul78677 = multiply_layer([Zer34224,Con43919], Mul78677), 
exec_layers([LDot58671,LThr15883,LRes12305,LRes52263,LCro28516,LRes237,LAve59818,LCon32270,LRes17128,LDot49586,LZer34224,LSub23043,LCon43919,LMul78677],["Dot58671","Thr15883","Res12305","Res52263","Cro28516","Res237","Ave59818","Con32270","Res17128","Dot49586","Zer34224","Sub23043","Con43919","Mul78677"],Mul78677,"Mul78677")

Actual (Unparsed): [[[0.0000000, -0.0000000, -0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.0000000, -0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.0000000, 0.0000000, -0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,-0.0,-0.0,0.0,0.0,0.0],[-0.0,-0.0,0.0,0.0,0.0,0.0],[-0.0,0.0,-0.0,0.0,0.0,0.0]]]

Actual:   [[[0, -0, -0, 0, 0, 0], [-0, -0, 0, 0, 0, 0], [-0, 0, -0, 0, 0, 0]]]

Expected: [[[0, -0, -0, 0, 0, 0], [-0, -0, 0, 0, 0, 0], [-0, 0, -0, 0, 0, 0]]]