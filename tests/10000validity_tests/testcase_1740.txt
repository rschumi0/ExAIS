import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay28484 = tf.keras.layers.Input(shape=([4, 2, 2]))
in0Con22497 = tf.keras.layers.Input(shape=([4, 14]))
in0Sub75740 = tf.keras.layers.Input(shape=([3, 2, 3, 3]))
in1Sub75740 = tf.keras.layers.Input(shape=([3, 2, 3, 3]))

Lay28484 = keras.layers.LayerNormalization(axis=2, epsilon=1.9719138643201979, name = 'Lay28484', )(in0Lay28484)
Res21627 = keras.layers.Reshape((4, 4), name = 'Res21627', )(Lay28484)
Con22497 = keras.layers.Concatenate(axis=2, name = 'Con22497', )([Res21627,in0Con22497])
Sub75740 = keras.layers.Subtract(name = 'Sub75740', )([in0Sub75740,in1Sub75740])
Res23674 = keras.layers.Reshape((3, 2, 9), name = 'Res23674', )(Sub75740)
Res91298 = keras.layers.Reshape((3, 18), name = 'Res91298', )(Res23674)
Up_96668 = keras.layers.UpSampling1D(size=(1), name = 'Up_96668', )(Res91298)
Zer50047 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer50047', )(Up_96668)
Mul30918 = keras.layers.Multiply(name = 'Mul30918', )([Con22497,Zer50047])
model = tf.keras.models.Model(inputs=[in0Lay28484,in0Con22497,in0Sub75740,in1Sub75740], outputs=Mul30918)
in0Lay28484 = tf.constant([[[[1.9177, 1.8521], [1.9469, 1.368]], [[1.4418, 1.653], [1.2154, 1.4377]], [[1.8993, 1.439], [1.102, 1.4673]], [[1.5739, 1.9148], [1.6532, 1.464]]]])
in0Con22497 = tf.constant([[[0.8476, 0.4734, 0.8583, 0.7409, 0.6201, 0.5064, 0.429, 0.7584, 0.8644, 0.1881, 0.0092, 0.7929, 0.9842, 0.9454], [0.3877, 0.4563, 0.8092, 0.2375, 0.5242, 0.1518, 0.0143, 0.7215, 0.8354, 0.9185, 0.0987, 0.0085, 0.9681, 0.7664], [0.9047, 0.5844, 0.2279, 0.4724, 0.9792, 0.5236, 0.1782, 0.5058, 0.6986, 0.2086, 0.0494, 0.4775, 0.9613, 0.3905], [0.5042, 0.2677, 0.433, 0.5718, 0.9973, 0.774, 0.7775, 0.8749, 0.4314, 0.0483, 0.0439, 0.2711, 0.0689, 0.4365]]])
in0Sub75740 = tf.constant([[[[[0.093, 0.6004, 0.8493], [0.8836, 0.1244, 0.8242], [0.4368, 0.5898, 0.4572]], [[0.9463, 0.9959, 0.6852], [0.7401, 0.025, 0.9565], [0.8713, 0.442, 0.5065]]], [[[0.0215, 0.9377, 0.0522], [0.2835, 0.8591, 0.8293], [0.1423, 0.6507, 0.9877]], [[0.4944, 0.6752, 0.2642], [0.4895, 0.3791, 0.8663], [0.202, 0.5638, 0.9998]]], [[[0.9753, 0.6197, 0.9582], [0.4992, 0.6403, 0.2953], [0.0001, 0.4716, 0.7532]], [[0.5672, 0.2918, 0.629], [0.4177, 0.7805, 0.1317], [0.0726, 0.2347, 0.3812]]]]])
in1Sub75740 = tf.constant([[[[[0.3726, 0.0315, 0.0123], [0.2218, 0.7442, 0.9371], [0.0143, 0.4751, 0.6259]], [[0.6111, 0.0261, 0.7942], [0.8839, 0.1642, 0.8465], [0.9994, 0.6609, 0.924]]], [[[0.2903, 0.627, 0.9435], [0.3425, 0.4293, 0.1313], [0.3223, 0.3692, 0.5893]], [[0.396, 0.6067, 0.2172], [0.5735, 0.482, 0.8606], [0.7993, 0.6873, 0.2147]]], [[[0.9831, 0.3661, 0.4038], [0.2971, 0.1765, 0.0385], [0.927, 0.1253, 0.5141]], [[0.9946, 0.4852, 0.376], [0.3481, 0.0461, 0.9199], [0.7408, 0.4853, 0.2151]]]]])
print (np.array2string(model.predict([in0Lay28484,in0Con22497,in0Sub75740,in1Sub75740],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul30918.png')

LLay28484 = layer_normalization_layer([[[[1.9177, 1.8521], [1.9469, 1.368]], [[1.4418, 1.653], [1.2154, 1.4377]], [[1.8993, 1.439], [1.102, 1.4673]], [[1.5739, 1.9148], [1.6532, 1.464]]]], 2, 1.9719138643201979, Lay28484), 
LRes21627 = reshape_layer(Lay28484, [4, 4], Res21627), 
LCon22497 = concatenate_layer([Res21627,[[[0.8476, 0.4734, 0.8583, 0.7409, 0.6201, 0.5064, 0.429, 0.7584, 0.8644, 0.1881, 0.0092, 0.7929, 0.9842, 0.9454], [0.3877, 0.4563, 0.8092, 0.2375, 0.5242, 0.1518, 0.0143, 0.7215, 0.8354, 0.9185, 0.0987, 0.0085, 0.9681, 0.7664], [0.9047, 0.5844, 0.2279, 0.4724, 0.9792, 0.5236, 0.1782, 0.5058, 0.6986, 0.2086, 0.0494, 0.4775, 0.9613, 0.3905], [0.5042, 0.2677, 0.433, 0.5718, 0.9973, 0.774, 0.7775, 0.8749, 0.4314, 0.0483, 0.0439, 0.2711, 0.0689, 0.4365]]]], 2, Con22497), 
LSub75740 = subtract_layer([[[[[0.093, 0.6004, 0.8493], [0.8836, 0.1244, 0.8242], [0.4368, 0.5898, 0.4572]], [[0.9463, 0.9959, 0.6852], [0.7401, 0.025, 0.9565], [0.8713, 0.442, 0.5065]]], [[[0.0215, 0.9377, 0.0522], [0.2835, 0.8591, 0.8293], [0.1423, 0.6507, 0.9877]], [[0.4944, 0.6752, 0.2642], [0.4895, 0.3791, 0.8663], [0.202, 0.5638, 0.9998]]], [[[0.9753, 0.6197, 0.9582], [0.4992, 0.6403, 0.2953], [0.0001, 0.4716, 0.7532]], [[0.5672, 0.2918, 0.629], [0.4177, 0.7805, 0.1317], [0.0726, 0.2347, 0.3812]]]]], [[[[[0.3726, 0.0315, 0.0123], [0.2218, 0.7442, 0.9371], [0.0143, 0.4751, 0.6259]], [[0.6111, 0.0261, 0.7942], [0.8839, 0.1642, 0.8465], [0.9994, 0.6609, 0.924]]], [[[0.2903, 0.627, 0.9435], [0.3425, 0.4293, 0.1313], [0.3223, 0.3692, 0.5893]], [[0.396, 0.6067, 0.2172], [0.5735, 0.482, 0.8606], [0.7993, 0.6873, 0.2147]]], [[[0.9831, 0.3661, 0.4038], [0.2971, 0.1765, 0.0385], [0.927, 0.1253, 0.5141]], [[0.9946, 0.4852, 0.376], [0.3481, 0.0461, 0.9199], [0.7408, 0.4853, 0.2151]]]]], Sub75740), 
LRes23674 = reshape_layer(Sub75740, [3, 2, 9], Res23674), 
LRes91298 = reshape_layer(Res23674, [3, 18], Res91298), 
LUp_96668 = up_sampling1D_layer(Res91298, 1, Up_96668), 
LZer50047 = zero_padding1D_layer(Up_96668, 1, 0, Zer50047), 
LMul30918 = multiply_layer([Con22497,Zer50047], Mul30918), 
exec_layers([LLay28484,LRes21627,LCon22497,LSub75740,LRes23674,LRes91298,LUp_96668,LZer50047,LMul30918],["Lay28484","Res21627","Con22497","Sub75740","Res23674","Res91298","Up_96668","Zer50047","Mul30918"],Mul30918,"Mul30918")

Actual (Unparsed): [[[-0.0000000, 0.0000000, 0.0000000, -0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.0224664, 0.0434844, -0.0672545, -0.0505853, -0.2402965, -0.0515163, 0.3418870, 0.0272412, -0.0884325, 0.0508834, 0.0138681, -0.0786435, -0.1201305, -0.1278552, 0.0108570, -0.0010889, -0.2119171, -0.3199720], [-0.0734085, -0.0031306, 0.2434113, -0.0005945, 0.3888400, 0.4079112, -0.0410220, 0.1329806, 0.3901133, 0.0515222, 0.0122067, 0.0237726, -0.0586824, -0.0214649, 0.0002816, -0.2852107, -0.1187206, 0.3065816], [0.0002202, 0.0401916, 0.0156477, -0.0320297, 0.2338479, 0.0687454, -0.4013477, 0.1980143, 0.2384544, -0.3308076, -0.1503685, 0.2213497, 0.0300254, 0.0354715, -0.0346020, -0.1811490, -0.0172663, 0.0725026]]]

Expected (Unparsed): [[[-0.0,0.0,0.0,-0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[-0.02246637916469881,0.043484412234122506,-0.06725450415183443,-0.05058531203470254,-0.24029646,-0.051516269999999996,0.34188700000000005,0.02724124999999999,-0.08843254,0.05088336,0.01386814,-0.07864349999999999,-0.12013052000000003,-0.1278552,0.010856999999999999,-0.00108885,-0.21191709000000003,-0.31997200000000003],[-0.07340844963312648,-0.00313062951575547,0.24341127662948525,-0.0005944870982606237,0.38884005999999993,0.4079112000000001,-0.04102199999999999,0.13298059999999998,0.39011327999999995,0.05152223999999999,0.012206700000000001,0.023772599999999994,-0.058682400000000016,-0.02146494,0.0002815799999999964,-0.28521074999999996,-0.11872055000000006,0.30658155000000004],[0.00022015105493133875,0.040191607943830476,0.015647659596658172,-0.03202966863347058,0.23384796,0.06874536,-0.40134770000000003,0.19801434,0.23845442999999997,-0.33080760000000003,-0.15036850000000002,0.2213497,0.030025439999999997,0.03547152,-0.034601980000000004,-0.18114902000000002,-0.017266340000000005,0.07250264999999999]]]

Actual:   [[[-0, 0, 0, -0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [-0.0224, 0.0435, -0.0672, -0.0505, -0.2402, -0.0515, 0.3419, 0.0273, -0.0884, 0.0509, 0.0139, -0.0786, -0.1201, -0.1278, 0.0109, -0.001, -0.2119, -0.3199], [-0.0734, -0.0031, 0.2435, -0.0005, 0.3889, 0.408, -0.041, 0.133, 0.3902, 0.0516, 0.0123, 0.0238, -0.0586, -0.0214, 0.0003, -0.2852, -0.1187, 0.3066], [0.0003, 0.0402, 0.0157, -0.032, 0.2339, 0.0688, -0.4013, 0.1981, 0.2385, -0.3308, -0.1503, 0.2214, 0.0301, 0.0355, -0.0346, -0.1811, -0.0172, 0.0726]]]

Expected: [[[-0, 0, 0, -0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [-0.0224, 0.0435, -0.0672, -0.0505, -0.2402, -0.0515, 0.3419, 0.0273, -0.0884, 0.0509, 0.0139, -0.0786, -0.1201, -0.1278, 0.0109, -0.001, -0.2119, -0.3199], [-0.0734, -0.0031, 0.2435, -0.0005, 0.3889, 0.408, -0.041, 0.133, 0.3902, 0.0516, 0.0123, 0.0238, -0.0586, -0.0214, 0.0003, -0.2852, -0.1187, 0.3066], [0.0003, 0.0402, 0.0157, -0.032, 0.2339, 0.0688, -0.4013, 0.1981, 0.2385, -0.3308, -0.1503, 0.2214, 0.0301, 0.0355, -0.0346, -0.1811, -0.0172, 0.0726]]]