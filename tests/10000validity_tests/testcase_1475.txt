import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub11561 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub11561 = tf.keras.layers.Input(shape=([2, 2]))
in0Min92961 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Min92961 = tf.keras.layers.Input(shape=([2, 2, 2]))

Sub11561 = keras.layers.Subtract(name = 'Sub11561', )([in0Sub11561,in1Sub11561])
Min92961 = keras.layers.Minimum(name = 'Min92961', )([in0Min92961,in1Min92961])
Res5783 = keras.layers.Reshape((2, 4), name = 'Res5783', )(Min92961)
Dot19431 = keras.layers.Dot(axes=(1, 1), name = 'Dot19431', )([Sub11561,Res5783])
Zer16306 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer16306', )(Dot19431)
Res65825 = keras.layers.Reshape((4, 4, 1), name = 'Res65825', )(Zer16306)
Max2300 = keras.layers.MaxPool2D(pool_size=(3, 4), name = 'Max2300', )(Res65825)
Res88814 = keras.layers.Reshape((1, 1), name = 'Res88814', )(Max2300)
Glo21154 = keras.layers.GlobalMaxPool1D(name = 'Glo21154', )(Res88814)
model = tf.keras.models.Model(inputs=[in0Sub11561,in1Sub11561,in0Min92961,in1Min92961], outputs=Glo21154)
in0Sub11561 = tf.constant([[[0.7901, 0.2613], [0.0119, 0.1028]]])
in1Sub11561 = tf.constant([[[0.5091, 0.0902], [0.4613, 0.2724]]])
in0Min92961 = tf.constant([[[[0.7499, 0.0541], [0.6383, 0.3231]], [[0.1145, 0.0692], [0.635, 0.2999]]]])
in1Min92961 = tf.constant([[[[0.1175, 0.1008], [0.9879, 0.1516]], [[0.9858, 0.0336], [0.0804, 0.8355]]]])
print (np.array2string(model.predict([in0Sub11561,in1Sub11561,in0Min92961,in1Min92961],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo21154.png')

LSub11561 = subtract_layer([[[0.7901, 0.2613], [0.0119, 0.1028]]], [[[0.5091, 0.0902], [0.4613, 0.2724]]], Sub11561), 
LMin92961 = minimum_layer([[[[[0.7499, 0.0541], [0.6383, 0.3231]], [[0.1145, 0.0692], [0.635, 0.2999]]]], [[[[0.1175, 0.1008], [0.9879, 0.1516]], [[0.9858, 0.0336], [0.0804, 0.8355]]]]], Min92961), 
LRes5783 = reshape_layer(Min92961, [2, 4], Res5783), 
LDot19431 = dot_layer(Sub11561,Res5783, 1, 1, Dot19431), 
LZer16306 = zero_padding1D_layer(Dot19431, 1, 1, Zer16306), 
LRes65825 = reshape_layer(Zer16306, [4, 4, 1], Res65825), 
LMax2300 = max_pool2D_layer(Res65825, 3, 4, Max2300), 
LRes88814 = reshape_layer(Max2300, [1, 1], Res88814), 
LGlo21154 = global_max_pool1D_layer(Res88814, Glo21154), 
exec_layers([LSub11561,LMin92961,LRes5783,LDot19431,LZer16306,LRes65825,LMax2300,LRes88814,LGlo21154],["Sub11561","Min92961","Res5783","Dot19431","Zer16306","Res65825","Max2300","Res88814","Glo21154"],Glo21154,"Glo21154")

Actual (Unparsed): [[0.1432305]]

Expected (Unparsed): [[0.14323054000000002]]

Actual:   [[0.1433]]

Expected: [[0.1433]]