import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer90920 = tf.keras.layers.Input(shape=([3, 3, 3]))

Zer90920 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer90920', )(in0Zer90920)
Res17681 = keras.layers.Reshape((5, 15), name = 'Res17681', )(Zer90920)
LST675 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST675', )(Res17681)
Res84059 = keras.layers.Reshape((2, 1), name = 'Res84059', )(LST675)
Ave5391 = keras.layers.AveragePooling1D(pool_size=(2), strides=(1), padding='valid', name = 'Ave5391', )(Res84059)
Sof85329 = keras.layers.Softmax(axis=1, name = 'Sof85329', )(Ave5391)
model = tf.keras.models.Model(inputs=[in0Zer90920], outputs=Sof85329)
w = model.get_layer('LST675').get_weights() 
w[0] = np.array([[10, 10, 4, 5, 5, 3, 7, 2], [8, 9, 9, 4, 1, 6, 8, 8], [7, 3, 10, 7, 9, 8, 3, 5], [10, 5, 2, 5, 8, 6, 2, 10], [5, 2, 10, 10, 6, 7, 5, 6], [10, 1, 4, 6, 7, 10, 3, 5], [5, 10, 9, 9, 10, 2, 10, 8], [2, 6, 6, 4, 5, 9, 5, 7], [1, 1, 4, 9, 5, 5, 4, 9], [2, 3, 4, 6, 6, 2, 6, 2], [1, 10, 10, 4, 8, 6, 7, 5], [7, 5, 5, 5, 1, 4, 1, 8], [5, 1, 2, 5, 4, 10, 3, 6], [9, 1, 4, 3, 5, 9, 10, 3], [4, 1, 4, 6, 8, 10, 10, 4]])
w[1] = np.array([[5, 3, 4, 1, 9, 9, 2, 6], [5, 8, 7, 2, 4, 3, 7, 1]])
w[2] = np.array([1, 4, 8, 9, 8, 2, 7, 5])
model.get_layer('LST675').set_weights(w) 
in0Zer90920 = tf.constant([[[[1.6182, 1.6254, 1.9648], [1.3196, 1.4729, 1.1715], [1.2394, 1.0718, 1.0576]], [[1.2006, 1.388, 1.9535], [1.6492, 1.7491, 1.2839], [1.49, 1.987, 1.516]], [[1.6589, 1.1643, 1.0304], [1.2117, 1.4576, 1.851], [1.3447, 1.6428, 1.7722]]]])
print (np.array2string(model.predict([in0Zer90920],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof85329.png')

LZer90920 = zero_padding2D_layer([[[[1.6182, 1.6254, 1.9648], [1.3196, 1.4729, 1.1715], [1.2394, 1.0718, 1.0576]], [[1.2006, 1.388, 1.9535], [1.6492, 1.7491, 1.2839], [1.49, 1.987, 1.516]], [[1.6589, 1.1643, 1.0304], [1.2117, 1.4576, 1.851], [1.3447, 1.6428, 1.7722]]]], 1, 1, 1, 1, Zer90920), 
LRes17681 = reshape_layer(Zer90920, [5, 15], Res17681), 
LLST675 = lstm_layer(Res17681,[[10, 10, 4, 5, 5, 3, 7, 2], [8, 9, 9, 4, 1, 6, 8, 8], [7, 3, 10, 7, 9, 8, 3, 5], [10, 5, 2, 5, 8, 6, 2, 10], [5, 2, 10, 10, 6, 7, 5, 6], [10, 1, 4, 6, 7, 10, 3, 5], [5, 10, 9, 9, 10, 2, 10, 8], [2, 6, 6, 4, 5, 9, 5, 7], [1, 1, 4, 9, 5, 5, 4, 9], [2, 3, 4, 6, 6, 2, 6, 2], [1, 10, 10, 4, 8, 6, 7, 5], [7, 5, 5, 5, 1, 4, 1, 8], [5, 1, 2, 5, 4, 10, 3, 6], [9, 1, 4, 3, 5, 9, 10, 3], [4, 1, 4, 6, 8, 10, 10, 4]],[[5, 3, 4, 1, 9, 9, 2, 6], [5, 8, 7, 2, 4, 3, 7, 1]],[1, 4, 8, 9, 8, 2, 7, 5], LST675), 
LRes84059 = reshape_layer(LST675, [2, 1], Res84059), 
LAve5391 = average_pooling1D_layer(Res84059, 2, 1, false, Ave5391), 
LSof85329 = softmax_layer(Ave5391, 1, Sof85329), 
exec_layers([LZer90920,LRes17681,LLST675,LRes84059,LAve5391,LSof85329],["Zer90920","Res17681","LST675","Res84059","Ave5391","Sof85329"],Sof85329,"Sof85329")

Actual (Unparsed): [[[1.0000000]]]

Expected (Unparsed): [[[1.0]]]

Actual:   [[[1]]]

Expected: [[[1]]]