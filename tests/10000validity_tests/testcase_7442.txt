import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot49738 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot49738 = tf.keras.layers.Input(shape=([2, 2]))

Dot49738 = keras.layers.Dot(axes=(1, 1), name = 'Dot49738', )([in0Dot49738,in1Dot49738])
GRU91049 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU91049', )(Dot49738)
Res4451 = keras.layers.Reshape((1, 1), name = 'Res4451', )(GRU91049)
Res60798 = keras.layers.Reshape((1, 1, 1), name = 'Res60798', )(Res4451)
Res10724 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res10724', )(Res60798)
Zer66541 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer66541', )(Res10724)
Lea32177 = keras.layers.LeakyReLU(alpha=4.028830531363932, name = 'Lea32177', )(Zer66541)
model = tf.keras.models.Model(inputs=[in0Dot49738,in1Dot49738], outputs=Lea32177)
w = model.get_layer('GRU91049').get_weights() 
w[0] = np.array([[3, 3, 7], [3, 1, 7]])
w[1] = np.array([[2, 3, 7]])
w[2] = np.array([1, 3, 2])
model.get_layer('GRU91049').set_weights(w) 
in0Dot49738 = tf.constant([[[0.3336, 0.7098], [0.064, 0.7632]]])
in1Dot49738 = tf.constant([[[0.6326, 0.2746], [0.1261, 0.3039]]])
print (np.array2string(model.predict([in0Dot49738,in1Dot49738],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lea32177.png')

LDot49738 = dot_layer([[[0.3336, 0.7098], [0.064, 0.7632]]], [[[0.6326, 0.2746], [0.1261, 0.3039]]], 1, 1, Dot49738), 
LGRU91049 = gru_layer(Dot49738,[[3, 3, 7], [3, 1, 7]],[[2, 3, 7]],[1, 3, 2], false, GRU91049), 
LRes4451 = reshape_layer(GRU91049, [1, 1], Res4451), 
LRes60798 = reshape_layer(Res4451, [1, 1, 1], Res60798), 
LRes10724 = reshape_layer(Res60798, [1, 1, 1, 1], Res10724), 
LZer66541 = zero_padding3D_layer(Res10724, 1, 1, 1, 1, 1, 1, Zer66541), 
LLea32177 = leaky_relu_layer(Zer66541, 4.028830531363932, Lea32177), 
exec_layers([LDot49738,LGRU91049,LRes4451,LRes60798,LRes10724,LZer66541,LLea32177],["Dot49738","GRU91049","Res4451","Res60798","Res10724","Zer66541","Lea32177"],Lea32177,"Lea32177")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.1337280], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.13372804143987982],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.1338], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.1338], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]