import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot27826 = tf.keras.layers.Input(shape=([2]))
in1Dot27826 = tf.keras.layers.Input(shape=([2]))
in0Con9023 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Dot27826 = keras.layers.Dot(axes=(1, 1), name = 'Dot27826', )([in0Dot27826,in1Dot27826])
Res41402 = keras.layers.Reshape((1, 1), name = 'Res41402', )(Dot27826)
Res41209 = keras.layers.Reshape((1, 1, 1), name = 'Res41209', )(Res41402)
Cro52627 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro52627', )(Res41209)
Res97471 = keras.layers.Reshape((1, 1), name = 'Res97471', )(Cro52627)
Zer66367 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer66367', )(Res97471)
Con9023 = keras.layers.Conv3D(4, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con9023', )(in0Con9023)
Res59789 = keras.layers.Reshape((2, 1, 4), name = 'Res59789', )(Con9023)
Res69237 = keras.layers.Reshape((2, 4), name = 'Res69237', )(Res59789)
Dot18303 = keras.layers.Dot(axes=(1, 1), name = 'Dot18303', )([Zer66367,Res69237])
model = tf.keras.models.Model(inputs=[in0Dot27826,in1Dot27826,in0Con9023], outputs=Dot18303)
w = model.get_layer('Con9023').get_weights() 
w[0] = np.array([[[[[0.1389, 0.1148, 0.7478, 0.0077]]]], [[[[0.133, 0.3743, 0.2986, 0.0906]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con9023').set_weights(w) 
in0Dot27826 = tf.constant([[0.8332, 0.5421]])
in1Dot27826 = tf.constant([[0.2711, 0.7952]])
in0Con9023 = tf.constant([[[[[0.6331]]], [[[0.396]]]]])
print (np.array2string(model.predict([in0Dot27826,in1Dot27826,in0Con9023],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot18303.png')

LDot27826 = dot_layer([[0.8332, 0.5421]], [[0.2711, 0.7952]], 1, 1, Dot27826), 
LRes41402 = reshape_layer(Dot27826, [1, 1], Res41402), 
LRes41209 = reshape_layer(Res41402, [1, 1, 1], Res41209), 
LCro52627 = cropping2D_layer(Res41209, 0, 0, 0, 0, Cro52627), 
LRes97471 = reshape_layer(Cro52627, [1, 1], Res97471), 
LZer66367 = zero_padding1D_layer(Res97471, 1, 0, Zer66367), 
LCon9023 = conv3D_layer([[[[[0.6331]]], [[[0.396]]]]], 2, 1, 1,[[[[[0.1389, 0.1148, 0.7478, 0.0077]]]], [[[[0.133, 0.3743, 0.2986, 0.0906]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con9023), 
LRes59789 = reshape_layer(Con9023, [2, 1, 4], Res59789), 
LRes69237 = reshape_layer(Res59789, [2, 4], Res69237), 
LDot18303 = dot_layer(Zer66367,Res69237, 1, 1, Dot18303), 
exec_layers([LDot27826,LRes41402,LRes41209,LCro52627,LRes97471,LZer66367,LCon9023,LRes59789,LRes69237,LDot18303],["Dot27826","Res41402","Res41209","Cro52627","Res97471","Zer66367","Con9023","Res59789","Res69237","Dot18303"],Dot18303,"Dot18303")

Actual (Unparsed): [[[0.0361356, 0.0298659, 0.1945443, 0.0020032]]]

Expected (Unparsed): [[[0.036135604817136006,0.029865856249152004,0.19454431448707202,0.0020031976752480003]]]

Actual:   [[[0.0362, 0.0299, 0.1946, 0.0021]]]

Expected: [[[0.0362, 0.0299, 0.1946, 0.0021]]]