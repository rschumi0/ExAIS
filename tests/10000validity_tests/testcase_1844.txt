import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max22946 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Max22946 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Max22946 = keras.layers.Maximum(name = 'Max22946', )([in0Max22946,in1Max22946])
Lay89445 = keras.layers.LayerNormalization(axis=3, epsilon=1.7062990910310185, name = 'Lay89445', )(Max22946)
model = tf.keras.models.Model(inputs=[in0Max22946,in1Max22946], outputs=Lay89445)
in0Max22946 = tf.constant([[[[[0.3611, 0.1515], [0.3426, 0.706]], [[0.6872, 0.1921], [0.9711, 0.4017]]]]])
in1Max22946 = tf.constant([[[[[0.2742, 0.0476], [0.1147, 0.8888]], [[0.698, 0.8499], [0.7211, 0.0383]]]]])
print (np.array2string(model.predict([in0Max22946,in1Max22946],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay89445.png')

LMax22946 = maximum_layer([[[[[[0.3611, 0.1515], [0.3426, 0.706]], [[0.6872, 0.1921], [0.9711, 0.4017]]]]], [[[[[0.2742, 0.0476], [0.1147, 0.8888]], [[0.698, 0.8499], [0.7211, 0.0383]]]]]], Max22946), 
LLay89445 = layer_normalization_layer(Max22946, 3, 1.7062990910310185, Lay89445), 
exec_layers([LMax22946,LLay89445],["Max22946","Lay89445"],Lay89445,"Lay89445")

Actual (Unparsed): [[[[[0.0070811, -0.2716099], [-0.0070811, 0.2716099]], [[-0.1039690, 0.1690890], [0.1039690, -0.1690890]]]]]

Expected (Unparsed): [[[[[0.007081141363137688,-0.27160991754781405],[-0.007081141363137688,0.27160991754781405]],[[-0.10396905084623678,0.16908898579432416],[0.10396905084623687,-0.1690889857943242]]]]]

Actual:   [[[[[0.0071, -0.2716], [-0.007, 0.2717]], [[-0.1039, 0.1691], [0.104, -0.169]]]]]

Expected: [[[[[0.0071, -0.2716], [-0.007, 0.2717]], [[-0.1039, 0.1691], [0.104, -0.169]]]]]