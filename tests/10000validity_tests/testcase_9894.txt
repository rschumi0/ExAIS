import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL38394 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

ReL38394 = keras.layers.ReLU(max_value=9.289058056146036, negative_slope=1.2394225401533878, threshold=0.15776915205744646, name = 'ReL38394', input_shape=(2, 1, 1, 2))(in0ReL38394)
Res70861 = keras.layers.Reshape((2, 1, 2), name = 'Res70861', )(ReL38394)
Dep1962 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='valid', name = 'Dep1962', )(Res70861)
Fla63098 = keras.layers.Flatten(name = 'Fla63098', )(Dep1962)
model = tf.keras.models.Model(inputs=[in0ReL38394], outputs=Fla63098)
w = model.get_layer('Dep1962').get_weights() 
w[0] = np.array([[[[0.5738], [0.7937]]], [[[0.1701], [0.0198]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep1962').set_weights(w) 
in0ReL38394 = tf.constant([[[[[0.0104, 0.79]]], [[[0.1147, 0.3281]]]]])
print (np.array2string(model.predict([in0ReL38394],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla63098.png')

LReL38394 = relu_layer([[[[[0.0104, 0.79]]], [[[0.1147, 0.3281]]]]], 9.289058056146036, 1.2394225401533878, 0.15776915205744646, ReL38394), 
LRes70861 = reshape_layer(ReL38394, [2, 1, 2], Res70861), 
LDep1962 = depthwise_conv2D_layer(Res70861, 2, 1,[[[[0.5738], [0.7937]]], [[[0.1701], [0.0198]]]],[0, 0], 1, 1, false, Dep1962), 
LFla63098 = flatten_layer(Dep1962, Fla63098), 
exec_layers([LReL38394,LRes70861,LDep1962,LFla63098],["ReL38394","Res70861","Dep1962","Fla63098"],Fla63098,"Fla63098")

Actual (Unparsed): [[-0.1138862, 0.6335194]]

Expected (Unparsed): [[-0.11388617719333677,0.63351938]]

Actual:   [[-0.1138, 0.6336]]

Expected: [[-0.1138, 0.6336]]