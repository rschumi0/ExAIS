import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max62438 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max62438 = tf.keras.layers.Input(shape=([2, 1, 2]))

Max62438 = keras.layers.Maximum(name = 'Max62438', )([in0Max62438,in1Max62438])
Res62423 = keras.layers.Reshape((2, 2), name = 'Res62423', )(Max62438)
Glo10314 = keras.layers.GlobalMaxPool1D(name = 'Glo10314', )(Res62423)
Res84669 = keras.layers.Reshape((2, 1), name = 'Res84669', )(Glo10314)
Con42567 = keras.layers.Conv1D(2, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con42567', )(Res84669)
model = tf.keras.models.Model(inputs=[in0Max62438,in1Max62438], outputs=Con42567)
w = model.get_layer('Con42567').get_weights() 
w[0] = np.array([[[0.1237, 0.744]], [[0.0154, 0.6502]]])
w[1] = np.array([0, 0])
model.get_layer('Con42567').set_weights(w) 
in0Max62438 = tf.constant([[[[0.2055, 0.494]], [[0.5131, 0.5601]]]])
in1Max62438 = tf.constant([[[[0.1005, 0.3801]], [[0.1256, 0.866]]]])
print (np.array2string(model.predict([in0Max62438,in1Max62438],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con42567.png')

LMax62438 = maximum_layer([[[[[0.2055, 0.494]], [[0.5131, 0.5601]]]], [[[[0.1005, 0.3801]], [[0.1256, 0.866]]]]], Max62438), 
LRes62423 = reshape_layer(Max62438, [2, 2], Res62423), 
LGlo10314 = global_max_pool1D_layer(Res62423, Glo10314), 
LRes84669 = reshape_layer(Glo10314, [2, 1], Res84669), 
LCon42567 = conv1D_layer(Res84669, 2,[[[0.1237, 0.744]], [[0.0154, 0.6502]]],[0, 0], 1, false, 1, Con42567), 
exec_layers([LMax62438,LRes62423,LGlo10314,LRes84669,LCon42567],["Max62438","Res62423","Glo10314","Res84669","Con42567"],Con42567,"Con42567")

Actual (Unparsed): [[[0.0768069, 0.9448196]]]

Expected (Unparsed): [[[0.07680687,0.9448196]]]

Actual:   [[[0.0769, 0.9449]]]

Expected: [[[0.0769, 0.9449]]]