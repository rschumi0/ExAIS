import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add3848 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add3848 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con88559 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Min30959 = tf.keras.layers.Input(shape=([1, 1]))
in1Min30959 = tf.keras.layers.Input(shape=([1, 1]))
in0Con19573 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Max14993 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max14993 = tf.keras.layers.Input(shape=([1, 2, 2]))

Add3848 = keras.layers.Add(name = 'Add3848', )([in0Add3848,in1Add3848])
Res77465 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res77465', )(Add3848)
Glo28500 = keras.layers.GlobalAveragePooling3D(name = 'Glo28500', )(Res77465)
Res80015 = keras.layers.Reshape((1, 1), name = 'Res80015', )(Glo28500)
LST78612 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST78612', )(Res80015)
Res24369 = keras.layers.Reshape((1, 1), name = 'Res24369', )(LST78612)
Res91155 = keras.layers.Reshape((1, 1, 1), name = 'Res91155', )(Res24369)
Zer10208 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer10208', )(Res91155)
Con88559 = keras.layers.Concatenate(axis=3, name = 'Con88559', )([Zer10208,in0Con88559])
Min30959 = keras.layers.Minimum(name = 'Min30959', )([in0Min30959,in1Min30959])
Res23914 = keras.layers.Reshape((1, 1, 1), name = 'Res23914', )(Min30959)
Zer3183 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer3183', )(Res23914)
Con19573 = keras.layers.Concatenate(axis=3, name = 'Con19573', )([Zer3183,in0Con19573])
Max14993 = keras.layers.Maximum(name = 'Max14993', )([in0Max14993,in1Max14993])
Min98140 = keras.layers.Minimum(name = 'Min98140', )([Con19573,Max14993])
Max38473 = keras.layers.Maximum(name = 'Max38473', )([Con88559,Min98140])
model = tf.keras.models.Model(inputs=[in0Add3848,in1Add3848,in0Con88559,in0Min30959,in1Min30959,in0Con19573,in0Max14993,in1Max14993], outputs=Max38473)
w = model.get_layer('LST78612').get_weights() 
w[0] = np.array([[9, 3, 1, 9]])
w[1] = np.array([[4, 3, 7, 9]])
w[2] = np.array([6, 1, 9, 10])
model.get_layer('LST78612').set_weights(w) 
in0Add3848 = tf.constant([[[[0.5918, 0.8066], [0.3523, 0.6272]]]])
in1Add3848 = tf.constant([[[[0.4189, 0.4792], [0.6582, 0.2396]]]])
in0Con88559 = tf.constant([[[[0.31], [0.5775]]]])
in0Min30959 = tf.constant([[[0.7386]]])
in1Min30959 = tf.constant([[[0.9472]]])
in0Con19573 = tf.constant([[[[0.7539], [0.732]]]])
in0Max14993 = tf.constant([[[[0.6141, 0.2706], [0.9696, 0.1114]]]])
in1Max14993 = tf.constant([[[[0.7478, 0.8227], [0.8927, 0.1868]]]])
print (np.array2string(model.predict([in0Add3848,in1Add3848,in0Con88559,in0Min30959,in1Min30959,in0Con19573,in0Max14993,in1Max14993],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max38473.png')

LAdd3848 = add_layer([[[[[0.5918, 0.8066], [0.3523, 0.6272]]]], [[[[0.4189, 0.4792], [0.6582, 0.2396]]]]], Add3848), 
LRes77465 = reshape_layer(Add3848, [1, 2, 2, 1], Res77465), 
LGlo28500 = global_average_pooling3D_layer(Res77465, Glo28500), 
LRes80015 = reshape_layer(Glo28500, [1, 1], Res80015), 
LLST78612 = lstm_layer(Res80015,[[9, 3, 1, 9]],[[4, 3, 7, 9]],[6, 1, 9, 10], LST78612), 
LRes24369 = reshape_layer(LST78612, [1, 1], Res24369), 
LRes91155 = reshape_layer(Res24369, [1, 1, 1], Res91155), 
LZer10208 = zero_padding2D_layer(Res91155, 0, 0, 1, 0, Zer10208), 
LCon88559 = concatenate_layer([Zer10208,[[[[0.31], [0.5775]]]]], 3, Con88559), 
LMin30959 = minimum_layer([[[[0.7386]]], [[[0.9472]]]], Min30959), 
LRes23914 = reshape_layer(Min30959, [1, 1, 1], Res23914), 
LZer3183 = zero_padding2D_layer(Res23914, 0, 0, 1, 0, Zer3183), 
LCon19573 = concatenate_layer([Zer3183,[[[[0.7539], [0.732]]]]], 3, Con19573), 
LMax14993 = maximum_layer([[[[[0.6141, 0.2706], [0.9696, 0.1114]]]], [[[[0.7478, 0.8227], [0.8927, 0.1868]]]]], Max14993), 
LMin98140 = minimum_layer([Con19573,Max14993], Min98140), 
LMax38473 = maximum_layer([Con88559,Min98140], Max38473), 
exec_layers([LAdd3848,LRes77465,LGlo28500,LRes80015,LLST78612,LRes24369,LRes91155,LZer10208,LCon88559,LMin30959,LRes23914,LZer3183,LCon19573,LMax14993,LMin98140,LMax38473],["Add3848","Res77465","Glo28500","Res80015","LST78612","Res24369","Res91155","Zer10208","Con88559","Min30959","Res23914","Zer3183","Con19573","Max14993","Min98140","Max38473"],Max38473,"Max38473")

Actual (Unparsed): [[[[0.0000000, 0.7539000], [0.7615941, 0.5775000]]]]

Expected (Unparsed): [[[[0,0.7539],[0.7615940645916177,0.5775]]]]

Actual:   [[[[0, 0.7539], [0.7616, 0.5775]]]]

Expected: [[[[0, 0.7539], [0.7616, 0.5775]]]]