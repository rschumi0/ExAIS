import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max53573 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Max53573 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Mul434 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul434 = tf.keras.layers.Input(shape=([1, 2]))

Max53573 = keras.layers.Maximum(name = 'Max53573', )([in0Max53573,in1Max53573])
Mas41712 = keras.layers.Masking(mask_value=2, name = 'Mas41712', )(Max53573)
Res24488 = keras.layers.Reshape((1, 1, 2), name = 'Res24488', )(Mas41712)
Mul434 = keras.layers.Multiply(name = 'Mul434', )([in0Mul434,in1Mul434])
Res32003 = keras.layers.Reshape((1, 1, 2), name = 'Res32003', )(Mul434)
Min42067 = keras.layers.Minimum(name = 'Min42067', )([Res24488,Res32003])
Mas99897 = keras.layers.Masking(mask_value=2, name = 'Mas99897', )(Min42067)
model = tf.keras.models.Model(inputs=[in0Max53573,in1Max53573,in0Mul434,in1Mul434], outputs=Mas99897)
in0Max53573 = tf.constant([[[[[0.9282], [0.1824]]]]])
in1Max53573 = tf.constant([[[[[0.947], [0.1768]]]]])
in0Mul434 = tf.constant([[[0.9904, 0.8728]]])
in1Mul434 = tf.constant([[[0.8556, 0.8973]]])
print (np.array2string(model.predict([in0Max53573,in1Max53573,in0Mul434,in1Mul434],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas99897.png')

LMax53573 = maximum_layer([[[[[[0.9282], [0.1824]]]]], [[[[[0.947], [0.1768]]]]]], Max53573), 
LMas41712 = masking_layer(Max53573, 2, Mas41712), 
LRes24488 = reshape_layer(Mas41712, [1, 1, 2], Res24488), 
LMul434 = multiply_layer([[[[0.9904, 0.8728]]], [[[0.8556, 0.8973]]]], Mul434), 
LRes32003 = reshape_layer(Mul434, [1, 1, 2], Res32003), 
LMin42067 = minimum_layer([Res24488,Res32003], Min42067), 
LMas99897 = masking_layer(Min42067, 2, Mas99897), 
exec_layers([LMax53573,LMas41712,LRes24488,LMul434,LRes32003,LMin42067,LMas99897],["Max53573","Mas41712","Res24488","Mul434","Res32003","Min42067","Mas99897"],Mas99897,"Mas99897")

Actual (Unparsed): [[[[0.8473863, 0.1824000]]]]

Expected (Unparsed): [[[[0.84738624,0.1824]]]]

Actual:   [[[[0.8474, 0.1824]]]]

Expected: [[[[0.8474, 0.1824]]]]