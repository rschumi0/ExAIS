import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add94895 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Add94895 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Add94895 = keras.layers.Add(name = 'Add94895', )([in0Add94895,in1Add94895])
Bat37927 = keras.layers.BatchNormalization(axis=3, epsilon=0.8206564170088398,  name = 'Bat37927', )(Add94895)
Res6346 = keras.layers.Reshape((2, 2, 2), name = 'Res6346', )(Bat37927)
Ave26277 = keras.layers.AveragePooling2D(pool_size=(2, 2), name = 'Ave26277', )(Res6346)
model = tf.keras.models.Model(inputs=[in0Add94895,in1Add94895], outputs=Ave26277)
w = model.get_layer('Bat37927').get_weights() 
w[0] = np.array([0.3987, 0.9807])
w[1] = np.array([0.798, 0.1093])
w[2] = np.array([0.5314, 0.8731])
w[3] = np.array([0.9928, 0.912])
model.get_layer('Bat37927').set_weights(w) 
in0Add94895 = tf.constant([[[[[0.4563], [0.0232]], [[0.284], [0.7883]]], [[[0.7996], [0.2231]], [[0.0501], [0.0155]]]]])
in1Add94895 = tf.constant([[[[[0.2244], [0.9635]], [[0.2838], [0.1779]]], [[[0.052], [0.833]], [[0.1262], [0.933]]]]])
print (np.array2string(model.predict([in0Add94895,in1Add94895],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave26277.png')

LAdd94895 = add_layer([[[[[[0.4563], [0.0232]], [[0.284], [0.7883]]], [[[0.7996], [0.2231]], [[0.0501], [0.0155]]]]], [[[[[0.2244], [0.9635]], [[0.2838], [0.1779]]], [[[0.052], [0.833]], [[0.1262], [0.933]]]]]], Add94895), 
LBat37927 = batch_normalization_layer(Add94895, 3, 0.8206564170088398, [0.3987, 0.9807], [0.798, 0.1093], [0.5314, 0.8731], [0.9928, 0.912], Bat37927), 
LRes6346 = reshape_layer(Bat37927, [2, 2, 2], Res6346), 
LAve26277 = average_pooling2D_layer(Res6346, 2, 2, Ave26277), 
exec_layers([LAdd94895,LBat37927,LRes6346,LAve26277],["Add94895","Bat37927","Res6346","Ave26277"],Ave26277,"Ave26277")

Actual (Unparsed): [[[[0.8091618, 0.1959296]]]]

Expected (Unparsed): [[[[0.8091617945544685,0.1959295977455372]]]]

Actual:   [[[[0.8092, 0.196]]]]

Expected: [[[[0.8092, 0.196]]]]