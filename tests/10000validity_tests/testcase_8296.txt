import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave40380 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave40380 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul88772 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Mul88772 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Ave40380 = keras.layers.Average(name = 'Ave40380', )([in0Ave40380,in1Ave40380])
Res44387 = keras.layers.Reshape((1, 2, 1), name = 'Res44387', )(Ave40380)
Mul88772 = keras.layers.Multiply(name = 'Mul88772', )([in0Mul88772,in1Mul88772])
Res58588 = keras.layers.Reshape((1, 2, 1), name = 'Res58588', )(Mul88772)
Sub23204 = keras.layers.Subtract(name = 'Sub23204', )([Res44387,Res58588])
model = tf.keras.models.Model(inputs=[in0Ave40380,in1Ave40380,in0Mul88772,in1Mul88772], outputs=Sub23204)
in0Ave40380 = tf.constant([[[0.1426, 0.8666]]])
in1Ave40380 = tf.constant([[[0.717, 0.5609]]])
in0Mul88772 = tf.constant([[[[[0.836]]], [[[0.3618]]]]])
in1Mul88772 = tf.constant([[[[[0.317]]], [[[0.5161]]]]])
print (np.array2string(model.predict([in0Ave40380,in1Ave40380,in0Mul88772,in1Mul88772],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub23204.png')

LAve40380 = average_layer([[[[0.1426, 0.8666]]], [[[0.717, 0.5609]]]], Ave40380), 
LRes44387 = reshape_layer(Ave40380, [1, 2, 1], Res44387), 
LMul88772 = multiply_layer([[[[[[0.836]]], [[[0.3618]]]]], [[[[[0.317]]], [[[0.5161]]]]]], Mul88772), 
LRes58588 = reshape_layer(Mul88772, [1, 2, 1], Res58588), 
LSub23204 = subtract_layer(Res44387,Res58588, Sub23204), 
exec_layers([LAve40380,LRes44387,LMul88772,LRes58588,LSub23204],["Ave40380","Res44387","Mul88772","Res58588","Sub23204"],Sub23204,"Sub23204")

Actual (Unparsed): [[[[0.1647880], [0.5270250]]]]

Expected (Unparsed): [[[[0.164788],[0.52702502]]]]

Actual:   [[[[0.1648], [0.5271]]]]

Expected: [[[[0.1648], [0.5271]]]]