import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave20181 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Ave20181 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Ave20181 = keras.layers.Average(name = 'Ave20181', )([in0Ave20181,in1Ave20181])
Res27129 = keras.layers.Reshape((2, 2, 4), name = 'Res27129', )(Ave20181)
Res43505 = keras.layers.Reshape((2, 8), name = 'Res43505', )(Res27129)
Glo83308 = keras.layers.GlobalAveragePooling1D(name = 'Glo83308', )(Res43505)
model = tf.keras.models.Model(inputs=[in0Ave20181,in1Ave20181], outputs=Glo83308)
in0Ave20181 = tf.constant([[[[[0.7152, 0.7821], [0.2754, 0.1452]], [[0.9054, 0.9333], [0.2681, 0.6863]]], [[[0.7544, 0.8155], [0.6974, 0.862]], [[0.7725, 0.1665], [0.5777, 0.8945]]]]])
in1Ave20181 = tf.constant([[[[[0.1749, 0.5896], [0.6752, 0.6649]], [[0.6128, 0.4931], [0.1375, 0.0575]]], [[[0.8239, 0.7812], [0.9411, 0.9631]], [[0.2502, 0.8053], [0.1158, 0.9083]]]]])
print (np.array2string(model.predict([in0Ave20181,in1Ave20181],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo83308.png')

LAve20181 = average_layer([[[[[[0.7152, 0.7821], [0.2754, 0.1452]], [[0.9054, 0.9333], [0.2681, 0.6863]]], [[[0.7544, 0.8155], [0.6974, 0.862]], [[0.7725, 0.1665], [0.5777, 0.8945]]]]], [[[[[0.1749, 0.5896], [0.6752, 0.6649]], [[0.6128, 0.4931], [0.1375, 0.0575]]], [[[0.8239, 0.7812], [0.9411, 0.9631]], [[0.2502, 0.8053], [0.1158, 0.9083]]]]]], Ave20181), 
LRes27129 = reshape_layer(Ave20181, [2, 2, 4], Res27129), 
LRes43505 = reshape_layer(Res27129, [2, 8], Res43505), 
LGlo83308 = global_average_pooling1D_layer(Res43505, Glo83308), 
exec_layers([LAve20181,LRes27129,LRes43505,LGlo83308],["Ave20181","Res27129","Res43505","Glo83308"],Glo83308,"Glo83308")

Actual (Unparsed): [[0.6171000, 0.7421000, 0.6472750, 0.6588000, 0.6352250, 0.5995500, 0.2747750, 0.6366500]]

Expected (Unparsed): [[0.6171,0.7421,0.647275,0.6588,0.6352249999999999,0.59955,0.274775,0.6366499999999999]]

Actual:   [[0.6171, 0.7421, 0.6473, 0.6588, 0.6353, 0.5996, 0.2748, 0.6367]]

Expected: [[0.6171, 0.7421, 0.6473, 0.6588, 0.6353, 0.5996, 0.2748, 0.6367]]