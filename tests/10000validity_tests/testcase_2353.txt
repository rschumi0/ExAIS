import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min82696 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min82696 = tf.keras.layers.Input(shape=([2, 1, 1]))

Min82696 = keras.layers.Minimum(name = 'Min82696', )([in0Min82696,in1Min82696])
Res38825 = keras.layers.Reshape((2, 1), name = 'Res38825', )(Min82696)
Glo47666 = keras.layers.GlobalAveragePooling1D(name = 'Glo47666', )(Res38825)
Res99963 = keras.layers.Reshape((1, 1), name = 'Res99963', )(Glo47666)
Res72227 = keras.layers.Reshape((1, 1, 1), name = 'Res72227', )(Res99963)
Con4838 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 1), padding='valid', name = 'Con4838', )(Res72227)
Res30386 = keras.layers.Reshape((1, 3), name = 'Res30386', )(Con4838)
GRU33608 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU33608', )(Res30386)
model = tf.keras.models.Model(inputs=[in0Min82696,in1Min82696], outputs=GRU33608)
w = model.get_layer('Con4838').get_weights() 
w[0] = np.array([[[[0.4595], [0.1676], [0.1541]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con4838').set_weights(w) 
w = model.get_layer('GRU33608').get_weights() 
w[0] = np.array([[1, 10, 1, 9, 9, 1, 7, 8, 2], [1, 8, 10, 9, 5, 8, 4, 2, 1], [8, 3, 3, 3, 7, 2, 10, 9, 1]])
w[1] = np.array([[9, 3, 2, 5, 10, 4, 1, 5, 3], [8, 1, 8, 9, 7, 10, 5, 3, 9], [4, 9, 5, 7, 6, 7, 8, 3, 4]])
w[2] = np.array([7, 4, 2, 3, 3, 6, 7, 7, 5])
model.get_layer('GRU33608').set_weights(w) 
in0Min82696 = tf.constant([[[[0.8643]], [[0.1869]]]])
in1Min82696 = tf.constant([[[[0.7794]], [[0.897]]]])
print (np.array2string(model.predict([in0Min82696,in1Min82696],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU33608.png')

LMin82696 = minimum_layer([[[[[0.8643]], [[0.1869]]]], [[[[0.7794]], [[0.897]]]]], Min82696), 
LRes38825 = reshape_layer(Min82696, [2, 1], Res38825), 
LGlo47666 = global_average_pooling1D_layer(Res38825, Glo47666), 
LRes99963 = reshape_layer(Glo47666, [1, 1], Res99963), 
LRes72227 = reshape_layer(Res99963, [1, 1, 1], Res72227), 
LCon4838 = conv2D_transpose_layer(Res72227, 1, 1,[[[[0.4595], [0.1676], [0.1541]]]],[0, 0, 0], 1, 1, false, Con4838), 
LRes30386 = reshape_layer(Con4838, [1, 3], Res30386), 
LGRU33608 = gru_layer(Res30386,[[1, 10, 1, 9, 9, 1, 7, 8, 2], [1, 8, 10, 9, 5, 8, 4, 2, 1], [8, 3, 3, 3, 7, 2, 10, 9, 1]],[[9, 3, 2, 5, 10, 4, 1, 5, 3], [8, 1, 8, 9, 7, 10, 5, 3, 9], [4, 9, 5, 7, 6, 7, 8, 3, 4]],[7, 4, 2, 3, 3, 6, 7, 7, 5], false, GRU33608), 
exec_layers([LMin82696,LRes38825,LGlo47666,LRes99963,LRes72227,LCon4838,LRes30386,LGRU33608],["Min82696","Res38825","Glo47666","Res99963","Res72227","Con4838","Res30386","GRU33608"],GRU33608,"GRU33608")

Actual (Unparsed): [[0.0003711, 0.0008317, 0.0371421]]

Expected (Unparsed): [[0.0003711211926598229,0.00083167065678457,0.037142072788520504]]

Actual:   [[0.0004, 0.0009, 0.0372]]

Expected: [[0.0004, 0.0009, 0.0372]]