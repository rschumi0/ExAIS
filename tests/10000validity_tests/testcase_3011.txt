import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add26144 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add26144 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Dot40915 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot40915 = tf.keras.layers.Input(shape=([2, 2]))

Add26144 = keras.layers.Add(name = 'Add26144', )([in0Add26144,in1Add26144])
Res37105 = keras.layers.Reshape((2, 2), name = 'Res37105', )(Add26144)
Dot40915 = keras.layers.Dot(axes=(1, 1), name = 'Dot40915', )([in0Dot40915,in1Dot40915])
Dot66452 = keras.layers.Dot(axes=(1, 1), name = 'Dot66452', )([Res37105,Dot40915])
Glo13985 = keras.layers.GlobalAveragePooling1D(name = 'Glo13985', )(Dot66452)
Res40702 = keras.layers.Reshape((2, 1), name = 'Res40702', )(Glo13985)
Res61219 = keras.layers.Reshape((2, 1, 1), name = 'Res61219', )(Res40702)
Dep69400 = keras.layers.DepthwiseConv2D((1, 1),strides=(2, 2), padding='valid', name = 'Dep69400', )(Res61219)
model = tf.keras.models.Model(inputs=[in0Add26144,in1Add26144,in0Dot40915,in1Dot40915], outputs=Dep69400)
w = model.get_layer('Dep69400').get_weights() 
w[0] = np.array([[[[0.0477]]]])
w[1] = np.array([0])
model.get_layer('Dep69400').set_weights(w) 
in0Add26144 = tf.constant([[[[0.7406], [0.8515]], [[0.5492], [0.1758]]]])
in1Add26144 = tf.constant([[[[0.7576], [0.1447]], [[0.0638], [0.9236]]]])
in0Dot40915 = tf.constant([[[0.0865, 0.1274], [0.7991, 0.6107]]])
in1Dot40915 = tf.constant([[[0.7478, 0.608], [0.9551, 0.6521]]])
print (np.array2string(model.predict([in0Add26144,in1Add26144,in0Dot40915,in1Dot40915],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep69400.png')

LAdd26144 = add_layer([[[[[0.7406], [0.8515]], [[0.5492], [0.1758]]]], [[[[0.7576], [0.1447]], [[0.0638], [0.9236]]]]], Add26144), 
LRes37105 = reshape_layer(Add26144, [2, 2], Res37105), 
LDot40915 = dot_layer([[[0.0865, 0.1274], [0.7991, 0.6107]]], [[[0.7478, 0.608], [0.9551, 0.6521]]], 1, 1, Dot40915), 
LDot66452 = dot_layer(Res37105,Dot40915, 1, 1, Dot66452), 
LGlo13985 = global_average_pooling1D_layer(Dot66452, Glo13985), 
LRes40702 = reshape_layer(Glo13985, [2, 1], Res40702), 
LRes61219 = reshape_layer(Res40702, [2, 1, 1], Res61219), 
LDep69400 = depthwise_conv2D_layer(Res61219, 1, 1,[[[[0.0477]]]],[0], 2, 2, false, Dep69400), 
exec_layers([LAdd26144,LRes37105,LDot40915,LDot66452,LGlo13985,LRes40702,LRes61219,LDep69400],["Add26144","Res37105","Dot40915","Dot66452","Glo13985","Res40702","Res61219","Dep69400"],Dep69400,"Dep69400")

Actual (Unparsed): [[[[0.0769657]]]]

Expected (Unparsed): [[[[0.07696572230733299]]]]

Actual:   [[[[0.077]]]]

Expected: [[[[0.077]]]]