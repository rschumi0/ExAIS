import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max79359 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Max79359 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Max97023 = tf.keras.layers.Input(shape=([2, 2]))
in1Max97023 = tf.keras.layers.Input(shape=([2, 2]))
in0Con66796 = tf.keras.layers.Input(shape=([2, 6]))

Max79359 = keras.layers.Maximum(name = 'Max79359', )([in0Max79359,in1Max79359])
Res29211 = keras.layers.Reshape((1, 2, 4), name = 'Res29211', )(Max79359)
Res69921 = keras.layers.Reshape((1, 8), name = 'Res69921', )(Res29211)
Zer76468 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer76468', )(Res69921)
Max97023 = keras.layers.Maximum(name = 'Max97023', )([in0Max97023,in1Max97023])
Con66796 = keras.layers.Concatenate(axis=2, name = 'Con66796', )([Max97023,in0Con66796])
Max26500 = keras.layers.Maximum(name = 'Max26500', )([Zer76468,Con66796])
model = tf.keras.models.Model(inputs=[in0Max79359,in1Max79359,in0Max97023,in1Max97023,in0Con66796], outputs=Max26500)
in0Max79359 = tf.constant([[[[[0.9103, 0.7261], [0.8363, 0.1624]], [[0.2038, 0.5111], [0.2444, 0.0561]]]]])
in1Max79359 = tf.constant([[[[[0.8322, 0.7429], [0.018, 0.4069]], [[0.3971, 0.5394], [0.5322, 0.0124]]]]])
in0Max97023 = tf.constant([[[0.2493, 0.6851], [0.0116, 0.2927]]])
in1Max97023 = tf.constant([[[0.5205, 0.0591], [0.9145, 0.7397]]])
in0Con66796 = tf.constant([[[0.3677, 0.0664, 0.3415, 0.6346, 0.9825, 0.4417], [0.9029, 0.1979, 0.1081, 0.7977, 0.9795, 0.3752]]])
print (np.array2string(model.predict([in0Max79359,in1Max79359,in0Max97023,in1Max97023,in0Con66796],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max26500.png')

LMax79359 = maximum_layer([[[[[[0.9103, 0.7261], [0.8363, 0.1624]], [[0.2038, 0.5111], [0.2444, 0.0561]]]]], [[[[[0.8322, 0.7429], [0.018, 0.4069]], [[0.3971, 0.5394], [0.5322, 0.0124]]]]]], Max79359), 
LRes29211 = reshape_layer(Max79359, [1, 2, 4], Res29211), 
LRes69921 = reshape_layer(Res29211, [1, 8], Res69921), 
LZer76468 = zero_padding1D_layer(Res69921, 1, 0, Zer76468), 
LMax97023 = maximum_layer([[[[0.2493, 0.6851], [0.0116, 0.2927]]], [[[0.5205, 0.0591], [0.9145, 0.7397]]]], Max97023), 
LCon66796 = concatenate_layer([Max97023,[[[0.3677, 0.0664, 0.3415, 0.6346, 0.9825, 0.4417], [0.9029, 0.1979, 0.1081, 0.7977, 0.9795, 0.3752]]]], 2, Con66796), 
LMax26500 = maximum_layer([Zer76468,Con66796], Max26500), 
exec_layers([LMax79359,LRes29211,LRes69921,LZer76468,LMax97023,LCon66796,LMax26500],["Max79359","Res29211","Res69921","Zer76468","Max97023","Con66796","Max26500"],Max26500,"Max26500")

Actual (Unparsed): [[[0.5205000, 0.6851000, 0.3677000, 0.0664000, 0.3415000, 0.6346000, 0.9825000, 0.4417000], [0.9145000, 0.7429000, 0.9029000, 0.4069000, 0.3971000, 0.7977000, 0.9795000, 0.3752000]]]

Expected (Unparsed): [[[0.5205,0.6851,0.3677,0.0664,0.3415,0.6346,0.9825,0.4417],[0.9145,0.7429,0.9029,0.4069,0.3971,0.7977,0.9795,0.3752]]]

Actual:   [[[0.5205, 0.6851, 0.3677, 0.0664, 0.3415, 0.6346, 0.9825, 0.4417], [0.9145, 0.7429, 0.9029, 0.4069, 0.3971, 0.7977, 0.9795, 0.3752]]]

Expected: [[[0.5205, 0.6851, 0.3677, 0.0664, 0.3415, 0.6346, 0.9825, 0.4417], [0.9145, 0.7429, 0.9029, 0.4069, 0.3971, 0.7977, 0.9795, 0.3752]]]