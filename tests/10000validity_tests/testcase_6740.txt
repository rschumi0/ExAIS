import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul41120 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul41120 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con8785 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Add84525 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Add84525 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Mul41120 = keras.layers.Multiply(name = 'Mul41120', )([in0Mul41120,in1Mul41120])
Res81255 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res81255', )(Mul41120)
Con8785 = keras.layers.Concatenate(axis=4, name = 'Con8785', )([Res81255,in0Con8785])
Add84525 = keras.layers.Add(name = 'Add84525', )([in0Add84525,in1Add84525])
Zer14593 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer14593', )(Add84525)
Ave71719 = keras.layers.Average(name = 'Ave71719', )([Con8785,Zer14593])
model = tf.keras.models.Model(inputs=[in0Mul41120,in1Mul41120,in0Con8785,in0Add84525,in1Add84525], outputs=Ave71719)
in0Mul41120 = tf.constant([[[[0.7088, 0.1217]], [[0.0137, 0.6002]]]])
in1Mul41120 = tf.constant([[[[0.0257, 0.5945]], [[0.4519, 0.7728]]]])
in0Con8785 = tf.constant([[[[[0.1329], [0.3427]]], [[[0.1747], [0.0711]]]]])
in0Add84525 = tf.constant([[[[[0.0388, 0.8308]]]]])
in1Add84525 = tf.constant([[[[[0.3554, 0.9032]]]]])
print (np.array2string(model.predict([in0Mul41120,in1Mul41120,in0Con8785,in0Add84525,in1Add84525],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave71719.png')

LMul41120 = multiply_layer([[[[[0.7088, 0.1217]], [[0.0137, 0.6002]]]], [[[[0.0257, 0.5945]], [[0.4519, 0.7728]]]]], Mul41120), 
LRes81255 = reshape_layer(Mul41120, [2, 1, 2, 1], Res81255), 
LCon8785 = concatenate_layer([Res81255,[[[[[0.1329], [0.3427]]], [[[0.1747], [0.0711]]]]]], 4, Con8785), 
LAdd84525 = add_layer([[[[[[0.0388, 0.8308]]]]], [[[[[0.3554, 0.9032]]]]]], Add84525), 
LZer14593 = zero_padding3D_layer(Add84525, 1, 0, 0, 0, 1, 0, Zer14593), 
LAve71719 = average_layer([Con8785,Zer14593], Ave71719), 
exec_layers([LMul41120,LRes81255,LCon8785,LAdd84525,LZer14593,LAve71719],["Mul41120","Res81255","Con8785","Add84525","Zer14593","Ave71719"],Ave71719,"Ave71719")

Actual (Unparsed): [[[[[0.0091081, 0.0664500], [0.0361753, 0.1713500]]], [[[0.0030955, 0.0873500], [0.4290173, 0.9025500]]]]]

Expected (Unparsed): [[[[[0.00910808,0.06645],[0.036175325,0.17135]]],[[[0.003095515,0.08735],[0.42901728,0.90255]]]]]

Actual:   [[[[[0.0092, 0.0665], [0.0362, 0.1714]]], [[[0.0031, 0.0874], [0.4291, 0.9026]]]]]

Expected: [[[[[0.0092, 0.0665], [0.0362, 0.1714]]], [[[0.0031, 0.0874], [0.4291, 0.9026]]]]]