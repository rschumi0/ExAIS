import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave91736 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave91736 = tf.keras.layers.Input(shape=([2, 1]))
in0Add43655 = tf.keras.layers.Input(shape=([2, 2]))
in1Add43655 = tf.keras.layers.Input(shape=([2, 2]))

Ave91736 = keras.layers.Average(name = 'Ave91736', )([in0Ave91736,in1Ave91736])
Res20725 = keras.layers.Reshape((2, 1, 1), name = 'Res20725', )(Ave91736)
Loc76119 = keras.layers.LocallyConnected2D(3, (2, 1),strides=(1, 1), name = 'Loc76119', )(Res20725)
Res45079 = keras.layers.Reshape((1, 3), name = 'Res45079', )(Loc76119)
Add43655 = keras.layers.Add(name = 'Add43655', )([in0Add43655,in1Add43655])
Cro86650 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro86650', )(Add43655)
Dot49694 = keras.layers.Dot(axes=(1, 1), name = 'Dot49694', )([Res45079,Cro86650])
model = tf.keras.models.Model(inputs=[in0Ave91736,in1Ave91736,in0Add43655,in1Add43655], outputs=Dot49694)
w = model.get_layer('Loc76119').get_weights() 
w[0] = np.array([[[0.5812, 0.0186, 0.4099], [0.5317, 0.6846, 0.5075]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc76119').set_weights(w) 
in0Ave91736 = tf.constant([[[0.9161], [0.5263]]])
in1Ave91736 = tf.constant([[[0.7455], [0.6167]]])
in0Add43655 = tf.constant([[[0.47, 0.0619], [0.4003, 0.3073]]])
in1Add43655 = tf.constant([[[0.7701, 0.8214], [0.7563, 0.5858]]])
print (np.array2string(model.predict([in0Ave91736,in1Ave91736,in0Add43655,in1Add43655],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot49694.png')

LAve91736 = average_layer([[[[0.9161], [0.5263]]], [[[0.7455], [0.6167]]]], Ave91736), 
LRes20725 = reshape_layer(Ave91736, [2, 1, 1], Res20725), 
LLoc76119 = locally_connected2D_layer(Res20725, 2, 1,[[[0.5812, 0.0186, 0.4099], [0.5317, 0.6846, 0.5075]]],[[[0, 0, 0]]], 1, 1, Loc76119), 
LRes45079 = reshape_layer(Loc76119, [1, 3], Res45079), 
LAdd43655 = add_layer([[[[0.47, 0.0619], [0.4003, 0.3073]]], [[[0.7701, 0.8214], [0.7563, 0.5858]]]], Add43655), 
LCro86650 = cropping1D_layer(Add43655, 0, 1, Cro86650), 
LDot49694 = dot_layer(Res45079,Cro86650, 1, 1, Dot49694), 
exec_layers([LAve91736,LRes20725,LLoc76119,LRes45079,LAdd43655,LCro86650,LDot49694],["Ave91736","Res20725","Loc76119","Res45079","Add43655","Cro86650","Dot49694"],Dot49694,"Dot49694")

Actual (Unparsed): [[[0.9756208, 0.6949164], [0.5043509, 0.3592397], [0.7819837, 0.5569924]]]

Expected (Unparsed): [[[0.9756207851509999,0.6949164095829999],[0.504350877378,0.359239682274],[0.7819837089169999,0.5569923474609999]]]

Actual:   [[[0.9757, 0.695], [0.5044, 0.3593], [0.782, 0.557]]]

Expected: [[[0.9757, 0.695], [0.5044, 0.3593], [0.782, 0.557]]]