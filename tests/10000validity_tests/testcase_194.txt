import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub25924 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in1Sub25924 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in0Dot15179 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot15179 = tf.keras.layers.Input(shape=([2, 2]))
in0Con3097 = tf.keras.layers.Input(shape=([2, 10]))
in0Dot46607 = tf.keras.layers.Input(shape=([2]))
in1Dot46607 = tf.keras.layers.Input(shape=([2]))
in0Con96188 = tf.keras.layers.Input(shape=([2, 11]))

Sub25924 = keras.layers.Subtract(name = 'Sub25924', )([in0Sub25924,in1Sub25924])
Bat10620 = keras.layers.BatchNormalization(axis=2, epsilon=0.7123224538409828,  name = 'Bat10620', )(Sub25924)
Res87269 = keras.layers.Reshape((2, 2, 6), name = 'Res87269', )(Bat10620)
Res91996 = keras.layers.Reshape((2, 12), name = 'Res91996', )(Res87269)
Dot15179 = keras.layers.Dot(axes=(2, 2), name = 'Dot15179', )([in0Dot15179,in1Dot15179])
Con3097 = keras.layers.Concatenate(axis=2, name = 'Con3097', )([Dot15179,in0Con3097])
Add70790 = keras.layers.Add(name = 'Add70790', )([Res91996,Con3097])
Dot46607 = keras.layers.Dot(axes=(1, 1), name = 'Dot46607', )([in0Dot46607,in1Dot46607])
Res60097 = keras.layers.Reshape((1, 1), name = 'Res60097', )(Dot46607)
PRe66307 = keras.layers.PReLU(name = 'PRe66307', )(Res60097)
Zer57356 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer57356', )(PRe66307)
Con96188 = keras.layers.Concatenate(axis=2, name = 'Con96188', )([Zer57356,in0Con96188])
Min94893 = keras.layers.Minimum(name = 'Min94893', )([Add70790,Con96188])
model = tf.keras.models.Model(inputs=[in0Sub25924,in1Sub25924,in0Dot15179,in1Dot15179,in0Con3097,in0Dot46607,in1Dot46607,in0Con96188], outputs=Min94893)
w = model.get_layer('Bat10620').get_weights() 
w[0] = np.array([0.5829, 0.7627])
w[1] = np.array([0.8817, 0.5439])
w[2] = np.array([0.8818, 0.2512])
w[3] = np.array([0.826, 0.7072])
model.get_layer('Bat10620').set_weights(w) 
w = model.get_layer('PRe66307').get_weights() 
w[0] = np.array([[0.749]])
model.get_layer('PRe66307').set_weights(w) 
in0Sub25924 = tf.constant([[[[[0.6699, 0.2591], [0.1969, 0.5883], [0.3432, 0.6866]], [[0.1697, 0.2181], [0.9965, 0.8872], [0.3315, 0.354]]], [[[0.1684, 0.7895], [0.1685, 0.5586], [0.2477, 0.1508]], [[0.3869, 0.5566], [0.6693, 0.9106], [0.3382, 0.3004]]]]])
in1Sub25924 = tf.constant([[[[[0.1887, 0.0717], [0.6165, 0.9186], [0.7876, 0.2272]], [[0.4639, 0.9869], [0.1954, 0.5707], [0.697, 0.5542]]], [[[0.9695, 0.7301], [0.9657, 0.6143], [0.575, 0.0455]], [[0.2921, 0.2708], [0.9262, 0.9765], [0.0008, 0.6638]]]]])
in0Dot15179 = tf.constant([[[0.4075, 0.1683], [0.3494, 0.8418]]])
in1Dot15179 = tf.constant([[[0.4807, 0.3319], [0.3943, 0.1542]]])
in0Con3097 = tf.constant([[[0.004, 0.6729, 0.1484, 0.21, 0.1433, 0.0989, 0.75, 0.4535, 0.769, 0.5247], [0.5876, 0.2542, 0.5946, 0.0702, 0.4643, 0.2419, 0.7862, 0.4763, 0.9705, 0.9499]]])
in0Dot46607 = tf.constant([[0.6012, 0.5016]])
in1Dot46607 = tf.constant([[0.8859, 0.4092]])
in0Con96188 = tf.constant([[[0.2266, 0.2375, 0.3913, 0.4232, 0.1147, 0.1551, 0.8399, 0.2951, 0.6901, 0.8835, 0.7168], [0.147, 0.9397, 0.8269, 0.1863, 0.1561, 0.5217, 0.1762, 0.6002, 0.4278, 0.8881, 0.2066]]])
print (np.array2string(model.predict([in0Sub25924,in1Sub25924,in0Dot15179,in1Dot15179,in0Con3097,in0Dot46607,in1Dot46607,in0Con96188],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min94893.png')

LSub25924 = subtract_layer([[[[[0.6699, 0.2591], [0.1969, 0.5883], [0.3432, 0.6866]], [[0.1697, 0.2181], [0.9965, 0.8872], [0.3315, 0.354]]], [[[0.1684, 0.7895], [0.1685, 0.5586], [0.2477, 0.1508]], [[0.3869, 0.5566], [0.6693, 0.9106], [0.3382, 0.3004]]]]], [[[[[0.1887, 0.0717], [0.6165, 0.9186], [0.7876, 0.2272]], [[0.4639, 0.9869], [0.1954, 0.5707], [0.697, 0.5542]]], [[[0.9695, 0.7301], [0.9657, 0.6143], [0.575, 0.0455]], [[0.2921, 0.2708], [0.9262, 0.9765], [0.0008, 0.6638]]]]], Sub25924), 
LBat10620 = batch_normalization_layer(Sub25924, 2, 0.7123224538409828, [0.5829, 0.7627], [0.8817, 0.5439], [0.8818, 0.2512], [0.826, 0.7072], Bat10620), 
LRes87269 = reshape_layer(Bat10620, [2, 2, 6], Res87269), 
LRes91996 = reshape_layer(Res87269, [2, 12], Res91996), 
LDot15179 = dot_layer([[[0.4075, 0.1683], [0.3494, 0.8418]]], [[[0.4807, 0.3319], [0.3943, 0.1542]]], 2, 2, Dot15179), 
LCon3097 = concatenate_layer([Dot15179,[[[0.004, 0.6729, 0.1484, 0.21, 0.1433, 0.0989, 0.75, 0.4535, 0.769, 0.5247], [0.5876, 0.2542, 0.5946, 0.0702, 0.4643, 0.2419, 0.7862, 0.4763, 0.9705, 0.9499]]]], 2, Con3097), 
LAdd70790 = add_layer([Res91996,Con3097], Add70790), 
LDot46607 = dot_layer([[0.6012, 0.5016]], [[0.8859, 0.4092]], 1, 1, Dot46607), 
LRes60097 = reshape_layer(Dot46607, [1, 1], Res60097), 
LPRe66307 = prelu_layer(Res60097, [[0.749]], PRe66307), 
LZer57356 = zero_padding1D_layer(PRe66307, 1, 0, Zer57356), 
LCon96188 = concatenate_layer([Zer57356,[[[0.2266, 0.2375, 0.3913, 0.4232, 0.1147, 0.1551, 0.8399, 0.2951, 0.6901, 0.8835, 0.7168], [0.147, 0.9397, 0.8269, 0.1863, 0.1561, 0.5217, 0.1762, 0.6002, 0.4278, 0.8881, 0.2066]]]], 2, Con96188), 
LMin94893 = minimum_layer([Add70790,Con96188], Min94893), 
exec_layers([LSub25924,LBat10620,LRes87269,LRes91996,LDot15179,LCon3097,LAdd70790,LDot46607,LRes60097,LPRe66307,LZer57356,LCon96188,LMin94893],["Sub25924","Bat10620","Res87269","Res91996","Dot15179","Con3097","Add70790","Dot46607","Res60097","PRe66307","Zer57356","Con96188","Min94893"],Min94893,"Min94893")

Actual (Unparsed): [[[0.0000000, 0.2266000, 0.2375000, 0.3913000, 0.4068255, 0.1147000, 0.1551000, -0.0101543, 0.2951000, 0.6901000, 0.8835000, 0.7168000], [0.5381371, 0.1470000, 0.6802200, 0.6953029, 0.1863000, 0.1561000, 0.5217000, 0.1762000, 0.6002000, 0.4278000, 0.8881000, 0.2066000]]]

Expected (Unparsed): [[[0,0.2266,0.2375,0.3913,0.40682545649310786,0.1147,0.1551,-0.010154297946613919,0.2951,0.6901,0.8835,0.7168],[0.53813706886763,0.147,0.680219952836622,0.6953028920692871,0.1863,0.1561,0.5217,0.1762,0.6002,0.4278,0.8881,0.2066]]]

Actual:   [[[0, 0.2266, 0.2375, 0.3913, 0.4069, 0.1147, 0.1551, -0.0101, 0.2951, 0.6901, 0.8835, 0.7168], [0.5382, 0.147, 0.6803, 0.6954, 0.1863, 0.1561, 0.5217, 0.1762, 0.6002, 0.4278, 0.8881, 0.2066]]]

Expected: [[[0, 0.2266, 0.2375, 0.3913, 0.4069, 0.1147, 0.1551, -0.0101, 0.2951, 0.6901, 0.8835, 0.7168], [0.5382, 0.147, 0.6803, 0.6954, 0.1863, 0.1561, 0.5217, 0.1762, 0.6002, 0.4278, 0.8881, 0.2066]]]