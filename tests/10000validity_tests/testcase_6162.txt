import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub38655 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub38655 = tf.keras.layers.Input(shape=([3, 2, 2]))

Sub38655 = keras.layers.Subtract(name = 'Sub38655', )([in0Sub38655,in1Sub38655])
Res5987 = keras.layers.Reshape((3, 4), name = 'Res5987', )(Sub38655)
Per1511 = keras.layers.Permute((1,2), name = 'Per1511',)(Res5987)
model = tf.keras.models.Model(inputs=[in0Sub38655,in1Sub38655], outputs=Per1511)
in0Sub38655 = tf.constant([[[[0.114, 0.6914], [0.6719, 0.1827]], [[0.4811, 0.2372], [0.5911, 0.5152]], [[0.7795, 0.4758], [0.7725, 0.3443]]]])
in1Sub38655 = tf.constant([[[[0.7752, 0.5311], [0.6797, 0.8362]], [[0.6489, 0.8396], [0.5665, 0.4014]], [[0.7719, 0.1382], [0.8862, 0.342]]]])
print (np.array2string(model.predict([in0Sub38655,in1Sub38655],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per1511.png')

LSub38655 = subtract_layer([[[[0.114, 0.6914], [0.6719, 0.1827]], [[0.4811, 0.2372], [0.5911, 0.5152]], [[0.7795, 0.4758], [0.7725, 0.3443]]]], [[[[0.7752, 0.5311], [0.6797, 0.8362]], [[0.6489, 0.8396], [0.5665, 0.4014]], [[0.7719, 0.1382], [0.8862, 0.342]]]], Sub38655), 
LRes5987 = reshape_layer(Sub38655, [3, 4], Res5987), 
LPer1511 = permute_layer(Res5987, 1,2, Per1511), 
exec_layers([LSub38655,LRes5987,LPer1511],["Sub38655","Res5987","Per1511"],Per1511,"Per1511")

Actual (Unparsed): [[[-0.6612000, 0.1603000, -0.0078000, -0.6535000], [-0.1678000, -0.6024000, 0.0246000, 0.1138000], [0.0076000, 0.3376000, -0.1137000, 0.0023000]]]

Expected (Unparsed): [[[-0.6612,0.1603,-0.007799999999999918,-0.6535000000000001],[-0.1678,-0.6024,0.024599999999999955,0.11380000000000001],[0.00759999999999994,0.3376,-0.11370000000000002,0.0022999999999999687]]]

Actual:   [[[-0.6612, 0.1603, -0.0078, -0.6535], [-0.1678, -0.6024, 0.0246, 0.1138], [0.0076, 0.3376, -0.1137, 0.0023]]]

Expected: [[[-0.6612, 0.1603, -0.0077, -0.6535], [-0.1678, -0.6024, 0.0246, 0.1139], [0.0076, 0.3376, -0.1137, 0.0023]]]