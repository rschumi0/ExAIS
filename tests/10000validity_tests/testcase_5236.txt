import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min7434 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Min7434 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Glo47983 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con9609 = tf.keras.layers.Input(shape=([7]))

Min7434 = keras.layers.Minimum(name = 'Min7434', )([in0Min7434,in1Min7434])
Fla64716 = keras.layers.Flatten(name = 'Fla64716', )(Min7434)
Glo47983 = keras.layers.GlobalAveragePooling2D(name = 'Glo47983', )(in0Glo47983)
Con9609 = keras.layers.Concatenate(axis=1, name = 'Con9609', )([Glo47983,in0Con9609])
Min1064 = keras.layers.Minimum(name = 'Min1064', )([Fla64716,Con9609])
Den4402 = keras.layers.Dense(1,name = 'Den4402', )(Min1064)
Res76355 = keras.layers.Reshape((1, 1), name = 'Res76355', )(Den4402)
Res14635 = keras.layers.Reshape((1, 1, 1), name = 'Res14635', )(Res76355)
Con45593 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con45593', )(Res14635)
model = tf.keras.models.Model(inputs=[in0Min7434,in1Min7434,in0Glo47983,in0Con9609], outputs=Con45593)
w = model.get_layer('Den4402').get_weights() 
w[0] = np.array([[0.6575], [0.5696], [0.7443], [0.4175], [0.6658], [0.8326], [0.1236], [0.6283]])
w[1] = np.array([0.255])
model.get_layer('Den4402').set_weights(w) 
w = model.get_layer('Con45593').get_weights() 
w[0] = np.array([[[[0.5496, 0.2466, 0.693, 0.2824]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con45593').set_weights(w) 
in0Min7434 = tf.constant([[[[0.767, 0.564], [0.3647, 0.0788]], [[0.3372, 0.9255], [0.341, 0.0269]]]])
in1Min7434 = tf.constant([[[[0.3948, 0.1233], [0.287, 0.7193]], [[0.6069, 0.2211], [0.5802, 0.0567]]]])
in0Glo47983 = tf.constant([[[[1.2608], [1.1642]], [[1.7262], [1.0348]]]])
in0Con9609 = tf.constant([[0.6026, 0.9691, 0.2629, 0.1257, 0.9641, 0.6635, 0.2113]])
print (np.array2string(model.predict([in0Min7434,in1Min7434,in0Glo47983,in0Con9609],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con45593.png')

LMin7434 = minimum_layer([[[[[0.767, 0.564], [0.3647, 0.0788]], [[0.3372, 0.9255], [0.341, 0.0269]]]], [[[[0.3948, 0.1233], [0.287, 0.7193]], [[0.6069, 0.2211], [0.5802, 0.0567]]]]], Min7434), 
LFla64716 = flatten_layer(Min7434, Fla64716), 
LGlo47983 = global_average_pooling2D_layer([[[[1.2608], [1.1642]], [[1.7262], [1.0348]]]], Glo47983), 
LCon9609 = concatenate_layer([Glo47983,[[0.6026, 0.9691, 0.2629, 0.1257, 0.9641, 0.6635, 0.2113]]], 1, Con9609), 
LMin1064 = minimum_layer([Fla64716,Con9609], Min1064), 
LDen4402 = dense_layer(Min1064, [[0.6575], [0.5696], [0.7443], [0.4175], [0.6658], [0.8326], [0.1236], [0.6283]],[0.255], Den4402), 
LRes76355 = reshape_layer(Den4402, [1, 1], Res76355), 
LRes14635 = reshape_layer(Res76355, [1, 1, 1], Res14635), 
LCon45593 = conv2D_layer(Res14635, 1, 1,[[[[0.5496, 0.2466, 0.693, 0.2824]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con45593), 
exec_layers([LMin7434,LFla64716,LGlo47983,LCon9609,LMin1064,LDen4402,LRes76355,LRes14635,LCon45593],["Min7434","Fla64716","Glo47983","Con9609","Min1064","Den4402","Res76355","Res14635","Con45593"],Con45593,"Con45593")

Actual (Unparsed): [[[[0.6365212, 0.2856007, 0.8026004, 0.3270626]]]]

Expected (Unparsed): [[[[0.636521202072,0.28560067036200004,0.80260042401,0.327062568168]]]]

Actual:   [[[[0.6366, 0.2857, 0.8027, 0.3271]]]]

Expected: [[[[0.6366, 0.2857, 0.8027, 0.3271]]]]