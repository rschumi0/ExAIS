import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max1343 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max1343 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0PRe59517 = tf.keras.layers.Input(shape=([2, 2]))
in0Con14734 = tf.keras.layers.Input(shape=([3, 1]))

Max1343 = keras.layers.Maximum(name = 'Max1343', )([in0Max1343,in1Max1343])
Res26673 = keras.layers.Reshape((1, 1), name = 'Res26673', )(Max1343)
Ave7253 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave7253', )(Res26673)
Res49882 = keras.layers.Reshape((1, 1, 1), name = 'Res49882', )(Ave7253)
Zer17356 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer17356', )(Res49882)
Res29386 = keras.layers.Reshape((3, 3), name = 'Res29386', )(Zer17356)
PRe59517 = keras.layers.PReLU(name = 'PRe59517', input_shape=(2, 2))(in0PRe59517)
Zer19706 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer19706', )(PRe59517)
Con14734 = keras.layers.Concatenate(axis=2, name = 'Con14734', )([Zer19706,in0Con14734])
Sub42444 = keras.layers.Subtract(name = 'Sub42444', )([Res29386,Con14734])
model = tf.keras.models.Model(inputs=[in0Max1343,in1Max1343,in0PRe59517,in0Con14734], outputs=Sub42444)
w = model.get_layer('PRe59517').get_weights() 
w[0] = np.array([[0.2115, 0.1239], [0.9408, 0.6499]])
model.get_layer('PRe59517').set_weights(w) 
in0Max1343 = tf.constant([[[[0.2253]]]])
in1Max1343 = tf.constant([[[[0.5996]]]])
in0PRe59517 = tf.constant([[[0.0917, 0.1601], [0.9081, 0.1096]]])
in0Con14734 = tf.constant([[[0.2502], [0.7285], [0.2547]]])
print (np.array2string(model.predict([in0Max1343,in1Max1343,in0PRe59517,in0Con14734],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub42444.png')

LMax1343 = maximum_layer([[[[[0.2253]]]], [[[[0.5996]]]]], Max1343), 
LRes26673 = reshape_layer(Max1343, [1, 1], Res26673), 
LAve7253 = average_pooling1D_layer(Res26673, 1, Ave7253), 
LRes49882 = reshape_layer(Ave7253, [1, 1, 1], Res49882), 
LZer17356 = zero_padding2D_layer(Res49882, 1, 1, 1, 1, Zer17356), 
LRes29386 = reshape_layer(Zer17356, [3, 3], Res29386), 
LPRe59517 = prelu_layer([[[0.0917, 0.1601], [0.9081, 0.1096]]], [[0.2115, 0.1239], [0.9408, 0.6499]], PRe59517), 
LZer19706 = zero_padding1D_layer(PRe59517, 1, 0, Zer19706), 
LCon14734 = concatenate_layer([Zer19706,[[[0.2502], [0.7285], [0.2547]]]], 2, Con14734), 
LSub42444 = subtract_layer(Res29386,Con14734, Sub42444), 
exec_layers([LMax1343,LRes26673,LAve7253,LRes49882,LZer17356,LRes29386,LPRe59517,LZer19706,LCon14734,LSub42444],["Max1343","Res26673","Ave7253","Res49882","Zer17356","Res29386","PRe59517","Zer19706","Con14734","Sub42444"],Sub42444,"Sub42444")

Actual (Unparsed): [[[0.0000000, 0.0000000, -0.2502000], [-0.0917000, 0.4395000, -0.7285000], [-0.9081000, -0.1096000, -0.2547000]]]

Expected (Unparsed): [[[0,0,-0.2502],[-0.0917,0.4395,-0.7285],[-0.9081,-0.1096,-0.2547]]]

Actual:   [[[0, 0, -0.2502], [-0.0917, 0.4395, -0.7285], [-0.9081, -0.1096, -0.2547]]]

Expected: [[[0, 0, -0.2502], [-0.0917, 0.4395, -0.7285], [-0.9081, -0.1096, -0.2547]]]