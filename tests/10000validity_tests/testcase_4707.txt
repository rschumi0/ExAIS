import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave35538 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave35538 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con88473 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul84127 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul84127 = tf.keras.layers.Input(shape=([1, 2]))

Ave35538 = keras.layers.Average(name = 'Ave35538', )([in0Ave35538,in1Ave35538])
Res32448 = keras.layers.Reshape((2, 1), name = 'Res32448', )(Ave35538)
Con88473 = keras.layers.Concatenate(axis=2, name = 'Con88473', )([Res32448,in0Con88473])
Mul84127 = keras.layers.Multiply(name = 'Mul84127', )([in0Mul84127,in1Mul84127])
Zer93297 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer93297', )(Mul84127)
Mul29818 = keras.layers.Multiply(name = 'Mul29818', )([Con88473,Zer93297])
Res3892 = keras.layers.Reshape((2, 2, 1), name = 'Res3892', )(Mul29818)
Max75788 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(1, 1), padding='same', name = 'Max75788', )(Res3892)
model = tf.keras.models.Model(inputs=[in0Ave35538,in1Ave35538,in0Con88473,in0Mul84127,in1Mul84127], outputs=Max75788)
in0Ave35538 = tf.constant([[[[0.6545]], [[0.3783]]]])
in1Ave35538 = tf.constant([[[[0.6502]], [[0.3866]]]])
in0Con88473 = tf.constant([[[0.4076], [0.5511]]])
in0Mul84127 = tf.constant([[[0.1475, 0.0645]]])
in1Mul84127 = tf.constant([[[0.9186, 0.4549]]])
print (np.array2string(model.predict([in0Ave35538,in1Ave35538,in0Con88473,in0Mul84127,in1Mul84127],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max75788.png')

LAve35538 = average_layer([[[[[0.6545]], [[0.3783]]]], [[[[0.6502]], [[0.3866]]]]], Ave35538), 
LRes32448 = reshape_layer(Ave35538, [2, 1], Res32448), 
LCon88473 = concatenate_layer([Res32448,[[[0.4076], [0.5511]]]], 2, Con88473), 
LMul84127 = multiply_layer([[[[0.1475, 0.0645]]], [[[0.9186, 0.4549]]]], Mul84127), 
LZer93297 = zero_padding1D_layer(Mul84127, 1, 0, Zer93297), 
LMul29818 = multiply_layer([Con88473,Zer93297], Mul29818), 
LRes3892 = reshape_layer(Mul29818, [2, 2, 1], Res3892), 
LMax75788 = max_pool2D_layer(Res3892, 2, 1, 1, 1, true, Max75788), 
exec_layers([LAve35538,LRes32448,LCon88473,LMul84127,LZer93297,LMul29818,LRes3892,LMax75788],["Ave35538","Res32448","Con88473","Mul84127","Zer93297","Mul29818","Res3892","Max75788"],Max75788,"Max75788")

Actual (Unparsed): [[[[0.0518195], [0.0161699]], [[0.0518195], [0.0161699]]]]

Expected (Unparsed): [[[[0.051819489074999996],[0.016169852655000004]],[[0.051819489074999996],[0.016169852655000004]]]]

Actual:   [[[[0.0519], [0.0162]], [[0.0519], [0.0162]]]]

Expected: [[[[0.0519], [0.0162]], [[0.0519], [0.0162]]]]