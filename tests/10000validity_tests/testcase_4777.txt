import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof49428 = tf.keras.layers.Input(shape=([2, 2]))
in0Min32319 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min32319 = tf.keras.layers.Input(shape=([1, 2, 1]))

Sof49428 = keras.layers.Softmax(axis=1, name = 'Sof49428', input_shape=(2, 2))(in0Sof49428)
Res39580 = keras.layers.Reshape((2, 2, 1), name = 'Res39580', )(Sof49428)
Min32319 = keras.layers.Minimum(name = 'Min32319', )([in0Min32319,in1Min32319])
Zer54064 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer54064', )(Min32319)
Ave79293 = keras.layers.Average(name = 'Ave79293', )([Res39580,Zer54064])
ELU72018 = keras.layers.ELU(alpha=1.2589651384100122, name = 'ELU72018', )(Ave79293)
model = tf.keras.models.Model(inputs=[in0Sof49428,in0Min32319,in1Min32319], outputs=ELU72018)
in0Sof49428 = tf.constant([[[0.636, 0.4014], [0.7031, 0.1329]]])
in0Min32319 = tf.constant([[[[0.8618], [0.1818]]]])
in1Min32319 = tf.constant([[[[0.7941], [0.2132]]]])
print (np.array2string(model.predict([in0Sof49428,in0Min32319,in1Min32319],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU72018.png')

LSof49428 = softmax_layer([[[0.636, 0.4014], [0.7031, 0.1329]]], 1, Sof49428), 
LRes39580 = reshape_layer(Sof49428, [2, 2, 1], Res39580), 
LMin32319 = minimum_layer([[[[[0.8618], [0.1818]]]], [[[[0.7941], [0.2132]]]]], Min32319), 
LZer54064 = zero_padding2D_layer(Min32319, 1, 0, 0, 0, Zer54064), 
LAve79293 = average_layer([Res39580,Zer54064], Ave79293), 
LELU72018 = elu_layer(Ave79293, 1.2589651384100122, ELU72018), 
exec_layers([LSof49428,LRes39580,LMin32319,LZer54064,LAve79293,LELU72018],["Sof49428","Res39580","Min32319","Zer54064","Ave79293","ELU72018"],ELU72018,"ELU72018")

Actual (Unparsed): [[[[0.2416156], [0.2833623]], [[0.6554344], [0.3075377]]]]

Expected (Unparsed): [[[[0.24161564558072776],[0.2833623100787032]],[[0.6554343544192722],[0.3075376899212968]]]]

Actual:   [[[[0.2417], [0.2834]], [[0.6555], [0.3076]]]]

Expected: [[[[0.2417], [0.2834]], [[0.6555], [0.3076]]]]