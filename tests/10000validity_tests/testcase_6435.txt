import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max12224 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max12224 = tf.keras.layers.Input(shape=([1, 1, 2]))

Max12224 = keras.layers.Maximum(name = 'Max12224', )([in0Max12224,in1Max12224])
Res17717 = keras.layers.Reshape((1, 2), name = 'Res17717', )(Max12224)
Res61075 = keras.layers.Reshape((1, 2, 1), name = 'Res61075', )(Res17717)
PRe98867 = keras.layers.PReLU(name = 'PRe98867', )(Res61075)
model = tf.keras.models.Model(inputs=[in0Max12224,in1Max12224], outputs=PRe98867)
w = model.get_layer('PRe98867').get_weights() 
w[0] = np.array([[[0.7023], [0.0328]]])
model.get_layer('PRe98867').set_weights(w) 
in0Max12224 = tf.constant([[[[0.1954, 0.7947]]]])
in1Max12224 = tf.constant([[[[0.2416, 0.1905]]]])
print (np.array2string(model.predict([in0Max12224,in1Max12224],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe98867.png')

LMax12224 = maximum_layer([[[[[0.1954, 0.7947]]]], [[[[0.2416, 0.1905]]]]], Max12224), 
LRes17717 = reshape_layer(Max12224, [1, 2], Res17717), 
LRes61075 = reshape_layer(Res17717, [1, 2, 1], Res61075), 
LPRe98867 = prelu_layer(Res61075, [[[0.7023], [0.0328]]], PRe98867), 
exec_layers([LMax12224,LRes17717,LRes61075,LPRe98867],["Max12224","Res17717","Res61075","PRe98867"],PRe98867,"PRe98867")

Actual (Unparsed): [[[[0.2416000], [0.7947000]]]]

Expected (Unparsed): [[[[0.2416],[0.7947]]]]

Actual:   [[[[0.2416], [0.7947]]]]

Expected: [[[[0.2416], [0.7947]]]]