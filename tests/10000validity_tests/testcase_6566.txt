import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dep13488 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Add75605 = tf.keras.layers.Input(shape=([2, 2]))
in1Add75605 = tf.keras.layers.Input(shape=([2, 2]))
in0Con45019 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Dep52626 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Dot40725 = tf.keras.layers.Input(shape=([2]))
in1Dot40725 = tf.keras.layers.Input(shape=([2]))
in0Con28667 = tf.keras.layers.Input(shape=([7]))

Dep13488 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep13488', )(in0Dep13488)
Zer45049 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer45049', )(Dep13488)
Add75605 = keras.layers.Add(name = 'Add75605', )([in0Add75605,in1Add75605])
Res6855 = keras.layers.Reshape((2, 2, 1), name = 'Res6855', )(Add75605)
Con45019 = keras.layers.Concatenate(axis=3, name = 'Con45019', )([Res6855,in0Con45019])
Dep52626 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep52626', )(in0Dep52626)
Zer31598 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer31598', )(Dep52626)
Max16189 = keras.layers.Maximum(name = 'Max16189', )([Con45019,Zer31598])
Add95498 = keras.layers.Add(name = 'Add95498', )([Zer45049,Max16189])
Res92130 = keras.layers.Reshape((2, 4), name = 'Res92130', )(Add95498)
Fla63370 = keras.layers.Flatten(name = 'Fla63370', )(Res92130)
Dot40725 = keras.layers.Dot(axes=(1, 1), name = 'Dot40725', )([in0Dot40725,in1Dot40725])
Con28667 = keras.layers.Concatenate(axis=1, name = 'Con28667', )([Dot40725,in0Con28667])
Ave18691 = keras.layers.Average(name = 'Ave18691', )([Fla63370,Con28667])
model = tf.keras.models.Model(inputs=[in0Dep13488,in0Add75605,in1Add75605,in0Con45019,in0Dep52626,in0Dot40725,in1Dot40725,in0Con28667], outputs=Ave18691)
w = model.get_layer('Dep13488').get_weights() 
w[0] = np.array([[[[0.2218], [0.6676]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep13488').set_weights(w) 
w = model.get_layer('Dep52626').get_weights() 
w[0] = np.array([[[[0.5372], [0.2211]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep52626').set_weights(w) 
in0Dep13488 = tf.constant([[[[0.5032, 0.7611], [0.164, 0.5512]]]])
in0Add75605 = tf.constant([[[0.0505, 0.3711], [0.428, 0.552]]])
in1Add75605 = tf.constant([[[0.6528, 0.9796], [0.7561, 0.1353]]])
in0Con45019 = tf.constant([[[[0.6822], [0.6917]], [[0.3333], [0.764]]]])
in0Dep52626 = tf.constant([[[[0.0734, 0.1438]]]])
in0Dot40725 = tf.constant([[0.3636, 0.96]])
in1Dot40725 = tf.constant([[0.2456, 0.2714]])
in0Con28667 = tf.constant([[0.567, 0.9225, 0.4213, 0.5793, 0.8079, 0.3953, 0.7751]])
print (np.array2string(model.predict([in0Dep13488,in0Add75605,in1Add75605,in0Con45019,in0Dep52626,in0Dot40725,in1Dot40725,in0Con28667],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave18691.png')

LDep13488 = depthwise_conv2D_layer([[[[0.5032, 0.7611], [0.164, 0.5512]]]], 1, 1,[[[[0.2218], [0.6676]]]],[0, 0], 1, 1, true, Dep13488), 
LZer45049 = zero_padding2D_layer(Dep13488, 1, 0, 0, 0, Zer45049), 
LAdd75605 = add_layer([[[[0.0505, 0.3711], [0.428, 0.552]]], [[[0.6528, 0.9796], [0.7561, 0.1353]]]], Add75605), 
LRes6855 = reshape_layer(Add75605, [2, 2, 1], Res6855), 
LCon45019 = concatenate_layer([Res6855,[[[[0.6822], [0.6917]], [[0.3333], [0.764]]]]], 3, Con45019), 
LDep52626 = depthwise_conv2D_layer([[[[0.0734, 0.1438]]]], 1, 1,[[[[0.5372], [0.2211]]]],[0, 0], 1, 1, true, Dep52626), 
LZer31598 = zero_padding2D_layer(Dep52626, 1, 0, 1, 0, Zer31598), 
LMax16189 = maximum_layer([Con45019,Zer31598], Max16189), 
LAdd95498 = add_layer([Zer45049,Max16189], Add95498), 
LRes92130 = reshape_layer(Add95498, [2, 4], Res92130), 
LFla63370 = flatten_layer(Res92130, Fla63370), 
LDot40725 = dot_layer([[0.3636, 0.96]], [[0.2456, 0.2714]], 1, 1, Dot40725), 
LCon28667 = concatenate_layer([Dot40725,[[0.567, 0.9225, 0.4213, 0.5793, 0.8079, 0.3953, 0.7751]]], 1, Con28667), 
LAve18691 = average_layer([Fla63370,Con28667], Ave18691), 
exec_layers([LDep13488,LZer45049,LAdd75605,LRes6855,LCon45019,LDep52626,LZer31598,LMax16189,LAdd95498,LRes92130,LFla63370,LDot40725,LCon28667,LAve18691],["Dep13488","Zer45049","Add75605","Res6855","Con45019","Dep52626","Zer31598","Max16189","Add95498","Res92130","Fla63370","Dot40725","Con28667","Ave18691"],Ave18691,"Ave18691")

Actual (Unparsed): [[0.5265721, 0.6246000, 1.1366000, 0.5565000, 0.9375049, 0.8246552, 0.5594876, 0.9535405]]

Expected (Unparsed): [[0.52657208,0.6246,1.1366,0.5565,0.9375048799999999,0.8246551799999999,0.5594876,0.95354056]]

Actual:   [[0.5266, 0.6246, 1.1366, 0.5565, 0.9376, 0.8247, 0.5595, 0.9536]]

Expected: [[0.5266, 0.6246, 1.1366, 0.5565, 0.9376, 0.8247, 0.5595, 0.9536]]