import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den48882 = tf.keras.layers.Input(shape=([5, 2]))
in0Con24272 = tf.keras.layers.Input(shape=([5, 2, 3]))
in0Sep668 = tf.keras.layers.Input(shape=([1, 1, 1]))

Den48882 = keras.layers.Dense(2,name = 'Den48882', )(in0Den48882)
Res55190 = keras.layers.Reshape((5, 2, 1), name = 'Res55190', )(Den48882)
Con24272 = keras.layers.Concatenate(axis=3, name = 'Con24272', )([Res55190,in0Con24272])
Sep668 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='same', name = 'Sep668', )(in0Sep668)
Zer57802 = keras.layers.ZeroPadding2D(padding=((4, 0), (1, 0)), name = 'Zer57802', )(Sep668)
Ave13845 = keras.layers.Average(name = 'Ave13845', )([Con24272,Zer57802])
Sep4365 = keras.layers.SeparableConv2D(4, (3, 1),strides=(1, 1), padding='same', name = 'Sep4365', )(Ave13845)
Res54273 = keras.layers.Reshape((5, 8), name = 'Res54273', )(Sep4365)
Glo14011 = keras.layers.GlobalMaxPool1D(name = 'Glo14011', )(Res54273)
model = tf.keras.models.Model(inputs=[in0Den48882,in0Con24272,in0Sep668], outputs=Glo14011)
w = model.get_layer('Den48882').get_weights() 
w[0] = np.array([[0.6735, 0.0828], [0.2546, 0.7013]])
w[1] = np.array([0.9693, 0.6286])
model.get_layer('Den48882').set_weights(w) 
w = model.get_layer('Sep668').get_weights() 
w[0] = np.array([[[[0.0813]]]])
w[1] = np.array([[[[0.1454, 0.5351, 0.3551, 0.642]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep668').set_weights(w) 
w = model.get_layer('Sep4365').get_weights() 
w[0] = np.array([[[[0.2524], [0.2098], [0.1884], [0.8927]]], [[[0.0138], [0.1263], [0.3614], [0.3319]]], [[[0.7062], [0.4431], [0.0185], [0.9321]]]])
w[1] = np.array([[[[0.0649, 0.3646, 0.7223, 0.7295], [0.3163, 0.8595, 0.8108, 0.8616], [0.6654, 0.4952, 0.4238, 0.3025], [0.75, 0.3111, 0.2312, 0.5931]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep4365').set_weights(w) 
in0Den48882 = tf.constant([[[0.6947, 0.7085], [0.1118, 0.496], [0.3429, 0.2979], [0.6986, 0.7887], [0.4215, 0.168]]])
in0Con24272 = tf.constant([[[[0.2478, 0.2392, 0.9552], [0.3654, 0.5146, 0.1891]], [[0.3938, 0.8371, 0.7096], [0.0107, 0.302, 0.6042]], [[0.0151, 0.9576, 0.2303], [0.9483, 0.259, 0.7031]], [[0.9195, 0.758, 0.1365], [0.0645, 0.2238, 0.8913]], [[0.3223, 0.7387, 0.3067], [0.2053, 0.0541, 0.9398]]]])
in0Sep668 = tf.constant([[[[0.1626]]]])
print (np.array2string(model.predict([in0Den48882,in0Con24272,in0Sep668],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo14011.png')

LDen48882 = dense_layer([[[0.6947, 0.7085], [0.1118, 0.496], [0.3429, 0.2979], [0.6986, 0.7887], [0.4215, 0.168]]], [[0.6735, 0.0828], [0.2546, 0.7013]],[0.9693, 0.6286], Den48882), 
LRes55190 = reshape_layer(Den48882, [5, 2, 1], Res55190), 
LCon24272 = concatenate_layer([Res55190,[[[[0.2478, 0.2392, 0.9552], [0.3654, 0.5146, 0.1891]], [[0.3938, 0.8371, 0.7096], [0.0107, 0.302, 0.6042]], [[0.0151, 0.9576, 0.2303], [0.9483, 0.259, 0.7031]], [[0.9195, 0.758, 0.1365], [0.0645, 0.2238, 0.8913]], [[0.3223, 0.7387, 0.3067], [0.2053, 0.0541, 0.9398]]]]], 3, Con24272), 
LSep668 = separable_conv2D_layer([[[[0.1626]]]], 1, 1,[[[[[0.0813]]]],[[[[0.1454, 0.5351, 0.3551, 0.642]]]]],[0, 0, 0, 0], 1, 1, true, Sep668), 
LZer57802 = zero_padding2D_layer(Sep668, 4, 0, 1, 0, Zer57802), 
LAve13845 = average_layer([Con24272,Zer57802], Ave13845), 
LSep4365 = separable_conv2D_layer(Ave13845, 3, 1,[[[[[0.2524], [0.2098], [0.1884], [0.8927]]], [[[0.0138], [0.1263], [0.3614], [0.3319]]], [[[0.7062], [0.4431], [0.0185], [0.9321]]]],[[[[0.0649, 0.3646, 0.7223, 0.7295], [0.3163, 0.8595, 0.8108, 0.8616], [0.6654, 0.4952, 0.4238, 0.3025], [0.75, 0.3111, 0.2312, 0.5931]]]]],[0, 0, 0, 0], 1, 1, true, Sep4365), 
LRes54273 = reshape_layer(Sep4365, [5, 8], Res54273), 
LGlo14011 = global_max_pool1D_layer(Res54273, Glo14011), 
exec_layers([LDen48882,LRes55190,LCon24272,LSep668,LZer57802,LAve13845,LSep4365,LRes54273,LGlo14011],["Den48882","Res55190","Con24272","Sep668","Zer57802","Ave13845","Sep4365","Res54273","Glo14011"],Glo14011,"Glo14011")

Actual (Unparsed): [[0.6702824, 0.7381413, 0.9374535, 1.0753207, 0.7945034, 0.5941005, 0.6987066, 0.9781851]]

Expected (Unparsed): [[0.6702823670253911,0.7381412723690918,0.9374535337903658,1.0753207005195236,0.7945034163356555,0.5941004891864723,0.6987066147950162,0.9781850767630361]]

Actual:   [[0.6703, 0.7382, 0.9375, 1.0754, 0.7946, 0.5942, 0.6988, 0.9782]]

Expected: [[0.6703, 0.7382, 0.9375, 1.0754, 0.7946, 0.5942, 0.6988, 0.9782]]