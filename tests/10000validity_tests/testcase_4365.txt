import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot69970 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot69970 = tf.keras.layers.Input(shape=([3, 2]))
in0Con93617 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Cro84905 = tf.keras.layers.Input(shape=([2, 2, 1, 3]))

Dot69970 = keras.layers.Dot(axes=(1, 1), name = 'Dot69970', )([in0Dot69970,in1Dot69970])
Ave88178 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave88178', )(Dot69970)
Res20687 = keras.layers.Reshape((2, 2, 1), name = 'Res20687', )(Ave88178)
Glo65300 = keras.layers.GlobalAveragePooling2D(name = 'Glo65300', )(Res20687)
Res32461 = keras.layers.Reshape((1, 1), name = 'Res32461', )(Glo65300)
Res42042 = keras.layers.Reshape((1, 1, 1), name = 'Res42042', )(Res32461)
Res11511 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res11511', )(Res42042)
Con93617 = keras.layers.Concatenate(axis=4, name = 'Con93617', )([Res11511,in0Con93617])
Cro84905 = keras.layers.Cropping3D(cropping=((1, 0), (1, 0), (0, 0)), name = 'Cro84905', )(in0Cro84905)
Sub86838 = keras.layers.Subtract(name = 'Sub86838', )([Con93617,Cro84905])
model = tf.keras.models.Model(inputs=[in0Dot69970,in1Dot69970,in0Con93617,in0Cro84905], outputs=Sub86838)
in0Dot69970 = tf.constant([[[0.5454, 0.0975], [0.3267, 0.9049], [0.8261, 0.0426]]])
in1Dot69970 = tf.constant([[[0.3372, 0.3427], [0.2482, 0.7158], [0.3355, 0.6556]]])
in0Con93617 = tf.constant([[[[[0.8721, 0.2914]]]]])
in0Cro84905 = tf.constant([[[[[1.5295, 1.1681, 1.7901]], [[1.5115, 1.0166, 1.505]]], [[[1.7264, 1.4035, 1.7245]], [[1.0411, 1.5046, 1.0559]]]]])
print (np.array2string(model.predict([in0Dot69970,in1Dot69970,in0Con93617,in0Cro84905],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub86838.png')

LDot69970 = dot_layer([[[0.5454, 0.0975], [0.3267, 0.9049], [0.8261, 0.0426]]], [[[0.3372, 0.3427], [0.2482, 0.7158], [0.3355, 0.6556]]], 1, 1, Dot69970), 
LAve88178 = average_pooling1D_layer(Dot69970, 1, Ave88178), 
LRes20687 = reshape_layer(Ave88178, [2, 2, 1], Res20687), 
LGlo65300 = global_average_pooling2D_layer(Res20687, Glo65300), 
LRes32461 = reshape_layer(Glo65300, [1, 1], Res32461), 
LRes42042 = reshape_layer(Res32461, [1, 1, 1], Res42042), 
LRes11511 = reshape_layer(Res42042, [1, 1, 1, 1], Res11511), 
LCon93617 = concatenate_layer([Res11511,[[[[[0.8721, 0.2914]]]]]], 4, Con93617), 
LCro84905 = cropping3D_layer([[[[[1.5295, 1.1681, 1.7901]], [[1.5115, 1.0166, 1.505]]], [[[1.7264, 1.4035, 1.7245]], [[1.0411, 1.5046, 1.0559]]]]], 1, 0, 1, 0, 0, 0, Cro84905), 
LSub86838 = subtract_layer(Con93617,Cro84905, Sub86838), 
exec_layers([LDot69970,LAve88178,LRes20687,LGlo65300,LRes32461,LRes42042,LRes11511,LCon93617,LCro84905,LSub86838],["Dot69970","Ave88178","Res20687","Glo65300","Res32461","Res42042","Res11511","Con93617","Cro84905","Sub86838"],Sub86838,"Sub86838")

Actual (Unparsed): [[[[[-0.4197654, -0.6325001, -0.7645000]]]]]

Expected (Unparsed): [[[[[-0.41976532999999994,-0.6325,-0.7645000000000001]]]]]

Actual:   [[[[[-0.4197, -0.6325, -0.7645]]]]]

Expected: [[[[[-0.4197, -0.6325, -0.7645]]]]]