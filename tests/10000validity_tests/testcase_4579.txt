import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer51283 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot29918 = tf.keras.layers.Input(shape=([2]))
in1Dot29918 = tf.keras.layers.Input(shape=([2]))
in0Con89304 = tf.keras.layers.Input(shape=([2]))
in0Con83564 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Sub99811 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub99811 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Con29107 = tf.keras.layers.Input(shape=([3]))

Zer51283 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer51283', )(in0Zer51283)
Fla82747 = keras.layers.Flatten(name = 'Fla82747', )(Zer51283)
Dot29918 = keras.layers.Dot(axes=(1, 1), name = 'Dot29918', )([in0Dot29918,in1Dot29918])
Con89304 = keras.layers.Concatenate(axis=1, name = 'Con89304', )([Dot29918,in0Con89304])
Sub50379 = keras.layers.Subtract(name = 'Sub50379', )([Fla82747,Con89304])
Res20484 = keras.layers.Reshape((3, 1), name = 'Res20484', )(Sub50379)
Con83564 = keras.layers.Conv3D(2, (2, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con83564', )(in0Con83564)
Res6322 = keras.layers.Reshape((1, 1, 4), name = 'Res6322', )(Con83564)
Res32347 = keras.layers.Reshape((1, 4), name = 'Res32347', )(Res6322)
Zer42059 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer42059', )(Res32347)
Dot36501 = keras.layers.Dot(axes=(1, 1), name = 'Dot36501', )([Res20484,Zer42059])
Fla66446 = keras.layers.Flatten(name = 'Fla66446', )(Dot36501)
Sub99811 = keras.layers.Subtract(name = 'Sub99811', )([in0Sub99811,in1Sub99811])
Res79746 = keras.layers.Reshape((3, 3, 3, 1), name = 'Res79746', )(Sub99811)
Glo28432 = keras.layers.GlobalMaxPool3D(name = 'Glo28432', )(Res79746)
Con29107 = keras.layers.Concatenate(axis=1, name = 'Con29107', )([Glo28432,in0Con29107])
Min77909 = keras.layers.Minimum(name = 'Min77909', )([Fla66446,Con29107])
model = tf.keras.models.Model(inputs=[in0Zer51283,in0Dot29918,in1Dot29918,in0Con89304,in0Con83564,in0Sub99811,in1Sub99811,in0Con29107], outputs=Min77909)
w = model.get_layer('Con83564').get_weights() 
w[0] = np.array([[[[[0.0801, 0.6891], [0.7322, 0.4183]]]], [[[[0.0922, 0.0873], [0.6441, 0.8574]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con83564').set_weights(w) 
in0Zer51283 = tf.constant([[[1.7493]]])
in0Dot29918 = tf.constant([[0.5985, 0.7122]])
in1Dot29918 = tf.constant([[0.4117, 0.1725]])
in0Con89304 = tf.constant([[0.5577, 0.165]])
in0Con83564 = tf.constant([[[[[0.0028, 0.7236], [0.0492, 0.5404]]], [[[0.3675, 0.5602], [0.5425, 0.4159]]]]])
in0Sub99811 = tf.constant([[[[0.3522, 0.7516, 0.3034], [0.7166, 0.9009, 0.7009], [0.4467, 0.5275, 0.1717]], [[0.1271, 0.9984, 0.2365], [0.7224, 0.4535, 0.569], [0.3713, 0.9636, 0.8498]], [[0.6651, 0.3728, 0.7262], [0.0149, 0.7926, 0.6848], [0.1593, 0.9418, 0.5139]]]])
in1Sub99811 = tf.constant([[[[0.9614, 0.0748, 0.8458], [0.6604, 0.8979, 0.2824], [0.1562, 0.9724, 0.1755]], [[0.4255, 0.9746, 0.5439], [0.2777, 0.3171, 0.6815], [0.5791, 0.4853, 0.8016]], [[0.4406, 0.1375, 0.1811], [0.7243, 0.1916, 0.7358], [0.7138, 0.6754, 0.3499]]]])
in0Con29107 = tf.constant([[0.1631, 0.0597, 0.072]])
print (np.array2string(model.predict([in0Zer51283,in0Dot29918,in1Dot29918,in0Con89304,in0Con83564,in0Sub99811,in1Sub99811,in0Con29107],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min77909.png')

LZer51283 = zero_padding1D_layer([[[1.7493]]], 1, 1, Zer51283), 
LFla82747 = flatten_layer(Zer51283, Fla82747), 
LDot29918 = dot_layer([[0.5985, 0.7122]], [[0.4117, 0.1725]], 1, 1, Dot29918), 
LCon89304 = concatenate_layer([Dot29918,[[0.5577, 0.165]]], 1, Con89304), 
LSub50379 = subtract_layer(Fla82747,Con89304, Sub50379), 
LRes20484 = reshape_layer(Sub50379, [3, 1], Res20484), 
LCon83564 = conv3D_layer([[[[[0.0028, 0.7236], [0.0492, 0.5404]]], [[[0.3675, 0.5602], [0.5425, 0.4159]]]]], 2, 1, 1,[[[[[0.0801, 0.6891], [0.7322, 0.4183]]]], [[[[0.0922, 0.0873], [0.6441, 0.8574]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con83564), 
LRes6322 = reshape_layer(Con83564, [1, 1, 4], Res6322), 
LRes32347 = reshape_layer(Res6322, [1, 4], Res32347), 
LZer42059 = zero_padding1D_layer(Res32347, 1, 1, Zer42059), 
LDot36501 = dot_layer(Res20484,Zer42059, 1, 1, Dot36501), 
LFla66446 = flatten_layer(Dot36501, Fla66446), 
LSub99811 = subtract_layer([[[[0.3522, 0.7516, 0.3034], [0.7166, 0.9009, 0.7009], [0.4467, 0.5275, 0.1717]], [[0.1271, 0.9984, 0.2365], [0.7224, 0.4535, 0.569], [0.3713, 0.9636, 0.8498]], [[0.6651, 0.3728, 0.7262], [0.0149, 0.7926, 0.6848], [0.1593, 0.9418, 0.5139]]]], [[[[0.9614, 0.0748, 0.8458], [0.6604, 0.8979, 0.2824], [0.1562, 0.9724, 0.1755]], [[0.4255, 0.9746, 0.5439], [0.2777, 0.3171, 0.6815], [0.5791, 0.4853, 0.8016]], [[0.4406, 0.1375, 0.1811], [0.7243, 0.1916, 0.7358], [0.7138, 0.6754, 0.3499]]]], Sub99811), 
LRes79746 = reshape_layer(Sub99811, [3, 3, 3, 1], Res79746), 
LGlo28432 = global_max_pool3D_layer(Res79746, Glo28432), 
LCon29107 = concatenate_layer([Glo28432,[[0.1631, 0.0597, 0.072]]], 1, Con29107), 
LMin77909 = minimum_layer([Fla66446,Con29107], Min77909), 
exec_layers([LZer51283,LFla82747,LDot29918,LCon89304,LSub50379,LRes20484,LCon83564,LRes6322,LRes32347,LZer42059,LDot36501,LFla66446,LSub99811,LRes79746,LGlo28432,LCon29107,LMin77909],["Zer51283","Fla82747","Dot29918","Con89304","Sub50379","Res20484","Con83564","Res6322","Res32347","Zer42059","Dot36501","Fla66446","Sub99811","Res79746","Glo28432","Con29107","Min77909"],Min77909,"Min77909")

Actual (Unparsed): [[0.6768000, 0.1631000, 0.0597000, 0.0720000]]

Expected (Unparsed): [[0.6768000000000001,0.1631,0.0597,0.072]]

Actual:   [[0.6768, 0.1631, 0.0597, 0.072]]

Expected: [[0.6769, 0.1631, 0.0597, 0.072]]