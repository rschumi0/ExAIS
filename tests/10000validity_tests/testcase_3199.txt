import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min18906 = tf.keras.layers.Input(shape=([1, 2]))
in1Min18906 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul29293 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul29293 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Max38646 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con31112 = tf.keras.layers.Input(shape=([1, 1]))

Min18906 = keras.layers.Minimum(name = 'Min18906', )([in0Min18906,in1Min18906])
Mul29293 = keras.layers.Multiply(name = 'Mul29293', )([in0Mul29293,in1Mul29293])
Res39770 = keras.layers.Reshape((2, 1), name = 'Res39770', )(Mul29293)
GRU29024 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU29024', )(Res39770)
Res65852 = keras.layers.Reshape((1, 1), name = 'Res65852', )(GRU29024)
Max38646 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max38646', )(in0Max38646)
Res14667 = keras.layers.Reshape((1, 1), name = 'Res14667', )(Max38646)
Ave26621 = keras.layers.Average(name = 'Ave26621', )([Res65852,Res14667])
Con31112 = keras.layers.Concatenate(axis=2, name = 'Con31112', )([Ave26621,in0Con31112])
Max72084 = keras.layers.Maximum(name = 'Max72084', )([Min18906,Con31112])
model = tf.keras.models.Model(inputs=[in0Min18906,in1Min18906,in0Mul29293,in1Mul29293,in0Max38646,in0Con31112], outputs=Max72084)
w = model.get_layer('GRU29024').get_weights() 
w[0] = np.array([[7, 1, 3]])
w[1] = np.array([[8, 10, 7]])
w[2] = np.array([1, 4, 5])
model.get_layer('GRU29024').set_weights(w) 
in0Min18906 = tf.constant([[[0.6118, 0.9659]]])
in1Min18906 = tf.constant([[[0.6427, 0.5589]]])
in0Mul29293 = tf.constant([[[[0.5034]], [[0.0699]]]])
in1Mul29293 = tf.constant([[[[0.6487]], [[0.8512]]]])
in0Max38646 = tf.constant([[[[1.1133]]]])
in0Con31112 = tf.constant([[[0.0197]]])
print (np.array2string(model.predict([in0Min18906,in1Min18906,in0Mul29293,in1Mul29293,in0Max38646,in0Con31112],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max72084.png')

LMin18906 = minimum_layer([[[[0.6118, 0.9659]]], [[[0.6427, 0.5589]]]], Min18906), 
LMul29293 = multiply_layer([[[[[0.5034]], [[0.0699]]]], [[[[0.6487]], [[0.8512]]]]], Mul29293), 
LRes39770 = reshape_layer(Mul29293, [2, 1], Res39770), 
LGRU29024 = gru_layer(Res39770,[[7, 1, 3]],[[8, 10, 7]],[1, 4, 5], false, GRU29024), 
LRes65852 = reshape_layer(GRU29024, [1, 1], Res65852), 
LMax38646 = max_pool2D_layer([[[[1.1133]]]], 1, 1, Max38646), 
LRes14667 = reshape_layer(Max38646, [1, 1], Res14667), 
LAve26621 = average_layer([Res65852,Res14667], Ave26621), 
LCon31112 = concatenate_layer([Ave26621,[[[0.0197]]]], 2, Con31112), 
LMax72084 = maximum_layer([Min18906,Con31112], Max72084), 
exec_layers([LMin18906,LMul29293,LRes39770,LGRU29024,LRes65852,LMax38646,LRes14667,LAve26621,LCon31112,LMax72084],["Min18906","Mul29293","Res39770","GRU29024","Res65852","Max38646","Res14667","Ave26621","Con31112","Max72084"],Max72084,"Max72084")

Actual (Unparsed): [[[0.6488123, 0.5589000]]]

Expected (Unparsed): [[[0.6488123634415889,0.5589]]]

Actual:   [[[0.6489, 0.5589]]]

Expected: [[[0.6489, 0.5589]]]