import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con42595 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Sep37759 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Min50513 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Min50513 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Con42595 = keras.layers.Conv3D(3, (1, 2, 1),strides=(1, 2, 7), padding='same', dilation_rate=(1, 1, 1), name = 'Con42595', )(in0Con42595)
Res78080 = keras.layers.Reshape((1, 1, 3), name = 'Res78080', )(Con42595)
Res50182 = keras.layers.Reshape((1, 3), name = 'Res50182', )(Res78080)
Sep37759 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep37759', )(in0Sep37759)
Loc19649 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc19649', )(Sep37759)
Res87084 = keras.layers.Reshape((1, 3), name = 'Res87084', )(Loc19649)
Dot65862 = keras.layers.Dot(axes=(2, 2), name = 'Dot65862', )([Res50182,Res87084])
Zer51698 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer51698', )(Dot65862)
Min50513 = keras.layers.Minimum(name = 'Min50513', )([in0Min50513,in1Min50513])
Res6966 = keras.layers.Reshape((2, 1, 2), name = 'Res6966', )(Min50513)
Res90750 = keras.layers.Reshape((2, 2), name = 'Res90750', )(Res6966)
Dot93288 = keras.layers.Dot(axes=(1, 1), name = 'Dot93288', )([Zer51698,Res90750])
model = tf.keras.models.Model(inputs=[in0Con42595,in0Sep37759,in0Min50513,in1Min50513], outputs=Dot93288)
w = model.get_layer('Con42595').get_weights() 
w[0] = np.array([[[[[0.8462, 0.6503, 0.7784]]], [[[0.5204, 0.9334, 0.1313]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con42595').set_weights(w) 
w = model.get_layer('Sep37759').get_weights() 
w[0] = np.array([[[[0.7307]]]])
w[1] = np.array([[[[0.2559, 0.6009, 0.5102, 0.9302]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep37759').set_weights(w) 
w = model.get_layer('Loc19649').get_weights() 
w[0] = np.array([[[0.3622, 0.9287, 0.0264], [0.3764, 0.966, 0.0293], [0.5864, 0.1817, 0.8902], [0.7398, 0.659, 0.1775]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc19649').set_weights(w) 
in0Con42595 = tf.constant([[[[[0.2307]], [[0.7602]]]]])
in0Sep37759 = tf.constant([[[[0.2136]]]])
in0Min50513 = tf.constant([[[[[0.8352, 0.9501]]], [[[0.9608, 0.1105]]]]])
in1Min50513 = tf.constant([[[[[0.1933, 0.8579]]], [[[0.082, 0.9611]]]]])
print (np.array2string(model.predict([in0Con42595,in0Sep37759,in0Min50513,in1Min50513],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot93288.png')

LCon42595 = conv3D_layer([[[[[0.2307]], [[0.7602]]]]], 1, 2, 1,[[[[[0.8462, 0.6503, 0.7784]]], [[[0.5204, 0.9334, 0.1313]]]]],[0, 0, 0], 1, 2, 7, true, 1, 1, 1, Con42595), 
LRes78080 = reshape_layer(Con42595, [1, 1, 3], Res78080), 
LRes50182 = reshape_layer(Res78080, [1, 3], Res50182), 
LSep37759 = separable_conv2D_layer([[[[0.2136]]]], 1, 1,[[[[[0.7307]]]],[[[[0.2559, 0.6009, 0.5102, 0.9302]]]]],[0, 0, 0, 0], 1, 1, false, Sep37759), 
LLoc19649 = locally_connected2D_layer(Sep37759, 1, 1,[[[0.3622, 0.9287, 0.0264], [0.3764, 0.966, 0.0293], [0.5864, 0.1817, 0.8902], [0.7398, 0.659, 0.1775]]],[[[0, 0, 0]]], 1, 1, Loc19649), 
LRes87084 = reshape_layer(Loc19649, [1, 3], Res87084), 
LDot65862 = dot_layer(Res50182,Res87084, 2, 2, Dot65862), 
LZer51698 = zero_padding1D_layer(Dot65862, 1, 0, Zer51698), 
LMin50513 = minimum_layer([[[[[[0.8352, 0.9501]]], [[[0.9608, 0.1105]]]]], [[[[[0.1933, 0.8579]]], [[[0.082, 0.9611]]]]]], Min50513), 
LRes6966 = reshape_layer(Min50513, [2, 1, 2], Res6966), 
LRes90750 = reshape_layer(Res6966, [2, 2], Res90750), 
LDot93288 = dot_layer(Zer51698,Res90750, 1, 1, Dot93288), 
exec_layers([LCon42595,LRes78080,LRes50182,LSep37759,LLoc19649,LRes87084,LDot65862,LZer51698,LMin50513,LRes6966,LRes90750,LDot93288],["Con42595","Res78080","Res50182","Sep37759","Loc19649","Res87084","Dot65862","Zer51698","Min50513","Res6966","Res90750","Dot93288"],Dot93288,"Dot93288")

Actual (Unparsed): [[[0.0289428, 0.0390022]]]

Expected (Unparsed): [[[0.02894283259834618,0.03900223173313723]]]

Actual:   [[[0.029, 0.0391]]]

Expected: [[[0.029, 0.0391]]]