import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave62258 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave62258 = tf.keras.layers.Input(shape=([1, 1]))
in0Con35143 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Dot33590 = tf.keras.layers.Input(shape=([3]))
in1Dot33590 = tf.keras.layers.Input(shape=([3]))

Ave62258 = keras.layers.Average(name = 'Ave62258', )([in0Ave62258,in1Ave62258])
Res495 = keras.layers.Reshape((1, 1, 1), name = 'Res495', )(Ave62258)
Con35143 = keras.layers.Concatenate(axis=3, name = 'Con35143', )([Res495,in0Con35143])
Dot33590 = keras.layers.Dot(axes=(1, 1), name = 'Dot33590', )([in0Dot33590,in1Dot33590])
Res10577 = keras.layers.Reshape((1, 1), name = 'Res10577', )(Dot33590)
Res59544 = keras.layers.Reshape((1, 1, 1), name = 'Res59544', )(Res10577)
Sep22409 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='valid', name = 'Sep22409', )(Res59544)
Max4987 = keras.layers.Maximum(name = 'Max4987', )([Con35143,Sep22409])
model = tf.keras.models.Model(inputs=[in0Ave62258,in1Ave62258,in0Con35143,in0Dot33590,in1Dot33590], outputs=Max4987)
w = model.get_layer('Sep22409').get_weights() 
w[0] = np.array([[[[0.0689]]]])
w[1] = np.array([[[[0.8455, 0.369, 0.6456]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep22409').set_weights(w) 
in0Ave62258 = tf.constant([[[0.321]]])
in1Ave62258 = tf.constant([[[0.8677]]])
in0Con35143 = tf.constant([[[[0.824, 0.9582]]]])
in0Dot33590 = tf.constant([[0.4451, 0.9778, 0.4505]])
in1Dot33590 = tf.constant([[0.0237, 0.3385, 0.0255]])
print (np.array2string(model.predict([in0Ave62258,in1Ave62258,in0Con35143,in0Dot33590,in1Dot33590],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max4987.png')

LAve62258 = average_layer([[[[0.321]]], [[[0.8677]]]], Ave62258), 
LRes495 = reshape_layer(Ave62258, [1, 1, 1], Res495), 
LCon35143 = concatenate_layer([Res495,[[[[0.824, 0.9582]]]]], 3, Con35143), 
LDot33590 = dot_layer([[0.4451, 0.9778, 0.4505]], [[0.0237, 0.3385, 0.0255]], 1, 1, Dot33590), 
LRes10577 = reshape_layer(Dot33590, [1, 1], Res10577), 
LRes59544 = reshape_layer(Res10577, [1, 1, 1], Res59544), 
LSep22409 = separable_conv2D_layer(Res59544, 1, 1,[[[[[0.0689]]]],[[[[0.8455, 0.369, 0.6456]]]]],[0, 0, 0], 1, 1, false, Sep22409), 
LMax4987 = maximum_layer([Con35143,Sep22409], Max4987), 
exec_layers([LAve62258,LRes495,LCon35143,LDot33590,LRes10577,LRes59544,LSep22409,LMax4987],["Ave62258","Res495","Con35143","Dot33590","Res10577","Res59544","Sep22409","Max4987"],Max4987,"Max4987")

Actual (Unparsed): [[[[0.5943500, 0.8240000, 0.9582000]]]]

Expected (Unparsed): [[[[0.59435,0.824,0.9582]]]]

Actual:   [[[[0.5944, 0.824, 0.9582]]]]

Expected: [[[[0.5944, 0.824, 0.9582]]]]