import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max28226 = tf.keras.layers.Input(shape=([1, 1]))
in1Max28226 = tf.keras.layers.Input(shape=([1, 1]))

Max28226 = keras.layers.Maximum(name = 'Max28226', )([in0Max28226,in1Max28226])
Res95680 = keras.layers.Reshape((1, 1, 1), name = 'Res95680', )(Max28226)
PRe3439 = keras.layers.PReLU(name = 'PRe3439', )(Res95680)
Sof4194 = keras.layers.Softmax(axis=1, name = 'Sof4194', )(PRe3439)
model = tf.keras.models.Model(inputs=[in0Max28226,in1Max28226], outputs=Sof4194)
w = model.get_layer('PRe3439').get_weights() 
w[0] = np.array([[[0.4898]]])
model.get_layer('PRe3439').set_weights(w) 
in0Max28226 = tf.constant([[[0.7891]]])
in1Max28226 = tf.constant([[[0.3004]]])
print (np.array2string(model.predict([in0Max28226,in1Max28226],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof4194.png')

LMax28226 = maximum_layer([[[[0.7891]]], [[[0.3004]]]], Max28226), 
LRes95680 = reshape_layer(Max28226, [1, 1, 1], Res95680), 
LPRe3439 = prelu_layer(Res95680, [[[0.4898]]], PRe3439), 
LSof4194 = softmax_layer(PRe3439, 1, Sof4194), 
exec_layers([LMax28226,LRes95680,LPRe3439,LSof4194],["Max28226","Res95680","PRe3439","Sof4194"],Sof4194,"Sof4194")

Actual (Unparsed): [[[[1.0000000]]]]

Expected (Unparsed): [[[[1.0]]]]

Actual:   [[[[1]]]]

Expected: [[[[1]]]]