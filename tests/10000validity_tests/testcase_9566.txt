import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con25555 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Con25555 = keras.layers.Conv3D(2, (2, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con25555', )(in0Con25555)
Res49048 = keras.layers.Reshape((1, 1, 4), name = 'Res49048', )(Con25555)
Res80084 = keras.layers.Reshape((1, 4), name = 'Res80084', )(Res49048)
Sim33404 = keras.layers.SimpleRNN(3,name = 'Sim33404', )(Res80084)
Bat77571 = keras.layers.BatchNormalization(axis=1, epsilon=0.7500478198879765,  name = 'Bat77571', )(Sim33404)
Res4051 = keras.layers.Reshape((3, 1), name = 'Res4051', )(Bat77571)
Res7458 = keras.layers.Reshape((3, 1, 1), name = 'Res7458', )(Res4051)
Res73544 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res73544', )(Res7458)
Cro91590 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro91590', )(Res73544)
model = tf.keras.models.Model(inputs=[in0Con25555], outputs=Cro91590)
w = model.get_layer('Con25555').get_weights() 
w[0] = np.array([[[[[0.5087, 0.3737]]]], [[[[0.6925, 0.2856]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con25555').set_weights(w) 
w = model.get_layer('Sim33404').get_weights() 
w[0] = np.array([[1, 1, 9], [9, 2, 3], [5, 4, 2], [7, 9, 4]])
w[1] = np.array([[1, 2, 10], [6, 6, 2], [5, 7, 5]])
w[2] = np.array([7, 6, 9])
model.get_layer('Sim33404').set_weights(w) 
w = model.get_layer('Bat77571').get_weights() 
w[0] = np.array([0.5094, 0.2452, 0.3193])
w[1] = np.array([0.3363, 0.8657, 0.8266])
w[2] = np.array([0.1308, 0.9386, 0.1481])
w[3] = np.array([0.6228, 0.8462, 0.9562])
model.get_layer('Bat77571').set_weights(w) 
in0Con25555 = tf.constant([[[[[0.2387], [0.0579]]], [[[0.0282], [0.2664]]]]])
print (np.array2string(model.predict([in0Con25555],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro91590.png')

LCon25555 = conv3D_layer([[[[[0.2387], [0.0579]]], [[[0.0282], [0.2664]]]]], 2, 1, 1,[[[[[0.5087, 0.3737]]]], [[[[0.6925, 0.2856]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con25555), 
LRes49048 = reshape_layer(Con25555, [1, 1, 4], Res49048), 
LRes80084 = reshape_layer(Res49048, [1, 4], Res80084), 
LSim33404 = simple_rnn_layer(Res80084,[[1, 1, 9], [9, 2, 3], [5, 4, 2], [7, 9, 4]],[[1, 2, 10], [6, 6, 2], [5, 7, 5]],[7, 6, 9], Sim33404), 
LBat77571 = batch_normalization_layer(Sim33404, 1, 0.7500478198879765, [0.5094, 0.2452, 0.3193], [0.3363, 0.8657, 0.8266], [0.1308, 0.9386, 0.1481], [0.6228, 0.8462, 0.9562], Bat77571), 
LRes4051 = reshape_layer(Bat77571, [3, 1], Res4051), 
LRes7458 = reshape_layer(Res4051, [3, 1, 1], Res7458), 
LRes73544 = reshape_layer(Res7458, [3, 1, 1, 1], Res73544), 
LCro91590 = cropping3D_layer(Res73544, 0, 0, 0, 0, 0, 0, Cro91590), 
exec_layers([LCon25555,LRes49048,LRes80084,LSim33404,LBat77571,LRes4051,LRes7458,LRes73544,LCro91590],["Con25555","Res49048","Res80084","Sim33404","Bat77571","Res4051","Res7458","Res73544","Cro91590"],Cro91590,"Cro91590")

Actual (Unparsed): [[[[[0.7141918]]], [[[0.8776162]]], [[[1.0348411]]]]]

Expected (Unparsed): [[[[[0.714191789300002]]],[[[0.8776161866272786]]],[[[1.0348411156862276]]]]]

Actual:   [[[[[0.7142]]], [[[0.8777]]], [[[1.0349]]]]]

Expected: [[[[[0.7142]]], [[[0.8777]]], [[[1.0349]]]]]