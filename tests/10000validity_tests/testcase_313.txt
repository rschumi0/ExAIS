import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc96717 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Up_756 = tf.keras.layers.Input(shape=([1, 1, 3]))
in0Con42287 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con5884 = tf.keras.layers.Input(shape=([1, 1]))
in0Con93813 = tf.keras.layers.Input(shape=([1, 1]))

Loc96717 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc96717', )(in0Loc96717)
Zer87300 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer87300', )(Loc96717)
Up_756 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_756', )(in0Up_756)
Con42287 = keras.layers.Concatenate(axis=3, name = 'Con42287', )([Up_756,in0Con42287])
Add26042 = keras.layers.Add(name = 'Add26042', )([Zer87300,Con42287])
Sep32484 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='same', name = 'Sep32484', )(Add26042)
Res49657 = keras.layers.Reshape((1, 4), name = 'Res49657', )(Sep32484)
Con5884 = keras.layers.Concatenate(axis=2, name = 'Con5884', )([Res49657,in0Con5884])
Con93813 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con93813', )(in0Con93813)
Dot76767 = keras.layers.Dot(axes=(1, 1), name = 'Dot76767', )([Con5884,Con93813])
model = tf.keras.models.Model(inputs=[in0Loc96717,in0Up_756,in0Con42287,in0Con5884,in0Con93813], outputs=Dot76767)
w = model.get_layer('Loc96717').get_weights() 
w[0] = np.array([[[0.7064, 0.7993, 0.4126, 0.3844], [0.8239, 0.6182, 0.6955, 0.0033]]])
w[1] = np.array([[[0, 0, 0, 0]]])
model.get_layer('Loc96717').set_weights(w) 
w = model.get_layer('Sep32484').get_weights() 
w[0] = np.array([[[[0.6103], [0.7303], [0.2617], [0.8881]]]])
w[1] = np.array([[[[0.4312, 0.0265], [0.1814, 0.7934], [0.8437, 0.6488], [0.4589, 0.786]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep32484').set_weights(w) 
w = model.get_layer('Con93813').get_weights() 
w[0] = np.array([[[0.9336, 0.7087, 0.4335]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con93813').set_weights(w) 
in0Loc96717 = tf.constant([[[[0.7755, 0.574]]]])
in0Up_756 = tf.constant([[[[1.605, 1.588, 1.4219]]]])
in0Con42287 = tf.constant([[[[0.1624], [0.9223]]]])
in0Con5884 = tf.constant([[[0.4979]]])
in0Con93813 = tf.constant([[[0.7493]]])
print (np.array2string(model.predict([in0Loc96717,in0Up_756,in0Con42287,in0Con5884,in0Con93813],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot76767.png')

LLoc96717 = locally_connected2D_layer([[[[0.7755, 0.574]]]], 1, 1,[[[0.7064, 0.7993, 0.4126, 0.3844], [0.8239, 0.6182, 0.6955, 0.0033]]],[[[0, 0, 0, 0]]], 1, 1, Loc96717), 
LZer87300 = zero_padding2D_layer(Loc96717, 0, 0, 1, 0, Zer87300), 
LUp_756 = up_sampling2D_layer([[[[1.605, 1.588, 1.4219]]]], 1, 2, Up_756), 
LCon42287 = concatenate_layer([Up_756,[[[[0.1624], [0.9223]]]]], 3, Con42287), 
LAdd26042 = add_layer([Zer87300,Con42287], Add26042), 
LSep32484 = separable_conv2D_layer(Add26042, 1, 1,[[[[[0.6103], [0.7303], [0.2617], [0.8881]]]],[[[[0.4312, 0.0265], [0.1814, 0.7934], [0.8437, 0.6488], [0.4589, 0.786]]]]],[0, 0], 1, 1, true, Sep32484), 
LRes49657 = reshape_layer(Sep32484, [1, 4], Res49657), 
LCon5884 = concatenate_layer([Res49657,[[[0.4979]]]], 2, Con5884), 
LCon93813 = conv1D_layer([[[0.7493]]], 1,[[[0.9336, 0.7087, 0.4335]]],[0, 0, 0], 1, true, 1, Con93813), 
LDot76767 = dot_layer(Con5884,Con93813, 1, 1, Dot76767), 
exec_layers([LLoc96717,LZer87300,LUp_756,LCon42287,LAdd26042,LSep32484,LRes49657,LCon5884,LCon93813,LDot76767],["Loc96717","Zer87300","Up_756","Con42287","Add26042","Sep32484","Res49657","Con5884","Con93813","Dot76767"],Dot76767,"Dot76767")

Actual (Unparsed): [[[0.7085586, 0.5378700, 0.3290062], [0.9100156, 0.6907970, 0.4225490], [1.4000577, 1.0627902, 0.6500911], [1.9196291, 1.4571992, 0.8913445], [0.3483042, 0.2643993, 0.1617287]]]

Expected (Unparsed): [[[0.7085585657219762,0.5378700252004761,0.32900614635869396],[0.9100156089169431,0.6907969816189348,0.42254902149260365],[1.4000577290569334,1.0627901805726743,0.6500910727786853],[1.9196290544951842,1.4571991333769678,0.8913444677845569],[0.348304192392,0.264399294289,0.16172864974499998]]]

Actual:   [[[0.7086, 0.5379, 0.3291], [0.9101, 0.6908, 0.4226], [1.4001, 1.0628, 0.6501], [1.9197, 1.4572, 0.8914], [0.3484, 0.2644, 0.1618]]]

Expected: [[[0.7086, 0.5379, 0.3291], [0.9101, 0.6908, 0.4226], [1.4001, 1.0628, 0.6501], [1.9197, 1.4572, 0.8914], [0.3484, 0.2644, 0.1618]]]