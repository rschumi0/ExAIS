import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min7909 = tf.keras.layers.Input(shape=([2, 2]))
in1Min7909 = tf.keras.layers.Input(shape=([2, 2]))
in0Zer92372 = tf.keras.layers.Input(shape=([2, 1]))
in0Con10843 = tf.keras.layers.Input(shape=([4, 1]))
in0Ave36038 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave36038 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con49438 = tf.keras.layers.Input(shape=([7]))

Min7909 = keras.layers.Minimum(name = 'Min7909', )([in0Min7909,in1Min7909])
Zer91808 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer91808', )(Min7909)
Zer92372 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer92372', )(in0Zer92372)
Con10843 = keras.layers.Concatenate(axis=2, name = 'Con10843', )([Zer92372,in0Con10843])
Max32410 = keras.layers.Maximum(name = 'Max32410', )([Zer91808,Con10843])
Fla90801 = keras.layers.Flatten(name = 'Fla90801', )(Max32410)
Ave36038 = keras.layers.Average(name = 'Ave36038', )([in0Ave36038,in1Ave36038])
Res83166 = keras.layers.Reshape((1, 4), name = 'Res83166', )(Ave36038)
Per17159 = keras.layers.Permute((2,1), name = 'Per17159',)(Res83166)
Glo59840 = keras.layers.GlobalAveragePooling1D(name = 'Glo59840', )(Per17159)
Con49438 = keras.layers.Concatenate(axis=1, name = 'Con49438', )([Glo59840,in0Con49438])
Ave37497 = keras.layers.Average(name = 'Ave37497', )([Fla90801,Con49438])
model = tf.keras.models.Model(inputs=[in0Min7909,in1Min7909,in0Zer92372,in0Con10843,in0Ave36038,in1Ave36038,in0Con49438], outputs=Ave37497)
in0Min7909 = tf.constant([[[0.9266, 0.7734], [0.8928, 0.3693]]])
in1Min7909 = tf.constant([[[0.158, 0.2943], [0.8575, 0.7323]]])
in0Zer92372 = tf.constant([[[1.2389], [1.6318]]])
in0Con10843 = tf.constant([[[0.6261], [0.3558], [0.7822], [0.5436]]])
in0Ave36038 = tf.constant([[[[0.1048, 0.0145], [0.7929, 0.8147]]]])
in1Ave36038 = tf.constant([[[[0.3134, 0.7568], [0.8817, 0.7257]]]])
in0Con49438 = tf.constant([[0.1378, 0.6146, 0.2553, 0.5814, 0.4058, 0.4852, 0.0796]])
print (np.array2string(model.predict([in0Min7909,in1Min7909,in0Zer92372,in0Con10843,in0Ave36038,in1Ave36038,in0Con49438],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave37497.png')

LMin7909 = minimum_layer([[[[0.9266, 0.7734], [0.8928, 0.3693]]], [[[0.158, 0.2943], [0.8575, 0.7323]]]], Min7909), 
LZer91808 = zero_padding1D_layer(Min7909, 2, 0, Zer91808), 
LZer92372 = zero_padding1D_layer([[[1.2389], [1.6318]]], 1, 1, Zer92372), 
LCon10843 = concatenate_layer([Zer92372,[[[0.6261], [0.3558], [0.7822], [0.5436]]]], 2, Con10843), 
LMax32410 = maximum_layer([Zer91808,Con10843], Max32410), 
LFla90801 = flatten_layer(Max32410, Fla90801), 
LAve36038 = average_layer([[[[[0.1048, 0.0145], [0.7929, 0.8147]]]], [[[[0.3134, 0.7568], [0.8817, 0.7257]]]]], Ave36038), 
LRes83166 = reshape_layer(Ave36038, [1, 4], Res83166), 
LPer17159 = permute_layer(Res83166, 2,1, Per17159), 
LGlo59840 = global_average_pooling1D_layer(Per17159, Glo59840), 
LCon49438 = concatenate_layer([Glo59840,[[0.1378, 0.6146, 0.2553, 0.5814, 0.4058, 0.4852, 0.0796]]], 1, Con49438), 
LAve37497 = average_layer([Fla90801,Con49438], Ave37497), 
exec_layers([LMin7909,LZer91808,LZer92372,LCon10843,LMax32410,LFla90801,LAve36038,LRes83166,LPer17159,LGlo59840,LCon49438,LAve37497],["Min7909","Zer91808","Zer92372","Con10843","Max32410","Fla90801","Ave36038","Res83166","Per17159","Glo59840","Con49438","Ave37497"],Ave37497,"Ave37497")

Actual (Unparsed): [[0.2752813, 0.3819500, 0.9267500, 0.3055500, 1.1066000, 0.5940000, 0.6713500, 0.3116000]]

Expected (Unparsed): [[0.27528125000000003,0.38195,0.92675,0.30555,1.1066,0.594,0.67135,0.3116]]

Actual:   [[0.2753, 0.382, 0.9268, 0.3056, 1.1066, 0.594, 0.6714, 0.3116]]

Expected: [[0.2753, 0.382, 0.9268, 0.3056, 1.1066, 0.594, 0.6714, 0.3116]]