import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add557 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Add557 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Add557 = keras.layers.Add(name = 'Add557', )([in0Add557,in1Add557])
Res56785 = keras.layers.Reshape((1, 1, 2), name = 'Res56785', )(Add557)
Res32887 = keras.layers.Reshape((1, 2), name = 'Res32887', )(Res56785)
Zer21331 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer21331', )(Res32887)
Max36672 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max36672', )(Zer21331)
model = tf.keras.models.Model(inputs=[in0Add557,in1Add557], outputs=Max36672)
in0Add557 = tf.constant([[[[[0.96], [0.3749]]]]])
in1Add557 = tf.constant([[[[[0.8842], [0.61]]]]])
print (np.array2string(model.predict([in0Add557,in1Add557],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max36672.png')

LAdd557 = add_layer([[[[[[0.96], [0.3749]]]]], [[[[[0.8842], [0.61]]]]]], Add557), 
LRes56785 = reshape_layer(Add557, [1, 1, 2], Res56785), 
LRes32887 = reshape_layer(Res56785, [1, 2], Res32887), 
LZer21331 = zero_padding1D_layer(Res32887, 1, 1, Zer21331), 
LMax36672 = max_pool1D_layer(Zer21331, 2, Max36672), 
exec_layers([LAdd557,LRes56785,LRes32887,LZer21331,LMax36672],["Add557","Res56785","Res32887","Zer21331","Max36672"],Max36672,"Max36672")

Actual (Unparsed): [[[1.8442000, 0.9849000]]]

Expected (Unparsed): [[[1.8441999999999998,0.9849]]]

Actual:   [[[1.8442, 0.9849]]]

Expected: [[[1.8442, 0.9849]]]