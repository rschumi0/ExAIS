import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min95623 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min95623 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Min95623 = keras.layers.Minimum(name = 'Min95623', )([in0Min95623,in1Min95623])
Res32689 = keras.layers.Reshape((1, 2, 2), name = 'Res32689', )(Min95623)
Con61342 = keras.layers.Conv2D(2, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con61342', )(Res32689)
Loc46832 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(7, 1), name = 'Loc46832', )(Con61342)
model = tf.keras.models.Model(inputs=[in0Min95623,in1Min95623], outputs=Loc46832)
w = model.get_layer('Con61342').get_weights() 
w[0] = np.array([[[[0.3904, 0.3714], [0.8041, 0.3893]], [[0.7642, 0.3564], [0.0698, 0.0276]]]])
w[1] = np.array([0, 0])
model.get_layer('Con61342').set_weights(w) 
w = model.get_layer('Loc46832').get_weights() 
w[0] = np.array([[[0.1594, 0.4688], [0.8495, 0.6837]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc46832').set_weights(w) 
in0Min95623 = tf.constant([[[[[0.8356], [0.626]], [[0.0897], [0.3799]]]]])
in1Min95623 = tf.constant([[[[[0.1872], [0.9216]], [[0.1458], [0.9748]]]]])
print (np.array2string(model.predict([in0Min95623,in1Min95623],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc46832.png')

LMin95623 = minimum_layer([[[[[[0.8356], [0.626]], [[0.0897], [0.3799]]]]], [[[[[0.1872], [0.9216]], [[0.1458], [0.9748]]]]]], Min95623), 
LRes32689 = reshape_layer(Min95623, [1, 2, 2], Res32689), 
LCon61342 = conv2D_layer(Res32689, 1, 2,[[[[0.3904, 0.3714], [0.8041, 0.3893]], [[0.7642, 0.3564], [0.0698, 0.0276]]]],[0, 0], 1, 1, false, 1, 1, Con61342), 
LLoc46832 = locally_connected2D_layer(Con61342, 1, 1,[[[0.1594, 0.4688], [0.8495, 0.6837]]],[[[0, 0]]], 7, 1, Loc46832), 
exec_layers([LMin95623,LRes32689,LCon61342,LLoc46832],["Min95623","Res32689","Con61342","Loc46832"],Loc46832,"Loc46832")

Actual (Unparsed): [[[[0.4091915, 0.5579863]]]]

Expected (Unparsed): [[[[0.409191558156,0.557986264652]]]]

Actual:   [[[[0.4092, 0.558]]]]

Expected: [[[[0.4092, 0.558]]]]