import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave37240 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave37240 = tf.keras.layers.Input(shape=([1, 1]))
in0Con26337 = tf.keras.layers.Input(shape=([1, 1, 3]))
in0Min98308 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Min98308 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Loc28456 = tf.keras.layers.Input(shape=([1, 1]))
in0Con88725 = tf.keras.layers.Input(shape=([1]))
in0Lea62674 = tf.keras.layers.Input(shape=([2, 2, 2]))

Ave37240 = keras.layers.Average(name = 'Ave37240', )([in0Ave37240,in1Ave37240])
Res96061 = keras.layers.Reshape((1, 1, 1), name = 'Res96061', )(Ave37240)
Con26337 = keras.layers.Concatenate(axis=3, name = 'Con26337', )([Res96061,in0Con26337])
Min98308 = keras.layers.Minimum(name = 'Min98308', )([in0Min98308,in1Min98308])
Res61588 = keras.layers.Reshape((1, 1, 4), name = 'Res61588', )(Min98308)
Max57707 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max57707', )(Res61588)
Add11631 = keras.layers.Add(name = 'Add11631', )([Con26337,Max57707])
Res2754 = keras.layers.Reshape((1, 4), name = 'Res2754', )(Add11631)
Fla89403 = keras.layers.Flatten(name = 'Fla89403', )(Res2754)
Loc28456 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc28456', )(in0Loc28456)
Fla8402 = keras.layers.Flatten(name = 'Fla8402', )(Loc28456)
Con88725 = keras.layers.Concatenate(axis=1, name = 'Con88725', )([Fla8402,in0Con88725])
Lea62674 = keras.layers.LeakyReLU(alpha=5.310695553211865, name = 'Lea62674', input_shape=(2, 2, 2))(in0Lea62674)
Res17929 = keras.layers.Reshape((2, 4), name = 'Res17929', )(Lea62674)
Glo12230 = keras.layers.GlobalMaxPool1D(name = 'Glo12230', )(Res17929)
Max35550 = keras.layers.Maximum(name = 'Max35550', )([Con88725,Glo12230])
Dot17564 = keras.layers.Dot(axes=(1, 1), name = 'Dot17564', )([Fla89403,Max35550])
Lay94447 = keras.layers.LayerNormalization(axis=1, epsilon=1.6594981233584454, name = 'Lay94447', )(Dot17564)
model = tf.keras.models.Model(inputs=[in0Ave37240,in1Ave37240,in0Con26337,in0Min98308,in1Min98308,in0Loc28456,in0Con88725,in0Lea62674], outputs=Lay94447)
w = model.get_layer('Loc28456').get_weights() 
w[0] = np.array([[[0.3002, 0.0941, 0.4905]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc28456').set_weights(w) 
in0Ave37240 = tf.constant([[[0.5569]]])
in1Ave37240 = tf.constant([[[0.5094]]])
in0Con26337 = tf.constant([[[[0.0877, 0.7798, 0.2366]]]])
in0Min98308 = tf.constant([[[[[0.64, 0.4972], [0.8404, 0.4882]]]]])
in1Min98308 = tf.constant([[[[[0.0105, 0.1736], [0.7808, 0.7536]]]]])
in0Loc28456 = tf.constant([[[0.0915]]])
in0Con88725 = tf.constant([[0.2114]])
in0Lea62674 = tf.constant([[[[0.5983, 0.7844], [0.6877, 0.645]], [[0.0537, 0.6318], [0.5302, 0.911]]]])
print (np.array2string(model.predict([in0Ave37240,in1Ave37240,in0Con26337,in0Min98308,in1Min98308,in0Loc28456,in0Con88725,in0Lea62674],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay94447.png')

LAve37240 = average_layer([[[[0.5569]]], [[[0.5094]]]], Ave37240), 
LRes96061 = reshape_layer(Ave37240, [1, 1, 1], Res96061), 
LCon26337 = concatenate_layer([Res96061,[[[[0.0877, 0.7798, 0.2366]]]]], 3, Con26337), 
LMin98308 = minimum_layer([[[[[[0.64, 0.4972], [0.8404, 0.4882]]]]], [[[[[0.0105, 0.1736], [0.7808, 0.7536]]]]]], Min98308), 
LRes61588 = reshape_layer(Min98308, [1, 1, 4], Res61588), 
LMax57707 = max_pool2D_layer(Res61588, 1, 1, Max57707), 
LAdd11631 = add_layer([Con26337,Max57707], Add11631), 
LRes2754 = reshape_layer(Add11631, [1, 4], Res2754), 
LFla89403 = flatten_layer(Res2754, Fla89403), 
LLoc28456 = locally_connected1D_layer([[[0.0915]]], 1,[[[0.3002, 0.0941, 0.4905]]],[[0, 0, 0]], 1, Loc28456), 
LFla8402 = flatten_layer(Loc28456, Fla8402), 
LCon88725 = concatenate_layer([Fla8402,[[0.2114]]], 1, Con88725), 
LLea62674 = leaky_relu_layer([[[[0.5983, 0.7844], [0.6877, 0.645]], [[0.0537, 0.6318], [0.5302, 0.911]]]], 5.310695553211865, Lea62674), 
LRes17929 = reshape_layer(Lea62674, [2, 4], Res17929), 
LGlo12230 = global_max_pool1D_layer(Res17929, Glo12230), 
LMax35550 = maximum_layer([Con88725,Glo12230], Max35550), 
LDot17564 = dot_layer(Fla89403,Max35550, 1, 1, Dot17564), 
LLay94447 = layer_normalization_layer(Dot17564, 1, 1.6594981233584454, Lay94447), 
exec_layers([LAve37240,LRes96061,LCon26337,LMin98308,LRes61588,LMax57707,LAdd11631,LRes2754,LFla89403,LLoc28456,LFla8402,LCon88725,LLea62674,LRes17929,LGlo12230,LMax35550,LDot17564,LLay94447],["Ave37240","Res96061","Con26337","Min98308","Res61588","Max57707","Add11631","Res2754","Fla89403","Loc28456","Fla8402","Con88725","Lea62674","Res17929","Glo12230","Max35550","Dot17564","Lay94447"],Lay94447,"Lay94447")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0.0]]

Actual:   [[0]]

Expected: [[0]]