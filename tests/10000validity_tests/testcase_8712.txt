import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub51266 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub51266 = tf.keras.layers.Input(shape=([3, 2, 2]))

Sub51266 = keras.layers.Subtract(name = 'Sub51266', )([in0Sub51266,in1Sub51266])
Res71630 = keras.layers.Reshape((3, 4), name = 'Res71630', )(Sub51266)
Sim60782 = keras.layers.SimpleRNN(1,name = 'Sim60782', )(Res71630)
Res506 = keras.layers.Reshape((1, 1), name = 'Res506', )(Sim60782)
Res8199 = keras.layers.Reshape((1, 1, 1), name = 'Res8199', )(Res506)
Res59717 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res59717', )(Res8199)
Con45802 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(10, 1, 3), padding='same', name = 'Con45802', )(Res59717)
model = tf.keras.models.Model(inputs=[in0Sub51266,in1Sub51266], outputs=Con45802)
w = model.get_layer('Sim60782').get_weights() 
w[0] = np.array([[1], [3], [10], [9]])
w[1] = np.array([[9]])
w[2] = np.array([5])
model.get_layer('Sim60782').set_weights(w) 
w = model.get_layer('Con45802').get_weights() 
w[0] = np.array([[[[[0.1991], [0.2303], [0.8931]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con45802').set_weights(w) 
in0Sub51266 = tf.constant([[[[0.4015, 0.0613], [0.2638, 0.9778]], [[0.4121, 0.1408], [0.1372, 0.7613]], [[0.1746, 0.548], [0.4735, 0.1828]]]])
in1Sub51266 = tf.constant([[[[0.826, 0.9596], [0.2686, 0.7415]], [[0.4209, 0.1637], [0.81, 0.8022]], [[0.428, 0.9818], [0.4629, 0.3169]]]])
print (np.array2string(model.predict([in0Sub51266,in1Sub51266],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con45802.png')

LSub51266 = subtract_layer([[[[0.4015, 0.0613], [0.2638, 0.9778]], [[0.4121, 0.1408], [0.1372, 0.7613]], [[0.1746, 0.548], [0.4735, 0.1828]]]], [[[[0.826, 0.9596], [0.2686, 0.7415]], [[0.4209, 0.1637], [0.81, 0.8022]], [[0.428, 0.9818], [0.4629, 0.3169]]]], Sub51266), 
LRes71630 = reshape_layer(Sub51266, [3, 4], Res71630), 
LSim60782 = simple_rnn_layer(Res71630,[[1], [3], [10], [9]],[[9]],[5], Sim60782), 
LRes506 = reshape_layer(Sim60782, [1, 1], Res506), 
LRes8199 = reshape_layer(Res506, [1, 1, 1], Res8199), 
LRes59717 = reshape_layer(Res8199, [1, 1, 1, 1], Res59717), 
LCon45802 = conv3D_transpose_layer(Res59717, 1, 1, 1,[[[[[0.1991], [0.2303], [0.8931]]]]],[0, 0, 0], 10, 1, 3, true, Con45802), 
exec_layers([LSub51266,LRes71630,LSim60782,LRes506,LRes8199,LRes59717,LCon45802],["Sub51266","Res71630","Sim60782","Res506","Res8199","Res59717","Con45802"],Con45802,"Con45802")

Actual (Unparsed): [[[[[0.1991000, 0.2303000, 0.8931000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]]]

Expected (Unparsed): [[[[[0.19909999994420619,0.230299999935463,0.8930999997497264],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]]],[[[0,0,0],[0,0,0],[0,0,0]]]]]

Actual:   [[[[[0.1991, 0.2303, 0.8931], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]]

Expected: [[[[[0.1991, 0.2303, 0.8931], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]], [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]]