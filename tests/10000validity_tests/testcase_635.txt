import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min28069 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Min28069 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Con2366 = tf.keras.layers.Input(shape=([4, 1]))
in0Min27141 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Min27141 = tf.keras.layers.Input(shape=([1, 1, 2]))

Min28069 = keras.layers.Minimum(name = 'Min28069', )([in0Min28069,in1Min28069])
Res31018 = keras.layers.Reshape((1, 1, 4), name = 'Res31018', )(Min28069)
Res74960 = keras.layers.Reshape((1, 4), name = 'Res74960', )(Res31018)
Fla55562 = keras.layers.Flatten(name = 'Fla55562', )(Res74960)
Sof30735 = keras.layers.Softmax(axis=1, name = 'Sof30735', )(Fla55562)
Res11868 = keras.layers.Reshape((4, 1), name = 'Res11868', )(Sof30735)
Con2366 = keras.layers.Concatenate(axis=2, name = 'Con2366', )([Res11868,in0Con2366])
Min27141 = keras.layers.Minimum(name = 'Min27141', )([in0Min27141,in1Min27141])
Res67779 = keras.layers.Reshape((1, 2), name = 'Res67779', )(Min27141)
Cro22388 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro22388', )(Res67779)
Dot6055 = keras.layers.Dot(axes=(2, 2), name = 'Dot6055', )([Con2366,Cro22388])
model = tf.keras.models.Model(inputs=[in0Min28069,in1Min28069,in0Con2366,in0Min27141,in1Min27141], outputs=Dot6055)
in0Min28069 = tf.constant([[[[[0.0745, 0.1095], [0.1739, 0.3388]]]]])
in1Min28069 = tf.constant([[[[[0.0642, 0.0072], [0.3364, 0.4901]]]]])
in0Con2366 = tf.constant([[[0.9843], [0.5486], [0.6684], [0.5538]]])
in0Min27141 = tf.constant([[[[0.8602, 0.0949]]]])
in1Min27141 = tf.constant([[[[0.0977, 0.843]]]])
print (np.array2string(model.predict([in0Min28069,in1Min28069,in0Con2366,in0Min27141,in1Min27141],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot6055.png')

LMin28069 = minimum_layer([[[[[[0.0745, 0.1095], [0.1739, 0.3388]]]]], [[[[[0.0642, 0.0072], [0.3364, 0.4901]]]]]], Min28069), 
LRes31018 = reshape_layer(Min28069, [1, 1, 4], Res31018), 
LRes74960 = reshape_layer(Res31018, [1, 4], Res74960), 
LFla55562 = flatten_layer(Res74960, Fla55562), 
LSof30735 = softmax_layer(Fla55562, 1, Sof30735), 
LRes11868 = reshape_layer(Sof30735, [4, 1], Res11868), 
LCon2366 = concatenate_layer([Res11868,[[[0.9843], [0.5486], [0.6684], [0.5538]]]], 2, Con2366), 
LMin27141 = minimum_layer([[[[[0.8602, 0.0949]]]], [[[[0.0977, 0.843]]]]], Min27141), 
LRes67779 = reshape_layer(Min27141, [1, 2], Res67779), 
LCro22388 = cropping1D_layer(Res67779, 0, 0, Cro22388), 
LDot6055 = dot_layer(Con2366,Cro22388, 2, 2, Dot6055), 
exec_layers([LMin28069,LRes31018,LRes74960,LFla55562,LSof30735,LRes11868,LCon2366,LMin27141,LRes67779,LCro22388,LDot6055],["Min28069","Res31018","Res74960","Fla55562","Sof30735","Res11868","Con2366","Min27141","Res67779","Cro22388","Dot6055"],Dot6055,"Dot6055")

Actual (Unparsed): [[[0.1157336], [0.0731488], [0.0883430], [0.0819335]]]

Expected (Unparsed): [[[0.11573363315332695],[0.07314884536176168],[0.08834298933261835],[0.081933522152293]]]

Actual:   [[[0.1158], [0.0732], [0.0884], [0.082]]]

Expected: [[[0.1158], [0.0732], [0.0884], [0.082]]]