import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul97901 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul97901 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Glo58222 = tf.keras.layers.Input(shape=([1, 2]))
in0Con16307 = tf.keras.layers.Input(shape=([3, 1, 1]))
in0Cro44818 = tf.keras.layers.Input(shape=([3, 1, 1, 4]))
in0Min64228 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Min64228 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con6454 = tf.keras.layers.Input(shape=([3, 1, 3, 3]))

Mul97901 = keras.layers.Multiply(name = 'Mul97901', )([in0Mul97901,in1Mul97901])
ELU10108 = keras.layers.ELU(alpha=-1.7992925356763596, name = 'ELU10108', )(Mul97901)
Zer48749 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer48749', )(ELU10108)
Glo58222 = keras.layers.GlobalMaxPool1D(name = 'Glo58222', )(in0Glo58222)
Res43604 = keras.layers.Reshape((2, 1), name = 'Res43604', )(Glo58222)
Res89317 = keras.layers.Reshape((2, 1, 1), name = 'Res89317', )(Res43604)
Zer56798 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer56798', )(Res89317)
Con16307 = keras.layers.Concatenate(axis=3, name = 'Con16307', )([Zer56798,in0Con16307])
Cro44818 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro44818', )(in0Cro44818)
Zer74488 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer74488', )(Cro44818)
Min64228 = keras.layers.Minimum(name = 'Min64228', )([in0Min64228,in1Min64228])
Zer62013 = keras.layers.ZeroPadding3D(padding=((2, 0), (0, 0), (1, 0)), name = 'Zer62013', )(Min64228)
Con6454 = keras.layers.Concatenate(axis=4, name = 'Con6454', )([Zer62013,in0Con6454])
Add66980 = keras.layers.Add(name = 'Add66980', )([Zer74488,Con6454])
Res79352 = keras.layers.Reshape((3, 1, 12), name = 'Res79352', )(Add66980)
Con29388 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con29388', )(Res79352)
Max83120 = keras.layers.Maximum(name = 'Max83120', )([Con16307,Con29388])
Min53562 = keras.layers.Minimum(name = 'Min53562', )([Zer48749,Max83120])
model = tf.keras.models.Model(inputs=[in0Mul97901,in1Mul97901,in0Glo58222,in0Con16307,in0Cro44818,in0Min64228,in1Min64228,in0Con6454], outputs=Min53562)
w = model.get_layer('Con29388').get_weights() 
w[0] = np.array([[[[0.8548, 0.9207], [0.415, 0.0478], [0.3378, 0.2616], [0.0075, 0.3481], [0.6086, 0.2961], [0.0034, 0.8485], [0.8825, 0.0051], [0.7078, 0.9072], [0.1492, 0.6183], [0.0737, 0.1616], [0.5019, 0.9351], [0.0801, 0.5147]]]])
w[1] = np.array([0, 0])
model.get_layer('Con29388').set_weights(w) 
in0Mul97901 = tf.constant([[[[0.757, 0.4983]], [[0.2058, 0.8456]]]])
in1Mul97901 = tf.constant([[[[0.4159, 0.9285]], [[0.6437, 0.651]]]])
in0Glo58222 = tf.constant([[[1.8629, 1.6008]]])
in0Con16307 = tf.constant([[[[0.282]], [[0.3276]], [[0.8221]]]])
in0Cro44818 = tf.constant([[[[[1.6352, 1.9703, 1.6433, 1.2795]]], [[[1.8498, 1.6334, 1.6661, 1.8444]]], [[[1.5054, 1.9467, 1.8592, 1.9474]]]]])
in0Min64228 = tf.constant([[[[[0.7243], [0.698]]]]])
in1Min64228 = tf.constant([[[[[0.1808], [0.4483]]]]])
in0Con6454 = tf.constant([[[[[0.4871, 0.2768, 0.9415], [0.8294, 0.4864, 0.9246], [0.4827, 0.9955, 0.9501]]], [[[0.5677, 0.3226, 0.2827], [0.4588, 0.244, 0.6025], [0.827, 0.0454, 0.9418]]], [[[0.6492, 0.903, 0.2883], [0.9359, 0.1741, 0.8309], [0.983, 0.9033, 0.6268]]]]])
print (np.array2string(model.predict([in0Mul97901,in1Mul97901,in0Glo58222,in0Con16307,in0Cro44818,in0Min64228,in1Min64228,in0Con6454],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min53562.png')

LMul97901 = multiply_layer([[[[[0.757, 0.4983]], [[0.2058, 0.8456]]]], [[[[0.4159, 0.9285]], [[0.6437, 0.651]]]]], Mul97901), 
LELU10108 = elu_layer(Mul97901, -1.7992925356763596, ELU10108), 
LZer48749 = zero_padding2D_layer(ELU10108, 1, 0, 0, 0, Zer48749), 
LGlo58222 = global_max_pool1D_layer([[[1.8629, 1.6008]]], Glo58222), 
LRes43604 = reshape_layer(Glo58222, [2, 1], Res43604), 
LRes89317 = reshape_layer(Res43604, [2, 1, 1], Res89317), 
LZer56798 = zero_padding2D_layer(Res89317, 1, 0, 0, 0, Zer56798), 
LCon16307 = concatenate_layer([Zer56798,[[[[0.282]], [[0.3276]], [[0.8221]]]]], 3, Con16307), 
LCro44818 = cropping3D_layer([[[[[1.6352, 1.9703, 1.6433, 1.2795]]], [[[1.8498, 1.6334, 1.6661, 1.8444]]], [[[1.5054, 1.9467, 1.8592, 1.9474]]]]], 0, 0, 0, 0, 0, 0, Cro44818), 
LZer74488 = zero_padding3D_layer(Cro44818, 0, 0, 0, 0, 2, 0, Zer74488), 
LMin64228 = minimum_layer([[[[[[0.7243], [0.698]]]]], [[[[[0.1808], [0.4483]]]]]], Min64228), 
LZer62013 = zero_padding3D_layer(Min64228, 2, 0, 0, 0, 1, 0, Zer62013), 
LCon6454 = concatenate_layer([Zer62013,[[[[[0.4871, 0.2768, 0.9415], [0.8294, 0.4864, 0.9246], [0.4827, 0.9955, 0.9501]]], [[[0.5677, 0.3226, 0.2827], [0.4588, 0.244, 0.6025], [0.827, 0.0454, 0.9418]]], [[[0.6492, 0.903, 0.2883], [0.9359, 0.1741, 0.8309], [0.983, 0.9033, 0.6268]]]]]], 4, Con6454), 
LAdd66980 = add_layer([Zer74488,Con6454], Add66980), 
LRes79352 = reshape_layer(Add66980, [3, 1, 12], Res79352), 
LCon29388 = conv2D_layer(Res79352, 1, 1,[[[[0.8548, 0.9207], [0.415, 0.0478], [0.3378, 0.2616], [0.0075, 0.3481], [0.6086, 0.2961], [0.0034, 0.8485], [0.8825, 0.0051], [0.7078, 0.9072], [0.1492, 0.6183], [0.0737, 0.1616], [0.5019, 0.9351], [0.0801, 0.5147]]]],[0, 0], 1, 1, false, 1, 1, Con29388), 
LMax83120 = maximum_layer([Con16307,Con29388], Max83120), 
LMin53562 = minimum_layer([Zer48749,Max83120], Min53562), 
exec_layers([LMul97901,LELU10108,LZer48749,LGlo58222,LRes43604,LRes89317,LZer56798,LCon16307,LCro44818,LZer74488,LMin64228,LZer62013,LCon6454,LAdd66980,LRes79352,LCon29388,LMax83120,LMin53562],["Mul97901","ELU10108","Zer48749","Glo58222","Res43604","Res89317","Zer56798","Con16307","Cro44818","Zer74488","Min64228","Zer62013","Con6454","Add66980","Res79352","Con29388","Max83120","Min53562"],Min53562,"Min53562")

Actual (Unparsed): [[[[0.0000000, 0.0000000]], [[0.3148363, 0.4626715]], [[0.1324735, 0.5504856]]]]

Expected (Unparsed): [[[[0,0]],[[0.3148363,0.46267155000000004]],[[0.13247346000000002,0.5504856]]]]

Actual:   [[[[0, 0]], [[0.3149, 0.4627]], [[0.1325, 0.5505]]]]

Expected: [[[[0, 0]], [[0.3149, 0.4627]], [[0.1325, 0.5505]]]]