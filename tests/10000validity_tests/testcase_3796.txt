import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub69629 = tf.keras.layers.Input(shape=([2, 2, 3]))
in1Sub69629 = tf.keras.layers.Input(shape=([2, 2, 3]))
in0Min11332 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Min11332 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Con76823 = tf.keras.layers.Input(shape=([6, 1, 3, 1]))
in0PRe34246 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Sub69629 = keras.layers.Subtract(name = 'Sub69629', )([in0Sub69629,in1Sub69629])
Res88223 = keras.layers.Reshape((2, 6), name = 'Res88223', )(Sub69629)
Thr41890 = keras.layers.ThresholdedReLU(theta=9.545069337395475, name = 'Thr41890', )(Res88223)
Min11332 = keras.layers.Minimum(name = 'Min11332', )([in0Min11332,in1Min11332])
Res17588 = keras.layers.Reshape((2, 1, 1), name = 'Res17588', )(Min11332)
Res90582 = keras.layers.Reshape((2, 1), name = 'Res90582', )(Res17588)
Dot81555 = keras.layers.Dot(axes=(1, 1), name = 'Dot81555', )([Thr41890,Res90582])
Res36412 = keras.layers.Reshape((6, 1, 1), name = 'Res36412', )(Dot81555)
Res11914 = keras.layers.Reshape((6, 1, 1, 1), name = 'Res11914', )(Res36412)
Zer25166 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer25166', )(Res11914)
Con76823 = keras.layers.Concatenate(axis=4, name = 'Con76823', )([Zer25166,in0Con76823])
PRe34246 = keras.layers.PReLU(name = 'PRe34246', input_shape=(2, 1, 2, 2))(in0PRe34246)
Zer11283 = keras.layers.ZeroPadding3D(padding=((4, 0), (0, 0), (1, 0)), name = 'Zer11283', )(PRe34246)
Ave60795 = keras.layers.Average(name = 'Ave60795', )([Con76823,Zer11283])
model = tf.keras.models.Model(inputs=[in0Sub69629,in1Sub69629,in0Min11332,in1Min11332,in0Con76823,in0PRe34246], outputs=Ave60795)
w = model.get_layer('PRe34246').get_weights() 
w[0] = np.array([[[[0.5427, 0.7121], [0.3824, 0.4653]]], [[[0.4694, 0.292], [0.3186, 0.1975]]]])
model.get_layer('PRe34246').set_weights(w) 
in0Sub69629 = tf.constant([[[[0.2049, 0.8543, 0.5019], [0.4064, 0.9649, 0.1939]], [[0.2259, 0.4311, 0.3949], [0.1008, 0.5703, 0.3664]]]])
in1Sub69629 = tf.constant([[[[0.2235, 0.7678, 0.6711], [0.2952, 0.0306, 0.1583]], [[0.0699, 0.007, 0.1237], [0.1094, 0.0634, 0.1352]]]])
in0Min11332 = tf.constant([[[[[0.2393]]], [[[0.9694]]]]])
in1Min11332 = tf.constant([[[[[0.2459]]], [[[0.8562]]]]])
in0Con76823 = tf.constant([[[[[0.4411], [0.5363], [0.6994]]], [[[0.5812], [0.2949], [0.7419]]], [[[0.2036], [0.4932], [0.1301]]], [[[0.9043], [0.135], [0.6944]]], [[[0.5528], [0.7612], [0.6712]]], [[[0.031], [0.1375], [0.4589]]]]])
in0PRe34246 = tf.constant([[[[[0.5734, 0.5682], [0.5739, 0.77]]], [[[0.8794, 0.2376], [0.6461, 0.6378]]]]])
print (np.array2string(model.predict([in0Sub69629,in1Sub69629,in0Min11332,in1Min11332,in0Con76823,in0PRe34246],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave60795.png')

LSub69629 = subtract_layer([[[[0.2049, 0.8543, 0.5019], [0.4064, 0.9649, 0.1939]], [[0.2259, 0.4311, 0.3949], [0.1008, 0.5703, 0.3664]]]], [[[[0.2235, 0.7678, 0.6711], [0.2952, 0.0306, 0.1583]], [[0.0699, 0.007, 0.1237], [0.1094, 0.0634, 0.1352]]]], Sub69629), 
LRes88223 = reshape_layer(Sub69629, [2, 6], Res88223), 
LThr41890 = thresholded_relu_layer(Res88223, 9.545069337395475, Thr41890), 
LMin11332 = minimum_layer([[[[[[0.2393]]], [[[0.9694]]]]], [[[[[0.2459]]], [[[0.8562]]]]]], Min11332), 
LRes17588 = reshape_layer(Min11332, [2, 1, 1], Res17588), 
LRes90582 = reshape_layer(Res17588, [2, 1], Res90582), 
LDot81555 = dot_layer(Thr41890,Res90582, 1, 1, Dot81555), 
LRes36412 = reshape_layer(Dot81555, [6, 1, 1], Res36412), 
LRes11914 = reshape_layer(Res36412, [6, 1, 1, 1], Res11914), 
LZer25166 = zero_padding3D_layer(Res11914, 0, 0, 0, 0, 2, 0, Zer25166), 
LCon76823 = concatenate_layer([Zer25166,[[[[[0.4411], [0.5363], [0.6994]]], [[[0.5812], [0.2949], [0.7419]]], [[[0.2036], [0.4932], [0.1301]]], [[[0.9043], [0.135], [0.6944]]], [[[0.5528], [0.7612], [0.6712]]], [[[0.031], [0.1375], [0.4589]]]]]], 4, Con76823), 
LPRe34246 = prelu_layer([[[[[0.5734, 0.5682], [0.5739, 0.77]]], [[[0.8794, 0.2376], [0.6461, 0.6378]]]]], [[[[0.5427, 0.7121], [0.3824, 0.4653]]], [[[0.4694, 0.292], [0.3186, 0.1975]]]], PRe34246), 
LZer11283 = zero_padding3D_layer(PRe34246, 4, 0, 0, 0, 1, 0, Zer11283), 
LAve60795 = average_layer([Con76823,Zer11283], Ave60795), 
exec_layers([LSub69629,LRes88223,LThr41890,LMin11332,LRes17588,LRes90582,LDot81555,LRes36412,LRes11914,LZer25166,LCon76823,LPRe34246,LZer11283,LAve60795],["Sub69629","Res88223","Thr41890","Min11332","Res17588","Res90582","Dot81555","Res36412","Res11914","Zer25166","Con76823","PRe34246","Zer11283","Ave60795"],Ave60795,"Ave60795")

Actual (Unparsed): [[[[[0.0000000, 0.2205500], [0.0000000, 0.2681500], [0.0000000, 0.3497000]]], [[[0.0000000, 0.2906000], [0.0000000, 0.1474500], [0.0000000, 0.3709500]]], [[[0.0000000, 0.1018000], [0.0000000, 0.2466000], [0.0000000, 0.0650500]]], [[[0.0000000, 0.4521500], [0.0000000, 0.0675000], [0.0000000, 0.3472000]]], [[[0.0000000, 0.2764000], [0.2867000, 0.6647000], [0.2869500, 0.7206000]]], [[[0.0000000, 0.0155000], [0.4397000, 0.1875500], [0.3230500, 0.5483500]]]]]

Expected (Unparsed): [[[[[0,0.22055],[0,0.26815],[0.0,0.3497]]],[[[0,0.2906],[0,0.14745],[0.0,0.37095]]],[[[0,0.1018],[0,0.2466],[0.0,0.06505]]],[[[0,0.45215],[0,0.0675],[0.0,0.3472]]],[[[0,0.2764],[0.2867,0.6647000000000001],[0.28695,0.7206]]],[[[0,0.0155],[0.4397,0.18755],[0.32305,0.54835]]]]]

Actual:   [[[[[0, 0.2206], [0, 0.2682], [0, 0.3497]]], [[[0, 0.2906], [0, 0.1475], [0, 0.371]]], [[[0, 0.1018], [0, 0.2466], [0, 0.0651]]], [[[0, 0.4522], [0, 0.0675], [0, 0.3472]]], [[[0, 0.2764], [0.2867, 0.6647], [0.287, 0.7206]]], [[[0, 0.0155], [0.4397, 0.1876], [0.3231, 0.5484]]]]]

Expected: [[[[[0, 0.2206], [0, 0.2682], [0, 0.3497]]], [[[0, 0.2906], [0, 0.1475], [0, 0.371]]], [[[0, 0.1018], [0, 0.2466], [0, 0.0651]]], [[[0, 0.4522], [0, 0.0675], [0, 0.3472]]], [[[0, 0.2764], [0.2867, 0.6648], [0.287, 0.7206]]], [[[0, 0.0155], [0.4397, 0.1876], [0.3231, 0.5484]]]]]