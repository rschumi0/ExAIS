import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay90912 = tf.keras.layers.Input(shape=([1, 3, 2]))
in0Glo80216 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con36505 = tf.keras.layers.Input(shape=([4]))

Lay90912 = keras.layers.LayerNormalization(axis=1, epsilon=1.8288278199129304, name = 'Lay90912', )(in0Lay90912)
Res37760 = keras.layers.Reshape((1, 6), name = 'Res37760', )(Lay90912)
Fla36017 = keras.layers.Flatten(name = 'Fla36017', )(Res37760)
Glo80216 = keras.layers.GlobalAveragePooling2D(name = 'Glo80216', )(in0Glo80216)
Res37783 = keras.layers.Reshape((2, 1), name = 'Res37783', )(Glo80216)
Sim98663 = keras.layers.SimpleRNN(2,name = 'Sim98663', )(Res37783)
Con36505 = keras.layers.Concatenate(axis=1, name = 'Con36505', )([Sim98663,in0Con36505])
Sub35729 = keras.layers.Subtract(name = 'Sub35729', )([Fla36017,Con36505])
Res13689 = keras.layers.Reshape((6, 1), name = 'Res13689', )(Sub35729)
Sep96147 = keras.layers.SeparableConv1D(2, (6),strides=(5), padding='valid', name = 'Sep96147', )(Res13689)
Fla69088 = keras.layers.Flatten(name = 'Fla69088', )(Sep96147)
model = tf.keras.models.Model(inputs=[in0Lay90912,in0Glo80216,in0Con36505], outputs=Fla69088)
w = model.get_layer('Sim98663').get_weights() 
w[0] = np.array([[4, 7]])
w[1] = np.array([[6, 5], [4, 9]])
w[2] = np.array([1, 2])
model.get_layer('Sim98663').set_weights(w) 
w = model.get_layer('Sep96147').get_weights() 
w[0] = np.array([[[0.5456]], [[0.5542]], [[0.4029]], [[0.705]], [[0.2112]], [[0.8136]]])
w[1] = np.array([[[0.6266, 0.393]]])
w[2] = np.array([0, 0])
model.get_layer('Sep96147').set_weights(w) 
in0Lay90912 = tf.constant([[[[1.1229, 1.6364], [1.3332, 1.8269], [1.0628, 1.0509]]]])
in0Glo80216 = tf.constant([[[[1.4255, 1.2155]]]])
in0Con36505 = tf.constant([[0.4701, 0.8155, 0.8307, 0.5494]])
print (np.array2string(model.predict([in0Lay90912,in0Glo80216,in0Con36505],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla69088.png')

LLay90912 = layer_normalization_layer([[[[1.1229, 1.6364], [1.3332, 1.8269], [1.0628, 1.0509]]]], 1, 1.8288278199129304, Lay90912), 
LRes37760 = reshape_layer(Lay90912, [1, 6], Res37760), 
LFla36017 = flatten_layer(Res37760, Fla36017), 
LGlo80216 = global_average_pooling2D_layer([[[[1.4255, 1.2155]]]], Glo80216), 
LRes37783 = reshape_layer(Glo80216, [2, 1], Res37783), 
LSim98663 = simple_rnn_layer(Res37783,[[4, 7]],[[6, 5], [4, 9]],[1, 2], Sim98663), 
LCon36505 = concatenate_layer([Sim98663,[[0.4701, 0.8155, 0.8307, 0.5494]]], 1, Con36505), 
LSub35729 = subtract_layer(Fla36017,Con36505, Sub35729), 
LRes13689 = reshape_layer(Sub35729, [6, 1], Res13689), 
LSep96147 = separable_conv1D_layer(Res13689, 6,[[[[0.5456]], [[0.5542]], [[0.4029]], [[0.705]], [[0.2112]], [[0.8136]]],[[[0.6266, 0.393]]]],[0, 0], 5, false, Sep96147), 
LFla69088 = flatten_layer(Sep96147, Fla69088), 
exec_layers([LLay90912,LRes37760,LFla36017,LGlo80216,LRes37783,LSim98663,LCon36505,LSub35729,LRes13689,LSep96147,LFla69088],["Lay90912","Res37760","Fla36017","Glo80216","Res37783","Sim98663","Con36505","Sub35729","Res13689","Sep96147","Fla69088"],Fla69088,"Fla69088")

Actual (Unparsed): [[-1.5580825, -0.9772206]]

Expected (Unparsed): [[-1.5580825501019886,-0.9772206227099929]]

Actual:   [[-1.558, -0.9772]]

Expected: [[-1.558, -0.9772]]