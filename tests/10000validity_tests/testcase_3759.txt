import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro91414 = tf.keras.layers.Input(shape=([1, 3, 3, 1]))
in0Con96503 = tf.keras.layers.Input(shape=([1, 24]))
in0Zer31359 = tf.keras.layers.Input(shape=([4, 3, 3, 1]))

Cro91414 = keras.layers.Cropping3D(cropping=((0, 0), (1, 1), (0, 1)), name = 'Cro91414', )(in0Cro91414)
Glo2377 = keras.layers.GlobalMaxPool3D(name = 'Glo2377', )(Cro91414)
Res30560 = keras.layers.Reshape((1, 1), name = 'Res30560', )(Glo2377)
Cro6399 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro6399', )(Res30560)
Con96503 = keras.layers.Concatenate(axis=2, name = 'Con96503', )([Cro6399,in0Con96503])
Zer31359 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer31359', )(in0Zer31359)
Res23729 = keras.layers.Reshape((6, 5, 5), name = 'Res23729', )(Zer31359)
Res90499 = keras.layers.Reshape((6, 25), name = 'Res90499', )(Res23729)
Dot10924 = keras.layers.Dot(axes=(2, 2), name = 'Dot10924', )([Con96503,Res90499])
Res48080 = keras.layers.Reshape((1, 6, 1), name = 'Res48080', )(Dot10924)
PRe43923 = keras.layers.PReLU(name = 'PRe43923', )(Res48080)
model = tf.keras.models.Model(inputs=[in0Cro91414,in0Con96503,in0Zer31359], outputs=PRe43923)
w = model.get_layer('PRe43923').get_weights() 
w[0] = np.array([[[0.1059], [0.9384], [0.218], [0.16], [0.2202], [0.2497]]])
model.get_layer('PRe43923').set_weights(w) 
in0Cro91414 = tf.constant([[[[[1.8254], [1.8902], [1.0041]], [[1.3512], [1.9672], [1.02]], [[1.105], [1.9683], [1.3242]]]]])
in0Con96503 = tf.constant([[[0.9474, 0.2814, 0.6424, 0.1986, 0.9352, 0.5098, 0.2798, 0.1048, 0.5423, 0.5273, 0.6761, 0.6416, 0.6948, 0.1558, 0.0153, 0.6039, 0.0371, 0.9842, 0.2446, 0.2181, 0.5742, 0.8391, 0.2382, 0.8882]]])
in0Zer31359 = tf.constant([[[[[1.7006], [1.0563], [1.5127]], [[1.0211], [1.0881], [1.348]], [[1.1578], [1.8481], [1.9301]]], [[[1.9541], [1.8295], [1.9246]], [[1.7922], [1.9096], [1.2508]], [[1.0053], [1.9459], [1.335]]], [[[1.674], [1.8686], [1.9851]], [[1.2616], [1.0566], [1.6298]], [[1.4981], [1.2875], [1.5843]]], [[[1.0108], [1.4077], [1.0444]], [[1.1265], [1.5711], [1.9202]], [[1.6952], [1.4214], [1.6498]]]]])
print (np.array2string(model.predict([in0Cro91414,in0Con96503,in0Zer31359],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe43923.png')

LCro91414 = cropping3D_layer([[[[[1.8254], [1.8902], [1.0041]], [[1.3512], [1.9672], [1.02]], [[1.105], [1.9683], [1.3242]]]]], 0, 0, 1, 1, 0, 1, Cro91414), 
LGlo2377 = global_max_pool3D_layer(Cro91414, Glo2377), 
LRes30560 = reshape_layer(Glo2377, [1, 1], Res30560), 
LCro6399 = cropping1D_layer(Res30560, 0, 0, Cro6399), 
LCon96503 = concatenate_layer([Cro6399,[[[0.9474, 0.2814, 0.6424, 0.1986, 0.9352, 0.5098, 0.2798, 0.1048, 0.5423, 0.5273, 0.6761, 0.6416, 0.6948, 0.1558, 0.0153, 0.6039, 0.0371, 0.9842, 0.2446, 0.2181, 0.5742, 0.8391, 0.2382, 0.8882]]]], 2, Con96503), 
LZer31359 = zero_padding3D_layer([[[[[1.7006], [1.0563], [1.5127]], [[1.0211], [1.0881], [1.348]], [[1.1578], [1.8481], [1.9301]]], [[[1.9541], [1.8295], [1.9246]], [[1.7922], [1.9096], [1.2508]], [[1.0053], [1.9459], [1.335]]], [[[1.674], [1.8686], [1.9851]], [[1.2616], [1.0566], [1.6298]], [[1.4981], [1.2875], [1.5843]]], [[[1.0108], [1.4077], [1.0444]], [[1.1265], [1.5711], [1.9202]], [[1.6952], [1.4214], [1.6498]]]]], 1, 1, 1, 1, 1, 1, Zer31359), 
LRes23729 = reshape_layer(Zer31359, [6, 5, 5], Res23729), 
LRes90499 = reshape_layer(Res23729, [6, 25], Res90499), 
LDot10924 = dot_layer(Con96503,Res90499, 2, 2, Dot10924), 
LRes48080 = reshape_layer(Dot10924, [1, 6, 1], Res48080), 
LPRe43923 = prelu_layer(Res48080, [[[0.1059], [0.9384], [0.218], [0.16], [0.2202], [0.2497]]], PRe43923), 
exec_layers([LCro91414,LGlo2377,LRes30560,LCro6399,LCon96503,LZer31359,LRes23729,LRes90499,LDot10924,LRes48080,LPRe43923],["Cro91414","Glo2377","Res30560","Cro6399","Con96503","Zer31359","Res23729","Res90499","Dot10924","Res48080","PRe43923"],PRe43923,"PRe43923")

Actual (Unparsed): [[[[0.0000000], [6.3134951], [7.0089547], [6.7592824], [6.8226312], [0.0000000]]]]

Expected (Unparsed): [[[[0.0],[6.313495],[7.0089545399999995],[6.75928222],[6.822631169999999],[0.0]]]]

Actual:   [[[[0], [6.3135], [7.009], [6.7593], [6.8227], [0]]]]

Expected: [[[[0], [6.3135], [7.009], [6.7593], [6.8227], [0]]]]