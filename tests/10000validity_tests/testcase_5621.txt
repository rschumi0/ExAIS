import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub53808 = tf.keras.layers.Input(shape=([2]))
in1Sub53808 = tf.keras.layers.Input(shape=([2]))
in0Con65129 = tf.keras.layers.Input(shape=([3, 1]))
in0Sub49609 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub49609 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot45519 = tf.keras.layers.Input(shape=([3]))
in1Dot45519 = tf.keras.layers.Input(shape=([3]))
in0Con37076 = tf.keras.layers.Input(shape=([5]))

Sub53808 = keras.layers.Subtract(name = 'Sub53808', )([in0Sub53808,in1Sub53808])
Res34085 = keras.layers.Reshape((2, 1), name = 'Res34085', )(Sub53808)
Zer30041 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer30041', )(Res34085)
Con65129 = keras.layers.Concatenate(axis=2, name = 'Con65129', )([Zer30041,in0Con65129])
Sub49609 = keras.layers.Subtract(name = 'Sub49609', )([in0Sub49609,in1Sub49609])
Add12056 = keras.layers.Add(name = 'Add12056', )([Con65129,Sub49609])
Fla7608 = keras.layers.Flatten(name = 'Fla7608', )(Add12056)
Dot45519 = keras.layers.Dot(axes=(1, 1), name = 'Dot45519', )([in0Dot45519,in1Dot45519])
Res66469 = keras.layers.Reshape((1, 1), name = 'Res66469', )(Dot45519)
Res27343 = keras.layers.Reshape((1, 1, 1), name = 'Res27343', )(Res66469)
Glo77978 = keras.layers.GlobalMaxPool2D(name = 'Glo77978', )(Res27343)
Con37076 = keras.layers.Concatenate(axis=1, name = 'Con37076', )([Glo77978,in0Con37076])
Ave53687 = keras.layers.Average(name = 'Ave53687', )([Fla7608,Con37076])
model = tf.keras.models.Model(inputs=[in0Sub53808,in1Sub53808,in0Con65129,in0Sub49609,in1Sub49609,in0Dot45519,in1Dot45519,in0Con37076], outputs=Ave53687)
in0Sub53808 = tf.constant([[0.9041, 0.5243]])
in1Sub53808 = tf.constant([[0.2646, 0.4557]])
in0Con65129 = tf.constant([[[0.4502], [0.5556], [0.0193]]])
in0Sub49609 = tf.constant([[[0.1156, 0.9492], [0.2616, 0.1698], [0.8148, 0.881]]])
in1Sub49609 = tf.constant([[[0.7858, 0.0453], [0.3221, 0.9851], [0.6081, 0.5919]]])
in0Dot45519 = tf.constant([[0.1233, 0.6372, 0.5271]])
in1Dot45519 = tf.constant([[0.1867, 0.7571, 0.455]])
in0Con37076 = tf.constant([[0.0572, 0.8821, 0.1713, 0.8877, 0.154]])
print (np.array2string(model.predict([in0Sub53808,in1Sub53808,in0Con65129,in0Sub49609,in1Sub49609,in0Dot45519,in1Dot45519,in0Con37076],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave53687.png')

LSub53808 = subtract_layer([[0.9041, 0.5243]], [[0.2646, 0.4557]], Sub53808), 
LRes34085 = reshape_layer(Sub53808, [2, 1], Res34085), 
LZer30041 = zero_padding1D_layer(Res34085, 1, 0, Zer30041), 
LCon65129 = concatenate_layer([Zer30041,[[[0.4502], [0.5556], [0.0193]]]], 2, Con65129), 
LSub49609 = subtract_layer([[[0.1156, 0.9492], [0.2616, 0.1698], [0.8148, 0.881]]], [[[0.7858, 0.0453], [0.3221, 0.9851], [0.6081, 0.5919]]], Sub49609), 
LAdd12056 = add_layer([Con65129,Sub49609], Add12056), 
LFla7608 = flatten_layer(Add12056, Fla7608), 
LDot45519 = dot_layer([[0.1233, 0.6372, 0.5271]], [[0.1867, 0.7571, 0.455]], 1, 1, Dot45519), 
LRes66469 = reshape_layer(Dot45519, [1, 1], Res66469), 
LRes27343 = reshape_layer(Res66469, [1, 1, 1], Res27343), 
LGlo77978 = global_max_pool2D_layer(Res27343, Glo77978), 
LCon37076 = concatenate_layer([Glo77978,[[0.0572, 0.8821, 0.1713, 0.8877, 0.154]]], 1, Con37076), 
LAve53687 = average_layer([Fla7608,Con37076], Ave53687), 
exec_layers([LSub53808,LRes34085,LZer30041,LCon65129,LSub49609,LAdd12056,LFla7608,LDot45519,LRes66469,LRes27343,LGlo77978,LCon37076,LAve53687],["Sub53808","Res34085","Zer30041","Con65129","Sub49609","Add12056","Fla7608","Dot45519","Res66469","Res27343","Glo77978","Con37076","Ave53687"],Ave53687,"Ave53687")

Actual (Unparsed): [[0.0375374, 0.7056500, 0.7305500, -0.0442000, 0.5815000, 0.2312000]]

Expected (Unparsed): [[0.03753736499999999,0.70565,0.73055,-0.04419999999999996,0.5815,0.23120000000000002]]

Actual:   [[0.0376, 0.7057, 0.7306, -0.0442, 0.5815, 0.2312]]

Expected: [[0.0376, 0.7057, 0.7306, -0.0441, 0.5815, 0.2313]]