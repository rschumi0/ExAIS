import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo27328 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Max37446 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max37446 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con34914 = tf.keras.layers.Input(shape=([2, 2]))

Glo27328 = keras.layers.GlobalMaxPool2D(name = 'Glo27328', )(in0Glo27328)
Res88916 = keras.layers.Reshape((2, 1), name = 'Res88916', )(Glo27328)
Res23577 = keras.layers.Reshape((2, 1, 1), name = 'Res23577', )(Res88916)
Res46571 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res46571', )(Res23577)
Con51056 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con51056', )(Res46571)
Res28025 = keras.layers.Reshape((2, 1, 4), name = 'Res28025', )(Con51056)
Res7296 = keras.layers.Reshape((2, 4), name = 'Res7296', )(Res28025)
Max37446 = keras.layers.Maximum(name = 'Max37446', )([in0Max37446,in1Max37446])
Res42048 = keras.layers.Reshape((2, 2), name = 'Res42048', )(Max37446)
Cro12616 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro12616', )(Res42048)
Sof13598 = keras.layers.Softmax(axis=1, name = 'Sof13598', )(Cro12616)
Con34914 = keras.layers.Concatenate(axis=2, name = 'Con34914', )([Sof13598,in0Con34914])
Max41865 = keras.layers.Maximum(name = 'Max41865', )([Res7296,Con34914])
Res66679 = keras.layers.Reshape((2, 4, 1), name = 'Res66679', )(Max41865)
Glo90804 = keras.layers.GlobalMaxPool2D(name = 'Glo90804', )(Res66679)
model = tf.keras.models.Model(inputs=[in0Glo27328,in0Max37446,in1Max37446,in0Con34914], outputs=Glo90804)
w = model.get_layer('Con51056').get_weights() 
w[0] = np.array([[[[[0.3137, 0.6562, 0.3738, 0.8658]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con51056').set_weights(w) 
in0Glo27328 = tf.constant([[[[1.5176, 1.3122], [1.3042, 1.0274]], [[1.6576, 1.3134], [1.6796, 1.5296]]]])
in0Max37446 = tf.constant([[[[0.0758], [0.9111]], [[0.0474], [0.8324]]]])
in1Max37446 = tf.constant([[[[0.406], [0.2675]], [[0.5084], [0.0807]]]])
in0Con34914 = tf.constant([[[0.9102, 0.7504], [0.539, 0.2517]]])
print (np.array2string(model.predict([in0Glo27328,in0Max37446,in1Max37446,in0Con34914],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo90804.png')

LGlo27328 = global_max_pool2D_layer([[[[1.5176, 1.3122], [1.3042, 1.0274]], [[1.6576, 1.3134], [1.6796, 1.5296]]]], Glo27328), 
LRes88916 = reshape_layer(Glo27328, [2, 1], Res88916), 
LRes23577 = reshape_layer(Res88916, [2, 1, 1], Res23577), 
LRes46571 = reshape_layer(Res23577, [2, 1, 1, 1], Res46571), 
LCon51056 = conv3D_layer(Res46571, 1, 1, 1,[[[[[0.3137, 0.6562, 0.3738, 0.8658]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con51056), 
LRes28025 = reshape_layer(Con51056, [2, 1, 4], Res28025), 
LRes7296 = reshape_layer(Res28025, [2, 4], Res7296), 
LMax37446 = maximum_layer([[[[[0.0758], [0.9111]], [[0.0474], [0.8324]]]], [[[[0.406], [0.2675]], [[0.5084], [0.0807]]]]], Max37446), 
LRes42048 = reshape_layer(Max37446, [2, 2], Res42048), 
LCro12616 = cropping1D_layer(Res42048, 0, 0, Cro12616), 
LSof13598 = softmax_layer(Cro12616, 1, Sof13598), 
LCon34914 = concatenate_layer([Sof13598,[[[0.9102, 0.7504], [0.539, 0.2517]]]], 2, Con34914), 
LMax41865 = maximum_layer([Res7296,Con34914], Max41865), 
LRes66679 = reshape_layer(Max41865, [2, 4, 1], Res66679), 
LGlo90804 = global_max_pool2D_layer(Res66679, Glo90804), 
exec_layers([LGlo27328,LRes88916,LRes23577,LRes46571,LCon51056,LRes28025,LRes7296,LMax37446,LRes42048,LCro12616,LSof13598,LCon34914,LMax41865,LRes66679,LGlo90804],["Glo27328","Res88916","Res23577","Res46571","Con51056","Res28025","Res7296","Max37446","Res42048","Cro12616","Sof13598","Con34914","Max41865","Res66679","Glo90804"],Glo90804,"Glo90804")

Actual (Unparsed): [[1.4541977]]

Expected (Unparsed): [[1.45419768]]

Actual:   [[1.4542]]

Expected: [[1.4542]]