import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den86280 = tf.keras.layers.Input(shape=([4, 5]))
in0Con95243 = tf.keras.layers.Input(shape=([4, 8]))
in0Sub67104 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))
in1Sub67104 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))
in0Dot5126 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot5126 = tf.keras.layers.Input(shape=([3, 3]))
in0Con21020 = tf.keras.layers.Input(shape=([3, 9]))

Den86280 = keras.layers.Dense(4,name = 'Den86280', )(in0Den86280)
Con95243 = keras.layers.Concatenate(axis=2, name = 'Con95243', )([Den86280,in0Con95243])
Sub67104 = keras.layers.Subtract(name = 'Sub67104', )([in0Sub67104,in1Sub67104])
Res6699 = keras.layers.Reshape((2, 3, 4), name = 'Res6699', )(Sub67104)
Res40792 = keras.layers.Reshape((2, 12), name = 'Res40792', )(Res6699)
Zer86526 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer86526', )(Res40792)
Dot5126 = keras.layers.Dot(axes=(1, 1), name = 'Dot5126', )([in0Dot5126,in1Dot5126])
Con21020 = keras.layers.Concatenate(axis=2, name = 'Con21020', )([Dot5126,in0Con21020])
Ave80118 = keras.layers.Average(name = 'Ave80118', )([Zer86526,Con21020])
Zer74460 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer74460', )(Ave80118)
Max53654 = keras.layers.Maximum(name = 'Max53654', )([Con95243,Zer74460])
ELU75584 = keras.layers.ELU(alpha=6.583334778731398, name = 'ELU75584', )(Max53654)
model = tf.keras.models.Model(inputs=[in0Den86280,in0Con95243,in0Sub67104,in1Sub67104,in0Dot5126,in1Dot5126,in0Con21020], outputs=ELU75584)
w = model.get_layer('Den86280').get_weights() 
w[0] = np.array([[0.0624, 0.6918, 0.1099, 0.2291], [0.9197, 0.6047, 0.1494, 0.612], [0.6713, 0.6313, 0.0393, 0.7662], [0.5427, 0.1696, 0.2352, 0.4193], [0.7871, 0.6553, 0.9891, 0.4786]])
w[1] = np.array([0.8228, 0.8198, 0.6609, 0.1257])
model.get_layer('Den86280').set_weights(w) 
in0Den86280 = tf.constant([[[0.0529, 0.2729, 0.5032, 0.9489, 0.3535], [0.7029, 0.0012, 0.5772, 0.7281, 0.6292], [0.5564, 0.5505, 0.8071, 0.2299, 0.7231], [0.4164, 0.4093, 0.4728, 0.2615, 0.2341]]])
in0Con95243 = tf.constant([[[0.4942, 0.2591, 0.1713, 0.7974, 0.8036, 0.0225, 0.4683, 0.7199], [0.7464, 0.4362, 0.214, 0.6052, 0.8153, 0.3203, 0.0815, 0.6774], [0.9539, 0.7474, 0.6971, 0.2854, 0.9259, 0.9742, 0.9679, 0.0995], [0.6756, 0.1948, 0.8999, 0.0503, 0.3228, 0.092, 0.391, 0.0842]]])
in0Sub67104 = tf.constant([[[[[0.2881, 0.9263], [0.7419, 0.0067]], [[0.2281, 0.2869], [0.5565, 0.2582]], [[0.664, 0.6817], [0.7412, 0.1088]]], [[[0.493, 0.493], [0.2084, 0.7185]], [[0.9038, 0.0526], [0.3509, 0.8996]], [[0.8547, 0.0577], [0.487, 0.028]]]]])
in1Sub67104 = tf.constant([[[[[0.3, 0.9709], [0.2885, 0.1259]], [[0.3855, 0.986], [0.1551, 0.1314]], [[0.6125, 0.3626], [0.484, 0.9239]]], [[[0.4032, 0.0636], [0.9187, 0.6307]], [[0.5931, 0.6669], [0.955, 0.1065]], [[0.1217, 0.4617], [0.7336, 0.2461]]]]])
in0Dot5126 = tf.constant([[[0.5959, 0.4931, 0.4545], [0.9679, 0.4613, 0.0683], [0.6107, 0.2898, 0.2319]]])
in1Dot5126 = tf.constant([[[0.9039, 0.1587, 0.907], [0.5994, 0.6577, 0.8165], [0.077, 0.2745, 0.0628]]])
in0Con21020 = tf.constant([[[0.3604, 0.8145, 0.8418, 0.5983, 0.4717, 0.1575, 0.4415, 0.0503, 0.1675], [0.4787, 0.6496, 0.8418, 0.6314, 0.1266, 0.3294, 0.2494, 0.6458, 0.6683], [0.4144, 0.2443, 0.4877, 0.1557, 0.2394, 0.7866, 0.2427, 0.6802, 0.6602]]])
print (np.array2string(model.predict([in0Den86280,in0Con95243,in0Sub67104,in1Sub67104,in0Dot5126,in1Dot5126,in0Con21020],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU75584.png')

LDen86280 = dense_layer([[[0.0529, 0.2729, 0.5032, 0.9489, 0.3535], [0.7029, 0.0012, 0.5772, 0.7281, 0.6292], [0.5564, 0.5505, 0.8071, 0.2299, 0.7231], [0.4164, 0.4093, 0.4728, 0.2615, 0.2341]]], [[0.0624, 0.6918, 0.1099, 0.2291], [0.9197, 0.6047, 0.1494, 0.612], [0.6713, 0.6313, 0.0393, 0.7662], [0.5427, 0.1696, 0.2352, 0.4193], [0.7871, 0.6553, 0.9891, 0.4786]],[0.8228, 0.8198, 0.6609, 0.1257], Den86280), 
LCon95243 = concatenate_layer([Den86280,[[[0.4942, 0.2591, 0.1713, 0.7974, 0.8036, 0.0225, 0.4683, 0.7199], [0.7464, 0.4362, 0.214, 0.6052, 0.8153, 0.3203, 0.0815, 0.6774], [0.9539, 0.7474, 0.6971, 0.2854, 0.9259, 0.9742, 0.9679, 0.0995], [0.6756, 0.1948, 0.8999, 0.0503, 0.3228, 0.092, 0.391, 0.0842]]]], 2, Con95243), 
LSub67104 = subtract_layer([[[[[0.2881, 0.9263], [0.7419, 0.0067]], [[0.2281, 0.2869], [0.5565, 0.2582]], [[0.664, 0.6817], [0.7412, 0.1088]]], [[[0.493, 0.493], [0.2084, 0.7185]], [[0.9038, 0.0526], [0.3509, 0.8996]], [[0.8547, 0.0577], [0.487, 0.028]]]]], [[[[[0.3, 0.9709], [0.2885, 0.1259]], [[0.3855, 0.986], [0.1551, 0.1314]], [[0.6125, 0.3626], [0.484, 0.9239]]], [[[0.4032, 0.0636], [0.9187, 0.6307]], [[0.5931, 0.6669], [0.955, 0.1065]], [[0.1217, 0.4617], [0.7336, 0.2461]]]]], Sub67104), 
LRes6699 = reshape_layer(Sub67104, [2, 3, 4], Res6699), 
LRes40792 = reshape_layer(Res6699, [2, 12], Res40792), 
LZer86526 = zero_padding1D_layer(Res40792, 1, 0, Zer86526), 
LDot5126 = dot_layer([[[0.5959, 0.4931, 0.4545], [0.9679, 0.4613, 0.0683], [0.6107, 0.2898, 0.2319]]], [[[0.9039, 0.1587, 0.907], [0.5994, 0.6577, 0.8165], [0.077, 0.2745, 0.0628]]], 1, 1, Dot5126), 
LCon21020 = concatenate_layer([Dot5126,[[[0.3604, 0.8145, 0.8418, 0.5983, 0.4717, 0.1575, 0.4415, 0.0503, 0.1675], [0.4787, 0.6496, 0.8418, 0.6314, 0.1266, 0.3294, 0.2494, 0.6458, 0.6683], [0.4144, 0.2443, 0.4877, 0.1557, 0.2394, 0.7866, 0.2427, 0.6802, 0.6602]]]], 2, Con21020), 
LAve80118 = average_layer([Zer86526,Con21020], Ave80118), 
LZer74460 = zero_padding1D_layer(Ave80118, 1, 0, Zer74460), 
LMax53654 = maximum_layer([Con95243,Zer74460], Max53654), 
LELU75584 = elu_layer(Max53654, 6.583334778731398, ELU75584), 
exec_layers([LDen86280,LCon95243,LSub67104,LRes6699,LRes40792,LZer86526,LDot5126,LCon21020,LAve80118,LZer74460,LMax53654,LELU75584],["Den86280","Con95243","Sub67104","Res6699","Res40792","Zer86526","Dot5126","Con21020","Ave80118","Zer74460","Max53654","ELU75584"],ELU75584,"ELU75584")

Actual (Unparsed): [[[2.2080931, 1.7316710, 1.3000889, 1.2574449, 0.4942000, 0.2591000, 0.1713000, 0.7974000, 0.8036000, 0.0225000, 0.4683000, 0.7199000], [2.1456221, 2.2069787, 1.5546028, 1.3361469, 0.7464000, 0.4362000, 0.2991500, 0.6052000, 0.8153000, 0.3203000, 0.0815000, 0.6774000], [2.5995392, 2.5599656, 1.6053028, 1.6509500, 0.9539000, 0.7474000, 0.6971000, 0.2854000, 0.9259000, 0.9742000, 0.9679000, 0.0995000], [1.8687834, 1.8516040, 1.0794459, 1.0555354, 0.6756000, 0.1948000, 0.8999000, 0.5162500, 0.7598000, 0.0920000, 0.3910000, 0.2210500]]]

Expected (Unparsed): [[[2.20809313,1.731671,1.3000888599999998,1.2574448999999999,0.4942,0.2591,0.1713,0.7974,0.8036,0.0225,0.4683,0.7199],[2.14562215,2.20697874,1.5546027900000001,1.3361468800000003,0.7464,0.4362,0.29915,0.6052,0.8153,0.3203,0.0815,0.6774],[2.59953918,2.55996557,1.60530278,1.65094999,0.9539,0.7474,0.6971,0.2854,0.9259,0.9742,0.9679,0.0995],[1.86878337,1.8516039999999996,1.07944593,1.05553541,0.6756,0.1948,0.8999,0.51625,0.7598,0.092,0.391,0.22105]]]

Actual:   [[[2.2081, 1.7317, 1.3001, 1.2575, 0.4942, 0.2591, 0.1713, 0.7974, 0.8036, 0.0225, 0.4683, 0.7199], [2.1457, 2.207, 1.5547, 1.3362, 0.7464, 0.4362, 0.2992, 0.6052, 0.8153, 0.3203, 0.0815, 0.6774], [2.5996, 2.56, 1.6054, 1.651, 0.9539, 0.7474, 0.6971, 0.2854, 0.9259, 0.9742, 0.9679, 0.0995], [1.8688, 1.8517, 1.0795, 1.0556, 0.6756, 0.1948, 0.8999, 0.5163, 0.7598, 0.092, 0.391, 0.2211]]]

Expected: [[[2.2081, 1.7317, 1.3001, 1.2575, 0.4942, 0.2591, 0.1713, 0.7974, 0.8036, 0.0225, 0.4683, 0.7199], [2.1457, 2.207, 1.5547, 1.3362, 0.7464, 0.4362, 0.2992, 0.6052, 0.8153, 0.3203, 0.0815, 0.6774], [2.5996, 2.56, 1.6054, 1.651, 0.9539, 0.7474, 0.6971, 0.2854, 0.9259, 0.9742, 0.9679, 0.0995], [1.8688, 1.8517, 1.0795, 1.0556, 0.6756, 0.1948, 0.8999, 0.5163, 0.7598, 0.092, 0.391, 0.2211]]]