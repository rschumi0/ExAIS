import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_51117 = tf.keras.layers.Input(shape=([3, 2, 2]))
in0Min29624 = tf.keras.layers.Input(shape=([2, 2]))
in1Min29624 = tf.keras.layers.Input(shape=([2, 2]))
in0Con90150 = tf.keras.layers.Input(shape=([2, 1]))
in0Add20758 = tf.keras.layers.Input(shape=([1, 2]))
in1Add20758 = tf.keras.layers.Input(shape=([1, 2]))
in0Max89976 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Max89976 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Up_51117 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_51117', )(in0Up_51117)
Lay18455 = keras.layers.LayerNormalization(axis=1, epsilon=2.2480790912890907, name = 'Lay18455', )(Up_51117)
Sep27098 = keras.layers.SeparableConv2D(3, (3, 1),strides=(5, 5), padding='valid', name = 'Sep27098', )(Lay18455)
Res82453 = keras.layers.Reshape((1, 3), name = 'Res82453', )(Sep27098)
Zer35809 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer35809', )(Res82453)
Min29624 = keras.layers.Minimum(name = 'Min29624', )([in0Min29624,in1Min29624])
Con90150 = keras.layers.Concatenate(axis=2, name = 'Con90150', )([Min29624,in0Con90150])
Ave5791 = keras.layers.Average(name = 'Ave5791', )([Zer35809,Con90150])
Res1680 = keras.layers.Reshape((2, 3, 1), name = 'Res1680', )(Ave5791)
Res9186 = keras.layers.Reshape((2, 3, 1, 1), name = 'Res9186', )(Res1680)
Zer84244 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer84244', )(Res9186)
Add20758 = keras.layers.Add(name = 'Add20758', )([in0Add20758,in1Add20758])
ELU60076 = keras.layers.ELU(alpha=3.829274410257602, name = 'ELU60076', )(Add20758)
Res87905 = keras.layers.Reshape((1, 2, 1), name = 'Res87905', )(ELU60076)
Res43899 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res43899', )(Res87905)
Zer39816 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer39816', )(Res43899)
Max89976 = keras.layers.Maximum(name = 'Max89976', )([in0Max89976,in1Max89976])
Sub57020 = keras.layers.Subtract(name = 'Sub57020', )([Zer39816,Max89976])
Zer44279 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer44279', )(Sub57020)
Mul54784 = keras.layers.Multiply(name = 'Mul54784', )([Zer84244,Zer44279])
model = tf.keras.models.Model(inputs=[in0Up_51117,in0Min29624,in1Min29624,in0Con90150,in0Add20758,in1Add20758,in0Max89976,in1Max89976], outputs=Mul54784)
w = model.get_layer('Sep27098').get_weights() 
w[0] = np.array([[[[0.4019], [0.5094]]], [[[0.561], [0.4646]]], [[[0.0003], [0.1461]]]])
w[1] = np.array([[[[0.7662, 0.2917, 0.6166], [0.2692, 0.2841, 0.878]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep27098').set_weights(w) 
in0Up_51117 = tf.constant([[[[1.8602, 1.8698], [1.8964, 1.654]], [[1.8319, 1.7509], [1.0777, 1.578]], [[1.6731, 1.7083], [1.9389, 1.226]]]])
in0Min29624 = tf.constant([[[0.8844, 0.8846], [0.7211, 0.2058]]])
in1Min29624 = tf.constant([[[0.421, 0.3121], [0.7495, 0.8593]]])
in0Con90150 = tf.constant([[[0.8243], [0.4186]]])
in0Add20758 = tf.constant([[[0.3516, 0.2861]]])
in1Add20758 = tf.constant([[[0.7931, 0.4644]]])
in0Max89976 = tf.constant([[[[[0.4952], [0.0998]], [[0.0302], [0.1761]]]]])
in1Max89976 = tf.constant([[[[[0.6083], [0.7699]], [[0.8323], [0.4911]]]]])
print (np.array2string(model.predict([in0Up_51117,in0Min29624,in1Min29624,in0Con90150,in0Add20758,in1Add20758,in0Max89976,in1Max89976],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul54784.png')

LUp_51117 = up_sampling2D_layer([[[[1.8602, 1.8698], [1.8964, 1.654]], [[1.8319, 1.7509], [1.0777, 1.578]], [[1.6731, 1.7083], [1.9389, 1.226]]]], 2, 1, Up_51117), 
LLay18455 = layer_normalization_layer(Up_51117, 1, 2.2480790912890907, Lay18455), 
LSep27098 = separable_conv2D_layer(Lay18455, 3, 1,[[[[[0.4019], [0.5094]]], [[[0.561], [0.4646]]], [[[0.0003], [0.1461]]]],[[[[0.7662, 0.2917, 0.6166], [0.2692, 0.2841, 0.878]]]]],[0, 0, 0], 5, 5, false, Sep27098), 
LRes82453 = reshape_layer(Sep27098, [1, 3], Res82453), 
LZer35809 = zero_padding1D_layer(Res82453, 1, 0, Zer35809), 
LMin29624 = minimum_layer([[[[0.8844, 0.8846], [0.7211, 0.2058]]], [[[0.421, 0.3121], [0.7495, 0.8593]]]], Min29624), 
LCon90150 = concatenate_layer([Min29624,[[[0.8243], [0.4186]]]], 2, Con90150), 
LAve5791 = average_layer([Zer35809,Con90150], Ave5791), 
LRes1680 = reshape_layer(Ave5791, [2, 3, 1], Res1680), 
LRes9186 = reshape_layer(Res1680, [2, 3, 1, 1], Res9186), 
LZer84244 = zero_padding3D_layer(Res9186, 0, 0, 0, 0, 2, 0, Zer84244), 
LAdd20758 = add_layer([[[[0.3516, 0.2861]]], [[[0.7931, 0.4644]]]], Add20758), 
LELU60076 = elu_layer(Add20758, 3.829274410257602, ELU60076), 
LRes87905 = reshape_layer(ELU60076, [1, 2, 1], Res87905), 
LRes43899 = reshape_layer(Res87905, [1, 2, 1, 1], Res43899), 
LZer39816 = zero_padding3D_layer(Res43899, 0, 0, 0, 0, 1, 0, Zer39816), 
LMax89976 = maximum_layer([[[[[[0.4952], [0.0998]], [[0.0302], [0.1761]]]]], [[[[[0.6083], [0.7699]], [[0.8323], [0.4911]]]]]], Max89976), 
LSub57020 = subtract_layer(Zer39816,Max89976, Sub57020), 
LZer44279 = zero_padding3D_layer(Sub57020, 1, 0, 1, 0, 1, 0, Zer44279), 
LMul54784 = multiply_layer([Zer84244,Zer44279], Mul54784), 
exec_layers([LUp_51117,LLay18455,LSep27098,LRes82453,LZer35809,LMin29624,LCon90150,LAve5791,LRes1680,LRes9186,LZer84244,LAdd20758,LELU60076,LRes87905,LRes43899,LZer39816,LMax89976,LSub57020,LZer44279,LMul54784],["Up_51117","Lay18455","Sep27098","Res82453","Zer35809","Min29624","Con90150","Ave5791","Res1680","Res9186","Zer84244","Add20758","ELU60076","Res87905","Res43899","Zer39816","Max89976","Sub57020","Zer44279","Mul54784"],Mul54784,"Mul54784")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0000000], [0.0441816]], [[0.0000000], [-0.0000000], [0.0646003]]]]]

Expected (Unparsed): [[[[[0],[0],[0.0]],[[0],[0],[0.0]],[[0],[0],[0.0]]],[[[0],[0],[0.0]],[[0],[-0.0],[0.04418164487628317]],[[0],[-0.0],[0.06460030697030375]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0], [0.0442]], [[0], [-0], [0.0647]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0], [0.0442]], [[0], [-0], [0.0647]]]]]