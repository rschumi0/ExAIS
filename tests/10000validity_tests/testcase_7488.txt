import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add14689 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add14689 = tf.keras.layers.Input(shape=([2, 1, 2]))

Add14689 = keras.layers.Add(name = 'Add14689', )([in0Add14689,in1Add14689])
Res25001 = keras.layers.Reshape((2, 2), name = 'Res25001', )(Add14689)
Res3610 = keras.layers.Reshape((2, 2, 1), name = 'Res3610', )(Res25001)
Res3049 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res3049', )(Res3610)
Glo78121 = keras.layers.GlobalAveragePooling3D(name = 'Glo78121', )(Res3049)
Res76422 = keras.layers.Reshape((1, 1), name = 'Res76422', )(Glo78121)
Ave99974 = keras.layers.AveragePooling1D(pool_size=(1), strides=(4), padding='same', name = 'Ave99974', )(Res76422)
Loc63422 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc63422', )(Ave99974)
model = tf.keras.models.Model(inputs=[in0Add14689,in1Add14689], outputs=Loc63422)
w = model.get_layer('Loc63422').get_weights() 
w[0] = np.array([[[0.2811, 0.141, 0.3727, 0.3569]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc63422').set_weights(w) 
in0Add14689 = tf.constant([[[[0.4634, 0.7726]], [[0.322, 0.132]]]])
in1Add14689 = tf.constant([[[[0.2182, 0.5257]], [[0.1682, 0.8761]]]])
print (np.array2string(model.predict([in0Add14689,in1Add14689],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc63422.png')

LAdd14689 = add_layer([[[[[0.4634, 0.7726]], [[0.322, 0.132]]]], [[[[0.2182, 0.5257]], [[0.1682, 0.8761]]]]], Add14689), 
LRes25001 = reshape_layer(Add14689, [2, 2], Res25001), 
LRes3610 = reshape_layer(Res25001, [2, 2, 1], Res3610), 
LRes3049 = reshape_layer(Res3610, [2, 2, 1, 1], Res3049), 
LGlo78121 = global_average_pooling3D_layer(Res3049, Glo78121), 
LRes76422 = reshape_layer(Glo78121, [1, 1], Res76422), 
LAve99974 = average_pooling1D_layer(Res76422, 1, 4, true, Ave99974), 
LLoc63422 = locally_connected1D_layer(Ave99974, 1,[[[0.2811, 0.141, 0.3727, 0.3569]]],[[0, 0, 0, 0]], 1, Loc63422), 
exec_layers([LAdd14689,LRes25001,LRes3610,LRes3049,LGlo78121,LRes76422,LAve99974,LLoc63422],["Add14689","Res25001","Res3610","Res3049","Glo78121","Res76422","Ave99974","Loc63422"],Loc63422,"Loc63422")

Actual (Unparsed): [[[0.2444305, 0.1226065, 0.3240813, 0.3103424]]]

Expected (Unparsed): [[[0.24443050499999996,0.12260654999999997,0.3240812849999999,0.31034239499999994]]]

Actual:   [[[0.2445, 0.1227, 0.3241, 0.3104]]]

Expected: [[[0.2445, 0.1227, 0.3241, 0.3104]]]