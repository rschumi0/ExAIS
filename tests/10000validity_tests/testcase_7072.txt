import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max69879 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max69879 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max43818 = tf.keras.layers.Input(shape=([2, 2]))
in1Max43818 = tf.keras.layers.Input(shape=([2, 2]))

Max69879 = keras.layers.Maximum(name = 'Max69879', )([in0Max69879,in1Max69879])
Res97455 = keras.layers.Reshape((2, 2), name = 'Res97455', )(Max69879)
Max43818 = keras.layers.Maximum(name = 'Max43818', )([in0Max43818,in1Max43818])
Sep48897 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='valid', name = 'Sep48897', )(Max43818)
Add90715 = keras.layers.Add(name = 'Add90715', )([Res97455,Sep48897])
model = tf.keras.models.Model(inputs=[in0Max69879,in1Max69879,in0Max43818,in1Max43818], outputs=Add90715)
w = model.get_layer('Sep48897').get_weights() 
w[0] = np.array([[[0.3489], [0.8395]]])
w[1] = np.array([[[0.8385, 0.5134], [0.5165, 0.1013]]])
w[2] = np.array([0, 0])
model.get_layer('Sep48897').set_weights(w) 
in0Max69879 = tf.constant([[[[0.2316], [0.5291]], [[0.2112], [0.5856]]]])
in1Max69879 = tf.constant([[[[0.4538], [0.4498]], [[0.8249], [0.4868]]]])
in0Max43818 = tf.constant([[[0.0718, 0.7271], [0.6228, 0.0945]]])
in1Max43818 = tf.constant([[[0.0105, 0.3673], [0.7246, 0.468]]])
print (np.array2string(model.predict([in0Max69879,in1Max69879,in0Max43818,in1Max43818],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add90715.png')

LMax69879 = maximum_layer([[[[[0.2316], [0.5291]], [[0.2112], [0.5856]]]], [[[[0.4538], [0.4498]], [[0.8249], [0.4868]]]]], Max69879), 
LRes97455 = reshape_layer(Max69879, [2, 2], Res97455), 
LMax43818 = maximum_layer([[[[0.0718, 0.7271], [0.6228, 0.0945]]], [[[0.0105, 0.3673], [0.7246, 0.468]]]], Max43818), 
LSep48897 = separable_conv1D_layer(Max43818, 1,[[[[0.3489], [0.8395]]],[[[0.8385, 0.5134], [0.5165, 0.1013]]]],[0, 0], 1, false, Sep48897), 
LAdd90715 = add_layer([Res97455,Sep48897], Add90715), 
exec_layers([LMax69879,LRes97455,LMax43818,LSep48897,LAdd90715],["Max69879","Res97455","Max43818","Sep48897","Add90715"],Add90715,"Add90715")

Actual (Unparsed): [[[0.7900771, 0.6037948], [1.2398092, 0.7551935]]]

Expected (Unparsed): [[[0.7900771126949999,0.603794759253],[1.23980926919,0.755193515196]]]

Actual:   [[[0.7901, 0.6038], [1.2399, 0.7552]]]

Expected: [[[0.7901, 0.6038], [1.2399, 0.7552]]]