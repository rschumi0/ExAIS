import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max85109 = tf.keras.layers.Input(shape=([1, 2]))
in1Max85109 = tf.keras.layers.Input(shape=([1, 2]))
in0Add30845 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Add30845 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con66617 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Thr57105 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Max20697 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max20697 = tf.keras.layers.Input(shape=([2, 2, 2]))

Max85109 = keras.layers.Maximum(name = 'Max85109', )([in0Max85109,in1Max85109])
Res58467 = keras.layers.Reshape((1, 2, 1), name = 'Res58467', )(Max85109)
Res93566 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res93566', )(Res58467)
Add30845 = keras.layers.Add(name = 'Add30845', )([in0Add30845,in1Add30845])
PRe33070 = keras.layers.PReLU(name = 'PRe33070', )(Add30845)
Mul214 = keras.layers.Multiply(name = 'Mul214', )([Res93566,PRe33070])
Res7359 = keras.layers.Reshape((1, 2, 1), name = 'Res7359', )(Mul214)
Zer4644 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer4644', )(Res7359)
Con66617 = keras.layers.Concatenate(axis=3, name = 'Con66617', )([Zer4644,in0Con66617])
Thr57105 = keras.layers.ThresholdedReLU(theta=5.509123124567734, name = 'Thr57105', input_shape=(1, 2, 2, 1))(in0Thr57105)
Res36358 = keras.layers.Reshape((1, 2, 2), name = 'Res36358', )(Thr57105)
Zer40847 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer40847', )(Res36358)
Max20697 = keras.layers.Maximum(name = 'Max20697', )([in0Max20697,in1Max20697])
Mul44359 = keras.layers.Multiply(name = 'Mul44359', )([Zer40847,Max20697])
Min70950 = keras.layers.Minimum(name = 'Min70950', )([Con66617,Mul44359])
model = tf.keras.models.Model(inputs=[in0Max85109,in1Max85109,in0Add30845,in1Add30845,in0Con66617,in0Thr57105,in0Max20697,in1Max20697], outputs=Min70950)
w = model.get_layer('PRe33070').get_weights() 
w[0] = np.array([[[[0.6021]], [[0.5407]]]])
model.get_layer('PRe33070').set_weights(w) 
in0Max85109 = tf.constant([[[0.261, 0.7337]]])
in1Max85109 = tf.constant([[[0.5619, 0.8684]]])
in0Add30845 = tf.constant([[[[[0.4046]], [[0.1197]]]]])
in1Add30845 = tf.constant([[[[[0.7772]], [[0.8669]]]]])
in0Con66617 = tf.constant([[[[0.765], [0.3941]], [[0.5032], [0.4504]]]])
in0Thr57105 = tf.constant([[[[[0.285], [0.9977]], [[0.8588], [0.8207]]]]])
in0Max20697 = tf.constant([[[[0.3438, 0.3464], [0.9202, 0.9412]], [[0.2802, 0.8482], [0.2055, 0.2962]]]])
in1Max20697 = tf.constant([[[[0.114, 0.1003], [0.0846, 0.4941]], [[0.2027, 0.7944], [0.0026, 0.7448]]]])
print (np.array2string(model.predict([in0Max85109,in1Max85109,in0Add30845,in1Add30845,in0Con66617,in0Thr57105,in0Max20697,in1Max20697],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min70950.png')

LMax85109 = maximum_layer([[[[0.261, 0.7337]]], [[[0.5619, 0.8684]]]], Max85109), 
LRes58467 = reshape_layer(Max85109, [1, 2, 1], Res58467), 
LRes93566 = reshape_layer(Res58467, [1, 2, 1, 1], Res93566), 
LAdd30845 = add_layer([[[[[[0.4046]], [[0.1197]]]]], [[[[[0.7772]], [[0.8669]]]]]], Add30845), 
LPRe33070 = prelu_layer(Add30845, [[[[0.6021]], [[0.5407]]]], PRe33070), 
LMul214 = multiply_layer([Res93566,PRe33070], Mul214), 
LRes7359 = reshape_layer(Mul214, [1, 2, 1], Res7359), 
LZer4644 = zero_padding2D_layer(Res7359, 1, 0, 0, 0, Zer4644), 
LCon66617 = concatenate_layer([Zer4644,[[[[0.765], [0.3941]], [[0.5032], [0.4504]]]]], 3, Con66617), 
LThr57105 = thresholded_relu_layer([[[[[0.285], [0.9977]], [[0.8588], [0.8207]]]]], 5.509123124567734, Thr57105), 
LRes36358 = reshape_layer(Thr57105, [1, 2, 2], Res36358), 
LZer40847 = zero_padding2D_layer(Res36358, 1, 0, 0, 0, Zer40847), 
LMax20697 = maximum_layer([[[[[0.3438, 0.3464], [0.9202, 0.9412]], [[0.2802, 0.8482], [0.2055, 0.2962]]]], [[[[0.114, 0.1003], [0.0846, 0.4941]], [[0.2027, 0.7944], [0.0026, 0.7448]]]]], Max20697), 
LMul44359 = multiply_layer([Zer40847,Max20697], Mul44359), 
LMin70950 = minimum_layer([Con66617,Mul44359], Min70950), 
exec_layers([LMax85109,LRes58467,LRes93566,LAdd30845,LPRe33070,LMul214,LRes7359,LZer4644,LCon66617,LThr57105,LRes36358,LZer40847,LMax20697,LMul44359,LMin70950],["Max85109","Res58467","Res93566","Add30845","PRe33070","Mul214","Res7359","Zer4644","Con66617","Thr57105","Res36358","Zer40847","Max20697","Mul44359","Min70950"],Min70950,"Min70950")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0.0],[0,0.0]],[[0.0,0.0],[0.0,0.0]]]]

Actual:   [[[[0, 0], [0, 0]], [[0, 0], [0, 0]]]]

Expected: [[[[0, 0], [0, 0]], [[0, 0], [0, 0]]]]