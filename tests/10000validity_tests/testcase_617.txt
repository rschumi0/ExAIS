import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub91069 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub91069 = tf.keras.layers.Input(shape=([3, 3, 3]))

Sub91069 = keras.layers.Subtract(name = 'Sub91069', )([in0Sub91069,in1Sub91069])
Res65190 = keras.layers.Reshape((3, 9), name = 'Res65190', )(Sub91069)
Sim94265 = keras.layers.SimpleRNN(3,name = 'Sim94265', )(Res65190)
Res39190 = keras.layers.Reshape((3, 1), name = 'Res39190', )(Sim94265)
Glo11798 = keras.layers.GlobalAveragePooling1D(name = 'Glo11798', )(Res39190)
model = tf.keras.models.Model(inputs=[in0Sub91069,in1Sub91069], outputs=Glo11798)
w = model.get_layer('Sim94265').get_weights() 
w[0] = np.array([[4, 2, 5], [3, 9, 9], [9, 2, 8], [5, 7, 10], [7, 9, 6], [1, 9, 4], [1, 6, 3], [2, 6, 4], [6, 4, 2]])
w[1] = np.array([[6, 5, 5], [1, 8, 7], [3, 4, 4]])
w[2] = np.array([8, 5, 5])
model.get_layer('Sim94265').set_weights(w) 
in0Sub91069 = tf.constant([[[[0.5579, 0.654, 0.7061], [0.8631, 0.9932, 0.7332], [0.6566, 0.8906, 0.1937]], [[0.5338, 0.2407, 0.2541], [0.9787, 0.9635, 0.662], [0.1608, 0.9705, 0.4029]], [[0.367, 0.0155, 0.1418], [0.2709, 0.2853, 0.8958], [0.1718, 0.372, 0.4732]]]])
in1Sub91069 = tf.constant([[[[0.0027, 0.9724, 0.6997], [0.4913, 0.3671, 0.9968], [0.216, 0.8563, 0.3371]], [[0.9762, 0.0187, 0.2109], [0.1447, 0.5417, 0.2165], [0.4309, 0.1568, 0.7857]], [[0.7824, 0.7508, 0.2511], [0.1901, 0.6313, 0.1301], [0.1278, 0.5102, 0.1778]]]])
print (np.array2string(model.predict([in0Sub91069,in1Sub91069],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo11798.png')

LSub91069 = subtract_layer([[[[0.5579, 0.654, 0.7061], [0.8631, 0.9932, 0.7332], [0.6566, 0.8906, 0.1937]], [[0.5338, 0.2407, 0.2541], [0.9787, 0.9635, 0.662], [0.1608, 0.9705, 0.4029]], [[0.367, 0.0155, 0.1418], [0.2709, 0.2853, 0.8958], [0.1718, 0.372, 0.4732]]]], [[[[0.0027, 0.9724, 0.6997], [0.4913, 0.3671, 0.9968], [0.216, 0.8563, 0.3371]], [[0.9762, 0.0187, 0.2109], [0.1447, 0.5417, 0.2165], [0.4309, 0.1568, 0.7857]], [[0.7824, 0.7508, 0.2511], [0.1901, 0.6313, 0.1301], [0.1278, 0.5102, 0.1778]]]], Sub91069), 
LRes65190 = reshape_layer(Sub91069, [3, 9], Res65190), 
LSim94265 = simple_rnn_layer(Res65190,[[4, 2, 5], [3, 9, 9], [9, 2, 8], [5, 7, 10], [7, 9, 6], [1, 9, 4], [1, 6, 3], [2, 6, 4], [6, 4, 2]],[[6, 5, 5], [1, 8, 7], [3, 4, 4]],[8, 5, 5], Sim94265), 
LRes39190 = reshape_layer(Sim94265, [3, 1], Res39190), 
LGlo11798 = global_average_pooling1D_layer(Res39190, Glo11798), 
exec_layers([LSub91069,LRes65190,LSim94265,LRes39190,LGlo11798],["Sub91069","Res65190","Sim94265","Res39190","Glo11798"],Glo11798,"Glo11798")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[0.9999999999970336]]

Actual:   [[1]]

Expected: [[1]]