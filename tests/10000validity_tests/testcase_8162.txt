import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave57688 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave57688 = tf.keras.layers.Input(shape=([1, 2]))
in0Con97959 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max71702 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max71702 = tf.keras.layers.Input(shape=([2, 2, 2]))

Ave57688 = keras.layers.Average(name = 'Ave57688', )([in0Ave57688,in1Ave57688])
Res27667 = keras.layers.Reshape((1, 2, 1), name = 'Res27667', )(Ave57688)
Zer85030 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer85030', )(Res27667)
Con97959 = keras.layers.Concatenate(axis=3, name = 'Con97959', )([Zer85030,in0Con97959])
Max71702 = keras.layers.Maximum(name = 'Max71702', )([in0Max71702,in1Max71702])
Sub9947 = keras.layers.Subtract(name = 'Sub9947', )([Con97959,Max71702])
model = tf.keras.models.Model(inputs=[in0Ave57688,in1Ave57688,in0Con97959,in0Max71702,in1Max71702], outputs=Sub9947)
in0Ave57688 = tf.constant([[[0.8575, 0.692]]])
in1Ave57688 = tf.constant([[[0.4015, 0.3406]]])
in0Con97959 = tf.constant([[[[0.6434], [0.4237]], [[0.633], [0.4491]]]])
in0Max71702 = tf.constant([[[[0.8758, 0.9805], [0.3646, 0.0885]], [[0.5932, 0.2106], [0.1528, 0.1837]]]])
in1Max71702 = tf.constant([[[[0.6222, 0.9514], [0.3626, 0.4176]], [[0.5423, 0.8085], [0.7178, 0.2609]]]])
print (np.array2string(model.predict([in0Ave57688,in1Ave57688,in0Con97959,in0Max71702,in1Max71702],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub9947.png')

LAve57688 = average_layer([[[[0.8575, 0.692]]], [[[0.4015, 0.3406]]]], Ave57688), 
LRes27667 = reshape_layer(Ave57688, [1, 2, 1], Res27667), 
LZer85030 = zero_padding2D_layer(Res27667, 1, 0, 0, 0, Zer85030), 
LCon97959 = concatenate_layer([Zer85030,[[[[0.6434], [0.4237]], [[0.633], [0.4491]]]]], 3, Con97959), 
LMax71702 = maximum_layer([[[[[0.8758, 0.9805], [0.3646, 0.0885]], [[0.5932, 0.2106], [0.1528, 0.1837]]]], [[[[0.6222, 0.9514], [0.3626, 0.4176]], [[0.5423, 0.8085], [0.7178, 0.2609]]]]], Max71702), 
LSub9947 = subtract_layer(Con97959,Max71702, Sub9947), 
exec_layers([LAve57688,LRes27667,LZer85030,LCon97959,LMax71702,LSub9947],["Ave57688","Res27667","Zer85030","Con97959","Max71702","Sub9947"],Sub9947,"Sub9947")

Actual (Unparsed): [[[[-0.8758000, -0.3371000], [-0.3646000, 0.0061000]], [[0.0363000, -0.1755000], [-0.2015000, 0.1882000]]]]

Expected (Unparsed): [[[[-0.8758,-0.33710000000000007],[-0.3646,0.006099999999999994]],[[0.03630000000000011,-0.1755],[-0.2015,0.18819999999999998]]]]

Actual:   [[[[-0.8758, -0.3371], [-0.3646, 0.0061]], [[0.0363, -0.1755], [-0.2015, 0.1882]]]]

Expected: [[[[-0.8758, -0.3371], [-0.3646, 0.0061]], [[0.0364, -0.1755], [-0.2015, 0.1882]]]]