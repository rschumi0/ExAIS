import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo24584 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con72112 = tf.keras.layers.Input(shape=([4, 4, 1]))
in0Zer93117 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con45245 = tf.keras.layers.Input(shape=([4, 4, 2, 1]))
in0Con40201 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Mul22505 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul22505 = tf.keras.layers.Input(shape=([1, 1]))
in0Con31524 = tf.keras.layers.Input(shape=([4, 4, 3]))

Glo24584 = keras.layers.GlobalMaxPool2D(name = 'Glo24584', )(in0Glo24584)
Res77396 = keras.layers.Reshape((1, 1), name = 'Res77396', )(Glo24584)
Res76871 = keras.layers.Reshape((1, 1, 1), name = 'Res76871', )(Res77396)
Zer17379 = keras.layers.ZeroPadding2D(padding=((3, 0), (3, 0)), name = 'Zer17379', )(Res76871)
Con72112 = keras.layers.Concatenate(axis=3, name = 'Con72112', )([Zer17379,in0Con72112])
Zer93117 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer93117', )(in0Zer93117)
Lay70617 = keras.layers.LayerNormalization(axis=3, epsilon=2.807295810553568, name = 'Lay70617', )(Zer93117)
Max23054 = keras.layers.Maximum(name = 'Max23054', )([Con72112,Lay70617])
Res30962 = keras.layers.Reshape((4, 4, 2, 1), name = 'Res30962', )(Max23054)
Con45245 = keras.layers.Concatenate(axis=4, name = 'Con45245', )([Res30962,in0Con45245])
Con40201 = keras.layers.Conv3D(2, (1, 2, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con40201', )(in0Con40201)
Zer27706 = keras.layers.ZeroPadding3D(padding=((3, 0), (3, 0), (0, 0)), name = 'Zer27706', )(Con40201)
Sub8988 = keras.layers.Subtract(name = 'Sub8988', )([Con45245,Zer27706])
Res56539 = keras.layers.Reshape((4, 4, 4), name = 'Res56539', )(Sub8988)
Mul22505 = keras.layers.Multiply(name = 'Mul22505', )([in0Mul22505,in1Mul22505])
ReL56537 = keras.layers.ReLU(max_value=1.7512654783875468, negative_slope=9.954890057438773, threshold=9.805825373596765, name = 'ReL56537', )(Mul22505)
Res64275 = keras.layers.Reshape((1, 1, 1), name = 'Res64275', )(ReL56537)
Ave52721 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave52721', )(Res64275)
Zer59321 = keras.layers.ZeroPadding2D(padding=((3, 0), (3, 0)), name = 'Zer59321', )(Ave52721)
Con31524 = keras.layers.Concatenate(axis=3, name = 'Con31524', )([Zer59321,in0Con31524])
Add33707 = keras.layers.Add(name = 'Add33707', )([Res56539,Con31524])
model = tf.keras.models.Model(inputs=[in0Glo24584,in0Con72112,in0Zer93117,in0Con45245,in0Con40201,in0Mul22505,in1Mul22505,in0Con31524], outputs=Add33707)
w = model.get_layer('Con40201').get_weights() 
w[0] = np.array([[[[[0.383, 0.4937], [0.9924, 0.4275]]], [[[0.8907, 0.4024], [0.1882, 0.5395]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con40201').set_weights(w) 
in0Glo24584 = tf.constant([[[[1.1072], [1.1271]], [[1.1034], [1.2824]]]])
in0Con72112 = tf.constant([[[[0.4293], [0.8038], [0.5477], [0.9831]], [[0.4434], [0.7919], [0.7188], [0.3902]], [[0.2432], [0.743], [0.5131], [0.3332]], [[0.3835], [0.3793], [0.0916], [0.1713]]]])
in0Zer93117 = tf.constant([[[[1.4062, 1.0784], [1.5093, 1.5639]], [[1.1797, 1.174], [1.5243, 1.5048]]]])
in0Con45245 = tf.constant([[[[[0.0871], [0.4897]], [[0.539], [0.0782]], [[0.3653], [0.3795]], [[0.5412], [0.3621]]], [[[0.3348], [0.3617]], [[0.4482], [0.2824]], [[0.3806], [0.3173]], [[0.0078], [0.0451]]], [[[0.1301], [0.8768]], [[0.7961], [0.7529]], [[0.8745], [0.909]], [[0.4986], [0.3203]]], [[[0.3521], [0.947]], [[0.0926], [0.1798]], [[0.63], [0.4168]], [[0.1872], [0.6991]]]]])
in0Con40201 = tf.constant([[[[[0.5376, 0.2968], [0.3323, 0.3104]], [[0.1918, 0.0721], [0.4144, 0.1043]]]]])
in0Mul22505 = tf.constant([[[0.3129]]])
in1Mul22505 = tf.constant([[[0.7703]]])
in0Con31524 = tf.constant([[[[0.3354, 0.2595, 0.6916], [0.051, 0.7344, 0.369], [0.5774, 0.3087, 0.9926], [0.9309, 0.9601, 0.0588]], [[0.3437, 0.7721, 0.3465], [0.3885, 0.2247, 0.7987], [0.6359, 0.0772, 0.3175], [0.3887, 0.8629, 0.0335]], [[0.806, 0.6234, 0.1608], [0.5771, 0.8841, 0.4784], [0.346, 0.131, 0.972], [0.9973, 0.4584, 0.9337]], [[0.8027, 0.8996, 0.3174], [0.4505, 0.5266, 0.0363], [0.6486, 0.2641, 0.2466], [0.6012, 0.6237, 0.3624]]]])
print (np.array2string(model.predict([in0Glo24584,in0Con72112,in0Zer93117,in0Con45245,in0Con40201,in0Mul22505,in1Mul22505,in0Con31524],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add33707.png')

LGlo24584 = global_max_pool2D_layer([[[[1.1072], [1.1271]], [[1.1034], [1.2824]]]], Glo24584), 
LRes77396 = reshape_layer(Glo24584, [1, 1], Res77396), 
LRes76871 = reshape_layer(Res77396, [1, 1, 1], Res76871), 
LZer17379 = zero_padding2D_layer(Res76871, 3, 0, 3, 0, Zer17379), 
LCon72112 = concatenate_layer([Zer17379,[[[[0.4293], [0.8038], [0.5477], [0.9831]], [[0.4434], [0.7919], [0.7188], [0.3902]], [[0.2432], [0.743], [0.5131], [0.3332]], [[0.3835], [0.3793], [0.0916], [0.1713]]]]], 3, Con72112), 
LZer93117 = zero_padding2D_layer([[[[1.4062, 1.0784], [1.5093, 1.5639]], [[1.1797, 1.174], [1.5243, 1.5048]]]], 1, 1, 1, 1, Zer93117), 
LLay70617 = layer_normalization_layer(Zer93117, 3, 2.807295810553568, Lay70617), 
LMax23054 = maximum_layer([Con72112,Lay70617], Max23054), 
LRes30962 = reshape_layer(Max23054, [4, 4, 2, 1], Res30962), 
LCon45245 = concatenate_layer([Res30962,[[[[[0.0871], [0.4897]], [[0.539], [0.0782]], [[0.3653], [0.3795]], [[0.5412], [0.3621]]], [[[0.3348], [0.3617]], [[0.4482], [0.2824]], [[0.3806], [0.3173]], [[0.0078], [0.0451]]], [[[0.1301], [0.8768]], [[0.7961], [0.7529]], [[0.8745], [0.909]], [[0.4986], [0.3203]]], [[[0.3521], [0.947]], [[0.0926], [0.1798]], [[0.63], [0.4168]], [[0.1872], [0.6991]]]]]], 4, Con45245), 
LCon40201 = conv3D_layer([[[[[0.5376, 0.2968], [0.3323, 0.3104]], [[0.1918, 0.0721], [0.4144, 0.1043]]]]], 1, 2, 1,[[[[[0.383, 0.4937], [0.9924, 0.4275]]], [[[0.8907, 0.4024], [0.1882, 0.5395]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con40201), 
LZer27706 = zero_padding3D_layer(Con40201, 3, 0, 3, 0, 0, 0, Zer27706), 
LSub8988 = subtract_layer(Con45245,Zer27706, Sub8988), 
LRes56539 = reshape_layer(Sub8988, [4, 4, 4], Res56539), 
LMul22505 = multiply_layer([[[[0.3129]]], [[[0.7703]]]], Mul22505), 
LReL56537 = relu_layer(Mul22505, 1.7512654783875468, 9.954890057438773, 9.805825373596765, ReL56537), 
LRes64275 = reshape_layer(ReL56537, [1, 1, 1], Res64275), 
LAve52721 = average_pooling2D_layer(Res64275, 1, 1, Ave52721), 
LZer59321 = zero_padding2D_layer(Ave52721, 3, 0, 3, 0, Zer59321), 
LCon31524 = concatenate_layer([Zer59321,[[[[0.3354, 0.2595, 0.6916], [0.051, 0.7344, 0.369], [0.5774, 0.3087, 0.9926], [0.9309, 0.9601, 0.0588]], [[0.3437, 0.7721, 0.3465], [0.3885, 0.2247, 0.7987], [0.6359, 0.0772, 0.3175], [0.3887, 0.8629, 0.0335]], [[0.806, 0.6234, 0.1608], [0.5771, 0.8841, 0.4784], [0.346, 0.131, 0.972], [0.9973, 0.4584, 0.9337]], [[0.8027, 0.8996, 0.3174], [0.4505, 0.5266, 0.0363], [0.6486, 0.2641, 0.2466], [0.6012, 0.6237, 0.3624]]]]], 3, Con31524), 
LAdd33707 = add_layer([Res56539,Con31524], Add33707), 
exec_layers([LGlo24584,LRes77396,LRes76871,LZer17379,LCon72112,LZer93117,LLay70617,LMax23054,LRes30962,LCon45245,LCon40201,LZer27706,LSub8988,LRes56539,LMul22505,LReL56537,LRes64275,LAve52721,LZer59321,LCon31524,LAdd33707],["Glo24584","Res77396","Res76871","Zer17379","Con72112","Zer93117","Lay70617","Max23054","Res30962","Con45245","Con40201","Zer27706","Sub8988","Res56539","Mul22505","ReL56537","Res64275","Ave52721","Zer59321","Con31524","Add33707"],Add33707,"Add33707")

Actual (Unparsed): [[[[0.0000000, 0.4225000, 0.6888000, 1.1813000], [0.0000000, 0.5900000, 1.5382000, 0.4472000], [0.0000000, 0.9427000, 0.8564000, 1.3721000], [0.0000000, 1.4721000, 1.9432000, 0.4209000]], [[0.0000000, 0.6785000, 1.2155000, 0.7082000], [0.0973569, 0.8367000, 1.0166000, 1.0811000], [0.0000000, 1.0165000, 0.7960000, 0.6348000], [0.0000000, 0.3965000, 1.2531000, 0.0786000]], [[0.0000000, 0.9361000, 0.8666000, 1.0376000], [0.0017010, 1.3732000, 1.6271000, 1.2313000], [0.0058191, 1.2205000, 0.6441000, 1.8810000], [0.0000000, 1.4959000, 0.7916000, 1.2540000]], [[0.0000000, 1.1548000, 1.2831000, 1.2644000], [0.0000000, 0.5431000, 0.9059000, 0.2161000], [0.0000000, 1.2786000, 0.3557000, 0.6634000], [-94.6189681, 0.2800266, -0.0290472, 0.5417231]]]]

Expected (Unparsed): [[[[0,0.4225,0.6888000000000001,1.1813],[0,0.5900000000000001,1.5382,0.4472],[0,0.9427000000000001,0.8563999999999999,1.3721],[0,1.4721,1.9432,0.4209]],[[0,0.6785,1.2155,0.7081999999999999],[0.09735692457995827,0.8367,1.0166,1.0811],[0,1.0165,0.796,0.6348],[0,0.39649999999999996,1.2530999999999999,0.0786]],[[0,0.9361,0.8665999999999999,1.0376],[0.0017009836648552577,1.3732,1.6271,1.2313],[0.005819064537692204,1.2205,0.6441,1.881],[0,1.4959,0.7916,1.254]],[[0,1.1548,1.2831,1.2644],[0,0.5431,0.9058999999999999,0.2161],[0,1.2786,0.3557,0.6634],[-94.61896812486067,0.28002660999999995,-0.02904719999999994,0.5417230800000001]]]]

Actual:   [[[[0, 0.4225, 0.6888, 1.1813], [0, 0.59, 1.5382, 0.4472], [0, 0.9427, 0.8564, 1.3721], [0, 1.4721, 1.9432, 0.4209]], [[0, 0.6785, 1.2155, 0.7082], [0.0974, 0.8367, 1.0166, 1.0811], [0, 1.0165, 0.796, 0.6348], [0, 0.3965, 1.2531, 0.0786]], [[0, 0.9361, 0.8666, 1.0376], [0.0018, 1.3732, 1.6271, 1.2313], [0.0059, 1.2205, 0.6441, 1.881], [0, 1.4959, 0.7916, 1.254]], [[0, 1.1548, 1.2831, 1.2644], [0, 0.5431, 0.9059, 0.2161], [0, 1.2786, 0.3557, 0.6634], [-94.6189, 0.2801, -0.029, 0.5418]]]]

Expected: [[[[0, 0.4225, 0.6889, 1.1813], [0, 0.5901, 1.5382, 0.4472], [0, 0.9428, 0.8564, 1.3721], [0, 1.4721, 1.9432, 0.4209]], [[0, 0.6785, 1.2155, 0.7082], [0.0974, 0.8367, 1.0166, 1.0811], [0, 1.0165, 0.796, 0.6348], [0, 0.3965, 1.2531, 0.0786]], [[0, 0.9361, 0.8666, 1.0376], [0.0018, 1.3732, 1.6271, 1.2313], [0.0059, 1.2205, 0.6441, 1.881], [0, 1.4959, 0.7916, 1.254]], [[0, 1.1548, 1.2831, 1.2644], [0, 0.5431, 0.9059, 0.2161], [0, 1.2786, 0.3557, 0.6634], [-94.6189, 0.2801, -0.029, 0.5418]]]]