import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo82412 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave15170 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Ave15170 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Glo82412 = keras.layers.GlobalMaxPool1D(name = 'Glo82412', )(in0Glo82412)
Res84611 = keras.layers.Reshape((1, 1), name = 'Res84611', )(Glo82412)
Ave15170 = keras.layers.Average(name = 'Ave15170', )([in0Ave15170,in1Ave15170])
ReL90549 = keras.layers.ReLU(max_value=0.5482711681380553, negative_slope=6.834323731046964, threshold=4.685058216694227, name = 'ReL90549', )(Ave15170)
Res92836 = keras.layers.Reshape((2, 2, 1), name = 'Res92836', )(ReL90549)
Dep85549 = keras.layers.DepthwiseConv2D((2, 2),strides=(2, 2), padding='same', name = 'Dep85549', )(Res92836)
Res23827 = keras.layers.Reshape((1, 1), name = 'Res23827', )(Dep85549)
Max99077 = keras.layers.Maximum(name = 'Max99077', )([Res84611,Res23827])
model = tf.keras.models.Model(inputs=[in0Glo82412,in0Ave15170,in1Ave15170], outputs=Max99077)
w = model.get_layer('Dep85549').get_weights() 
w[0] = np.array([[[[0.4559]], [[0.8682]]], [[[0.9184]], [[0.8554]]]])
w[1] = np.array([0])
model.get_layer('Dep85549').set_weights(w) 
in0Glo82412 = tf.constant([[[1.9592], [1.6904]]])
in0Ave15170 = tf.constant([[[[[0.6557]], [[0.5297]]], [[[0.2421]], [[0.1484]]]]])
in1Ave15170 = tf.constant([[[[[0.2071]], [[0.6607]]], [[[0.1175]], [[0.1658]]]]])
print (np.array2string(model.predict([in0Glo82412,in0Ave15170,in1Ave15170],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max99077.png')

LGlo82412 = global_max_pool1D_layer([[[1.9592], [1.6904]]], Glo82412), 
LRes84611 = reshape_layer(Glo82412, [1, 1], Res84611), 
LAve15170 = average_layer([[[[[[0.6557]], [[0.5297]]], [[[0.2421]], [[0.1484]]]]], [[[[[0.2071]], [[0.6607]]], [[[0.1175]], [[0.1658]]]]]], Ave15170), 
LReL90549 = relu_layer(Ave15170, 0.5482711681380553, 6.834323731046964, 4.685058216694227, ReL90549), 
LRes92836 = reshape_layer(ReL90549, [2, 2, 1], Res92836), 
LDep85549 = depthwise_conv2D_layer(Res92836, 2, 2,[[[[0.4559]], [[0.8682]]], [[[0.9184]], [[0.8554]]]],[0], 2, 2, true, Dep85549), 
LRes23827 = reshape_layer(Dep85549, [1, 1], Res23827), 
LMax99077 = maximum_layer([Res84611,Res23827], Max99077), 
exec_layers([LGlo82412,LRes84611,LAve15170,LReL90549,LRes92836,LDep85549,LRes23827,LMax99077],["Glo82412","Res84611","Ave15170","ReL90549","Res92836","Dep85549","Res23827","Max99077"],Max99077,"Max99077")

Actual (Unparsed): [[[1.9592000]]]

Expected (Unparsed): [[[1.9592]]]

Actual:   [[[1.9592]]]

Expected: [[[1.9592]]]