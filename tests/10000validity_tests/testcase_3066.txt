import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add28562 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Add28562 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con95380 = tf.keras.layers.Input(shape=([6, 2, 1, 2]))
in0Zer45092 = tf.keras.layers.Input(shape=([4, 2]))

Add28562 = keras.layers.Add(name = 'Add28562', )([in0Add28562,in1Add28562])
Zer80030 = keras.layers.ZeroPadding3D(padding=((5, 0), (0, 0), (0, 0)), name = 'Zer80030', )(Add28562)
Con95380 = keras.layers.Concatenate(axis=4, name = 'Con95380', )([Zer80030,in0Con95380])
Zer45092 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer45092', )(in0Zer45092)
Res41079 = keras.layers.Reshape((6, 2, 1), name = 'Res41079', )(Zer45092)
Res84281 = keras.layers.Reshape((6, 2, 1, 1), name = 'Res84281', )(Res41079)
Con6185 = keras.layers.Conv3DTranspose(3, (2, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con6185', )(Res84281)
Add3016 = keras.layers.Add(name = 'Add3016', )([Con95380,Con6185])
Res14645 = keras.layers.Reshape((6, 2, 3), name = 'Res14645', )(Add3016)
Glo99230 = keras.layers.GlobalMaxPool2D(name = 'Glo99230', )(Res14645)
model = tf.keras.models.Model(inputs=[in0Add28562,in1Add28562,in0Con95380,in0Zer45092], outputs=Glo99230)
w = model.get_layer('Con6185').get_weights() 
w[0] = np.array([[[[[0.2366], [0.9367], [0.8417]]]], [[[[0.4965], [0.6816], [0.2183]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con6185').set_weights(w) 
in0Add28562 = tf.constant([[[[[0.5111]], [[0.0851]]]]])
in1Add28562 = tf.constant([[[[[0.2918]], [[0.6882]]]]])
in0Con95380 = tf.constant([[[[[0.2465, 0.0301]], [[0.7281, 0.8471]]], [[[0.2614, 0.5754]], [[0.7837, 0.7043]]], [[[0.4344, 0.4182]], [[0.9495, 0.9488]]], [[[0.3485, 0.5316]], [[0.8311, 0.5054]]], [[[0.123, 0.7778]], [[0.1001, 0.4142]]], [[[0.5673, 0.4194]], [[0.8174, 0.4435]]]]])
in0Zer45092 = tf.constant([[[1.3518, 1.6447], [1.3956, 1.2078], [1.7646, 1.2129], [1.3055, 1.5711]]])
print (np.array2string(model.predict([in0Add28562,in1Add28562,in0Con95380,in0Zer45092],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo99230.png')

LAdd28562 = add_layer([[[[[[0.5111]], [[0.0851]]]]], [[[[[0.2918]], [[0.6882]]]]]], Add28562), 
LZer80030 = zero_padding3D_layer(Add28562, 5, 0, 0, 0, 0, 0, Zer80030), 
LCon95380 = concatenate_layer([Zer80030,[[[[[0.2465, 0.0301]], [[0.7281, 0.8471]]], [[[0.2614, 0.5754]], [[0.7837, 0.7043]]], [[[0.4344, 0.4182]], [[0.9495, 0.9488]]], [[[0.3485, 0.5316]], [[0.8311, 0.5054]]], [[[0.123, 0.7778]], [[0.1001, 0.4142]]], [[[0.5673, 0.4194]], [[0.8174, 0.4435]]]]]], 4, Con95380), 
LZer45092 = zero_padding1D_layer([[[1.3518, 1.6447], [1.3956, 1.2078], [1.7646, 1.2129], [1.3055, 1.5711]]], 1, 1, Zer45092), 
LRes41079 = reshape_layer(Zer45092, [6, 2, 1], Res41079), 
LRes84281 = reshape_layer(Res41079, [6, 2, 1, 1], Res84281), 
LCon6185 = conv3D_transpose_layer(Res84281, 2, 1, 1,[[[[[0.2366], [0.9367], [0.8417]]]], [[[[0.4965], [0.6816], [0.2183]]]]],[0, 0, 0], 1, 1, 1, true, Con6185), 
LAdd3016 = add_layer([Con95380,Con6185], Add3016), 
LRes14645 = reshape_layer(Add3016, [6, 2, 3], Res14645), 
LGlo99230 = global_max_pool2D_layer(Res14645, Glo99230), 
exec_layers([LAdd28562,LZer80030,LCon95380,LZer45092,LRes41079,LRes84281,LCon6185,LAdd3016,LRes14645,LGlo99230],["Add28562","Zer80030","Con95380","Zer45092","Res41079","Res84281","Con6185","Add3016","Res14645","Glo99230"],Glo99230,"Glo99230")

Actual (Unparsed): [[1.5533511, 3.2018739, 2.3244433]]

Expected (Unparsed): [[1.55335115,3.20187378,2.3244432699999997]]

Actual:   [[1.5534, 3.2019, 2.3245]]

Expected: [[1.5534, 3.2019, 2.3245]]