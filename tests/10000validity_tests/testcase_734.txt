import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep62817 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Lea31413 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Con37951 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Dot32032 = tf.keras.layers.Input(shape=([2]))
in1Dot32032 = tf.keras.layers.Input(shape=([2]))
in0Con39660 = tf.keras.layers.Input(shape=([5]))

Sep62817 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='valid', name = 'Sep62817', )(in0Sep62817)
Zer18482 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer18482', )(Sep62817)
Lea31413 = keras.layers.LeakyReLU(alpha=5.211048607150833, name = 'Lea31413', input_shape=(2, 1, 1, 2))(in0Lea31413)
Res56940 = keras.layers.Reshape((2, 1, 2), name = 'Res56940', )(Lea31413)
Glo48007 = keras.layers.GlobalAveragePooling2D(name = 'Glo48007', )(Res56940)
Res46179 = keras.layers.Reshape((2, 1), name = 'Res46179', )(Glo48007)
Res28612 = keras.layers.Reshape((2, 1, 1), name = 'Res28612', )(Res46179)
Max55720 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(1, 1), padding='same', name = 'Max55720', )(Res28612)
Con37951 = keras.layers.Concatenate(axis=3, name = 'Con37951', )([Max55720,in0Con37951])
Sub40576 = keras.layers.Subtract(name = 'Sub40576', )([Zer18482,Con37951])
Res6688 = keras.layers.Reshape((2, 3), name = 'Res6688', )(Sub40576)
Fla82295 = keras.layers.Flatten(name = 'Fla82295', )(Res6688)
Dot32032 = keras.layers.Dot(axes=(1, 1), name = 'Dot32032', )([in0Dot32032,in1Dot32032])
Con39660 = keras.layers.Concatenate(axis=1, name = 'Con39660', )([Dot32032,in0Con39660])
Min6158 = keras.layers.Minimum(name = 'Min6158', )([Fla82295,Con39660])
model = tf.keras.models.Model(inputs=[in0Sep62817,in0Lea31413,in0Con37951,in0Dot32032,in1Dot32032,in0Con39660], outputs=Min6158)
w = model.get_layer('Sep62817').get_weights() 
w[0] = np.array([[[[0.5725]]]])
w[1] = np.array([[[[0.0317, 0.567, 0.1423]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep62817').set_weights(w) 
in0Sep62817 = tf.constant([[[[0.0767]]]])
in0Lea31413 = tf.constant([[[[[0.1433, 0.7465]]], [[[0.1809, 0.3356]]]]])
in0Con37951 = tf.constant([[[[0.0171, 0.5097]], [[0.2401, 0.1775]]]])
in0Dot32032 = tf.constant([[0.2243, 0.6957]])
in1Dot32032 = tf.constant([[0.1466, 0.7545]])
in0Con39660 = tf.constant([[0.9183, 0.6456, 0.4817, 0.9754, 0.6439]])
print (np.array2string(model.predict([in0Sep62817,in0Lea31413,in0Con37951,in0Dot32032,in1Dot32032,in0Con39660],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min6158.png')

LSep62817 = separable_conv2D_layer([[[[0.0767]]]], 1, 1,[[[[[0.5725]]]],[[[[0.0317, 0.567, 0.1423]]]]],[0, 0, 0], 1, 1, false, Sep62817), 
LZer18482 = zero_padding2D_layer(Sep62817, 1, 0, 0, 0, Zer18482), 
LLea31413 = leaky_relu_layer([[[[[0.1433, 0.7465]]], [[[0.1809, 0.3356]]]]], 5.211048607150833, Lea31413), 
LRes56940 = reshape_layer(Lea31413, [2, 1, 2], Res56940), 
LGlo48007 = global_average_pooling2D_layer(Res56940, Glo48007), 
LRes46179 = reshape_layer(Glo48007, [2, 1], Res46179), 
LRes28612 = reshape_layer(Res46179, [2, 1, 1], Res28612), 
LMax55720 = max_pool2D_layer(Res28612, 2, 1, 1, 1, true, Max55720), 
LCon37951 = concatenate_layer([Max55720,[[[[0.0171, 0.5097]], [[0.2401, 0.1775]]]]], 3, Con37951), 
LSub40576 = subtract_layer(Zer18482,Con37951, Sub40576), 
LRes6688 = reshape_layer(Sub40576, [2, 3], Res6688), 
LFla82295 = flatten_layer(Res6688, Fla82295), 
LDot32032 = dot_layer([[0.2243, 0.6957]], [[0.1466, 0.7545]], 1, 1, Dot32032), 
LCon39660 = concatenate_layer([Dot32032,[[0.9183, 0.6456, 0.4817, 0.9754, 0.6439]]], 1, Con39660), 
LMin6158 = minimum_layer([Fla82295,Con39660], Min6158), 
exec_layers([LSep62817,LZer18482,LLea31413,LRes56940,LGlo48007,LRes46179,LRes28612,LMax55720,LCon37951,LSub40576,LRes6688,LFla82295,LDot32032,LCon39660,LMin6158],["Sep62817","Zer18482","Lea31413","Res56940","Glo48007","Res46179","Res28612","Max55720","Con37951","Sub40576","Res6688","Fla82295","Dot32032","Con39660","Min6158"],Min6158,"Min6158")

Actual (Unparsed): [[-0.5410500, -0.0171000, -0.5097000, -0.5396580, -0.2152026, -0.1712515]]

Expected (Unparsed): [[-0.54105,-0.0171,-0.5097,-0.5396580292250001,-0.21520260475,-0.171251500275]]

Actual:   [[-0.541, -0.0171, -0.5097, -0.5396, -0.2152, -0.1712]]

Expected: [[-0.541, -0.0171, -0.5097, -0.5396, -0.2152, -0.1712]]