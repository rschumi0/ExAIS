import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo44135 = tf.keras.layers.Input(shape=([1, 1]))
in0Glo54110 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con51120 = tf.keras.layers.Input(shape=([26]))

Glo44135 = keras.layers.GlobalAveragePooling1D(name = 'Glo44135', )(in0Glo44135)
Res44930 = keras.layers.Reshape((1, 1), name = 'Res44930', )(Glo44135)
Res5487 = keras.layers.Reshape((1, 1, 1), name = 'Res5487', )(Res44930)
Res62705 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res62705', )(Res5487)
Zer17078 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer17078', )(Res62705)
Res23739 = keras.layers.Reshape((3, 3, 3), name = 'Res23739', )(Zer17078)
Res20130 = keras.layers.Reshape((3, 9), name = 'Res20130', )(Res23739)
Fla29606 = keras.layers.Flatten(name = 'Fla29606', )(Res20130)
Glo54110 = keras.layers.GlobalMaxPool2D(name = 'Glo54110', )(in0Glo54110)
Mas15469 = keras.layers.Masking(mask_value=2, name = 'Mas15469', )(Glo54110)
Con51120 = keras.layers.Concatenate(axis=1, name = 'Con51120', )([Mas15469,in0Con51120])
Ave52441 = keras.layers.Average(name = 'Ave52441', )([Fla29606,Con51120])
Res41285 = keras.layers.Reshape((27, 1), name = 'Res41285', )(Ave52441)
Res34822 = keras.layers.Reshape((27, 1, 1), name = 'Res34822', )(Res41285)
Max7113 = keras.layers.MaxPool2D(pool_size=(8, 1), strides=(12, 1), padding='same', name = 'Max7113', )(Res34822)
model = tf.keras.models.Model(inputs=[in0Glo44135,in0Glo54110,in0Con51120], outputs=Max7113)
in0Glo44135 = tf.constant([[[1.669]]])
in0Glo54110 = tf.constant([[[[1.9603], [1.3662]]]])
in0Con51120 = tf.constant([[0.8062, 0.2261, 0.6474, 0.9147, 0.3723, 0.0171, 0.6765, 0.5549, 0.055, 0.327, 0.7146, 0.7835, 0.1778, 0.0816, 0.9165, 0.6933, 0.6423, 0.8255, 0.8396, 0.9812, 0.2412, 0.4509, 0.0038, 0.0711, 0.7356, 0.6055]])
print (np.array2string(model.predict([in0Glo44135,in0Glo54110,in0Con51120],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max7113.png')

LGlo44135 = global_average_pooling1D_layer([[[1.669]]], Glo44135), 
LRes44930 = reshape_layer(Glo44135, [1, 1], Res44930), 
LRes5487 = reshape_layer(Res44930, [1, 1, 1], Res5487), 
LRes62705 = reshape_layer(Res5487, [1, 1, 1, 1], Res62705), 
LZer17078 = zero_padding3D_layer(Res62705, 1, 1, 1, 1, 1, 1, Zer17078), 
LRes23739 = reshape_layer(Zer17078, [3, 3, 3], Res23739), 
LRes20130 = reshape_layer(Res23739, [3, 9], Res20130), 
LFla29606 = flatten_layer(Res20130, Fla29606), 
LGlo54110 = global_max_pool2D_layer([[[[1.9603], [1.3662]]]], Glo54110), 
LMas15469 = masking_layer(Glo54110, 2, Mas15469), 
LCon51120 = concatenate_layer([Mas15469,[[0.8062, 0.2261, 0.6474, 0.9147, 0.3723, 0.0171, 0.6765, 0.5549, 0.055, 0.327, 0.7146, 0.7835, 0.1778, 0.0816, 0.9165, 0.6933, 0.6423, 0.8255, 0.8396, 0.9812, 0.2412, 0.4509, 0.0038, 0.0711, 0.7356, 0.6055]]], 1, Con51120), 
LAve52441 = average_layer([Fla29606,Con51120], Ave52441), 
LRes41285 = reshape_layer(Ave52441, [27, 1], Res41285), 
LRes34822 = reshape_layer(Res41285, [27, 1, 1], Res34822), 
LMax7113 = max_pool2D_layer(Res34822, 8, 1, 12, 1, true, Max7113), 
exec_layers([LGlo44135,LRes44930,LRes5487,LRes62705,LZer17078,LRes23739,LRes20130,LFla29606,LGlo54110,LMas15469,LCon51120,LAve52441,LRes41285,LRes34822,LMax7113],["Glo44135","Res44930","Res5487","Res62705","Zer17078","Res23739","Res20130","Fla29606","Glo54110","Mas15469","Con51120","Ave52441","Res41285","Res34822","Max7113"],Max7113,"Max7113")

Actual (Unparsed): [[[[0.9801500]], [[0.9234000]], [[0.3678000]]]]

Expected (Unparsed): [[[[0.98015]],[[0.9234]],[[0.3678]]]]

Actual:   [[[[0.9802]], [[0.9234]], [[0.3678]]]]

Expected: [[[[0.9802]], [[0.9234]], [[0.3678]]]]