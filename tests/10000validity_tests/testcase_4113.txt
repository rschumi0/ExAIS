import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max78489 = tf.keras.layers.Input(shape=([2, 2]))
in1Max78489 = tf.keras.layers.Input(shape=([2, 2]))
in0Add83820 = tf.keras.layers.Input(shape=([1, 2]))
in1Add83820 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul463 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul463 = tf.keras.layers.Input(shape=([2, 2]))
in0Sim72338 = tf.keras.layers.Input(shape=([1, 1]))
in0Sub87157 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub87157 = tf.keras.layers.Input(shape=([3, 2]))
in0Glo45816 = tf.keras.layers.Input(shape=([2, 2]))
in0Con50574 = tf.keras.layers.Input(shape=([4]))

Max78489 = keras.layers.Maximum(name = 'Max78489', )([in0Max78489,in1Max78489])
Add83820 = keras.layers.Add(name = 'Add83820', )([in0Add83820,in1Add83820])
Zer45194 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer45194', )(Add83820)
Mul463 = keras.layers.Multiply(name = 'Mul463', )([in0Mul463,in1Mul463])
Min80864 = keras.layers.Minimum(name = 'Min80864', )([Zer45194,Mul463])
Min69236 = keras.layers.Minimum(name = 'Min69236', )([Max78489,Min80864])
Res32977 = keras.layers.Reshape((2, 2, 1), name = 'Res32977', )(Min69236)
Zer97021 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer97021', )(Res32977)
Sim72338 = keras.layers.SimpleRNN(3,name = 'Sim72338', )(in0Sim72338)
ReL50331 = keras.layers.ReLU(max_value=7.815209701922935, negative_slope=8.401883670066068, threshold=6.1314245007149095, name = 'ReL50331', )(Sim72338)
Res75513 = keras.layers.Reshape((3, 1), name = 'Res75513', )(ReL50331)
Res82831 = keras.layers.Reshape((3, 1, 1), name = 'Res82831', )(Res75513)
Sub87157 = keras.layers.Subtract(name = 'Sub87157', )([in0Sub87157,in1Sub87157])
Fla72295 = keras.layers.Flatten(name = 'Fla72295', )(Sub87157)
Glo45816 = keras.layers.GlobalAveragePooling1D(name = 'Glo45816', )(in0Glo45816)
Con50574 = keras.layers.Concatenate(axis=1, name = 'Con50574', )([Glo45816,in0Con50574])
Max93415 = keras.layers.Maximum(name = 'Max93415', )([Fla72295,Con50574])
Res40944 = keras.layers.Reshape((6, 1), name = 'Res40944', )(Max93415)
Res71464 = keras.layers.Reshape((6, 1, 1), name = 'Res71464', )(Res40944)
Cro58020 = keras.layers.Cropping2D(cropping=((5, 0), (0, 0)), name = 'Cro58020', )(Res71464)
Zer82004 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer82004', )(Cro58020)
Add45466 = keras.layers.Add(name = 'Add45466', )([Res82831,Zer82004])
Zer36736 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer36736', )(Add45466)
Min54417 = keras.layers.Minimum(name = 'Min54417', )([Zer97021,Zer36736])
model = tf.keras.models.Model(inputs=[in0Max78489,in1Max78489,in0Add83820,in1Add83820,in0Mul463,in1Mul463,in0Sim72338,in0Sub87157,in1Sub87157,in0Glo45816,in0Con50574], outputs=Min54417)
w = model.get_layer('Sim72338').get_weights() 
w[0] = np.array([[5, 4, 10]])
w[1] = np.array([[2, 10, 10], [5, 8, 3], [8, 9, 6]])
w[2] = np.array([1, 7, 10])
model.get_layer('Sim72338').set_weights(w) 
in0Max78489 = tf.constant([[[0.9303, 0.6373], [0.0249, 0.3281]]])
in1Max78489 = tf.constant([[[0.2276, 0.8498], [0.5271, 0.9232]]])
in0Add83820 = tf.constant([[[0.3836, 0.2929]]])
in1Add83820 = tf.constant([[[0.4368, 0.712]]])
in0Mul463 = tf.constant([[[0.9577, 0.1474], [0.9039, 0.3557]]])
in1Mul463 = tf.constant([[[0.947, 0.2607], [0.7137, 0.2099]]])
in0Sim72338 = tf.constant([[[9]]])
in0Sub87157 = tf.constant([[[0.1899, 0.4582], [0.9891, 0.9385], [0.0261, 0.132]]])
in1Sub87157 = tf.constant([[[0.0424, 0.5879], [0.2571, 0.4631], [0.2522, 0.7312]]])
in0Glo45816 = tf.constant([[[1.8718, 1.7516], [1.0826, 1.7292]]])
in0Con50574 = tf.constant([[0.0193, 0.4959, 0.1579, 0.4188]])
print (np.array2string(model.predict([in0Max78489,in1Max78489,in0Add83820,in1Add83820,in0Mul463,in1Mul463,in0Sim72338,in0Sub87157,in1Sub87157,in0Glo45816,in0Con50574],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min54417.png')

LMax78489 = maximum_layer([[[[0.9303, 0.6373], [0.0249, 0.3281]]], [[[0.2276, 0.8498], [0.5271, 0.9232]]]], Max78489), 
LAdd83820 = add_layer([[[[0.3836, 0.2929]]], [[[0.4368, 0.712]]]], Add83820), 
LZer45194 = zero_padding1D_layer(Add83820, 1, 0, Zer45194), 
LMul463 = multiply_layer([[[[0.9577, 0.1474], [0.9039, 0.3557]]], [[[0.947, 0.2607], [0.7137, 0.2099]]]], Mul463), 
LMin80864 = minimum_layer([Zer45194,Mul463], Min80864), 
LMin69236 = minimum_layer([Max78489,Min80864], Min69236), 
LRes32977 = reshape_layer(Min69236, [2, 2, 1], Res32977), 
LZer97021 = zero_padding2D_layer(Res32977, 1, 0, 1, 0, Zer97021), 
LSim72338 = simple_rnn_layer([[[9]]],[[5, 4, 10]],[[2, 10, 10], [5, 8, 3], [8, 9, 6]],[1, 7, 10], Sim72338), 
LReL50331 = relu_layer(Sim72338, 7.815209701922935, 8.401883670066068, 6.1314245007149095, ReL50331), 
LRes75513 = reshape_layer(ReL50331, [3, 1], Res75513), 
LRes82831 = reshape_layer(Res75513, [3, 1, 1], Res82831), 
LSub87157 = subtract_layer([[[0.1899, 0.4582], [0.9891, 0.9385], [0.0261, 0.132]]], [[[0.0424, 0.5879], [0.2571, 0.4631], [0.2522, 0.7312]]], Sub87157), 
LFla72295 = flatten_layer(Sub87157, Fla72295), 
LGlo45816 = global_average_pooling1D_layer([[[1.8718, 1.7516], [1.0826, 1.7292]]], Glo45816), 
LCon50574 = concatenate_layer([Glo45816,[[0.0193, 0.4959, 0.1579, 0.4188]]], 1, Con50574), 
LMax93415 = maximum_layer([Fla72295,Con50574], Max93415), 
LRes40944 = reshape_layer(Max93415, [6, 1], Res40944), 
LRes71464 = reshape_layer(Res40944, [6, 1, 1], Res71464), 
LCro58020 = cropping2D_layer(Res71464, 5, 0, 0, 0, Cro58020), 
LZer82004 = zero_padding2D_layer(Cro58020, 2, 0, 0, 0, Zer82004), 
LAdd45466 = add_layer([Res82831,Zer82004], Add45466), 
LZer36736 = zero_padding2D_layer(Add45466, 0, 0, 2, 0, Zer36736), 
LMin54417 = minimum_layer([Zer97021,Zer36736], Min54417), 
exec_layers([LMax78489,LAdd83820,LZer45194,LMul463,LMin80864,LMin69236,LRes32977,LZer97021,LSim72338,LReL50331,LRes75513,LRes82831,LSub87157,LFla72295,LGlo45816,LCon50574,LMax93415,LRes40944,LRes71464,LCro58020,LZer82004,LAdd45466,LZer36736,LMin54417],["Max78489","Add83820","Zer45194","Mul463","Min80864","Min69236","Res32977","Zer97021","Sim72338","ReL50331","Res75513","Res82831","Sub87157","Fla72295","Glo45816","Con50574","Max93415","Res40944","Res71464","Cro58020","Zer82004","Add45466","Zer36736","Min54417"],Min54417,"Min54417")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [-43.1136317]], [[0.0000000], [0.0000000], [-43.1136317]], [[0.0000000], [0.0000000], [-42.6948317]]]]

Expected (Unparsed): [[[[0],[0],[-43.11363171673352]],[[0],[0],[-43.11363171673352]],[[0],[0],[-42.694831716733525]]]]

Actual:   [[[[0], [0], [-43.1136]], [[0], [0], [-43.1136]], [[0], [0], [-42.6948]]]]

Expected: [[[[0], [0], [-43.1136]], [[0], [0], [-43.1136]], [[0], [0], [-42.6948]]]]