import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den31198 = tf.keras.layers.Input(shape=([4, 4, 5]))
in0Sub51041 = tf.keras.layers.Input(shape=([2, 3, 2]))
in1Sub51041 = tf.keras.layers.Input(shape=([2, 3, 2]))

Den31198 = keras.layers.Dense(3,name = 'Den31198', )(in0Den31198)
Res76160 = keras.layers.Reshape((4, 4, 3, 1), name = 'Res76160', )(Den31198)
Zer20850 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer20850', )(Res76160)
Sub51041 = keras.layers.Subtract(name = 'Sub51041', )([in0Sub51041,in1Sub51041])
ReL97792 = keras.layers.ReLU(max_value=1.7555770286116963, negative_slope=3.634892828914284, threshold=9.413973095839914, name = 'ReL97792', )(Sub51041)
Res98507 = keras.layers.Reshape((2, 3, 2, 1), name = 'Res98507', )(ReL97792)
PRe49657 = keras.layers.PReLU(name = 'PRe49657', )(Res98507)
Zer33781 = keras.layers.ZeroPadding3D(padding=((4, 0), (3, 0), (3, 0)), name = 'Zer33781', )(PRe49657)
Max52514 = keras.layers.Maximum(name = 'Max52514', )([Zer20850,Zer33781])
model = tf.keras.models.Model(inputs=[in0Den31198,in0Sub51041,in1Sub51041], outputs=Max52514)
w = model.get_layer('Den31198').get_weights() 
w[0] = np.array([[0.9502, 0.1333, 0.2679], [0.1817, 0.3251, 0.2558], [0.3508, 0.1696, 0.0955], [0.1875, 0.6969, 0.0901], [0.4245, 0.8032, 0.968]])
w[1] = np.array([0.9104, 0.3419, 0.92])
model.get_layer('Den31198').set_weights(w) 
w = model.get_layer('PRe49657').get_weights() 
w[0] = np.array([[[[0.4383], [0.606]], [[0.2817], [0.7184]], [[0.3206], [0.8794]]], [[[0.6269], [0.5894]], [[0.3175], [0.2563]], [[0.5483], [0.9324]]]])
model.get_layer('PRe49657').set_weights(w) 
in0Den31198 = tf.constant([[[[0.4878, 0.5164, 0.5462, 0.7341, 0.2893], [0.7405, 0.5225, 0.4453, 0.2834, 0.8231], [0.0377, 0.547, 0.0298, 0.4342, 0.2896], [0.1388, 0.7062, 0.9433, 0.339, 0.6225]], [[0.5432, 0.6932, 0.0689, 0.2443, 0.4981], [0.3836, 0.9008, 0.875, 0.521, 0.0904], [0.4929, 0.113, 0.7951, 0.9197, 0.8725], [0.6019, 0.0179, 0.6768, 0.8486, 0.6557]], [[0.1313, 0.2145, 0.0871, 0.9056, 0.9036], [0.3192, 0.9385, 0.6972, 0.422, 0.091], [0.9591, 0.3985, 0.8642, 0.7793, 0.0819], [0.6078, 0.8793, 0.9463, 0.5631, 0.4931]], [[0.536, 0.6478, 0.1513, 0.1388, 0.0704], [0.0461, 0.414, 0.8267, 0.6015, 0.4963], [0.788, 0.6374, 0.5738, 0.6879, 0.7173], [0.6221, 0.9326, 0.8609, 0.1924, 0.0653]]]])
in0Sub51041 = tf.constant([[[[0.9414, 0.4702], [0.1095, 0.0347], [0.1107, 0.92]], [[0.1322, 0.4998], [0.9225, 0.1579], [0.158, 0.7874]]]])
in1Sub51041 = tf.constant([[[[0.9069, 0.9805], [0.0638, 0.0402], [0.1577, 0.8796]], [[0.1406, 0.6436], [0.5538, 0.1348], [0.5117, 0.2971]]]])
print (np.array2string(model.predict([in0Den31198,in0Sub51041,in1Sub51041],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max52514.png')

LDen31198 = dense_layer([[[[0.4878, 0.5164, 0.5462, 0.7341, 0.2893], [0.7405, 0.5225, 0.4453, 0.2834, 0.8231], [0.0377, 0.547, 0.0298, 0.4342, 0.2896], [0.1388, 0.7062, 0.9433, 0.339, 0.6225]], [[0.5432, 0.6932, 0.0689, 0.2443, 0.4981], [0.3836, 0.9008, 0.875, 0.521, 0.0904], [0.4929, 0.113, 0.7951, 0.9197, 0.8725], [0.6019, 0.0179, 0.6768, 0.8486, 0.6557]], [[0.1313, 0.2145, 0.0871, 0.9056, 0.9036], [0.3192, 0.9385, 0.6972, 0.422, 0.091], [0.9591, 0.3985, 0.8642, 0.7793, 0.0819], [0.6078, 0.8793, 0.9463, 0.5631, 0.4931]], [[0.536, 0.6478, 0.1513, 0.1388, 0.0704], [0.0461, 0.414, 0.8267, 0.6015, 0.4963], [0.788, 0.6374, 0.5738, 0.6879, 0.7173], [0.6221, 0.9326, 0.8609, 0.1924, 0.0653]]]], [[0.9502, 0.1333, 0.2679], [0.1817, 0.3251, 0.2558], [0.3508, 0.1696, 0.0955], [0.1875, 0.6969, 0.0901], [0.4245, 0.8032, 0.968]],[0.9104, 0.3419, 0.92], Den31198), 
LRes76160 = reshape_layer(Den31198, [4, 4, 3, 1], Res76160), 
LZer20850 = zero_padding3D_layer(Res76160, 1, 1, 1, 1, 1, 1, Zer20850), 
LSub51041 = subtract_layer([[[[0.9414, 0.4702], [0.1095, 0.0347], [0.1107, 0.92]], [[0.1322, 0.4998], [0.9225, 0.1579], [0.158, 0.7874]]]], [[[[0.9069, 0.9805], [0.0638, 0.0402], [0.1577, 0.8796]], [[0.1406, 0.6436], [0.5538, 0.1348], [0.5117, 0.2971]]]], Sub51041), 
LReL97792 = relu_layer(Sub51041, 1.7555770286116963, 3.634892828914284, 9.413973095839914, ReL97792), 
LRes98507 = reshape_layer(ReL97792, [2, 3, 2, 1], Res98507), 
LPRe49657 = prelu_layer(Res98507, [[[[0.4383], [0.606]], [[0.2817], [0.7184]], [[0.3206], [0.8794]]], [[[0.6269], [0.5894]], [[0.3175], [0.2563]], [[0.5483], [0.9324]]]], PRe49657), 
LZer33781 = zero_padding3D_layer(PRe49657, 4, 0, 3, 0, 3, 0, Zer33781), 
LMax52514 = maximum_layer([Zer20850,Zer33781], Max52514), 
exec_layers([LDen31198,LRes76160,LZer20850,LSub51041,LReL97792,LRes98507,LPRe49657,LZer33781,LMax52514],["Den31198","Res76160","Zer20850","Sub51041","ReL97792","Res98507","PRe49657","Zer33781","Max52514"],Max52514,"Max52514")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.9197960], [1.4114009], [1.5811236], [0.0000000]], [[0.0000000], [2.2677160], [1.5446116], [2.1168567], [0.0000000]], [[0.0000000], [1.2604140], [1.0650099], [1.3923226], [0.0000000]], [[0.0000000], [1.8293277], [1.4862124], [1.8610395], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.8339229], [1.2216799], [1.7535960], [0.0000000]], [[0.0000000], [1.8815844], [1.2699782], [1.4712029], [0.0000000]], [[0.0000000], [2.2210268], [1.9209198], [2.0843303], [0.0000000]], [[0.0000000], [2.1604564], [1.6607854], [1.8616387], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.6580688], [1.8007925], [1.9746418], [0.0000000]], [[0.0000000], [1.7465616], [1.1749838], [1.4382748], [0.0000000]], [[0.0000000], [2.3781909], [1.3547449], [1.5109044], [0.0000000]], [[0.0000000], [2.2945646], [1.6577549], [1.9261823], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.6463983], [0.8028841], [1.3244039], [0.0000000]], [[0.0000000], [1.6428950], [1.4406583], [1.6518148], [0.0000000]], [[0.0000000], [2.4097373], [1.8070085], [2.1052762], [0.0000000]], [[0.0000000], [2.0367714], [1.0605554], [1.4879813], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[1.9197960000000003],[1.41140095],[1.58112365],[0]],[[0],[2.2677160400000003],[1.54461166],[2.1168567400000002],[0]],[[0],[1.2604139799999998],[1.0650098899999998],[1.3923225500000003],[0]],[[0],[1.82932769],[1.48621244],[1.8610395300000002],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[1.8339229000000001],[1.22167991],[1.75359602],[0]],[[0],[1.88158438],[1.2699781399999999],[1.47120288],[0]],[[0],[2.22102676],[1.92091976],[2.08433033],[0]],[[0],[2.1604564],[1.66078542],[1.8616386900000002],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[1.6580687899999997],[1.8007925599999997],[1.9746417800000002],[0]],[[0],[1.7465615500000002],[1.17498383],[1.4382747799999998],[0]],[[0],[2.3781909299999997],[1.3547449499999997],[1.51090442],[0]],[[0],[2.29456461],[1.65775496],[1.9261823200000001],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[1.6463983],[0.80288406],[1.32440387],[0]],[[0],[1.6428949800000001],[1.44065836],[1.6518147900000002],[0]],[[0],[2.40973732],[1.80700849],[2.1052762100000004],[0]],[[0],[2.03677141],[1.06055535],[1.48798126],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [1.9198], [1.4115], [1.5812], [0]], [[0], [2.2678], [1.5447], [2.1169], [0]], [[0], [1.2605], [1.0651], [1.3924], [0]], [[0], [1.8294], [1.4863], [1.8611], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [1.834], [1.2217], [1.7536], [0]], [[0], [1.8816], [1.27], [1.4713], [0]], [[0], [2.2211], [1.921], [2.0844], [0]], [[0], [2.1605], [1.6608], [1.8617], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [1.6581], [1.8008], [1.9747], [0]], [[0], [1.7466], [1.175], [1.4383], [0]], [[0], [2.3782], [1.3548], [1.511], [0]], [[0], [2.2946], [1.6578], [1.9262], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [1.6464], [0.8029], [1.3245], [0]], [[0], [1.6429], [1.4407], [1.6519], [0]], [[0], [2.4098], [1.8071], [2.1053], [0]], [[0], [2.0368], [1.0606], [1.488], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]]]]

Expected: [[[[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [1.9198], [1.4115], [1.5812], [0]], [[0], [2.2678], [1.5447], [2.1169], [0]], [[0], [1.2605], [1.0651], [1.3924], [0]], [[0], [1.8294], [1.4863], [1.8611], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [1.834], [1.2217], [1.7536], [0]], [[0], [1.8816], [1.27], [1.4713], [0]], [[0], [2.2211], [1.921], [2.0844], [0]], [[0], [2.1605], [1.6608], [1.8617], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [1.6581], [1.8008], [1.9747], [0]], [[0], [1.7466], [1.175], [1.4383], [0]], [[0], [2.3782], [1.3548], [1.511], [0]], [[0], [2.2946], [1.6578], [1.9262], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [1.6464], [0.8029], [1.3245], [0]], [[0], [1.6429], [1.4407], [1.6519], [0]], [[0], [2.4098], [1.8071], [2.1053], [0]], [[0], [2.0368], [1.0606], [1.488], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]]]]