import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave21397 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave21397 = tf.keras.layers.Input(shape=([1, 2, 2]))

Ave21397 = keras.layers.Average(name = 'Ave21397', )([in0Ave21397,in1Ave21397])
Den15345 = keras.layers.Dense(3,name = 'Den15345', )(Ave21397)
model = tf.keras.models.Model(inputs=[in0Ave21397,in1Ave21397], outputs=Den15345)
w = model.get_layer('Den15345').get_weights() 
w[0] = np.array([[0.5629, 0.3743, 0.0928], [0.2431, 0.3639, 0.727]])
w[1] = np.array([0.1597, 0.2554, 0.5447])
model.get_layer('Den15345').set_weights(w) 
in0Ave21397 = tf.constant([[[[0.3315, 0.5599], [0.6743, 0.3603]]]])
in1Ave21397 = tf.constant([[[[0.296, 0.4423], [0.8555, 0.0011]]]])
print (np.array2string(model.predict([in0Ave21397,in1Ave21397],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den15345.png')

LAve21397 = average_layer([[[[[0.3315, 0.5599], [0.6743, 0.3603]]]], [[[[0.296, 0.4423], [0.8555, 0.0011]]]]], Ave21397), 
LDen15345 = dense_layer(Ave21397, [[0.5629, 0.3743, 0.0928], [0.2431, 0.3639, 0.727]],[0.1597, 0.2554, 0.5447], Den15345), 
exec_layers([LAve21397,LDen15345],["Ave21397","Den15345"],Den15345,"Den15345")

Actual (Unparsed): [[[[0.4581273, 0.5551869, 0.9381157], [0.6341904, 0.6074588, 0.7470516]]]]

Expected (Unparsed): [[[[0.458127285,0.5551869150000001,0.9381157],[0.63419038,0.6074588000000001,0.7470516199999999]]]]

Actual:   [[[[0.4582, 0.5552, 0.9382], [0.6342, 0.6075, 0.7471]]]]

Expected: [[[[0.4582, 0.5552, 0.9382], [0.6342, 0.6075, 0.7471]]]]