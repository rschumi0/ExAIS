import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub11621 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub11621 = tf.keras.layers.Input(shape=([2, 2]))

Sub11621 = keras.layers.Subtract(name = 'Sub11621', )([in0Sub11621,in1Sub11621])
Res71612 = keras.layers.Reshape((2, 2, 1), name = 'Res71612', )(Sub11621)
Con98610 = keras.layers.Conv2D(2, (2, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con98610', )(Res71612)
Fla29064 = keras.layers.Flatten(name = 'Fla29064', )(Con98610)
Res73371 = keras.layers.Reshape((4, 1), name = 'Res73371', )(Fla29064)
Res71043 = keras.layers.Reshape((4, 1, 1), name = 'Res71043', )(Res73371)
Zer8857 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer8857', )(Res71043)
model = tf.keras.models.Model(inputs=[in0Sub11621,in1Sub11621], outputs=Zer8857)
w = model.get_layer('Con98610').get_weights() 
w[0] = np.array([[[[0.7203, 0.5809]]], [[[0.9519, 0.4394]]]])
w[1] = np.array([0, 0])
model.get_layer('Con98610').set_weights(w) 
in0Sub11621 = tf.constant([[[0.4555, 0.0946], [0.1991, 0.1122]]])
in1Sub11621 = tf.constant([[[0.6521, 0.3173], [0.0531, 0.4105]]])
print (np.array2string(model.predict([in0Sub11621,in1Sub11621],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer8857.png')

LSub11621 = subtract_layer([[[0.4555, 0.0946], [0.1991, 0.1122]]], [[[0.6521, 0.3173], [0.0531, 0.4105]]], Sub11621), 
LRes71612 = reshape_layer(Sub11621, [2, 2, 1], Res71612), 
LCon98610 = conv2D_layer(Res71612, 2, 1,[[[[0.7203, 0.5809]]], [[[0.9519, 0.4394]]]],[0, 0], 1, 1, false, 1, 1, Con98610), 
LFla29064 = flatten_layer(Con98610, Fla29064), 
LRes73371 = reshape_layer(Fla29064, [4, 1], Res73371), 
LRes71043 = reshape_layer(Res73371, [4, 1, 1], Res71043), 
LZer8857 = zero_padding2D_layer(Res71043, 1, 1, 1, 1, Zer8857), 
exec_layers([LSub11621,LRes71612,LCon98610,LFla29064,LRes73371,LRes71043,LZer8857],["Sub11621","Res71612","Con98610","Fla29064","Res73371","Res71043","Zer8857"],Zer8857,"Zer8857")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0026336], [0.0000000]], [[0.0000000], [-0.0500526], [0.0000000]], [[0.0000000], [-0.4443626], [0.0000000]], [[0.0000000], [-0.2604394], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[-0.0026335800000000242],[0]],[[0],[-0.05005253999999999],[0]],[[0],[-0.44436258],[0]],[[0],[-0.26043945],[0]],[[0],[0],[0]]]]

Actual:   [[[[0], [0], [0]], [[0], [-0.0026], [0]], [[0], [-0.05], [0]], [[0], [-0.4443], [0]], [[0], [-0.2604], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [-0.0026], [0]], [[0], [-0.05], [0]], [[0], [-0.4443], [0]], [[0], [-0.2604], [0]], [[0], [0], [0]]]]