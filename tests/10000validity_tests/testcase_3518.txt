import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add73109 = tf.keras.layers.Input(shape=([2, 2]))
in1Add73109 = tf.keras.layers.Input(shape=([2, 2]))
in0Con93657 = tf.keras.layers.Input(shape=([20]))
in0Up_10085 = tf.keras.layers.Input(shape=([1, 1, 4]))
in0Max94679 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max94679 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con69100 = tf.keras.layers.Input(shape=([2, 1]))
in0Add8488 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add8488 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con13130 = tf.keras.layers.Input(shape=([3, 7]))
in0Min3596 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Min3596 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Con40082 = tf.keras.layers.Input(shape=([21]))

Add73109 = keras.layers.Add(name = 'Add73109', )([in0Add73109,in1Add73109])
Fla83741 = keras.layers.Flatten(name = 'Fla83741', )(Add73109)
Con93657 = keras.layers.Concatenate(axis=1, name = 'Con93657', )([Fla83741,in0Con93657])
Up_10085 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_10085', )(in0Up_10085)
Res3367 = keras.layers.Reshape((2, 8), name = 'Res3367', )(Up_10085)
Zer98947 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer98947', )(Res3367)
Max94679 = keras.layers.Maximum(name = 'Max94679', )([in0Max94679,in1Max94679])
Res95778 = keras.layers.Reshape((2, 2), name = 'Res95778', )(Max94679)
Con69100 = keras.layers.Concatenate(axis=2, name = 'Con69100', )([Res95778,in0Con69100])
Add8488 = keras.layers.Add(name = 'Add8488', )([in0Add8488,in1Add8488])
Res96227 = keras.layers.Reshape((1, 1), name = 'Res96227', )(Add8488)
Zer52137 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer52137', )(Res96227)
Dot33719 = keras.layers.Dot(axes=(1, 1), name = 'Dot33719', )([Con69100,Zer52137])
Con13130 = keras.layers.Concatenate(axis=2, name = 'Con13130', )([Dot33719,in0Con13130])
Mul74726 = keras.layers.Multiply(name = 'Mul74726', )([Zer98947,Con13130])
Fla90168 = keras.layers.Flatten(name = 'Fla90168', )(Mul74726)
Min3596 = keras.layers.Minimum(name = 'Min3596', )([in0Min3596,in1Min3596])
Res13982 = keras.layers.Reshape((2, 2, 4), name = 'Res13982', )(Min3596)
Res73430 = keras.layers.Reshape((2, 8), name = 'Res73430', )(Res13982)
LST67646 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST67646', )(Res73430)
Con40082 = keras.layers.Concatenate(axis=1, name = 'Con40082', )([LST67646,in0Con40082])
Max34887 = keras.layers.Maximum(name = 'Max34887', )([Fla90168,Con40082])
Dot10356 = keras.layers.Dot(axes=(1, 1), name = 'Dot10356', )([Con93657,Max34887])
model = tf.keras.models.Model(inputs=[in0Add73109,in1Add73109,in0Con93657,in0Up_10085,in0Max94679,in1Max94679,in0Con69100,in0Add8488,in1Add8488,in0Con13130,in0Min3596,in1Min3596,in0Con40082], outputs=Dot10356)
w = model.get_layer('LST67646').get_weights() 
w[0] = np.array([[6, 2, 6, 8, 6, 3, 4, 9, 6, 5, 4, 4], [3, 1, 4, 8, 8, 5, 4, 1, 8, 6, 3, 3], [2, 1, 7, 4, 6, 2, 7, 2, 3, 5, 7, 10], [1, 10, 5, 2, 4, 6, 4, 10, 8, 7, 10, 1], [2, 3, 2, 9, 7, 2, 2, 9, 1, 6, 5, 8], [8, 4, 9, 1, 6, 4, 9, 8, 9, 10, 8, 4], [8, 8, 1, 10, 5, 2, 6, 10, 10, 8, 5, 7], [10, 7, 2, 3, 8, 6, 7, 7, 5, 4, 1, 2]])
w[1] = np.array([[2, 10, 6, 2, 7, 4, 9, 8, 9, 4, 9, 10], [9, 8, 8, 4, 6, 4, 4, 7, 1, 10, 6, 4], [4, 3, 3, 9, 5, 4, 3, 4, 2, 6, 7, 10]])
w[2] = np.array([6, 7, 8, 10, 3, 6, 3, 8, 5, 1, 10, 5])
model.get_layer('LST67646').set_weights(w) 
in0Add73109 = tf.constant([[[0.9299, 0.8435], [0.8066, 0.3087]]])
in1Add73109 = tf.constant([[[0.2027, 0.8369], [0.7683, 0.2196]]])
in0Con93657 = tf.constant([[0.042, 0.369, 0.5909, 0.0744, 0.418, 0.7795, 0.79, 0.4234, 0.3403, 0.3906, 0.7784, 0.9873, 0.7706, 0.9974, 0.3486, 0.7965, 0.2998, 0.4609, 0.9872, 0.1949]])
in0Up_10085 = tf.constant([[[[1.6947, 1.0505, 1.2173, 1.4831]]]])
in0Max94679 = tf.constant([[[[0.7418], [0.7999]], [[0.8045], [0.0906]]]])
in1Max94679 = tf.constant([[[[0.4759], [0.3535]], [[0.294], [0.7257]]]])
in0Con69100 = tf.constant([[[0.6123], [0.8173]]])
in0Add8488 = tf.constant([[[[0.9406]]]])
in1Add8488 = tf.constant([[[[0.9846]]]])
in0Con13130 = tf.constant([[[0.4405, 0.4684, 0.3902, 0.986, 0.03, 0.5049, 0.6748], [0.3015, 0.1768, 0.0154, 0.4851, 0.6168, 0.3815, 0.4854], [0.1026, 0.0152, 0.4292, 0.8224, 0.4257, 0.9757, 0.8144]]])
in0Min3596 = tf.constant([[[[[0.9737, 0.9986], [0.3518, 0.1375]], [[0.8373, 0.3628], [0.7758, 0.5473]]], [[[0.1041, 0.6184], [0.6552, 0.1629]], [[0.0652, 0.8043], [0.5507, 0.762]]]]])
in1Min3596 = tf.constant([[[[[0.9491, 0.7142], [0.1871, 0.2193]], [[0.4868, 0.2286], [0.3926, 0.4906]]], [[[0.1182, 0.1554], [0.8029, 0.5089]], [[0.337, 0.2882], [0.2644, 0.3557]]]]])
in0Con40082 = tf.constant([[0.5967, 0.5789, 0.8934, 0.5997, 0.6206, 0.9783, 0.5957, 0.582, 0.1725, 0.6399, 0.7501, 0.1654, 0.1042, 0.2481, 0.3736, 0.9064, 0.0905, 0.6095, 0.3252, 0.441, 0.6731]])
print (np.array2string(model.predict([in0Add73109,in1Add73109,in0Con93657,in0Up_10085,in0Max94679,in1Max94679,in0Con69100,in0Add8488,in1Add8488,in0Con13130,in0Min3596,in1Min3596,in0Con40082],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot10356.png')

LAdd73109 = add_layer([[[[0.9299, 0.8435], [0.8066, 0.3087]]], [[[0.2027, 0.8369], [0.7683, 0.2196]]]], Add73109), 
LFla83741 = flatten_layer(Add73109, Fla83741), 
LCon93657 = concatenate_layer([Fla83741,[[0.042, 0.369, 0.5909, 0.0744, 0.418, 0.7795, 0.79, 0.4234, 0.3403, 0.3906, 0.7784, 0.9873, 0.7706, 0.9974, 0.3486, 0.7965, 0.2998, 0.4609, 0.9872, 0.1949]]], 1, Con93657), 
LUp_10085 = up_sampling2D_layer([[[[1.6947, 1.0505, 1.2173, 1.4831]]]], 2, 2, Up_10085), 
LRes3367 = reshape_layer(Up_10085, [2, 8], Res3367), 
LZer98947 = zero_padding1D_layer(Res3367, 1, 0, Zer98947), 
LMax94679 = maximum_layer([[[[[0.7418], [0.7999]], [[0.8045], [0.0906]]]], [[[[0.4759], [0.3535]], [[0.294], [0.7257]]]]], Max94679), 
LRes95778 = reshape_layer(Max94679, [2, 2], Res95778), 
LCon69100 = concatenate_layer([Res95778,[[[0.6123], [0.8173]]]], 2, Con69100), 
LAdd8488 = add_layer([[[[[0.9406]]]], [[[[0.9846]]]]], Add8488), 
LRes96227 = reshape_layer(Add8488, [1, 1], Res96227), 
LZer52137 = zero_padding1D_layer(Res96227, 1, 0, Zer52137), 
LDot33719 = dot_layer(Con69100,Zer52137, 1, 1, Dot33719), 
LCon13130 = concatenate_layer([Dot33719,[[[0.4405, 0.4684, 0.3902, 0.986, 0.03, 0.5049, 0.6748], [0.3015, 0.1768, 0.0154, 0.4851, 0.6168, 0.3815, 0.4854], [0.1026, 0.0152, 0.4292, 0.8224, 0.4257, 0.9757, 0.8144]]]], 2, Con13130), 
LMul74726 = multiply_layer([Zer98947,Con13130], Mul74726), 
LFla90168 = flatten_layer(Mul74726, Fla90168), 
LMin3596 = minimum_layer([[[[[[0.9737, 0.9986], [0.3518, 0.1375]], [[0.8373, 0.3628], [0.7758, 0.5473]]], [[[0.1041, 0.6184], [0.6552, 0.1629]], [[0.0652, 0.8043], [0.5507, 0.762]]]]], [[[[[0.9491, 0.7142], [0.1871, 0.2193]], [[0.4868, 0.2286], [0.3926, 0.4906]]], [[[0.1182, 0.1554], [0.8029, 0.5089]], [[0.337, 0.2882], [0.2644, 0.3557]]]]]], Min3596), 
LRes13982 = reshape_layer(Min3596, [2, 2, 4], Res13982), 
LRes73430 = reshape_layer(Res13982, [2, 8], Res73430), 
LLST67646 = lstm_layer(Res73430,[[6, 2, 6, 8, 6, 3, 4, 9, 6, 5, 4, 4], [3, 1, 4, 8, 8, 5, 4, 1, 8, 6, 3, 3], [2, 1, 7, 4, 6, 2, 7, 2, 3, 5, 7, 10], [1, 10, 5, 2, 4, 6, 4, 10, 8, 7, 10, 1], [2, 3, 2, 9, 7, 2, 2, 9, 1, 6, 5, 8], [8, 4, 9, 1, 6, 4, 9, 8, 9, 10, 8, 4], [8, 8, 1, 10, 5, 2, 6, 10, 10, 8, 5, 7], [10, 7, 2, 3, 8, 6, 7, 7, 5, 4, 1, 2]],[[2, 10, 6, 2, 7, 4, 9, 8, 9, 4, 9, 10], [9, 8, 8, 4, 6, 4, 4, 7, 1, 10, 6, 4], [4, 3, 3, 9, 5, 4, 3, 4, 2, 6, 7, 10]],[6, 7, 8, 10, 3, 6, 3, 8, 5, 1, 10, 5], LST67646), 
LCon40082 = concatenate_layer([LST67646,[[0.5967, 0.5789, 0.8934, 0.5997, 0.6206, 0.9783, 0.5957, 0.582, 0.1725, 0.6399, 0.7501, 0.1654, 0.1042, 0.2481, 0.3736, 0.9064, 0.0905, 0.6095, 0.3252, 0.441, 0.6731]]], 1, Con40082), 
LMax34887 = maximum_layer([Fla90168,Con40082], Max34887), 
LDot10356 = dot_layer(Con93657,Max34887, 1, 1, Dot10356), 
exec_layers([LAdd73109,LFla83741,LCon93657,LUp_10085,LRes3367,LZer98947,LMax94679,LRes95778,LCon69100,LAdd8488,LRes96227,LZer52137,LDot33719,LCon13130,LMul74726,LFla90168,LMin3596,LRes13982,LRes73430,LLST67646,LCon40082,LMax34887,LDot10356],["Add73109","Fla83741","Con93657","Up_10085","Res3367","Zer98947","Max94679","Res95778","Con69100","Add8488","Res96227","Zer52137","Dot33719","Con13130","Mul74726","Fla90168","Min3596","Res13982","Res73430","LST67646","Con40082","Max34887","Dot10356"],Dot10356,"Dot10356")

Actual (Unparsed): [[14.2139908]]

Expected (Unparsed): [[14.213990411734807]]

Actual:   [[14.214]]

Expected: [[14.214]]