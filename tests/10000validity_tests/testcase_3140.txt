import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub61299 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub61299 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Mul16417 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul16417 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Ave2856 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave2856 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Min57923 = tf.keras.layers.Input(shape=([1, 1]))
in1Min57923 = tf.keras.layers.Input(shape=([1, 1]))
in0Con30214 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Ave24723 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Ave24723 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Sub61299 = keras.layers.Subtract(name = 'Sub61299', )([in0Sub61299,in1Sub61299])
Mul16417 = keras.layers.Multiply(name = 'Mul16417', )([in0Mul16417,in1Mul16417])
Zer63538 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer63538', )(Mul16417)
Sub45218 = keras.layers.Subtract(name = 'Sub45218', )([Sub61299,Zer63538])
Res75303 = keras.layers.Reshape((2, 4), name = 'Res75303', )(Sub45218)
Loc7518 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc7518', )(Res75303)
Res495 = keras.layers.Reshape((1, 3, 1), name = 'Res495', )(Loc7518)
Zer6469 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer6469', )(Res495)
Ave2856 = keras.layers.Average(name = 'Ave2856', )([in0Ave2856,in1Ave2856])
Res13274 = keras.layers.Reshape((2, 2), name = 'Res13274', )(Ave2856)
Up_65173 = keras.layers.UpSampling1D(size=(1), name = 'Up_65173', )(Res13274)
Res58329 = keras.layers.Reshape((2, 2, 1), name = 'Res58329', )(Up_65173)
Min57923 = keras.layers.Minimum(name = 'Min57923', )([in0Min57923,in1Min57923])
Res73736 = keras.layers.Reshape((1, 1, 1), name = 'Res73736', )(Min57923)
Res50607 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res50607', )(Res73736)
Zer63569 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer63569', )(Res50607)
Con30214 = keras.layers.Concatenate(axis=4, name = 'Con30214', )([Zer63569,in0Con30214])
Ave24723 = keras.layers.Average(name = 'Ave24723', )([in0Ave24723,in1Ave24723])
Sub18689 = keras.layers.Subtract(name = 'Sub18689', )([Con30214,Ave24723])
Res71698 = keras.layers.Reshape((2, 2, 1), name = 'Res71698', )(Sub18689)
Mul76147 = keras.layers.Multiply(name = 'Mul76147', )([Res58329,Res71698])
Zer5830 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer5830', )(Mul76147)
Min49396 = keras.layers.Minimum(name = 'Min49396', )([Zer6469,Zer5830])
model = tf.keras.models.Model(inputs=[in0Sub61299,in1Sub61299,in0Mul16417,in1Mul16417,in0Ave2856,in1Ave2856,in0Min57923,in1Min57923,in0Con30214,in0Ave24723,in1Ave24723], outputs=Min49396)
w = model.get_layer('Loc7518').get_weights() 
w[0] = np.array([[[0.6993, 0.2986, 0.0357], [0.7352, 0.7451, 0.8915], [0.1563, 0.1224, 0.4377], [0.2862, 0.3094, 0.9942], [0.3636, 0.1183, 0.8991], [0.3117, 0.2675, 0.2426], [0.0905, 0.3069, 0.0727], [0.8832, 0.8348, 0.551]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc7518').set_weights(w) 
in0Sub61299 = tf.constant([[[[0.5193, 0.9833], [0.9749, 0.1436]], [[0.1989, 0.5131], [0.6074, 0.8135]]]])
in1Sub61299 = tf.constant([[[[0.9194, 0.7131], [0.6308, 0.4412]], [[0.3253, 0.2666], [0.4795, 0.2128]]]])
in0Mul16417 = tf.constant([[[[0.5591, 0.7221], [0.0818, 0.747]]]])
in1Mul16417 = tf.constant([[[[0.5333, 0.4782], [0.3437, 0.4809]]]])
in0Ave2856 = tf.constant([[[[0.8378], [0.844]], [[0.0821], [0.321]]]])
in1Ave2856 = tf.constant([[[[0.795], [0.7091]], [[0.0531], [0.5463]]]])
in0Min57923 = tf.constant([[[0.9827]]])
in1Min57923 = tf.constant([[[0.8626]]])
in0Con30214 = tf.constant([[[[[0.1], [0.8815]]]]])
in0Ave24723 = tf.constant([[[[[0.2341, 0.2832], [0.0109, 0.4126]]]]])
in1Ave24723 = tf.constant([[[[[0.1869, 0.6091], [0.4613, 0.0728]]]]])
print (np.array2string(model.predict([in0Sub61299,in1Sub61299,in0Mul16417,in1Mul16417,in0Ave2856,in1Ave2856,in0Min57923,in1Min57923,in0Con30214,in0Ave24723,in1Ave24723],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min49396.png')

LSub61299 = subtract_layer([[[[0.5193, 0.9833], [0.9749, 0.1436]], [[0.1989, 0.5131], [0.6074, 0.8135]]]], [[[[0.9194, 0.7131], [0.6308, 0.4412]], [[0.3253, 0.2666], [0.4795, 0.2128]]]], Sub61299), 
LMul16417 = multiply_layer([[[[[0.5591, 0.7221], [0.0818, 0.747]]]], [[[[0.5333, 0.4782], [0.3437, 0.4809]]]]], Mul16417), 
LZer63538 = zero_padding2D_layer(Mul16417, 1, 0, 0, 0, Zer63538), 
LSub45218 = subtract_layer(Sub61299,Zer63538, Sub45218), 
LRes75303 = reshape_layer(Sub45218, [2, 4], Res75303), 
LLoc7518 = locally_connected1D_layer(Res75303, 2,[[[0.6993, 0.2986, 0.0357], [0.7352, 0.7451, 0.8915], [0.1563, 0.1224, 0.4377], [0.2862, 0.3094, 0.9942], [0.3636, 0.1183, 0.8991], [0.3117, 0.2675, 0.2426], [0.0905, 0.3069, 0.0727], [0.8832, 0.8348, 0.551]]],[[0, 0, 0]], 1, Loc7518), 
LRes495 = reshape_layer(Loc7518, [1, 3, 1], Res495), 
LZer6469 = zero_padding2D_layer(Res495, 1, 0, 1, 0, Zer6469), 
LAve2856 = average_layer([[[[[0.8378], [0.844]], [[0.0821], [0.321]]]], [[[[0.795], [0.7091]], [[0.0531], [0.5463]]]]], Ave2856), 
LRes13274 = reshape_layer(Ave2856, [2, 2], Res13274), 
LUp_65173 = up_sampling1D_layer(Res13274, 1, Up_65173), 
LRes58329 = reshape_layer(Up_65173, [2, 2, 1], Res58329), 
LMin57923 = minimum_layer([[[[0.9827]]], [[[0.8626]]]], Min57923), 
LRes73736 = reshape_layer(Min57923, [1, 1, 1], Res73736), 
LRes50607 = reshape_layer(Res73736, [1, 1, 1, 1], Res50607), 
LZer63569 = zero_padding3D_layer(Res50607, 0, 0, 0, 0, 1, 0, Zer63569), 
LCon30214 = concatenate_layer([Zer63569,[[[[[0.1], [0.8815]]]]]], 4, Con30214), 
LAve24723 = average_layer([[[[[[0.2341, 0.2832], [0.0109, 0.4126]]]]], [[[[[0.1869, 0.6091], [0.4613, 0.0728]]]]]], Ave24723), 
LSub18689 = subtract_layer(Con30214,Ave24723, Sub18689), 
LRes71698 = reshape_layer(Sub18689, [2, 2, 1], Res71698), 
LMul76147 = multiply_layer([Res58329,Res71698], Mul76147), 
LZer5830 = zero_padding2D_layer(Mul76147, 0, 0, 2, 0, Zer5830), 
LMin49396 = minimum_layer([Zer6469,Zer5830], Min49396), 
exec_layers([LSub61299,LMul16417,LZer63538,LSub45218,LRes75303,LLoc7518,LRes495,LZer6469,LAve2856,LRes13274,LUp_65173,LRes58329,LMin57923,LRes73736,LRes50607,LZer63569,LCon30214,LAve24723,LSub18689,LRes71698,LMul76147,LZer5830,LMin49396],["Sub61299","Mul16417","Zer63538","Sub45218","Res75303","Loc7518","Res495","Zer6469","Ave2856","Res13274","Up_65173","Res58329","Min57923","Res73736","Res50607","Zer63569","Con30214","Ave24723","Sub18689","Res71698","Mul76147","Zer5830","Min49396"],Min49396,"Min49396")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [-0.1718522], [-0.2688028]], [[0.0000000], [-0.0754058], [0.0423514], [-0.1840585]]]]

Expected (Unparsed): [[[[0],[0],[-0.1718522],[-0.26880278249999995]],[[0],[-0.07540579197199995],[0.04235140000000001],[-0.184058513027]]]]

Actual:   [[[[0], [0], [-0.1718], [-0.2688]], [[0], [-0.0754], [0.0424], [-0.184]]]]

Expected: [[[[0], [0], [-0.1718], [-0.2688]], [[0], [-0.0754], [0.0424], [-0.184]]]]