import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep20336 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con18555 = tf.keras.layers.Input(shape=([8, 8, 3]))
in0Up_60713 = tf.keras.layers.Input(shape=([4, 4, 4]))

Sep20336 = keras.layers.SeparableConv2D(2, (2, 1),strides=(2, 2), padding='valid', name = 'Sep20336', )(in0Sep20336)
Fla26397 = keras.layers.Flatten(name = 'Fla26397', )(Sep20336)
Res55039 = keras.layers.Reshape((2, 1), name = 'Res55039', )(Fla26397)
Res22963 = keras.layers.Reshape((2, 1, 1), name = 'Res22963', )(Res55039)
Zer76491 = keras.layers.ZeroPadding2D(padding=((6, 0), (7, 0)), name = 'Zer76491', )(Res22963)
Con18555 = keras.layers.Concatenate(axis=3, name = 'Con18555', )([Zer76491,in0Con18555])
Up_60713 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_60713', )(in0Up_60713)
Min4103 = keras.layers.Minimum(name = 'Min4103', )([Con18555,Up_60713])
model = tf.keras.models.Model(inputs=[in0Sep20336,in0Con18555,in0Up_60713], outputs=Min4103)
w = model.get_layer('Sep20336').get_weights() 
w[0] = np.array([[[[0.6318], [0.1536]]], [[[0.223], [0.2759]]]])
w[1] = np.array([[[[0.1101, 0.7541], [0.2555, 0.1512]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep20336').set_weights(w) 
in0Sep20336 = tf.constant([[[[0.1715, 0.8989]], [[0.0546, 0.195]]]])
in0Con18555 = tf.constant([[[[0.8384, 0.0413, 0.7945], [0.691, 0.5634, 0.4981], [0.0487, 0.4214, 0.1044], [0.9754, 0.8614, 0.2322], [0.6035, 0.2019, 0.3867], [0.1883, 0.9304, 0.7406], [0.2448, 0.1306, 0.7703], [0.4685, 0.1982, 0.2944]], [[0.5399, 0.7256, 0.7918], [0.5762, 0.7671, 0.6954], [0.3759, 0.5497, 0.0555], [0.6316, 0.8688, 0.9627], [0.3875, 0.0058, 0.2055], [0.9814, 0.3184, 0.5113], [0.6657, 0.8915, 0.5615], [0.1333, 0.1775, 0.3136]], [[0.5715, 0.1683, 0.2541], [0.2469, 0.9949, 0.1617], [0.4355, 0.415, 0.2784], [0.2198, 0.9787, 0.4534], [0.2965, 0.0482, 0.0701], [0.4569, 0.5959, 0.3725], [0.0168, 0.279, 0.7382], [0.1017, 0.7141, 0.7661]], [[0.2695, 0.7118, 0.1862], [0.7989, 0.042, 0.8461], [0.1458, 0.6138, 0.9736], [0.0564, 0.3336, 0.381], [0.8394, 0.9413, 0.8586], [0.4271, 0.363, 0.678], [0.8868, 0.8081, 0.6958], [0.0893, 0.8026, 0.162]], [[0.3575, 0.9379, 0.4004], [0.8991, 0.847, 0.101], [0.7569, 0.8264, 0.4277], [0.6398, 0.1804, 0.2427], [0.0401, 0.549, 0.0374], [0.3908, 0.9026, 0.1516], [0.3158, 0.9077, 0.1241], [0.682, 0.4994, 0.5754]], [[0.5676, 0.5947, 0.7028], [0.2414, 0.2858, 0.5278], [0.0403, 0.2519, 0.0732], [0.654, 0.8911, 0.1214], [0.0739, 0.3596, 0.0604], [0.4476, 0.9234, 0.8066], [0.8357, 0.2726, 0.606], [0.9513, 0.5888, 0.1916]], [[0.0634, 0.0232, 0.8857], [0.5133, 0.6049, 0.2981], [0.0305, 0.6892, 0.337], [0.2398, 0.5924, 0.0439], [0.1563, 0.7289, 0.7434], [0.5652, 0.3311, 0.153], [0.1684, 0.1405, 0.3336], [0.5837, 0.9003, 0.1622]], [[0.3798, 0.1381, 0.68], [0.8685, 0.0848, 0.8853], [0.3443, 0.1338, 0.7449], [0.3418, 0.3046, 0.677], [0.025, 0.6778, 0.3944], [0.8197, 0.244, 0.2489], [0.2362, 0.9895, 0.0297], [0.9603, 0.8077, 0.1424]]]])
in0Up_60713 = tf.constant([[[[1.5289, 1.1568, 1.9166, 1.5773], [1.546, 1.2764, 1.3671, 1.6055], [1.3232, 1.5564, 1.4393, 1.7193], [1.8754, 1.1651, 1.5715, 1.3356]], [[1.4287, 1.0627, 1.6203, 1.87], [1.7304, 1.1176, 1.1499, 1.3295], [1.9319, 1.1027, 1.0639, 1.3734], [1.5586, 1.9368, 1.6111, 1.0602]], [[1.314, 1.7514, 1.5508, 1.8514], [1.9854, 1.1013, 1.7938, 1.8276], [1.5127, 1.9179, 1.1497, 1.4852], [1.364, 1.6037, 1.9047, 1.931]], [[1.72, 1.0086, 1.8317, 1.7673], [1.6113, 1.893, 1.8899, 1.4702], [1.0768, 1.8843, 1.3108, 1.6029], [1.6134, 1.8628, 1.9873, 1.7786]]]])
print (np.array2string(model.predict([in0Sep20336,in0Con18555,in0Up_60713],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min4103.png')

LSep20336 = separable_conv2D_layer([[[[0.1715, 0.8989]], [[0.0546, 0.195]]]], 2, 1,[[[[[0.6318], [0.1536]]], [[[0.223], [0.2759]]]],[[[[0.1101, 0.7541], [0.2555, 0.1512]]]]],[0, 0], 2, 2, false, Sep20336), 
LFla26397 = flatten_layer(Sep20336, Fla26397), 
LRes55039 = reshape_layer(Fla26397, [2, 1], Res55039), 
LRes22963 = reshape_layer(Res55039, [2, 1, 1], Res22963), 
LZer76491 = zero_padding2D_layer(Res22963, 6, 0, 7, 0, Zer76491), 
LCon18555 = concatenate_layer([Zer76491,[[[[0.8384, 0.0413, 0.7945], [0.691, 0.5634, 0.4981], [0.0487, 0.4214, 0.1044], [0.9754, 0.8614, 0.2322], [0.6035, 0.2019, 0.3867], [0.1883, 0.9304, 0.7406], [0.2448, 0.1306, 0.7703], [0.4685, 0.1982, 0.2944]], [[0.5399, 0.7256, 0.7918], [0.5762, 0.7671, 0.6954], [0.3759, 0.5497, 0.0555], [0.6316, 0.8688, 0.9627], [0.3875, 0.0058, 0.2055], [0.9814, 0.3184, 0.5113], [0.6657, 0.8915, 0.5615], [0.1333, 0.1775, 0.3136]], [[0.5715, 0.1683, 0.2541], [0.2469, 0.9949, 0.1617], [0.4355, 0.415, 0.2784], [0.2198, 0.9787, 0.4534], [0.2965, 0.0482, 0.0701], [0.4569, 0.5959, 0.3725], [0.0168, 0.279, 0.7382], [0.1017, 0.7141, 0.7661]], [[0.2695, 0.7118, 0.1862], [0.7989, 0.042, 0.8461], [0.1458, 0.6138, 0.9736], [0.0564, 0.3336, 0.381], [0.8394, 0.9413, 0.8586], [0.4271, 0.363, 0.678], [0.8868, 0.8081, 0.6958], [0.0893, 0.8026, 0.162]], [[0.3575, 0.9379, 0.4004], [0.8991, 0.847, 0.101], [0.7569, 0.8264, 0.4277], [0.6398, 0.1804, 0.2427], [0.0401, 0.549, 0.0374], [0.3908, 0.9026, 0.1516], [0.3158, 0.9077, 0.1241], [0.682, 0.4994, 0.5754]], [[0.5676, 0.5947, 0.7028], [0.2414, 0.2858, 0.5278], [0.0403, 0.2519, 0.0732], [0.654, 0.8911, 0.1214], [0.0739, 0.3596, 0.0604], [0.4476, 0.9234, 0.8066], [0.8357, 0.2726, 0.606], [0.9513, 0.5888, 0.1916]], [[0.0634, 0.0232, 0.8857], [0.5133, 0.6049, 0.2981], [0.0305, 0.6892, 0.337], [0.2398, 0.5924, 0.0439], [0.1563, 0.7289, 0.7434], [0.5652, 0.3311, 0.153], [0.1684, 0.1405, 0.3336], [0.5837, 0.9003, 0.1622]], [[0.3798, 0.1381, 0.68], [0.8685, 0.0848, 0.8853], [0.3443, 0.1338, 0.7449], [0.3418, 0.3046, 0.677], [0.025, 0.6778, 0.3944], [0.8197, 0.244, 0.2489], [0.2362, 0.9895, 0.0297], [0.9603, 0.8077, 0.1424]]]]], 3, Con18555), 
LUp_60713 = up_sampling2D_layer([[[[1.5289, 1.1568, 1.9166, 1.5773], [1.546, 1.2764, 1.3671, 1.6055], [1.3232, 1.5564, 1.4393, 1.7193], [1.8754, 1.1651, 1.5715, 1.3356]], [[1.4287, 1.0627, 1.6203, 1.87], [1.7304, 1.1176, 1.1499, 1.3295], [1.9319, 1.1027, 1.0639, 1.3734], [1.5586, 1.9368, 1.6111, 1.0602]], [[1.314, 1.7514, 1.5508, 1.8514], [1.9854, 1.1013, 1.7938, 1.8276], [1.5127, 1.9179, 1.1497, 1.4852], [1.364, 1.6037, 1.9047, 1.931]], [[1.72, 1.0086, 1.8317, 1.7673], [1.6113, 1.893, 1.8899, 1.4702], [1.0768, 1.8843, 1.3108, 1.6029], [1.6134, 1.8628, 1.9873, 1.7786]]]], 2, 2, Up_60713), 
LMin4103 = minimum_layer([Con18555,Up_60713], Min4103), 
exec_layers([LSep20336,LFla26397,LRes55039,LRes22963,LZer76491,LCon18555,LUp_60713,LMin4103],["Sep20336","Fla26397","Res55039","Res22963","Zer76491","Con18555","Up_60713","Min4103"],Min4103,"Min4103")

Actual (Unparsed): [[[[0.0000000, 0.8384000, 0.0413000, 0.7945000], [0.0000000, 0.6910000, 0.5634000, 0.4981000], [0.0000000, 0.0487000, 0.4214000, 0.1044000], [0.0000000, 0.9754000, 0.8614000, 0.2322000], [0.0000000, 0.6035000, 0.2019000, 0.3867000], [0.0000000, 0.1883000, 0.9304000, 0.7406000], [0.0000000, 0.2448000, 0.1306000, 0.7703000], [0.0000000, 0.4685000, 0.1982000, 0.2944000]], [[0.0000000, 0.5399000, 0.7256000, 0.7918000], [0.0000000, 0.5762000, 0.7671000, 0.6954000], [0.0000000, 0.3759000, 0.5497000, 0.0555000], [0.0000000, 0.6316000, 0.8688000, 0.9627000], [0.0000000, 0.3875000, 0.0058000, 0.2055000], [0.0000000, 0.9814000, 0.3184000, 0.5113000], [0.0000000, 0.6657000, 0.8915000, 0.5615000], [0.0000000, 0.1333000, 0.1775000, 0.3136000]], [[0.0000000, 0.5715000, 0.1683000, 0.2541000], [0.0000000, 0.2469000, 0.9949000, 0.1617000], [0.0000000, 0.4355000, 0.4150000, 0.2784000], [0.0000000, 0.2198000, 0.9787000, 0.4534000], [0.0000000, 0.2965000, 0.0482000, 0.0701000], [0.0000000, 0.4569000, 0.5959000, 0.3725000], [0.0000000, 0.0168000, 0.2790000, 0.7382000], [0.0000000, 0.1017000, 0.7141000, 0.7661000]], [[0.0000000, 0.2695000, 0.7118000, 0.1862000], [0.0000000, 0.7989000, 0.0420000, 0.8461000], [0.0000000, 0.1458000, 0.6138000, 0.9736000], [0.0000000, 0.0564000, 0.3336000, 0.3810000], [0.0000000, 0.8394000, 0.9413000, 0.8586000], [0.0000000, 0.4271000, 0.3630000, 0.6780000], [0.0000000, 0.8868000, 0.8081000, 0.6958000], [0.0000000, 0.0893000, 0.8026000, 0.1620000]], [[0.0000000, 0.3575000, 0.9379000, 0.4004000], [0.0000000, 0.8991000, 0.8470000, 0.1010000], [0.0000000, 0.7569000, 0.8264000, 0.4277000], [0.0000000, 0.6398000, 0.1804000, 0.2427000], [0.0000000, 0.0401000, 0.5490000, 0.0374000], [0.0000000, 0.3908000, 0.9026000, 0.1516000], [0.0000000, 0.3158000, 0.9077000, 0.1241000], [0.0000000, 0.6820000, 0.4994000, 0.5754000]], [[0.0000000, 0.5676000, 0.5947000, 0.7028000], [0.0000000, 0.2414000, 0.2858000, 0.5278000], [0.0000000, 0.0403000, 0.2519000, 0.0732000], [0.0000000, 0.6540000, 0.8911000, 0.1214000], [0.0000000, 0.0739000, 0.3596000, 0.0604000], [0.0000000, 0.4476000, 0.9234000, 0.8066000], [0.0000000, 0.8357000, 0.2726000, 0.6060000], [0.0000000, 0.9513000, 0.5888000, 0.1916000]], [[0.0000000, 0.0634000, 0.0232000, 0.8857000], [0.0000000, 0.5133000, 0.6049000, 0.2981000], [0.0000000, 0.0305000, 0.6892000, 0.3370000], [0.0000000, 0.2398000, 0.5924000, 0.0439000], [0.0000000, 0.1563000, 0.7289000, 0.7434000], [0.0000000, 0.5652000, 0.3311000, 0.1530000], [0.0000000, 0.1684000, 0.1405000, 0.3336000], [0.0622935, 0.5837000, 0.9003000, 0.1622000]], [[0.0000000, 0.3798000, 0.1381000, 0.6800000], [0.0000000, 0.8685000, 0.0848000, 0.8853000], [0.0000000, 0.3443000, 0.1338000, 0.7449000], [0.0000000, 0.3418000, 0.3046000, 0.6770000], [0.0000000, 0.0250000, 0.6778000, 0.3944000], [0.0000000, 0.8197000, 0.2440000, 0.2489000], [0.0000000, 0.2362000, 0.9895000, 0.0297000], [0.1199023, 0.9603000, 0.8077000, 0.1424000]]]]

Expected (Unparsed): [[[[0,0.8384,0.0413,0.7945],[0,0.691,0.5634,0.4981],[0,0.0487,0.4214,0.1044],[0,0.9754,0.8614,0.2322],[0,0.6035,0.2019,0.3867],[0,0.1883,0.9304,0.7406],[0,0.2448,0.1306,0.7703],[0,0.4685,0.1982,0.2944]],[[0,0.5399,0.7256,0.7918],[0,0.5762,0.7671,0.6954],[0,0.3759,0.5497,0.0555],[0,0.6316,0.8688,0.9627],[0,0.3875,0.0058,0.2055],[0,0.9814,0.3184,0.5113],[0,0.6657,0.8915,0.5615],[0,0.1333,0.1775,0.3136]],[[0,0.5715,0.1683,0.2541],[0,0.2469,0.9949,0.1617],[0,0.4355,0.415,0.2784],[0,0.2198,0.9787,0.4534],[0,0.2965,0.0482,0.0701],[0,0.4569,0.5959,0.3725],[0,0.0168,0.279,0.7382],[0,0.1017,0.7141,0.7661]],[[0,0.2695,0.7118,0.1862],[0,0.7989,0.042,0.8461],[0,0.1458,0.6138,0.9736],[0,0.0564,0.3336,0.381],[0,0.8394,0.9413,0.8586],[0,0.4271,0.363,0.678],[0,0.8868,0.8081,0.6958],[0,0.0893,0.8026,0.162]],[[0,0.3575,0.9379,0.4004],[0,0.8991,0.847,0.101],[0,0.7569,0.8264,0.4277],[0,0.6398,0.1804,0.2427],[0,0.0401,0.549,0.0374],[0,0.3908,0.9026,0.1516],[0,0.3158,0.9077,0.1241],[0,0.682,0.4994,0.5754]],[[0,0.5676,0.5947,0.7028],[0,0.2414,0.2858,0.5278],[0,0.0403,0.2519,0.0732],[0,0.654,0.8911,0.1214],[0,0.0739,0.3596,0.0604],[0,0.4476,0.9234,0.8066],[0,0.8357,0.2726,0.606],[0,0.9513,0.5888,0.1916]],[[0,0.0634,0.0232,0.8857],[0,0.5133,0.6049,0.2981],[0,0.0305,0.6892,0.337],[0,0.2398,0.5924,0.0439],[0,0.1563,0.7289,0.7434],[0,0.5652,0.3311,0.153],[0,0.1684,0.1405,0.3336],[0.06229347642000001,0.5837,0.9003,0.1622]],[[0,0.3798,0.1381,0.68],[0,0.8685,0.0848,0.8853],[0,0.3443,0.1338,0.7449],[0,0.3418,0.3046,0.677],[0,0.025,0.6778,0.3944],[0,0.8197,0.244,0.2489],[0,0.2362,0.9895,0.0297],[0.119902272798,0.9603,0.8077,0.1424]]]]

Actual:   [[[[0, 0.8384, 0.0413, 0.7945], [0, 0.691, 0.5634, 0.4981], [0, 0.0487, 0.4214, 0.1044], [0, 0.9754, 0.8614, 0.2322], [0, 0.6035, 0.2019, 0.3867], [0, 0.1883, 0.9304, 0.7406], [0, 0.2448, 0.1306, 0.7703], [0, 0.4685, 0.1982, 0.2944]], [[0, 0.5399, 0.7256, 0.7918], [0, 0.5762, 0.7671, 0.6954], [0, 0.3759, 0.5497, 0.0555], [0, 0.6316, 0.8688, 0.9627], [0, 0.3875, 0.0058, 0.2055], [0, 0.9814, 0.3184, 0.5113], [0, 0.6657, 0.8915, 0.5615], [0, 0.1333, 0.1775, 0.3136]], [[0, 0.5715, 0.1683, 0.2541], [0, 0.2469, 0.9949, 0.1617], [0, 0.4355, 0.415, 0.2784], [0, 0.2198, 0.9787, 0.4534], [0, 0.2965, 0.0482, 0.0701], [0, 0.4569, 0.5959, 0.3725], [0, 0.0168, 0.279, 0.7382], [0, 0.1017, 0.7141, 0.7661]], [[0, 0.2695, 0.7118, 0.1862], [0, 0.7989, 0.042, 0.8461], [0, 0.1458, 0.6138, 0.9736], [0, 0.0564, 0.3336, 0.381], [0, 0.8394, 0.9413, 0.8586], [0, 0.4271, 0.363, 0.678], [0, 0.8868, 0.8081, 0.6958], [0, 0.0893, 0.8026, 0.162]], [[0, 0.3575, 0.9379, 0.4004], [0, 0.8991, 0.847, 0.101], [0, 0.7569, 0.8264, 0.4277], [0, 0.6398, 0.1804, 0.2427], [0, 0.0401, 0.549, 0.0374], [0, 0.3908, 0.9026, 0.1516], [0, 0.3158, 0.9077, 0.1241], [0, 0.682, 0.4994, 0.5754]], [[0, 0.5676, 0.5947, 0.7028], [0, 0.2414, 0.2858, 0.5278], [0, 0.0403, 0.2519, 0.0732], [0, 0.654, 0.8911, 0.1214], [0, 0.0739, 0.3596, 0.0604], [0, 0.4476, 0.9234, 0.8066], [0, 0.8357, 0.2726, 0.606], [0, 0.9513, 0.5888, 0.1916]], [[0, 0.0634, 0.0232, 0.8857], [0, 0.5133, 0.6049, 0.2981], [0, 0.0305, 0.6892, 0.337], [0, 0.2398, 0.5924, 0.0439], [0, 0.1563, 0.7289, 0.7434], [0, 0.5652, 0.3311, 0.153], [0, 0.1684, 0.1405, 0.3336], [0.0623, 0.5837, 0.9003, 0.1622]], [[0, 0.3798, 0.1381, 0.68], [0, 0.8685, 0.0848, 0.8853], [0, 0.3443, 0.1338, 0.7449], [0, 0.3418, 0.3046, 0.677], [0, 0.025, 0.6778, 0.3944], [0, 0.8197, 0.244, 0.2489], [0, 0.2362, 0.9895, 0.0297], [0.12, 0.9603, 0.8077, 0.1424]]]]

Expected: [[[[0, 0.8384, 0.0413, 0.7945], [0, 0.691, 0.5634, 0.4981], [0, 0.0487, 0.4214, 0.1044], [0, 0.9754, 0.8614, 0.2322], [0, 0.6035, 0.2019, 0.3867], [0, 0.1883, 0.9304, 0.7406], [0, 0.2448, 0.1306, 0.7703], [0, 0.4685, 0.1982, 0.2944]], [[0, 0.5399, 0.7256, 0.7918], [0, 0.5762, 0.7671, 0.6954], [0, 0.3759, 0.5497, 0.0555], [0, 0.6316, 0.8688, 0.9627], [0, 0.3875, 0.0058, 0.2055], [0, 0.9814, 0.3184, 0.5113], [0, 0.6657, 0.8915, 0.5615], [0, 0.1333, 0.1775, 0.3136]], [[0, 0.5715, 0.1683, 0.2541], [0, 0.2469, 0.9949, 0.1617], [0, 0.4355, 0.415, 0.2784], [0, 0.2198, 0.9787, 0.4534], [0, 0.2965, 0.0482, 0.0701], [0, 0.4569, 0.5959, 0.3725], [0, 0.0168, 0.279, 0.7382], [0, 0.1017, 0.7141, 0.7661]], [[0, 0.2695, 0.7118, 0.1862], [0, 0.7989, 0.042, 0.8461], [0, 0.1458, 0.6138, 0.9736], [0, 0.0564, 0.3336, 0.381], [0, 0.8394, 0.9413, 0.8586], [0, 0.4271, 0.363, 0.678], [0, 0.8868, 0.8081, 0.6958], [0, 0.0893, 0.8026, 0.162]], [[0, 0.3575, 0.9379, 0.4004], [0, 0.8991, 0.847, 0.101], [0, 0.7569, 0.8264, 0.4277], [0, 0.6398, 0.1804, 0.2427], [0, 0.0401, 0.549, 0.0374], [0, 0.3908, 0.9026, 0.1516], [0, 0.3158, 0.9077, 0.1241], [0, 0.682, 0.4994, 0.5754]], [[0, 0.5676, 0.5947, 0.7028], [0, 0.2414, 0.2858, 0.5278], [0, 0.0403, 0.2519, 0.0732], [0, 0.654, 0.8911, 0.1214], [0, 0.0739, 0.3596, 0.0604], [0, 0.4476, 0.9234, 0.8066], [0, 0.8357, 0.2726, 0.606], [0, 0.9513, 0.5888, 0.1916]], [[0, 0.0634, 0.0232, 0.8857], [0, 0.5133, 0.6049, 0.2981], [0, 0.0305, 0.6892, 0.337], [0, 0.2398, 0.5924, 0.0439], [0, 0.1563, 0.7289, 0.7434], [0, 0.5652, 0.3311, 0.153], [0, 0.1684, 0.1405, 0.3336], [0.0623, 0.5837, 0.9003, 0.1622]], [[0, 0.3798, 0.1381, 0.68], [0, 0.8685, 0.0848, 0.8853], [0, 0.3443, 0.1338, 0.7449], [0, 0.3418, 0.3046, 0.677], [0, 0.025, 0.6778, 0.3944], [0, 0.8197, 0.244, 0.2489], [0, 0.2362, 0.9895, 0.0297], [0.12, 0.9603, 0.8077, 0.1424]]]]