import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min32547 = tf.keras.layers.Input(shape=([1, 2]))
in1Min32547 = tf.keras.layers.Input(shape=([1, 2]))
in0Min33182 = tf.keras.layers.Input(shape=([1, 1]))
in1Min33182 = tf.keras.layers.Input(shape=([1, 1]))
in0Max50487 = tf.keras.layers.Input(shape=([2, 1]))
in1Max50487 = tf.keras.layers.Input(shape=([2, 1]))
in0Con11381 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Sep806 = tf.keras.layers.Input(shape=([1, 2]))
in0Con63287 = tf.keras.layers.Input(shape=([1, 2]))

Min32547 = keras.layers.Minimum(name = 'Min32547', )([in0Min32547,in1Min32547])
Res36466 = keras.layers.Reshape((1, 2, 1), name = 'Res36466', )(Min32547)
Dep53493 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep53493', )(Res36466)
Res78557 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res78557', )(Dep53493)
Glo47103 = keras.layers.GlobalMaxPool3D(name = 'Glo47103', )(Res78557)
Res21127 = keras.layers.Reshape((1, 1), name = 'Res21127', )(Glo47103)
Zer803 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer803', )(Res21127)
Min33182 = keras.layers.Minimum(name = 'Min33182', )([in0Min33182,in1Min33182])
Zer16817 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer16817', )(Min33182)
Max50487 = keras.layers.Maximum(name = 'Max50487', )([in0Max50487,in1Max50487])
Add49476 = keras.layers.Add(name = 'Add49476', )([Zer16817,Max50487])
Mul50164 = keras.layers.Multiply(name = 'Mul50164', )([Zer803,Add49476])
Res37740 = keras.layers.Reshape((2, 1, 1), name = 'Res37740', )(Mul50164)
Sep42801 = keras.layers.SeparableConv2D(4, (2, 1),strides=(1, 1), padding='same', name = 'Sep42801', )(Res37740)
Res18837 = keras.layers.Reshape((2, 4), name = 'Res18837', )(Sep42801)
Con11381 = keras.layers.Conv3D(2, (1, 1, 2),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con11381', )(in0Con11381)
Res31565 = keras.layers.Reshape((1, 2, 2), name = 'Res31565', )(Con11381)
Res68925 = keras.layers.Reshape((1, 4), name = 'Res68925', )(Res31565)
Sep806 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep806', )(in0Sep806)
Sof265 = keras.layers.Softmax(axis=1, name = 'Sof265', )(Sep806)
Sof98044 = keras.layers.Softmax(axis=1, name = 'Sof98044', )(Sof265)
Con63287 = keras.layers.Concatenate(axis=2, name = 'Con63287', )([Sof98044,in0Con63287])
Max38482 = keras.layers.Maximum(name = 'Max38482', )([Res68925,Con63287])
Zer4377 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer4377', )(Max38482)
Max31820 = keras.layers.Maximum(name = 'Max31820', )([Res18837,Zer4377])
model = tf.keras.models.Model(inputs=[in0Min32547,in1Min32547,in0Min33182,in1Min33182,in0Max50487,in1Max50487,in0Con11381,in0Sep806,in0Con63287], outputs=Max31820)
w = model.get_layer('Dep53493').get_weights() 
w[0] = np.array([[[[0.8226]]]])
w[1] = np.array([0])
model.get_layer('Dep53493').set_weights(w) 
w = model.get_layer('Sep42801').get_weights() 
w[0] = np.array([[[[0.2255]]], [[[0.4206]]]])
w[1] = np.array([[[[0.8169, 0.6065, 0.1363, 0.2333]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep42801').set_weights(w) 
w = model.get_layer('Con11381').get_weights() 
w[0] = np.array([[[[[0.3457, 0.5372], [0.0091, 0.0664]], [[0.2841, 0.0759], [0.0123, 0.1018]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con11381').set_weights(w) 
w = model.get_layer('Sep806').get_weights() 
w[0] = np.array([[[0.7952], [0.9353]]])
w[1] = np.array([[[0.9476, 0.9732], [0.945, 0.2745]]])
w[2] = np.array([0, 0])
model.get_layer('Sep806').set_weights(w) 
in0Min32547 = tf.constant([[[0.2596, 0.0804]]])
in1Min32547 = tf.constant([[[0.8554, 0.8265]]])
in0Min33182 = tf.constant([[[0.8301]]])
in1Min33182 = tf.constant([[[0.1798]]])
in0Max50487 = tf.constant([[[0.1285], [0.825]]])
in1Max50487 = tf.constant([[[0.4733], [0.8209]]])
in0Con11381 = tf.constant([[[[[0.7992, 0.6117], [0.175, 0.045]], [[0.6583, 0.099], [0.5643, 0.0675]]]]])
in0Sep806 = tf.constant([[[0.0202, 0.2133]]])
in0Con63287 = tf.constant([[[0.6165, 0.7462]]])
print (np.array2string(model.predict([in0Min32547,in1Min32547,in0Min33182,in1Min33182,in0Max50487,in1Max50487,in0Con11381,in0Sep806,in0Con63287],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max31820.png')

LMin32547 = minimum_layer([[[[0.2596, 0.0804]]], [[[0.8554, 0.8265]]]], Min32547), 
LRes36466 = reshape_layer(Min32547, [1, 2, 1], Res36466), 
LDep53493 = depthwise_conv2D_layer(Res36466, 1, 1,[[[[0.8226]]]],[0], 1, 1, true, Dep53493), 
LRes78557 = reshape_layer(Dep53493, [1, 2, 1, 1], Res78557), 
LGlo47103 = global_max_pool3D_layer(Res78557, Glo47103), 
LRes21127 = reshape_layer(Glo47103, [1, 1], Res21127), 
LZer803 = zero_padding1D_layer(Res21127, 1, 0, Zer803), 
LMin33182 = minimum_layer([[[[0.8301]]], [[[0.1798]]]], Min33182), 
LZer16817 = zero_padding1D_layer(Min33182, 1, 0, Zer16817), 
LMax50487 = maximum_layer([[[[0.1285], [0.825]]], [[[0.4733], [0.8209]]]], Max50487), 
LAdd49476 = add_layer([Zer16817,Max50487], Add49476), 
LMul50164 = multiply_layer([Zer803,Add49476], Mul50164), 
LRes37740 = reshape_layer(Mul50164, [2, 1, 1], Res37740), 
LSep42801 = separable_conv2D_layer(Res37740, 2, 1,[[[[[0.2255]]], [[[0.4206]]]],[[[[0.8169, 0.6065, 0.1363, 0.2333]]]]],[0, 0, 0, 0], 1, 1, true, Sep42801), 
LRes18837 = reshape_layer(Sep42801, [2, 4], Res18837), 
LCon11381 = conv3D_layer([[[[[0.7992, 0.6117], [0.175, 0.045]], [[0.6583, 0.099], [0.5643, 0.0675]]]]], 1, 1, 2,[[[[[0.3457, 0.5372], [0.0091, 0.0664]], [[0.2841, 0.0759], [0.0123, 0.1018]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con11381), 
LRes31565 = reshape_layer(Con11381, [1, 2, 2], Res31565), 
LRes68925 = reshape_layer(Res31565, [1, 4], Res68925), 
LSep806 = separable_conv1D_layer([[[0.0202, 0.2133]]], 1,[[[[0.7952], [0.9353]]],[[[0.9476, 0.9732], [0.945, 0.2745]]]],[0, 0], 1, true, Sep806), 
LSof265 = softmax_layer(Sep806, 1, Sof265), 
LSof98044 = softmax_layer(Sof265, 1, Sof98044), 
LCon63287 = concatenate_layer([Sof98044,[[[0.6165, 0.7462]]]], 2, Con63287), 
LMax38482 = maximum_layer([Res68925,Con63287], Max38482), 
LZer4377 = zero_padding1D_layer(Max38482, 1, 0, Zer4377), 
LMax31820 = maximum_layer([Res18837,Zer4377], Max31820), 
exec_layers([LMin32547,LRes36466,LDep53493,LRes78557,LGlo47103,LRes21127,LZer803,LMin33182,LZer16817,LMax50487,LAdd49476,LMul50164,LRes37740,LSep42801,LRes18837,LCon11381,LRes31565,LRes68925,LSep806,LSof265,LSof98044,LCon63287,LMax38482,LZer4377,LMax31820],["Min32547","Res36466","Dep53493","Res78557","Glo47103","Res21127","Zer803","Min33182","Zer16817","Max50487","Add49476","Mul50164","Res37740","Sep42801","Res18837","Con11381","Res31565","Res68925","Sep806","Sof265","Sof98044","Con63287","Max38482","Zer4377","Max31820"],Max31820,"Max31820")

Actual (Unparsed): [[[0.0737244, 0.0547360, 0.0123009, 0.0210551], [1.0000000, 1.0000000, 0.6165000, 0.7462000]]]

Expected (Unparsed): [[[0.07372438936244186,0.05473600458846981,0.012300935573633034,0.021055086348705697],[1.0,1.0,0.6165,0.7462]]]

Actual:   [[[0.0738, 0.0548, 0.0124, 0.0211], [1, 1, 0.6165, 0.7462]]]

Expected: [[[0.0738, 0.0548, 0.0124, 0.0211], [1, 1, 0.6165, 0.7462]]]