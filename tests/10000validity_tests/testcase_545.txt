import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave38856 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave38856 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con99999 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Min32818 = tf.keras.layers.Input(shape=([1, 1]))
in1Min32818 = tf.keras.layers.Input(shape=([1, 1]))
in0Min19084 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min19084 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Glo65379 = tf.keras.layers.Input(shape=([2, 1]))
in0Con69050 = tf.keras.layers.Input(shape=([2, 3, 1]))

Ave38856 = keras.layers.Average(name = 'Ave38856', )([in0Ave38856,in1Ave38856])
Zer86541 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer86541', )(Ave38856)
Con99999 = keras.layers.Concatenate(axis=3, name = 'Con99999', )([Zer86541,in0Con99999])
Min32818 = keras.layers.Minimum(name = 'Min32818', )([in0Min32818,in1Min32818])
Res43311 = keras.layers.Reshape((1, 1, 1), name = 'Res43311', )(Min32818)
Res8153 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res8153', )(Res43311)
Zer26246 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer26246', )(Res8153)
Min19084 = keras.layers.Minimum(name = 'Min19084', )([in0Min19084,in1Min19084])
Add68543 = keras.layers.Add(name = 'Add68543', )([Zer26246,Min19084])
Res35375 = keras.layers.Reshape((2, 1, 2), name = 'Res35375', )(Add68543)
Zer79495 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer79495', )(Res35375)
Glo65379 = keras.layers.GlobalAveragePooling1D(name = 'Glo65379', )(in0Glo65379)
Res24836 = keras.layers.Reshape((1, 1), name = 'Res24836', )(Glo65379)
Res28389 = keras.layers.Reshape((1, 1, 1), name = 'Res28389', )(Res24836)
Up_75551 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_75551', )(Res28389)
Zer28413 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer28413', )(Up_75551)
Con69050 = keras.layers.Concatenate(axis=3, name = 'Con69050', )([Zer28413,in0Con69050])
Ave46224 = keras.layers.Average(name = 'Ave46224', )([Zer79495,Con69050])
Min4062 = keras.layers.Minimum(name = 'Min4062', )([Con99999,Ave46224])
Res35928 = keras.layers.Reshape((2, 6), name = 'Res35928', )(Min4062)
Loc20542 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc20542', )(Res35928)
model = tf.keras.models.Model(inputs=[in0Ave38856,in1Ave38856,in0Con99999,in0Min32818,in1Min32818,in0Min19084,in1Min19084,in0Glo65379,in0Con69050], outputs=Loc20542)
w = model.get_layer('Loc20542').get_weights() 
w[0] = np.array([[[0.6192, 0.3667], [0.0821, 0.8615], [0.8473, 0.5338], [0.7336, 0.8407], [0.6709, 0.7907], [0.1069, 0.6824]], [[0.7224, 0.3921], [0.6454, 0.0027], [0.649, 0.0572], [0.2908, 0.4869], [0.6744, 0.8937], [0.3798, 0.8839]]])
w[1] = np.array([[0, 0], [0, 0]])
model.get_layer('Loc20542').set_weights(w) 
in0Ave38856 = tf.constant([[[[0.3702], [0.3882]], [[0.4627], [0.3065]]]])
in1Ave38856 = tf.constant([[[[0.4294], [0.6792]], [[0.997], [0.0279]]]])
in0Con99999 = tf.constant([[[[0.6183], [0.2064], [0.9279]], [[0.4143], [0.3808], [0.4942]]]])
in0Min32818 = tf.constant([[[0.8524]]])
in1Min32818 = tf.constant([[[0.9378]]])
in0Min19084 = tf.constant([[[[[0.4921], [0.1857]]], [[[0.5115], [0.5489]]]]])
in1Min19084 = tf.constant([[[[[0.8416], [0.153]]], [[[0.3408], [0.045]]]]])
in0Glo65379 = tf.constant([[[1.8455], [1.5362]]])
in0Con69050 = tf.constant([[[[0.4178], [0.7761], [0.2207]], [[0.8295], [0.7738], [0.309]]]])
print (np.array2string(model.predict([in0Ave38856,in1Ave38856,in0Con99999,in0Min32818,in1Min32818,in0Min19084,in1Min19084,in0Glo65379,in0Con69050],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc20542.png')

LAve38856 = average_layer([[[[[0.3702], [0.3882]], [[0.4627], [0.3065]]]], [[[[0.4294], [0.6792]], [[0.997], [0.0279]]]]], Ave38856), 
LZer86541 = zero_padding2D_layer(Ave38856, 0, 0, 1, 0, Zer86541), 
LCon99999 = concatenate_layer([Zer86541,[[[[0.6183], [0.2064], [0.9279]], [[0.4143], [0.3808], [0.4942]]]]], 3, Con99999), 
LMin32818 = minimum_layer([[[[0.8524]]], [[[0.9378]]]], Min32818), 
LRes43311 = reshape_layer(Min32818, [1, 1, 1], Res43311), 
LRes8153 = reshape_layer(Res43311, [1, 1, 1, 1], Res8153), 
LZer26246 = zero_padding3D_layer(Res8153, 1, 0, 0, 0, 1, 0, Zer26246), 
LMin19084 = minimum_layer([[[[[[0.4921], [0.1857]]], [[[0.5115], [0.5489]]]]], [[[[[0.8416], [0.153]]], [[[0.3408], [0.045]]]]]], Min19084), 
LAdd68543 = add_layer([Zer26246,Min19084], Add68543), 
LRes35375 = reshape_layer(Add68543, [2, 1, 2], Res35375), 
LZer79495 = zero_padding2D_layer(Res35375, 0, 0, 2, 0, Zer79495), 
LGlo65379 = global_average_pooling1D_layer([[[1.8455], [1.5362]]], Glo65379), 
LRes24836 = reshape_layer(Glo65379, [1, 1], Res24836), 
LRes28389 = reshape_layer(Res24836, [1, 1, 1], Res28389), 
LUp_75551 = up_sampling2D_layer(Res28389, 1, 2, Up_75551), 
LZer28413 = zero_padding2D_layer(Up_75551, 1, 0, 1, 0, Zer28413), 
LCon69050 = concatenate_layer([Zer28413,[[[[0.4178], [0.7761], [0.2207]], [[0.8295], [0.7738], [0.309]]]]], 3, Con69050), 
LAve46224 = average_layer([Zer79495,Con69050], Ave46224), 
LMin4062 = minimum_layer([Con99999,Ave46224], Min4062), 
LRes35928 = reshape_layer(Min4062, [2, 6], Res35928), 
LLoc20542 = locally_connected1D_layer(Res35928, 1,[[[0.6192, 0.3667], [0.0821, 0.8615], [0.8473, 0.5338], [0.7336, 0.8407], [0.6709, 0.7907], [0.1069, 0.6824]], [[0.7224, 0.3921], [0.6454, 0.0027], [0.649, 0.0572], [0.2908, 0.4869], [0.6744, 0.8937], [0.3798, 0.8839]]],[[0, 0], [0, 0]], 1, Loc20542), 
exec_layers([LAve38856,LZer86541,LCon99999,LMin32818,LRes43311,LRes8153,LZer26246,LMin19084,LAdd68543,LRes35375,LZer79495,LGlo65379,LRes24836,LRes28389,LUp_75551,LZer28413,LCon69050,LAve46224,LMin4062,LRes35928,LLoc20542],["Ave38856","Zer86541","Con99999","Min32818","Res43311","Res8153","Zer26246","Min19084","Add68543","Res35375","Zer79495","Glo65379","Res24836","Res28389","Up_75551","Zer28413","Con69050","Ave46224","Min4062","Res35928","Loc20542"],Loc20542,"Loc20542")

Actual (Unparsed): [[[0.3536149, 0.6755460], [1.1522553, 0.8145276]]]

Expected (Unparsed): [[[0.35361494,0.675546005],[1.1522553500000001,0.81452757]]]

Actual:   [[[0.3537, 0.6756], [1.1523, 0.8146]]]

Expected: [[[0.3537, 0.6756], [1.1523, 0.8146]]]