import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave15794 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Add26935 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add26935 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dot88240 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot88240 = tf.keras.layers.Input(shape=([3, 3]))
in0Con22962 = tf.keras.layers.Input(shape=([3, 1]))

Ave15794 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave15794', )(in0Ave15794)
Zer10728 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer10728', )(Ave15794)
Add26935 = keras.layers.Add(name = 'Add26935', )([in0Add26935,in1Add26935])
Add13968 = keras.layers.Add(name = 'Add13968', )([Zer10728,Add26935])
Res61764 = keras.layers.Reshape((1, 4), name = 'Res61764', )(Add13968)
Zer15194 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer15194', )(Res61764)
Dot88240 = keras.layers.Dot(axes=(2, 1), name = 'Dot88240', )([in0Dot88240,in1Dot88240])
Con22962 = keras.layers.Concatenate(axis=2, name = 'Con22962', )([Dot88240,in0Con22962])
Sub65044 = keras.layers.Subtract(name = 'Sub65044', )([Zer15194,Con22962])
model = tf.keras.models.Model(inputs=[in0Ave15794,in0Add26935,in1Add26935,in0Dot88240,in1Dot88240,in0Con22962], outputs=Sub65044)
in0Ave15794 = tf.constant([[[[1.2133, 1.5249]]]])
in0Add26935 = tf.constant([[[[0.0973, 0.0678], [0.3262, 0.6852]]]])
in1Add26935 = tf.constant([[[[0.8511, 0.2998], [0.908, 0.6544]]]])
in0Dot88240 = tf.constant([[[0.5433, 0.9205, 0.235], [0.5158, 0.7785, 0.3652], [0.7885, 0.5768, 0.915]]])
in1Dot88240 = tf.constant([[[0.2896, 0.8044, 0.8648], [0.0725, 0.372, 0.9911], [0.5721, 0.1321, 0.0943]]])
in0Con22962 = tf.constant([[[0.3813], [0.9019], [0.6831]]])
print (np.array2string(model.predict([in0Ave15794,in0Add26935,in1Add26935,in0Dot88240,in1Dot88240,in0Con22962],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub65044.png')

LAve15794 = average_pooling2D_layer([[[[1.2133, 1.5249]]]], 1, 1, Ave15794), 
LZer10728 = zero_padding2D_layer(Ave15794, 0, 0, 1, 0, Zer10728), 
LAdd26935 = add_layer([[[[[0.0973, 0.0678], [0.3262, 0.6852]]]], [[[[0.8511, 0.2998], [0.908, 0.6544]]]]], Add26935), 
LAdd13968 = add_layer([Zer10728,Add26935], Add13968), 
LRes61764 = reshape_layer(Add13968, [1, 4], Res61764), 
LZer15194 = zero_padding1D_layer(Res61764, 2, 0, Zer15194), 
LDot88240 = dot_layer([[[0.5433, 0.9205, 0.235], [0.5158, 0.7785, 0.3652], [0.7885, 0.5768, 0.915]]], [[[0.2896, 0.8044, 0.8648], [0.0725, 0.372, 0.9911], [0.5721, 0.1321, 0.0943]]], 2, 1, Dot88240), 
LCon22962 = concatenate_layer([Dot88240,[[[0.3813], [0.9019], [0.6831]]]], 2, Con22962), 
LSub65044 = subtract_layer(Zer15194,Con22962, Sub65044), 
exec_layers([LAve15794,LZer10728,LAdd26935,LAdd13968,LRes61764,LZer15194,LDot88240,LCon22962,LSub65044],["Ave15794","Zer10728","Add26935","Add13968","Res61764","Zer15194","Dot88240","Con22962","Sub65044"],Sub65044,"Sub65044")

Actual (Unparsed): [[[-0.3585194, -0.8105000, -1.4043138, -0.3813000], [-0.4147479, -0.7527545, -1.2520736, -0.9019000], [0.1547609, -0.6021105, 1.1076542, 2.1813999]]]

Expected (Unparsed): [[[-0.35851943,-0.8105000200000001,-1.40431389,-0.3813],[-0.41474785000000003,-0.75275444,-1.25207355,-0.9019],[0.15476089999999987,-0.6021105,1.1076542199999997,2.1813999999999996]]]

Actual:   [[[-0.3585, -0.8105, -1.4043, -0.3813], [-0.4147, -0.7527, -1.252, -0.9019], [0.1548, -0.6021, 1.1077, 2.1814]]]

Expected: [[[-0.3585, -0.8105, -1.4043, -0.3813], [-0.4147, -0.7527, -1.252, -0.9019], [0.1548, -0.6021, 1.1077, 2.1814]]]