import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add83262 = tf.keras.layers.Input(shape=([2, 2]))
in1Add83262 = tf.keras.layers.Input(shape=([2, 2]))
in0Max23037 = tf.keras.layers.Input(shape=([2, 2]))
in1Max23037 = tf.keras.layers.Input(shape=([2, 2]))
in0Con44956 = tf.keras.layers.Input(shape=([2, 1]))

Add83262 = keras.layers.Add(name = 'Add83262', )([in0Add83262,in1Add83262])
PRe35034 = keras.layers.PReLU(name = 'PRe35034', )(Add83262)
Max23037 = keras.layers.Maximum(name = 'Max23037', )([in0Max23037,in1Max23037])
Res99170 = keras.layers.Reshape((2, 2, 1), name = 'Res99170', )(Max23037)
Cro92747 = keras.layers.Cropping2D(cropping=((0, 1), (1, 0)), name = 'Cro92747', )(Res99170)
Res56734 = keras.layers.Reshape((1, 1), name = 'Res56734', )(Cro92747)
Up_19203 = keras.layers.UpSampling1D(size=(2), name = 'Up_19203', )(Res56734)
Con44956 = keras.layers.Concatenate(axis=2, name = 'Con44956', )([Up_19203,in0Con44956])
Min75033 = keras.layers.Minimum(name = 'Min75033', )([PRe35034,Con44956])
model = tf.keras.models.Model(inputs=[in0Add83262,in1Add83262,in0Max23037,in1Max23037,in0Con44956], outputs=Min75033)
w = model.get_layer('PRe35034').get_weights() 
w[0] = np.array([[0.3252, 0.6025], [0.5871, 0.9631]])
model.get_layer('PRe35034').set_weights(w) 
in0Add83262 = tf.constant([[[0.6485, 0.6269], [0.1818, 0.0145]]])
in1Add83262 = tf.constant([[[0.3254, 0.959], [0.4129, 0.9252]]])
in0Max23037 = tf.constant([[[0.7754, 0.2456], [0.6076, 0.179]]])
in1Max23037 = tf.constant([[[0.3506, 0.0478], [0.7297, 0.6433]]])
in0Con44956 = tf.constant([[[0.983], [0.0847]]])
print (np.array2string(model.predict([in0Add83262,in1Add83262,in0Max23037,in1Max23037,in0Con44956],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min75033.png')

LAdd83262 = add_layer([[[[0.6485, 0.6269], [0.1818, 0.0145]]], [[[0.3254, 0.959], [0.4129, 0.9252]]]], Add83262), 
LPRe35034 = prelu_layer(Add83262, [[0.3252, 0.6025], [0.5871, 0.9631]], PRe35034), 
LMax23037 = maximum_layer([[[[0.7754, 0.2456], [0.6076, 0.179]]], [[[0.3506, 0.0478], [0.7297, 0.6433]]]], Max23037), 
LRes99170 = reshape_layer(Max23037, [2, 2, 1], Res99170), 
LCro92747 = cropping2D_layer(Res99170, 0, 1, 1, 0, Cro92747), 
LRes56734 = reshape_layer(Cro92747, [1, 1], Res56734), 
LUp_19203 = up_sampling1D_layer(Res56734, 2, Up_19203), 
LCon44956 = concatenate_layer([Up_19203,[[[0.983], [0.0847]]]], 2, Con44956), 
LMin75033 = minimum_layer([PRe35034,Con44956], Min75033), 
exec_layers([LAdd83262,LPRe35034,LMax23037,LRes99170,LCro92747,LRes56734,LUp_19203,LCon44956,LMin75033],["Add83262","PRe35034","Max23037","Res99170","Cro92747","Res56734","Up_19203","Con44956","Min75033"],Min75033,"Min75033")

Actual (Unparsed): [[[0.2456000, 0.9830000], [0.2456000, 0.0847000]]]

Expected (Unparsed): [[[0.2456,0.983],[0.2456,0.0847]]]

Actual:   [[[0.2456, 0.983], [0.2456, 0.0847]]]

Expected: [[[0.2456, 0.983], [0.2456, 0.0847]]]