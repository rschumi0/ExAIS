import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub90495 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub90495 = tf.keras.layers.Input(shape=([2, 2]))

Sub90495 = keras.layers.Subtract(name = 'Sub90495', )([in0Sub90495,in1Sub90495])
Res60903 = keras.layers.Reshape((2, 2, 1), name = 'Res60903', )(Sub90495)
Cro5778 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro5778', )(Res60903)
Res36422 = keras.layers.Reshape((1, 2), name = 'Res36422', )(Cro5778)
Per97178 = keras.layers.Permute((2,1), name = 'Per97178',)(Res36422)
Glo73865 = keras.layers.GlobalMaxPool1D(name = 'Glo73865', )(Per97178)
model = tf.keras.models.Model(inputs=[in0Sub90495,in1Sub90495], outputs=Glo73865)
in0Sub90495 = tf.constant([[[0.4578, 0.6894], [0.6551, 0.2851]]])
in1Sub90495 = tf.constant([[[0.8566, 0.2431], [0.5394, 0.1872]]])
print (np.array2string(model.predict([in0Sub90495,in1Sub90495],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo73865.png')

LSub90495 = subtract_layer([[[0.4578, 0.6894], [0.6551, 0.2851]]], [[[0.8566, 0.2431], [0.5394, 0.1872]]], Sub90495), 
LRes60903 = reshape_layer(Sub90495, [2, 2, 1], Res60903), 
LCro5778 = cropping2D_layer(Res60903, 1, 0, 0, 0, Cro5778), 
LRes36422 = reshape_layer(Cro5778, [1, 2], Res36422), 
LPer97178 = permute_layer(Res36422, 2,1, Per97178), 
LGlo73865 = global_max_pool1D_layer(Per97178, Glo73865), 
exec_layers([LSub90495,LRes60903,LCro5778,LRes36422,LPer97178,LGlo73865],["Sub90495","Res60903","Cro5778","Res36422","Per97178","Glo73865"],Glo73865,"Glo73865")

Actual (Unparsed): [[0.1157000]]

Expected (Unparsed): [[0.11570000000000003]]

Actual:   [[0.1157]]

Expected: [[0.1158]]