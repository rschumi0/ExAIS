import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr90736 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Thr90736 = keras.layers.ThresholdedReLU(theta=5.74759420729428, name = 'Thr90736', input_shape=(2, 1, 1, 1))(in0Thr90736)
Lay24371 = keras.layers.LayerNormalization(axis=1, epsilon=1.7055862558937673, name = 'Lay24371', )(Thr90736)
Res71433 = keras.layers.Reshape((2, 1, 1), name = 'Res71433', )(Lay24371)
Cro22872 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro22872', )(Res71433)
Res35832 = keras.layers.Reshape((1, 1), name = 'Res35832', )(Cro22872)
Sim28255 = keras.layers.SimpleRNN(3,name = 'Sim28255', )(Res35832)
model = tf.keras.models.Model(inputs=[in0Thr90736], outputs=Sim28255)
w = model.get_layer('Sim28255').get_weights() 
w[0] = np.array([[10, 2, 4]])
w[1] = np.array([[3, 10, 1], [7, 4, 1], [6, 4, 7]])
w[2] = np.array([4, 8, 8])
model.get_layer('Sim28255').set_weights(w) 
in0Thr90736 = tf.constant([[[[[0.6652]]], [[[0.7767]]]]])
print (np.array2string(model.predict([in0Thr90736],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim28255.png')

LThr90736 = thresholded_relu_layer([[[[[0.6652]]], [[[0.7767]]]]], 5.74759420729428, Thr90736), 
LLay24371 = layer_normalization_layer(Thr90736, 1, 1.7055862558937673, Lay24371), 
LRes71433 = reshape_layer(Lay24371, [2, 1, 1], Res71433), 
LCro22872 = cropping2D_layer(Res71433, 1, 0, 0, 0, Cro22872), 
LRes35832 = reshape_layer(Cro22872, [1, 1], Res35832), 
LSim28255 = simple_rnn_layer(Res35832,[[10, 2, 4]],[[3, 10, 1], [7, 4, 1], [6, 4, 7]],[4, 8, 8], Sim28255), 
exec_layers([LThr90736,LLay24371,LRes71433,LCro22872,LRes35832,LSim28255],["Thr90736","Lay24371","Res71433","Cro22872","Res35832","Sim28255"],Sim28255,"Sim28255")

Actual (Unparsed): [[0.9993293, 0.9999998, 0.9999998]]

Expected (Unparsed): [[0.999329299739067,0.9999997749296758,0.9999997749296758]]

Actual:   [[0.9994, 1, 1]]

Expected: [[0.9994, 1, 1]]