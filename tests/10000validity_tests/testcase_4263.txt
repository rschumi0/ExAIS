import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max20892 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Max20892 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Max20892 = keras.layers.Maximum(name = 'Max20892', )([in0Max20892,in1Max20892])
Bat17541 = keras.layers.BatchNormalization(axis=1, epsilon=0.4121992588337857,  name = 'Bat17541', )(Max20892)
model = tf.keras.models.Model(inputs=[in0Max20892,in1Max20892], outputs=Bat17541)
w = model.get_layer('Bat17541').get_weights() 
w[0] = np.array([0.3687])
w[1] = np.array([0.8132])
w[2] = np.array([0.1075])
w[3] = np.array([0.2193])
model.get_layer('Bat17541').set_weights(w) 
in0Max20892 = tf.constant([[[[[0.4157, 0.9822], [0.808, 0.9134]]]]])
in1Max20892 = tf.constant([[[[[0.7424, 0.2786], [0.6696, 0.0017]]]]])
print (np.array2string(model.predict([in0Max20892,in1Max20892],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat17541.png')

LMax20892 = maximum_layer([[[[[[0.4157, 0.9822], [0.808, 0.9134]]]]], [[[[[0.7424, 0.2786], [0.6696, 0.0017]]]]]], Max20892), 
LBat17541 = batch_normalization_layer(Max20892, 1, 0.4121992588337857, [0.3687], [0.8132], [0.1075], [0.2193], Bat17541), 
exec_layers([LMax20892,LBat17541],["Max20892","Bat17541"],Bat17541,"Bat17541")

Actual (Unparsed): [[[[[1.1077724, 1.2190316], [1.1382086, 1.1871107]]]]]

Expected (Unparsed): [[[[[1.1077723925105367,1.2190315824995535],[1.1382086012815105,1.1871106806178005]]]]]

Actual:   [[[[[1.1078, 1.2191], [1.1383, 1.1872]]]]]

Expected: [[[[[1.1078, 1.2191], [1.1383, 1.1872]]]]]