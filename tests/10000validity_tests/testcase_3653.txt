import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max89604 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Max89604 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Up_68849 = tf.keras.layers.Input(shape=([1, 1, 3, 3]))

Max89604 = keras.layers.Maximum(name = 'Max89604', )([in0Max89604,in1Max89604])
Res24429 = keras.layers.Reshape((1, 2, 1), name = 'Res24429', )(Max89604)
Res55149 = keras.layers.Reshape((1, 2), name = 'Res55149', )(Res24429)
Zer7376 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer7376', )(Res55149)
Up_68849 = keras.layers.UpSampling3D(size=(2, 1, 2), name = 'Up_68849', )(in0Up_68849)
Res16141 = keras.layers.Reshape((2, 1, 18), name = 'Res16141', )(Up_68849)
Res29735 = keras.layers.Reshape((2, 18), name = 'Res29735', )(Res16141)
Dot15979 = keras.layers.Dot(axes=(1, 1), name = 'Dot15979', )([Zer7376,Res29735])
model = tf.keras.models.Model(inputs=[in0Max89604,in1Max89604,in0Up_68849], outputs=Dot15979)
in0Max89604 = tf.constant([[[[[0.1189]], [[0.5839]]]]])
in1Max89604 = tf.constant([[[[[0.3206]], [[0.2482]]]]])
in0Up_68849 = tf.constant([[[[[1.0403, 1.7063, 1.0704], [1.5455, 1.0604, 1.5749], [1.628, 1.6678, 1.5668]]]]])
print (np.array2string(model.predict([in0Max89604,in1Max89604,in0Up_68849],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot15979.png')

LMax89604 = maximum_layer([[[[[[0.1189]], [[0.5839]]]]], [[[[[0.3206]], [[0.2482]]]]]], Max89604), 
LRes24429 = reshape_layer(Max89604, [1, 2, 1], Res24429), 
LRes55149 = reshape_layer(Res24429, [1, 2], Res55149), 
LZer7376 = zero_padding1D_layer(Res55149, 1, 0, Zer7376), 
LUp_68849 = up_sampling3D_layer([[[[[1.0403, 1.7063, 1.0704], [1.5455, 1.0604, 1.5749], [1.628, 1.6678, 1.5668]]]]], 2, 1, 2, Up_68849), 
LRes16141 = reshape_layer(Up_68849, [2, 1, 18], Res16141), 
LRes29735 = reshape_layer(Res16141, [2, 18], Res29735), 
LDot15979 = dot_layer(Zer7376,Res29735, 1, 1, Dot15979), 
exec_layers([LMax89604,LRes24429,LRes55149,LZer7376,LUp_68849,LRes16141,LRes29735,LDot15979],["Max89604","Res24429","Res55149","Zer7376","Up_68849","Res16141","Res29735","Dot15979"],Dot15979,"Dot15979")

Actual (Unparsed): [[[0.3335202, 0.5470398, 0.3431702, 0.3335202, 0.5470398, 0.3431702, 0.4954873, 0.3399642, 0.5049130, 0.4954873, 0.3399642, 0.5049130, 0.5219368, 0.5346967, 0.5023161, 0.5219368, 0.5346967, 0.5023161], [0.6074312, 0.9963085, 0.6250065, 0.6074312, 0.9963085, 0.6250065, 0.9024174, 0.6191675, 0.9195841, 0.9024174, 0.6191675, 0.9195841, 0.9505892, 0.9738283, 0.9148545, 0.9505892, 0.9738283, 0.9148545]]]

Expected (Unparsed): [[[0.33352018,0.54703978,0.34317024,0.33352018,0.54703978,0.34317024,0.4954873,0.33996424,0.50491294,0.4954873,0.33996424,0.50491294,0.5219368,0.5346966799999999,0.5023160799999999,0.5219368,0.5346966799999999,0.5023160799999999],[0.60743117,0.99630857,0.62500656,0.60743117,0.99630857,0.62500656,0.9024174500000001,0.61916756,0.91958411,0.9024174500000001,0.61916756,0.91958411,0.9505891999999999,0.9738284199999999,0.9148545199999999,0.9505891999999999,0.9738284199999999,0.9148545199999999]]]

Actual:   [[[0.3336, 0.5471, 0.3432, 0.3336, 0.5471, 0.3432, 0.4955, 0.34, 0.505, 0.4955, 0.34, 0.505, 0.522, 0.5347, 0.5024, 0.522, 0.5347, 0.5024], [0.6075, 0.9964, 0.6251, 0.6075, 0.9964, 0.6251, 0.9025, 0.6192, 0.9196, 0.9025, 0.6192, 0.9196, 0.9506, 0.9739, 0.9149, 0.9506, 0.9739, 0.9149]]]

Expected: [[[0.3336, 0.5471, 0.3432, 0.3336, 0.5471, 0.3432, 0.4955, 0.34, 0.505, 0.4955, 0.34, 0.505, 0.522, 0.5347, 0.5024, 0.522, 0.5347, 0.5024], [0.6075, 0.9964, 0.6251, 0.6075, 0.9964, 0.6251, 0.9025, 0.6192, 0.9196, 0.9025, 0.6192, 0.9196, 0.9506, 0.9739, 0.9149, 0.9506, 0.9739, 0.9149]]]