import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub61452 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub61452 = tf.keras.layers.Input(shape=([2, 2]))
in0Max71750 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Max71750 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Add88336 = tf.keras.layers.Input(shape=([1, 2]))
in1Add88336 = tf.keras.layers.Input(shape=([1, 2]))
in0Con90035 = tf.keras.layers.Input(shape=([2, 2]))

Sub61452 = keras.layers.Subtract(name = 'Sub61452', )([in0Sub61452,in1Sub61452])
Loc69938 = keras.layers.LocallyConnected1D(4, (1),strides=(2), name = 'Loc69938', )(Sub61452)
Max71750 = keras.layers.Maximum(name = 'Max71750', )([in0Max71750,in1Max71750])
Res80661 = keras.layers.Reshape((2, 2, 2), name = 'Res80661', )(Max71750)
Res40855 = keras.layers.Reshape((2, 4), name = 'Res40855', )(Res80661)
Add88336 = keras.layers.Add(name = 'Add88336', )([in0Add88336,in1Add88336])
Zer83832 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer83832', )(Add88336)
Con90035 = keras.layers.Concatenate(axis=2, name = 'Con90035', )([Zer83832,in0Con90035])
Ave31541 = keras.layers.Average(name = 'Ave31541', )([Res40855,Con90035])
Dot7881 = keras.layers.Dot(axes=(2, 2), name = 'Dot7881', )([Loc69938,Ave31541])
model = tf.keras.models.Model(inputs=[in0Sub61452,in1Sub61452,in0Max71750,in1Max71750,in0Add88336,in1Add88336,in0Con90035], outputs=Dot7881)
w = model.get_layer('Loc69938').get_weights() 
w[0] = np.array([[[0.9047, 0.0218, 0.9905, 0.9212], [0.9075, 0.0667, 0.2183, 0.7795]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc69938').set_weights(w) 
in0Sub61452 = tf.constant([[[0.976, 0.5409], [0.0098, 0.5255]]])
in1Sub61452 = tf.constant([[[0.9451, 0.4977], [0.6973, 0.5107]]])
in0Max71750 = tf.constant([[[[[0.9217], [0.2171]], [[0.0788], [0.3394]]], [[[0.03], [0.9404]], [[0.6359], [0.6651]]]]])
in1Max71750 = tf.constant([[[[[0.6823], [0.8462]], [[0.5927], [0.5237]]], [[[0.2343], [0.7845]], [[0.113], [0.2249]]]]])
in0Add88336 = tf.constant([[[0.9693, 0.9672]]])
in1Add88336 = tf.constant([[[0.2991, 0.2639]]])
in0Con90035 = tf.constant([[[0.5238, 0.0153], [0.7692, 0.4476]]])
print (np.array2string(model.predict([in0Sub61452,in1Sub61452,in0Max71750,in1Max71750,in0Add88336,in1Add88336,in0Con90035],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot7881.png')

LSub61452 = subtract_layer([[[0.976, 0.5409], [0.0098, 0.5255]]], [[[0.9451, 0.4977], [0.6973, 0.5107]]], Sub61452), 
LLoc69938 = locally_connected1D_layer(Sub61452, 1,[[[0.9047, 0.0218, 0.9905, 0.9212], [0.9075, 0.0667, 0.2183, 0.7795]]],[[0, 0, 0, 0]], 2, Loc69938), 
LMax71750 = maximum_layer([[[[[[0.9217], [0.2171]], [[0.0788], [0.3394]]], [[[0.03], [0.9404]], [[0.6359], [0.6651]]]]], [[[[[0.6823], [0.8462]], [[0.5927], [0.5237]]], [[[0.2343], [0.7845]], [[0.113], [0.2249]]]]]], Max71750), 
LRes80661 = reshape_layer(Max71750, [2, 2, 2], Res80661), 
LRes40855 = reshape_layer(Res80661, [2, 4], Res40855), 
LAdd88336 = add_layer([[[[0.9693, 0.9672]]], [[[0.2991, 0.2639]]]], Add88336), 
LZer83832 = zero_padding1D_layer(Add88336, 1, 0, Zer83832), 
LCon90035 = concatenate_layer([Zer83832,[[[0.5238, 0.0153], [0.7692, 0.4476]]]], 2, Con90035), 
LAve31541 = average_layer([Res40855,Con90035], Ave31541), 
LDot7881 = dot_layer(Loc69938,Ave31541, 2, 2, Dot7881), 
exec_layers([LSub61452,LLoc69938,LMax71750,LRes80661,LRes40855,LAdd88336,LZer83832,LCon90035,LAve31541,LDot7881],["Sub61452","Loc69938","Max71750","Res80661","Res40855","Add88336","Zer83832","Con90035","Ave31541","Dot7881"],Dot7881,"Dot7881")

Actual (Unparsed): [[[0.0715517, 0.1170193]]]

Expected (Unparsed): [[[0.07155172772399997,0.11701929492899996]]]

Actual:   [[[0.0716, 0.1171]]]

Expected: [[[0.0716, 0.1171]]]