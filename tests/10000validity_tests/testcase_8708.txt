import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL23443 = tf.keras.layers.Input(shape=([1, 2]))
in0Con70077 = tf.keras.layers.Input(shape=([1, 2]))
in0Add30556 = tf.keras.layers.Input(shape=([1, 1]))
in1Add30556 = tf.keras.layers.Input(shape=([1, 1]))

ReL23443 = keras.layers.ReLU(max_value=3.8853372578565146, negative_slope=3.81450219678529, threshold=5.568746694400376, name = 'ReL23443', input_shape=(1, 2))(in0ReL23443)
Res17441 = keras.layers.Reshape((1, 2, 1), name = 'Res17441', )(ReL23443)
Ave46888 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Ave46888', )(Res17441)
Res53394 = keras.layers.Reshape((1, 2), name = 'Res53394', )(Ave46888)
Con70077 = keras.layers.Concatenate(axis=2, name = 'Con70077', )([Res53394,in0Con70077])
Add30556 = keras.layers.Add(name = 'Add30556', )([in0Add30556,in1Add30556])
Den40892 = keras.layers.Dense(4,name = 'Den40892', )(Add30556)
Ave81103 = keras.layers.Average(name = 'Ave81103', )([Con70077,Den40892])
model = tf.keras.models.Model(inputs=[in0ReL23443,in0Con70077,in0Add30556,in1Add30556], outputs=Ave81103)
w = model.get_layer('Den40892').get_weights() 
w[0] = np.array([[0.3079, 0.5294, 0.2457, 0.8446]])
w[1] = np.array([0.566, 0.495, 0.4073, 0.5825])
model.get_layer('Den40892').set_weights(w) 
in0ReL23443 = tf.constant([[[0.5308, 0.0867]]])
in0Con70077 = tf.constant([[[0.8305, 0.9845]]])
in0Add30556 = tf.constant([[[0.9934]]])
in1Add30556 = tf.constant([[[0.7955]]])
print (np.array2string(model.predict([in0ReL23443,in0Con70077,in0Add30556,in1Add30556],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave81103.png')

LReL23443 = relu_layer([[[0.5308, 0.0867]]], 3.8853372578565146, 3.81450219678529, 5.568746694400376, ReL23443), 
LRes17441 = reshape_layer(ReL23443, [1, 2, 1], Res17441), 
LAve46888 = average_pooling2D_layer(Res17441, 1, 1, 1, 1, true, Ave46888), 
LRes53394 = reshape_layer(Ave46888, [1, 2], Res53394), 
LCon70077 = concatenate_layer([Res53394,[[[0.8305, 0.9845]]]], 2, Con70077), 
LAdd30556 = add_layer([[[[0.9934]]], [[[0.7955]]]], Add30556), 
LDen40892 = dense_layer(Add30556, [[0.3079, 0.5294, 0.2457, 0.8446]],[0.566, 0.495, 0.4073, 0.5825], Den40892), 
LAve81103 = average_layer([Con70077,Den40892], Ave81103), 
exec_layers([LReL23443,LRes17441,LAve46888,LRes53394,LCon70077,LAdd30556,LDen40892,LAve81103],["ReL23443","Res17441","Ave46888","Res53394","Con70077","Add30556","Den40892","Ave81103"],Ave81103,"Ave81103")

Actual (Unparsed): [[[-9.0502282, -9.7346178, 0.8386664, 1.5389524]]]

Expected (Unparsed): [[[-9.05022821153871,-9.734617749334886,0.838666365,1.5389524700000001]]]

Actual:   [[[-9.0502, -9.7346, 0.8387, 1.539]]]

Expected: [[[-9.0502, -9.7346, 0.8387, 1.539]]]