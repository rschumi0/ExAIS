import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL46010 = tf.keras.layers.Input(shape=([2, 2]))
in0Con70472 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Min10667 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min10667 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con15377 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Mul73886 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul73886 = tf.keras.layers.Input(shape=([1, 2, 2]))

ReL46010 = keras.layers.ReLU(max_value=6.369202452553402, negative_slope=6.65983271727821, threshold=9.50214805951738, name = 'ReL46010', input_shape=(2, 2))(in0ReL46010)
Res37224 = keras.layers.Reshape((2, 2, 1), name = 'Res37224', )(ReL46010)
Sep61316 = keras.layers.SeparableConv2D(3, (2, 2),strides=(1, 1), padding='valid', name = 'Sep61316', )(Res37224)
Res59399 = keras.layers.Reshape((1, 3), name = 'Res59399', )(Sep61316)
GRU57053 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU57053', )(Res59399)
Res99076 = keras.layers.Reshape((1, 1), name = 'Res99076', )(GRU57053)
Res83367 = keras.layers.Reshape((1, 1, 1), name = 'Res83367', )(Res99076)
Zer15364 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer15364', )(Res83367)
Con70472 = keras.layers.Concatenate(axis=3, name = 'Con70472', )([Zer15364,in0Con70472])
Min10667 = keras.layers.Minimum(name = 'Min10667', )([in0Min10667,in1Min10667])
Con15377 = keras.layers.Concatenate(axis=3, name = 'Con15377', )([Min10667,in0Con15377])
Mul73886 = keras.layers.Multiply(name = 'Mul73886', )([in0Mul73886,in1Mul73886])
Add74163 = keras.layers.Add(name = 'Add74163', )([Con15377,Mul73886])
Sub13516 = keras.layers.Subtract(name = 'Sub13516', )([Con70472,Add74163])
model = tf.keras.models.Model(inputs=[in0ReL46010,in0Con70472,in0Min10667,in1Min10667,in0Con15377,in0Mul73886,in1Mul73886], outputs=Sub13516)
w = model.get_layer('Sep61316').get_weights() 
w[0] = np.array([[[[0.9894]], [[0.1381]]], [[[0.621]], [[0.1805]]]])
w[1] = np.array([[[[0.4252, 0.1206, 0.096]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep61316').set_weights(w) 
w = model.get_layer('GRU57053').get_weights() 
w[0] = np.array([[9, 8, 1], [7, 5, 8], [9, 9, 1]])
w[1] = np.array([[1, 5, 6]])
w[2] = np.array([7, 5, 5])
model.get_layer('GRU57053').set_weights(w) 
in0ReL46010 = tf.constant([[[0.2904, 0.2546], [0.5392, 0.0165]]])
in0Con70472 = tf.constant([[[[0.7689], [0.5836]]]])
in0Min10667 = tf.constant([[[[0.3907], [0.3237]]]])
in1Min10667 = tf.constant([[[[0.4348], [0.3592]]]])
in0Con15377 = tf.constant([[[[0.8352], [0.5905]]]])
in0Mul73886 = tf.constant([[[[0.6705, 0.8328], [0.034, 0.4758]]]])
in1Mul73886 = tf.constant([[[[0.0859, 0.8988], [0.3299, 0.6133]]]])
print (np.array2string(model.predict([in0ReL46010,in0Con70472,in0Min10667,in1Min10667,in0Con15377,in0Mul73886,in1Mul73886],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub13516.png')

LReL46010 = relu_layer([[[0.2904, 0.2546], [0.5392, 0.0165]]], 6.369202452553402, 6.65983271727821, 9.50214805951738, ReL46010), 
LRes37224 = reshape_layer(ReL46010, [2, 2, 1], Res37224), 
LSep61316 = separable_conv2D_layer(Res37224, 2, 2,[[[[[0.9894]], [[0.1381]]], [[[0.621]], [[0.1805]]]],[[[[0.4252, 0.1206, 0.096]]]]],[0, 0, 0], 1, 1, false, Sep61316), 
LRes59399 = reshape_layer(Sep61316, [1, 3], Res59399), 
LGRU57053 = gru_layer(Res59399,[[9, 8, 1], [7, 5, 8], [9, 9, 1]],[[1, 5, 6]],[7, 5, 5], false, GRU57053), 
LRes99076 = reshape_layer(GRU57053, [1, 1], Res99076), 
LRes83367 = reshape_layer(Res99076, [1, 1, 1], Res83367), 
LZer15364 = zero_padding2D_layer(Res83367, 0, 0, 1, 0, Zer15364), 
LCon70472 = concatenate_layer([Zer15364,[[[[0.7689], [0.5836]]]]], 3, Con70472), 
LMin10667 = minimum_layer([[[[[0.3907], [0.3237]]]], [[[[0.4348], [0.3592]]]]], Min10667), 
LCon15377 = concatenate_layer([Min10667,[[[[0.8352], [0.5905]]]]], 3, Con15377), 
LMul73886 = multiply_layer([[[[[0.6705, 0.8328], [0.034, 0.4758]]]], [[[[0.0859, 0.8988], [0.3299, 0.6133]]]]], Mul73886), 
LAdd74163 = add_layer([Con15377,Mul73886], Add74163), 
LSub13516 = subtract_layer(Con70472,Add74163, Sub13516), 
exec_layers([LReL46010,LRes37224,LSep61316,LRes59399,LGRU57053,LRes99076,LRes83367,LZer15364,LCon70472,LMin10667,LCon15377,LMul73886,LAdd74163,LSub13516],["ReL46010","Res37224","Sep61316","Res59399","GRU57053","Res99076","Res83367","Zer15364","Con70472","Min10667","Con15377","Mul73886","Add74163","Sub13516"],Sub13516,"Sub13516")

Actual (Unparsed): [[[[-0.4482960, -0.8148207], [-1.3349166, -0.2987082]]]]

Expected (Unparsed): [[[[-0.44829595,-0.8148206400000001],[-1.3349166000000001,-0.29870814]]]]

Actual:   [[[[-0.4482, -0.8148], [-1.3349, -0.2987]]]]

Expected: [[[[-0.4482, -0.8148], [-1.3349, -0.2987]]]]