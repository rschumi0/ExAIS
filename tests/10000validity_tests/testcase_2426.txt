import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave39148 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave39148 = tf.keras.layers.Input(shape=([1, 1]))
in0GRU85171 = tf.keras.layers.Input(shape=([1, 2]))

Ave39148 = keras.layers.Average(name = 'Ave39148', )([in0Ave39148,in1Ave39148])
Glo38407 = keras.layers.GlobalMaxPool1D(name = 'Glo38407', )(Ave39148)
Res64053 = keras.layers.Reshape((1, 1), name = 'Res64053', )(Glo38407)
Res7244 = keras.layers.Reshape((1, 1, 1), name = 'Res7244', )(Res64053)
Max27872 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Max27872', )(Res7244)
Res16210 = keras.layers.Reshape((1, 1), name = 'Res16210', )(Max27872)
Fla92096 = keras.layers.Flatten(name = 'Fla92096', )(Res16210)
GRU85171 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU85171', )(in0GRU85171)
Add7356 = keras.layers.Add(name = 'Add7356', )([Fla92096,GRU85171])
Res36716 = keras.layers.Reshape((1, 1), name = 'Res36716', )(Add7356)
Res95584 = keras.layers.Reshape((1, 1, 1), name = 'Res95584', )(Res36716)
Up_69366 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_69366', )(Res95584)
model = tf.keras.models.Model(inputs=[in0Ave39148,in1Ave39148,in0GRU85171], outputs=Up_69366)
w = model.get_layer('GRU85171').get_weights() 
w[0] = np.array([[2, 7, 9], [7, 10, 6]])
w[1] = np.array([[10, 4, 7]])
w[2] = np.array([3, 3, 5])
model.get_layer('GRU85171').set_weights(w) 
in0Ave39148 = tf.constant([[[0.4923]]])
in1Ave39148 = tf.constant([[[0.423]]])
in0GRU85171 = tf.constant([[[3, 2]]])
print (np.array2string(model.predict([in0Ave39148,in1Ave39148,in0GRU85171],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_69366.png')

LAve39148 = average_layer([[[[0.4923]]], [[[0.423]]]], Ave39148), 
LGlo38407 = global_max_pool1D_layer(Ave39148, Glo38407), 
LRes64053 = reshape_layer(Glo38407, [1, 1], Res64053), 
LRes7244 = reshape_layer(Res64053, [1, 1, 1], Res7244), 
LMax27872 = max_pool2D_layer(Res7244, 1, 1, 1, 1, true, Max27872), 
LRes16210 = reshape_layer(Max27872, [1, 1], Res16210), 
LFla92096 = flatten_layer(Res16210, Fla92096), 
LGRU85171 = gru_layer([[[3, 2]]],[[2, 7, 9], [7, 10, 6]],[[10, 4, 7]],[3, 3, 5], false, GRU85171), 
LAdd7356 = add_layer([Fla92096,GRU85171], Add7356), 
LRes36716 = reshape_layer(Add7356, [1, 1], Res36716), 
LRes95584 = reshape_layer(Res36716, [1, 1, 1], Res95584), 
LUp_69366 = up_sampling2D_layer(Res95584, 2, 1, Up_69366), 
exec_layers([LAve39148,LGlo38407,LRes64053,LRes7244,LMax27872,LRes16210,LFla92096,LGRU85171,LAdd7356,LRes36716,LRes95584,LUp_69366],["Ave39148","Glo38407","Res64053","Res7244","Max27872","Res16210","Fla92096","GRU85171","Add7356","Res36716","Res95584","Up_69366"],Up_69366,"Up_69366")

Actual (Unparsed): [[[[0.4576500]], [[0.4576500]]]]

Expected (Unparsed): [[[[0.4576500001026188]],[[0.4576500001026188]]]]

Actual:   [[[[0.4577]], [[0.4577]]]]

Expected: [[[[0.4577]], [[0.4577]]]]