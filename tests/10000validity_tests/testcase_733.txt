import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub14672 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub14672 = tf.keras.layers.Input(shape=([2, 2]))

Sub14672 = keras.layers.Subtract(name = 'Sub14672', )([in0Sub14672,in1Sub14672])
Res60307 = keras.layers.Reshape((2, 2, 1), name = 'Res60307', )(Sub14672)
Sep19104 = keras.layers.SeparableConv2D(4, (1, 1),strides=(2, 2), padding='same', name = 'Sep19104', )(Res60307)
Res3396 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res3396', )(Sep19104)
PRe46998 = keras.layers.PReLU(name = 'PRe46998', )(Res3396)
model = tf.keras.models.Model(inputs=[in0Sub14672,in1Sub14672], outputs=PRe46998)
w = model.get_layer('Sep19104').get_weights() 
w[0] = np.array([[[[0.0452]]]])
w[1] = np.array([[[[0.5556, 0.2552, 0.9884, 0.7464]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep19104').set_weights(w) 
w = model.get_layer('PRe46998').get_weights() 
w[0] = np.array([[[[0.9369], [0.9674], [0.4226], [0.5095]]]])
model.get_layer('PRe46998').set_weights(w) 
in0Sub14672 = tf.constant([[[0.52, 0.4705], [0.335, 0.5921]]])
in1Sub14672 = tf.constant([[[0.358, 0.6738], [0.1448, 0.1926]]])
print (np.array2string(model.predict([in0Sub14672,in1Sub14672],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe46998.png')

LSub14672 = subtract_layer([[[0.52, 0.4705], [0.335, 0.5921]]], [[[0.358, 0.6738], [0.1448, 0.1926]]], Sub14672), 
LRes60307 = reshape_layer(Sub14672, [2, 2, 1], Res60307), 
LSep19104 = separable_conv2D_layer(Res60307, 1, 1,[[[[[0.0452]]]],[[[[0.5556, 0.2552, 0.9884, 0.7464]]]]],[0, 0, 0, 0], 2, 2, true, Sep19104), 
LRes3396 = reshape_layer(Sep19104, [1, 1, 4, 1], Res3396), 
LPRe46998 = prelu_layer(Res3396, [[[[0.9369], [0.9674], [0.4226], [0.5095]]]], PRe46998), 
exec_layers([LSub14672,LRes60307,LSep19104,LRes3396,LPRe46998],["Sub14672","Res60307","Sep19104","Res3396","PRe46998"],PRe46998,"PRe46998")

Actual (Unparsed): [[[[[0.0040683], [0.0018687], [0.0072375], [0.0054654]]]]]

Expected (Unparsed): [[[[[0.00406832544],[0.00186867648],[0.0072374601600000005],[0.00546543936]]]]]

Actual:   [[[[[0.0041], [0.0019], [0.0073], [0.0055]]]]]

Expected: [[[[[0.0041], [0.0019], [0.0073], [0.0055]]]]]