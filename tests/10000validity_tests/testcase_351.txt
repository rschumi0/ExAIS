import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min32468 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Min32468 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Zer7494 = tf.keras.layers.Input(shape=([1, 1]))
in0Cro19939 = tf.keras.layers.Input(shape=([4, 1, 1]))
in0Fla37327 = tf.keras.layers.Input(shape=([2]))
in0Con23255 = tf.keras.layers.Input(shape=([2, 2]))

Min32468 = keras.layers.Minimum(name = 'Min32468', )([in0Min32468,in1Min32468])
Res82128 = keras.layers.Reshape((2, 1, 1), name = 'Res82128', )(Min32468)
Res40633 = keras.layers.Reshape((2, 1), name = 'Res40633', )(Res82128)
Zer7494 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer7494', )(in0Zer7494)
Dot916 = keras.layers.Dot(axes=(2, 2), name = 'Dot916', )([Res40633,Zer7494])
Cro19939 = keras.layers.Cropping2D(cropping=((1, 1), (0, 0)), name = 'Cro19939', )(in0Cro19939)
Res9698 = keras.layers.Reshape((2, 1), name = 'Res9698', )(Cro19939)
Fla37327 = keras.layers.Flatten(name = 'Fla37327', )(in0Fla37327)
Res97439 = keras.layers.Reshape((2, 1), name = 'Res97439', )(Fla37327)
Sub67878 = keras.layers.Subtract(name = 'Sub67878', )([Res9698,Res97439])
Thr87975 = keras.layers.ThresholdedReLU(theta=3.5758969917228876, name = 'Thr87975', )(Sub67878)
Con23255 = keras.layers.Concatenate(axis=2, name = 'Con23255', )([Thr87975,in0Con23255])
Max62487 = keras.layers.Maximum(name = 'Max62487', )([Dot916,Con23255])
model = tf.keras.models.Model(inputs=[in0Min32468,in1Min32468,in0Zer7494,in0Cro19939,in0Fla37327,in0Con23255], outputs=Max62487)
in0Min32468 = tf.constant([[[[[0.2448]]], [[[0.9618]]]]])
in1Min32468 = tf.constant([[[[[0.0842]]], [[[0.0959]]]]])
in0Zer7494 = tf.constant([[[1.1701]]])
in0Cro19939 = tf.constant([[[[1.2943]], [[1.1894]], [[1.9152]], [[1.2702]]]])
in0Fla37327 = tf.constant([[1.3039, 1.9044]])
in0Con23255 = tf.constant([[[0.1691, 0.5558], [0.3012, 0.7222]]])
print (np.array2string(model.predict([in0Min32468,in1Min32468,in0Zer7494,in0Cro19939,in0Fla37327,in0Con23255],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max62487.png')

LMin32468 = minimum_layer([[[[[[0.2448]]], [[[0.9618]]]]], [[[[[0.0842]]], [[[0.0959]]]]]], Min32468), 
LRes82128 = reshape_layer(Min32468, [2, 1, 1], Res82128), 
LRes40633 = reshape_layer(Res82128, [2, 1], Res40633), 
LZer7494 = zero_padding1D_layer([[[1.1701]]], 1, 1, Zer7494), 
LDot916 = dot_layer(Res40633,Zer7494, 2, 2, Dot916), 
LCro19939 = cropping2D_layer([[[[1.2943]], [[1.1894]], [[1.9152]], [[1.2702]]]], 1, 1, 0, 0, Cro19939), 
LRes9698 = reshape_layer(Cro19939, [2, 1], Res9698), 
LFla37327 = flatten_layer([[1.3039, 1.9044]], Fla37327), 
LRes97439 = reshape_layer(Fla37327, [2, 1], Res97439), 
LSub67878 = subtract_layer(Res9698,Res97439, Sub67878), 
LThr87975 = thresholded_relu_layer(Sub67878, 3.5758969917228876, Thr87975), 
LCon23255 = concatenate_layer([Thr87975,[[[0.1691, 0.5558], [0.3012, 0.7222]]]], 2, Con23255), 
LMax62487 = maximum_layer([Dot916,Con23255], Max62487), 
exec_layers([LMin32468,LRes82128,LRes40633,LZer7494,LDot916,LCro19939,LRes9698,LFla37327,LRes97439,LSub67878,LThr87975,LCon23255,LMax62487],["Min32468","Res82128","Res40633","Zer7494","Dot916","Cro19939","Res9698","Fla37327","Res97439","Sub67878","Thr87975","Con23255","Max62487"],Max62487,"Max62487")

Actual (Unparsed): [[[-0.0000000, 0.1691000, 0.5558000], [0.0000000, 0.3012000, 0.7222000]]]

Expected (Unparsed): [[[0.0,0.1691,0.5558],[0.0,0.3012,0.7222]]]

Actual:   [[[-0, 0.1691, 0.5558], [0, 0.3012, 0.7222]]]

Expected: [[[0, 0.1691, 0.5558], [0, 0.3012, 0.7222]]]