import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub49992 = tf.keras.layers.Input(shape=([2, 3, 3]))
in1Sub49992 = tf.keras.layers.Input(shape=([2, 3, 3]))
in0Min49161 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Min49161 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Sub49992 = keras.layers.Subtract(name = 'Sub49992', )([in0Sub49992,in1Sub49992])
Res95892 = keras.layers.Reshape((2, 9), name = 'Res95892', )(Sub49992)
Sep41197 = keras.layers.SeparableConv1D(3, (2),strides=(1), padding='same', name = 'Sep41197', )(Res95892)
Res84583 = keras.layers.Reshape((2, 3, 1), name = 'Res84583', )(Sep41197)
Res3576 = keras.layers.Reshape((2, 3, 1, 1), name = 'Res3576', )(Res84583)
Min49161 = keras.layers.Minimum(name = 'Min49161', )([in0Min49161,in1Min49161])
Zer9388 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer9388', )(Min49161)
Min86759 = keras.layers.Minimum(name = 'Min86759', )([Res3576,Zer9388])
model = tf.keras.models.Model(inputs=[in0Sub49992,in1Sub49992,in0Min49161,in1Min49161], outputs=Min86759)
w = model.get_layer('Sep41197').get_weights() 
w[0] = np.array([[[0.127], [0.557], [0.686], [0.4557], [0.8641], [0.8503], [0.1165], [0.1058], [0.8848]], [[0.916], [0.5906], [0.2207], [0.2558], [0.7192], [0.4636], [0.1749], [0.9047], [0.4328]]])
w[1] = np.array([[[0.9466, 0.3294, 0.5372], [0.7743, 0.931, 0.6581], [0.399, 0.2939, 0.606], [0.2178, 0.1044, 0.9034], [0.2084, 0.3959, 0.7598], [0.7875, 0.073, 0.8692], [0.317, 0.435, 0.5469], [0.6115, 0.6381, 0.7479], [0.2172, 0.0192, 0.8196]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep41197').set_weights(w) 
in0Sub49992 = tf.constant([[[[0.3605, 0.3257, 0.5835], [0.7747, 0.8624, 0.9975], [0.6618, 0.3054, 0.9941]], [[0.9611, 0.5898, 0.9362], [0.1258, 0.2964, 0.5471], [0.8177, 0.3549, 0.997]]]])
in1Sub49992 = tf.constant([[[[0.4172, 0.9417, 0.1989], [0.6307, 0.9019, 0.0368], [0.4217, 0.5351, 0.1491]], [[0.7272, 0.8371, 0.2691], [0.1558, 0.8664, 0.3376], [0.3038, 0.8813, 0.1058]]]])
in0Min49161 = tf.constant([[[[[0.5904]], [[0.2241]]]]])
in1Min49161 = tf.constant([[[[[0.958]], [[0.4397]]]]])
print (np.array2string(model.predict([in0Sub49992,in1Sub49992,in0Min49161,in1Min49161],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min86759.png')

LSub49992 = subtract_layer([[[[0.3605, 0.3257, 0.5835], [0.7747, 0.8624, 0.9975], [0.6618, 0.3054, 0.9941]], [[0.9611, 0.5898, 0.9362], [0.1258, 0.2964, 0.5471], [0.8177, 0.3549, 0.997]]]], [[[[0.4172, 0.9417, 0.1989], [0.6307, 0.9019, 0.0368], [0.4217, 0.5351, 0.1491]], [[0.7272, 0.8371, 0.2691], [0.1558, 0.8664, 0.3376], [0.3038, 0.8813, 0.1058]]]], Sub49992), 
LRes95892 = reshape_layer(Sub49992, [2, 9], Res95892), 
LSep41197 = separable_conv1D_layer(Res95892, 2,[[[[0.127], [0.557], [0.686], [0.4557], [0.8641], [0.8503], [0.1165], [0.1058], [0.8848]], [[0.916], [0.5906], [0.2207], [0.2558], [0.7192], [0.4636], [0.1749], [0.9047], [0.4328]]],[[[0.9466, 0.3294, 0.5372], [0.7743, 0.931, 0.6581], [0.399, 0.2939, 0.606], [0.2178, 0.1044, 0.9034], [0.2084, 0.3959, 0.7598], [0.7875, 0.073, 0.8692], [0.317, 0.435, 0.5469], [0.6115, 0.6381, 0.7479], [0.2172, 0.0192, 0.8196]]]],[0, 0, 0], 1, true, Sep41197), 
LRes84583 = reshape_layer(Sep41197, [2, 3, 1], Res84583), 
LRes3576 = reshape_layer(Res84583, [2, 3, 1, 1], Res3576), 
LMin49161 = minimum_layer([[[[[[0.5904]], [[0.2241]]]]], [[[[[0.958]], [[0.4397]]]]]], Min49161), 
LZer9388 = zero_padding3D_layer(Min49161, 1, 0, 1, 0, 0, 0, Zer9388), 
LMin86759 = minimum_layer([Res3576,Zer9388], Min86759), 
exec_layers([LSub49992,LRes95892,LSep41197,LRes84583,LRes3576,LMin49161,LZer9388,LMin86759],["Sub49992","Res95892","Sep41197","Res84583","Res3576","Min49161","Zer9388","Min86759"],Min86759,"Min86759")

Actual (Unparsed): [[[[[0.0000000]], [[-0.6158033]], [[0.0000000]]], [[[0.0000000]], [[-0.1617324]], [[0.2241000]]]]]

Expected (Unparsed): [[[[[0]],[[-0.6158033059539999]],[[0]]],[[[0]],[[-0.16173241201999994]],[[0.2241]]]]]

Actual:   [[[[[0]], [[-0.6158]], [[0]]], [[[0]], [[-0.1617]], [[0.2241]]]]]

Expected: [[[[[0]], [[-0.6158]], [[0]]], [[[0]], [[-0.1617]], [[0.2241]]]]]