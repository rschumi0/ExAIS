import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub82187 = tf.keras.layers.Input(shape=([3]))
in1Sub82187 = tf.keras.layers.Input(shape=([3]))
in0Con53313 = tf.keras.layers.Input(shape=([4, 1]))
in0Add32382 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add32382 = tf.keras.layers.Input(shape=([2, 2, 1]))

Sub82187 = keras.layers.Subtract(name = 'Sub82187', )([in0Sub82187,in1Sub82187])
Res63538 = keras.layers.Reshape((3, 1), name = 'Res63538', )(Sub82187)
Res79250 = keras.layers.Reshape((3, 1, 1), name = 'Res79250', )(Res63538)
Ave35380 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave35380', )(Res79250)
Res28163 = keras.layers.Reshape((3, 1), name = 'Res28163', )(Ave35380)
Zer28303 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer28303', )(Res28163)
Con53313 = keras.layers.Concatenate(axis=2, name = 'Con53313', )([Zer28303,in0Con53313])
Add32382 = keras.layers.Add(name = 'Add32382', )([in0Add32382,in1Add32382])
Res70457 = keras.layers.Reshape((2, 2), name = 'Res70457', )(Add32382)
Zer18633 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer18633', )(Res70457)
Max54356 = keras.layers.Maximum(name = 'Max54356', )([Con53313,Zer18633])
model = tf.keras.models.Model(inputs=[in0Sub82187,in1Sub82187,in0Con53313,in0Add32382,in1Add32382], outputs=Max54356)
in0Sub82187 = tf.constant([[0.3517, 0.4697, 0.7917]])
in1Sub82187 = tf.constant([[0.3706, 0.8811, 0.6508]])
in0Con53313 = tf.constant([[[0.5875], [0.4597], [0.7879], [0.8718]]])
in0Add32382 = tf.constant([[[[0.3243], [0.7188]], [[0.6025], [0.8463]]]])
in1Add32382 = tf.constant([[[[0.086], [0.2457]], [[0.698], [0.0914]]]])
print (np.array2string(model.predict([in0Sub82187,in1Sub82187,in0Con53313,in0Add32382,in1Add32382],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max54356.png')

LSub82187 = subtract_layer([[0.3517, 0.4697, 0.7917]], [[0.3706, 0.8811, 0.6508]], Sub82187), 
LRes63538 = reshape_layer(Sub82187, [3, 1], Res63538), 
LRes79250 = reshape_layer(Res63538, [3, 1, 1], Res79250), 
LAve35380 = average_pooling2D_layer(Res79250, 1, 1, Ave35380), 
LRes28163 = reshape_layer(Ave35380, [3, 1], Res28163), 
LZer28303 = zero_padding1D_layer(Res28163, 1, 0, Zer28303), 
LCon53313 = concatenate_layer([Zer28303,[[[0.5875], [0.4597], [0.7879], [0.8718]]]], 2, Con53313), 
LAdd32382 = add_layer([[[[[0.3243], [0.7188]], [[0.6025], [0.8463]]]], [[[[0.086], [0.2457]], [[0.698], [0.0914]]]]], Add32382), 
LRes70457 = reshape_layer(Add32382, [2, 2], Res70457), 
LZer18633 = zero_padding1D_layer(Res70457, 1, 1, Zer18633), 
LMax54356 = maximum_layer([Con53313,Zer18633], Max54356), 
exec_layers([LSub82187,LRes63538,LRes79250,LAve35380,LRes28163,LZer28303,LCon53313,LAdd32382,LRes70457,LZer18633,LMax54356],["Sub82187","Res63538","Res79250","Ave35380","Res28163","Zer28303","Con53313","Add32382","Res70457","Zer18633","Max54356"],Max54356,"Max54356")

Actual (Unparsed): [[[0.0000000, 0.5875000], [0.4103000, 0.9645000], [1.3005000, 0.9377000], [0.1409000, 0.8718000]]]

Expected (Unparsed): [[[0,0.5875],[0.4103,0.9645],[1.3005,0.9377000000000001],[0.14089999999999991,0.8718]]]

Actual:   [[[0, 0.5875], [0.4103, 0.9645], [1.3005, 0.9377], [0.1409, 0.8718]]]

Expected: [[[0, 0.5875], [0.4103, 0.9645], [1.3005, 0.9378], [0.1409, 0.8718]]]