import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul85491 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul85491 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Add50616 = tf.keras.layers.Input(shape=([1, 1]))
in1Add50616 = tf.keras.layers.Input(shape=([1, 1]))

Mul85491 = keras.layers.Multiply(name = 'Mul85491', )([in0Mul85491,in1Mul85491])
Den189 = keras.layers.Dense(1,name = 'Den189', )(Mul85491)
Res22759 = keras.layers.Reshape((2, 1), name = 'Res22759', )(Den189)
Add50616 = keras.layers.Add(name = 'Add50616', )([in0Add50616,in1Add50616])
Zer64205 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer64205', )(Add50616)
Max44351 = keras.layers.Maximum(name = 'Max44351', )([Res22759,Zer64205])
model = tf.keras.models.Model(inputs=[in0Mul85491,in1Mul85491,in0Add50616,in1Add50616], outputs=Max44351)
w = model.get_layer('Den189').get_weights() 
w[0] = np.array([[0.1732]])
w[1] = np.array([0.6594])
model.get_layer('Den189').set_weights(w) 
in0Mul85491 = tf.constant([[[[0.196]], [[0.7012]]]])
in1Mul85491 = tf.constant([[[[0.6775]], [[0.2142]]]])
in0Add50616 = tf.constant([[[0.3057]]])
in1Add50616 = tf.constant([[[0.4013]]])
print (np.array2string(model.predict([in0Mul85491,in1Mul85491,in0Add50616,in1Add50616],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max44351.png')

LMul85491 = multiply_layer([[[[[0.196]], [[0.7012]]]], [[[[0.6775]], [[0.2142]]]]], Mul85491), 
LDen189 = dense_layer(Mul85491, [[0.1732]],[0.6594], Den189), 
LRes22759 = reshape_layer(Den189, [2, 1], Res22759), 
LAdd50616 = add_layer([[[[0.3057]]], [[[0.4013]]]], Add50616), 
LZer64205 = zero_padding1D_layer(Add50616, 1, 0, Zer64205), 
LMax44351 = maximum_layer([Res22759,Zer64205], Max44351), 
exec_layers([LMul85491,LDen189,LRes22759,LAdd50616,LZer64205,LMax44351],["Mul85491","Den189","Res22759","Add50616","Zer64205","Max44351"],Max44351,"Max44351")

Actual (Unparsed): [[[0.6823992], [0.7070000]]]

Expected (Unparsed): [[[0.682399228],[0.7070000000000001]]]

Actual:   [[[0.6824], [0.707]]]

Expected: [[[0.6824], [0.7071]]]