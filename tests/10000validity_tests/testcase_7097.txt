import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST14487 = tf.keras.layers.Input(shape=([3, 3]))

LST14487 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST14487', )(in0LST14487)
Res28153 = keras.layers.Reshape((1, 1), name = 'Res28153', )(LST14487)
Res21444 = keras.layers.Reshape((1, 1, 1), name = 'Res21444', )(Res28153)
Sep6017 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='same', name = 'Sep6017', )(Res21444)
model = tf.keras.models.Model(inputs=[in0LST14487], outputs=Sep6017)
w = model.get_layer('LST14487').get_weights() 
w[0] = np.array([[1, 1, 7, 5], [10, 3, 5, 9], [4, 6, 9, 5]])
w[1] = np.array([[5, 10, 10, 6]])
w[2] = np.array([8, 3, 4, 9])
model.get_layer('LST14487').set_weights(w) 
w = model.get_layer('Sep6017').get_weights() 
w[0] = np.array([[[[0.133]]]])
w[1] = np.array([[[[0.5184, 0.8347, 0.5729, 0.5153]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep6017').set_weights(w) 
in0LST14487 = tf.constant([[[6, 1, 5], [10, 6, 6], [1, 9, 10]]])
print (np.array2string(model.predict([in0LST14487],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep6017.png')

LLST14487 = lstm_layer([[[6, 1, 5], [10, 6, 6], [1, 9, 10]]],[[1, 1, 7, 5], [10, 3, 5, 9], [4, 6, 9, 5]],[[5, 10, 10, 6]],[8, 3, 4, 9], LST14487), 
LRes28153 = reshape_layer(LST14487, [1, 1], Res28153), 
LRes21444 = reshape_layer(Res28153, [1, 1, 1], Res21444), 
LSep6017 = separable_conv2D_layer(Res21444, 1, 1,[[[[[0.133]]]],[[[[0.5184, 0.8347, 0.5729, 0.5153]]]]],[0, 0, 0, 0], 1, 1, true, Sep6017), 
exec_layers([LLST14487,LRes28153,LRes21444,LSep6017],["LST14487","Res28153","Res21444","Sep6017"],Sep6017,"Sep6017")

Actual (Unparsed): [[[[0.0686062, 0.1104661, 0.0758189, 0.0681960]]]]

Expected (Unparsed): [[[[0.06860623911338974,0.11046610298600774,0.075818893495488,0.0681959780384447]]]]

Actual:   [[[[0.0687, 0.1105, 0.0759, 0.0682]]]]

Expected: [[[[0.0687, 0.1105, 0.0759, 0.0682]]]]