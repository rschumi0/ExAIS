import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max81902 = tf.keras.layers.Input(shape=([2, 2]))
in1Max81902 = tf.keras.layers.Input(shape=([2, 2]))

Max81902 = keras.layers.Maximum(name = 'Max81902', )([in0Max81902,in1Max81902])
Bat37298 = keras.layers.BatchNormalization(axis=1, epsilon=0.6528467436045059,  name = 'Bat37298', )(Max81902)
model = tf.keras.models.Model(inputs=[in0Max81902,in1Max81902], outputs=Bat37298)
w = model.get_layer('Bat37298').get_weights() 
w[0] = np.array([0.3858, 0.9619])
w[1] = np.array([0.8288, 0.3242])
w[2] = np.array([0.5181, 0.5384])
w[3] = np.array([0.935, 0.4321])
model.get_layer('Bat37298').set_weights(w) 
in0Max81902 = tf.constant([[[0.0916, 0.2793], [0.0708, 0.9221]]])
in1Max81902 = tf.constant([[[0.3517, 0.4034], [0.3538, 0.7468]]])
print (np.array2string(model.predict([in0Max81902,in1Max81902],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat37298.png')

LMax81902 = maximum_layer([[[[0.0916, 0.2793], [0.0708, 0.9221]]], [[[0.3517, 0.4034], [0.3538, 0.7468]]]], Max81902), 
LBat37298 = batch_normalization_layer(Max81902, 1, 0.6528467436045059, [0.3858, 0.9619], [0.8288, 0.3242], [0.5181, 0.5384], [0.935, 0.4321], Bat37298), 
exec_layers([LMax81902,LBat37298],["Max81902","Bat37298"],Bat37298,"Bat37298")

Actual (Unparsed): [[[0.7778539, 0.7936827], [0.1537263, 0.6785378]]]

Expected (Unparsed): [[[0.7778538636132956,0.7936826812286358],[0.15372629065071342,0.6785378238208086]]]

Actual:   [[[0.7779, 0.7937], [0.1538, 0.6786]]]

Expected: [[[0.7779, 0.7937], [0.1538, 0.6786]]]