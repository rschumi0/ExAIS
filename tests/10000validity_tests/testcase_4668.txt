import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave95302 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave95302 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Sub40813 = tf.keras.layers.Input(shape=([3]))
in1Sub40813 = tf.keras.layers.Input(shape=([3]))
in0Con30768 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul95616 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Mul95616 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Dot85681 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot85681 = tf.keras.layers.Input(shape=([2, 2]))

Ave95302 = keras.layers.Average(name = 'Ave95302', )([in0Ave95302,in1Ave95302])
Res68042 = keras.layers.Reshape((1, 1), name = 'Res68042', )(Ave95302)
Fla54512 = keras.layers.Flatten(name = 'Fla54512', )(Res68042)
Sub40813 = keras.layers.Subtract(name = 'Sub40813', )([in0Sub40813,in1Sub40813])
Res30813 = keras.layers.Reshape((3, 1), name = 'Res30813', )(Sub40813)
Res82328 = keras.layers.Reshape((3, 1, 1), name = 'Res82328', )(Res30813)
Res94521 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res94521', )(Res82328)
Glo96116 = keras.layers.GlobalAveragePooling3D(name = 'Glo96116', )(Res94521)
Ave45751 = keras.layers.Average(name = 'Ave45751', )([Fla54512,Glo96116])
Res45444 = keras.layers.Reshape((1, 1), name = 'Res45444', )(Ave45751)
Zer94574 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer94574', )(Res45444)
Con30768 = keras.layers.Concatenate(axis=2, name = 'Con30768', )([Zer94574,in0Con30768])
Mul95616 = keras.layers.Multiply(name = 'Mul95616', )([in0Mul95616,in1Mul95616])
Res63250 = keras.layers.Reshape((1, 1, 2), name = 'Res63250', )(Mul95616)
Res48585 = keras.layers.Reshape((1, 2), name = 'Res48585', )(Res63250)
Zer99056 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer99056', )(Res48585)
Dot85681 = keras.layers.Dot(axes=(2, 2), name = 'Dot85681', )([in0Dot85681,in1Dot85681])
Per80897 = keras.layers.Permute((1,2), name = 'Per80897',)(Dot85681)
Max29834 = keras.layers.Maximum(name = 'Max29834', )([Zer99056,Per80897])
Add90038 = keras.layers.Add(name = 'Add90038', )([Con30768,Max29834])
Up_28540 = keras.layers.UpSampling1D(size=(2), name = 'Up_28540', )(Add90038)
model = tf.keras.models.Model(inputs=[in0Ave95302,in1Ave95302,in0Sub40813,in1Sub40813,in0Con30768,in0Mul95616,in1Mul95616,in0Dot85681,in1Dot85681], outputs=Up_28540)
in0Ave95302 = tf.constant([[[[0.1536]]]])
in1Ave95302 = tf.constant([[[[0.6496]]]])
in0Sub40813 = tf.constant([[0.1474, 0.9254, 0.0641]])
in1Sub40813 = tf.constant([[0.5082, 0.9934, 0.5398]])
in0Con30768 = tf.constant([[[0.0268], [0.4818]]])
in0Mul95616 = tf.constant([[[[[0.0689], [0.0202]]]]])
in1Mul95616 = tf.constant([[[[[0.7016], [0.7461]]]]])
in0Dot85681 = tf.constant([[[0.5757, 0.7581], [0.5758, 0.1064]]])
in1Dot85681 = tf.constant([[[0.2921, 0.1834], [0.1418, 0.8416]]])
print (np.array2string(model.predict([in0Ave95302,in1Ave95302,in0Sub40813,in1Sub40813,in0Con30768,in0Mul95616,in1Mul95616,in0Dot85681,in1Dot85681],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_28540.png')

LAve95302 = average_layer([[[[[0.1536]]]], [[[[0.6496]]]]], Ave95302), 
LRes68042 = reshape_layer(Ave95302, [1, 1], Res68042), 
LFla54512 = flatten_layer(Res68042, Fla54512), 
LSub40813 = subtract_layer([[0.1474, 0.9254, 0.0641]], [[0.5082, 0.9934, 0.5398]], Sub40813), 
LRes30813 = reshape_layer(Sub40813, [3, 1], Res30813), 
LRes82328 = reshape_layer(Res30813, [3, 1, 1], Res82328), 
LRes94521 = reshape_layer(Res82328, [3, 1, 1, 1], Res94521), 
LGlo96116 = global_average_pooling3D_layer(Res94521, Glo96116), 
LAve45751 = average_layer([Fla54512,Glo96116], Ave45751), 
LRes45444 = reshape_layer(Ave45751, [1, 1], Res45444), 
LZer94574 = zero_padding1D_layer(Res45444, 1, 0, Zer94574), 
LCon30768 = concatenate_layer([Zer94574,[[[0.0268], [0.4818]]]], 2, Con30768), 
LMul95616 = multiply_layer([[[[[[0.0689], [0.0202]]]]], [[[[[0.7016], [0.7461]]]]]], Mul95616), 
LRes63250 = reshape_layer(Mul95616, [1, 1, 2], Res63250), 
LRes48585 = reshape_layer(Res63250, [1, 2], Res48585), 
LZer99056 = zero_padding1D_layer(Res48585, 1, 0, Zer99056), 
LDot85681 = dot_layer([[[0.5757, 0.7581], [0.5758, 0.1064]]], [[[0.2921, 0.1834], [0.1418, 0.8416]]], 2, 2, Dot85681), 
LPer80897 = permute_layer(Dot85681, 1,2, Per80897), 
LMax29834 = maximum_layer([Zer99056,Per80897], Max29834), 
LAdd90038 = add_layer([Con30768,Max29834], Add90038), 
LUp_28540 = up_sampling1D_layer(Add90038, 2, Up_28540), 
exec_layers([LAve95302,LRes68042,LFla54512,LSub40813,LRes30813,LRes82328,LRes94521,LGlo96116,LAve45751,LRes45444,LZer94574,LCon30768,LMul95616,LRes63250,LRes48585,LZer99056,LDot85681,LPer80897,LMax29834,LAdd90038,LUp_28540],["Ave95302","Res68042","Fla54512","Sub40813","Res30813","Res82328","Res94521","Glo96116","Ave45751","Res45444","Zer94574","Con30768","Mul95616","Res63250","Res48585","Zer99056","Dot85681","Per80897","Max29834","Add90038","Up_28540"],Up_28540,"Up_28540")

Actual (Unparsed): [[[0.3071975, 0.7464512], [0.3071975, 0.7464512], [0.2377550, 0.6529947], [0.2377550, 0.6529947]]]

Expected (Unparsed): [[[0.30719751000000006,0.74645122],[0.30719751000000006,0.74645122],[0.23775494,0.6529946799999999],[0.23775494,0.6529946799999999]]]

Actual:   [[[0.3072, 0.7465], [0.3072, 0.7465], [0.2378, 0.653], [0.2378, 0.653]]]

Expected: [[[0.3072, 0.7465], [0.3072, 0.7465], [0.2378, 0.653], [0.2378, 0.653]]]