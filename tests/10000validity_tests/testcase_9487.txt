import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub94192 = tf.keras.layers.Input(shape=([2]))
in1Sub94192 = tf.keras.layers.Input(shape=([2]))
in0Add52359 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add52359 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con15353 = tf.keras.layers.Input(shape=([1]))
in0Den8186 = tf.keras.layers.Input(shape=([2, 4]))
in0Add82906 = tf.keras.layers.Input(shape=([2, 1]))
in1Add82906 = tf.keras.layers.Input(shape=([2, 1]))

Sub94192 = keras.layers.Subtract(name = 'Sub94192', )([in0Sub94192,in1Sub94192])
Add52359 = keras.layers.Add(name = 'Add52359', )([in0Add52359,in1Add52359])
Res54924 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res54924', )(Add52359)
Glo34746 = keras.layers.GlobalAveragePooling3D(name = 'Glo34746', )(Res54924)
Con15353 = keras.layers.Concatenate(axis=1, name = 'Con15353', )([Glo34746,in0Con15353])
Min71228 = keras.layers.Minimum(name = 'Min71228', )([Sub94192,Con15353])
Res22559 = keras.layers.Reshape((2, 1), name = 'Res22559', )(Min71228)
Den8186 = keras.layers.Dense(2,name = 'Den8186', )(in0Den8186)
Res17101 = keras.layers.Reshape((2, 2, 1), name = 'Res17101', )(Den8186)
Res16407 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res16407', )(Res17101)
Glo26860 = keras.layers.GlobalAveragePooling3D(name = 'Glo26860', )(Res16407)
Res93490 = keras.layers.Reshape((1, 1), name = 'Res93490', )(Glo26860)
Zer33253 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer33253', )(Res93490)
Add82906 = keras.layers.Add(name = 'Add82906', )([in0Add82906,in1Add82906])
Mul63855 = keras.layers.Multiply(name = 'Mul63855', )([Zer33253,Add82906])
ReL46402 = keras.layers.ReLU(max_value=8.837457866834217, negative_slope=7.508120748336841, threshold=8.03584518323933, name = 'ReL46402', )(Mul63855)
Add20770 = keras.layers.Add(name = 'Add20770', )([Res22559,ReL46402])
Cro7254 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro7254', )(Add20770)
model = tf.keras.models.Model(inputs=[in0Sub94192,in1Sub94192,in0Add52359,in1Add52359,in0Con15353,in0Den8186,in0Add82906,in1Add82906], outputs=Cro7254)
w = model.get_layer('Den8186').get_weights() 
w[0] = np.array([[0.3879, 0.12], [0.3131, 0.6263], [0.6457, 0.5955], [0.5729, 0.8048]])
w[1] = np.array([0.888, 0.025])
model.get_layer('Den8186').set_weights(w) 
in0Sub94192 = tf.constant([[0.4046, 0.7985]])
in1Sub94192 = tf.constant([[0.4705, 0.3233]])
in0Add52359 = tf.constant([[[[0.4323]], [[0.3479]]]])
in1Add52359 = tf.constant([[[[0.5166]], [[0.8897]]]])
in0Con15353 = tf.constant([[0.9318]])
in0Den8186 = tf.constant([[[0.6281, 0.6351, 0.4223, 0.8868], [0.8609, 0.5991, 0.3973, 0.6311]]])
in0Add82906 = tf.constant([[[0.5709], [0.7801]]])
in1Add82906 = tf.constant([[[0.9107], [0.3034]]])
print (np.array2string(model.predict([in0Sub94192,in1Sub94192,in0Add52359,in1Add52359,in0Con15353,in0Den8186,in0Add82906,in1Add82906],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro7254.png')

LSub94192 = subtract_layer([[0.4046, 0.7985]], [[0.4705, 0.3233]], Sub94192), 
LAdd52359 = add_layer([[[[[0.4323]], [[0.3479]]]], [[[[0.5166]], [[0.8897]]]]], Add52359), 
LRes54924 = reshape_layer(Add52359, [2, 1, 1, 1], Res54924), 
LGlo34746 = global_average_pooling3D_layer(Res54924, Glo34746), 
LCon15353 = concatenate_layer([Glo34746,[[0.9318]]], 1, Con15353), 
LMin71228 = minimum_layer([Sub94192,Con15353], Min71228), 
LRes22559 = reshape_layer(Min71228, [2, 1], Res22559), 
LDen8186 = dense_layer([[[0.6281, 0.6351, 0.4223, 0.8868], [0.8609, 0.5991, 0.3973, 0.6311]]], [[0.3879, 0.12], [0.3131, 0.6263], [0.6457, 0.5955], [0.5729, 0.8048]],[0.888, 0.025], Den8186), 
LRes17101 = reshape_layer(Den8186, [2, 2, 1], Res17101), 
LRes16407 = reshape_layer(Res17101, [2, 2, 1, 1], Res16407), 
LGlo26860 = global_average_pooling3D_layer(Res16407, Glo26860), 
LRes93490 = reshape_layer(Glo26860, [1, 1], Res93490), 
LZer33253 = zero_padding1D_layer(Res93490, 1, 0, Zer33253), 
LAdd82906 = add_layer([[[[0.5709], [0.7801]]], [[[0.9107], [0.3034]]]], Add82906), 
LMul63855 = multiply_layer([Zer33253,Add82906], Mul63855), 
LReL46402 = relu_layer(Mul63855, 8.837457866834217, 7.508120748336841, 8.03584518323933, ReL46402), 
LAdd20770 = add_layer([Res22559,ReL46402], Add20770), 
LCro7254 = cropping1D_layer(Add20770, 1, 0, Cro7254), 
exec_layers([LSub94192,LAdd52359,LRes54924,LGlo34746,LCon15353,LMin71228,LRes22559,LDen8186,LRes17101,LRes16407,LGlo26860,LRes93490,LZer33253,LAdd82906,LMul63855,LReL46402,LAdd20770,LCro7254],["Sub94192","Add52359","Res54924","Glo34746","Con15353","Min71228","Res22559","Den8186","Res17101","Res16407","Glo26860","Res93490","Zer33253","Add82906","Mul63855","ReL46402","Add20770","Cro7254"],Cro7254,"Cro7254")

Actual (Unparsed): [[[-45.9272813]]]

Expected (Unparsed): [[[-45.9272812644678]]]

Actual:   [[[-45.9272]]]

Expected: [[[-45.9272]]]