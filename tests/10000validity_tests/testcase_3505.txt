import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul57047 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Mul57047 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con79402 = tf.keras.layers.Input(shape=([2, 3, 6, 2]))
in0Ave9979 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Ave9979 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Con38470 = tf.keras.layers.Input(shape=([2, 3, 6, 2]))
in0Up_19707 = tf.keras.layers.Input(shape=([2, 3, 3, 3]))

Mul57047 = keras.layers.Multiply(name = 'Mul57047', )([in0Mul57047,in1Mul57047])
Zer57083 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (5, 0)), name = 'Zer57083', )(Mul57047)
Con79402 = keras.layers.Concatenate(axis=4, name = 'Con79402', )([Zer57083,in0Con79402])
Ave9979 = keras.layers.Average(name = 'Ave9979', )([in0Ave9979,in1Ave9979])
Res62583 = keras.layers.Reshape((1, 2, 4), name = 'Res62583', )(Ave9979)
Sep15053 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='valid', name = 'Sep15053', )(Res62583)
Res3907 = keras.layers.Reshape((1, 2, 3, 1), name = 'Res3907', )(Sep15053)
Zer82775 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (3, 0)), name = 'Zer82775', )(Res3907)
Con38470 = keras.layers.Concatenate(axis=4, name = 'Con38470', )([Zer82775,in0Con38470])
Up_19707 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_19707', )(in0Up_19707)
Add5982 = keras.layers.Add(name = 'Add5982', )([Con38470,Up_19707])
Sub57491 = keras.layers.Subtract(name = 'Sub57491', )([Con79402,Add5982])
ReL70053 = keras.layers.ReLU(max_value=5.397511708684146, negative_slope=9.74821199695367, threshold=2.4096068545408675, name = 'ReL70053', )(Sub57491)
model = tf.keras.models.Model(inputs=[in0Mul57047,in1Mul57047,in0Con79402,in0Ave9979,in1Ave9979,in0Con38470,in0Up_19707], outputs=ReL70053)
w = model.get_layer('Sep15053').get_weights() 
w[0] = np.array([[[[0.4546], [0.7056], [0.1886], [0.6212]]]])
w[1] = np.array([[[[0.0115, 0.8883, 0.9041], [0.0404, 0.0142, 0.5399], [0.1286, 0.4033, 0.343], [0.1294, 0.4304, 0.5254]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep15053').set_weights(w) 
in0Mul57047 = tf.constant([[[[[0.878]], [[0.7018]]]]])
in1Mul57047 = tf.constant([[[[[0.6813]], [[0.9019]]]]])
in0Con79402 = tf.constant([[[[[0.1035, 0.1433], [0.3822, 0.3661], [0.0782, 0.09], [0.9169, 0.3273], [0.4411, 0.2486], [0.2355, 0.1421]], [[0.4595, 0.6896], [0.2578, 0.185], [0.9269, 0.1097], [0.6461, 0.9268], [0.9397, 0.1005], [0.9207, 0.691]], [[0.4789, 0.6144], [0.4337, 0.95], [0.8701, 0.8731], [0.3522, 0.7069], [0.9509, 0.7317], [0.3837, 0.2269]]], [[[0.4352, 0.4258], [0.9666, 0.7521], [0.5307, 0.7065], [0.0434, 0.8639], [0.3419, 0.6006], [0.3367, 0.8404]], [[0.9667, 0.4173], [0.2564, 0.697], [0.4861, 0.1723], [0.1787, 0.597], [0.2339, 0.2931], [0.8615, 0.9701]], [[0.8352, 0.3335], [0.1837, 0.9878], [0.5056, 0.4325], [0.232, 0.0105], [0.0157, 0.4227], [0.9963, 0.2423]]]]])
in0Ave9979 = tf.constant([[[[[0.0084, 0.723], [0.1356, 0.0743]], [[0.6153, 0.7415], [0.5667, 0.1569]]]]])
in1Ave9979 = tf.constant([[[[[0.4572, 0.4611], [0.718, 0.7618]], [[0.6118, 0.847], [0.6857, 0.876]]]]])
in0Con38470 = tf.constant([[[[[0.5715, 0.9689], [0.7978, 0.3243], [0.9282, 0.2274], [0.5113, 0.0348], [0.5735, 0.3511], [0.7439, 0.7312]], [[0.4194, 0.9672], [0.1745, 0.8505], [0.0888, 0.569], [0.8685, 0.4246], [0.3078, 0.9819], [0.6851, 0.0958]], [[0.4852, 0.0616], [0.4685, 0.7904], [0.5884, 0.9143], [0.8269, 0.8561], [0.3576, 0.5556], [0.946, 0.9205]]], [[[0.4933, 0.463], [0.6735, 0.5984], [0.698, 0.9205], [0.0626, 0.4413], [0.3555, 0.3977], [0.6694, 0.2025]], [[0.1933, 0.4674], [0.1625, 0.5724], [0.4859, 0.9201], [0.219, 0.029], [0.2327, 0.8063], [0.2596, 0.3422]], [[0.2692, 0.1083], [0.3062, 0.576], [0.4569, 0.6241], [0.1308, 0.1354], [0.9371, 0.4321], [0.9119, 0.5246]]]]])
in0Up_19707 = tf.constant([[[[[1.2456, 1.0358, 1.1264], [1.4308, 1.5924, 1.7581], [1.1994, 1.6325, 1.5175]], [[1.8631, 1.6338, 1.9714], [1.6065, 1.789, 1.5701], [1.9064, 1.9318, 1.9843]], [[1.2476, 1.7144, 1.5222], [1.353, 1.1814, 1.8886], [1.0893, 1.7706, 1.2066]]], [[[1.7699, 1.7504, 1.595], [1.6538, 1.8056, 1.3244], [1.8875, 1.9638, 1.9433]], [[1.2806, 1.7462, 1.2504], [1.1883, 1.5671, 1.756], [1.6757, 1.278, 1.3594]], [[1.0641, 1.0162, 1.764], [1.2342, 1.9991, 1.4657], [1.5263, 1.3948, 1.4713]]]]])
print (np.array2string(model.predict([in0Mul57047,in1Mul57047,in0Con79402,in0Ave9979,in1Ave9979,in0Con38470,in0Up_19707],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL70053.png')

LMul57047 = multiply_layer([[[[[[0.878]], [[0.7018]]]]], [[[[[0.6813]], [[0.9019]]]]]], Mul57047), 
LZer57083 = zero_padding3D_layer(Mul57047, 1, 0, 1, 0, 5, 0, Zer57083), 
LCon79402 = concatenate_layer([Zer57083,[[[[[0.1035, 0.1433], [0.3822, 0.3661], [0.0782, 0.09], [0.9169, 0.3273], [0.4411, 0.2486], [0.2355, 0.1421]], [[0.4595, 0.6896], [0.2578, 0.185], [0.9269, 0.1097], [0.6461, 0.9268], [0.9397, 0.1005], [0.9207, 0.691]], [[0.4789, 0.6144], [0.4337, 0.95], [0.8701, 0.8731], [0.3522, 0.7069], [0.9509, 0.7317], [0.3837, 0.2269]]], [[[0.4352, 0.4258], [0.9666, 0.7521], [0.5307, 0.7065], [0.0434, 0.8639], [0.3419, 0.6006], [0.3367, 0.8404]], [[0.9667, 0.4173], [0.2564, 0.697], [0.4861, 0.1723], [0.1787, 0.597], [0.2339, 0.2931], [0.8615, 0.9701]], [[0.8352, 0.3335], [0.1837, 0.9878], [0.5056, 0.4325], [0.232, 0.0105], [0.0157, 0.4227], [0.9963, 0.2423]]]]]], 4, Con79402), 
LAve9979 = average_layer([[[[[[0.0084, 0.723], [0.1356, 0.0743]], [[0.6153, 0.7415], [0.5667, 0.1569]]]]], [[[[[0.4572, 0.4611], [0.718, 0.7618]], [[0.6118, 0.847], [0.6857, 0.876]]]]]], Ave9979), 
LRes62583 = reshape_layer(Ave9979, [1, 2, 4], Res62583), 
LSep15053 = separable_conv2D_layer(Res62583, 1, 1,[[[[[0.4546], [0.7056], [0.1886], [0.6212]]]],[[[[0.0115, 0.8883, 0.9041], [0.0404, 0.0142, 0.5399], [0.1286, 0.4033, 0.343], [0.1294, 0.4304, 0.5254]]]]],[0, 0, 0], 1, 1, false, Sep15053), 
LRes3907 = reshape_layer(Sep15053, [1, 2, 3, 1], Res3907), 
LZer82775 = zero_padding3D_layer(Res3907, 1, 0, 1, 0, 3, 0, Zer82775), 
LCon38470 = concatenate_layer([Zer82775,[[[[[0.5715, 0.9689], [0.7978, 0.3243], [0.9282, 0.2274], [0.5113, 0.0348], [0.5735, 0.3511], [0.7439, 0.7312]], [[0.4194, 0.9672], [0.1745, 0.8505], [0.0888, 0.569], [0.8685, 0.4246], [0.3078, 0.9819], [0.6851, 0.0958]], [[0.4852, 0.0616], [0.4685, 0.7904], [0.5884, 0.9143], [0.8269, 0.8561], [0.3576, 0.5556], [0.946, 0.9205]]], [[[0.4933, 0.463], [0.6735, 0.5984], [0.698, 0.9205], [0.0626, 0.4413], [0.3555, 0.3977], [0.6694, 0.2025]], [[0.1933, 0.4674], [0.1625, 0.5724], [0.4859, 0.9201], [0.219, 0.029], [0.2327, 0.8063], [0.2596, 0.3422]], [[0.2692, 0.1083], [0.3062, 0.576], [0.4569, 0.6241], [0.1308, 0.1354], [0.9371, 0.4321], [0.9119, 0.5246]]]]]], 4, Con38470), 
LUp_19707 = up_sampling3D_layer([[[[[1.2456, 1.0358, 1.1264], [1.4308, 1.5924, 1.7581], [1.1994, 1.6325, 1.5175]], [[1.8631, 1.6338, 1.9714], [1.6065, 1.789, 1.5701], [1.9064, 1.9318, 1.9843]], [[1.2476, 1.7144, 1.5222], [1.353, 1.1814, 1.8886], [1.0893, 1.7706, 1.2066]]], [[[1.7699, 1.7504, 1.595], [1.6538, 1.8056, 1.3244], [1.8875, 1.9638, 1.9433]], [[1.2806, 1.7462, 1.2504], [1.1883, 1.5671, 1.756], [1.6757, 1.278, 1.3594]], [[1.0641, 1.0162, 1.764], [1.2342, 1.9991, 1.4657], [1.5263, 1.3948, 1.4713]]]]], 1, 1, 2, Up_19707), 
LAdd5982 = add_layer([Con38470,Up_19707], Add5982), 
LSub57491 = subtract_layer(Con79402,Add5982, Sub57491), 
LReL70053 = relu_layer(Sub57491, 5.397511708684146, 9.74821199695367, 2.4096068545408675, ReL70053), 
exec_layers([LMul57047,LZer57083,LCon79402,LAve9979,LRes62583,LSep15053,LRes3907,LZer82775,LCon38470,LUp_19707,LAdd5982,LSub57491,LReL70053],["Mul57047","Zer57083","Con79402","Ave9979","Res62583","Sep15053","Res3907","Zer82775","Con38470","Up_19707","Add5982","Sub57491","ReL70053"],ReL70053,"ReL70053")

Actual (Unparsed): [[[[[-35.6317312, -38.1487195, -42.5178685], [-35.6317312, -37.6379132, -34.0622689], [-37.4370998, -47.2983911, -41.9670946], [-37.4370998, -35.0585365, -37.7763382], [-35.1813634, -40.6939781, -39.2814622], [-35.1813634, -44.3593061, -44.0249420]], [[-41.6512527, -39.0250841, -45.4130874], [-41.6512527, -38.6039613, -49.1944187], [-39.1498613, -32.7589333, -43.2723794], [-39.1498613, -43.0969125, -33.8994735], [-42.0733495, -36.1610592, -51.4248095], [-42.0733495, -40.0242758, -37.0306000]], [[-35.6512273, -40.2631074, -32.9392748], [-35.6512273, -40.5409313, -36.7722724], [-36.6786897, -32.2598241, -42.3014583], [-36.6786897, -39.6333718, -43.3542650], [-34.1080861, -34.9659279, -33.5348903], [-34.1080861, -46.2309615, -42.0129102]]], [[[-40.7427185, -41.1189992, -39.4003904], [-40.7427185, -37.6954273, -37.5394567], [-39.6109516, -42.7216062, -38.4860071], [-39.6109516, -41.2778962, -32.2802955], [-41.8891091, -42.7654726, -40.4551468], [-41.8891091, -45.8761267, -36.2146747]], [[-35.9729183, -32.9724185, -36.1669079], [-35.9729183, -39.5963288, -34.4638945], [-35.0731589, -38.7638326, -47.8969318], [-35.6780354, -39.1586348, -35.0702347], [-42.2047237, -35.9358756, -41.7438604], [-38.7238238, -30.0801244, -30.6201761]], [[-33.8624311, -27.8780028, -38.4899077], [-33.8624311, -34.5896469, -36.6708910], [-35.5206017, -42.5022711, -39.6450707], [-36.3253208, -41.9904897, -38.9948647], [-42.6712378, -46.0681665, -37.9235361], [-39.6436778, -36.2634150, -40.5838233]]]]]

Expected (Unparsed): [[[[[-35.63173131078257,-38.14871964839601,-42.517868265430636],[-35.63173131078257,-37.637913339755634,-34.06226917927303],[-37.437100172618386,-47.29839142873672,-41.96709428760276],[-37.437100172618386,-35.058536445361696,-37.77633795011238],[-35.18136391652331,-40.69397780080061,-39.281461882442024],[-35.18136391652331,-44.359305511655194,-44.02494184015968]],[[-41.65125221890146,-39.02508390692214,-45.41308722852588],[-41.65125221890146,-38.603961148653745,-49.194418662144216],[-39.14986102048315,-32.758933235280324,-43.27237987399485],[-39.14986102048315,-43.09691205804968,-33.8994740389239],[-42.073349798369556,-36.16105922221715,-51.424809567047205],[-42.073349798369556,-40.02427563660989,-37.03059973234542]],[[-35.65122773477648,-40.26310683053526,-32.93927515722397],[-35.65122773477648,-40.54093087244844,-36.772272114426144],[-36.678689279255394,-32.25982478103629,-42.30145795909827],[-36.678689279255394,-39.63337233553205,-43.35426485476927],[-34.10808577565871,-34.96592843139064,-33.534890910237834],[-34.10808577565871,-46.23096221507029,-42.01291088398844]]],[[[-40.742718860785374,-41.11899984386779,-39.40039006880485],[-40.742718860785374,-37.69542779053766,-37.5394563985864],[-39.61095144793906,-42.72160589616698,-38.4860077834906],[-39.61095144793906,-41.27789569941814,-32.2802960262299],[-41.88910859162713,-42.765472850153266,-40.455146606875246],[-41.88910859162713,-45.87612729838118,-36.21467438820039]],[[-35.97291873067595,-32.97241907801361,-36.16690814941533],[-35.97291873067595,-39.596329129943626,-34.46389551354752],[-35.07315876335712,-38.763831825403784,-47.896931645349675],[-35.67803526750632,-39.1586344112804,-35.07023429975804],[-42.20472423049786,-35.935875525087525,-41.74386023287252],[-38.72382431492291,-30.080124578517456,-30.62017552314869]],[[-33.86243083333548,-27.87800348840562,-38.489907068289384],[-33.86243083333548,-34.58964744830822,-36.670890709657826],[-35.520601694017294,-42.50227112623551,-39.64507018992839],[-36.32532082385181,-41.99048999639545,-38.99486444973159],[-42.67123821834386,-46.068167074721174,-37.92353595126637],[-39.64367801637412,-36.26341544818517,-40.58382300523503]]]]]

Actual:   [[[[[-35.6317, -38.1487, -42.5178], [-35.6317, -37.6379, -34.0622], [-37.437, -47.2983, -41.967], [-37.437, -35.0585, -37.7763], [-35.1813, -40.6939, -39.2814], [-35.1813, -44.3593, -44.0249]], [[-41.6512, -39.025, -45.413], [-41.6512, -38.6039, -49.1944], [-39.1498, -32.7589, -43.2723], [-39.1498, -43.0969, -33.8994], [-42.0733, -36.161, -51.4248], [-42.0733, -40.0242, -37.0306]], [[-35.6512, -40.2631, -32.9392], [-35.6512, -40.5409, -36.7722], [-36.6786, -32.2598, -42.3014], [-36.6786, -39.6333, -43.3542], [-34.108, -34.9659, -33.5348], [-34.108, -46.2309, -42.0129]]], [[[-40.7427, -41.1189, -39.4003], [-40.7427, -37.6954, -37.5394], [-39.6109, -42.7216, -38.486], [-39.6109, -41.2778, -32.2802], [-41.8891, -42.7654, -40.4551], [-41.8891, -45.8761, -36.2146]], [[-35.9729, -32.9724, -36.1669], [-35.9729, -39.5963, -34.4638], [-35.0731, -38.7638, -47.8969], [-35.678, -39.1586, -35.0702], [-42.2047, -35.9358, -41.7438], [-38.7238, -30.0801, -30.6201]], [[-33.8624, -27.878, -38.4899], [-33.8624, -34.5896, -36.6708], [-35.5206, -42.5022, -39.645], [-36.3253, -41.9904, -38.9948], [-42.6712, -46.0681, -37.9235], [-39.6436, -36.2634, -40.5838]]]]]

Expected: [[[[[-35.6317, -38.1487, -42.5178], [-35.6317, -37.6379, -34.0622], [-37.4371, -47.2983, -41.967], [-37.4371, -35.0585, -37.7763], [-35.1813, -40.6939, -39.2814], [-35.1813, -44.3593, -44.0249]], [[-41.6512, -39.025, -45.413], [-41.6512, -38.6039, -49.1944], [-39.1498, -32.7589, -43.2723], [-39.1498, -43.0969, -33.8994], [-42.0733, -36.161, -51.4248], [-42.0733, -40.0242, -37.0305]], [[-35.6512, -40.2631, -32.9392], [-35.6512, -40.5409, -36.7722], [-36.6786, -32.2598, -42.3014], [-36.6786, -39.6333, -43.3542], [-34.108, -34.9659, -33.5348], [-34.108, -46.2309, -42.0129]]], [[[-40.7427, -41.1189, -39.4003], [-40.7427, -37.6954, -37.5394], [-39.6109, -42.7216, -38.486], [-39.6109, -41.2778, -32.2802], [-41.8891, -42.7654, -40.4551], [-41.8891, -45.8761, -36.2146]], [[-35.9729, -32.9724, -36.1669], [-35.9729, -39.5963, -34.4638], [-35.0731, -38.7638, -47.8969], [-35.678, -39.1586, -35.0702], [-42.2047, -35.9358, -41.7438], [-38.7238, -30.0801, -30.6201]], [[-33.8624, -27.878, -38.4899], [-33.8624, -34.5896, -36.6708], [-35.5206, -42.5022, -39.645], [-36.3253, -41.9904, -38.9948], [-42.6712, -46.0681, -37.9235], [-39.6436, -36.2634, -40.5838]]]]]