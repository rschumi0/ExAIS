import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc63130 = tf.keras.layers.Input(shape=([2, 1, 2]))

Loc63130 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 1), name = 'Loc63130', )(in0Loc63130)
Dep89614 = keras.layers.DepthwiseConv2D((1, 2),strides=(1, 1), padding='same', name = 'Dep89614', )(Loc63130)
Den20790 = keras.layers.Dense(4,name = 'Den20790', )(Dep89614)
model = tf.keras.models.Model(inputs=[in0Loc63130], outputs=Den20790)
w = model.get_layer('Loc63130').get_weights() 
w[0] = np.array([[[0.8638, 0.2503], [0.4263, 0.4222]], [[0.9112, 0.4579], [0.5669, 0.0849]]])
w[1] = np.array([[[0, 0]], [[0, 0]]])
model.get_layer('Loc63130').set_weights(w) 
w = model.get_layer('Dep89614').get_weights() 
w[0] = np.array([[[[0.4915], [0.6802]], [[0.7551], [0.2284]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep89614').set_weights(w) 
w = model.get_layer('Den20790').get_weights() 
w[0] = np.array([[0.5476, 0.3525, 0.2345, 0.1357], [0.3098, 0.9853, 0.4923, 0.6827]])
w[1] = np.array([0.349, 0.1252, 0.3411, 0.4093])
model.get_layer('Den20790').set_weights(w) 
in0Loc63130 = tf.constant([[[[0.6371, 0.1289]], [[0.6708, 0.6657]]]])
print (np.array2string(model.predict([in0Loc63130],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den20790.png')

LLoc63130 = locally_connected2D_layer([[[[0.6371, 0.1289]], [[0.6708, 0.6657]]]], 1, 1,[[[0.8638, 0.2503], [0.4263, 0.4222]], [[0.9112, 0.4579], [0.5669, 0.0849]]],[[[0, 0]], [[0, 0]]], 1, 1, Loc63130), 
LDep89614 = depthwise_conv2D_layer(Loc63130, 1, 2,[[[[0.4915], [0.6802]], [[0.7551], [0.2284]]]],[0, 0], 1, 1, true, Dep89614), 
LDen20790 = dense_layer(Dep89614, [[0.5476, 0.3525, 0.2345, 0.1357], [0.3098, 0.9853, 0.4923, 0.6827]],[0.349, 0.1252, 0.3411, 0.4093], Den20790), 
exec_layers([LLoc63130,LDep89614,LDen20790],["Loc63130","Dep89614","Den20790"],Den20790,"Den20790")

Actual (Unparsed): [[[[0.5569792, 0.3734143, 0.4824852, 0.5489935]], [[0.6917183, 0.5402187, 0.5768268, 0.6441192]]]]

Expected (Unparsed): [[[[0.5569792267550215,0.3734142886644101,0.4824852303669541,0.5489934701966609]],[[0.6917183027457761,0.5402187045089725,0.5768267896769925,0.6441191575326144]]]]

Actual:   [[[[0.557, 0.3735, 0.4825, 0.549]], [[0.6918, 0.5403, 0.5769, 0.6442]]]]

Expected: [[[[0.557, 0.3735, 0.4825, 0.549]], [[0.6918, 0.5403, 0.5769, 0.6442]]]]