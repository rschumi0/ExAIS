import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub7620 = tf.keras.layers.Input(shape=([2, 3, 3, 3]))
in1Sub7620 = tf.keras.layers.Input(shape=([2, 3, 3, 3]))
in0Max95688 = tf.keras.layers.Input(shape=([1, 2]))
in1Max95688 = tf.keras.layers.Input(shape=([1, 2]))

Sub7620 = keras.layers.Subtract(name = 'Sub7620', )([in0Sub7620,in1Sub7620])
Res38539 = keras.layers.Reshape((2, 3, 9), name = 'Res38539', )(Sub7620)
Glo12416 = keras.layers.GlobalAveragePooling2D(name = 'Glo12416', )(Res38539)
Res23999 = keras.layers.Reshape((9, 1), name = 'Res23999', )(Glo12416)
PRe49854 = keras.layers.PReLU(name = 'PRe49854', )(Res23999)
Res74205 = keras.layers.Reshape((9, 1, 1), name = 'Res74205', )(PRe49854)
Zer63757 = keras.layers.ZeroPadding2D(padding=((0, 0), (6, 0)), name = 'Zer63757', )(Res74205)
Max95688 = keras.layers.Maximum(name = 'Max95688', )([in0Max95688,in1Max95688])
Res51918 = keras.layers.Reshape((1, 2, 1), name = 'Res51918', )(Max95688)
Up_98241 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_98241', )(Res51918)
Zer77522 = keras.layers.ZeroPadding2D(padding=((8, 0), (3, 0)), name = 'Zer77522', )(Up_98241)
Add35072 = keras.layers.Add(name = 'Add35072', )([Zer63757,Zer77522])
model = tf.keras.models.Model(inputs=[in0Sub7620,in1Sub7620,in0Max95688,in1Max95688], outputs=Add35072)
w = model.get_layer('PRe49854').get_weights() 
w[0] = np.array([[0.4171], [0.0483], [0.5732], [0.3549], [0.5006], [0.1097], [0.4629], [0.578], [0.0956]])
model.get_layer('PRe49854').set_weights(w) 
in0Sub7620 = tf.constant([[[[[0.6614, 0.6253, 0.0006], [0.0282, 0.3438, 0.5074], [0.6148, 0.7339, 0.7521]], [[0.8781, 0.4201, 0.7214], [0.4993, 0.6949, 0.9296], [0.0741, 0.7093, 0.4829]], [[0.5877, 0.3599, 0.1909], [0.6258, 0.0959, 0.715], [0.2066, 0.6983, 0.8188]]], [[[0.9528, 0.0233, 0.8138], [0.7365, 0.6865, 0.2422], [0.0553, 0.8509, 0.8089]], [[0.2387, 0.9361, 0.4357], [0.3205, 0.9124, 0.4891], [0.0223, 0.4141, 0.3484]], [[0.0282, 0.5626, 0.9331], [0.9177, 0.8394, 0.7711], [0.8024, 0.8117, 0.0642]]]]])
in1Sub7620 = tf.constant([[[[[0.2596, 0.7999, 0.9936], [0.8172, 0.7074, 0.0822], [0.0788, 0.1461, 0.9746]], [[0.21, 0.7075, 0.784], [0.7644, 0.026, 0.5641], [0.7732, 0.1677, 0.6324]], [[0.312, 0.9431, 0.1795], [0.8856, 0.3654, 0.9169], [0.07, 0.2819, 0.5973]]], [[[0.7894, 0.3123, 0.8417], [0.7972, 0.8699, 0.6227], [0.6177, 0.9337, 0.9157]], [[0.5511, 0.7486, 0.0527], [0.0963, 0.9775, 0.5616], [0.9455, 0.523, 0.8132]], [[0.0842, 0.562, 0.5525], [0.1854, 0.47, 0.507], [0.2335, 0.3923, 0.2649]]]]])
in0Max95688 = tf.constant([[[0.8622, 0.2024]]])
in1Max95688 = tf.constant([[[0.9537, 0.1444]]])
print (np.array2string(model.predict([in0Sub7620,in1Sub7620,in0Max95688,in1Max95688],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add35072.png')

LSub7620 = subtract_layer([[[[[0.6614, 0.6253, 0.0006], [0.0282, 0.3438, 0.5074], [0.6148, 0.7339, 0.7521]], [[0.8781, 0.4201, 0.7214], [0.4993, 0.6949, 0.9296], [0.0741, 0.7093, 0.4829]], [[0.5877, 0.3599, 0.1909], [0.6258, 0.0959, 0.715], [0.2066, 0.6983, 0.8188]]], [[[0.9528, 0.0233, 0.8138], [0.7365, 0.6865, 0.2422], [0.0553, 0.8509, 0.8089]], [[0.2387, 0.9361, 0.4357], [0.3205, 0.9124, 0.4891], [0.0223, 0.4141, 0.3484]], [[0.0282, 0.5626, 0.9331], [0.9177, 0.8394, 0.7711], [0.8024, 0.8117, 0.0642]]]]], [[[[[0.2596, 0.7999, 0.9936], [0.8172, 0.7074, 0.0822], [0.0788, 0.1461, 0.9746]], [[0.21, 0.7075, 0.784], [0.7644, 0.026, 0.5641], [0.7732, 0.1677, 0.6324]], [[0.312, 0.9431, 0.1795], [0.8856, 0.3654, 0.9169], [0.07, 0.2819, 0.5973]]], [[[0.7894, 0.3123, 0.8417], [0.7972, 0.8699, 0.6227], [0.6177, 0.9337, 0.9157]], [[0.5511, 0.7486, 0.0527], [0.0963, 0.9775, 0.5616], [0.9455, 0.523, 0.8132]], [[0.0842, 0.562, 0.5525], [0.1854, 0.47, 0.507], [0.2335, 0.3923, 0.2649]]]]], Sub7620), 
LRes38539 = reshape_layer(Sub7620, [2, 3, 9], Res38539), 
LGlo12416 = global_average_pooling2D_layer(Res38539, Glo12416), 
LRes23999 = reshape_layer(Glo12416, [9, 1], Res23999), 
LPRe49854 = prelu_layer(Res23999, [[0.4171], [0.0483], [0.5732], [0.3549], [0.5006], [0.1097], [0.4629], [0.578], [0.0956]], PRe49854), 
LRes74205 = reshape_layer(PRe49854, [9, 1, 1], Res74205), 
LZer63757 = zero_padding2D_layer(Res74205, 0, 0, 6, 0, Zer63757), 
LMax95688 = maximum_layer([[[[0.8622, 0.2024]]], [[[0.9537, 0.1444]]]], Max95688), 
LRes51918 = reshape_layer(Max95688, [1, 2, 1], Res51918), 
LUp_98241 = up_sampling2D_layer(Res51918, 1, 2, Up_98241), 
LZer77522 = zero_padding2D_layer(Up_98241, 8, 0, 3, 0, Zer77522), 
LAdd35072 = add_layer([Zer63757,Zer77522], Add35072), 
exec_layers([LSub7620,LRes38539,LGlo12416,LRes23999,LPRe49854,LRes74205,LZer63757,LMax95688,LRes51918,LUp_98241,LZer77522,LAdd35072],["Sub7620","Res38539","Glo12416","Res23999","PRe49854","Res74205","Zer63757","Max95688","Res51918","Up_98241","Zer77522","Add35072"],Add35072,"Add35072")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.1901000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0092261]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0294720]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0247306]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0261167]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0666500]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0727679]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.2955833]], [[0.0000000], [0.0000000], [0.0000000], [0.9537000], [0.9537000], [0.2024000], [0.1876967]]]]

Expected (Unparsed): [[[[0],[0],[0],[0],[0],[0],[0.19009999999999996]],[[0],[0],[0],[0],[0],[0],[-0.009226105000000002]],[[0],[0],[0],[0],[0],[0],[-0.02947203333333335]],[[0],[0],[0],[0],[0],[0],[-0.024730615000000008]],[[0],[0],[0],[0],[0],[0],[0.02611666666666665]],[[0],[0],[0],[0],[0],[0],[0.06664999999999996]],[[0],[0],[0],[0],[0],[0],[-0.07276788]],[[0],[0],[0],[0],[0],[0],[0.29558333333333336]],[[0],[0],[0],[0.9537],[0.9537],[0.2024],[0.18769671999999998]]]]

Actual:   [[[[0], [0], [0], [0], [0], [0], [0.1901]], [[0], [0], [0], [0], [0], [0], [-0.0092]], [[0], [0], [0], [0], [0], [0], [-0.0294]], [[0], [0], [0], [0], [0], [0], [-0.0247]], [[0], [0], [0], [0], [0], [0], [0.0262]], [[0], [0], [0], [0], [0], [0], [0.0667]], [[0], [0], [0], [0], [0], [0], [-0.0727]], [[0], [0], [0], [0], [0], [0], [0.2956]], [[0], [0], [0], [0.9537], [0.9537], [0.2024], [0.1877]]]]

Expected: [[[[0], [0], [0], [0], [0], [0], [0.1901]], [[0], [0], [0], [0], [0], [0], [-0.0092]], [[0], [0], [0], [0], [0], [0], [-0.0294]], [[0], [0], [0], [0], [0], [0], [-0.0247]], [[0], [0], [0], [0], [0], [0], [0.0262]], [[0], [0], [0], [0], [0], [0], [0.0667]], [[0], [0], [0], [0], [0], [0], [-0.0727]], [[0], [0], [0], [0], [0], [0], [0.2956]], [[0], [0], [0], [0.9537], [0.9537], [0.2024], [0.1877]]]]