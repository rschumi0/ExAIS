import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub37134 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub37134 = tf.keras.layers.Input(shape=([3, 3]))
in0Con88112 = tf.keras.layers.Input(shape=([2, 1]))
in0Sub22686 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub22686 = tf.keras.layers.Input(shape=([2, 3]))

Sub37134 = keras.layers.Subtract(name = 'Sub37134', )([in0Sub37134,in1Sub37134])
Sep31071 = keras.layers.SeparableConv1D(2, (3),strides=(2), padding='same', name = 'Sep31071', )(Sub37134)
Con88112 = keras.layers.Concatenate(axis=2, name = 'Con88112', )([Sep31071,in0Con88112])
Sub22686 = keras.layers.Subtract(name = 'Sub22686', )([in0Sub22686,in1Sub22686])
Add22711 = keras.layers.Add(name = 'Add22711', )([Con88112,Sub22686])
Thr20873 = keras.layers.ThresholdedReLU(theta=0.3924667684825307, name = 'Thr20873', )(Add22711)
model = tf.keras.models.Model(inputs=[in0Sub37134,in1Sub37134,in0Con88112,in0Sub22686,in1Sub22686], outputs=Thr20873)
w = model.get_layer('Sep31071').get_weights() 
w[0] = np.array([[[0.3405], [0.1268], [0.5244]], [[0.2515], [0.0131], [0.2198]], [[0.8538], [0.0069], [0.83]]])
w[1] = np.array([[[0.4782, 0.3413], [0.4089, 0.3794], [0.8066, 0.5466]]])
w[2] = np.array([0, 0])
model.get_layer('Sep31071').set_weights(w) 
in0Sub37134 = tf.constant([[[0.721, 0.4443, 0.5734], [0.6323, 0.9843, 0.9334], [0.0305, 0.9326, 0.3801]]])
in1Sub37134 = tf.constant([[[0.5345, 0.6811, 0.6898], [0.0116, 0.2608, 0.489], [0.6295, 0.6721, 0.1395]]])
in0Con88112 = tf.constant([[[0.9829], [0.2186]]])
in0Sub22686 = tf.constant([[[0.7669, 0.4019, 0.7979], [0.8004, 0.0262, 0.4375]]])
in1Sub22686 = tf.constant([[[0.5866, 0.0876, 0.9212], [0.1189, 0.3652, 0.5251]]])
print (np.array2string(model.predict([in0Sub37134,in1Sub37134,in0Con88112,in0Sub22686,in1Sub22686],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr20873.png')

LSub37134 = subtract_layer([[[0.721, 0.4443, 0.5734], [0.6323, 0.9843, 0.9334], [0.0305, 0.9326, 0.3801]]], [[[0.5345, 0.6811, 0.6898], [0.0116, 0.2608, 0.489], [0.6295, 0.6721, 0.1395]]], Sub37134), 
LSep31071 = separable_conv1D_layer(Sub37134, 3,[[[[0.3405], [0.1268], [0.5244]], [[0.2515], [0.0131], [0.2198]], [[0.8538], [0.0069], [0.83]]],[[[0.4782, 0.3413], [0.4089, 0.3794], [0.8066, 0.5466]]]],[0, 0], 2, true, Sep31071), 
LCon88112 = concatenate_layer([Sep31071,[[[0.9829], [0.2186]]]], 2, Con88112), 
LSub22686 = subtract_layer([[[0.7669, 0.4019, 0.7979], [0.8004, 0.0262, 0.4375]]], [[[0.5866, 0.0876, 0.9212], [0.1189, 0.3652, 0.5251]]], Sub22686), 
LAdd22711 = add_layer([Con88112,Sub22686], Add22711), 
LThr20873 = thresholded_relu_layer(Add22711, 0.3924667684825307, Thr20873), 
exec_layers([LSub37134,LSep31071,LCon88112,LSub22686,LAdd22711,LThr20873],["Sub37134","Sep31071","Con88112","Sub22686","Add22711","Thr20873"],Thr20873,"Thr20873")

Actual (Unparsed): [[[0.7338059, 0.6995288, 0.8596001], [0.9800634, -0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.733805929333,0.6995287631389999,0.8596],[0.9800633759690001,0,0]]]

Actual:   [[[0.7339, 0.6996, 0.8597], [0.9801, -0, 0]]]

Expected: [[[0.7339, 0.6996, 0.8596], [0.9801, 0, 0]]]