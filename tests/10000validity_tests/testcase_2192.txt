import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave7456 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave7456 = tf.keras.layers.Input(shape=([1, 1]))
in0Con41605 = tf.keras.layers.Input(shape=([4, 12, 3]))
in0Mul43765 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul43765 = tf.keras.layers.Input(shape=([2, 2]))
in0Max28686 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max28686 = tf.keras.layers.Input(shape=([2, 2, 1]))

Ave7456 = keras.layers.Average(name = 'Ave7456', )([in0Ave7456,in1Ave7456])
Res58771 = keras.layers.Reshape((1, 1, 1), name = 'Res58771', )(Ave7456)
Zer18388 = keras.layers.ZeroPadding2D(padding=((3, 0), (11, 0)), name = 'Zer18388', )(Res58771)
Con41605 = keras.layers.Concatenate(axis=3, name = 'Con41605', )([Zer18388,in0Con41605])
Mul43765 = keras.layers.Multiply(name = 'Mul43765', )([in0Mul43765,in1Mul43765])
Res85236 = keras.layers.Reshape((2, 2, 1), name = 'Res85236', )(Mul43765)
Max28686 = keras.layers.Maximum(name = 'Max28686', )([in0Max28686,in1Max28686])
ReL61681 = keras.layers.ReLU(max_value=3.3881553250890613, negative_slope=9.938389371973642, threshold=6.811714108999112, name = 'ReL61681', )(Max28686)
Ave43351 = keras.layers.Average(name = 'Ave43351', )([Res85236,ReL61681])
Con39628 = keras.layers.Conv2DTranspose(4, (1, 2),strides=(2, 6), padding='valid', name = 'Con39628', )(Ave43351)
Min67450 = keras.layers.Minimum(name = 'Min67450', )([Con41605,Con39628])
model = tf.keras.models.Model(inputs=[in0Ave7456,in1Ave7456,in0Con41605,in0Mul43765,in1Mul43765,in0Max28686,in1Max28686], outputs=Min67450)
w = model.get_layer('Con39628').get_weights() 
w[0] = np.array([[[[0.2129], [0.2569], [0.0502], [0.8703]], [[0.5184], [0.9321], [0.2582], [0.4509]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con39628').set_weights(w) 
in0Ave7456 = tf.constant([[[0.2422]]])
in1Ave7456 = tf.constant([[[0.7813]]])
in0Con41605 = tf.constant([[[[0.3777, 0.1318, 0.8302], [0.708, 0.0626, 0.5891], [0.7501, 0.2112, 0.3147], [0.8538, 0.4268, 0.806], [0.4409, 0.4754, 0.7578], [0.6787, 0.782, 0.0913], [0.0981, 0.2786, 0.556], [0.7975, 0.689, 0.8489], [0.9041, 0.8336, 0.0282], [0.7347, 0.4514, 0.5236], [0.4137, 0.1002, 0.1015], [0.6735, 0.5625, 0.832]], [[0.9713, 0.9161, 0.1631], [0.0905, 0.3451, 0.8157], [0.4536, 0.1803, 0.2745], [0.8963, 0.4339, 0.1547], [0.9855, 0.1431, 0.121], [0.8438, 0.5662, 0.9387], [0.3309, 0.802, 0.5048], [0.8459, 0.8354, 0.0063], [0.5201, 0.1224, 0.3821], [0.0052, 0.7898, 0.3653], [0.986, 0.6193, 0.1136], [0.2195, 0.1117, 0.2224]], [[0.7731, 0.6589, 0.8426], [0.0962, 0.849, 0.9494], [0.9064, 0.3436, 0.5393], [0.0382, 0.4718, 0.3708], [0.5833, 0.777, 0.9589], [0.0028, 0.2461, 0.0851], [0.7185, 0.886, 0.4383], [0.8847, 0.3263, 0.9472], [0.4559, 0.399, 0.4104], [0.3294, 0.5155, 0.1964], [0.3853, 0.4055, 0.7255], [0.1802, 0.1994, 0.1815]], [[0.3872, 0.5832, 0.2227], [0.6456, 0.554, 0.902], [0.6961, 0.3933, 0.5858], [0.6286, 0.7435, 0.1638], [0.0336, 0.5769, 0.8108], [0.7607, 0.5659, 0.5835], [0.5332, 0.1976, 0.8021], [0.3693, 0.459, 0.8097], [0.8605, 0.388, 0.7598], [0.5012, 0.1461, 0.5599], [0.043, 0.2617, 0.4041], [0.8915, 0.6496, 0.5784]]]])
in0Mul43765 = tf.constant([[[0.5725, 0.6325], [0.5817, 0.7791]]])
in1Mul43765 = tf.constant([[[0.6854, 0.0129], [0.714, 0.5668]]])
in0Max28686 = tf.constant([[[[0.2952], [0.7974]], [[0.1055], [0.9292]]]])
in1Max28686 = tf.constant([[[[0.3627], [0.4803]], [[0.1811], [0.7234]]]])
print (np.array2string(model.predict([in0Ave7456,in1Ave7456,in0Con41605,in0Mul43765,in1Mul43765,in0Max28686,in1Max28686],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min67450.png')

LAve7456 = average_layer([[[[0.2422]]], [[[0.7813]]]], Ave7456), 
LRes58771 = reshape_layer(Ave7456, [1, 1, 1], Res58771), 
LZer18388 = zero_padding2D_layer(Res58771, 3, 0, 11, 0, Zer18388), 
LCon41605 = concatenate_layer([Zer18388,[[[[0.3777, 0.1318, 0.8302], [0.708, 0.0626, 0.5891], [0.7501, 0.2112, 0.3147], [0.8538, 0.4268, 0.806], [0.4409, 0.4754, 0.7578], [0.6787, 0.782, 0.0913], [0.0981, 0.2786, 0.556], [0.7975, 0.689, 0.8489], [0.9041, 0.8336, 0.0282], [0.7347, 0.4514, 0.5236], [0.4137, 0.1002, 0.1015], [0.6735, 0.5625, 0.832]], [[0.9713, 0.9161, 0.1631], [0.0905, 0.3451, 0.8157], [0.4536, 0.1803, 0.2745], [0.8963, 0.4339, 0.1547], [0.9855, 0.1431, 0.121], [0.8438, 0.5662, 0.9387], [0.3309, 0.802, 0.5048], [0.8459, 0.8354, 0.0063], [0.5201, 0.1224, 0.3821], [0.0052, 0.7898, 0.3653], [0.986, 0.6193, 0.1136], [0.2195, 0.1117, 0.2224]], [[0.7731, 0.6589, 0.8426], [0.0962, 0.849, 0.9494], [0.9064, 0.3436, 0.5393], [0.0382, 0.4718, 0.3708], [0.5833, 0.777, 0.9589], [0.0028, 0.2461, 0.0851], [0.7185, 0.886, 0.4383], [0.8847, 0.3263, 0.9472], [0.4559, 0.399, 0.4104], [0.3294, 0.5155, 0.1964], [0.3853, 0.4055, 0.7255], [0.1802, 0.1994, 0.1815]], [[0.3872, 0.5832, 0.2227], [0.6456, 0.554, 0.902], [0.6961, 0.3933, 0.5858], [0.6286, 0.7435, 0.1638], [0.0336, 0.5769, 0.8108], [0.7607, 0.5659, 0.5835], [0.5332, 0.1976, 0.8021], [0.3693, 0.459, 0.8097], [0.8605, 0.388, 0.7598], [0.5012, 0.1461, 0.5599], [0.043, 0.2617, 0.4041], [0.8915, 0.6496, 0.5784]]]]], 3, Con41605), 
LMul43765 = multiply_layer([[[[0.5725, 0.6325], [0.5817, 0.7791]]], [[[0.6854, 0.0129], [0.714, 0.5668]]]], Mul43765), 
LRes85236 = reshape_layer(Mul43765, [2, 2, 1], Res85236), 
LMax28686 = maximum_layer([[[[[0.2952], [0.7974]], [[0.1055], [0.9292]]]], [[[[0.3627], [0.4803]], [[0.1811], [0.7234]]]]], Max28686), 
LReL61681 = relu_layer(Max28686, 3.3881553250890613, 9.938389371973642, 6.811714108999112, ReL61681), 
LAve43351 = average_layer([Res85236,ReL61681], Ave43351), 
LCon39628 = conv2D_transpose_layer(Ave43351, 1, 2,[[[[0.2129], [0.2569], [0.0502], [0.8703]], [[0.5184], [0.9321], [0.2582], [0.4509]]]],[0, 0, 0, 0], 2, 6, false, Con39628), 
LMin67450 = minimum_layer([Con41605,Con39628], Min67450), 
exec_layers([LAve7456,LRes58771,LZer18388,LCon41605,LMul43765,LRes85236,LMax28686,LReL61681,LAve43351,LCon39628,LMin67450],["Ave7456","Res58771","Zer18388","Con41605","Mul43765","Res85236","Max28686","ReL61681","Ave43351","Con39628","Min67450"],Min67450,"Min67450")

Actual (Unparsed): [[[[-6.7809099, -8.1823192, -1.5988806, -27.7192386], [-16.5111494, -29.6875816, -8.2237245, -14.3612601], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [-6.3619242, -7.6767418, -1.5000873, -26.0064944], [-15.4909419, -27.8532155, -7.7155887, -13.4738921], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[-6.9705899, -8.4112003, -1.6436055, -28.4946189], [-16.9730098, -30.5180217, -8.4537638, -14.7629825], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [-6.1763484, -7.4528131, -1.4563302, -25.2478912], [-15.0390748, -27.0407439, -7.4905268, -13.0808619], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[-6.780909898543257,-8.182319177716124,-1.5988805866926796,-27.719238537821496],[-16.51114932552759,-29.68758157084157,-8.223724451873503,-14.361260090432854],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[-6.361924230359083,-7.676741826112017,-1.5000873478817565,-26.006494399631325],[-15.490941855416384,-27.853215477302495,-7.7155887096228986,-13.473892134659044],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[-6.970589875942479,-8.411200277734254,-1.643605503862435,-28.49461892453142],[-16.97300982474674,-30.51802171613896,-8.453763766878101,-14.762982503816175],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[-6.176348417883962,-7.452813097953921,-1.4563301577161807,-25.24789116056558],[-15.039074776096973,-27.04074382484566,-7.490526827137805,-13.080861914626015],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]]]

Actual:   [[[[-6.7809, -8.1823, -1.5988, -27.7192], [-16.5111, -29.6875, -8.2237, -14.3612], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [-6.3619, -7.6767, -1.5, -26.0064], [-15.4909, -27.8532, -7.7155, -13.4738], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[-6.9705, -8.4112, -1.6436, -28.4946], [-16.973, -30.518, -8.4537, -14.7629], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [-6.1763, -7.4528, -1.4563, -25.2478], [-15.039, -27.0407, -7.4905, -13.0808], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]]

Expected: [[[[-6.7809, -8.1823, -1.5988, -27.7192], [-16.5111, -29.6875, -8.2237, -14.3612], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [-6.3619, -7.6767, -1.5, -26.0064], [-15.4909, -27.8532, -7.7155, -13.4738], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[-6.9705, -8.4112, -1.6436, -28.4946], [-16.973, -30.518, -8.4537, -14.7629], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [-6.1763, -7.4528, -1.4563, -25.2478], [-15.039, -27.0407, -7.4905, -13.0808], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]]