import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con15240 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Add54777 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add54777 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con58284 = tf.keras.layers.Input(shape=([6]))

Con15240 = keras.layers.Conv2DTranspose(2, (1, 1),strides=(1, 1), padding='same', name = 'Con15240', )(in0Con15240)
Res7925 = keras.layers.Reshape((2, 4), name = 'Res7925', )(Con15240)
Fla41790 = keras.layers.Flatten(name = 'Fla41790', )(Res7925)
Add54777 = keras.layers.Add(name = 'Add54777', )([in0Add54777,in1Add54777])
Glo55278 = keras.layers.GlobalMaxPool2D(name = 'Glo55278', )(Add54777)
Con58284 = keras.layers.Concatenate(axis=1, name = 'Con58284', )([Glo55278,in0Con58284])
Mul33221 = keras.layers.Multiply(name = 'Mul33221', )([Fla41790,Con58284])
model = tf.keras.models.Model(inputs=[in0Con15240,in0Add54777,in1Add54777,in0Con58284], outputs=Mul33221)
w = model.get_layer('Con15240').get_weights() 
w[0] = np.array([[[[0.0732], [0.2487]]]])
w[1] = np.array([0, 0])
model.get_layer('Con15240').set_weights(w) 
in0Con15240 = tf.constant([[[[0.5647], [0.1985]], [[0.632], [0.7269]]]])
in0Add54777 = tf.constant([[[[0.1006, 0.7864]], [[0.6461, 0.0783]]]])
in1Add54777 = tf.constant([[[[0.1837, 0.7228]], [[0.1348, 0.8786]]]])
in0Con58284 = tf.constant([[0.4821, 0.3983, 0.1995, 0.3234, 0.1199, 0.9188]])
print (np.array2string(model.predict([in0Con15240,in0Add54777,in1Add54777,in0Con58284],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul33221.png')

LCon15240 = conv2D_transpose_layer([[[[0.5647], [0.1985]], [[0.632], [0.7269]]]], 1, 1,[[[[0.0732], [0.2487]]]],[0, 0], 1, 1, true, Con15240), 
LRes7925 = reshape_layer(Con15240, [2, 4], Res7925), 
LFla41790 = flatten_layer(Res7925, Fla41790), 
LAdd54777 = add_layer([[[[[0.1006, 0.7864]], [[0.6461, 0.0783]]]], [[[[0.1837, 0.7228]], [[0.1348, 0.8786]]]]], Add54777), 
LGlo55278 = global_max_pool2D_layer(Add54777, Glo55278), 
LCon58284 = concatenate_layer([Glo55278,[[0.4821, 0.3983, 0.1995, 0.3234, 0.1199, 0.9188]]], 1, Con58284), 
LMul33221 = multiply_layer([Fla41790,Con58284], Mul33221), 
exec_layers([LCon15240,LRes7925,LFla41790,LAdd54777,LGlo55278,LCon58284,LMul33221],["Con15240","Res7925","Fla41790","Add54777","Glo55278","Con58284","Mul33221"],Mul33221,"Mul33221")

Actual (Unparsed): [[0.0322793, 0.2119534, 0.0070050, 0.0196629, 0.0092293, 0.0508315, 0.0063798, 0.1661007]]

Expected (Unparsed): [[0.032279313636,0.21195339118799997,0.0070050094200000005,0.019662856185,0.0092293488,0.05083149456,0.006379768692,0.166100691564]]

Actual:   [[0.0323, 0.212, 0.0071, 0.0197, 0.0093, 0.0509, 0.0064, 0.1662]]

Expected: [[0.0323, 0.212, 0.0071, 0.0197, 0.0093, 0.0509, 0.0064, 0.1662]]