import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub50575 = tf.keras.layers.Input(shape=([3]))
in1Sub50575 = tf.keras.layers.Input(shape=([3]))
in0Glo1746 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con55317 = tf.keras.layers.Input(shape=([2]))

Sub50575 = keras.layers.Subtract(name = 'Sub50575', )([in0Sub50575,in1Sub50575])
Glo1746 = keras.layers.GlobalAveragePooling2D(name = 'Glo1746', )(in0Glo1746)
Con55317 = keras.layers.Concatenate(axis=1, name = 'Con55317', )([Glo1746,in0Con55317])
Mul76326 = keras.layers.Multiply(name = 'Mul76326', )([Sub50575,Con55317])
Res42797 = keras.layers.Reshape((3, 1), name = 'Res42797', )(Mul76326)
Per84335 = keras.layers.Permute((1,2), name = 'Per84335',)(Res42797)
model = tf.keras.models.Model(inputs=[in0Sub50575,in1Sub50575,in0Glo1746,in0Con55317], outputs=Per84335)
in0Sub50575 = tf.constant([[0.0135, 0.4693, 0.1101]])
in1Sub50575 = tf.constant([[0.8442, 0.8855, 0.9111]])
in0Glo1746 = tf.constant([[[[1.3016]]]])
in0Con55317 = tf.constant([[0.7104, 0.4601]])
print (np.array2string(model.predict([in0Sub50575,in1Sub50575,in0Glo1746,in0Con55317],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per84335.png')

LSub50575 = subtract_layer([[0.0135, 0.4693, 0.1101]], [[0.8442, 0.8855, 0.9111]], Sub50575), 
LGlo1746 = global_average_pooling2D_layer([[[[1.3016]]]], Glo1746), 
LCon55317 = concatenate_layer([Glo1746,[[0.7104, 0.4601]]], 1, Con55317), 
LMul76326 = multiply_layer([Sub50575,Con55317], Mul76326), 
LRes42797 = reshape_layer(Mul76326, [3, 1], Res42797), 
LPer84335 = permute_layer(Res42797, 1,2, Per84335), 
exec_layers([LSub50575,LGlo1746,LCon55317,LMul76326,LRes42797,LPer84335],["Sub50575","Glo1746","Con55317","Mul76326","Res42797","Per84335"],Per84335,"Per84335")

Actual (Unparsed): [[[-1.0812391], [-0.2956685], [-0.3685401]]]

Expected (Unparsed): [[[-1.08123912],[-0.29566848],[-0.36854010000000004]]]

Actual:   [[[-1.0812], [-0.2956], [-0.3685]]]

Expected: [[[-1.0812], [-0.2956], [-0.3685]]]