import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave27824 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Ave27824 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Dot56844 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot56844 = tf.keras.layers.Input(shape=([3, 2]))
in0Con44740 = tf.keras.layers.Input(shape=([4, 1]))
in0Con65701 = tf.keras.layers.Input(shape=([4, 4, 1]))
in0Max1505 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Max1505 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con47133 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Thr35834 = tf.keras.layers.Input(shape=([2, 1, 2]))

Ave27824 = keras.layers.Average(name = 'Ave27824', )([in0Ave27824,in1Ave27824])
Res33109 = keras.layers.Reshape((1, 1, 4), name = 'Res33109', )(Ave27824)
Res93724 = keras.layers.Reshape((1, 4), name = 'Res93724', )(Res33109)
Glo13247 = keras.layers.GlobalAveragePooling1D(name = 'Glo13247', )(Res93724)
Res95595 = keras.layers.Reshape((4, 1), name = 'Res95595', )(Glo13247)
Loc94813 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc94813', )(Res95595)
Dot56844 = keras.layers.Dot(axes=(2, 2), name = 'Dot56844', )([in0Dot56844,in1Dot56844])
Zer59526 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer59526', )(Dot56844)
Con44740 = keras.layers.Concatenate(axis=2, name = 'Con44740', )([Zer59526,in0Con44740])
Mul78004 = keras.layers.Multiply(name = 'Mul78004', )([Loc94813,Con44740])
Res33020 = keras.layers.Reshape((4, 4, 1), name = 'Res33020', )(Mul78004)
Con65701 = keras.layers.Concatenate(axis=3, name = 'Con65701', )([Res33020,in0Con65701])
Max1505 = keras.layers.Maximum(name = 'Max1505', )([in0Max1505,in1Max1505])
Res40921 = keras.layers.Reshape((1, 2, 1), name = 'Res40921', )(Max1505)
Zer44853 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer44853', )(Res40921)
Con47133 = keras.layers.Concatenate(axis=3, name = 'Con47133', )([Zer44853,in0Con47133])
Thr35834 = keras.layers.ThresholdedReLU(theta=9.391599005675593, name = 'Thr35834', input_shape=(2, 1, 2))(in0Thr35834)
Zer47059 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer47059', )(Thr35834)
Ave47247 = keras.layers.Average(name = 'Ave47247', )([Con47133,Zer47059])
Zer9252 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer9252', )(Ave47247)
Min9773 = keras.layers.Minimum(name = 'Min9773', )([Con65701,Zer9252])
model = tf.keras.models.Model(inputs=[in0Ave27824,in1Ave27824,in0Dot56844,in1Dot56844,in0Con44740,in0Con65701,in0Max1505,in1Max1505,in0Con47133,in0Thr35834], outputs=Min9773)
w = model.get_layer('Loc94813').get_weights() 
w[0] = np.array([[[0.4274, 0.9951, 0.195, 0.9464]], [[0.0438, 0.244, 0.9839, 0.1117]], [[0.1881, 0.2729, 0.1509, 0.3398]], [[0.353, 0.9889, 0.3289, 0.4732]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc94813').set_weights(w) 
in0Ave27824 = tf.constant([[[[[0.8787, 0.1507], [0.4672, 0.5711]]]]])
in1Ave27824 = tf.constant([[[[[0.5538, 0.1488], [0.257, 0.2625]]]]])
in0Dot56844 = tf.constant([[[0.3889, 0.3384], [0.662, 0.7289], [0.427, 0.0062]]])
in1Dot56844 = tf.constant([[[0.1874, 0.3884], [0.5257, 0.3387], [0.6928, 0.0553]]])
in0Con44740 = tf.constant([[[0.6854], [0.4045], [0.39], [0.1083]]])
in0Con65701 = tf.constant([[[[0.0038], [0.7228], [0.7518], [0.7423]], [[0.7517], [0.4922], [0.6111], [0.8117]], [[0.9534], [0.5752], [0.8666], [0.359]], [[0.5075], [0.3891], [0.4227], [0.2665]]]])
in0Max1505 = tf.constant([[[[[0.3021]], [[0.2937]]]]])
in1Max1505 = tf.constant([[[[[0.9326]], [[0.3137]]]]])
in0Con47133 = tf.constant([[[[0.2773], [0.1999], [0.3112]], [[0.9714], [0.726], [0.9924]]]])
in0Thr35834 = tf.constant([[[[0.1252, 0.4599]], [[0.1259, 0.076]]]])
print (np.array2string(model.predict([in0Ave27824,in1Ave27824,in0Dot56844,in1Dot56844,in0Con44740,in0Con65701,in0Max1505,in1Max1505,in0Con47133,in0Thr35834],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min9773.png')

LAve27824 = average_layer([[[[[[0.8787, 0.1507], [0.4672, 0.5711]]]]], [[[[[0.5538, 0.1488], [0.257, 0.2625]]]]]], Ave27824), 
LRes33109 = reshape_layer(Ave27824, [1, 1, 4], Res33109), 
LRes93724 = reshape_layer(Res33109, [1, 4], Res93724), 
LGlo13247 = global_average_pooling1D_layer(Res93724, Glo13247), 
LRes95595 = reshape_layer(Glo13247, [4, 1], Res95595), 
LLoc94813 = locally_connected1D_layer(Res95595, 1,[[[0.4274, 0.9951, 0.195, 0.9464]], [[0.0438, 0.244, 0.9839, 0.1117]], [[0.1881, 0.2729, 0.1509, 0.3398]], [[0.353, 0.9889, 0.3289, 0.4732]]],[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc94813), 
LDot56844 = dot_layer([[[0.3889, 0.3384], [0.662, 0.7289], [0.427, 0.0062]]], [[[0.1874, 0.3884], [0.5257, 0.3387], [0.6928, 0.0553]]], 2, 2, Dot56844), 
LZer59526 = zero_padding1D_layer(Dot56844, 1, 0, Zer59526), 
LCon44740 = concatenate_layer([Zer59526,[[[0.6854], [0.4045], [0.39], [0.1083]]]], 2, Con44740), 
LMul78004 = multiply_layer([Loc94813,Con44740], Mul78004), 
LRes33020 = reshape_layer(Mul78004, [4, 4, 1], Res33020), 
LCon65701 = concatenate_layer([Res33020,[[[[0.0038], [0.7228], [0.7518], [0.7423]], [[0.7517], [0.4922], [0.6111], [0.8117]], [[0.9534], [0.5752], [0.8666], [0.359]], [[0.5075], [0.3891], [0.4227], [0.2665]]]]], 3, Con65701), 
LMax1505 = maximum_layer([[[[[[0.3021]], [[0.2937]]]]], [[[[[0.9326]], [[0.3137]]]]]], Max1505), 
LRes40921 = reshape_layer(Max1505, [1, 2, 1], Res40921), 
LZer44853 = zero_padding2D_layer(Res40921, 1, 0, 1, 0, Zer44853), 
LCon47133 = concatenate_layer([Zer44853,[[[[0.2773], [0.1999], [0.3112]], [[0.9714], [0.726], [0.9924]]]]], 3, Con47133), 
LThr35834 = thresholded_relu_layer([[[[0.1252, 0.4599]], [[0.1259, 0.076]]]], 9.391599005675593, Thr35834), 
LZer47059 = zero_padding2D_layer(Thr35834, 0, 0, 2, 0, Zer47059), 
LAve47247 = average_layer([Con47133,Zer47059], Ave47247), 
LZer9252 = zero_padding2D_layer(Ave47247, 2, 0, 1, 0, Zer9252), 
LMin9773 = minimum_layer([Con65701,Zer9252], Min9773), 
exec_layers([LAve27824,LRes33109,LRes93724,LGlo13247,LRes95595,LLoc94813,LDot56844,LZer59526,LCon44740,LMul78004,LRes33020,LCon65701,LMax1505,LRes40921,LZer44853,LCon47133,LThr35834,LZer47059,LAve47247,LZer9252,LMin9773],["Ave27824","Res33109","Res93724","Glo13247","Res95595","Loc94813","Dot56844","Zer59526","Con44740","Mul78004","Res33020","Con65701","Max1505","Res40921","Zer44853","Con47133","Thr35834","Zer47059","Ave47247","Zer9252","Min9773"],Min9773,"Min9773")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.1386500], [0.0000000, 0.0999500], [0.0000000, 0.1556000]], [[0.0000000, 0.0000000], [0.0000000, 0.3891000], [0.0406004, 0.3630000], [0.0213600, 0.2665000]]]]

Expected (Unparsed): [[[[0.0,0],[0.0,0],[0.0,0],[0,0]],[[0,0],[0,0],[0,0],[0,0]],[[0,0],[0,0.13865],[0,0.09995],[0,0.1556]],[[0,0],[0,0.3891],[0.04060040734669921,0.363],[0.021359983008000002,0.2665]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0.1387], [0, 0.1], [0, 0.1556]], [[0, 0], [0, 0.3891], [0.0407, 0.363], [0.0214, 0.2665]]]]

Expected: [[[[0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0.1387], [0, 0.1], [0, 0.1556]], [[0, 0], [0, 0.3891], [0.0407, 0.363], [0.0214, 0.2665]]]]