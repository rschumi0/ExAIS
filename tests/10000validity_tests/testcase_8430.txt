import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub47555 = tf.keras.layers.Input(shape=([2]))
in1Sub47555 = tf.keras.layers.Input(shape=([2]))
in0Add53838 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Add53838 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Dot49151 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot49151 = tf.keras.layers.Input(shape=([2, 2]))
in0Sub55923 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub55923 = tf.keras.layers.Input(shape=([3, 2]))

Sub47555 = keras.layers.Subtract(name = 'Sub47555', )([in0Sub47555,in1Sub47555])
Res24689 = keras.layers.Reshape((2, 1), name = 'Res24689', )(Sub47555)
Res12756 = keras.layers.Reshape((2, 1, 1), name = 'Res12756', )(Res24689)
Zer88035 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer88035', )(Res12756)
Add53838 = keras.layers.Add(name = 'Add53838', )([in0Add53838,in1Add53838])
Res163 = keras.layers.Reshape((2, 1, 2), name = 'Res163', )(Add53838)
Res43310 = keras.layers.Reshape((2, 2), name = 'Res43310', )(Res163)
Dot49151 = keras.layers.Dot(axes=(2, 1), name = 'Dot49151', )([in0Dot49151,in1Dot49151])
Zer91543 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer91543', )(Dot49151)
Sub55923 = keras.layers.Subtract(name = 'Sub55923', )([in0Sub55923,in1Sub55923])
Sub81184 = keras.layers.Subtract(name = 'Sub81184', )([Zer91543,Sub55923])
Dot51576 = keras.layers.Dot(axes=(2, 2), name = 'Dot51576', )([Res43310,Sub81184])
Res93501 = keras.layers.Reshape((2, 3, 1), name = 'Res93501', )(Dot51576)
Up_84615 = keras.layers.UpSampling2D(size=(1, 1), name = 'Up_84615', )(Res93501)
Mul28326 = keras.layers.Multiply(name = 'Mul28326', )([Zer88035,Up_84615])
model = tf.keras.models.Model(inputs=[in0Sub47555,in1Sub47555,in0Add53838,in1Add53838,in0Dot49151,in1Dot49151,in0Sub55923,in1Sub55923], outputs=Mul28326)
in0Sub47555 = tf.constant([[0.2451, 0.2656]])
in1Sub47555 = tf.constant([[0.2865, 0.4395]])
in0Add53838 = tf.constant([[[[[0.6677, 0.4635]]], [[[0.483, 0.2952]]]]])
in1Add53838 = tf.constant([[[[[0.6734, 0.3963]]], [[[0.3534, 0.0761]]]]])
in0Dot49151 = tf.constant([[[0.8319, 0.1792], [0.94, 0.1086]]])
in1Dot49151 = tf.constant([[[0.9071, 0.6599], [0.2909, 0.6648]]])
in0Sub55923 = tf.constant([[[0.3774, 0.6891], [0.1326, 0.8258], [0.6286, 0.2998]]])
in1Sub55923 = tf.constant([[[0.8879, 0.1622], [0.129, 0.7615], [0.359, 0.1113]]])
print (np.array2string(model.predict([in0Sub47555,in1Sub47555,in0Add53838,in1Add53838,in0Dot49151,in1Dot49151,in0Sub55923,in1Sub55923],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul28326.png')

LSub47555 = subtract_layer([[0.2451, 0.2656]], [[0.2865, 0.4395]], Sub47555), 
LRes24689 = reshape_layer(Sub47555, [2, 1], Res24689), 
LRes12756 = reshape_layer(Res24689, [2, 1, 1], Res12756), 
LZer88035 = zero_padding2D_layer(Res12756, 0, 0, 2, 0, Zer88035), 
LAdd53838 = add_layer([[[[[[0.6677, 0.4635]]], [[[0.483, 0.2952]]]]], [[[[[0.6734, 0.3963]]], [[[0.3534, 0.0761]]]]]], Add53838), 
LRes163 = reshape_layer(Add53838, [2, 1, 2], Res163), 
LRes43310 = reshape_layer(Res163, [2, 2], Res43310), 
LDot49151 = dot_layer([[[0.8319, 0.1792], [0.94, 0.1086]]], [[[0.9071, 0.6599], [0.2909, 0.6648]]], 2, 1, Dot49151), 
LZer91543 = zero_padding1D_layer(Dot49151, 1, 0, Zer91543), 
LSub55923 = subtract_layer([[[0.3774, 0.6891], [0.1326, 0.8258], [0.6286, 0.2998]]], [[[0.8879, 0.1622], [0.129, 0.7615], [0.359, 0.1113]]], Sub55923), 
LSub81184 = subtract_layer(Zer91543,Sub55923, Sub81184), 
LDot51576 = dot_layer(Res43310,Sub81184, 2, 2, Dot51576), 
LRes93501 = reshape_layer(Dot51576, [2, 3, 1], Res93501), 
LUp_84615 = up_sampling2D_layer(Res93501, 1, 1, Up_84615), 
LMul28326 = multiply_layer([Zer88035,Up_84615], Mul28326), 
exec_layers([LSub47555,LRes24689,LRes12756,LZer88035,LAdd53838,LRes163,LRes43310,LDot49151,LZer91543,LSub55923,LSub81184,LDot51576,LRes93501,LUp_84615,LMul28326],["Sub47555","Res24689","Res12756","Zer88035","Add53838","Res163","Res43310","Dot49151","Zer91543","Sub55923","Sub81184","Dot51576","Res93501","Up_84615","Mul28326"],Mul28326,"Mul28326")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [-0.0520675]], [[0.0000000], [0.0000000], [-0.1219461]]]]

Expected (Unparsed): [[[[0.0],[0.0],[-0.05206754810400114]],[[0.0],[0.0],[-0.12194613036291999]]]]

Actual:   [[[[0], [0], [-0.052]], [[0], [0], [-0.1219]]]]

Expected: [[[[0], [0], [-0.052]], [[0], [0], [-0.1219]]]]