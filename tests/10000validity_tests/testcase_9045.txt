import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min8327 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Min8327 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Max49289 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max49289 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con70725 = tf.keras.layers.Input(shape=([2, 2, 3]))
in0Ave3943 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave3943 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Add90995 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add90995 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con72346 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con61815 = tf.keras.layers.Input(shape=([2, 2, 2]))

Min8327 = keras.layers.Minimum(name = 'Min8327', )([in0Min8327,in1Min8327])
Res95088 = keras.layers.Reshape((2, 1, 4), name = 'Res95088', )(Min8327)
Zer10963 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer10963', )(Res95088)
Max49289 = keras.layers.Maximum(name = 'Max49289', )([in0Max49289,in1Max49289])
Con70725 = keras.layers.Concatenate(axis=3, name = 'Con70725', )([Max49289,in0Con70725])
Add24507 = keras.layers.Add(name = 'Add24507', )([Zer10963,Con70725])
Ave3943 = keras.layers.Average(name = 'Ave3943', )([in0Ave3943,in1Ave3943])
Zer65681 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer65681', )(Ave3943)
Add90995 = keras.layers.Add(name = 'Add90995', )([in0Add90995,in1Add90995])
Con72346 = keras.layers.Concatenate(axis=3, name = 'Con72346', )([Add90995,in0Con72346])
Max30167 = keras.layers.Maximum(name = 'Max30167', )([Zer65681,Con72346])
Con61815 = keras.layers.Concatenate(axis=3, name = 'Con61815', )([Max30167,in0Con61815])
Max93156 = keras.layers.Maximum(name = 'Max93156', )([Add24507,Con61815])
model = tf.keras.models.Model(inputs=[in0Min8327,in1Min8327,in0Max49289,in1Max49289,in0Con70725,in0Ave3943,in1Ave3943,in0Add90995,in1Add90995,in0Con72346,in0Con61815], outputs=Max93156)
in0Min8327 = tf.constant([[[[[0.8795, 0.0865], [0.8713, 0.079]]], [[[0.5477, 0.5627], [0.5518, 0.2533]]]]])
in1Min8327 = tf.constant([[[[[0.3907, 0.9714], [0.3696, 0.5542]]], [[[0.2454, 0.9992], [0.6207, 0.932]]]]])
in0Max49289 = tf.constant([[[[0.2172], [0.0224]], [[0.715], [0.5489]]]])
in1Max49289 = tf.constant([[[[0.3105], [0.9695]], [[0.4561], [0.7473]]]])
in0Con70725 = tf.constant([[[[0.1845, 0.9793, 0.5003], [0.3066, 0.638, 0.4647]], [[0.2591, 0.8863, 0.7308], [0.3442, 0.5772, 0.9749]]]])
in0Ave3943 = tf.constant([[[[0.0479, 0.2384]]]])
in1Ave3943 = tf.constant([[[[0.2059, 0.731]]]])
in0Add90995 = tf.constant([[[[0.5398], [0.5812]], [[0.6653], [0.2717]]]])
in1Add90995 = tf.constant([[[[0.6723], [0.3916]], [[0.1586], [0.3489]]]])
in0Con72346 = tf.constant([[[[0.5932], [0.7806]], [[0.0165], [0.7134]]]])
in0Con61815 = tf.constant([[[[0.2965, 0.7602], [0.9453, 0.7735]], [[0.3301, 0.5351], [0.6016, 0.8455]]]])
print (np.array2string(model.predict([in0Min8327,in1Min8327,in0Max49289,in1Max49289,in0Con70725,in0Ave3943,in1Ave3943,in0Add90995,in1Add90995,in0Con72346,in0Con61815],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max93156.png')

LMin8327 = minimum_layer([[[[[[0.8795, 0.0865], [0.8713, 0.079]]], [[[0.5477, 0.5627], [0.5518, 0.2533]]]]], [[[[[0.3907, 0.9714], [0.3696, 0.5542]]], [[[0.2454, 0.9992], [0.6207, 0.932]]]]]], Min8327), 
LRes95088 = reshape_layer(Min8327, [2, 1, 4], Res95088), 
LZer10963 = zero_padding2D_layer(Res95088, 0, 0, 1, 0, Zer10963), 
LMax49289 = maximum_layer([[[[[0.2172], [0.0224]], [[0.715], [0.5489]]]], [[[[0.3105], [0.9695]], [[0.4561], [0.7473]]]]], Max49289), 
LCon70725 = concatenate_layer([Max49289,[[[[0.1845, 0.9793, 0.5003], [0.3066, 0.638, 0.4647]], [[0.2591, 0.8863, 0.7308], [0.3442, 0.5772, 0.9749]]]]], 3, Con70725), 
LAdd24507 = add_layer([Zer10963,Con70725], Add24507), 
LAve3943 = average_layer([[[[[0.0479, 0.2384]]]], [[[[0.2059, 0.731]]]]], Ave3943), 
LZer65681 = zero_padding2D_layer(Ave3943, 1, 0, 1, 0, Zer65681), 
LAdd90995 = add_layer([[[[[0.5398], [0.5812]], [[0.6653], [0.2717]]]], [[[[0.6723], [0.3916]], [[0.1586], [0.3489]]]]], Add90995), 
LCon72346 = concatenate_layer([Add90995,[[[[0.5932], [0.7806]], [[0.0165], [0.7134]]]]], 3, Con72346), 
LMax30167 = maximum_layer([Zer65681,Con72346], Max30167), 
LCon61815 = concatenate_layer([Max30167,[[[[0.2965, 0.7602], [0.9453, 0.7735]], [[0.3301, 0.5351], [0.6016, 0.8455]]]]], 3, Con61815), 
LMax93156 = maximum_layer([Add24507,Con61815], Max93156), 
exec_layers([LMin8327,LRes95088,LZer10963,LMax49289,LCon70725,LAdd24507,LAve3943,LZer65681,LAdd90995,LCon72346,LMax30167,LCon61815,LMax93156],["Min8327","Res95088","Zer10963","Max49289","Con70725","Add24507","Ave3943","Zer65681","Add90995","Con72346","Max30167","Con61815","Max93156"],Max93156,"Max93156")

Actual (Unparsed): [[[[1.2121000, 0.5932000, 0.9793000, 0.7602000], [1.3602000, 0.7806000, 1.0076000, 0.7735000]], [[0.8239000, 0.2591000, 0.8863000, 0.7308000], [0.9927000, 0.9069000, 1.1290000, 1.2282000]]]]

Expected (Unparsed): [[[[1.2121,0.5932,0.9793,0.7602],[1.3602,0.7806,1.0076,0.7735]],[[0.8239,0.2591,0.8863,0.7308],[0.9926999999999999,0.9069,1.129,1.2282]]]]

Actual:   [[[[1.2121, 0.5932, 0.9793, 0.7602], [1.3602, 0.7806, 1.0076, 0.7735]], [[0.8239, 0.2591, 0.8863, 0.7308], [0.9927, 0.9069, 1.129, 1.2282]]]]

Expected: [[[[1.2121, 0.5932, 0.9793, 0.7602], [1.3602, 0.7806, 1.0076, 0.7735]], [[0.8239, 0.2591, 0.8863, 0.7308], [0.9927, 0.9069, 1.129, 1.2282]]]]