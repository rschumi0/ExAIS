import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub72838 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub72838 = tf.keras.layers.Input(shape=([3, 3]))

Sub72838 = keras.layers.Subtract(name = 'Sub72838', )([in0Sub72838,in1Sub72838])
Bat93840 = keras.layers.BatchNormalization(axis=1, epsilon=0.26184643240005,  name = 'Bat93840', )(Sub72838)
ELU53989 = keras.layers.ELU(alpha=0.10799709437030103, name = 'ELU53989', )(Bat93840)
model = tf.keras.models.Model(inputs=[in0Sub72838,in1Sub72838], outputs=ELU53989)
w = model.get_layer('Bat93840').get_weights() 
w[0] = np.array([0.3478, 0.9189, 0.2531])
w[1] = np.array([0.8293, 0.6808, 0.9484])
w[2] = np.array([0.842, 0.7777, 0.4979])
w[3] = np.array([0.7967, 0.3129, 0.5165])
model.get_layer('Bat93840').set_weights(w) 
in0Sub72838 = tf.constant([[[0.643, 0.8327, 0.2563], [0.3217, 0.6604, 0.9572], [0.2452, 0.5436, 0.389]]])
in1Sub72838 = tf.constant([[[0.0936, 0.9788, 0.3489], [0.7665, 0.4127, 0.2107], [0.3809, 0.6633, 0.8998]]])
print (np.array2string(model.predict([in0Sub72838,in1Sub72838],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU53989.png')

LSub72838 = subtract_layer([[[0.643, 0.8327, 0.2563], [0.3217, 0.6604, 0.9572], [0.2452, 0.5436, 0.389]]], [[[0.0936, 0.9788, 0.3489], [0.7665, 0.4127, 0.2107], [0.3809, 0.6633, 0.8998]]], Sub72838), 
LBat93840 = batch_normalization_layer(Sub72838, 1, 0.26184643240005, [0.3478, 0.9189, 0.2531], [0.8293, 0.6808, 0.9484], [0.842, 0.7777, 0.4979], [0.7967, 0.3129, 0.5165], Bat93840), 
LELU53989 = elu_layer(Bat93840, 0.10799709437030103, ELU53989), 
exec_layers([LSub72838,LBat93840,LELU53989],["Sub72838","Bat93840","ELU53989"],ELU53989,"ELU53989")

Actual (Unparsed): [[[0.7303880, 0.4952777, 0.5133631], [-0.0595176, 0.0383993, 0.6429832], [0.7666306, 0.7712207, 0.6590205]]]

Expected (Unparsed): [[[0.7303880091843645,0.49527765507542915,0.5133630669299627],[-0.05951761831307774,0.03839933914505289,0.6429832063798598],[0.7666305704896004,0.7712207075984489,0.659020543644034]]]

Actual:   [[[0.7304, 0.4953, 0.5134], [-0.0595, 0.0384, 0.643], [0.7667, 0.7713, 0.6591]]]

Expected: [[[0.7304, 0.4953, 0.5134], [-0.0595, 0.0384, 0.643], [0.7667, 0.7713, 0.6591]]]