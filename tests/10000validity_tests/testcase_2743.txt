import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL83853 = tf.keras.layers.Input(shape=([2, 2]))

ReL83853 = keras.layers.ReLU(max_value=2.785602844206496, negative_slope=1.0434575267819781, threshold=6.917180858197974, name = 'ReL83853', input_shape=(2, 2))(in0ReL83853)
Glo14551 = keras.layers.GlobalMaxPool1D(name = 'Glo14551', )(ReL83853)
ReL65343 = keras.layers.ReLU(max_value=7.754150698625979, negative_slope=1.145726872400686, threshold=7.007313673742286, name = 'ReL65343', )(Glo14551)
Res17132 = keras.layers.Reshape((2, 1), name = 'Res17132', )(ReL65343)
Res87611 = keras.layers.Reshape((2, 1, 1), name = 'Res87611', )(Res17132)
Dep16346 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='valid', name = 'Dep16346', )(Res87611)
model = tf.keras.models.Model(inputs=[in0ReL83853], outputs=Dep16346)
w = model.get_layer('Dep16346').get_weights() 
w[0] = np.array([[[[0.0528]]], [[[0.8124]]]])
w[1] = np.array([0])
model.get_layer('Dep16346').set_weights(w) 
in0ReL83853 = tf.constant([[[0.0535, 0.5667], [0.8768, 0.6629]]])
print (np.array2string(model.predict([in0ReL83853],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep16346.png')

LReL83853 = relu_layer([[[0.0535, 0.5667], [0.8768, 0.6629]]], 2.785602844206496, 1.0434575267819781, 6.917180858197974, ReL83853), 
LGlo14551 = global_max_pool1D_layer(ReL83853, Glo14551), 
LReL65343 = relu_layer(Glo14551, 7.754150698625979, 1.145726872400686, 7.007313673742286, ReL65343), 
LRes17132 = reshape_layer(ReL65343, [2, 1], Res17132), 
LRes87611 = reshape_layer(Res17132, [2, 1, 1], Res87611), 
LDep16346 = depthwise_conv2D_layer(Res87611, 2, 1,[[[[0.0528]]], [[[0.8124]]]],[0], 1, 1, false, Dep16346), 
exec_layers([LReL83853,LGlo14551,LReL65343,LRes17132,LRes87611,LDep16346],["ReL83853","Glo14551","ReL65343","Res17132","Res87611","Dep16346"],Dep16346,"Dep16346")

Actual (Unparsed): [[[[-13.4019160]]]]

Expected (Unparsed): [[[[-13.401915982523269]]]]

Actual:   [[[[-13.4019]]]]

Expected: [[[[-13.4019]]]]