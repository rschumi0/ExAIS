import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU8316 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot22001 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot22001 = tf.keras.layers.Input(shape=([3, 2]))
in0Con14200 = tf.keras.layers.Input(shape=([1]))

GRU8316 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU8316', )(in0GRU8316)
Dot22001 = keras.layers.Dot(axes=(1, 1), name = 'Dot22001', )([in0Dot22001,in1Dot22001])
Res50270 = keras.layers.Reshape((2, 2, 1), name = 'Res50270', )(Dot22001)
Res20340 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res20340', )(Res50270)
Glo19318 = keras.layers.GlobalMaxPool3D(name = 'Glo19318', )(Res20340)
Con14200 = keras.layers.Concatenate(axis=1, name = 'Con14200', )([Glo19318,in0Con14200])
Add46251 = keras.layers.Add(name = 'Add46251', )([GRU8316,Con14200])
model = tf.keras.models.Model(inputs=[in0GRU8316,in0Dot22001,in1Dot22001,in0Con14200], outputs=Add46251)
w = model.get_layer('GRU8316').get_weights() 
w[0] = np.array([[5, 3, 3, 1, 3, 7]])
w[1] = np.array([[8, 7, 4, 2, 3, 7], [8, 2, 7, 5, 6, 2]])
w[2] = np.array([7, 10, 9, 4, 1, 1])
model.get_layer('GRU8316').set_weights(w) 
in0GRU8316 = tf.constant([[[2]]])
in0Dot22001 = tf.constant([[[0.8215, 0.8109], [0.9876, 0.2669], [0.0585, 0.8431]]])
in1Dot22001 = tf.constant([[[0.7524, 0.2305], [0.5207, 0.1138], [0.2884, 0.4843]]])
in0Con14200 = tf.constant([[0.2272]])
print (np.array2string(model.predict([in0GRU8316,in0Dot22001,in1Dot22001,in0Con14200],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add46251.png')

LGRU8316 = gru_layer([[[2]]],[[5, 3, 3, 1, 3, 7]],[[8, 7, 4, 2, 3, 7], [8, 2, 7, 5, 6, 2]],[7, 10, 9, 4, 1, 1], false, GRU8316), 
LDot22001 = dot_layer([[[0.8215, 0.8109], [0.9876, 0.2669], [0.0585, 0.8431]]], [[[0.7524, 0.2305], [0.5207, 0.1138], [0.2884, 0.4843]]], 1, 1, Dot22001), 
LRes50270 = reshape_layer(Dot22001, [2, 2, 1], Res50270), 
LRes20340 = reshape_layer(Res50270, [2, 2, 1, 1], Res20340), 
LGlo19318 = global_max_pool3D_layer(Res20340, Glo19318), 
LCon14200 = concatenate_layer([Glo19318,[[0.2272]]], 1, Con14200), 
LAdd46251 = add_layer([GRU8316,Con14200], Add46251), 
exec_layers([LGRU8316,LDot22001,LRes50270,LRes20340,LGlo19318,LCon14200,LAdd46251],["GRU8316","Dot22001","Res50270","Res20340","Glo19318","Con14200","Add46251"],Add46251,"Add46251")

Actual (Unparsed): [[1.1492113, 0.2272001]]

Expected (Unparsed): [[1.149211361399307,0.2272001125351621]]

Actual:   [[1.1493, 0.2273]]

Expected: [[1.1493, 0.2273]]