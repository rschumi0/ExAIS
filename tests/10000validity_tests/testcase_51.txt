import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub3914 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Sub3914 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Sub3914 = keras.layers.Subtract(name = 'Sub3914', )([in0Sub3914,in1Sub3914])
Res51435 = keras.layers.Reshape((2, 2, 4), name = 'Res51435', )(Sub3914)
Res34317 = keras.layers.Reshape((2, 8), name = 'Res34317', )(Res51435)
Glo30997 = keras.layers.GlobalMaxPool1D(name = 'Glo30997', )(Res34317)
model = tf.keras.models.Model(inputs=[in0Sub3914,in1Sub3914], outputs=Glo30997)
in0Sub3914 = tf.constant([[[[[0.8301, 0.3782], [0.4376, 0.5501]], [[0.7315, 0.9106], [0.134, 0.4029]]], [[[0.3324, 0.062], [0.9638, 0.2188]], [[0.741, 0.6331], [0.9581, 0.4208]]]]])
in1Sub3914 = tf.constant([[[[[0.839, 0.5066], [0.9052, 0.075]], [[0.2633, 0.0971], [0.3625, 0.6254]]], [[[0.5931, 0.8117], [0.8899, 0.8331]], [[0.9393, 0.3857], [0.3626, 0.6058]]]]])
print (np.array2string(model.predict([in0Sub3914,in1Sub3914],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo30997.png')

LSub3914 = subtract_layer([[[[[0.8301, 0.3782], [0.4376, 0.5501]], [[0.7315, 0.9106], [0.134, 0.4029]]], [[[0.3324, 0.062], [0.9638, 0.2188]], [[0.741, 0.6331], [0.9581, 0.4208]]]]], [[[[[0.839, 0.5066], [0.9052, 0.075]], [[0.2633, 0.0971], [0.3625, 0.6254]]], [[[0.5931, 0.8117], [0.8899, 0.8331]], [[0.9393, 0.3857], [0.3626, 0.6058]]]]], Sub3914), 
LRes51435 = reshape_layer(Sub3914, [2, 2, 4], Res51435), 
LRes34317 = reshape_layer(Res51435, [2, 8], Res34317), 
LGlo30997 = global_max_pool1D_layer(Res34317, Glo30997), 
exec_layers([LSub3914,LRes51435,LRes34317,LGlo30997],["Sub3914","Res51435","Res34317","Glo30997"],Glo30997,"Glo30997")

Actual (Unparsed): [[-0.0089000, -0.1284000, 0.0739000, 0.4751000, 0.4682000, 0.8135000, 0.5955000, -0.1850000]]

Expected (Unparsed): [[-0.008900000000000019,-0.12840000000000007,0.07389999999999997,0.4751,0.46820000000000006,0.8135,0.5954999999999999,-0.185]]

Actual:   [[-0.0089, -0.1284, 0.0739, 0.4751, 0.4682, 0.8135, 0.5955, -0.185]]

Expected: [[-0.0089, -0.1284, 0.0739, 0.4751, 0.4683, 0.8135, 0.5955, -0.185]]