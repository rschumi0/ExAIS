import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub79536 = tf.keras.layers.Input(shape=([2, 2, 3]))
in1Sub79536 = tf.keras.layers.Input(shape=([2, 2, 3]))

Sub79536 = keras.layers.Subtract(name = 'Sub79536', )([in0Sub79536,in1Sub79536])
Res96490 = keras.layers.Reshape((2, 6), name = 'Res96490', )(Sub79536)
Per82025 = keras.layers.Permute((1,2), name = 'Per82025',)(Res96490)
Den3904 = keras.layers.Dense(2,name = 'Den3904', )(Per82025)
model = tf.keras.models.Model(inputs=[in0Sub79536,in1Sub79536], outputs=Den3904)
w = model.get_layer('Den3904').get_weights() 
w[0] = np.array([[0.3282, 0.3335], [0.5997, 0.5441], [0.1581, 0.2057], [0.6568, 0.0901], [0.3574, 0.2497], [0.9065, 0.9286]])
w[1] = np.array([0.8326, 0.7199])
model.get_layer('Den3904').set_weights(w) 
in0Sub79536 = tf.constant([[[[0.0841, 0.115, 0.2813], [0.5595, 0.257, 0.7103]], [[0.7991, 0.9037, 0.4503], [0.2998, 0.3517, 0.6519]]]])
in1Sub79536 = tf.constant([[[[0.3426, 0.1978, 0.9602], [0.0977, 0.8261, 0.1771]], [[0.5823, 0.6128, 0.3436], [0.4555, 0.7302, 0.2873]]]])
print (np.array2string(model.predict([in0Sub79536,in1Sub79536],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den3904.png')

LSub79536 = subtract_layer([[[[0.0841, 0.115, 0.2813], [0.5595, 0.257, 0.7103]], [[0.7991, 0.9037, 0.4503], [0.2998, 0.3517, 0.6519]]]], [[[[0.3426, 0.1978, 0.9602], [0.0977, 0.8261, 0.1771]], [[0.5823, 0.6128, 0.3436], [0.4555, 0.7302, 0.2873]]]], Sub79536), 
LRes96490 = reshape_layer(Sub79536, [2, 6], Res96490), 
LPer82025 = permute_layer(Res96490, 1,2, Per82025), 
LDen3904 = dense_layer(Per82025, [[0.3282, 0.3335], [0.5997, 0.5441], [0.1581, 0.2057], [0.6568, 0.0901], [0.3574, 0.2497], [0.9065, 0.9286]],[0.8326, 0.7199], Den3904), 
exec_layers([LSub79536,LRes96490,LPer82025,LDen3904],["Sub79536","Res96490","Per82025","Den3904"],Den3904,"Den3904")

Actual (Unparsed): [[[1.1740308, 0.8436225], [1.1880460, 1.2024572]]]

Expected (Unparsed): [[[1.17403075,0.8436224699999999],[1.188046,1.20245722]]]

Actual:   [[[1.1741, 0.8437], [1.1881, 1.2025]]]

Expected: [[[1.1741, 0.8437], [1.1881, 1.2025]]]