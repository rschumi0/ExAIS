import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con60894 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con30159 = tf.keras.layers.Input(shape=([2, 1, 6, 1]))
in0ReL5533 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Con60894 = keras.layers.Conv2D(4, (2, 2),strides=(1, 12), padding='valid', dilation_rate=(1, 1), name = 'Con60894', )(in0Con60894)
Res94776 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res94776', )(Con60894)
Zer69310 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (2, 0)), name = 'Zer69310', )(Res94776)
Con30159 = keras.layers.Concatenate(axis=4, name = 'Con30159', )([Zer69310,in0Con30159])
ReL5533 = keras.layers.ReLU(max_value=6.640520171974507, negative_slope=2.869484410757934, threshold=4.890374671618835, name = 'ReL5533', input_shape=(2, 1, 2, 2))(in0ReL5533)
Zer58470 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (4, 0)), name = 'Zer58470', )(ReL5533)
Min97230 = keras.layers.Minimum(name = 'Min97230', )([Con30159,Zer58470])
Res87564 = keras.layers.Reshape((2, 1, 12), name = 'Res87564', )(Min97230)
Res79517 = keras.layers.Reshape((2, 12), name = 'Res79517', )(Res87564)
Per20758 = keras.layers.Permute((1,2), name = 'Per20758',)(Res79517)
Res27701 = keras.layers.Reshape((2, 12, 1), name = 'Res27701', )(Per20758)
Res28500 = keras.layers.Reshape((2, 12, 1, 1), name = 'Res28500', )(Res27701)
Glo11172 = keras.layers.GlobalAveragePooling3D(name = 'Glo11172', )(Res28500)
model = tf.keras.models.Model(inputs=[in0Con60894,in0Con30159,in0ReL5533], outputs=Glo11172)
w = model.get_layer('Con60894').get_weights() 
w[0] = np.array([[[[0.9095, 0.587, 0.9474, 0.8376]], [[0.8976, 0.1518, 0.5247, 0.0195]]], [[[0.7475, 0.6288, 0.2632, 0.1893]], [[0.4047, 0.2678, 0.2091, 0.2212]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con60894').set_weights(w) 
in0Con60894 = tf.constant([[[[0.8903], [0.4889]], [[0.6963], [0.9772]]]])
in0Con30159 = tf.constant([[[[[0.6802], [0.7914], [0.1571], [0.6531], [0.8604], [0.6758]]], [[[0.3173], [0.5383], [0.9709], [0.4809], [0.8019], [0.9167]]]]])
in0ReL5533 = tf.constant([[[[[0.5568, 0.8169], [0.301, 0.4552]]], [[[0.7955, 0.2635], [0.4628, 0.1741]]]]])
print (np.array2string(model.predict([in0Con60894,in0Con30159,in0ReL5533],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo11172.png')

LCon60894 = conv2D_layer([[[[0.8903], [0.4889]], [[0.6963], [0.9772]]]], 2, 2,[[[[0.9095, 0.587, 0.9474, 0.8376]], [[0.8976, 0.1518, 0.5247, 0.0195]]], [[[0.7475, 0.6288, 0.2632, 0.1893]], [[0.4047, 0.2678, 0.2091, 0.2212]]]],[0, 0, 0, 0], 1, 12, false, 1, 1, Con60894), 
LRes94776 = reshape_layer(Con60894, [1, 1, 4, 1], Res94776), 
LZer69310 = zero_padding3D_layer(Res94776, 1, 0, 0, 0, 2, 0, Zer69310), 
LCon30159 = concatenate_layer([Zer69310,[[[[[0.6802], [0.7914], [0.1571], [0.6531], [0.8604], [0.6758]]], [[[0.3173], [0.5383], [0.9709], [0.4809], [0.8019], [0.9167]]]]]], 4, Con30159), 
LReL5533 = relu_layer([[[[[0.5568, 0.8169], [0.301, 0.4552]]], [[[0.7955, 0.2635], [0.4628, 0.1741]]]]], 6.640520171974507, 2.869484410757934, 4.890374671618835, ReL5533), 
LZer58470 = zero_padding3D_layer(ReL5533, 0, 0, 0, 0, 4, 0, Zer58470), 
LMin97230 = minimum_layer([Con30159,Zer58470], Min97230), 
LRes87564 = reshape_layer(Min97230, [2, 1, 12], Res87564), 
LRes79517 = reshape_layer(Res87564, [2, 12], Res79517), 
LPer20758 = permute_layer(Res79517, 1,2, Per20758), 
LRes27701 = reshape_layer(Per20758, [2, 12, 1], Res27701), 
LRes28500 = reshape_layer(Res27701, [2, 12, 1, 1], Res28500), 
LGlo11172 = global_average_pooling3D_layer(Res28500, Glo11172), 
exec_layers([LCon60894,LRes94776,LZer69310,LCon30159,LReL5533,LZer58470,LMin97230,LRes87564,LRes79517,LPer20758,LRes27701,LRes28500,LGlo11172],["Con60894","Res94776","Zer69310","Con30159","ReL5533","Zer58470","Min97230","Res87564","Res79517","Per20758","Res27701","Res28500","Glo11172"],Glo11172,"Glo11172")

Actual (Unparsed): [[-4.2201982]]

Expected (Unparsed): [[-4.220198233546994]]

Actual:   [[-4.2201]]

Expected: [[-4.2201]]