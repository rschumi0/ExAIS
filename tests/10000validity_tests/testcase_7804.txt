import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave14449 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave14449 = tf.keras.layers.Input(shape=([2, 1]))
in0Dep4807 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Ave1413 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave1413 = tf.keras.layers.Input(shape=([2, 1]))
in0Min14080 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min14080 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Min30201 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min30201 = tf.keras.layers.Input(shape=([1, 1, 1]))

Ave14449 = keras.layers.Average(name = 'Ave14449', )([in0Ave14449,in1Ave14449])
Res7788 = keras.layers.Reshape((2, 1, 1), name = 'Res7788', )(Ave14449)
Zer25732 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer25732', )(Res7788)
Dep4807 = keras.layers.DepthwiseConv2D((2, 1),strides=(2, 2), padding='same', name = 'Dep4807', )(in0Dep4807)
Res99978 = keras.layers.Reshape((1, 1), name = 'Res99978', )(Dep4807)
Zer34342 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer34342', )(Res99978)
Ave1413 = keras.layers.Average(name = 'Ave1413', )([in0Ave1413,in1Ave1413])
Mul48061 = keras.layers.Multiply(name = 'Mul48061', )([Zer34342,Ave1413])
Res39354 = keras.layers.Reshape((2, 1, 1), name = 'Res39354', )(Mul48061)
Zer54340 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer54340', )(Res39354)
Min14080 = keras.layers.Minimum(name = 'Min14080', )([in0Min14080,in1Min14080])
Zer83294 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer83294', )(Min14080)
Min80517 = keras.layers.Minimum(name = 'Min80517', )([Zer54340,Zer83294])
Add64675 = keras.layers.Add(name = 'Add64675', )([Zer25732,Min80517])
Min30201 = keras.layers.Minimum(name = 'Min30201', )([in0Min30201,in1Min30201])
Zer76826 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer76826', )(Min30201)
Ave40876 = keras.layers.Average(name = 'Ave40876', )([Add64675,Zer76826])
model = tf.keras.models.Model(inputs=[in0Ave14449,in1Ave14449,in0Dep4807,in0Ave1413,in1Ave1413,in0Min14080,in1Min14080,in0Min30201,in1Min30201], outputs=Ave40876)
w = model.get_layer('Dep4807').get_weights() 
w[0] = np.array([[[[0.8786]]], [[[0.1256]]]])
w[1] = np.array([0])
model.get_layer('Dep4807').set_weights(w) 
in0Ave14449 = tf.constant([[[0.9365], [0.5224]]])
in1Ave14449 = tf.constant([[[0.949], [0.7022]]])
in0Dep4807 = tf.constant([[[[0.0108]], [[0.2639]]]])
in0Ave1413 = tf.constant([[[0.2456], [0.0677]]])
in1Ave1413 = tf.constant([[[0.229], [0.0982]]])
in0Min14080 = tf.constant([[[[0.561], [0.5759]]]])
in1Min14080 = tf.constant([[[[0.7423], [0.4997]]]])
in0Min30201 = tf.constant([[[[0.7676]]]])
in1Min30201 = tf.constant([[[[0.8328]]]])
print (np.array2string(model.predict([in0Ave14449,in1Ave14449,in0Dep4807,in0Ave1413,in1Ave1413,in0Min14080,in1Min14080,in0Min30201,in1Min30201],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave40876.png')

LAve14449 = average_layer([[[[0.9365], [0.5224]]], [[[0.949], [0.7022]]]], Ave14449), 
LRes7788 = reshape_layer(Ave14449, [2, 1, 1], Res7788), 
LZer25732 = zero_padding2D_layer(Res7788, 0, 0, 2, 0, Zer25732), 
LDep4807 = depthwise_conv2D_layer([[[[0.0108]], [[0.2639]]]], 2, 1,[[[[0.8786]]], [[[0.1256]]]],[0], 2, 2, true, Dep4807), 
LRes99978 = reshape_layer(Dep4807, [1, 1], Res99978), 
LZer34342 = zero_padding1D_layer(Res99978, 1, 0, Zer34342), 
LAve1413 = average_layer([[[[0.2456], [0.0677]]], [[[0.229], [0.0982]]]], Ave1413), 
LMul48061 = multiply_layer([Zer34342,Ave1413], Mul48061), 
LRes39354 = reshape_layer(Mul48061, [2, 1, 1], Res39354), 
LZer54340 = zero_padding2D_layer(Res39354, 0, 0, 2, 0, Zer54340), 
LMin14080 = minimum_layer([[[[[0.561], [0.5759]]]], [[[[0.7423], [0.4997]]]]], Min14080), 
LZer83294 = zero_padding2D_layer(Min14080, 1, 0, 1, 0, Zer83294), 
LMin80517 = minimum_layer([Zer54340,Zer83294], Min80517), 
LAdd64675 = add_layer([Zer25732,Min80517], Add64675), 
LMin30201 = minimum_layer([[[[[0.7676]]]], [[[[0.8328]]]]], Min30201), 
LZer76826 = zero_padding2D_layer(Min30201, 1, 0, 2, 0, Zer76826), 
LAve40876 = average_layer([Add64675,Zer76826], Ave40876), 
exec_layers([LAve14449,LRes7788,LZer25732,LDep4807,LRes99978,LZer34342,LAve1413,LMul48061,LRes39354,LZer54340,LMin14080,LZer83294,LMin80517,LAdd64675,LMin30201,LZer76826,LAve40876],["Ave14449","Res7788","Zer25732","Dep4807","Res99978","Zer34342","Ave1413","Mul48061","Res39354","Zer54340","Min14080","Zer83294","Min80517","Add64675","Min30201","Zer76826","Ave40876"],Ave40876,"Ave40876")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.4713750]], [[0.0000000], [0.0000000], [0.6917183]]]]

Expected (Unparsed): [[[[0],[0],[0.471375]],[[0],[0],[0.691718275012]]]]

Actual:   [[[[0], [0], [0.4714]], [[0], [0], [0.6918]]]]

Expected: [[[[0], [0], [0.4714]], [[0], [0], [0.6918]]]]