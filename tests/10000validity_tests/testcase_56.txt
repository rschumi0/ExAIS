import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max5891 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Max5891 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Min61590 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min61590 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Max5891 = keras.layers.Maximum(name = 'Max5891', )([in0Max5891,in1Max5891])
Lea19025 = keras.layers.LeakyReLU(alpha=7.331804688680815, name = 'Lea19025', )(Max5891)
Min61590 = keras.layers.Minimum(name = 'Min61590', )([in0Min61590,in1Min61590])
Zer51014 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer51014', )(Min61590)
Sub13526 = keras.layers.Subtract(name = 'Sub13526', )([Lea19025,Zer51014])
model = tf.keras.models.Model(inputs=[in0Max5891,in1Max5891,in0Min61590,in1Min61590], outputs=Sub13526)
in0Max5891 = tf.constant([[[[[0.3672], [0.5718]], [[0.8625], [0.3903]]], [[[0.1575], [0.7396]], [[0.0008], [0.1646]]]]])
in1Max5891 = tf.constant([[[[[0.6329], [0.4155]], [[0.0481], [0.0575]]], [[[0.9542], [0.335]], [[0.0152], [0.1135]]]]])
in0Min61590 = tf.constant([[[[[0.9818], [0.1951]], [[0.8999], [0.5778]]]]])
in1Min61590 = tf.constant([[[[[0.4841], [0.615]], [[0.1272], [0.3999]]]]])
print (np.array2string(model.predict([in0Max5891,in1Max5891,in0Min61590,in1Min61590],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub13526.png')

LMax5891 = maximum_layer([[[[[[0.3672], [0.5718]], [[0.8625], [0.3903]]], [[[0.1575], [0.7396]], [[0.0008], [0.1646]]]]], [[[[[0.6329], [0.4155]], [[0.0481], [0.0575]]], [[[0.9542], [0.335]], [[0.0152], [0.1135]]]]]], Max5891), 
LLea19025 = leaky_relu_layer(Max5891, 7.331804688680815, Lea19025), 
LMin61590 = minimum_layer([[[[[[0.9818], [0.1951]], [[0.8999], [0.5778]]]]], [[[[[0.4841], [0.615]], [[0.1272], [0.3999]]]]]], Min61590), 
LZer51014 = zero_padding3D_layer(Min61590, 1, 0, 0, 0, 0, 0, Zer51014), 
LSub13526 = subtract_layer(Lea19025,Zer51014, Sub13526), 
exec_layers([LMax5891,LLea19025,LMin61590,LZer51014,LSub13526],["Max5891","Lea19025","Min61590","Zer51014","Sub13526"],Sub13526,"Sub13526")

Actual (Unparsed): [[[[[0.6329000], [0.5718000]], [[0.8625000], [0.3903000]]], [[[0.4701000], [0.5445000]], [[-0.1120000], [-0.2353000]]]]]

Expected (Unparsed): [[[[[0.6329],[0.5718]],[[0.8625],[0.3903]]],[[[0.4701000000000001],[0.5445]],[[-0.112],[-0.23529999999999998]]]]]

Actual:   [[[[[0.6329], [0.5718]], [[0.8625], [0.3903]]], [[[0.4701], [0.5445]], [[-0.112], [-0.2353]]]]]

Expected: [[[[[0.6329], [0.5718]], [[0.8625], [0.3903]]], [[[0.4702], [0.5445]], [[-0.112], [-0.2352]]]]]