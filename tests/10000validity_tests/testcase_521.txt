import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add36755 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Add36755 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Add36755 = keras.layers.Add(name = 'Add36755', )([in0Add36755,in1Add36755])
Res42804 = keras.layers.Reshape((2, 1, 2), name = 'Res42804', )(Add36755)
Cro33817 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro33817', )(Res42804)
Con97530 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con97530', )(Cro33817)
Thr47893 = keras.layers.ThresholdedReLU(theta=4.925302998695623, name = 'Thr47893', )(Con97530)
model = tf.keras.models.Model(inputs=[in0Add36755,in1Add36755], outputs=Thr47893)
w = model.get_layer('Con97530').get_weights() 
w[0] = np.array([[[[0.1043, 0.782, 0.8699, 0.4558], [0.6444, 0.7475, 0.1006, 0.3562]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con97530').set_weights(w) 
in0Add36755 = tf.constant([[[[[0.1287], [0.3776]]], [[[0.1822], [0.3892]]]]])
in1Add36755 = tf.constant([[[[[0.5264], [0.3432]]], [[[0.4068], [0.9609]]]]])
print (np.array2string(model.predict([in0Add36755,in1Add36755],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr47893.png')

LAdd36755 = add_layer([[[[[[0.1287], [0.3776]]], [[[0.1822], [0.3892]]]]], [[[[[0.5264], [0.3432]]], [[[0.4068], [0.9609]]]]]], Add36755), 
LRes42804 = reshape_layer(Add36755, [2, 1, 2], Res42804), 
LCro33817 = cropping2D_layer(Res42804, 1, 0, 0, 0, Cro33817), 
LCon97530 = conv2D_layer(Cro33817, 1, 1,[[[[0.1043, 0.782, 0.8699, 0.4558], [0.6444, 0.7475, 0.1006, 0.3562]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con97530), 
LThr47893 = thresholded_relu_layer(Con97530, 4.925302998695623, Thr47893), 
exec_layers([LAdd36755,LRes42804,LCro33817,LCon97530,LThr47893],["Add36755","Res42804","Cro33817","Con97530","Thr47893"],Thr47893,"Thr47893")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0,0]]]]

Actual:   [[[[0, 0, 0, 0]]]]

Expected: [[[[0, 0, 0, 0]]]]