import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con56541 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Ave45906 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave45906 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con3080 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave96699 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave96699 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Ave76178 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave76178 = tf.keras.layers.Input(shape=([1, 1]))
in0Con35521 = tf.keras.layers.Input(shape=([2, 3]))

Con56541 = keras.layers.Conv2DTranspose(2, (1, 1),strides=(1, 1), padding='valid', name = 'Con56541', )(in0Con56541)
Zer11131 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer11131', )(Con56541)
Ave45906 = keras.layers.Average(name = 'Ave45906', )([in0Ave45906,in1Ave45906])
Con3080 = keras.layers.Concatenate(axis=3, name = 'Con3080', )([Ave45906,in0Con3080])
Mul24057 = keras.layers.Multiply(name = 'Mul24057', )([Zer11131,Con3080])
Res70159 = keras.layers.Reshape((2, 4), name = 'Res70159', )(Mul24057)
Ave96699 = keras.layers.Average(name = 'Ave96699', )([in0Ave96699,in1Ave96699])
Res72076 = keras.layers.Reshape((2, 1), name = 'Res72076', )(Ave96699)
Ave76178 = keras.layers.Average(name = 'Ave76178', )([in0Ave76178,in1Ave76178])
Bat62830 = keras.layers.BatchNormalization(axis=2, epsilon=0.5898365012003468,  name = 'Bat62830', )(Ave76178)
Bat50175 = keras.layers.BatchNormalization(axis=1, epsilon=0.17777490915892857,  name = 'Bat50175', )(Bat62830)
Zer30948 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer30948', )(Bat50175)
Dot75179 = keras.layers.Dot(axes=(1, 1), name = 'Dot75179', )([Res72076,Zer30948])
Zer33409 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer33409', )(Dot75179)
Con35521 = keras.layers.Concatenate(axis=2, name = 'Con35521', )([Zer33409,in0Con35521])
Max70677 = keras.layers.Maximum(name = 'Max70677', )([Res70159,Con35521])
model = tf.keras.models.Model(inputs=[in0Con56541,in0Ave45906,in1Ave45906,in0Con3080,in0Ave96699,in1Ave96699,in0Ave76178,in1Ave76178,in0Con35521], outputs=Max70677)
w = model.get_layer('Con56541').get_weights() 
w[0] = np.array([[[[0.3236], [0.482]]]])
w[1] = np.array([0, 0])
model.get_layer('Con56541').set_weights(w) 
w = model.get_layer('Bat62830').get_weights() 
w[0] = np.array([0.6123])
w[1] = np.array([0.9153])
w[2] = np.array([0.6769])
w[3] = np.array([0.8952])
model.get_layer('Bat62830').set_weights(w) 
w = model.get_layer('Bat50175').get_weights() 
w[0] = np.array([0.1539])
w[1] = np.array([0.6061])
w[2] = np.array([0.4099])
w[3] = np.array([0.5025])
model.get_layer('Bat50175').set_weights(w) 
in0Con56541 = tf.constant([[[[0.1937]]]])
in0Ave45906 = tf.constant([[[[0.6773], [0.7666]], [[0.9962], [0.5807]]]])
in1Ave45906 = tf.constant([[[[0.5613], [0.3249]], [[0.7366], [0.9476]]]])
in0Con3080 = tf.constant([[[[0.5284], [0.8734]], [[0.0397], [0.4]]]])
in0Ave96699 = tf.constant([[[[0.4015]], [[0.6965]]]])
in1Ave96699 = tf.constant([[[[0.5973]], [[0.5226]]]])
in0Ave76178 = tf.constant([[[0.3042]]])
in1Ave76178 = tf.constant([[[0.2391]]])
in0Con35521 = tf.constant([[[0.8944, 0.6478, 0.3696], [0.8509, 0.3463, 0.543]]])
print (np.array2string(model.predict([in0Con56541,in0Ave45906,in1Ave45906,in0Con3080,in0Ave96699,in1Ave96699,in0Ave76178,in1Ave76178,in0Con35521],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max70677.png')

LCon56541 = conv2D_transpose_layer([[[[0.1937]]]], 1, 1,[[[[0.3236], [0.482]]]],[0, 0], 1, 1, false, Con56541), 
LZer11131 = zero_padding2D_layer(Con56541, 1, 0, 1, 0, Zer11131), 
LAve45906 = average_layer([[[[[0.6773], [0.7666]], [[0.9962], [0.5807]]]], [[[[0.5613], [0.3249]], [[0.7366], [0.9476]]]]], Ave45906), 
LCon3080 = concatenate_layer([Ave45906,[[[[0.5284], [0.8734]], [[0.0397], [0.4]]]]], 3, Con3080), 
LMul24057 = multiply_layer([Zer11131,Con3080], Mul24057), 
LRes70159 = reshape_layer(Mul24057, [2, 4], Res70159), 
LAve96699 = average_layer([[[[[0.4015]], [[0.6965]]]], [[[[0.5973]], [[0.5226]]]]], Ave96699), 
LRes72076 = reshape_layer(Ave96699, [2, 1], Res72076), 
LAve76178 = average_layer([[[[0.3042]]], [[[0.2391]]]], Ave76178), 
LBat62830 = batch_normalization_layer(Ave76178, 2, 0.5898365012003468, [0.6123], [0.9153], [0.6769], [0.8952], Bat62830), 
LBat50175 = batch_normalization_layer(Bat62830, 1, 0.17777490915892857, [0.1539], [0.6061], [0.4099], [0.5025], Bat50175), 
LZer30948 = zero_padding1D_layer(Bat50175, 1, 0, Zer30948), 
LDot75179 = dot_layer(Res72076,Zer30948, 1, 1, Dot75179), 
LZer33409 = zero_padding1D_layer(Dot75179, 1, 0, Zer33409), 
LCon35521 = concatenate_layer([Zer33409,[[[0.8944, 0.6478, 0.3696], [0.8509, 0.3463, 0.543]]]], 2, Con35521), 
LMax70677 = maximum_layer([Res70159,Con35521], Max70677), 
exec_layers([LCon56541,LZer11131,LAve45906,LCon3080,LMul24057,LRes70159,LAve96699,LRes72076,LAve76178,LBat62830,LBat50175,LZer30948,LDot75179,LZer33409,LCon35521,LMax70677],["Con56541","Zer11131","Ave45906","Con3080","Mul24057","Res70159","Ave96699","Res72076","Ave76178","Bat62830","Bat50175","Zer30948","Dot75179","Zer33409","Con35521","Max70677"],Max70677,"Max70677")

Actual (Unparsed): [[[0.0000000, 0.8944000, 0.6478000, 0.3696000], [0.4037722, 0.8509000, 0.3463000, 0.5430000]]]

Expected (Unparsed): [[[0.0,0.8944,0.6478,0.3696],[0.40377221126063073,0.8509,0.3463,0.543]]]

Actual:   [[[0, 0.8944, 0.6478, 0.3696], [0.4038, 0.8509, 0.3463, 0.543]]]

Expected: [[[0, 0.8944, 0.6478, 0.3696], [0.4038, 0.8509, 0.3463, 0.543]]]