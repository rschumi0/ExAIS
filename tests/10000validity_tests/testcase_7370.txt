import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot65161 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot65161 = tf.keras.layers.Input(shape=([2, 3]))

Dot65161 = keras.layers.Dot(axes=(1, 1), name = 'Dot65161', )([in0Dot65161,in1Dot65161])
Res80604 = keras.layers.Reshape((3, 3, 1), name = 'Res80604', )(Dot65161)
Res12647 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res12647', )(Res80604)
Con69798 = keras.layers.Conv3D(4, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con69798', )(Res12647)
Res71220 = keras.layers.Reshape((3, 3, 4), name = 'Res71220', )(Con69798)
Con9379 = keras.layers.Conv2D(3, (2, 3),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con9379', )(Res71220)
Res27746 = keras.layers.Reshape((2, 3), name = 'Res27746', )(Con9379)
Sep11146 = keras.layers.SeparableConv1D(2, (1),strides=(2), padding='valid', name = 'Sep11146', )(Res27746)
Loc48986 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc48986', )(Sep11146)
model = tf.keras.models.Model(inputs=[in0Dot65161,in1Dot65161], outputs=Loc48986)
w = model.get_layer('Con69798').get_weights() 
w[0] = np.array([[[[[0.1391, 0.0356, 0.631, 0.9393]]]], [[[[0.1442, 0.0417, 0.3303, 0.4123]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con69798').set_weights(w) 
w = model.get_layer('Con9379').get_weights() 
w[0] = np.array([[[[0.7119, 0.0411, 0.8737], [0.753, 0.7854, 0.1829], [0.5511, 0.2156, 0.2396], [0.1727, 0.369, 0.9525]], [[0.8602, 0.5525, 0.3876], [0.9888, 0.0179, 0.4095], [0.8966, 0.4795, 0.3605], [0.7341, 0.614, 0.5239]], [[0.1408, 0.7885, 0.4893], [0.1966, 0.396, 0.0783], [0.3281, 0.0988, 0.1472], [0.2008, 0.4298, 0.0532]]], [[[0.0259, 0.0528, 0.1782], [0.9202, 0.2476, 0.6266], [0.0583, 0.8968, 0.653], [0.8953, 0.8856, 0.0733]], [[0.6143, 0.0959, 0.1286], [0.4702, 0.9674, 0.0543], [0.0829, 0.2556, 0.7684], [0.0648, 0.3092, 0.3505]], [[0.5993, 0.237, 0.1904], [0.1718, 0.3502, 0.1512], [0.6779, 0.8324, 0.8901], [0.1295, 0.3029, 0.7196]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con9379').set_weights(w) 
w = model.get_layer('Sep11146').get_weights() 
w[0] = np.array([[[0.1032], [0.0123], [0.1279]]])
w[1] = np.array([[[0.0446, 0.7872], [0.5147, 0.4591], [0.847, 0.6605]]])
w[2] = np.array([0, 0])
model.get_layer('Sep11146').set_weights(w) 
w = model.get_layer('Loc48986').get_weights() 
w[0] = np.array([[[0.7884, 0.005], [0.3661, 0.1962]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc48986').set_weights(w) 
in0Dot65161 = tf.constant([[[0.9258, 0.6913, 0.365], [0.1209, 0.331, 0.1053]]])
in1Dot65161 = tf.constant([[[0.3017, 0.6558, 0.0018], [0.5819, 0.5556, 0.3671]]])
print (np.array2string(model.predict([in0Dot65161,in1Dot65161],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc48986.png')

LDot65161 = dot_layer([[[0.9258, 0.6913, 0.365], [0.1209, 0.331, 0.1053]]], [[[0.3017, 0.6558, 0.0018], [0.5819, 0.5556, 0.3671]]], 1, 1, Dot65161), 
LRes80604 = reshape_layer(Dot65161, [3, 3, 1], Res80604), 
LRes12647 = reshape_layer(Res80604, [3, 3, 1, 1], Res12647), 
LCon69798 = conv3D_layer(Res12647, 2, 1, 1,[[[[[0.1391, 0.0356, 0.631, 0.9393]]]], [[[[0.1442, 0.0417, 0.3303, 0.4123]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con69798), 
LRes71220 = reshape_layer(Con69798, [3, 3, 4], Res71220), 
LCon9379 = conv2D_layer(Res71220, 2, 3,[[[[0.7119, 0.0411, 0.8737], [0.753, 0.7854, 0.1829], [0.5511, 0.2156, 0.2396], [0.1727, 0.369, 0.9525]], [[0.8602, 0.5525, 0.3876], [0.9888, 0.0179, 0.4095], [0.8966, 0.4795, 0.3605], [0.7341, 0.614, 0.5239]], [[0.1408, 0.7885, 0.4893], [0.1966, 0.396, 0.0783], [0.3281, 0.0988, 0.1472], [0.2008, 0.4298, 0.0532]]], [[[0.0259, 0.0528, 0.1782], [0.9202, 0.2476, 0.6266], [0.0583, 0.8968, 0.653], [0.8953, 0.8856, 0.0733]], [[0.6143, 0.0959, 0.1286], [0.4702, 0.9674, 0.0543], [0.0829, 0.2556, 0.7684], [0.0648, 0.3092, 0.3505]], [[0.5993, 0.237, 0.1904], [0.1718, 0.3502, 0.1512], [0.6779, 0.8324, 0.8901], [0.1295, 0.3029, 0.7196]]]],[0, 0, 0], 1, 1, false, 1, 1, Con9379), 
LRes27746 = reshape_layer(Con9379, [2, 3], Res27746), 
LSep11146 = separable_conv1D_layer(Res27746, 1,[[[[0.1032], [0.0123], [0.1279]]],[[[0.0446, 0.7872], [0.5147, 0.4591], [0.847, 0.6605]]]],[0, 0], 2, false, Sep11146), 
LLoc48986 = locally_connected1D_layer(Sep11146, 1,[[[0.7884, 0.005], [0.3661, 0.1962]]],[[0, 0]], 1, Loc48986), 
exec_layers([LDot65161,LRes80604,LRes12647,LCon69798,LRes71220,LCon9379,LRes27746,LSep11146,LLoc48986],["Dot65161","Res80604","Res12647","Con69798","Res71220","Con9379","Res27746","Sep11146","Loc48986"],Loc48986,"Loc48986")

Actual (Unparsed): [[[0.4030940, 0.0880868]]]

Expected (Unparsed): [[[0.40309397230899013,0.08808682007357457]]]

Actual:   [[[0.4031, 0.0881]]]

Expected: [[[0.4031, 0.0881]]]