import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep33774 = tf.keras.layers.Input(shape=([2, 2, 1]))

Sep33774 = keras.layers.SeparableConv2D(3, (1, 1),strides=(2, 2), padding='valid', name = 'Sep33774', )(in0Sep33774)
Zer79175 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer79175', )(Sep33774)
Max59608 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(1, 1), padding='valid', name = 'Max59608', )(Zer79175)
Res41146 = keras.layers.Reshape((2, 9), name = 'Res41146', )(Max59608)
Cro94780 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro94780', )(Res41146)
model = tf.keras.models.Model(inputs=[in0Sep33774], outputs=Cro94780)
w = model.get_layer('Sep33774').get_weights() 
w[0] = np.array([[[[0.7412]]]])
w[1] = np.array([[[[0.0488, 0.2435, 0.0667]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep33774').set_weights(w) 
in0Sep33774 = tf.constant([[[[0.5124], [0.2292]], [[0.4297], [0.2832]]]])
print (np.array2string(model.predict([in0Sep33774],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro94780.png')

LSep33774 = separable_conv2D_layer([[[[0.5124], [0.2292]], [[0.4297], [0.2832]]]], 1, 1,[[[[[0.7412]]]],[[[[0.0488, 0.2435, 0.0667]]]]],[0, 0, 0], 2, 2, false, Sep33774), 
LZer79175 = zero_padding2D_layer(Sep33774, 1, 1, 1, 1, Zer79175), 
LMax59608 = max_pool2D_layer(Zer79175, 2, 1, 1, 1, false, Max59608), 
LRes41146 = reshape_layer(Max59608, [2, 9], Res41146), 
LCro94780 = cropping1D_layer(Res41146, 1, 0, Cro94780), 
exec_layers([LSep33774,LZer79175,LMax59608,LRes41146,LCro94780],["Sep33774","Zer79175","Max59608","Res41146","Cro94780"],Cro94780,"Cro94780")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0185338, 0.0924791, 0.0253321, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0.018533794944,0.09247907927999999,0.025332051695999995,0,0,0]]]

Actual:   [[[0, 0, 0, 0.0186, 0.0925, 0.0254, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0.0186, 0.0925, 0.0254, 0, 0, 0]]]