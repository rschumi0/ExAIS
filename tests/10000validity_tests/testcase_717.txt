import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro79555 = tf.keras.layers.Input(shape=([3, 1, 3]))
in0Mul72430 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul72430 = tf.keras.layers.Input(shape=([1, 1]))
in0Con89470 = tf.keras.layers.Input(shape=([1, 1, 2]))

Cro79555 = keras.layers.Cropping2D(cropping=((2, 0), (0, 0)), name = 'Cro79555', )(in0Cro79555)
Mul72430 = keras.layers.Multiply(name = 'Mul72430', )([in0Mul72430,in1Mul72430])
Den44186 = keras.layers.Dense(4,name = 'Den44186', )(Mul72430)
Res94532 = keras.layers.Reshape((1, 4, 1), name = 'Res94532', )(Den44186)
Glo96016 = keras.layers.GlobalMaxPool2D(name = 'Glo96016', )(Res94532)
Res72879 = keras.layers.Reshape((1, 1), name = 'Res72879', )(Glo96016)
Res96322 = keras.layers.Reshape((1, 1, 1), name = 'Res96322', )(Res72879)
Max37644 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Max37644', )(Res96322)
Con89470 = keras.layers.Concatenate(axis=3, name = 'Con89470', )([Max37644,in0Con89470])
Add52992 = keras.layers.Add(name = 'Add52992', )([Cro79555,Con89470])
model = tf.keras.models.Model(inputs=[in0Cro79555,in0Mul72430,in1Mul72430,in0Con89470], outputs=Add52992)
w = model.get_layer('Den44186').get_weights() 
w[0] = np.array([[0.7551, 0.8017, 0.5759, 0.6003]])
w[1] = np.array([0.3032, 0.2985, 0.083, 0.3572])
model.get_layer('Den44186').set_weights(w) 
in0Cro79555 = tf.constant([[[[1.9134, 1.1033, 1.3037]], [[1.8739, 1.2567, 1.7671]], [[1.5165, 1.7787, 1.8125]]]])
in0Mul72430 = tf.constant([[[0.0103]]])
in1Mul72430 = tf.constant([[[0.8463]]])
in0Con89470 = tf.constant([[[[0.3116, 0.0202]]]])
print (np.array2string(model.predict([in0Cro79555,in0Mul72430,in1Mul72430,in0Con89470],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add52992.png')

LCro79555 = cropping2D_layer([[[[1.9134, 1.1033, 1.3037]], [[1.8739, 1.2567, 1.7671]], [[1.5165, 1.7787, 1.8125]]]], 2, 0, 0, 0, Cro79555), 
LMul72430 = multiply_layer([[[[0.0103]]], [[[0.8463]]]], Mul72430), 
LDen44186 = dense_layer(Mul72430, [[0.7551, 0.8017, 0.5759, 0.6003]],[0.3032, 0.2985, 0.083, 0.3572], Den44186), 
LRes94532 = reshape_layer(Den44186, [1, 4, 1], Res94532), 
LGlo96016 = global_max_pool2D_layer(Res94532, Glo96016), 
LRes72879 = reshape_layer(Glo96016, [1, 1], Res72879), 
LRes96322 = reshape_layer(Res72879, [1, 1, 1], Res96322), 
LMax37644 = max_pool2D_layer(Res96322, 1, 1, 1, 1, true, Max37644), 
LCon89470 = concatenate_layer([Max37644,[[[[0.3116, 0.0202]]]]], 3, Con89470), 
LAdd52992 = add_layer([Cro79555,Con89470], Add52992), 
exec_layers([LCro79555,LMul72430,LDen44186,LRes94532,LGlo96016,LRes72879,LRes96322,LMax37644,LCon89470,LAdd52992],["Cro79555","Mul72430","Den44186","Res94532","Glo96016","Res72879","Res96322","Max37644","Con89470","Add52992"],Add52992,"Add52992")

Actual (Unparsed): [[[[1.8789327, 2.0903000, 1.8327000]]]]

Expected (Unparsed): [[[[1.878932749067,2.0903,1.8327]]]]

Actual:   [[[[1.879, 2.0903, 1.8327]]]]

Expected: [[[[1.879, 2.0903, 1.8327]]]]