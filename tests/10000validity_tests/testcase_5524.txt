import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer89552 = tf.keras.layers.Input(shape=([1, 3, 1, 3]))
in0Ave4796 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave4796 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con3728 = tf.keras.layers.Input(shape=([3, 5, 7]))
in0Con74759 = tf.keras.layers.Input(shape=([2, 1]))
in0Max98050 = tf.keras.layers.Input(shape=([2, 2]))
in1Max98050 = tf.keras.layers.Input(shape=([2, 2]))

Zer89552 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer89552', )(in0Zer89552)
Res9106 = keras.layers.Reshape((3, 5, 9), name = 'Res9106', )(Zer89552)
Ave4796 = keras.layers.Average(name = 'Ave4796', )([in0Ave4796,in1Ave4796])
Zer44544 = keras.layers.ZeroPadding2D(padding=((1, 0), (3, 0)), name = 'Zer44544', )(Ave4796)
Con3728 = keras.layers.Concatenate(axis=3, name = 'Con3728', )([Zer44544,in0Con3728])
Max51344 = keras.layers.Maximum(name = 'Max51344', )([Res9106,Con3728])
Res55574 = keras.layers.Reshape((3, 5, 9, 1), name = 'Res55574', )(Max51344)
Glo53029 = keras.layers.GlobalMaxPool3D(name = 'Glo53029', )(Res55574)
Res38596 = keras.layers.Reshape((1, 1), name = 'Res38596', )(Glo53029)
GRU55818 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU55818', )(Res38596)
Res55477 = keras.layers.Reshape((1, 1), name = 'Res55477', )(GRU55818)
Zer30491 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer30491', )(Res55477)
Con74759 = keras.layers.Concatenate(axis=2, name = 'Con74759', )([Zer30491,in0Con74759])
Max98050 = keras.layers.Maximum(name = 'Max98050', )([in0Max98050,in1Max98050])
Ave77881 = keras.layers.Average(name = 'Ave77881', )([Con74759,Max98050])
model = tf.keras.models.Model(inputs=[in0Zer89552,in0Ave4796,in1Ave4796,in0Con3728,in0Con74759,in0Max98050,in1Max98050], outputs=Ave77881)
w = model.get_layer('GRU55818').get_weights() 
w[0] = np.array([[9, 2, 1]])
w[1] = np.array([[7, 8, 7]])
w[2] = np.array([[4, 5, 8], [8, 2, 3]])
model.get_layer('GRU55818').set_weights(w) 
in0Zer89552 = tf.constant([[[[[1.7681, 1.8902, 1.8944]], [[1.7531, 1.8143, 1.2003]], [[1.0442, 1.744, 1.5359]]]]])
in0Ave4796 = tf.constant([[[[0.3456, 0.6226], [0.8725, 0.0005]], [[0.0335, 0.1881], [0.6478, 0.85]]]])
in1Ave4796 = tf.constant([[[[0.2989, 0.2753], [0.462, 0.6551]], [[0.1807, 0.8796], [0.7911, 0.6603]]]])
in0Con3728 = tf.constant([[[[0.9399, 0.6063, 0.5186, 0.8024, 0.2644, 0.6341, 0.5307], [0.9023, 0.244, 0.8447, 0.668, 0.4671, 0.3108, 0.196], [0.9132, 0.2814, 0.3781, 0.0157, 0.9781, 0.3217, 0.9745], [0.0036, 0.7549, 0.5555, 0.9168, 0.9458, 0.1465, 0.9942], [0.8552, 0.5657, 0.9945, 0.7192, 0.2646, 0.5612, 0.6364]], [[0.924, 0.1024, 0.1558, 0.3505, 0.4981, 0.4041, 0.4252], [0.5747, 0.3149, 0.5459, 0.2521, 0.3233, 0.1805, 0.7676], [0.0089, 0.6671, 0.3501, 0.8206, 0.9714, 0.4907, 0.6262], [0.2821, 0.0266, 0.9968, 0.3127, 0.1582, 0.4522, 0.587], [0.7227, 0.8904, 0.4192, 0.8178, 0.5071, 0.7738, 0.3957]], [[0.1021, 0.808, 0.0968, 0.8162, 0.7075, 0.1253, 0.022], [0.22, 0.3901, 0.8293, 0.3398, 0.5598, 0.6908, 0.4535], [0.7487, 0.5363, 0.5254, 0.2576, 0.2421, 0.6216, 0.1995], [0.062, 0.5142, 0.9025, 0.3938, 0.0274, 0.0383, 0.9952], [0.9807, 0.8743, 0.6136, 0.0622, 0.7584, 0.0215, 0.7318]]]])
in0Con74759 = tf.constant([[[0.7347], [0.3524]]])
in0Max98050 = tf.constant([[[0.1893, 0.4121], [0.732, 0.5814]]])
in1Max98050 = tf.constant([[[0.2159, 0.7981], [0.0575, 0.2115]]])
print (np.array2string(model.predict([in0Zer89552,in0Ave4796,in1Ave4796,in0Con3728,in0Con74759,in0Max98050,in1Max98050],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave77881.png')

LZer89552 = zero_padding3D_layer([[[[[1.7681, 1.8902, 1.8944]], [[1.7531, 1.8143, 1.2003]], [[1.0442, 1.744, 1.5359]]]]], 1, 1, 1, 1, 1, 1, Zer89552), 
LRes9106 = reshape_layer(Zer89552, [3, 5, 9], Res9106), 
LAve4796 = average_layer([[[[[0.3456, 0.6226], [0.8725, 0.0005]], [[0.0335, 0.1881], [0.6478, 0.85]]]], [[[[0.2989, 0.2753], [0.462, 0.6551]], [[0.1807, 0.8796], [0.7911, 0.6603]]]]], Ave4796), 
LZer44544 = zero_padding2D_layer(Ave4796, 1, 0, 3, 0, Zer44544), 
LCon3728 = concatenate_layer([Zer44544,[[[[0.9399, 0.6063, 0.5186, 0.8024, 0.2644, 0.6341, 0.5307], [0.9023, 0.244, 0.8447, 0.668, 0.4671, 0.3108, 0.196], [0.9132, 0.2814, 0.3781, 0.0157, 0.9781, 0.3217, 0.9745], [0.0036, 0.7549, 0.5555, 0.9168, 0.9458, 0.1465, 0.9942], [0.8552, 0.5657, 0.9945, 0.7192, 0.2646, 0.5612, 0.6364]], [[0.924, 0.1024, 0.1558, 0.3505, 0.4981, 0.4041, 0.4252], [0.5747, 0.3149, 0.5459, 0.2521, 0.3233, 0.1805, 0.7676], [0.0089, 0.6671, 0.3501, 0.8206, 0.9714, 0.4907, 0.6262], [0.2821, 0.0266, 0.9968, 0.3127, 0.1582, 0.4522, 0.587], [0.7227, 0.8904, 0.4192, 0.8178, 0.5071, 0.7738, 0.3957]], [[0.1021, 0.808, 0.0968, 0.8162, 0.7075, 0.1253, 0.022], [0.22, 0.3901, 0.8293, 0.3398, 0.5598, 0.6908, 0.4535], [0.7487, 0.5363, 0.5254, 0.2576, 0.2421, 0.6216, 0.1995], [0.062, 0.5142, 0.9025, 0.3938, 0.0274, 0.0383, 0.9952], [0.9807, 0.8743, 0.6136, 0.0622, 0.7584, 0.0215, 0.7318]]]]], 3, Con3728), 
LMax51344 = maximum_layer([Res9106,Con3728], Max51344), 
LRes55574 = reshape_layer(Max51344, [3, 5, 9, 1], Res55574), 
LGlo53029 = global_max_pool3D_layer(Res55574, Glo53029), 
LRes38596 = reshape_layer(Glo53029, [1, 1], Res38596), 
LGRU55818 = gru_layer(Res38596,[[9, 2, 1]],[[7, 8, 7]],[[4, 5, 8], [8, 2, 3]], true, GRU55818), 
LRes55477 = reshape_layer(GRU55818, [1, 1], Res55477), 
LZer30491 = zero_padding1D_layer(Res55477, 1, 0, Zer30491), 
LCon74759 = concatenate_layer([Zer30491,[[[0.7347], [0.3524]]]], 2, Con74759), 
LMax98050 = maximum_layer([[[[0.1893, 0.4121], [0.732, 0.5814]]], [[[0.2159, 0.7981], [0.0575, 0.2115]]]], Max98050), 
LAve77881 = average_layer([Con74759,Max98050], Ave77881), 
exec_layers([LZer89552,LRes9106,LAve4796,LZer44544,LCon3728,LMax51344,LRes55574,LGlo53029,LRes38596,LGRU55818,LRes55477,LZer30491,LCon74759,LMax98050,LAve77881],["Zer89552","Res9106","Ave4796","Zer44544","Con3728","Max51344","Res55574","Glo53029","Res38596","GRU55818","Res55477","Zer30491","Con74759","Max98050","Ave77881"],Ave77881,"Ave77881")

Actual (Unparsed): [[[0.1079500, 0.7664000], [0.3660000, 0.4669000]]]

Expected (Unparsed): [[[0.10795,0.7664],[0.366000000000121,0.4669]]]

Actual:   [[[0.108, 0.7664], [0.366, 0.4669]]]

Expected: [[[0.108, 0.7664], [0.3661, 0.4669]]]