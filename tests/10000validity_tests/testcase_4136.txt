import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max56457 = tf.keras.layers.Input(shape=([1, 1]))
in1Max56457 = tf.keras.layers.Input(shape=([1, 1]))

Max56457 = keras.layers.Maximum(name = 'Max56457', )([in0Max56457,in1Max56457])
GRU2135 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU2135', )(Max56457)
model = tf.keras.models.Model(inputs=[in0Max56457,in1Max56457], outputs=GRU2135)
w = model.get_layer('GRU2135').get_weights() 
w[0] = np.array([[10, 2, 1, 9, 8, 2]])
w[1] = np.array([[2, 3, 2, 1, 2, 10], [2, 4, 7, 6, 7, 5]])
w[2] = np.array([[3, 9, 1, 6, 5, 1], [6, 8, 3, 1, 8, 10]])
model.get_layer('GRU2135').set_weights(w) 
in0Max56457 = tf.constant([[[0.5782]]])
in1Max56457 = tf.constant([[[0.6165]]])
print (np.array2string(model.predict([in0Max56457,in1Max56457],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU2135.png')

LMax56457 = maximum_layer([[[[0.5782]]], [[[0.6165]]]], Max56457), 
LGRU2135 = gru_layer(Max56457,[[10, 2, 1, 9, 8, 2]],[[2, 3, 2, 1, 2, 10], [2, 4, 7, 6, 7, 5]],[[3, 9, 1, 6, 5, 1], [6, 8, 3, 1, 8, 10]], true, GRU2135), 
exec_layers([LMax56457,LGRU2135],["Max56457","GRU2135"],GRU2135,"GRU2135")

Actual (Unparsed): [[0.0000003, 0.0000000]]

Expected (Unparsed): [[2.593725842991999e-7,1.2064482856605387e-8]]

Actual:   [[0, 0]]

Expected: [[0, 0]]