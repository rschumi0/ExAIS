import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe56797 = tf.keras.layers.Input(shape=([1, 2, 1]))

PRe56797 = keras.layers.PReLU(name = 'PRe56797', input_shape=(1, 2, 1))(in0PRe56797)
Fla14719 = keras.layers.Flatten(name = 'Fla14719', )(PRe56797)
Res62199 = keras.layers.Reshape((2, 1), name = 'Res62199', )(Fla14719)
Res77702 = keras.layers.Reshape((2, 1, 1), name = 'Res77702', )(Res62199)
Loc45601 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc45601', )(Res77702)
model = tf.keras.models.Model(inputs=[in0PRe56797], outputs=Loc45601)
w = model.get_layer('PRe56797').get_weights() 
w[0] = np.array([[[0.7893], [0.0993]]])
model.get_layer('PRe56797').set_weights(w) 
w = model.get_layer('Loc45601').get_weights() 
w[0] = np.array([[[0.1169, 0.8499, 0.1299]], [[0.516, 0.2628, 0.9486]]])
w[1] = np.array([[[0, 0, 0]], [[0, 0, 0]]])
model.get_layer('Loc45601').set_weights(w) 
in0PRe56797 = tf.constant([[[[0.4017], [0.3382]]]])
print (np.array2string(model.predict([in0PRe56797],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc45601.png')

LPRe56797 = prelu_layer([[[[0.4017], [0.3382]]]], [[[0.7893], [0.0993]]], PRe56797), 
LFla14719 = flatten_layer(PRe56797, Fla14719), 
LRes62199 = reshape_layer(Fla14719, [2, 1], Res62199), 
LRes77702 = reshape_layer(Res62199, [2, 1, 1], Res77702), 
LLoc45601 = locally_connected2D_layer(Res77702, 1, 1,[[[0.1169, 0.8499, 0.1299]], [[0.516, 0.2628, 0.9486]]],[[[0, 0, 0]], [[0, 0, 0]]], 1, 1, Loc45601), 
exec_layers([LPRe56797,LFla14719,LRes62199,LRes77702,LLoc45601],["PRe56797","Fla14719","Res62199","Res77702","Loc45601"],Loc45601,"Loc45601")

Actual (Unparsed): [[[[0.0469587, 0.3414048, 0.0521808]], [[0.1745112, 0.0888790, 0.3208165]]]]

Expected (Unparsed): [[[[0.046958730000000004,0.34140483,0.05218083]],[[0.1745112,0.08887895999999999,0.32081652]]]]

Actual:   [[[[0.047, 0.3415, 0.0522]], [[0.1746, 0.0889, 0.3209]]]]

Expected: [[[[0.047, 0.3415, 0.0522]], [[0.1746, 0.0889, 0.3209]]]]