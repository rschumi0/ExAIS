import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer63012 = tf.keras.layers.Input(shape=([2, 2, 1]))

Zer63012 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer63012', )(in0Zer63012)
ELU85208 = keras.layers.ELU(alpha=-8.459070786676683, name = 'ELU85208', )(Zer63012)
Con20455 = keras.layers.Conv2D(2, (2, 1),strides=(5, 1), padding='valid', dilation_rate=(1, 1), name = 'Con20455', )(ELU85208)
Sof12157 = keras.layers.Softmax(axis=1, name = 'Sof12157', )(Con20455)
model = tf.keras.models.Model(inputs=[in0Zer63012], outputs=Sof12157)
w = model.get_layer('Con20455').get_weights() 
w[0] = np.array([[[[0.2005, 0.4163]]], [[[0.6241, 0.3486]]]])
w[1] = np.array([0, 0])
model.get_layer('Con20455').set_weights(w) 
in0Zer63012 = tf.constant([[[[1.5119], [1.3398]], [[1.3276], [1.563]]]])
print (np.array2string(model.predict([in0Zer63012],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof12157.png')

LZer63012 = zero_padding2D_layer([[[[1.5119], [1.3398]], [[1.3276], [1.563]]]], 1, 1, 1, 1, Zer63012), 
LELU85208 = elu_layer(Zer63012, -8.459070786676683, ELU85208), 
LCon20455 = conv2D_layer(ELU85208, 2, 1,[[[[0.2005, 0.4163]]], [[[0.6241, 0.3486]]]],[0, 0], 5, 1, false, 1, 1, Con20455), 
LSof12157 = softmax_layer(Con20455, 1, Sof12157), 
exec_layers([LZer63012,LELU85208,LCon20455,LSof12157],["Zer63012","ELU85208","Con20455","Sof12157"],Sof12157,"Sof12157")

Actual (Unparsed): [[[[1.0000000, 1.0000000], [1.0000000, 1.0000000], [1.0000000, 1.0000000], [1.0000000, 1.0000000]]]]

Expected (Unparsed): [[[[1.0,1.0],[1.0,1.0],[1.0,1.0],[1.0,1.0]]]]

Actual:   [[[[1, 1], [1, 1], [1, 1], [1, 1]]]]

Expected: [[[[1, 1], [1, 1], [1, 1], [1, 1]]]]