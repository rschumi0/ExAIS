import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max19703 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max19703 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con8456 = tf.keras.layers.Input(shape=([1, 1, 3]))
in0Max36215 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max36215 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Max19703 = keras.layers.Maximum(name = 'Max19703', )([in0Max19703,in1Max19703])
Res71203 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res71203', )(Max19703)
Glo76843 = keras.layers.GlobalAveragePooling3D(name = 'Glo76843', )(Res71203)
Res96675 = keras.layers.Reshape((1, 1), name = 'Res96675', )(Glo76843)
Res36009 = keras.layers.Reshape((1, 1, 1), name = 'Res36009', )(Res96675)
Con8456 = keras.layers.Concatenate(axis=3, name = 'Con8456', )([Res36009,in0Con8456])
Max36215 = keras.layers.Maximum(name = 'Max36215', )([in0Max36215,in1Max36215])
Res97299 = keras.layers.Reshape((2, 2, 2), name = 'Res97299', )(Max36215)
Sep54073 = keras.layers.SeparableConv2D(4, (1, 1),strides=(2, 2), padding='same', name = 'Sep54073', )(Res97299)
Min20877 = keras.layers.Minimum(name = 'Min20877', )([Con8456,Sep54073])
model = tf.keras.models.Model(inputs=[in0Max19703,in1Max19703,in0Con8456,in0Max36215,in1Max36215], outputs=Min20877)
w = model.get_layer('Sep54073').get_weights() 
w[0] = np.array([[[[0.3934], [0.447]]]])
w[1] = np.array([[[[0.7417, 0.8125, 0.3951, 0.9779], [0.7917, 0.5791, 0.1929, 0.5847]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep54073').set_weights(w) 
in0Max19703 = tf.constant([[[[0.8001, 0.6165]]]])
in1Max19703 = tf.constant([[[[0.34, 0.0355]]]])
in0Con8456 = tf.constant([[[[0.6458, 0.1537, 0.0624]]]])
in0Max36215 = tf.constant([[[[[0.2091, 0.7835]], [[0.8373, 0.9868]]], [[[0.171, 0.3889]], [[0.4413, 0.027]]]]])
in1Max36215 = tf.constant([[[[[0.5729, 0.4942]], [[0.3418, 0.792]]], [[[0.3767, 0.204]], [[0.5799, 0.2042]]]]])
print (np.array2string(model.predict([in0Max19703,in1Max19703,in0Con8456,in0Max36215,in1Max36215],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min20877.png')

LMax19703 = maximum_layer([[[[[0.8001, 0.6165]]]], [[[[0.34, 0.0355]]]]], Max19703), 
LRes71203 = reshape_layer(Max19703, [1, 1, 2, 1], Res71203), 
LGlo76843 = global_average_pooling3D_layer(Res71203, Glo76843), 
LRes96675 = reshape_layer(Glo76843, [1, 1], Res96675), 
LRes36009 = reshape_layer(Res96675, [1, 1, 1], Res36009), 
LCon8456 = concatenate_layer([Res36009,[[[[0.6458, 0.1537, 0.0624]]]]], 3, Con8456), 
LMax36215 = maximum_layer([[[[[[0.2091, 0.7835]], [[0.8373, 0.9868]]], [[[0.171, 0.3889]], [[0.4413, 0.027]]]]], [[[[[0.5729, 0.4942]], [[0.3418, 0.792]]], [[[0.3767, 0.204]], [[0.5799, 0.2042]]]]]], Max36215), 
LRes97299 = reshape_layer(Max36215, [2, 2, 2], Res97299), 
LSep54073 = separable_conv2D_layer(Res97299, 1, 1,[[[[[0.3934], [0.447]]]],[[[[0.7417, 0.8125, 0.3951, 0.9779], [0.7917, 0.5791, 0.1929, 0.5847]]]]],[0, 0, 0, 0], 2, 2, true, Sep54073), 
LMin20877 = minimum_layer([Con8456,Sep54073], Min20877), 
exec_layers([LMax19703,LRes71203,LGlo76843,LRes96675,LRes36009,LCon8456,LMax36215,LRes97299,LSep54073,LMin20877],["Max19703","Res71203","Glo76843","Res96675","Res36009","Con8456","Max36215","Res97299","Sep54073","Min20877"],Min20877,"Min20877")

Actual (Unparsed): [[[[0.4444362, 0.3859353, 0.1537000, 0.0624000]]]]

Expected (Unparsed): [[[[0.444436237112,0.3859353317,0.1537,0.0624]]]]

Actual:   [[[[0.4445, 0.386, 0.1537, 0.0624]]]]

Expected: [[[[0.4445, 0.386, 0.1537, 0.0624]]]]