import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot32337 = tf.keras.layers.Input(shape=([2]))
in1Dot32337 = tf.keras.layers.Input(shape=([2]))
in0Con91439 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Max97064 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max97064 = tf.keras.layers.Input(shape=([1, 1, 2]))

Dot32337 = keras.layers.Dot(axes=(1, 1), name = 'Dot32337', )([in0Dot32337,in1Dot32337])
Res27181 = keras.layers.Reshape((1, 1), name = 'Res27181', )(Dot32337)
Res23190 = keras.layers.Reshape((1, 1, 1), name = 'Res23190', )(Res27181)
Con91439 = keras.layers.Concatenate(axis=3, name = 'Con91439', )([Res23190,in0Con91439])
Max97064 = keras.layers.Maximum(name = 'Max97064', )([in0Max97064,in1Max97064])
Max29164 = keras.layers.Maximum(name = 'Max29164', )([Con91439,Max97064])
Glo42070 = keras.layers.GlobalMaxPool2D(name = 'Glo42070', )(Max29164)
Bat6505 = keras.layers.BatchNormalization(axis=1, epsilon=0.8447028294932394,  name = 'Bat6505', )(Glo42070)
Res8846 = keras.layers.Reshape((2, 1), name = 'Res8846', )(Bat6505)
Res83851 = keras.layers.Reshape((2, 1, 1), name = 'Res83851', )(Res8846)
Res16784 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res16784', )(Res83851)
Glo27444 = keras.layers.GlobalMaxPool3D(name = 'Glo27444', )(Res16784)
model = tf.keras.models.Model(inputs=[in0Dot32337,in1Dot32337,in0Con91439,in0Max97064,in1Max97064], outputs=Glo27444)
w = model.get_layer('Bat6505').get_weights() 
w[0] = np.array([0.0139, 0.9769])
w[1] = np.array([0.8155, 0.4798])
w[2] = np.array([0.5641, 0.526])
w[3] = np.array([0.8778, 0.788])
model.get_layer('Bat6505').set_weights(w) 
in0Dot32337 = tf.constant([[0.1694, 0.1364]])
in1Dot32337 = tf.constant([[0.1313, 0.0491]])
in0Con91439 = tf.constant([[[[0.0871]]]])
in0Max97064 = tf.constant([[[[0.4069, 0.2717]]]])
in1Max97064 = tf.constant([[[[0.949, 0.1151]]]])
print (np.array2string(model.predict([in0Dot32337,in1Dot32337,in0Con91439,in0Max97064,in1Max97064],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo27444.png')

LDot32337 = dot_layer([[0.1694, 0.1364]], [[0.1313, 0.0491]], 1, 1, Dot32337), 
LRes27181 = reshape_layer(Dot32337, [1, 1], Res27181), 
LRes23190 = reshape_layer(Res27181, [1, 1, 1], Res23190), 
LCon91439 = concatenate_layer([Res23190,[[[[0.0871]]]]], 3, Con91439), 
LMax97064 = maximum_layer([[[[[0.4069, 0.2717]]]], [[[[0.949, 0.1151]]]]], Max97064), 
LMax29164 = maximum_layer([Con91439,Max97064], Max29164), 
LGlo42070 = global_max_pool2D_layer(Max29164, Glo42070), 
LBat6505 = batch_normalization_layer(Glo42070, 1, 0.8447028294932394, [0.0139, 0.9769], [0.8155, 0.4798], [0.5641, 0.526], [0.8778, 0.788], Bat6505), 
LRes8846 = reshape_layer(Bat6505, [2, 1], Res8846), 
LRes83851 = reshape_layer(Res8846, [2, 1, 1], Res83851), 
LRes16784 = reshape_layer(Res83851, [2, 1, 1, 1], Res16784), 
LGlo27444 = global_max_pool3D_layer(Res16784, Glo27444), 
exec_layers([LDot32337,LRes27181,LRes23190,LCon91439,LMax97064,LMax29164,LGlo42070,LBat6505,LRes8846,LRes83851,LRes16784,LGlo27444],["Dot32337","Res27181","Res23190","Con91439","Max97064","Max29164","Glo42070","Bat6505","Res8846","Res83851","Res16784","Glo27444"],Glo27444,"Glo27444")

Actual (Unparsed): [[0.8195765]]

Expected (Unparsed): [[0.8195764558152105]]

Actual:   [[0.8196]]

Expected: [[0.8196]]