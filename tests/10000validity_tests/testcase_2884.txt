import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul79874 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul79874 = tf.keras.layers.Input(shape=([1, 1]))
in0Con36853 = tf.keras.layers.Input(shape=([11]))
in0Fla40238 = tf.keras.layers.Input(shape=([1, 4, 3]))
in0Ave90427 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave90427 = tf.keras.layers.Input(shape=([1, 2]))
in0Glo37527 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con14145 = tf.keras.layers.Input(shape=([2, 1]))
in0Den8097 = tf.keras.layers.Input(shape=([5, 4, 2]))

Mul79874 = keras.layers.Multiply(name = 'Mul79874', )([in0Mul79874,in1Mul79874])
Fla91001 = keras.layers.Flatten(name = 'Fla91001', )(Mul79874)
Con36853 = keras.layers.Concatenate(axis=1, name = 'Con36853', )([Fla91001,in0Con36853])
Fla40238 = keras.layers.Flatten(name = 'Fla40238', )(in0Fla40238)
Mas24652 = keras.layers.Masking(mask_value=1, name = 'Mas24652', )(Fla40238)
Dot64913 = keras.layers.Dot(axes=(1, 1), name = 'Dot64913', )([Con36853,Mas24652])
Fla94897 = keras.layers.Flatten(name = 'Fla94897', )(Dot64913)
Ave90427 = keras.layers.Average(name = 'Ave90427', )([in0Ave90427,in1Ave90427])
Zer63528 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer63528', )(Ave90427)
Glo37527 = keras.layers.GlobalAveragePooling2D(name = 'Glo37527', )(in0Glo37527)
Res54345 = keras.layers.Reshape((1, 1), name = 'Res54345', )(Glo37527)
Zer92683 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer92683', )(Res54345)
Con14145 = keras.layers.Concatenate(axis=2, name = 'Con14145', )([Zer92683,in0Con14145])
Den8097 = keras.layers.Dense(4,name = 'Den8097', )(in0Den8097)
Res49500 = keras.layers.Reshape((5, 16), name = 'Res49500', )(Den8097)
Loc52208 = keras.layers.LocallyConnected1D(2, (1),strides=(4), name = 'Loc52208', )(Res49500)
Add32773 = keras.layers.Add(name = 'Add32773', )([Con14145,Loc52208])
Sub66230 = keras.layers.Subtract(name = 'Sub66230', )([Zer63528,Add32773])
Res85929 = keras.layers.Reshape((2, 2, 1), name = 'Res85929', )(Sub66230)
Glo4277 = keras.layers.GlobalAveragePooling2D(name = 'Glo4277', )(Res85929)
Dot82863 = keras.layers.Dot(axes=(1, 1), name = 'Dot82863', )([Fla94897,Glo4277])
model = tf.keras.models.Model(inputs=[in0Mul79874,in1Mul79874,in0Con36853,in0Fla40238,in0Ave90427,in1Ave90427,in0Glo37527,in0Con14145,in0Den8097], outputs=Dot82863)
w = model.get_layer('Den8097').get_weights() 
w[0] = np.array([[0.2931, 0.1836, 0.1664, 0.9564], [0.8457, 0.7326, 0.7899, 0.0485]])
w[1] = np.array([0.203, 0.0754, 0.8396, 0.219])
model.get_layer('Den8097').set_weights(w) 
w = model.get_layer('Loc52208').get_weights() 
w[0] = np.array([[[0.3238, 0.6017], [0.2077, 0.4341], [0.1682, 0.7746], [0.2469, 0.3868], [0.3052, 0.3029], [0.977, 0.9351], [0.3187, 0.5291], [0.2847, 0.3057], [0.2793, 0.0905], [0.5137, 0.1968], [0.5778, 0.3611], [0.351, 0.8286], [0.2437, 0.3336], [0.3994, 0.9492], [0.301, 0.2052], [0.6013, 0.7509]], [[0.633, 0.3282], [0.116, 0.1977], [0.0346, 0.1186], [0.4742, 0.834], [0.6145, 0.9783], [0.8311, 0.7443], [0.4773, 0.2765], [0.9262, 0.9739], [0.6622, 0.9658], [0.9172, 0.3786], [0.6453, 0.4578], [0.6034, 0.5724], [0.3215, 0.9754], [0.6769, 0.3678], [0.2757, 0.7135], [0.5504, 0.8639]]])
w[1] = np.array([[0, 0], [0, 0]])
model.get_layer('Loc52208').set_weights(w) 
in0Mul79874 = tf.constant([[[0.7394]]])
in1Mul79874 = tf.constant([[[0.1019]]])
in0Con36853 = tf.constant([[0.0635, 0.3588, 0.4885, 0.032, 0.8764, 0.2171, 0.3558, 0.3672, 0.0431, 0.1223, 0.5884]])
in0Fla40238 = tf.constant([[[[1.5934, 1.3447, 1.3344], [1.362, 1.875, 1.2192], [1.5571, 1.5426, 1.7003], [1.9497, 1.3419, 1.7961]]]])
in0Ave90427 = tf.constant([[[0.5686, 0.2515]]])
in1Ave90427 = tf.constant([[[0.8058, 0.9947]]])
in0Glo37527 = tf.constant([[[[1.9092]], [[1.2347]]]])
in0Con14145 = tf.constant([[[0.9599], [0.3034]]])
in0Den8097 = tf.constant([[[[0.4396, 0.749], [0.2268, 0.3182], [0.2044, 0.422], [0.5543, 0.6393]], [[0.806, 0.6084], [0.6324, 0.1061], [0.4422, 0.1977], [0.3352, 0.1001]], [[0.7424, 0.4516], [0.8655, 0.8451], [0.4537, 0.4913], [0.1553, 0.6318]], [[0.6673, 0.2122], [0.7231, 0.4087], [0.0211, 0.9225], [0.9647, 0.7339]], [[0.3716, 0.9354], [0.4827, 0.7196], [0.8813, 0.9379], [0.5973, 0.3933]]]])
print (np.array2string(model.predict([in0Mul79874,in1Mul79874,in0Con36853,in0Fla40238,in0Ave90427,in1Ave90427,in0Glo37527,in0Con14145,in0Den8097],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot82863.png')

LMul79874 = multiply_layer([[[[0.7394]]], [[[0.1019]]]], Mul79874), 
LFla91001 = flatten_layer(Mul79874, Fla91001), 
LCon36853 = concatenate_layer([Fla91001,[[0.0635, 0.3588, 0.4885, 0.032, 0.8764, 0.2171, 0.3558, 0.3672, 0.0431, 0.1223, 0.5884]]], 1, Con36853), 
LFla40238 = flatten_layer([[[[1.5934, 1.3447, 1.3344], [1.362, 1.875, 1.2192], [1.5571, 1.5426, 1.7003], [1.9497, 1.3419, 1.7961]]]], Fla40238), 
LMas24652 = masking_layer(Fla40238, 1, Mas24652), 
LDot64913 = dot_layer(Con36853,Mas24652, 1, 1, Dot64913), 
LFla94897 = flatten_layer(Dot64913, Fla94897), 
LAve90427 = average_layer([[[[0.5686, 0.2515]]], [[[0.8058, 0.9947]]]], Ave90427), 
LZer63528 = zero_padding1D_layer(Ave90427, 1, 0, Zer63528), 
LGlo37527 = global_average_pooling2D_layer([[[[1.9092]], [[1.2347]]]], Glo37527), 
LRes54345 = reshape_layer(Glo37527, [1, 1], Res54345), 
LZer92683 = zero_padding1D_layer(Res54345, 1, 0, Zer92683), 
LCon14145 = concatenate_layer([Zer92683,[[[0.9599], [0.3034]]]], 2, Con14145), 
LDen8097 = dense_layer([[[[0.4396, 0.749], [0.2268, 0.3182], [0.2044, 0.422], [0.5543, 0.6393]], [[0.806, 0.6084], [0.6324, 0.1061], [0.4422, 0.1977], [0.3352, 0.1001]], [[0.7424, 0.4516], [0.8655, 0.8451], [0.4537, 0.4913], [0.1553, 0.6318]], [[0.6673, 0.2122], [0.7231, 0.4087], [0.0211, 0.9225], [0.9647, 0.7339]], [[0.3716, 0.9354], [0.4827, 0.7196], [0.8813, 0.9379], [0.5973, 0.3933]]]], [[0.2931, 0.1836, 0.1664, 0.9564], [0.8457, 0.7326, 0.7899, 0.0485]],[0.203, 0.0754, 0.8396, 0.219], Den8097), 
LRes49500 = reshape_layer(Den8097, [5, 16], Res49500), 
LLoc52208 = locally_connected1D_layer(Res49500, 1,[[[0.3238, 0.6017], [0.2077, 0.4341], [0.1682, 0.7746], [0.2469, 0.3868], [0.3052, 0.3029], [0.977, 0.9351], [0.3187, 0.5291], [0.2847, 0.3057], [0.2793, 0.0905], [0.5137, 0.1968], [0.5778, 0.3611], [0.351, 0.8286], [0.2437, 0.3336], [0.3994, 0.9492], [0.301, 0.2052], [0.6013, 0.7509]], [[0.633, 0.3282], [0.116, 0.1977], [0.0346, 0.1186], [0.4742, 0.834], [0.6145, 0.9783], [0.8311, 0.7443], [0.4773, 0.2765], [0.9262, 0.9739], [0.6622, 0.9658], [0.9172, 0.3786], [0.6453, 0.4578], [0.6034, 0.5724], [0.3215, 0.9754], [0.6769, 0.3678], [0.2757, 0.7135], [0.5504, 0.8639]]],[[0, 0], [0, 0]], 4, Loc52208), 
LAdd32773 = add_layer([Con14145,Loc52208], Add32773), 
LSub66230 = subtract_layer(Zer63528,Add32773, Sub66230), 
LRes85929 = reshape_layer(Sub66230, [2, 2, 1], Res85929), 
LGlo4277 = global_average_pooling2D_layer(Res85929, Glo4277), 
LDot82863 = dot_layer(Fla94897,Glo4277, 1, 1, Dot82863), 
exec_layers([LMul79874,LFla91001,LCon36853,LFla40238,LMas24652,LDot64913,LFla94897,LAve90427,LZer63528,LGlo37527,LRes54345,LZer92683,LCon14145,LDen8097,LRes49500,LLoc52208,LAdd32773,LSub66230,LRes85929,LGlo4277,LDot82863],["Mul79874","Fla91001","Con36853","Fla40238","Mas24652","Dot64913","Fla94897","Ave90427","Zer63528","Glo37527","Res54345","Zer92683","Con14145","Den8097","Res49500","Loc52208","Add32773","Sub66230","Res85929","Glo4277","Dot82863"],Dot82863,"Dot82863")

Actual (Unparsed): [[-39.7121127]]

Expected (Unparsed): [[-39.712112599734205]]

Actual:   [[-39.7121]]

Expected: [[-39.7121]]