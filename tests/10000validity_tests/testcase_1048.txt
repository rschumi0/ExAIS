import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub42604 = tf.keras.layers.Input(shape=([2]))
in1Sub42604 = tf.keras.layers.Input(shape=([2]))

Sub42604 = keras.layers.Subtract(name = 'Sub42604', )([in0Sub42604,in1Sub42604])
Res95338 = keras.layers.Reshape((2, 1), name = 'Res95338', )(Sub42604)
Res20933 = keras.layers.Reshape((2, 1, 1), name = 'Res20933', )(Res95338)
Res14793 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res14793', )(Res20933)
Glo19219 = keras.layers.GlobalMaxPool3D(name = 'Glo19219', )(Res14793)
Res80699 = keras.layers.Reshape((1, 1), name = 'Res80699', )(Glo19219)
Res42472 = keras.layers.Reshape((1, 1, 1), name = 'Res42472', )(Res80699)
Cro75338 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro75338', )(Res42472)
Con20980 = keras.layers.Conv2D(3, (1, 1),strides=(1, 3), padding='same', dilation_rate=(1, 1), name = 'Con20980', )(Cro75338)
model = tf.keras.models.Model(inputs=[in0Sub42604,in1Sub42604], outputs=Con20980)
w = model.get_layer('Con20980').get_weights() 
w[0] = np.array([[[[0.3328, 0.1607, 0.0147]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con20980').set_weights(w) 
in0Sub42604 = tf.constant([[0.562, 0.477]])
in1Sub42604 = tf.constant([[0.5075, 0.2332]])
print (np.array2string(model.predict([in0Sub42604,in1Sub42604],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con20980.png')

LSub42604 = subtract_layer([[0.562, 0.477]], [[0.5075, 0.2332]], Sub42604), 
LRes95338 = reshape_layer(Sub42604, [2, 1], Res95338), 
LRes20933 = reshape_layer(Res95338, [2, 1, 1], Res20933), 
LRes14793 = reshape_layer(Res20933, [2, 1, 1, 1], Res14793), 
LGlo19219 = global_max_pool3D_layer(Res14793, Glo19219), 
LRes80699 = reshape_layer(Glo19219, [1, 1], Res80699), 
LRes42472 = reshape_layer(Res80699, [1, 1, 1], Res42472), 
LCro75338 = cropping2D_layer(Res42472, 0, 0, 0, 0, Cro75338), 
LCon20980 = conv2D_layer(Cro75338, 1, 1,[[[[0.3328, 0.1607, 0.0147]]]],[0, 0, 0], 1, 3, true, 1, 1, Con20980), 
exec_layers([LSub42604,LRes95338,LRes20933,LRes14793,LGlo19219,LRes80699,LRes42472,LCro75338,LCon20980],["Sub42604","Res95338","Res20933","Res14793","Glo19219","Res80699","Res42472","Cro75338","Con20980"],Con20980,"Con20980")

Actual (Unparsed): [[[[0.0811366, 0.0391787, 0.0035839]]]]

Expected (Unparsed): [[[[0.08113664,0.03917866,0.00358386]]]]

Actual:   [[[[0.0812, 0.0392, 0.0036]]]]

Expected: [[[[0.0812, 0.0392, 0.0036]]]]