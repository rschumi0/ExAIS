import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max17688 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max17688 = tf.keras.layers.Input(shape=([2, 2, 1]))

Max17688 = keras.layers.Maximum(name = 'Max17688', )([in0Max17688,in1Max17688])
ReL95245 = keras.layers.ReLU(max_value=1.8487992858491913, negative_slope=1.2802365743988096, threshold=5.382212728660779, name = 'ReL95245', )(Max17688)
Loc47612 = keras.layers.LocallyConnected2D(2, (2, 2),strides=(1, 1), name = 'Loc47612', )(ReL95245)
model = tf.keras.models.Model(inputs=[in0Max17688,in1Max17688], outputs=Loc47612)
w = model.get_layer('Loc47612').get_weights() 
w[0] = np.array([[[0.8885, 0.8532], [0.1027, 0.3287], [0.0182, 0.1159], [0.9408, 0.1287]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc47612').set_weights(w) 
in0Max17688 = tf.constant([[[[0.4026], [0.8894]], [[0.3381], [0.1623]]]])
in1Max17688 = tf.constant([[[[0.4409], [0.1334]], [[0.0798], [0.3607]]]])
print (np.array2string(model.predict([in0Max17688,in1Max17688],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc47612.png')

LMax17688 = maximum_layer([[[[[0.4026], [0.8894]], [[0.3381], [0.1623]]]], [[[[0.4409], [0.1334]], [[0.0798], [0.3607]]]]], Max17688), 
LReL95245 = relu_layer(Max17688, 1.8487992858491913, 1.2802365743988096, 5.382212728660779, ReL95245), 
LLoc47612 = locally_connected2D_layer(ReL95245, 2, 2,[[[0.8885, 0.8532], [0.1027, 0.3287], [0.0182, 0.1159], [0.9408, 0.1287]]],[[[0, 0]]], 1, 1, Loc47612), 
exec_layers([LMax17688,LReL95245,LLoc47612],["Max17688","ReL95245","Loc47612"],Loc47612,"Loc47612")

Actual (Unparsed): [[[[-12.3770843, -8.8638420]]]]

Expected (Unparsed): [[[[-12.377084280794353,-8.86384200009463]]]]

Actual:   [[[[-12.377, -8.8638]]]]

Expected: [[[[-12.377, -8.8638]]]]