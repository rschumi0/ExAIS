import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep42574 = tf.keras.layers.Input(shape=([2, 2]))
in0Min89731 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min89731 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Sep42574 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep42574', )(in0Sep42574)
Res12034 = keras.layers.Reshape((2, 4, 1), name = 'Res12034', )(Sep42574)
Res46662 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res46662', )(Res12034)
Zer68363 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer68363', )(Res46662)
Min89731 = keras.layers.Minimum(name = 'Min89731', )([in0Min89731,in1Min89731])
Zer28491 = keras.layers.ZeroPadding3D(padding=((1, 0), (2, 0), (1, 0)), name = 'Zer28491', )(Min89731)
Add25397 = keras.layers.Add(name = 'Add25397', )([Zer68363,Zer28491])
Zer17975 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer17975', )(Add25397)
Res96029 = keras.layers.Reshape((4, 6, 5), name = 'Res96029', )(Zer17975)
Res80152 = keras.layers.Reshape((4, 30), name = 'Res80152', )(Res96029)
LST55343 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST55343', )(Res80152)
model = tf.keras.models.Model(inputs=[in0Sep42574,in0Min89731,in1Min89731], outputs=LST55343)
w = model.get_layer('Sep42574').get_weights() 
w[0] = np.array([[[0.8325], [0.0549]]])
w[1] = np.array([[[0.2337, 0.9586, 0.1006, 0.4338], [0.7659, 0.2491, 0.2588, 0.8963]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep42574').set_weights(w) 
w = model.get_layer('LST55343').get_weights() 
w[0] = np.array([[2, 10, 6, 8, 4, 6, 3, 10], [8, 6, 5, 4, 2, 5, 8, 8], [7, 8, 1, 2, 5, 4, 10, 10], [3, 8, 5, 4, 6, 3, 7, 2], [3, 10, 10, 3, 1, 9, 8, 4], [10, 5, 3, 7, 8, 10, 8, 7], [7, 9, 6, 9, 8, 3, 1, 9], [6, 9, 10, 8, 10, 7, 8, 9], [10, 2, 10, 8, 9, 2, 6, 3], [3, 3, 2, 5, 4, 7, 8, 6], [2, 2, 3, 8, 8, 6, 2, 10], [4, 4, 1, 9, 2, 4, 4, 2], [8, 6, 2, 1, 8, 1, 2, 9], [7, 6, 3, 2, 2, 10, 10, 1], [9, 7, 3, 4, 3, 10, 5, 3], [2, 5, 3, 1, 5, 6, 6, 8], [10, 2, 1, 10, 3, 9, 1, 10], [6, 6, 5, 4, 1, 4, 9, 4], [5, 3, 8, 2, 6, 6, 4, 9], [5, 4, 5, 8, 1, 5, 9, 9], [4, 10, 8, 5, 3, 9, 1, 2], [1, 1, 9, 5, 7, 6, 8, 7], [1, 9, 7, 3, 1, 8, 9, 5], [2, 3, 1, 2, 4, 4, 3, 5], [7, 6, 3, 1, 8, 3, 10, 1], [6, 8, 8, 1, 6, 2, 1, 8], [4, 4, 4, 8, 6, 1, 8, 3], [8, 5, 1, 10, 8, 9, 1, 7], [1, 7, 2, 1, 1, 5, 9, 10], [2, 9, 9, 7, 6, 3, 7, 1]])
w[1] = np.array([[7, 10, 3, 1, 2, 2, 5, 10], [2, 8, 8, 5, 4, 9, 1, 4]])
w[2] = np.array([1, 5, 2, 8, 6, 2, 7, 2])
model.get_layer('LST55343').set_weights(w) 
in0Sep42574 = tf.constant([[[0.2221, 0.0584], [0.6434, 0.1628]]])
in0Min89731 = tf.constant([[[[[0.7742], [0.8867]], [[0.486], [0.2645]]]]])
in1Min89731 = tf.constant([[[[[0.3785], [0.5158]], [[0.6342], [0.6403]]]]])
print (np.array2string(model.predict([in0Sep42574,in0Min89731,in1Min89731],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST55343.png')

LSep42574 = separable_conv1D_layer([[[0.2221, 0.0584], [0.6434, 0.1628]]], 1,[[[[0.8325], [0.0549]]],[[[0.2337, 0.9586, 0.1006, 0.4338], [0.7659, 0.2491, 0.2588, 0.8963]]]],[0, 0, 0, 0], 1, false, Sep42574), 
LRes12034 = reshape_layer(Sep42574, [2, 4, 1], Res12034), 
LRes46662 = reshape_layer(Res12034, [2, 4, 1, 1], Res46662), 
LZer68363 = zero_padding3D_layer(Res46662, 0, 0, 0, 0, 2, 0, Zer68363), 
LMin89731 = minimum_layer([[[[[[0.7742], [0.8867]], [[0.486], [0.2645]]]]], [[[[[0.3785], [0.5158]], [[0.6342], [0.6403]]]]]], Min89731), 
LZer28491 = zero_padding3D_layer(Min89731, 1, 0, 2, 0, 1, 0, Zer28491), 
LAdd25397 = add_layer([Zer68363,Zer28491], Add25397), 
LZer17975 = zero_padding3D_layer(Add25397, 1, 1, 1, 1, 1, 1, Zer17975), 
LRes96029 = reshape_layer(Zer17975, [4, 6, 5], Res96029), 
LRes80152 = reshape_layer(Res96029, [4, 30], Res80152), 
LLST55343 = lstm_layer(Res80152,[[2, 10, 6, 8, 4, 6, 3, 10], [8, 6, 5, 4, 2, 5, 8, 8], [7, 8, 1, 2, 5, 4, 10, 10], [3, 8, 5, 4, 6, 3, 7, 2], [3, 10, 10, 3, 1, 9, 8, 4], [10, 5, 3, 7, 8, 10, 8, 7], [7, 9, 6, 9, 8, 3, 1, 9], [6, 9, 10, 8, 10, 7, 8, 9], [10, 2, 10, 8, 9, 2, 6, 3], [3, 3, 2, 5, 4, 7, 8, 6], [2, 2, 3, 8, 8, 6, 2, 10], [4, 4, 1, 9, 2, 4, 4, 2], [8, 6, 2, 1, 8, 1, 2, 9], [7, 6, 3, 2, 2, 10, 10, 1], [9, 7, 3, 4, 3, 10, 5, 3], [2, 5, 3, 1, 5, 6, 6, 8], [10, 2, 1, 10, 3, 9, 1, 10], [6, 6, 5, 4, 1, 4, 9, 4], [5, 3, 8, 2, 6, 6, 4, 9], [5, 4, 5, 8, 1, 5, 9, 9], [4, 10, 8, 5, 3, 9, 1, 2], [1, 1, 9, 5, 7, 6, 8, 7], [1, 9, 7, 3, 1, 8, 9, 5], [2, 3, 1, 2, 4, 4, 3, 5], [7, 6, 3, 1, 8, 3, 10, 1], [6, 8, 8, 1, 6, 2, 1, 8], [4, 4, 4, 8, 6, 1, 8, 3], [8, 5, 1, 10, 8, 9, 1, 7], [1, 7, 2, 1, 1, 5, 9, 10], [2, 9, 9, 7, 6, 3, 7, 1]],[[7, 10, 3, 1, 2, 2, 5, 10], [2, 8, 8, 5, 4, 9, 1, 4]],[1, 5, 2, 8, 6, 2, 7, 2], LST55343), 
exec_layers([LSep42574,LRes12034,LRes46662,LZer68363,LMin89731,LZer28491,LAdd25397,LZer17975,LRes96029,LRes80152,LLST55343],["Sep42574","Res12034","Res46662","Zer68363","Min89731","Zer28491","Add25397","Zer17975","Res96029","Res80152","LST55343"],LST55343,"LST55343")

Actual (Unparsed): [[0.9988488, 0.9992698]]

Expected (Unparsed): [[0.9988488051245745,0.9992697965356508]]

Actual:   [[0.9989, 0.9993]]

Expected: [[0.9989, 0.9993]]