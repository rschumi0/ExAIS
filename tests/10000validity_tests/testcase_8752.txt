import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max83275 = tf.keras.layers.Input(shape=([1, 1]))
in1Max83275 = tf.keras.layers.Input(shape=([1, 1]))
in0Con50563 = tf.keras.layers.Input(shape=([2]))
in0Min66768 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min66768 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con78777 = tf.keras.layers.Input(shape=([1]))
in0Max18858 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max18858 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con14583 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Con24557 = tf.keras.layers.Input(shape=([1]))

Max83275 = keras.layers.Maximum(name = 'Max83275', )([in0Max83275,in1Max83275])
Fla30909 = keras.layers.Flatten(name = 'Fla30909', )(Max83275)
Con50563 = keras.layers.Concatenate(axis=1, name = 'Con50563', )([Fla30909,in0Con50563])
Min66768 = keras.layers.Minimum(name = 'Min66768', )([in0Min66768,in1Min66768])
Res9501 = keras.layers.Reshape((2, 1), name = 'Res9501', )(Min66768)
Fla83737 = keras.layers.Flatten(name = 'Fla83737', )(Res9501)
Con78777 = keras.layers.Concatenate(axis=1, name = 'Con78777', )([Fla83737,in0Con78777])
Max18858 = keras.layers.Maximum(name = 'Max18858', )([in0Max18858,in1Max18858])
Res50556 = keras.layers.Reshape((1, 2), name = 'Res50556', )(Max18858)
Sep38493 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='same', name = 'Sep38493', )(Res50556)
Fla92999 = keras.layers.Flatten(name = 'Fla92999', )(Sep38493)
Con14583 = keras.layers.Conv3DTranspose(2, (1, 1, 2),strides=(1, 1, 1), padding='valid', name = 'Con14583', )(in0Con14583)
Glo59660 = keras.layers.GlobalMaxPool3D(name = 'Glo59660', )(Con14583)
Con24557 = keras.layers.Concatenate(axis=1, name = 'Con24557', )([Glo59660,in0Con24557])
Max62219 = keras.layers.Maximum(name = 'Max62219', )([Fla92999,Con24557])
Ave37034 = keras.layers.Average(name = 'Ave37034', )([Con78777,Max62219])
Ave68080 = keras.layers.Average(name = 'Ave68080', )([Con50563,Ave37034])
model = tf.keras.models.Model(inputs=[in0Max83275,in1Max83275,in0Con50563,in0Min66768,in1Min66768,in0Con78777,in0Max18858,in1Max18858,in0Con14583,in0Con24557], outputs=Ave68080)
w = model.get_layer('Sep38493').get_weights() 
w[0] = np.array([[[0.8818], [0.3125]]])
w[1] = np.array([[[0.0589, 0.652, 0.9643], [0.5068, 0.12, 0.8486]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep38493').set_weights(w) 
w = model.get_layer('Con14583').get_weights() 
w[0] = np.array([[[[[0.884, 0.7708], [0.6523, 0.3629]], [[0.6171, 0.9116], [0.9575, 0.4996]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con14583').set_weights(w) 
in0Max83275 = tf.constant([[[0.8484]]])
in1Max83275 = tf.constant([[[0.0522]]])
in0Con50563 = tf.constant([[0.9744, 0.5911]])
in0Min66768 = tf.constant([[[[0.7137]], [[0.0713]]]])
in1Min66768 = tf.constant([[[[0.4226]], [[0.4129]]]])
in0Con78777 = tf.constant([[0.481]])
in0Max18858 = tf.constant([[[[0.1053, 0.8125]]]])
in1Max18858 = tf.constant([[[[0.5425, 0.5216]]]])
in0Con14583 = tf.constant([[[[[0.7392, 0.3227], [0.7223, 0.1917]], [[0.7838, 0.8277], [0.6142, 0.7298]]]]])
in0Con24557 = tf.constant([[0.0614]])
print (np.array2string(model.predict([in0Max83275,in1Max83275,in0Con50563,in0Min66768,in1Min66768,in0Con78777,in0Max18858,in1Max18858,in0Con14583,in0Con24557],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave68080.png')

LMax83275 = maximum_layer([[[[0.8484]]], [[[0.0522]]]], Max83275), 
LFla30909 = flatten_layer(Max83275, Fla30909), 
LCon50563 = concatenate_layer([Fla30909,[[0.9744, 0.5911]]], 1, Con50563), 
LMin66768 = minimum_layer([[[[[0.7137]], [[0.0713]]]], [[[[0.4226]], [[0.4129]]]]], Min66768), 
LRes9501 = reshape_layer(Min66768, [2, 1], Res9501), 
LFla83737 = flatten_layer(Res9501, Fla83737), 
LCon78777 = concatenate_layer([Fla83737,[[0.481]]], 1, Con78777), 
LMax18858 = maximum_layer([[[[[0.1053, 0.8125]]]], [[[[0.5425, 0.5216]]]]], Max18858), 
LRes50556 = reshape_layer(Max18858, [1, 2], Res50556), 
LSep38493 = separable_conv1D_layer(Res50556, 1,[[[[0.8818], [0.3125]]],[[[0.0589, 0.652, 0.9643], [0.5068, 0.12, 0.8486]]]],[0, 0, 0], 1, true, Sep38493), 
LFla92999 = flatten_layer(Sep38493, Fla92999), 
LCon14583 = conv3D_transpose_layer([[[[[0.7392, 0.3227], [0.7223, 0.1917]], [[0.7838, 0.8277], [0.6142, 0.7298]]]]], 1, 1, 2,[[[[[0.884, 0.7708], [0.6523, 0.3629]], [[0.6171, 0.9116], [0.9575, 0.4996]]]]],[0, 0], 1, 1, 1, false, Con14583), 
LGlo59660 = global_max_pool3D_layer(Con14583, Glo59660), 
LCon24557 = concatenate_layer([Glo59660,[[0.0614]]], 1, Con24557), 
LMax62219 = maximum_layer([Fla92999,Con24557], Max62219), 
LAve37034 = average_layer([Con78777,Max62219], Ave37034), 
LAve68080 = average_layer([Con50563,Ave37034], Ave68080), 
exec_layers([LMax83275,LFla30909,LCon50563,LMin66768,LRes9501,LFla83737,LCon78777,LMax18858,LRes50556,LSep38493,LFla92999,LCon14583,LGlo59660,LCon24557,LMax62219,LAve37034,LAve68080],["Max83275","Fla30909","Con50563","Min66768","Res9501","Fla83737","Con78777","Max18858","Res50556","Sep38493","Fla92999","Con14583","Glo59660","Con24557","Max62219","Ave37034","Ave68080"],Ave68080,"Ave68080")

Actual (Unparsed): [[1.1157742, 0.9623986, 0.5849908]]

Expected (Unparsed): [[1.115774235,0.9623986250000001,0.5849908256749999]]

Actual:   [[1.1158, 0.9624, 0.585]]

Expected: [[1.1158, 0.9624, 0.585]]