import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave43960 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave43960 = tf.keras.layers.Input(shape=([2, 2]))

Ave43960 = keras.layers.Average(name = 'Ave43960', )([in0Ave43960,in1Ave43960])
Res88194 = keras.layers.Reshape((2, 2, 1), name = 'Res88194', )(Ave43960)
Sep10648 = keras.layers.SeparableConv2D(2, (2, 1),strides=(2, 2), padding='same', name = 'Sep10648', )(Res88194)
model = tf.keras.models.Model(inputs=[in0Ave43960,in1Ave43960], outputs=Sep10648)
w = model.get_layer('Sep10648').get_weights() 
w[0] = np.array([[[[0.9089]]], [[[0.0367]]]])
w[1] = np.array([[[[0.3788, 0.3902]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep10648').set_weights(w) 
in0Ave43960 = tf.constant([[[0.8664, 0.7515], [0.9703, 0.8048]]])
in1Ave43960 = tf.constant([[[0.6683, 0.5304], [0.2092, 0.7927]]])
print (np.array2string(model.predict([in0Ave43960,in1Ave43960],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep10648.png')

LAve43960 = average_layer([[[[0.8664, 0.7515], [0.9703, 0.8048]]], [[[0.6683, 0.5304], [0.2092, 0.7927]]]], Ave43960), 
LRes88194 = reshape_layer(Ave43960, [2, 2, 1], Res88194), 
LSep10648 = separable_conv2D_layer(Res88194, 2, 1,[[[[[0.9089]]], [[[0.0367]]]],[[[[0.3788, 0.3902]]]]],[0, 0], 2, 2, true, Sep10648), 
exec_layers([LAve43960,LRes88194,LSep10648],["Ave43960","Res88194","Sep10648"],Sep10648,"Sep10648")

Actual (Unparsed): [[[[0.2723906, 0.2805882]]]]

Expected (Unparsed): [[[[0.272390625312,0.28058823124800003]]]]

Actual:   [[[[0.2724, 0.2806]]]]

Expected: [[[[0.2724, 0.2806]]]]