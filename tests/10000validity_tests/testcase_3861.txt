import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul3739 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul3739 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con19036 = tf.keras.layers.Input(shape=([2, 1]))
in0Cro82793 = tf.keras.layers.Input(shape=([1, 3, 1]))
in0Con4719 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot59854 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot59854 = tf.keras.layers.Input(shape=([2, 3]))

Mul3739 = keras.layers.Multiply(name = 'Mul3739', )([in0Mul3739,in1Mul3739])
Fla3712 = keras.layers.Flatten(name = 'Fla3712', )(Mul3739)
Lea36080 = keras.layers.LeakyReLU(alpha=4.41080733586614, name = 'Lea36080', )(Fla3712)
Res3236 = keras.layers.Reshape((2, 1), name = 'Res3236', )(Lea36080)
Con19036 = keras.layers.Concatenate(axis=2, name = 'Con19036', )([Res3236,in0Con19036])
Cro82793 = keras.layers.Cropping2D(cropping=((0, 0), (0, 2)), name = 'Cro82793', )(in0Cro82793)
Res33875 = keras.layers.Reshape((1, 1), name = 'Res33875', )(Cro82793)
Zer76559 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer76559', )(Res33875)
Con4719 = keras.layers.Concatenate(axis=2, name = 'Con4719', )([Zer76559,in0Con4719])
Dot59854 = keras.layers.Dot(axes=(2, 2), name = 'Dot59854', )([in0Dot59854,in1Dot59854])
Add7565 = keras.layers.Add(name = 'Add7565', )([Con4719,Dot59854])
Ave97548 = keras.layers.Average(name = 'Ave97548', )([Con19036,Add7565])
model = tf.keras.models.Model(inputs=[in0Mul3739,in1Mul3739,in0Con19036,in0Cro82793,in0Con4719,in0Dot59854,in1Dot59854], outputs=Ave97548)
in0Mul3739 = tf.constant([[[[0.7191, 0.8296]]]])
in1Mul3739 = tf.constant([[[[0.4347, 0.17]]]])
in0Con19036 = tf.constant([[[0.8587], [0.9728]]])
in0Cro82793 = tf.constant([[[[1.9056], [1.3166], [1.1715]]]])
in0Con4719 = tf.constant([[[0.8649], [0.9376]]])
in0Dot59854 = tf.constant([[[0.4208, 0.0034, 0.2166], [0.1066, 0.429, 0.2033]]])
in1Dot59854 = tf.constant([[[0.9232, 0.5325, 0.4428], [0.9168, 0.8225, 0.0443]]])
print (np.array2string(model.predict([in0Mul3739,in1Mul3739,in0Con19036,in0Cro82793,in0Con4719,in0Dot59854,in1Dot59854],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave97548.png')

LMul3739 = multiply_layer([[[[[0.7191, 0.8296]]]], [[[[0.4347, 0.17]]]]], Mul3739), 
LFla3712 = flatten_layer(Mul3739, Fla3712), 
LLea36080 = leaky_relu_layer(Fla3712, 4.41080733586614, Lea36080), 
LRes3236 = reshape_layer(Lea36080, [2, 1], Res3236), 
LCon19036 = concatenate_layer([Res3236,[[[0.8587], [0.9728]]]], 2, Con19036), 
LCro82793 = cropping2D_layer([[[[1.9056], [1.3166], [1.1715]]]], 0, 0, 0, 2, Cro82793), 
LRes33875 = reshape_layer(Cro82793, [1, 1], Res33875), 
LZer76559 = zero_padding1D_layer(Res33875, 1, 0, Zer76559), 
LCon4719 = concatenate_layer([Zer76559,[[[0.8649], [0.9376]]]], 2, Con4719), 
LDot59854 = dot_layer([[[0.4208, 0.0034, 0.2166], [0.1066, 0.429, 0.2033]]], [[[0.9232, 0.5325, 0.4428], [0.9168, 0.8225, 0.0443]]], 2, 2, Dot59854), 
LAdd7565 = add_layer([Con4719,Dot59854], Add7565), 
LAve97548 = average_layer([Con19036,Add7565], Ave97548), 
exec_layers([LMul3739,LFla3712,LLea36080,LRes3236,LCon19036,LCro82793,LRes33875,LZer76559,LCon4719,LDot59854,LAdd7565,LAve97548],["Mul3739","Fla3712","Lea36080","Res3236","Con19036","Cro82793","Res33875","Zer76559","Con4719","Dot59854","Add7565","Ave97548"],Ave97548,"Ave97548")

Actual (Unparsed): [[[0.3993982, 1.0608907], [1.2317544, 1.1849948]]]

Expected (Unparsed): [[[0.399398155,1.06089066],[1.23175443,1.184994785]]]

Actual:   [[[0.3994, 1.0609], [1.2318, 1.185]]]

Expected: [[[0.3994, 1.0609], [1.2318, 1.185]]]