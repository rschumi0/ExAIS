import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul66033 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul66033 = tf.keras.layers.Input(shape=([2, 2]))

Mul66033 = keras.layers.Multiply(name = 'Mul66033', )([in0Mul66033,in1Mul66033])
Per19201 = keras.layers.Permute((1,2), name = 'Per19201',)(Mul66033)
Res86348 = keras.layers.Reshape((2, 2, 1), name = 'Res86348', )(Per19201)
Max55335 = keras.layers.MaxPool2D(pool_size=(2, 2), name = 'Max55335', )(Res86348)
Res50040 = keras.layers.Reshape((1, 1), name = 'Res50040', )(Max55335)
Loc37846 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc37846', )(Res50040)
model = tf.keras.models.Model(inputs=[in0Mul66033,in1Mul66033], outputs=Loc37846)
w = model.get_layer('Loc37846').get_weights() 
w[0] = np.array([[[0.8889, 0.1109, 0.8843, 0.0259]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc37846').set_weights(w) 
in0Mul66033 = tf.constant([[[0.8316, 0.8983], [0.8539, 0.9835]]])
in1Mul66033 = tf.constant([[[0.8771, 0.173], [0.5896, 0.8686]]])
print (np.array2string(model.predict([in0Mul66033,in1Mul66033],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc37846.png')

LMul66033 = multiply_layer([[[[0.8316, 0.8983], [0.8539, 0.9835]]], [[[0.8771, 0.173], [0.5896, 0.8686]]]], Mul66033), 
LPer19201 = permute_layer(Mul66033, 1,2, Per19201), 
LRes86348 = reshape_layer(Per19201, [2, 2, 1], Res86348), 
LMax55335 = max_pool2D_layer(Res86348, 2, 2, Max55335), 
LRes50040 = reshape_layer(Max55335, [1, 1], Res50040), 
LLoc37846 = locally_connected1D_layer(Res50040, 1,[[[0.8889, 0.1109, 0.8843, 0.0259]]],[[0, 0, 0, 0]], 1, Loc37846), 
exec_layers([LMul66033,LPer19201,LRes86348,LMax55335,LRes50040,LLoc37846],["Mul66033","Per19201","Res86348","Max55335","Res50040","Loc37846"],Loc37846,"Loc37846")

Actual (Unparsed): [[[0.7593589, 0.0947383, 0.7554293, 0.0221255]]]

Expected (Unparsed): [[[0.7593589140900001,0.09473833229,0.75542928083,0.02212554379]]]

Actual:   [[[0.7594, 0.0948, 0.7555, 0.0222]]]

Expected: [[[0.7594, 0.0948, 0.7555, 0.0222]]]