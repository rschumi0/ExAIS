import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add37873 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Add37873 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Sub6734 = tf.keras.layers.Input(shape=([2]))
in1Sub6734 = tf.keras.layers.Input(shape=([2]))
in0Con32942 = tf.keras.layers.Input(shape=([14]))
in0Con86673 = tf.keras.layers.Input(shape=([9, 1]))
in0Dot22504 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot22504 = tf.keras.layers.Input(shape=([2, 3]))
in0Con30906 = tf.keras.layers.Input(shape=([3, 3, 1, 2]))
in0Con36971 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Add37873 = keras.layers.Add(name = 'Add37873', )([in0Add37873,in1Add37873])
Res36254 = keras.layers.Reshape((2, 2, 4), name = 'Res36254', )(Add37873)
Res76962 = keras.layers.Reshape((2, 8), name = 'Res76962', )(Res36254)
Fla95573 = keras.layers.Flatten(name = 'Fla95573', )(Res76962)
Sub6734 = keras.layers.Subtract(name = 'Sub6734', )([in0Sub6734,in1Sub6734])
Con32942 = keras.layers.Concatenate(axis=1, name = 'Con32942', )([Sub6734,in0Con32942])
Max38506 = keras.layers.Maximum(name = 'Max38506', )([Fla95573,Con32942])
Res10631 = keras.layers.Reshape((16, 1), name = 'Res10631', )(Max38506)
Res1331 = keras.layers.Reshape((16, 1, 1), name = 'Res1331', )(Res10631)
Cro74418 = keras.layers.Cropping2D(cropping=((7, 0), (0, 0)), name = 'Cro74418', )(Res1331)
Res17142 = keras.layers.Reshape((9, 1), name = 'Res17142', )(Cro74418)
Con86673 = keras.layers.Concatenate(axis=2, name = 'Con86673', )([Res17142,in0Con86673])
Dot22504 = keras.layers.Dot(axes=(1, 1), name = 'Dot22504', )([in0Dot22504,in1Dot22504])
ELU98657 = keras.layers.ELU(alpha=-7.091393198057732, name = 'ELU98657', )(Dot22504)
Res49624 = keras.layers.Reshape((3, 3, 1), name = 'Res49624', )(ELU98657)
Res30685 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res30685', )(Res49624)
Con30906 = keras.layers.Concatenate(axis=4, name = 'Con30906', )([Res30685,in0Con30906])
Con36971 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con36971', )(in0Con36971)
Zer32568 = keras.layers.ZeroPadding3D(padding=((2, 0), (2, 0), (0, 0)), name = 'Zer32568', )(Con36971)
Sub57037 = keras.layers.Subtract(name = 'Sub57037', )([Con30906,Zer32568])
Res82615 = keras.layers.Reshape((3, 3, 3), name = 'Res82615', )(Sub57037)
Res52344 = keras.layers.Reshape((3, 9), name = 'Res52344', )(Res82615)
Loc3615 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc3615', )(Res52344)
Zer41345 = keras.layers.ZeroPadding1D(padding=((6, 0)), name = 'Zer41345', )(Loc3615)
Ave32050 = keras.layers.Average(name = 'Ave32050', )([Con86673,Zer41345])
model = tf.keras.models.Model(inputs=[in0Add37873,in1Add37873,in0Sub6734,in1Sub6734,in0Con32942,in0Con86673,in0Dot22504,in1Dot22504,in0Con30906,in0Con36971], outputs=Ave32050)
w = model.get_layer('Con36971').get_weights() 
w[0] = np.array([[[[[0.1609], [0.0312], [0.954]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con36971').set_weights(w) 
w = model.get_layer('Loc3615').get_weights() 
w[0] = np.array([[[0.0708, 0.9743], [0.2833, 0.8044], [0.8534, 0.0319], [0.0623, 0.0802], [0.76, 0.3742], [0.0267, 0.8232], [0.6926, 0.8302], [0.8006, 0.2898], [0.4482, 0.8961]], [[0.0568, 0.1251], [0.4181, 0.6166], [0.0043, 0.3127], [0.0832, 0.6488], [0.4513, 0.7102], [0.835, 0.4931], [0.6535, 0.0283], [0.3043, 0.9724], [0.0174, 0.5361]], [[0.6908, 0.0452], [0.7385, 0.6079], [0.5507, 0.9504], [0.6242, 0.4682], [0.1244, 0.4991], [0.6757, 0.1351], [0.5604, 0.0513], [0.4869, 0.6141], [0.3301, 0.346]]])
w[1] = np.array([[0, 0], [0, 0], [0, 0]])
model.get_layer('Loc3615').set_weights(w) 
in0Add37873 = tf.constant([[[[[0.7838, 0.8277], [0.2013, 0.641]], [[0.4368, 0.237], [0.5941, 0.2452]]], [[[0.6052, 0.3361], [0.8539, 0.5642]], [[0.2397, 0.5063], [0.6361, 0.819]]]]])
in1Add37873 = tf.constant([[[[[0.5573, 0.5584], [0.3989, 0.1784]], [[0.7573, 0.4921], [0.1048, 0.7507]]], [[[0.9256, 0.0811], [0.3787, 0.8126]], [[0.6122, 0.2232], [0.0992, 0.1993]]]]])
in0Sub6734 = tf.constant([[0.3085, 0.5297]])
in1Sub6734 = tf.constant([[0.7855, 0.5741]])
in0Con32942 = tf.constant([[0.0907, 0.2968, 0.5609, 0.8895, 0.777, 0.7376, 0.8344, 0.0353, 0.379, 0.7847, 0.3136, 0.9171, 0.3882, 0.657]])
in0Con86673 = tf.constant([[[0.7636], [0.4015], [0.969], [0.1329], [0.084], [0.5236], [0.0221], [0.6281], [0.5111]]])
in0Dot22504 = tf.constant([[[0.3267, 0.9391, 0.5547], [0.3758, 0.3901, 0.2372]]])
in1Dot22504 = tf.constant([[[0.8712, 0.6044, 0.5763], [0.2406, 0.7896, 0.2435]]])
in0Con30906 = tf.constant([[[[[0.5308, 0.0802]], [[0.964, 0.452]], [[0.4656, 0.3977]]], [[[0.0107, 0.0311]], [[0.6203, 0.0195]], [[0.7033, 0.1908]]], [[[0.6634, 0.3004]], [[0.1582, 0.4634]], [[0.5437, 0.6238]]]]])
in0Con36971 = tf.constant([[[[[0.1295]]]]])
print (np.array2string(model.predict([in0Add37873,in1Add37873,in0Sub6734,in1Sub6734,in0Con32942,in0Con86673,in0Dot22504,in1Dot22504,in0Con30906,in0Con36971],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave32050.png')

LAdd37873 = add_layer([[[[[[0.7838, 0.8277], [0.2013, 0.641]], [[0.4368, 0.237], [0.5941, 0.2452]]], [[[0.6052, 0.3361], [0.8539, 0.5642]], [[0.2397, 0.5063], [0.6361, 0.819]]]]], [[[[[0.5573, 0.5584], [0.3989, 0.1784]], [[0.7573, 0.4921], [0.1048, 0.7507]]], [[[0.9256, 0.0811], [0.3787, 0.8126]], [[0.6122, 0.2232], [0.0992, 0.1993]]]]]], Add37873), 
LRes36254 = reshape_layer(Add37873, [2, 2, 4], Res36254), 
LRes76962 = reshape_layer(Res36254, [2, 8], Res76962), 
LFla95573 = flatten_layer(Res76962, Fla95573), 
LSub6734 = subtract_layer([[0.3085, 0.5297]], [[0.7855, 0.5741]], Sub6734), 
LCon32942 = concatenate_layer([Sub6734,[[0.0907, 0.2968, 0.5609, 0.8895, 0.777, 0.7376, 0.8344, 0.0353, 0.379, 0.7847, 0.3136, 0.9171, 0.3882, 0.657]]], 1, Con32942), 
LMax38506 = maximum_layer([Fla95573,Con32942], Max38506), 
LRes10631 = reshape_layer(Max38506, [16, 1], Res10631), 
LRes1331 = reshape_layer(Res10631, [16, 1, 1], Res1331), 
LCro74418 = cropping2D_layer(Res1331, 7, 0, 0, 0, Cro74418), 
LRes17142 = reshape_layer(Cro74418, [9, 1], Res17142), 
LCon86673 = concatenate_layer([Res17142,[[[0.7636], [0.4015], [0.969], [0.1329], [0.084], [0.5236], [0.0221], [0.6281], [0.5111]]]], 2, Con86673), 
LDot22504 = dot_layer([[[0.3267, 0.9391, 0.5547], [0.3758, 0.3901, 0.2372]]], [[[0.8712, 0.6044, 0.5763], [0.2406, 0.7896, 0.2435]]], 1, 1, Dot22504), 
LELU98657 = elu_layer(Dot22504, -7.091393198057732, ELU98657), 
LRes49624 = reshape_layer(ELU98657, [3, 3, 1], Res49624), 
LRes30685 = reshape_layer(Res49624, [3, 3, 1, 1], Res30685), 
LCon30906 = concatenate_layer([Res30685,[[[[[0.5308, 0.0802]], [[0.964, 0.452]], [[0.4656, 0.3977]]], [[[0.0107, 0.0311]], [[0.6203, 0.0195]], [[0.7033, 0.1908]]], [[[0.6634, 0.3004]], [[0.1582, 0.4634]], [[0.5437, 0.6238]]]]]], 4, Con30906), 
LCon36971 = conv3D_transpose_layer([[[[[0.1295]]]]], 1, 1, 1,[[[[[0.1609], [0.0312], [0.954]]]]],[0, 0, 0], 1, 1, 1, false, Con36971), 
LZer32568 = zero_padding3D_layer(Con36971, 2, 0, 2, 0, 0, 0, Zer32568), 
LSub57037 = subtract_layer(Con30906,Zer32568, Sub57037), 
LRes82615 = reshape_layer(Sub57037, [3, 3, 3], Res82615), 
LRes52344 = reshape_layer(Res82615, [3, 9], Res52344), 
LLoc3615 = locally_connected1D_layer(Res52344, 1,[[[0.0708, 0.9743], [0.2833, 0.8044], [0.8534, 0.0319], [0.0623, 0.0802], [0.76, 0.3742], [0.0267, 0.8232], [0.6926, 0.8302], [0.8006, 0.2898], [0.4482, 0.8961]], [[0.0568, 0.1251], [0.4181, 0.6166], [0.0043, 0.3127], [0.0832, 0.6488], [0.4513, 0.7102], [0.835, 0.4931], [0.6535, 0.0283], [0.3043, 0.9724], [0.0174, 0.5361]], [[0.6908, 0.0452], [0.7385, 0.6079], [0.5507, 0.9504], [0.6242, 0.4682], [0.1244, 0.4991], [0.6757, 0.1351], [0.5604, 0.0513], [0.4869, 0.6141], [0.3301, 0.346]]],[[0, 0], [0, 0], [0, 0]], 1, Loc3615), 
LZer41345 = zero_padding1D_layer(Loc3615, 6, 0, Zer41345), 
LAve32050 = average_layer([Con86673,Zer41345], Ave32050), 
exec_layers([LAdd37873,LRes36254,LRes76962,LFla95573,LSub6734,LCon32942,LMax38506,LRes10631,LRes1331,LCro74418,LRes17142,LCon86673,LDot22504,LELU98657,LRes49624,LRes30685,LCon30906,LCon36971,LZer32568,LSub57037,LRes82615,LRes52344,LLoc3615,LZer41345,LAve32050],["Add37873","Res36254","Res76962","Fla95573","Sub6734","Con32942","Max38506","Res10631","Res1331","Cro74418","Res17142","Con86673","Dot22504","ELU98657","Res49624","Res30685","Con30906","Con36971","Zer32568","Sub57037","Res82615","Res52344","Loc3615","Zer41345","Ave32050"],Ave32050,"Ave32050")

Actual (Unparsed): [[[0.4979500, 0.3818000], [0.7654000, 0.2007500], [0.2086000, 0.4845000], [0.6163000, 0.0664500], [0.6884000, 0.0420000], [0.4259500, 0.2618000], [1.3413774, 1.1565350], [0.8969351, 1.2904733], [1.6668082, 1.0666568]]]

Expected (Unparsed): [[[0.49795,0.3818],[0.7654,0.20075],[0.2086,0.4845],[0.6163,0.06645],[0.6884,0.042],[0.42595,0.2618],[1.341377341755,1.1565350254350002],[0.8969350984219999,1.290473306271],[1.666808141486,1.066656788275]]]

Actual:   [[[0.498, 0.3818], [0.7654, 0.2008], [0.2086, 0.4845], [0.6163, 0.0665], [0.6884, 0.042], [0.426, 0.2618], [1.3414, 1.1566], [0.897, 1.2905], [1.6669, 1.0667]]]

Expected: [[[0.498, 0.3818], [0.7654, 0.2008], [0.2086, 0.4845], [0.6163, 0.0665], [0.6884, 0.042], [0.426, 0.2618], [1.3414, 1.1566], [0.897, 1.2905], [1.6669, 1.0667]]]