import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro89637 = tf.keras.layers.Input(shape=([1, 4]))
in0GRU39553 = tf.keras.layers.Input(shape=([2, 1]))
in0Glo27110 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Con15109 = tf.keras.layers.Input(shape=([2]))

Cro89637 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro89637', )(in0Cro89637)
Fla17593 = keras.layers.Flatten(name = 'Fla17593', )(Cro89637)
GRU39553 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU39553', )(in0GRU39553)
Glo27110 = keras.layers.GlobalMaxPool3D(name = 'Glo27110', )(in0Glo27110)
Add57702 = keras.layers.Add(name = 'Add57702', )([GRU39553,Glo27110])
Con15109 = keras.layers.Concatenate(axis=1, name = 'Con15109', )([Add57702,in0Con15109])
Max57517 = keras.layers.Maximum(name = 'Max57517', )([Fla17593,Con15109])
Res83952 = keras.layers.Reshape((4, 1), name = 'Res83952', )(Max57517)
Up_90549 = keras.layers.UpSampling1D(size=(2), name = 'Up_90549', )(Res83952)
model = tf.keras.models.Model(inputs=[in0Cro89637,in0GRU39553,in0Glo27110,in0Con15109], outputs=Up_90549)
w = model.get_layer('GRU39553').get_weights() 
w[0] = np.array([[3, 3, 9, 10, 9, 3]])
w[1] = np.array([[8, 3, 7, 4, 8, 2], [4, 9, 8, 6, 5, 3]])
w[2] = np.array([[4, 8, 4, 8, 6, 10], [5, 1, 6, 4, 6, 6]])
model.get_layer('GRU39553').set_weights(w) 
in0Cro89637 = tf.constant([[[1.7572, 1.285, 1.8875, 1.0701]]])
in0GRU39553 = tf.constant([[[2], [8]]])
in0Glo27110 = tf.constant([[[[[1.2538, 1.0452], [1.1904, 1.9647]], [[1.2117, 1.7081], [1.4352, 1.2539]]], [[[1.9119, 1.0509], [1.2821, 1.6218]], [[1.947, 1.9451], [1.2604, 1.8117]]]]])
in0Con15109 = tf.constant([[0.9804, 0.1414]])
print (np.array2string(model.predict([in0Cro89637,in0GRU39553,in0Glo27110,in0Con15109],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_90549.png')

LCro89637 = cropping1D_layer([[[1.7572, 1.285, 1.8875, 1.0701]]], 0, 0, Cro89637), 
LFla17593 = flatten_layer(Cro89637, Fla17593), 
LGRU39553 = gru_layer([[[2], [8]]],[[3, 3, 9, 10, 9, 3]],[[8, 3, 7, 4, 8, 2], [4, 9, 8, 6, 5, 3]],[[4, 8, 4, 8, 6, 10], [5, 1, 6, 4, 6, 6]], true, GRU39553), 
LGlo27110 = global_max_pool3D_layer([[[[[1.2538, 1.0452], [1.1904, 1.9647]], [[1.2117, 1.7081], [1.4352, 1.2539]]], [[[1.9119, 1.0509], [1.2821, 1.6218]], [[1.947, 1.9451], [1.2604, 1.8117]]]]], Glo27110), 
LAdd57702 = add_layer([GRU39553,Glo27110], Add57702), 
LCon15109 = concatenate_layer([Add57702,[[0.9804, 0.1414]]], 1, Con15109), 
LMax57517 = maximum_layer([Fla17593,Con15109], Max57517), 
LRes83952 = reshape_layer(Max57517, [4, 1], Res83952), 
LUp_90549 = up_sampling1D_layer(Res83952, 2, Up_90549), 
exec_layers([LCro89637,LFla17593,LGRU39553,LGlo27110,LAdd57702,LCon15109,LMax57517,LRes83952,LUp_90549],["Cro89637","Fla17593","GRU39553","Glo27110","Add57702","Con15109","Max57517","Res83952","Up_90549"],Up_90549,"Up_90549")

Actual (Unparsed): [[[1.9470003], [1.9470003], [1.9647003], [1.9647003], [1.8875000], [1.8875000], [1.0700999], [1.0700999]]]

Expected (Unparsed): [[[1.9470003059022316],[1.9470003059022316],[1.9647003059022314],[1.9647003059022314],[1.8875],[1.8875],[1.0701],[1.0701]]]

Actual:   [[[1.9471], [1.9471], [1.9648], [1.9648], [1.8875], [1.8875], [1.0701], [1.0701]]]

Expected: [[[1.9471], [1.9471], [1.9648], [1.9648], [1.8875], [1.8875], [1.0701], [1.0701]]]