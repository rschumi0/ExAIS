import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul83744 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Mul83744 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Mul83744 = keras.layers.Multiply(name = 'Mul83744', )([in0Mul83744,in1Mul83744])
Res43501 = keras.layers.Reshape((1, 2, 4), name = 'Res43501', )(Mul83744)
Res70281 = keras.layers.Reshape((1, 8), name = 'Res70281', )(Res43501)
Con96990 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con96990', )(Res70281)
Res35437 = keras.layers.Reshape((1, 3, 1), name = 'Res35437', )(Con96990)
Res12283 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res12283', )(Res35437)
Glo81267 = keras.layers.GlobalAveragePooling3D(name = 'Glo81267', )(Res12283)
model = tf.keras.models.Model(inputs=[in0Mul83744,in1Mul83744], outputs=Glo81267)
w = model.get_layer('Con96990').get_weights() 
w[0] = np.array([[[0.0911, 0.1095, 0.1848], [0.2455, 0.0157, 0.4753], [0.2851, 0.6547, 0.5064], [0.3739, 0.2619, 0.846], [0.9744, 0.686, 0.5851], [0.4564, 0.1375, 0.2736], [0.7195, 0.882, 0.4843], [0.964, 0.9974, 0.1913]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con96990').set_weights(w) 
in0Mul83744 = tf.constant([[[[[0.2206, 0.473], [0.9854, 0.9077]], [[0.2702, 0.2549], [0.6618, 0.3982]]]]])
in1Mul83744 = tf.constant([[[[[0.6474, 0.576], [0.4701, 0.4804]], [[0.1068, 0.2299], [0.6807, 0.4948]]]]])
print (np.array2string(model.predict([in0Mul83744,in1Mul83744],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo81267.png')

LMul83744 = multiply_layer([[[[[[0.2206, 0.473], [0.9854, 0.9077]], [[0.2702, 0.2549], [0.6618, 0.3982]]]]], [[[[[0.6474, 0.576], [0.4701, 0.4804]], [[0.1068, 0.2299], [0.6807, 0.4948]]]]]], Mul83744), 
LRes43501 = reshape_layer(Mul83744, [1, 2, 4], Res43501), 
LRes70281 = reshape_layer(Res43501, [1, 8], Res70281), 
LCon96990 = conv1D_layer(Res70281, 1,[[[0.0911, 0.1095, 0.1848], [0.2455, 0.0157, 0.4753], [0.2851, 0.6547, 0.5064], [0.3739, 0.2619, 0.846], [0.9744, 0.686, 0.5851], [0.4564, 0.1375, 0.2736], [0.7195, 0.882, 0.4843], [0.964, 0.9974, 0.1913]]],[0, 0, 0], 1, true, 1, Con96990), 
LRes35437 = reshape_layer(Con96990, [1, 3, 1], Res35437), 
LRes12283 = reshape_layer(Res35437, [1, 3, 1, 1], Res12283), 
LGlo81267 = global_average_pooling3D_layer(Res12283, Glo81267), 
exec_layers([LMul83744,LRes43501,LRes70281,LCon96990,LRes35437,LRes12283,LGlo81267],["Mul83744","Res43501","Res70281","Con96990","Res35437","Res12283","Glo81267"],Glo81267,"Glo81267")

Actual (Unparsed): [[1.0170640]]

Expected (Unparsed): [[1.0170639596176665]]

Actual:   [[1.0171]]

Expected: [[1.0171]]