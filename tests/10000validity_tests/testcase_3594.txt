import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo87234 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con63306 = tf.keras.layers.Input(shape=([1]))
in0GRU76088 = tf.keras.layers.Input(shape=([3, 2]))

Glo87234 = keras.layers.GlobalAveragePooling2D(name = 'Glo87234', )(in0Glo87234)
Res19009 = keras.layers.Reshape((1, 1), name = 'Res19009', )(Glo87234)
Glo84234 = keras.layers.GlobalAveragePooling1D(name = 'Glo84234', )(Res19009)
Res16753 = keras.layers.Reshape((1, 1), name = 'Res16753', )(Glo84234)
Glo92544 = keras.layers.GlobalMaxPool1D(name = 'Glo92544', )(Res16753)
Con63306 = keras.layers.Concatenate(axis=1, name = 'Con63306', )([Glo92544,in0Con63306])
GRU76088 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU76088', )(in0GRU76088)
ReL78415 = keras.layers.ReLU(max_value=1.1381547912122392, negative_slope=4.379693972272756, threshold=5.6037604436514785, name = 'ReL78415', )(GRU76088)
Dot4249 = keras.layers.Dot(axes=(1, 1), name = 'Dot4249', )([Con63306,ReL78415])
model = tf.keras.models.Model(inputs=[in0Glo87234,in0Con63306,in0GRU76088], outputs=Dot4249)
w = model.get_layer('GRU76088').get_weights() 
w[0] = np.array([[6, 9, 7, 9, 5, 3], [7, 2, 4, 9, 5, 6]])
w[1] = np.array([[8, 3, 5, 5, 3, 2], [5, 5, 5, 7, 5, 6]])
w[2] = np.array([[10, 3, 8, 9, 5, 8], [8, 7, 1, 9, 10, 6]])
model.get_layer('GRU76088').set_weights(w) 
in0Glo87234 = tf.constant([[[[1.9278], [1.1987]]]])
in0Con63306 = tf.constant([[0.9022]])
in0GRU76088 = tf.constant([[[8, 8], [9, 9], [5, 5]]])
print (np.array2string(model.predict([in0Glo87234,in0Con63306,in0GRU76088],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot4249.png')

LGlo87234 = global_average_pooling2D_layer([[[[1.9278], [1.1987]]]], Glo87234), 
LRes19009 = reshape_layer(Glo87234, [1, 1], Res19009), 
LGlo84234 = global_average_pooling1D_layer(Res19009, Glo84234), 
LRes16753 = reshape_layer(Glo84234, [1, 1], Res16753), 
LGlo92544 = global_max_pool1D_layer(Res16753, Glo92544), 
LCon63306 = concatenate_layer([Glo92544,[[0.9022]]], 1, Con63306), 
LGRU76088 = gru_layer([[[8, 8], [9, 9], [5, 5]]],[[6, 9, 7, 9, 5, 3], [7, 2, 4, 9, 5, 6]],[[8, 3, 5, 5, 3, 2], [5, 5, 5, 7, 5, 6]],[[10, 3, 8, 9, 5, 8], [8, 7, 1, 9, 10, 6]], true, GRU76088), 
LReL78415 = relu_layer(GRU76088, 1.1381547912122392, 4.379693972272756, 5.6037604436514785, ReL78415), 
LDot4249 = dot_layer(Con63306,ReL78415, 1, 1, Dot4249), 
exec_layers([LGlo87234,LRes19009,LGlo84234,LRes16753,LGlo92544,LCon63306,LGRU76088,LReL78415,LDot4249],["Glo87234","Res19009","Glo84234","Res16753","Glo92544","Con63306","GRU76088","ReL78415","Dot4249"],Dot4249,"Dot4249")

Actual (Unparsed): [[-60.5089371]]

Expected (Unparsed): [[-60.50893737862969]]

Actual:   [[-60.5089]]

Expected: [[-60.5089]]