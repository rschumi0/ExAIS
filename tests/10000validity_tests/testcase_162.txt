import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul26137 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul26137 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Min59412 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min59412 = tf.keras.layers.Input(shape=([2, 1, 1]))

Mul26137 = keras.layers.Multiply(name = 'Mul26137', )([in0Mul26137,in1Mul26137])
Res28740 = keras.layers.Reshape((2, 2), name = 'Res28740', )(Mul26137)
Max47936 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='valid', name = 'Max47936', )(Res28740)
Res55691 = keras.layers.Reshape((1, 2, 1), name = 'Res55691', )(Max47936)
Res69868 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res69868', )(Res55691)
Cro58983 = keras.layers.Cropping3D(cropping=((0, 0), (1, 0), (0, 0)), name = 'Cro58983', )(Res69868)
Res76146 = keras.layers.Reshape((1, 1, 1), name = 'Res76146', )(Cro58983)
Zer98877 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer98877', )(Res76146)
Min59412 = keras.layers.Minimum(name = 'Min59412', )([in0Min59412,in1Min59412])
Min2831 = keras.layers.Minimum(name = 'Min2831', )([Zer98877,Min59412])
Max31802 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max31802', )(Min2831)
model = tf.keras.models.Model(inputs=[in0Mul26137,in1Mul26137,in0Min59412,in1Min59412], outputs=Max31802)
in0Mul26137 = tf.constant([[[[0.2565, 0.0559]], [[0.0093, 0.1257]]]])
in1Mul26137 = tf.constant([[[[0.9956, 0.0362]], [[0.1285, 0.8418]]]])
in0Min59412 = tf.constant([[[[0.4016]], [[0.9438]]]])
in1Min59412 = tf.constant([[[[0.4924]], [[0.5596]]]])
print (np.array2string(model.predict([in0Mul26137,in1Mul26137,in0Min59412,in1Min59412],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max31802.png')

LMul26137 = multiply_layer([[[[[0.2565, 0.0559]], [[0.0093, 0.1257]]]], [[[[0.9956, 0.0362]], [[0.1285, 0.8418]]]]], Mul26137), 
LRes28740 = reshape_layer(Mul26137, [2, 2], Res28740), 
LMax47936 = max_pool1D_layer(Res28740, 2, 1, false, Max47936), 
LRes55691 = reshape_layer(Max47936, [1, 2, 1], Res55691), 
LRes69868 = reshape_layer(Res55691, [1, 2, 1, 1], Res69868), 
LCro58983 = cropping3D_layer(Res69868, 0, 0, 1, 0, 0, 0, Cro58983), 
LRes76146 = reshape_layer(Cro58983, [1, 1, 1], Res76146), 
LZer98877 = zero_padding2D_layer(Res76146, 1, 0, 0, 0, Zer98877), 
LMin59412 = minimum_layer([[[[[0.4016]], [[0.9438]]]], [[[[0.4924]], [[0.5596]]]]], Min59412), 
LMin2831 = minimum_layer([Zer98877,Min59412], Min2831), 
LMax31802 = max_pool2D_layer(Min2831, 1, 1, Max31802), 
exec_layers([LMul26137,LRes28740,LMax47936,LRes55691,LRes69868,LCro58983,LRes76146,LZer98877,LMin59412,LMin2831,LMax31802],["Mul26137","Res28740","Max47936","Res55691","Res69868","Cro58983","Res76146","Zer98877","Min59412","Min2831","Max31802"],Max31802,"Max31802")

Actual (Unparsed): [[[[0.0000000]], [[0.1058143]]]]

Expected (Unparsed): [[[[0]],[[0.10581426000000001]]]]

Actual:   [[[[0]], [[0.1059]]]]

Expected: [[[[0]], [[0.1059]]]]