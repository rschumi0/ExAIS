import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc69682 = tf.keras.layers.Input(shape=([2, 1, 2]))

Loc69682 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(8, 1), name = 'Loc69682', )(in0Loc69682)
Res47487 = keras.layers.Reshape((1, 3), name = 'Res47487', )(Loc69682)
LST57125 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST57125', )(Res47487)
Res30106 = keras.layers.Reshape((1, 1), name = 'Res30106', )(LST57125)
Res68747 = keras.layers.Reshape((1, 1, 1), name = 'Res68747', )(Res30106)
Cro18987 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro18987', )(Res68747)
model = tf.keras.models.Model(inputs=[in0Loc69682], outputs=Cro18987)
w = model.get_layer('Loc69682').get_weights() 
w[0] = np.array([[[0.7151, 0.24, 0.6574], [0.8527, 0.401, 0.6031]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc69682').set_weights(w) 
w = model.get_layer('LST57125').get_weights() 
w[0] = np.array([[2, 6, 9, 2], [1, 5, 10, 4], [7, 5, 1, 2]])
w[1] = np.array([[6, 3, 10, 8]])
w[2] = np.array([9, 8, 3, 6])
model.get_layer('LST57125').set_weights(w) 
in0Loc69682 = tf.constant([[[[0.0866, 0.1272]], [[0.6172, 0.2347]]]])
print (np.array2string(model.predict([in0Loc69682],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro18987.png')

LLoc69682 = locally_connected2D_layer([[[[0.0866, 0.1272]], [[0.6172, 0.2347]]]], 1, 1,[[[0.7151, 0.24, 0.6574], [0.8527, 0.401, 0.6031]]],[[[0, 0, 0]]], 8, 1, Loc69682), 
LRes47487 = reshape_layer(Loc69682, [1, 3], Res47487), 
LLST57125 = lstm_layer(Res47487,[[2, 6, 9, 2], [1, 5, 10, 4], [7, 5, 1, 2]],[[6, 3, 10, 8]],[9, 8, 3, 6], LST57125), 
LRes30106 = reshape_layer(LST57125, [1, 1], Res30106), 
LRes68747 = reshape_layer(Res30106, [1, 1, 1], Res68747), 
LCro18987 = cropping2D_layer(Res68747, 0, 0, 0, 0, Cro18987), 
exec_layers([LLoc69682,LRes47487,LLST57125,LRes30106,LRes68747,LCro18987],["Loc69682","Res47487","LST57125","Res30106","Res68747","Cro18987"],Cro18987,"Cro18987")

Actual (Unparsed): [[[[0.7607927]]]]

Expected (Unparsed): [[[[0.7607926639916206]]]]

Actual:   [[[[0.7608]]]]

Expected: [[[[0.7608]]]]