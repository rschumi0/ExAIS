import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add39238 = tf.keras.layers.Input(shape=([1, 1]))
in1Add39238 = tf.keras.layers.Input(shape=([1, 1]))
in0Con14868 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Max68757 = tf.keras.layers.Input(shape=([2, 1]))
in1Max68757 = tf.keras.layers.Input(shape=([2, 1]))

Add39238 = keras.layers.Add(name = 'Add39238', )([in0Add39238,in1Add39238])
ReL19311 = keras.layers.ReLU(max_value=9.606866807771773, negative_slope=8.940032489488766, threshold=0.28096421666644167, name = 'ReL19311', )(Add39238)
Res38873 = keras.layers.Reshape((1, 1, 1), name = 'Res38873', )(ReL19311)
Con14868 = keras.layers.Concatenate(axis=3, name = 'Con14868', )([Res38873,in0Con14868])
Max68757 = keras.layers.Maximum(name = 'Max68757', )([in0Max68757,in1Max68757])
Res95079 = keras.layers.Reshape((2, 1, 1), name = 'Res95079', )(Max68757)
Res81134 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res81134', )(Res95079)
Cro48021 = keras.layers.Cropping3D(cropping=((0, 1), (0, 0), (0, 0)), name = 'Cro48021', )(Res81134)
Res21646 = keras.layers.Reshape((1, 1, 1), name = 'Res21646', )(Cro48021)
Sep9992 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep9992', )(Res21646)
Mul15258 = keras.layers.Multiply(name = 'Mul15258', )([Con14868,Sep9992])
model = tf.keras.models.Model(inputs=[in0Add39238,in1Add39238,in0Con14868,in0Max68757,in1Max68757], outputs=Mul15258)
w = model.get_layer('Sep9992').get_weights() 
w[0] = np.array([[[[0.505]]]])
w[1] = np.array([[[[0.1656, 0.0331, 0.1185]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep9992').set_weights(w) 
in0Add39238 = tf.constant([[[0.836]]])
in1Add39238 = tf.constant([[[0.0316]]])
in0Con14868 = tf.constant([[[[0.8708, 0.7453]]]])
in0Max68757 = tf.constant([[[0.8872], [0.6855]]])
in1Max68757 = tf.constant([[[0.4147], [0.5994]]])
print (np.array2string(model.predict([in0Add39238,in1Add39238,in0Con14868,in0Max68757,in1Max68757],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul15258.png')

LAdd39238 = add_layer([[[[0.836]]], [[[0.0316]]]], Add39238), 
LReL19311 = relu_layer(Add39238, 9.606866807771773, 8.940032489488766, 0.28096421666644167, ReL19311), 
LRes38873 = reshape_layer(ReL19311, [1, 1, 1], Res38873), 
LCon14868 = concatenate_layer([Res38873,[[[[0.8708, 0.7453]]]]], 3, Con14868), 
LMax68757 = maximum_layer([[[[0.8872], [0.6855]]], [[[0.4147], [0.5994]]]], Max68757), 
LRes95079 = reshape_layer(Max68757, [2, 1, 1], Res95079), 
LRes81134 = reshape_layer(Res95079, [2, 1, 1, 1], Res81134), 
LCro48021 = cropping3D_layer(Res81134, 0, 1, 0, 0, 0, 0, Cro48021), 
LRes21646 = reshape_layer(Cro48021, [1, 1, 1], Res21646), 
LSep9992 = separable_conv2D_layer(Res21646, 1, 1,[[[[[0.505]]]],[[[[0.1656, 0.0331, 0.1185]]]]],[0, 0, 0], 1, 1, true, Sep9992), 
LMul15258 = multiply_layer([Con14868,Sep9992], Mul15258), 
exec_layers([LAdd39238,LReL19311,LRes38873,LCon14868,LMax68757,LRes95079,LRes81134,LCro48021,LRes21646,LSep9992,LMul15258],["Add39238","ReL19311","Res38873","Con14868","Max68757","Res95079","Res81134","Cro48021","Res21646","Sep9992","Mul15258"],Mul15258,"Mul15258")

Actual (Unparsed): [[[[0.0643714, 0.0129140, 0.0395697]]]]

Expected (Unparsed): [[[[0.06437137516415999,0.012913956685279998,0.0395696658498]]]]

Actual:   [[[[0.0644, 0.013, 0.0396]]]]

Expected: [[[[0.0644, 0.013, 0.0396]]]]