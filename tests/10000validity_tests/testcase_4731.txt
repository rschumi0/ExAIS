import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min66987 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Min66987 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Min66987 = keras.layers.Minimum(name = 'Min66987', )([in0Min66987,in1Min66987])
Res66653 = keras.layers.Reshape((2, 1, 2), name = 'Res66653', )(Min66987)
Loc81011 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc81011', )(Res66653)
Res75396 = keras.layers.Reshape((2, 1, 3, 1), name = 'Res75396', )(Loc81011)
Zer15748 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer15748', )(Res75396)
Res66759 = keras.layers.Reshape((4, 3, 5), name = 'Res66759', )(Zer15748)
Res78948 = keras.layers.Reshape((4, 15), name = 'Res78948', )(Res66759)
Con3811 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con3811', )(Res78948)
model = tf.keras.models.Model(inputs=[in0Min66987,in1Min66987], outputs=Con3811)
w = model.get_layer('Loc81011').get_weights() 
w[0] = np.array([[[0.146, 0.4818, 0.6121], [0.4217, 0.485, 0.9059]], [[0.2504, 0.9897, 0.475], [0.178, 0.3432, 0.7406]]])
w[1] = np.array([[[0, 0, 0]], [[0, 0, 0]]])
model.get_layer('Loc81011').set_weights(w) 
w = model.get_layer('Con3811').get_weights() 
w[0] = np.array([[[0.2666, 0.0886], [0.0615, 0.1866], [0.4725, 0.8262], [0.4231, 0.1651], [0.2918, 0.7278], [0.0525, 0.5435], [0.2357, 0.7257], [0.1014, 0.89], [0.8879, 0.6401], [0.1825, 0.8897], [0.0279, 0.9976], [0.6597, 0.8086], [0.967, 0.4691], [0.2454, 0.8342], [0.3021, 0.9405]]])
w[1] = np.array([0, 0])
model.get_layer('Con3811').set_weights(w) 
in0Min66987 = tf.constant([[[[[0.3012, 0.8426]]], [[[0.33, 0.6898]]]]])
in1Min66987 = tf.constant([[[[[0.0488, 0.1993]]], [[[0.5782, 0.4818]]]]])
print (np.array2string(model.predict([in0Min66987,in1Min66987],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con3811.png')

LMin66987 = minimum_layer([[[[[[0.3012, 0.8426]]], [[[0.33, 0.6898]]]]], [[[[[0.0488, 0.1993]]], [[[0.5782, 0.4818]]]]]], Min66987), 
LRes66653 = reshape_layer(Min66987, [2, 1, 2], Res66653), 
LLoc81011 = locally_connected2D_layer(Res66653, 1, 1,[[[0.146, 0.4818, 0.6121], [0.4217, 0.485, 0.9059]], [[0.2504, 0.9897, 0.475], [0.178, 0.3432, 0.7406]]],[[[0, 0, 0]], [[0, 0, 0]]], 1, 1, Loc81011), 
LRes75396 = reshape_layer(Loc81011, [2, 1, 3, 1], Res75396), 
LZer15748 = zero_padding3D_layer(Res75396, 1, 1, 1, 1, 1, 1, Zer15748), 
LRes66759 = reshape_layer(Zer15748, [4, 3, 5], Res66759), 
LRes78948 = reshape_layer(Res66759, [4, 15], Res78948), 
LCon3811 = conv1D_layer(Res78948, 1,[[[0.2666, 0.0886], [0.0615, 0.1866], [0.4725, 0.8262], [0.4231, 0.1651], [0.2918, 0.7278], [0.0525, 0.5435], [0.2357, 0.7257], [0.1014, 0.89], [0.8879, 0.6401], [0.1825, 0.8897], [0.0279, 0.9976], [0.6597, 0.8086], [0.967, 0.4691], [0.2454, 0.8342], [0.3021, 0.9405]]],[0, 0], 1, true, 1, Con3811), 
exec_layers([LMin66987,LRes66653,LLoc81011,LRes75396,LZer15748,LRes66759,LRes78948,LCon3811],["Min66987","Res66653","Loc81011","Res75396","Zer15748","Res66759","Res78948","Con3811"],Con3811,"Con3811")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.2205028, 0.3078027], [0.5455741, 0.8887790], [0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0],[0.22050282951800004,0.307802674212],[0.545574063276,0.8887789493880001],[0.0,0.0]]]

Actual:   [[[0, 0], [0.2206, 0.3079], [0.5456, 0.8888], [0, 0]]]

Expected: [[[0, 0], [0.2206, 0.3079], [0.5456, 0.8888], [0, 0]]]