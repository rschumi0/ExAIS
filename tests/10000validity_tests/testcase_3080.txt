import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU53232 = tf.keras.layers.Input(shape=([1, 2]))

GRU53232 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU53232', )(in0GRU53232)
Fla10972 = keras.layers.Flatten(name = 'Fla10972', )(GRU53232)
model = tf.keras.models.Model(inputs=[in0GRU53232], outputs=Fla10972)
w = model.get_layer('GRU53232').get_weights() 
w[0] = np.array([[2, 6, 6], [4, 8, 3]])
w[1] = np.array([[5, 4, 4]])
w[2] = np.array([[10, 2, 1], [9, 8, 9]])
model.get_layer('GRU53232').set_weights(w) 
in0GRU53232 = tf.constant([[[4, 3]]])
print (np.array2string(model.predict([in0GRU53232],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla10972.png')

LGRU53232 = gru_layer([[[4, 3]]],[[2, 6, 6], [4, 8, 3]],[[5, 4, 4]],[[10, 2, 1], [9, 8, 9]], true, GRU53232), 
LFla10972 = flatten_layer(GRU53232, Fla10972), 
exec_layers([LGRU53232,LFla10972],["GRU53232","Fla10972"],Fla10972,"Fla10972")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0.0]]

Actual:   [[0]]

Expected: [[0]]