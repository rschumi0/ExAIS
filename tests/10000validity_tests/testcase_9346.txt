import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con82090 = tf.keras.layers.Input(shape=([1, 2, 2]))

Con82090 = keras.layers.Conv2D(2, (1, 2),strides=(1, 2), padding='same', dilation_rate=(1, 1), name = 'Con82090', )(in0Con82090)
Res2279 = keras.layers.Reshape((1, 2), name = 'Res2279', )(Con82090)
Glo73908 = keras.layers.GlobalAveragePooling1D(name = 'Glo73908', )(Res2279)
Res49918 = keras.layers.Reshape((2, 1), name = 'Res49918', )(Glo73908)
Max3425 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='same', name = 'Max3425', )(Res49918)
model = tf.keras.models.Model(inputs=[in0Con82090], outputs=Max3425)
w = model.get_layer('Con82090').get_weights() 
w[0] = np.array([[[[0.3062, 0.8434], [0.3998, 0.9655]], [[0.4624, 0.9388], [0.9252, 0.765]]]])
w[1] = np.array([0, 0])
model.get_layer('Con82090').set_weights(w) 
in0Con82090 = tf.constant([[[[0.5096, 0.505], [0.3046, 0.6991]]]])
print (np.array2string(model.predict([in0Con82090],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max3425.png')

LCon82090 = conv2D_layer([[[[0.5096, 0.505], [0.3046, 0.6991]]]], 1, 2,[[[[0.3062, 0.8434], [0.3998, 0.9655]], [[0.4624, 0.9388], [0.9252, 0.765]]]],[0, 0], 1, 2, true, 1, 1, Con82090), 
LRes2279 = reshape_layer(Con82090, [1, 2], Res2279), 
LGlo73908 = global_average_pooling1D_layer(Res2279, Glo73908), 
LRes49918 = reshape_layer(Glo73908, [2, 1], Res49918), 
LMax3425 = max_pool1D_layer(Res49918, 1, 1, true, Max3425), 
exec_layers([LCon82090,LRes2279,LGlo73908,LRes49918,LMax3425],["Con82090","Res2279","Glo73908","Res49918","Max3425"],Max3425,"Max3425")

Actual (Unparsed): [[[1.1455929], [1.7381441]]]

Expected (Unparsed): [[[1.1455928800000001],[1.7381441200000003]]]

Actual:   [[[1.1456], [1.7382]]]

Expected: [[[1.1456], [1.7382]]]