import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max50751 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max50751 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Up_56825 = tf.keras.layers.Input(shape=([4, 2]))
in0Ave51566 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave51566 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con85103 = tf.keras.layers.Input(shape=([4, 1]))

Max50751 = keras.layers.Maximum(name = 'Max50751', )([in0Max50751,in1Max50751])
Res43221 = keras.layers.Reshape((1, 2), name = 'Res43221', )(Max50751)
Zer93155 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer93155', )(Res43221)
Up_56825 = keras.layers.UpSampling1D(size=(1), name = 'Up_56825', )(in0Up_56825)
Ave51566 = keras.layers.Average(name = 'Ave51566', )([in0Ave51566,in1Ave51566])
Res30734 = keras.layers.Reshape((1, 2), name = 'Res30734', )(Ave51566)
Dot30510 = keras.layers.Dot(axes=(2, 2), name = 'Dot30510', )([Up_56825,Res30734])
Con85103 = keras.layers.Concatenate(axis=2, name = 'Con85103', )([Dot30510,in0Con85103])
Sub59104 = keras.layers.Subtract(name = 'Sub59104', )([Zer93155,Con85103])
model = tf.keras.models.Model(inputs=[in0Max50751,in1Max50751,in0Up_56825,in0Ave51566,in1Ave51566,in0Con85103], outputs=Sub59104)
in0Max50751 = tf.constant([[[[0.4315], [0.3723]]]])
in1Max50751 = tf.constant([[[[0.5533], [0.6469]]]])
in0Up_56825 = tf.constant([[[1.1445, 1.186], [1.7952, 1.2366], [1.7372, 1.3176], [1.8793, 1.4347]]])
in0Ave51566 = tf.constant([[[[0.7502], [0.5826]]]])
in1Ave51566 = tf.constant([[[[0.5179], [0.6914]]]])
in0Con85103 = tf.constant([[[0.0755], [0.8594], [0.9074], [0.2197]]])
print (np.array2string(model.predict([in0Max50751,in1Max50751,in0Up_56825,in0Ave51566,in1Ave51566,in0Con85103],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub59104.png')

LMax50751 = maximum_layer([[[[[0.4315], [0.3723]]]], [[[[0.5533], [0.6469]]]]], Max50751), 
LRes43221 = reshape_layer(Max50751, [1, 2], Res43221), 
LZer93155 = zero_padding1D_layer(Res43221, 3, 0, Zer93155), 
LUp_56825 = up_sampling1D_layer([[[1.1445, 1.186], [1.7952, 1.2366], [1.7372, 1.3176], [1.8793, 1.4347]]], 1, Up_56825), 
LAve51566 = average_layer([[[[[0.7502], [0.5826]]]], [[[[0.5179], [0.6914]]]]], Ave51566), 
LRes30734 = reshape_layer(Ave51566, [1, 2], Res30734), 
LDot30510 = dot_layer(Up_56825,Res30734, 2, 2, Dot30510), 
LCon85103 = concatenate_layer([Dot30510,[[[0.0755], [0.8594], [0.9074], [0.2197]]]], 2, Con85103), 
LSub59104 = subtract_layer(Zer93155,Con85103, Sub59104), 
exec_layers([LMax50751,LRes43221,LZer93155,LUp_56825,LAve51566,LRes30734,LDot30510,LCon85103,LSub59104],["Max50751","Res43221","Zer93155","Up_56825","Ave51566","Res30734","Dot30510","Con85103","Sub59104"],Sub59104,"Sub59104")

Actual (Unparsed): [[[-1.4811522, -0.0755000], [-1.9259607, -0.8594000], [-1.9407828, -0.9074000], [-1.5521740, 0.4272000]]]

Expected (Unparsed): [[[-1.481152225,-0.0755],[-1.92596076,-0.8594],[-1.94078286,-0.9074],[-1.552174065,0.4272]]]

Actual:   [[[-1.4811, -0.0755], [-1.9259, -0.8594], [-1.9407, -0.9074], [-1.5521, 0.4272]]]

Expected: [[[-1.4811, -0.0755], [-1.9259, -0.8594], [-1.9407, -0.9074], [-1.5521, 0.4272]]]