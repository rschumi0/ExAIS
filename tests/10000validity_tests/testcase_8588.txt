import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL84186 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dep96356 = tf.keras.layers.Input(shape=([1, 1, 2]))

ReL84186 = keras.layers.ReLU(max_value=4.641081097507684, negative_slope=7.932571924125322, threshold=9.06900993669706, name = 'ReL84186', input_shape=(2, 2, 2))(in0ReL84186)
Dep96356 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep96356', )(in0Dep96356)
Zer8109 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer8109', )(Dep96356)
Sub60476 = keras.layers.Subtract(name = 'Sub60476', )([ReL84186,Zer8109])
Lay17070 = keras.layers.LayerNormalization(axis=1, epsilon=1.355352267367529, name = 'Lay17070', )(Sub60476)
Res58340 = keras.layers.Reshape((2, 4), name = 'Res58340', )(Lay17070)
Sep4579 = keras.layers.SeparableConv1D(3, (1),strides=(2), padding='valid', name = 'Sep4579', )(Res58340)
ReL62998 = keras.layers.ReLU(max_value=2.0049210018061663, negative_slope=4.43324493045105, threshold=1.6460376082162231, name = 'ReL62998', )(Sep4579)
model = tf.keras.models.Model(inputs=[in0ReL84186,in0Dep96356], outputs=ReL62998)
w = model.get_layer('Dep96356').get_weights() 
w[0] = np.array([[[[0.2803], [0.396]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep96356').set_weights(w) 
w = model.get_layer('Sep4579').get_weights() 
w[0] = np.array([[[0.9474], [0.9166], [0.5366], [0.9054]]])
w[1] = np.array([[[0.187, 0.0138, 0.8239], [0.8845, 0.812, 0.6975], [0.2857, 0.0448, 0.3891], [0.9478, 0.7239, 0.0356]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep4579').set_weights(w) 
in0ReL84186 = tf.constant([[[[0.4972, 0.145], [0.5695, 0.5356]], [[0.9409, 0.5623], [0.1094, 0.4236]]]])
in0Dep96356 = tf.constant([[[[0.733, 0.4368]]]])
print (np.array2string(model.predict([in0ReL84186,in0Dep96356],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL62998.png')

LReL84186 = relu_layer([[[[0.4972, 0.145], [0.5695, 0.5356]], [[0.9409, 0.5623], [0.1094, 0.4236]]]], 4.641081097507684, 7.932571924125322, 9.06900993669706, ReL84186), 
LDep96356 = depthwise_conv2D_layer([[[[0.733, 0.4368]]]], 1, 1,[[[[0.2803], [0.396]]]],[0, 0], 1, 1, true, Dep96356), 
LZer8109 = zero_padding2D_layer(Dep96356, 1, 0, 1, 0, Zer8109), 
LSub60476 = subtract_layer(ReL84186,Zer8109, Sub60476), 
LLay17070 = layer_normalization_layer(Sub60476, 1, 1.355352267367529, Lay17070), 
LRes58340 = reshape_layer(Lay17070, [2, 4], Res58340), 
LSep4579 = separable_conv1D_layer(Res58340, 1,[[[[0.9474], [0.9166], [0.5366], [0.9054]]],[[[0.187, 0.0138, 0.8239], [0.8845, 0.812, 0.6975], [0.2857, 0.0448, 0.3891], [0.9478, 0.7239, 0.0356]]]],[0, 0, 0], 2, false, Sep4579), 
LReL62998 = relu_layer(Sep4579, 2.0049210018061663, 4.43324493045105, 1.6460376082162231, ReL62998), 
exec_layers([LReL84186,LDep96356,LZer8109,LSub60476,LLay17070,LRes58340,LSep4579,LReL62998],["ReL84186","Dep96356","Zer8109","Sub60476","Lay17070","Res58340","Sep4579","ReL62998"],ReL62998,"ReL62998")

Actual (Unparsed): [[[-8.7323267, -8.7479770, -11.6500101]]]

Expected (Unparsed): [[[-8.732326824332556,-8.74797703303908,-11.650010048511648]]]

Actual:   [[[-8.7323, -8.7479, -11.65]]]

Expected: [[[-8.7323, -8.7479, -11.65]]]