import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add73037 = tf.keras.layers.Input(shape=([2, 2]))
in1Add73037 = tf.keras.layers.Input(shape=([2, 2]))
in0Glo76681 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con24534 = tf.keras.layers.Input(shape=([14]))
in0Con96099 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Sub93953 = tf.keras.layers.Input(shape=([2]))
in1Sub93953 = tf.keras.layers.Input(shape=([2]))
in0Con55750 = tf.keras.layers.Input(shape=([4]))
in0Con90533 = tf.keras.layers.Input(shape=([10]))

Add73037 = keras.layers.Add(name = 'Add73037', )([in0Add73037,in1Add73037])
Res37560 = keras.layers.Reshape((2, 2, 1), name = 'Res37560', )(Add73037)
Con42232 = keras.layers.Conv2DTranspose(4, (1, 1),strides=(1, 1), padding='valid', name = 'Con42232', )(Res37560)
Res3644 = keras.layers.Reshape((2, 8), name = 'Res3644', )(Con42232)
Fla94588 = keras.layers.Flatten(name = 'Fla94588', )(Res3644)
Glo76681 = keras.layers.GlobalMaxPool2D(name = 'Glo76681', )(in0Glo76681)
Con24534 = keras.layers.Concatenate(axis=1, name = 'Con24534', )([Glo76681,in0Con24534])
Max67428 = keras.layers.Maximum(name = 'Max67428', )([Fla94588,Con24534])
Con96099 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con96099', )(in0Con96099)
Res18974 = keras.layers.Reshape((2, 2), name = 'Res18974', )(Con96099)
Con39390 = keras.layers.Conv1D(3, (2),strides=(1), padding='same', dilation_rate=(1), name = 'Con39390', )(Res18974)
Ave71190 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave71190', )(Con39390)
Fla38627 = keras.layers.Flatten(name = 'Fla38627', )(Ave71190)
Sub93953 = keras.layers.Subtract(name = 'Sub93953', )([in0Sub93953,in1Sub93953])
Con55750 = keras.layers.Concatenate(axis=1, name = 'Con55750', )([Sub93953,in0Con55750])
Ave32185 = keras.layers.Average(name = 'Ave32185', )([Fla38627,Con55750])
Con90533 = keras.layers.Concatenate(axis=1, name = 'Con90533', )([Ave32185,in0Con90533])
Max84408 = keras.layers.Maximum(name = 'Max84408', )([Max67428,Con90533])
model = tf.keras.models.Model(inputs=[in0Add73037,in1Add73037,in0Glo76681,in0Con24534,in0Con96099,in0Sub93953,in1Sub93953,in0Con55750,in0Con90533], outputs=Max84408)
w = model.get_layer('Con42232').get_weights() 
w[0] = np.array([[[[0.9812], [0.3824], [0.8458], [0.6321]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con42232').set_weights(w) 
w = model.get_layer('Con96099').get_weights() 
w[0] = np.array([[[[0.7879, 0.5835]]]])
w[1] = np.array([0, 0])
model.get_layer('Con96099').set_weights(w) 
w = model.get_layer('Con39390').get_weights() 
w[0] = np.array([[[0.9911, 0.1807, 0.7292], [0.627, 0.6512, 0.451]], [[0.4901, 0.4024, 0.2593], [0.9631, 0.3407, 0.1598]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con39390').set_weights(w) 
in0Add73037 = tf.constant([[[0.9391, 0.6316], [0.3364, 0.0822]]])
in1Add73037 = tf.constant([[[0.3239, 0.1661], [0.6442, 0.1857]]])
in0Glo76681 = tf.constant([[[[1.0435, 1.8772]], [[1.4675, 1.6465]]]])
in0Con24534 = tf.constant([[0.6116, 0.2518, 0.9072, 0.2832, 0.6849, 0.7244, 0.9566, 0.4721, 0.516, 0.0837, 0.9166, 0.1966, 0.2426, 0.6169]])
in0Con96099 = tf.constant([[[[0.4714]], [[0.23]]]])
in0Sub93953 = tf.constant([[0.8499, 0.6762]])
in1Sub93953 = tf.constant([[0.2834, 0.8572]])
in0Con55750 = tf.constant([[0.9525, 0.4834, 0.9146, 0.4169]])
in0Con90533 = tf.constant([[0.0881, 0.7735, 0.696, 0.5286, 0.3876, 0.0287, 0.7991, 0.7246, 0.4, 0.6267]])
print (np.array2string(model.predict([in0Add73037,in1Add73037,in0Glo76681,in0Con24534,in0Con96099,in0Sub93953,in1Sub93953,in0Con55750,in0Con90533],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max84408.png')

LAdd73037 = add_layer([[[[0.9391, 0.6316], [0.3364, 0.0822]]], [[[0.3239, 0.1661], [0.6442, 0.1857]]]], Add73037), 
LRes37560 = reshape_layer(Add73037, [2, 2, 1], Res37560), 
LCon42232 = conv2D_transpose_layer(Res37560, 1, 1,[[[[0.9812], [0.3824], [0.8458], [0.6321]]]],[0, 0, 0, 0], 1, 1, false, Con42232), 
LRes3644 = reshape_layer(Con42232, [2, 8], Res3644), 
LFla94588 = flatten_layer(Res3644, Fla94588), 
LGlo76681 = global_max_pool2D_layer([[[[1.0435, 1.8772]], [[1.4675, 1.6465]]]], Glo76681), 
LCon24534 = concatenate_layer([Glo76681,[[0.6116, 0.2518, 0.9072, 0.2832, 0.6849, 0.7244, 0.9566, 0.4721, 0.516, 0.0837, 0.9166, 0.1966, 0.2426, 0.6169]]], 1, Con24534), 
LMax67428 = maximum_layer([Fla94588,Con24534], Max67428), 
LCon96099 = conv2D_layer([[[[0.4714]], [[0.23]]]], 1, 1,[[[[0.7879, 0.5835]]]],[0, 0], 1, 1, false, 1, 1, Con96099), 
LRes18974 = reshape_layer(Con96099, [2, 2], Res18974), 
LCon39390 = conv1D_layer(Res18974, 2,[[[0.9911, 0.1807, 0.7292], [0.627, 0.6512, 0.451]], [[0.4901, 0.4024, 0.2593], [0.9631, 0.3407, 0.1598]]],[0, 0, 0], 1, true, 1, Con39390), 
LAve71190 = average_pooling1D_layer(Con39390, 1, Ave71190), 
LFla38627 = flatten_layer(Ave71190, Fla38627), 
LSub93953 = subtract_layer([[0.8499, 0.6762]], [[0.2834, 0.8572]], Sub93953), 
LCon55750 = concatenate_layer([Sub93953,[[0.9525, 0.4834, 0.9146, 0.4169]]], 1, Con55750), 
LAve32185 = average_layer([Fla38627,Con55750], Ave32185), 
LCon90533 = concatenate_layer([Ave32185,[[0.0881, 0.7735, 0.696, 0.5286, 0.3876, 0.0287, 0.7991, 0.7246, 0.4, 0.6267]]], 1, Con90533), 
LMax84408 = maximum_layer([Max67428,Con90533], Max84408), 
exec_layers([LAdd73037,LRes37560,LCon42232,LRes3644,LFla94588,LGlo76681,LCon24534,LMax67428,LCon96099,LRes18974,LCon39390,LAve71190,LFla38627,LSub93953,LCon55750,LAve32185,LCon90533,LMax84408],["Add73037","Res37560","Con42232","Res3644","Fla94588","Glo76681","Con24534","Max67428","Con96099","Res18974","Con39390","Ave71190","Fla38627","Sub93953","Con55750","Ave32185","Con90533","Max84408"],Max84408,"Max84408")

Actual (Unparsed): [[1.4675000, 1.8772000, 1.0682454, 0.7983423, 0.9072000, 0.3050405, 0.6849000, 0.7735000, 0.9621647, 0.5286000, 0.8293915, 0.6198373, 0.9166000, 0.7246000, 0.4000000, 0.6267000]]

Expected (Unparsed): [[1.4675,1.8772,1.0682454000000001,0.7983423000000001,0.9072,0.30504048000000006,0.6849,0.7735,0.9621647199999999,0.5286,0.82939148,0.61983726,0.9166,0.7246,0.4,0.6267]]

Actual:   [[1.4675, 1.8772, 1.0683, 0.7984, 0.9072, 0.3051, 0.6849, 0.7735, 0.9622, 0.5286, 0.8294, 0.6199, 0.9166, 0.7246, 0.4, 0.6267]]

Expected: [[1.4675, 1.8772, 1.0683, 0.7984, 0.9072, 0.3051, 0.6849, 0.7735, 0.9622, 0.5286, 0.8294, 0.6199, 0.9166, 0.7246, 0.4, 0.6267]]