import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max32560 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Max32560 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Max32560 = keras.layers.Maximum(name = 'Max32560', )([in0Max32560,in1Max32560])
Res89796 = keras.layers.Reshape((2, 1, 1), name = 'Res89796', )(Max32560)
Res89461 = keras.layers.Reshape((2, 1), name = 'Res89461', )(Res89796)
Loc25038 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc25038', )(Res89461)
Res85346 = keras.layers.Reshape((2, 2, 1), name = 'Res85346', )(Loc25038)
Res8743 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res8743', )(Res85346)
Glo27047 = keras.layers.GlobalAveragePooling3D(name = 'Glo27047', )(Res8743)
model = tf.keras.models.Model(inputs=[in0Max32560,in1Max32560], outputs=Glo27047)
w = model.get_layer('Loc25038').get_weights() 
w[0] = np.array([[[0.6358, 0.6907]], [[0.3173, 0.4186]]])
w[1] = np.array([[0, 0], [0, 0]])
model.get_layer('Loc25038').set_weights(w) 
in0Max32560 = tf.constant([[[[[0.3499]]], [[[0.7913]]]]])
in1Max32560 = tf.constant([[[[[0.5796]]], [[[0.5927]]]]])
print (np.array2string(model.predict([in0Max32560,in1Max32560],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo27047.png')

LMax32560 = maximum_layer([[[[[[0.3499]]], [[[0.7913]]]]], [[[[[0.5796]]], [[[0.5927]]]]]], Max32560), 
LRes89796 = reshape_layer(Max32560, [2, 1, 1], Res89796), 
LRes89461 = reshape_layer(Res89796, [2, 1], Res89461), 
LLoc25038 = locally_connected1D_layer(Res89461, 1,[[[0.6358, 0.6907]], [[0.3173, 0.4186]]],[[0, 0], [0, 0]], 1, Loc25038), 
LRes85346 = reshape_layer(Loc25038, [2, 2, 1], Res85346), 
LRes8743 = reshape_layer(Res85346, [2, 2, 1, 1], Res8743), 
LGlo27047 = global_average_pooling3D_layer(Res8743, Glo27047), 
exec_layers([LMax32560,LRes89796,LRes89461,LLoc25038,LRes85346,LRes8743,LGlo27047],["Max32560","Res89796","Res89461","Loc25038","Res85346","Res8743","Glo27047"],Glo27047,"Glo27047")

Actual (Unparsed): [[0.3377893]]

Expected (Unparsed): [[0.33778926750000005]]

Actual:   [[0.3378]]

Expected: [[0.3378]]