import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave34885 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Ave34885 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Ave59564 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave59564 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dot70167 = tf.keras.layers.Input(shape=([2]))
in1Dot70167 = tf.keras.layers.Input(shape=([2]))

Ave34885 = keras.layers.Average(name = 'Ave34885', )([in0Ave34885,in1Ave34885])
Res70157 = keras.layers.Reshape((1, 2, 2), name = 'Res70157', )(Ave34885)
Zer2195 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer2195', )(Res70157)
Ave59564 = keras.layers.Average(name = 'Ave59564', )([in0Ave59564,in1Ave59564])
Up_12449 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_12449', )(Ave59564)
Max323 = keras.layers.Maximum(name = 'Max323', )([Zer2195,Up_12449])
Res15634 = keras.layers.Reshape((2, 4, 2, 1), name = 'Res15634', )(Max323)
Zer87783 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer87783', )(Res15634)
Res89681 = keras.layers.Reshape((4, 6, 4), name = 'Res89681', )(Zer87783)
Dot70167 = keras.layers.Dot(axes=(1, 1), name = 'Dot70167', )([in0Dot70167,in1Dot70167])
Res89037 = keras.layers.Reshape((1, 1), name = 'Res89037', )(Dot70167)
Res41563 = keras.layers.Reshape((1, 1, 1), name = 'Res41563', )(Res89037)
Sep8391 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep8391', )(Res41563)
Up_8625 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_8625', )(Sep8391)
Zer26166 = keras.layers.ZeroPadding2D(padding=((2, 0), (5, 0)), name = 'Zer26166', )(Up_8625)
Ave72378 = keras.layers.Average(name = 'Ave72378', )([Res89681,Zer26166])
model = tf.keras.models.Model(inputs=[in0Ave34885,in1Ave34885,in0Ave59564,in1Ave59564,in0Dot70167,in1Dot70167], outputs=Ave72378)
w = model.get_layer('Sep8391').get_weights() 
w[0] = np.array([[[[0.1474]]]])
w[1] = np.array([[[[0.1415, 0.8312, 0.9263, 0.497]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep8391').set_weights(w) 
in0Ave34885 = tf.constant([[[[[0.0417, 0.535]], [[0.586, 0.1131]]]]])
in1Ave34885 = tf.constant([[[[[0.7053, 0.6627]], [[0.0664, 0.0806]]]]])
in0Ave59564 = tf.constant([[[[0.0198, 0.85], [0.0153, 0.1807]]]])
in1Ave59564 = tf.constant([[[[0.8747, 0.8293], [0.6393, 0.1674]]]])
in0Dot70167 = tf.constant([[0.3147, 0.1992]])
in1Dot70167 = tf.constant([[0.6925, 0.7512]])
print (np.array2string(model.predict([in0Ave34885,in1Ave34885,in0Ave59564,in1Ave59564,in0Dot70167,in1Dot70167],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave72378.png')

LAve34885 = average_layer([[[[[[0.0417, 0.535]], [[0.586, 0.1131]]]]], [[[[[0.7053, 0.6627]], [[0.0664, 0.0806]]]]]], Ave34885), 
LRes70157 = reshape_layer(Ave34885, [1, 2, 2], Res70157), 
LZer2195 = zero_padding2D_layer(Res70157, 1, 0, 2, 0, Zer2195), 
LAve59564 = average_layer([[[[[0.0198, 0.85], [0.0153, 0.1807]]]], [[[[0.8747, 0.8293], [0.6393, 0.1674]]]]], Ave59564), 
LUp_12449 = up_sampling2D_layer(Ave59564, 2, 2, Up_12449), 
LMax323 = maximum_layer([Zer2195,Up_12449], Max323), 
LRes15634 = reshape_layer(Max323, [2, 4, 2, 1], Res15634), 
LZer87783 = zero_padding3D_layer(Res15634, 1, 1, 1, 1, 1, 1, Zer87783), 
LRes89681 = reshape_layer(Zer87783, [4, 6, 4], Res89681), 
LDot70167 = dot_layer([[0.3147, 0.1992]], [[0.6925, 0.7512]], 1, 1, Dot70167), 
LRes89037 = reshape_layer(Dot70167, [1, 1], Res89037), 
LRes41563 = reshape_layer(Res89037, [1, 1, 1], Res41563), 
LSep8391 = separable_conv2D_layer(Res41563, 1, 1,[[[[[0.1474]]]],[[[[0.1415, 0.8312, 0.9263, 0.497]]]]],[0, 0, 0, 0], 1, 1, false, Sep8391), 
LUp_8625 = up_sampling2D_layer(Sep8391, 2, 1, Up_8625), 
LZer26166 = zero_padding2D_layer(Up_8625, 2, 0, 5, 0, Zer26166), 
LAve72378 = average_layer([Res89681,Zer26166], Ave72378), 
exec_layers([LAve34885,LRes70157,LZer2195,LAve59564,LUp_12449,LMax323,LRes15634,LZer87783,LRes89681,LDot70167,LRes89037,LRes41563,LSep8391,LUp_8625,LZer26166,LAve72378],["Ave34885","Res70157","Zer2195","Ave59564","Up_12449","Max323","Res15634","Zer87783","Res89681","Dot70167","Res89037","Res41563","Sep8391","Up_8625","Zer26166","Ave72378"],Ave72378,"Ave72378")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.2236250, 0.4198250, 0.0000000], [0.0000000, 0.2236250, 0.4198250, 0.0000000], [0.0000000, 0.1636500, 0.0870250, 0.0000000], [0.0000000, 0.1636500, 0.0870250, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.2236250, 0.4198250, 0.0000000], [0.0000000, 0.2236250, 0.4198250, 0.0000000], [0.0000000, 0.1867500, 0.2994250, 0.0000000], [0.0000000, 0.1636500, 0.0870250, 0.0000000], [0.0038332, 0.0225171, 0.0250933, 0.0134636]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0038332, 0.0225171, 0.0250933, 0.0134636]]]]

Expected (Unparsed): [[[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[0,0.22362500000000002,0.419825,0],[0,0.22362500000000002,0.419825,0],[0,0.16365,0.08702499999999999,0],[0,0.16365,0.08702499999999999,0],[0,0,0,0]],[[0,0,0,0],[0,0.22362500000000002,0.419825,0],[0,0.22362500000000002,0.419825,0],[0,0.18675,0.299425,0],[0,0.16365,0.08702499999999999,0],[0.0038332095049544994,0.0225170582368776,0.0250933001020449,0.013463640452031]],[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0.0038332095049544994,0.0225170582368776,0.0250933001020449,0.013463640452031]]]]

Actual:   [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0.2237, 0.4199, 0], [0, 0.2237, 0.4199, 0], [0, 0.1637, 0.0871, 0], [0, 0.1637, 0.0871, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0.2237, 0.4199, 0], [0, 0.2237, 0.4199, 0], [0, 0.1868, 0.2995, 0], [0, 0.1637, 0.0871, 0], [0.0039, 0.0226, 0.0251, 0.0135]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0.0039, 0.0226, 0.0251, 0.0135]]]]

Expected: [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0.2237, 0.4199, 0], [0, 0.2237, 0.4199, 0], [0, 0.1637, 0.0871, 0], [0, 0.1637, 0.0871, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0.2237, 0.4199, 0], [0, 0.2237, 0.4199, 0], [0, 0.1868, 0.2995, 0], [0, 0.1637, 0.0871, 0], [0.0039, 0.0226, 0.0251, 0.0135]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0.0039, 0.0226, 0.0251, 0.0135]]]]