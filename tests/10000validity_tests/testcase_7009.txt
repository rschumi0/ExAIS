import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot43892 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot43892 = tf.keras.layers.Input(shape=([2, 3]))
in0Con38058 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Min91572 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Min91572 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Dot43892 = keras.layers.Dot(axes=(2, 2), name = 'Dot43892', )([in0Dot43892,in1Dot43892])
Res60529 = keras.layers.Reshape((2, 2, 1), name = 'Res60529', )(Dot43892)
Ave63521 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave63521', )(Res60529)
Res15190 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res15190', )(Ave63521)
Con38058 = keras.layers.Concatenate(axis=4, name = 'Con38058', )([Res15190,in0Con38058])
Min91572 = keras.layers.Minimum(name = 'Min91572', )([in0Min91572,in1Min91572])
Zer83003 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer83003', )(Min91572)
Mul97929 = keras.layers.Multiply(name = 'Mul97929', )([Con38058,Zer83003])
Mas90644 = keras.layers.Masking(mask_value=1, name = 'Mas90644', )(Mul97929)
model = tf.keras.models.Model(inputs=[in0Dot43892,in1Dot43892,in0Con38058,in0Min91572,in1Min91572], outputs=Mas90644)
in0Dot43892 = tf.constant([[[0.6562, 0.1832, 0.4269], [0.3149, 0.2894, 0.6798]]])
in1Dot43892 = tf.constant([[[0.2235, 0.1854, 0.2466], [0.9173, 0.1558, 0.8457]]])
in0Con38058 = tf.constant([[[[[0.5448]], [[0.5342]]], [[[0.7282]], [[0.6179]]]]])
in0Min91572 = tf.constant([[[[[0.7999, 0.2382]]]]])
in1Min91572 = tf.constant([[[[[0.3578, 0.4115]]]]])
print (np.array2string(model.predict([in0Dot43892,in1Dot43892,in0Con38058,in0Min91572,in1Min91572],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas90644.png')

LDot43892 = dot_layer([[[0.6562, 0.1832, 0.4269], [0.3149, 0.2894, 0.6798]]], [[[0.2235, 0.1854, 0.2466], [0.9173, 0.1558, 0.8457]]], 2, 2, Dot43892), 
LRes60529 = reshape_layer(Dot43892, [2, 2, 1], Res60529), 
LAve63521 = average_pooling2D_layer(Res60529, 1, 1, Ave63521), 
LRes15190 = reshape_layer(Ave63521, [2, 2, 1, 1], Res15190), 
LCon38058 = concatenate_layer([Res15190,[[[[[0.5448]], [[0.5342]]], [[[0.7282]], [[0.6179]]]]]], 4, Con38058), 
LMin91572 = minimum_layer([[[[[[0.7999, 0.2382]]]]], [[[[[0.3578, 0.4115]]]]]], Min91572), 
LZer83003 = zero_padding3D_layer(Min91572, 1, 0, 1, 0, 0, 0, Zer83003), 
LMul97929 = multiply_layer([Con38058,Zer83003], Mul97929), 
LMas90644 = masking_layer(Mul97929, 1, Mas90644), 
exec_layers([LDot43892,LRes60529,LAve63521,LRes15190,LCon38058,LMin91572,LZer83003,LMul97929,LMas90644],["Dot43892","Res60529","Ave63521","Res15190","Con38058","Min91572","Zer83003","Mul97929","Mas90644"],Mas90644,"Mas90644")

Actual (Unparsed): [[[[[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000]], [[0.3251877, 0.1471838]]]]]

Expected (Unparsed): [[[[[0.0,0.0]],[[0.0,0.0]]],[[[0.0,0.0]],[[0.32518765707,0.14718378]]]]]

Actual:   [[[[[0, 0]], [[0, 0]]], [[[0, 0]], [[0.3252, 0.1472]]]]]

Expected: [[[[[0, 0]], [[0, 0]]], [[[0, 0]], [[0.3252, 0.1472]]]]]