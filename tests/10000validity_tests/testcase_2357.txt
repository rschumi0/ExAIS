import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min67698 = tf.keras.layers.Input(shape=([1, 1]))
in1Min67698 = tf.keras.layers.Input(shape=([1, 1]))
in0Con19055 = tf.keras.layers.Input(shape=([2, 2]))
in0Max46743 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Max46743 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Con92679 = tf.keras.layers.Input(shape=([4]))
in0Min63918 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Min63918 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Con80662 = tf.keras.layers.Input(shape=([1]))

Min67698 = keras.layers.Minimum(name = 'Min67698', )([in0Min67698,in1Min67698])
Res34247 = keras.layers.Reshape((1, 1, 1), name = 'Res34247', )(Min67698)
Ave90399 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Ave90399', )(Res34247)
Res82598 = keras.layers.Reshape((1, 1), name = 'Res82598', )(Ave90399)
Sim97392 = keras.layers.SimpleRNN(2,name = 'Sim97392', )(Res82598)
Con19055 = keras.layers.Conv1D(4, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con19055', )(in0Con19055)
Res49904 = keras.layers.Reshape((1, 4, 1), name = 'Res49904', )(Con19055)
Dep70313 = keras.layers.DepthwiseConv2D((1, 3),strides=(1, 1), padding='valid', name = 'Dep70313', )(Res49904)
Res28727 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res28727', )(Dep70313)
Zer21909 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer21909', )(Res28727)
Max46743 = keras.layers.Maximum(name = 'Max46743', )([in0Max46743,in1Max46743])
Sub67245 = keras.layers.Subtract(name = 'Sub67245', )([Zer21909,Max46743])
Res5314 = keras.layers.Reshape((1, 2, 2), name = 'Res5314', )(Sub67245)
Res93008 = keras.layers.Reshape((1, 4), name = 'Res93008', )(Res5314)
Fla29766 = keras.layers.Flatten(name = 'Fla29766', )(Res93008)
Con92679 = keras.layers.Concatenate(axis=1, name = 'Con92679', )([Fla29766,in0Con92679])
Min63918 = keras.layers.Minimum(name = 'Min63918', )([in0Min63918,in1Min63918])
Fla94322 = keras.layers.Flatten(name = 'Fla94322', )(Min63918)
Dot12013 = keras.layers.Dot(axes=(1, 1), name = 'Dot12013', )([Con92679,Fla94322])
Con80662 = keras.layers.Concatenate(axis=1, name = 'Con80662', )([Dot12013,in0Con80662])
Max61452 = keras.layers.Maximum(name = 'Max61452', )([Sim97392,Con80662])
model = tf.keras.models.Model(inputs=[in0Min67698,in1Min67698,in0Con19055,in0Max46743,in1Max46743,in0Con92679,in0Min63918,in1Min63918,in0Con80662], outputs=Max61452)
w = model.get_layer('Sim97392').get_weights() 
w[0] = np.array([[6, 9]])
w[1] = np.array([[8, 6], [10, 2]])
w[2] = np.array([10, 2])
model.get_layer('Sim97392').set_weights(w) 
w = model.get_layer('Con19055').get_weights() 
w[0] = np.array([[[0.7573, 0.9134, 0.5718, 0.334], [0.3395, 0.237, 0.8349, 0.041]], [[0.7982, 0.6707, 0.3348, 0.4719], [0.5959, 0.1292, 0.4639, 0.3657]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con19055').set_weights(w) 
w = model.get_layer('Dep70313').get_weights() 
w[0] = np.array([[[[0.6424]], [[0.118]], [[0.1482]]]])
w[1] = np.array([0])
model.get_layer('Dep70313').set_weights(w) 
in0Min67698 = tf.constant([[[0.6956]]])
in1Min67698 = tf.constant([[[0.4067]]])
in0Con19055 = tf.constant([[[0.8457, 0.3959], [0.5896, 0.2232]]])
in0Max46743 = tf.constant([[[[[0.6521], [0.6594]], [[0.5876], [0.8791]]]]])
in1Max46743 = tf.constant([[[[[0.2003], [0.6789]], [[0.1023], [0.8475]]]]])
in0Con92679 = tf.constant([[0.1924, 0.6575, 0.6808, 0.3253]])
in0Min63918 = tf.constant([[[[[0.3151, 0.4814]], [[0.2504, 0.6811]]], [[[0.0259, 0.3019]], [[0.6528, 0.4902]]]]])
in1Min63918 = tf.constant([[[[[0.1608, 0.1688]], [[0.6344, 0.5676]]], [[[0.5636, 0.2899]], [[0.9485, 0.2936]]]]])
in0Con80662 = tf.constant([[0.4885]])
print (np.array2string(model.predict([in0Min67698,in1Min67698,in0Con19055,in0Max46743,in1Max46743,in0Con92679,in0Min63918,in1Min63918,in0Con80662],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max61452.png')

LMin67698 = minimum_layer([[[[0.6956]]], [[[0.4067]]]], Min67698), 
LRes34247 = reshape_layer(Min67698, [1, 1, 1], Res34247), 
LAve90399 = average_pooling2D_layer(Res34247, 1, 1, 1, 1, true, Ave90399), 
LRes82598 = reshape_layer(Ave90399, [1, 1], Res82598), 
LSim97392 = simple_rnn_layer(Res82598,[[6, 9]],[[8, 6], [10, 2]],[10, 2], Sim97392), 
LCon19055 = conv1D_layer([[[0.8457, 0.3959], [0.5896, 0.2232]]], 2,[[[0.7573, 0.9134, 0.5718, 0.334], [0.3395, 0.237, 0.8349, 0.041]], [[0.7982, 0.6707, 0.3348, 0.4719], [0.5959, 0.1292, 0.4639, 0.3657]]],[0, 0, 0, 0], 1, false, 1, Con19055), 
LRes49904 = reshape_layer(Con19055, [1, 4, 1], Res49904), 
LDep70313 = depthwise_conv2D_layer(Res49904, 1, 3,[[[[0.6424]], [[0.118]], [[0.1482]]]],[0], 1, 1, false, Dep70313), 
LRes28727 = reshape_layer(Dep70313, [1, 2, 1, 1], Res28727), 
LZer21909 = zero_padding3D_layer(Res28727, 0, 0, 0, 0, 1, 0, Zer21909), 
LMax46743 = maximum_layer([[[[[[0.6521], [0.6594]], [[0.5876], [0.8791]]]]], [[[[[0.2003], [0.6789]], [[0.1023], [0.8475]]]]]], Max46743), 
LSub67245 = subtract_layer(Zer21909,Max46743, Sub67245), 
LRes5314 = reshape_layer(Sub67245, [1, 2, 2], Res5314), 
LRes93008 = reshape_layer(Res5314, [1, 4], Res93008), 
LFla29766 = flatten_layer(Res93008, Fla29766), 
LCon92679 = concatenate_layer([Fla29766,[[0.1924, 0.6575, 0.6808, 0.3253]]], 1, Con92679), 
LMin63918 = minimum_layer([[[[[[0.3151, 0.4814]], [[0.2504, 0.6811]]], [[[0.0259, 0.3019]], [[0.6528, 0.4902]]]]], [[[[[0.1608, 0.1688]], [[0.6344, 0.5676]]], [[[0.5636, 0.2899]], [[0.9485, 0.2936]]]]]], Min63918), 
LFla94322 = flatten_layer(Min63918, Fla94322), 
LDot12013 = dot_layer(Con92679,Fla94322, 1, 1, Dot12013), 
LCon80662 = concatenate_layer([Dot12013,[[0.4885]]], 1, Con80662), 
LMax61452 = maximum_layer([Sim97392,Con80662], Max61452), 
exec_layers([LMin67698,LRes34247,LAve90399,LRes82598,LSim97392,LCon19055,LRes49904,LDep70313,LRes28727,LZer21909,LMax46743,LSub67245,LRes5314,LRes93008,LFla29766,LCon92679,LMin63918,LFla94322,LDot12013,LCon80662,LMax61452],["Min67698","Res34247","Ave90399","Res82598","Sim97392","Con19055","Res49904","Dep70313","Res28727","Zer21909","Max46743","Sub67245","Res5314","Res93008","Fla29766","Con92679","Min63918","Fla94322","Dot12013","Con80662","Max61452"],Max61452,"Max61452")

Actual (Unparsed): [[1.0000000, 0.9999758]]

Expected (Unparsed): [[0.9999999999686953,0.9999757589950676]]

Actual:   [[1, 1]]

Expected: [[1, 1]]