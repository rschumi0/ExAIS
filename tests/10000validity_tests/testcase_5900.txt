import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr58298 = tf.keras.layers.Input(shape=([1, 1]))

Thr58298 = keras.layers.ThresholdedReLU(theta=9.946514434922523, name = 'Thr58298', input_shape=(1, 1))(in0Thr58298)
ReL90947 = keras.layers.ReLU(max_value=1.4612666816749276, negative_slope=9.632844788352676, threshold=7.982500199634784, name = 'ReL90947', )(Thr58298)
Zer98096 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer98096', )(ReL90947)
Res30878 = keras.layers.Reshape((3, 1, 1), name = 'Res30878', )(Zer98096)
Sep64276 = keras.layers.SeparableConv2D(4, (3, 1),strides=(2, 2), padding='valid', name = 'Sep64276', )(Res30878)
model = tf.keras.models.Model(inputs=[in0Thr58298], outputs=Sep64276)
w = model.get_layer('Sep64276').get_weights() 
w[0] = np.array([[[[0.5612]]], [[[0.7932]]], [[[0.3415]]]])
w[1] = np.array([[[[0.2286, 0.935, 0.6571, 0.3584]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep64276').set_weights(w) 
in0Thr58298 = tf.constant([[[0.4784]]])
print (np.array2string(model.predict([in0Thr58298],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep64276.png')

LThr58298 = thresholded_relu_layer([[[0.4784]]], 9.946514434922523, Thr58298), 
LReL90947 = relu_layer(Thr58298, 1.4612666816749276, 9.632844788352676, 7.982500199634784, ReL90947), 
LZer98096 = zero_padding1D_layer(ReL90947, 1, 1, Zer98096), 
LRes30878 = reshape_layer(Zer98096, [3, 1, 1], Res30878), 
LSep64276 = separable_conv2D_layer(Res30878, 3, 1,[[[[[0.5612]]], [[[0.7932]]], [[[0.3415]]]],[[[[0.2286, 0.935, 0.6571, 0.3584]]]]],[0, 0, 0, 0], 2, 2, false, Sep64276), 
exec_layers([LThr58298,LReL90947,LZer98096,LRes30878,LSep64276],["Thr58298","ReL90947","Zer98096","Res30878","Sep64276"],Sep64276,"Sep64276")

Actual (Unparsed): [[[[-13.9428782, -57.0279575, -40.0781507, -21.8597005]]]]

Expected (Unparsed): [[[[-13.942878160986185,-57.027957482598794,-40.078150654348306,-21.859700493864604]]]]

Actual:   [[[[-13.9428, -57.0279, -40.0781, -21.8597]]]]

Expected: [[[[-13.9428, -57.0279, -40.0781, -21.8597]]]]