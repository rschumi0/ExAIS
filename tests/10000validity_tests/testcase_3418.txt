import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max41040 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max41040 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con32753 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul74993 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul74993 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul16400 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Mul16400 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Sub64551 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Sub64551 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Ave47618 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Ave47618 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Max55732 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max55732 = tf.keras.layers.Input(shape=([2, 2, 1]))

Max41040 = keras.layers.Maximum(name = 'Max41040', )([in0Max41040,in1Max41040])
Res69894 = keras.layers.Reshape((2, 2), name = 'Res69894', )(Max41040)
Con32753 = keras.layers.Concatenate(axis=2, name = 'Con32753', )([Res69894,in0Con32753])
Mul74993 = keras.layers.Multiply(name = 'Mul74993', )([in0Mul74993,in1Mul74993])
Res91785 = keras.layers.Reshape((2, 2, 1), name = 'Res91785', )(Mul74993)
Res5271 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res5271', )(Res91785)
Cro94500 = keras.layers.Cropping3D(cropping=((0, 0), (0, 1), (0, 0)), name = 'Cro94500', )(Res5271)
Mul16400 = keras.layers.Multiply(name = 'Mul16400', )([in0Mul16400,in1Mul16400])
Zer18327 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer18327', )(Mul16400)
Max60450 = keras.layers.Maximum(name = 'Max60450', )([Cro94500,Zer18327])
Res97446 = keras.layers.Reshape((2, 1, 1), name = 'Res97446', )(Max60450)
Res47657 = keras.layers.Reshape((2, 1), name = 'Res47657', )(Res97446)
Dot53104 = keras.layers.Dot(axes=(1, 1), name = 'Dot53104', )([Con32753,Res47657])
Res86538 = keras.layers.Reshape((3, 1, 1), name = 'Res86538', )(Dot53104)
Zer67903 = keras.layers.ZeroPadding2D(padding=((5, 0), (7, 0)), name = 'Zer67903', )(Res86538)
Sub64551 = keras.layers.Subtract(name = 'Sub64551', )([in0Sub64551,in1Sub64551])
Res6559 = keras.layers.Reshape((2, 2, 4), name = 'Res6559', )(Sub64551)
Res19072 = keras.layers.Reshape((2, 8), name = 'Res19072', )(Res6559)
Ave47618 = keras.layers.Average(name = 'Ave47618', )([in0Ave47618,in1Ave47618])
Res62606 = keras.layers.Reshape((1, 2, 4), name = 'Res62606', )(Ave47618)
Res90279 = keras.layers.Reshape((1, 8), name = 'Res90279', )(Res62606)
Zer54995 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer54995', )(Res90279)
Dot59424 = keras.layers.Dot(axes=(1, 1), name = 'Dot59424', )([Res19072,Zer54995])
Res61207 = keras.layers.Reshape((8, 8, 1), name = 'Res61207', )(Dot59424)
Max55732 = keras.layers.Maximum(name = 'Max55732', )([in0Max55732,in1Max55732])
Zer73918 = keras.layers.ZeroPadding2D(padding=((6, 0), (6, 0)), name = 'Zer73918', )(Max55732)
Sub34903 = keras.layers.Subtract(name = 'Sub34903', )([Res61207,Zer73918])
Mul9225 = keras.layers.Multiply(name = 'Mul9225', )([Zer67903,Sub34903])
model = tf.keras.models.Model(inputs=[in0Max41040,in1Max41040,in0Con32753,in0Mul74993,in1Mul74993,in0Mul16400,in1Mul16400,in0Sub64551,in1Sub64551,in0Ave47618,in1Ave47618,in0Max55732,in1Max55732], outputs=Mul9225)
in0Max41040 = tf.constant([[[[0.7719], [0.5822]], [[0.2447], [0.7643]]]])
in1Max41040 = tf.constant([[[[0.9163], [0.5913]], [[0.7178], [0.2767]]]])
in0Con32753 = tf.constant([[[0.3156], [0.8154]]])
in0Mul74993 = tf.constant([[[0.6181, 0.3638], [0.3686, 0.0948]]])
in1Mul74993 = tf.constant([[[0.3078, 0.2745], [0.5205, 0.013]]])
in0Mul16400 = tf.constant([[[[[0.1397]]]]])
in1Mul16400 = tf.constant([[[[[0.4153]]]]])
in0Sub64551 = tf.constant([[[[[0.9094, 0.113], [0.6948, 0.1151]], [[0.8186, 0.0608], [0.616, 0.7247]]], [[[0.6062, 0.855], [0.1348, 0.7901]], [[0.2284, 0.1259], [0.9332, 0.201]]]]])
in1Sub64551 = tf.constant([[[[[0.3636, 0.6914], [0.5521, 0.8924]], [[0.5243, 0.7041], [0.6044, 0.2044]]], [[[0.1078, 0.3948], [0.3802, 0.0582]], [[0.6793, 0.1097], [0.0431, 0.6946]]]]])
in0Ave47618 = tf.constant([[[[[0.911, 0.0674], [0.5055, 0.8397]], [[0.5035, 0.0226], [0.2479, 0.812]]]]])
in1Ave47618 = tf.constant([[[[[0.1073, 0.8088], [0.7962, 0.2632]], [[0.7308, 0.559], [0.3103, 0.9613]]]]])
in0Max55732 = tf.constant([[[[0.3725], [0.2524]], [[0.7528], [0.2648]]]])
in1Max55732 = tf.constant([[[[0.6474], [0.1185]], [[0.4036], [0.7103]]]])
print (np.array2string(model.predict([in0Max41040,in1Max41040,in0Con32753,in0Mul74993,in1Mul74993,in0Mul16400,in1Mul16400,in0Sub64551,in1Sub64551,in0Ave47618,in1Ave47618,in0Max55732,in1Max55732],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul9225.png')

LMax41040 = maximum_layer([[[[[0.7719], [0.5822]], [[0.2447], [0.7643]]]], [[[[0.9163], [0.5913]], [[0.7178], [0.2767]]]]], Max41040), 
LRes69894 = reshape_layer(Max41040, [2, 2], Res69894), 
LCon32753 = concatenate_layer([Res69894,[[[0.3156], [0.8154]]]], 2, Con32753), 
LMul74993 = multiply_layer([[[[0.6181, 0.3638], [0.3686, 0.0948]]], [[[0.3078, 0.2745], [0.5205, 0.013]]]], Mul74993), 
LRes91785 = reshape_layer(Mul74993, [2, 2, 1], Res91785), 
LRes5271 = reshape_layer(Res91785, [2, 2, 1, 1], Res5271), 
LCro94500 = cropping3D_layer(Res5271, 0, 0, 0, 1, 0, 0, Cro94500), 
LMul16400 = multiply_layer([[[[[[0.1397]]]]], [[[[[0.4153]]]]]], Mul16400), 
LZer18327 = zero_padding3D_layer(Mul16400, 1, 0, 0, 0, 0, 0, Zer18327), 
LMax60450 = maximum_layer([Cro94500,Zer18327], Max60450), 
LRes97446 = reshape_layer(Max60450, [2, 1, 1], Res97446), 
LRes47657 = reshape_layer(Res97446, [2, 1], Res47657), 
LDot53104 = dot_layer(Con32753,Res47657, 1, 1, Dot53104), 
LRes86538 = reshape_layer(Dot53104, [3, 1, 1], Res86538), 
LZer67903 = zero_padding2D_layer(Res86538, 5, 0, 7, 0, Zer67903), 
LSub64551 = subtract_layer([[[[[0.9094, 0.113], [0.6948, 0.1151]], [[0.8186, 0.0608], [0.616, 0.7247]]], [[[0.6062, 0.855], [0.1348, 0.7901]], [[0.2284, 0.1259], [0.9332, 0.201]]]]], [[[[[0.3636, 0.6914], [0.5521, 0.8924]], [[0.5243, 0.7041], [0.6044, 0.2044]]], [[[0.1078, 0.3948], [0.3802, 0.0582]], [[0.6793, 0.1097], [0.0431, 0.6946]]]]], Sub64551), 
LRes6559 = reshape_layer(Sub64551, [2, 2, 4], Res6559), 
LRes19072 = reshape_layer(Res6559, [2, 8], Res19072), 
LAve47618 = average_layer([[[[[[0.911, 0.0674], [0.5055, 0.8397]], [[0.5035, 0.0226], [0.2479, 0.812]]]]], [[[[[0.1073, 0.8088], [0.7962, 0.2632]], [[0.7308, 0.559], [0.3103, 0.9613]]]]]], Ave47618), 
LRes62606 = reshape_layer(Ave47618, [1, 2, 4], Res62606), 
LRes90279 = reshape_layer(Res62606, [1, 8], Res90279), 
LZer54995 = zero_padding1D_layer(Res90279, 1, 0, Zer54995), 
LDot59424 = dot_layer(Res19072,Zer54995, 1, 1, Dot59424), 
LRes61207 = reshape_layer(Dot59424, [8, 8, 1], Res61207), 
LMax55732 = maximum_layer([[[[[0.3725], [0.2524]], [[0.7528], [0.2648]]]], [[[[0.6474], [0.1185]], [[0.4036], [0.7103]]]]], Max55732), 
LZer73918 = zero_padding2D_layer(Max55732, 6, 0, 6, 0, Zer73918), 
LSub34903 = subtract_layer(Res61207,Zer73918, Sub34903), 
LMul9225 = multiply_layer([Zer67903,Sub34903], Mul9225), 
exec_layers([LMax41040,LRes69894,LCon32753,LMul74993,LRes91785,LRes5271,LCro94500,LMul16400,LZer18327,LMax60450,LRes97446,LRes47657,LDot53104,LRes86538,LZer67903,LSub64551,LRes6559,LRes19072,LAve47618,LRes62606,LRes90279,LZer54995,LDot59424,LRes61207,LMax55732,LZer73918,LSub34903,LMul9225],["Max41040","Res69894","Con32753","Mul74993","Res91785","Res5271","Cro94500","Mul16400","Zer18327","Max60450","Res97446","Res47657","Dot53104","Res86538","Zer67903","Sub64551","Res6559","Res19072","Ave47618","Res62606","Res90279","Zer54995","Dot59424","Res61207","Max55732","Zer73918","Sub34903","Mul9225"],Mul9225,"Mul9225")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0044821]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0000000], [0.1391035]], [[-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.0000000], [-0.2485116]]]]

Expected (Unparsed): [[[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0]],[[-0.0],[-0.0],[-0.0],[-0.0],[-0.0],[-0.0],[-0.0],[-0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0]],[[-0.0],[-0.0],[-0.0],[-0.0],[-0.0],[-0.0],[-0.0],[-0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0044820814114498765]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.0],[0.1391035346636363]],[[-0.0],[-0.0],[-0.0],[-0.0],[-0.0],[-0.0],[-0.0],[-0.24851163965084835]]]]

Actual:   [[[[0], [0], [0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0], [0], [0]], [[-0], [-0], [-0], [-0], [-0], [-0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [0], [0]], [[-0], [-0], [-0], [-0], [-0], [-0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [0], [0.0045]], [[0], [0], [0], [0], [0], [0], [-0], [0.1392]], [[-0], [-0], [-0], [-0], [-0], [-0], [-0], [-0.2485]]]]

Expected: [[[[0], [0], [0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0], [0], [0]], [[-0], [-0], [-0], [-0], [-0], [-0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [0], [0]], [[-0], [-0], [-0], [-0], [-0], [-0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [0], [0.0045]], [[0], [0], [0], [0], [0], [0], [-0], [0.1392]], [[-0], [-0], [-0], [-0], [-0], [-0], [-0], [-0.2485]]]]