import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim13603 = tf.keras.layers.Input(shape=([1, 1]))
in0Con61072 = tf.keras.layers.Input(shape=([6, 2, 1]))
in0Max85418 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max85418 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot19631 = tf.keras.layers.Input(shape=([2]))
in1Dot19631 = tf.keras.layers.Input(shape=([2]))
in0Con72877 = tf.keras.layers.Input(shape=([2, 1]))
in0Add45284 = tf.keras.layers.Input(shape=([1, 2]))
in1Add45284 = tf.keras.layers.Input(shape=([1, 2]))
in0Con37137 = tf.keras.layers.Input(shape=([2, 4]))

Sim13603 = keras.layers.SimpleRNN(3,name = 'Sim13603', )(in0Sim13603)
Res51125 = keras.layers.Reshape((3, 1), name = 'Res51125', )(Sim13603)
Res369 = keras.layers.Reshape((3, 1, 1), name = 'Res369', )(Res51125)
Up_21297 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_21297', )(Res369)
Con61072 = keras.layers.Concatenate(axis=3, name = 'Con61072', )([Up_21297,in0Con61072])
Max85418 = keras.layers.Maximum(name = 'Max85418', )([in0Max85418,in1Max85418])
Zer45061 = keras.layers.ZeroPadding2D(padding=((4, 0), (0, 0)), name = 'Zer45061', )(Max85418)
Add61852 = keras.layers.Add(name = 'Add61852', )([Con61072,Zer45061])
Res76719 = keras.layers.Reshape((6, 2, 2, 1), name = 'Res76719', )(Add61852)
Con73864 = keras.layers.Conv3D(3, (5, 1, 2),strides=(7, 1, 11), padding='same', dilation_rate=(1, 1, 1), name = 'Con73864', )(Res76719)
Res28307 = keras.layers.Reshape((1, 2, 3), name = 'Res28307', )(Con73864)
Loc859 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc859', )(Res28307)
Res16510 = keras.layers.Reshape((1, 6), name = 'Res16510', )(Loc859)
Zer88799 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer88799', )(Res16510)
Dot19631 = keras.layers.Dot(axes=(1, 1), name = 'Dot19631', )([in0Dot19631,in1Dot19631])
Den54479 = keras.layers.Dense(4,name = 'Den54479', )(Dot19631)
Res2489 = keras.layers.Reshape((4, 1), name = 'Res2489', )(Den54479)
Max73111 = keras.layers.MaxPool1D(pool_size=(2), strides=(3), padding='same', name = 'Max73111', )(Res2489)
Thr1232 = keras.layers.ThresholdedReLU(theta=3.017098886309223, name = 'Thr1232', )(Max73111)
Con72877 = keras.layers.Concatenate(axis=2, name = 'Con72877', )([Thr1232,in0Con72877])
Add45284 = keras.layers.Add(name = 'Add45284', )([in0Add45284,in1Add45284])
Zer8784 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer8784', )(Add45284)
Mul99389 = keras.layers.Multiply(name = 'Mul99389', )([Con72877,Zer8784])
Con37137 = keras.layers.Concatenate(axis=2, name = 'Con37137', )([Mul99389,in0Con37137])
Add14202 = keras.layers.Add(name = 'Add14202', )([Zer88799,Con37137])
model = tf.keras.models.Model(inputs=[in0Sim13603,in0Con61072,in0Max85418,in1Max85418,in0Dot19631,in1Dot19631,in0Con72877,in0Add45284,in1Add45284,in0Con37137], outputs=Add14202)
w = model.get_layer('Sim13603').get_weights() 
w[0] = np.array([[3, 1, 3]])
w[1] = np.array([[1, 10, 2], [9, 1, 5], [9, 1, 9]])
w[2] = np.array([2, 4, 6])
model.get_layer('Sim13603').set_weights(w) 
w = model.get_layer('Con73864').get_weights() 
w[0] = np.array([[[[[0.1571, 0.2906, 0.5028]], [[0.8352, 0.7854, 0.5687]]]], [[[[0.5399, 0.6974, 0.1753]], [[0.7437, 0.2074, 0.1726]]]], [[[[0.7599, 0.8519, 0.9332]], [[0.3308, 0.5782, 0.7163]]]], [[[[0.9731, 0.1349, 0.2176]], [[0.4498, 0.159, 0.7624]]]], [[[[0.9865, 0.8344, 0.3671]], [[0.6664, 0.0704, 0.1681]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con73864').set_weights(w) 
w = model.get_layer('Loc859').get_weights() 
w[0] = np.array([[[0.4059, 0.5135, 0.06], [0.7544, 0.4354, 0.4242], [0.398, 0.8927, 0.1136]], [[0.8596, 0.2307, 0.6285], [0.8571, 0.9961, 0.5647], [0.1915, 0.0711, 0.6254]]])
w[1] = np.array([[[0, 0, 0], [0, 0, 0]]])
model.get_layer('Loc859').set_weights(w) 
w = model.get_layer('Den54479').get_weights() 
w[0] = np.array([[0.8502, 0.4202, 0.1505, 0.6476]])
w[1] = np.array([0.8966, 0.4356, 0.7697, 0.3802])
model.get_layer('Den54479').set_weights(w) 
in0Sim13603 = tf.constant([[[4]]])
in0Con61072 = tf.constant([[[[0.8995], [0.3701]], [[0.4217], [0.1987]], [[0.3446], [0.159]], [[0.7422], [0.741]], [[0.8964], [0.6472]], [[0.884], [0.2146]]]])
in0Max85418 = tf.constant([[[[0.1694, 0.9209], [0.8233, 0.4526]], [[0.7805, 0.6109], [0.838, 0.4231]]]])
in1Max85418 = tf.constant([[[[0.2684, 0.354], [0.4286, 0.4825]], [[0.8115, 0.7672], [0.8081, 0.9279]]]])
in0Dot19631 = tf.constant([[0.4668, 0.9909]])
in1Dot19631 = tf.constant([[0.2979, 0.3252]])
in0Con72877 = tf.constant([[[0.4846], [0.8655]]])
in0Add45284 = tf.constant([[[0.23, 0.6569]]])
in1Add45284 = tf.constant([[[0.1748, 0.2736]]])
in0Con37137 = tf.constant([[[0.1243, 0.9377, 0.8082, 0.2881], [0.0959, 0.958, 0.7685, 0.2933]]])
print (np.array2string(model.predict([in0Sim13603,in0Con61072,in0Max85418,in1Max85418,in0Dot19631,in1Dot19631,in0Con72877,in0Add45284,in1Add45284,in0Con37137],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add14202.png')

LSim13603 = simple_rnn_layer([[[4]]],[[3, 1, 3]],[[1, 10, 2], [9, 1, 5], [9, 1, 9]],[2, 4, 6], Sim13603), 
LRes51125 = reshape_layer(Sim13603, [3, 1], Res51125), 
LRes369 = reshape_layer(Res51125, [3, 1, 1], Res369), 
LUp_21297 = up_sampling2D_layer(Res369, 2, 2, Up_21297), 
LCon61072 = concatenate_layer([Up_21297,[[[[0.8995], [0.3701]], [[0.4217], [0.1987]], [[0.3446], [0.159]], [[0.7422], [0.741]], [[0.8964], [0.6472]], [[0.884], [0.2146]]]]], 3, Con61072), 
LMax85418 = maximum_layer([[[[[0.1694, 0.9209], [0.8233, 0.4526]], [[0.7805, 0.6109], [0.838, 0.4231]]]], [[[[0.2684, 0.354], [0.4286, 0.4825]], [[0.8115, 0.7672], [0.8081, 0.9279]]]]], Max85418), 
LZer45061 = zero_padding2D_layer(Max85418, 4, 0, 0, 0, Zer45061), 
LAdd61852 = add_layer([Con61072,Zer45061], Add61852), 
LRes76719 = reshape_layer(Add61852, [6, 2, 2, 1], Res76719), 
LCon73864 = conv3D_layer(Res76719, 5, 1, 2,[[[[[0.1571, 0.2906, 0.5028]], [[0.8352, 0.7854, 0.5687]]]], [[[[0.5399, 0.6974, 0.1753]], [[0.7437, 0.2074, 0.1726]]]], [[[[0.7599, 0.8519, 0.9332]], [[0.3308, 0.5782, 0.7163]]]], [[[[0.9731, 0.1349, 0.2176]], [[0.4498, 0.159, 0.7624]]]], [[[[0.9865, 0.8344, 0.3671]], [[0.6664, 0.0704, 0.1681]]]]],[0, 0, 0], 7, 1, 11, true, 1, 1, 1, Con73864), 
LRes28307 = reshape_layer(Con73864, [1, 2, 3], Res28307), 
LLoc859 = locally_connected2D_layer(Res28307, 1, 1,[[[0.4059, 0.5135, 0.06], [0.7544, 0.4354, 0.4242], [0.398, 0.8927, 0.1136]], [[0.8596, 0.2307, 0.6285], [0.8571, 0.9961, 0.5647], [0.1915, 0.0711, 0.6254]]],[[[0, 0, 0], [0, 0, 0]]], 1, 1, Loc859), 
LRes16510 = reshape_layer(Loc859, [1, 6], Res16510), 
LZer88799 = zero_padding1D_layer(Res16510, 1, 0, Zer88799), 
LDot19631 = dot_layer([[0.4668, 0.9909]], [[0.2979, 0.3252]], 1, 1, Dot19631), 
LDen54479 = dense_layer(Dot19631, [[0.8502, 0.4202, 0.1505, 0.6476]],[0.8966, 0.4356, 0.7697, 0.3802], Den54479), 
LRes2489 = reshape_layer(Den54479, [4, 1], Res2489), 
LMax73111 = max_pool1D_layer(Res2489, 2, 3, true, Max73111), 
LThr1232 = thresholded_relu_layer(Max73111, 3.017098886309223, Thr1232), 
LCon72877 = concatenate_layer([Thr1232,[[[0.4846], [0.8655]]]], 2, Con72877), 
LAdd45284 = add_layer([[[[0.23, 0.6569]]], [[[0.1748, 0.2736]]]], Add45284), 
LZer8784 = zero_padding1D_layer(Add45284, 1, 0, Zer8784), 
LMul99389 = multiply_layer([Con72877,Zer8784], Mul99389), 
LCon37137 = concatenate_layer([Mul99389,[[[0.1243, 0.9377, 0.8082, 0.2881], [0.0959, 0.958, 0.7685, 0.2933]]]], 2, Con37137), 
LAdd14202 = add_layer([Zer88799,Con37137], Add14202), 
exec_layers([LSim13603,LRes51125,LRes369,LUp_21297,LCon61072,LMax85418,LZer45061,LAdd61852,LRes76719,LCon73864,LRes28307,LLoc859,LRes16510,LZer88799,LDot19631,LDen54479,LRes2489,LMax73111,LThr1232,LCon72877,LAdd45284,LZer8784,LMul99389,LCon37137,LAdd14202],["Sim13603","Res51125","Res369","Up_21297","Con61072","Max85418","Zer45061","Add61852","Res76719","Con73864","Res28307","Loc859","Res16510","Zer88799","Dot19631","Den54479","Res2489","Max73111","Thr1232","Con72877","Add45284","Zer8784","Mul99389","Con37137","Add14202"],Add14202,"Add14202")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.1243000, 0.9377000, 0.8082000, 0.2881000], [7.4136326, 9.5226418, 2.7465656, 10.1851784, 6.4702341, 8.5377084]]]

Expected (Unparsed): [[[0,0.0,0.1243,0.9377,0.8082,0.2881],[7.413632601847045,9.522641800544871,2.7465655676942387,10.185178440792546,6.470234111014651,8.537708419738614]]]

Actual:   [[[0, 0, 0.1243, 0.9377, 0.8082, 0.2881], [7.4137, 9.5227, 2.7466, 10.1852, 6.4703, 8.5378]]]

Expected: [[[0, 0, 0.1243, 0.9377, 0.8082, 0.2881], [7.4137, 9.5227, 2.7466, 10.1852, 6.4703, 8.5378]]]