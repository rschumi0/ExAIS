import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den99659 = tf.keras.layers.Input(shape=([2, 4, 2]))

Den99659 = keras.layers.Dense(2,name = 'Den99659', )(in0Den99659)
Res43352 = keras.layers.Reshape((2, 4, 2, 1), name = 'Res43352', )(Den99659)
Cro53633 = keras.layers.Cropping3D(cropping=((1, 0), (3, 0), (1, 0)), name = 'Cro53633', )(Res43352)
Glo98541 = keras.layers.GlobalAveragePooling3D(name = 'Glo98541', )(Cro53633)
model = tf.keras.models.Model(inputs=[in0Den99659], outputs=Glo98541)
w = model.get_layer('Den99659').get_weights() 
w[0] = np.array([[0.7154, 0.8348], [0.0501, 0.3384]])
w[1] = np.array([0.706, 0.7212])
model.get_layer('Den99659').set_weights(w) 
in0Den99659 = tf.constant([[[[0.3571, 0.4725], [0.2544, 0.0916], [0.1587, 0.8859], [0.5417, 0.0682]], [[0.3366, 0.2013], [0.1774, 0.2095], [0.8117, 0.6932], [0.0973, 0.0756]]]])
print (np.array2string(model.predict([in0Den99659],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo98541.png')

LDen99659 = dense_layer([[[[0.3571, 0.4725], [0.2544, 0.0916], [0.1587, 0.8859], [0.5417, 0.0682]], [[0.3366, 0.2013], [0.1774, 0.2095], [0.8117, 0.6932], [0.0973, 0.0756]]]], [[0.7154, 0.8348], [0.0501, 0.3384]],[0.706, 0.7212], Den99659), 
LRes43352 = reshape_layer(Den99659, [2, 4, 2, 1], Res43352), 
LCro53633 = cropping3D_layer(Res43352, 1, 0, 3, 0, 1, 0, Cro53633), 
LGlo98541 = global_average_pooling3D_layer(Cro53633, Glo98541), 
exec_layers([LDen99659,LRes43352,LCro53633,LGlo98541],["Den99659","Res43352","Cro53633","Glo98541"],Glo98541,"Glo98541")

Actual (Unparsed): [[0.8280091]]

Expected (Unparsed): [[0.82800908]]

Actual:   [[0.8281]]

Expected: [[0.8281]]