import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den41228 = tf.keras.layers.Input(shape=([4, 5]))
in0Con53731 = tf.keras.layers.Input(shape=([4, 1]))
in0Sep55469 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con20838 = tf.keras.layers.Input(shape=([1, 3]))
in0Sub27260 = tf.keras.layers.Input(shape=([2, 3, 2]))
in1Sub27260 = tf.keras.layers.Input(shape=([2, 3, 2]))

Den41228 = keras.layers.Dense(1,name = 'Den41228', )(in0Den41228)
Con53731 = keras.layers.Concatenate(axis=2, name = 'Con53731', )([Den41228,in0Con53731])
Sep55469 = keras.layers.SeparableConv2D(3, (1, 1),strides=(2, 2), padding='valid', name = 'Sep55469', )(in0Sep55469)
Cro63054 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro63054', )(Sep55469)
Res77058 = keras.layers.Reshape((1, 3), name = 'Res77058', )(Cro63054)
Con20838 = keras.layers.Concatenate(axis=2, name = 'Con20838', )([Res77058,in0Con20838])
Sub27260 = keras.layers.Subtract(name = 'Sub27260', )([in0Sub27260,in1Sub27260])
Res26580 = keras.layers.Reshape((2, 6), name = 'Res26580', )(Sub27260)
Dot21848 = keras.layers.Dot(axes=(2, 2), name = 'Dot21848', )([Con20838,Res26580])
Zer91842 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer91842', )(Dot21848)
Min15739 = keras.layers.Minimum(name = 'Min15739', )([Con53731,Zer91842])
model = tf.keras.models.Model(inputs=[in0Den41228,in0Con53731,in0Sep55469,in0Con20838,in0Sub27260,in1Sub27260], outputs=Min15739)
w = model.get_layer('Den41228').get_weights() 
w[0] = np.array([[0.0806], [0.9541], [0.4003], [0.4504], [0.6766]])
w[1] = np.array([0.7086])
model.get_layer('Den41228').set_weights(w) 
w = model.get_layer('Sep55469').get_weights() 
w[0] = np.array([[[[0.9941], [0.7774]]]])
w[1] = np.array([[[[0.7048, 0.8615, 0.8952], [0.924, 0.8105, 0.0706]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep55469').set_weights(w) 
in0Den41228 = tf.constant([[[0.1579, 0.8548, 0.715, 0.5242, 0.5482], [0.1769, 0.9532, 0.6477, 0.2373, 0.9284], [0.9041, 0.343, 0.0814, 0.3905, 0.0731], [0.2664, 0.2618, 0.0527, 0.4072, 0.6095]]])
in0Con53731 = tf.constant([[[0.2723], [0.7018], [0.5389], [0.9437]]])
in0Sep55469 = tf.constant([[[[0.275, 0.0115]], [[0.1323, 0.8777]]]])
in0Con20838 = tf.constant([[[0.527, 0.5713, 0.6608]]])
in0Sub27260 = tf.constant([[[[0.9706, 0.5134], [0.9138, 0.4886], [0.5416, 0.1587]], [[0.2858, 0.9019], [0.4267, 0.2146], [0.9219, 0.6307]]]])
in1Sub27260 = tf.constant([[[[0.5429, 0.0778], [0.8608, 0.2801], [0.1275, 0.1742]], [[0.2376, 0.7048], [0.7418, 0.4865], [0.4238, 0.4893]]]])
print (np.array2string(model.predict([in0Den41228,in0Con53731,in0Sep55469,in0Con20838,in0Sub27260,in1Sub27260],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min15739.png')

LDen41228 = dense_layer([[[0.1579, 0.8548, 0.715, 0.5242, 0.5482], [0.1769, 0.9532, 0.6477, 0.2373, 0.9284], [0.9041, 0.343, 0.0814, 0.3905, 0.0731], [0.2664, 0.2618, 0.0527, 0.4072, 0.6095]]], [[0.0806], [0.9541], [0.4003], [0.4504], [0.6766]],[0.7086], Den41228), 
LCon53731 = concatenate_layer([Den41228,[[[0.2723], [0.7018], [0.5389], [0.9437]]]], 2, Con53731), 
LSep55469 = separable_conv2D_layer([[[[0.275, 0.0115]], [[0.1323, 0.8777]]]], 1, 1,[[[[[0.9941], [0.7774]]]],[[[[0.7048, 0.8615, 0.8952], [0.924, 0.8105, 0.0706]]]]],[0, 0, 0], 2, 2, false, Sep55469), 
LCro63054 = cropping2D_layer(Sep55469, 0, 0, 0, 0, Cro63054), 
LRes77058 = reshape_layer(Cro63054, [1, 3], Res77058), 
LCon20838 = concatenate_layer([Res77058,[[[0.527, 0.5713, 0.6608]]]], 2, Con20838), 
LSub27260 = subtract_layer([[[[0.9706, 0.5134], [0.9138, 0.4886], [0.5416, 0.1587]], [[0.2858, 0.9019], [0.4267, 0.2146], [0.9219, 0.6307]]]], [[[[0.5429, 0.0778], [0.8608, 0.2801], [0.1275, 0.1742]], [[0.2376, 0.7048], [0.7418, 0.4865], [0.4238, 0.4893]]]], Sub27260), 
LRes26580 = reshape_layer(Sub27260, [2, 6], Res26580), 
LDot21848 = dot_layer(Con20838,Res26580, 2, 2, Dot21848), 
LZer91842 = zero_padding1D_layer(Dot21848, 3, 0, Zer91842), 
LMin15739 = minimum_layer([Con53731,Zer91842], Min15739), 
exec_layers([LDen41228,LCon53731,LSep55469,LCro63054,LRes77058,LCon20838,LSub27260,LRes26580,LDot21848,LZer91842,LMin15739],["Den41228","Con53731","Sep55469","Cro63054","Res77058","Con20838","Sub27260","Res26580","Dot21848","Zer91842","Min15739"],Min15739,"Min15739")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.5409038, 0.2149311]]]

Expected (Unparsed): [[[0,0],[0,0],[0,0],[0.54090379208494,0.21493111721410413]]]

Actual:   [[[0, 0], [0, 0], [0, 0], [0.541, 0.215]]]

Expected: [[[0, 0], [0, 0], [0, 0], [0.541, 0.215]]]