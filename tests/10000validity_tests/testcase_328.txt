import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot40939 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot40939 = tf.keras.layers.Input(shape=([3, 3]))
in0Con35971 = tf.keras.layers.Input(shape=([3, 3, 3, 3]))
in0Cro95917 = tf.keras.layers.Input(shape=([1, 4, 3, 4]))

Dot40939 = keras.layers.Dot(axes=(2, 2), name = 'Dot40939', )([in0Dot40939,in1Dot40939])
Res10779 = keras.layers.Reshape((3, 3, 1), name = 'Res10779', )(Dot40939)
Res18007 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res18007', )(Res10779)
Zer9696 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer9696', )(Res18007)
Con35971 = keras.layers.Concatenate(axis=4, name = 'Con35971', )([Zer9696,in0Con35971])
Cro95917 = keras.layers.Cropping3D(cropping=((0, 0), (1, 0), (0, 1)), name = 'Cro95917', )(in0Cro95917)
Zer22217 = keras.layers.ZeroPadding3D(padding=((2, 0), (0, 0), (1, 0)), name = 'Zer22217', )(Cro95917)
Sub26997 = keras.layers.Subtract(name = 'Sub26997', )([Con35971,Zer22217])
Res73001 = keras.layers.Reshape((3, 3, 12), name = 'Res73001', )(Sub26997)
Res7830 = keras.layers.Reshape((3, 36), name = 'Res7830', )(Res73001)
Zer89818 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer89818', )(Res7830)
PRe64085 = keras.layers.PReLU(name = 'PRe64085', )(Zer89818)
model = tf.keras.models.Model(inputs=[in0Dot40939,in1Dot40939,in0Con35971,in0Cro95917], outputs=PRe64085)
w = model.get_layer('PRe64085').get_weights() 
w[0] = np.array([[0.3861, 0.8466, 0.8948, 0.2628, 0.3668, 0.9489, 0.4616, 0.9312, 0.6589, 0.4315, 0.8342, 0.7637, 0.0536, 0.8828, 0.1266, 0.6394, 0.7309, 0.1089, 0.0766, 0.4494, 0.374, 0.2569, 0.9623, 0.5271, 0.1279, 0.0498, 0.0793, 0.3259, 0.5636, 0.1409, 0.4308, 0.5132, 0.4162, 0.3586, 0.2693, 0.4283], [0.4954, 0.6663, 0.6569, 0.4186, 0.8341, 0.983, 0.2669, 0.9109, 0.8356, 0.6296, 0.2336, 0.2021, 0.9094, 0.0498, 0.9785, 0.8597, 0.8422, 0.6322, 0.5881, 0.3122, 0.9416, 0.9121, 0.5009, 0.6771, 0.8127, 0.1679, 0.972, 0.1286, 0.4775, 0.4422, 0.0274, 0.1351, 0.4334, 0.3179, 0.3942, 0.7145], [0.1603, 0.3557, 0.1989, 0.4456, 0.534, 0.963, 0.0623, 0.3539, 0.5789, 0.6026, 0.5892, 0.9446, 0.003, 0.6746, 0.148, 0.5951, 0.9991, 0.1094, 0.268, 0.2388, 0.8655, 0.6921, 0.9444, 0.7739, 0.1031, 0.4087, 0.6311, 0.9112, 0.7797, 0.6502, 0.7306, 0.2399, 0.1174, 0.9402, 0.941, 0.135], [0.454, 0.9629, 0.9105, 0.7559, 0.9585, 0.0586, 0.2676, 0.7913, 0.7396, 0.0271, 0.2414, 0.7968, 0.2736, 0.0346, 0.7721, 0.94, 0.403, 0.6537, 0.2199, 0.7171, 0.5072, 0.5825, 0.5241, 0.7413, 0.8308, 0.3886, 0.9413, 0.0121, 0.3713, 0.7007, 0.2938, 0.1741, 0.1722, 0.6316, 0.9979, 0.1444], [0.3478, 0.8596, 0.0111, 0.1511, 0.6719, 0.7147, 0.2334, 0.6583, 0.1038, 0.8234, 0.8326, 0.8763, 0.1986, 0.3499, 0.4207, 0.5555, 0.946, 0.6381, 0.0078, 0.5439, 0.2217, 0.106, 0.1769, 0.1537, 0.6958, 0.5748, 0.9862, 0.725, 0.7411, 0.8248, 0.6852, 0.9018, 0.6122, 0.0596, 0.4566, 0.0419]])
model.get_layer('PRe64085').set_weights(w) 
in0Dot40939 = tf.constant([[[0.2155, 0.8519, 0.6482], [0.7567, 0.8578, 0.2209], [0.9932, 0.4345, 0.3716]]])
in1Dot40939 = tf.constant([[[0.4867, 0.0828, 0.7573], [0.0465, 0.5711, 0.5968], [0.2987, 0.7499, 0.7003]]])
in0Con35971 = tf.constant([[[[[0.8295, 0.3927, 0.0304], [0.3687, 0.6426, 0.0216], [0.5643, 0.0445, 0.9445]], [[0.6614, 0.3651, 0.0037], [0.9619, 0.5987, 0.5918], [0.7008, 0.2466, 0.5749]], [[0.7502, 0.4276, 0.9003], [0.6648, 0.5569, 0.7704], [0.3037, 0.8212, 0.6894]]], [[[0.488, 0.2832, 0.0864], [0.8525, 0.6107, 0.5272], [0.7676, 0.3673, 0.376]], [[0.9821, 0.4538, 0.7922], [0.2092, 0.9025, 0.6097], [0.925, 0.3344, 0.2095]], [[0.6275, 0.9002, 0.7584], [0.8173, 0.6358, 0.9989], [0.3094, 0.6313, 0.0732]]], [[[0.2149, 0.1287, 0.9899], [0.0164, 0.5872, 0.5204], [0.4255, 0.5211, 0.798]], [[0.3394, 0.7539, 0.7803], [0.5625, 0.1686, 0.6673], [0.7354, 0.8915, 0.3739]], [[0.2006, 0.885, 0.395], [0.7584, 0.6691, 0.427], [0.4121, 0.9379, 0.9356]]]]])
in0Cro95917 = tf.constant([[[[[1.5498, 1.8601, 1.8245, 1.2208], [1.6672, 1.0458, 1.3191, 1.8178], [1.4874, 1.2028, 1.6063, 1.0101]], [[1.0361, 1.1583, 1.5989, 1.8001], [1.3444, 1.0896, 1.715, 1.3997], [1.7845, 1.2919, 1.4601, 1.0242]], [[1.1819, 1.5681, 1.9977, 1.8488], [1.9327, 1.4638, 1.3603, 1.3545], [1.8973, 1.5886, 1.0175, 1.4576]], [[1.6766, 1.8253, 1.3613, 1.012], [1.9822, 1.3132, 1.296, 1.5007], [1.207, 1.7104, 1.5266, 1.993]]]]])
print (np.array2string(model.predict([in0Dot40939,in1Dot40939,in0Con35971,in0Cro95917],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe64085.png')

LDot40939 = dot_layer([[[0.2155, 0.8519, 0.6482], [0.7567, 0.8578, 0.2209], [0.9932, 0.4345, 0.3716]]], [[[0.4867, 0.0828, 0.7573], [0.0465, 0.5711, 0.5968], [0.2987, 0.7499, 0.7003]]], 2, 2, Dot40939), 
LRes10779 = reshape_layer(Dot40939, [3, 3, 1], Res10779), 
LRes18007 = reshape_layer(Res10779, [3, 3, 1, 1], Res18007), 
LZer9696 = zero_padding3D_layer(Res18007, 0, 0, 0, 0, 2, 0, Zer9696), 
LCon35971 = concatenate_layer([Zer9696,[[[[[0.8295, 0.3927, 0.0304], [0.3687, 0.6426, 0.0216], [0.5643, 0.0445, 0.9445]], [[0.6614, 0.3651, 0.0037], [0.9619, 0.5987, 0.5918], [0.7008, 0.2466, 0.5749]], [[0.7502, 0.4276, 0.9003], [0.6648, 0.5569, 0.7704], [0.3037, 0.8212, 0.6894]]], [[[0.488, 0.2832, 0.0864], [0.8525, 0.6107, 0.5272], [0.7676, 0.3673, 0.376]], [[0.9821, 0.4538, 0.7922], [0.2092, 0.9025, 0.6097], [0.925, 0.3344, 0.2095]], [[0.6275, 0.9002, 0.7584], [0.8173, 0.6358, 0.9989], [0.3094, 0.6313, 0.0732]]], [[[0.2149, 0.1287, 0.9899], [0.0164, 0.5872, 0.5204], [0.4255, 0.5211, 0.798]], [[0.3394, 0.7539, 0.7803], [0.5625, 0.1686, 0.6673], [0.7354, 0.8915, 0.3739]], [[0.2006, 0.885, 0.395], [0.7584, 0.6691, 0.427], [0.4121, 0.9379, 0.9356]]]]]], 4, Con35971), 
LCro95917 = cropping3D_layer([[[[[1.5498, 1.8601, 1.8245, 1.2208], [1.6672, 1.0458, 1.3191, 1.8178], [1.4874, 1.2028, 1.6063, 1.0101]], [[1.0361, 1.1583, 1.5989, 1.8001], [1.3444, 1.0896, 1.715, 1.3997], [1.7845, 1.2919, 1.4601, 1.0242]], [[1.1819, 1.5681, 1.9977, 1.8488], [1.9327, 1.4638, 1.3603, 1.3545], [1.8973, 1.5886, 1.0175, 1.4576]], [[1.6766, 1.8253, 1.3613, 1.012], [1.9822, 1.3132, 1.296, 1.5007], [1.207, 1.7104, 1.5266, 1.993]]]]], 0, 0, 1, 0, 0, 1, Cro95917), 
LZer22217 = zero_padding3D_layer(Cro95917, 2, 0, 0, 0, 1, 0, Zer22217), 
LSub26997 = subtract_layer(Con35971,Zer22217, Sub26997), 
LRes73001 = reshape_layer(Sub26997, [3, 3, 12], Res73001), 
LRes7830 = reshape_layer(Res73001, [3, 36], Res7830), 
LZer89818 = zero_padding1D_layer(Res7830, 1, 1, Zer89818), 
LPRe64085 = prelu_layer(Zer89818, [[0.3861, 0.8466, 0.8948, 0.2628, 0.3668, 0.9489, 0.4616, 0.9312, 0.6589, 0.4315, 0.8342, 0.7637, 0.0536, 0.8828, 0.1266, 0.6394, 0.7309, 0.1089, 0.0766, 0.4494, 0.374, 0.2569, 0.9623, 0.5271, 0.1279, 0.0498, 0.0793, 0.3259, 0.5636, 0.1409, 0.4308, 0.5132, 0.4162, 0.3586, 0.2693, 0.4283], [0.4954, 0.6663, 0.6569, 0.4186, 0.8341, 0.983, 0.2669, 0.9109, 0.8356, 0.6296, 0.2336, 0.2021, 0.9094, 0.0498, 0.9785, 0.8597, 0.8422, 0.6322, 0.5881, 0.3122, 0.9416, 0.9121, 0.5009, 0.6771, 0.8127, 0.1679, 0.972, 0.1286, 0.4775, 0.4422, 0.0274, 0.1351, 0.4334, 0.3179, 0.3942, 0.7145], [0.1603, 0.3557, 0.1989, 0.4456, 0.534, 0.963, 0.0623, 0.3539, 0.5789, 0.6026, 0.5892, 0.9446, 0.003, 0.6746, 0.148, 0.5951, 0.9991, 0.1094, 0.268, 0.2388, 0.8655, 0.6921, 0.9444, 0.7739, 0.1031, 0.4087, 0.6311, 0.9112, 0.7797, 0.6502, 0.7306, 0.2399, 0.1174, 0.9402, 0.941, 0.135], [0.454, 0.9629, 0.9105, 0.7559, 0.9585, 0.0586, 0.2676, 0.7913, 0.7396, 0.0271, 0.2414, 0.7968, 0.2736, 0.0346, 0.7721, 0.94, 0.403, 0.6537, 0.2199, 0.7171, 0.5072, 0.5825, 0.5241, 0.7413, 0.8308, 0.3886, 0.9413, 0.0121, 0.3713, 0.7007, 0.2938, 0.1741, 0.1722, 0.6316, 0.9979, 0.1444], [0.3478, 0.8596, 0.0111, 0.1511, 0.6719, 0.7147, 0.2334, 0.6583, 0.1038, 0.8234, 0.8326, 0.8763, 0.1986, 0.3499, 0.4207, 0.5555, 0.946, 0.6381, 0.0078, 0.5439, 0.2217, 0.106, 0.1769, 0.1537, 0.6958, 0.5748, 0.9862, 0.725, 0.7411, 0.8248, 0.6852, 0.9018, 0.6122, 0.0596, 0.4566, 0.0419]], PRe64085), 
exec_layers([LDot40939,LRes10779,LRes18007,LZer9696,LCon35971,LCro95917,LZer22217,LSub26997,LRes73001,LRes7830,LZer89818,LPRe64085],["Dot40939","Res10779","Res18007","Zer9696","Con35971","Cro95917","Zer22217","Sub26997","Res73001","Res7830","Zer89818","PRe64085"],PRe64085,"PRe64085")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.8295000, 0.3927000, 0.0304000, 0.0000000, 0.3687000, 0.6426000, 0.0216000, 0.6663030, 0.5643000, 0.0445000, 0.9445000, 0.0000000, 0.6614000, 0.3651000, 0.0037000, 0.0000000, 0.9619000, 0.5987000, 0.5918000, 0.8833866, 0.7008000, 0.2466000, 0.5749000, 0.0000000, 0.7502000, 0.4276000, 0.9003000, 0.0000000, 0.6648000, 0.5569000, 0.7704000, 1.1571441, 0.3037000, 0.8212000, 0.6894000], [0.0000000, 0.4880000, 0.2832000, 0.0864000, 0.0000000, 0.8525000, 0.6107000, 0.5272000, 0.6065993, 0.7676000, 0.3673000, 0.3760000, 0.0000000, 0.9821000, 0.4538000, 0.7922000, 0.0000000, 0.2092000, 0.9025000, 0.6097000, 0.6569093, 0.9250000, 0.3344000, 0.2095000, 0.0000000, 0.6275000, 0.9002000, 0.7584000, 0.0000000, 0.8173000, 0.6358000, 0.9989000, 1.0239868, 0.3094000, 0.6313000, 0.0732000], [0.0000000, 0.2149000, 0.1287000, 0.9899000, -0.9931019, -0.0669153, -0.2707309, -1.0126266, -0.4020616, -0.0179971, -0.2882075, -0.4794346, 0.0000000, 0.3394000, 0.7539000, 0.7803000, -0.4763057, -0.6573607, -0.4022191, -0.8472536, -0.7185007, -0.4242930, -0.2456981, -0.7269188, 0.0000000, 0.2006000, 0.8850000, 0.3950000, -0.6225216, -0.7475768, -0.2033684, -0.1018485, -0.1893284, -0.5691348, -0.3573480, -0.0816004], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0.8295,0.3927,0.0304,0,0.3687,0.6426,0.0216,0.66630303,0.5643,0.0445,0.9445,0,0.6614,0.3651,0.0037,0,0.9619,0.5987,0.5918,0.8833866,0.7008,0.2466,0.5749,0,0.7502,0.4276,0.9003,0,0.6648,0.5569,0.7704,1.1571441199999999,0.3037,0.8212,0.6894],[0,0.488,0.2832,0.0864,0,0.8525,0.6107,0.5272,0.6065993000000001,0.7676,0.3673,0.376,0,0.9821,0.4538,0.7922,0,0.2092,0.9025,0.6097,0.6569092500000001,0.925,0.3344,0.2095,0,0.6275,0.9002,0.7584,0,0.8173,0.6358,0.9989,1.0239867800000002,0.3094,0.6313,0.0732],[0,0.2149,0.1287,0.9899,-0.9931018500000001,-0.06691534,-0.27073091999999993,-1.01262661,-0.40206155908800006,-0.017997109999999997,-0.28820746,-0.4794345599999999,0,0.3394,0.7539,0.7803,-0.4763057,-0.65736072,-0.40221909,-0.84725365,-0.7185007220640001,-0.424293,-0.24569808000000007,-0.72691878,0,0.2006,0.885,0.395,-0.62252158,-0.74757683,-0.20336835999999997,-0.1018485,-0.18932841198599998,-0.56913476,-0.3573479900000001,-0.08160044],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]]

Actual:   [[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0.8295, 0.3927, 0.0304, 0, 0.3687, 0.6426, 0.0216, 0.6664, 0.5643, 0.0445, 0.9445, 0, 0.6614, 0.3651, 0.0037, 0, 0.9619, 0.5987, 0.5918, 0.8834, 0.7008, 0.2466, 0.5749, 0, 0.7502, 0.4276, 0.9003, 0, 0.6648, 0.5569, 0.7704, 1.1572, 0.3037, 0.8212, 0.6894], [0, 0.488, 0.2832, 0.0864, 0, 0.8525, 0.6107, 0.5272, 0.6066, 0.7676, 0.3673, 0.376, 0, 0.9821, 0.4538, 0.7922, 0, 0.2092, 0.9025, 0.6097, 0.657, 0.925, 0.3344, 0.2095, 0, 0.6275, 0.9002, 0.7584, 0, 0.8173, 0.6358, 0.9989, 1.024, 0.3094, 0.6313, 0.0732], [0, 0.2149, 0.1287, 0.9899, -0.9931, -0.0669, -0.2707, -1.0126, -0.402, -0.0179, -0.2882, -0.4794, 0, 0.3394, 0.7539, 0.7803, -0.4763, -0.6573, -0.4022, -0.8472, -0.7185, -0.4242, -0.2456, -0.7269, 0, 0.2006, 0.885, 0.395, -0.6225, -0.7475, -0.2033, -0.1018, -0.1893, -0.5691, -0.3573, -0.0816], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0.8295, 0.3927, 0.0304, 0, 0.3687, 0.6426, 0.0216, 0.6664, 0.5643, 0.0445, 0.9445, 0, 0.6614, 0.3651, 0.0037, 0, 0.9619, 0.5987, 0.5918, 0.8834, 0.7008, 0.2466, 0.5749, 0, 0.7502, 0.4276, 0.9003, 0, 0.6648, 0.5569, 0.7704, 1.1572, 0.3037, 0.8212, 0.6894], [0, 0.488, 0.2832, 0.0864, 0, 0.8525, 0.6107, 0.5272, 0.6066, 0.7676, 0.3673, 0.376, 0, 0.9821, 0.4538, 0.7922, 0, 0.2092, 0.9025, 0.6097, 0.657, 0.925, 0.3344, 0.2095, 0, 0.6275, 0.9002, 0.7584, 0, 0.8173, 0.6358, 0.9989, 1.024, 0.3094, 0.6313, 0.0732], [0, 0.2149, 0.1287, 0.9899, -0.9931, -0.0669, -0.2707, -1.0126, -0.402, -0.0179, -0.2882, -0.4794, 0, 0.3394, 0.7539, 0.7803, -0.4763, -0.6573, -0.4022, -0.8472, -0.7185, -0.4242, -0.2456, -0.7269, 0, 0.2006, 0.885, 0.395, -0.6225, -0.7475, -0.2033, -0.1018, -0.1893, -0.5691, -0.3573, -0.0816], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]