import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max8055 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max8055 = tf.keras.layers.Input(shape=([1, 2, 1]))

Max8055 = keras.layers.Maximum(name = 'Max8055', )([in0Max8055,in1Max8055])
Res3433 = keras.layers.Reshape((1, 2), name = 'Res3433', )(Max8055)
Sep63259 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep63259', )(Res3433)
Res76307 = keras.layers.Reshape((1, 3, 1), name = 'Res76307', )(Sep63259)
Res36838 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res36838', )(Res76307)
Con3595 = keras.layers.Conv3DTranspose(4, (1, 1, 1),strides=(1, 3, 1), padding='valid', name = 'Con3595', )(Res36838)
model = tf.keras.models.Model(inputs=[in0Max8055,in1Max8055], outputs=Con3595)
w = model.get_layer('Sep63259').get_weights() 
w[0] = np.array([[[0.0183], [0.0384]]])
w[1] = np.array([[[0.6975, 0.63, 0.7154], [0.5984, 0.6186, 0.311]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep63259').set_weights(w) 
w = model.get_layer('Con3595').get_weights() 
w[0] = np.array([[[[[0.8718], [0.1577], [0.6482], [0.3459]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con3595').set_weights(w) 
in0Max8055 = tf.constant([[[[0.3138], [0.0226]]]])
in1Max8055 = tf.constant([[[[0.4959], [0.8534]]]])
print (np.array2string(model.predict([in0Max8055,in1Max8055],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con3595.png')

LMax8055 = maximum_layer([[[[[0.3138], [0.0226]]]], [[[[0.4959], [0.8534]]]]], Max8055), 
LRes3433 = reshape_layer(Max8055, [1, 2], Res3433), 
LSep63259 = separable_conv1D_layer(Res3433, 1,[[[[0.0183], [0.0384]]],[[[0.6975, 0.63, 0.7154], [0.5984, 0.6186, 0.311]]]],[0, 0, 0], 1, false, Sep63259), 
LRes76307 = reshape_layer(Sep63259, [1, 3, 1], Res76307), 
LRes36838 = reshape_layer(Res76307, [1, 3, 1, 1], Res36838), 
LCon3595 = conv3D_transpose_layer(Res36838, 1, 1, 1,[[[[[0.8718], [0.1577], [0.6482], [0.3459]]]]],[0, 0, 0, 0], 1, 3, 1, false, Con3595), 
exec_layers([LMax8055,LRes3433,LSep63259,LRes76307,LRes36838,LCon3595],["Max8055","Res3433","Sep63259","Res76307","Res36838","Con3595"],Con3595,"Con3595")

Actual (Unparsed): [[[[[0.0226142, 0.0040907, 0.0168141, 0.0089725]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0226573, 0.0040985, 0.0168461, 0.0089896]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0145450, 0.0026310, 0.0108145, 0.0057710]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]]

Expected (Unparsed): [[[[[0.0226142258211522,0.004090689850878301,0.0168141100909278,0.0089725403894661]],[[0,0,0,0]],[[0,0,0,0]],[[0.0226572969580488,0.0040984809936732,0.0168461343062712,0.0089896295225844]],[[0,0,0,0]],[[0,0,0,0]],[[0.014545004577116398,0.0026310475129746,0.010814489523843599,0.005770953295738199]],[[0,0,0,0]],[[0,0,0,0]]]]]

Actual:   [[[[[0.0227, 0.0041, 0.0169, 0.009]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0.0227, 0.0041, 0.0169, 0.009]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0.0146, 0.0027, 0.0109, 0.0058]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]]]]

Expected: [[[[[0.0227, 0.0041, 0.0169, 0.009]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0.0227, 0.0041, 0.0169, 0.009]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0.0146, 0.0027, 0.0109, 0.0058]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]]]]