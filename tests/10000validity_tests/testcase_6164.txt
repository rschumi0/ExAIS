import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add46693 = tf.keras.layers.Input(shape=([2, 2]))
in1Add46693 = tf.keras.layers.Input(shape=([2, 2]))
in0Max28945 = tf.keras.layers.Input(shape=([1, 2]))
in0Con82846 = tf.keras.layers.Input(shape=([1]))

Add46693 = keras.layers.Add(name = 'Add46693', )([in0Add46693,in1Add46693])
Fla87758 = keras.layers.Flatten(name = 'Fla87758', )(Add46693)
Max28945 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='valid', name = 'Max28945', )(in0Max28945)
Sim41429 = keras.layers.SimpleRNN(3,name = 'Sim41429', )(Max28945)
Con82846 = keras.layers.Concatenate(axis=1, name = 'Con82846', )([Sim41429,in0Con82846])
Min21702 = keras.layers.Minimum(name = 'Min21702', )([Fla87758,Con82846])
Lay12630 = keras.layers.LayerNormalization(axis=1, epsilon=1.3849831127333867, name = 'Lay12630', )(Min21702)
model = tf.keras.models.Model(inputs=[in0Add46693,in1Add46693,in0Max28945,in0Con82846], outputs=Lay12630)
w = model.get_layer('Sim41429').get_weights() 
w[0] = np.array([[8, 2, 8], [6, 10, 5]])
w[1] = np.array([[1, 7, 4], [1, 5, 3], [8, 10, 4]])
w[2] = np.array([3, 7, 9])
model.get_layer('Sim41429').set_weights(w) 
in0Add46693 = tf.constant([[[0.4515, 0.5745], [0.3523, 0.3876]]])
in1Add46693 = tf.constant([[[0.9179, 0.4652], [0.6198, 0.9334]]])
in0Max28945 = tf.constant([[[1.739, 1.9543]]])
in0Con82846 = tf.constant([[0.4462]])
print (np.array2string(model.predict([in0Add46693,in1Add46693,in0Max28945,in0Con82846],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay12630.png')

LAdd46693 = add_layer([[[[0.4515, 0.5745], [0.3523, 0.3876]]], [[[0.9179, 0.4652], [0.6198, 0.9334]]]], Add46693), 
LFla87758 = flatten_layer(Add46693, Fla87758), 
LMax28945 = max_pool1D_layer([[[1.739, 1.9543]]], 1, 1, false, Max28945), 
LSim41429 = simple_rnn_layer(Max28945,[[8, 2, 8], [6, 10, 5]],[[1, 7, 4], [1, 5, 3], [8, 10, 4]],[3, 7, 9], Sim41429), 
LCon82846 = concatenate_layer([Sim41429,[[0.4462]]], 1, Con82846), 
LMin21702 = minimum_layer([Fla87758,Con82846], Min21702), 
LLay12630 = layer_normalization_layer(Min21702, 1, 1.3849831127333867, Lay12630), 
exec_layers([LAdd46693,LFla87758,LMax28945,LSim41429,LCon82846,LMin21702,LLay12630],["Add46693","Fla87758","Max28945","Sim41429","Con82846","Min21702","Lay12630"],Lay12630,"Lay12630")

Actual (Unparsed): [[0.1211579, 0.1211579, 0.0979136, -0.3402295]]

Expected (Unparsed): [[0.1211579337261597,0.1211579337261597,0.09791360605925331,-0.34022947351157307]]

Actual:   [[0.1212, 0.1212, 0.098, -0.3402]]

Expected: [[0.1212, 0.1212, 0.098, -0.3402]]