import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul26046 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul26046 = tf.keras.layers.Input(shape=([1, 2]))

Mul26046 = keras.layers.Multiply(name = 'Mul26046', )([in0Mul26046,in1Mul26046])
LST80165 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST80165', )(Mul26046)
Res85330 = keras.layers.Reshape((1, 1), name = 'Res85330', )(LST80165)
Res99005 = keras.layers.Reshape((1, 1, 1), name = 'Res99005', )(Res85330)
Zer48978 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer48978', )(Res99005)
Bat72411 = keras.layers.BatchNormalization(axis=2, epsilon=0.2924042735613431,  name = 'Bat72411', )(Zer48978)
Res51384 = keras.layers.Reshape((3, 3), name = 'Res51384', )(Bat72411)
Zer80186 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer80186', )(Res51384)
model = tf.keras.models.Model(inputs=[in0Mul26046,in1Mul26046], outputs=Zer80186)
w = model.get_layer('LST80165').get_weights() 
w[0] = np.array([[6, 10, 2, 7], [2, 9, 5, 1]])
w[1] = np.array([[7, 1, 1, 3]])
w[2] = np.array([10, 5, 4, 5])
model.get_layer('LST80165').set_weights(w) 
w = model.get_layer('Bat72411').get_weights() 
w[0] = np.array([0.651, 0.65, 0.0419])
w[1] = np.array([0.3205, 0.6513, 0.143])
w[2] = np.array([0.6489, 0.8106, 0.0527])
w[3] = np.array([0.479, 0.7686, 0.3082])
model.get_layer('Bat72411').set_weights(w) 
in0Mul26046 = tf.constant([[[0.1408, 0.0933]]])
in1Mul26046 = tf.constant([[[0.7607, 0.7092]]])
print (np.array2string(model.predict([in0Mul26046,in1Mul26046],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer80186.png')

LMul26046 = multiply_layer([[[[0.1408, 0.0933]]], [[[0.7607, 0.7092]]]], Mul26046), 
LLST80165 = lstm_layer(Mul26046,[[6, 10, 2, 7], [2, 9, 5, 1]],[[7, 1, 1, 3]],[10, 5, 4, 5], LST80165), 
LRes85330 = reshape_layer(LST80165, [1, 1], Res85330), 
LRes99005 = reshape_layer(Res85330, [1, 1, 1], Res99005), 
LZer48978 = zero_padding2D_layer(Res99005, 1, 1, 1, 1, Zer48978), 
LBat72411 = batch_normalization_layer(Zer48978, 2, 0.2924042735613431, [0.651, 0.65, 0.0419], [0.3205, 0.6513, 0.143], [0.6489, 0.8106, 0.0527], [0.479, 0.7686, 0.3082], Bat72411), 
LRes51384 = reshape_layer(Bat72411, [3, 3], Res51384), 
LZer80186 = zero_padding1D_layer(Res51384, 1, 1, Zer80186), 
exec_layers([LMul26046,LLST80165,LRes85330,LRes99005,LZer48978,LBat72411,LRes51384,LZer80186],["Mul26046","LST80165","Res85330","Res99005","Zer48978","Bat72411","Res51384","Zer80186"],Zer80186,"Zer80186")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000], [-0.1604697, 0.1397814, 0.1401508], [-0.1604697, 0.6188826, 0.1401508], [-0.1604697, 0.1397814, 0.1401508], [0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0],[-0.16046972746490618,0.13978144808678938,0.14015075083846207],[-0.16046972746490618,0.6188825748905493,0.14015075083846207],[-0.16046972746490618,0.13978144808678938,0.14015075083846207],[0,0,0]]]

Actual:   [[[0, 0, 0], [-0.1604, 0.1398, 0.1402], [-0.1604, 0.6189, 0.1402], [-0.1604, 0.1398, 0.1402], [0, 0, 0]]]

Expected: [[[0, 0, 0], [-0.1604, 0.1398, 0.1402], [-0.1604, 0.6189, 0.1402], [-0.1604, 0.1398, 0.1402], [0, 0, 0]]]