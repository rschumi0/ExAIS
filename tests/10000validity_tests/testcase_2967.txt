import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min9408 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Min9408 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Min9408 = keras.layers.Minimum(name = 'Min9408', )([in0Min9408,in1Min9408])
Con21591 = keras.layers.Conv3D(4, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con21591', )(Min9408)
Res55818 = keras.layers.Reshape((2, 2, 8), name = 'Res55818', )(Con21591)
Zer14791 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer14791', )(Res55818)
model = tf.keras.models.Model(inputs=[in0Min9408,in1Min9408], outputs=Zer14791)
w = model.get_layer('Con21591').get_weights() 
w[0] = np.array([[[[[0.3275, 0.0329, 0.6599, 0.4173]]]], [[[[0.7529, 0.1478, 0.6758, 0.4168]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con21591').set_weights(w) 
in0Min9408 = tf.constant([[[[[0.7387], [0.5208]], [[0.3857], [0.3025]]], [[[0.2038], [0.3889]], [[0.7029], [0.8744]]]]])
in1Min9408 = tf.constant([[[[[0.6599], [0.6729]], [[0.0346], [0.2937]]], [[[0.4337], [0.4769]], [[0.8353], [0.2297]]]]])
print (np.array2string(model.predict([in0Min9408,in1Min9408],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer14791.png')

LMin9408 = minimum_layer([[[[[[0.7387], [0.5208]], [[0.3857], [0.3025]]], [[[0.2038], [0.3889]], [[0.7029], [0.8744]]]]], [[[[[0.6599], [0.6729]], [[0.0346], [0.2937]]], [[[0.4337], [0.4769]], [[0.8353], [0.2297]]]]]], Min9408), 
LCon21591 = conv3D_layer(Min9408, 2, 1, 1,[[[[[0.3275, 0.0329, 0.6599, 0.4173]]]], [[[[0.7529, 0.1478, 0.6758, 0.4168]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con21591), 
LRes55818 = reshape_layer(Con21591, [2, 2, 8], Res55818), 
LZer14791 = zero_padding2D_layer(Res55818, 1, 1, 1, 1, Zer14791), 
exec_layers([LMin9408,LCon21591,LRes55818,LZer14791],["Min9408","Con21591","Res55818","Zer14791"],Zer14791,"Zer14791")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.3695583, 0.0518323, 0.5731961, 0.3603201, 0.4633648, 0.0746137, 0.6064945, 0.3794234], [0.5405449, 0.1050270, 0.4978524, 0.3074073, 0.2691279, 0.0436124, 0.3490439, 0.2183000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0667445, 0.0067050, 0.1344876, 0.0850457, 0.1273648, 0.0127948, 0.2566351, 0.1622880], [0.2301997, 0.0231254, 0.4638437, 0.2933202, 0.0752267, 0.0075571, 0.1515790, 0.0958538], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0.36955827,0.05183235,0.5731960500000001,0.36032011,0.46336481000000007,0.07461374,0.60649454,0.37942336000000004],[0.54054491,0.10502695999999999,0.49785235999999994,0.3074073,0.26912788,0.043612389999999994,0.34904389,0.21829997],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0.06674450000000001,0.00670502,0.13448762,0.08504574000000001,0.12736475000000003,0.01279481,0.25663511000000006,0.16228797],[0.23019975,0.02312541,0.46384371,0.29332017,0.07522675,0.00755713,0.15157903,0.09585381],[0,0,0,0,0,0,0,0]],[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]]]]

Actual:   [[[[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]], [[0, 0, 0, 0, 0, 0, 0, 0], [0.3696, 0.0519, 0.5732, 0.3604, 0.4634, 0.0747, 0.6065, 0.3795], [0.5406, 0.1051, 0.4979, 0.3075, 0.2692, 0.0437, 0.3491, 0.2183], [0, 0, 0, 0, 0, 0, 0, 0]], [[0, 0, 0, 0, 0, 0, 0, 0], [0.0668, 0.0068, 0.1345, 0.0851, 0.1274, 0.0128, 0.2567, 0.1623], [0.2302, 0.0232, 0.4639, 0.2934, 0.0753, 0.0076, 0.1516, 0.0959], [0, 0, 0, 0, 0, 0, 0, 0]], [[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]]]]

Expected: [[[[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]], [[0, 0, 0, 0, 0, 0, 0, 0], [0.3696, 0.0519, 0.5732, 0.3604, 0.4634, 0.0747, 0.6065, 0.3795], [0.5406, 0.1051, 0.4979, 0.3075, 0.2692, 0.0437, 0.3491, 0.2183], [0, 0, 0, 0, 0, 0, 0, 0]], [[0, 0, 0, 0, 0, 0, 0, 0], [0.0668, 0.0068, 0.1345, 0.0851, 0.1274, 0.0128, 0.2567, 0.1623], [0.2302, 0.0232, 0.4639, 0.2934, 0.0753, 0.0076, 0.1516, 0.0959], [0, 0, 0, 0, 0, 0, 0, 0]], [[0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0]]]]