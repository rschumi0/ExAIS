import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe89870 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Sub48665 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub48665 = tf.keras.layers.Input(shape=([2, 3]))
in0Add41117 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Add41117 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Ave20382 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave20382 = tf.keras.layers.Input(shape=([2, 1]))
in0Con76843 = tf.keras.layers.Input(shape=([14]))
in0Con15884 = tf.keras.layers.Input(shape=([4]))

PRe89870 = keras.layers.PReLU(name = 'PRe89870', input_shape=(1, 1, 2, 1))(in0PRe89870)
Res6304 = keras.layers.Reshape((1, 1, 2), name = 'Res6304', )(PRe89870)
Res47665 = keras.layers.Reshape((1, 2), name = 'Res47665', )(Res6304)
Loc13287 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc13287', )(Res47665)
Glo68382 = keras.layers.GlobalMaxPool1D(name = 'Glo68382', )(Loc13287)
Res19310 = keras.layers.Reshape((4, 1), name = 'Res19310', )(Glo68382)
Res38819 = keras.layers.Reshape((4, 1, 1), name = 'Res38819', )(Res19310)
Zer76384 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer76384', )(Res38819)
Sub48665 = keras.layers.Subtract(name = 'Sub48665', )([in0Sub48665,in1Sub48665])
Res47568 = keras.layers.Reshape((2, 3, 1), name = 'Res47568', )(Sub48665)
Zer82954 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer82954', )(Res47568)
Max45389 = keras.layers.Maximum(name = 'Max45389', )([Zer76384,Zer82954])
Res82165 = keras.layers.Reshape((4, 5), name = 'Res82165', )(Max45389)
Fla7535 = keras.layers.Flatten(name = 'Fla7535', )(Res82165)
Add41117 = keras.layers.Add(name = 'Add41117', )([in0Add41117,in1Add41117])
Res89424 = keras.layers.Reshape((2, 2, 4), name = 'Res89424', )(Add41117)
Res98445 = keras.layers.Reshape((2, 8), name = 'Res98445', )(Res89424)
Fla52513 = keras.layers.Flatten(name = 'Fla52513', )(Res98445)
Ave20382 = keras.layers.Average(name = 'Ave20382', )([in0Ave20382,in1Ave20382])
LST19944 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST19944', )(Ave20382)
Con76843 = keras.layers.Concatenate(axis=1, name = 'Con76843', )([LST19944,in0Con76843])
Min83695 = keras.layers.Minimum(name = 'Min83695', )([Fla52513,Con76843])
Con15884 = keras.layers.Concatenate(axis=1, name = 'Con15884', )([Min83695,in0Con15884])
Add20511 = keras.layers.Add(name = 'Add20511', )([Fla7535,Con15884])
model = tf.keras.models.Model(inputs=[in0PRe89870,in0Sub48665,in1Sub48665,in0Add41117,in1Add41117,in0Ave20382,in1Ave20382,in0Con76843,in0Con15884], outputs=Add20511)
w = model.get_layer('PRe89870').get_weights() 
w[0] = np.array([[[[0.0081], [0.0519]]]])
model.get_layer('PRe89870').set_weights(w) 
w = model.get_layer('Loc13287').get_weights() 
w[0] = np.array([[[0.6699, 0.9036, 0.4364, 0.8952], [0.2551, 0.7947, 0.3768, 0.8806]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc13287').set_weights(w) 
w = model.get_layer('LST19944').get_weights() 
w[0] = np.array([[5, 5, 6, 5, 1, 5, 5, 4]])
w[1] = np.array([[4, 8, 6, 2, 6, 10, 5, 1], [9, 7, 6, 8, 2, 2, 9, 2]])
w[2] = np.array([8, 4, 2, 3, 3, 4, 7, 5])
model.get_layer('LST19944').set_weights(w) 
in0PRe89870 = tf.constant([[[[[0.0336], [0.7404]]]]])
in0Sub48665 = tf.constant([[[0.3946, 0.2166, 0.2852], [0.6157, 0.1341, 0.3214]]])
in1Sub48665 = tf.constant([[[0.0995, 0.7724, 0.5195], [0.0482, 0.7517, 0.7133]]])
in0Add41117 = tf.constant([[[[[0.1101, 0.7366], [0.6799, 0.1681]], [[0.8941, 0.2312], [0.4905, 0.3092]]], [[[0.4838, 0.8734], [0.0804, 0.0989]], [[0.5967, 0.8144], [0.8159, 0.5629]]]]])
in1Add41117 = tf.constant([[[[[0.2978, 0.1407], [0.7571, 0.7216]], [[0.109, 0.946], [0.3768, 0.4995]]], [[[0.6278, 0.2738], [0.0859, 0.1828]], [[0.7392, 0.8058], [0.1478, 0.8951]]]]])
in0Ave20382 = tf.constant([[[0.8546], [0.2799]]])
in1Ave20382 = tf.constant([[[0.243], [0.125]]])
in0Con76843 = tf.constant([[0.6857, 0.7742, 0.3778, 0.7243, 0.2816, 0.236, 0.3154, 0.1691, 0.4988, 0.0966, 0.1353, 0.9607, 0.4111, 0.2616]])
in0Con15884 = tf.constant([[0.591, 0.6536, 0.9501, 0.4256]])
print (np.array2string(model.predict([in0PRe89870,in0Sub48665,in1Sub48665,in0Add41117,in1Add41117,in0Ave20382,in1Ave20382,in0Con76843,in0Con15884],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add20511.png')

LPRe89870 = prelu_layer([[[[[0.0336], [0.7404]]]]], [[[[0.0081], [0.0519]]]], PRe89870), 
LRes6304 = reshape_layer(PRe89870, [1, 1, 2], Res6304), 
LRes47665 = reshape_layer(Res6304, [1, 2], Res47665), 
LLoc13287 = locally_connected1D_layer(Res47665, 1,[[[0.6699, 0.9036, 0.4364, 0.8952], [0.2551, 0.7947, 0.3768, 0.8806]]],[[0, 0, 0, 0]], 1, Loc13287), 
LGlo68382 = global_max_pool1D_layer(Loc13287, Glo68382), 
LRes19310 = reshape_layer(Glo68382, [4, 1], Res19310), 
LRes38819 = reshape_layer(Res19310, [4, 1, 1], Res38819), 
LZer76384 = zero_padding2D_layer(Res38819, 0, 0, 4, 0, Zer76384), 
LSub48665 = subtract_layer([[[0.3946, 0.2166, 0.2852], [0.6157, 0.1341, 0.3214]]], [[[0.0995, 0.7724, 0.5195], [0.0482, 0.7517, 0.7133]]], Sub48665), 
LRes47568 = reshape_layer(Sub48665, [2, 3, 1], Res47568), 
LZer82954 = zero_padding2D_layer(Res47568, 1, 1, 1, 1, Zer82954), 
LMax45389 = maximum_layer([Zer76384,Zer82954], Max45389), 
LRes82165 = reshape_layer(Max45389, [4, 5], Res82165), 
LFla7535 = flatten_layer(Res82165, Fla7535), 
LAdd41117 = add_layer([[[[[[0.1101, 0.7366], [0.6799, 0.1681]], [[0.8941, 0.2312], [0.4905, 0.3092]]], [[[0.4838, 0.8734], [0.0804, 0.0989]], [[0.5967, 0.8144], [0.8159, 0.5629]]]]], [[[[[0.2978, 0.1407], [0.7571, 0.7216]], [[0.109, 0.946], [0.3768, 0.4995]]], [[[0.6278, 0.2738], [0.0859, 0.1828]], [[0.7392, 0.8058], [0.1478, 0.8951]]]]]], Add41117), 
LRes89424 = reshape_layer(Add41117, [2, 2, 4], Res89424), 
LRes98445 = reshape_layer(Res89424, [2, 8], Res98445), 
LFla52513 = flatten_layer(Res98445, Fla52513), 
LAve20382 = average_layer([[[[0.8546], [0.2799]]], [[[0.243], [0.125]]]], Ave20382), 
LLST19944 = lstm_layer(Ave20382,[[5, 5, 6, 5, 1, 5, 5, 4]],[[4, 8, 6, 2, 6, 10, 5, 1], [9, 7, 6, 8, 2, 2, 9, 2]],[8, 4, 2, 3, 3, 4, 7, 5], LST19944), 
LCon76843 = concatenate_layer([LST19944,[[0.6857, 0.7742, 0.3778, 0.7243, 0.2816, 0.236, 0.3154, 0.1691, 0.4988, 0.0966, 0.1353, 0.9607, 0.4111, 0.2616]]], 1, Con76843), 
LMin83695 = minimum_layer([Fla52513,Con76843], Min83695), 
LCon15884 = concatenate_layer([Min83695,[[0.591, 0.6536, 0.9501, 0.4256]]], 1, Con15884), 
LAdd20511 = add_layer([Fla7535,Con15884], Add20511), 
exec_layers([LPRe89870,LRes6304,LRes47665,LLoc13287,LGlo68382,LRes19310,LRes38819,LZer76384,LSub48665,LRes47568,LZer82954,LMax45389,LRes82165,LFla7535,LAdd41117,LRes89424,LRes98445,LFla52513,LAve20382,LLST19944,LCon76843,LMin83695,LCon15884,LAdd20511],["PRe89870","Res6304","Res47665","Loc13287","Glo68382","Res19310","Res38819","Zer76384","Sub48665","Res47568","Zer82954","Max45389","Res82165","Fla7535","Add41117","Res89424","Res98445","Fla52513","Ave20382","LST19944","Con76843","Min83695","Con15884","Add20511"],Add20511,"Add20511")

Actual (Unparsed): [[0.4079000, 0.8773000, 0.6857000, 0.7742000, 0.5891847, 0.7243000, 0.5767000, 0.2360000, 0.3154000, 0.7878569, 0.1663000, 0.6641000, 0.1353000, 0.9607000, 0.7047458, 0.2616000, 0.5910000, 0.6536000, 0.9501000, 1.1076750]]

Expected (Unparsed): [[0.40790000000000004,0.8773,0.6857,0.7742,0.58918468,0.7243,0.5767,0.236,0.3154,0.78785684,0.1663,0.6641,0.1353,0.9607,0.70474576,0.2616,0.591,0.6536,0.9501,1.10767496]]

Actual:   [[0.4079, 0.8773, 0.6857, 0.7742, 0.5892, 0.7243, 0.5767, 0.236, 0.3154, 0.7879, 0.1663, 0.6641, 0.1353, 0.9607, 0.7048, 0.2616, 0.591, 0.6536, 0.9501, 1.1077]]

Expected: [[0.408, 0.8773, 0.6857, 0.7742, 0.5892, 0.7243, 0.5767, 0.236, 0.3154, 0.7879, 0.1663, 0.6641, 0.1353, 0.9607, 0.7048, 0.2616, 0.591, 0.6536, 0.9501, 1.1077]]