import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max35148 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max35148 = tf.keras.layers.Input(shape=([1, 2, 2]))

Max35148 = keras.layers.Maximum(name = 'Max35148', )([in0Max35148,in1Max35148])
Fla23428 = keras.layers.Flatten(name = 'Fla23428', )(Max35148)
Res86512 = keras.layers.Reshape((4, 1), name = 'Res86512', )(Fla23428)
Res9773 = keras.layers.Reshape((4, 1, 1), name = 'Res9773', )(Res86512)
Res37542 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res37542', )(Res9773)
Con95718 = keras.layers.Conv3D(3, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con95718', )(Res37542)
model = tf.keras.models.Model(inputs=[in0Max35148,in1Max35148], outputs=Con95718)
w = model.get_layer('Con95718').get_weights() 
w[0] = np.array([[[[[0.3501, 0.8093, 0.1363]]]], [[[[0.9417, 0.7146, 0.8859]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con95718').set_weights(w) 
in0Max35148 = tf.constant([[[[0.7852, 0.3519], [0.6127, 0.4355]]]])
in1Max35148 = tf.constant([[[[0.8965, 0.3285], [0.8617, 0.5724]]]])
print (np.array2string(model.predict([in0Max35148,in1Max35148],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con95718.png')

LMax35148 = maximum_layer([[[[[0.7852, 0.3519], [0.6127, 0.4355]]]], [[[[0.8965, 0.3285], [0.8617, 0.5724]]]]], Max35148), 
LFla23428 = flatten_layer(Max35148, Fla23428), 
LRes86512 = reshape_layer(Fla23428, [4, 1], Res86512), 
LRes9773 = reshape_layer(Res86512, [4, 1, 1], Res9773), 
LRes37542 = reshape_layer(Res9773, [4, 1, 1, 1], Res37542), 
LCon95718 = conv3D_layer(Res37542, 2, 1, 1,[[[[[0.3501, 0.8093, 0.1363]]]], [[[[0.9417, 0.7146, 0.8859]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con95718), 
exec_layers([LMax35148,LFla23428,LRes86512,LRes9773,LRes37542,LCon95718],["Max35148","Fla23428","Res86512","Res9773","Res37542","Con95718"],Con95718,"Con95718")

Actual (Unparsed): [[[[[0.6452489, 0.9770052, 0.4339412]]], [[[0.9346631, 0.9005635, 0.8113440]]], [[[0.8407102, 1.1064108, 0.6245388]]], [[[0.2003972, 0.4632433, 0.0780181]]]]]

Expected (Unparsed): [[[[[0.64524888,0.9770051900000001,0.43394116000000005]]],[[[0.9346630800000001,0.9005634900000001,0.811344]]],[[[0.8407102500000001,1.10641085,0.6245388700000001]]],[[[0.20039724000000003,0.46324332,0.07801812000000001]]]]]

Actual:   [[[[[0.6453, 0.9771, 0.434]]], [[[0.9347, 0.9006, 0.8114]]], [[[0.8408, 1.1065, 0.6246]]], [[[0.2004, 0.4633, 0.0781]]]]]

Expected: [[[[[0.6453, 0.9771, 0.434]]], [[[0.9347, 0.9006, 0.8114]]], [[[0.8408, 1.1065, 0.6246]]], [[[0.2004, 0.4633, 0.0781]]]]]