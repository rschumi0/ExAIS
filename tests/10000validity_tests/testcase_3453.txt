import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul90854 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul90854 = tf.keras.layers.Input(shape=([1, 2]))

Mul90854 = keras.layers.Multiply(name = 'Mul90854', )([in0Mul90854,in1Mul90854])
Res31720 = keras.layers.Reshape((1, 2, 1), name = 'Res31720', )(Mul90854)
Dep24564 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep24564', )(Res31720)
Res69462 = keras.layers.Reshape((1, 2), name = 'Res69462', )(Dep24564)
LST11576 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST11576', )(Res69462)
model = tf.keras.models.Model(inputs=[in0Mul90854,in1Mul90854], outputs=LST11576)
w = model.get_layer('Dep24564').get_weights() 
w[0] = np.array([[[[0.0978]]]])
w[1] = np.array([0])
model.get_layer('Dep24564').set_weights(w) 
w = model.get_layer('LST11576').get_weights() 
w[0] = np.array([[4, 2, 7, 3, 10, 10, 8, 1, 7, 1, 9, 2], [10, 9, 7, 9, 2, 2, 5, 1, 1, 1, 7, 10]])
w[1] = np.array([[6, 9, 8, 5, 6, 6, 2, 4, 10, 9, 6, 10], [5, 6, 7, 1, 8, 6, 7, 3, 5, 5, 6, 10], [5, 10, 1, 4, 1, 5, 10, 7, 7, 7, 2, 9]])
w[2] = np.array([4, 1, 7, 2, 10, 5, 9, 5, 2, 10, 5, 6])
model.get_layer('LST11576').set_weights(w) 
in0Mul90854 = tf.constant([[[0.1673, 0.8195]]])
in1Mul90854 = tf.constant([[[0.8714, 0.246]]])
print (np.array2string(model.predict([in0Mul90854,in1Mul90854],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST11576.png')

LMul90854 = multiply_layer([[[[0.1673, 0.8195]]], [[[0.8714, 0.246]]]], Mul90854), 
LRes31720 = reshape_layer(Mul90854, [1, 2, 1], Res31720), 
LDep24564 = depthwise_conv2D_layer(Res31720, 1, 1,[[[[0.0978]]]],[0], 1, 1, false, Dep24564), 
LRes69462 = reshape_layer(Dep24564, [1, 2], Res69462), 
LLST11576 = lstm_layer(Res69462,[[4, 2, 7, 3, 10, 10, 8, 1, 7, 1, 9, 2], [10, 9, 7, 9, 2, 2, 5, 1, 1, 1, 7, 10]],[[6, 9, 8, 5, 6, 6, 2, 4, 10, 9, 6, 10], [5, 6, 7, 1, 8, 6, 7, 3, 5, 5, 6, 10], [5, 10, 1, 4, 1, 5, 10, 7, 7, 7, 2, 9]],[4, 1, 7, 2, 10, 5, 9, 5, 2, 10, 5, 6], LST11576), 
exec_layers([LMul90854,LRes31720,LDep24564,LRes69462,LLST11576],["Mul90854","Res31720","Dep24564","Res69462","LST11576"],LST11576,"LST11576")

Actual (Unparsed): [[0.7556160, 0.6433281, 0.7476073]]

Expected (Unparsed): [[0.7556159693197606,0.6433280657899387,0.7476072847594487]]

Actual:   [[0.7557, 0.6434, 0.7477]]

Expected: [[0.7557, 0.6434, 0.7477]]