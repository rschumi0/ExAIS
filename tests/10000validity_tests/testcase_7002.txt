import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul92469 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Mul92469 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Ave21621 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave21621 = tf.keras.layers.Input(shape=([2, 1]))

Mul92469 = keras.layers.Multiply(name = 'Mul92469', )([in0Mul92469,in1Mul92469])
Con16299 = keras.layers.Conv3DTranspose(4, (1, 1, 1),strides=(2, 11, 1), padding='valid', name = 'Con16299', )(Mul92469)
Res20253 = keras.layers.Reshape((4, 22, 4), name = 'Res20253', )(Con16299)
Res33624 = keras.layers.Reshape((4, 88), name = 'Res33624', )(Res20253)
Up_12308 = keras.layers.UpSampling1D(size=(1), name = 'Up_12308', )(Res33624)
Ave21621 = keras.layers.Average(name = 'Ave21621', )([in0Ave21621,in1Ave21621])
Zer98783 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer98783', )(Ave21621)
Dot86355 = keras.layers.Dot(axes=(1, 1), name = 'Dot86355', )([Up_12308,Zer98783])
model = tf.keras.models.Model(inputs=[in0Mul92469,in1Mul92469,in0Ave21621,in1Ave21621], outputs=Dot86355)
w = model.get_layer('Con16299').get_weights() 
w[0] = np.array([[[[[0.5056], [0.199], [0.658], [0.3762]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con16299').set_weights(w) 
in0Mul92469 = tf.constant([[[[[0.7915]], [[0.9791]]], [[[0.9672]], [[0.079]]]]])
in1Mul92469 = tf.constant([[[[[0.8816]], [[0.5516]]], [[[0.5394]], [[0.0319]]]]])
in0Ave21621 = tf.constant([[[0.2946], [0.8802]]])
in1Ave21621 = tf.constant([[[0.1846], [0.4566]]])
print (np.array2string(model.predict([in0Mul92469,in1Mul92469,in0Ave21621,in1Ave21621],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot86355.png')

LMul92469 = multiply_layer([[[[[[0.7915]], [[0.9791]]], [[[0.9672]], [[0.079]]]]], [[[[[0.8816]], [[0.5516]]], [[[0.5394]], [[0.0319]]]]]], Mul92469), 
LCon16299 = conv3D_transpose_layer(Mul92469, 1, 1, 1,[[[[[0.5056], [0.199], [0.658], [0.3762]]]]],[0, 0, 0, 0], 2, 11, 1, false, Con16299), 
LRes20253 = reshape_layer(Con16299, [4, 22, 4], Res20253), 
LRes33624 = reshape_layer(Res20253, [4, 88], Res33624), 
LUp_12308 = up_sampling1D_layer(Res33624, 1, Up_12308), 
LAve21621 = average_layer([[[[0.2946], [0.8802]]], [[[0.1846], [0.4566]]]], Ave21621), 
LZer98783 = zero_padding1D_layer(Ave21621, 2, 0, Zer98783), 
LDot86355 = dot_layer(Up_12308,Zer98783, 1, 1, Dot86355), 
exec_layers([LMul92469,LCon16299,LRes20253,LRes33624,LUp_12308,LAve21621,LZer98783,LDot86355],["Mul92469","Con16299","Res20253","Res33624","Up_12308","Ave21621","Zer98783","Dot86355"],Dot86355,"Dot86355")

Actual (Unparsed): [[[0.0632006], [0.0248752], [0.0822508], [0.0470254], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0003053], [0.0001202], [0.0003973], [0.0002272], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]]

Expected (Unparsed): [[[0.0632005865607168],[0.024875230865471998],[0.08225076336422399],[0.04702543644015359],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.000305289349376],[0.00012015937604],[0.00039731090168],[0.00022715556415199998],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0]]]

Actual:   [[[0.0633], [0.0249], [0.0823], [0.0471], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0.0004], [0.0002], [0.0004], [0.0003], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]]]

Expected: [[[0.0633], [0.0249], [0.0823], [0.0471], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0.0004], [0.0002], [0.0004], [0.0003], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0], [0]]]