import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat5737 = tf.keras.layers.Input(shape=([1, 3, 2]))

Bat5737 = keras.layers.BatchNormalization(axis=3, epsilon=0.17217414095403866,  name = 'Bat5737', )(in0Bat5737)
Zer787 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer787', )(Bat5737)
model = tf.keras.models.Model(inputs=[in0Bat5737], outputs=Zer787)
w = model.get_layer('Bat5737').get_weights() 
w[0] = np.array([0.7245, 0.3921])
w[1] = np.array([0.2081, 0.5516])
w[2] = np.array([0.9316, 0.3409])
w[3] = np.array([0.0217, 0.2825])
model.get_layer('Bat5737').set_weights(w) 
in0Bat5737 = tf.constant([[[[1.3496, 1.837], [1.5425, 1.0415], [1.1111, 1.6936]]]])
print (np.array2string(model.predict([in0Bat5737],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer787.png')

LBat5737 = batch_normalization_layer([[[[1.3496, 1.837], [1.5425, 1.0415], [1.1111, 1.6936]]]], 3, 0.17217414095403866, [0.7245, 0.3921], [0.2081, 0.5516], [0.9316, 0.3409], [0.0217, 0.2825], Bat5737), 
LZer787 = zero_padding2D_layer(Bat5737, 1, 1, 1, 1, Zer787), 
exec_layers([LBat5737,LZer787],["Bat5737","Zer787"],Zer787,"Zer787")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.8958881, 1.4215761], [1.2132910, 0.9589961], [0.5034540, 1.3381896], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0],[0,0],[0,0],[0,0],[0,0]],[[0,0],[0.8958882122519152,1.4215761319247822],[1.2132909542217585,0.9589960818304275],[0.5034540289454995,1.3381896087525251],[0,0]],[[0,0],[0,0],[0,0],[0,0],[0,0]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0.8959, 1.4216], [1.2133, 0.959], [0.5035, 1.3382], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]]]

Expected: [[[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]], [[0, 0], [0.8959, 1.4216], [1.2133, 0.959], [0.5035, 1.3382], [0, 0]], [[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]]]