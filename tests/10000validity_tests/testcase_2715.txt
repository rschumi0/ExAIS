import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul37697 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul37697 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot3454 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot3454 = tf.keras.layers.Input(shape=([2, 2]))
in0Con87580 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Cro97931 = tf.keras.layers.Input(shape=([4, 3, 1, 2]))

Mul37697 = keras.layers.Multiply(name = 'Mul37697', )([in0Mul37697,in1Mul37697])
Res82862 = keras.layers.Reshape((1, 1, 1), name = 'Res82862', )(Mul37697)
Up_91334 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_91334', )(Res82862)
Res89739 = keras.layers.Reshape((2, 1), name = 'Res89739', )(Up_91334)
Dot3454 = keras.layers.Dot(axes=(2, 1), name = 'Dot3454', )([in0Dot3454,in1Dot3454])
Sep49174 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep49174', )(Dot3454)
Res92352 = keras.layers.Reshape((2, 4, 1), name = 'Res92352', )(Sep49174)
Dep74305 = keras.layers.DepthwiseConv2D((1, 3),strides=(1, 1), padding='valid', name = 'Dep74305', )(Res92352)
Res55983 = keras.layers.Reshape((2, 2), name = 'Res55983', )(Dep74305)
Dot11106 = keras.layers.Dot(axes=(1, 2), name = 'Dot11106', )([Res89739,Res55983])
Res8296 = keras.layers.Reshape((1, 2, 1), name = 'Res8296', )(Dot11106)
Con87580 = keras.layers.Concatenate(axis=3, name = 'Con87580', )([Res8296,in0Con87580])
Cro97931 = keras.layers.Cropping3D(cropping=((3, 0), (2, 0), (0, 0)), name = 'Cro97931', )(in0Cro97931)
Res13497 = keras.layers.Reshape((1, 1, 2), name = 'Res13497', )(Cro97931)
Dep47645 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep47645', )(Res13497)
Zer39239 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer39239', )(Dep47645)
Sub19228 = keras.layers.Subtract(name = 'Sub19228', )([Con87580,Zer39239])
model = tf.keras.models.Model(inputs=[in0Mul37697,in1Mul37697,in0Dot3454,in1Dot3454,in0Con87580,in0Cro97931], outputs=Sub19228)
w = model.get_layer('Sep49174').get_weights() 
w[0] = np.array([[[0.9807], [0.5661]]])
w[1] = np.array([[[0.6803, 0.7646, 0.015, 0.138], [0.2082, 0.2209, 0.8341, 0.7898]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep49174').set_weights(w) 
w = model.get_layer('Dep74305').get_weights() 
w[0] = np.array([[[[0.3531]], [[0.6965]], [[0.9952]]]])
w[1] = np.array([0])
model.get_layer('Dep74305').set_weights(w) 
w = model.get_layer('Dep47645').get_weights() 
w[0] = np.array([[[[0.8699], [0.3919]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep47645').set_weights(w) 
in0Mul37697 = tf.constant([[[0.3201]]])
in1Mul37697 = tf.constant([[[0.1421]]])
in0Dot3454 = tf.constant([[[0.6918, 0.5792], [0.4091, 0.7792]]])
in1Dot3454 = tf.constant([[[0.2906, 0.8928], [0.9655, 0.8785]]])
in0Con87580 = tf.constant([[[[0.4324], [0.8542]]]])
in0Cro97931 = tf.constant([[[[[1.521, 1.7944]], [[1.0408, 1.7861]], [[1.2664, 1.8938]]], [[[1.4722, 1.2205]], [[1.9928, 1.2837]], [[1.5438, 1.4133]]], [[[1.2557, 1.6824]], [[1.9691, 1.1311]], [[1.9426, 1.4386]]], [[[1.3878, 1.9401]], [[1.6926, 1.1069]], [[1.4205, 1.6786]]]]])
print (np.array2string(model.predict([in0Mul37697,in1Mul37697,in0Dot3454,in1Dot3454,in0Con87580,in0Cro97931],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub19228.png')

LMul37697 = multiply_layer([[[[0.3201]]], [[[0.1421]]]], Mul37697), 
LRes82862 = reshape_layer(Mul37697, [1, 1, 1], Res82862), 
LUp_91334 = up_sampling2D_layer(Res82862, 2, 1, Up_91334), 
LRes89739 = reshape_layer(Up_91334, [2, 1], Res89739), 
LDot3454 = dot_layer([[[0.6918, 0.5792], [0.4091, 0.7792]]], [[[0.2906, 0.8928], [0.9655, 0.8785]]], 2, 1, Dot3454), 
LSep49174 = separable_conv1D_layer(Dot3454, 1,[[[[0.9807], [0.5661]]],[[[0.6803, 0.7646, 0.015, 0.138], [0.2082, 0.2209, 0.8341, 0.7898]]]],[0, 0, 0, 0], 1, true, Sep49174), 
LRes92352 = reshape_layer(Sep49174, [2, 4, 1], Res92352), 
LDep74305 = depthwise_conv2D_layer(Res92352, 1, 3,[[[[0.3531]], [[0.6965]], [[0.9952]]]],[0], 1, 1, false, Dep74305), 
LRes55983 = reshape_layer(Dep74305, [2, 2], Res55983), 
LDot11106 = dot_layer(Res89739,Res55983, 1, 2, Dot11106), 
LRes8296 = reshape_layer(Dot11106, [1, 2, 1], Res8296), 
LCon87580 = concatenate_layer([Res8296,[[[[0.4324], [0.8542]]]]], 3, Con87580), 
LCro97931 = cropping3D_layer([[[[[1.521, 1.7944]], [[1.0408, 1.7861]], [[1.2664, 1.8938]]], [[[1.4722, 1.2205]], [[1.9928, 1.2837]], [[1.5438, 1.4133]]], [[[1.2557, 1.6824]], [[1.9691, 1.1311]], [[1.9426, 1.4386]]], [[[1.3878, 1.9401]], [[1.6926, 1.1069]], [[1.4205, 1.6786]]]]], 3, 0, 2, 0, 0, 0, Cro97931), 
LRes13497 = reshape_layer(Cro97931, [1, 1, 2], Res13497), 
LDep47645 = depthwise_conv2D_layer(Res13497, 1, 1,[[[[0.8699], [0.3919]]]],[0, 0], 1, 1, false, Dep47645), 
LZer39239 = zero_padding2D_layer(Dep47645, 0, 0, 1, 0, Zer39239), 
LSub19228 = subtract_layer(Con87580,Zer39239, Sub19228), 
exec_layers([LMul37697,LRes82862,LUp_91334,LRes89739,LDot3454,LSep49174,LRes92352,LDep74305,LRes55983,LDot11106,LRes8296,LCon87580,LCro97931,LRes13497,LDep47645,LZer39239,LSub19228],["Mul37697","Res82862","Up_91334","Res89739","Dot3454","Sep49174","Res92352","Dep74305","Res55983","Dot11106","Res8296","Con87580","Cro97931","Res13497","Dep47645","Zer39239","Sub19228"],Sub19228,"Sub19228")

Actual (Unparsed): [[[[0.1134673, 0.4324000], [-1.1212017, 0.1963567]]]]

Expected (Unparsed): [[[[0.11346726502923299,0.4324],[-1.121201651841481,0.19635665999999985]]]]

Actual:   [[[[0.1135, 0.4324], [-1.1212, 0.1964]]]]

Expected: [[[[0.1135, 0.4324], [-1.1212, 0.1964]]]]