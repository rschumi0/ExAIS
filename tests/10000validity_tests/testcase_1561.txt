import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max39555 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max39555 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Min84621 = tf.keras.layers.Input(shape=([2, 2]))
in1Min84621 = tf.keras.layers.Input(shape=([2, 2]))
in0Con39088 = tf.keras.layers.Input(shape=([2, 2]))

Max39555 = keras.layers.Maximum(name = 'Max39555', )([in0Max39555,in1Max39555])
Res18649 = keras.layers.Reshape((1, 4), name = 'Res18649', )(Max39555)
Zer75052 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer75052', )(Res18649)
Min84621 = keras.layers.Minimum(name = 'Min84621', )([in0Min84621,in1Min84621])
Con39088 = keras.layers.Concatenate(axis=2, name = 'Con39088', )([Min84621,in0Con39088])
Sub49155 = keras.layers.Subtract(name = 'Sub49155', )([Zer75052,Con39088])
model = tf.keras.models.Model(inputs=[in0Max39555,in1Max39555,in0Min84621,in1Min84621,in0Con39088], outputs=Sub49155)
in0Max39555 = tf.constant([[[[0.5145, 0.0863], [0.619, 0.0698]]]])
in1Max39555 = tf.constant([[[[0.5743, 0.5911], [0.1673, 0.8549]]]])
in0Min84621 = tf.constant([[[0.6763, 0.4708], [0.9138, 0.9751]]])
in1Min84621 = tf.constant([[[0.4304, 0.4562], [0.7885, 0.2337]]])
in0Con39088 = tf.constant([[[0.1047, 0.0173], [0.7368, 0.3011]]])
print (np.array2string(model.predict([in0Max39555,in1Max39555,in0Min84621,in1Min84621,in0Con39088],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub49155.png')

LMax39555 = maximum_layer([[[[[0.5145, 0.0863], [0.619, 0.0698]]]], [[[[0.5743, 0.5911], [0.1673, 0.8549]]]]], Max39555), 
LRes18649 = reshape_layer(Max39555, [1, 4], Res18649), 
LZer75052 = zero_padding1D_layer(Res18649, 1, 0, Zer75052), 
LMin84621 = minimum_layer([[[[0.6763, 0.4708], [0.9138, 0.9751]]], [[[0.4304, 0.4562], [0.7885, 0.2337]]]], Min84621), 
LCon39088 = concatenate_layer([Min84621,[[[0.1047, 0.0173], [0.7368, 0.3011]]]], 2, Con39088), 
LSub49155 = subtract_layer(Zer75052,Con39088, Sub49155), 
exec_layers([LMax39555,LRes18649,LZer75052,LMin84621,LCon39088,LSub49155],["Max39555","Res18649","Zer75052","Min84621","Con39088","Sub49155"],Sub49155,"Sub49155")

Actual (Unparsed): [[[-0.4304000, -0.4562000, -0.1047000, -0.0173000], [-0.2142000, 0.3574000, -0.1178000, 0.5538000]]]

Expected (Unparsed): [[[-0.4304,-0.4562,-0.1047,-0.0173],[-0.21419999999999995,0.35739999999999994,-0.11780000000000002,0.5538000000000001]]]

Actual:   [[[-0.4304, -0.4562, -0.1047, -0.0173], [-0.2142, 0.3574, -0.1178, 0.5538]]]

Expected: [[[-0.4304, -0.4562, -0.1047, -0.0173], [-0.2141, 0.3574, -0.1178, 0.5539]]]