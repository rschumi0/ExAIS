import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max96150 = tf.keras.layers.Input(shape=([1, 2, 1]))

Max96150 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max96150', )(in0Max96150)
Res27767 = keras.layers.Reshape((1, 2), name = 'Res27767', )(Max96150)
PRe28615 = keras.layers.PReLU(name = 'PRe28615', )(Res27767)
Res90386 = keras.layers.Reshape((1, 2, 1), name = 'Res90386', )(PRe28615)
Sep54830 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='valid', name = 'Sep54830', )(Res90386)
model = tf.keras.models.Model(inputs=[in0Max96150], outputs=Sep54830)
w = model.get_layer('PRe28615').get_weights() 
w[0] = np.array([[0.7537, 0.3346]])
model.get_layer('PRe28615').set_weights(w) 
w = model.get_layer('Sep54830').get_weights() 
w[0] = np.array([[[[0.0327]]]])
w[1] = np.array([[[[0.067, 0.5749, 0.7936]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep54830').set_weights(w) 
in0Max96150 = tf.constant([[[[1.1417], [1.691]]]])
print (np.array2string(model.predict([in0Max96150],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep54830.png')

LMax96150 = max_pool2D_layer([[[[1.1417], [1.691]]]], 1, 1, Max96150), 
LRes27767 = reshape_layer(Max96150, [1, 2], Res27767), 
LPRe28615 = prelu_layer(Res27767, [[0.7537, 0.3346]], PRe28615), 
LRes90386 = reshape_layer(PRe28615, [1, 2, 1], Res90386), 
LSep54830 = separable_conv2D_layer(Res90386, 1, 1,[[[[[0.0327]]]],[[[[0.067, 0.5749, 0.7936]]]]],[0, 0, 0], 1, 1, false, Sep54830), 
exec_layers([LMax96150,LRes27767,LPRe28615,LRes90386,LSep54830],["Max96150","Res27767","PRe28615","Res90386","Sep54830"],Sep54830,"Sep54830")

Actual (Unparsed): [[[[0.0025014, 0.0214631, 0.0296279], [0.0037048, 0.0317895, 0.0438827]]]]

Expected (Unparsed): [[[[0.0025013505300000003,0.021463080891,0.029627937024],[0.0037048119000000004,0.03178949793,0.04388266752]]]]

Actual:   [[[[0.0026, 0.0215, 0.0297], [0.0038, 0.0318, 0.0439]]]]

Expected: [[[[0.0026, 0.0215, 0.0297], [0.0038, 0.0318, 0.0439]]]]