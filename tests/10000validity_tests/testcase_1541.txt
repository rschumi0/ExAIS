import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub1561 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub1561 = tf.keras.layers.Input(shape=([3, 2]))
in0Add96972 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Add96972 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con85967 = tf.keras.layers.Input(shape=([1, 9]))
in0Cro55345 = tf.keras.layers.Input(shape=([1, 3]))
in0Con2143 = tf.keras.layers.Input(shape=([2, 5, 1]))
in0Min4089 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Min4089 = tf.keras.layers.Input(shape=([2, 1, 2]))

Sub1561 = keras.layers.Subtract(name = 'Sub1561', )([in0Sub1561,in1Sub1561])
ReL59186 = keras.layers.ReLU(max_value=8.583623216029917, negative_slope=0.7003475157139647, threshold=6.301670162284458, name = 'ReL59186', )(Sub1561)
Res87488 = keras.layers.Reshape((3, 2, 1), name = 'Res87488', )(ReL59186)
Max18647 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max18647', )(Res87488)
Res16612 = keras.layers.Reshape((1, 2), name = 'Res16612', )(Max18647)
Zer40539 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer40539', )(Res16612)
Add96972 = keras.layers.Add(name = 'Add96972', )([in0Add96972,in1Add96972])
Res25687 = keras.layers.Reshape((1, 1, 1), name = 'Res25687', )(Add96972)
Res37664 = keras.layers.Reshape((1, 1), name = 'Res37664', )(Res25687)
Con85967 = keras.layers.Concatenate(axis=2, name = 'Con85967', )([Res37664,in0Con85967])
Cro55345 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro55345', )(in0Cro55345)
Res60020 = keras.layers.Reshape((1, 3, 1), name = 'Res60020', )(Cro55345)
Zer50502 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer50502', )(Res60020)
Con2143 = keras.layers.Concatenate(axis=3, name = 'Con2143', )([Zer50502,in0Con2143])
Min4089 = keras.layers.Minimum(name = 'Min4089', )([in0Min4089,in1Min4089])
Zer12596 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer12596', )(Min4089)
Add10103 = keras.layers.Add(name = 'Add10103', )([Con2143,Zer12596])
Res93480 = keras.layers.Reshape((2, 10), name = 'Res93480', )(Add10103)
Dot59035 = keras.layers.Dot(axes=(2, 2), name = 'Dot59035', )([Con85967,Res93480])
Zer99847 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer99847', )(Dot59035)
Max74308 = keras.layers.Maximum(name = 'Max74308', )([Zer40539,Zer99847])
model = tf.keras.models.Model(inputs=[in0Sub1561,in1Sub1561,in0Add96972,in1Add96972,in0Con85967,in0Cro55345,in0Con2143,in0Min4089,in1Min4089], outputs=Max74308)
in0Sub1561 = tf.constant([[[0.2528, 0.2184], [0.0526, 0.1295], [0.7584, 0.3055]]])
in1Sub1561 = tf.constant([[[0.0509, 0.5076], [0.6116, 0.8873], [0.386, 0.3997]]])
in0Add96972 = tf.constant([[[[[0.5301]]]]])
in1Add96972 = tf.constant([[[[[0.1002]]]]])
in0Con85967 = tf.constant([[[0.4815, 0.5326, 0.9844, 0.989, 0.7421, 0.3424, 0.7031, 0.5781, 0.2159]]])
in0Cro55345 = tf.constant([[[1.722, 1.7395, 1.6818]]])
in0Con2143 = tf.constant([[[[0.9419], [0.7098], [0.0258], [0.4134], [0.6084]], [[0.5392], [0.5376], [0.4425], [0.1452], [0.0733]]]])
in0Min4089 = tf.constant([[[[0.2186, 0.3676]], [[0.7414, 0.53]]]])
in1Min4089 = tf.constant([[[[0.6071, 0.6488]], [[0.7542, 0.0291]]]])
print (np.array2string(model.predict([in0Sub1561,in1Sub1561,in0Add96972,in1Add96972,in0Con85967,in0Cro55345,in0Con2143,in0Min4089,in1Min4089],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max74308.png')

LSub1561 = subtract_layer([[[0.2528, 0.2184], [0.0526, 0.1295], [0.7584, 0.3055]]], [[[0.0509, 0.5076], [0.6116, 0.8873], [0.386, 0.3997]]], Sub1561), 
LReL59186 = relu_layer(Sub1561, 8.583623216029917, 0.7003475157139647, 6.301670162284458, ReL59186), 
LRes87488 = reshape_layer(ReL59186, [3, 2, 1], Res87488), 
LMax18647 = max_pool2D_layer(Res87488, 2, 1, Max18647), 
LRes16612 = reshape_layer(Max18647, [1, 2], Res16612), 
LZer40539 = zero_padding1D_layer(Res16612, 2, 0, Zer40539), 
LAdd96972 = add_layer([[[[[[0.5301]]]]], [[[[[0.1002]]]]]], Add96972), 
LRes25687 = reshape_layer(Add96972, [1, 1, 1], Res25687), 
LRes37664 = reshape_layer(Res25687, [1, 1], Res37664), 
LCon85967 = concatenate_layer([Res37664,[[[0.4815, 0.5326, 0.9844, 0.989, 0.7421, 0.3424, 0.7031, 0.5781, 0.2159]]]], 2, Con85967), 
LCro55345 = cropping1D_layer([[[1.722, 1.7395, 1.6818]]], 0, 0, Cro55345), 
LRes60020 = reshape_layer(Cro55345, [1, 3, 1], Res60020), 
LZer50502 = zero_padding2D_layer(Res60020, 1, 0, 2, 0, Zer50502), 
LCon2143 = concatenate_layer([Zer50502,[[[[0.9419], [0.7098], [0.0258], [0.4134], [0.6084]], [[0.5392], [0.5376], [0.4425], [0.1452], [0.0733]]]]], 3, Con2143), 
LMin4089 = minimum_layer([[[[[0.2186, 0.3676]], [[0.7414, 0.53]]]], [[[[0.6071, 0.6488]], [[0.7542, 0.0291]]]]], Min4089), 
LZer12596 = zero_padding2D_layer(Min4089, 0, 0, 4, 0, Zer12596), 
LAdd10103 = add_layer([Con2143,Zer12596], Add10103), 
LRes93480 = reshape_layer(Add10103, [2, 10], Res93480), 
LDot59035 = dot_layer(Con85967,Res93480, 2, 2, Dot59035), 
LZer99847 = zero_padding1D_layer(Dot59035, 1, 1, Zer99847), 
LMax74308 = maximum_layer([Zer40539,Zer99847], Max74308), 
exec_layers([LSub1561,LReL59186,LRes87488,LMax18647,LRes16612,LZer40539,LAdd96972,LRes25687,LRes37664,LCon85967,LCro55345,LRes60020,LZer50502,LCon2143,LMin4089,LZer12596,LAdd10103,LRes93480,LDot59035,LZer99847,LMax74308],["Sub1561","ReL59186","Res87488","Max18647","Res16612","Zer40539","Add96972","Res25687","Res37664","Con85967","Cro55345","Res60020","Zer50502","Con2143","Min4089","Zer12596","Add10103","Res93480","Dot59035","Zer99847","Max74308"],Max74308,"Max74308")

Actual (Unparsed): [[[0.0000000, 0.0000000], [1.7991508, 4.9409306], [0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0],[1.7991507499999997,4.94093049],[0,0]]]

Actual:   [[[0, 0], [1.7992, 4.941], [0, 0]]]

Expected: [[[0, 0], [1.7992, 4.941], [0, 0]]]