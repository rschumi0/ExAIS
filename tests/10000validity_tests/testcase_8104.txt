import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul68554 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Mul68554 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Con83859 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Thr59902 = tf.keras.layers.Input(shape=([1, 1, 2]))

Mul68554 = keras.layers.Multiply(name = 'Mul68554', )([in0Mul68554,in1Mul68554])
Glo37429 = keras.layers.GlobalMaxPool3D(name = 'Glo37429', )(Mul68554)
Res80844 = keras.layers.Reshape((1, 1), name = 'Res80844', )(Glo37429)
Res63424 = keras.layers.Reshape((1, 1, 1), name = 'Res63424', )(Res80844)
Con83859 = keras.layers.Concatenate(axis=3, name = 'Con83859', )([Res63424,in0Con83859])
Thr59902 = keras.layers.ThresholdedReLU(theta=4.067274322160637, name = 'Thr59902', input_shape=(1, 1, 2))(in0Thr59902)
Mul66452 = keras.layers.Multiply(name = 'Mul66452', )([Con83859,Thr59902])
Res55529 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res55529', )(Mul66452)
Zer29657 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer29657', )(Res55529)
Res43173 = keras.layers.Reshape((3, 3, 4), name = 'Res43173', )(Zer29657)
Res22789 = keras.layers.Reshape((3, 12), name = 'Res22789', )(Res43173)
Sep49817 = keras.layers.SeparableConv1D(4, (1),strides=(2), padding='valid', name = 'Sep49817', )(Res22789)
model = tf.keras.models.Model(inputs=[in0Mul68554,in1Mul68554,in0Con83859,in0Thr59902], outputs=Sep49817)
w = model.get_layer('Sep49817').get_weights() 
w[0] = np.array([[[0.0975], [0.2791], [0.1291], [0.576], [0.4817], [0.5469], [0.508], [0.0958], [0.96], [0.4554], [0.9847], [0.831]]])
w[1] = np.array([[[0.2036, 0.0355, 0.167, 0.5341], [0.4527, 0.9514, 0.385, 0.6004], [0.4305, 0.0476, 0.0627, 0.532], [0.6161, 0.6557, 0.3506, 0.8028], [0.8193, 0.7745, 0.1276, 0.9297], [0.4402, 0.212, 0.0633, 0.2135], [0.0408, 0.4193, 0.652, 0.9282], [0.7163, 0.8149, 0.6713, 0.3633], [0.0027, 0.247, 0.5318, 0.3701], [0.0906, 0.127, 0.2854, 0.8344], [0.929, 0.6817, 0.6384, 0.8068], [0.3972, 0.7193, 0.1733, 0.8552]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep49817').set_weights(w) 
in0Mul68554 = tf.constant([[[[[0.8267], [0.3975]]], [[[0.9128], [0.3244]]]]])
in1Mul68554 = tf.constant([[[[[0.1774], [0.8761]]], [[[0.2017], [0.2157]]]]])
in0Con83859 = tf.constant([[[[0.3859]]]])
in0Thr59902 = tf.constant([[[[0.3337, 0.82]]]])
print (np.array2string(model.predict([in0Mul68554,in1Mul68554,in0Con83859,in0Thr59902],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep49817.png')

LMul68554 = multiply_layer([[[[[[0.8267], [0.3975]]], [[[0.9128], [0.3244]]]]], [[[[[0.1774], [0.8761]]], [[[0.2017], [0.2157]]]]]], Mul68554), 
LGlo37429 = global_max_pool3D_layer(Mul68554, Glo37429), 
LRes80844 = reshape_layer(Glo37429, [1, 1], Res80844), 
LRes63424 = reshape_layer(Res80844, [1, 1, 1], Res63424), 
LCon83859 = concatenate_layer([Res63424,[[[[0.3859]]]]], 3, Con83859), 
LThr59902 = thresholded_relu_layer([[[[0.3337, 0.82]]]], 4.067274322160637, Thr59902), 
LMul66452 = multiply_layer([Con83859,Thr59902], Mul66452), 
LRes55529 = reshape_layer(Mul66452, [1, 1, 2, 1], Res55529), 
LZer29657 = zero_padding3D_layer(Res55529, 1, 1, 1, 1, 1, 1, Zer29657), 
LRes43173 = reshape_layer(Zer29657, [3, 3, 4], Res43173), 
LRes22789 = reshape_layer(Res43173, [3, 12], Res22789), 
LSep49817 = separable_conv1D_layer(Res22789, 1,[[[[0.0975], [0.2791], [0.1291], [0.576], [0.4817], [0.5469], [0.508], [0.0958], [0.96], [0.4554], [0.9847], [0.831]]],[[[0.2036, 0.0355, 0.167, 0.5341], [0.4527, 0.9514, 0.385, 0.6004], [0.4305, 0.0476, 0.0627, 0.532], [0.6161, 0.6557, 0.3506, 0.8028], [0.8193, 0.7745, 0.1276, 0.9297], [0.4402, 0.212, 0.0633, 0.2135], [0.0408, 0.4193, 0.652, 0.9282], [0.7163, 0.8149, 0.6713, 0.3633], [0.0027, 0.247, 0.5318, 0.3701], [0.0906, 0.127, 0.2854, 0.8344], [0.929, 0.6817, 0.6384, 0.8068], [0.3972, 0.7193, 0.1733, 0.8552]]]],[0, 0, 0, 0], 2, false, Sep49817), 
exec_layers([LMul68554,LGlo37429,LRes80844,LRes63424,LCon83859,LThr59902,LMul66452,LRes55529,LZer29657,LRes43173,LRes22789,LSep49817],["Mul68554","Glo37429","Res80844","Res63424","Con83859","Thr59902","Mul66452","Res55529","Zer29657","Res43173","Res22789","Sep49817"],Sep49817,"Sep49817")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0]]]

Actual:   [[[0, 0, 0, 0], [0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0], [0, 0, 0, 0]]]