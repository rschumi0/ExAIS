import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max62318 = tf.keras.layers.Input(shape=([2, 2]))
in1Max62318 = tf.keras.layers.Input(shape=([2, 2]))

Max62318 = keras.layers.Maximum(name = 'Max62318', )([in0Max62318,in1Max62318])
Glo91441 = keras.layers.GlobalAveragePooling1D(name = 'Glo91441', )(Max62318)
Res51211 = keras.layers.Reshape((2, 1), name = 'Res51211', )(Glo91441)
Sep74952 = keras.layers.SeparableConv1D(2, (2),strides=(1), padding='valid', name = 'Sep74952', )(Res51211)
model = tf.keras.models.Model(inputs=[in0Max62318,in1Max62318], outputs=Sep74952)
w = model.get_layer('Sep74952').get_weights() 
w[0] = np.array([[[0.8424]], [[0.7379]]])
w[1] = np.array([[[0.1974, 0.4943]]])
w[2] = np.array([0, 0])
model.get_layer('Sep74952').set_weights(w) 
in0Max62318 = tf.constant([[[0.1797, 0.2641], [0.3562, 0.8987]]])
in1Max62318 = tf.constant([[[0.6559, 0.8361], [0.1993, 0.445]]])
print (np.array2string(model.predict([in0Max62318,in1Max62318],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep74952.png')

LMax62318 = maximum_layer([[[[0.1797, 0.2641], [0.3562, 0.8987]]], [[[0.6559, 0.8361], [0.1993, 0.445]]]], Max62318), 
LGlo91441 = global_average_pooling1D_layer(Max62318, Glo91441), 
LRes51211 = reshape_layer(Glo91441, [2, 1], Res51211), 
LSep74952 = separable_conv1D_layer(Res51211, 2,[[[[0.8424]], [[0.7379]]],[[[0.1974, 0.4943]]]],[0, 0], 1, false, Sep74952), 
exec_layers([LMax62318,LGlo91441,LRes51211,LSep74952],["Max62318","Glo91441","Res51211","Sep74952"],Sep74952,"Sep74952")

Actual (Unparsed): [[[0.2104977, 0.5270973]]]

Expected (Unparsed): [[[0.21049768345199998,0.527097289414]]]

Actual:   [[[0.2105, 0.5271]]]

Expected: [[[0.2105, 0.5271]]]