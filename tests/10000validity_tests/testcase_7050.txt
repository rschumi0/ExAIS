import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot10417 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot10417 = tf.keras.layers.Input(shape=([2, 3]))
in0Con5359 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot2110 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot2110 = tf.keras.layers.Input(shape=([3, 2]))
in0Con75084 = tf.keras.layers.Input(shape=([3, 7]))
in0Add30503 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Add30503 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Sub6536 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub6536 = tf.keras.layers.Input(shape=([2, 3]))
in0Con28416 = tf.keras.layers.Input(shape=([4, 5, 1]))

Dot10417 = keras.layers.Dot(axes=(1, 1), name = 'Dot10417', )([in0Dot10417,in1Dot10417])
Res35412 = keras.layers.Reshape((3, 3, 1), name = 'Res35412', )(Dot10417)
Up_78522 = keras.layers.UpSampling2D(size=(1, 1), name = 'Up_78522', )(Res35412)
Res59509 = keras.layers.Reshape((3, 3), name = 'Res59509', )(Up_78522)
Glo91924 = keras.layers.GlobalMaxPool1D(name = 'Glo91924', )(Res59509)
Res88912 = keras.layers.Reshape((3, 1), name = 'Res88912', )(Glo91924)
Con5359 = keras.layers.Concatenate(axis=2, name = 'Con5359', )([Res88912,in0Con5359])
Dot2110 = keras.layers.Dot(axes=(2, 2), name = 'Dot2110', )([in0Dot2110,in1Dot2110])
Add51522 = keras.layers.Add(name = 'Add51522', )([Con5359,Dot2110])
Con75084 = keras.layers.Concatenate(axis=2, name = 'Con75084', )([Add51522,in0Con75084])
Add30503 = keras.layers.Add(name = 'Add30503', )([in0Add30503,in1Add30503])
Lay58307 = keras.layers.LayerNormalization(axis=1, epsilon=2.7274266746574902, name = 'Lay58307', )(Add30503)
Zer7986 = keras.layers.ZeroPadding2D(padding=((3, 0), (4, 0)), name = 'Zer7986', )(Lay58307)
Sub6536 = keras.layers.Subtract(name = 'Sub6536', )([in0Sub6536,in1Sub6536])
Res9726 = keras.layers.Reshape((2, 3, 1), name = 'Res9726', )(Sub6536)
Zer63770 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer63770', )(Res9726)
Con28416 = keras.layers.Concatenate(axis=3, name = 'Con28416', )([Zer63770,in0Con28416])
Max45987 = keras.layers.Maximum(name = 'Max45987', )([Zer7986,Con28416])
Res63876 = keras.layers.Reshape((4, 10), name = 'Res63876', )(Max45987)
Zer52526 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer52526', )(Res63876)
Dot9853 = keras.layers.Dot(axes=(2, 2), name = 'Dot9853', )([Con75084,Zer52526])
model = tf.keras.models.Model(inputs=[in0Dot10417,in1Dot10417,in0Con5359,in0Dot2110,in1Dot2110,in0Con75084,in0Add30503,in1Add30503,in0Sub6536,in1Sub6536,in0Con28416], outputs=Dot9853)
in0Dot10417 = tf.constant([[[0.0282, 0.9567, 0.8169], [0.8034, 0.355, 0.6415]]])
in1Dot10417 = tf.constant([[[0.5154, 0.2068, 0.6027], [0.8915, 0.9985, 0.1546]]])
in0Con5359 = tf.constant([[[0.1515, 0.1579], [0.3774, 0.922], [0.1425, 0.5716]]])
in0Dot2110 = tf.constant([[[0.049, 0.7417], [0.8608, 0.4177], [0.6101, 0.494]]])
in1Dot2110 = tf.constant([[[0.5934, 0.806], [0.4549, 0.4962], [0.7865, 0.7122]]])
in0Con75084 = tf.constant([[[0.3376, 0.7916, 0.7933, 0.087, 0.8338, 0.6217, 0.1289], [0.8616, 0.3473, 0.6762, 0.8334, 0.9596, 0.3348, 0.3277], [0.5949, 0.2009, 0.2203, 0.2424, 0.6558, 0.7839, 0.9028]]])
in0Add30503 = tf.constant([[[[0.9131, 0.3214]]]])
in1Add30503 = tf.constant([[[[0.0321, 0.8689]]]])
in0Sub6536 = tf.constant([[[0.6718, 0.0925, 0.4667], [0.4145, 0.6196, 0.4403]]])
in1Sub6536 = tf.constant([[[0.8341, 0.8171, 0.4696], [0.9915, 0.8, 0.8096]]])
in0Con28416 = tf.constant([[[[0.0313], [0.6172], [0.5202], [0.7796], [0.3828]], [[0.5952], [0.2646], [0.075], [0.2352], [0.4224]], [[0.3287], [0.3437], [0.6354], [0.4568], [0.8792]], [[0.1649], [0.2026], [0.7683], [0.503], [0.4125]]]])
print (np.array2string(model.predict([in0Dot10417,in1Dot10417,in0Con5359,in0Dot2110,in1Dot2110,in0Con75084,in0Add30503,in1Add30503,in0Sub6536,in1Sub6536,in0Con28416],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot9853.png')

LDot10417 = dot_layer([[[0.0282, 0.9567, 0.8169], [0.8034, 0.355, 0.6415]]], [[[0.5154, 0.2068, 0.6027], [0.8915, 0.9985, 0.1546]]], 1, 1, Dot10417), 
LRes35412 = reshape_layer(Dot10417, [3, 3, 1], Res35412), 
LUp_78522 = up_sampling2D_layer(Res35412, 1, 1, Up_78522), 
LRes59509 = reshape_layer(Up_78522, [3, 3], Res59509), 
LGlo91924 = global_max_pool1D_layer(Res59509, Glo91924), 
LRes88912 = reshape_layer(Glo91924, [3, 1], Res88912), 
LCon5359 = concatenate_layer([Res88912,[[[0.1515, 0.1579], [0.3774, 0.922], [0.1425, 0.5716]]]], 2, Con5359), 
LDot2110 = dot_layer([[[0.049, 0.7417], [0.8608, 0.4177], [0.6101, 0.494]]], [[[0.5934, 0.806], [0.4549, 0.4962], [0.7865, 0.7122]]], 2, 2, Dot2110), 
LAdd51522 = add_layer([Con5359,Dot2110], Add51522), 
LCon75084 = concatenate_layer([Add51522,[[[0.3376, 0.7916, 0.7933, 0.087, 0.8338, 0.6217, 0.1289], [0.8616, 0.3473, 0.6762, 0.8334, 0.9596, 0.3348, 0.3277], [0.5949, 0.2009, 0.2203, 0.2424, 0.6558, 0.7839, 0.9028]]]], 2, Con75084), 
LAdd30503 = add_layer([[[[[0.9131, 0.3214]]]], [[[[0.0321, 0.8689]]]]], Add30503), 
LLay58307 = layer_normalization_layer(Add30503, 1, 2.7274266746574902, Lay58307), 
LZer7986 = zero_padding2D_layer(Lay58307, 3, 0, 4, 0, Zer7986), 
LSub6536 = subtract_layer([[[0.6718, 0.0925, 0.4667], [0.4145, 0.6196, 0.4403]]], [[[0.8341, 0.8171, 0.4696], [0.9915, 0.8, 0.8096]]], Sub6536), 
LRes9726 = reshape_layer(Sub6536, [2, 3, 1], Res9726), 
LZer63770 = zero_padding2D_layer(Res9726, 1, 1, 1, 1, Zer63770), 
LCon28416 = concatenate_layer([Zer63770,[[[[0.0313], [0.6172], [0.5202], [0.7796], [0.3828]], [[0.5952], [0.2646], [0.075], [0.2352], [0.4224]], [[0.3287], [0.3437], [0.6354], [0.4568], [0.8792]], [[0.1649], [0.2026], [0.7683], [0.503], [0.4125]]]]], 3, Con28416), 
LMax45987 = maximum_layer([Zer7986,Con28416], Max45987), 
LRes63876 = reshape_layer(Max45987, [4, 10], Res63876), 
LZer52526 = zero_padding1D_layer(Res63876, 1, 0, Zer52526), 
LDot9853 = dot_layer(Con75084,Zer52526, 2, 2, Dot9853), 
exec_layers([LDot10417,LRes35412,LUp_78522,LRes59509,LGlo91924,LRes88912,LCon5359,LDot2110,LAdd51522,LCon75084,LAdd30503,LLay58307,LZer7986,LSub6536,LRes9726,LZer63770,LCon28416,LMax45987,LRes63876,LZer52526,LDot9853],["Dot10417","Res35412","Up_78522","Res59509","Glo91924","Res88912","Con5359","Dot2110","Add51522","Con75084","Add30503","Lay58307","Zer7986","Sub6536","Res9726","Zer63770","Con28416","Max45987","Res63876","Zer52526","Dot9853"],Dot9853,"Dot9853")

Actual (Unparsed): [[[0.0000000, 1.3373738, 0.7218758, 1.2924014, 1.2398092], [0.0000000, 1.7876428, 1.2238712, 1.7731388, 1.4729217], [0.0000000, 1.3594453, 1.1054215, 1.6563942, 1.1017401]]]

Expected (Unparsed): [[[0.0,1.337373797332,0.7218758201279999,1.292401433068,1.2398091884359999],[0.0,1.787642812658,1.223871200832,1.7731388249420001,1.472921754834],[0.0,1.359445283177,1.1054215390079998,1.656394151223,1.1017400671209998]]]

Actual:   [[[0, 1.3374, 0.7219, 1.2925, 1.2399], [0, 1.7877, 1.2239, 1.7732, 1.473], [0, 1.3595, 1.1055, 1.6564, 1.1018]]]

Expected: [[[0, 1.3374, 0.7219, 1.2925, 1.2399], [0, 1.7877, 1.2239, 1.7732, 1.473], [0, 1.3595, 1.1055, 1.6564, 1.1018]]]