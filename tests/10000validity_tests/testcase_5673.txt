import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo27872 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con33992 = tf.keras.layers.Input(shape=([3, 2, 1]))
in0Sub11013 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub11013 = tf.keras.layers.Input(shape=([3, 2, 2]))

Glo27872 = keras.layers.GlobalAveragePooling2D(name = 'Glo27872', )(in0Glo27872)
Res49817 = keras.layers.Reshape((1, 1), name = 'Res49817', )(Glo27872)
GRU44723 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU44723', )(Res49817)
Res11522 = keras.layers.Reshape((1, 1), name = 'Res11522', )(GRU44723)
Res25350 = keras.layers.Reshape((1, 1, 1), name = 'Res25350', )(Res11522)
Cro93438 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro93438', )(Res25350)
Zer84952 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer84952', )(Cro93438)
Con33992 = keras.layers.Concatenate(axis=3, name = 'Con33992', )([Zer84952,in0Con33992])
Sub11013 = keras.layers.Subtract(name = 'Sub11013', )([in0Sub11013,in1Sub11013])
Add11786 = keras.layers.Add(name = 'Add11786', )([Con33992,Sub11013])
model = tf.keras.models.Model(inputs=[in0Glo27872,in0Con33992,in0Sub11013,in1Sub11013], outputs=Add11786)
w = model.get_layer('GRU44723').get_weights() 
w[0] = np.array([[10, 7, 7]])
w[1] = np.array([[5, 6, 9]])
w[2] = np.array([[8, 4, 8], [10, 3, 1]])
model.get_layer('GRU44723').set_weights(w) 
in0Glo27872 = tf.constant([[[[1.6289], [1.9219]], [[1.4779], [1.1017]]]])
in0Con33992 = tf.constant([[[[0.9719], [0.0802]], [[0.049], [0.4406]], [[0.1674], [0.1433]]]])
in0Sub11013 = tf.constant([[[[0.8131, 0.9511], [0.7586, 0.9576]], [[0.2207, 0.0549], [0.2321, 0.9892]], [[0.7639, 0.4163], [0.2602, 0.3192]]]])
in1Sub11013 = tf.constant([[[[0.3819, 0.4445], [0.3375, 0.5153]], [[0.6892, 0.1266], [0.026, 0.6208]], [[0.4077, 0.3045], [0.8894, 0.0372]]]])
print (np.array2string(model.predict([in0Glo27872,in0Con33992,in0Sub11013,in1Sub11013],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add11786.png')

LGlo27872 = global_average_pooling2D_layer([[[[1.6289], [1.9219]], [[1.4779], [1.1017]]]], Glo27872), 
LRes49817 = reshape_layer(Glo27872, [1, 1], Res49817), 
LGRU44723 = gru_layer(Res49817,[[10, 7, 7]],[[5, 6, 9]],[[8, 4, 8], [10, 3, 1]], true, GRU44723), 
LRes11522 = reshape_layer(GRU44723, [1, 1], Res11522), 
LRes25350 = reshape_layer(Res11522, [1, 1, 1], Res25350), 
LCro93438 = cropping2D_layer(Res25350, 0, 0, 0, 0, Cro93438), 
LZer84952 = zero_padding2D_layer(Cro93438, 2, 0, 1, 0, Zer84952), 
LCon33992 = concatenate_layer([Zer84952,[[[[0.9719], [0.0802]], [[0.049], [0.4406]], [[0.1674], [0.1433]]]]], 3, Con33992), 
LSub11013 = subtract_layer([[[[0.8131, 0.9511], [0.7586, 0.9576]], [[0.2207, 0.0549], [0.2321, 0.9892]], [[0.7639, 0.4163], [0.2602, 0.3192]]]], [[[[0.3819, 0.4445], [0.3375, 0.5153]], [[0.6892, 0.1266], [0.026, 0.6208]], [[0.4077, 0.3045], [0.8894, 0.0372]]]], Sub11013), 
LAdd11786 = add_layer([Con33992,Sub11013], Add11786), 
exec_layers([LGlo27872,LRes49817,LGRU44723,LRes11522,LRes25350,LCro93438,LZer84952,LCon33992,LSub11013,LAdd11786],["Glo27872","Res49817","GRU44723","Res11522","Res25350","Cro93438","Zer84952","Con33992","Sub11013","Add11786"],Add11786,"Add11786")

Actual (Unparsed): [[[[0.4312000, 1.4785000], [0.4211000, 0.5225000]], [[-0.4685000, -0.0227000], [0.2061000, 0.8090000]], [[0.3562000, 0.2792000], [-0.6292000, 0.4253000]]]]

Expected (Unparsed): [[[[0.4312,1.4785],[0.42110000000000003,0.5225]],[[-0.4685,-0.022699999999999984],[0.2061,0.8089999999999999]],[[0.3562,0.2792],[-0.6291999999999967,0.4253]]]]

Actual:   [[[[0.4312, 1.4785], [0.4211, 0.5225]], [[-0.4685, -0.0227], [0.2061, 0.809]], [[0.3562, 0.2792], [-0.6292, 0.4253]]]]

Expected: [[[[0.4312, 1.4785], [0.4212, 0.5225]], [[-0.4685, -0.0226], [0.2061, 0.809]], [[0.3562, 0.2792], [-0.6291, 0.4253]]]]