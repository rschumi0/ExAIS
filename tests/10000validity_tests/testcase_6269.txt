import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_75028 = tf.keras.layers.Input(shape=([3, 4, 4, 1]))

Up_75028 = keras.layers.UpSampling3D(size=(2, 2, 2), name = 'Up_75028', )(in0Up_75028)
Res91913 = keras.layers.Reshape((6, 8, 8), name = 'Res91913', )(Up_75028)
Sep67360 = keras.layers.SeparableConv2D(4, (5, 2),strides=(5, 5), padding='valid', name = 'Sep67360', )(Res91913)
Res7316 = keras.layers.Reshape((1, 2, 4, 1), name = 'Res7316', )(Sep67360)
Glo6915 = keras.layers.GlobalMaxPool3D(name = 'Glo6915', )(Res7316)
model = tf.keras.models.Model(inputs=[in0Up_75028], outputs=Glo6915)
w = model.get_layer('Sep67360').get_weights() 
w[0] = np.array([[[[0.8007], [0.1152], [0.9817], [0.6895], [0.9593], [0.3371], [0.2279], [0.354]], [[0.9934], [0.6393], [0.425], [0.787], [0.5989], [0.5429], [0.5141], [0.5255]]], [[[0.4327], [0.4335], [0.4992], [0.0633], [0.7943], [0.8767], [0.9472], [0.8711]], [[0.2376], [0.3202], [0.9298], [0.9885], [0.8889], [0.5582], [0.3951], [0.8119]]], [[[0.3945], [0.1148], [0.1792], [0.679], [0.9732], [0.135], [0.9974], [0.9928]], [[0.0041], [0.4663], [0.7913], [0.9189], [0.9497], [0.3562], [0.7521], [0.1408]]], [[[0.1775], [0.5985], [0.1852], [0.7656], [0.4286], [0.019], [0.1404], [0.2342]], [[0.2565], [0.9064], [0.3896], [0.0077], [0.7548], [0.368], [0.9035], [0.8802]]], [[[0.2847], [0.6167], [0.4524], [0.9967], [0.7162], [0.8806], [0.3334], [0.0432]], [[0.9042], [0.9684], [0.5169], [0.6212], [0.7356], [0.5193], [0.6931], [0.5184]]]])
w[1] = np.array([[[[0.2705, 0.824, 0.0323, 0.0542], [0.4805, 0.8937, 0.7589, 0.9353], [0.4134, 0.1284, 0.2975, 0.9076], [0.4439, 0.3335, 0.5858, 0.813], [0.916, 0.3881, 0.2036, 0.434], [0.9719, 0.2139, 0.0797, 0.1028], [0.5784, 0.3815, 0.049, 0.4898], [0.9929, 0.1317, 0.0818, 0.9697]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep67360').set_weights(w) 
in0Up_75028 = tf.constant([[[[[1.2874], [1.6284], [1.9828], [1.5544]], [[1.9199], [1.4573], [1.067], [1.3081]], [[1.1331], [1.8199], [1.2585], [1.5168]], [[1.2622], [1.6548], [1.3641], [1.9984]]], [[[1.6029], [1.1568], [1.5613], [1.4672]], [[1.579], [1.73], [1.7417], [1.7782]], [[1.4611], [1.3935], [1.0426], [1.3145]], [[1.9354], [1.5455], [1.2963], [1.2532]]], [[[1.5072], [1.7779], [1.5831], [1.6206]], [[1.1944], [1.2585], [1.8083], [1.764]], [[1.2176], [1.0469], [1.2402], [1.1057]], [[1.4263], [1.5965], [1.2461], [1.8244]]]]])
print (np.array2string(model.predict([in0Up_75028],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo6915.png')

LUp_75028 = up_sampling3D_layer([[[[[1.2874], [1.6284], [1.9828], [1.5544]], [[1.9199], [1.4573], [1.067], [1.3081]], [[1.1331], [1.8199], [1.2585], [1.5168]], [[1.2622], [1.6548], [1.3641], [1.9984]]], [[[1.6029], [1.1568], [1.5613], [1.4672]], [[1.579], [1.73], [1.7417], [1.7782]], [[1.4611], [1.3935], [1.0426], [1.3145]], [[1.9354], [1.5455], [1.2963], [1.2532]]], [[[1.5072], [1.7779], [1.5831], [1.6206]], [[1.1944], [1.2585], [1.8083], [1.764]], [[1.2176], [1.0469], [1.2402], [1.1057]], [[1.4263], [1.5965], [1.2461], [1.8244]]]]], 2, 2, 2, Up_75028), 
LRes91913 = reshape_layer(Up_75028, [6, 8, 8], Res91913), 
LSep67360 = separable_conv2D_layer(Res91913, 5, 2,[[[[[0.8007], [0.1152], [0.9817], [0.6895], [0.9593], [0.3371], [0.2279], [0.354]], [[0.9934], [0.6393], [0.425], [0.787], [0.5989], [0.5429], [0.5141], [0.5255]]], [[[0.4327], [0.4335], [0.4992], [0.0633], [0.7943], [0.8767], [0.9472], [0.8711]], [[0.2376], [0.3202], [0.9298], [0.9885], [0.8889], [0.5582], [0.3951], [0.8119]]], [[[0.3945], [0.1148], [0.1792], [0.679], [0.9732], [0.135], [0.9974], [0.9928]], [[0.0041], [0.4663], [0.7913], [0.9189], [0.9497], [0.3562], [0.7521], [0.1408]]], [[[0.1775], [0.5985], [0.1852], [0.7656], [0.4286], [0.019], [0.1404], [0.2342]], [[0.2565], [0.9064], [0.3896], [0.0077], [0.7548], [0.368], [0.9035], [0.8802]]], [[[0.2847], [0.6167], [0.4524], [0.9967], [0.7162], [0.8806], [0.3334], [0.0432]], [[0.9042], [0.9684], [0.5169], [0.6212], [0.7356], [0.5193], [0.6931], [0.5184]]]],[[[[0.2705, 0.824, 0.0323, 0.0542], [0.4805, 0.8937, 0.7589, 0.9353], [0.4134, 0.1284, 0.2975, 0.9076], [0.4439, 0.3335, 0.5858, 0.813], [0.916, 0.3881, 0.2036, 0.434], [0.9719, 0.2139, 0.0797, 0.1028], [0.5784, 0.3815, 0.049, 0.4898], [0.9929, 0.1317, 0.0818, 0.9697]]]]],[0, 0, 0, 0], 5, 5, false, Sep67360), 
LRes7316 = reshape_layer(Sep67360, [1, 2, 4, 1], Res7316), 
LGlo6915 = global_max_pool3D_layer(Res7316, Glo6915), 
exec_layers([LUp_75028,LRes91913,LSep67360,LRes7316,LGlo6915],["Up_75028","Res91913","Sep67360","Res7316","Glo6915"],Glo6915,"Glo6915")

Actual (Unparsed): [[46.7963772]]

Expected (Unparsed): [[46.79637713186401]]

Actual:   [[46.7964]]

Expected: [[46.7964]]