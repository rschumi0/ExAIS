import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave3024 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave3024 = tf.keras.layers.Input(shape=([1, 2]))

Ave3024 = keras.layers.Average(name = 'Ave3024', )([in0Ave3024,in1Ave3024])
Res54087 = keras.layers.Reshape((1, 2, 1), name = 'Res54087', )(Ave3024)
Zer91286 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer91286', )(Res54087)
Res31912 = keras.layers.Reshape((3, 4), name = 'Res31912', )(Zer91286)
Sep3996 = keras.layers.SeparableConv1D(4, (3),strides=(1), padding='same', name = 'Sep3996', )(Res31912)
model = tf.keras.models.Model(inputs=[in0Ave3024,in1Ave3024], outputs=Sep3996)
w = model.get_layer('Sep3996').get_weights() 
w[0] = np.array([[[0.0853], [0.7088], [0.539], [0.9082]], [[0.2788], [0.9872], [0.6866], [0.8272]], [[0.8434], [0.6246], [0.8833], [0.6712]]])
w[1] = np.array([[[0.4184, 0.8021, 0.4346, 0.2396], [0.7448, 0.6121, 0.2505, 0.973], [0.3871, 0.7761, 0.1595, 0.3678], [0.0473, 0.5691, 0.6005, 0.7053]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep3996').set_weights(w) 
in0Ave3024 = tf.constant([[[0.0251, 0.7155]]])
in1Ave3024 = tf.constant([[[0.5657, 0.8497]]])
print (np.array2string(model.predict([in0Ave3024,in1Ave3024],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep3996.png')

LAve3024 = average_layer([[[[0.0251, 0.7155]]], [[[0.5657, 0.8497]]]], Ave3024), 
LRes54087 = reshape_layer(Ave3024, [1, 2, 1], Res54087), 
LZer91286 = zero_padding2D_layer(Res54087, 1, 1, 1, 1, Zer91286), 
LRes31912 = reshape_layer(Zer91286, [3, 4], Res31912), 
LSep3996 = separable_conv1D_layer(Res31912, 3,[[[[0.0853], [0.7088], [0.539], [0.9082]], [[0.2788], [0.9872], [0.6866], [0.8272]], [[0.8434], [0.6246], [0.8833], [0.6712]]],[[[0.4184, 0.8021, 0.4346, 0.2396], [0.7448, 0.6121, 0.2505, 0.973], [0.3871, 0.7761, 0.1595, 0.3678], [0.0473, 0.5691, 0.6005, 0.7053]]]],[0, 0, 0, 0], 1, true, Sep3996), 
exec_layers([LAve3024,LRes54087,LZer91286,LRes31912,LSep3996],["Ave3024","Res54087","Zer91286","Res31912","Sep3996"],Sep3996,"Sep3996")

Actual (Unparsed): [[[0.4050115, 0.6494317, 0.1564766, 0.4337745], [0.4251994, 0.5955242, 0.1587552, 0.4813763], [0.3192329, 0.4555368, 0.1197301, 0.3588722]]]

Expected (Unparsed): [[[0.40501153595,0.649431733902,0.15647662093,0.433774474644],[0.42519940806,0.5955241819239999,0.15875516845999998,0.48137630648799995],[0.319232930436,0.45553679273200004,0.11973008305999999,0.35887218388]]]

Actual:   [[[0.4051, 0.6495, 0.1565, 0.4338], [0.4252, 0.5956, 0.1588, 0.4814], [0.3193, 0.4556, 0.1198, 0.3589]]]

Expected: [[[0.4051, 0.6495, 0.1565, 0.4338], [0.4252, 0.5956, 0.1588, 0.4814], [0.3193, 0.4556, 0.1198, 0.3589]]]