import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer17415 = tf.keras.layers.Input(shape=([3, 2, 4, 2]))
in0Dot81201 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot81201 = tf.keras.layers.Input(shape=([3, 3]))

Zer17415 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer17415', )(in0Zer17415)
Res84659 = keras.layers.Reshape((5, 4, 12), name = 'Res84659', )(Zer17415)
Sep11423 = keras.layers.SeparableConv2D(3, (1, 4),strides=(5, 5), padding='valid', name = 'Sep11423', )(Res84659)
Res70267 = keras.layers.Reshape((1, 3), name = 'Res70267', )(Sep11423)
Zer43256 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer43256', )(Res70267)
Dot81201 = keras.layers.Dot(axes=(1, 2), name = 'Dot81201', )([in0Dot81201,in1Dot81201])
Mul28322 = keras.layers.Multiply(name = 'Mul28322', )([Zer43256,Dot81201])
model = tf.keras.models.Model(inputs=[in0Zer17415,in0Dot81201,in1Dot81201], outputs=Mul28322)
w = model.get_layer('Sep11423').get_weights() 
w[0] = np.array([[[[0.6865], [0.9056], [0.9376], [0.6528], [0.3988], [0.4014], [0.3281], [0.8806], [0.8655], [0.9203], [0.3942], [0.7809]], [[0.0257], [0.8775], [0.2226], [0.8829], [0.6425], [0.8068], [0.3935], [0.964], [0.7213], [0.9488], [0.2241], [0.996]], [[0.6097], [0.7749], [0.7007], [0.5439], [0.3602], [0.2085], [0.5828], [0.6321], [0.5941], [0.2208], [0.1516], [0.461]], [[0.6735], [0.5586], [0.4716], [0.3881], [0.4634], [0.5869], [0.8345], [0.2713], [0.3423], [0.6228], [0.263], [0.6136]]]])
w[1] = np.array([[[[0.3247, 0.0921, 0.6871], [0.7456, 0.9854, 0.8678], [0.4407, 0.8288, 0.5265], [0.0795, 0.5787, 0.1387], [0.4635, 0.0211, 0.0864], [0.9588, 0.5889, 0.2537], [0.3388, 0.1697, 0.7805], [0.7046, 0.7599, 0.1452], [0.5056, 0.4304, 0.3071], [0.4476, 0.4317, 0.5651], [0.641, 0.5186, 0.0569], [0.4869, 0.175, 0.0265]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep11423').set_weights(w) 
in0Zer17415 = tf.constant([[[[[1.0876, 1.4138], [1.4572, 1.5466], [1.9858, 1.8819], [1.6189, 1.1801]], [[1.2363, 1.6655], [1.2415, 1.3853], [1.421, 1.184], [1.4479, 1.1178]]], [[[1.6349, 1.7663], [1.8711, 1.9554], [1.9894, 1.3749], [1.7424, 1.3166]], [[1.7687, 1.7813], [1.3447, 1.9159], [1.7599, 1.6701], [1.0459, 1.6516]]], [[[1.7401, 1.9661], [1.866, 1.8312], [1.3605, 1.5345], [1.545, 1.8852]], [[1.6955, 1.2865], [1.3796, 1.4921], [1.5416, 1.6384], [1.6726, 1.344]]]]])
in0Dot81201 = tf.constant([[[0.1429, 0.218, 0.5012], [0.6208, 0.3983, 0.69], [0.6533, 0.6054, 0.7599]]])
in1Dot81201 = tf.constant([[[0.5807, 0.999, 0.7755], [0.975, 0.0231, 0.2751], [0.1364, 0.5377, 0.4127]]])
print (np.array2string(model.predict([in0Zer17415,in0Dot81201,in1Dot81201],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul28322.png')

LZer17415 = zero_padding3D_layer([[[[[1.0876, 1.4138], [1.4572, 1.5466], [1.9858, 1.8819], [1.6189, 1.1801]], [[1.2363, 1.6655], [1.2415, 1.3853], [1.421, 1.184], [1.4479, 1.1178]]], [[[1.6349, 1.7663], [1.8711, 1.9554], [1.9894, 1.3749], [1.7424, 1.3166]], [[1.7687, 1.7813], [1.3447, 1.9159], [1.7599, 1.6701], [1.0459, 1.6516]]], [[[1.7401, 1.9661], [1.866, 1.8312], [1.3605, 1.5345], [1.545, 1.8852]], [[1.6955, 1.2865], [1.3796, 1.4921], [1.5416, 1.6384], [1.6726, 1.344]]]]], 1, 1, 1, 1, 1, 1, Zer17415), 
LRes84659 = reshape_layer(Zer17415, [5, 4, 12], Res84659), 
LSep11423 = separable_conv2D_layer(Res84659, 1, 4,[[[[[0.6865], [0.9056], [0.9376], [0.6528], [0.3988], [0.4014], [0.3281], [0.8806], [0.8655], [0.9203], [0.3942], [0.7809]], [[0.0257], [0.8775], [0.2226], [0.8829], [0.6425], [0.8068], [0.3935], [0.964], [0.7213], [0.9488], [0.2241], [0.996]], [[0.6097], [0.7749], [0.7007], [0.5439], [0.3602], [0.2085], [0.5828], [0.6321], [0.5941], [0.2208], [0.1516], [0.461]], [[0.6735], [0.5586], [0.4716], [0.3881], [0.4634], [0.5869], [0.8345], [0.2713], [0.3423], [0.6228], [0.263], [0.6136]]]],[[[[0.3247, 0.0921, 0.6871], [0.7456, 0.9854, 0.8678], [0.4407, 0.8288, 0.5265], [0.0795, 0.5787, 0.1387], [0.4635, 0.0211, 0.0864], [0.9588, 0.5889, 0.2537], [0.3388, 0.1697, 0.7805], [0.7046, 0.7599, 0.1452], [0.5056, 0.4304, 0.3071], [0.4476, 0.4317, 0.5651], [0.641, 0.5186, 0.0569], [0.4869, 0.175, 0.0265]]]]],[0, 0, 0], 5, 5, false, Sep11423), 
LRes70267 = reshape_layer(Sep11423, [1, 3], Res70267), 
LZer43256 = zero_padding1D_layer(Res70267, 2, 0, Zer43256), 
LDot81201 = dot_layer([[[0.1429, 0.218, 0.5012], [0.6208, 0.3983, 0.69], [0.6533, 0.6054, 0.7599]]], [[[0.5807, 0.999, 0.7755], [0.975, 0.0231, 0.2751], [0.1364, 0.5377, 0.4127]]], 1, 2, Dot81201), 
LMul28322 = multiply_layer([Zer43256,Dot81201], Mul28322), 
exec_layers([LZer17415,LRes84659,LSep11423,LRes70267,LZer43256,LDot81201,LMul28322],["Zer17415","Res84659","Sep11423","Res70267","Zer43256","Dot81201","Mul28322"],Mul28322,"Mul28322")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0,0.0],[0.0,0.0,0.0],[0.0,0.0,0.0]]]

Actual:   [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]]

Expected: [[[0, 0, 0], [0, 0, 0], [0, 0, 0]]]