import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min87623 = tf.keras.layers.Input(shape=([1, 2]))
in1Min87623 = tf.keras.layers.Input(shape=([1, 2]))
in0Con62599 = tf.keras.layers.Input(shape=([2]))
in0Max75697 = tf.keras.layers.Input(shape=([2, 2]))
in1Max75697 = tf.keras.layers.Input(shape=([2, 2]))
in0Dot29283 = tf.keras.layers.Input(shape=([3]))
in1Dot29283 = tf.keras.layers.Input(shape=([3]))
in0Con55062 = tf.keras.layers.Input(shape=([3]))
in0GRU13749 = tf.keras.layers.Input(shape=([2, 2]))
in0Con31332 = tf.keras.layers.Input(shape=([1]))

Min87623 = keras.layers.Minimum(name = 'Min87623', )([in0Min87623,in1Min87623])
Res41814 = keras.layers.Reshape((1, 2, 1), name = 'Res41814', )(Min87623)
PRe40174 = keras.layers.PReLU(name = 'PRe40174', )(Res41814)
Res13513 = keras.layers.Reshape((1, 2), name = 'Res13513', )(PRe40174)
Fla94752 = keras.layers.Flatten(name = 'Fla94752', )(Res13513)
Con62599 = keras.layers.Concatenate(axis=1, name = 'Con62599', )([Fla94752,in0Con62599])
Max75697 = keras.layers.Maximum(name = 'Max75697', )([in0Max75697,in1Max75697])
Fla73878 = keras.layers.Flatten(name = 'Fla73878', )(Max75697)
Dot29283 = keras.layers.Dot(axes=(1, 1), name = 'Dot29283', )([in0Dot29283,in1Dot29283])
Con55062 = keras.layers.Concatenate(axis=1, name = 'Con55062', )([Dot29283,in0Con55062])
Mul11192 = keras.layers.Multiply(name = 'Mul11192', )([Fla73878,Con55062])
GRU13749 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU13749', )(in0GRU13749)
Con31332 = keras.layers.Concatenate(axis=1, name = 'Con31332', )([GRU13749,in0Con31332])
Mul79998 = keras.layers.Multiply(name = 'Mul79998', )([Mul11192,Con31332])
Min15600 = keras.layers.Minimum(name = 'Min15600', )([Con62599,Mul79998])
model = tf.keras.models.Model(inputs=[in0Min87623,in1Min87623,in0Con62599,in0Max75697,in1Max75697,in0Dot29283,in1Dot29283,in0Con55062,in0GRU13749,in0Con31332], outputs=Min15600)
w = model.get_layer('PRe40174').get_weights() 
w[0] = np.array([[[0.2568], [0.8258]]])
model.get_layer('PRe40174').set_weights(w) 
w = model.get_layer('GRU13749').get_weights() 
w[0] = np.array([[8, 1, 3, 10, 1, 2, 1, 9, 5], [3, 9, 9, 6, 1, 1, 3, 5, 2]])
w[1] = np.array([[2, 9, 2, 2, 1, 9, 2, 3, 8], [5, 10, 1, 5, 2, 6, 10, 2, 4], [4, 1, 10, 4, 10, 4, 7, 1, 3]])
w[2] = np.array([3, 5, 6, 2, 5, 5, 1, 4, 10])
model.get_layer('GRU13749').set_weights(w) 
in0Min87623 = tf.constant([[[0.4524, 0.4892]]])
in1Min87623 = tf.constant([[[0.5406, 0.3025]]])
in0Con62599 = tf.constant([[0.5045, 0.5399]])
in0Max75697 = tf.constant([[[0.1487, 0.2133], [0.5015, 0.6907]]])
in1Max75697 = tf.constant([[[0.3961, 0.3199], [0.9187, 0.0601]]])
in0Dot29283 = tf.constant([[0.5042, 0.3596, 0.4792]])
in1Dot29283 = tf.constant([[0.55, 0.8202, 0.5369]])
in0Con55062 = tf.constant([[0.1416, 0.0142, 0.6134]])
in0GRU13749 = tf.constant([[[9, 8], [5, 7]]])
in0Con31332 = tf.constant([[0.0466]])
print (np.array2string(model.predict([in0Min87623,in1Min87623,in0Con62599,in0Max75697,in1Max75697,in0Dot29283,in1Dot29283,in0Con55062,in0GRU13749,in0Con31332],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min15600.png')

LMin87623 = minimum_layer([[[[0.4524, 0.4892]]], [[[0.5406, 0.3025]]]], Min87623), 
LRes41814 = reshape_layer(Min87623, [1, 2, 1], Res41814), 
LPRe40174 = prelu_layer(Res41814, [[[0.2568], [0.8258]]], PRe40174), 
LRes13513 = reshape_layer(PRe40174, [1, 2], Res13513), 
LFla94752 = flatten_layer(Res13513, Fla94752), 
LCon62599 = concatenate_layer([Fla94752,[[0.5045, 0.5399]]], 1, Con62599), 
LMax75697 = maximum_layer([[[[0.1487, 0.2133], [0.5015, 0.6907]]], [[[0.3961, 0.3199], [0.9187, 0.0601]]]], Max75697), 
LFla73878 = flatten_layer(Max75697, Fla73878), 
LDot29283 = dot_layer([[0.5042, 0.3596, 0.4792]], [[0.55, 0.8202, 0.5369]], 1, 1, Dot29283), 
LCon55062 = concatenate_layer([Dot29283,[[0.1416, 0.0142, 0.6134]]], 1, Con55062), 
LMul11192 = multiply_layer([Fla73878,Con55062], Mul11192), 
LGRU13749 = gru_layer([[[9, 8], [5, 7]]],[[8, 1, 3, 10, 1, 2, 1, 9, 5], [3, 9, 9, 6, 1, 1, 3, 5, 2]],[[2, 9, 2, 2, 1, 9, 2, 3, 8], [5, 10, 1, 5, 2, 6, 10, 2, 4], [4, 1, 10, 4, 10, 4, 7, 1, 3]],[3, 5, 6, 2, 5, 5, 1, 4, 10], false, GRU13749), 
LCon31332 = concatenate_layer([GRU13749,[[0.0466]]], 1, Con31332), 
LMul79998 = multiply_layer([Mul11192,Con31332], Mul79998), 
LMin15600 = minimum_layer([Con62599,Mul79998], Min15600), 
exec_layers([LMin87623,LRes41814,LPRe40174,LRes13513,LFla94752,LCon62599,LMax75697,LFla73878,LDot29283,LCon55062,LMul11192,LGRU13749,LCon31332,LMul79998,LMin15600],["Min87623","Res41814","PRe40174","Res13513","Fla94752","Con62599","Max75697","Fla73878","Dot29283","Con55062","Mul11192","GRU13749","Con31332","Mul79998","Min15600"],Min15600,"Min15600")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000, 0.0197433]]

Expected (Unparsed): [[0.0,0.0,0.0,0.019743272707999998]]

Actual:   [[0, 0, 0, 0.0198]]

Expected: [[0, 0, 0, 0.0198]]