import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave32097 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave32097 = tf.keras.layers.Input(shape=([2, 1]))

Ave32097 = keras.layers.Average(name = 'Ave32097', )([in0Ave32097,in1Ave32097])
Loc74330 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc74330', )(Ave32097)
Res22822 = keras.layers.Reshape((2, 2, 1), name = 'Res22822', )(Loc74330)
Con66149 = keras.layers.Conv2D(3, (1, 2),strides=(4, 2), padding='same', dilation_rate=(1, 1), name = 'Con66149', )(Res22822)
model = tf.keras.models.Model(inputs=[in0Ave32097,in1Ave32097], outputs=Con66149)
w = model.get_layer('Loc74330').get_weights() 
w[0] = np.array([[[0.0586, 0.951]], [[0.7315, 0.8168]]])
w[1] = np.array([[0, 0], [0, 0]])
model.get_layer('Loc74330').set_weights(w) 
w = model.get_layer('Con66149').get_weights() 
w[0] = np.array([[[[0.5232, 0.4068, 0.3603]], [[0.3444, 0.7337, 0.7868]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con66149').set_weights(w) 
in0Ave32097 = tf.constant([[[0.2781], [0.115]]])
in1Ave32097 = tf.constant([[[0.7712], [0.1764]]])
print (np.array2string(model.predict([in0Ave32097,in1Ave32097],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con66149.png')

LAve32097 = average_layer([[[[0.2781], [0.115]]], [[[0.7712], [0.1764]]]], Ave32097), 
LLoc74330 = locally_connected1D_layer(Ave32097, 1,[[[0.0586, 0.951]], [[0.7315, 0.8168]]],[[0, 0], [0, 0]], 1, Loc74330), 
LRes22822 = reshape_layer(Loc74330, [2, 2, 1], Res22822), 
LCon66149 = conv2D_layer(Res22822, 1, 2,[[[[0.5232, 0.4068, 0.3603]], [[0.3444, 0.7337, 0.7868]]]],[0, 0, 0], 4, 2, true, 1, 1, Con66149), 
exec_layers([LAve32097,LLoc74330,LRes22822,LCon66149],["Ave32097","Loc74330","Res22822","Con66149"],Con66149,"Con66149")

Actual (Unparsed): [[[[0.1879212, 0.3785807, 0.4036449]]]]

Expected (Unparsed): [[[[0.187921193628,0.37858071398700005,0.40364492336700003]]]]

Actual:   [[[[0.188, 0.3786, 0.4037]]]]

Expected: [[[[0.188, 0.3786, 0.4037]]]]