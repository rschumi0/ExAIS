import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro54563 = tf.keras.layers.Input(shape=([1, 3]))
in0Ave2869 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave2869 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Mul84374 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul84374 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con19091 = tf.keras.layers.Input(shape=([6]))
in0Max71310 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Max71310 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0GRU12010 = tf.keras.layers.Input(shape=([3, 3]))
in0Con70866 = tf.keras.layers.Input(shape=([7]))

Cro54563 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro54563', )(in0Cro54563)
Ave2869 = keras.layers.Average(name = 'Ave2869', )([in0Ave2869,in1Ave2869])
Res51207 = keras.layers.Reshape((1, 1), name = 'Res51207', )(Ave2869)
Mul84374 = keras.layers.Multiply(name = 'Mul84374', )([in0Mul84374,in1Mul84374])
Res12303 = keras.layers.Reshape((1, 2), name = 'Res12303', )(Mul84374)
Fla33057 = keras.layers.Flatten(name = 'Fla33057', )(Res12303)
Con19091 = keras.layers.Concatenate(axis=1, name = 'Con19091', )([Fla33057,in0Con19091])
Max71310 = keras.layers.Maximum(name = 'Max71310', )([in0Max71310,in1Max71310])
Res1515 = keras.layers.Reshape((1, 2, 4), name = 'Res1515', )(Max71310)
Res20626 = keras.layers.Reshape((1, 8), name = 'Res20626', )(Res1515)
Fla41922 = keras.layers.Flatten(name = 'Fla41922', )(Res20626)
GRU12010 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU12010', )(in0GRU12010)
Con70866 = keras.layers.Concatenate(axis=1, name = 'Con70866', )([GRU12010,in0Con70866])
Max74126 = keras.layers.Maximum(name = 'Max74126', )([Fla41922,Con70866])
Dot39171 = keras.layers.Dot(axes=(1, 1), name = 'Dot39171', )([Con19091,Max74126])
Res40098 = keras.layers.Reshape((1, 1), name = 'Res40098', )(Dot39171)
Sub50662 = keras.layers.Subtract(name = 'Sub50662', )([Res51207,Res40098])
Dot32025 = keras.layers.Dot(axes=(1, 1), name = 'Dot32025', )([Cro54563,Sub50662])
model = tf.keras.models.Model(inputs=[in0Cro54563,in0Ave2869,in1Ave2869,in0Mul84374,in1Mul84374,in0Con19091,in0Max71310,in1Max71310,in0GRU12010,in0Con70866], outputs=Dot32025)
w = model.get_layer('GRU12010').get_weights() 
w[0] = np.array([[4, 2, 3], [6, 4, 3], [3, 5, 9]])
w[1] = np.array([[2, 8, 7]])
w[2] = np.array([9, 7, 1])
model.get_layer('GRU12010').set_weights(w) 
in0Cro54563 = tf.constant([[[1.4518, 1.0532, 1.3172]]])
in0Ave2869 = tf.constant([[[[0.0152]]]])
in1Ave2869 = tf.constant([[[[0.9369]]]])
in0Mul84374 = tf.constant([[[[0.132], [0.8991]]]])
in1Mul84374 = tf.constant([[[[0.5121], [0.4693]]]])
in0Con19091 = tf.constant([[0.8161, 0.806, 0.2694, 0.4596, 0.4045, 0.2102]])
in0Max71310 = tf.constant([[[[[0.1982, 0.2778], [0.8273, 0.2751]], [[0.0207, 0.0927], [0.6118, 0.0229]]]]])
in1Max71310 = tf.constant([[[[[0.1115, 0.7645], [0.7239, 0.484]], [[0.6997, 0.4616], [0.6806, 0.0062]]]]])
in0GRU12010 = tf.constant([[[5, 1, 4], [6, 9, 10], [4, 10, 9]]])
in0Con70866 = tf.constant([[0.8132, 0.3814, 0.6779, 0.1684, 0.8057, 0.2494, 0.4384]])
print (np.array2string(model.predict([in0Cro54563,in0Ave2869,in1Ave2869,in0Mul84374,in1Mul84374,in0Con19091,in0Max71310,in1Max71310,in0GRU12010,in0Con70866],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot32025.png')

LCro54563 = cropping1D_layer([[[1.4518, 1.0532, 1.3172]]], 0, 0, Cro54563), 
LAve2869 = average_layer([[[[[0.0152]]]], [[[[0.9369]]]]], Ave2869), 
LRes51207 = reshape_layer(Ave2869, [1, 1], Res51207), 
LMul84374 = multiply_layer([[[[[0.132], [0.8991]]]], [[[[0.5121], [0.4693]]]]], Mul84374), 
LRes12303 = reshape_layer(Mul84374, [1, 2], Res12303), 
LFla33057 = flatten_layer(Res12303, Fla33057), 
LCon19091 = concatenate_layer([Fla33057,[[0.8161, 0.806, 0.2694, 0.4596, 0.4045, 0.2102]]], 1, Con19091), 
LMax71310 = maximum_layer([[[[[[0.1982, 0.2778], [0.8273, 0.2751]], [[0.0207, 0.0927], [0.6118, 0.0229]]]]], [[[[[0.1115, 0.7645], [0.7239, 0.484]], [[0.6997, 0.4616], [0.6806, 0.0062]]]]]], Max71310), 
LRes1515 = reshape_layer(Max71310, [1, 2, 4], Res1515), 
LRes20626 = reshape_layer(Res1515, [1, 8], Res20626), 
LFla41922 = flatten_layer(Res20626, Fla41922), 
LGRU12010 = gru_layer([[[5, 1, 4], [6, 9, 10], [4, 10, 9]]],[[4, 2, 3], [6, 4, 3], [3, 5, 9]],[[2, 8, 7]],[9, 7, 1], false, GRU12010), 
LCon70866 = concatenate_layer([GRU12010,[[0.8132, 0.3814, 0.6779, 0.1684, 0.8057, 0.2494, 0.4384]]], 1, Con70866), 
LMax74126 = maximum_layer([Fla41922,Con70866], Max74126), 
LDot39171 = dot_layer(Con19091,Max74126, 1, 1, Dot39171), 
LRes40098 = reshape_layer(Dot39171, [1, 1], Res40098), 
LSub50662 = subtract_layer(Res51207,Res40098, Sub50662), 
LDot32025 = dot_layer(Cro54563,Sub50662, 1, 1, Dot32025), 
exec_layers([LCro54563,LAve2869,LRes51207,LMul84374,LRes12303,LFla33057,LCon19091,LMax71310,LRes1515,LRes20626,LFla41922,LGRU12010,LCon70866,LMax74126,LDot39171,LRes40098,LSub50662,LDot32025],["Cro54563","Ave2869","Res51207","Mul84374","Res12303","Fla33057","Con19091","Max71310","Res1515","Res20626","Fla41922","GRU12010","Con70866","Max74126","Dot39171","Res40098","Sub50662","Dot32025"],Dot32025,"Dot32025")

Actual (Unparsed): [[[-2.9446508], [-2.1361801], [-2.6716448]]]

Expected (Unparsed): [[[-2.9446507886641613],[-2.1361800596646194],[-2.6716448676322035]]]

Actual:   [[[-2.9446], [-2.1361], [-2.6716]]]

Expected: [[[-2.9446], [-2.1361], [-2.6716]]]