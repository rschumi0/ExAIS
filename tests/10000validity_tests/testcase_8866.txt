import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep20264 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Mul76727 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul76727 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Min88143 = tf.keras.layers.Input(shape=([2, 2]))
in1Min88143 = tf.keras.layers.Input(shape=([2, 2]))

Sep20264 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep20264', )(in0Sep20264)
Res44667 = keras.layers.Reshape((1, 2), name = 'Res44667', )(Sep20264)
Mul76727 = keras.layers.Multiply(name = 'Mul76727', )([in0Mul76727,in1Mul76727])
Res4908 = keras.layers.Reshape((2, 2), name = 'Res4908', )(Mul76727)
Dot52815 = keras.layers.Dot(axes=(2, 2), name = 'Dot52815', )([Res44667,Res4908])
Zer82918 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer82918', )(Dot52815)
Min88143 = keras.layers.Minimum(name = 'Min88143', )([in0Min88143,in1Min88143])
Max52416 = keras.layers.Maximum(name = 'Max52416', )([Zer82918,Min88143])
model = tf.keras.models.Model(inputs=[in0Sep20264,in0Mul76727,in1Mul76727,in0Min88143,in1Min88143], outputs=Max52416)
w = model.get_layer('Sep20264').get_weights() 
w[0] = np.array([[[[0.02], [0.2831]]]])
w[1] = np.array([[[[0.0373, 0.7477], [0.7845, 0.7433]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep20264').set_weights(w) 
in0Sep20264 = tf.constant([[[[0.9573, 0.1836]]]])
in0Mul76727 = tf.constant([[[[0.9803], [0.1578]], [[0.4942], [0.7613]]]])
in1Mul76727 = tf.constant([[[[0.8574], [0.3077]], [[0.1988], [0.2864]]]])
in0Min88143 = tf.constant([[[0.4704, 0.653], [0.7855, 0.6263]]])
in1Min88143 = tf.constant([[[0.3326, 0.7328], [0.9669, 0.632]]])
print (np.array2string(model.predict([in0Sep20264,in0Mul76727,in1Mul76727,in0Min88143,in1Min88143],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max52416.png')

LSep20264 = separable_conv2D_layer([[[[0.9573, 0.1836]]]], 1, 1,[[[[[0.02], [0.2831]]]],[[[[0.0373, 0.7477], [0.7845, 0.7433]]]]],[0, 0], 1, 1, false, Sep20264), 
LRes44667 = reshape_layer(Sep20264, [1, 2], Res44667), 
LMul76727 = multiply_layer([[[[[0.9803], [0.1578]], [[0.4942], [0.7613]]]], [[[[0.8574], [0.3077]], [[0.1988], [0.2864]]]]], Mul76727), 
LRes4908 = reshape_layer(Mul76727, [2, 2], Res4908), 
LDot52815 = dot_layer(Res44667,Res4908, 2, 2, Dot52815), 
LZer82918 = zero_padding1D_layer(Dot52815, 1, 0, Zer82918), 
LMin88143 = minimum_layer([[[[0.4704, 0.653], [0.7855, 0.6263]]], [[[0.3326, 0.7328], [0.9669, 0.632]]]], Min88143), 
LMax52416 = maximum_layer([Zer82918,Min88143], Max52416), 
exec_layers([LSep20264,LRes44667,LMul76727,LRes4908,LDot52815,LZer82918,LMin88143,LMax52416],["Sep20264","Res44667","Mul76727","Res4908","Dot52815","Zer82918","Min88143","Max52416"],Max52416,"Max52416")

Actual (Unparsed): [[[0.3326000, 0.6530000], [0.7855000, 0.6263000]]]

Expected (Unparsed): [[[0.3326,0.653],[0.7855,0.6263]]]

Actual:   [[[0.3326, 0.653], [0.7855, 0.6263]]]

Expected: [[[0.3326, 0.653], [0.7855, 0.6263]]]