import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave85013 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot20209 = tf.keras.layers.Input(shape=([3]))
in1Dot20209 = tf.keras.layers.Input(shape=([3]))
in0Max25331 = tf.keras.layers.Input(shape=([2, 1]))
in1Max25331 = tf.keras.layers.Input(shape=([2, 1]))
in0Con3281 = tf.keras.layers.Input(shape=([2, 3]))

Ave85013 = keras.layers.AveragePooling2D(pool_size=(2, 2), strides=(2, 1), padding='same', name = 'Ave85013', )(in0Ave85013)
Lay8186 = keras.layers.LayerNormalization(axis=1, epsilon=1.9773545377595156, name = 'Lay8186', )(Ave85013)
Res2816 = keras.layers.Reshape((1, 4), name = 'Res2816', )(Lay8186)
Zer69506 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer69506', )(Res2816)
Dot20209 = keras.layers.Dot(axes=(1, 1), name = 'Dot20209', )([in0Dot20209,in1Dot20209])
Res97555 = keras.layers.Reshape((1, 1), name = 'Res97555', )(Dot20209)
Zer31942 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer31942', )(Res97555)
Max25331 = keras.layers.Maximum(name = 'Max25331', )([in0Max25331,in1Max25331])
Sof778 = keras.layers.Softmax(axis=1, name = 'Sof778', )(Max25331)
Sub82599 = keras.layers.Subtract(name = 'Sub82599', )([Zer31942,Sof778])
Con3281 = keras.layers.Concatenate(axis=2, name = 'Con3281', )([Sub82599,in0Con3281])
Add27411 = keras.layers.Add(name = 'Add27411', )([Zer69506,Con3281])
model = tf.keras.models.Model(inputs=[in0Ave85013,in0Dot20209,in1Dot20209,in0Max25331,in1Max25331,in0Con3281], outputs=Add27411)
in0Ave85013 = tf.constant([[[[1.7949, 1.1643], [1.9072, 1.8171]], [[1.9431, 1.9821], [1.9373, 1.4357]]]])
in0Dot20209 = tf.constant([[0.1788, 0.6272, 0.6316]])
in1Dot20209 = tf.constant([[0.0225, 0.8094, 0.0289]])
in0Max25331 = tf.constant([[[0.9637], [0.567]]])
in1Max25331 = tf.constant([[[0.4059], [0.8804]]])
in0Con3281 = tf.constant([[[0.2239, 0.1433, 0.9857], [0.9773, 0.617, 0.2325]]])
print (np.array2string(model.predict([in0Ave85013,in0Dot20209,in1Dot20209,in0Max25331,in1Max25331,in0Con3281],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add27411.png')

LAve85013 = average_pooling2D_layer([[[[1.7949, 1.1643], [1.9072, 1.8171]], [[1.9431, 1.9821], [1.9373, 1.4357]]]], 2, 2, 2, 1, true, Ave85013), 
LLay8186 = layer_normalization_layer(Ave85013, 1, 1.9773545377595156, Lay8186), 
LRes2816 = reshape_layer(Lay8186, [1, 4], Res2816), 
LZer69506 = zero_padding1D_layer(Res2816, 1, 0, Zer69506), 
LDot20209 = dot_layer([[0.1788, 0.6272, 0.6316]], [[0.0225, 0.8094, 0.0289]], 1, 1, Dot20209), 
LRes97555 = reshape_layer(Dot20209, [1, 1], Res97555), 
LZer31942 = zero_padding1D_layer(Res97555, 1, 0, Zer31942), 
LMax25331 = maximum_layer([[[[0.9637], [0.567]]], [[[0.4059], [0.8804]]]], Max25331), 
LSof778 = softmax_layer(Max25331, 1, Sof778), 
LSub82599 = subtract_layer(Zer31942,Sof778, Sub82599), 
LCon3281 = concatenate_layer([Sub82599,[[[0.2239, 0.1433, 0.9857], [0.9773, 0.617, 0.2325]]]], 2, Con3281), 
LAdd27411 = add_layer([Zer69506,Con3281], Add27411), 
exec_layers([LAve85013,LLay8186,LRes2816,LZer69506,LDot20209,LRes97555,LZer31942,LMax25331,LSof778,LSub82599,LCon3281,LAdd27411],["Ave85013","Lay8186","Res2816","Zer69506","Dot20209","Res97555","Zer31942","Max25331","Sof778","Sub82599","Con3281","Add27411"],Add27411,"Add27411")

Actual (Unparsed): [[[-0.5208130, 0.2239000, 0.1433000, 0.9857000], [0.0507449, 0.9773000, 0.6170000, 0.2325000]]]

Expected (Unparsed): [[[-0.5208129664845009,0.2239,0.1433,0.9857],[0.05074488648450082,0.9773,0.617,0.2325]]]

Actual:   [[[-0.5208, 0.2239, 0.1433, 0.9857], [0.0508, 0.9773, 0.617, 0.2325]]]

Expected: [[[-0.5208, 0.2239, 0.1433, 0.9857], [0.0508, 0.9773, 0.617, 0.2325]]]