import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max39329 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Mas41394 = tf.keras.layers.Input(shape=([1, 2]))
in0Con53097 = tf.keras.layers.Input(shape=([7]))

Max39329 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max39329', )(in0Max39329)
Res31424 = keras.layers.Reshape((2, 4), name = 'Res31424', )(Max39329)
Fla35666 = keras.layers.Flatten(name = 'Fla35666', )(Res31424)
Mas41394 = keras.layers.Masking(mask_value=1, name = 'Mas41394', )(in0Mas41394)
Res37918 = keras.layers.Reshape((1, 2, 1), name = 'Res37918', )(Mas41394)
Glo89705 = keras.layers.GlobalAveragePooling2D(name = 'Glo89705', )(Res37918)
Con53097 = keras.layers.Concatenate(axis=1, name = 'Con53097', )([Glo89705,in0Con53097])
Ave13090 = keras.layers.Average(name = 'Ave13090', )([Fla35666,Con53097])
model = tf.keras.models.Model(inputs=[in0Max39329,in0Mas41394,in0Con53097], outputs=Ave13090)
in0Max39329 = tf.constant([[[[1.7066, 1.5811], [1.8837, 1.0519]], [[1.89, 1.6074], [1.0297, 1.3038]]]])
in0Mas41394 = tf.constant([[[1.0318, 1.7944]]])
in0Con53097 = tf.constant([[0.5221, 0.9476, 0.5057, 0.1491, 0.847, 0.6725, 0.4991]])
print (np.array2string(model.predict([in0Max39329,in0Mas41394,in0Con53097],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave13090.png')

LMax39329 = max_pool2D_layer([[[[1.7066, 1.5811], [1.8837, 1.0519]], [[1.89, 1.6074], [1.0297, 1.3038]]]], 1, 1, Max39329), 
LRes31424 = reshape_layer(Max39329, [2, 4], Res31424), 
LFla35666 = flatten_layer(Res31424, Fla35666), 
LMas41394 = masking_layer([[[1.0318, 1.7944]]], 1, Mas41394), 
LRes37918 = reshape_layer(Mas41394, [1, 2, 1], Res37918), 
LGlo89705 = global_average_pooling2D_layer(Res37918, Glo89705), 
LCon53097 = concatenate_layer([Glo89705,[[0.5221, 0.9476, 0.5057, 0.1491, 0.847, 0.6725, 0.4991]]], 1, Con53097), 
LAve13090 = average_layer([Fla35666,Con53097], Ave13090), 
exec_layers([LMax39329,LRes31424,LFla35666,LMas41394,LRes37918,LGlo89705,LCon53097,LAve13090],["Max39329","Res31424","Fla35666","Mas41394","Res37918","Glo89705","Con53097","Ave13090"],Ave13090,"Ave13090")

Actual (Unparsed): [[1.5598500, 1.0516000, 1.4156500, 0.7788000, 1.0195500, 1.2272000, 0.8511000, 0.9014500]]

Expected (Unparsed): [[1.55985,1.0516,1.4156499999999999,0.7788,1.01955,1.2271999999999998,0.8511,0.9014500000000001]]

Actual:   [[1.5599, 1.0516, 1.4157, 0.7788, 1.0196, 1.2272, 0.8511, 0.9015]]

Expected: [[1.5599, 1.0516, 1.4157, 0.7788, 1.0196, 1.2272, 0.8511, 0.9015]]