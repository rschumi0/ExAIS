import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max61383 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max61383 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Ave13255 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave13255 = tf.keras.layers.Input(shape=([2, 1]))
in0Con11359 = tf.keras.layers.Input(shape=([2, 3]))

Max61383 = keras.layers.Maximum(name = 'Max61383', )([in0Max61383,in1Max61383])
Con28084 = keras.layers.Conv2DTranspose(4, (1, 1),strides=(1, 1), padding='valid', name = 'Con28084', )(Max61383)
Res17709 = keras.layers.Reshape((1, 4), name = 'Res17709', )(Con28084)
Zer55558 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer55558', )(Res17709)
Ave13255 = keras.layers.Average(name = 'Ave13255', )([in0Ave13255,in1Ave13255])
ReL81719 = keras.layers.ReLU(max_value=6.5740532307733055, negative_slope=8.551127334472136, threshold=3.181164567642899, name = 'ReL81719', )(Ave13255)
Con11359 = keras.layers.Concatenate(axis=2, name = 'Con11359', )([ReL81719,in0Con11359])
Min82990 = keras.layers.Minimum(name = 'Min82990', )([Zer55558,Con11359])
model = tf.keras.models.Model(inputs=[in0Max61383,in1Max61383,in0Ave13255,in1Ave13255,in0Con11359], outputs=Min82990)
w = model.get_layer('Con28084').get_weights() 
w[0] = np.array([[[[0.453], [0.3556], [0.6771], [0.1845]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con28084').set_weights(w) 
in0Max61383 = tf.constant([[[[0.9455]]]])
in1Max61383 = tf.constant([[[[0.654]]]])
in0Ave13255 = tf.constant([[[0.5892], [0.4414]]])
in1Ave13255 = tf.constant([[[0.0893], [0.5038]]])
in0Con11359 = tf.constant([[[0.4984, 0.0928, 0.7809], [0.0578, 0.5356, 0.3224]]])
print (np.array2string(model.predict([in0Max61383,in1Max61383,in0Ave13255,in1Ave13255,in0Con11359],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min82990.png')

LMax61383 = maximum_layer([[[[[0.9455]]]], [[[[0.654]]]]], Max61383), 
LCon28084 = conv2D_transpose_layer(Max61383, 1, 1,[[[[0.453], [0.3556], [0.6771], [0.1845]]]],[0, 0, 0, 0], 1, 1, false, Con28084), 
LRes17709 = reshape_layer(Con28084, [1, 4], Res17709), 
LZer55558 = zero_padding1D_layer(Res17709, 1, 0, Zer55558), 
LAve13255 = average_layer([[[[0.5892], [0.4414]]], [[[0.0893], [0.5038]]]], Ave13255), 
LReL81719 = relu_layer(Ave13255, 6.5740532307733055, 8.551127334472136, 3.181164567642899, ReL81719), 
LCon11359 = concatenate_layer([ReL81719,[[[0.4984, 0.0928, 0.7809], [0.0578, 0.5356, 0.3224]]]], 2, Con11359), 
LMin82990 = minimum_layer([Zer55558,Con11359], Min82990), 
exec_layers([LMax61383,LCon28084,LRes17709,LZer55558,LAve13255,LReL81719,LCon11359,LMin82990],["Max61383","Con28084","Res17709","Zer55558","Ave13255","ReL81719","Con11359","Min82990"],Min82990,"Min82990")

Actual (Unparsed): [[[-24.3015733, 0.0000000, 0.0000000, 0.0000000], [-23.1612807, 0.0578000, 0.5356000, 0.1744448]]]

Expected (Unparsed): [[[-24.301573341605756,0,0,0],[-23.161280511553898,0.0578,0.5356,0.17444475]]]

Actual:   [[[-24.3015, 0, 0, 0], [-23.1612, 0.0578, 0.5356, 0.1745]]]

Expected: [[[-24.3015, 0, 0, 0], [-23.1612, 0.0578, 0.5356, 0.1745]]]