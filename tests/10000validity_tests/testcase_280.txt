import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max44904 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max44904 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con10051 = tf.keras.layers.Input(shape=([1, 1]))

Max44904 = keras.layers.Maximum(name = 'Max44904', )([in0Max44904,in1Max44904])
Ave76234 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave76234', )(Max44904)
Res27171 = keras.layers.Reshape((1, 2), name = 'Res27171', )(Ave76234)
Con10051 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con10051', )(in0Con10051)
Dot50810 = keras.layers.Dot(axes=(2, 2), name = 'Dot50810', )([Res27171,Con10051])
model = tf.keras.models.Model(inputs=[in0Max44904,in1Max44904,in0Con10051], outputs=Dot50810)
w = model.get_layer('Con10051').get_weights() 
w[0] = np.array([[[0.6858, 0.3566]]])
w[1] = np.array([0, 0])
model.get_layer('Con10051').set_weights(w) 
in0Max44904 = tf.constant([[[[0.6658, 0.8323]]]])
in1Max44904 = tf.constant([[[[0.6427, 0.2659]]]])
in0Con10051 = tf.constant([[[0.7237]]])
print (np.array2string(model.predict([in0Max44904,in1Max44904,in0Con10051],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot50810.png')

LMax44904 = maximum_layer([[[[[0.6658, 0.8323]]]], [[[[0.6427, 0.2659]]]]], Max44904), 
LAve76234 = average_pooling2D_layer(Max44904, 1, 1, Ave76234), 
LRes27171 = reshape_layer(Ave76234, [1, 2], Res27171), 
LCon10051 = conv1D_layer([[[0.7237]]], 1,[[[0.6858, 0.3566]]],[0, 0], 1, false, 1, Con10051), 
LDot50810 = dot_layer(Res27171,Con10051, 2, 2, Dot50810), 
exec_layers([LMax44904,LAve76234,LRes27171,LCon10051,LDot50810],["Max44904","Ave76234","Res27171","Con10051","Dot50810"],Dot50810,"Dot50810")

Actual (Unparsed): [[[0.5452383]]]

Expected (Unparsed): [[[0.545238344534]]]

Actual:   [[[0.5453]]]

Expected: [[[0.5453]]]