import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dep41017 = tf.keras.layers.Input(shape=([1, 1, 1]))

Dep41017 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep41017', )(in0Dep41017)
Den54549 = keras.layers.Dense(4,name = 'Den54549', )(Dep41017)
Res9881 = keras.layers.Reshape((1, 4), name = 'Res9881', )(Den54549)
Per14974 = keras.layers.Permute((1,2), name = 'Per14974',)(Res9881)
Bat79378 = keras.layers.BatchNormalization(axis=1, epsilon=0.27713340503959005,  name = 'Bat79378', )(Per14974)
Res56727 = keras.layers.Reshape((1, 4, 1), name = 'Res56727', )(Bat79378)
Dep49545 = keras.layers.DepthwiseConv2D((1, 4),strides=(1, 1), padding='valid', name = 'Dep49545', )(Res56727)
model = tf.keras.models.Model(inputs=[in0Dep41017], outputs=Dep49545)
w = model.get_layer('Dep41017').get_weights() 
w[0] = np.array([[[[0.6096]]]])
w[1] = np.array([0])
model.get_layer('Dep41017').set_weights(w) 
w = model.get_layer('Den54549').get_weights() 
w[0] = np.array([[0.7796, 0.1997, 0.7974, 0.4084]])
w[1] = np.array([0.3382, 0.9781, 0.3008, 0.4874])
model.get_layer('Den54549').set_weights(w) 
w = model.get_layer('Bat79378').get_weights() 
w[0] = np.array([0.968])
w[1] = np.array([0.3303])
w[2] = np.array([0.0982])
w[3] = np.array([0.4159])
model.get_layer('Bat79378').set_weights(w) 
w = model.get_layer('Dep49545').get_weights() 
w[0] = np.array([[[[0.2306]], [[0.6588]], [[0.3584]], [[0.3044]]]])
w[1] = np.array([0])
model.get_layer('Dep49545').set_weights(w) 
in0Dep41017 = tf.constant([[[[0.0774]]]])
print (np.array2string(model.predict([in0Dep41017],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep49545.png')

LDep41017 = depthwise_conv2D_layer([[[[0.0774]]]], 1, 1,[[[[0.6096]]]],[0], 1, 1, true, Dep41017), 
LDen54549 = dense_layer(Dep41017, [[0.7796, 0.1997, 0.7974, 0.4084]],[0.3382, 0.9781, 0.3008, 0.4874], Den54549), 
LRes9881 = reshape_layer(Den54549, [1, 4], Res9881), 
LPer14974 = permute_layer(Res9881, 1,2, Per14974), 
LBat79378 = batch_normalization_layer(Per14974, 1, 0.27713340503959005, [0.968], [0.3303], [0.0982], [0.4159], Bat79378), 
LRes56727 = reshape_layer(Bat79378, [1, 4, 1], Res56727), 
LDep49545 = depthwise_conv2D_layer(Res56727, 1, 4,[[[[0.2306]], [[0.6588]], [[0.3584]], [[0.3044]]]],[0], 1, 1, false, Dep49545), 
exec_layers([LDep41017,LDen54549,LRes9881,LPer14974,LBat79378,LRes56727,LDep49545],["Dep41017","Den54549","Res9881","Per14974","Bat79378","Res56727","Dep49545"],Dep49545,"Dep49545")

Actual (Unparsed): [[[[1.5128543]]]]

Expected (Unparsed): [[[[1.5128542616620635]]]]

Actual:   [[[[1.5129]]]]

Expected: [[[[1.5129]]]]