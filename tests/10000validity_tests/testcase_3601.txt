import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub46301 = tf.keras.layers.Input(shape=([3, 3, 2]))
in1Sub46301 = tf.keras.layers.Input(shape=([3, 3, 2]))
in0Dot94390 = tf.keras.layers.Input(shape=([2]))
in1Dot94390 = tf.keras.layers.Input(shape=([2]))
in0Con19601 = tf.keras.layers.Input(shape=([5, 2]))
in0Mul35102 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul35102 = tf.keras.layers.Input(shape=([2, 1]))
in0Con44637 = tf.keras.layers.Input(shape=([5, 2]))
in0Zer63150 = tf.keras.layers.Input(shape=([3, 3]))
in0Con2795 = tf.keras.layers.Input(shape=([5, 3]))

Sub46301 = keras.layers.Subtract(name = 'Sub46301', )([in0Sub46301,in1Sub46301])
Res46115 = keras.layers.Reshape((3, 6), name = 'Res46115', )(Sub46301)
Zer23995 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer23995', )(Res46115)
Dot94390 = keras.layers.Dot(axes=(1, 1), name = 'Dot94390', )([in0Dot94390,in1Dot94390])
Res13083 = keras.layers.Reshape((1, 1), name = 'Res13083', )(Dot94390)
Zer61758 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer61758', )(Res13083)
Con19601 = keras.layers.Concatenate(axis=2, name = 'Con19601', )([Zer61758,in0Con19601])
Mul35102 = keras.layers.Multiply(name = 'Mul35102', )([in0Mul35102,in1Mul35102])
Zer84856 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer84856', )(Mul35102)
Con44637 = keras.layers.Concatenate(axis=2, name = 'Con44637', )([Zer84856,in0Con44637])
Zer63150 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer63150', )(in0Zer63150)
Max56707 = keras.layers.Maximum(name = 'Max56707', )([Con44637,Zer63150])
Add45695 = keras.layers.Add(name = 'Add45695', )([Con19601,Max56707])
Con2795 = keras.layers.Concatenate(axis=2, name = 'Con2795', )([Add45695,in0Con2795])
Ave78741 = keras.layers.Average(name = 'Ave78741', )([Zer23995,Con2795])
model = tf.keras.models.Model(inputs=[in0Sub46301,in1Sub46301,in0Dot94390,in1Dot94390,in0Con19601,in0Mul35102,in1Mul35102,in0Con44637,in0Zer63150,in0Con2795], outputs=Ave78741)
in0Sub46301 = tf.constant([[[[0.9061, 0.123], [0.1199, 0.6012], [0.6955, 0.1152]], [[0.5257, 0.9942], [0.4803, 0.5166], [0.9152, 0.616]], [[0.0769, 0.2686], [0.423, 0.1855], [0.4715, 0.746]]]])
in1Sub46301 = tf.constant([[[[0.3775, 0.4438], [0.9866, 0.5615], [0.6628, 0.632]], [[0.0921, 0.2452], [0.4758, 0.353], [0.8104, 0.826]], [[0.1548, 0.2277], [0.0934, 0.6501], [0.7595, 0.7696]]]])
in0Dot94390 = tf.constant([[0.3795, 0.7402]])
in1Dot94390 = tf.constant([[0.9932, 0.0734]])
in0Con19601 = tf.constant([[[0.1632, 0.6091], [0.4958, 0.9485], [0.0273, 0.7849], [0.8464, 0.9867], [0.5937, 0.0039]]])
in0Mul35102 = tf.constant([[[0.7818], [0.6176]]])
in1Mul35102 = tf.constant([[[0.8766], [0.2339]]])
in0Con44637 = tf.constant([[[0.4968, 0.8157], [0.0287, 0.9869], [0.4022, 0.3587], [0.1345, 0.6039], [0.8192, 0.5034]]])
in0Zer63150 = tf.constant([[[1.0001, 1.7907, 1.3046], [1.8961, 1.1056, 1.0465], [1.2487, 1.975, 1.7996]]])
in0Con2795 = tf.constant([[[0.4136, 0.3471, 0.8695], [0.6728, 0.1924, 0.6321], [0.2779, 0.7773, 0.8462], [0.0818, 0.5329, 0.6058], [0.1507, 0.1563, 0.6564]]])
print (np.array2string(model.predict([in0Sub46301,in1Sub46301,in0Dot94390,in1Dot94390,in0Con19601,in0Mul35102,in1Mul35102,in0Con44637,in0Zer63150,in0Con2795],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave78741.png')

LSub46301 = subtract_layer([[[[0.9061, 0.123], [0.1199, 0.6012], [0.6955, 0.1152]], [[0.5257, 0.9942], [0.4803, 0.5166], [0.9152, 0.616]], [[0.0769, 0.2686], [0.423, 0.1855], [0.4715, 0.746]]]], [[[[0.3775, 0.4438], [0.9866, 0.5615], [0.6628, 0.632]], [[0.0921, 0.2452], [0.4758, 0.353], [0.8104, 0.826]], [[0.1548, 0.2277], [0.0934, 0.6501], [0.7595, 0.7696]]]], Sub46301), 
LRes46115 = reshape_layer(Sub46301, [3, 6], Res46115), 
LZer23995 = zero_padding1D_layer(Res46115, 2, 0, Zer23995), 
LDot94390 = dot_layer([[0.3795, 0.7402]], [[0.9932, 0.0734]], 1, 1, Dot94390), 
LRes13083 = reshape_layer(Dot94390, [1, 1], Res13083), 
LZer61758 = zero_padding1D_layer(Res13083, 4, 0, Zer61758), 
LCon19601 = concatenate_layer([Zer61758,[[[0.1632, 0.6091], [0.4958, 0.9485], [0.0273, 0.7849], [0.8464, 0.9867], [0.5937, 0.0039]]]], 2, Con19601), 
LMul35102 = multiply_layer([[[[0.7818], [0.6176]]], [[[0.8766], [0.2339]]]], Mul35102), 
LZer84856 = zero_padding1D_layer(Mul35102, 3, 0, Zer84856), 
LCon44637 = concatenate_layer([Zer84856,[[[0.4968, 0.8157], [0.0287, 0.9869], [0.4022, 0.3587], [0.1345, 0.6039], [0.8192, 0.5034]]]], 2, Con44637), 
LZer63150 = zero_padding1D_layer([[[1.0001, 1.7907, 1.3046], [1.8961, 1.1056, 1.0465], [1.2487, 1.975, 1.7996]]], 1, 1, Zer63150), 
LMax56707 = maximum_layer([Con44637,Zer63150], Max56707), 
LAdd45695 = add_layer([Con19601,Max56707], Add45695), 
LCon2795 = concatenate_layer([Add45695,[[[0.4136, 0.3471, 0.8695], [0.6728, 0.1924, 0.6321], [0.2779, 0.7773, 0.8462], [0.0818, 0.5329, 0.6058], [0.1507, 0.1563, 0.6564]]]], 2, Con2795), 
LAve78741 = average_layer([Zer23995,Con2795], Ave78741), 
exec_layers([LSub46301,LRes46115,LZer23995,LDot94390,LRes13083,LZer61758,LCon19601,LMul35102,LZer84856,LCon44637,LZer63150,LMax56707,LAdd45695,LCon2795,LAve78741],["Sub46301","Res46115","Zer23995","Dot94390","Res13083","Zer61758","Con19601","Mul35102","Zer84856","Con44637","Zer63150","Max56707","Add45695","Con2795","Ave78741"],Ave78741,"Ave78741")

Actual (Unparsed): [[[0.0000000, 0.3300000, 0.7124000, 0.2068000, 0.1735500, 0.4347500], [0.5000500, 1.1432500, 1.1265500, 0.3364000, 0.0962000, 0.3160500], [1.2123500, 0.4060500, 0.4823500, 0.1588000, 0.4050000, 0.1647000], [0.8411500, 1.7852000, 1.3954000, 0.1227000, 0.3188500, 0.1979000], [0.2489034, 0.7269000, 0.4184500, -0.1569500, -0.0658500, 0.3164000]]]

Expected (Unparsed): [[[0,0.33,0.7123999999999999,0.2068,0.17355,0.43475],[0.50005,1.14325,1.12655,0.3364,0.0962,0.31605],[1.2123499999999998,0.40605,0.48234999999999995,0.15879999999999997,0.405,0.16469999999999996],[0.84115,1.7852000000000001,1.3954000000000002,0.12269999999999998,0.31885,0.19790000000000002],[0.24890336000000002,0.7269,0.41845,-0.15695,-0.06584999999999999,0.3164]]]

Actual:   [[[0, 0.33, 0.7124, 0.2068, 0.1736, 0.4348], [0.5001, 1.1433, 1.1266, 0.3364, 0.0962, 0.3161], [1.2124, 0.4061, 0.4824, 0.1588, 0.405, 0.1647], [0.8412, 1.7852, 1.3954, 0.1227, 0.3189, 0.1979], [0.249, 0.7269, 0.4185, -0.1569, -0.0658, 0.3164]]]

Expected: [[[0, 0.33, 0.7124, 0.2068, 0.1736, 0.4348], [0.5001, 1.1433, 1.1266, 0.3364, 0.0962, 0.3161], [1.2124, 0.4061, 0.4824, 0.1588, 0.405, 0.1647], [0.8412, 1.7853, 1.3955, 0.1227, 0.3189, 0.198], [0.249, 0.7269, 0.4185, -0.1569, -0.0658, 0.3164]]]