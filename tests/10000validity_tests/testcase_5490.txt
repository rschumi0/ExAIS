import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max5322 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Max5322 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con2979 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Ave93592 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Ave93592 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Max5322 = keras.layers.Maximum(name = 'Max5322', )([in0Max5322,in1Max5322])
Zer39313 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer39313', )(Max5322)
Con2979 = keras.layers.Concatenate(axis=4, name = 'Con2979', )([Zer39313,in0Con2979])
Ave93592 = keras.layers.Average(name = 'Ave93592', )([in0Ave93592,in1Ave93592])
Sub53509 = keras.layers.Subtract(name = 'Sub53509', )([Con2979,Ave93592])
Res30609 = keras.layers.Reshape((1, 2, 4), name = 'Res30609', )(Sub53509)
PRe10783 = keras.layers.PReLU(name = 'PRe10783', )(Res30609)
Glo11092 = keras.layers.GlobalAveragePooling2D(name = 'Glo11092', )(PRe10783)
model = tf.keras.models.Model(inputs=[in0Max5322,in1Max5322,in0Con2979,in0Ave93592,in1Ave93592], outputs=Glo11092)
w = model.get_layer('PRe10783').get_weights() 
w[0] = np.array([[[0.6367, 0.8138, 0.8153, 0.9513], [0.2995, 0.1243, 0.5564, 0.3133]]])
model.get_layer('PRe10783').set_weights(w) 
in0Max5322 = tf.constant([[[[[0.635]], [[0.4175]]]]])
in1Max5322 = tf.constant([[[[[0.8237]], [[0.9156]]]]])
in0Con2979 = tf.constant([[[[[0.4112], [0.6655]], [[0.2308], [0.4543]]]]])
in0Ave93592 = tf.constant([[[[[0.1551, 0.819], [0.7156, 0.0312]], [[0.0234, 0.4216], [0.9955, 0.1652]]]]])
in1Ave93592 = tf.constant([[[[[0.1794, 0.0439], [0.5644, 0.3876]], [[0.6115, 0.7654], [0.6942, 0.2878]]]]])
print (np.array2string(model.predict([in0Max5322,in1Max5322,in0Con2979,in0Ave93592,in1Ave93592],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo11092.png')

LMax5322 = maximum_layer([[[[[[0.635]], [[0.4175]]]]], [[[[[0.8237]], [[0.9156]]]]]], Max5322), 
LZer39313 = zero_padding3D_layer(Max5322, 0, 0, 0, 0, 1, 0, Zer39313), 
LCon2979 = concatenate_layer([Zer39313,[[[[[0.4112], [0.6655]], [[0.2308], [0.4543]]]]]], 4, Con2979), 
LAve93592 = average_layer([[[[[[0.1551, 0.819], [0.7156, 0.0312]], [[0.0234, 0.4216], [0.9955, 0.1652]]]]], [[[[[0.1794, 0.0439], [0.5644, 0.3876]], [[0.6115, 0.7654], [0.6942, 0.2878]]]]]], Ave93592), 
LSub53509 = subtract_layer(Con2979,Ave93592, Sub53509), 
LRes30609 = reshape_layer(Sub53509, [1, 2, 4], Res30609), 
LPRe10783 = prelu_layer(Res30609, [[[0.6367, 0.8138, 0.8153, 0.9513], [0.2995, 0.1243, 0.5564, 0.3133]]], PRe10783), 
LGlo11092 = global_average_pooling2D_layer(PRe10783, Glo11092), 
exec_layers([LMax5322,LZer39313,LCon2979,LAve93592,LSub53509,LRes30609,LPRe10783,LGlo11092],["Max5322","Zer39313","Con2979","Ave93592","Sub53509","Res30609","PRe10783","Glo11092"],Glo11092,"Glo11092")

Actual (Unparsed): [[-0.1007822, -0.0307815, 0.1272250, 0.3419500]]

Expected (Unparsed): [[-0.100782175,-0.03078152999999999,0.12722499999999992,0.34195]]

Actual:   [[-0.1007, -0.0307, 0.1273, 0.342]]

Expected: [[-0.1007, -0.0307, 0.1273, 0.342]]