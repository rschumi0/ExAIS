import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub40560 = tf.keras.layers.Input(shape=([2]))
in1Sub40560 = tf.keras.layers.Input(shape=([2]))

Sub40560 = keras.layers.Subtract(name = 'Sub40560', )([in0Sub40560,in1Sub40560])
Res73408 = keras.layers.Reshape((2, 1), name = 'Res73408', )(Sub40560)
Res26078 = keras.layers.Reshape((2, 1, 1), name = 'Res26078', )(Res73408)
Res98894 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res98894', )(Res26078)
Con28121 = keras.layers.Conv3D(2, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con28121', )(Res98894)
model = tf.keras.models.Model(inputs=[in0Sub40560,in1Sub40560], outputs=Con28121)
w = model.get_layer('Con28121').get_weights() 
w[0] = np.array([[[[[0.744, 0.0998]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con28121').set_weights(w) 
in0Sub40560 = tf.constant([[0.567, 0.6125]])
in1Sub40560 = tf.constant([[0.1039, 0.3186]])
print (np.array2string(model.predict([in0Sub40560,in1Sub40560],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con28121.png')

LSub40560 = subtract_layer([[0.567, 0.6125]], [[0.1039, 0.3186]], Sub40560), 
LRes73408 = reshape_layer(Sub40560, [2, 1], Res73408), 
LRes26078 = reshape_layer(Res73408, [2, 1, 1], Res26078), 
LRes98894 = reshape_layer(Res26078, [2, 1, 1, 1], Res98894), 
LCon28121 = conv3D_layer(Res98894, 1, 1, 1,[[[[[0.744, 0.0998]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con28121), 
exec_layers([LSub40560,LRes73408,LRes26078,LRes98894,LCon28121],["Sub40560","Res73408","Res26078","Res98894","Con28121"],Con28121,"Con28121")

Actual (Unparsed): [[[[[0.3445464, 0.0462174]]], [[[0.2186616, 0.0293312]]]]]

Expected (Unparsed): [[[[[0.3445464,0.046217379999999995]]],[[[0.21866160000000004,0.029331220000000005]]]]]

Actual:   [[[[[0.3446, 0.0463]]], [[[0.2187, 0.0294]]]]]

Expected: [[[[[0.3446, 0.0463]]], [[[0.2187, 0.0294]]]]]