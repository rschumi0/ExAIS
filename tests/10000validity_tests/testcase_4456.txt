import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo98525 = tf.keras.layers.Input(shape=([1, 1, 2]))

Glo98525 = keras.layers.GlobalMaxPool2D(name = 'Glo98525', )(in0Glo98525)
Res43210 = keras.layers.Reshape((2, 1), name = 'Res43210', )(Glo98525)
Glo80568 = keras.layers.GlobalMaxPool1D(name = 'Glo80568', )(Res43210)
Res23258 = keras.layers.Reshape((1, 1), name = 'Res23258', )(Glo80568)
Per44954 = keras.layers.Permute((2,1), name = 'Per44954',)(Res23258)
Sep36510 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep36510', )(Per44954)
model = tf.keras.models.Model(inputs=[in0Glo98525], outputs=Sep36510)
w = model.get_layer('Sep36510').get_weights() 
w[0] = np.array([[[0.3267]]])
w[1] = np.array([[[0.8378, 0.7786]]])
w[2] = np.array([0, 0])
model.get_layer('Sep36510').set_weights(w) 
in0Glo98525 = tf.constant([[[[1.5123, 1.9884]]]])
print (np.array2string(model.predict([in0Glo98525],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep36510.png')

LGlo98525 = global_max_pool2D_layer([[[[1.5123, 1.9884]]]], Glo98525), 
LRes43210 = reshape_layer(Glo98525, [2, 1], Res43210), 
LGlo80568 = global_max_pool1D_layer(Res43210, Glo80568), 
LRes23258 = reshape_layer(Glo80568, [1, 1], Res23258), 
LPer44954 = permute_layer(Res23258, 2,1, Per44954), 
LSep36510 = separable_conv1D_layer(Per44954, 1,[[[[0.3267]]],[[[0.8378, 0.7786]]]],[0, 0], 1, true, Sep36510), 
exec_layers([LGlo98525,LRes43210,LGlo80568,LRes23258,LPer44954,LSep36510],["Glo98525","Res43210","Glo80568","Res23258","Per44954","Sep36510"],Sep36510,"Sep36510")

Actual (Unparsed): [[[0.5442435, 0.5057866]]]

Expected (Unparsed): [[[0.544243492584,0.5057865640079999]]]

Actual:   [[[0.5443, 0.5058]]]

Expected: [[[0.5443, 0.5058]]]