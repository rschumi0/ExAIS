import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max90820 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max90820 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot76805 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot76805 = tf.keras.layers.Input(shape=([3, 2]))
in0Con21347 = tf.keras.layers.Input(shape=([3, 3]))

Max90820 = keras.layers.Maximum(name = 'Max90820', )([in0Max90820,in1Max90820])
Con77641 = keras.layers.Conv2D(3, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con77641', )(Max90820)
Res57341 = keras.layers.Reshape((2, 6), name = 'Res57341', )(Con77641)
Zer2191 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer2191', )(Res57341)
Dot76805 = keras.layers.Dot(axes=(2, 2), name = 'Dot76805', )([in0Dot76805,in1Dot76805])
Con21347 = keras.layers.Concatenate(axis=2, name = 'Con21347', )([Dot76805,in0Con21347])
Max70418 = keras.layers.Maximum(name = 'Max70418', )([Zer2191,Con21347])
Glo71816 = keras.layers.GlobalMaxPool1D(name = 'Glo71816', )(Max70418)
model = tf.keras.models.Model(inputs=[in0Max90820,in1Max90820,in0Dot76805,in1Dot76805,in0Con21347], outputs=Glo71816)
w = model.get_layer('Con77641').get_weights() 
w[0] = np.array([[[[0.2458, 0.4146, 0.2146], [0.6348, 0.508, 0.879]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con77641').set_weights(w) 
in0Max90820 = tf.constant([[[[0.7284, 0.0744], [0.2627, 0.0611]], [[0.226, 0.8465], [0.9317, 0.7864]]]])
in1Max90820 = tf.constant([[[[0.9677, 0.103], [0.5507, 0.7562]], [[0.4591, 0.2388], [0.5144, 0.743]]]])
in0Dot76805 = tf.constant([[[0.3612, 0.3844], [0.7243, 0.5462], [0.0742, 0.8903]]])
in1Dot76805 = tf.constant([[[0.0307, 0.4191], [0.0961, 0.8915], [0.7767, 0.4421]]])
in0Con21347 = tf.constant([[[0.673, 0.0449, 0.9809], [0.0776, 0.5785, 0.5344], [0.0645, 0.0253, 0.0958]]])
print (np.array2string(model.predict([in0Max90820,in1Max90820,in0Dot76805,in1Dot76805,in0Con21347],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo71816.png')

LMax90820 = maximum_layer([[[[[0.7284, 0.0744], [0.2627, 0.0611]], [[0.226, 0.8465], [0.9317, 0.7864]]]], [[[[0.9677, 0.103], [0.5507, 0.7562]], [[0.4591, 0.2388], [0.5144, 0.743]]]]], Max90820), 
LCon77641 = conv2D_layer(Max90820, 1, 1,[[[[0.2458, 0.4146, 0.2146], [0.6348, 0.508, 0.879]]]],[0, 0, 0], 1, 1, false, 1, 1, Con77641), 
LRes57341 = reshape_layer(Con77641, [2, 6], Res57341), 
LZer2191 = zero_padding1D_layer(Res57341, 1, 0, Zer2191), 
LDot76805 = dot_layer([[[0.3612, 0.3844], [0.7243, 0.5462], [0.0742, 0.8903]]], [[[0.0307, 0.4191], [0.0961, 0.8915], [0.7767, 0.4421]]], 2, 2, Dot76805), 
LCon21347 = concatenate_layer([Dot76805,[[[0.673, 0.0449, 0.9809], [0.0776, 0.5785, 0.5344], [0.0645, 0.0253, 0.0958]]]], 2, Con21347), 
LMax70418 = maximum_layer([Zer2191,Con21347], Max70418), 
LGlo71816 = global_max_pool1D_layer(Max70418, Glo71816), 
exec_layers([LMax90820,LCon77641,LRes57341,LZer2191,LDot76805,LCon21347,LMax70418,LGlo71816],["Max90820","Con77641","Res57341","Zer2191","Dot76805","Con21347","Max70418","Glo71816"],Glo71816,"Glo71816")

Actual (Unparsed): [[0.6502050, 0.8008330, 0.8425963, 0.7282186, 0.7857740, 0.9809000]]

Expected (Unparsed): [[0.65020498,0.8008330699999999,0.84259636,0.72821858,0.7857740200000001,0.9809]]

Actual:   [[0.6503, 0.8009, 0.8426, 0.7283, 0.7858, 0.9809]]

Expected: [[0.6503, 0.8009, 0.8426, 0.7283, 0.7858, 0.9809]]