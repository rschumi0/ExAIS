import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot80309 = tf.keras.layers.Input(shape=([2]))
in1Dot80309 = tf.keras.layers.Input(shape=([2]))
in0Con57480 = tf.keras.layers.Input(shape=([3, 2]))
in0Max2178 = tf.keras.layers.Input(shape=([2, 2]))
in1Max2178 = tf.keras.layers.Input(shape=([2, 2]))
in0Con98336 = tf.keras.layers.Input(shape=([3, 1]))
in0Dot99920 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot99920 = tf.keras.layers.Input(shape=([3, 3]))
in0Min18490 = tf.keras.layers.Input(shape=([1, 1]))
in1Min18490 = tf.keras.layers.Input(shape=([1, 1]))
in0Con48809 = tf.keras.layers.Input(shape=([3, 2]))

Dot80309 = keras.layers.Dot(axes=(1, 1), name = 'Dot80309', )([in0Dot80309,in1Dot80309])
Res75346 = keras.layers.Reshape((1, 1), name = 'Res75346', )(Dot80309)
Zer84735 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer84735', )(Res75346)
Con57480 = keras.layers.Concatenate(axis=2, name = 'Con57480', )([Zer84735,in0Con57480])
Max2178 = keras.layers.Maximum(name = 'Max2178', )([in0Max2178,in1Max2178])
Zer68132 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer68132', )(Max2178)
Con98336 = keras.layers.Concatenate(axis=2, name = 'Con98336', )([Zer68132,in0Con98336])
Dot99920 = keras.layers.Dot(axes=(2, 2), name = 'Dot99920', )([in0Dot99920,in1Dot99920])
Min18490 = keras.layers.Minimum(name = 'Min18490', )([in0Min18490,in1Min18490])
Zer17849 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer17849', )(Min18490)
Con48809 = keras.layers.Concatenate(axis=2, name = 'Con48809', )([Zer17849,in0Con48809])
Max79103 = keras.layers.Maximum(name = 'Max79103', )([Dot99920,Con48809])
Min29371 = keras.layers.Minimum(name = 'Min29371', )([Con98336,Max79103])
Ave64249 = keras.layers.Average(name = 'Ave64249', )([Con57480,Min29371])
model = tf.keras.models.Model(inputs=[in0Dot80309,in1Dot80309,in0Con57480,in0Max2178,in1Max2178,in0Con98336,in0Dot99920,in1Dot99920,in0Min18490,in1Min18490,in0Con48809], outputs=Ave64249)
in0Dot80309 = tf.constant([[0.328, 0.7803]])
in1Dot80309 = tf.constant([[0.5001, 0.6446]])
in0Con57480 = tf.constant([[[0.9, 0.084], [0.8226, 0.6086], [0.4982, 0.4965]]])
in0Max2178 = tf.constant([[[0.7072, 0.5817], [0.1709, 0.0224]]])
in1Max2178 = tf.constant([[[0.2279, 0.7505], [0.9904, 0.4047]]])
in0Con98336 = tf.constant([[[0.9595], [0.5153], [0.4722]]])
in0Dot99920 = tf.constant([[[0.8699, 0.1396, 0.0896], [0.3834, 0.753, 0.7854], [0.4853, 0.3184, 0.3541]]])
in1Dot99920 = tf.constant([[[0.5089, 0.6574, 0.2005], [0.1506, 0.4525, 0.4688], [0.8112, 0.4479, 0.5308]]])
in0Min18490 = tf.constant([[[0.0254]]])
in1Min18490 = tf.constant([[[0.4366]]])
in0Con48809 = tf.constant([[[0.2271, 0.2034], [0.2694, 0.7426], [0.4204, 0.142]]])
print (np.array2string(model.predict([in0Dot80309,in1Dot80309,in0Con57480,in0Max2178,in1Max2178,in0Con98336,in0Dot99920,in1Dot99920,in0Min18490,in1Min18490,in0Con48809],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave64249.png')

LDot80309 = dot_layer([[0.328, 0.7803]], [[0.5001, 0.6446]], 1, 1, Dot80309), 
LRes75346 = reshape_layer(Dot80309, [1, 1], Res75346), 
LZer84735 = zero_padding1D_layer(Res75346, 2, 0, Zer84735), 
LCon57480 = concatenate_layer([Zer84735,[[[0.9, 0.084], [0.8226, 0.6086], [0.4982, 0.4965]]]], 2, Con57480), 
LMax2178 = maximum_layer([[[[0.7072, 0.5817], [0.1709, 0.0224]]], [[[0.2279, 0.7505], [0.9904, 0.4047]]]], Max2178), 
LZer68132 = zero_padding1D_layer(Max2178, 1, 0, Zer68132), 
LCon98336 = concatenate_layer([Zer68132,[[[0.9595], [0.5153], [0.4722]]]], 2, Con98336), 
LDot99920 = dot_layer([[[0.8699, 0.1396, 0.0896], [0.3834, 0.753, 0.7854], [0.4853, 0.3184, 0.3541]]], [[[0.5089, 0.6574, 0.2005], [0.1506, 0.4525, 0.4688], [0.8112, 0.4479, 0.5308]]], 2, 2, Dot99920), 
LMin18490 = minimum_layer([[[[0.0254]]], [[[0.4366]]]], Min18490), 
LZer17849 = zero_padding1D_layer(Min18490, 2, 0, Zer17849), 
LCon48809 = concatenate_layer([Zer17849,[[[0.2271, 0.2034], [0.2694, 0.7426], [0.4204, 0.142]]]], 2, Con48809), 
LMax79103 = maximum_layer([Dot99920,Con48809], Max79103), 
LMin29371 = minimum_layer([Con98336,Max79103], Min29371), 
LAve64249 = average_layer([Con57480,Min29371], Ave64249), 
exec_layers([LDot80309,LRes75346,LZer84735,LCon57480,LMax2178,LZer68132,LCon98336,LDot99920,LMin18490,LZer17849,LCon48809,LMax79103,LMin29371,LAve64249],["Dot80309","Res75346","Zer84735","Con57480","Max2178","Zer68132","Con98336","Dot99920","Min18490","Zer17849","Con48809","Max79103","Min29371","Ave64249"],Ave64249,"Ave64249")

Actual (Unparsed): [[[0.0000000, 0.4500000, 0.4498747], [0.3536000, 0.7865500, 0.5619500], [0.5971483, 0.4514500, 0.4843500]]]

Expected (Unparsed): [[[0,0.45,0.44987469999999996],[0.3536,0.78655,0.56195],[0.59714828,0.45145,0.48435]]]

Actual:   [[[0, 0.45, 0.4499], [0.3536, 0.7866, 0.562], [0.5972, 0.4515, 0.4844]]]

Expected: [[[0, 0.45, 0.4499], [0.3536, 0.7866, 0.562], [0.5972, 0.4515, 0.4844]]]