import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add18776 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Add18776 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Add18776 = keras.layers.Add(name = 'Add18776', )([in0Add18776,in1Add18776])
Res38355 = keras.layers.Reshape((1, 1, 2), name = 'Res38355', )(Add18776)
Res31748 = keras.layers.Reshape((1, 2), name = 'Res31748', )(Res38355)
LST80843 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST80843', )(Res31748)
Res23443 = keras.layers.Reshape((1, 1), name = 'Res23443', )(LST80843)
Res98541 = keras.layers.Reshape((1, 1, 1), name = 'Res98541', )(Res23443)
Max62174 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Max62174', )(Res98541)
model = tf.keras.models.Model(inputs=[in0Add18776,in1Add18776], outputs=Max62174)
w = model.get_layer('LST80843').get_weights() 
w[0] = np.array([[7, 8, 3, 3], [3, 8, 6, 3]])
w[1] = np.array([[6, 9, 2, 3]])
w[2] = np.array([10, 2, 6, 10])
model.get_layer('LST80843').set_weights(w) 
in0Add18776 = tf.constant([[[[[0.3341, 0.1409]]]]])
in1Add18776 = tf.constant([[[[[0.4809, 0.1788]]]]])
print (np.array2string(model.predict([in0Add18776,in1Add18776],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max62174.png')

LAdd18776 = add_layer([[[[[[0.3341, 0.1409]]]]], [[[[[0.4809, 0.1788]]]]]], Add18776), 
LRes38355 = reshape_layer(Add18776, [1, 1, 2], Res38355), 
LRes31748 = reshape_layer(Res38355, [1, 2], Res31748), 
LLST80843 = lstm_layer(Res31748,[[7, 8, 3, 3], [3, 8, 6, 3]],[[6, 9, 2, 3]],[10, 2, 6, 10], LST80843), 
LRes23443 = reshape_layer(LST80843, [1, 1], Res23443), 
LRes98541 = reshape_layer(Res23443, [1, 1, 1], Res98541), 
LMax62174 = max_pool2D_layer(Res98541, 1, 1, 1, 1, true, Max62174), 
exec_layers([LAdd18776,LRes38355,LRes31748,LLST80843,LRes23443,LRes98541,LMax62174],["Add18776","Res38355","Res31748","LST80843","Res23443","Res98541","Max62174"],Max62174,"Max62174")

Actual (Unparsed): [[[[0.7615930]]]]

Expected (Unparsed): [[[[0.7615929815893007]]]]

Actual:   [[[[0.7616]]]]

Expected: [[[[0.7616]]]]