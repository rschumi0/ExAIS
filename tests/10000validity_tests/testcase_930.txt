import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul96797 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul96797 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Sub6335 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub6335 = tf.keras.layers.Input(shape=([2, 2]))
in0Sub54539 = tf.keras.layers.Input(shape=([3]))
in1Sub54539 = tf.keras.layers.Input(shape=([3]))
in0Con28102 = tf.keras.layers.Input(shape=([1]))
in0Up_92921 = tf.keras.layers.Input(shape=([2, 3]))
in0Sof90608 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Con30369 = tf.keras.layers.Input(shape=([3, 2]))

Mul96797 = keras.layers.Multiply(name = 'Mul96797', )([in0Mul96797,in1Mul96797])
Res44763 = keras.layers.Reshape((1, 4), name = 'Res44763', )(Mul96797)
Sub6335 = keras.layers.Subtract(name = 'Sub6335', )([in0Sub6335,in1Sub6335])
Fla39348 = keras.layers.Flatten(name = 'Fla39348', )(Sub6335)
Sub54539 = keras.layers.Subtract(name = 'Sub54539', )([in0Sub54539,in1Sub54539])
Con28102 = keras.layers.Concatenate(axis=1, name = 'Con28102', )([Sub54539,in0Con28102])
Max810 = keras.layers.Maximum(name = 'Max810', )([Fla39348,Con28102])
Res67077 = keras.layers.Reshape((1, 4), name = 'Res67077', )(Max810)
Ave22987 = keras.layers.Average(name = 'Ave22987', )([Res44763,Res67077])
Zer31809 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer31809', )(Ave22987)
Up_92921 = keras.layers.UpSampling1D(size=(1), name = 'Up_92921', )(in0Up_92921)
Sof90608 = keras.layers.Softmax(axis=1, name = 'Sof90608', input_shape=(2, 1, 2, 1))(in0Sof90608)
Res28091 = keras.layers.Reshape((2, 1, 2), name = 'Res28091', )(Sof90608)
Res5123 = keras.layers.Reshape((2, 2), name = 'Res5123', )(Res28091)
Dot50163 = keras.layers.Dot(axes=(1, 1), name = 'Dot50163', )([Up_92921,Res5123])
Con30369 = keras.layers.Concatenate(axis=2, name = 'Con30369', )([Dot50163,in0Con30369])
Add54497 = keras.layers.Add(name = 'Add54497', )([Zer31809,Con30369])
model = tf.keras.models.Model(inputs=[in0Mul96797,in1Mul96797,in0Sub6335,in1Sub6335,in0Sub54539,in1Sub54539,in0Con28102,in0Up_92921,in0Sof90608,in0Con30369], outputs=Add54497)
in0Mul96797 = tf.constant([[[[0.821, 0.5054], [0.4126, 0.6774]]]])
in1Mul96797 = tf.constant([[[[0.2286, 0.53], [0.9059, 0.6417]]]])
in0Sub6335 = tf.constant([[[0.223, 0.7981], [0.7957, 0.9705]]])
in1Sub6335 = tf.constant([[[0.9571, 0.815], [0.0752, 0.4181]]])
in0Sub54539 = tf.constant([[0.55, 0.5765, 0.8407]])
in1Sub54539 = tf.constant([[0.1231, 0.1534, 0.8608]])
in0Con28102 = tf.constant([[0.1758]])
in0Up_92921 = tf.constant([[[1.7147, 1.0885, 1.6954], [1.7157, 1.9544, 1.6239]]])
in0Sof90608 = tf.constant([[[[[0.4643], [0.4982]]], [[[0.953], [0.4171]]]]])
in0Con30369 = tf.constant([[[0.6107, 0.2451], [0.0563, 0.9393], [0.7274, 0.658]]])
print (np.array2string(model.predict([in0Mul96797,in1Mul96797,in0Sub6335,in1Sub6335,in0Sub54539,in1Sub54539,in0Con28102,in0Up_92921,in0Sof90608,in0Con30369],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add54497.png')

LMul96797 = multiply_layer([[[[[0.821, 0.5054], [0.4126, 0.6774]]]], [[[[0.2286, 0.53], [0.9059, 0.6417]]]]], Mul96797), 
LRes44763 = reshape_layer(Mul96797, [1, 4], Res44763), 
LSub6335 = subtract_layer([[[0.223, 0.7981], [0.7957, 0.9705]]], [[[0.9571, 0.815], [0.0752, 0.4181]]], Sub6335), 
LFla39348 = flatten_layer(Sub6335, Fla39348), 
LSub54539 = subtract_layer([[0.55, 0.5765, 0.8407]], [[0.1231, 0.1534, 0.8608]], Sub54539), 
LCon28102 = concatenate_layer([Sub54539,[[0.1758]]], 1, Con28102), 
LMax810 = maximum_layer([Fla39348,Con28102], Max810), 
LRes67077 = reshape_layer(Max810, [1, 4], Res67077), 
LAve22987 = average_layer([Res44763,Res67077], Ave22987), 
LZer31809 = zero_padding1D_layer(Ave22987, 2, 0, Zer31809), 
LUp_92921 = up_sampling1D_layer([[[1.7147, 1.0885, 1.6954], [1.7157, 1.9544, 1.6239]]], 1, Up_92921), 
LSof90608 = softmax_layer([[[[[0.4643], [0.4982]]], [[[0.953], [0.4171]]]]], 1, Sof90608), 
LRes28091 = reshape_layer(Sof90608, [2, 1, 2], Res28091), 
LRes5123 = reshape_layer(Res28091, [2, 2], Res5123), 
LDot50163 = dot_layer(Up_92921,Res5123, 1, 1, Dot50163), 
LCon30369 = concatenate_layer([Dot50163,[[[0.6107, 0.2451], [0.0563, 0.9393], [0.7274, 0.658]]]], 2, Con30369), 
LAdd54497 = add_layer([Zer31809,Con30369], Add54497), 
exec_layers([LMul96797,LRes44763,LSub6335,LFla39348,LSub54539,LCon28102,LMax810,LRes67077,LAve22987,LZer31809,LUp_92921,LSof90608,LRes28091,LRes5123,LDot50163,LCon30369,LAdd54497],["Mul96797","Res44763","Sub6335","Fla39348","Sub54539","Con28102","Max810","Res67077","Ave22987","Zer31809","Up_92921","Sof90608","Res28091","Res5123","Dot50163","Con30369","Add54497"],Add54497,"Add54497")

Actual (Unparsed): [[[1.7153198, 1.7151797, 0.6107000, 0.2451000], [1.6251849, 1.5039035, 0.0563000, 0.9393000], [1.9583746, 2.0065799, 1.2745372, 1.1515438]]]

Expected (Unparsed): [[[1.7153198001377832,1.7151797361054402,0.6107,0.2451],[1.625184939306744,1.5039034937006448,0.0563,0.9393],[1.9583745901484786,2.006579868461028,1.2745371699999999,1.15154379]]]

Actual:   [[[1.7154, 1.7152, 0.6107, 0.2451], [1.6252, 1.504, 0.0563, 0.9393], [1.9584, 2.0066, 1.2746, 1.1516]]]

Expected: [[[1.7154, 1.7152, 0.6107, 0.2451], [1.6252, 1.504, 0.0563, 0.9393], [1.9584, 2.0066, 1.2746, 1.1516]]]