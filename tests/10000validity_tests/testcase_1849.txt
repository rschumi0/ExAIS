import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max26102 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Max26102 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Max26102 = keras.layers.Maximum(name = 'Max26102', )([in0Max26102,in1Max26102])
Res76874 = keras.layers.Reshape((2, 2, 1), name = 'Res76874', )(Max26102)
Res9413 = keras.layers.Reshape((2, 2), name = 'Res9413', )(Res76874)
Con36868 = keras.layers.Conv1D(3, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con36868', )(Res9413)
Res47214 = keras.layers.Reshape((2, 3, 1), name = 'Res47214', )(Con36868)
Up_42282 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_42282', )(Res47214)
Res59359 = keras.layers.Reshape((4, 3), name = 'Res59359', )(Up_42282)
ReL81889 = keras.layers.ReLU(max_value=2.5412223049106406, negative_slope=7.687090688766568, threshold=0.1076427238701827, name = 'ReL81889', )(Res59359)
model = tf.keras.models.Model(inputs=[in0Max26102,in1Max26102], outputs=ReL81889)
w = model.get_layer('Con36868').get_weights() 
w[0] = np.array([[[0.0875, 0.2034, 0.328], [0.0404, 0.1676, 0.4263]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con36868').set_weights(w) 
in0Max26102 = tf.constant([[[[[0.3626]], [[0.2224]]], [[[0.5311]], [[0.7958]]]]])
in1Max26102 = tf.constant([[[[[0.783]], [[0.4669]]], [[[0.234]], [[0.2732]]]]])
print (np.array2string(model.predict([in0Max26102,in1Max26102],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL81889.png')

LMax26102 = maximum_layer([[[[[[0.3626]], [[0.2224]]], [[[0.5311]], [[0.7958]]]]], [[[[[0.783]], [[0.4669]]], [[[0.234]], [[0.2732]]]]]], Max26102), 
LRes76874 = reshape_layer(Max26102, [2, 2, 1], Res76874), 
LRes9413 = reshape_layer(Res76874, [2, 2], Res9413), 
LCon36868 = conv1D_layer(Res9413, 1,[[[0.0875, 0.2034, 0.328], [0.0404, 0.1676, 0.4263]]],[0, 0, 0], 1, false, 1, Con36868), 
LRes47214 = reshape_layer(Con36868, [2, 3, 1], Res47214), 
LUp_42282 = up_sampling2D_layer(Res47214, 2, 1, Up_42282), 
LRes59359 = reshape_layer(Up_42282, [4, 3], Res59359), 
LReL81889 = relu_layer(Res59359, 2.5412223049106406, 7.687090688766568, 0.1076427238701827, ReL81889), 
exec_layers([LMax26102,LRes76874,LRes9413,LCon36868,LRes47214,LUp_42282,LRes59359,LReL81889],["Max26102","Res76874","Res9413","Con36868","Res47214","Up_42282","Res59359","ReL81889"],ReL81889,"ReL81889")

Actual (Unparsed): [[[-0.1557978, 0.2375146, 0.4558635], [-0.1557978, 0.2375146, 0.4558635], [-0.2230883, 0.2414018, 0.5134503], [-0.2230883, 0.2414018, 0.5134503]]]

Expected (Unparsed): [[[-0.15579783280139425,0.23751464,0.45586347],[-0.15579783280139425,0.23751464,0.45586347],[-0.22308824169274333,0.24140182,0.51345034],[-0.22308824169274333,0.24140182,0.51345034]]]

Actual:   [[[-0.1557, 0.2376, 0.4559], [-0.1557, 0.2376, 0.4559], [-0.223, 0.2415, 0.5135], [-0.223, 0.2415, 0.5135]]]

Expected: [[[-0.1557, 0.2376, 0.4559], [-0.1557, 0.2376, 0.4559], [-0.223, 0.2415, 0.5135], [-0.223, 0.2415, 0.5135]]]