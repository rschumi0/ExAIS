import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con82937 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Add81947 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Add81947 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con43257 = tf.keras.layers.Input(shape=([2, 3, 2, 3]))

Con82937 = keras.layers.Conv3D(4, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con82937', )(in0Con82937)
Zer71082 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer71082', )(Con82937)
Add81947 = keras.layers.Add(name = 'Add81947', )([in0Add81947,in1Add81947])
Zer42413 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer42413', )(Add81947)
Con43257 = keras.layers.Concatenate(axis=4, name = 'Con43257', )([Zer42413,in0Con43257])
Max19312 = keras.layers.Maximum(name = 'Max19312', )([Zer71082,Con43257])
Res37429 = keras.layers.Reshape((2, 3, 8), name = 'Res37429', )(Max19312)
Res88050 = keras.layers.Reshape((2, 24), name = 'Res88050', )(Res37429)
Glo21622 = keras.layers.GlobalMaxPool1D(name = 'Glo21622', )(Res88050)
Res91433 = keras.layers.Reshape((24, 1), name = 'Res91433', )(Glo21622)
Res73486 = keras.layers.Reshape((24, 1, 1), name = 'Res73486', )(Res91433)
Cro47809 = keras.layers.Cropping2D(cropping=((3, 8), (0, 0)), name = 'Cro47809', )(Res73486)
model = tf.keras.models.Model(inputs=[in0Con82937,in0Add81947,in1Add81947,in0Con43257], outputs=Cro47809)
w = model.get_layer('Con82937').get_weights() 
w[0] = np.array([[[[[0.789, 0.8825, 0.8877, 0.5562]]]], [[[[0.3106, 0.5456, 0.4728, 0.7238]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con82937').set_weights(w) 
in0Con82937 = tf.constant([[[[[0.5757], [0.7378]]], [[[0.5241], [0.7024]]]]])
in0Add81947 = tf.constant([[[[[0.0683]], [[0.0323]]]]])
in1Add81947 = tf.constant([[[[[0.078]], [[0.0786]]]]])
in0Con43257 = tf.constant([[[[[0.9015, 0.1054, 0.3481], [0.6378, 0.9208, 0.2447]], [[0.0975, 0.1582, 0.8335], [0.9137, 0.3704, 0.5226]], [[0.4802, 0.1495, 0.2373], [0.4507, 0.8403, 0.5245]]], [[[0.6265, 0.73, 0.4971], [0.7192, 0.5665, 0.1005]], [[0.1489, 0.6389, 0.6607], [0.6713, 0.7488, 0.0404]], [[0.8123, 0.8672, 0.0754], [0.6163, 0.7671, 0.3404]]]]])
print (np.array2string(model.predict([in0Con82937,in0Add81947,in1Add81947,in0Con43257],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro47809.png')

LCon82937 = conv3D_layer([[[[[0.5757], [0.7378]]], [[[0.5241], [0.7024]]]]], 2, 1, 1,[[[[[0.789, 0.8825, 0.8877, 0.5562]]]], [[[[0.3106, 0.5456, 0.4728, 0.7238]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con82937), 
LZer71082 = zero_padding3D_layer(Con82937, 0, 0, 2, 0, 0, 0, Zer71082), 
LAdd81947 = add_layer([[[[[[0.0683]], [[0.0323]]]]], [[[[[0.078]], [[0.0786]]]]]], Add81947), 
LZer42413 = zero_padding3D_layer(Add81947, 1, 0, 1, 0, 1, 0, Zer42413), 
LCon43257 = concatenate_layer([Zer42413,[[[[[0.9015, 0.1054, 0.3481], [0.6378, 0.9208, 0.2447]], [[0.0975, 0.1582, 0.8335], [0.9137, 0.3704, 0.5226]], [[0.4802, 0.1495, 0.2373], [0.4507, 0.8403, 0.5245]]], [[[0.6265, 0.73, 0.4971], [0.7192, 0.5665, 0.1005]], [[0.1489, 0.6389, 0.6607], [0.6713, 0.7488, 0.0404]], [[0.8123, 0.8672, 0.0754], [0.6163, 0.7671, 0.3404]]]]]], 4, Con43257), 
LMax19312 = maximum_layer([Zer71082,Con43257], Max19312), 
LRes37429 = reshape_layer(Max19312, [2, 3, 8], Res37429), 
LRes88050 = reshape_layer(Res37429, [2, 24], Res88050), 
LGlo21622 = global_max_pool1D_layer(Res88050, Glo21622), 
LRes91433 = reshape_layer(Glo21622, [24, 1], Res91433), 
LRes73486 = reshape_layer(Res91433, [24, 1, 1], Res73486), 
LCro47809 = cropping2D_layer(Res73486, 3, 8, 0, 0, Cro47809), 
exec_layers([LCon82937,LZer71082,LAdd81947,LZer42413,LCon43257,LMax19312,LRes37429,LRes88050,LGlo21622,LRes91433,LRes73486,LCro47809],["Con82937","Zer71082","Add81947","Zer42413","Con43257","Max19312","Res37429","Res88050","Glo21622","Res91433","Res73486","Cro47809"],Cro47809,"Cro47809")

Actual (Unparsed): [[[[0.4971000]], [[0.0000000]], [[0.7192000]], [[0.9208000]], [[0.2447000]], [[0.0000000]], [[0.1489000]], [[0.6389000]], [[0.8335000]], [[0.1463000]], [[0.9137000]], [[0.7488000]], [[0.5226000]]]]

Expected (Unparsed): [[[[0.4971]],[[0]],[[0.7192]],[[0.9208]],[[0.2447]],[[0]],[[0.1489]],[[0.6389]],[[0.8335]],[[0.14629999999999999]],[[0.9137]],[[0.7488]],[[0.5226]]]]

Actual:   [[[[0.4971]], [[0]], [[0.7192]], [[0.9208]], [[0.2447]], [[0]], [[0.1489]], [[0.6389]], [[0.8335]], [[0.1463]], [[0.9137]], [[0.7488]], [[0.5226]]]]

Expected: [[[[0.4971]], [[0]], [[0.7192]], [[0.9208]], [[0.2447]], [[0]], [[0.1489]], [[0.6389]], [[0.8335]], [[0.1463]], [[0.9137]], [[0.7488]], [[0.5226]]]]