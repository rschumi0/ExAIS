import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub45957 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub45957 = tf.keras.layers.Input(shape=([2, 2]))
in0Con60613 = tf.keras.layers.Input(shape=([2, 2]))
in0Sep65051 = tf.keras.layers.Input(shape=([2, 2]))

Sub45957 = keras.layers.Subtract(name = 'Sub45957', )([in0Sub45957,in1Sub45957])
Con60613 = keras.layers.Concatenate(axis=2, name = 'Con60613', )([Sub45957,in0Con60613])
Sep65051 = keras.layers.SeparableConv1D(4, (1),strides=(2), padding='valid', name = 'Sep65051', )(in0Sep65051)
Zer95856 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer95856', )(Sep65051)
Min42236 = keras.layers.Minimum(name = 'Min42236', )([Con60613,Zer95856])
Res46574 = keras.layers.Reshape((2, 4, 1), name = 'Res46574', )(Min42236)
Res66493 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res66493', )(Res46574)
Glo85697 = keras.layers.GlobalAveragePooling3D(name = 'Glo85697', )(Res66493)
Res38904 = keras.layers.Reshape((1, 1), name = 'Res38904', )(Glo85697)
Glo56277 = keras.layers.GlobalAveragePooling1D(name = 'Glo56277', )(Res38904)
model = tf.keras.models.Model(inputs=[in0Sub45957,in1Sub45957,in0Con60613,in0Sep65051], outputs=Glo56277)
w = model.get_layer('Sep65051').get_weights() 
w[0] = np.array([[[0.7361], [0.6116]]])
w[1] = np.array([[[0.9239, 0.7859, 0.1071, 0.6145], [0.1442, 0.2836, 0.303, 0.6059]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep65051').set_weights(w) 
in0Sub45957 = tf.constant([[[0.7243, 0.019], [0.6599, 0.9035]]])
in1Sub45957 = tf.constant([[[0.5434, 0.1598], [0.1662, 0.0208]]])
in0Con60613 = tf.constant([[[0.9902, 0.435], [0.8735, 0.9779]]])
in0Sep65051 = tf.constant([[[0.6455, 0.3045], [0.0318, 0.4534]]])
print (np.array2string(model.predict([in0Sub45957,in1Sub45957,in0Con60613,in0Sep65051],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo56277.png')

LSub45957 = subtract_layer([[[0.7243, 0.019], [0.6599, 0.9035]]], [[[0.5434, 0.1598], [0.1662, 0.0208]]], Sub45957), 
LCon60613 = concatenate_layer([Sub45957,[[[0.9902, 0.435], [0.8735, 0.9779]]]], 2, Con60613), 
LSep65051 = separable_conv1D_layer([[[0.6455, 0.3045], [0.0318, 0.4534]]], 1,[[[[0.7361], [0.6116]]],[[[0.9239, 0.7859, 0.1071, 0.6145], [0.1442, 0.2836, 0.303, 0.6059]]]],[0, 0, 0, 0], 2, false, Sep65051), 
LZer95856 = zero_padding1D_layer(Sep65051, 1, 0, Zer95856), 
LMin42236 = minimum_layer([Con60613,Zer95856], Min42236), 
LRes46574 = reshape_layer(Min42236, [2, 4, 1], Res46574), 
LRes66493 = reshape_layer(Res46574, [2, 4, 1, 1], Res66493), 
LGlo85697 = global_average_pooling3D_layer(Res66493, Glo85697), 
LRes38904 = reshape_layer(Glo85697, [1, 1], Res38904), 
LGlo56277 = global_average_pooling1D_layer(Res38904, Glo56277), 
exec_layers([LSub45957,LCon60613,LSep65051,LZer95856,LMin42236,LRes46574,LRes66493,LGlo85697,LRes38904,LGlo56277],["Sub45957","Con60613","Sep65051","Zer95856","Min42236","Res46574","Res66493","Glo85697","Res38904","Glo56277"],Glo56277,"Glo56277")

Actual (Unparsed): [[0.1579278]]

Expected (Unparsed): [[0.15792781147624999]]

Actual:   [[0.158]]

Expected: [[0.158]]