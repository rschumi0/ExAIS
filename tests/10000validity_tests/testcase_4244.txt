import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave38009 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave38009 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Loc97617 = tf.keras.layers.Input(shape=([2, 2]))
in0Add63332 = tf.keras.layers.Input(shape=([2, 2]))
in1Add63332 = tf.keras.layers.Input(shape=([2, 2]))
in0Thr16055 = tf.keras.layers.Input(shape=([1, 1]))
in0Max75812 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max75812 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con34541 = tf.keras.layers.Input(shape=([2, 2, 2]))

Ave38009 = keras.layers.Average(name = 'Ave38009', )([in0Ave38009,in1Ave38009])
Loc67012 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc67012', )(Ave38009)
Zer47385 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer47385', )(Loc67012)
Loc97617 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc97617', )(in0Loc97617)
Add63332 = keras.layers.Add(name = 'Add63332', )([in0Add63332,in1Add63332])
Min39614 = keras.layers.Minimum(name = 'Min39614', )([Loc97617,Add63332])
Res74416 = keras.layers.Reshape((2, 2, 1), name = 'Res74416', )(Min39614)
Thr16055 = keras.layers.ThresholdedReLU(theta=9.069038571864354, name = 'Thr16055', input_shape=(1, 1))(in0Thr16055)
Res7611 = keras.layers.Reshape((1, 1, 1), name = 'Res7611', )(Thr16055)
Zer63588 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer63588', )(Res7611)
Max75812 = keras.layers.Maximum(name = 'Max75812', )([in0Max75812,in1Max75812])
Max184 = keras.layers.Maximum(name = 'Max184', )([Zer63588,Max75812])
Zer69911 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer69911', )(Max184)
Max20477 = keras.layers.Maximum(name = 'Max20477', )([Res74416,Zer69911])
Con34541 = keras.layers.Concatenate(axis=3, name = 'Con34541', )([Max20477,in0Con34541])
Add91904 = keras.layers.Add(name = 'Add91904', )([Zer47385,Con34541])
model = tf.keras.models.Model(inputs=[in0Ave38009,in1Ave38009,in0Loc97617,in0Add63332,in1Add63332,in0Thr16055,in0Max75812,in1Max75812,in0Con34541], outputs=Add91904)
w = model.get_layer('Loc67012').get_weights() 
w[0] = np.array([[[0.5075, 0.7066, 0.4609]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc67012').set_weights(w) 
w = model.get_layer('Loc97617').get_weights() 
w[0] = np.array([[[0.904, 0.2769], [0.4473, 0.6378]], [[0.737, 0.2167], [0.6998, 0.2499]]])
w[1] = np.array([[0, 0], [0, 0]])
model.get_layer('Loc97617').set_weights(w) 
in0Ave38009 = tf.constant([[[[0.9035]]]])
in1Ave38009 = tf.constant([[[[0.0189]]]])
in0Loc97617 = tf.constant([[[0.0189, 0.5114], [0.9572, 0.9722]]])
in0Add63332 = tf.constant([[[0.067, 0.7443], [0.2306, 0.0844]]])
in1Add63332 = tf.constant([[[0.2812, 0.1612], [0.7789, 0.5536]]])
in0Thr16055 = tf.constant([[[0.4261]]])
in0Max75812 = tf.constant([[[[0.6894], [0.6955]]]])
in1Max75812 = tf.constant([[[[0.4326], [0.515]]]])
in0Con34541 = tf.constant([[[[0.7316, 0.4981], [0.9825, 0.1842]], [[0.0487, 0.6497], [0.7422, 0.595]]]])
print (np.array2string(model.predict([in0Ave38009,in1Ave38009,in0Loc97617,in0Add63332,in1Add63332,in0Thr16055,in0Max75812,in1Max75812,in0Con34541],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add91904.png')

LAve38009 = average_layer([[[[[0.9035]]]], [[[[0.0189]]]]], Ave38009), 
LLoc67012 = locally_connected2D_layer(Ave38009, 1, 1,[[[0.5075, 0.7066, 0.4609]]],[[[0, 0, 0]]], 1, 1, Loc67012), 
LZer47385 = zero_padding2D_layer(Loc67012, 1, 0, 1, 0, Zer47385), 
LLoc97617 = locally_connected1D_layer([[[0.0189, 0.5114], [0.9572, 0.9722]]], 1,[[[0.904, 0.2769], [0.4473, 0.6378]], [[0.737, 0.2167], [0.6998, 0.2499]]],[[0, 0], [0, 0]], 1, Loc97617), 
LAdd63332 = add_layer([[[[0.067, 0.7443], [0.2306, 0.0844]]], [[[0.2812, 0.1612], [0.7789, 0.5536]]]], Add63332), 
LMin39614 = minimum_layer([Loc97617,Add63332], Min39614), 
LRes74416 = reshape_layer(Min39614, [2, 2, 1], Res74416), 
LThr16055 = thresholded_relu_layer([[[0.4261]]], 9.069038571864354, Thr16055), 
LRes7611 = reshape_layer(Thr16055, [1, 1, 1], Res7611), 
LZer63588 = zero_padding2D_layer(Res7611, 0, 0, 1, 0, Zer63588), 
LMax75812 = maximum_layer([[[[[0.6894], [0.6955]]]], [[[[0.4326], [0.515]]]]], Max75812), 
LMax184 = maximum_layer([Zer63588,Max75812], Max184), 
LZer69911 = zero_padding2D_layer(Max184, 1, 0, 0, 0, Zer69911), 
LMax20477 = maximum_layer([Res74416,Zer69911], Max20477), 
LCon34541 = concatenate_layer([Max20477,[[[[0.7316, 0.4981], [0.9825, 0.1842]], [[0.0487, 0.6497], [0.7422, 0.595]]]]], 3, Con34541), 
LAdd91904 = add_layer([Zer47385,Con34541], Add91904), 
exec_layers([LAve38009,LLoc67012,LZer47385,LLoc97617,LAdd63332,LMin39614,LRes74416,LThr16055,LRes7611,LZer63588,LMax75812,LMax184,LZer69911,LMax20477,LCon34541,LAdd91904],["Ave38009","Loc67012","Zer47385","Loc97617","Add63332","Min39614","Res74416","Thr16055","Res7611","Zer63588","Max75812","Max184","Zer69911","Max20477","Con34541","Add91904"],Add91904,"Add91904")

Actual (Unparsed): [[[[0.2458348, 0.7316000, 0.4981000], [0.3314043, 0.9825000, 0.1842000]], [[1.0095000, 0.0487000, 0.6497000], [0.9295590, 1.0680839, 0.8075671]]]]

Expected (Unparsed): [[[[0.24583481999999998,0.7316,0.4981],[0.33140432999999997,0.9825,0.1842]],[[1.0095,0.0487,0.6497],[0.929559,1.0680839199999999,0.80756708]]]]

Actual:   [[[[0.2459, 0.7316, 0.4981], [0.3315, 0.9825, 0.1842]], [[1.0095, 0.0487, 0.6497], [0.9296, 1.0681, 0.8076]]]]

Expected: [[[[0.2459, 0.7316, 0.4981], [0.3315, 0.9825, 0.1842]], [[1.0095, 0.0487, 0.6497], [0.9296, 1.0681, 0.8076]]]]