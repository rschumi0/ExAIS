import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat14000 = tf.keras.layers.Input(shape=([3]))

Bat14000 = keras.layers.BatchNormalization(axis=1, epsilon=0.25017497469308,  name = 'Bat14000', )(in0Bat14000)
Res21745 = keras.layers.Reshape((3, 1), name = 'Res21745', )(Bat14000)
Res923 = keras.layers.Reshape((3, 1, 1), name = 'Res923', )(Res21745)
Res38421 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res38421', )(Res923)
Glo30337 = keras.layers.GlobalAveragePooling3D(name = 'Glo30337', )(Res38421)
Res46978 = keras.layers.Reshape((1, 1), name = 'Res46978', )(Glo30337)
Res84818 = keras.layers.Reshape((1, 1, 1), name = 'Res84818', )(Res46978)
Max23393 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='valid', name = 'Max23393', )(Res84818)
model = tf.keras.models.Model(inputs=[in0Bat14000], outputs=Max23393)
w = model.get_layer('Bat14000').get_weights() 
w[0] = np.array([0.9705, 0.967, 0.8516])
w[1] = np.array([0.3327, 0.3746, 0.0792])
w[2] = np.array([0.1759, 0.7715, 0.2001])
w[3] = np.array([0.5865, 0.5783, 0.2553])
model.get_layer('Bat14000').set_weights(w) 
in0Bat14000 = tf.constant([[1.7286, 1.3471, 1.5376]])
print (np.array2string(model.predict([in0Bat14000],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max23393.png')

LBat14000 = batch_normalization_layer([[1.7286, 1.3471, 1.5376]], 1, 0.25017497469308, [0.9705, 0.967, 0.8516], [0.3327, 0.3746, 0.0792], [0.1759, 0.7715, 0.2001], [0.5865, 0.5783, 0.2553], Bat14000), 
LRes21745 = reshape_layer(Bat14000, [3, 1], Res21745), 
LRes923 = reshape_layer(Res21745, [3, 1, 1], Res923), 
LRes38421 = reshape_layer(Res923, [3, 1, 1, 1], Res38421), 
LGlo30337 = global_average_pooling3D_layer(Res38421, Glo30337), 
LRes46978 = reshape_layer(Glo30337, [1, 1], Res46978), 
LRes84818 = reshape_layer(Res46978, [1, 1, 1], Res84818), 
LMax23393 = max_pool2D_layer(Res84818, 1, 1, 1, 1, false, Max23393), 
exec_layers([LBat14000,LRes21745,LRes923,LRes38421,LGlo30337,LRes46978,LRes84818,LMax23393],["Bat14000","Res21745","Res923","Res38421","Glo30337","Res46978","Res84818","Max23393"],Max23393,"Max23393")

Actual (Unparsed): [[[[1.5491667]]]]

Expected (Unparsed): [[[[1.5491667055610971]]]]

Actual:   [[[[1.5492]]]]

Expected: [[[[1.5492]]]]