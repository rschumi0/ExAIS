import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add18126 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Add18126 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Loc41577 = tf.keras.layers.Input(shape=([2, 1]))

Add18126 = keras.layers.Add(name = 'Add18126', )([in0Add18126,in1Add18126])
Zer59696 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer59696', )(Add18126)
Loc41577 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc41577', )(in0Loc41577)
Sep21065 = keras.layers.SeparableConv1D(4, (1),strides=(2), padding='same', name = 'Sep21065', )(Loc41577)
Res75567 = keras.layers.Reshape((1, 4, 1), name = 'Res75567', )(Sep21065)
Loc8360 = keras.layers.LocallyConnected2D(2, (1, 2),strides=(1, 1), name = 'Loc8360', )(Res75567)
Max12227 = keras.layers.Maximum(name = 'Max12227', )([Zer59696,Loc8360])
model = tf.keras.models.Model(inputs=[in0Add18126,in1Add18126,in0Loc41577], outputs=Max12227)
w = model.get_layer('Loc41577').get_weights() 
w[0] = np.array([[[0.9353, 0.0725, 0.8326, 0.7161]], [[0.7662, 0.9189, 0.4118, 0.0935]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc41577').set_weights(w) 
w = model.get_layer('Sep21065').get_weights() 
w[0] = np.array([[[0.3014], [0.863], [0.9724], [0.7805]]])
w[1] = np.array([[[0.3835, 0.8375, 0.3665, 0.2586], [0.9673, 0.9443, 0.3193, 0.552], [0.2882, 0.1292, 0.4404, 0.7235], [0.491, 0.9781, 0.1016, 0.1061]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep21065').set_weights(w) 
w = model.get_layer('Loc8360').get_weights() 
w[0] = np.array([[[0.2308, 0.0717], [0.8843, 0.4617]], [[0.648, 0.2916], [0.1272, 0.3151]], [[0.402, 0.4889], [0.5206, 0.5592]]])
w[1] = np.array([[[0, 0], [0, 0], [0, 0]]])
model.get_layer('Loc8360').set_weights(w) 
in0Add18126 = tf.constant([[[[0.9545, 0.4029]]]])
in1Add18126 = tf.constant([[[[0.6568, 0.4472]]]])
in0Loc41577 = tf.constant([[[0.4913], [0.773]]])
print (np.array2string(model.predict([in0Add18126,in1Add18126,in0Loc41577],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max12227.png')

LAdd18126 = add_layer([[[[[0.9545, 0.4029]]]], [[[[0.6568, 0.4472]]]]], Add18126), 
LZer59696 = zero_padding2D_layer(Add18126, 0, 0, 2, 0, Zer59696), 
LLoc41577 = locally_connected1D_layer([[[0.4913], [0.773]]], 1,[[[0.9353, 0.0725, 0.8326, 0.7161]], [[0.7662, 0.9189, 0.4118, 0.0935]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc41577), 
LSep21065 = separable_conv1D_layer(Loc41577, 1,[[[[0.3014], [0.863], [0.9724], [0.7805]]],[[[0.3835, 0.8375, 0.3665, 0.2586], [0.9673, 0.9443, 0.3193, 0.552], [0.2882, 0.1292, 0.4404, 0.7235], [0.491, 0.9781, 0.1016, 0.1061]]]],[0, 0, 0, 0], 2, true, Sep21065), 
LRes75567 = reshape_layer(Sep21065, [1, 4, 1], Res75567), 
LLoc8360 = locally_connected2D_layer(Res75567, 1, 2,[[[0.2308, 0.0717], [0.8843, 0.4617]], [[0.648, 0.2916], [0.1272, 0.3151]], [[0.402, 0.4889], [0.5206, 0.5592]]],[[[0, 0], [0, 0], [0, 0]]], 1, 1, Loc8360), 
LMax12227 = maximum_layer([Zer59696,Loc8360], Max12227), 
exec_layers([LAdd18126,LZer59696,LLoc41577,LSep21065,LRes75567,LLoc8360,LMax12227],["Add18126","Zer59696","Loc41577","Sep21065","Res75567","Loc8360","Max12227"],Max12227,"Max12227")

Actual (Unparsed): [[[[0.4878896, 0.2385134], [0.3348509, 0.2186676], [1.6113000, 0.8501000]]]]

Expected (Unparsed): [[[[0.487889575377372,0.23851340717554464],[0.33485094522292724,0.21866759680905556],[1.6113,0.8501]]]]

Actual:   [[[[0.4879, 0.2386], [0.3349, 0.2187], [1.6113, 0.8501]]]]

Expected: [[[[0.4879, 0.2386], [0.3349, 0.2187], [1.6113, 0.8501]]]]