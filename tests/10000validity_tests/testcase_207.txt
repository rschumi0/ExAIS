import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc38631 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Sub35364 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub35364 = tf.keras.layers.Input(shape=([2, 2, 2]))

Loc38631 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 1), name = 'Loc38631', )(in0Loc38631)
Zer66728 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer66728', )(Loc38631)
Sub35364 = keras.layers.Subtract(name = 'Sub35364', )([in0Sub35364,in1Sub35364])
Sub93418 = keras.layers.Subtract(name = 'Sub93418', )([Zer66728,Sub35364])
Sof54045 = keras.layers.Softmax(axis=1, name = 'Sof54045', )(Sub93418)
Lea22031 = keras.layers.LeakyReLU(alpha=6.200714680244526, name = 'Lea22031', )(Sof54045)
model = tf.keras.models.Model(inputs=[in0Loc38631,in0Sub35364,in1Sub35364], outputs=Lea22031)
w = model.get_layer('Loc38631').get_weights() 
w[0] = np.array([[[0.3431, 0.2245]], [[0.0633, 0.9137]]])
w[1] = np.array([[[0, 0], [0, 0]]])
model.get_layer('Loc38631').set_weights(w) 
in0Loc38631 = tf.constant([[[[0.6947], [0.1087]]]])
in0Sub35364 = tf.constant([[[[0.8291, 0.0967], [0.096, 0.3459]], [[0.7636, 0.6019], [0.5658, 0.3648]]]])
in1Sub35364 = tf.constant([[[[0.0756, 0.6398], [0.3081, 0.4697]], [[0.3625, 0.8895], [0.5785, 0.7428]]]])
print (np.array2string(model.predict([in0Loc38631,in0Sub35364,in1Sub35364],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lea22031.png')

LLoc38631 = locally_connected2D_layer([[[[0.6947], [0.1087]]]], 1, 1,[[[0.3431, 0.2245]], [[0.0633, 0.9137]]],[[[0, 0], [0, 0]]], 1, 1, Loc38631), 
LZer66728 = zero_padding2D_layer(Loc38631, 1, 0, 0, 0, Zer66728), 
LSub35364 = subtract_layer([[[[0.8291, 0.0967], [0.096, 0.3459]], [[0.7636, 0.6019], [0.5658, 0.3648]]]], [[[[0.0756, 0.6398], [0.3081, 0.4697]], [[0.3625, 0.8895], [0.5785, 0.7428]]]], Sub35364), 
LSub93418 = subtract_layer(Zer66728,Sub35364, Sub93418), 
LSof54045 = softmax_layer(Sub93418, 1, Sof54045), 
LLea22031 = leaky_relu_layer(Sof54045, 6.200714680244526, Lea22031), 
exec_layers([LLoc38631,LZer66728,LSub35364,LSub93418,LSof54045,LLea22031],["Loc38631","Zer66728","Sub35364","Sub93418","Sof54045","Lea22031"],Lea22031,"Lea22031")

Actual (Unparsed): [[[[0.3564624, 0.5248644], [0.5479817, 0.4125293]], [[0.6435376, 0.4751356], [0.4520183, 0.5874707]]]]

Expected (Unparsed): [[[[0.35646242783533144,0.5248644357770941],[0.5479817157309118,0.41252928761088037]],[[0.6435375721646684,0.47513556422290587],[0.45201828426908824,0.5874707123891196]]]]

Actual:   [[[[0.3565, 0.5249], [0.548, 0.4126]], [[0.6436, 0.4752], [0.4521, 0.5875]]]]

Expected: [[[[0.3565, 0.5249], [0.548, 0.4126]], [[0.6436, 0.4752], [0.4521, 0.5875]]]]