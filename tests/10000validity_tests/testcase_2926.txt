import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave4879 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Ave4879 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Ave4879 = keras.layers.Average(name = 'Ave4879', )([in0Ave4879,in1Ave4879])
Bat9198 = keras.layers.BatchNormalization(axis=3, epsilon=0.4664126134433232,  name = 'Bat9198', )(Ave4879)
ELU72635 = keras.layers.ELU(alpha=-2.254141539660637, name = 'ELU72635', )(Bat9198)
model = tf.keras.models.Model(inputs=[in0Ave4879,in1Ave4879], outputs=ELU72635)
w = model.get_layer('Bat9198').get_weights() 
w[0] = np.array([0.4754, 0.7007])
w[1] = np.array([0.2203, 0.2873])
w[2] = np.array([0.1913, 0.7496])
w[3] = np.array([0.6736, 0.1959])
model.get_layer('Bat9198').set_weights(w) 
in0Ave4879 = tf.constant([[[[[0.5737], [0.7382]], [[0.0299], [0.7276]]], [[[0.9801], [0.299]], [[0.9343], [0.5102]]]]])
in1Ave4879 = tf.constant([[[[[0.8301], [0.6485]], [[0.7945], [0.4726]]], [[[0.7212], [0.706]], [[0.3447], [0.594]]]]])
print (np.array2string(model.predict([in0Ave4879,in1Ave4879],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU72635.png')

LAve4879 = average_layer([[[[[[0.5737], [0.7382]], [[0.0299], [0.7276]]], [[[0.9801], [0.299]], [[0.9343], [0.5102]]]]], [[[[[0.8301], [0.6485]], [[0.7945], [0.4726]]], [[[0.7212], [0.706]], [[0.3447], [0.594]]]]]], Ave4879), 
LBat9198 = batch_normalization_layer(Ave4879, 3, 0.4664126134433232, [0.4754, 0.7007], [0.2203, 0.2873], [0.1913, 0.7496], [0.6736, 0.1959], Bat9198), 
LELU72635 = elu_layer(Bat9198, -2.254141539660637, ELU72635), 
exec_layers([LAve4879,LBat9198,LELU72635],["Ave4879","Bat9198","ELU72635"],ELU72635,"ELU72635")

Actual (Unparsed): [[[[[0.4476449], [0.2388690]], [[0.3186558], [0.1585813]]], [[[0.5138759], [0.0745481]], [[0.4198612], [0.1172535]]]]]

Expected (Unparsed): [[[[[0.4476448703815861],[0.23886903403244342]],[[0.31865582034330664],[0.1585812548951166]]],[[[0.5138758720840164],[0.07454814772296514]],[[0.4198612434489364],[0.11725349726946838]]]]]

Actual:   [[[[[0.4477], [0.2389]], [[0.3187], [0.1586]]], [[[0.5139], [0.0746]], [[0.4199], [0.1173]]]]]

Expected: [[[[[0.4477], [0.2389]], [[0.3187], [0.1586]]], [[[0.5139], [0.0746]], [[0.4199], [0.1173]]]]]