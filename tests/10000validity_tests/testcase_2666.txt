import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot78369 = tf.keras.layers.Input(shape=([3]))
in1Dot78369 = tf.keras.layers.Input(shape=([3]))
in0Per39135 = tf.keras.layers.Input(shape=([1, 2]))
in0Max80193 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Max80193 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Dot78369 = keras.layers.Dot(axes=(1, 1), name = 'Dot78369', )([in0Dot78369,in1Dot78369])
Res33256 = keras.layers.Reshape((1, 1), name = 'Res33256', )(Dot78369)
Per39135 = keras.layers.Permute((2,1), name = 'Per39135',)(in0Per39135)
Res18829 = keras.layers.Reshape((2, 1, 1), name = 'Res18829', )(Per39135)
Ave53714 = keras.layers.AveragePooling2D(pool_size=(2, 1), strides=(2, 1), padding='same', name = 'Ave53714', )(Res18829)
Res62810 = keras.layers.Reshape((1, 1), name = 'Res62810', )(Ave53714)
Add2341 = keras.layers.Add(name = 'Add2341', )([Res33256,Res62810])
Max80193 = keras.layers.Maximum(name = 'Max80193', )([in0Max80193,in1Max80193])
Res82020 = keras.layers.Reshape((2, 1, 1), name = 'Res82020', )(Max80193)
Res15462 = keras.layers.Reshape((2, 1), name = 'Res15462', )(Res82020)
Max17906 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max17906', )(Res15462)
Res43670 = keras.layers.Reshape((2, 1, 1), name = 'Res43670', )(Max17906)
Res49683 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res49683', )(Res43670)
Cro14762 = keras.layers.Cropping3D(cropping=((1, 0), (0, 0), (0, 0)), name = 'Cro14762', )(Res49683)
Res92146 = keras.layers.Reshape((1, 1, 1), name = 'Res92146', )(Cro14762)
Res84484 = keras.layers.Reshape((1, 1), name = 'Res84484', )(Res92146)
Dot20338 = keras.layers.Dot(axes=(2, 2), name = 'Dot20338', )([Add2341,Res84484])
Res75027 = keras.layers.Reshape((1, 1, 1), name = 'Res75027', )(Dot20338)
Res65879 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res65879', )(Res75027)
Glo92067 = keras.layers.GlobalMaxPool3D(name = 'Glo92067', )(Res65879)
model = tf.keras.models.Model(inputs=[in0Dot78369,in1Dot78369,in0Per39135,in0Max80193,in1Max80193], outputs=Glo92067)
in0Dot78369 = tf.constant([[0.303, 0.7622, 0.2482]])
in1Dot78369 = tf.constant([[0.4039, 0.0839, 0.6242]])
in0Per39135 = tf.constant([[[1.9056, 1.2885]]])
in0Max80193 = tf.constant([[[[[0.8337]]], [[[0.9595]]]]])
in1Max80193 = tf.constant([[[[[0.2861]]], [[[0.8918]]]]])
print (np.array2string(model.predict([in0Dot78369,in1Dot78369,in0Per39135,in0Max80193,in1Max80193],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo92067.png')

LDot78369 = dot_layer([[0.303, 0.7622, 0.2482]], [[0.4039, 0.0839, 0.6242]], 1, 1, Dot78369), 
LRes33256 = reshape_layer(Dot78369, [1, 1], Res33256), 
LPer39135 = permute_layer([[[1.9056, 1.2885]]], 2,1, Per39135), 
LRes18829 = reshape_layer(Per39135, [2, 1, 1], Res18829), 
LAve53714 = average_pooling2D_layer(Res18829, 2, 1, 2, 1, true, Ave53714), 
LRes62810 = reshape_layer(Ave53714, [1, 1], Res62810), 
LAdd2341 = add_layer([Res33256,Res62810], Add2341), 
LMax80193 = maximum_layer([[[[[[0.8337]]], [[[0.9595]]]]], [[[[[0.2861]]], [[[0.8918]]]]]], Max80193), 
LRes82020 = reshape_layer(Max80193, [2, 1, 1], Res82020), 
LRes15462 = reshape_layer(Res82020, [2, 1], Res15462), 
LMax17906 = max_pool1D_layer(Res15462, 1, Max17906), 
LRes43670 = reshape_layer(Max17906, [2, 1, 1], Res43670), 
LRes49683 = reshape_layer(Res43670, [2, 1, 1, 1], Res49683), 
LCro14762 = cropping3D_layer(Res49683, 1, 0, 0, 0, 0, 0, Cro14762), 
LRes92146 = reshape_layer(Cro14762, [1, 1, 1], Res92146), 
LRes84484 = reshape_layer(Res92146, [1, 1], Res84484), 
LDot20338 = dot_layer(Add2341,Res84484, 2, 2, Dot20338), 
LRes75027 = reshape_layer(Dot20338, [1, 1, 1], Res75027), 
LRes65879 = reshape_layer(Res75027, [1, 1, 1, 1], Res65879), 
LGlo92067 = global_max_pool3D_layer(Res65879, Glo92067), 
exec_layers([LDot78369,LRes33256,LPer39135,LRes18829,LAve53714,LRes62810,LAdd2341,LMax80193,LRes82020,LRes15462,LMax17906,LRes43670,LRes49683,LCro14762,LRes92146,LRes84484,LDot20338,LRes75027,LRes65879,LGlo92067],["Dot78369","Res33256","Per39135","Res18829","Ave53714","Res62810","Add2341","Max80193","Res82020","Res15462","Max17906","Res43670","Res49683","Cro14762","Res92146","Res84484","Dot20338","Res75027","Res65879","Glo92067"],Glo92067,"Glo92067")

Actual (Unparsed): [[1.8598053]]

Expected (Unparsed): [[1.85980529784]]

Actual:   [[1.8599]]

Expected: [[1.8599]]