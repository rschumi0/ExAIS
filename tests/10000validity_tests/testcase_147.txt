import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot94657 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot94657 = tf.keras.layers.Input(shape=([2, 3]))
in0Sof45428 = tf.keras.layers.Input(shape=([1, 2]))
in0Con30798 = tf.keras.layers.Input(shape=([1, 1]))
in0Dep94177 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con29630 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot28081 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot28081 = tf.keras.layers.Input(shape=([3, 2]))
in0Con64456 = tf.keras.layers.Input(shape=([3, 1]))

Dot94657 = keras.layers.Dot(axes=(1, 1), name = 'Dot94657', )([in0Dot94657,in1Dot94657])
Sof45428 = keras.layers.Softmax(axis=1, name = 'Sof45428', input_shape=(1, 2))(in0Sof45428)
Con30798 = keras.layers.Concatenate(axis=2, name = 'Con30798', )([Sof45428,in0Con30798])
Dep94177 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep94177', )(in0Dep94177)
Res63706 = keras.layers.Reshape((1, 1), name = 'Res63706', )(Dep94177)
Dot97930 = keras.layers.Dot(axes=(1, 1), name = 'Dot97930', )([Con30798,Res63706])
Con29630 = keras.layers.Concatenate(axis=2, name = 'Con29630', )([Dot97930,in0Con29630])
Mul50136 = keras.layers.Multiply(name = 'Mul50136', )([Dot94657,Con29630])
Dot28081 = keras.layers.Dot(axes=(1, 1), name = 'Dot28081', )([in0Dot28081,in1Dot28081])
Zer68336 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer68336', )(Dot28081)
Con64456 = keras.layers.Concatenate(axis=2, name = 'Con64456', )([Zer68336,in0Con64456])
Sub79612 = keras.layers.Subtract(name = 'Sub79612', )([Mul50136,Con64456])
Res75601 = keras.layers.Reshape((3, 3, 1), name = 'Res75601', )(Sub79612)
Res89297 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res89297', )(Res75601)
Cro86330 = keras.layers.Cropping3D(cropping=((1, 1), (2, 0), (0, 0)), name = 'Cro86330', )(Res89297)
model = tf.keras.models.Model(inputs=[in0Dot94657,in1Dot94657,in0Sof45428,in0Con30798,in0Dep94177,in0Con29630,in0Dot28081,in1Dot28081,in0Con64456], outputs=Cro86330)
w = model.get_layer('Dep94177').get_weights() 
w[0] = np.array([[[[0.1043]]]])
w[1] = np.array([0])
model.get_layer('Dep94177').set_weights(w) 
in0Dot94657 = tf.constant([[[0.9323, 0.1276, 0.6938], [0.5837, 0.5337, 0.311]]])
in1Dot94657 = tf.constant([[[0.4643, 0.4976, 0.2468], [0.808, 0.4869, 0.6436]]])
in0Sof45428 = tf.constant([[[0.1103, 0.7188]]])
in0Con30798 = tf.constant([[[0.3034]]])
in0Dep94177 = tf.constant([[[[0.7183]]]])
in0Con29630 = tf.constant([[[0.1287, 0.9372], [0.788, 0.8065], [0.1542, 0.4919]]])
in0Dot28081 = tf.constant([[[0.3347, 0.7076], [0.9596, 0.0826], [0.1295, 0.9184]]])
in1Dot28081 = tf.constant([[[0.1154, 0.9369], [0.9314, 0.4966], [0.7142, 0.9832]]])
in0Con64456 = tf.constant([[[0.0118], [0.4216], [0.1184]]])
print (np.array2string(model.predict([in0Dot94657,in1Dot94657,in0Sof45428,in0Con30798,in0Dep94177,in0Con29630,in0Dot28081,in1Dot28081,in0Con64456],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro86330.png')

LDot94657 = dot_layer([[[0.9323, 0.1276, 0.6938], [0.5837, 0.5337, 0.311]]], [[[0.4643, 0.4976, 0.2468], [0.808, 0.4869, 0.6436]]], 1, 1, Dot94657), 
LSof45428 = softmax_layer([[[0.1103, 0.7188]]], 1, Sof45428), 
LCon30798 = concatenate_layer([Sof45428,[[[0.3034]]]], 2, Con30798), 
LDep94177 = depthwise_conv2D_layer([[[[0.7183]]]], 1, 1,[[[[0.1043]]]],[0], 1, 1, false, Dep94177), 
LRes63706 = reshape_layer(Dep94177, [1, 1], Res63706), 
LDot97930 = dot_layer(Con30798,Res63706, 1, 1, Dot97930), 
LCon29630 = concatenate_layer([Dot97930,[[[0.1287, 0.9372], [0.788, 0.8065], [0.1542, 0.4919]]]], 2, Con29630), 
LMul50136 = multiply_layer([Dot94657,Con29630], Mul50136), 
LDot28081 = dot_layer([[[0.3347, 0.7076], [0.9596, 0.0826], [0.1295, 0.9184]]], [[[0.1154, 0.9369], [0.9314, 0.4966], [0.7142, 0.9832]]], 1, 1, Dot28081), 
LZer68336 = zero_padding1D_layer(Dot28081, 1, 0, Zer68336), 
LCon64456 = concatenate_layer([Zer68336,[[[0.0118], [0.4216], [0.1184]]]], 2, Con64456), 
LSub79612 = subtract_layer(Mul50136,Con64456, Sub79612), 
LRes75601 = reshape_layer(Sub79612, [3, 3, 1], Res75601), 
LRes89297 = reshape_layer(Res75601, [3, 3, 1, 1], Res89297), 
LCro86330 = cropping3D_layer(Res89297, 1, 1, 2, 0, 0, 0, Cro86330), 
exec_layers([LDot94657,LSof45428,LCon30798,LDep94177,LRes63706,LDot97930,LCon29630,LMul50136,LDot28081,LZer68336,LCon64456,LSub79612,LRes75601,LRes89297,LCro86330],["Dot94657","Sof45428","Con30798","Dep94177","Res63706","Dot97930","Con29630","Mul50136","Dot28081","Zer68336","Con64456","Sub79612","Res75601","Res89297","Cro86330"],Cro86330,"Cro86330")

Actual (Unparsed): [[[[[-0.1191778]]]]]

Expected (Unparsed): [[[[[-0.11917782350000006]]]]]

Actual:   [[[[[-0.1191]]]]]

Expected: [[[[[-0.1191]]]]]