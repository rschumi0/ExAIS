import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul96781 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul96781 = tf.keras.layers.Input(shape=([2, 1]))
in0Con32722 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Add47692 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Add47692 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Mul96781 = keras.layers.Multiply(name = 'Mul96781', )([in0Mul96781,in1Mul96781])
Res47325 = keras.layers.Reshape((2, 1, 1), name = 'Res47325', )(Mul96781)
Res47708 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res47708', )(Res47325)
Zer70810 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer70810', )(Res47708)
Con32722 = keras.layers.Concatenate(axis=4, name = 'Con32722', )([Zer70810,in0Con32722])
Add47692 = keras.layers.Add(name = 'Add47692', )([in0Add47692,in1Add47692])
Max62158 = keras.layers.Maximum(name = 'Max62158', )([Con32722,Add47692])
model = tf.keras.models.Model(inputs=[in0Mul96781,in1Mul96781,in0Con32722,in0Add47692,in1Add47692], outputs=Max62158)
in0Mul96781 = tf.constant([[[0.6762], [0.2802]]])
in1Mul96781 = tf.constant([[[0.6326], [0.2194]]])
in0Con32722 = tf.constant([[[[[0.4568]], [[0.6466]]], [[[0.95]], [[0.7964]]]]])
in0Add47692 = tf.constant([[[[[0.3091, 0.9031]], [[0.9403, 0.3546]]], [[[0.8962, 0.6351]], [[0.469, 0.9962]]]]])
in1Add47692 = tf.constant([[[[[0.6342, 0.9972]], [[0.3207, 0.0425]]], [[[0.5553, 0.6576]], [[0.5432, 0.282]]]]])
print (np.array2string(model.predict([in0Mul96781,in1Mul96781,in0Con32722,in0Add47692,in1Add47692],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max62158.png')

LMul96781 = multiply_layer([[[[0.6762], [0.2802]]], [[[0.6326], [0.2194]]]], Mul96781), 
LRes47325 = reshape_layer(Mul96781, [2, 1, 1], Res47325), 
LRes47708 = reshape_layer(Res47325, [2, 1, 1, 1], Res47708), 
LZer70810 = zero_padding3D_layer(Res47708, 0, 0, 1, 0, 0, 0, Zer70810), 
LCon32722 = concatenate_layer([Zer70810,[[[[[0.4568]], [[0.6466]]], [[[0.95]], [[0.7964]]]]]], 4, Con32722), 
LAdd47692 = add_layer([[[[[[0.3091, 0.9031]], [[0.9403, 0.3546]]], [[[0.8962, 0.6351]], [[0.469, 0.9962]]]]], [[[[[0.6342, 0.9972]], [[0.3207, 0.0425]]], [[[0.5553, 0.6576]], [[0.5432, 0.282]]]]]], Add47692), 
LMax62158 = maximum_layer([Con32722,Add47692], Max62158), 
exec_layers([LMul96781,LRes47325,LRes47708,LZer70810,LCon32722,LAdd47692,LMax62158],["Mul96781","Res47325","Res47708","Zer70810","Con32722","Add47692","Max62158"],Max62158,"Max62158")

Actual (Unparsed): [[[[[0.9433000, 1.9003000]], [[1.2610000, 0.6466000]]], [[[1.4515000, 1.2927000]], [[1.0122000, 1.2782000]]]]]

Expected (Unparsed): [[[[[0.9433,1.9003]],[[1.2610000000000001,0.6466]]],[[[1.4515,1.2927]],[[1.0122,1.2782]]]]]

Actual:   [[[[[0.9433, 1.9003]], [[1.261, 0.6466]]], [[[1.4515, 1.2927]], [[1.0122, 1.2782]]]]]

Expected: [[[[[0.9433, 1.9003]], [[1.2611, 0.6466]]], [[[1.4515, 1.2927]], [[1.0122, 1.2782]]]]]