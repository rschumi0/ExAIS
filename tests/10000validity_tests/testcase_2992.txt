import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave19776 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Ave19776 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Ave19776 = keras.layers.Average(name = 'Ave19776', )([in0Ave19776,in1Ave19776])
Den23469 = keras.layers.Dense(1,name = 'Den23469', )(Ave19776)
Res98922 = keras.layers.Reshape((2, 2, 1), name = 'Res98922', )(Den23469)
Res94551 = keras.layers.Reshape((2, 2), name = 'Res94551', )(Res98922)
Glo99185 = keras.layers.GlobalAveragePooling1D(name = 'Glo99185', )(Res94551)
model = tf.keras.models.Model(inputs=[in0Ave19776,in1Ave19776], outputs=Glo99185)
w = model.get_layer('Den23469').get_weights() 
w[0] = np.array([[0.329]])
w[1] = np.array([0.9003])
model.get_layer('Den23469').set_weights(w) 
in0Ave19776 = tf.constant([[[[[0.1306]], [[0.6982]]], [[[0.528]], [[0.6813]]]]])
in1Ave19776 = tf.constant([[[[[0.9856]], [[0.3183]]], [[[0.8011]], [[0.505]]]]])
print (np.array2string(model.predict([in0Ave19776,in1Ave19776],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo99185.png')

LAve19776 = average_layer([[[[[[0.1306]], [[0.6982]]], [[[0.528]], [[0.6813]]]]], [[[[[0.9856]], [[0.3183]]], [[[0.8011]], [[0.505]]]]]], Ave19776), 
LDen23469 = dense_layer(Ave19776, [[0.329]],[0.9003], Den23469), 
LRes98922 = reshape_layer(Den23469, [2, 2, 1], Res98922), 
LRes94551 = reshape_layer(Res98922, [2, 2], Res94551), 
LGlo99185 = global_average_pooling1D_layer(Res94551, Glo99185), 
exec_layers([LAve19776,LDen23469,LRes98922,LRes94551,LGlo99185],["Ave19776","Den23469","Res98922","Res94551","Glo99185"],Glo99185,"Glo99185")

Actual (Unparsed): [[1.1014259, 1.0814803]]

Expected (Unparsed): [[1.101425925,1.0814803]]

Actual:   [[1.1015, 1.0815]]

Expected: [[1.1015, 1.0815]]