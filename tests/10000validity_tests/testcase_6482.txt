import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min19364 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Min19364 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Glo51351 = tf.keras.layers.Input(shape=([2, 2, 1]))

Min19364 = keras.layers.Minimum(name = 'Min19364', )([in0Min19364,in1Min19364])
Res50004 = keras.layers.Reshape((2, 2), name = 'Res50004', )(Min19364)
GRU7455 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU7455', )(Res50004)
Glo51351 = keras.layers.GlobalMaxPool2D(name = 'Glo51351', )(in0Glo51351)
Dot59107 = keras.layers.Dot(axes=(1, 1), name = 'Dot59107', )([GRU7455,Glo51351])
Fla38590 = keras.layers.Flatten(name = 'Fla38590', )(Dot59107)
Res5206 = keras.layers.Reshape((1, 1), name = 'Res5206', )(Fla38590)
Zer90850 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer90850', )(Res5206)
model = tf.keras.models.Model(inputs=[in0Min19364,in1Min19364,in0Glo51351], outputs=Zer90850)
w = model.get_layer('GRU7455').get_weights() 
w[0] = np.array([[1, 7, 9], [8, 1, 6]])
w[1] = np.array([[1, 9, 9]])
w[2] = np.array([6, 9, 5])
model.get_layer('GRU7455').set_weights(w) 
in0Min19364 = tf.constant([[[[0.7898, 0.2364]], [[0.9419, 0.739]]]])
in1Min19364 = tf.constant([[[[0.4817, 0.3996]], [[0.8598, 0.0396]]]])
in0Glo51351 = tf.constant([[[[1.2651], [1.7363]], [[1.4654], [1.7703]]]])
print (np.array2string(model.predict([in0Min19364,in1Min19364,in0Glo51351],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer90850.png')

LMin19364 = minimum_layer([[[[[0.7898, 0.2364]], [[0.9419, 0.739]]]], [[[[0.4817, 0.3996]], [[0.8598, 0.0396]]]]], Min19364), 
LRes50004 = reshape_layer(Min19364, [2, 2], Res50004), 
LGRU7455 = gru_layer(Res50004,[[1, 7, 9], [8, 1, 6]],[[1, 9, 9]],[6, 9, 5], false, GRU7455), 
LGlo51351 = global_max_pool2D_layer([[[[1.2651], [1.7363]], [[1.4654], [1.7703]]]], Glo51351), 
LDot59107 = dot_layer(GRU7455,Glo51351, 1, 1, Dot59107), 
LFla38590 = flatten_layer(Dot59107, Fla38590), 
LRes5206 = reshape_layer(Fla38590, [1, 1], Res5206), 
LZer90850 = zero_padding1D_layer(Res5206, 1, 1, Zer90850), 
exec_layers([LMin19364,LRes50004,LGRU7455,LGlo51351,LDot59107,LFla38590,LRes5206,LZer90850],["Min19364","Res50004","GRU7455","Glo51351","Dot59107","Fla38590","Res5206","Zer90850"],Zer90850,"Zer90850")

Actual (Unparsed): [[[0.0000000], [0.0017602], [0.0000000]]]

Expected (Unparsed): [[[0],[0.0017602391062201334],[0]]]

Actual:   [[[0], [0.0018], [0]]]

Expected: [[[0], [0.0018], [0]]]