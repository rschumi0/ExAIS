import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro81069 = tf.keras.layers.Input(shape=([3, 2, 1]))
in0Con88194 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave5612 = tf.keras.layers.Input(shape=([2, 2]))
in0Con72508 = tf.keras.layers.Input(shape=([2]))
in0Max46367 = tf.keras.layers.Input(shape=([2, 2]))
in1Max46367 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul14109 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Mul14109 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Con48026 = tf.keras.layers.Input(shape=([3]))

Cro81069 = keras.layers.Cropping2D(cropping=((2, 0), (1, 0)), name = 'Cro81069', )(in0Cro81069)
Dep82740 = keras.layers.DepthwiseConv2D((2, 1),strides=(2, 2), padding='same', name = 'Dep82740', )(Cro81069)
Res10905 = keras.layers.Reshape((1, 1), name = 'Res10905', )(Dep82740)
Glo81671 = keras.layers.GlobalMaxPool1D(name = 'Glo81671', )(Res10905)
Res27372 = keras.layers.Reshape((1, 1), name = 'Res27372', )(Glo81671)
Con88194 = keras.layers.Concatenate(axis=2, name = 'Con88194', )([Res27372,in0Con88194])
Ave5612 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave5612', )(in0Ave5612)
Max39892 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max39892', )(Ave5612)
Dot92237 = keras.layers.Dot(axes=(2, 2), name = 'Dot92237', )([Con88194,Max39892])
Fla79055 = keras.layers.Flatten(name = 'Fla79055', )(Dot92237)
Con72508 = keras.layers.Concatenate(axis=1, name = 'Con72508', )([Fla79055,in0Con72508])
Max46367 = keras.layers.Maximum(name = 'Max46367', )([in0Max46367,in1Max46367])
Fla5004 = keras.layers.Flatten(name = 'Fla5004', )(Max46367)
Mul14109 = keras.layers.Multiply(name = 'Mul14109', )([in0Mul14109,in1Mul14109])
Res55765 = keras.layers.Reshape((2, 1, 4), name = 'Res55765', )(Mul14109)
Res79792 = keras.layers.Reshape((2, 4), name = 'Res79792', )(Res55765)
Ave24678 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='valid', name = 'Ave24678', )(Res79792)
Res73100 = keras.layers.Reshape((2, 4, 1), name = 'Res73100', )(Ave24678)
Res80869 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res80869', )(Res73100)
Glo92455 = keras.layers.GlobalAveragePooling3D(name = 'Glo92455', )(Res80869)
Con48026 = keras.layers.Concatenate(axis=1, name = 'Con48026', )([Glo92455,in0Con48026])
Ave51714 = keras.layers.Average(name = 'Ave51714', )([Fla5004,Con48026])
Max92541 = keras.layers.Maximum(name = 'Max92541', )([Con72508,Ave51714])
model = tf.keras.models.Model(inputs=[in0Cro81069,in0Con88194,in0Ave5612,in0Con72508,in0Max46367,in1Max46367,in0Mul14109,in1Mul14109,in0Con48026], outputs=Max92541)
w = model.get_layer('Dep82740').get_weights() 
w[0] = np.array([[[[0.0382]]], [[[0.9484]]]])
w[1] = np.array([0])
model.get_layer('Dep82740').set_weights(w) 
in0Cro81069 = tf.constant([[[[1.7195], [1.5803]], [[1.8277], [1.5069]], [[1.6968], [1.925]]]])
in0Con88194 = tf.constant([[[0.917]]])
in0Ave5612 = tf.constant([[[1.6594, 1.575], [1.6085, 1.7154]]])
in0Con72508 = tf.constant([[0.8261, 0.7569]])
in0Max46367 = tf.constant([[[0.8626, 0.2795], [0.4129, 0.486]]])
in1Max46367 = tf.constant([[[0.3359, 0.577], [0.6765, 0.0864]]])
in0Mul14109 = tf.constant([[[[[0.8721, 0.8524], [0.736, 0.7497]]], [[[0.9898, 0.1961], [0.3102, 0.036]]]]])
in1Mul14109 = tf.constant([[[[[0.194, 0.5694], [0.6661, 0.7064]]], [[[0.8505, 0.4188], [0.7377, 0.5437]]]]])
in0Con48026 = tf.constant([[0.0501, 0.2375, 0.6797]])
print (np.array2string(model.predict([in0Cro81069,in0Con88194,in0Ave5612,in0Con72508,in0Max46367,in1Max46367,in0Mul14109,in1Mul14109,in0Con48026],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max92541.png')

LCro81069 = cropping2D_layer([[[[1.7195], [1.5803]], [[1.8277], [1.5069]], [[1.6968], [1.925]]]], 2, 0, 1, 0, Cro81069), 
LDep82740 = depthwise_conv2D_layer(Cro81069, 2, 1,[[[[0.0382]]], [[[0.9484]]]],[0], 2, 2, true, Dep82740), 
LRes10905 = reshape_layer(Dep82740, [1, 1], Res10905), 
LGlo81671 = global_max_pool1D_layer(Res10905, Glo81671), 
LRes27372 = reshape_layer(Glo81671, [1, 1], Res27372), 
LCon88194 = concatenate_layer([Res27372,[[[0.917]]]], 2, Con88194), 
LAve5612 = average_pooling1D_layer([[[1.6594, 1.575], [1.6085, 1.7154]]], 1, Ave5612), 
LMax39892 = max_pool1D_layer(Ave5612, 1, Max39892), 
LDot92237 = dot_layer(Con88194,Max39892, 2, 2, Dot92237), 
LFla79055 = flatten_layer(Dot92237, Fla79055), 
LCon72508 = concatenate_layer([Fla79055,[[0.8261, 0.7569]]], 1, Con72508), 
LMax46367 = maximum_layer([[[[0.8626, 0.2795], [0.4129, 0.486]]], [[[0.3359, 0.577], [0.6765, 0.0864]]]], Max46367), 
LFla5004 = flatten_layer(Max46367, Fla5004), 
LMul14109 = multiply_layer([[[[[[0.8721, 0.8524], [0.736, 0.7497]]], [[[0.9898, 0.1961], [0.3102, 0.036]]]]], [[[[[0.194, 0.5694], [0.6661, 0.7064]]], [[[0.8505, 0.4188], [0.7377, 0.5437]]]]]], Mul14109), 
LRes55765 = reshape_layer(Mul14109, [2, 1, 4], Res55765), 
LRes79792 = reshape_layer(Res55765, [2, 4], Res79792), 
LAve24678 = average_pooling1D_layer(Res79792, 1, 1, false, Ave24678), 
LRes73100 = reshape_layer(Ave24678, [2, 4, 1], Res73100), 
LRes80869 = reshape_layer(Res73100, [2, 4, 1, 1], Res80869), 
LGlo92455 = global_average_pooling3D_layer(Res80869, Glo92455), 
LCon48026 = concatenate_layer([Glo92455,[[0.0501, 0.2375, 0.6797]]], 1, Con48026), 
LAve51714 = average_layer([Fla5004,Con48026], Ave51714), 
LMax92541 = maximum_layer([Con72508,Ave51714], Max92541), 
exec_layers([LCro81069,LDep82740,LRes10905,LGlo81671,LRes27372,LCon88194,LAve5612,LMax39892,LDot92237,LFla79055,LCon72508,LMax46367,LFla5004,LMul14109,LRes55765,LRes79792,LAve24678,LRes73100,LRes80869,LGlo92455,LCon48026,LAve51714,LMax92541],["Cro81069","Dep82740","Res10905","Glo81671","Res27372","Con88194","Ave5612","Max39892","Dot92237","Fla79055","Con72508","Max46367","Fla5004","Mul14109","Res55765","Res79792","Ave24678","Res73100","Res80869","Glo92455","Con48026","Ave51714","Max92541"],Max92541,"Max92541")

Actual (Unparsed): [[1.5662990, 1.6913028, 0.8261000, 0.7569000]]

Expected (Unparsed): [[1.566298979,1.6913028475,0.8261,0.7569]]

Actual:   [[1.5663, 1.6914, 0.8261, 0.7569]]

Expected: [[1.5663, 1.6914, 0.8261, 0.7569]]