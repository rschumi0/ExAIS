import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub54436 = tf.keras.layers.Input(shape=([3]))
in1Sub54436 = tf.keras.layers.Input(shape=([3]))
in0Con49507 = tf.keras.layers.Input(shape=([3, 1]))
in0Ave92530 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave92530 = tf.keras.layers.Input(shape=([1, 2]))

Sub54436 = keras.layers.Subtract(name = 'Sub54436', )([in0Sub54436,in1Sub54436])
Res3786 = keras.layers.Reshape((3, 1), name = 'Res3786', )(Sub54436)
Con49507 = keras.layers.Concatenate(axis=2, name = 'Con49507', )([Res3786,in0Con49507])
Ave92530 = keras.layers.Average(name = 'Ave92530', )([in0Ave92530,in1Ave92530])
Dot92827 = keras.layers.Dot(axes=(2, 2), name = 'Dot92827', )([Con49507,Ave92530])
model = tf.keras.models.Model(inputs=[in0Sub54436,in1Sub54436,in0Con49507,in0Ave92530,in1Ave92530], outputs=Dot92827)
in0Sub54436 = tf.constant([[0.2811, 0.1142, 0.1994]])
in1Sub54436 = tf.constant([[0.38, 0.0555, 0.4273]])
in0Con49507 = tf.constant([[[0.2832], [0.213], [0.3962]]])
in0Ave92530 = tf.constant([[[0.4742, 0.5149]]])
in1Ave92530 = tf.constant([[[0.9661, 0.5777]]])
print (np.array2string(model.predict([in0Sub54436,in1Sub54436,in0Con49507,in0Ave92530,in1Ave92530],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot92827.png')

LSub54436 = subtract_layer([[0.2811, 0.1142, 0.1994]], [[0.38, 0.0555, 0.4273]], Sub54436), 
LRes3786 = reshape_layer(Sub54436, [3, 1], Res3786), 
LCon49507 = concatenate_layer([Res3786,[[[0.2832], [0.213], [0.3962]]]], 2, Con49507), 
LAve92530 = average_layer([[[[0.4742, 0.5149]]], [[[0.9661, 0.5777]]]], Ave92530), 
LDot92827 = dot_layer(Con49507,Ave92530, 2, 2, Dot92827), 
exec_layers([LSub54436,LRes3786,LCon49507,LAve92530,LDot92827],["Sub54436","Res3786","Con49507","Ave92530","Dot92827"],Dot92827,"Dot92827")

Actual (Unparsed): [[[0.0834893], [0.1586347], [0.0523219]]]

Expected (Unparsed): [[[0.08348932500000003],[0.158634705],[0.05232187499999999]]]

Actual:   [[[0.0835], [0.1587], [0.0524]]]

Expected: [[[0.0835], [0.1587], [0.0524]]]