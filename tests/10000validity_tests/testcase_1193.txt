import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max24430 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max24430 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dot67969 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot67969 = tf.keras.layers.Input(shape=([2, 2]))

Max24430 = keras.layers.Maximum(name = 'Max24430', )([in0Max24430,in1Max24430])
Res32982 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res32982', )(Max24430)
Cro69787 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (1, 0)), name = 'Cro69787', )(Res32982)
Res93134 = keras.layers.Reshape((1, 2, 1), name = 'Res93134', )(Cro69787)
Res16619 = keras.layers.Reshape((1, 2), name = 'Res16619', )(Res93134)
Zer85563 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer85563', )(Res16619)
Dot67969 = keras.layers.Dot(axes=(1, 2), name = 'Dot67969', )([in0Dot67969,in1Dot67969])
Add57782 = keras.layers.Add(name = 'Add57782', )([Zer85563,Dot67969])
model = tf.keras.models.Model(inputs=[in0Max24430,in1Max24430,in0Dot67969,in1Dot67969], outputs=Add57782)
in0Max24430 = tf.constant([[[[0.0851, 0.1618], [0.2005, 0.267]]]])
in1Max24430 = tf.constant([[[[0.3845, 0.7197], [0.6842, 0.6023]]]])
in0Dot67969 = tf.constant([[[0.8499, 0.0186], [0.2322, 0.0164]]])
in1Dot67969 = tf.constant([[[0.2569, 0.2387], [0.6481, 0.6065]]])
print (np.array2string(model.predict([in0Max24430,in1Max24430,in0Dot67969,in1Dot67969],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add57782.png')

LMax24430 = maximum_layer([[[[[0.0851, 0.1618], [0.2005, 0.267]]]], [[[[0.3845, 0.7197], [0.6842, 0.6023]]]]], Max24430), 
LRes32982 = reshape_layer(Max24430, [1, 2, 2, 1], Res32982), 
LCro69787 = cropping3D_layer(Res32982, 0, 0, 0, 0, 1, 0, Cro69787), 
LRes93134 = reshape_layer(Cro69787, [1, 2, 1], Res93134), 
LRes16619 = reshape_layer(Res93134, [1, 2], Res16619), 
LZer85563 = zero_padding1D_layer(Res16619, 1, 0, Zer85563), 
LDot67969 = dot_layer([[[0.8499, 0.0186], [0.2322, 0.0164]]], [[[0.2569, 0.2387], [0.6481, 0.6065]]], 1, 2, Dot67969), 
LAdd57782 = add_layer([Zer85563,Dot67969], Add57782), 
exec_layers([LMax24430,LRes32982,LCro69787,LRes93134,LRes16619,LZer85563,LDot67969,LAdd57782],["Max24430","Res32982","Cro69787","Res93134","Res16619","Zer85563","Dot67969","Add57782"],Add57782,"Add57782")

Actual (Unparsed): [[[0.2737655, 0.6916495], [0.7283930, 0.6243012]]]

Expected (Unparsed): [[[0.27376545,0.6916494900000001],[0.7283930200000001,0.62430126]]]

Actual:   [[[0.2738, 0.6917], [0.7284, 0.6244]]]

Expected: [[[0.2738, 0.6917], [0.7284, 0.6244]]]