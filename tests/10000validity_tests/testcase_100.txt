import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add86203 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add86203 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Zer40403 = tf.keras.layers.Input(shape=([2, 4, 1, 1]))

Add86203 = keras.layers.Add(name = 'Add86203', )([in0Add86203,in1Add86203])
Res5999 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res5999', )(Add86203)
Con95358 = keras.layers.Conv3DTranspose(4, (1, 1, 1),strides=(1, 9, 1), padding='same', name = 'Con95358', )(Res5999)
Res33495 = keras.layers.Reshape((1, 9, 4), name = 'Res33495', )(Con95358)
Loc13812 = keras.layers.LocallyConnected2D(2, (1, 5),strides=(1, 1), name = 'Loc13812', )(Res33495)
Res13374 = keras.layers.Reshape((1, 5, 2, 1), name = 'Res13374', )(Loc13812)
Zer44160 = keras.layers.ZeroPadding3D(padding=((3, 0), (1, 0), (1, 0)), name = 'Zer44160', )(Res13374)
Zer40403 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer40403', )(in0Zer40403)
Add27936 = keras.layers.Add(name = 'Add27936', )([Zer44160,Zer40403])
Res27801 = keras.layers.Reshape((4, 6, 3), name = 'Res27801', )(Add27936)
Res59197 = keras.layers.Reshape((4, 18), name = 'Res59197', )(Res27801)
GRU38646 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU38646', )(Res59197)
model = tf.keras.models.Model(inputs=[in0Add86203,in1Add86203,in0Zer40403], outputs=GRU38646)
w = model.get_layer('Con95358').get_weights() 
w[0] = np.array([[[[[0.2558], [0.0899], [0.8204], [0.9383]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con95358').set_weights(w) 
w = model.get_layer('Loc13812').get_weights() 
w[0] = np.array([[[0.5662, 0.0364], [0.0839, 0.354], [0.883, 0.6435], [0.0142, 0.2886], [0.5231, 0.1235], [0.8794, 0.7047], [0.0847, 0.4951], [0.2401, 0.0249], [0.7621, 0.7029], [0.4535, 0.1708], [0.7468, 0.144], [0.427, 0.2564], [0.408, 0.912], [0.8718, 0.8762], [0.5817, 0.8698], [0.0567, 0.7429], [0.7405, 0.6168], [0.3315, 0.3352], [0.1645, 0.5175], [0.3691, 0.7734]], [[0.4891, 0.2253], [0.1538, 0.3577], [0.165, 0.5526], [0.2386, 0.077], [0.4364, 0.1133], [0.6827, 0.922], [0.4127, 0.8951], [0.3895, 0.0236], [0.6926, 0.8086], [0.2668, 0.4753], [0.7838, 0.3014], [0.75, 0.1996], [0.254, 0.327], [0.7481, 0.3671], [0.148, 0.3157], [0.9959, 0.6896], [0.7101, 0.3048], [0.136, 0.3741], [0.8631, 0.0577], [0.5849, 0.645]], [[0.2107, 0.8228], [0.3901, 0.5219], [0.5563, 0.3687], [0.8325, 0.9737], [0.0583, 0.0662], [0.4887, 0.6619], [0.1807, 0.0839], [0.8299, 0.2309], [0.5378, 0.2142], [0.2084, 0.5095], [0.5834, 0.4509], [0.2541, 0.0441], [0.8463, 0.2053], [0.2913, 0.1019], [0.0769, 0.9643], [0.3727, 0.6548], [0.2387, 0.2708], [0.924, 0.8807], [0.748, 0.1359], [0.7928, 0.4069]], [[0.7492, 0.3835], [0.7064, 0.8577], [0.496, 0.9688], [0.7545, 0.2669], [0.1042, 0.0135], [0.5338, 0.5711], [0.0365, 0.1574], [0.0211, 0.7045], [0.6895, 0.8381], [0.0696, 0.7876], [0.3594, 0.2799], [0.6664, 0.5187], [0.6841, 0.2982], [0.734, 0.1594], [0.3801, 0.5056], [0.3082, 0.4391], [0.7252, 0.1474], [0.3847, 0.2912], [0.7712, 0.5837], [0.5917, 0.5865]], [[0.7166, 0.3876], [0.1138, 0.9261], [0.2138, 0.1366], [0.9711, 0.1224], [0.6447, 0.2347], [0.84, 0.2056], [0.5559, 0.5232], [0.0914, 0.672], [0.5144, 0.0116], [0.6178, 0.2127], [0.6172, 0.7954], [0.3209, 0.3508], [0.7691, 0.1096], [0.843, 0.2528], [0.6275, 0.5153], [0.235, 0.4778], [0.8077, 0.4157], [0.7784, 0.5822], [0.5379, 0.4524], [0.1028, 0.3069]]])
w[1] = np.array([[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]])
model.get_layer('Loc13812').set_weights(w) 
w = model.get_layer('GRU38646').get_weights() 
w[0] = np.array([[2, 6, 2, 5, 10, 5], [7, 10, 6, 5, 10, 5], [5, 1, 8, 3, 5, 9], [5, 7, 7, 4, 7, 4], [6, 4, 4, 4, 4, 9], [9, 5, 10, 10, 4, 10], [8, 2, 9, 4, 1, 5], [10, 6, 7, 3, 7, 5], [1, 10, 5, 6, 2, 7], [2, 10, 6, 9, 10, 8], [3, 5, 8, 1, 6, 9], [2, 1, 3, 6, 2, 10], [5, 8, 10, 10, 8, 1], [7, 9, 6, 4, 9, 1], [9, 4, 7, 8, 9, 5], [8, 1, 8, 3, 1, 8], [2, 9, 3, 1, 4, 9], [1, 8, 8, 3, 10, 4]])
w[1] = np.array([[1, 5, 1, 7, 7, 4], [5, 10, 7, 8, 9, 5]])
w[2] = np.array([[4, 9, 5, 6, 3, 3], [10, 7, 5, 3, 5, 10]])
model.get_layer('GRU38646').set_weights(w) 
in0Add86203 = tf.constant([[[[0.2216]]]])
in1Add86203 = tf.constant([[[[0.1251]]]])
in0Zer40403 = tf.constant([[[[[1.7546]], [[1.3084]], [[1.9481]], [[1.8068]]], [[[1.0018]], [[1.8287]], [[1.5088]], [[1.505]]]]])
print (np.array2string(model.predict([in0Add86203,in1Add86203,in0Zer40403],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU38646.png')

LAdd86203 = add_layer([[[[[0.2216]]]], [[[[0.1251]]]]], Add86203), 
LRes5999 = reshape_layer(Add86203, [1, 1, 1, 1], Res5999), 
LCon95358 = conv3D_transpose_layer(Res5999, 1, 1, 1,[[[[[0.2558], [0.0899], [0.8204], [0.9383]]]]],[0, 0, 0, 0], 1, 9, 1, true, Con95358), 
LRes33495 = reshape_layer(Con95358, [1, 9, 4], Res33495), 
LLoc13812 = locally_connected2D_layer(Res33495, 1, 5,[[[0.5662, 0.0364], [0.0839, 0.354], [0.883, 0.6435], [0.0142, 0.2886], [0.5231, 0.1235], [0.8794, 0.7047], [0.0847, 0.4951], [0.2401, 0.0249], [0.7621, 0.7029], [0.4535, 0.1708], [0.7468, 0.144], [0.427, 0.2564], [0.408, 0.912], [0.8718, 0.8762], [0.5817, 0.8698], [0.0567, 0.7429], [0.7405, 0.6168], [0.3315, 0.3352], [0.1645, 0.5175], [0.3691, 0.7734]], [[0.4891, 0.2253], [0.1538, 0.3577], [0.165, 0.5526], [0.2386, 0.077], [0.4364, 0.1133], [0.6827, 0.922], [0.4127, 0.8951], [0.3895, 0.0236], [0.6926, 0.8086], [0.2668, 0.4753], [0.7838, 0.3014], [0.75, 0.1996], [0.254, 0.327], [0.7481, 0.3671], [0.148, 0.3157], [0.9959, 0.6896], [0.7101, 0.3048], [0.136, 0.3741], [0.8631, 0.0577], [0.5849, 0.645]], [[0.2107, 0.8228], [0.3901, 0.5219], [0.5563, 0.3687], [0.8325, 0.9737], [0.0583, 0.0662], [0.4887, 0.6619], [0.1807, 0.0839], [0.8299, 0.2309], [0.5378, 0.2142], [0.2084, 0.5095], [0.5834, 0.4509], [0.2541, 0.0441], [0.8463, 0.2053], [0.2913, 0.1019], [0.0769, 0.9643], [0.3727, 0.6548], [0.2387, 0.2708], [0.924, 0.8807], [0.748, 0.1359], [0.7928, 0.4069]], [[0.7492, 0.3835], [0.7064, 0.8577], [0.496, 0.9688], [0.7545, 0.2669], [0.1042, 0.0135], [0.5338, 0.5711], [0.0365, 0.1574], [0.0211, 0.7045], [0.6895, 0.8381], [0.0696, 0.7876], [0.3594, 0.2799], [0.6664, 0.5187], [0.6841, 0.2982], [0.734, 0.1594], [0.3801, 0.5056], [0.3082, 0.4391], [0.7252, 0.1474], [0.3847, 0.2912], [0.7712, 0.5837], [0.5917, 0.5865]], [[0.7166, 0.3876], [0.1138, 0.9261], [0.2138, 0.1366], [0.9711, 0.1224], [0.6447, 0.2347], [0.84, 0.2056], [0.5559, 0.5232], [0.0914, 0.672], [0.5144, 0.0116], [0.6178, 0.2127], [0.6172, 0.7954], [0.3209, 0.3508], [0.7691, 0.1096], [0.843, 0.2528], [0.6275, 0.5153], [0.235, 0.4778], [0.8077, 0.4157], [0.7784, 0.5822], [0.5379, 0.4524], [0.1028, 0.3069]]],[[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0]]], 1, 1, Loc13812), 
LRes13374 = reshape_layer(Loc13812, [1, 5, 2, 1], Res13374), 
LZer44160 = zero_padding3D_layer(Res13374, 3, 0, 1, 0, 1, 0, Zer44160), 
LZer40403 = zero_padding3D_layer([[[[[1.7546]], [[1.3084]], [[1.9481]], [[1.8068]]], [[[1.0018]], [[1.8287]], [[1.5088]], [[1.505]]]]], 1, 1, 1, 1, 1, 1, Zer40403), 
LAdd27936 = add_layer([Zer44160,Zer40403], Add27936), 
LRes27801 = reshape_layer(Add27936, [4, 6, 3], Res27801), 
LRes59197 = reshape_layer(Res27801, [4, 18], Res59197), 
LGRU38646 = gru_layer(Res59197,[[2, 6, 2, 5, 10, 5], [7, 10, 6, 5, 10, 5], [5, 1, 8, 3, 5, 9], [5, 7, 7, 4, 7, 4], [6, 4, 4, 4, 4, 9], [9, 5, 10, 10, 4, 10], [8, 2, 9, 4, 1, 5], [10, 6, 7, 3, 7, 5], [1, 10, 5, 6, 2, 7], [2, 10, 6, 9, 10, 8], [3, 5, 8, 1, 6, 9], [2, 1, 3, 6, 2, 10], [5, 8, 10, 10, 8, 1], [7, 9, 6, 4, 9, 1], [9, 4, 7, 8, 9, 5], [8, 1, 8, 3, 1, 8], [2, 9, 3, 1, 4, 9], [1, 8, 8, 3, 10, 4]],[[1, 5, 1, 7, 7, 4], [5, 10, 7, 8, 9, 5]],[[4, 9, 5, 6, 3, 3], [10, 7, 5, 3, 5, 10]], true, GRU38646), 
exec_layers([LAdd86203,LRes5999,LCon95358,LRes33495,LLoc13812,LRes13374,LZer44160,LZer40403,LAdd27936,LRes27801,LRes59197,LGRU38646],["Add86203","Res5999","Con95358","Res33495","Loc13812","Res13374","Zer44160","Zer40403","Add27936","Res27801","Res59197","GRU38646"],GRU38646,"GRU38646")

Actual (Unparsed): [[0.0000008, 0.0000001]]

Expected (Unparsed): [[8.410254961331146e-7,1.2017181641443003e-7]]

Actual:   [[0, 0]]

Expected: [[0, 0]]