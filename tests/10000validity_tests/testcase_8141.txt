import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep72794 = tf.keras.layers.Input(shape=([2, 1, 2]))

Sep72794 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep72794', )(in0Sep72794)
Res20727 = keras.layers.Reshape((2, 2), name = 'Res20727', )(Sep72794)
GRU97722 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU97722', )(Res20727)
model = tf.keras.models.Model(inputs=[in0Sep72794], outputs=GRU97722)
w = model.get_layer('Sep72794').get_weights() 
w[0] = np.array([[[[0.1939], [0.0189]]]])
w[1] = np.array([[[[0.4009, 0.7323], [0.0145, 0.7732]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep72794').set_weights(w) 
w = model.get_layer('GRU97722').get_weights() 
w[0] = np.array([[1, 1, 6, 4, 3, 3, 4, 4, 7], [8, 7, 10, 5, 8, 6, 7, 1, 3]])
w[1] = np.array([[7, 10, 8, 6, 3, 2, 4, 2, 3], [5, 6, 1, 9, 7, 6, 6, 7, 2], [2, 8, 6, 2, 5, 6, 9, 6, 10]])
w[2] = np.array([[10, 3, 1, 1, 10, 10, 2, 10, 4], [4, 6, 6, 5, 5, 5, 1, 1, 5]])
model.get_layer('GRU97722').set_weights(w) 
in0Sep72794 = tf.constant([[[[0.8085, 0.687]], [[0.6184, 0.9025]]]])
print (np.array2string(model.predict([in0Sep72794],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU97722.png')

LSep72794 = separable_conv2D_layer([[[[0.8085, 0.687]], [[0.6184, 0.9025]]]], 1, 1,[[[[[0.1939], [0.0189]]]],[[[[0.4009, 0.7323], [0.0145, 0.7732]]]]],[0, 0], 1, 1, false, Sep72794), 
LRes20727 = reshape_layer(Sep72794, [2, 2], Res20727), 
LGRU97722 = gru_layer(Res20727,[[1, 1, 6, 4, 3, 3, 4, 4, 7], [8, 7, 10, 5, 8, 6, 7, 1, 3]],[[7, 10, 8, 6, 3, 2, 4, 2, 3], [5, 6, 1, 9, 7, 6, 6, 7, 2], [2, 8, 6, 2, 5, 6, 9, 6, 10]],[[10, 3, 1, 1, 10, 10, 2, 10, 4], [4, 6, 6, 5, 5, 5, 1, 1, 5]], true, GRU97722), 
exec_layers([LSep72794,LRes20727,LGRU97722],["Sep72794","Res20727","GRU97722"],GRU97722,"GRU97722")

Actual (Unparsed): [[0.0000006, 0.0001062, 0.0004274]]

Expected (Unparsed): [[6.401072270956191e-7,0.00010623399963992922,0.000427396571252938]]

Actual:   [[0, 0.0002, 0.0005]]

Expected: [[0, 0.0002, 0.0005]]