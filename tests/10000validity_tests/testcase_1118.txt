import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min4156 = tf.keras.layers.Input(shape=([1, 1]))
in1Min4156 = tf.keras.layers.Input(shape=([1, 1]))
in0Con40943 = tf.keras.layers.Input(shape=([1, 4, 4, 3]))
in0Up_35258 = tf.keras.layers.Input(shape=([1, 4, 2, 4]))

Min4156 = keras.layers.Minimum(name = 'Min4156', )([in0Min4156,in1Min4156])
Res94916 = keras.layers.Reshape((1, 1, 1), name = 'Res94916', )(Min4156)
Res73420 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res73420', )(Res94916)
Zer28935 = keras.layers.ZeroPadding3D(padding=((0, 0), (3, 0), (3, 0)), name = 'Zer28935', )(Res73420)
Con40943 = keras.layers.Concatenate(axis=4, name = 'Con40943', )([Zer28935,in0Con40943])
Up_35258 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_35258', )(in0Up_35258)
Sub39990 = keras.layers.Subtract(name = 'Sub39990', )([Con40943,Up_35258])
model = tf.keras.models.Model(inputs=[in0Min4156,in1Min4156,in0Con40943,in0Up_35258], outputs=Sub39990)
in0Min4156 = tf.constant([[[0.2911]]])
in1Min4156 = tf.constant([[[0.0145]]])
in0Con40943 = tf.constant([[[[[0.0634, 0.8631, 0.9242], [0.0374, 0.4526, 0.9702], [0.8865, 0.4153, 0.7981], [0.3863, 0.6969, 0.4079]], [[0.4335, 0.8156, 0.587], [0.1461, 0.936, 0.4265], [0.2812, 0.2106, 0.2633], [0.6036, 0.4478, 0.5679]], [[0.1798, 0.251, 0.5028], [0.3773, 0.5459, 0.2978], [0.0669, 0.7067, 0.4738], [0.3674, 0.3811, 0.2048]], [[0.1833, 0.5372, 0.8968], [0.9502, 0.6327, 0.7378], [0.0737, 0.0192, 0.6437], [0.619, 0.1438, 0.7991]]]]])
in0Up_35258 = tf.constant([[[[[1.2341, 1.9963, 1.9224, 1.0898], [1.1811, 1.3006, 1.7299, 1.8512]], [[1.8032, 1.5681, 1.396, 1.8371], [1.8402, 1.4041, 1.3797, 1.8929]], [[1.8285, 1.465, 1.5398, 1.0285], [1.0538, 1.9657, 1.4919, 1.503]], [[1.0716, 1.7687, 1.8758, 1.8173], [1.0521, 1.653, 1.0639, 1.6364]]]]])
print (np.array2string(model.predict([in0Min4156,in1Min4156,in0Con40943,in0Up_35258],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub39990.png')

LMin4156 = minimum_layer([[[[0.2911]]], [[[0.0145]]]], Min4156), 
LRes94916 = reshape_layer(Min4156, [1, 1, 1], Res94916), 
LRes73420 = reshape_layer(Res94916, [1, 1, 1, 1], Res73420), 
LZer28935 = zero_padding3D_layer(Res73420, 0, 0, 3, 0, 3, 0, Zer28935), 
LCon40943 = concatenate_layer([Zer28935,[[[[[0.0634, 0.8631, 0.9242], [0.0374, 0.4526, 0.9702], [0.8865, 0.4153, 0.7981], [0.3863, 0.6969, 0.4079]], [[0.4335, 0.8156, 0.587], [0.1461, 0.936, 0.4265], [0.2812, 0.2106, 0.2633], [0.6036, 0.4478, 0.5679]], [[0.1798, 0.251, 0.5028], [0.3773, 0.5459, 0.2978], [0.0669, 0.7067, 0.4738], [0.3674, 0.3811, 0.2048]], [[0.1833, 0.5372, 0.8968], [0.9502, 0.6327, 0.7378], [0.0737, 0.0192, 0.6437], [0.619, 0.1438, 0.7991]]]]]], 4, Con40943), 
LUp_35258 = up_sampling3D_layer([[[[[1.2341, 1.9963, 1.9224, 1.0898], [1.1811, 1.3006, 1.7299, 1.8512]], [[1.8032, 1.5681, 1.396, 1.8371], [1.8402, 1.4041, 1.3797, 1.8929]], [[1.8285, 1.465, 1.5398, 1.0285], [1.0538, 1.9657, 1.4919, 1.503]], [[1.0716, 1.7687, 1.8758, 1.8173], [1.0521, 1.653, 1.0639, 1.6364]]]]], 1, 1, 2, Up_35258), 
LSub39990 = subtract_layer(Con40943,Up_35258, Sub39990), 
exec_layers([LMin4156,LRes94916,LRes73420,LZer28935,LCon40943,LUp_35258,LSub39990],["Min4156","Res94916","Res73420","Zer28935","Con40943","Up_35258","Sub39990"],Sub39990,"Sub39990")

Actual (Unparsed): [[[[[-1.2341000, -1.9329000, -1.0593000, -0.1656000], [-1.2341000, -1.9589000, -1.4698000, -0.1196000], [-1.1811000, -0.4141001, -1.3146000, -1.0531000], [-1.1811000, -0.9143001, -1.0330000, -1.4433000]], [[-1.8032000, -1.1346000, -0.5804000, -1.2501000], [-1.8032000, -1.4220000, -0.4600000, -1.4106000], [-1.8401999, -1.1228999, -1.1690999, -1.6296000], [-1.8401999, -0.8004999, -0.9318999, -1.3250000]], [[-1.8285000, -1.2852000, -1.2888001, -0.5257000], [-1.8285000, -1.0877000, -0.9939001, -0.7307000], [-1.0538000, -1.8988000, -0.7851999, -1.0292000], [-1.0538000, -1.5983000, -1.1108000, -1.2982000]], [[-1.0716000, -1.5854000, -1.3386000, -0.9205000], [-1.0716000, -0.8185000, -1.2431000, -1.0795000], [-1.0520999, -1.5793000, -1.0447000, -0.9927000], [-1.0375999, -1.0340000, -0.9201000, -0.8373000]]]]]

Expected (Unparsed): [[[[[-1.2341,-1.9329,-1.0593000000000001,-0.16560000000000008],[-1.2341,-1.9588999999999999,-1.4698000000000002,-0.11960000000000015],[-1.1811,-0.4141,-1.3146,-1.0531],[-1.1811,-0.9143,-1.033,-1.4433]],[[-1.8032,-1.1346,-0.5803999999999999,-1.2501],[-1.8032,-1.4220000000000002,-0.45999999999999985,-1.4106],[-1.8402,-1.1229,-1.1690999999999998,-1.6296],[-1.8402,-0.8004999999999999,-0.9319,-1.3250000000000002]],[[-1.8285,-1.2852000000000001,-1.2888000000000002,-0.5257],[-1.8285,-1.0877000000000001,-0.9939,-0.7306999999999999],[-1.0538,-1.8988,-0.7852,-1.0292],[-1.0538,-1.5983,-1.1108,-1.2981999999999998]],[[-1.0716,-1.5854,-1.3386,-0.9204999999999999],[-1.0716,-0.8184999999999999,-1.2430999999999999,-1.0795],[-1.0521,-1.5793,-1.0447,-0.9927],[-1.0376,-1.034,-0.9201,-0.8373]]]]]

Actual:   [[[[[-1.2341, -1.9329, -1.0593, -0.1656], [-1.2341, -1.9589, -1.4698, -0.1196], [-1.1811, -0.4141, -1.3146, -1.0531], [-1.1811, -0.9143, -1.033, -1.4433]], [[-1.8032, -1.1346, -0.5804, -1.2501], [-1.8032, -1.422, -0.46, -1.4106], [-1.8401, -1.1228, -1.169, -1.6296], [-1.8401, -0.8004, -0.9318, -1.325]], [[-1.8285, -1.2852, -1.2888, -0.5257], [-1.8285, -1.0877, -0.9939, -0.7307], [-1.0538, -1.8988, -0.7851, -1.0292], [-1.0538, -1.5983, -1.1108, -1.2982]], [[-1.0716, -1.5854, -1.3386, -0.9205], [-1.0716, -0.8185, -1.2431, -1.0795], [-1.052, -1.5793, -1.0447, -0.9927], [-1.0375, -1.034, -0.9201, -0.8373]]]]]

Expected: [[[[[-1.2341, -1.9329, -1.0593, -0.1656], [-1.2341, -1.9588, -1.4698, -0.1196], [-1.1811, -0.4141, -1.3146, -1.0531], [-1.1811, -0.9143, -1.033, -1.4433]], [[-1.8032, -1.1346, -0.5803, -1.2501], [-1.8032, -1.422, -0.4599, -1.4106], [-1.8402, -1.1229, -1.169, -1.6296], [-1.8402, -0.8004, -0.9319, -1.325]], [[-1.8285, -1.2852, -1.2888, -0.5257], [-1.8285, -1.0877, -0.9939, -0.7306], [-1.0538, -1.8988, -0.7852, -1.0292], [-1.0538, -1.5983, -1.1108, -1.2981]], [[-1.0716, -1.5854, -1.3386, -0.9204], [-1.0716, -0.8184, -1.243, -1.0795], [-1.0521, -1.5793, -1.0447, -0.9927], [-1.0376, -1.034, -0.9201, -0.8373]]]]]