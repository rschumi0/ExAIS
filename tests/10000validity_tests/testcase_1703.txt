import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub99213 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub99213 = tf.keras.layers.Input(shape=([2, 2]))
in0PRe6455 = tf.keras.layers.Input(shape=([1, 2, 1]))

Sub99213 = keras.layers.Subtract(name = 'Sub99213', )([in0Sub99213,in1Sub99213])
Res59945 = keras.layers.Reshape((2, 2, 1), name = 'Res59945', )(Sub99213)
PRe6455 = keras.layers.PReLU(name = 'PRe6455', input_shape=(1, 2, 1))(in0PRe6455)
Zer48380 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer48380', )(PRe6455)
Sub1010 = keras.layers.Subtract(name = 'Sub1010', )([Res59945,Zer48380])
Res53245 = keras.layers.Reshape((2, 2), name = 'Res53245', )(Sub1010)
Cro32358 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro32358', )(Res53245)
model = tf.keras.models.Model(inputs=[in0Sub99213,in1Sub99213,in0PRe6455], outputs=Cro32358)
w = model.get_layer('PRe6455').get_weights() 
w[0] = np.array([[[0.4273], [0.2162]]])
model.get_layer('PRe6455').set_weights(w) 
in0Sub99213 = tf.constant([[[0.5139, 0.4955], [0.6277, 0.2658]]])
in1Sub99213 = tf.constant([[[0.9345, 0.7078], [0.2013, 0.4748]]])
in0PRe6455 = tf.constant([[[[0.4628], [0.8447]]]])
print (np.array2string(model.predict([in0Sub99213,in1Sub99213,in0PRe6455],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro32358.png')

LSub99213 = subtract_layer([[[0.5139, 0.4955], [0.6277, 0.2658]]], [[[0.9345, 0.7078], [0.2013, 0.4748]]], Sub99213), 
LRes59945 = reshape_layer(Sub99213, [2, 2, 1], Res59945), 
LPRe6455 = prelu_layer([[[[0.4628], [0.8447]]]], [[[0.4273], [0.2162]]], PRe6455), 
LZer48380 = zero_padding2D_layer(PRe6455, 1, 0, 0, 0, Zer48380), 
LSub1010 = subtract_layer(Res59945,Zer48380, Sub1010), 
LRes53245 = reshape_layer(Sub1010, [2, 2], Res53245), 
LCro32358 = cropping1D_layer(Res53245, 0, 1, Cro32358), 
exec_layers([LSub99213,LRes59945,LPRe6455,LZer48380,LSub1010,LRes53245,LCro32358],["Sub99213","Res59945","PRe6455","Zer48380","Sub1010","Res53245","Cro32358"],Cro32358,"Cro32358")

Actual (Unparsed): [[[-0.4206000, -0.2123000]]]

Expected (Unparsed): [[[-0.4206,-0.2123]]]

Actual:   [[[-0.4206, -0.2123]]]

Expected: [[[-0.4206, -0.2123]]]