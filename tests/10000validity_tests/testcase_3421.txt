import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul30358 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul30358 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0PRe4832 = tf.keras.layers.Input(shape=([2, 1]))
in0Con36932 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul97985 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul97985 = tf.keras.layers.Input(shape=([1, 1]))
in0Con26427 = tf.keras.layers.Input(shape=([2, 1]))

Mul30358 = keras.layers.Multiply(name = 'Mul30358', )([in0Mul30358,in1Mul30358])
Res39354 = keras.layers.Reshape((2, 2), name = 'Res39354', )(Mul30358)
PRe4832 = keras.layers.PReLU(name = 'PRe4832', input_shape=(2, 1))(in0PRe4832)
Con36932 = keras.layers.Concatenate(axis=2, name = 'Con36932', )([PRe4832,in0Con36932])
Sub81357 = keras.layers.Subtract(name = 'Sub81357', )([Res39354,Con36932])
Mul97985 = keras.layers.Multiply(name = 'Mul97985', )([in0Mul97985,in1Mul97985])
Zer20305 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer20305', )(Mul97985)
Con26427 = keras.layers.Concatenate(axis=2, name = 'Con26427', )([Zer20305,in0Con26427])
Add81689 = keras.layers.Add(name = 'Add81689', )([Sub81357,Con26427])
model = tf.keras.models.Model(inputs=[in0Mul30358,in1Mul30358,in0PRe4832,in0Con36932,in0Mul97985,in1Mul97985,in0Con26427], outputs=Add81689)
w = model.get_layer('PRe4832').get_weights() 
w[0] = np.array([[0.48], [0.4768]])
model.get_layer('PRe4832').set_weights(w) 
in0Mul30358 = tf.constant([[[[0.8831], [0.4287]], [[0.7986], [0.1624]]]])
in1Mul30358 = tf.constant([[[[0.6611], [0.9411]], [[0.5695], [0.4657]]]])
in0PRe4832 = tf.constant([[[0.8829], [0.383]]])
in0Con36932 = tf.constant([[[0.3969], [0.3307]]])
in0Mul97985 = tf.constant([[[0.6627]]])
in1Mul97985 = tf.constant([[[0.4474]]])
in0Con26427 = tf.constant([[[0.9014], [0.3926]]])
print (np.array2string(model.predict([in0Mul30358,in1Mul30358,in0PRe4832,in0Con36932,in0Mul97985,in1Mul97985,in0Con26427],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add81689.png')

LMul30358 = multiply_layer([[[[[0.8831], [0.4287]], [[0.7986], [0.1624]]]], [[[[0.6611], [0.9411]], [[0.5695], [0.4657]]]]], Mul30358), 
LRes39354 = reshape_layer(Mul30358, [2, 2], Res39354), 
LPRe4832 = prelu_layer([[[0.8829], [0.383]]], [[0.48], [0.4768]], PRe4832), 
LCon36932 = concatenate_layer([PRe4832,[[[0.3969], [0.3307]]]], 2, Con36932), 
LSub81357 = subtract_layer(Res39354,Con36932, Sub81357), 
LMul97985 = multiply_layer([[[[0.6627]]], [[[0.4474]]]], Mul97985), 
LZer20305 = zero_padding1D_layer(Mul97985, 1, 0, Zer20305), 
LCon26427 = concatenate_layer([Zer20305,[[[0.9014], [0.3926]]]], 2, Con26427), 
LAdd81689 = add_layer([Sub81357,Con26427], Add81689), 
exec_layers([LMul30358,LRes39354,LPRe4832,LCon36932,LSub81357,LMul97985,LZer20305,LCon26427,LAdd81689],["Mul30358","Res39354","PRe4832","Con36932","Sub81357","Mul97985","Zer20305","Con26427","Add81689"],Add81689,"Add81689")

Actual (Unparsed): [[[-0.2990826, 0.9079496], [0.3682947, 0.1375297]]]

Expected (Unparsed): [[[-0.29908259000000004,0.90794957],[0.36829468,0.13752968]]]

Actual:   [[[-0.299, 0.908], [0.3683, 0.1376]]]

Expected: [[[-0.299, 0.908], [0.3683, 0.1376]]]