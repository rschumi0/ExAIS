import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot34228 = tf.keras.layers.Input(shape=([2]))
in1Dot34228 = tf.keras.layers.Input(shape=([2]))

Dot34228 = keras.layers.Dot(axes=(1, 1), name = 'Dot34228', )([in0Dot34228,in1Dot34228])
Res39666 = keras.layers.Reshape((1, 1), name = 'Res39666', )(Dot34228)
Zer90347 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer90347', )(Res39666)
GRU38814 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU38814', )(Zer90347)
Res35765 = keras.layers.Reshape((3, 1), name = 'Res35765', )(GRU38814)
Loc80990 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc80990', )(Res35765)
Res38705 = keras.layers.Reshape((2, 3, 1), name = 'Res38705', )(Loc80990)
Glo85078 = keras.layers.GlobalMaxPool2D(name = 'Glo85078', )(Res38705)
model = tf.keras.models.Model(inputs=[in0Dot34228,in1Dot34228], outputs=Glo85078)
w = model.get_layer('GRU38814').get_weights() 
w[0] = np.array([[3, 8, 6, 4, 4, 2, 3, 2, 5]])
w[1] = np.array([[3, 9, 1, 5, 4, 8, 6, 5, 3], [4, 4, 9, 2, 4, 1, 7, 8, 1], [2, 4, 3, 6, 7, 7, 2, 5, 4]])
w[2] = np.array([[2, 4, 7, 1, 4, 9, 10, 8, 6], [8, 8, 4, 4, 1, 1, 2, 4, 3]])
model.get_layer('GRU38814').set_weights(w) 
w = model.get_layer('Loc80990').get_weights() 
w[0] = np.array([[[0.5835, 0.0537, 0.8075], [0.7407, 0.9326, 0.8622]], [[0.9212, 0.4147, 0.1041], [0.2058, 0.7749, 0.5428]]])
w[1] = np.array([[0, 0, 0], [0, 0, 0]])
model.get_layer('Loc80990').set_weights(w) 
in0Dot34228 = tf.constant([[0.9212, 0.6766]])
in1Dot34228 = tf.constant([[0.8217, 0.5363]])
print (np.array2string(model.predict([in0Dot34228,in1Dot34228],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo85078.png')

LDot34228 = dot_layer([[0.9212, 0.6766]], [[0.8217, 0.5363]], 1, 1, Dot34228), 
LRes39666 = reshape_layer(Dot34228, [1, 1], Res39666), 
LZer90347 = zero_padding1D_layer(Res39666, 3, 0, Zer90347), 
LGRU38814 = gru_layer(Zer90347,[[3, 8, 6, 4, 4, 2, 3, 2, 5]],[[3, 9, 1, 5, 4, 8, 6, 5, 3], [4, 4, 9, 2, 4, 1, 7, 8, 1], [2, 4, 3, 6, 7, 7, 2, 5, 4]],[[2, 4, 7, 1, 4, 9, 10, 8, 6], [8, 8, 4, 4, 1, 1, 2, 4, 3]], true, GRU38814), 
LRes35765 = reshape_layer(GRU38814, [3, 1], Res35765), 
LLoc80990 = locally_connected1D_layer(Res35765, 2,[[[0.5835, 0.0537, 0.8075], [0.7407, 0.9326, 0.8622]], [[0.9212, 0.4147, 0.1041], [0.2058, 0.7749, 0.5428]]],[[0, 0, 0], [0, 0, 0]], 1, Loc80990), 
LRes38705 = reshape_layer(Loc80990, [2, 3, 1], Res38705), 
LGlo85078 = global_max_pool2D_layer(Res38705, Glo85078), 
exec_layers([LDot34228,LRes39666,LZer90347,LGRU38814,LRes35765,LLoc80990,LRes38705,LGlo85078],["Dot34228","Res39666","Zer90347","GRU38814","Res35765","Loc80990","Res38705","Glo85078"],Glo85078,"Glo85078")

Actual (Unparsed): [[0.0001271]]

Expected (Unparsed): [[0.00012710837780169812]]

Actual:   [[0.0002]]

Expected: [[0.0002]]