import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max4930 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max4930 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot53657 = tf.keras.layers.Input(shape=([3]))
in1Dot53657 = tf.keras.layers.Input(shape=([3]))
in0Con41975 = tf.keras.layers.Input(shape=([7]))

Max4930 = keras.layers.Maximum(name = 'Max4930', )([in0Max4930,in1Max4930])
Res68841 = keras.layers.Reshape((2, 4), name = 'Res68841', )(Max4930)
Fla69818 = keras.layers.Flatten(name = 'Fla69818', )(Res68841)
Dot53657 = keras.layers.Dot(axes=(1, 1), name = 'Dot53657', )([in0Dot53657,in1Dot53657])
Con41975 = keras.layers.Concatenate(axis=1, name = 'Con41975', )([Dot53657,in0Con41975])
Max85399 = keras.layers.Maximum(name = 'Max85399', )([Fla69818,Con41975])
Res58289 = keras.layers.Reshape((8, 1), name = 'Res58289', )(Max85399)
Sof17519 = keras.layers.Softmax(axis=1, name = 'Sof17519', )(Res58289)
model = tf.keras.models.Model(inputs=[in0Max4930,in1Max4930,in0Dot53657,in1Dot53657,in0Con41975], outputs=Sof17519)
in0Max4930 = tf.constant([[[[0.8722, 0.801], [0.9457, 0.7218]], [[0.1811, 0.3221], [0.1839, 0.8165]]]])
in1Max4930 = tf.constant([[[[0.5497, 0.4608], [0.7815, 0.4939]], [[0.4488, 0.7672], [0.2172, 0.2223]]]])
in0Dot53657 = tf.constant([[0.0222, 0.1354, 0.6143]])
in1Dot53657 = tf.constant([[0.2947, 0.7148, 0.9108]])
in0Con41975 = tf.constant([[0.376, 0.457, 0.0418, 0.1123, 0.8831, 0.065, 0.1716]])
print (np.array2string(model.predict([in0Max4930,in1Max4930,in0Dot53657,in1Dot53657,in0Con41975],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof17519.png')

LMax4930 = maximum_layer([[[[[0.8722, 0.801], [0.9457, 0.7218]], [[0.1811, 0.3221], [0.1839, 0.8165]]]], [[[[0.5497, 0.4608], [0.7815, 0.4939]], [[0.4488, 0.7672], [0.2172, 0.2223]]]]], Max4930), 
LRes68841 = reshape_layer(Max4930, [2, 4], Res68841), 
LFla69818 = flatten_layer(Res68841, Fla69818), 
LDot53657 = dot_layer([[0.0222, 0.1354, 0.6143]], [[0.2947, 0.7148, 0.9108]], 1, 1, Dot53657), 
LCon41975 = concatenate_layer([Dot53657,[[0.376, 0.457, 0.0418, 0.1123, 0.8831, 0.065, 0.1716]]], 1, Con41975), 
LMax85399 = maximum_layer([Fla69818,Con41975], Max85399), 
LRes58289 = reshape_layer(Max85399, [8, 1], Res58289), 
LSof17519 = softmax_layer(Res58289, 1, Sof17519), 
exec_layers([LMax4930,LRes68841,LFla69818,LDot53657,LCon41975,LMax85399,LRes58289,LSof17519],["Max4930","Res68841","Fla69818","Dot53657","Con41975","Max85399","Res58289","Sof17519"],Sof17519,"Sof17519")

Actual (Unparsed): [[[0.1428786], [0.1330593], [0.1537757], [0.1229276], [0.0935593], [0.1444445], [0.0742172], [0.1351378]]]

Expected (Unparsed): [[[0.14287859311034667],[0.1330593501516971],[0.15377573432861147],[0.12292756388939347],[0.09355928227701238],[0.14444448840094565],[0.07421715110477409],[0.1351378367372193]]]

Actual:   [[[0.1429], [0.1331], [0.1538], [0.123], [0.0936], [0.1445], [0.0743], [0.1352]]]

Expected: [[[0.1429], [0.1331], [0.1538], [0.123], [0.0936], [0.1445], [0.0743], [0.1352]]]