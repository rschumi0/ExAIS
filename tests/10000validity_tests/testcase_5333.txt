import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo75898 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Min94432 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min94432 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Dot3446 = tf.keras.layers.Input(shape=([2]))
in1Dot3446 = tf.keras.layers.Input(shape=([2]))
in0Con41733 = tf.keras.layers.Input(shape=([1]))
in0Con74457 = tf.keras.layers.Input(shape=([3]))
in0Con68680 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0LST25873 = tf.keras.layers.Input(shape=([1, 2]))
in0Con94902 = tf.keras.layers.Input(shape=([3]))

Glo75898 = keras.layers.GlobalMaxPool3D(name = 'Glo75898', )(in0Glo75898)
Res28872 = keras.layers.Reshape((1, 1), name = 'Res28872', )(Glo75898)
Res44517 = keras.layers.Reshape((1, 1, 1), name = 'Res44517', )(Res28872)
Zer51876 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer51876', )(Res44517)
Min94432 = keras.layers.Minimum(name = 'Min94432', )([in0Min94432,in1Min94432])
Sub26159 = keras.layers.Subtract(name = 'Sub26159', )([Zer51876,Min94432])
Res98809 = keras.layers.Reshape((2, 1), name = 'Res98809', )(Sub26159)
Fla73581 = keras.layers.Flatten(name = 'Fla73581', )(Res98809)
Dot3446 = keras.layers.Dot(axes=(1, 1), name = 'Dot3446', )([in0Dot3446,in1Dot3446])
Con41733 = keras.layers.Concatenate(axis=1, name = 'Con41733', )([Dot3446,in0Con41733])
Sub8059 = keras.layers.Subtract(name = 'Sub8059', )([Fla73581,Con41733])
Res9725 = keras.layers.Reshape((2, 1), name = 'Res9725', )(Sub8059)
Res27625 = keras.layers.Reshape((2, 1, 1), name = 'Res27625', )(Res9725)
Cro73162 = keras.layers.Cropping2D(cropping=((0, 1), (0, 0)), name = 'Cro73162', )(Res27625)
Res1927 = keras.layers.Reshape((1, 1), name = 'Res1927', )(Cro73162)
Fla55600 = keras.layers.Flatten(name = 'Fla55600', )(Res1927)
Con74457 = keras.layers.Concatenate(axis=1, name = 'Con74457', )([Fla55600,in0Con74457])
Con68680 = keras.layers.Conv2DTranspose(2, (1, 2),strides=(1, 1), padding='same', name = 'Con68680', )(in0Con68680)
Res36171 = keras.layers.Reshape((1, 4), name = 'Res36171', )(Con68680)
Fla82393 = keras.layers.Flatten(name = 'Fla82393', )(Res36171)
LST25873 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST25873', )(in0LST25873)
Con94902 = keras.layers.Concatenate(axis=1, name = 'Con94902', )([LST25873,in0Con94902])
Sub29336 = keras.layers.Subtract(name = 'Sub29336', )([Fla82393,Con94902])
Sub88128 = keras.layers.Subtract(name = 'Sub88128', )([Con74457,Sub29336])
model = tf.keras.models.Model(inputs=[in0Glo75898,in0Min94432,in1Min94432,in0Dot3446,in1Dot3446,in0Con41733,in0Con74457,in0Con68680,in0LST25873,in0Con94902], outputs=Sub88128)
w = model.get_layer('Con68680').get_weights() 
w[0] = np.array([[[[0.8535, 0.2762], [0.3892, 0.5189]], [[0.4828, 0.9426], [0.6629, 0.4183]]]])
w[1] = np.array([0, 0])
model.get_layer('Con68680').set_weights(w) 
w = model.get_layer('LST25873').get_weights() 
w[0] = np.array([[9, 8, 3, 6], [8, 3, 1, 9]])
w[1] = np.array([[8, 8, 2, 8]])
w[2] = np.array([4, 6, 1, 2])
model.get_layer('LST25873').set_weights(w) 
in0Glo75898 = tf.constant([[[[[1.0943], [1.8981]]]]])
in0Min94432 = tf.constant([[[[0.1773]], [[0.2302]]]])
in1Min94432 = tf.constant([[[[0.5541]], [[0.1344]]]])
in0Dot3446 = tf.constant([[0.4324, 0.4849]])
in1Dot3446 = tf.constant([[0.2559, 0.6093]])
in0Con41733 = tf.constant([[0.5807]])
in0Con74457 = tf.constant([[0.7792, 0.3897, 0.6211]])
in0Con68680 = tf.constant([[[[0.3802, 0.1606], [0.6733, 0.5892]]]])
in0LST25873 = tf.constant([[[7, 9]]])
in0Con94902 = tf.constant([[0.0454, 0.0207, 0.7438]])
print (np.array2string(model.predict([in0Glo75898,in0Min94432,in1Min94432,in0Dot3446,in1Dot3446,in0Con41733,in0Con74457,in0Con68680,in0LST25873,in0Con94902],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub88128.png')

LGlo75898 = global_max_pool3D_layer([[[[[1.0943], [1.8981]]]]], Glo75898), 
LRes28872 = reshape_layer(Glo75898, [1, 1], Res28872), 
LRes44517 = reshape_layer(Res28872, [1, 1, 1], Res44517), 
LZer51876 = zero_padding2D_layer(Res44517, 1, 0, 0, 0, Zer51876), 
LMin94432 = minimum_layer([[[[[0.1773]], [[0.2302]]]], [[[[0.5541]], [[0.1344]]]]], Min94432), 
LSub26159 = subtract_layer(Zer51876,Min94432, Sub26159), 
LRes98809 = reshape_layer(Sub26159, [2, 1], Res98809), 
LFla73581 = flatten_layer(Res98809, Fla73581), 
LDot3446 = dot_layer([[0.4324, 0.4849]], [[0.2559, 0.6093]], 1, 1, Dot3446), 
LCon41733 = concatenate_layer([Dot3446,[[0.5807]]], 1, Con41733), 
LSub8059 = subtract_layer(Fla73581,Con41733, Sub8059), 
LRes9725 = reshape_layer(Sub8059, [2, 1], Res9725), 
LRes27625 = reshape_layer(Res9725, [2, 1, 1], Res27625), 
LCro73162 = cropping2D_layer(Res27625, 0, 1, 0, 0, Cro73162), 
LRes1927 = reshape_layer(Cro73162, [1, 1], Res1927), 
LFla55600 = flatten_layer(Res1927, Fla55600), 
LCon74457 = concatenate_layer([Fla55600,[[0.7792, 0.3897, 0.6211]]], 1, Con74457), 
LCon68680 = conv2D_transpose_layer([[[[0.3802, 0.1606], [0.6733, 0.5892]]]], 1, 2,[[[[0.8535, 0.2762], [0.3892, 0.5189]], [[0.4828, 0.9426], [0.6629, 0.4183]]]],[0, 0], 1, 1, true, Con68680), 
LRes36171 = reshape_layer(Con68680, [1, 4], Res36171), 
LFla82393 = flatten_layer(Res36171, Fla82393), 
LLST25873 = lstm_layer([[[7, 9]]],[[9, 8, 3, 6], [8, 3, 1, 9]],[[8, 8, 2, 8]],[4, 6, 1, 2], LST25873), 
LCon94902 = concatenate_layer([LST25873,[[0.0454, 0.0207, 0.7438]]], 1, Con94902), 
LSub29336 = subtract_layer(Fla82393,Con94902, Sub29336), 
LSub88128 = subtract_layer(Con74457,Sub29336, Sub88128), 
exec_layers([LGlo75898,LRes28872,LRes44517,LZer51876,LMin94432,LSub26159,LRes98809,LFla73581,LDot3446,LCon41733,LSub8059,LRes9725,LRes27625,LCro73162,LRes1927,LFla55600,LCon74457,LCon68680,LRes36171,LFla82393,LLST25873,LCon94902,LSub29336,LSub88128],["Glo75898","Res28872","Res44517","Zer51876","Min94432","Sub26159","Res98809","Fla73581","Dot3446","Con41733","Sub8059","Res9725","Res27625","Cro73162","Res1927","Fla55600","Con74457","Con68680","Res36171","Fla82393","LST25873","Con94902","Sub29336","Sub88128"],Sub88128,"Sub88128")

Actual (Unparsed): [[-0.1906650, 0.5932908, -0.6619407, 0.4779022]]

Expected (Unparsed): [[-0.19066499404423515,0.59329082,-0.6619407100000003,0.47790219999999994]]

Actual:   [[-0.1906, 0.5933, -0.6619, 0.478]]

Expected: [[-0.1906, 0.5933, -0.6619, 0.478]]