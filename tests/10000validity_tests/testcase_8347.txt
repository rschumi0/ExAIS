import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add12515 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Add12515 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con66920 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Add48099 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Add48099 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Add12515 = keras.layers.Add(name = 'Add12515', )([in0Add12515,in1Add12515])
Ave32378 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave32378', )(Add12515)
Res36293 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res36293', )(Ave32378)
Con66920 = keras.layers.Concatenate(axis=4, name = 'Con66920', )([Res36293,in0Con66920])
Add48099 = keras.layers.Add(name = 'Add48099', )([in0Add48099,in1Add48099])
Zer87758 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer87758', )(Add48099)
Min54706 = keras.layers.Minimum(name = 'Min54706', )([Con66920,Zer87758])
Glo31733 = keras.layers.GlobalAveragePooling3D(name = 'Glo31733', )(Min54706)
Mas37581 = keras.layers.Masking(mask_value=2, name = 'Mas37581', )(Glo31733)
model = tf.keras.models.Model(inputs=[in0Add12515,in1Add12515,in0Con66920,in0Add48099,in1Add48099], outputs=Mas37581)
in0Add12515 = tf.constant([[[[0.3007, 0.4224], [0.7417, 0.4617]], [[0.8832, 0.6695], [0.787, 0.481]]]])
in1Add12515 = tf.constant([[[[0.8104, 0.7443], [0.0035, 0.4251]], [[0.6826, 0.5744], [0.1719, 0.0908]]]])
in0Con66920 = tf.constant([[[[[0.1467], [0.8689]], [[0.8465], [0.0877]]], [[[0.6271], [0.472]], [[0.022], [0.7443]]]]])
in0Add48099 = tf.constant([[[[[0.3934, 0.5579], [0.235, 0.3798]]], [[[0.2484, 0.1434], [0.0842, 0.7863]]]]])
in1Add48099 = tf.constant([[[[[0.2614, 0.844], [0.0206, 0.0044]]], [[[0.5198, 0.0448], [0.8977, 0.2084]]]]])
print (np.array2string(model.predict([in0Add12515,in1Add12515,in0Con66920,in0Add48099,in1Add48099],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas37581.png')

LAdd12515 = add_layer([[[[[0.3007, 0.4224], [0.7417, 0.4617]], [[0.8832, 0.6695], [0.787, 0.481]]]], [[[[0.8104, 0.7443], [0.0035, 0.4251]], [[0.6826, 0.5744], [0.1719, 0.0908]]]]], Add12515), 
LAve32378 = average_pooling2D_layer(Add12515, 1, 1, Ave32378), 
LRes36293 = reshape_layer(Ave32378, [2, 2, 2, 1], Res36293), 
LCon66920 = concatenate_layer([Res36293,[[[[[0.1467], [0.8689]], [[0.8465], [0.0877]]], [[[0.6271], [0.472]], [[0.022], [0.7443]]]]]], 4, Con66920), 
LAdd48099 = add_layer([[[[[[0.3934, 0.5579], [0.235, 0.3798]]], [[[0.2484, 0.1434], [0.0842, 0.7863]]]]], [[[[[0.2614, 0.844], [0.0206, 0.0044]]], [[[0.5198, 0.0448], [0.8977, 0.2084]]]]]], Add48099), 
LZer87758 = zero_padding3D_layer(Add48099, 0, 0, 1, 0, 0, 0, Zer87758), 
LMin54706 = minimum_layer([Con66920,Zer87758], Min54706), 
LGlo31733 = global_average_pooling3D_layer(Min54706, Glo31733), 
LMas37581 = masking_layer(Glo31733, 2, Mas37581), 
exec_layers([LAdd12515,LAve32378,LRes36293,LCon66920,LAdd48099,LZer87758,LMin54706,LGlo31733,LMas37581],["Add12515","Ave32378","Res36293","Con66920","Add48099","Zer87758","Min54706","Glo31733","Mas37581"],Mas37581,"Mas37581")

Actual (Unparsed): [[0.2813000, 0.2125625]]

Expected (Unparsed): [[0.2813,0.2125625]]

Actual:   [[0.2813, 0.2126]]

Expected: [[0.2813, 0.2126]]