import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub44046 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub44046 = tf.keras.layers.Input(shape=([2, 2]))

Sub44046 = keras.layers.Subtract(name = 'Sub44046', )([in0Sub44046,in1Sub44046])
Sep26106 = keras.layers.SeparableConv1D(3, (1),strides=(2), padding='same', name = 'Sep26106', )(Sub44046)
Thr5092 = keras.layers.ThresholdedReLU(theta=5.626463187768753, name = 'Thr5092', )(Sep26106)
model = tf.keras.models.Model(inputs=[in0Sub44046,in1Sub44046], outputs=Thr5092)
w = model.get_layer('Sep26106').get_weights() 
w[0] = np.array([[[0.4991], [0.9847]]])
w[1] = np.array([[[0.5327, 0.9024, 0.1391], [0.4079, 0.1407, 0.6392]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep26106').set_weights(w) 
in0Sub44046 = tf.constant([[[0.3493, 0.1551], [0.0844, 0.6162]]])
in1Sub44046 = tf.constant([[[0.8452, 0.6366], [0.2229, 0.8652]]])
print (np.array2string(model.predict([in0Sub44046,in1Sub44046],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr5092.png')

LSub44046 = subtract_layer([[[0.3493, 0.1551], [0.0844, 0.6162]]], [[[0.8452, 0.6366], [0.2229, 0.8652]]], Sub44046), 
LSep26106 = separable_conv1D_layer(Sub44046, 1,[[[[0.4991], [0.9847]]],[[[0.5327, 0.9024, 0.1391], [0.4079, 0.1407, 0.6392]]]],[0, 0, 0], 2, true, Sep26106), 
LThr5092 = thresholded_relu_layer(Sep26106, 5.626463187768753, Thr5092), 
exec_layers([LSub44046,LSep26106,LThr5092],["Sub44046","Sep26106","Thr5092"],Thr5092,"Thr5092")

Actual (Unparsed): [[[-0.0000000, -0.0000000, -0.0000000]]]

Expected (Unparsed): [[[0,0,0]]]

Actual:   [[[-0, -0, -0]]]

Expected: [[[0, 0, 0]]]