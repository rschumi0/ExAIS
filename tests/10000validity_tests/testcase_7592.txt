import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min85252 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min85252 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Zer65455 = tf.keras.layers.Input(shape=([3, 2]))
in0Con13193 = tf.keras.layers.Input(shape=([5, 2]))
in0Zer69510 = tf.keras.layers.Input(shape=([3, 4, 3]))

Min85252 = keras.layers.Minimum(name = 'Min85252', )([in0Min85252,in1Min85252])
Res90816 = keras.layers.Reshape((1, 2), name = 'Res90816', )(Min85252)
Zer62930 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer62930', )(Res90816)
Zer65455 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer65455', )(in0Zer65455)
Sub32896 = keras.layers.Subtract(name = 'Sub32896', )([Zer62930,Zer65455])
Con13193 = keras.layers.Concatenate(axis=2, name = 'Con13193', )([Sub32896,in0Con13193])
Zer69510 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer69510', )(in0Zer69510)
Res91311 = keras.layers.Reshape((5, 18), name = 'Res91311', )(Zer69510)
Con91177 = keras.layers.Conv1D(4, (3),strides=(6), padding='valid', dilation_rate=(1), name = 'Con91177', )(Res91311)
PRe32522 = keras.layers.PReLU(name = 'PRe32522', )(Con91177)
Zer55136 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer55136', )(PRe32522)
Sub47349 = keras.layers.Subtract(name = 'Sub47349', )([Con13193,Zer55136])
model = tf.keras.models.Model(inputs=[in0Min85252,in1Min85252,in0Zer65455,in0Con13193,in0Zer69510], outputs=Sub47349)
w = model.get_layer('Con91177').get_weights() 
w[0] = np.array([[[0.4009, 0.8206, 0.4585, 0.1457], [0.922, 0.0697, 0.7149, 0.7405], [0.5398, 0.3547, 0.7506, 0.4134], [0.1768, 0.8977, 0.3945, 0.2956], [0.8551, 0.864, 0.1924, 0.1175], [0.2536, 0.4145, 0.6414, 0.2124], [0.0456, 0.3548, 0.4873, 0.8513], [0.937, 0.427, 0.111, 0.5359], [0.6417, 0.1168, 0.1784, 0.6552], [0.2545, 0.8288, 0.2759, 0.3465], [0.6117, 0.4204, 0.2165, 0.4902], [0.266, 0.3797, 0.0615, 0.5175], [0.6439, 0.3825, 0.6761, 0.1118], [0.8038, 0.5688, 0.8121, 0.944], [0.9665, 0.6445, 0.2961, 0.2997], [0.6513, 0.8305, 0.8878, 0.8251], [0.8195, 0.7569, 0.7715, 0.6506], [0.8985, 0.634, 0.4437, 0.8318]], [[0.9415, 0.4152, 0.9696, 0.3917], [0.4634, 0.2149, 0.1916, 0.2426], [0.6848, 0.9422, 0.4999, 0.9212], [0.0166, 0.9687, 0.1952, 0.3786], [0.6214, 0.6606, 0.3107, 0.0337], [0.798, 0.7758, 0.9998, 0.9204], [0.7552, 0.0498, 0.2387, 0.0364], [0.0632, 0.7775, 0.6471, 0.938], [0.7004, 0.8336, 0.6889, 0.2138], [0.1497, 0.3724, 0.3754, 0.718], [0.4432, 0.3906, 0.8687, 0.3491], [0.398, 0.4531, 0.0566, 0.7165], [0.5464, 0.134, 0.2532, 0.2558], [0.4191, 0.1526, 0.6715, 0.2233], [0.9133, 0.7541, 0.2065, 0.5313], [0.445, 0.6188, 0.3715, 0.5675], [0.4718, 0.4688, 0.9361, 0.9853], [0.7504, 0.5891, 0.9313, 0.9465]], [[0.3938, 0.6756, 0.2049, 0.4528], [0.3847, 0.7823, 0.6397, 0.2116], [0.7116, 0.6513, 0.4771, 0.9471], [0.702, 0.3783, 0.9317, 0.1907], [0.446, 0.1918, 0.4239, 0.3611], [0.4274, 0.1051, 0.3124, 0.3818], [0.6082, 0.3384, 0.9651, 0.1725], [0.2487, 0.7026, 0.3716, 0.0978], [0.6898, 0.5845, 0.2708, 0.8619], [0.1696, 0.783, 0.9429, 0.3954], [0.5033, 0.206, 0.4013, 0.998], [0.1163, 0.3563, 0.7049, 0.3705], [0.4871, 0.6128, 0.5095, 0.2006], [0.5315, 0.5417, 0.7786, 0.6508], [0.8374, 0.8624, 0.7811, 0.4345], [0.9479, 0.2341, 0.118, 0.1696], [0.0816, 0.7334, 0.5404, 0.3447], [0.777, 0.7443, 0.7486, 0.5506]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con91177').set_weights(w) 
w = model.get_layer('PRe32522').get_weights() 
w[0] = np.array([[0.9552, 0.0007, 0.1952, 0.5875]])
model.get_layer('PRe32522').set_weights(w) 
in0Min85252 = tf.constant([[[[0.4511], [0.4458]]]])
in1Min85252 = tf.constant([[[[0.1101], [0.68]]]])
in0Zer65455 = tf.constant([[[1.096, 1.3599], [1.4551, 1.2512], [1.5556, 1.451]]])
in0Con13193 = tf.constant([[[0.6769, 0.5719], [0.9795, 0.2441], [0.6829, 0.7892], [0.8954, 0.8433], [0.8928, 0.0546]]])
in0Zer69510 = tf.constant([[[[1.8916, 1.6285, 1.8385], [1.0335, 1.7086, 1.1347], [1.6331, 1.5293, 1.4717], [1.7646, 1.8711, 1.9374]], [[1.5547, 1.0141, 1.9636], [1.2671, 1.0613, 1.726], [1.7748, 1.1363, 1.5306], [1.3152, 1.2578, 1.5674]], [[1.2025, 1.7125, 1.8183], [1.3856, 1.7701, 1.3787], [1.8959, 1.5223, 1.4892], [1.7752, 1.9555, 1.9563]]]])
print (np.array2string(model.predict([in0Min85252,in1Min85252,in0Zer65455,in0Con13193,in0Zer69510],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub47349.png')

LMin85252 = minimum_layer([[[[[0.4511], [0.4458]]]], [[[[0.1101], [0.68]]]]], Min85252), 
LRes90816 = reshape_layer(Min85252, [1, 2], Res90816), 
LZer62930 = zero_padding1D_layer(Res90816, 4, 0, Zer62930), 
LZer65455 = zero_padding1D_layer([[[1.096, 1.3599], [1.4551, 1.2512], [1.5556, 1.451]]], 1, 1, Zer65455), 
LSub32896 = subtract_layer(Zer62930,Zer65455, Sub32896), 
LCon13193 = concatenate_layer([Sub32896,[[[0.6769, 0.5719], [0.9795, 0.2441], [0.6829, 0.7892], [0.8954, 0.8433], [0.8928, 0.0546]]]], 2, Con13193), 
LZer69510 = zero_padding2D_layer([[[[1.8916, 1.6285, 1.8385], [1.0335, 1.7086, 1.1347], [1.6331, 1.5293, 1.4717], [1.7646, 1.8711, 1.9374]], [[1.5547, 1.0141, 1.9636], [1.2671, 1.0613, 1.726], [1.7748, 1.1363, 1.5306], [1.3152, 1.2578, 1.5674]], [[1.2025, 1.7125, 1.8183], [1.3856, 1.7701, 1.3787], [1.8959, 1.5223, 1.4892], [1.7752, 1.9555, 1.9563]]]], 1, 1, 1, 1, Zer69510), 
LRes91311 = reshape_layer(Zer69510, [5, 18], Res91311), 
LCon91177 = conv1D_layer(Res91311, 3,[[[0.4009, 0.8206, 0.4585, 0.1457], [0.922, 0.0697, 0.7149, 0.7405], [0.5398, 0.3547, 0.7506, 0.4134], [0.1768, 0.8977, 0.3945, 0.2956], [0.8551, 0.864, 0.1924, 0.1175], [0.2536, 0.4145, 0.6414, 0.2124], [0.0456, 0.3548, 0.4873, 0.8513], [0.937, 0.427, 0.111, 0.5359], [0.6417, 0.1168, 0.1784, 0.6552], [0.2545, 0.8288, 0.2759, 0.3465], [0.6117, 0.4204, 0.2165, 0.4902], [0.266, 0.3797, 0.0615, 0.5175], [0.6439, 0.3825, 0.6761, 0.1118], [0.8038, 0.5688, 0.8121, 0.944], [0.9665, 0.6445, 0.2961, 0.2997], [0.6513, 0.8305, 0.8878, 0.8251], [0.8195, 0.7569, 0.7715, 0.6506], [0.8985, 0.634, 0.4437, 0.8318]], [[0.9415, 0.4152, 0.9696, 0.3917], [0.4634, 0.2149, 0.1916, 0.2426], [0.6848, 0.9422, 0.4999, 0.9212], [0.0166, 0.9687, 0.1952, 0.3786], [0.6214, 0.6606, 0.3107, 0.0337], [0.798, 0.7758, 0.9998, 0.9204], [0.7552, 0.0498, 0.2387, 0.0364], [0.0632, 0.7775, 0.6471, 0.938], [0.7004, 0.8336, 0.6889, 0.2138], [0.1497, 0.3724, 0.3754, 0.718], [0.4432, 0.3906, 0.8687, 0.3491], [0.398, 0.4531, 0.0566, 0.7165], [0.5464, 0.134, 0.2532, 0.2558], [0.4191, 0.1526, 0.6715, 0.2233], [0.9133, 0.7541, 0.2065, 0.5313], [0.445, 0.6188, 0.3715, 0.5675], [0.4718, 0.4688, 0.9361, 0.9853], [0.7504, 0.5891, 0.9313, 0.9465]], [[0.3938, 0.6756, 0.2049, 0.4528], [0.3847, 0.7823, 0.6397, 0.2116], [0.7116, 0.6513, 0.4771, 0.9471], [0.702, 0.3783, 0.9317, 0.1907], [0.446, 0.1918, 0.4239, 0.3611], [0.4274, 0.1051, 0.3124, 0.3818], [0.6082, 0.3384, 0.9651, 0.1725], [0.2487, 0.7026, 0.3716, 0.0978], [0.6898, 0.5845, 0.2708, 0.8619], [0.1696, 0.783, 0.9429, 0.3954], [0.5033, 0.206, 0.4013, 0.998], [0.1163, 0.3563, 0.7049, 0.3705], [0.4871, 0.6128, 0.5095, 0.2006], [0.5315, 0.5417, 0.7786, 0.6508], [0.8374, 0.8624, 0.7811, 0.4345], [0.9479, 0.2341, 0.118, 0.1696], [0.0816, 0.7334, 0.5404, 0.3447], [0.777, 0.7443, 0.7486, 0.5506]]],[0, 0, 0, 0], 6, false, 1, Con91177), 
LPRe32522 = prelu_layer(Con91177, [[0.9552, 0.0007, 0.1952, 0.5875]], PRe32522), 
LZer55136 = zero_padding1D_layer(PRe32522, 4, 0, Zer55136), 
LSub47349 = subtract_layer(Con13193,Zer55136, Sub47349), 
exec_layers([LMin85252,LRes90816,LZer62930,LZer65455,LSub32896,LCon13193,LZer69510,LRes91311,LCon91177,LPRe32522,LZer55136,LSub47349],["Min85252","Res90816","Zer62930","Zer65455","Sub32896","Con13193","Zer69510","Res91311","Con91177","PRe32522","Zer55136","Sub47349"],Sub47349,"Sub47349")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.6769000, 0.5719000], [-1.0960000, -1.3599000, 0.9795000, 0.2441000], [-1.4551001, -1.2512000, 0.6829000, 0.7892000], [-1.5556000, -1.4510000, 0.8954000, 0.8433000], [-17.3901112, -18.2502511, -18.7413215, -16.3396358]]]

Expected (Unparsed): [[[0,0,0.6769,0.5719],[-1.096,-1.3599,0.9795,0.2441],[-1.4551,-1.2512,0.6829,0.7892],[-1.5556,-1.451,0.8954,0.8433],[-17.390111360000006,-18.25025126,-18.741321629999998,-16.339635930000004]]]

Actual:   [[[0, 0, 0.6769, 0.5719], [-1.096, -1.3599, 0.9795, 0.2441], [-1.4551, -1.2512, 0.6829, 0.7892], [-1.5556, -1.451, 0.8954, 0.8433], [-17.3901, -18.2502, -18.7413, -16.3396]]]

Expected: [[[0, 0, 0.6769, 0.5719], [-1.096, -1.3599, 0.9795, 0.2441], [-1.4551, -1.2512, 0.6829, 0.7892], [-1.5556, -1.451, 0.8954, 0.8433], [-17.3901, -18.2502, -18.7413, -16.3396]]]