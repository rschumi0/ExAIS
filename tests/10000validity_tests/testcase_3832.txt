import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con21592 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Up_43655 = tf.keras.layers.Input(shape=([1, 4]))
in0Con14371 = tf.keras.layers.Input(shape=([2, 2]))

Con21592 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con21592', )(in0Con21592)
Res25003 = keras.layers.Reshape((2, 1, 6), name = 'Res25003', )(Con21592)
Res8091 = keras.layers.Reshape((2, 6), name = 'Res8091', )(Res25003)
Up_43655 = keras.layers.UpSampling1D(size=(2), name = 'Up_43655', )(in0Up_43655)
Con14371 = keras.layers.Concatenate(axis=2, name = 'Con14371', )([Up_43655,in0Con14371])
Mul86490 = keras.layers.Multiply(name = 'Mul86490', )([Res8091,Con14371])
Glo24637 = keras.layers.GlobalMaxPool1D(name = 'Glo24637', )(Mul86490)
Res76231 = keras.layers.Reshape((6, 1), name = 'Res76231', )(Glo24637)
Glo27676 = keras.layers.GlobalMaxPool1D(name = 'Glo27676', )(Res76231)
model = tf.keras.models.Model(inputs=[in0Con21592,in0Up_43655,in0Con14371], outputs=Glo27676)
w = model.get_layer('Con21592').get_weights() 
w[0] = np.array([[[[[0.0259, 0.7483, 0.7384]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con21592').set_weights(w) 
in0Con21592 = tf.constant([[[[[0.3557], [0.4538]]], [[[0.0515], [0.4403]]]]])
in0Up_43655 = tf.constant([[[1.1703, 1.3016, 1.3355, 1.542]]])
in0Con14371 = tf.constant([[[0.6788, 0.074], [0.0037, 0.8464]]])
print (np.array2string(model.predict([in0Con21592,in0Up_43655,in0Con14371],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo27676.png')

LCon21592 = conv3D_layer([[[[[0.3557], [0.4538]]], [[[0.0515], [0.4403]]]]], 1, 1, 1,[[[[[0.0259, 0.7483, 0.7384]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con21592), 
LRes25003 = reshape_layer(Con21592, [2, 1, 6], Res25003), 
LRes8091 = reshape_layer(Res25003, [2, 6], Res8091), 
LUp_43655 = up_sampling1D_layer([[[1.1703, 1.3016, 1.3355, 1.542]]], 2, Up_43655), 
LCon14371 = concatenate_layer([Up_43655,[[[0.6788, 0.074], [0.0037, 0.8464]]]], 2, Con14371), 
LMul86490 = multiply_layer([Res8091,Con14371], Mul86490), 
LGlo24637 = global_max_pool1D_layer(Mul86490, Glo24637), 
LRes76231 = reshape_layer(Glo24637, [6, 1], Res76231), 
LGlo27676 = global_max_pool1D_layer(Res76231, Glo27676), 
exec_layers([LCon21592,LRes25003,LRes8091,LUp_43655,LCon14371,LMul86490,LGlo24637,LRes76231,LGlo27676],["Con21592","Res25003","Res8091","Up_43655","Con14371","Mul86490","Glo24637","Res76231","Glo27676"],Glo27676,"Glo27676")

Actual (Unparsed): [[0.3507676]]

Expected (Unparsed): [[0.35076757923999996]]

Actual:   [[0.3508]]

Expected: [[0.3508]]