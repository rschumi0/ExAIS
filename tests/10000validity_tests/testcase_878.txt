import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min84696 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min84696 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Dot78973 = tf.keras.layers.Input(shape=([3]))
in1Dot78973 = tf.keras.layers.Input(shape=([3]))
in0Con8210 = tf.keras.layers.Input(shape=([3]))

Min84696 = keras.layers.Minimum(name = 'Min84696', )([in0Min84696,in1Min84696])
Res93186 = keras.layers.Reshape((2, 2), name = 'Res93186', )(Min84696)
Fla98218 = keras.layers.Flatten(name = 'Fla98218', )(Res93186)
Dot78973 = keras.layers.Dot(axes=(1, 1), name = 'Dot78973', )([in0Dot78973,in1Dot78973])
Con8210 = keras.layers.Concatenate(axis=1, name = 'Con8210', )([Dot78973,in0Con8210])
Add15793 = keras.layers.Add(name = 'Add15793', )([Fla98218,Con8210])
Den50504 = keras.layers.Dense(2,name = 'Den50504', )(Add15793)
Res19347 = keras.layers.Reshape((2, 1), name = 'Res19347', )(Den50504)
Ave59311 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave59311', )(Res19347)
model = tf.keras.models.Model(inputs=[in0Min84696,in1Min84696,in0Dot78973,in1Dot78973,in0Con8210], outputs=Ave59311)
w = model.get_layer('Den50504').get_weights() 
w[0] = np.array([[0.9959, 0.7568], [0.8767, 0.7543], [0.5298, 0.7917], [0.0441, 0.4003]])
w[1] = np.array([0.6281, 0.0698])
model.get_layer('Den50504').set_weights(w) 
in0Min84696 = tf.constant([[[[0.0678], [0.0839]], [[0.0842], [0.1163]]]])
in1Min84696 = tf.constant([[[[0.3529], [0.6444]], [[0.3408], [0.5989]]]])
in0Dot78973 = tf.constant([[0.5831, 0.6121, 0.6481]])
in1Dot78973 = tf.constant([[0.7169, 0.5861, 0.1545]])
in0Con8210 = tf.constant([[0.9983, 0.3848, 0.6188]])
print (np.array2string(model.predict([in0Min84696,in1Min84696,in0Dot78973,in1Dot78973,in0Con8210],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave59311.png')

LMin84696 = minimum_layer([[[[[0.0678], [0.0839]], [[0.0842], [0.1163]]]], [[[[0.3529], [0.6444]], [[0.3408], [0.5989]]]]], Min84696), 
LRes93186 = reshape_layer(Min84696, [2, 2], Res93186), 
LFla98218 = flatten_layer(Res93186, Fla98218), 
LDot78973 = dot_layer([[0.5831, 0.6121, 0.6481]], [[0.7169, 0.5861, 0.1545]], 1, 1, Dot78973), 
LCon8210 = concatenate_layer([Dot78973,[[0.9983, 0.3848, 0.6188]]], 1, Con8210), 
LAdd15793 = add_layer([Fla98218,Con8210], Add15793), 
LDen50504 = dense_layer(Add15793, [[0.9959, 0.7568], [0.8767, 0.7543], [0.5298, 0.7917], [0.0441, 0.4003]],[0.6281, 0.0698], Den50504), 
LRes19347 = reshape_layer(Den50504, [2, 1], Res19347), 
LAve59311 = average_pooling1D_layer(Res19347, 1, Ave59311), 
exec_layers([LMin84696,LRes93186,LFla98218,LDot78973,LCon8210,LAdd15793,LDen50504,LRes19347,LAve59311],["Min84696","Res93186","Fla98218","Dot78973","Con8210","Add15793","Den50504","Res19347","Ave59311"],Ave59311,"Ave59311")

Actual (Unparsed): [[[2.7985932], [2.2666260]]]

Expected (Unparsed): [[[2.798593198635],[2.2666260395199997]]]

Actual:   [[[2.7986], [2.2667]]]

Expected: [[[2.7986], [2.2667]]]