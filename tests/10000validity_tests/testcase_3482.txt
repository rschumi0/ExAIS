import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave63389 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave63389 = tf.keras.layers.Input(shape=([2, 2, 2]))

Ave63389 = keras.layers.Average(name = 'Ave63389', )([in0Ave63389,in1Ave63389])
Res1931 = keras.layers.Reshape((2, 4), name = 'Res1931', )(Ave63389)
Con5075 = keras.layers.Conv1D(4, (2),strides=(1), padding='same', dilation_rate=(1), name = 'Con5075', )(Res1931)
model = tf.keras.models.Model(inputs=[in0Ave63389,in1Ave63389], outputs=Con5075)
w = model.get_layer('Con5075').get_weights() 
w[0] = np.array([[[0.7653, 0.1885, 0.149, 0.3359], [0.259, 0.9101, 0.6972, 0.6285], [0.5551, 0.2952, 0.8838, 0.6801], [0.8386, 0.4563, 0.997, 0.8732]], [[0.0089, 0.9164, 0.9871, 0.5926], [0.5999, 0.3009, 0.2583, 0.1283], [0.8324, 0.234, 0.1015, 0.1678], [0.4008, 0.1787, 0.3204, 0.9962]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con5075').set_weights(w) 
in0Ave63389 = tf.constant([[[[0.1751, 0.8559], [0.8463, 0.7641]], [[0.0585, 0.7558], [0.6939, 0.1542]]]])
in1Ave63389 = tf.constant([[[[0.1261, 0.8551], [0.914, 0.8633]], [[0.9732, 0.9385], [0.6913, 0.2365]]]])
print (np.array2string(model.predict([in0Ave63389,in1Ave63389],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con5075.png')

LAve63389 = average_layer([[[[[0.1751, 0.8559], [0.8463, 0.7641]], [[0.0585, 0.7558], [0.6939, 0.1542]]]], [[[[0.1261, 0.8551], [0.914, 0.8633]], [[0.9732, 0.9385], [0.6913, 0.2365]]]]], Ave63389), 
LRes1931 = reshape_layer(Ave63389, [2, 4], Res1931), 
LCon5075 = conv1D_layer(Res1931, 2,[[[0.7653, 0.1885, 0.149, 0.3359], [0.259, 0.9101, 0.6972, 0.6285], [0.5551, 0.2952, 0.8838, 0.6801], [0.8386, 0.4563, 0.997, 0.8732]], [[0.0089, 0.9164, 0.9871, 0.5926], [0.5999, 0.3009, 0.2583, 0.1283], [0.8324, 0.234, 0.1015, 0.1678], [0.4008, 0.1787, 0.3204, 0.9962]]],[0, 0, 0, 0], 1, true, 1, Con5075), 
exec_layers([LAve63389,LRes1931,LCon5075],["Ave63389","Res1931","Con5075"],Con5075,"Con5075")

Actual (Unparsed): [[[2.6753816, 2.3627001, 3.0689329, 2.6225892], [1.1624746, 1.1618227, 1.4743784, 1.3473247]]]

Expected (Unparsed): [[[2.675381635,2.3627000600000003,3.06893289,2.6225891499999996],[1.1624746250000002,1.161822665,1.47437846,1.3473246700000001]]]

Actual:   [[[2.6754, 2.3628, 3.069, 2.6226], [1.1625, 1.1619, 1.4744, 1.3474]]]

Expected: [[[2.6754, 2.3628, 3.069, 2.6226], [1.1625, 1.1619, 1.4744, 1.3474]]]