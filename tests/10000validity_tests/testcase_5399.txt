import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max28781 = tf.keras.layers.Input(shape=([2, 1]))
in1Max28781 = tf.keras.layers.Input(shape=([2, 1]))
in0Min66836 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min66836 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Max28781 = keras.layers.Maximum(name = 'Max28781', )([in0Max28781,in1Max28781])
Res21907 = keras.layers.Reshape((2, 1, 1), name = 'Res21907', )(Max28781)
Res28901 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res28901', )(Res21907)
Zer54696 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (2, 0)), name = 'Zer54696', )(Res28901)
Min66836 = keras.layers.Minimum(name = 'Min66836', )([in0Min66836,in1Min66836])
Zer3216 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer3216', )(Min66836)
Ave45242 = keras.layers.Average(name = 'Ave45242', )([Zer54696,Zer3216])
model = tf.keras.models.Model(inputs=[in0Max28781,in1Max28781,in0Min66836,in1Min66836], outputs=Ave45242)
in0Max28781 = tf.constant([[[0.6117], [0.8721]]])
in1Max28781 = tf.constant([[[0.7047], [0.9772]]])
in0Min66836 = tf.constant([[[[[0.5094], [0.0214]], [[0.8521], [0.9931]]]]])
in1Min66836 = tf.constant([[[[[0.1202], [0.0059]], [[0.1267], [0.395]]]]])
print (np.array2string(model.predict([in0Max28781,in1Max28781,in0Min66836,in1Min66836],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave45242.png')

LMax28781 = maximum_layer([[[[0.6117], [0.8721]]], [[[0.7047], [0.9772]]]], Max28781), 
LRes21907 = reshape_layer(Max28781, [2, 1, 1], Res21907), 
LRes28901 = reshape_layer(Res21907, [2, 1, 1, 1], Res28901), 
LZer54696 = zero_padding3D_layer(Res28901, 0, 0, 2, 0, 2, 0, Zer54696), 
LMin66836 = minimum_layer([[[[[[0.5094], [0.0214]], [[0.8521], [0.9931]]]]], [[[[[0.1202], [0.0059]], [[0.1267], [0.395]]]]]], Min66836), 
LZer3216 = zero_padding3D_layer(Min66836, 1, 0, 1, 0, 1, 0, Zer3216), 
LAve45242 = average_layer([Zer54696,Zer3216], Ave45242), 
exec_layers([LMax28781,LRes21907,LRes28901,LZer54696,LMin66836,LZer3216,LAve45242],["Max28781","Res21907","Res28901","Zer54696","Min66836","Zer3216","Ave45242"],Ave45242,"Ave45242")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.3523500]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0601000], [0.0029500]], [[0.0000000], [0.0633500], [0.6861000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0.35235]]],[[[0],[0],[0]],[[0],[0.0601],[0.00295]],[[0],[0.06335],[0.6860999999999999]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.3524]]], [[[0], [0], [0]], [[0], [0.0601], [0.003]], [[0], [0.0634], [0.6861]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.3524]]], [[[0], [0], [0]], [[0], [0.0601], [0.003]], [[0], [0.0634], [0.6861]]]]]