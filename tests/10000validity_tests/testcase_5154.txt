import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min89954 = tf.keras.layers.Input(shape=([2, 1]))
in1Min89954 = tf.keras.layers.Input(shape=([2, 1]))
in0Con32753 = tf.keras.layers.Input(shape=([2]))
in0Con68399 = tf.keras.layers.Input(shape=([1, 2, 1]))

Min89954 = keras.layers.Minimum(name = 'Min89954', )([in0Min89954,in1Min89954])
Fla55860 = keras.layers.Flatten(name = 'Fla55860', )(Min89954)
Con32753 = keras.layers.Concatenate(axis=1, name = 'Con32753', )([Fla55860,in0Con32753])
Con68399 = keras.layers.Conv2D(4, (1, 1),strides=(1, 7), padding='valid', dilation_rate=(1, 1), name = 'Con68399', )(in0Con68399)
Glo12221 = keras.layers.GlobalAveragePooling2D(name = 'Glo12221', )(Con68399)
Max38704 = keras.layers.Maximum(name = 'Max38704', )([Con32753,Glo12221])
Res10637 = keras.layers.Reshape((4, 1), name = 'Res10637', )(Max38704)
Res22117 = keras.layers.Reshape((4, 1, 1), name = 'Res22117', )(Res10637)
Res73677 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res73677', )(Res22117)
Glo94510 = keras.layers.GlobalAveragePooling3D(name = 'Glo94510', )(Res73677)
model = tf.keras.models.Model(inputs=[in0Min89954,in1Min89954,in0Con32753,in0Con68399], outputs=Glo94510)
w = model.get_layer('Con68399').get_weights() 
w[0] = np.array([[[[0.5897, 0.9269, 0.9653, 0.5527]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con68399').set_weights(w) 
in0Min89954 = tf.constant([[[0.8771], [0.6703]]])
in1Min89954 = tf.constant([[[0.8499], [0.6726]]])
in0Con32753 = tf.constant([[0.2299, 0.7515]])
in0Con68399 = tf.constant([[[[0.7784], [0.0544]]]])
print (np.array2string(model.predict([in0Min89954,in1Min89954,in0Con32753,in0Con68399],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo94510.png')

LMin89954 = minimum_layer([[[[0.8771], [0.6703]]], [[[0.8499], [0.6726]]]], Min89954), 
LFla55860 = flatten_layer(Min89954, Fla55860), 
LCon32753 = concatenate_layer([Fla55860,[[0.2299, 0.7515]]], 1, Con32753), 
LCon68399 = conv2D_layer([[[[0.7784], [0.0544]]]], 1, 1,[[[[0.5897, 0.9269, 0.9653, 0.5527]]]],[0, 0, 0, 0], 1, 7, false, 1, 1, Con68399), 
LGlo12221 = global_average_pooling2D_layer(Con68399, Glo12221), 
LMax38704 = maximum_layer([Con32753,Glo12221], Max38704), 
LRes10637 = reshape_layer(Max38704, [4, 1], Res10637), 
LRes22117 = reshape_layer(Res10637, [4, 1, 1], Res22117), 
LRes73677 = reshape_layer(Res22117, [4, 1, 1, 1], Res73677), 
LGlo94510 = global_average_pooling3D_layer(Res73677, Glo94510), 
exec_layers([LMin89954,LFla55860,LCon32753,LCon68399,LGlo12221,LMax38704,LRes10637,LRes22117,LRes73677,LGlo94510],["Min89954","Fla55860","Con32753","Con68399","Glo12221","Max38704","Res10637","Res22117","Res73677","Glo94510"],Glo94510,"Glo94510")

Actual (Unparsed): [[0.7685721]]

Expected (Unparsed): [[0.76857212]]

Actual:   [[0.7686]]

Expected: [[0.7686]]