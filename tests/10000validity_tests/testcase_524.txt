import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro56286 = tf.keras.layers.Input(shape=([1, 4, 4, 1]))
in0Ave68645 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Ave68645 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Cro56286 = keras.layers.Cropping3D(cropping=((0, 0), (2, 1), (3, 0)), name = 'Cro56286', )(in0Cro56286)
Zer90706 = keras.layers.ZeroPadding3D(padding=((2, 0), (2, 0), (3, 0)), name = 'Zer90706', )(Cro56286)
Ave68645 = keras.layers.Average(name = 'Ave68645', )([in0Ave68645,in1Ave68645])
Res6769 = keras.layers.Reshape((2, 1, 2), name = 'Res6769', )(Ave68645)
Dep33160 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='valid', name = 'Dep33160', )(Res6769)
Res69811 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res69811', )(Dep33160)
Zer99501 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer99501', )(Res69811)
Add31568 = keras.layers.Add(name = 'Add31568', )([Zer90706,Zer99501])
model = tf.keras.models.Model(inputs=[in0Cro56286,in0Ave68645,in1Ave68645], outputs=Add31568)
w = model.get_layer('Dep33160').get_weights() 
w[0] = np.array([[[[0.8619], [0.0908]]], [[[0.6911], [0.4981]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep33160').set_weights(w) 
in0Cro56286 = tf.constant([[[[[1.4906], [1.8182], [1.8447], [1.5893]], [[1.1691], [1.2938], [1.4456], [1.5824]], [[1.669], [1.0132], [1.0125], [1.9143]], [[1.2341], [1.6938], [1.8056], [1.2742]]]]])
in0Ave68645 = tf.constant([[[[[0.4728], [0.4752]]], [[[0.3128], [0.9125]]]]])
in1Ave68645 = tf.constant([[[[[0.2046], [0.4684]]], [[[0.9784], [0.0418]]]]])
print (np.array2string(model.predict([in0Cro56286,in0Ave68645,in1Ave68645],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add31568.png')

LCro56286 = cropping3D_layer([[[[[1.4906], [1.8182], [1.8447], [1.5893]], [[1.1691], [1.2938], [1.4456], [1.5824]], [[1.669], [1.0132], [1.0125], [1.9143]], [[1.2341], [1.6938], [1.8056], [1.2742]]]]], 0, 0, 2, 1, 3, 0, Cro56286), 
LZer90706 = zero_padding3D_layer(Cro56286, 2, 0, 2, 0, 3, 0, Zer90706), 
LAve68645 = average_layer([[[[[[0.4728], [0.4752]]], [[[0.3128], [0.9125]]]]], [[[[[0.2046], [0.4684]]], [[[0.9784], [0.0418]]]]]], Ave68645), 
LRes6769 = reshape_layer(Ave68645, [2, 1, 2], Res6769), 
LDep33160 = depthwise_conv2D_layer(Res6769, 2, 1,[[[[0.8619], [0.0908]]], [[[0.6911], [0.4981]]]],[0, 0], 1, 1, false, Dep33160), 
LRes69811 = reshape_layer(Dep33160, [1, 1, 2, 1], Res69811), 
LZer99501 = zero_padding3D_layer(Res69811, 1, 1, 1, 1, 1, 1, Zer99501), 
LAdd31568 = add_layer([Zer90706,Zer99501], Add31568), 
exec_layers([LCro56286,LZer90706,LAve68645,LRes6769,LDep33160,LRes69811,LZer99501,LAdd31568],["Cro56286","Zer90706","Ave68645","Res6769","Dep33160","Res69811","Zer99501","Add31568"],Add31568,"Add31568")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.7380997], [0.2805079], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [1.9143000]]]]]

Expected (Unparsed): [[[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]]],[[[0],[0],[0],[0]],[[0],[0.7380996900000001],[0.280507855],[0]],[[0],[0],[0],[0]]],[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[1.9143]]]]]

Actual:   [[[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0.7381], [0.2806], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [1.9143]]]]]

Expected: [[[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0.7381], [0.2806], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [1.9143]]]]]