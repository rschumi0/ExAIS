import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add42957 = tf.keras.layers.Input(shape=([1, 2]))
in1Add42957 = tf.keras.layers.Input(shape=([1, 2]))
in0Dot21385 = tf.keras.layers.Input(shape=([3]))
in1Dot21385 = tf.keras.layers.Input(shape=([3]))
in0Con26191 = tf.keras.layers.Input(shape=([1, 1]))

Add42957 = keras.layers.Add(name = 'Add42957', )([in0Add42957,in1Add42957])
Dot21385 = keras.layers.Dot(axes=(1, 1), name = 'Dot21385', )([in0Dot21385,in1Dot21385])
Res54671 = keras.layers.Reshape((1, 1), name = 'Res54671', )(Dot21385)
Max54364 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max54364', )(Res54671)
Con26191 = keras.layers.Concatenate(axis=2, name = 'Con26191', )([Max54364,in0Con26191])
Max78097 = keras.layers.Maximum(name = 'Max78097', )([Add42957,Con26191])
Res43795 = keras.layers.Reshape((1, 2, 1), name = 'Res43795', )(Max78097)
PRe3468 = keras.layers.PReLU(name = 'PRe3468', )(Res43795)
model = tf.keras.models.Model(inputs=[in0Add42957,in1Add42957,in0Dot21385,in1Dot21385,in0Con26191], outputs=PRe3468)
w = model.get_layer('PRe3468').get_weights() 
w[0] = np.array([[[0.597], [0.772]]])
model.get_layer('PRe3468').set_weights(w) 
in0Add42957 = tf.constant([[[0.6567, 0.6953]]])
in1Add42957 = tf.constant([[[0.7903, 0.6519]]])
in0Dot21385 = tf.constant([[0.8094, 0.9839, 0.972]])
in1Dot21385 = tf.constant([[0.713, 0.7144, 0.0755]])
in0Con26191 = tf.constant([[[0.4985]]])
print (np.array2string(model.predict([in0Add42957,in1Add42957,in0Dot21385,in1Dot21385,in0Con26191],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe3468.png')

LAdd42957 = add_layer([[[[0.6567, 0.6953]]], [[[0.7903, 0.6519]]]], Add42957), 
LDot21385 = dot_layer([[0.8094, 0.9839, 0.972]], [[0.713, 0.7144, 0.0755]], 1, 1, Dot21385), 
LRes54671 = reshape_layer(Dot21385, [1, 1], Res54671), 
LMax54364 = max_pool1D_layer(Res54671, 1, Max54364), 
LCon26191 = concatenate_layer([Max54364,[[[0.4985]]]], 2, Con26191), 
LMax78097 = maximum_layer([Add42957,Con26191], Max78097), 
LRes43795 = reshape_layer(Max78097, [1, 2, 1], Res43795), 
LPRe3468 = prelu_layer(Res43795, [[[0.597], [0.772]]], PRe3468), 
exec_layers([LAdd42957,LDot21385,LRes54671,LMax54364,LCon26191,LMax78097,LRes43795,LPRe3468],["Add42957","Dot21385","Res54671","Max54364","Con26191","Max78097","Res43795","PRe3468"],PRe3468,"PRe3468")

Actual (Unparsed): [[[[1.4470000], [1.3472000]]]]

Expected (Unparsed): [[[[1.447],[1.3472]]]]

Actual:   [[[[1.447], [1.3472]]]]

Expected: [[[[1.447], [1.3472]]]]