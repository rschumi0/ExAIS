import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add48194 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add48194 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Glo79209 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con13555 = tf.keras.layers.Input(shape=([1]))

Add48194 = keras.layers.Add(name = 'Add48194', )([in0Add48194,in1Add48194])
Max44333 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 2), padding='valid', name = 'Max44333', )(Add48194)
Res10178 = keras.layers.Reshape((2, 1), name = 'Res10178', )(Max44333)
Fla60518 = keras.layers.Flatten(name = 'Fla60518', )(Res10178)
Glo79209 = keras.layers.GlobalMaxPool2D(name = 'Glo79209', )(in0Glo79209)
Con13555 = keras.layers.Concatenate(axis=1, name = 'Con13555', )([Glo79209,in0Con13555])
Min72224 = keras.layers.Minimum(name = 'Min72224', )([Fla60518,Con13555])
Res64441 = keras.layers.Reshape((2, 1), name = 'Res64441', )(Min72224)
Sim91254 = keras.layers.SimpleRNN(3,name = 'Sim91254', )(Res64441)
model = tf.keras.models.Model(inputs=[in0Add48194,in1Add48194,in0Glo79209,in0Con13555], outputs=Sim91254)
w = model.get_layer('Sim91254').get_weights() 
w[0] = np.array([[3, 10, 2]])
w[1] = np.array([[3, 8, 9], [2, 2, 5], [10, 6, 4]])
w[2] = np.array([1, 2, 7])
model.get_layer('Sim91254').set_weights(w) 
in0Add48194 = tf.constant([[[[0.916], [0.9922]], [[0.4142], [0.7055]]]])
in1Add48194 = tf.constant([[[[0.0352], [0.7621]], [[0.7891], [0.4418]]]])
in0Glo79209 = tf.constant([[[[1.2722], [1.0246]], [[1.0809], [1.142]]]])
in0Con13555 = tf.constant([[0.592]])
print (np.array2string(model.predict([in0Add48194,in1Add48194,in0Glo79209,in0Con13555],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim91254.png')

LAdd48194 = add_layer([[[[[0.916], [0.9922]], [[0.4142], [0.7055]]]], [[[[0.0352], [0.7621]], [[0.7891], [0.4418]]]]], Add48194), 
LMax44333 = max_pool2D_layer(Add48194, 1, 1, 1, 2, false, Max44333), 
LRes10178 = reshape_layer(Max44333, [2, 1], Res10178), 
LFla60518 = flatten_layer(Res10178, Fla60518), 
LGlo79209 = global_max_pool2D_layer([[[[1.2722], [1.0246]], [[1.0809], [1.142]]]], Glo79209), 
LCon13555 = concatenate_layer([Glo79209,[[0.592]]], 1, Con13555), 
LMin72224 = minimum_layer([Fla60518,Con13555], Min72224), 
LRes64441 = reshape_layer(Min72224, [2, 1], Res64441), 
LSim91254 = simple_rnn_layer(Res64441,[[3, 10, 2]],[[3, 8, 9], [2, 2, 5], [10, 6, 4]],[1, 2, 7], Sim91254), 
exec_layers([LAdd48194,LMax44333,LRes10178,LFla60518,LGlo79209,LCon13555,LMin72224,LRes64441,LSim91254],["Add48194","Max44333","Res10178","Fla60518","Glo79209","Con13555","Min72224","Res64441","Sim91254"],Sim91254,"Sim91254")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[0.9999999999999992,1.0,1.0]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]