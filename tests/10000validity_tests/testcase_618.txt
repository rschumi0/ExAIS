import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add70013 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Add70013 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con11381 = tf.keras.layers.Input(shape=([1, 5]))
in0Mul25952 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Mul25952 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Add70013 = keras.layers.Add(name = 'Add70013', )([in0Add70013,in1Add70013])
Res2177 = keras.layers.Reshape((1, 1, 2), name = 'Res2177', )(Add70013)
Con36551 = keras.layers.Conv2D(3, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con36551', )(Res2177)
Res55508 = keras.layers.Reshape((1, 3), name = 'Res55508', )(Con36551)
PRe90563 = keras.layers.PReLU(name = 'PRe90563', )(Res55508)
Con11381 = keras.layers.Concatenate(axis=2, name = 'Con11381', )([PRe90563,in0Con11381])
Mul25952 = keras.layers.Multiply(name = 'Mul25952', )([in0Mul25952,in1Mul25952])
Res54066 = keras.layers.Reshape((2, 2, 4), name = 'Res54066', )(Mul25952)
Res80821 = keras.layers.Reshape((2, 8), name = 'Res80821', )(Res54066)
Dot43402 = keras.layers.Dot(axes=(2, 2), name = 'Dot43402', )([Con11381,Res80821])
model = tf.keras.models.Model(inputs=[in0Add70013,in1Add70013,in0Con11381,in0Mul25952,in1Mul25952], outputs=Dot43402)
w = model.get_layer('Con36551').get_weights() 
w[0] = np.array([[[[0.7332, 0.1545, 0.613], [0.8021, 0.1989, 0.3804]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con36551').set_weights(w) 
w = model.get_layer('PRe90563').get_weights() 
w[0] = np.array([[0.2013, 0.4502, 0.6311]])
model.get_layer('PRe90563').set_weights(w) 
in0Add70013 = tf.constant([[[[[0.8834], [0.8162]]]]])
in1Add70013 = tf.constant([[[[[0.195], [0.5231]]]]])
in0Con11381 = tf.constant([[[0.4791, 0.5511, 0.7541, 0.2456, 0.0877]]])
in0Mul25952 = tf.constant([[[[[0.5115, 0.1524], [0.2636, 0.5539]], [[0.2581, 0.4318], [0.3098, 0.6071]]], [[[0.1727, 0.7123], [0.4838, 0.6131]], [[0.0235, 0.117], [0.0104, 0.36]]]]])
in1Mul25952 = tf.constant([[[[[0.5344, 0.4272], [0.8149, 0.2583]], [[0.3003, 0.1261], [0.8315, 0.1236]]], [[[0.1341, 0.2094], [0.8179, 0.769]], [[0.2119, 0.0712], [0.6878, 0.9009]]]]])
print (np.array2string(model.predict([in0Add70013,in1Add70013,in0Con11381,in0Mul25952,in1Mul25952],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot43402.png')

LAdd70013 = add_layer([[[[[[0.8834], [0.8162]]]]], [[[[[0.195], [0.5231]]]]]], Add70013), 
LRes2177 = reshape_layer(Add70013, [1, 1, 2], Res2177), 
LCon36551 = conv2D_layer(Res2177, 1, 1,[[[[0.7332, 0.1545, 0.613], [0.8021, 0.1989, 0.3804]]]],[0, 0, 0], 1, 1, false, 1, 1, Con36551), 
LRes55508 = reshape_layer(Con36551, [1, 3], Res55508), 
LPRe90563 = prelu_layer(Res55508, [[0.2013, 0.4502, 0.6311]], PRe90563), 
LCon11381 = concatenate_layer([PRe90563,[[[0.4791, 0.5511, 0.7541, 0.2456, 0.0877]]]], 2, Con11381), 
LMul25952 = multiply_layer([[[[[[0.5115, 0.1524], [0.2636, 0.5539]], [[0.2581, 0.4318], [0.3098, 0.6071]]], [[[0.1727, 0.7123], [0.4838, 0.6131]], [[0.0235, 0.117], [0.0104, 0.36]]]]], [[[[[0.5344, 0.4272], [0.8149, 0.2583]], [[0.3003, 0.1261], [0.8315, 0.1236]]], [[[0.1341, 0.2094], [0.8179, 0.769]], [[0.2119, 0.0712], [0.6878, 0.9009]]]]]], Mul25952), 
LRes54066 = reshape_layer(Mul25952, [2, 2, 4], Res54066), 
LRes80821 = reshape_layer(Res54066, [2, 8], Res80821), 
LDot43402 = dot_layer(Con11381,Res80821, 2, 2, Dot43402), 
exec_layers([LAdd70013,LRes2177,LCon36551,LRes55508,LPRe90563,LCon11381,LMul25952,LRes54066,LRes80821,LDot43402],["Add70013","Res2177","Con36551","Res55508","PRe90563","Con11381","Mul25952","Res54066","Res80821","Dot43402"],Dot43402,"Dot43402")

Actual (Unparsed): [[[1.0115691, 0.8360622]]]

Expected (Unparsed): [[[1.0115690834993745,0.8360622124003306]]]

Actual:   [[[1.0116, 0.8361]]]

Expected: [[[1.0116, 0.8361]]]