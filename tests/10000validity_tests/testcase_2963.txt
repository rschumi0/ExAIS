import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min68986 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min68986 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con66911 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Mul79447 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul79447 = tf.keras.layers.Input(shape=([1, 2]))
in0Sep3000 = tf.keras.layers.Input(shape=([1, 2]))
in0Con79979 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Add45606 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Add45606 = tf.keras.layers.Input(shape=([1, 1, 2]))

Min68986 = keras.layers.Minimum(name = 'Min68986', )([in0Min68986,in1Min68986])
Zer12801 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer12801', )(Min68986)
Con66911 = keras.layers.Concatenate(axis=3, name = 'Con66911', )([Zer12801,in0Con66911])
Mul79447 = keras.layers.Multiply(name = 'Mul79447', )([in0Mul79447,in1Mul79447])
Res85974 = keras.layers.Reshape((1, 2, 1), name = 'Res85974', )(Mul79447)
Sep3000 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep3000', )(in0Sep3000)
Res72681 = keras.layers.Reshape((1, 4, 1), name = 'Res72681', )(Sep3000)
Res53769 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res53769', )(Res72681)
Con54522 = keras.layers.Conv3D(2, (1, 4, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con54522', )(Res53769)
Res71797 = keras.layers.Reshape((1, 2, 1), name = 'Res71797', )(Con54522)
Min96653 = keras.layers.Minimum(name = 'Min96653', )([Res85974,Res71797])
Con79979 = keras.layers.Concatenate(axis=3, name = 'Con79979', )([Min96653,in0Con79979])
Add45606 = keras.layers.Add(name = 'Add45606', )([in0Add45606,in1Add45606])
Zer12147 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer12147', )(Add45606)
Ave45251 = keras.layers.Average(name = 'Ave45251', )([Con79979,Zer12147])
Max18268 = keras.layers.Maximum(name = 'Max18268', )([Con66911,Ave45251])
Fla8428 = keras.layers.Flatten(name = 'Fla8428', )(Max18268)
model = tf.keras.models.Model(inputs=[in0Min68986,in1Min68986,in0Con66911,in0Mul79447,in1Mul79447,in0Sep3000,in0Con79979,in0Add45606,in1Add45606], outputs=Fla8428)
w = model.get_layer('Sep3000').get_weights() 
w[0] = np.array([[[0.8852], [0.5103]]])
w[1] = np.array([[[0.3274, 0.9998, 0.7667, 0.5337], [0.7973, 0.947, 0.7857, 0.1965]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep3000').set_weights(w) 
w = model.get_layer('Con54522').get_weights() 
w[0] = np.array([[[[[0.9248, 0.352]]], [[[0.8746, 0.9127]]], [[[0.8875, 0.244]]], [[[0.9239, 0.1231]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con54522').set_weights(w) 
in0Min68986 = tf.constant([[[[0.8619]]]])
in1Min68986 = tf.constant([[[[0.0427]]]])
in0Con66911 = tf.constant([[[[0.3593], [0.2978]]]])
in0Mul79447 = tf.constant([[[0.424, 0.4801]]])
in1Mul79447 = tf.constant([[[0.4792, 0.139]]])
in0Sep3000 = tf.constant([[[0.5757, 0.533]]])
in0Con79979 = tf.constant([[[[0.5259], [0.4795]]]])
in0Add45606 = tf.constant([[[[0.5239, 0.1685]]]])
in1Add45606 = tf.constant([[[[0.1843, 0.9371]]]])
print (np.array2string(model.predict([in0Min68986,in1Min68986,in0Con66911,in0Mul79447,in1Mul79447,in0Sep3000,in0Con79979,in0Add45606,in1Add45606],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla8428.png')

LMin68986 = minimum_layer([[[[[0.8619]]]], [[[[0.0427]]]]], Min68986), 
LZer12801 = zero_padding2D_layer(Min68986, 0, 0, 1, 0, Zer12801), 
LCon66911 = concatenate_layer([Zer12801,[[[[0.3593], [0.2978]]]]], 3, Con66911), 
LMul79447 = multiply_layer([[[[0.424, 0.4801]]], [[[0.4792, 0.139]]]], Mul79447), 
LRes85974 = reshape_layer(Mul79447, [1, 2, 1], Res85974), 
LSep3000 = separable_conv1D_layer([[[0.5757, 0.533]]], 1,[[[[0.8852], [0.5103]]],[[[0.3274, 0.9998, 0.7667, 0.5337], [0.7973, 0.947, 0.7857, 0.1965]]]],[0, 0, 0, 0], 1, false, Sep3000), 
LRes72681 = reshape_layer(Sep3000, [1, 4, 1], Res72681), 
LRes53769 = reshape_layer(Res72681, [1, 4, 1, 1], Res53769), 
LCon54522 = conv3D_layer(Res53769, 1, 4, 1,[[[[[0.9248, 0.352]]], [[[0.8746, 0.9127]]], [[[0.8875, 0.244]]], [[[0.9239, 0.1231]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con54522), 
LRes71797 = reshape_layer(Con54522, [1, 2, 1], Res71797), 
LMin96653 = minimum_layer([Res85974,Res71797], Min96653), 
LCon79979 = concatenate_layer([Min96653,[[[[0.5259], [0.4795]]]]], 3, Con79979), 
LAdd45606 = add_layer([[[[[0.5239, 0.1685]]]], [[[[0.1843, 0.9371]]]]], Add45606), 
LZer12147 = zero_padding2D_layer(Add45606, 0, 0, 1, 0, Zer12147), 
LAve45251 = average_layer([Con79979,Zer12147], Ave45251), 
LMax18268 = maximum_layer([Con66911,Ave45251], Max18268), 
LFla8428 = flatten_layer(Max18268, Fla8428), 
exec_layers([LMin68986,LZer12801,LCon66911,LMul79447,LRes85974,LSep3000,LRes72681,LRes53769,LCon54522,LRes71797,LMin96653,LCon79979,LAdd45606,LZer12147,LAve45251,LMax18268,LFla8428],["Min68986","Zer12801","Con66911","Mul79447","Res85974","Sep3000","Res72681","Res53769","Con54522","Res71797","Min96653","Con79979","Add45606","Zer12147","Ave45251","Max18268","Fla8428"],Fla8428,"Fla8428")

Actual (Unparsed): [[0.1015904, 0.3593000, 0.3874669, 0.7925500]]

Expected (Unparsed): [[0.1015904,0.3593,0.38746695000000003,0.7925500000000001]]

Actual:   [[0.1016, 0.3593, 0.3875, 0.7926]]

Expected: [[0.1016, 0.3593, 0.3875, 0.7926]]