import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot75908 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot75908 = tf.keras.layers.Input(shape=([2, 3]))
in0Con54271 = tf.keras.layers.Input(shape=([1]))
in0Sim99009 = tf.keras.layers.Input(shape=([1, 3]))

Dot75908 = keras.layers.Dot(axes=(1, 1), name = 'Dot75908', )([in0Dot75908,in1Dot75908])
Res57743 = keras.layers.Reshape((3, 3, 1), name = 'Res57743', )(Dot75908)
Ave44033 = keras.layers.AveragePooling2D(pool_size=(2, 2), name = 'Ave44033', )(Res57743)
Res89359 = keras.layers.Reshape((1, 1), name = 'Res89359', )(Ave44033)
Fla34339 = keras.layers.Flatten(name = 'Fla34339', )(Res89359)
Con54271 = keras.layers.Concatenate(axis=1, name = 'Con54271', )([Fla34339,in0Con54271])
Sim99009 = keras.layers.SimpleRNN(2,name = 'Sim99009', )(in0Sim99009)
Thr38512 = keras.layers.ThresholdedReLU(theta=6.504655039714244, name = 'Thr38512', )(Sim99009)
Ave45729 = keras.layers.Average(name = 'Ave45729', )([Con54271,Thr38512])
model = tf.keras.models.Model(inputs=[in0Dot75908,in1Dot75908,in0Con54271,in0Sim99009], outputs=Ave45729)
w = model.get_layer('Sim99009').get_weights() 
w[0] = np.array([[8, 2], [9, 5], [8, 4]])
w[1] = np.array([[6, 4], [3, 6]])
w[2] = np.array([5, 8])
model.get_layer('Sim99009').set_weights(w) 
in0Dot75908 = tf.constant([[[0.6909, 0.7873, 0.937], [0.9291, 0.7922, 0.6901]]])
in1Dot75908 = tf.constant([[[0.7945, 0.7556, 0.6492], [0.2555, 0.8219, 0.099]]])
in0Con54271 = tf.constant([[0.271]])
in0Sim99009 = tf.constant([[[3, 3, 1]]])
print (np.array2string(model.predict([in0Dot75908,in1Dot75908,in0Con54271,in0Sim99009],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave45729.png')

LDot75908 = dot_layer([[[0.6909, 0.7873, 0.937], [0.9291, 0.7922, 0.6901]]], [[[0.7945, 0.7556, 0.6492], [0.2555, 0.8219, 0.099]]], 1, 1, Dot75908), 
LRes57743 = reshape_layer(Dot75908, [3, 3, 1], Res57743), 
LAve44033 = average_pooling2D_layer(Res57743, 2, 2, Ave44033), 
LRes89359 = reshape_layer(Ave44033, [1, 1], Res89359), 
LFla34339 = flatten_layer(Res89359, Fla34339), 
LCon54271 = concatenate_layer([Fla34339,[[0.271]]], 1, Con54271), 
LSim99009 = simple_rnn_layer([[[3, 3, 1]]],[[8, 2], [9, 5], [8, 4]],[[6, 4], [3, 6]],[5, 8], Sim99009), 
LThr38512 = thresholded_relu_layer(Sim99009, 6.504655039714244, Thr38512), 
LAve45729 = average_layer([Con54271,Thr38512], Ave45729), 
exec_layers([LDot75908,LRes57743,LAve44033,LRes89359,LFla34339,LCon54271,LSim99009,LThr38512,LAve45729],["Dot75908","Res57743","Ave44033","Res89359","Fla34339","Con54271","Sim99009","Thr38512","Ave45729"],Ave45729,"Ave45729")

Actual (Unparsed): [[0.5182358, 0.1355000]]

Expected (Unparsed): [[0.518235805,0.1355]]

Actual:   [[0.5183, 0.1355]]

Expected: [[0.5183, 0.1355]]