import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add11016 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add11016 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Sub68710 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub68710 = tf.keras.layers.Input(shape=([3, 2, 2]))
in0Dot36098 = tf.keras.layers.Input(shape=([2]))
in1Dot36098 = tf.keras.layers.Input(shape=([2]))
in0Con38088 = tf.keras.layers.Input(shape=([11]))

Add11016 = keras.layers.Add(name = 'Add11016', )([in0Add11016,in1Add11016])
Res28878 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res28878', )(Add11016)
Zer71517 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer71517', )(Res28878)
Sub68710 = keras.layers.Subtract(name = 'Sub68710', )([in0Sub68710,in1Sub68710])
Res15005 = keras.layers.Reshape((3, 4), name = 'Res15005', )(Sub68710)
Fla34480 = keras.layers.Flatten(name = 'Fla34480', )(Res15005)
Dot36098 = keras.layers.Dot(axes=(1, 1), name = 'Dot36098', )([in0Dot36098,in1Dot36098])
Con38088 = keras.layers.Concatenate(axis=1, name = 'Con38088', )([Dot36098,in0Con38088])
Min83635 = keras.layers.Minimum(name = 'Min83635', )([Fla34480,Con38088])
Res69952 = keras.layers.Reshape((12, 1), name = 'Res69952', )(Min83635)
Res71522 = keras.layers.Reshape((12, 1, 1), name = 'Res71522', )(Res69952)
Res38392 = keras.layers.Reshape((12, 1, 1, 1), name = 'Res38392', )(Res71522)
Cro60886 = keras.layers.Cropping3D(cropping=((5, 5), (0, 0), (0, 0)), name = 'Cro60886', )(Res38392)
Zer9620 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer9620', )(Cro60886)
Max64699 = keras.layers.Maximum(name = 'Max64699', )([Zer71517,Zer9620])
model = tf.keras.models.Model(inputs=[in0Add11016,in1Add11016,in0Sub68710,in1Sub68710,in0Dot36098,in1Dot36098,in0Con38088], outputs=Max64699)
in0Add11016 = tf.constant([[[[0.547], [0.2112]]]])
in1Add11016 = tf.constant([[[[0.3721], [0.4868]]]])
in0Sub68710 = tf.constant([[[[0.4635, 0.2958], [0.3565, 0.3356]], [[0.3252, 0.9107], [0.4111, 0.7687]], [[0.2485, 0.7225], [0.5403, 0.6141]]]])
in1Sub68710 = tf.constant([[[[0.7517, 0.7794], [0.7871, 0.2568]], [[0.5789, 0.7746], [0.4399, 0.7487]], [[0.0983, 0.4932], [0.7529, 0.9474]]]])
in0Dot36098 = tf.constant([[0.5411, 0.9942]])
in1Dot36098 = tf.constant([[0.1173, 0.8776]])
in0Con38088 = tf.constant([[0.1344, 0.2571, 0.504, 0.9088, 0.5089, 0.7771, 0.1769, 0.0248, 0.6958, 0.5884, 0.0425]])
print (np.array2string(model.predict([in0Add11016,in1Add11016,in0Sub68710,in1Sub68710,in0Dot36098,in1Dot36098,in0Con38088],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max64699.png')

LAdd11016 = add_layer([[[[[0.547], [0.2112]]]], [[[[0.3721], [0.4868]]]]], Add11016), 
LRes28878 = reshape_layer(Add11016, [1, 2, 1, 1], Res28878), 
LZer71517 = zero_padding3D_layer(Res28878, 1, 0, 1, 0, 0, 0, Zer71517), 
LSub68710 = subtract_layer([[[[0.4635, 0.2958], [0.3565, 0.3356]], [[0.3252, 0.9107], [0.4111, 0.7687]], [[0.2485, 0.7225], [0.5403, 0.6141]]]], [[[[0.7517, 0.7794], [0.7871, 0.2568]], [[0.5789, 0.7746], [0.4399, 0.7487]], [[0.0983, 0.4932], [0.7529, 0.9474]]]], Sub68710), 
LRes15005 = reshape_layer(Sub68710, [3, 4], Res15005), 
LFla34480 = flatten_layer(Res15005, Fla34480), 
LDot36098 = dot_layer([[0.5411, 0.9942]], [[0.1173, 0.8776]], 1, 1, Dot36098), 
LCon38088 = concatenate_layer([Dot36098,[[0.1344, 0.2571, 0.504, 0.9088, 0.5089, 0.7771, 0.1769, 0.0248, 0.6958, 0.5884, 0.0425]]], 1, Con38088), 
LMin83635 = minimum_layer([Fla34480,Con38088], Min83635), 
LRes69952 = reshape_layer(Min83635, [12, 1], Res69952), 
LRes71522 = reshape_layer(Res69952, [12, 1, 1], Res71522), 
LRes38392 = reshape_layer(Res71522, [12, 1, 1, 1], Res38392), 
LCro60886 = cropping3D_layer(Res38392, 5, 5, 0, 0, 0, 0, Cro60886), 
LZer9620 = zero_padding3D_layer(Cro60886, 0, 0, 2, 0, 0, 0, Zer9620), 
LMax64699 = maximum_layer([Zer71517,Zer9620], Max64699), 
exec_layers([LAdd11016,LRes28878,LZer71517,LSub68710,LRes15005,LFla34480,LDot36098,LCon38088,LMin83635,LRes69952,LRes71522,LRes38392,LCro60886,LZer9620,LMax64699],["Add11016","Res28878","Zer71517","Sub68710","Res15005","Fla34480","Dot36098","Con38088","Min83635","Res69952","Res71522","Res38392","Cro60886","Zer9620","Max64699"],Max64699,"Max64699")

Actual (Unparsed): [[[[[0.0000000]], [[0.0000000]], [[0.1361000]]], [[[0.0000000]], [[0.9191000]], [[0.6980000]]]]]

Expected (Unparsed): [[[[[0]],[[0]],[[0.1361]]],[[[0]],[[0.9191]],[[0.698]]]]]

Actual:   [[[[[0]], [[0]], [[0.1361]]], [[[0]], [[0.9191]], [[0.698]]]]]

Expected: [[[[[0]], [[0]], [[0.1361]]], [[[0]], [[0.9191]], [[0.698]]]]]