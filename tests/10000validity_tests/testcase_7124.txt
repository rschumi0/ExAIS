import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_32651 = tf.keras.layers.Input(shape=([3, 1]))
in0Min91099 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Min91099 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Up_32651 = keras.layers.UpSampling1D(size=(2), name = 'Up_32651', )(in0Up_32651)
LST52570 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST52570', )(Up_32651)
Res23162 = keras.layers.Reshape((1, 1), name = 'Res23162', )(LST52570)
Min91099 = keras.layers.Minimum(name = 'Min91099', )([in0Min91099,in1Min91099])
Res37256 = keras.layers.Reshape((1, 1, 1), name = 'Res37256', )(Min91099)
Res812 = keras.layers.Reshape((1, 1), name = 'Res812', )(Res37256)
Max38008 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max38008', )(Res812)
Sub47141 = keras.layers.Subtract(name = 'Sub47141', )([Res23162,Max38008])
model = tf.keras.models.Model(inputs=[in0Up_32651,in0Min91099,in1Min91099], outputs=Sub47141)
w = model.get_layer('LST52570').get_weights() 
w[0] = np.array([[1, 10, 2, 9]])
w[1] = np.array([[6, 10, 9, 7]])
w[2] = np.array([1, 9, 7, 8])
model.get_layer('LST52570').set_weights(w) 
in0Up_32651 = tf.constant([[[1.4785], [1.5813], [1.8312]]])
in0Min91099 = tf.constant([[[[[0.4816]]]]])
in1Min91099 = tf.constant([[[[[0.2348]]]]])
print (np.array2string(model.predict([in0Up_32651,in0Min91099,in1Min91099],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub47141.png')

LUp_32651 = up_sampling1D_layer([[[1.4785], [1.5813], [1.8312]]], 2, Up_32651), 
LLST52570 = lstm_layer(Up_32651,[[1, 10, 2, 9]],[[6, 10, 9, 7]],[1, 9, 7, 8], LST52570), 
LRes23162 = reshape_layer(LST52570, [1, 1], Res23162), 
LMin91099 = minimum_layer([[[[[[0.4816]]]]], [[[[[0.2348]]]]]], Min91099), 
LRes37256 = reshape_layer(Min91099, [1, 1, 1], Res37256), 
LRes812 = reshape_layer(Res37256, [1, 1], Res812), 
LMax38008 = max_pool1D_layer(Res812, 1, Max38008), 
LSub47141 = subtract_layer(Res23162,Max38008, Sub47141), 
exec_layers([LUp_32651,LLST52570,LRes23162,LMin91099,LRes37256,LRes812,LMax38008,LSub47141],["Up_32651","LST52570","Res23162","Min91099","Res37256","Res812","Max38008","Sub47141"],Sub47141,"Sub47141")

Actual (Unparsed): [[[0.7651856]]]

Expected (Unparsed): [[[0.7651856032745188]]]

Actual:   [[[0.7652]]]

Expected: [[[0.7652]]]