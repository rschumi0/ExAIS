import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot82736 = tf.keras.layers.Input(shape=([2]))
in1Dot82736 = tf.keras.layers.Input(shape=([2]))
in0Con36690 = tf.keras.layers.Input(shape=([3]))
in0Mul39877 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Mul39877 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Sub61464 = tf.keras.layers.Input(shape=([3, 3, 3, 2]))
in1Sub61464 = tf.keras.layers.Input(shape=([3, 3, 3, 2]))
in0Con59246 = tf.keras.layers.Input(shape=([1]))

Dot82736 = keras.layers.Dot(axes=(1, 1), name = 'Dot82736', )([in0Dot82736,in1Dot82736])
Con36690 = keras.layers.Concatenate(axis=1, name = 'Con36690', )([Dot82736,in0Con36690])
Mul39877 = keras.layers.Multiply(name = 'Mul39877', )([in0Mul39877,in1Mul39877])
Res48395 = keras.layers.Reshape((2, 2, 1), name = 'Res48395', )(Mul39877)
Res22498 = keras.layers.Reshape((2, 2), name = 'Res22498', )(Res48395)
Fla93786 = keras.layers.Flatten(name = 'Fla93786', )(Res22498)
Sub61464 = keras.layers.Subtract(name = 'Sub61464', )([in0Sub61464,in1Sub61464])
Mas85172 = keras.layers.Masking(mask_value=2, name = 'Mas85172', )(Sub61464)
Res32820 = keras.layers.Reshape((3, 3, 6), name = 'Res32820', )(Mas85172)
Res94358 = keras.layers.Reshape((3, 18), name = 'Res94358', )(Res32820)
GRU81630 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU81630', )(Res94358)
Con59246 = keras.layers.Concatenate(axis=1, name = 'Con59246', )([GRU81630,in0Con59246])
Mul70081 = keras.layers.Multiply(name = 'Mul70081', )([Fla93786,Con59246])
Dot89989 = keras.layers.Dot(axes=(1, 1), name = 'Dot89989', )([Con36690,Mul70081])
model = tf.keras.models.Model(inputs=[in0Dot82736,in1Dot82736,in0Con36690,in0Mul39877,in1Mul39877,in0Sub61464,in1Sub61464,in0Con59246], outputs=Dot89989)
w = model.get_layer('GRU81630').get_weights() 
w[0] = np.array([[6, 8, 7, 2, 3, 1, 5, 9, 7], [9, 2, 9, 3, 4, 3, 3, 8, 10], [7, 2, 7, 2, 9, 6, 5, 10, 3], [8, 4, 6, 3, 2, 10, 9, 3, 10], [10, 7, 2, 7, 1, 3, 3, 7, 3], [9, 3, 4, 9, 2, 1, 2, 2, 3], [7, 3, 1, 1, 3, 2, 9, 7, 8], [1, 6, 10, 2, 8, 8, 6, 7, 4], [8, 7, 7, 9, 5, 4, 10, 2, 9], [8, 5, 4, 10, 4, 1, 2, 10, 9], [6, 9, 9, 10, 5, 6, 3, 3, 8], [3, 2, 9, 5, 2, 8, 9, 8, 9], [3, 4, 9, 6, 8, 8, 6, 5, 8], [4, 5, 3, 1, 7, 4, 8, 6, 8], [5, 5, 4, 6, 8, 9, 8, 9, 3], [9, 9, 5, 4, 6, 8, 3, 2, 2], [4, 1, 4, 6, 9, 6, 2, 8, 4], [8, 5, 9, 3, 4, 3, 4, 9, 10]])
w[1] = np.array([[8, 1, 10, 8, 6, 1, 1, 1, 3], [5, 4, 2, 6, 10, 2, 7, 9, 10], [3, 1, 4, 5, 3, 5, 10, 7, 5]])
w[2] = np.array([[9, 6, 3, 8, 1, 3, 6, 1, 3], [5, 4, 1, 10, 9, 5, 2, 4, 8]])
model.get_layer('GRU81630').set_weights(w) 
in0Dot82736 = tf.constant([[0.5699, 0.1208]])
in1Dot82736 = tf.constant([[0.1943, 0.9628]])
in0Con36690 = tf.constant([[0.6547, 0.7603, 0.0216]])
in0Mul39877 = tf.constant([[[[[0.3996]], [[0.5771]]], [[[0.4906]], [[0.3748]]]]])
in1Mul39877 = tf.constant([[[[[0.4934]], [[0.7081]]], [[[0.4248]], [[0.9924]]]]])
in0Sub61464 = tf.constant([[[[[0.7046, 0.6547], [0.1313, 0.6286], [0.5429, 0.6044]], [[0.5928, 0.5263], [0.1738, 0.9723], [0.6565, 0.8125]], [[0.875, 0.6415], [0.3416, 0.831], [0.4931, 0.0291]]], [[[0.4398, 0.6146], [0.0895, 0.0236], [0.1344, 0.2422]], [[0.0146, 0.7761], [0.995, 0.4618], [0.1095, 0.9148]], [[0.239, 0.7534], [0.5963, 0.0025], [0.5941, 0.9604]]], [[[0.492, 0.9582], [0.4455, 0.7185], [0.0528, 0.7253]], [[0.2052, 0.1794], [0.8444, 0.6817], [0.0027, 0.9407]], [[0.5183, 0.1635], [0.8632, 0.673], [0.2721, 0.998]]]]])
in1Sub61464 = tf.constant([[[[[0.5137, 0.6637], [0.2734, 0.1291], [0.8366, 0.3847]], [[0.0339, 0.2575], [0.7775, 0.238], [0.8354, 0.9171]], [[0.2043, 0.8292], [0.83, 0.5586], [0.8163, 0.4795]]], [[[0.3629, 0.0263], [0.7044, 0.1958], [0.3994, 0.274]], [[0.575, 0.991], [0.6773, 0.2929], [0.9695, 0.2681]], [[0.3518, 0.9997], [0.0324, 0.9664], [0.4494, 0.2689]]], [[[0.5118, 0.3041], [0.4098, 0.3838], [0.7132, 0.2458]], [[0.3535, 0.9281], [0.0693, 0.2726], [0.4878, 0.5422]], [[0.8358, 0.6428], [0.2392, 0.0304], [0.1799, 0.0877]]]]])
in0Con59246 = tf.constant([[0.597]])
print (np.array2string(model.predict([in0Dot82736,in1Dot82736,in0Con36690,in0Mul39877,in1Mul39877,in0Sub61464,in1Sub61464,in0Con59246],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot89989.png')

LDot82736 = dot_layer([[0.5699, 0.1208]], [[0.1943, 0.9628]], 1, 1, Dot82736), 
LCon36690 = concatenate_layer([Dot82736,[[0.6547, 0.7603, 0.0216]]], 1, Con36690), 
LMul39877 = multiply_layer([[[[[[0.3996]], [[0.5771]]], [[[0.4906]], [[0.3748]]]]], [[[[[0.4934]], [[0.7081]]], [[[0.4248]], [[0.9924]]]]]], Mul39877), 
LRes48395 = reshape_layer(Mul39877, [2, 2, 1], Res48395), 
LRes22498 = reshape_layer(Res48395, [2, 2], Res22498), 
LFla93786 = flatten_layer(Res22498, Fla93786), 
LSub61464 = subtract_layer([[[[[0.7046, 0.6547], [0.1313, 0.6286], [0.5429, 0.6044]], [[0.5928, 0.5263], [0.1738, 0.9723], [0.6565, 0.8125]], [[0.875, 0.6415], [0.3416, 0.831], [0.4931, 0.0291]]], [[[0.4398, 0.6146], [0.0895, 0.0236], [0.1344, 0.2422]], [[0.0146, 0.7761], [0.995, 0.4618], [0.1095, 0.9148]], [[0.239, 0.7534], [0.5963, 0.0025], [0.5941, 0.9604]]], [[[0.492, 0.9582], [0.4455, 0.7185], [0.0528, 0.7253]], [[0.2052, 0.1794], [0.8444, 0.6817], [0.0027, 0.9407]], [[0.5183, 0.1635], [0.8632, 0.673], [0.2721, 0.998]]]]], [[[[[0.5137, 0.6637], [0.2734, 0.1291], [0.8366, 0.3847]], [[0.0339, 0.2575], [0.7775, 0.238], [0.8354, 0.9171]], [[0.2043, 0.8292], [0.83, 0.5586], [0.8163, 0.4795]]], [[[0.3629, 0.0263], [0.7044, 0.1958], [0.3994, 0.274]], [[0.575, 0.991], [0.6773, 0.2929], [0.9695, 0.2681]], [[0.3518, 0.9997], [0.0324, 0.9664], [0.4494, 0.2689]]], [[[0.5118, 0.3041], [0.4098, 0.3838], [0.7132, 0.2458]], [[0.3535, 0.9281], [0.0693, 0.2726], [0.4878, 0.5422]], [[0.8358, 0.6428], [0.2392, 0.0304], [0.1799, 0.0877]]]]], Sub61464), 
LMas85172 = masking_layer(Sub61464, 2, Mas85172), 
LRes32820 = reshape_layer(Mas85172, [3, 3, 6], Res32820), 
LRes94358 = reshape_layer(Res32820, [3, 18], Res94358), 
LGRU81630 = gru_layer(Res94358,[[6, 8, 7, 2, 3, 1, 5, 9, 7], [9, 2, 9, 3, 4, 3, 3, 8, 10], [7, 2, 7, 2, 9, 6, 5, 10, 3], [8, 4, 6, 3, 2, 10, 9, 3, 10], [10, 7, 2, 7, 1, 3, 3, 7, 3], [9, 3, 4, 9, 2, 1, 2, 2, 3], [7, 3, 1, 1, 3, 2, 9, 7, 8], [1, 6, 10, 2, 8, 8, 6, 7, 4], [8, 7, 7, 9, 5, 4, 10, 2, 9], [8, 5, 4, 10, 4, 1, 2, 10, 9], [6, 9, 9, 10, 5, 6, 3, 3, 8], [3, 2, 9, 5, 2, 8, 9, 8, 9], [3, 4, 9, 6, 8, 8, 6, 5, 8], [4, 5, 3, 1, 7, 4, 8, 6, 8], [5, 5, 4, 6, 8, 9, 8, 9, 3], [9, 9, 5, 4, 6, 8, 3, 2, 2], [4, 1, 4, 6, 9, 6, 2, 8, 4], [8, 5, 9, 3, 4, 3, 4, 9, 10]],[[8, 1, 10, 8, 6, 1, 1, 1, 3], [5, 4, 2, 6, 10, 2, 7, 9, 10], [3, 1, 4, 5, 3, 5, 10, 7, 5]],[[9, 6, 3, 8, 1, 3, 6, 1, 3], [5, 4, 1, 10, 9, 5, 2, 4, 8]], true, GRU81630), 
LCon59246 = concatenate_layer([GRU81630,[[0.597]]], 1, Con59246), 
LMul70081 = multiply_layer([Fla93786,Con59246], Mul70081), 
LDot89989 = dot_layer(Con36690,Mul70081, 1, 1, Dot89989), 
exec_layers([LDot82736,LCon36690,LMul39877,LRes48395,LRes22498,LFla93786,LSub61464,LMas85172,LRes32820,LRes94358,LGRU81630,LCon59246,LMul70081,LDot89989],["Dot82736","Con36690","Mul39877","Res48395","Res22498","Fla93786","Sub61464","Mas85172","Res32820","Res94358","GRU81630","Con59246","Mul70081","Dot89989"],Dot89989,"Dot89989")

Actual (Unparsed): [[0.2511423]]

Expected (Unparsed): [[0.2511423371998819]]

Actual:   [[0.2512]]

Expected: [[0.2512]]