import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo93114 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Ave83824 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Ave83824 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con29219 = tf.keras.layers.Input(shape=([1]))
in0Dot26595 = tf.keras.layers.Input(shape=([3]))
in1Dot26595 = tf.keras.layers.Input(shape=([3]))
in0Con9093 = tf.keras.layers.Input(shape=([1]))

Glo93114 = keras.layers.GlobalMaxPool3D(name = 'Glo93114', )(in0Glo93114)
Res28982 = keras.layers.Reshape((1, 1), name = 'Res28982', )(Glo93114)
Res86149 = keras.layers.Reshape((1, 1, 1), name = 'Res86149', )(Res28982)
Up_75185 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_75185', )(Res86149)
Res66639 = keras.layers.Reshape((1, 2), name = 'Res66639', )(Up_75185)
Fla9308 = keras.layers.Flatten(name = 'Fla9308', )(Res66639)
Ave83824 = keras.layers.Average(name = 'Ave83824', )([in0Ave83824,in1Ave83824])
Res19217 = keras.layers.Reshape((1, 1, 1), name = 'Res19217', )(Ave83824)
Glo86021 = keras.layers.GlobalMaxPool2D(name = 'Glo86021', )(Res19217)
Con29219 = keras.layers.Concatenate(axis=1, name = 'Con29219', )([Glo86021,in0Con29219])
Ave88927 = keras.layers.Average(name = 'Ave88927', )([Fla9308,Con29219])
Dot26595 = keras.layers.Dot(axes=(1, 1), name = 'Dot26595', )([in0Dot26595,in1Dot26595])
Con9093 = keras.layers.Concatenate(axis=1, name = 'Con9093', )([Dot26595,in0Con9093])
Sub48109 = keras.layers.Subtract(name = 'Sub48109', )([Ave88927,Con9093])
model = tf.keras.models.Model(inputs=[in0Glo93114,in0Ave83824,in1Ave83824,in0Con29219,in0Dot26595,in1Dot26595,in0Con9093], outputs=Sub48109)
in0Glo93114 = tf.constant([[[[[1.6266]]], [[[1.4636]]]]])
in0Ave83824 = tf.constant([[[[[0.6589]]]]])
in1Ave83824 = tf.constant([[[[[0.1396]]]]])
in0Con29219 = tf.constant([[0.8178]])
in0Dot26595 = tf.constant([[0.9253, 0.0275, 0.9009]])
in1Dot26595 = tf.constant([[0.508, 0.0533, 0.1581]])
in0Con9093 = tf.constant([[0.974]])
print (np.array2string(model.predict([in0Glo93114,in0Ave83824,in1Ave83824,in0Con29219,in0Dot26595,in1Dot26595,in0Con9093],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub48109.png')

LGlo93114 = global_max_pool3D_layer([[[[[1.6266]]], [[[1.4636]]]]], Glo93114), 
LRes28982 = reshape_layer(Glo93114, [1, 1], Res28982), 
LRes86149 = reshape_layer(Res28982, [1, 1, 1], Res86149), 
LUp_75185 = up_sampling2D_layer(Res86149, 1, 2, Up_75185), 
LRes66639 = reshape_layer(Up_75185, [1, 2], Res66639), 
LFla9308 = flatten_layer(Res66639, Fla9308), 
LAve83824 = average_layer([[[[[[0.6589]]]]], [[[[[0.1396]]]]]], Ave83824), 
LRes19217 = reshape_layer(Ave83824, [1, 1, 1], Res19217), 
LGlo86021 = global_max_pool2D_layer(Res19217, Glo86021), 
LCon29219 = concatenate_layer([Glo86021,[[0.8178]]], 1, Con29219), 
LAve88927 = average_layer([Fla9308,Con29219], Ave88927), 
LDot26595 = dot_layer([[0.9253, 0.0275, 0.9009]], [[0.508, 0.0533, 0.1581]], 1, 1, Dot26595), 
LCon9093 = concatenate_layer([Dot26595,[[0.974]]], 1, Con9093), 
LSub48109 = subtract_layer(Ave88927,Con9093, Sub48109), 
exec_layers([LGlo93114,LRes28982,LRes86149,LUp_75185,LRes66639,LFla9308,LAve83824,LRes19217,LGlo86021,LCon29219,LAve88927,LDot26595,LCon9093,LSub48109],["Glo93114","Res28982","Res86149","Up_75185","Res66639","Fla9308","Ave83824","Res19217","Glo86021","Con29219","Ave88927","Dot26595","Con9093","Sub48109"],Sub48109,"Sub48109")

Actual (Unparsed): [[0.3989746, 0.2482000]]

Expected (Unparsed): [[0.3989745600000001,0.24819999999999998]]

Actual:   [[0.399, 0.2482]]

Expected: [[0.399, 0.2482]]