import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min3798 = tf.keras.layers.Input(shape=([2, 2]))
in1Min3798 = tf.keras.layers.Input(shape=([2, 2]))

Min3798 = keras.layers.Minimum(name = 'Min3798', )([in0Min3798,in1Min3798])
Res51924 = keras.layers.Reshape((2, 2, 1), name = 'Res51924', )(Min3798)
Sep735 = keras.layers.SeparableConv2D(2, (1, 2),strides=(1, 1), padding='same', name = 'Sep735', )(Res51924)
Res38003 = keras.layers.Reshape((2, 4), name = 'Res38003', )(Sep735)
Ave92567 = keras.layers.AveragePooling1D(pool_size=(1), strides=(2), padding='valid', name = 'Ave92567', )(Res38003)
model = tf.keras.models.Model(inputs=[in0Min3798,in1Min3798], outputs=Ave92567)
w = model.get_layer('Sep735').get_weights() 
w[0] = np.array([[[[0.6813]], [[0.4977]]]])
w[1] = np.array([[[[0.1165, 0.8551]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep735').set_weights(w) 
in0Min3798 = tf.constant([[[0.2427, 0.6713], [0.2852, 0.9916]]])
in1Min3798 = tf.constant([[[0.8408, 0.0592], [0.056, 0.852]]])
print (np.array2string(model.predict([in0Min3798,in1Min3798],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave92567.png')

LMin3798 = minimum_layer([[[[0.2427, 0.6713], [0.2852, 0.9916]]], [[[0.8408, 0.0592], [0.056, 0.852]]]], Min3798), 
LRes51924 = reshape_layer(Min3798, [2, 2, 1], Res51924), 
LSep735 = separable_conv2D_layer(Res51924, 1, 2,[[[[[0.6813]], [[0.4977]]]],[[[[0.1165, 0.8551]]]]],[0, 0], 1, 1, true, Sep735), 
LRes38003 = reshape_layer(Sep735, [2, 4], Res38003), 
LAve92567 = average_pooling1D_layer(Res38003, 1, 2, false, Ave92567), 
exec_layers([LMin3798,LRes51924,LSep735,LRes38003,LAve92567],["Min3798","Res51924","Sep735","Res38003","Ave92567"],Ave92567,"Ave92567")

Actual (Unparsed): [[[0.0226960, 0.1665866, 0.0046988, 0.0344887]]]

Expected (Unparsed): [[[0.022695988275000002,0.166586605785,0.00469878984,0.034488714095999996]]]

Actual:   [[[0.0227, 0.1666, 0.0047, 0.0345]]]

Expected: [[[0.0227, 0.1666, 0.0047, 0.0345]]]