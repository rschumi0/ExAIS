import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep37148 = tf.keras.layers.Input(shape=([1, 2]))

Sep37148 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep37148', )(in0Sep37148)
Thr34462 = keras.layers.ThresholdedReLU(theta=5.892031405794694, name = 'Thr34462', )(Sep37148)
Glo31972 = keras.layers.GlobalAveragePooling1D(name = 'Glo31972', )(Thr34462)
model = tf.keras.models.Model(inputs=[in0Sep37148], outputs=Glo31972)
w = model.get_layer('Sep37148').get_weights() 
w[0] = np.array([[[0.2066], [0.5469]]])
w[1] = np.array([[[0.3047, 0.8981], [0.838, 0.5201]]])
w[2] = np.array([0, 0])
model.get_layer('Sep37148').set_weights(w) 
in0Sep37148 = tf.constant([[[0.1622, 0.35]]])
print (np.array2string(model.predict([in0Sep37148],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo31972.png')

LSep37148 = separable_conv1D_layer([[[0.1622, 0.35]]], 1,[[[[0.2066], [0.5469]]],[[[0.3047, 0.8981], [0.838, 0.5201]]]],[0, 0], 1, true, Sep37148), 
LThr34462 = thresholded_relu_layer(Sep37148, 5.892031405794694, Thr34462), 
LGlo31972 = global_average_pooling1D_layer(Thr34462, Glo31972), 
exec_layers([LSep37148,LThr34462,LGlo31972],["Sep37148","Thr34462","Glo31972"],Glo31972,"Glo31972")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[0,0]]

Actual:   [[0, 0]]

Expected: [[0, 0]]