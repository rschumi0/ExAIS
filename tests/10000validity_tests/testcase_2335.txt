import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat88464 = tf.keras.layers.Input(shape=([1, 2]))
in0Ave25600 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Ave25600 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Bat88464 = keras.layers.BatchNormalization(axis=2, epsilon=0.5082436356143419,  name = 'Bat88464', )(in0Bat88464)
Res54425 = keras.layers.Reshape((1, 2, 1), name = 'Res54425', )(Bat88464)
Res25609 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res25609', )(Res54425)
Zer65069 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer65069', )(Res25609)
Ave25600 = keras.layers.Average(name = 'Ave25600', )([in0Ave25600,in1Ave25600])
Mas78454 = keras.layers.Masking(mask_value=1, name = 'Mas78454', )(Ave25600)
Zer47521 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer47521', )(Mas78454)
Mul32222 = keras.layers.Multiply(name = 'Mul32222', )([Zer65069,Zer47521])
model = tf.keras.models.Model(inputs=[in0Bat88464,in0Ave25600,in1Ave25600], outputs=Mul32222)
w = model.get_layer('Bat88464').get_weights() 
w[0] = np.array([0.2467, 0.0193])
w[1] = np.array([0.4862, 0.7463])
w[2] = np.array([0.3067, 0.8732])
w[3] = np.array([0.8225, 0.5541])
model.get_layer('Bat88464').set_weights(w) 
in0Bat88464 = tf.constant([[[1.0751, 1.3388]]])
in0Ave25600 = tf.constant([[[[[0.7555], [0.0497]]], [[[0.818], [0.9779]]]]])
in1Ave25600 = tf.constant([[[[[0.541], [0.2973]]], [[[0.0084], [0.2128]]]]])
print (np.array2string(model.predict([in0Bat88464,in0Ave25600,in1Ave25600],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul32222.png')

LBat88464 = batch_normalization_layer([[[1.0751, 1.3388]]], 2, 0.5082436356143419, [0.2467, 0.0193], [0.4862, 0.7463], [0.3067, 0.8732], [0.8225, 0.5541], Bat88464), 
LRes54425 = reshape_layer(Bat88464, [1, 2, 1], Res54425), 
LRes25609 = reshape_layer(Res54425, [1, 2, 1, 1], Res25609), 
LZer65069 = zero_padding3D_layer(Res25609, 1, 0, 1, 0, 1, 0, Zer65069), 
LAve25600 = average_layer([[[[[[0.7555], [0.0497]]], [[[0.818], [0.9779]]]]], [[[[[0.541], [0.2973]]], [[[0.0084], [0.2128]]]]]], Ave25600), 
LMas78454 = masking_layer(Ave25600, 1, Mas78454), 
LZer47521 = zero_padding3D_layer(Mas78454, 0, 0, 2, 0, 0, 0, Zer47521), 
LMul32222 = multiply_layer([Zer65069,Zer47521], Mul32222), 
exec_layers([LBat88464,LRes54425,LRes25609,LZer65069,LAve25600,LMas78454,LZer47521,LMul32222],["Bat88464","Res54425","Res25609","Zer65069","Ave25600","Mas78454","Zer47521","Mul32222"],Mul32222,"Mul32222")

Actual (Unparsed): [[[[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.4495002]]]]]

Expected (Unparsed): [[[[[0],[0]],[[0],[0]],[[0.0],[0.0]]],[[[0],[0]],[[0],[0.0]],[[0.0],[0.4495002161510587]]]]]

Actual:   [[[[[0], [0]], [[0], [0]], [[0], [0]]], [[[0], [0]], [[0], [0]], [[0], [0.4496]]]]]

Expected: [[[[[0], [0]], [[0], [0]], [[0], [0]]], [[[0], [0]], [[0], [0]], [[0], [0.4496]]]]]