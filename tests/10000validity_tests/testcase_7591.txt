import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe72600 = tf.keras.layers.Input(shape=([2, 1]))

PRe72600 = keras.layers.PReLU(name = 'PRe72600', input_shape=(2, 1))(in0PRe72600)
Thr4407 = keras.layers.ThresholdedReLU(theta=4.1406027859430985, name = 'Thr4407', )(PRe72600)
Max866 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='same', name = 'Max866', )(Thr4407)
model = tf.keras.models.Model(inputs=[in0PRe72600], outputs=Max866)
w = model.get_layer('PRe72600').get_weights() 
w[0] = np.array([[0.9251], [0.7835]])
model.get_layer('PRe72600').set_weights(w) 
in0PRe72600 = tf.constant([[[0.35], [0.3576]]])
print (np.array2string(model.predict([in0PRe72600],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max866.png')

LPRe72600 = prelu_layer([[[0.35], [0.3576]]], [[0.9251], [0.7835]], PRe72600), 
LThr4407 = thresholded_relu_layer(PRe72600, 4.1406027859430985, Thr4407), 
LMax866 = max_pool1D_layer(Thr4407, 1, 1, true, Max866), 
exec_layers([LPRe72600,LThr4407,LMax866],["PRe72600","Thr4407","Max866"],Max866,"Max866")

Actual (Unparsed): [[[0.0000000], [0.0000000]]]

Expected (Unparsed): [[[0],[0]]]

Actual:   [[[0], [0]]]

Expected: [[[0], [0]]]