import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max20137 = tf.keras.layers.Input(shape=([2, 1]))
in1Max20137 = tf.keras.layers.Input(shape=([2, 1]))
in0Con36089 = tf.keras.layers.Input(shape=([1, 1]))
in0Mul84499 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul84499 = tf.keras.layers.Input(shape=([1, 1]))
in0Max98160 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max98160 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max20137 = keras.layers.Maximum(name = 'Max20137', )([in0Max20137,in1Max20137])
Max55282 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max55282', )(Max20137)
Con36089 = keras.layers.Concatenate(axis=2, name = 'Con36089', )([Max55282,in0Con36089])
Mul84499 = keras.layers.Multiply(name = 'Mul84499', )([in0Mul84499,in1Mul84499])
Thr94519 = keras.layers.ThresholdedReLU(theta=1.6493014798895322, name = 'Thr94519', )(Mul84499)
Max98160 = keras.layers.Maximum(name = 'Max98160', )([in0Max98160,in1Max98160])
Res72138 = keras.layers.Reshape((2, 1), name = 'Res72138', )(Max98160)
Dot11849 = keras.layers.Dot(axes=(2, 2), name = 'Dot11849', )([Thr94519,Res72138])
Min51004 = keras.layers.Minimum(name = 'Min51004', )([Con36089,Dot11849])
model = tf.keras.models.Model(inputs=[in0Max20137,in1Max20137,in0Con36089,in0Mul84499,in1Mul84499,in0Max98160,in1Max98160], outputs=Min51004)
in0Max20137 = tf.constant([[[0.2825], [0.8711]]])
in1Max20137 = tf.constant([[[0.3545], [0.1542]]])
in0Con36089 = tf.constant([[[0.3147]]])
in0Mul84499 = tf.constant([[[0.3268]]])
in1Mul84499 = tf.constant([[[0.5457]]])
in0Max98160 = tf.constant([[[[0.5285]], [[0.8206]]]])
in1Max98160 = tf.constant([[[[0.5898]], [[0.0926]]]])
print (np.array2string(model.predict([in0Max20137,in1Max20137,in0Con36089,in0Mul84499,in1Mul84499,in0Max98160,in1Max98160],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min51004.png')

LMax20137 = maximum_layer([[[[0.2825], [0.8711]]], [[[0.3545], [0.1542]]]], Max20137), 
LMax55282 = max_pool1D_layer(Max20137, 2, Max55282), 
LCon36089 = concatenate_layer([Max55282,[[[0.3147]]]], 2, Con36089), 
LMul84499 = multiply_layer([[[[0.3268]]], [[[0.5457]]]], Mul84499), 
LThr94519 = thresholded_relu_layer(Mul84499, 1.6493014798895322, Thr94519), 
LMax98160 = maximum_layer([[[[[0.5285]], [[0.8206]]]], [[[[0.5898]], [[0.0926]]]]], Max98160), 
LRes72138 = reshape_layer(Max98160, [2, 1], Res72138), 
LDot11849 = dot_layer(Thr94519,Res72138, 2, 2, Dot11849), 
LMin51004 = minimum_layer([Con36089,Dot11849], Min51004), 
exec_layers([LMax20137,LMax55282,LCon36089,LMul84499,LThr94519,LMax98160,LRes72138,LDot11849,LMin51004],["Max20137","Max55282","Con36089","Mul84499","Thr94519","Max98160","Res72138","Dot11849","Min51004"],Min51004,"Min51004")

Actual (Unparsed): [[[0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0]]]

Actual:   [[[0, 0]]]

Expected: [[[0, 0]]]