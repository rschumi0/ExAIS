import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave51754 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Ave51754 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Ave94036 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave94036 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con16481 = tf.keras.layers.Input(shape=([1, 2, 3]))

Ave51754 = keras.layers.Average(name = 'Ave51754', )([in0Ave51754,in1Ave51754])
Res22581 = keras.layers.Reshape((1, 2, 4), name = 'Res22581', )(Ave51754)
Ave94036 = keras.layers.Average(name = 'Ave94036', )([in0Ave94036,in1Ave94036])
Con16481 = keras.layers.Concatenate(axis=3, name = 'Con16481', )([Ave94036,in0Con16481])
Mul37690 = keras.layers.Multiply(name = 'Mul37690', )([Res22581,Con16481])
model = tf.keras.models.Model(inputs=[in0Ave51754,in1Ave51754,in0Ave94036,in1Ave94036,in0Con16481], outputs=Mul37690)
in0Ave51754 = tf.constant([[[[[0.3863, 0.7324], [0.0138, 0.208]], [[0.7434, 0.2888], [0.3826, 0.8935]]]]])
in1Ave51754 = tf.constant([[[[[0.747, 0.102], [0.2581, 0.6983]], [[0.1452, 0.2837], [0.3333, 0.4469]]]]])
in0Ave94036 = tf.constant([[[[0.3459], [0.2202]]]])
in1Ave94036 = tf.constant([[[[0.5498], [0.7399]]]])
in0Con16481 = tf.constant([[[[0.2906, 0.6941, 0.1683], [0.5881, 0.3156, 0.6867]]]])
print (np.array2string(model.predict([in0Ave51754,in1Ave51754,in0Ave94036,in1Ave94036,in0Con16481],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul37690.png')

LAve51754 = average_layer([[[[[[0.3863, 0.7324], [0.0138, 0.208]], [[0.7434, 0.2888], [0.3826, 0.8935]]]]], [[[[[0.747, 0.102], [0.2581, 0.6983]], [[0.1452, 0.2837], [0.3333, 0.4469]]]]]], Ave51754), 
LRes22581 = reshape_layer(Ave51754, [1, 2, 4], Res22581), 
LAve94036 = average_layer([[[[[0.3459], [0.2202]]]], [[[[0.5498], [0.7399]]]]], Ave94036), 
LCon16481 = concatenate_layer([Ave94036,[[[[0.2906, 0.6941, 0.1683], [0.5881, 0.3156, 0.6867]]]]], 3, Con16481), 
LMul37690 = multiply_layer([Res22581,Con16481], Mul37690), 
exec_layers([LAve51754,LRes22581,LAve94036,LCon16481,LMul37690],["Ave51754","Res22581","Ave94036","Con16481","Mul37690"],Mul37690,"Mul37690")

Actual (Unparsed): [[[[0.2537742, 0.1212383, 0.0943629, 0.0762651], [0.2132862, 0.1683436, 0.1129690, 0.4602263]]]]

Expected (Unparsed): [[[[0.2537742025,0.12123832000000001,0.094362895,0.076265145],[0.21328621499999997,0.168343625,0.11296901999999999,0.46022634]]]]

Actual:   [[[[0.2538, 0.1213, 0.0944, 0.0763], [0.2133, 0.1684, 0.113, 0.4603]]]]

Expected: [[[[0.2538, 0.1213, 0.0944, 0.0763], [0.2133, 0.1684, 0.113, 0.4603]]]]