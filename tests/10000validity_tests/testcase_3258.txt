import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max52382 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max52382 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max52382 = keras.layers.Maximum(name = 'Max52382', )([in0Max52382,in1Max52382])
Res83583 = keras.layers.Reshape((2, 1), name = 'Res83583', )(Max52382)
LST92043 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST92043', )(Res83583)
model = tf.keras.models.Model(inputs=[in0Max52382,in1Max52382], outputs=LST92043)
w = model.get_layer('LST92043').get_weights() 
w[0] = np.array([[7, 5, 10, 8, 8, 1, 7, 2]])
w[1] = np.array([[3, 10, 5, 4, 7, 10, 5, 1], [9, 10, 8, 9, 8, 4, 9, 5]])
w[2] = np.array([3, 8, 7, 9, 5, 1, 3, 5])
model.get_layer('LST92043').set_weights(w) 
in0Max52382 = tf.constant([[[[0.8236]], [[0.8184]]]])
in1Max52382 = tf.constant([[[[0.1907]], [[0.0251]]]])
print (np.array2string(model.predict([in0Max52382,in1Max52382],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST92043.png')

LMax52382 = maximum_layer([[[[[0.8236]], [[0.8184]]]], [[[[0.1907]], [[0.0251]]]]], Max52382), 
LRes83583 = reshape_layer(Max52382, [2, 1], Res83583), 
LLST92043 = lstm_layer(Res83583,[[7, 5, 10, 8, 8, 1, 7, 2]],[[3, 10, 5, 4, 7, 10, 5, 1], [9, 10, 8, 9, 8, 4, 9, 5]],[3, 8, 7, 9, 5, 1, 3, 5], LST92043), 
exec_layers([LMax52382,LRes83583,LLST92043],["Max52382","Res83583","LST92043"],LST92043,"LST92043")

Actual (Unparsed): [[0.9640165, 0.9602418]]

Expected (Unparsed): [[0.9640165475688938,0.9602417568928204]]

Actual:   [[0.9641, 0.9603]]

Expected: [[0.9641, 0.9603]]