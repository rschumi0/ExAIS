import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub99335 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub99335 = tf.keras.layers.Input(shape=([3, 2, 2]))
in0Add57274 = tf.keras.layers.Input(shape=([1, 2]))
in1Add57274 = tf.keras.layers.Input(shape=([1, 2]))
in0Con1382 = tf.keras.layers.Input(shape=([3, 2]))

Sub99335 = keras.layers.Subtract(name = 'Sub99335', )([in0Sub99335,in1Sub99335])
Res88431 = keras.layers.Reshape((3, 4), name = 'Res88431', )(Sub99335)
Add57274 = keras.layers.Add(name = 'Add57274', )([in0Add57274,in1Add57274])
Zer4643 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer4643', )(Add57274)
Con1382 = keras.layers.Concatenate(axis=2, name = 'Con1382', )([Zer4643,in0Con1382])
Ave65423 = keras.layers.Average(name = 'Ave65423', )([Res88431,Con1382])
model = tf.keras.models.Model(inputs=[in0Sub99335,in1Sub99335,in0Add57274,in1Add57274,in0Con1382], outputs=Ave65423)
in0Sub99335 = tf.constant([[[[0.4258, 0.934], [0.7809, 0.0593]], [[0.3295, 0.0167], [0.5775, 0.0906]], [[0.4739, 0.3912], [0.9576, 0.686]]]])
in1Sub99335 = tf.constant([[[[0.3355, 0.4326], [0.6571, 0.6596]], [[0.1801, 0.6009], [0.2545, 0.6997]], [[0.8979, 0.8236], [0.8058, 0.382]]]])
in0Add57274 = tf.constant([[[0.9744, 0.8577]]])
in1Add57274 = tf.constant([[[0.852, 0.945]]])
in0Con1382 = tf.constant([[[0.8741, 0.1523], [0.9834, 0.5318], [0.7756, 0.7254]]])
print (np.array2string(model.predict([in0Sub99335,in1Sub99335,in0Add57274,in1Add57274,in0Con1382],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave65423.png')

LSub99335 = subtract_layer([[[[0.4258, 0.934], [0.7809, 0.0593]], [[0.3295, 0.0167], [0.5775, 0.0906]], [[0.4739, 0.3912], [0.9576, 0.686]]]], [[[[0.3355, 0.4326], [0.6571, 0.6596]], [[0.1801, 0.6009], [0.2545, 0.6997]], [[0.8979, 0.8236], [0.8058, 0.382]]]], Sub99335), 
LRes88431 = reshape_layer(Sub99335, [3, 4], Res88431), 
LAdd57274 = add_layer([[[[0.9744, 0.8577]]], [[[0.852, 0.945]]]], Add57274), 
LZer4643 = zero_padding1D_layer(Add57274, 2, 0, Zer4643), 
LCon1382 = concatenate_layer([Zer4643,[[[0.8741, 0.1523], [0.9834, 0.5318], [0.7756, 0.7254]]]], 2, Con1382), 
LAve65423 = average_layer([Res88431,Con1382], Ave65423), 
exec_layers([LSub99335,LRes88431,LAdd57274,LZer4643,LCon1382,LAve65423],["Sub99335","Res88431","Add57274","Zer4643","Con1382","Ave65423"],Ave65423,"Ave65423")

Actual (Unparsed): [[[0.0451500, 0.2507000, 0.4989500, -0.2240000], [0.0747000, -0.2921000, 0.6532000, -0.0386500], [0.7012000, 0.6851500, 0.4637000, 0.5147000]]]

Expected (Unparsed): [[[0.045149999999999996,0.25070000000000003,0.49895,-0.22399999999999998],[0.0747,-0.29209999999999997,0.6532,-0.03864999999999996],[0.7012,0.6851499999999999,0.4637,0.5147]]]

Actual:   [[[0.0452, 0.2507, 0.499, -0.224], [0.0747, -0.2921, 0.6532, -0.0386], [0.7012, 0.6852, 0.4637, 0.5147]]]

Expected: [[[0.0452, 0.2508, 0.499, -0.2239], [0.0747, -0.292, 0.6532, -0.0386], [0.7012, 0.6852, 0.4637, 0.5147]]]