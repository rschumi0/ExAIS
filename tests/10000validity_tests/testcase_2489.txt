import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave59809 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Ave59809 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Dot799 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot799 = tf.keras.layers.Input(shape=([2, 2]))

Ave59809 = keras.layers.Average(name = 'Ave59809', )([in0Ave59809,in1Ave59809])
Res84759 = keras.layers.Reshape((1, 2, 2), name = 'Res84759', )(Ave59809)
Max26474 = keras.layers.MaxPool2D(pool_size=(1, 2), name = 'Max26474', )(Res84759)
Res3283 = keras.layers.Reshape((1, 2), name = 'Res3283', )(Max26474)
Zer5681 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer5681', )(Res3283)
Dot799 = keras.layers.Dot(axes=(2, 2), name = 'Dot799', )([in0Dot799,in1Dot799])
Max30772 = keras.layers.Maximum(name = 'Max30772', )([Zer5681,Dot799])
model = tf.keras.models.Model(inputs=[in0Ave59809,in1Ave59809,in0Dot799,in1Dot799], outputs=Max30772)
in0Ave59809 = tf.constant([[[[[0.7854, 0.911]], [[0.3891, 0.2876]]]]])
in1Ave59809 = tf.constant([[[[[0.756, 0.7696]], [[0.2907, 0.7902]]]]])
in0Dot799 = tf.constant([[[0.1723, 0.1682], [0.2441, 0.8098]]])
in1Dot799 = tf.constant([[[0.4117, 0.4589], [0.8149, 0.0083]]])
print (np.array2string(model.predict([in0Ave59809,in1Ave59809,in0Dot799,in1Dot799],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max30772.png')

LAve59809 = average_layer([[[[[[0.7854, 0.911]], [[0.3891, 0.2876]]]]], [[[[[0.756, 0.7696]], [[0.2907, 0.7902]]]]]], Ave59809), 
LRes84759 = reshape_layer(Ave59809, [1, 2, 2], Res84759), 
LMax26474 = max_pool2D_layer(Res84759, 1, 2, Max26474), 
LRes3283 = reshape_layer(Max26474, [1, 2], Res3283), 
LZer5681 = zero_padding1D_layer(Res3283, 1, 0, Zer5681), 
LDot799 = dot_layer([[[0.1723, 0.1682], [0.2441, 0.8098]]], [[[0.4117, 0.4589], [0.8149, 0.0083]]], 2, 2, Dot799), 
LMax30772 = maximum_layer([Zer5681,Dot799], Max30772), 
exec_layers([LAve59809,LRes84759,LMax26474,LRes3283,LZer5681,LDot799,LMax30772],["Ave59809","Res84759","Max26474","Res3283","Zer5681","Dot799","Max30772"],Max30772,"Max30772")

Actual (Unparsed): [[[0.1481229, 0.1418033], [0.7707000, 0.8403000]]]

Expected (Unparsed): [[[0.14812289,0.14180333],[0.7706999999999999,0.8403]]]

Actual:   [[[0.1482, 0.1419], [0.7707, 0.8403]]]

Expected: [[[0.1482, 0.1419], [0.7707, 0.8403]]]