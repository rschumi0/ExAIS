import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave89218 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave89218 = tf.keras.layers.Input(shape=([2, 2]))
in0Con30262 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Sub67692 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub67692 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con38159 = tf.keras.layers.Input(shape=([8, 1]))
in0Sub24975 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub24975 = tf.keras.layers.Input(shape=([3, 2]))
in0Mul87085 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul87085 = tf.keras.layers.Input(shape=([2, 1, 1]))

Ave89218 = keras.layers.Average(name = 'Ave89218', )([in0Ave89218,in1Ave89218])
Res77269 = keras.layers.Reshape((2, 2, 1), name = 'Res77269', )(Ave89218)
Con30262 = keras.layers.Concatenate(axis=3, name = 'Con30262', )([Res77269,in0Con30262])
Sub67692 = keras.layers.Subtract(name = 'Sub67692', )([in0Sub67692,in1Sub67692])
Ave81248 = keras.layers.Average(name = 'Ave81248', )([Con30262,Sub67692])
Fla1810 = keras.layers.Flatten(name = 'Fla1810', )(Ave81248)
Res71424 = keras.layers.Reshape((8, 1), name = 'Res71424', )(Fla1810)
Con38159 = keras.layers.Concatenate(axis=2, name = 'Con38159', )([Res71424,in0Con38159])
Sub24975 = keras.layers.Subtract(name = 'Sub24975', )([in0Sub24975,in1Sub24975])
Zer97182 = keras.layers.ZeroPadding1D(padding=((5, 0)), name = 'Zer97182', )(Sub24975)
Dot11788 = keras.layers.Dot(axes=(2, 2), name = 'Dot11788', )([Con38159,Zer97182])
Res5938 = keras.layers.Reshape((8, 8, 1), name = 'Res5938', )(Dot11788)
Mul87085 = keras.layers.Multiply(name = 'Mul87085', )([in0Mul87085,in1Mul87085])
Zer44478 = keras.layers.ZeroPadding2D(padding=((6, 0), (7, 0)), name = 'Zer44478', )(Mul87085)
Mul16698 = keras.layers.Multiply(name = 'Mul16698', )([Res5938,Zer44478])
model = tf.keras.models.Model(inputs=[in0Ave89218,in1Ave89218,in0Con30262,in0Sub67692,in1Sub67692,in0Con38159,in0Sub24975,in1Sub24975,in0Mul87085,in1Mul87085], outputs=Mul16698)
in0Ave89218 = tf.constant([[[0.3253, 0.7532], [0.0142, 0.1306]]])
in1Ave89218 = tf.constant([[[0.0436, 0.9636], [0.3372, 0.3389]]])
in0Con30262 = tf.constant([[[[0.7907], [0.6922]], [[0.5302], [0.6438]]]])
in0Sub67692 = tf.constant([[[[0.7447, 0.6768], [0.341, 0.6435]], [[0.2881, 0.2635], [0.6842, 0.7654]]]])
in1Sub67692 = tf.constant([[[[0.82, 0.5421], [0.9648, 0.4225]], [[0.4418, 0.3974], [0.7339, 0.5048]]]])
in0Con38159 = tf.constant([[[0.6292], [0.3713], [0.5852], [0.3968], [0.2809], [0.2443], [0.451], [0.2327]]])
in0Sub24975 = tf.constant([[[0.5657, 0.8307], [0.9086, 0.4122], [0.1746, 0.2136]]])
in1Sub24975 = tf.constant([[[0.251, 0.5925], [0.6396, 0.6487], [0.7158, 0.2741]]])
in0Mul87085 = tf.constant([[[[0.838]], [[0.377]]]])
in1Mul87085 = tf.constant([[[[0.7629]], [[0.7528]]]])
print (np.array2string(model.predict([in0Ave89218,in1Ave89218,in0Con30262,in0Sub67692,in1Sub67692,in0Con38159,in0Sub24975,in1Sub24975,in0Mul87085,in1Mul87085],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul16698.png')

LAve89218 = average_layer([[[[0.3253, 0.7532], [0.0142, 0.1306]]], [[[0.0436, 0.9636], [0.3372, 0.3389]]]], Ave89218), 
LRes77269 = reshape_layer(Ave89218, [2, 2, 1], Res77269), 
LCon30262 = concatenate_layer([Res77269,[[[[0.7907], [0.6922]], [[0.5302], [0.6438]]]]], 3, Con30262), 
LSub67692 = subtract_layer([[[[0.7447, 0.6768], [0.341, 0.6435]], [[0.2881, 0.2635], [0.6842, 0.7654]]]], [[[[0.82, 0.5421], [0.9648, 0.4225]], [[0.4418, 0.3974], [0.7339, 0.5048]]]], Sub67692), 
LAve81248 = average_layer([Con30262,Sub67692], Ave81248), 
LFla1810 = flatten_layer(Ave81248, Fla1810), 
LRes71424 = reshape_layer(Fla1810, [8, 1], Res71424), 
LCon38159 = concatenate_layer([Res71424,[[[0.6292], [0.3713], [0.5852], [0.3968], [0.2809], [0.2443], [0.451], [0.2327]]]], 2, Con38159), 
LSub24975 = subtract_layer([[[0.5657, 0.8307], [0.9086, 0.4122], [0.1746, 0.2136]]], [[[0.251, 0.5925], [0.6396, 0.6487], [0.7158, 0.2741]]], Sub24975), 
LZer97182 = zero_padding1D_layer(Sub24975, 5, 0, Zer97182), 
LDot11788 = dot_layer(Con38159,Zer97182, 2, 2, Dot11788), 
LRes5938 = reshape_layer(Dot11788, [8, 8, 1], Res5938), 
LMul87085 = multiply_layer([[[[[0.838]], [[0.377]]]], [[[[0.7629]], [[0.7528]]]]], Mul87085), 
LZer44478 = zero_padding2D_layer(Mul87085, 6, 0, 7, 0, Zer44478), 
LMul16698 = multiply_layer([Res5938,Zer44478], Mul16698), 
exec_layers([LAve89218,LRes77269,LCon30262,LSub67692,LAve81248,LFla1810,LRes71424,LCon38159,LSub24975,LZer97182,LDot11788,LRes5938,LMul87085,LZer44478,LMul16698],["Ave89218","Res77269","Con30262","Sub67692","Ave81248","Fla1810","Res71424","Con38159","Sub24975","Zer97182","Dot11788","Res5938","Mul87085","Zer44478","Mul16698"],Mul16698,"Mul16698")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0000000], [-0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0000000], [-0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0000000], [-0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0000000], [-0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0000000], [-0.0494571]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.0734514]]]]

Expected (Unparsed): [[[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.0],[-0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.0],[-0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.0],[-0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.0],[-0.0]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.0],[-0.049457056251306]],[[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[0.0],[-0.07345144069234401]]]]

Actual:   [[[[0], [0], [0], [0], [0], [0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [0], [-0]], [[0], [0], [0], [0], [0], [0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [0], [-0]], [[0], [0], [0], [0], [0], [0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [-0], [-0.0494]], [[0], [0], [0], [0], [0], [0], [0], [-0.0734]]]]

Expected: [[[[0], [0], [0], [0], [0], [0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [0], [-0]], [[0], [0], [0], [0], [0], [0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [0], [-0]], [[0], [0], [0], [0], [0], [0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [-0], [-0]], [[0], [0], [0], [0], [0], [0], [-0], [-0.0494]], [[0], [0], [0], [0], [0], [0], [0], [-0.0734]]]]