import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub20585 = tf.keras.layers.Input(shape=([3]))
in1Sub20585 = tf.keras.layers.Input(shape=([3]))

Sub20585 = keras.layers.Subtract(name = 'Sub20585', )([in0Sub20585,in1Sub20585])
Res28047 = keras.layers.Reshape((3, 1), name = 'Res28047', )(Sub20585)
Loc95595 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc95595', )(Res28047)
model = tf.keras.models.Model(inputs=[in0Sub20585,in1Sub20585], outputs=Loc95595)
w = model.get_layer('Loc95595').get_weights() 
w[0] = np.array([[[0.7132, 0.8813]], [[0.569, 0.6835]], [[0.3934, 0.9882]]])
w[1] = np.array([[0, 0], [0, 0], [0, 0]])
model.get_layer('Loc95595').set_weights(w) 
in0Sub20585 = tf.constant([[0.7956, 0.0091, 0.4479]])
in1Sub20585 = tf.constant([[0.9083, 0.1813, 0.7162]])
print (np.array2string(model.predict([in0Sub20585,in1Sub20585],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc95595.png')

LSub20585 = subtract_layer([[0.7956, 0.0091, 0.4479]], [[0.9083, 0.1813, 0.7162]], Sub20585), 
LRes28047 = reshape_layer(Sub20585, [3, 1], Res28047), 
LLoc95595 = locally_connected1D_layer(Res28047, 1,[[[0.7132, 0.8813]], [[0.569, 0.6835]], [[0.3934, 0.9882]]],[[0, 0], [0, 0], [0, 0]], 1, Loc95595), 
exec_layers([LSub20585,LRes28047,LLoc95595],["Sub20585","Res28047","Loc95595"],Loc95595,"Loc95595")

Actual (Unparsed): [[[-0.0803776, -0.0993225], [-0.0979818, -0.1176987], [-0.1055492, -0.2651341]]]

Expected (Unparsed): [[[-0.08037764000000001,-0.09932251000000002],[-0.09798179999999998,-0.11769869999999999],[-0.10554921999999999,-0.2651340599999999]]]

Actual:   [[[-0.0803, -0.0993], [-0.0979, -0.1176], [-0.1055, -0.2651]]]

Expected: [[[-0.0803, -0.0993], [-0.0979, -0.1176], [-0.1055, -0.2651]]]