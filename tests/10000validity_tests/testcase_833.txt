import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep97458 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con16233 = tf.keras.layers.Input(shape=([3, 1]))
in0Sub88850 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub88850 = tf.keras.layers.Input(shape=([2, 2]))

Sep97458 = keras.layers.SeparableConv2D(3, (1, 2),strides=(2, 2), padding='valid', name = 'Sep97458', )(in0Sep97458)
Res88441 = keras.layers.Reshape((1, 3), name = 'Res88441', )(Sep97458)
Glo79673 = keras.layers.GlobalMaxPool1D(name = 'Glo79673', )(Res88441)
Res34993 = keras.layers.Reshape((3, 1), name = 'Res34993', )(Glo79673)
Con16233 = keras.layers.Concatenate(axis=2, name = 'Con16233', )([Res34993,in0Con16233])
Sub88850 = keras.layers.Subtract(name = 'Sub88850', )([in0Sub88850,in1Sub88850])
Zer27164 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer27164', )(Sub88850)
Add72014 = keras.layers.Add(name = 'Add72014', )([Con16233,Zer27164])
model = tf.keras.models.Model(inputs=[in0Sep97458,in0Con16233,in0Sub88850,in1Sub88850], outputs=Add72014)
w = model.get_layer('Sep97458').get_weights() 
w[0] = np.array([[[[0.04]], [[0.5836]]]])
w[1] = np.array([[[[0.4075, 0.2291, 0.4091]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep97458').set_weights(w) 
in0Sep97458 = tf.constant([[[[0.9437], [0.9992]], [[0.1783], [0.6693]]]])
in0Con16233 = tf.constant([[[0.3231], [0.6368], [0.7643]]])
in0Sub88850 = tf.constant([[[0.5632, 0.5674], [0.9366, 0.9588]]])
in1Sub88850 = tf.constant([[[0.6577, 0.1587], [0.9258, 0.7726]]])
print (np.array2string(model.predict([in0Sep97458,in0Con16233,in0Sub88850,in1Sub88850],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add72014.png')

LSep97458 = separable_conv2D_layer([[[[0.9437], [0.9992]], [[0.1783], [0.6693]]]], 1, 2,[[[[[0.04]], [[0.5836]]]],[[[[0.4075, 0.2291, 0.4091]]]]],[0, 0, 0], 2, 2, false, Sep97458), 
LRes88441 = reshape_layer(Sep97458, [1, 3], Res88441), 
LGlo79673 = global_max_pool1D_layer(Res88441, Glo79673), 
LRes34993 = reshape_layer(Glo79673, [3, 1], Res34993), 
LCon16233 = concatenate_layer([Res34993,[[[0.3231], [0.6368], [0.7643]]]], 2, Con16233), 
LSub88850 = subtract_layer([[[0.5632, 0.5674], [0.9366, 0.9588]]], [[[0.6577, 0.1587], [0.9258, 0.7726]]], Sub88850), 
LZer27164 = zero_padding1D_layer(Sub88850, 1, 0, Zer27164), 
LAdd72014 = add_layer([Con16233,Zer27164], Add72014), 
exec_layers([LSep97458,LRes88441,LGlo79673,LRes34993,LCon16233,LSub88850,LZer27164,LAdd72014],["Sep97458","Res88441","Glo79673","Res34993","Con16233","Sub88850","Zer27164","Add72014"],Add72014,"Add72014")

Actual (Unparsed): [[[0.2530091, 0.3231000], [0.0477439, 1.0455000], [0.2648025, 0.9505000]]]

Expected (Unparsed): [[[0.2530090564,0.3231],[0.04774386459200006,1.0455],[0.26480246619200004,0.9505]]]

Actual:   [[[0.2531, 0.3231], [0.0478, 1.0455], [0.2649, 0.9505]]]

Expected: [[[0.2531, 0.3231], [0.0478, 1.0455], [0.2649, 0.9505]]]