import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max47351 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max47351 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Ave44420 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave44420 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Max47351 = keras.layers.Maximum(name = 'Max47351', )([in0Max47351,in1Max47351])
Res62291 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res62291', )(Max47351)
Ave44420 = keras.layers.Average(name = 'Ave44420', )([in0Ave44420,in1Ave44420])
Zer49961 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer49961', )(Ave44420)
Sub64639 = keras.layers.Subtract(name = 'Sub64639', )([Res62291,Zer49961])
Sof38387 = keras.layers.Softmax(axis=1, name = 'Sof38387', )(Sub64639)
model = tf.keras.models.Model(inputs=[in0Max47351,in1Max47351,in0Ave44420,in1Ave44420], outputs=Sof38387)
in0Max47351 = tf.constant([[[[0.4037, 0.5046]], [[0.7655, 0.6987]]]])
in1Max47351 = tf.constant([[[[0.7575, 0.4461]], [[0.7965, 0.7381]]]])
in0Ave44420 = tf.constant([[[[[0.1232], [0.2853]]]]])
in1Ave44420 = tf.constant([[[[[0.8286], [0.9108]]]]])
print (np.array2string(model.predict([in0Max47351,in1Max47351,in0Ave44420,in1Ave44420],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof38387.png')

LMax47351 = maximum_layer([[[[[0.4037, 0.5046]], [[0.7655, 0.6987]]]], [[[[0.7575, 0.4461]], [[0.7965, 0.7381]]]]], Max47351), 
LRes62291 = reshape_layer(Max47351, [2, 1, 2, 1], Res62291), 
LAve44420 = average_layer([[[[[[0.1232], [0.2853]]]]], [[[[[0.8286], [0.9108]]]]]], Ave44420), 
LZer49961 = zero_padding3D_layer(Ave44420, 1, 0, 0, 0, 0, 0, Zer49961), 
LSub64639 = subtract_layer(Res62291,Zer49961, Sub64639), 
LSof38387 = softmax_layer(Sub64639, 1, Sof38387), 
exec_layers([LMax47351,LRes62291,LAve44420,LZer49961,LSub64639,LSof38387],["Max47351","Res62291","Ave44420","Zer49961","Sub64639","Sof38387"],Sof38387,"Sof38387")

Actual (Unparsed): [[[[[0.6075201], [0.5901414]]], [[[0.3924799], [0.4098586]]]]]

Expected (Unparsed): [[[[[0.6075201154110508],[0.590141412810367]]],[[[0.3924798845889492],[0.4098585871896329]]]]]

Actual:   [[[[[0.6076], [0.5902]]], [[[0.3925], [0.4099]]]]]

Expected: [[[[[0.6076], [0.5902]]], [[[0.3925], [0.4099]]]]]