import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add43136 = tf.keras.layers.Input(shape=([1, 2]))
in1Add43136 = tf.keras.layers.Input(shape=([1, 2]))
in0Con9009 = tf.keras.layers.Input(shape=([3, 5, 1]))
in0Den86745 = tf.keras.layers.Input(shape=([3, 5, 3]))

Add43136 = keras.layers.Add(name = 'Add43136', )([in0Add43136,in1Add43136])
Res74233 = keras.layers.Reshape((1, 2, 1), name = 'Res74233', )(Add43136)
Zer92234 = keras.layers.ZeroPadding2D(padding=((2, 0), (3, 0)), name = 'Zer92234', )(Res74233)
Con9009 = keras.layers.Concatenate(axis=3, name = 'Con9009', )([Zer92234,in0Con9009])
Den86745 = keras.layers.Dense(2,name = 'Den86745', )(in0Den86745)
Max3931 = keras.layers.Maximum(name = 'Max3931', )([Con9009,Den86745])
Res73368 = keras.layers.Reshape((3, 5, 2, 1), name = 'Res73368', )(Max3931)
Cro42390 = keras.layers.Cropping3D(cropping=((0, 1), (4, 0), (1, 0)), name = 'Cro42390', )(Res73368)
Res13179 = keras.layers.Reshape((2, 1, 1), name = 'Res13179', )(Cro42390)
Sep1284 = keras.layers.SeparableConv2D(4, (1, 1),strides=(2, 2), padding='same', name = 'Sep1284', )(Res13179)
model = tf.keras.models.Model(inputs=[in0Add43136,in1Add43136,in0Con9009,in0Den86745], outputs=Sep1284)
w = model.get_layer('Den86745').get_weights() 
w[0] = np.array([[0.772, 0.0177], [0.7519, 0.0872], [0.5231, 0.422]])
w[1] = np.array([0.969, 0.7884])
model.get_layer('Den86745').set_weights(w) 
w = model.get_layer('Sep1284').get_weights() 
w[0] = np.array([[[[0.8412]]]])
w[1] = np.array([[[[0.1151, 0.9151, 0.8246, 0.3377]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep1284').set_weights(w) 
in0Add43136 = tf.constant([[[0.0415, 0.8621]]])
in1Add43136 = tf.constant([[[0.6341, 0.9049]]])
in0Con9009 = tf.constant([[[[0.2569], [0.5121], [0.9036], [0.7188], [0.657]], [[0.0561], [0.0871], [0.307], [0.6626], [0.3847]], [[0.9346], [0.7612], [0.1364], [0.4086], [0.1344]]]])
in0Den86745 = tf.constant([[[[0.5158, 0.9698, 0.5871], [0.048, 0.5181, 0.9036], [0.8018, 0.0809, 0.6607], [0.1772, 0.4131, 0.2652], [0.1988, 0.2147, 0.3857]], [[0.0408, 0.3804, 0.4781], [0.0509, 0.8436, 0.171], [0.1348, 0.601, 0.8204], [0.7329, 0.1891, 0.7328], [0.5734, 0.4837, 0.5475]], [[0.8367, 0.9928, 0.7731], [0.0564, 0.6133, 0.7048], [0.2212, 0.1507, 0.7649], [0.6475, 0.5431, 0.3921], [0.4594, 0.8198, 0.2472]]]])
print (np.array2string(model.predict([in0Add43136,in1Add43136,in0Con9009,in0Den86745],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep1284.png')

LAdd43136 = add_layer([[[[0.0415, 0.8621]]], [[[0.6341, 0.9049]]]], Add43136), 
LRes74233 = reshape_layer(Add43136, [1, 2, 1], Res74233), 
LZer92234 = zero_padding2D_layer(Res74233, 2, 0, 3, 0, Zer92234), 
LCon9009 = concatenate_layer([Zer92234,[[[[0.2569], [0.5121], [0.9036], [0.7188], [0.657]], [[0.0561], [0.0871], [0.307], [0.6626], [0.3847]], [[0.9346], [0.7612], [0.1364], [0.4086], [0.1344]]]]], 3, Con9009), 
LDen86745 = dense_layer([[[[0.5158, 0.9698, 0.5871], [0.048, 0.5181, 0.9036], [0.8018, 0.0809, 0.6607], [0.1772, 0.4131, 0.2652], [0.1988, 0.2147, 0.3857]], [[0.0408, 0.3804, 0.4781], [0.0509, 0.8436, 0.171], [0.1348, 0.601, 0.8204], [0.7329, 0.1891, 0.7328], [0.5734, 0.4837, 0.5475]], [[0.8367, 0.9928, 0.7731], [0.0564, 0.6133, 0.7048], [0.2212, 0.1507, 0.7649], [0.6475, 0.5431, 0.3921], [0.4594, 0.8198, 0.2472]]]], [[0.772, 0.0177], [0.7519, 0.0872], [0.5231, 0.422]],[0.969, 0.7884], Den86745), 
LMax3931 = maximum_layer([Con9009,Den86745], Max3931), 
LRes73368 = reshape_layer(Max3931, [3, 5, 2, 1], Res73368), 
LCro42390 = cropping3D_layer(Res73368, 0, 1, 4, 0, 1, 0, Cro42390), 
LRes13179 = reshape_layer(Cro42390, [2, 1, 1], Res13179), 
LSep1284 = separable_conv2D_layer(Res13179, 1, 1,[[[[[0.8412]]]],[[[[0.1151, 0.9151, 0.8246, 0.3377]]]]],[0, 0, 0, 0], 2, 2, true, Sep1284), 
exec_layers([LAdd43136,LRes74233,LZer92234,LCon9009,LDen86745,LMax3931,LRes73368,LCro42390,LRes13179,LSep1284],["Add43136","Res74233","Zer92234","Con9009","Den86745","Max3931","Res73368","Cro42390","Res13179","Sep1284"],Sep1284,"Sep1284")

Actual (Unparsed): [[[[0.0942472, 0.7493105, 0.6752065, 0.2765186]]]]

Expected (Unparsed): [[[[0.09424723254071998,0.7493105343007199,0.6752064982891199,0.27651859625543995]]]]

Actual:   [[[[0.0943, 0.7494, 0.6753, 0.2766]]]]

Expected: [[[[0.0943, 0.7494, 0.6753, 0.2766]]]]