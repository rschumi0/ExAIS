import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub69317 = tf.keras.layers.Input(shape=([2]))
in1Sub69317 = tf.keras.layers.Input(shape=([2]))
in0Min51475 = tf.keras.layers.Input(shape=([2, 1]))
in1Min51475 = tf.keras.layers.Input(shape=([2, 1]))
in0PRe75759 = tf.keras.layers.Input(shape=([1, 1]))
in0Con881 = tf.keras.layers.Input(shape=([2]))
in0Ave33499 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave33499 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con5631 = tf.keras.layers.Input(shape=([3, 1, 1]))
in0Ave26538 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave26538 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Min47447 = tf.keras.layers.Input(shape=([2, 1]))
in1Min47447 = tf.keras.layers.Input(shape=([2, 1]))
in0Con60842 = tf.keras.layers.Input(shape=([3, 1]))

Sub69317 = keras.layers.Subtract(name = 'Sub69317', )([in0Sub69317,in1Sub69317])
Lay98634 = keras.layers.LayerNormalization(axis=1, epsilon=1.3879249580000357, name = 'Lay98634', )(Sub69317)
Res86548 = keras.layers.Reshape((2, 1), name = 'Res86548', )(Lay98634)
Glo94069 = keras.layers.GlobalMaxPool1D(name = 'Glo94069', )(Res86548)
Res31483 = keras.layers.Reshape((1, 1), name = 'Res31483', )(Glo94069)
Min51475 = keras.layers.Minimum(name = 'Min51475', )([in0Min51475,in1Min51475])
Dot63441 = keras.layers.Dot(axes=(1, 2), name = 'Dot63441', )([Res31483,Min51475])
Zer44489 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer44489', )(Dot63441)
PRe75759 = keras.layers.PReLU(name = 'PRe75759', input_shape=(1, 1))(in0PRe75759)
Fla19491 = keras.layers.Flatten(name = 'Fla19491', )(PRe75759)
Con881 = keras.layers.Concatenate(axis=1, name = 'Con881', )([Fla19491,in0Con881])
Ave33499 = keras.layers.Average(name = 'Ave33499', )([in0Ave33499,in1Ave33499])
Res28003 = keras.layers.Reshape((2, 2), name = 'Res28003', )(Ave33499)
LST87645 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST87645', )(Res28003)
Ave97169 = keras.layers.Average(name = 'Ave97169', )([Con881,LST87645])
Res52282 = keras.layers.Reshape((3, 1), name = 'Res52282', )(Ave97169)
Res18421 = keras.layers.Reshape((3, 1, 1), name = 'Res18421', )(Res52282)
Con5631 = keras.layers.Concatenate(axis=3, name = 'Con5631', )([Res18421,in0Con5631])
Ave26538 = keras.layers.Average(name = 'Ave26538', )([in0Ave26538,in1Ave26538])
Zer38038 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer38038', )(Ave26538)
Sub24860 = keras.layers.Subtract(name = 'Sub24860', )([Con5631,Zer38038])
Res86109 = keras.layers.Reshape((3, 2), name = 'Res86109', )(Sub24860)
Min47447 = keras.layers.Minimum(name = 'Min47447', )([in0Min47447,in1Min47447])
Zer83265 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer83265', )(Min47447)
Con60842 = keras.layers.Concatenate(axis=2, name = 'Con60842', )([Zer83265,in0Con60842])
Min59960 = keras.layers.Minimum(name = 'Min59960', )([Res86109,Con60842])
Mul63088 = keras.layers.Multiply(name = 'Mul63088', )([Zer44489,Min59960])
model = tf.keras.models.Model(inputs=[in0Sub69317,in1Sub69317,in0Min51475,in1Min51475,in0PRe75759,in0Con881,in0Ave33499,in1Ave33499,in0Con5631,in0Ave26538,in1Ave26538,in0Min47447,in1Min47447,in0Con60842], outputs=Mul63088)
w = model.get_layer('PRe75759').get_weights() 
w[0] = np.array([[0.2026]])
model.get_layer('PRe75759').set_weights(w) 
w = model.get_layer('LST87645').get_weights() 
w[0] = np.array([[1, 8, 3, 4, 8, 1, 3, 4, 3, 10, 4, 5], [1, 4, 4, 5, 7, 6, 6, 5, 9, 8, 6, 7]])
w[1] = np.array([[3, 1, 1, 10, 9, 7, 2, 5, 10, 4, 3, 2], [3, 4, 10, 10, 9, 8, 3, 1, 8, 6, 2, 9], [9, 7, 10, 3, 5, 8, 1, 10, 3, 1, 5, 9]])
w[2] = np.array([1, 10, 9, 5, 3, 2, 8, 10, 9, 7, 5, 2])
model.get_layer('LST87645').set_weights(w) 
in0Sub69317 = tf.constant([[0.5336, 0.0154]])
in1Sub69317 = tf.constant([[0.5965, 0.8495]])
in0Min51475 = tf.constant([[[0.4348], [0.2665]]])
in1Min51475 = tf.constant([[[0.9546], [0.7588]]])
in0PRe75759 = tf.constant([[[0.6974]]])
in0Con881 = tf.constant([[0.0616, 0.3008]])
in0Ave33499 = tf.constant([[[[0.4275, 0.3033]], [[0.9111, 0.7355]]]])
in1Ave33499 = tf.constant([[[[0.3773, 0.7842]], [[0.3312, 0.716]]]])
in0Con5631 = tf.constant([[[[0.7915]], [[0.3563]], [[0.654]]]])
in0Ave26538 = tf.constant([[[[0.4766, 0.7256]], [[0.4504, 0.5554]]]])
in1Ave26538 = tf.constant([[[[0.3986, 0.2867]], [[0.6724, 0.6268]]]])
in0Min47447 = tf.constant([[[0.3912], [0.8211]]])
in1Min47447 = tf.constant([[[0.8823], [0.6314]]])
in0Con60842 = tf.constant([[[0.0167], [0.9846], [0.1416]]])
print (np.array2string(model.predict([in0Sub69317,in1Sub69317,in0Min51475,in1Min51475,in0PRe75759,in0Con881,in0Ave33499,in1Ave33499,in0Con5631,in0Ave26538,in1Ave26538,in0Min47447,in1Min47447,in0Con60842],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul63088.png')

LSub69317 = subtract_layer([[0.5336, 0.0154]], [[0.5965, 0.8495]], Sub69317), 
LLay98634 = layer_normalization_layer(Sub69317, 1, 1.3879249580000357, Lay98634), 
LRes86548 = reshape_layer(Lay98634, [2, 1], Res86548), 
LGlo94069 = global_max_pool1D_layer(Res86548, Glo94069), 
LRes31483 = reshape_layer(Glo94069, [1, 1], Res31483), 
LMin51475 = minimum_layer([[[[0.4348], [0.2665]]], [[[0.9546], [0.7588]]]], Min51475), 
LDot63441 = dot_layer(Res31483,Min51475, 1, 2, Dot63441), 
LZer44489 = zero_padding1D_layer(Dot63441, 2, 0, Zer44489), 
LPRe75759 = prelu_layer([[[0.6974]]], [[0.2026]], PRe75759), 
LFla19491 = flatten_layer(PRe75759, Fla19491), 
LCon881 = concatenate_layer([Fla19491,[[0.0616, 0.3008]]], 1, Con881), 
LAve33499 = average_layer([[[[[0.4275, 0.3033]], [[0.9111, 0.7355]]]], [[[[0.3773, 0.7842]], [[0.3312, 0.716]]]]], Ave33499), 
LRes28003 = reshape_layer(Ave33499, [2, 2], Res28003), 
LLST87645 = lstm_layer(Res28003,[[1, 8, 3, 4, 8, 1, 3, 4, 3, 10, 4, 5], [1, 4, 4, 5, 7, 6, 6, 5, 9, 8, 6, 7]],[[3, 1, 1, 10, 9, 7, 2, 5, 10, 4, 3, 2], [3, 4, 10, 10, 9, 8, 3, 1, 8, 6, 2, 9], [9, 7, 10, 3, 5, 8, 1, 10, 3, 1, 5, 9]],[1, 10, 9, 5, 3, 2, 8, 10, 9, 7, 5, 2], LST87645), 
LAve97169 = average_layer([Con881,LST87645], Ave97169), 
LRes52282 = reshape_layer(Ave97169, [3, 1], Res52282), 
LRes18421 = reshape_layer(Res52282, [3, 1, 1], Res18421), 
LCon5631 = concatenate_layer([Res18421,[[[[0.7915]], [[0.3563]], [[0.654]]]]], 3, Con5631), 
LAve26538 = average_layer([[[[[0.4766, 0.7256]], [[0.4504, 0.5554]]]], [[[[0.3986, 0.2867]], [[0.6724, 0.6268]]]]], Ave26538), 
LZer38038 = zero_padding2D_layer(Ave26538, 1, 0, 0, 0, Zer38038), 
LSub24860 = subtract_layer(Con5631,Zer38038, Sub24860), 
LRes86109 = reshape_layer(Sub24860, [3, 2], Res86109), 
LMin47447 = minimum_layer([[[[0.3912], [0.8211]]], [[[0.8823], [0.6314]]]], Min47447), 
LZer83265 = zero_padding1D_layer(Min47447, 1, 0, Zer83265), 
LCon60842 = concatenate_layer([Zer83265,[[[0.0167], [0.9846], [0.1416]]]], 2, Con60842), 
LMin59960 = minimum_layer([Res86109,Con60842], Min59960), 
LMul63088 = multiply_layer([Zer44489,Min59960], Mul63088), 
exec_layers([LSub69317,LLay98634,LRes86548,LGlo94069,LRes31483,LMin51475,LDot63441,LZer44489,LPRe75759,LFla19491,LCon881,LAve33499,LRes28003,LLST87645,LAve97169,LRes52282,LRes18421,LCon5631,LAve26538,LZer38038,LSub24860,LRes86109,LMin47447,LZer83265,LCon60842,LMin59960,LMul63088],["Sub69317","Lay98634","Res86548","Glo94069","Res31483","Min51475","Dot63441","Zer44489","PRe75759","Fla19491","Con881","Ave33499","Res28003","LST87645","Ave97169","Res52282","Res18421","Con5631","Ave26538","Zer38038","Sub24860","Res86109","Min47447","Zer83265","Con60842","Min59960","Mul63088"],Mul63088,"Mul63088")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, -0.0000000], [0.0096048, 0.0052144]]]

Expected (Unparsed): [[[0,0.0],[0.0,-0.0],[0.009604752792615315,0.005214380618495442]]]

Actual:   [[[0, 0], [0, -0], [0.0097, 0.0053]]]

Expected: [[[0, 0], [0, -0], [0.0097, 0.0053]]]