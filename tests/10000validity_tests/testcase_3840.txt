import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer53161 = tf.keras.layers.Input(shape=([4, 4, 3]))

Zer53161 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer53161', )(in0Zer53161)
Den59773 = keras.layers.Dense(2,name = 'Den59773', )(Zer53161)
Den57062 = keras.layers.Dense(2,name = 'Den57062', )(Den59773)
model = tf.keras.models.Model(inputs=[in0Zer53161], outputs=Den57062)
w = model.get_layer('Den59773').get_weights() 
w[0] = np.array([[0.2589, 0.8939], [0.3471, 0.9865], [0.3087, 0.1447]])
w[1] = np.array([0.3503, 0.6864])
model.get_layer('Den59773').set_weights(w) 
w = model.get_layer('Den57062').get_weights() 
w[0] = np.array([[0.9139, 0.8789], [0.4928, 0.4649]])
w[1] = np.array([0.3914, 0.3322])
model.get_layer('Den57062').set_weights(w) 
in0Zer53161 = tf.constant([[[[1.7778, 1.1602, 1.9985], [1.2855, 1.5105, 1.692], [1.7721, 1.4169, 1.5558], [1.6859, 1.808, 1.574]], [[1.1459, 1.5404, 1.4576], [1.481, 1.8114, 1.547], [1.176, 1.5138, 1.7423], [1.347, 1.6161, 1.5476]], [[1.4181, 1.1854, 1.7244], [1.3848, 1.078, 1.6501], [1.482, 1.3388, 1.2846], [1.9625, 1.3207, 1.7584]], [[1.1765, 1.1719, 1.7865], [1.89, 1.0004, 1.8001], [1.7269, 1.4983, 1.1701], [1.5801, 1.1303, 1.0891]]]])
print (np.array2string(model.predict([in0Zer53161],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den57062.png')

LZer53161 = zero_padding2D_layer([[[[1.7778, 1.1602, 1.9985], [1.2855, 1.5105, 1.692], [1.7721, 1.4169, 1.5558], [1.6859, 1.808, 1.574]], [[1.1459, 1.5404, 1.4576], [1.481, 1.8114, 1.547], [1.176, 1.5138, 1.7423], [1.347, 1.6161, 1.5476]], [[1.4181, 1.1854, 1.7244], [1.3848, 1.078, 1.6501], [1.482, 1.3388, 1.2846], [1.9625, 1.3207, 1.7584]], [[1.1765, 1.1719, 1.7865], [1.89, 1.0004, 1.8001], [1.7269, 1.4983, 1.1701], [1.5801, 1.1303, 1.0891]]]], 1, 1, 1, 1, Zer53161), 
LDen59773 = dense_layer(Zer53161, [[0.2589, 0.8939], [0.3471, 0.9865], [0.3087, 0.1447]],[0.3503, 0.6864], Den59773), 
LDen57062 = dense_layer(Den59773, [[0.9139, 0.8789], [0.4928, 0.4649]],[0.3914, 0.3322], Den57062), 
exec_layers([LZer53161,LDen59773,LDen57062],["Zer53161","Den59773","Den57062"],Den57062,"Den57062")

Actual (Unparsed): [[[[1.0497971, 0.9591860], [1.0497971, 0.9591860], [1.0497971, 0.9591860], [1.0497971, 0.9591860], [1.0497971, 0.9591860], [1.0497971, 0.9591860]], [[1.0497971, 0.9591860], [3.8919742, 3.6652273], [3.7317184, 3.5123623], [3.9378745, 3.7077081], [4.2001338, 3.9571125], [1.0497971, 0.9591860]], [[1.0497971, 0.9591860], [3.5783688, 3.3660520], [4.0545803, 3.8187917], [3.6780021, 3.4614916], [3.8071613, 3.5836679], [1.0497971, 0.9591860]], [[1.0497971, 0.9591860], [3.5717830, 3.3603348], [3.4366939, 3.2317414], [3.5828487, 3.3696695], [4.0611200, 3.8252893], [1.0497971, 0.9591860]], [[1.0497971, 0.9591860], [3.4192927, 3.2156731], [3.7694497, 3.5481721], [3.8363446, 3.6102102], [3.4126782, 3.2073366], [1.0497971, 0.9591860]], [[1.0497971, 0.9591860], [1.0497971, 0.9591860], [1.0497971, 0.9591860], [1.0497971, 0.9591860], [1.0497971, 0.9591860], [1.0497971, 0.9591860]]]]

Expected (Unparsed): [[[[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001]],[[1.04979709,0.9591860300000001],[3.891974202757,3.6652273359139995],[3.73171838599,3.5123622746],[3.937874542786001,3.707708109116],[4.200133816697,3.957112517748],[1.04979709,0.9591860300000001]],[[1.04979709,0.9591860300000001],[3.5783688086570002,3.3660519699],[4.054580234806,3.8187916439960006],[3.678002035469,3.46149161643],[3.8071612827230004,3.58366787478],[1.04979709,0.9591860300000001]],[[1.04979709,0.9591860300000001],[3.5717829988050003,3.3603347633319998],[3.4366939668530003,3.231741464802],[3.5828487350060003,3.369669502908],[4.061120011353999,3.825289245992],[1.04979709,0.9591860300000001]],[[1.04979709,0.9591860300000001],[3.4192927323710003,3.2156731181460003],[3.769449800365,3.5481721275619997],[3.836344657743,3.6102102113860006],[3.412678123849,3.2073364826299997],[1.04979709,0.9591860300000001]],[[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001],[1.04979709,0.9591860300000001]]]]

Actual:   [[[[1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592]], [[1.0498, 0.9592], [3.892, 3.6653], [3.7318, 3.5124], [3.9379, 3.7078], [4.2002, 3.9572], [1.0498, 0.9592]], [[1.0498, 0.9592], [3.5784, 3.3661], [4.0546, 3.8188], [3.6781, 3.4615], [3.8072, 3.5837], [1.0498, 0.9592]], [[1.0498, 0.9592], [3.5718, 3.3604], [3.4367, 3.2318], [3.5829, 3.3697], [4.0612, 3.8253], [1.0498, 0.9592]], [[1.0498, 0.9592], [3.4193, 3.2157], [3.7695, 3.5482], [3.8364, 3.6103], [3.4127, 3.2074], [1.0498, 0.9592]], [[1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592]]]]

Expected: [[[[1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592]], [[1.0498, 0.9592], [3.892, 3.6653], [3.7318, 3.5124], [3.9379, 3.7078], [4.2002, 3.9572], [1.0498, 0.9592]], [[1.0498, 0.9592], [3.5784, 3.3661], [4.0546, 3.8188], [3.6781, 3.4615], [3.8072, 3.5837], [1.0498, 0.9592]], [[1.0498, 0.9592], [3.5718, 3.3604], [3.4367, 3.2318], [3.5829, 3.3697], [4.0612, 3.8253], [1.0498, 0.9592]], [[1.0498, 0.9592], [3.4193, 3.2157], [3.7695, 3.5482], [3.8364, 3.6103], [3.4127, 3.2074], [1.0498, 0.9592]], [[1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592], [1.0498, 0.9592]]]]