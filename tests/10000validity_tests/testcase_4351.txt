import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU19565 = tf.keras.layers.Input(shape=([1, 2]))

GRU19565 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU19565', )(in0GRU19565)
Res66872 = keras.layers.Reshape((1, 1), name = 'Res66872', )(GRU19565)
Per43433 = keras.layers.Permute((1,2), name = 'Per43433',)(Res66872)
Zer79366 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer79366', )(Per43433)
Sep97381 = keras.layers.SeparableConv1D(2, (2),strides=(1), padding='valid', name = 'Sep97381', )(Zer79366)
Res27670 = keras.layers.Reshape((2, 2, 1), name = 'Res27670', )(Sep97381)
Cro17586 = keras.layers.Cropping2D(cropping=((0, 1), (0, 1)), name = 'Cro17586', )(Res27670)
model = tf.keras.models.Model(inputs=[in0GRU19565], outputs=Cro17586)
w = model.get_layer('GRU19565').get_weights() 
w[0] = np.array([[6, 4, 10], [4, 4, 9]])
w[1] = np.array([[9, 1, 8]])
w[2] = np.array([2, 2, 2])
model.get_layer('GRU19565').set_weights(w) 
w = model.get_layer('Sep97381').get_weights() 
w[0] = np.array([[[0.6579]], [[0.5527]]])
w[1] = np.array([[[0.7451, 0.5805]]])
w[2] = np.array([0, 0])
model.get_layer('Sep97381').set_weights(w) 
in0GRU19565 = tf.constant([[[6, 6]]])
print (np.array2string(model.predict([in0GRU19565],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro17586.png')

LGRU19565 = gru_layer([[[6, 6]]],[[6, 4, 10], [4, 4, 9]],[[9, 1, 8]],[2, 2, 2], false, GRU19565), 
LRes66872 = reshape_layer(GRU19565, [1, 1], Res66872), 
LPer43433 = permute_layer(Res66872, 1,2, Per43433), 
LZer79366 = zero_padding1D_layer(Per43433, 1, 1, Zer79366), 
LSep97381 = separable_conv1D_layer(Zer79366, 2,[[[[0.6579]], [[0.5527]]],[[[0.7451, 0.5805]]]],[0, 0], 1, false, Sep97381), 
LRes27670 = reshape_layer(Sep97381, [2, 2, 1], Res27670), 
LCro17586 = cropping2D_layer(Res27670, 0, 1, 0, 1, Cro17586), 
exec_layers([LGRU19565,LRes66872,LPer43433,LZer79366,LSep97381,LRes27670,LCro17586],["GRU19565","Res66872","Per43433","Zer79366","Sep97381","Res27670","Cro17586"],Cro17586,"Cro17586")

Actual (Unparsed): [[[[0.0000000]]]]

Expected (Unparsed): [[[[0.0]]]]

Actual:   [[[[0]]]]

Expected: [[[[0]]]]