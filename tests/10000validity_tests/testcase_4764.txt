import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe38433 = tf.keras.layers.Input(shape=([2, 2]))
in0Dot69509 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot69509 = tf.keras.layers.Input(shape=([2, 2]))
in0Thr47642 = tf.keras.layers.Input(shape=([1, 1]))
in0Con31226 = tf.keras.layers.Input(shape=([2, 1]))
in0Con66985 = tf.keras.layers.Input(shape=([4, 2]))
in0Con16598 = tf.keras.layers.Input(shape=([2]))
in0Sub86972 = tf.keras.layers.Input(shape=([3, 3, 2]))
in1Sub86972 = tf.keras.layers.Input(shape=([3, 3, 2]))
in0Dot47877 = tf.keras.layers.Input(shape=([3]))
in1Dot47877 = tf.keras.layers.Input(shape=([3]))
in0Con11384 = tf.keras.layers.Input(shape=([17]))

PRe38433 = keras.layers.PReLU(name = 'PRe38433', input_shape=(2, 2))(in0PRe38433)
Res41349 = keras.layers.Reshape((2, 2, 1), name = 'Res41349', )(PRe38433)
Zer91494 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer91494', )(Res41349)
Res51388 = keras.layers.Reshape((4, 4), name = 'Res51388', )(Zer91494)
Dot69509 = keras.layers.Dot(axes=(1, 1), name = 'Dot69509', )([in0Dot69509,in1Dot69509])
Thr47642 = keras.layers.ThresholdedReLU(theta=9.154091706556661, name = 'Thr47642', input_shape=(1, 1))(in0Thr47642)
Zer8883 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer8883', )(Thr47642)
Con31226 = keras.layers.Concatenate(axis=2, name = 'Con31226', )([Zer8883,in0Con31226])
Max7438 = keras.layers.Maximum(name = 'Max7438', )([Dot69509,Con31226])
Zer12629 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer12629', )(Max7438)
Con66985 = keras.layers.Concatenate(axis=2, name = 'Con66985', )([Zer12629,in0Con66985])
Add68857 = keras.layers.Add(name = 'Add68857', )([Res51388,Con66985])
Fla39032 = keras.layers.Flatten(name = 'Fla39032', )(Add68857)
Con16598 = keras.layers.Concatenate(axis=1, name = 'Con16598', )([Fla39032,in0Con16598])
Sub86972 = keras.layers.Subtract(name = 'Sub86972', )([in0Sub86972,in1Sub86972])
Res88184 = keras.layers.Reshape((3, 6), name = 'Res88184', )(Sub86972)
Fla70247 = keras.layers.Flatten(name = 'Fla70247', )(Res88184)
Dot47877 = keras.layers.Dot(axes=(1, 1), name = 'Dot47877', )([in0Dot47877,in1Dot47877])
Con11384 = keras.layers.Concatenate(axis=1, name = 'Con11384', )([Dot47877,in0Con11384])
Max70815 = keras.layers.Maximum(name = 'Max70815', )([Fla70247,Con11384])
Mas57294 = keras.layers.Masking(mask_value=2, name = 'Mas57294', )(Max70815)
Max76975 = keras.layers.Maximum(name = 'Max76975', )([Con16598,Mas57294])
model = tf.keras.models.Model(inputs=[in0PRe38433,in0Dot69509,in1Dot69509,in0Thr47642,in0Con31226,in0Con66985,in0Con16598,in0Sub86972,in1Sub86972,in0Dot47877,in1Dot47877,in0Con11384], outputs=Max76975)
w = model.get_layer('PRe38433').get_weights() 
w[0] = np.array([[0.373, 0.842], [0.4794, 0.1768]])
model.get_layer('PRe38433').set_weights(w) 
in0PRe38433 = tf.constant([[[0.5319, 0.804], [0.0096, 0.634]]])
in0Dot69509 = tf.constant([[[0.7572, 0.149], [0.6806, 0.0551]]])
in1Dot69509 = tf.constant([[[0.3692, 0.9788], [0.3461, 0.3519]]])
in0Thr47642 = tf.constant([[[0.9844]]])
in0Con31226 = tf.constant([[[0.4069], [0.7956]]])
in0Con66985 = tf.constant([[[0.1415, 0.3483], [0.6362, 0.2577], [0.2042, 0.9077], [0.8084, 0.9219]]])
in0Con16598 = tf.constant([[0.6408, 0.8375]])
in0Sub86972 = tf.constant([[[[0.8508, 0.7278], [0.9263, 0.7112], [0.3482, 0.6161]], [[0.5027, 0.3888], [0.5795, 0.9428], [0.4686, 0.9418]], [[0.5974, 0.4149], [0.5605, 0.0911], [0.9463, 0.6855]]]])
in1Sub86972 = tf.constant([[[[0.5129, 0.7666], [0.8152, 0.5325], [0.576, 0.6984]], [[0.8202, 0.5393], [0.8656, 0.8312], [0.2696, 0.3266]], [[0.358, 0.3995], [0.8753, 0.4719], [0.9652, 0.732]]]])
in0Dot47877 = tf.constant([[0.266, 0.8736, 0.5352]])
in1Dot47877 = tf.constant([[0.1102, 0.3305, 0.4605]])
in0Con11384 = tf.constant([[0.4857, 0.5704, 0.5889, 0.3704, 0.8444, 0.0711, 0.0438, 0.2739, 0.0039, 0.1878, 0.9326, 0.8589, 0.1105, 0.5558, 0.0091, 0.7577, 0.0875]])
print (np.array2string(model.predict([in0PRe38433,in0Dot69509,in1Dot69509,in0Thr47642,in0Con31226,in0Con66985,in0Con16598,in0Sub86972,in1Sub86972,in0Dot47877,in1Dot47877,in0Con11384],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max76975.png')

LPRe38433 = prelu_layer([[[0.5319, 0.804], [0.0096, 0.634]]], [[0.373, 0.842], [0.4794, 0.1768]], PRe38433), 
LRes41349 = reshape_layer(PRe38433, [2, 2, 1], Res41349), 
LZer91494 = zero_padding2D_layer(Res41349, 1, 1, 1, 1, Zer91494), 
LRes51388 = reshape_layer(Zer91494, [4, 4], Res51388), 
LDot69509 = dot_layer([[[0.7572, 0.149], [0.6806, 0.0551]]], [[[0.3692, 0.9788], [0.3461, 0.3519]]], 1, 1, Dot69509), 
LThr47642 = thresholded_relu_layer([[[0.9844]]], 9.154091706556661, Thr47642), 
LZer8883 = zero_padding1D_layer(Thr47642, 1, 0, Zer8883), 
LCon31226 = concatenate_layer([Zer8883,[[[0.4069], [0.7956]]]], 2, Con31226), 
LMax7438 = maximum_layer([Dot69509,Con31226], Max7438), 
LZer12629 = zero_padding1D_layer(Max7438, 2, 0, Zer12629), 
LCon66985 = concatenate_layer([Zer12629,[[[0.1415, 0.3483], [0.6362, 0.2577], [0.2042, 0.9077], [0.8084, 0.9219]]]], 2, Con66985), 
LAdd68857 = add_layer([Res51388,Con66985], Add68857), 
LFla39032 = flatten_layer(Add68857, Fla39032), 
LCon16598 = concatenate_layer([Fla39032,[[0.6408, 0.8375]]], 1, Con16598), 
LSub86972 = subtract_layer([[[[0.8508, 0.7278], [0.9263, 0.7112], [0.3482, 0.6161]], [[0.5027, 0.3888], [0.5795, 0.9428], [0.4686, 0.9418]], [[0.5974, 0.4149], [0.5605, 0.0911], [0.9463, 0.6855]]]], [[[[0.5129, 0.7666], [0.8152, 0.5325], [0.576, 0.6984]], [[0.8202, 0.5393], [0.8656, 0.8312], [0.2696, 0.3266]], [[0.358, 0.3995], [0.8753, 0.4719], [0.9652, 0.732]]]], Sub86972), 
LRes88184 = reshape_layer(Sub86972, [3, 6], Res88184), 
LFla70247 = flatten_layer(Res88184, Fla70247), 
LDot47877 = dot_layer([[0.266, 0.8736, 0.5352]], [[0.1102, 0.3305, 0.4605]], 1, 1, Dot47877), 
LCon11384 = concatenate_layer([Dot47877,[[0.4857, 0.5704, 0.5889, 0.3704, 0.8444, 0.0711, 0.0438, 0.2739, 0.0039, 0.1878, 0.9326, 0.8589, 0.1105, 0.5558, 0.0091, 0.7577, 0.0875]]], 1, Con11384), 
LMax70815 = maximum_layer([Fla70247,Con11384], Max70815), 
LMas57294 = masking_layer(Max70815, 2, Mas57294), 
LMax76975 = maximum_layer([Con16598,Mas57294], Max76975), 
exec_layers([LPRe38433,LRes41349,LZer91494,LRes51388,LDot69509,LThr47642,LZer8883,LCon31226,LMax7438,LZer12629,LCon66985,LAdd68857,LFla39032,LCon16598,LSub86972,LRes88184,LFla70247,LDot47877,LCon11384,LMax70815,LMas57294,LMax76975],["PRe38433","Res41349","Zer91494","Res51388","Dot69509","Thr47642","Zer8883","Con31226","Max7438","Zer12629","Con66985","Add68857","Fla39032","Con16598","Sub86972","Res88184","Fla70247","Dot47877","Con11384","Max70815","Mas57294","Max76975"],Max76975,"Max76975")

Actual (Unparsed): [[0.5644976, 0.4857000, 0.5704000, 0.5889000, 0.3704000, 0.8444000, 1.4402000, 0.2577000, 0.5151139, 0.9902505, 0.8382000, 0.9326000, 0.8589000, 0.7956000, 0.8084000, 0.9219000, 0.7577000, 0.8375000]]

Expected (Unparsed): [[0.5644976,0.4857,0.5704,0.5889,0.3704,0.8444,1.4402,0.2577,0.5151139,0.9902505,0.8382000000000001,0.9326,0.8589,0.7956,0.8084,0.9219,0.7577,0.8375]]

Actual:   [[0.5645, 0.4857, 0.5704, 0.5889, 0.3704, 0.8444, 1.4402, 0.2577, 0.5152, 0.9903, 0.8382, 0.9326, 0.8589, 0.7956, 0.8084, 0.9219, 0.7577, 0.8375]]

Expected: [[0.5645, 0.4857, 0.5704, 0.5889, 0.3704, 0.8444, 1.4402, 0.2577, 0.5152, 0.9903, 0.8383, 0.9326, 0.8589, 0.7956, 0.8084, 0.9219, 0.7577, 0.8375]]