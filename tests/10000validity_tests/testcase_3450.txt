import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot39505 = tf.keras.layers.Input(shape=([3]))
in1Dot39505 = tf.keras.layers.Input(shape=([3]))
in0Lea30461 = tf.keras.layers.Input(shape=([2, 1, 1]))

Dot39505 = keras.layers.Dot(axes=(1, 1), name = 'Dot39505', )([in0Dot39505,in1Dot39505])
Res75784 = keras.layers.Reshape((1, 1), name = 'Res75784', )(Dot39505)
Res64746 = keras.layers.Reshape((1, 1, 1), name = 'Res64746', )(Res75784)
Max34438 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max34438', )(Res64746)
Res60918 = keras.layers.Reshape((1, 1), name = 'Res60918', )(Max34438)
Lea30461 = keras.layers.LeakyReLU(alpha=0.33338353020361994, name = 'Lea30461', input_shape=(2, 1, 1))(in0Lea30461)
Res22853 = keras.layers.Reshape((2, 1), name = 'Res22853', )(Lea30461)
Glo77636 = keras.layers.GlobalAveragePooling1D(name = 'Glo77636', )(Res22853)
Mas5422 = keras.layers.Masking(mask_value=1, name = 'Mas5422', )(Glo77636)
Res19886 = keras.layers.Reshape((1, 1), name = 'Res19886', )(Mas5422)
Max83792 = keras.layers.Maximum(name = 'Max83792', )([Res60918,Res19886])
model = tf.keras.models.Model(inputs=[in0Dot39505,in1Dot39505,in0Lea30461], outputs=Max83792)
in0Dot39505 = tf.constant([[0.2926, 0.2666, 0.2579]])
in1Dot39505 = tf.constant([[0.6776, 0.3971, 0.5649]])
in0Lea30461 = tf.constant([[[[0.4068]], [[0.0265]]]])
print (np.array2string(model.predict([in0Dot39505,in1Dot39505,in0Lea30461],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max83792.png')

LDot39505 = dot_layer([[0.2926, 0.2666, 0.2579]], [[0.6776, 0.3971, 0.5649]], 1, 1, Dot39505), 
LRes75784 = reshape_layer(Dot39505, [1, 1], Res75784), 
LRes64746 = reshape_layer(Res75784, [1, 1, 1], Res64746), 
LMax34438 = max_pool2D_layer(Res64746, 1, 1, Max34438), 
LRes60918 = reshape_layer(Max34438, [1, 1], Res60918), 
LLea30461 = leaky_relu_layer([[[[0.4068]], [[0.0265]]]], 0.33338353020361994, Lea30461), 
LRes22853 = reshape_layer(Lea30461, [2, 1], Res22853), 
LGlo77636 = global_average_pooling1D_layer(Res22853, Glo77636), 
LMas5422 = masking_layer(Glo77636, 1, Mas5422), 
LRes19886 = reshape_layer(Mas5422, [1, 1], Res19886), 
LMax83792 = maximum_layer([Res60918,Res19886], Max83792), 
exec_layers([LDot39505,LRes75784,LRes64746,LMax34438,LRes60918,LLea30461,LRes22853,LGlo77636,LMas5422,LRes19886,LMax83792],["Dot39505","Res75784","Res64746","Max34438","Res60918","Lea30461","Res22853","Glo77636","Mas5422","Res19886","Max83792"],Max83792,"Max83792")

Actual (Unparsed): [[[0.4498203]]]

Expected (Unparsed): [[[0.44982033]]]

Actual:   [[[0.4499]]]

Expected: [[[0.4499]]]