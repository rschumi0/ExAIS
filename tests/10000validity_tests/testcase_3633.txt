import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc95004 = tf.keras.layers.Input(shape=([2, 1]))
in0Max52897 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Max52897 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Max75759 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Max75759 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Con41368 = tf.keras.layers.Input(shape=([2, 58]))
in0Zer55012 = tf.keras.layers.Input(shape=([1, 4, 3, 2]))
in0Dot30502 = tf.keras.layers.Input(shape=([2]))
in1Dot30502 = tf.keras.layers.Input(shape=([2]))
in0Con46896 = tf.keras.layers.Input(shape=([5]))
in0Con18557 = tf.keras.layers.Input(shape=([14]))

Loc95004 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc95004', )(in0Loc95004)
Res78356 = keras.layers.Reshape((1, 3, 1), name = 'Res78356', )(Loc95004)
Res45955 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res45955', )(Res78356)
Zer97807 = keras.layers.ZeroPadding3D(padding=((1, 0), (2, 0), (1, 0)), name = 'Zer97807', )(Res45955)
Max52897 = keras.layers.Maximum(name = 'Max52897', )([in0Max52897,in1Max52897])
Zer93366 = keras.layers.ZeroPadding3D(padding=((0, 0), (4, 0), (0, 0)), name = 'Zer93366', )(Max52897)
Min78178 = keras.layers.Minimum(name = 'Min78178', )([Zer97807,Zer93366])
Res18287 = keras.layers.Reshape((2, 5, 2), name = 'Res18287', )(Min78178)
Res88961 = keras.layers.Reshape((2, 10), name = 'Res88961', )(Res18287)
Fla47453 = keras.layers.Flatten(name = 'Fla47453', )(Res88961)
Max75759 = keras.layers.Maximum(name = 'Max75759', )([in0Max75759,in1Max75759])
Res59214 = keras.layers.Reshape((2, 1, 2), name = 'Res59214', )(Max75759)
Res83082 = keras.layers.Reshape((2, 2), name = 'Res83082', )(Res59214)
Con41368 = keras.layers.Concatenate(axis=2, name = 'Con41368', )([Res83082,in0Con41368])
Zer55012 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer55012', )(in0Zer55012)
Res27516 = keras.layers.Reshape((3, 6, 10), name = 'Res27516', )(Zer55012)
Res82702 = keras.layers.Reshape((3, 60), name = 'Res82702', )(Res27516)
Dot70397 = keras.layers.Dot(axes=(2, 2), name = 'Dot70397', )([Con41368,Res82702])
Fla65863 = keras.layers.Flatten(name = 'Fla65863', )(Dot70397)
Dot30502 = keras.layers.Dot(axes=(1, 1), name = 'Dot30502', )([in0Dot30502,in1Dot30502])
Con46896 = keras.layers.Concatenate(axis=1, name = 'Con46896', )([Dot30502,in0Con46896])
Add70562 = keras.layers.Add(name = 'Add70562', )([Fla65863,Con46896])
ReL70879 = keras.layers.ReLU(max_value=0.5582182594464853, negative_slope=0.47042532850910634, threshold=0.11917840389393475, name = 'ReL70879', )(Add70562)
Con18557 = keras.layers.Concatenate(axis=1, name = 'Con18557', )([ReL70879,in0Con18557])
Ave35550 = keras.layers.Average(name = 'Ave35550', )([Fla47453,Con18557])
model = tf.keras.models.Model(inputs=[in0Loc95004,in0Max52897,in1Max52897,in0Max75759,in1Max75759,in0Con41368,in0Zer55012,in0Dot30502,in1Dot30502,in0Con46896,in0Con18557], outputs=Ave35550)
w = model.get_layer('Loc95004').get_weights() 
w[0] = np.array([[[0.9976, 0.7292, 0.2882], [0.8062, 0.1528, 0.1359]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc95004').set_weights(w) 
in0Loc95004 = tf.constant([[[0.2243], [0.7709]]])
in0Max52897 = tf.constant([[[[[0.6204], [0.5674]]], [[[0.3499], [0.4296]]]]])
in1Max52897 = tf.constant([[[[[0.5431], [0.2149]]], [[[0.5693], [0.1655]]]]])
in0Max75759 = tf.constant([[[[[0.6895, 0.5417]]], [[[0.7901, 0.794]]]]])
in1Max75759 = tf.constant([[[[[0.9849, 0.3001]]], [[[0.8393, 0.5781]]]]])
in0Con41368 = tf.constant([[[0.8785, 0.5775, 0.7809, 0.6879, 0.5793, 0.4972, 0.8986, 0.9231, 0.9199, 0.8368, 0.6438, 0.1304, 0.699, 0.9741, 0.6035, 0.7658, 0.2216, 0.9696, 0.6862, 0.1732, 0.4385, 0.044, 0.4852, 0.4055, 0.0439, 0.8328, 0.5737, 0.107, 0.721, 0.6715, 0.9898, 0.1898, 0.3407, 0.1576, 0.3637, 0.7312, 0.9383, 0.8914, 0.2378, 0.3825, 0.7189, 0.6083, 0.1336, 0.5851, 0.1795, 0.8762, 0.8323, 0.0657, 0.6678, 0.161, 0.1527, 0.4011, 0.3506, 0.3334, 0.2339, 0.9303, 0.6121, 0.6329], [0.9588, 0.9249, 0.3604, 0.6879, 0.6929, 0.7249, 0.5881, 0.445, 0.9537, 0.4976, 0.7991, 0.7578, 0.9744, 0.3816, 0.5938, 0.95, 0.3815, 0.0435, 0.7857, 0.88, 0.3669, 0.09, 0.914, 0.9077, 0.8015, 0.3587, 0.9087, 0.693, 0.7116, 0.8361, 0.9712, 0.9391, 0.4203, 0.8446, 0.4368, 0.034, 0.44, 0.1795, 0.5029, 0.043, 0.896, 0.0816, 0.2258, 0.6562, 0.8602, 0.2841, 0.1161, 0.5046, 0.4771, 0.8862, 0.9959, 0.7256, 0.1774, 0.4758, 0.5199, 0.7803, 0.5903, 0.7474]]])
in0Zer55012 = tf.constant([[[[[1.1093, 1.1796], [1.4693, 1.5761], [1.6581, 1.5819]], [[1.7156, 1.5292], [1.6183, 1.2187], [1.2072, 1.8609]], [[1.0983, 1.8837], [1.4984, 1.7685], [1.9228, 1.4878]], [[1.6104, 1.7075], [1.5254, 1.5934], [1.7509, 1.7911]]]]])
in0Dot30502 = tf.constant([[0.5544, 0.2339]])
in1Dot30502 = tf.constant([[0.6149, 0.7572]])
in0Con46896 = tf.constant([[0.4888, 0.051, 0.9506, 0.7408, 0.1815]])
in0Con18557 = tf.constant([[0.7481, 0.7823, 0.4502, 0.4707, 0.8373, 0.9702, 0.284, 0.6159, 0.9187, 0.8759, 0.2742, 0.0887, 0.7352, 0.0737]])
print (np.array2string(model.predict([in0Loc95004,in0Max52897,in1Max52897,in0Max75759,in1Max75759,in0Con41368,in0Zer55012,in0Dot30502,in1Dot30502,in0Con46896,in0Con18557],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave35550.png')

LLoc95004 = locally_connected1D_layer([[[0.2243], [0.7709]]], 2,[[[0.9976, 0.7292, 0.2882], [0.8062, 0.1528, 0.1359]]],[[0, 0, 0]], 1, Loc95004), 
LRes78356 = reshape_layer(Loc95004, [1, 3, 1], Res78356), 
LRes45955 = reshape_layer(Res78356, [1, 3, 1, 1], Res45955), 
LZer97807 = zero_padding3D_layer(Res45955, 1, 0, 2, 0, 1, 0, Zer97807), 
LMax52897 = maximum_layer([[[[[[0.6204], [0.5674]]], [[[0.3499], [0.4296]]]]], [[[[[0.5431], [0.2149]]], [[[0.5693], [0.1655]]]]]], Max52897), 
LZer93366 = zero_padding3D_layer(Max52897, 0, 0, 4, 0, 0, 0, Zer93366), 
LMin78178 = minimum_layer([Zer97807,Zer93366], Min78178), 
LRes18287 = reshape_layer(Min78178, [2, 5, 2], Res18287), 
LRes88961 = reshape_layer(Res18287, [2, 10], Res88961), 
LFla47453 = flatten_layer(Res88961, Fla47453), 
LMax75759 = maximum_layer([[[[[[0.6895, 0.5417]]], [[[0.7901, 0.794]]]]], [[[[[0.9849, 0.3001]]], [[[0.8393, 0.5781]]]]]], Max75759), 
LRes59214 = reshape_layer(Max75759, [2, 1, 2], Res59214), 
LRes83082 = reshape_layer(Res59214, [2, 2], Res83082), 
LCon41368 = concatenate_layer([Res83082,[[[0.8785, 0.5775, 0.7809, 0.6879, 0.5793, 0.4972, 0.8986, 0.9231, 0.9199, 0.8368, 0.6438, 0.1304, 0.699, 0.9741, 0.6035, 0.7658, 0.2216, 0.9696, 0.6862, 0.1732, 0.4385, 0.044, 0.4852, 0.4055, 0.0439, 0.8328, 0.5737, 0.107, 0.721, 0.6715, 0.9898, 0.1898, 0.3407, 0.1576, 0.3637, 0.7312, 0.9383, 0.8914, 0.2378, 0.3825, 0.7189, 0.6083, 0.1336, 0.5851, 0.1795, 0.8762, 0.8323, 0.0657, 0.6678, 0.161, 0.1527, 0.4011, 0.3506, 0.3334, 0.2339, 0.9303, 0.6121, 0.6329], [0.9588, 0.9249, 0.3604, 0.6879, 0.6929, 0.7249, 0.5881, 0.445, 0.9537, 0.4976, 0.7991, 0.7578, 0.9744, 0.3816, 0.5938, 0.95, 0.3815, 0.0435, 0.7857, 0.88, 0.3669, 0.09, 0.914, 0.9077, 0.8015, 0.3587, 0.9087, 0.693, 0.7116, 0.8361, 0.9712, 0.9391, 0.4203, 0.8446, 0.4368, 0.034, 0.44, 0.1795, 0.5029, 0.043, 0.896, 0.0816, 0.2258, 0.6562, 0.8602, 0.2841, 0.1161, 0.5046, 0.4771, 0.8862, 0.9959, 0.7256, 0.1774, 0.4758, 0.5199, 0.7803, 0.5903, 0.7474]]]], 2, Con41368), 
LZer55012 = zero_padding3D_layer([[[[[1.1093, 1.1796], [1.4693, 1.5761], [1.6581, 1.5819]], [[1.7156, 1.5292], [1.6183, 1.2187], [1.2072, 1.8609]], [[1.0983, 1.8837], [1.4984, 1.7685], [1.9228, 1.4878]], [[1.6104, 1.7075], [1.5254, 1.5934], [1.7509, 1.7911]]]]], 1, 1, 1, 1, 1, 1, Zer55012), 
LRes27516 = reshape_layer(Zer55012, [3, 6, 10], Res27516), 
LRes82702 = reshape_layer(Res27516, [3, 60], Res82702), 
LDot70397 = dot_layer(Con41368,Res82702, 2, 2, Dot70397), 
LFla65863 = flatten_layer(Dot70397, Fla65863), 
LDot30502 = dot_layer([[0.5544, 0.2339]], [[0.6149, 0.7572]], 1, 1, Dot30502), 
LCon46896 = concatenate_layer([Dot30502,[[0.4888, 0.051, 0.9506, 0.7408, 0.1815]]], 1, Con46896), 
LAdd70562 = add_layer([Fla65863,Con46896], Add70562), 
LReL70879 = relu_layer(Add70562, 0.5582182594464853, 0.47042532850910634, 0.11917840389393475, ReL70879), 
LCon18557 = concatenate_layer([ReL70879,[[0.7481, 0.7823, 0.4502, 0.4707, 0.8373, 0.9702, 0.284, 0.6159, 0.9187, 0.8759, 0.2742, 0.0887, 0.7352, 0.0737]]], 1, Con18557), 
LAve35550 = average_layer([Fla47453,Con18557], Ave35550), 
exec_layers([LLoc95004,LRes78356,LRes45955,LZer97807,LMax52897,LZer93366,LMin78178,LRes18287,LRes88961,LFla47453,LMax75759,LRes59214,LRes83082,LCon41368,LZer55012,LRes27516,LRes82702,LDot70397,LFla65863,LDot30502,LCon46896,LAdd70562,LReL70879,LCon18557,LAve35550],["Loc95004","Res78356","Res45955","Zer97807","Max52897","Zer93366","Min78178","Res18287","Res88961","Fla47453","Max75759","Res59214","Res83082","Con41368","Zer55012","Res27516","Res82702","Dot70397","Fla65863","Dot30502","Con46896","Add70562","ReL70879","Con18557","Ave35550"],Ave35550,"Ave35550")

Actual (Unparsed): [[0.2590048, 0.2791091, -0.0160364, 0.2791091, 0.2791091, 0.0907500, 0.3740500, 0.3911500, 0.2251000, 0.2353500, 0.4186500, 0.4851000, 0.1420000, 0.3079500, 0.4593500, 0.4379500, 0.1371000, 0.0443500, 0.3676000, 0.1215543]]

Expected (Unparsed): [[0.25900482,0.27910912972324264,-0.016036424024515397,0.27910912972324264,0.27910912972324264,0.09075,0.37405,0.39115,0.2251,0.23535,0.41865,0.4851,0.142,0.30795,0.45935,0.43795,0.1371,0.04435,0.3676,0.12155428500000001]]

Actual:   [[0.2591, 0.2792, -0.016, 0.2792, 0.2792, 0.0908, 0.3741, 0.3912, 0.2251, 0.2354, 0.4187, 0.4851, 0.142, 0.308, 0.4594, 0.438, 0.1371, 0.0444, 0.3676, 0.1216]]

Expected: [[0.2591, 0.2792, -0.016, 0.2792, 0.2792, 0.0908, 0.3741, 0.3912, 0.2251, 0.2354, 0.4187, 0.4851, 0.142, 0.308, 0.4594, 0.438, 0.1371, 0.0444, 0.3676, 0.1216]]