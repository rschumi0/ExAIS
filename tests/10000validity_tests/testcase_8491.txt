import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo93041 = tf.keras.layers.Input(shape=([1, 2]))
in0Zer92111 = tf.keras.layers.Input(shape=([2, 3, 3, 1]))

Glo93041 = keras.layers.GlobalMaxPool1D(name = 'Glo93041', )(in0Glo93041)
Res93059 = keras.layers.Reshape((2, 1), name = 'Res93059', )(Glo93041)
Res66629 = keras.layers.Reshape((2, 1, 1), name = 'Res66629', )(Res93059)
Ave3613 = keras.layers.AveragePooling2D(pool_size=(2, 1), strides=(2, 1), padding='same', name = 'Ave3613', )(Res66629)
Res48107 = keras.layers.Reshape((1, 1), name = 'Res48107', )(Ave3613)
Zer51027 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer51027', )(Res48107)
Zer92111 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer92111', )(in0Zer92111)
Res29422 = keras.layers.Reshape((4, 5, 5), name = 'Res29422', )(Zer92111)
Glo36116 = keras.layers.GlobalAveragePooling2D(name = 'Glo36116', )(Res29422)
Res28859 = keras.layers.Reshape((5, 1), name = 'Res28859', )(Glo36116)
Cro37200 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro37200', )(Res28859)
Max59526 = keras.layers.Maximum(name = 'Max59526', )([Zer51027,Cro37200])
model = tf.keras.models.Model(inputs=[in0Glo93041,in0Zer92111], outputs=Max59526)
in0Glo93041 = tf.constant([[[1.6822, 1.4042]]])
in0Zer92111 = tf.constant([[[[[1.2803], [1.9737], [1.0756]], [[1.819], [1.9979], [1.5614]], [[1.7994], [1.2491], [1.3736]]], [[[1.6485], [1.0595], [1.2826]], [[1.7693], [1.1658], [1.3593]], [[1.1951], [1.1087], [1.1091]]]]])
print (np.array2string(model.predict([in0Glo93041,in0Zer92111],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max59526.png')

LGlo93041 = global_max_pool1D_layer([[[1.6822, 1.4042]]], Glo93041), 
LRes93059 = reshape_layer(Glo93041, [2, 1], Res93059), 
LRes66629 = reshape_layer(Res93059, [2, 1, 1], Res66629), 
LAve3613 = average_pooling2D_layer(Res66629, 2, 1, 2, 1, true, Ave3613), 
LRes48107 = reshape_layer(Ave3613, [1, 1], Res48107), 
LZer51027 = zero_padding1D_layer(Res48107, 3, 0, Zer51027), 
LZer92111 = zero_padding3D_layer([[[[[1.2803], [1.9737], [1.0756]], [[1.819], [1.9979], [1.5614]], [[1.7994], [1.2491], [1.3736]]], [[[1.6485], [1.0595], [1.2826]], [[1.7693], [1.1658], [1.3593]], [[1.1951], [1.1087], [1.1091]]]]], 1, 1, 1, 1, 1, 1, Zer92111), 
LRes29422 = reshape_layer(Zer92111, [4, 5, 5], Res29422), 
LGlo36116 = global_average_pooling2D_layer(Res29422, Glo36116), 
LRes28859 = reshape_layer(Glo36116, [5, 1], Res28859), 
LCro37200 = cropping1D_layer(Res28859, 0, 1, Cro37200), 
LMax59526 = maximum_layer([Zer51027,Cro37200], Max59526), 
exec_layers([LGlo93041,LRes93059,LRes66629,LAve3613,LRes48107,LZer51027,LZer92111,LRes29422,LGlo36116,LRes28859,LCro37200,LMax59526],["Glo93041","Res93059","Res66629","Ave3613","Res48107","Zer51027","Zer92111","Res29422","Glo36116","Res28859","Cro37200","Max59526"],Max59526,"Max59526")

Actual (Unparsed): [[[0.0000000], [0.4755800], [0.4277350], [1.5432000]]]

Expected (Unparsed): [[[0],[0.47558],[0.42773500000000003],[1.5432]]]

Actual:   [[[0], [0.4756], [0.4278], [1.5432]]]

Expected: [[[0], [0.4756], [0.4278], [1.5432]]]