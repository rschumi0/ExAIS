import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe54660 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Ave72790 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave72790 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con57927 = tf.keras.layers.Input(shape=([2, 2]))
in0Add84248 = tf.keras.layers.Input(shape=([2, 2]))
in1Add84248 = tf.keras.layers.Input(shape=([2, 2]))
in0Sof78715 = tf.keras.layers.Input(shape=([1, 2]))
in0Con55524 = tf.keras.layers.Input(shape=([2, 2]))

PRe54660 = keras.layers.PReLU(name = 'PRe54660', input_shape=(1, 1, 2))(in0PRe54660)
Res35569 = keras.layers.Reshape((1, 2), name = 'Res35569', )(PRe54660)
ReL67914 = keras.layers.ReLU(max_value=8.124774844998255, negative_slope=9.968059861507559, threshold=1.4489567590748031, name = 'ReL67914', )(Res35569)
Res28630 = keras.layers.Reshape((1, 2, 1), name = 'Res28630', )(ReL67914)
Res68473 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res68473', )(Res28630)
Cro73663 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro73663', )(Res68473)
Ave72790 = keras.layers.Average(name = 'Ave72790', )([in0Ave72790,in1Ave72790])
Sub15113 = keras.layers.Subtract(name = 'Sub15113', )([Cro73663,Ave72790])
Res88949 = keras.layers.Reshape((1, 2, 1), name = 'Res88949', )(Sub15113)
Res54022 = keras.layers.Reshape((1, 2), name = 'Res54022', )(Res88949)
Zer39630 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer39630', )(Res54022)
Con57927 = keras.layers.Concatenate(axis=2, name = 'Con57927', )([Zer39630,in0Con57927])
Add84248 = keras.layers.Add(name = 'Add84248', )([in0Add84248,in1Add84248])
Res39218 = keras.layers.Reshape((2, 2, 1), name = 'Res39218', )(Add84248)
Up_18723 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_18723', )(Res39218)
Res35842 = keras.layers.Reshape((2, 4), name = 'Res35842', )(Up_18723)
Sof78715 = keras.layers.Softmax(axis=1, name = 'Sof78715', input_shape=(1, 2))(in0Sof78715)
Zer58468 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer58468', )(Sof78715)
Con55524 = keras.layers.Concatenate(axis=2, name = 'Con55524', )([Zer58468,in0Con55524])
Sub31726 = keras.layers.Subtract(name = 'Sub31726', )([Res35842,Con55524])
Min77066 = keras.layers.Minimum(name = 'Min77066', )([Con57927,Sub31726])
model = tf.keras.models.Model(inputs=[in0PRe54660,in0Ave72790,in1Ave72790,in0Con57927,in0Add84248,in1Add84248,in0Sof78715,in0Con55524], outputs=Min77066)
w = model.get_layer('PRe54660').get_weights() 
w[0] = np.array([[[0.8412, 0.8015]]])
model.get_layer('PRe54660').set_weights(w) 
in0PRe54660 = tf.constant([[[[0.5079, 0.8164]]]])
in0Ave72790 = tf.constant([[[[[0.0883]], [[0.6698]]]]])
in1Ave72790 = tf.constant([[[[[0.8905]], [[0.9139]]]]])
in0Con57927 = tf.constant([[[0.3686, 0.3186], [0.8487, 0.9115]]])
in0Add84248 = tf.constant([[[0.8734, 0.6976], [0.6639, 0.9097]]])
in1Add84248 = tf.constant([[[0.5026, 0.2375], [0.2252, 0.9778]]])
in0Sof78715 = tf.constant([[[0.5948, 0.0692]]])
in0Con55524 = tf.constant([[[0.1935, 0.0769], [0.6795, 0.7758]]])
print (np.array2string(model.predict([in0PRe54660,in0Ave72790,in1Ave72790,in0Con57927,in0Add84248,in1Add84248,in0Sof78715,in0Con55524],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min77066.png')

LPRe54660 = prelu_layer([[[[0.5079, 0.8164]]]], [[[0.8412, 0.8015]]], PRe54660), 
LRes35569 = reshape_layer(PRe54660, [1, 2], Res35569), 
LReL67914 = relu_layer(Res35569, 8.124774844998255, 9.968059861507559, 1.4489567590748031, ReL67914), 
LRes28630 = reshape_layer(ReL67914, [1, 2, 1], Res28630), 
LRes68473 = reshape_layer(Res28630, [1, 2, 1, 1], Res68473), 
LCro73663 = cropping3D_layer(Res68473, 0, 0, 0, 0, 0, 0, Cro73663), 
LAve72790 = average_layer([[[[[[0.0883]], [[0.6698]]]]], [[[[[0.8905]], [[0.9139]]]]]], Ave72790), 
LSub15113 = subtract_layer(Cro73663,Ave72790, Sub15113), 
LRes88949 = reshape_layer(Sub15113, [1, 2, 1], Res88949), 
LRes54022 = reshape_layer(Res88949, [1, 2], Res54022), 
LZer39630 = zero_padding1D_layer(Res54022, 1, 0, Zer39630), 
LCon57927 = concatenate_layer([Zer39630,[[[0.3686, 0.3186], [0.8487, 0.9115]]]], 2, Con57927), 
LAdd84248 = add_layer([[[[0.8734, 0.6976], [0.6639, 0.9097]]], [[[0.5026, 0.2375], [0.2252, 0.9778]]]], Add84248), 
LRes39218 = reshape_layer(Add84248, [2, 2, 1], Res39218), 
LUp_18723 = up_sampling2D_layer(Res39218, 1, 2, Up_18723), 
LRes35842 = reshape_layer(Up_18723, [2, 4], Res35842), 
LSof78715 = softmax_layer([[[0.5948, 0.0692]]], 1, Sof78715), 
LZer58468 = zero_padding1D_layer(Sof78715, 1, 0, Zer58468), 
LCon55524 = concatenate_layer([Zer58468,[[[0.1935, 0.0769], [0.6795, 0.7758]]]], 2, Con55524), 
LSub31726 = subtract_layer(Res35842,Con55524, Sub31726), 
LMin77066 = minimum_layer([Con57927,Sub31726], Min77066), 
exec_layers([LPRe54660,LRes35569,LReL67914,LRes28630,LRes68473,LCro73663,LAve72790,LSub15113,LRes88949,LRes54022,LZer39630,LCon57927,LAdd84248,LRes39218,LUp_18723,LRes35842,LSof78715,LZer58468,LCon55524,LSub31726,LMin77066],["PRe54660","Res35569","ReL67914","Res28630","Res68473","Cro73663","Ave72790","Sub15113","Res88949","Res54022","Zer39630","Con57927","Add84248","Res39218","Up_18723","Res35842","Sof78715","Zer58468","Con55524","Sub31726","Min77066"],Min77066,"Min77066")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.3686000, 0.3186000], [-9.8699101, -7.0972137, 0.8487000, 0.9115000]]]

Expected (Unparsed): [[[0,0,0.3686,0.3186],[-9.869910107533933,-7.097213640258852,0.8487,0.9115]]]

Actual:   [[[0, 0, 0.3686, 0.3186], [-9.8699, -7.0972, 0.8487, 0.9115]]]

Expected: [[[0, 0, 0.3686, 0.3186], [-9.8699, -7.0972, 0.8487, 0.9115]]]