import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro813 = tf.keras.layers.Input(shape=([3, 1, 2]))

Cro813 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro813', )(in0Cro813)
Loc4118 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc4118', )(Cro813)
model = tf.keras.models.Model(inputs=[in0Cro813], outputs=Loc4118)
w = model.get_layer('Loc4118').get_weights() 
w[0] = np.array([[[0.9397, 0.9847, 0.5802, 0.1681], [0.9281, 0.5424, 0.2323, 0.2486]], [[0.3225, 0.4326, 0.0526, 0.1278], [0.4894, 0.5528, 0.3631, 0.8073]]])
w[1] = np.array([[[0, 0, 0, 0]], [[0, 0, 0, 0]]])
model.get_layer('Loc4118').set_weights(w) 
in0Cro813 = tf.constant([[[[1.9557, 1.3962]], [[1.8592, 1.1191]], [[1.5907, 1.3751]]]])
print (np.array2string(model.predict([in0Cro813],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc4118.png')

LCro813 = cropping2D_layer([[[[1.9557, 1.3962]], [[1.8592, 1.1191]], [[1.5907, 1.3751]]]], 1, 0, 0, 0, Cro813), 
LLoc4118 = locally_connected2D_layer(Cro813, 1, 1,[[[0.9397, 0.9847, 0.5802, 0.1681], [0.9281, 0.5424, 0.2323, 0.2486]], [[0.3225, 0.4326, 0.0526, 0.1278], [0.4894, 0.5528, 0.3631, 0.8073]]],[[[0, 0, 0, 0]], [[0, 0, 0, 0]]], 1, 1, Loc4118), 
exec_layers([LCro813,LLoc4118],["Cro813","Loc4118"],Loc4118,"Loc4118")

Actual (Unparsed): [[[[2.7857269, 2.4377541, 1.3386748, 0.5907398]], [[1.1859747, 1.4482921, 0.5829696, 1.3134097]]]]

Expected (Unparsed): [[[[2.78572695,2.43775408,1.3386747700000001,0.59073978]],[[1.18597469,1.4482921,0.58296963,1.31340969]]]]

Actual:   [[[[2.7858, 2.4378, 1.3387, 0.5908]], [[1.186, 1.4483, 0.583, 1.3135]]]]

Expected: [[[[2.7858, 2.4378, 1.3387, 0.5908]], [[1.186, 1.4483, 0.583, 1.3135]]]]