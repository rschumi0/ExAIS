import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add76961 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add76961 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Ave26381 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave26381 = tf.keras.layers.Input(shape=([2, 2]))

Add76961 = keras.layers.Add(name = 'Add76961', )([in0Add76961,in1Add76961])
Up_84055 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_84055', )(Add76961)
Res46014 = keras.layers.Reshape((4, 4), name = 'Res46014', )(Up_84055)
Ave92853 = keras.layers.AveragePooling1D(pool_size=(2), name = 'Ave92853', )(Res46014)
Res37103 = keras.layers.Reshape((2, 4, 1), name = 'Res37103', )(Ave92853)
Res24724 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res24724', )(Res37103)
Ave26381 = keras.layers.Average(name = 'Ave26381', )([in0Ave26381,in1Ave26381])
Lay46320 = keras.layers.LayerNormalization(axis=1, epsilon=1.7757127953557486, name = 'Lay46320', )(Ave26381)
Res77035 = keras.layers.Reshape((2, 2, 1), name = 'Res77035', )(Lay46320)
Res83194 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res83194', )(Res77035)
Up_29483 = keras.layers.UpSampling3D(size=(1, 1, 1), name = 'Up_29483', )(Res83194)
Zer19082 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer19082', )(Up_29483)
Add25582 = keras.layers.Add(name = 'Add25582', )([Res24724,Zer19082])
model = tf.keras.models.Model(inputs=[in0Add76961,in1Add76961,in0Ave26381,in1Ave26381], outputs=Add25582)
in0Add76961 = tf.constant([[[[0.1514, 0.8196]], [[0.7243, 0.8098]]]])
in1Add76961 = tf.constant([[[[0.3623, 0.0058]], [[0.7252, 0.1999]]]])
in0Ave26381 = tf.constant([[[0.3253, 0.6003], [0.3207, 0.2939]]])
in1Ave26381 = tf.constant([[[0.6176, 0.7389], [0.6398, 0.5852]]])
print (np.array2string(model.predict([in0Add76961,in1Add76961,in0Ave26381,in1Ave26381],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add25582.png')

LAdd76961 = add_layer([[[[[0.1514, 0.8196]], [[0.7243, 0.8098]]]], [[[[0.3623, 0.0058]], [[0.7252, 0.1999]]]]], Add76961), 
LUp_84055 = up_sampling2D_layer(Add76961, 2, 2, Up_84055), 
LRes46014 = reshape_layer(Up_84055, [4, 4], Res46014), 
LAve92853 = average_pooling1D_layer(Res46014, 2, Ave92853), 
LRes37103 = reshape_layer(Ave92853, [2, 4, 1], Res37103), 
LRes24724 = reshape_layer(Res37103, [2, 4, 1, 1], Res24724), 
LAve26381 = average_layer([[[[0.3253, 0.6003], [0.3207, 0.2939]]], [[[0.6176, 0.7389], [0.6398, 0.5852]]]], Ave26381), 
LLay46320 = layer_normalization_layer(Ave26381, 1, 1.7757127953557486, Lay46320), 
LRes77035 = reshape_layer(Lay46320, [2, 2, 1], Res77035), 
LRes83194 = reshape_layer(Res77035, [2, 2, 1, 1], Res83194), 
LUp_29483 = up_sampling3D_layer(Res83194, 1, 1, 1, Up_29483), 
LZer19082 = zero_padding3D_layer(Up_29483, 0, 0, 2, 0, 0, 0, Zer19082), 
LAdd25582 = add_layer([Res24724,Zer19082], Add25582), 
exec_layers([LAdd76961,LUp_84055,LRes46014,LAve92853,LRes37103,LRes24724,LAve26381,LLay46320,LRes77035,LRes83194,LUp_29483,LZer19082,LAdd25582],["Add76961","Up_84055","Res46014","Ave92853","Res37103","Res24724","Ave26381","Lay46320","Res77035","Res83194","Up_29483","Zer19082","Add25582"],Add25582,"Add25582")

Actual (Unparsed): [[[[[0.5137000]], [[0.8254000]], [[0.5103981]], [[0.9113991]]], [[[1.4495000]], [[1.0097000]], [[1.4528019]], [[0.9237009]]]]]

Expected (Unparsed): [[[[[0.5137]],[[0.8254]],[[0.5103980997666366]],[[0.9113991035292676]]],[[[1.4495]],[[1.0097]],[[1.4528019002333634]],[[0.9237008964707324]]]]]

Actual:   [[[[[0.5137]], [[0.8254]], [[0.5104]], [[0.9114]]], [[[1.4495]], [[1.0097]], [[1.4529]], [[0.9238]]]]]

Expected: [[[[[0.5137]], [[0.8254]], [[0.5104]], [[0.9114]]], [[[1.4495]], [[1.0097]], [[1.4529]], [[0.9238]]]]]