import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof50264 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Sof50264 = keras.layers.Softmax(axis=1, name = 'Sof50264', input_shape=(2, 2, 2, 2))(in0Sof50264)
Res55630 = keras.layers.Reshape((2, 2, 4), name = 'Res55630', )(Sof50264)
Con24892 = keras.layers.Conv2DTranspose(3, (2, 1),strides=(1, 1), padding='same', name = 'Con24892', )(Res55630)
Ave34488 = keras.layers.AveragePooling2D(pool_size=(2, 2), name = 'Ave34488', )(Con24892)
Res51974 = keras.layers.Reshape((1, 3), name = 'Res51974', )(Ave34488)
Up_91516 = keras.layers.UpSampling1D(size=(1), name = 'Up_91516', )(Res51974)
Bat14952 = keras.layers.BatchNormalization(axis=2, epsilon=0.6353347408880926,  name = 'Bat14952', )(Up_91516)
model = tf.keras.models.Model(inputs=[in0Sof50264], outputs=Bat14952)
w = model.get_layer('Con24892').get_weights() 
w[0] = np.array([[[[0.4695, 0.91, 0.2225, 0.5161], [0.5828, 0.9495, 0.0753, 0.6308], [0.0465, 0.2432, 0.5347, 0.482]]], [[[0.4803, 0.1058, 0.0335, 0.7428], [0.2908, 0.4282, 0.1105, 0.2226], [0.2009, 0.5367, 0.3864, 0.5992]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con24892').set_weights(w) 
w = model.get_layer('Bat14952').get_weights() 
w[0] = np.array([0.2482, 0.5206, 0.8639])
w[1] = np.array([0.6019, 0.9131, 0.8868])
w[2] = np.array([0.5327, 0.6476, 0.3913])
w[3] = np.array([0.9282, 0.4594, 0.2437])
model.get_layer('Bat14952').set_weights(w) 
in0Sof50264 = tf.constant([[[[[0.3258, 0.7865], [0.0755, 0.3546]], [[0.5508, 0.9314], [0.6598, 0.6618]]], [[[0.625, 0.9676], [0.8836, 0.0038]], [[0.6593, 0.8236], [0.635, 0.8974]]]]])
print (np.array2string(model.predict([in0Sof50264],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat14952.png')

LSof50264 = softmax_layer([[[[[0.3258, 0.7865], [0.0755, 0.3546]], [[0.5508, 0.9314], [0.6598, 0.6618]]], [[[0.625, 0.9676], [0.8836, 0.0038]], [[0.6593, 0.8236], [0.635, 0.8974]]]]], 1, Sof50264), 
LRes55630 = reshape_layer(Sof50264, [2, 2, 4], Res55630), 
LCon24892 = conv2D_transpose_layer(Res55630, 2, 1,[[[[0.4695, 0.91, 0.2225, 0.5161], [0.5828, 0.9495, 0.0753, 0.6308], [0.0465, 0.2432, 0.5347, 0.482]]], [[[0.4803, 0.1058, 0.0335, 0.7428], [0.2908, 0.4282, 0.1105, 0.2226], [0.2009, 0.5367, 0.3864, 0.5992]]]],[0, 0, 0], 1, 1, true, Con24892), 
LAve34488 = average_pooling2D_layer(Con24892, 2, 2, Ave34488), 
LRes51974 = reshape_layer(Ave34488, [1, 3], Res51974), 
LUp_91516 = up_sampling1D_layer(Res51974, 1, Up_91516), 
LBat14952 = batch_normalization_layer(Up_91516, 2, 0.6353347408880926, [0.2482, 0.5206, 0.8639], [0.6019, 0.9131, 0.8868], [0.5327, 0.6476, 0.3913], [0.9282, 0.4594, 0.2437], Bat14952), 
exec_layers([LSof50264,LRes55630,LCon24892,LAve34488,LRes51974,LUp_91516,LBat14952],["Sof50264","Res55630","Con24892","Ave34488","Res51974","Up_91516","Bat14952"],Bat14952,"Bat14952")

Actual (Unparsed): [[[0.7722039, 1.2722173, 1.5055064]]]

Expected (Unparsed): [[[0.7722038737606517,1.2722172988216898,1.5055064027933045]]]

Actual:   [[[0.7723, 1.2723, 1.5056]]]

Expected: [[[0.7723, 1.2723, 1.5056]]]