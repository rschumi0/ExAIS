import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub35356 = tf.keras.layers.Input(shape=([3]))
in1Sub35356 = tf.keras.layers.Input(shape=([3]))

Sub35356 = keras.layers.Subtract(name = 'Sub35356', )([in0Sub35356,in1Sub35356])
Thr9932 = keras.layers.ThresholdedReLU(theta=5.784673120833433, name = 'Thr9932', )(Sub35356)
Sof60110 = keras.layers.Softmax(axis=1, name = 'Sof60110', )(Thr9932)
Res44251 = keras.layers.Reshape((3, 1), name = 'Res44251', )(Sof60110)
Res27632 = keras.layers.Reshape((3, 1, 1), name = 'Res27632', )(Res44251)
Zer84949 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer84949', )(Res27632)
model = tf.keras.models.Model(inputs=[in0Sub35356,in1Sub35356], outputs=Zer84949)
in0Sub35356 = tf.constant([[0.2015, 0.4495, 0.539]])
in1Sub35356 = tf.constant([[0.969, 0.4204, 0.4575]])
print (np.array2string(model.predict([in0Sub35356,in1Sub35356],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer84949.png')

LSub35356 = subtract_layer([[0.2015, 0.4495, 0.539]], [[0.969, 0.4204, 0.4575]], Sub35356), 
LThr9932 = thresholded_relu_layer(Sub35356, 5.784673120833433, Thr9932), 
LSof60110 = softmax_layer(Thr9932, 1, Sof60110), 
LRes44251 = reshape_layer(Sof60110, [3, 1], Res44251), 
LRes27632 = reshape_layer(Res44251, [3, 1, 1], Res27632), 
LZer84949 = zero_padding2D_layer(Res27632, 1, 1, 1, 1, Zer84949), 
exec_layers([LSub35356,LThr9932,LSof60110,LRes44251,LRes27632,LZer84949],["Sub35356","Thr9932","Sof60110","Res44251","Res27632","Zer84949"],Zer84949,"Zer84949")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.3333333], [0.0000000]], [[0.0000000], [0.3333333], [0.0000000]], [[0.0000000], [0.3333333], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[0.3333333333333333],[0]],[[0],[0.3333333333333333],[0]],[[0],[0.3333333333333333],[0]],[[0],[0],[0]]]]

Actual:   [[[[0], [0], [0]], [[0], [0.3334], [0]], [[0], [0.3334], [0]], [[0], [0.3334], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [0.3334], [0]], [[0], [0.3334], [0]], [[0], [0.3334], [0]], [[0], [0], [0]]]]