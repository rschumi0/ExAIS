import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul89370 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul89370 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Max27345 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Max27345 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Add83175 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add83175 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con70395 = tf.keras.layers.Input(shape=([8, 1]))

Mul89370 = keras.layers.Multiply(name = 'Mul89370', )([in0Mul89370,in1Mul89370])
Res84351 = keras.layers.Reshape((1, 2), name = 'Res84351', )(Mul89370)
Zer64419 = keras.layers.ZeroPadding1D(padding=((7, 0)), name = 'Zer64419', )(Res84351)
Max27345 = keras.layers.Maximum(name = 'Max27345', )([in0Max27345,in1Max27345])
Fla96210 = keras.layers.Flatten(name = 'Fla96210', )(Max27345)
Res92794 = keras.layers.Reshape((8, 1), name = 'Res92794', )(Fla96210)
Add83175 = keras.layers.Add(name = 'Add83175', )([in0Add83175,in1Add83175])
Res61169 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res61169', )(Add83175)
Con5250 = keras.layers.Conv3DTranspose(2, (1, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con5250', )(Res61169)
Res65385 = keras.layers.Reshape((8, 1), name = 'Res65385', )(Con5250)
Mul30618 = keras.layers.Multiply(name = 'Mul30618', )([Res92794,Res65385])
Con70395 = keras.layers.Concatenate(axis=2, name = 'Con70395', )([Mul30618,in0Con70395])
Min62680 = keras.layers.Minimum(name = 'Min62680', )([Zer64419,Con70395])
model = tf.keras.models.Model(inputs=[in0Mul89370,in1Mul89370,in0Max27345,in1Max27345,in0Add83175,in1Add83175,in0Con70395], outputs=Min62680)
w = model.get_layer('Con5250').get_weights() 
w[0] = np.array([[[[[0.544], [0.7045]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con5250').set_weights(w) 
in0Mul89370 = tf.constant([[[[0.106, 0.593]]]])
in1Mul89370 = tf.constant([[[[0.8802, 0.0345]]]])
in0Max27345 = tf.constant([[[[[0.8139, 0.3847], [0.2808, 0.5591]]], [[[0.0649, 0.1718], [0.627, 0.1585]]]]])
in1Max27345 = tf.constant([[[[[0.188, 0.5528], [0.9258, 0.3937]]], [[[0.8442, 0.1821], [0.8845, 0.9676]]]]])
in0Add83175 = tf.constant([[[[0.8171], [0.1529]], [[0.4551], [0.0632]]]])
in1Add83175 = tf.constant([[[[0.0015], [0.6553]], [[0.4986], [0.8166]]]])
in0Con70395 = tf.constant([[[0.2394], [0.2864], [0.8266], [0.279], [0.8347], [0.9841], [0.3092], [0.2876]]])
print (np.array2string(model.predict([in0Mul89370,in1Mul89370,in0Max27345,in1Max27345,in0Add83175,in1Add83175,in0Con70395],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min62680.png')

LMul89370 = multiply_layer([[[[[0.106, 0.593]]]], [[[[0.8802, 0.0345]]]]], Mul89370), 
LRes84351 = reshape_layer(Mul89370, [1, 2], Res84351), 
LZer64419 = zero_padding1D_layer(Res84351, 7, 0, Zer64419), 
LMax27345 = maximum_layer([[[[[[0.8139, 0.3847], [0.2808, 0.5591]]], [[[0.0649, 0.1718], [0.627, 0.1585]]]]], [[[[[0.188, 0.5528], [0.9258, 0.3937]]], [[[0.8442, 0.1821], [0.8845, 0.9676]]]]]], Max27345), 
LFla96210 = flatten_layer(Max27345, Fla96210), 
LRes92794 = reshape_layer(Fla96210, [8, 1], Res92794), 
LAdd83175 = add_layer([[[[[0.8171], [0.1529]], [[0.4551], [0.0632]]]], [[[[0.0015], [0.6553]], [[0.4986], [0.8166]]]]], Add83175), 
LRes61169 = reshape_layer(Add83175, [2, 2, 1, 1], Res61169), 
LCon5250 = conv3D_transpose_layer(Res61169, 1, 1, 1,[[[[[0.544], [0.7045]]]]],[0, 0], 1, 1, 1, true, Con5250), 
LRes65385 = reshape_layer(Con5250, [8, 1], Res65385), 
LMul30618 = multiply_layer([Res92794,Res65385], Mul30618), 
LCon70395 = concatenate_layer([Mul30618,[[[0.2394], [0.2864], [0.8266], [0.279], [0.8347], [0.9841], [0.3092], [0.2876]]]], 2, Con70395), 
LMin62680 = minimum_layer([Zer64419,Con70395], Min62680), 
exec_layers([LMul89370,LRes84351,LZer64419,LMax27345,LFla96210,LRes92794,LAdd83175,LRes61169,LCon5250,LRes65385,LMul30618,LCon70395,LMin62680],["Mul89370","Res84351","Zer64419","Max27345","Fla96210","Res92794","Add83175","Res61169","Con5250","Res65385","Mul30618","Con70395","Min62680"],Min62680,"Min62680")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0933012, 0.0204585]]]

Expected (Unparsed): [[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0.0933012,0.0204585]]]

Actual:   [[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0.0934, 0.0205]]]

Expected: [[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0.0934, 0.0205]]]