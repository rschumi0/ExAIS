import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul97607 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Mul97607 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Add51027 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add51027 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Dot36944 = tf.keras.layers.Input(shape=([2]))
in1Dot36944 = tf.keras.layers.Input(shape=([2]))
in0Con6130 = tf.keras.layers.Input(shape=([1]))
in0Con19517 = tf.keras.layers.Input(shape=([2]))

Mul97607 = keras.layers.Multiply(name = 'Mul97607', )([in0Mul97607,in1Mul97607])
Res75513 = keras.layers.Reshape((1, 2, 2), name = 'Res75513', )(Mul97607)
Res24810 = keras.layers.Reshape((1, 4), name = 'Res24810', )(Res75513)
Fla47476 = keras.layers.Flatten(name = 'Fla47476', )(Res24810)
Add51027 = keras.layers.Add(name = 'Add51027', )([in0Add51027,in1Add51027])
Res38887 = keras.layers.Reshape((2, 2), name = 'Res38887', )(Add51027)
Cro81200 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro81200', )(Res38887)
Thr82979 = keras.layers.ThresholdedReLU(theta=6.994853427349605, name = 'Thr82979', )(Cro81200)
Lea30807 = keras.layers.LeakyReLU(alpha=0.4186341093564776, name = 'Lea30807', )(Thr82979)
Fla30779 = keras.layers.Flatten(name = 'Fla30779', )(Lea30807)
Dot36944 = keras.layers.Dot(axes=(1, 1), name = 'Dot36944', )([in0Dot36944,in1Dot36944])
Con6130 = keras.layers.Concatenate(axis=1, name = 'Con6130', )([Dot36944,in0Con6130])
Add59304 = keras.layers.Add(name = 'Add59304', )([Fla30779,Con6130])
Con19517 = keras.layers.Concatenate(axis=1, name = 'Con19517', )([Add59304,in0Con19517])
Mul84916 = keras.layers.Multiply(name = 'Mul84916', )([Fla47476,Con19517])
model = tf.keras.models.Model(inputs=[in0Mul97607,in1Mul97607,in0Add51027,in1Add51027,in0Dot36944,in1Dot36944,in0Con6130,in0Con19517], outputs=Mul84916)
in0Mul97607 = tf.constant([[[[[0.3742, 0.9432]], [[0.4806, 0.8603]]]]])
in1Mul97607 = tf.constant([[[[[0.1721, 0.4042]], [[0.01, 0.8619]]]]])
in0Add51027 = tf.constant([[[[0.0528], [0.9965]], [[0.466], [0.1764]]]])
in1Add51027 = tf.constant([[[[0.6927], [0.633]], [[0.6917], [0.5808]]]])
in0Dot36944 = tf.constant([[0.2822, 0.2781]])
in1Dot36944 = tf.constant([[0.9928, 0.8767]])
in0Con6130 = tf.constant([[0.7134]])
in0Con19517 = tf.constant([[0.0708, 0.2993]])
print (np.array2string(model.predict([in0Mul97607,in1Mul97607,in0Add51027,in1Add51027,in0Dot36944,in1Dot36944,in0Con6130,in0Con19517],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul84916.png')

LMul97607 = multiply_layer([[[[[[0.3742, 0.9432]], [[0.4806, 0.8603]]]]], [[[[[0.1721, 0.4042]], [[0.01, 0.8619]]]]]], Mul97607), 
LRes75513 = reshape_layer(Mul97607, [1, 2, 2], Res75513), 
LRes24810 = reshape_layer(Res75513, [1, 4], Res24810), 
LFla47476 = flatten_layer(Res24810, Fla47476), 
LAdd51027 = add_layer([[[[[0.0528], [0.9965]], [[0.466], [0.1764]]]], [[[[0.6927], [0.633]], [[0.6917], [0.5808]]]]], Add51027), 
LRes38887 = reshape_layer(Add51027, [2, 2], Res38887), 
LCro81200 = cropping1D_layer(Res38887, 1, 0, Cro81200), 
LThr82979 = thresholded_relu_layer(Cro81200, 6.994853427349605, Thr82979), 
LLea30807 = leaky_relu_layer(Thr82979, 0.4186341093564776, Lea30807), 
LFla30779 = flatten_layer(Lea30807, Fla30779), 
LDot36944 = dot_layer([[0.2822, 0.2781]], [[0.9928, 0.8767]], 1, 1, Dot36944), 
LCon6130 = concatenate_layer([Dot36944,[[0.7134]]], 1, Con6130), 
LAdd59304 = add_layer([Fla30779,Con6130], Add59304), 
LCon19517 = concatenate_layer([Add59304,[[0.0708, 0.2993]]], 1, Con19517), 
LMul84916 = multiply_layer([Fla47476,Con19517], Mul84916), 
exec_layers([LMul97607,LRes75513,LRes24810,LFla47476,LAdd51027,LRes38887,LCro81200,LThr82979,LLea30807,LFla30779,LDot36944,LCon6130,LAdd59304,LCon19517,LMul84916],["Mul97607","Res75513","Res24810","Fla47476","Add51027","Res38887","Cro81200","Thr82979","Lea30807","Fla30779","Dot36944","Con6130","Add59304","Con19517","Mul84916"],Mul84916,"Mul84916")

Actual (Unparsed): [[0.0337441, 0.2719776, 0.0003403, 0.2219287]]

Expected (Unparsed): [[0.033744116575882596,0.27197764329600005,0.0003402648,0.221928726201]]

Actual:   [[0.0338, 0.272, 0.0004, 0.222]]

Expected: [[0.0338, 0.272, 0.0004, 0.222]]