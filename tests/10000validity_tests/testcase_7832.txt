import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL47031 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

ReL47031 = keras.layers.ReLU(max_value=9.928451719091827, negative_slope=9.374236506776048, threshold=7.64920880910545, name = 'ReL47031', input_shape=(2, 1, 2, 2))(in0ReL47031)
Zer5978 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer5978', )(ReL47031)
Res66057 = keras.layers.Reshape((4, 3, 8), name = 'Res66057', )(Zer5978)
Res7739 = keras.layers.Reshape((4, 24), name = 'Res7739', )(Res66057)
Sim22378 = keras.layers.SimpleRNN(1,name = 'Sim22378', )(Res7739)
model = tf.keras.models.Model(inputs=[in0ReL47031], outputs=Sim22378)
w = model.get_layer('Sim22378').get_weights() 
w[0] = np.array([[7], [6], [8], [7], [8], [8], [1], [6], [6], [7], [9], [4], [7], [7], [3], [7], [9], [2], [10], [1], [8], [4], [7], [6]])
w[1] = np.array([[1]])
w[2] = np.array([2])
model.get_layer('Sim22378').set_weights(w) 
in0ReL47031 = tf.constant([[[[[0.9672, 0.0506], [0.9174, 0.8778]]], [[[0.9658, 0.3877], [0.4257, 0.9545]]]]])
print (np.array2string(model.predict([in0ReL47031],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim22378.png')

LReL47031 = relu_layer([[[[[0.9672, 0.0506], [0.9174, 0.8778]]], [[[0.9658, 0.3877], [0.4257, 0.9545]]]]], 9.928451719091827, 9.374236506776048, 7.64920880910545, ReL47031), 
LZer5978 = zero_padding3D_layer(ReL47031, 1, 1, 1, 1, 1, 1, Zer5978), 
LRes66057 = reshape_layer(Zer5978, [4, 3, 8], Res66057), 
LRes7739 = reshape_layer(Res66057, [4, 24], Res7739), 
LSim22378 = simple_rnn_layer(Res7739,[[7], [6], [8], [7], [8], [8], [1], [6], [6], [7], [9], [4], [7], [7], [3], [7], [9], [2], [10], [1], [8], [4], [7], [6]],[[1]],[2], Sim22378), 
exec_layers([LReL47031,LZer5978,LRes66057,LRes7739,LSim22378],["ReL47031","Zer5978","Res66057","Res7739","Sim22378"],Sim22378,"Sim22378")

Actual (Unparsed): [[0.7615942]]

Expected (Unparsed): [[0.7615941559557649]]

Actual:   [[0.7616]]

Expected: [[0.7616]]