import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max46971 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Max46971 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Max46971 = keras.layers.Maximum(name = 'Max46971', )([in0Max46971,in1Max46971])
Res62519 = keras.layers.Reshape((2, 1, 2), name = 'Res62519', )(Max46971)
Res87148 = keras.layers.Reshape((2, 2), name = 'Res87148', )(Res62519)
Sim33383 = keras.layers.SimpleRNN(3,name = 'Sim33383', )(Res87148)
Res89274 = keras.layers.Reshape((3, 1), name = 'Res89274', )(Sim33383)
PRe9733 = keras.layers.PReLU(name = 'PRe9733', )(Res89274)
model = tf.keras.models.Model(inputs=[in0Max46971,in1Max46971], outputs=PRe9733)
w = model.get_layer('Sim33383').get_weights() 
w[0] = np.array([[9, 2, 10], [2, 10, 7]])
w[1] = np.array([[3, 7, 3], [4, 4, 2], [2, 9, 4]])
w[2] = np.array([8, 2, 1])
model.get_layer('Sim33383').set_weights(w) 
w = model.get_layer('PRe9733').get_weights() 
w[0] = np.array([[0.8398], [0.2513], [0.5935]])
model.get_layer('PRe9733').set_weights(w) 
in0Max46971 = tf.constant([[[[[0.6665], [0.4938]]], [[[0.9379], [0.8916]]]]])
in1Max46971 = tf.constant([[[[[0.0655], [0.1828]]], [[[0.2614], [0.5133]]]]])
print (np.array2string(model.predict([in0Max46971,in1Max46971],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe9733.png')

LMax46971 = maximum_layer([[[[[[0.6665], [0.4938]]], [[[0.9379], [0.8916]]]]], [[[[[0.0655], [0.1828]]], [[[0.2614], [0.5133]]]]]], Max46971), 
LRes62519 = reshape_layer(Max46971, [2, 1, 2], Res62519), 
LRes87148 = reshape_layer(Res62519, [2, 2], Res87148), 
LSim33383 = simple_rnn_layer(Res87148,[[9, 2, 10], [2, 10, 7]],[[3, 7, 3], [4, 4, 2], [2, 9, 4]],[8, 2, 1], Sim33383), 
LRes89274 = reshape_layer(Sim33383, [3, 1], Res89274), 
LPRe9733 = prelu_layer(Res89274, [[0.8398], [0.2513], [0.5935]], PRe9733), 
exec_layers([LMax46971,LRes62519,LRes87148,LSim33383,LRes89274,LPRe9733],["Max46971","Res62519","Res87148","Sim33383","Res89274","PRe9733"],PRe9733,"PRe9733")

Actual (Unparsed): [[[1.0000000], [1.0000000], [1.0000000]]]

Expected (Unparsed): [[[1.0],[1.0],[1.0]]]

Actual:   [[[1], [1], [1]]]

Expected: [[[1], [1], [1]]]