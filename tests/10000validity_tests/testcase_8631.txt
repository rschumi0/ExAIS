import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep30348 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul93082 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Mul93082 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con32647 = tf.keras.layers.Input(shape=([2]))

Sep30348 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep30348', )(in0Sep30348)
Fla28755 = keras.layers.Flatten(name = 'Fla28755', )(Sep30348)
Mul93082 = keras.layers.Multiply(name = 'Mul93082', )([in0Mul93082,in1Mul93082])
Res99294 = keras.layers.Reshape((1, 1, 2), name = 'Res99294', )(Mul93082)
Res59986 = keras.layers.Reshape((1, 2), name = 'Res59986', )(Res99294)
GRU5377 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU5377', )(Res59986)
Con32647 = keras.layers.Concatenate(axis=1, name = 'Con32647', )([GRU5377,in0Con32647])
Min56437 = keras.layers.Minimum(name = 'Min56437', )([Fla28755,Con32647])
model = tf.keras.models.Model(inputs=[in0Sep30348,in0Mul93082,in1Mul93082,in0Con32647], outputs=Min56437)
w = model.get_layer('Sep30348').get_weights() 
w[0] = np.array([[[0.5235], [0.9161]]])
w[1] = np.array([[[0.5843, 0.397, 0.0194, 0.4778], [0.874, 0.3912, 0.3016, 0.5453]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep30348').set_weights(w) 
w = model.get_layer('GRU5377').get_weights() 
w[0] = np.array([[7, 5, 10, 8, 8, 2], [9, 5, 2, 6, 9, 1]])
w[1] = np.array([[9, 4, 3, 3, 9, 10], [2, 4, 4, 5, 5, 9]])
w[2] = np.array([10, 1, 5, 6, 10, 4])
model.get_layer('GRU5377').set_weights(w) 
in0Sep30348 = tf.constant([[[0.5927, 0.9751]]])
in0Mul93082 = tf.constant([[[[[0.3694, 0.6802]]]]])
in1Mul93082 = tf.constant([[[[[0.4418, 0.2982]]]]])
in0Con32647 = tf.constant([[0.4592, 0.8783]])
print (np.array2string(model.predict([in0Sep30348,in0Mul93082,in1Mul93082,in0Con32647],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min56437.png')

LSep30348 = separable_conv1D_layer([[[0.5927, 0.9751]]], 1,[[[[0.5235], [0.9161]]],[[[0.5843, 0.397, 0.0194, 0.4778], [0.874, 0.3912, 0.3016, 0.5453]]]],[0, 0, 0, 0], 1, true, Sep30348), 
LFla28755 = flatten_layer(Sep30348, Fla28755), 
LMul93082 = multiply_layer([[[[[[0.3694, 0.6802]]]]], [[[[[0.4418, 0.2982]]]]]], Mul93082), 
LRes99294 = reshape_layer(Mul93082, [1, 1, 2], Res99294), 
LRes59986 = reshape_layer(Res99294, [1, 2], Res59986), 
LGRU5377 = gru_layer(Res59986,[[7, 5, 10, 8, 8, 2], [9, 5, 2, 6, 9, 1]],[[9, 4, 3, 3, 9, 10], [2, 4, 4, 5, 5, 9]],[10, 1, 5, 6, 10, 4], false, GRU5377), 
LCon32647 = concatenate_layer([GRU5377,[[0.4592, 0.8783]]], 1, Con32647), 
LMin56437 = minimum_layer([Fla28755,Con32647], Min56437), 
exec_layers([LSep30348,LFla28755,LMul93082,LRes99294,LRes59986,LGRU5377,LCon32647,LMin56437],["Sep30348","Fla28755","Mul93082","Res99294","Res59986","GRU5377","Con32647","Min56437"],Min56437,"Min56437")

Actual (Unparsed): [[0.0000023, 0.0557018, 0.2754354, 0.6353616]]

Expected (Unparsed): [[2.3339941418270826e-6,0.05570181099108008,0.275435397506,0.635361595093]]

Actual:   [[0, 0.0558, 0.2755, 0.6354]]

Expected: [[0, 0.0558, 0.2755, 0.6354]]