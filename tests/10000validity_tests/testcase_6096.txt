import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min3040 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Min3040 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Min3040 = keras.layers.Minimum(name = 'Min3040', )([in0Min3040,in1Min3040])
Res27815 = keras.layers.Reshape((1, 1, 2), name = 'Res27815', )(Min3040)
Loc72331 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 1), name = 'Loc72331', )(Res27815)
model = tf.keras.models.Model(inputs=[in0Min3040,in1Min3040], outputs=Loc72331)
w = model.get_layer('Loc72331').get_weights() 
w[0] = np.array([[[0.5109, 0.5834], [0.9138, 0.8723]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc72331').set_weights(w) 
in0Min3040 = tf.constant([[[[[0.2243, 0.8508]]]]])
in1Min3040 = tf.constant([[[[[0.0765, 0.3144]]]]])
print (np.array2string(model.predict([in0Min3040,in1Min3040],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc72331.png')

LMin3040 = minimum_layer([[[[[[0.2243, 0.8508]]]]], [[[[[0.0765, 0.3144]]]]]], Min3040), 
LRes27815 = reshape_layer(Min3040, [1, 1, 2], Res27815), 
LLoc72331 = locally_connected2D_layer(Res27815, 1, 1,[[[0.5109, 0.5834], [0.9138, 0.8723]]],[[[0, 0]]], 1, 1, Loc72331), 
exec_layers([LMin3040,LRes27815,LLoc72331],["Min3040","Res27815","Loc72331"],Loc72331,"Loc72331")

Actual (Unparsed): [[[[0.3263826, 0.3188812]]]]

Expected (Unparsed): [[[[0.32638257000000004,0.31888122]]]]

Actual:   [[[[0.3264, 0.3189]]]]

Expected: [[[[0.3264, 0.3189]]]]