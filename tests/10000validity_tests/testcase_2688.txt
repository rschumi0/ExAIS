import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min38216 = tf.keras.layers.Input(shape=([1, 2]))
in1Min38216 = tf.keras.layers.Input(shape=([1, 2]))
in0Con5284 = tf.keras.layers.Input(shape=([1, 1]))
in0Add51667 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Add51667 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Glo96645 = tf.keras.layers.Input(shape=([2, 2]))

Min38216 = keras.layers.Minimum(name = 'Min38216', )([in0Min38216,in1Min38216])
Con5284 = keras.layers.Concatenate(axis=2, name = 'Con5284', )([Min38216,in0Con5284])
Add51667 = keras.layers.Add(name = 'Add51667', )([in0Add51667,in1Add51667])
Res43679 = keras.layers.Reshape((2, 1, 1), name = 'Res43679', )(Add51667)
Glo96645 = keras.layers.GlobalAveragePooling1D(name = 'Glo96645', )(in0Glo96645)
Res21454 = keras.layers.Reshape((2, 1), name = 'Res21454', )(Glo96645)
Res44691 = keras.layers.Reshape((2, 1, 1), name = 'Res44691', )(Res21454)
Ave92272 = keras.layers.AveragePooling2D(pool_size=(2, 1), name = 'Ave92272', )(Res44691)
Zer37480 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer37480', )(Ave92272)
Add12114 = keras.layers.Add(name = 'Add12114', )([Res43679,Zer37480])
Con60130 = keras.layers.Conv2D(3, (2, 1),strides=(2, 8), padding='valid', dilation_rate=(1, 1), name = 'Con60130', )(Add12114)
Res24529 = keras.layers.Reshape((1, 3), name = 'Res24529', )(Con60130)
Dot52678 = keras.layers.Dot(axes=(2, 2), name = 'Dot52678', )([Con5284,Res24529])
Res64649 = keras.layers.Reshape((1, 1, 1), name = 'Res64649', )(Dot52678)
Res85109 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res85109', )(Res64649)
Glo16646 = keras.layers.GlobalAveragePooling3D(name = 'Glo16646', )(Res85109)
model = tf.keras.models.Model(inputs=[in0Min38216,in1Min38216,in0Con5284,in0Add51667,in1Add51667,in0Glo96645], outputs=Glo16646)
w = model.get_layer('Con60130').get_weights() 
w[0] = np.array([[[[0.3586, 0.5217, 0.4305]]], [[[0.9774, 0.5854, 0.7449]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con60130').set_weights(w) 
in0Min38216 = tf.constant([[[0.6919, 0.3652]]])
in1Min38216 = tf.constant([[[0.8493, 0.2762]]])
in0Con5284 = tf.constant([[[0.1938]]])
in0Add51667 = tf.constant([[[[[0.3752]]], [[[0.76]]]]])
in1Add51667 = tf.constant([[[[[0.995]]], [[[0.0976]]]]])
in0Glo96645 = tf.constant([[[1.383, 1.7091], [1.707, 1.1673]]])
print (np.array2string(model.predict([in0Min38216,in1Min38216,in0Con5284,in0Add51667,in1Add51667,in0Glo96645],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo16646.png')

LMin38216 = minimum_layer([[[[0.6919, 0.3652]]], [[[0.8493, 0.2762]]]], Min38216), 
LCon5284 = concatenate_layer([Min38216,[[[0.1938]]]], 2, Con5284), 
LAdd51667 = add_layer([[[[[[0.3752]]], [[[0.76]]]]], [[[[[0.995]]], [[[0.0976]]]]]], Add51667), 
LRes43679 = reshape_layer(Add51667, [2, 1, 1], Res43679), 
LGlo96645 = global_average_pooling1D_layer([[[1.383, 1.7091], [1.707, 1.1673]]], Glo96645), 
LRes21454 = reshape_layer(Glo96645, [2, 1], Res21454), 
LRes44691 = reshape_layer(Res21454, [2, 1, 1], Res44691), 
LAve92272 = average_pooling2D_layer(Res44691, 2, 1, Ave92272), 
LZer37480 = zero_padding2D_layer(Ave92272, 1, 0, 0, 0, Zer37480), 
LAdd12114 = add_layer([Res43679,Zer37480], Add12114), 
LCon60130 = conv2D_layer(Add12114, 2, 1,[[[[0.3586, 0.5217, 0.4305]]], [[[0.9774, 0.5854, 0.7449]]]],[0, 0, 0], 2, 8, false, 1, 1, Con60130), 
LRes24529 = reshape_layer(Con60130, [1, 3], Res24529), 
LDot52678 = dot_layer(Con5284,Res24529, 2, 2, Dot52678), 
LRes64649 = reshape_layer(Dot52678, [1, 1, 1], Res64649), 
LRes85109 = reshape_layer(Res64649, [1, 1, 1, 1], Res85109), 
LGlo16646 = global_average_pooling3D_layer(Res85109, Glo16646), 
exec_layers([LMin38216,LCon5284,LAdd51667,LRes43679,LGlo96645,LRes21454,LRes44691,LAve92272,LZer37480,LAdd12114,LCon60130,LRes24529,LDot52678,LRes64649,LRes85109,LGlo16646],["Min38216","Con5284","Add51667","Res43679","Glo96645","Res21454","Res44691","Ave92272","Zer37480","Add12114","Con60130","Res24529","Dot52678","Res64649","Res85109","Glo16646"],Glo16646,"Glo16646")

Actual (Unparsed): [[2.9593694]]

Expected (Unparsed): [[2.9593693528280003]]

Actual:   [[2.9594]]

Expected: [[2.9594]]