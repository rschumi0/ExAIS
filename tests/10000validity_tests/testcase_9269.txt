import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe96514 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

PRe96514 = keras.layers.PReLU(name = 'PRe96514', input_shape=(2, 1, 1, 1))(in0PRe96514)
Res49350 = keras.layers.Reshape((2, 1, 1), name = 'Res49350', )(PRe96514)
Res88295 = keras.layers.Reshape((2, 1), name = 'Res88295', )(Res49350)
Sim69120 = keras.layers.SimpleRNN(2,name = 'Sim69120', )(Res88295)
Res90053 = keras.layers.Reshape((2, 1), name = 'Res90053', )(Sim69120)
Up_21967 = keras.layers.UpSampling1D(size=(2), name = 'Up_21967', )(Res90053)
Cro36720 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro36720', )(Up_21967)
Mas70247 = keras.layers.Masking(mask_value=2, name = 'Mas70247', )(Cro36720)
model = tf.keras.models.Model(inputs=[in0PRe96514], outputs=Mas70247)
w = model.get_layer('PRe96514').get_weights() 
w[0] = np.array([[[[0.3018]]], [[[0.841]]]])
model.get_layer('PRe96514').set_weights(w) 
w = model.get_layer('Sim69120').get_weights() 
w[0] = np.array([[10, 2]])
w[1] = np.array([[2, 10], [3, 6]])
w[2] = np.array([10, 10])
model.get_layer('Sim69120').set_weights(w) 
in0PRe96514 = tf.constant([[[[[0.5912]]], [[[0.7954]]]]])
print (np.array2string(model.predict([in0PRe96514],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas70247.png')

LPRe96514 = prelu_layer([[[[[0.5912]]], [[[0.7954]]]]], [[[[0.3018]]], [[[0.841]]]], PRe96514), 
LRes49350 = reshape_layer(PRe96514, [2, 1, 1], Res49350), 
LRes88295 = reshape_layer(Res49350, [2, 1], Res88295), 
LSim69120 = simple_rnn_layer(Res88295,[[10, 2]],[[2, 10], [3, 6]],[10, 10], Sim69120), 
LRes90053 = reshape_layer(Sim69120, [2, 1], Res90053), 
LUp_21967 = up_sampling1D_layer(Res90053, 2, Up_21967), 
LCro36720 = cropping1D_layer(Up_21967, 0, 0, Cro36720), 
LMas70247 = masking_layer(Cro36720, 2, Mas70247), 
exec_layers([LPRe96514,LRes49350,LRes88295,LSim69120,LRes90053,LUp_21967,LCro36720,LMas70247],["PRe96514","Res49350","Res88295","Sim69120","Res90053","Up_21967","Cro36720","Mas70247"],Mas70247,"Mas70247")

Actual (Unparsed): [[[1.0000000], [1.0000000], [1.0000000], [1.0000000]]]

Expected (Unparsed): [[[1.0],[1.0],[1.0],[1.0]]]

Actual:   [[[1], [1], [1], [1]]]

Expected: [[[1], [1], [1], [1]]]