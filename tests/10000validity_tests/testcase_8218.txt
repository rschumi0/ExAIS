import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max73127 = tf.keras.layers.Input(shape=([1, 2]))
in1Max73127 = tf.keras.layers.Input(shape=([1, 2]))

Max73127 = keras.layers.Maximum(name = 'Max73127', )([in0Max73127,in1Max73127])
Res14361 = keras.layers.Reshape((1, 2, 1), name = 'Res14361', )(Max73127)
Glo857 = keras.layers.GlobalMaxPool2D(name = 'Glo857', )(Res14361)
Res28779 = keras.layers.Reshape((1, 1), name = 'Res28779', )(Glo857)
LST75511 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST75511', )(Res28779)
model = tf.keras.models.Model(inputs=[in0Max73127,in1Max73127], outputs=LST75511)
w = model.get_layer('LST75511').get_weights() 
w[0] = np.array([[1, 5, 1, 5, 5, 8, 3, 7, 8, 6, 10, 10]])
w[1] = np.array([[1, 4, 5, 5, 7, 4, 5, 5, 9, 8, 5, 8], [2, 7, 10, 3, 2, 8, 3, 4, 4, 5, 3, 7], [9, 6, 8, 10, 4, 2, 2, 10, 9, 6, 7, 2]])
w[2] = np.array([3, 3, 4, 8, 5, 1, 10, 2, 3, 8, 7, 6])
model.get_layer('LST75511').set_weights(w) 
in0Max73127 = tf.constant([[[0.1209, 0.0054]]])
in1Max73127 = tf.constant([[[0.2185, 0.9981]]])
print (np.array2string(model.predict([in0Max73127,in1Max73127],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST75511.png')

LMax73127 = maximum_layer([[[[0.1209, 0.0054]]], [[[0.2185, 0.9981]]]], Max73127), 
LRes14361 = reshape_layer(Max73127, [1, 2, 1], Res14361), 
LGlo857 = global_max_pool2D_layer(Res14361, Glo857), 
LRes28779 = reshape_layer(Glo857, [1, 1], Res28779), 
LLST75511 = lstm_layer(Res28779,[[1, 5, 1, 5, 5, 8, 3, 7, 8, 6, 10, 10]],[[1, 4, 5, 5, 7, 4, 5, 5, 9, 8, 5, 8], [2, 7, 10, 3, 2, 8, 3, 4, 4, 5, 3, 7], [9, 6, 8, 10, 4, 2, 2, 10, 9, 6, 7, 2]],[3, 3, 4, 8, 5, 1, 10, 2, 3, 8, 7, 6], LST75511), 
exec_layers([LMax73127,LRes14361,LGlo857,LRes28779,LLST75511],["Max73127","Res14361","Glo857","Res28779","LST75511"],LST75511,"LST75511")

Actual (Unparsed): [[0.7539212, 0.7614519, 0.7587635]]

Expected (Unparsed): [[0.753921205555079,0.7614518916879801,0.7587635204228137]]

Actual:   [[0.754, 0.7615, 0.7588]]

Expected: [[0.754, 0.7615, 0.7588]]