import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add77862 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Add77862 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Add77862 = keras.layers.Add(name = 'Add77862', )([in0Add77862,in1Add77862])
ReL49329 = keras.layers.ReLU(max_value=1.9205199816587561, negative_slope=9.695779433110937, threshold=3.735496126516138, name = 'ReL49329', )(Add77862)
Res96497 = keras.layers.Reshape((2, 2, 4), name = 'Res96497', )(ReL49329)
Res22537 = keras.layers.Reshape((2, 8), name = 'Res22537', )(Res96497)
GRU27010 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU27010', )(Res22537)
model = tf.keras.models.Model(inputs=[in0Add77862,in1Add77862], outputs=GRU27010)
w = model.get_layer('GRU27010').get_weights() 
w[0] = np.array([[2, 8, 8], [7, 9, 8], [7, 6, 8], [10, 2, 2], [9, 8, 6], [10, 3, 9], [7, 8, 7], [10, 3, 1]])
w[1] = np.array([[10, 6, 8]])
w[2] = np.array([[4, 7, 3], [3, 4, 7]])
model.get_layer('GRU27010').set_weights(w) 
in0Add77862 = tf.constant([[[[[0.5126, 0.0391], [0.6961, 0.171]], [[0.613, 0.4801], [0.5486, 0.2611]]], [[[0.1916, 0.4727], [0.1785, 0.4939]], [[0.0833, 0.2793], [0.9027, 0.7455]]]]])
in1Add77862 = tf.constant([[[[[0.0433, 0.2992], [0.5393, 0.5795]], [[0.3708, 0.4682], [0.4479, 0.5438]]], [[[0.8902, 0.563], [0.454, 0.4633]], [[0.3079, 0.3604], [0.2836, 0.1712]]]]])
print (np.array2string(model.predict([in0Add77862,in1Add77862],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU27010.png')

LAdd77862 = add_layer([[[[[[0.5126, 0.0391], [0.6961, 0.171]], [[0.613, 0.4801], [0.5486, 0.2611]]], [[[0.1916, 0.4727], [0.1785, 0.4939]], [[0.0833, 0.2793], [0.9027, 0.7455]]]]], [[[[[0.0433, 0.2992], [0.5393, 0.5795]], [[0.3708, 0.4682], [0.4479, 0.5438]]], [[[0.8902, 0.563], [0.454, 0.4633]], [[0.3079, 0.3604], [0.2836, 0.1712]]]]]], Add77862), 
LReL49329 = relu_layer(Add77862, 1.9205199816587561, 9.695779433110937, 3.735496126516138, ReL49329), 
LRes96497 = reshape_layer(ReL49329, [2, 2, 4], Res96497), 
LRes22537 = reshape_layer(Res96497, [2, 8], Res22537), 
LGRU27010 = gru_layer(Res22537,[[2, 8, 8], [7, 9, 8], [7, 6, 8], [10, 2, 2], [9, 8, 6], [10, 3, 9], [7, 8, 7], [10, 3, 1]],[[10, 6, 8]],[[4, 7, 3], [3, 4, 7]], true, GRU27010), 
exec_layers([LAdd77862,LReL49329,LRes96497,LRes22537,LGRU27010],["Add77862","ReL49329","Res96497","Res22537","GRU27010"],GRU27010,"GRU27010")

Actual (Unparsed): [[-1.0000000]]

Expected (Unparsed): [[-1.0]]

Actual:   [[-1]]

Expected: [[-1]]