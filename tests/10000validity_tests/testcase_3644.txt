import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den23500 = tf.keras.layers.Input(shape=([5, 2]))

Den23500 = keras.layers.Dense(4,name = 'Den23500', )(in0Den23500)
Res64027 = keras.layers.Reshape((5, 4, 1), name = 'Res64027', )(Den23500)
Glo86725 = keras.layers.GlobalMaxPool2D(name = 'Glo86725', )(Res64027)
Res98530 = keras.layers.Reshape((1, 1), name = 'Res98530', )(Glo86725)
Res31808 = keras.layers.Reshape((1, 1, 1), name = 'Res31808', )(Res98530)
Res39555 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res39555', )(Res31808)
Glo92493 = keras.layers.GlobalAveragePooling3D(name = 'Glo92493', )(Res39555)
model = tf.keras.models.Model(inputs=[in0Den23500], outputs=Glo92493)
w = model.get_layer('Den23500').get_weights() 
w[0] = np.array([[0.4762, 0.4375, 0.318, 0.1812], [0.7798, 0.8111, 0.306, 0.877]])
w[1] = np.array([0.9067, 0.3662, 0.2403, 0.5845])
model.get_layer('Den23500').set_weights(w) 
in0Den23500 = tf.constant([[[0.7805, 0.5477], [0.9532, 0.9798], [0.4796, 0.1139], [0.1226, 0.114], [0.1024, 0.4072]]])
print (np.array2string(model.predict([in0Den23500],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo92493.png')

LDen23500 = dense_layer([[[0.7805, 0.5477], [0.9532, 0.9798], [0.4796, 0.1139], [0.1226, 0.114], [0.1024, 0.4072]]], [[0.4762, 0.4375, 0.318, 0.1812], [0.7798, 0.8111, 0.306, 0.877]],[0.9067, 0.3662, 0.2403, 0.5845], Den23500), 
LRes64027 = reshape_layer(Den23500, [5, 4, 1], Res64027), 
LGlo86725 = global_max_pool2D_layer(Res64027, Glo86725), 
LRes98530 = reshape_layer(Glo86725, [1, 1], Res98530), 
LRes31808 = reshape_layer(Res98530, [1, 1, 1], Res31808), 
LRes39555 = reshape_layer(Res31808, [1, 1, 1, 1], Res39555), 
LGlo92493 = global_average_pooling3D_layer(Res39555, Glo92493), 
exec_layers([LDen23500,LRes64027,LGlo86725,LRes98530,LRes31808,LRes39555,LGlo92493],["Den23500","Res64027","Glo86725","Res98530","Res31808","Res39555","Glo92493"],Glo92493,"Glo92493")

Actual (Unparsed): [[2.1246619]]

Expected (Unparsed): [[2.12466188]]

Actual:   [[2.1247]]

Expected: [[2.1247]]