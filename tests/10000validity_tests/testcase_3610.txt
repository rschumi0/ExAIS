import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave42530 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave42530 = tf.keras.layers.Input(shape=([1, 1, 1]))

Ave42530 = keras.layers.Average(name = 'Ave42530', )([in0Ave42530,in1Ave42530])
Sof51473 = keras.layers.Softmax(axis=1, name = 'Sof51473', )(Ave42530)
Res49870 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res49870', )(Sof51473)
PRe14158 = keras.layers.PReLU(name = 'PRe14158', )(Res49870)
model = tf.keras.models.Model(inputs=[in0Ave42530,in1Ave42530], outputs=PRe14158)
w = model.get_layer('PRe14158').get_weights() 
w[0] = np.array([[[[0.3951]]]])
model.get_layer('PRe14158').set_weights(w) 
in0Ave42530 = tf.constant([[[[0.1348]]]])
in1Ave42530 = tf.constant([[[[0.6727]]]])
print (np.array2string(model.predict([in0Ave42530,in1Ave42530],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe14158.png')

LAve42530 = average_layer([[[[[0.1348]]]], [[[[0.6727]]]]], Ave42530), 
LSof51473 = softmax_layer(Ave42530, 1, Sof51473), 
LRes49870 = reshape_layer(Sof51473, [1, 1, 1, 1], Res49870), 
LPRe14158 = prelu_layer(Res49870, [[[[0.3951]]]], PRe14158), 
exec_layers([LAve42530,LSof51473,LRes49870,LPRe14158],["Ave42530","Sof51473","Res49870","PRe14158"],PRe14158,"PRe14158")

Actual (Unparsed): [[[[[1.0000000]]]]]

Expected (Unparsed): [[[[[1.0]]]]]

Actual:   [[[[[1]]]]]

Expected: [[[[[1]]]]]