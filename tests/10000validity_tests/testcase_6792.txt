import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot56423 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot56423 = tf.keras.layers.Input(shape=([3, 3]))

Dot56423 = keras.layers.Dot(axes=(2, 1), name = 'Dot56423', )([in0Dot56423,in1Dot56423])
Sep43613 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep43613', )(Dot56423)
model = tf.keras.models.Model(inputs=[in0Dot56423,in1Dot56423], outputs=Sep43613)
w = model.get_layer('Sep43613').get_weights() 
w[0] = np.array([[[0.6984], [0.9831], [0.5244]]])
w[1] = np.array([[[0.1794, 0.8097, 0.7318, 0.3852], [0.5505, 0.2147, 0.0897, 0.0336], [0.7273, 0.2216, 0.1994, 0.8175]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep43613').set_weights(w) 
in0Dot56423 = tf.constant([[[0.3002, 0.7904, 0.0841], [0.5885, 0.1238, 0.3814], [0.5614, 0.5969, 0.5299]]])
in1Dot56423 = tf.constant([[[0.1802, 0.2825, 0.6338], [0.8813, 0.331, 0.6191], [0.5211, 0.1642, 0.3978]]])
print (np.array2string(model.predict([in0Dot56423,in1Dot56423],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep43613.png')

LDot56423 = dot_layer([[[0.3002, 0.7904, 0.0841], [0.5885, 0.1238, 0.3814], [0.5614, 0.5969, 0.5299]]], [[[0.1802, 0.2825, 0.6338], [0.8813, 0.331, 0.6191], [0.5211, 0.1642, 0.3978]]], 2, 1, Dot56423), 
LSep43613 = separable_conv1D_layer(Dot56423, 1,[[[[0.6984], [0.9831], [0.5244]]],[[[0.1794, 0.8097, 0.7318, 0.3852], [0.5505, 0.2147, 0.0897, 0.0336], [0.7273, 0.2216, 0.1994, 0.8175]]]],[0, 0, 0, 0], 1, true, Sep43613), 
exec_layers([LDot56423,LSep43613],["Dot56423","Sep43613"],Sep43613,"Sep43613")

Actual (Unparsed): [[[0.5664626, 0.6081838, 0.5123888, 0.5313248], [0.4272585, 0.3608989, 0.2982179, 0.3780627], [0.7100736, 0.7131653, 0.5986591, 0.6589847]]]

Expected (Unparsed): [[[0.5664625926784788,0.6081838331938572,0.5123888114127035,0.5313247641404568],[0.4272584860688403,0.3608988645202185,0.2982178750814547,0.3780626968904112],[0.710073574513533,0.7131653011597889,0.5986590729460542,0.6589846928215621]]]

Actual:   [[[0.5665, 0.6082, 0.5124, 0.5314], [0.4273, 0.3609, 0.2983, 0.3781], [0.7101, 0.7132, 0.5987, 0.659]]]

Expected: [[[0.5665, 0.6082, 0.5124, 0.5314], [0.4273, 0.3609, 0.2983, 0.3781], [0.7101, 0.7132, 0.5987, 0.659]]]