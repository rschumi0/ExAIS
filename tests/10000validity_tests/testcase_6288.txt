import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe8079 = tf.keras.layers.Input(shape=([2, 2]))

PRe8079 = keras.layers.PReLU(name = 'PRe8079', input_shape=(2, 2))(in0PRe8079)
Res20967 = keras.layers.Reshape((2, 2, 1), name = 'Res20967', )(PRe8079)
Loc68887 = keras.layers.LocallyConnected2D(2, (1, 2),strides=(2, 1), name = 'Loc68887', )(Res20967)
Res36974 = keras.layers.Reshape((1, 2), name = 'Res36974', )(Loc68887)
Bat15670 = keras.layers.BatchNormalization(axis=1, epsilon=0.2671395707941633,  name = 'Bat15670', )(Res36974)
model = tf.keras.models.Model(inputs=[in0PRe8079], outputs=Bat15670)
w = model.get_layer('PRe8079').get_weights() 
w[0] = np.array([[0.8835, 0.1711], [0.9283, 0.0606]])
model.get_layer('PRe8079').set_weights(w) 
w = model.get_layer('Loc68887').get_weights() 
w[0] = np.array([[[0.5756, 0.1718], [0.1558, 0.3346]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc68887').set_weights(w) 
w = model.get_layer('Bat15670').get_weights() 
w[0] = np.array([0.6314])
w[1] = np.array([0.8985])
w[2] = np.array([0.3263])
w[3] = np.array([0.9066])
model.get_layer('Bat15670').set_weights(w) 
in0PRe8079 = tf.constant([[[0.2486, 0.9913], [0.1183, 0.8891]]])
print (np.array2string(model.predict([in0PRe8079],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat15670.png')

LPRe8079 = prelu_layer([[[0.2486, 0.9913], [0.1183, 0.8891]]], [[0.8835, 0.1711], [0.9283, 0.0606]], PRe8079), 
LRes20967 = reshape_layer(PRe8079, [2, 2, 1], Res20967), 
LLoc68887 = locally_connected2D_layer(Res20967, 1, 2,[[[0.5756, 0.1718], [0.1558, 0.3346]]],[[[0, 0]]], 2, 1, Loc68887), 
LRes36974 = reshape_layer(Loc68887, [1, 2], Res36974), 
LBat15670 = batch_normalization_layer(Res36974, 1, 0.2671395707941633, [0.6314], [0.8985], [0.3263], [0.9066], Bat15670), 
exec_layers([LPRe8079,LRes20967,LLoc68887,LRes36974,LBat15670],["PRe8079","Res20967","Loc68887","Res36974","Bat15670"],Bat15670,"Bat15670")

Actual (Unparsed): [[[0.8817379, 0.9265317]]]

Expected (Unparsed): [[[0.8817379467319376,0.9265317283513529]]]

Actual:   [[[0.8818, 0.9266]]]

Expected: [[[0.8818, 0.9266]]]