import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min62073 = tf.keras.layers.Input(shape=([1, 2]))
in1Min62073 = tf.keras.layers.Input(shape=([1, 2]))
in0Con98847 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Min25293 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Min25293 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Min62073 = keras.layers.Minimum(name = 'Min62073', )([in0Min62073,in1Min62073])
Res4025 = keras.layers.Reshape((1, 2, 1), name = 'Res4025', )(Min62073)
Res88175 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res88175', )(Res4025)
Zer55428 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer55428', )(Res88175)
Con98847 = keras.layers.Concatenate(axis=4, name = 'Con98847', )([Zer55428,in0Con98847])
Min25293 = keras.layers.Minimum(name = 'Min25293', )([in0Min25293,in1Min25293])
Max96340 = keras.layers.Maximum(name = 'Max96340', )([Con98847,Min25293])
model = tf.keras.models.Model(inputs=[in0Min62073,in1Min62073,in0Con98847,in0Min25293,in1Min25293], outputs=Max96340)
in0Min62073 = tf.constant([[[0.7948, 0.4426]]])
in1Min62073 = tf.constant([[[0.0521, 0.7593]]])
in0Con98847 = tf.constant([[[[[0.5204]], [[0.6292]]], [[[0.0641]], [[0.3776]]]]])
in0Min25293 = tf.constant([[[[[0.3682, 0.1887]], [[0.0255, 0.9085]]], [[[0.0439, 0.1795]], [[0.2138, 0.2076]]]]])
in1Min25293 = tf.constant([[[[[0.5437, 0.9861]], [[0.6722, 0.0103]]], [[[0.7284, 0.2235]], [[0.2485, 0.662]]]]])
print (np.array2string(model.predict([in0Min62073,in1Min62073,in0Con98847,in0Min25293,in1Min25293],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max96340.png')

LMin62073 = minimum_layer([[[[0.7948, 0.4426]]], [[[0.0521, 0.7593]]]], Min62073), 
LRes4025 = reshape_layer(Min62073, [1, 2, 1], Res4025), 
LRes88175 = reshape_layer(Res4025, [1, 2, 1, 1], Res88175), 
LZer55428 = zero_padding3D_layer(Res88175, 1, 0, 0, 0, 0, 0, Zer55428), 
LCon98847 = concatenate_layer([Zer55428,[[[[[0.5204]], [[0.6292]]], [[[0.0641]], [[0.3776]]]]]], 4, Con98847), 
LMin25293 = minimum_layer([[[[[[0.3682, 0.1887]], [[0.0255, 0.9085]]], [[[0.0439, 0.1795]], [[0.2138, 0.2076]]]]], [[[[[0.5437, 0.9861]], [[0.6722, 0.0103]]], [[[0.7284, 0.2235]], [[0.2485, 0.662]]]]]], Min25293), 
LMax96340 = maximum_layer([Con98847,Min25293], Max96340), 
exec_layers([LMin62073,LRes4025,LRes88175,LZer55428,LCon98847,LMin25293,LMax96340],["Min62073","Res4025","Res88175","Zer55428","Con98847","Min25293","Max96340"],Max96340,"Max96340")

Actual (Unparsed): [[[[[0.3682000, 0.5204000]], [[0.0255000, 0.6292000]]], [[[0.0521000, 0.1795000]], [[0.4426000, 0.3776000]]]]]

Expected (Unparsed): [[[[[0.3682,0.5204]],[[0.0255,0.6292]]],[[[0.0521,0.1795]],[[0.4426,0.3776]]]]]

Actual:   [[[[[0.3682, 0.5204]], [[0.0255, 0.6292]]], [[[0.0521, 0.1795]], [[0.4426, 0.3776]]]]]

Expected: [[[[[0.3682, 0.5204]], [[0.0255, 0.6292]]], [[[0.0521, 0.1795]], [[0.4426, 0.3776]]]]]