import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min13764 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Min13764 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Min84184 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min84184 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con43928 = tf.keras.layers.Input(shape=([1]))

Min13764 = keras.layers.Minimum(name = 'Min13764', )([in0Min13764,in1Min13764])
Res5684 = keras.layers.Reshape((2, 1, 1), name = 'Res5684', )(Min13764)
Res37670 = keras.layers.Reshape((2, 1), name = 'Res37670', )(Res5684)
Fla62123 = keras.layers.Flatten(name = 'Fla62123', )(Res37670)
Min84184 = keras.layers.Minimum(name = 'Min84184', )([in0Min84184,in1Min84184])
Res69168 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res69168', )(Min84184)
Glo4964 = keras.layers.GlobalAveragePooling3D(name = 'Glo4964', )(Res69168)
Con43928 = keras.layers.Concatenate(axis=1, name = 'Con43928', )([Glo4964,in0Con43928])
Sub24859 = keras.layers.Subtract(name = 'Sub24859', )([Fla62123,Con43928])
Res8630 = keras.layers.Reshape((2, 1), name = 'Res8630', )(Sub24859)
Loc78105 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc78105', )(Res8630)
model = tf.keras.models.Model(inputs=[in0Min13764,in1Min13764,in0Min84184,in1Min84184,in0Con43928], outputs=Loc78105)
w = model.get_layer('Loc78105').get_weights() 
w[0] = np.array([[[0.2596, 0.053, 0.2061, 0.3591]], [[0.7275, 0.1798, 0.9568, 0.7314]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc78105').set_weights(w) 
in0Min13764 = tf.constant([[[[[0.8923]]], [[[0.8495]]]]])
in1Min13764 = tf.constant([[[[[0.9115]]], [[[0.9777]]]]])
in0Min84184 = tf.constant([[[[0.831]], [[0.3899]]]])
in1Min84184 = tf.constant([[[[0.4159]], [[0.3668]]]])
in0Con43928 = tf.constant([[0.807]])
print (np.array2string(model.predict([in0Min13764,in1Min13764,in0Min84184,in1Min84184,in0Con43928],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc78105.png')

LMin13764 = minimum_layer([[[[[[0.8923]]], [[[0.8495]]]]], [[[[[0.9115]]], [[[0.9777]]]]]], Min13764), 
LRes5684 = reshape_layer(Min13764, [2, 1, 1], Res5684), 
LRes37670 = reshape_layer(Res5684, [2, 1], Res37670), 
LFla62123 = flatten_layer(Res37670, Fla62123), 
LMin84184 = minimum_layer([[[[[0.831]], [[0.3899]]]], [[[[0.4159]], [[0.3668]]]]], Min84184), 
LRes69168 = reshape_layer(Min84184, [2, 1, 1, 1], Res69168), 
LGlo4964 = global_average_pooling3D_layer(Res69168, Glo4964), 
LCon43928 = concatenate_layer([Glo4964,[[0.807]]], 1, Con43928), 
LSub24859 = subtract_layer(Fla62123,Con43928, Sub24859), 
LRes8630 = reshape_layer(Sub24859, [2, 1], Res8630), 
LLoc78105 = locally_connected1D_layer(Res8630, 1,[[[0.2596, 0.053, 0.2061, 0.3591]], [[0.7275, 0.1798, 0.9568, 0.7314]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc78105), 
exec_layers([LMin13764,LRes5684,LRes37670,LFla62123,LMin84184,LRes69168,LGlo4964,LCon43928,LSub24859,LRes8630,LLoc78105],["Min13764","Res5684","Res37670","Fla62123","Min84184","Res69168","Glo4964","Con43928","Sub24859","Res8630","Loc78105"],Loc78105,"Loc78105")

Actual (Unparsed): [[[0.1300466, 0.0265504, 0.1032458, 0.1798911], [0.0309188, 0.0076415, 0.0406640, 0.0310845]]]

Expected (Unparsed): [[[0.13004662,0.02655035,0.103245795,0.179891145],[0.030918749999999988,0.007641499999999996,0.040663999999999985,0.03108449999999999]]]

Actual:   [[[0.1301, 0.0266, 0.1033, 0.1799], [0.031, 0.0077, 0.0407, 0.0311]]]

Expected: [[[0.1301, 0.0266, 0.1033, 0.1799], [0.031, 0.0077, 0.0407, 0.0311]]]