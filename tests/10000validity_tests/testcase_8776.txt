import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub75949 = tf.keras.layers.Input(shape=([3]))
in1Sub75949 = tf.keras.layers.Input(shape=([3]))
in0Add1906 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Add1906 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Sub75949 = keras.layers.Subtract(name = 'Sub75949', )([in0Sub75949,in1Sub75949])
Sof83231 = keras.layers.Softmax(axis=1, name = 'Sof83231', )(Sub75949)
Res93542 = keras.layers.Reshape((3, 1), name = 'Res93542', )(Sof83231)
PRe30925 = keras.layers.PReLU(name = 'PRe30925', )(Res93542)
Res65324 = keras.layers.Reshape((3, 1, 1), name = 'Res65324', )(PRe30925)
Res39782 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res39782', )(Res65324)
Zer67146 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (2, 0)), name = 'Zer67146', )(Res39782)
Add1906 = keras.layers.Add(name = 'Add1906', )([in0Add1906,in1Add1906])
Zer56101 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer56101', )(Add1906)
Max37787 = keras.layers.Maximum(name = 'Max37787', )([Zer67146,Zer56101])
model = tf.keras.models.Model(inputs=[in0Sub75949,in1Sub75949,in0Add1906,in1Add1906], outputs=Max37787)
w = model.get_layer('PRe30925').get_weights() 
w[0] = np.array([[0.3999], [0.163], [0.5813]])
model.get_layer('PRe30925').set_weights(w) 
in0Sub75949 = tf.constant([[0.5519, 0.7489, 0.4183]])
in1Sub75949 = tf.constant([[0.6722, 0.142, 0.1023]])
in0Add1906 = tf.constant([[[[[0.9641], [0.0344]], [[0.5933], [0.4786]]], [[[0.5356], [0.9625]], [[0.976], [0.6712]]]]])
in1Add1906 = tf.constant([[[[[0.3477], [0.4592]], [[0.2665], [0.9669]]], [[[0.7434], [0.4334]], [[0.8325], [0.9376]]]]])
print (np.array2string(model.predict([in0Sub75949,in1Sub75949,in0Add1906,in1Add1906],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max37787.png')

LSub75949 = subtract_layer([[0.5519, 0.7489, 0.4183]], [[0.6722, 0.142, 0.1023]], Sub75949), 
LSof83231 = softmax_layer(Sub75949, 1, Sof83231), 
LRes93542 = reshape_layer(Sof83231, [3, 1], Res93542), 
LPRe30925 = prelu_layer(Res93542, [[0.3999], [0.163], [0.5813]], PRe30925), 
LRes65324 = reshape_layer(PRe30925, [3, 1, 1], Res65324), 
LRes39782 = reshape_layer(Res65324, [3, 1, 1, 1], Res39782), 
LZer67146 = zero_padding3D_layer(Res39782, 0, 0, 2, 0, 2, 0, Zer67146), 
LAdd1906 = add_layer([[[[[[0.9641], [0.0344]], [[0.5933], [0.4786]]], [[[0.5356], [0.9625]], [[0.976], [0.6712]]]]], [[[[[0.3477], [0.4592]], [[0.2665], [0.9669]]], [[[0.7434], [0.4334]], [[0.8325], [0.9376]]]]]], Add1906), 
LZer56101 = zero_padding3D_layer(Add1906, 1, 0, 1, 0, 1, 0, Zer56101), 
LMax37787 = maximum_layer([Zer67146,Zer56101], Max37787), 
exec_layers([LSub75949,LSof83231,LRes93542,LPRe30925,LRes65324,LRes39782,LZer67146,LAdd1906,LZer56101,LMax37787],["Sub75949","Sof83231","Res93542","PRe30925","Res65324","Res39782","Zer67146","Add1906","Zer56101","Max37787"],Max37787,"Max37787")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.2166260]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.3118000], [0.4936000]], [[0.0000000], [0.8598000], [1.4455000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.2790000], [1.3959000]], [[0.0000000], [1.8085000], [1.6088000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0.21662598707201536]]],[[[0],[0],[0]],[[0],[1.3117999999999999],[0.4936]],[[0],[0.8598000000000001],[1.4455]]],[[[0],[0],[0]],[[0],[1.279],[1.3959000000000001]],[[0],[1.8085],[1.6088]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.2167]]], [[[0], [0], [0]], [[0], [1.3118], [0.4936]], [[0], [0.8598], [1.4455]]], [[[0], [0], [0]], [[0], [1.279], [1.3959]], [[0], [1.8085], [1.6088]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.2167]]], [[[0], [0], [0]], [[0], [1.3118], [0.4936]], [[0], [0.8599], [1.4455]]], [[[0], [0], [0]], [[0], [1.279], [1.396]], [[0], [1.8085], [1.6088]]]]]