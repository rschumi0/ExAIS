import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add46724 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Add46724 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Add46724 = keras.layers.Add(name = 'Add46724', )([in0Add46724,in1Add46724])
Res96716 = keras.layers.Reshape((2, 2, 4), name = 'Res96716', )(Add46724)
Res88580 = keras.layers.Reshape((2, 8), name = 'Res88580', )(Res96716)
Cro12461 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro12461', )(Res88580)
GRU75181 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU75181', )(Cro12461)
model = tf.keras.models.Model(inputs=[in0Add46724,in1Add46724], outputs=GRU75181)
w = model.get_layer('GRU75181').get_weights() 
w[0] = np.array([[2, 5, 3, 6, 7, 7, 9, 6, 3], [2, 7, 6, 2, 8, 9, 9, 7, 6], [6, 1, 4, 7, 8, 10, 4, 8, 5], [4, 6, 10, 4, 8, 6, 3, 2, 4], [9, 10, 2, 7, 2, 10, 8, 10, 9], [4, 9, 9, 7, 3, 4, 5, 5, 9], [4, 8, 4, 7, 4, 4, 4, 2, 8], [9, 1, 7, 2, 4, 4, 9, 9, 7]])
w[1] = np.array([[2, 7, 6, 1, 3, 3, 9, 7, 5], [4, 2, 1, 6, 10, 4, 5, 4, 7], [10, 2, 4, 4, 8, 2, 4, 8, 4]])
w[2] = np.array([4, 1, 2, 6, 8, 10, 9, 9, 4])
model.get_layer('GRU75181').set_weights(w) 
in0Add46724 = tf.constant([[[[[0.1264, 0.8405], [0.4751, 0.2922]], [[0.3685, 0.765], [0.5823, 0.7567]]], [[[0.6498, 0.3253], [0.0273, 0.1946]], [[0.6337, 0.7638], [0.8608, 0.9203]]]]])
in1Add46724 = tf.constant([[[[[0.5151, 0.4468], [0.5511, 0.9318]], [[0.6709, 0.025], [0.597, 0.2825]]], [[[0.0035, 0.7139], [0.0797, 0.038]], [[0.5845, 0.9773], [0.0424, 0.1381]]]]])
print (np.array2string(model.predict([in0Add46724,in1Add46724],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU75181.png')

LAdd46724 = add_layer([[[[[[0.1264, 0.8405], [0.4751, 0.2922]], [[0.3685, 0.765], [0.5823, 0.7567]]], [[[0.6498, 0.3253], [0.0273, 0.1946]], [[0.6337, 0.7638], [0.8608, 0.9203]]]]], [[[[[0.5151, 0.4468], [0.5511, 0.9318]], [[0.6709, 0.025], [0.597, 0.2825]]], [[[0.0035, 0.7139], [0.0797, 0.038]], [[0.5845, 0.9773], [0.0424, 0.1381]]]]]], Add46724), 
LRes96716 = reshape_layer(Add46724, [2, 2, 4], Res96716), 
LRes88580 = reshape_layer(Res96716, [2, 8], Res88580), 
LCro12461 = cropping1D_layer(Res88580, 1, 0, Cro12461), 
LGRU75181 = gru_layer(Cro12461,[[2, 5, 3, 6, 7, 7, 9, 6, 3], [2, 7, 6, 2, 8, 9, 9, 7, 6], [6, 1, 4, 7, 8, 10, 4, 8, 5], [4, 6, 10, 4, 8, 6, 3, 2, 4], [9, 10, 2, 7, 2, 10, 8, 10, 9], [4, 9, 9, 7, 3, 4, 5, 5, 9], [4, 8, 4, 7, 4, 4, 4, 2, 8], [9, 1, 7, 2, 4, 4, 9, 9, 7]],[[2, 7, 6, 1, 3, 3, 9, 7, 5], [4, 2, 1, 6, 10, 4, 5, 4, 7], [10, 2, 4, 4, 8, 2, 4, 8, 4]],[4, 1, 2, 6, 8, 10, 9, 9, 4], false, GRU75181), 
exec_layers([LAdd46724,LRes96716,LRes88580,LCro12461,LGRU75181],["Add46724","Res96716","Res88580","Cro12461","GRU75181"],GRU75181,"GRU75181")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0,0.0]]

Actual:   [[0, 0, 0]]

Expected: [[0, 0, 0]]