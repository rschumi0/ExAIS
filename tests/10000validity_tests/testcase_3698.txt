import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr54590 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Dot17013 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot17013 = tf.keras.layers.Input(shape=([2, 2]))
in0LST28567 = tf.keras.layers.Input(shape=([2, 2]))
in0Con53504 = tf.keras.layers.Input(shape=([2]))
in0Con59814 = tf.keras.layers.Input(shape=([32]))
in0Dep1541 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Add43597 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Add43597 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Thr54590 = keras.layers.ThresholdedReLU(theta=6.829931336075055, name = 'Thr54590', input_shape=(2, 1, 1))(in0Thr54590)
Res6210 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res6210', )(Thr54590)
Zer16467 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer16467', )(Res6210)
Res96569 = keras.layers.Reshape((4, 3, 3), name = 'Res96569', )(Zer16467)
Res92094 = keras.layers.Reshape((4, 9), name = 'Res92094', )(Res96569)
Fla68446 = keras.layers.Flatten(name = 'Fla68446', )(Res92094)
Dot17013 = keras.layers.Dot(axes=(1, 1), name = 'Dot17013', )([in0Dot17013,in1Dot17013])
Fla89226 = keras.layers.Flatten(name = 'Fla89226', )(Dot17013)
LST28567 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST28567', )(in0LST28567)
Con53504 = keras.layers.Concatenate(axis=1, name = 'Con53504', )([LST28567,in0Con53504])
Min3866 = keras.layers.Minimum(name = 'Min3866', )([Fla89226,Con53504])
Con59814 = keras.layers.Concatenate(axis=1, name = 'Con59814', )([Min3866,in0Con59814])
Max83215 = keras.layers.Maximum(name = 'Max83215', )([Fla68446,Con59814])
Res99501 = keras.layers.Reshape((36, 1), name = 'Res99501', )(Max83215)
Sim67335 = keras.layers.SimpleRNN(1,name = 'Sim67335', )(Res99501)
Res54074 = keras.layers.Reshape((1, 1), name = 'Res54074', )(Sim67335)
Dep1541 = keras.layers.DepthwiseConv2D((1, 1),strides=(2, 2), padding='same', name = 'Dep1541', )(in0Dep1541)
Max49796 = keras.layers.MaxPool2D(pool_size=(2, 2), strides=(2, 1), padding='same', name = 'Max49796', )(Dep1541)
Res71718 = keras.layers.Reshape((1, 1), name = 'Res71718', )(Max49796)
Add43597 = keras.layers.Add(name = 'Add43597', )([in0Add43597,in1Add43597])
ReL71936 = keras.layers.ReLU(max_value=4.276130891523497, negative_slope=6.795739193358482, threshold=9.247651487679232, name = 'ReL71936', )(Add43597)
Res70413 = keras.layers.Reshape((1, 1), name = 'Res70413', )(ReL71936)
Dot92192 = keras.layers.Dot(axes=(1, 2), name = 'Dot92192', )([Res71718,Res70413])
Max72042 = keras.layers.Maximum(name = 'Max72042', )([Res54074,Dot92192])
model = tf.keras.models.Model(inputs=[in0Thr54590,in0Dot17013,in1Dot17013,in0LST28567,in0Con53504,in0Con59814,in0Dep1541,in0Add43597,in1Add43597], outputs=Max72042)
w = model.get_layer('LST28567').get_weights() 
w[0] = np.array([[6, 6, 8, 4, 3, 10, 7, 5], [4, 5, 4, 2, 1, 9, 8, 3]])
w[1] = np.array([[5, 9, 8, 9, 5, 10, 9, 5], [3, 5, 9, 7, 1, 8, 9, 8]])
w[2] = np.array([5, 10, 9, 1, 5, 4, 7, 6])
model.get_layer('LST28567').set_weights(w) 
w = model.get_layer('Sim67335').get_weights() 
w[0] = np.array([[8]])
w[1] = np.array([[9]])
w[2] = np.array([10])
model.get_layer('Sim67335').set_weights(w) 
w = model.get_layer('Dep1541').get_weights() 
w[0] = np.array([[[[0.3342]]]])
w[1] = np.array([0])
model.get_layer('Dep1541').set_weights(w) 
in0Thr54590 = tf.constant([[[[0.5793]], [[0.4882]]]])
in0Dot17013 = tf.constant([[[0.8241, 0.4006], [0.3566, 0.9257]]])
in1Dot17013 = tf.constant([[[0.5731, 0.4703], [0.822, 0.6316]]])
in0LST28567 = tf.constant([[[6, 5], [7, 5]]])
in0Con53504 = tf.constant([[0.2167, 0.7173]])
in0Con59814 = tf.constant([[0.204, 0.2958, 0.6005, 0.8507, 0.5723, 0.0247, 0.4133, 0.8536, 0.9602, 0.4294, 0.3776, 0.5725, 0.6009, 0.3292, 0.2599, 0.7252, 0.0904, 0.4933, 0.3764, 0.9176, 0.9746, 0.9932, 0.642, 0.9927, 0.241, 0.4135, 0.5289, 0.5027, 0.5849, 0.9373, 0.98, 0.2834]])
in0Dep1541 = tf.constant([[[[0.4711], [0.2903]], [[0.3322], [0.1548]]]])
in0Add43597 = tf.constant([[[[[0.1484]]]]])
in1Add43597 = tf.constant([[[[[0.7236]]]]])
print (np.array2string(model.predict([in0Thr54590,in0Dot17013,in1Dot17013,in0LST28567,in0Con53504,in0Con59814,in0Dep1541,in0Add43597,in1Add43597],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max72042.png')

LThr54590 = thresholded_relu_layer([[[[0.5793]], [[0.4882]]]], 6.829931336075055, Thr54590), 
LRes6210 = reshape_layer(Thr54590, [2, 1, 1, 1], Res6210), 
LZer16467 = zero_padding3D_layer(Res6210, 1, 1, 1, 1, 1, 1, Zer16467), 
LRes96569 = reshape_layer(Zer16467, [4, 3, 3], Res96569), 
LRes92094 = reshape_layer(Res96569, [4, 9], Res92094), 
LFla68446 = flatten_layer(Res92094, Fla68446), 
LDot17013 = dot_layer([[[0.8241, 0.4006], [0.3566, 0.9257]]], [[[0.5731, 0.4703], [0.822, 0.6316]]], 1, 1, Dot17013), 
LFla89226 = flatten_layer(Dot17013, Fla89226), 
LLST28567 = lstm_layer([[[6, 5], [7, 5]]],[[6, 6, 8, 4, 3, 10, 7, 5], [4, 5, 4, 2, 1, 9, 8, 3]],[[5, 9, 8, 9, 5, 10, 9, 5], [3, 5, 9, 7, 1, 8, 9, 8]],[5, 10, 9, 1, 5, 4, 7, 6], LST28567), 
LCon53504 = concatenate_layer([LST28567,[[0.2167, 0.7173]]], 1, Con53504), 
LMin3866 = minimum_layer([Fla89226,Con53504], Min3866), 
LCon59814 = concatenate_layer([Min3866,[[0.204, 0.2958, 0.6005, 0.8507, 0.5723, 0.0247, 0.4133, 0.8536, 0.9602, 0.4294, 0.3776, 0.5725, 0.6009, 0.3292, 0.2599, 0.7252, 0.0904, 0.4933, 0.3764, 0.9176, 0.9746, 0.9932, 0.642, 0.9927, 0.241, 0.4135, 0.5289, 0.5027, 0.5849, 0.9373, 0.98, 0.2834]]], 1, Con59814), 
LMax83215 = maximum_layer([Fla68446,Con59814], Max83215), 
LRes99501 = reshape_layer(Max83215, [36, 1], Res99501), 
LSim67335 = simple_rnn_layer(Res99501,[[8]],[[9]],[10], Sim67335), 
LRes54074 = reshape_layer(Sim67335, [1, 1], Res54074), 
LDep1541 = depthwise_conv2D_layer([[[[0.4711], [0.2903]], [[0.3322], [0.1548]]]], 1, 1,[[[[0.3342]]]],[0], 2, 2, true, Dep1541), 
LMax49796 = max_pool2D_layer(Dep1541, 2, 2, 2, 1, true, Max49796), 
LRes71718 = reshape_layer(Max49796, [1, 1], Res71718), 
LAdd43597 = add_layer([[[[[[0.1484]]]]], [[[[[0.7236]]]]]], Add43597), 
LReL71936 = relu_layer(Add43597, 4.276130891523497, 6.795739193358482, 9.247651487679232, ReL71936), 
LRes70413 = reshape_layer(ReL71936, [1, 1], Res70413), 
LDot92192 = dot_layer(Res71718,Res70413, 1, 2, Dot92192), 
LMax72042 = maximum_layer([Res54074,Dot92192], Max72042), 
exec_layers([LThr54590,LRes6210,LZer16467,LRes96569,LRes92094,LFla68446,LDot17013,LFla89226,LLST28567,LCon53504,LMin3866,LCon59814,LMax83215,LRes99501,LSim67335,LRes54074,LDep1541,LMax49796,LRes71718,LAdd43597,LReL71936,LRes70413,LDot92192,LMax72042],["Thr54590","Res6210","Zer16467","Res96569","Res92094","Fla68446","Dot17013","Fla89226","LST28567","Con53504","Min3866","Con59814","Max83215","Res99501","Sim67335","Res54074","Dep1541","Max49796","Res71718","Add43597","ReL71936","Res70413","Dot92192","Max72042"],Max72042,"Max72042")

Actual (Unparsed): [[[1.0000000]]]

Expected (Unparsed): [[[1.0]]]

Actual:   [[[1]]]

Expected: [[[1]]]