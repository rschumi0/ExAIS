import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub71257 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub71257 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sep12551 = tf.keras.layers.Input(shape=([1, 1]))
in0Mul63984 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul63984 = tf.keras.layers.Input(shape=([2, 1]))
in0Con10257 = tf.keras.layers.Input(shape=([2, 2, 1]))

Sub71257 = keras.layers.Subtract(name = 'Sub71257', )([in0Sub71257,in1Sub71257])
Sep12551 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep12551', )(in0Sep12551)
Res55118 = keras.layers.Reshape((1, 4, 1), name = 'Res55118', )(Sep12551)
Con25706 = keras.layers.Conv2D(2, (1, 3),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con25706', )(Res55118)
Zer80292 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer80292', )(Con25706)
Max71032 = keras.layers.Maximum(name = 'Max71032', )([Sub71257,Zer80292])
Mul63984 = keras.layers.Multiply(name = 'Mul63984', )([in0Mul63984,in1Mul63984])
Res99382 = keras.layers.Reshape((2, 1, 1), name = 'Res99382', )(Mul63984)
Dep72325 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='valid', name = 'Dep72325', )(Res99382)
Zer16606 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer16606', )(Dep72325)
Con10257 = keras.layers.Concatenate(axis=3, name = 'Con10257', )([Zer16606,in0Con10257])
Min27622 = keras.layers.Minimum(name = 'Min27622', )([Max71032,Con10257])
model = tf.keras.models.Model(inputs=[in0Sub71257,in1Sub71257,in0Sep12551,in0Mul63984,in1Mul63984,in0Con10257], outputs=Min27622)
w = model.get_layer('Sep12551').get_weights() 
w[0] = np.array([[[0.9089]]])
w[1] = np.array([[[0.6843, 0.2761, 0.7651, 0.7248]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep12551').set_weights(w) 
w = model.get_layer('Con25706').get_weights() 
w[0] = np.array([[[[0.4813, 0.2264]], [[0.8441, 0.4196]], [[0.7176, 0.7479]]]])
w[1] = np.array([0, 0])
model.get_layer('Con25706').set_weights(w) 
w = model.get_layer('Dep72325').get_weights() 
w[0] = np.array([[[[0.628]]], [[[0.841]]]])
w[1] = np.array([0])
model.get_layer('Dep72325').set_weights(w) 
in0Sub71257 = tf.constant([[[[0.6007, 0.3023], [0.1364, 0.2312]], [[0.5425, 0.9897], [0.1718, 0.811]]]])
in1Sub71257 = tf.constant([[[[0.3876, 0.1117], [0.2267, 0.9375]], [[0.8287, 0.059], [0.8157, 0.4278]]]])
in0Sep12551 = tf.constant([[[0.8502]]])
in0Mul63984 = tf.constant([[[0.1294], [0.3942]]])
in1Mul63984 = tf.constant([[[0.3669], [0.733]]])
in0Con10257 = tf.constant([[[[0.705], [0.3583]], [[0.6135], [0.8124]]]])
print (np.array2string(model.predict([in0Sub71257,in1Sub71257,in0Sep12551,in0Mul63984,in1Mul63984,in0Con10257],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min27622.png')

LSub71257 = subtract_layer([[[[0.6007, 0.3023], [0.1364, 0.2312]], [[0.5425, 0.9897], [0.1718, 0.811]]]], [[[[0.3876, 0.1117], [0.2267, 0.9375]], [[0.8287, 0.059], [0.8157, 0.4278]]]], Sub71257), 
LSep12551 = separable_conv1D_layer([[[0.8502]]], 1,[[[[0.9089]]],[[[0.6843, 0.2761, 0.7651, 0.7248]]]],[0, 0, 0, 0], 1, false, Sep12551), 
LRes55118 = reshape_layer(Sep12551, [1, 4, 1], Res55118), 
LCon25706 = conv2D_layer(Res55118, 1, 3,[[[[0.4813, 0.2264]], [[0.8441, 0.4196]], [[0.7176, 0.7479]]]],[0, 0], 1, 1, false, 1, 1, Con25706), 
LZer80292 = zero_padding2D_layer(Con25706, 1, 0, 0, 0, Zer80292), 
LMax71032 = maximum_layer([Sub71257,Zer80292], Max71032), 
LMul63984 = multiply_layer([[[[0.1294], [0.3942]]], [[[0.3669], [0.733]]]], Mul63984), 
LRes99382 = reshape_layer(Mul63984, [2, 1, 1], Res99382), 
LDep72325 = depthwise_conv2D_layer(Res99382, 2, 1,[[[[0.628]]], [[[0.841]]]],[0], 1, 1, false, Dep72325), 
LZer16606 = zero_padding2D_layer(Dep72325, 1, 0, 1, 0, Zer16606), 
LCon10257 = concatenate_layer([Zer16606,[[[[0.705], [0.3583]], [[0.6135], [0.8124]]]]], 3, Con10257), 
LMin27622 = minimum_layer([Max71032,Con10257], Min27622), 
exec_layers([LSub71257,LSep12551,LRes55118,LCon25706,LZer80292,LMax71032,LMul63984,LRes99382,LDep72325,LZer16606,LCon10257,LMin27622],["Sub71257","Sep12551","Res55118","Con25706","Zer80292","Max71032","Mul63984","Res99382","Dep72325","Zer16606","Con10257","Min27622"],Min27622,"Min27622")

Actual (Unparsed): [[[[0.0000000, 0.1906000], [0.0000000, 0.0000000]], [[0.0000000, 0.6135000], [0.2728212, 0.7152721]]]]

Expected (Unparsed): [[[[0,0.19060000000000002],[0,0]],[[0,0.6135],[0.27282124068,0.7152721309241975]]]]

Actual:   [[[[0, 0.1906], [0, 0]], [[0, 0.6135], [0.2729, 0.7153]]]]

Expected: [[[[0, 0.1907], [0, 0]], [[0, 0.6135], [0.2729, 0.7153]]]]