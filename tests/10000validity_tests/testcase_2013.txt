import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min26830 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min26830 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0ELU43903 = tf.keras.layers.Input(shape=([2, 1]))
in0Con39167 = tf.keras.layers.Input(shape=([2, 1, 2]))

Min26830 = keras.layers.Minimum(name = 'Min26830', )([in0Min26830,in1Min26830])
Con52332 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 1), padding='valid', name = 'Con52332', )(Min26830)
ELU43903 = keras.layers.ELU(alpha=2.6465219723185047, name = 'ELU43903', input_shape=(2, 1))(in0ELU43903)
Res6212 = keras.layers.Reshape((2, 1, 1), name = 'Res6212', )(ELU43903)
Cro91137 = keras.layers.Cropping2D(cropping=((0, 1), (0, 0)), name = 'Cro91137', )(Res6212)
Zer2496 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer2496', )(Cro91137)
Con39167 = keras.layers.Concatenate(axis=3, name = 'Con39167', )([Zer2496,in0Con39167])
Sub65349 = keras.layers.Subtract(name = 'Sub65349', )([Con52332,Con39167])
Res19525 = keras.layers.Reshape((2, 3), name = 'Res19525', )(Sub65349)
LST30903 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST30903', )(Res19525)
model = tf.keras.models.Model(inputs=[in0Min26830,in1Min26830,in0ELU43903,in0Con39167], outputs=LST30903)
w = model.get_layer('Con52332').get_weights() 
w[0] = np.array([[[[0.3232], [0.8749], [0.2187]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con52332').set_weights(w) 
w = model.get_layer('LST30903').get_weights() 
w[0] = np.array([[9, 4, 7, 5, 6, 9, 9, 6], [9, 3, 5, 2, 9, 3, 10, 4], [6, 7, 6, 9, 8, 5, 10, 6]])
w[1] = np.array([[4, 6, 10, 8, 2, 9, 6, 8], [3, 6, 10, 9, 4, 6, 8, 10]])
w[2] = np.array([4, 5, 8, 8, 8, 10, 2, 5])
model.get_layer('LST30903').set_weights(w) 
in0Min26830 = tf.constant([[[[0.0327]], [[0.8654]]]])
in1Min26830 = tf.constant([[[[0.9315]], [[0.0662]]]])
in0ELU43903 = tf.constant([[[0.2841], [0.8382]]])
in0Con39167 = tf.constant([[[[0.1828, 0.4304]], [[0.3429, 0.7358]]]])
print (np.array2string(model.predict([in0Min26830,in1Min26830,in0ELU43903,in0Con39167],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST30903.png')

LMin26830 = minimum_layer([[[[[0.0327]], [[0.8654]]]], [[[[0.9315]], [[0.0662]]]]], Min26830), 
LCon52332 = conv2D_transpose_layer(Min26830, 1, 1,[[[[0.3232], [0.8749], [0.2187]]]],[0, 0, 0], 1, 1, false, Con52332), 
LELU43903 = elu_layer([[[0.2841], [0.8382]]], 2.6465219723185047, ELU43903), 
LRes6212 = reshape_layer(ELU43903, [2, 1, 1], Res6212), 
LCro91137 = cropping2D_layer(Res6212, 0, 1, 0, 0, Cro91137), 
LZer2496 = zero_padding2D_layer(Cro91137, 1, 0, 0, 0, Zer2496), 
LCon39167 = concatenate_layer([Zer2496,[[[[0.1828, 0.4304]], [[0.3429, 0.7358]]]]], 3, Con39167), 
LSub65349 = subtract_layer(Con52332,Con39167, Sub65349), 
LRes19525 = reshape_layer(Sub65349, [2, 3], Res19525), 
LLST30903 = lstm_layer(Res19525,[[9, 4, 7, 5, 6, 9, 9, 6], [9, 3, 5, 2, 9, 3, 10, 4], [6, 7, 6, 9, 8, 5, 10, 6]],[[4, 6, 10, 8, 2, 9, 6, 8], [3, 6, 10, 9, 4, 6, 8, 10]],[4, 5, 8, 8, 8, 10, 2, 5], LST30903), 
exec_layers([LMin26830,LCon52332,LELU43903,LRes6212,LCro91137,LZer2496,LCon39167,LSub65349,LRes19525,LLST30903],["Min26830","Con52332","ELU43903","Res6212","Cro91137","Zer2496","Con39167","Sub65349","Res19525","LST30903"],LST30903,"LST30903")

Actual (Unparsed): [[0.0018579, 0.9151254]]

Expected (Unparsed): [[0.0018579340688356463,0.9151253666170963]]

Actual:   [[0.0019, 0.9152]]

Expected: [[0.0019, 0.9152]]