import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST59769 = tf.keras.layers.Input(shape=([1, 1]))
in0Min76322 = tf.keras.layers.Input(shape=([2, 2]))
in1Min76322 = tf.keras.layers.Input(shape=([2, 2]))

LST59769 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST59769', )(in0LST59769)
Res69126 = keras.layers.Reshape((1, 1), name = 'Res69126', )(LST59769)
Res59113 = keras.layers.Reshape((1, 1, 1), name = 'Res59113', )(Res69126)
Zer12795 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer12795', )(Res59113)
Min76322 = keras.layers.Minimum(name = 'Min76322', )([in0Min76322,in1Min76322])
Res71714 = keras.layers.Reshape((2, 2, 1), name = 'Res71714', )(Min76322)
Max72545 = keras.layers.MaxPool2D(pool_size=(1, 2), strides=(1, 1), padding='same', name = 'Max72545', )(Res71714)
Min49711 = keras.layers.Minimum(name = 'Min49711', )([Zer12795,Max72545])
ReL4745 = keras.layers.ReLU(max_value=4.893771149266515, negative_slope=9.926694072626118, threshold=4.6659746688441235, name = 'ReL4745', )(Min49711)
model = tf.keras.models.Model(inputs=[in0LST59769,in0Min76322,in1Min76322], outputs=ReL4745)
w = model.get_layer('LST59769').get_weights() 
w[0] = np.array([[6, 1, 5, 8]])
w[1] = np.array([[2, 3, 5, 4]])
w[2] = np.array([8, 2, 5, 10])
model.get_layer('LST59769').set_weights(w) 
in0LST59769 = tf.constant([[[6]]])
in0Min76322 = tf.constant([[[0.442, 0.0272], [0.9341, 0.3958]]])
in1Min76322 = tf.constant([[[0.8566, 0.8975], [0.0272, 0.4702]]])
print (np.array2string(model.predict([in0LST59769,in0Min76322,in1Min76322],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL4745.png')

LLST59769 = lstm_layer([[[6]]],[[6, 1, 5, 8]],[[2, 3, 5, 4]],[8, 2, 5, 10], LST59769), 
LRes69126 = reshape_layer(LST59769, [1, 1], Res69126), 
LRes59113 = reshape_layer(Res69126, [1, 1, 1], Res59113), 
LZer12795 = zero_padding2D_layer(Res59113, 1, 0, 1, 0, Zer12795), 
LMin76322 = minimum_layer([[[[0.442, 0.0272], [0.9341, 0.3958]]], [[[0.8566, 0.8975], [0.0272, 0.4702]]]], Min76322), 
LRes71714 = reshape_layer(Min76322, [2, 2, 1], Res71714), 
LMax72545 = max_pool2D_layer(Res71714, 1, 2, 1, 1, true, Max72545), 
LMin49711 = minimum_layer([Zer12795,Max72545], Min49711), 
LReL4745 = relu_layer(Min49711, 4.893771149266515, 9.926694072626118, 4.6659746688441235, ReL4745), 
exec_layers([LLST59769,LRes69126,LRes59113,LZer12795,LMin76322,LRes71714,LMax72545,LMin49711,LReL4745],["LST59769","Res69126","Res59113","Zer12795","Min76322","Res71714","Max72545","Min49711","ReL4745"],ReL4745,"ReL4745")

Actual (Unparsed): [[[[-46.3177031], [-46.3177031]], [[-46.3177031], [-42.3887176]]]]

Expected (Unparsed): [[[[-46.317703088238574],[-46.317703088238574]],[[-46.317703088238574],[-42.38871757429315]]]]

Actual:   [[[[-46.3177], [-46.3177]], [[-46.3177], [-42.3887]]]]

Expected: [[[[-46.3177], [-46.3177]], [[-46.3177], [-42.3887]]]]