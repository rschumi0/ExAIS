import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave63138 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave63138 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con79630 = tf.keras.layers.Input(shape=([1, 1]))
in0Add5281 = tf.keras.layers.Input(shape=([1, 1]))
in1Add5281 = tf.keras.layers.Input(shape=([1, 1]))

Ave63138 = keras.layers.Average(name = 'Ave63138', )([in0Ave63138,in1Ave63138])
Res71397 = keras.layers.Reshape((1, 2, 1), name = 'Res71397', )(Ave63138)
Res21253 = keras.layers.Reshape((1, 2), name = 'Res21253', )(Res71397)
Con79630 = keras.layers.Concatenate(axis=2, name = 'Con79630', )([Res21253,in0Con79630])
Add5281 = keras.layers.Add(name = 'Add5281', )([in0Add5281,in1Add5281])
Loc12433 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc12433', )(Add5281)
Max95529 = keras.layers.Maximum(name = 'Max95529', )([Con79630,Loc12433])
model = tf.keras.models.Model(inputs=[in0Ave63138,in1Ave63138,in0Con79630,in0Add5281,in1Add5281], outputs=Max95529)
w = model.get_layer('Loc12433').get_weights() 
w[0] = np.array([[[0.53, 0.9847, 0.1268]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc12433').set_weights(w) 
in0Ave63138 = tf.constant([[[[[0.2112]], [[0.5614]]]]])
in1Ave63138 = tf.constant([[[[[0.1117]], [[0.5355]]]]])
in0Con79630 = tf.constant([[[0.0996]]])
in0Add5281 = tf.constant([[[0.4972]]])
in1Add5281 = tf.constant([[[0.2439]]])
print (np.array2string(model.predict([in0Ave63138,in1Ave63138,in0Con79630,in0Add5281,in1Add5281],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max95529.png')

LAve63138 = average_layer([[[[[[0.2112]], [[0.5614]]]]], [[[[[0.1117]], [[0.5355]]]]]], Ave63138), 
LRes71397 = reshape_layer(Ave63138, [1, 2, 1], Res71397), 
LRes21253 = reshape_layer(Res71397, [1, 2], Res21253), 
LCon79630 = concatenate_layer([Res21253,[[[0.0996]]]], 2, Con79630), 
LAdd5281 = add_layer([[[[0.4972]]], [[[0.2439]]]], Add5281), 
LLoc12433 = locally_connected1D_layer(Add5281, 1,[[[0.53, 0.9847, 0.1268]]],[[0, 0, 0]], 1, Loc12433), 
LMax95529 = maximum_layer([Con79630,Loc12433], Max95529), 
exec_layers([LAve63138,LRes71397,LRes21253,LCon79630,LAdd5281,LLoc12433,LMax95529],["Ave63138","Res71397","Res21253","Con79630","Add5281","Loc12433","Max95529"],Max95529,"Max95529")

Actual (Unparsed): [[[0.3927830, 0.7297612, 0.0996000]]]

Expected (Unparsed): [[[0.392783,0.72976117,0.0996]]]

Actual:   [[[0.3928, 0.7298, 0.0996]]]

Expected: [[[0.3928, 0.7298, 0.0996]]]