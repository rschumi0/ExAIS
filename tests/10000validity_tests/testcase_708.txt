import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat3172 = tf.keras.layers.Input(shape=([3, 2, 1]))
in0Con89378 = tf.keras.layers.Input(shape=([3, 1]))
in0Dot71781 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot71781 = tf.keras.layers.Input(shape=([3, 3]))

Bat3172 = keras.layers.BatchNormalization(axis=3, epsilon=0.10715814345963941,  name = 'Bat3172', )(in0Bat3172)
Res73291 = keras.layers.Reshape((3, 2), name = 'Res73291', )(Bat3172)
Con89378 = keras.layers.Concatenate(axis=2, name = 'Con89378', )([Res73291,in0Con89378])
Dot71781 = keras.layers.Dot(axes=(1, 1), name = 'Dot71781', )([in0Dot71781,in1Dot71781])
Sub93747 = keras.layers.Subtract(name = 'Sub93747', )([Con89378,Dot71781])
Sep66151 = keras.layers.SeparableConv1D(2, (1),strides=(3), padding='same', name = 'Sep66151', )(Sub93747)
model = tf.keras.models.Model(inputs=[in0Bat3172,in0Con89378,in0Dot71781,in1Dot71781], outputs=Sep66151)
w = model.get_layer('Bat3172').get_weights() 
w[0] = np.array([0.8037])
w[1] = np.array([0.0428])
w[2] = np.array([0.1711])
w[3] = np.array([0.2173])
model.get_layer('Bat3172').set_weights(w) 
w = model.get_layer('Sep66151').get_weights() 
w[0] = np.array([[[0.207], [0.0743], [0.2201]]])
w[1] = np.array([[[0.9817, 0.194], [0.2585, 0.1028], [0.5107, 0.1]]])
w[2] = np.array([0, 0])
model.get_layer('Sep66151').set_weights(w) 
in0Bat3172 = tf.constant([[[[1.9489], [1.2163]], [[1.815], [1.5948]], [[1.153], [1.2198]]]])
in0Con89378 = tf.constant([[[0.7024], [0.5178], [0.7807]]])
in0Dot71781 = tf.constant([[[0.5482, 0.2562, 0.843], [0.2769, 0.7627, 0.3309], [0.1964, 0.6792, 0.3751]]])
in1Dot71781 = tf.constant([[[0.7482, 0.905, 0.0501], [0.4517, 0.7553, 0.7327], [0.7932, 0.3219, 0.5486]]])
print (np.array2string(model.predict([in0Bat3172,in0Con89378,in0Dot71781,in1Dot71781],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep66151.png')

LBat3172 = batch_normalization_layer([[[[1.9489], [1.2163]], [[1.815], [1.5948]], [[1.153], [1.2198]]]], 3, 0.10715814345963941, [0.8037], [0.0428], [0.1711], [0.2173], Bat3172), 
LRes73291 = reshape_layer(Bat3172, [3, 2], Res73291), 
LCon89378 = concatenate_layer([Res73291,[[[0.7024], [0.5178], [0.7807]]]], 2, Con89378), 
LDot71781 = dot_layer([[[0.5482, 0.2562, 0.843], [0.2769, 0.7627, 0.3309], [0.1964, 0.6792, 0.3751]]], [[[0.7482, 0.905, 0.0501], [0.4517, 0.7553, 0.7327], [0.7932, 0.3219, 0.5486]]], 1, 1, Dot71781), 
LSub93747 = subtract_layer(Con89378,Dot71781, Sub93747), 
LSep66151 = separable_conv1D_layer(Sub93747, 1,[[[[0.207], [0.0743], [0.2201]]],[[[0.9817, 0.194], [0.2585, 0.1028], [0.5107, 0.1]]]],[0, 0], 3, true, Sep66151), 
exec_layers([LBat3172,LRes73291,LCon89378,LDot71781,LSub93747,LSep66151],["Bat3172","Res73291","Con89378","Dot71781","Sub93747","Sep66151"],Sep66151,"Sep66151")

Actual (Unparsed): [[[0.4333473, 0.0884408]]]

Expected (Unparsed): [[[0.4333473386336693,0.08844078252629392]]]

Actual:   [[[0.4334, 0.0885]]]

Expected: [[[0.4334, 0.0885]]]