import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub30562 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub30562 = tf.keras.layers.Input(shape=([3, 3]))

Sub30562 = keras.layers.Subtract(name = 'Sub30562', )([in0Sub30562,in1Sub30562])
Res38782 = keras.layers.Reshape((3, 3, 1), name = 'Res38782', )(Sub30562)
Sep73543 = keras.layers.SeparableConv2D(2, (3, 2),strides=(2, 2), padding='same', name = 'Sep73543', )(Res38782)
model = tf.keras.models.Model(inputs=[in0Sub30562,in1Sub30562], outputs=Sep73543)
w = model.get_layer('Sep73543').get_weights() 
w[0] = np.array([[[[0.49]], [[0.4714]]], [[[0.8991]], [[0.9991]]], [[[0.4336]], [[0.6065]]]])
w[1] = np.array([[[[0.9914, 0.4705]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep73543').set_weights(w) 
in0Sub30562 = tf.constant([[[0.5818, 0.999, 0.6035], [0.8588, 0.6455, 0.0606], [0.3484, 0.3777, 0.3713]]])
in1Sub30562 = tf.constant([[[0.7475, 0.1851, 0.7327], [0.9728, 0.2037, 0.01], [0.8917, 0.7481, 0.7013]]])
print (np.array2string(model.predict([in0Sub30562,in1Sub30562],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep73543.png')

LSub30562 = subtract_layer([[[0.5818, 0.999, 0.6035], [0.8588, 0.6455, 0.0606], [0.3484, 0.3777, 0.3713]]], [[[0.7475, 0.1851, 0.7327], [0.9728, 0.2037, 0.01], [0.8917, 0.7481, 0.7013]]], Sub30562), 
LRes38782 = reshape_layer(Sub30562, [3, 3, 1], Res38782), 
LSep73543 = separable_conv2D_layer(Res38782, 3, 2,[[[[[0.49]], [[0.4714]]], [[[0.8991]], [[0.9991]]], [[[0.4336]], [[0.6065]]]],[[[[0.9914, 0.4705]]]]],[0, 0], 2, 2, true, Sep73543), 
exec_layers([LSub30562,LRes38782,LSep73543],["Sub30562","Res38782","Sep73543"],Sep73543,"Sep73543")

Actual (Unparsed): [[[[0.8751166, 0.4153141], [-0.0934132, -0.0443322]], [[-0.7000703, -0.3322404], [-0.2695706, -0.1279332]]]]

Expected (Unparsed): [[[[0.8751166318879999,0.41531407636000006],[-0.09341323738399998,-0.04433218497999999]],[[-0.70007031891,-0.332240352075],[-0.2695705826,-0.1279331845]]]]

Actual:   [[[[0.8752, 0.4154], [-0.0934, -0.0443]], [[-0.7, -0.3322], [-0.2695, -0.1279]]]]

Expected: [[[[0.8752, 0.4154], [-0.0934, -0.0443]], [[-0.7, -0.3322], [-0.2695, -0.1279]]]]