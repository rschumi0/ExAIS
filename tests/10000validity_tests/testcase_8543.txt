import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con59935 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Dot8436 = tf.keras.layers.Input(shape=([3]))
in1Dot8436 = tf.keras.layers.Input(shape=([3]))
in0Con90530 = tf.keras.layers.Input(shape=([3]))

Con59935 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con59935', )(in0Con59935)
Res29337 = keras.layers.Reshape((1, 4), name = 'Res29337', )(Con59935)
Fla90526 = keras.layers.Flatten(name = 'Fla90526', )(Res29337)
Dot8436 = keras.layers.Dot(axes=(1, 1), name = 'Dot8436', )([in0Dot8436,in1Dot8436])
Con90530 = keras.layers.Concatenate(axis=1, name = 'Con90530', )([Dot8436,in0Con90530])
Ave27202 = keras.layers.Average(name = 'Ave27202', )([Fla90526,Con90530])
Res7302 = keras.layers.Reshape((4, 1), name = 'Res7302', )(Ave27202)
Res28850 = keras.layers.Reshape((4, 1, 1), name = 'Res28850', )(Res7302)
Res85369 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res85369', )(Res28850)
Cro53465 = keras.layers.Cropping3D(cropping=((1, 1), (0, 0), (0, 0)), name = 'Cro53465', )(Res85369)
Res13512 = keras.layers.Reshape((2, 1, 1), name = 'Res13512', )(Cro53465)
Loc20832 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc20832', )(Res13512)
Zer65660 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer65660', )(Loc20832)
model = tf.keras.models.Model(inputs=[in0Con59935,in0Dot8436,in1Dot8436,in0Con90530], outputs=Zer65660)
w = model.get_layer('Con59935').get_weights() 
w[0] = np.array([[[[0.6207, 0.3458, 0.7545, 0.4298]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con59935').set_weights(w) 
w = model.get_layer('Loc20832').get_weights() 
w[0] = np.array([[[0.9011, 0.3434, 0.339]], [[0.8067, 0.2651, 0.3465]]])
w[1] = np.array([[[0, 0, 0]], [[0, 0, 0]]])
model.get_layer('Loc20832').set_weights(w) 
in0Con59935 = tf.constant([[[[0.5982]]]])
in0Dot8436 = tf.constant([[0.2651, 0.4558, 0.8621]])
in1Dot8436 = tf.constant([[0.7595, 0.9429, 0.5254]])
in0Con90530 = tf.constant([[0.637, 0.6223, 0.4612]])
print (np.array2string(model.predict([in0Con59935,in0Dot8436,in1Dot8436,in0Con90530],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer65660.png')

LCon59935 = conv2D_layer([[[[0.5982]]]], 1, 1,[[[[0.6207, 0.3458, 0.7545, 0.4298]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con59935), 
LRes29337 = reshape_layer(Con59935, [1, 4], Res29337), 
LFla90526 = flatten_layer(Res29337, Fla90526), 
LDot8436 = dot_layer([[0.2651, 0.4558, 0.8621]], [[0.7595, 0.9429, 0.5254]], 1, 1, Dot8436), 
LCon90530 = concatenate_layer([Dot8436,[[0.637, 0.6223, 0.4612]]], 1, Con90530), 
LAve27202 = average_layer([Fla90526,Con90530], Ave27202), 
LRes7302 = reshape_layer(Ave27202, [4, 1], Res7302), 
LRes28850 = reshape_layer(Res7302, [4, 1, 1], Res28850), 
LRes85369 = reshape_layer(Res28850, [4, 1, 1, 1], Res85369), 
LCro53465 = cropping3D_layer(Res85369, 1, 1, 0, 0, 0, 0, Cro53465), 
LRes13512 = reshape_layer(Cro53465, [2, 1, 1], Res13512), 
LLoc20832 = locally_connected2D_layer(Res13512, 1, 1,[[[0.9011, 0.3434, 0.339]], [[0.8067, 0.2651, 0.3465]]],[[[0, 0, 0]], [[0, 0, 0]]], 1, 1, Loc20832), 
LZer65660 = zero_padding2D_layer(Loc20832, 1, 1, 1, 1, Zer65660), 
exec_layers([LCon59935,LRes29337,LFla90526,LDot8436,LCon90530,LAve27202,LRes7302,LRes28850,LRes85369,LCro53465,LRes13512,LLoc20832,LZer65660],["Con59935","Res29337","Fla90526","Dot8436","Con90530","Ave27202","Res7302","Res28850","Res85369","Cro53465","Res13512","Loc20832","Zer65660"],Zer65660,"Zer65660")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.3802000, 0.1448903, 0.1430339], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.4330535, 0.1423112, 0.1860085], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0],[0,0,0],[0,0,0]],[[0,0,0],[0.380200023658,0.144890343052,0.14303385642000002],[0,0,0]],[[0,0,0],[0.433053460365,0.142311233845,0.18600845917499997],[0,0,0]],[[0,0,0],[0,0,0],[0,0,0]]]]

Actual:   [[[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0.3802, 0.1449, 0.1431], [0, 0, 0]], [[0, 0, 0], [0.4331, 0.1424, 0.1861], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]

Expected: [[[[0, 0, 0], [0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0.3803, 0.1449, 0.1431], [0, 0, 0]], [[0, 0, 0], [0.4331, 0.1424, 0.1861], [0, 0, 0]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]