import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add38747 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add38747 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con11418 = tf.keras.layers.Input(shape=([4, 2]))
in0Zer78327 = tf.keras.layers.Input(shape=([2, 3]))

Add38747 = keras.layers.Add(name = 'Add38747', )([in0Add38747,in1Add38747])
Res57544 = keras.layers.Reshape((1, 1), name = 'Res57544', )(Add38747)
Zer72612 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer72612', )(Res57544)
Con11418 = keras.layers.Concatenate(axis=2, name = 'Con11418', )([Zer72612,in0Con11418])
Zer78327 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer78327', )(in0Zer78327)
Con54309 = keras.layers.Conv1D(3, (4),strides=(1), padding='same', dilation_rate=(1), name = 'Con54309', )(Zer78327)
Add99558 = keras.layers.Add(name = 'Add99558', )([Con11418,Con54309])
Res45911 = keras.layers.Reshape((4, 3, 1), name = 'Res45911', )(Add99558)
Sep44579 = keras.layers.SeparableConv2D(3, (2, 2),strides=(3, 3), padding='valid', name = 'Sep44579', )(Res45911)
model = tf.keras.models.Model(inputs=[in0Add38747,in1Add38747,in0Con11418,in0Zer78327], outputs=Sep44579)
w = model.get_layer('Con54309').get_weights() 
w[0] = np.array([[[0.0393, 0.1749, 0.0277], [0.1, 0.1214, 0.5874], [0.4772, 0.323, 0.2349]], [[0.0366, 0.7008, 0.5136], [0.1793, 0.1931, 0.4355], [0.8975, 0.4677, 0.94]], [[0.0147, 0.003, 0.1402], [0.091, 0.159, 0.6807], [0.8613, 0.1466, 0.4483]], [[0.1757, 0.2404, 0.3409], [0.1927, 0.2244, 0.6604], [0.5218, 0.9647, 0.7608]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con54309').set_weights(w) 
w = model.get_layer('Sep44579').get_weights() 
w[0] = np.array([[[[0.747]], [[0.8075]]], [[[0.9392]], [[0.4862]]]])
w[1] = np.array([[[[0.2689, 0.6424, 0.8266]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep44579').set_weights(w) 
in0Add38747 = tf.constant([[[[0.4773]]]])
in1Add38747 = tf.constant([[[[0.4576]]]])
in0Con11418 = tf.constant([[[0.3638, 0.4418], [0.8186, 0.5625], [0.593, 0.3106], [0.1961, 0.7537]]])
in0Zer78327 = tf.constant([[[1.8939, 1.4089, 1.2697], [1.112, 1.1084, 1.1148]]])
print (np.array2string(model.predict([in0Add38747,in1Add38747,in0Con11418,in0Zer78327],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep44579.png')

LAdd38747 = add_layer([[[[[0.4773]]]], [[[[0.4576]]]]], Add38747), 
LRes57544 = reshape_layer(Add38747, [1, 1], Res57544), 
LZer72612 = zero_padding1D_layer(Res57544, 3, 0, Zer72612), 
LCon11418 = concatenate_layer([Zer72612,[[[0.3638, 0.4418], [0.8186, 0.5625], [0.593, 0.3106], [0.1961, 0.7537]]]], 2, Con11418), 
LZer78327 = zero_padding1D_layer([[[1.8939, 1.4089, 1.2697], [1.112, 1.1084, 1.1148]]], 1, 1, Zer78327), 
LCon54309 = conv1D_layer(Zer78327, 4,[[[0.0393, 0.1749, 0.0277], [0.1, 0.1214, 0.5874], [0.4772, 0.323, 0.2349]], [[0.0366, 0.7008, 0.5136], [0.1793, 0.1931, 0.4355], [0.8975, 0.4677, 0.94]], [[0.0147, 0.003, 0.1402], [0.091, 0.159, 0.6807], [0.8613, 0.1466, 0.4483]], [[0.1757, 0.2404, 0.3409], [0.1927, 0.2244, 0.6604], [0.5218, 0.9647, 0.7608]]],[0, 0, 0], 1, true, 1, Con54309), 
LAdd99558 = add_layer([Con11418,Con54309], Add99558), 
LRes45911 = reshape_layer(Add99558, [4, 3, 1], Res45911), 
LSep44579 = separable_conv2D_layer(Res45911, 2, 2,[[[[[0.747]], [[0.8075]]], [[[0.9392]], [[0.4862]]]],[[[[0.2689, 0.6424, 0.8266]]]]],[0, 0, 0], 3, 3, false, Sep44579), 
exec_layers([LAdd38747,LRes57544,LZer72612,LCon11418,LZer78327,LCon54309,LAdd99558,LRes45911,LSep44579],["Add38747","Res57544","Zer72612","Con11418","Zer78327","Con54309","Add99558","Res45911","Sep44579"],Sep44579,"Sep44579")

Actual (Unparsed): [[[[2.0446596, 4.8846758, 6.2852942]]]]

Expected (Unparsed): [[[[2.0446595837055193,4.88467577750995,6.285294205619124]]]]

Actual:   [[[[2.0447, 4.8847, 6.2853]]]]

Expected: [[[[2.0447, 4.8847, 6.2853]]]]