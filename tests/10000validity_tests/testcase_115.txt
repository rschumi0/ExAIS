import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe51745 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con76469 = tf.keras.layers.Input(shape=([2, 1]))
in0Cro25721 = tf.keras.layers.Input(shape=([3, 2]))

PRe51745 = keras.layers.PReLU(name = 'PRe51745', input_shape=(1, 1, 2, 1))(in0PRe51745)
Res50539 = keras.layers.Reshape((1, 1, 2), name = 'Res50539', )(PRe51745)
Glo59974 = keras.layers.GlobalAveragePooling2D(name = 'Glo59974', )(Res50539)
Res27092 = keras.layers.Reshape((2, 1), name = 'Res27092', )(Glo59974)
Ave72271 = keras.layers.AveragePooling1D(pool_size=(2), strides=(1), padding='valid', name = 'Ave72271', )(Res27092)
Zer31865 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer31865', )(Ave72271)
Con76469 = keras.layers.Concatenate(axis=2, name = 'Con76469', )([Zer31865,in0Con76469])
Cro25721 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro25721', )(in0Cro25721)
Max20119 = keras.layers.Maximum(name = 'Max20119', )([Con76469,Cro25721])
model = tf.keras.models.Model(inputs=[in0PRe51745,in0Con76469,in0Cro25721], outputs=Max20119)
w = model.get_layer('PRe51745').get_weights() 
w[0] = np.array([[[[0.7663], [0.7959]]]])
model.get_layer('PRe51745').set_weights(w) 
in0PRe51745 = tf.constant([[[[[0.9193], [0.2923]]]]])
in0Con76469 = tf.constant([[[0.7634], [0.8399]]])
in0Cro25721 = tf.constant([[[1.9969, 1.6559], [1.3638, 1.5211], [1.362, 1.3619]]])
print (np.array2string(model.predict([in0PRe51745,in0Con76469,in0Cro25721],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max20119.png')

LPRe51745 = prelu_layer([[[[[0.9193], [0.2923]]]]], [[[[0.7663], [0.7959]]]], PRe51745), 
LRes50539 = reshape_layer(PRe51745, [1, 1, 2], Res50539), 
LGlo59974 = global_average_pooling2D_layer(Res50539, Glo59974), 
LRes27092 = reshape_layer(Glo59974, [2, 1], Res27092), 
LAve72271 = average_pooling1D_layer(Res27092, 2, 1, false, Ave72271), 
LZer31865 = zero_padding1D_layer(Ave72271, 1, 0, Zer31865), 
LCon76469 = concatenate_layer([Zer31865,[[[0.7634], [0.8399]]]], 2, Con76469), 
LCro25721 = cropping1D_layer([[[1.9969, 1.6559], [1.3638, 1.5211], [1.362, 1.3619]]], 1, 0, Cro25721), 
LMax20119 = maximum_layer([Con76469,Cro25721], Max20119), 
exec_layers([LPRe51745,LRes50539,LGlo59974,LRes27092,LAve72271,LZer31865,LCon76469,LCro25721,LMax20119],["PRe51745","Res50539","Glo59974","Res27092","Ave72271","Zer31865","Con76469","Cro25721","Max20119"],Max20119,"Max20119")

Actual (Unparsed): [[[1.3638000, 1.5211000], [1.3620000, 1.3619000]]]

Expected (Unparsed): [[[1.3638,1.5211],[1.362,1.3619]]]

Actual:   [[[1.3638, 1.5211], [1.362, 1.3619]]]

Expected: [[[1.3638, 1.5211], [1.362, 1.3619]]]