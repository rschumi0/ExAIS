import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot93247 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot93247 = tf.keras.layers.Input(shape=([2, 3]))
in0Add22487 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Add22487 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Sub56079 = tf.keras.layers.Input(shape=([3]))
in1Sub56079 = tf.keras.layers.Input(shape=([3]))
in0Con63706 = tf.keras.layers.Input(shape=([9]))

Dot93247 = keras.layers.Dot(axes=(2, 2), name = 'Dot93247', )([in0Dot93247,in1Dot93247])
Res89905 = keras.layers.Reshape((2, 2, 1), name = 'Res89905', )(Dot93247)
Res21256 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res21256', )(Res89905)
Zer60980 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer60980', )(Res21256)
Add22487 = keras.layers.Add(name = 'Add22487', )([in0Add22487,in1Add22487])
Zer53303 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer53303', )(Add22487)
Mul46886 = keras.layers.Multiply(name = 'Mul46886', )([Zer60980,Zer53303])
Res59746 = keras.layers.Reshape((2, 2, 3), name = 'Res59746', )(Mul46886)
Res16746 = keras.layers.Reshape((2, 6), name = 'Res16746', )(Res59746)
Fla14182 = keras.layers.Flatten(name = 'Fla14182', )(Res16746)
Sub56079 = keras.layers.Subtract(name = 'Sub56079', )([in0Sub56079,in1Sub56079])
Mas66453 = keras.layers.Masking(mask_value=2, name = 'Mas66453', )(Sub56079)
Con63706 = keras.layers.Concatenate(axis=1, name = 'Con63706', )([Mas66453,in0Con63706])
Add93668 = keras.layers.Add(name = 'Add93668', )([Fla14182,Con63706])
model = tf.keras.models.Model(inputs=[in0Dot93247,in1Dot93247,in0Add22487,in1Add22487,in0Sub56079,in1Sub56079,in0Con63706], outputs=Add93668)
in0Dot93247 = tf.constant([[[0.4442, 0.695, 0.0817], [0.8855, 0.4091, 0.7796]]])
in1Dot93247 = tf.constant([[[0.5599, 0.1697, 0.7945], [0.3986, 0.5772, 0.4401]]])
in0Add22487 = tf.constant([[[[[0.6521], [0.5013]]], [[[0.383], [0.8327]]]]])
in1Add22487 = tf.constant([[[[[0.6796], [0.1071]]], [[[0.236], [0.5937]]]]])
in0Sub56079 = tf.constant([[0.863, 0.3513, 0.07]])
in1Sub56079 = tf.constant([[0.7807, 0.0799, 0.3301]])
in0Con63706 = tf.constant([[0.0101, 0.7593, 0.1336, 0.8555, 0.4778, 0.3012, 0.2822, 0.0436, 0.819]])
print (np.array2string(model.predict([in0Dot93247,in1Dot93247,in0Add22487,in1Add22487,in0Sub56079,in1Sub56079,in0Con63706],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add93668.png')

LDot93247 = dot_layer([[[0.4442, 0.695, 0.0817], [0.8855, 0.4091, 0.7796]]], [[[0.5599, 0.1697, 0.7945], [0.3986, 0.5772, 0.4401]]], 2, 2, Dot93247), 
LRes89905 = reshape_layer(Dot93247, [2, 2, 1], Res89905), 
LRes21256 = reshape_layer(Res89905, [2, 2, 1, 1], Res21256), 
LZer60980 = zero_padding3D_layer(Res21256, 0, 0, 0, 0, 2, 0, Zer60980), 
LAdd22487 = add_layer([[[[[[0.6521], [0.5013]]], [[[0.383], [0.8327]]]]], [[[[[0.6796], [0.1071]]], [[[0.236], [0.5937]]]]]], Add22487), 
LZer53303 = zero_padding3D_layer(Add22487, 0, 0, 1, 0, 1, 0, Zer53303), 
LMul46886 = multiply_layer([Zer60980,Zer53303], Mul46886), 
LRes59746 = reshape_layer(Mul46886, [2, 2, 3], Res59746), 
LRes16746 = reshape_layer(Res59746, [2, 6], Res16746), 
LFla14182 = flatten_layer(Res16746, Fla14182), 
LSub56079 = subtract_layer([[0.863, 0.3513, 0.07]], [[0.7807, 0.0799, 0.3301]], Sub56079), 
LMas66453 = masking_layer(Sub56079, 2, Mas66453), 
LCon63706 = concatenate_layer([Mas66453,[[0.0101, 0.7593, 0.1336, 0.8555, 0.4778, 0.3012, 0.2822, 0.0436, 0.819]]], 1, Con63706), 
LAdd93668 = add_layer([Fla14182,Con63706], Add93668), 
exec_layers([LDot93247,LRes89905,LRes21256,LZer60980,LAdd22487,LZer53303,LMul46886,LRes59746,LRes16746,LFla14182,LSub56079,LMas66453,LCon63706,LAdd93668],["Dot93247","Res89905","Res21256","Zer60980","Add22487","Zer53303","Mul46886","Res59746","Res16746","Fla14182","Sub56079","Mas66453","Con63706","Add93668"],Add93668,"Add93668")

Actual (Unparsed): [[0.0822999, 0.2714000, -0.2601000, 0.0101000, 0.7593000, 0.5072600, 0.8555000, 0.4778000, 0.3012000, 0.2822000, 0.0436000, 2.1486827]]

Expected (Unparsed): [[0.08230000000000004,0.2714,-0.2601,0.0101,0.7593,0.507259987636,0.8555,0.4778,0.3012,0.2822,0.0436,2.1486826341920002]]

Actual:   [[0.0823, 0.2714, -0.2601, 0.0101, 0.7593, 0.5073, 0.8555, 0.4778, 0.3012, 0.2822, 0.0436, 2.1487]]

Expected: [[0.0824, 0.2714, -0.2601, 0.0101, 0.7593, 0.5073, 0.8555, 0.4778, 0.3012, 0.2822, 0.0436, 2.1487]]