import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add3271 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Add3271 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Add3271 = keras.layers.Add(name = 'Add3271', )([in0Add3271,in1Add3271])
Res59078 = keras.layers.Reshape((2, 2, 2), name = 'Res59078', )(Add3271)
Res20367 = keras.layers.Reshape((2, 4), name = 'Res20367', )(Res59078)
Up_16909 = keras.layers.UpSampling1D(size=(2), name = 'Up_16909', )(Res20367)
Res83417 = keras.layers.Reshape((4, 4, 1), name = 'Res83417', )(Up_16909)
Res44240 = keras.layers.Reshape((4, 4, 1, 1), name = 'Res44240', )(Res83417)
Con12938 = keras.layers.Conv3DTranspose(2, (4, 2, 1),strides=(1, 3, 1), padding='same', name = 'Con12938', )(Res44240)
model = tf.keras.models.Model(inputs=[in0Add3271,in1Add3271], outputs=Con12938)
w = model.get_layer('Con12938').get_weights() 
w[0] = np.array([[[[[0.0192], [0.7529]]], [[[0.123], [0.3787]]]], [[[[0.6947], [0.6396]]], [[[0.0859], [0.3067]]]], [[[[0.7288], [0.2621]]], [[[0.1312], [0.8894]]]], [[[[0.3166], [0.0704]]], [[[0.6373], [0.9997]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con12938').set_weights(w) 
in0Add3271 = tf.constant([[[[[0.7582, 0.6819]], [[0.6502, 0.7664]]], [[[0.6906, 0.8107]], [[0.6319, 0.681]]]]])
in1Add3271 = tf.constant([[[[[0.5436, 0.7334]], [[0.0134, 0.0876]]], [[[0.7943, 0.7102]], [[0.6822, 0.4344]]]]])
print (np.array2string(model.predict([in0Add3271,in1Add3271],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con12938.png')

LAdd3271 = add_layer([[[[[[0.7582, 0.6819]], [[0.6502, 0.7664]]], [[[0.6906, 0.8107]], [[0.6319, 0.681]]]]], [[[[[0.5436, 0.7334]], [[0.0134, 0.0876]]], [[[0.7943, 0.7102]], [[0.6822, 0.4344]]]]]], Add3271), 
LRes59078 = reshape_layer(Add3271, [2, 2, 2], Res59078), 
LRes20367 = reshape_layer(Res59078, [2, 4], Res20367), 
LUp_16909 = up_sampling1D_layer(Res20367, 2, Up_16909), 
LRes83417 = reshape_layer(Up_16909, [4, 4, 1], Res83417), 
LRes44240 = reshape_layer(Res83417, [4, 4, 1, 1], Res44240), 
LCon12938 = conv3D_transpose_layer(Res44240, 4, 2, 1,[[[[[0.0192], [0.7529]]], [[[0.123], [0.3787]]]], [[[[0.6947], [0.6396]]], [[[0.0859], [0.3067]]]], [[[[0.7288], [0.2621]]], [[[0.1312], [0.8894]]]], [[[[0.3166], [0.0704]]], [[[0.6373], [0.9997]]]]],[0, 0], 1, 3, 1, true, Con12938), 
exec_layers([LAdd3271,LRes59078,LRes20367,LUp_16909,LRes83417,LRes44240,LCon12938],["Add3271","Res59078","Res20367","Up_16909","Res83417","Res44240","Con12938"],Con12938,"Con12938")

Actual (Unparsed): [[[[[0.9293550, 1.8127565]], [[0.2719460, 0.8922537]], [[0.0000000, 0.0000000]], [[1.0103827, 1.9708053]], [[0.2956562, 0.9700466]], [[0.0000000, 0.0000000]], [[0.4737440, 0.9240630]], [[0.1386260, 0.4548314]], [[0.0000000, 0.0000000]], [[0.6096706, 1.1891950]], [[0.1784006, 0.5853316]], [[0.0000000, 0.0000000]]], [[[1.8816224, 2.2918143]], [[0.4652635, 2.1194146]], [[0.0000000, 0.0000000]], [[2.0438808, 2.4212616]], [[0.4943323, 2.2688052]], [[0.0000000, 0.0000000]], [[0.9698653, 1.5877540]], [[0.3057019, 1.2913817]], [[0.0000000, 0.0000000]], [[1.2370847, 1.6098364]], [[0.3225976, 1.4438714]], [[0.0000000, 0.0000000]]], [[[2.4209718, 2.5005718]], [[1.3106289, 3.4769809]], [[0.0000000, 0.0000000]], [[2.5653252, 2.5884405]], [[1.4053741, 3.7160681]], [[0.0000000, 0.0000000]], [[1.6318635, 2.0505313]], [[0.7844921, 2.1542909]], [[0.0000000, 0.0000000]], [[1.6890556, 1.8371495]], [[0.8893060, 2.3777865]], [[0.0000000, 0.0000000]]], [[[2.5259050, 1.4305810]], [[1.1520089, 3.0774984]], [[0.0000000, 0.0000000]], [[2.6130851, 1.4710327]], [[1.2321581, 3.2340239]], [[0.0000000, 0.0000000]], [[2.0807172, 1.2316414]], [[0.7082034, 2.2351960]], [[0.0000000, 0.0000000]], [[1.8581483, 1.0658778]], [[0.7864075, 2.1878737]], [[0.0000000, 0.0000000]]]]]

Expected (Unparsed): [[[[[0.92935502,1.8127564999999999]],[[0.27194602,0.89225372]],[[0,0]],[[1.01038267,1.97080525]],[[0.29565617,0.97004662]],[[0,0]],[[0.47374404,0.924063]],[[0.13862604,0.45483144]],[[0,0]],[[0.6096706,1.189195]],[[0.1784006,0.5853316]],[[0,0]]],[[[1.88162238,2.29181427]],[[0.46526348000000006,2.11941461]],[[0,0]],[[2.04388083,2.42126162]],[[0.4943323300000001,2.26880516]],[[0,0]],[[0.9698653199999999,1.58775401]],[[0.30570186,1.2913816299999998]],[[0,0]],[[1.2370846800000002,1.6098364600000001]],[[0.32259760000000004,1.44387138]],[[0,0]]],[[[2.42097183,2.50057175]],[[1.31062891,3.4769808400000004]],[[0,0]],[[2.56532513,2.5884405000000004]],[[1.40537406,3.7160680899999994]],[[0,0]],[[1.63186343,2.05053125]],[[0.78449209,2.1542909]],[[0,0]],[[1.6890556600000002,1.8371495000000002]],[[0.8893060600000001,2.37778656]],[[0,0]]],[[[2.5259050300000006,1.43058105]],[[1.15200893,3.0774983500000004]],[[0,0]],[[2.61308513,1.4710326500000002]],[[1.23215808,3.2340239]],[[0,0]],[[2.08071711,1.23164141]],[[0.70820339,2.23519593]],[[0,0]],[[1.8581483000000003,1.06587778]],[[0.78640754,2.18787374]],[[0,0]]]]]

Actual:   [[[[[0.9294, 1.8128]], [[0.272, 0.8923]], [[0, 0]], [[1.0104, 1.9709]], [[0.2957, 0.9701]], [[0, 0]], [[0.4738, 0.9241]], [[0.1387, 0.4549]], [[0, 0]], [[0.6097, 1.1892]], [[0.1785, 0.5854]], [[0, 0]]], [[[1.8817, 2.2919]], [[0.4653, 2.1195]], [[0, 0]], [[2.0439, 2.4213]], [[0.4944, 2.2689]], [[0, 0]], [[0.9699, 1.5878]], [[0.3058, 1.2914]], [[0, 0]], [[1.2371, 1.6099]], [[0.3226, 1.4439]], [[0, 0]]], [[[2.421, 2.5006]], [[1.3107, 3.477]], [[0, 0]], [[2.5654, 2.5885]], [[1.4054, 3.7161]], [[0, 0]], [[1.6319, 2.0506]], [[0.7845, 2.1543]], [[0, 0]], [[1.6891, 1.8372]], [[0.8894, 2.3778]], [[0, 0]]], [[[2.526, 1.4306]], [[1.1521, 3.0775]], [[0, 0]], [[2.6131, 1.4711]], [[1.2322, 3.2341]], [[0, 0]], [[2.0808, 1.2317]], [[0.7083, 2.2352]], [[0, 0]], [[1.8582, 1.0659]], [[0.7865, 2.1879]], [[0, 0]]]]]

Expected: [[[[[0.9294, 1.8128]], [[0.272, 0.8923]], [[0, 0]], [[1.0104, 1.9709]], [[0.2957, 0.9701]], [[0, 0]], [[0.4738, 0.9241]], [[0.1387, 0.4549]], [[0, 0]], [[0.6097, 1.1892]], [[0.1785, 0.5854]], [[0, 0]]], [[[1.8817, 2.2919]], [[0.4653, 2.1195]], [[0, 0]], [[2.0439, 2.4213]], [[0.4944, 2.2689]], [[0, 0]], [[0.9699, 1.5878]], [[0.3058, 1.2914]], [[0, 0]], [[1.2371, 1.6099]], [[0.3226, 1.4439]], [[0, 0]]], [[[2.421, 2.5006]], [[1.3107, 3.477]], [[0, 0]], [[2.5654, 2.5885]], [[1.4054, 3.7161]], [[0, 0]], [[1.6319, 2.0506]], [[0.7845, 2.1543]], [[0, 0]], [[1.6891, 1.8372]], [[0.8894, 2.3778]], [[0, 0]]], [[[2.526, 1.4306]], [[1.1521, 3.0775]], [[0, 0]], [[2.6131, 1.4711]], [[1.2322, 3.2341]], [[0, 0]], [[2.0808, 1.2317]], [[0.7083, 2.2352]], [[0, 0]], [[1.8582, 1.0659]], [[0.7865, 2.1879]], [[0, 0]]]]]