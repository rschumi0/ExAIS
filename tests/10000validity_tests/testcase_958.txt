import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub30035 = tf.keras.layers.Input(shape=([2, 2, 2, 3]))
in1Sub30035 = tf.keras.layers.Input(shape=([2, 2, 2, 3]))

Sub30035 = keras.layers.Subtract(name = 'Sub30035', )([in0Sub30035,in1Sub30035])
Res78412 = keras.layers.Reshape((2, 2, 6), name = 'Res78412', )(Sub30035)
Dep64455 = keras.layers.DepthwiseConv2D((2, 2),strides=(2, 2), padding='valid', name = 'Dep64455', )(Res78412)
Res5022 = keras.layers.Reshape((1, 6), name = 'Res5022', )(Dep64455)
Cro63173 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro63173', )(Res5022)
model = tf.keras.models.Model(inputs=[in0Sub30035,in1Sub30035], outputs=Cro63173)
w = model.get_layer('Dep64455').get_weights() 
w[0] = np.array([[[[0.8729], [0.6412], [0.1917], [0.9364], [0.8038], [0.3005]], [[0.8539], [0.9326], [0.5546], [0.5751], [0.1499], [0.3465]]], [[[0.6728], [0.9959], [0.3495], [0.0921], [0.5571], [0.0851]], [[0.6152], [0.2531], [0.4742], [0.4941], [0.7098], [0.1474]]]])
w[1] = np.array([0, 0, 0, 0, 0, 0])
model.get_layer('Dep64455').set_weights(w) 
in0Sub30035 = tf.constant([[[[[0.5657, 0.4834, 0.6728], [0.5692, 0.367, 0.6049]], [[0.5233, 0.0455, 0.7433], [0.6854, 0.274, 0.7827]]], [[[0.5531, 0.8595, 0.3054], [0.6022, 0.153, 0.7598]], [[0.4432, 0.5731, 0.3806], [0.0537, 0.9205, 0.9295]]]]])
in1Sub30035 = tf.constant([[[[[0.3409, 0.6913, 0.9679], [0.3735, 0.4254, 0.2902]], [[0.6996, 0.3049, 0.635], [0.5441, 0.5544, 0.0582]]], [[[0.0683, 0.405, 0.7976], [0.6691, 0.3884, 0.059]], [[0.4931, 0.0402, 0.1889], [0.3927, 0.9155, 0.6317]]]]])
print (np.array2string(model.predict([in0Sub30035,in1Sub30035],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro63173.png')

LSub30035 = subtract_layer([[[[[0.5657, 0.4834, 0.6728], [0.5692, 0.367, 0.6049]], [[0.5233, 0.0455, 0.7433], [0.6854, 0.274, 0.7827]]], [[[0.5531, 0.8595, 0.3054], [0.6022, 0.153, 0.7598]], [[0.4432, 0.5731, 0.3806], [0.0537, 0.9205, 0.9295]]]]], [[[[[0.3409, 0.6913, 0.9679], [0.3735, 0.4254, 0.2902]], [[0.6996, 0.3049, 0.635], [0.5441, 0.5544, 0.0582]]], [[[0.0683, 0.405, 0.7976], [0.6691, 0.3884, 0.059]], [[0.4931, 0.0402, 0.1889], [0.3927, 0.9155, 0.6317]]]]], Sub30035), 
LRes78412 = reshape_layer(Sub30035, [2, 2, 6], Res78412), 
LDep64455 = depthwise_conv2D_layer(Res78412, 2, 2,[[[[0.8729], [0.6412], [0.1917], [0.9364], [0.8038], [0.3005]], [[0.8539], [0.9326], [0.5546], [0.5751], [0.1499], [0.3465]]], [[[0.6728], [0.9959], [0.3495], [0.0921], [0.5571], [0.0851]], [[0.6152], [0.2531], [0.4742], [0.4941], [0.7098], [0.1474]]]],[0, 0, 0, 0, 0, 0], 2, 2, false, Dep64455), 
LRes5022 = reshape_layer(Dep64455, [1, 6], Res5022), 
LCro63173 = cropping1D_layer(Res5022, 0, 0, Cro63173), 
exec_layers([LSub30035,LRes78412,LDep64455,LRes5022,LCro63173],["Sub30035","Res78412","Dep64455","Res5022","Cro63173"],Cro63173,"Cro63173")

Actual (Unparsed): [[[0.3411603, 0.2122916, -0.0776272, 0.0908537, -0.2165662, 0.4491404]]]

Expected (Unparsed): [[[0.3411603099999999,0.21229162000000004,-0.07762725000000004,0.09085372000000003,-0.21656622000000003,0.4491403999999999]]]

Actual:   [[[0.3412, 0.2123, -0.0776, 0.0909, -0.2165, 0.4492]]]

Expected: [[[0.3412, 0.2123, -0.0776, 0.0909, -0.2165, 0.4492]]]