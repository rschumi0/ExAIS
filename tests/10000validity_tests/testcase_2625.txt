import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max31877 = tf.keras.layers.Input(shape=([2, 2]))
in1Max31877 = tf.keras.layers.Input(shape=([2, 2]))
in0Con71377 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Min26908 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Min26908 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Max31877 = keras.layers.Maximum(name = 'Max31877', )([in0Max31877,in1Max31877])
Thr64165 = keras.layers.ThresholdedReLU(theta=7.995053639349126, name = 'Thr64165', )(Max31877)
Res88295 = keras.layers.Reshape((2, 2, 1), name = 'Res88295', )(Thr64165)
Res54243 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res54243', )(Res88295)
Zer19291 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer19291', )(Res54243)
Con71377 = keras.layers.Concatenate(axis=4, name = 'Con71377', )([Zer19291,in0Con71377])
Min26908 = keras.layers.Minimum(name = 'Min26908', )([in0Min26908,in1Min26908])
Min82566 = keras.layers.Minimum(name = 'Min82566', )([Con71377,Min26908])
model = tf.keras.models.Model(inputs=[in0Max31877,in1Max31877,in0Con71377,in0Min26908,in1Min26908], outputs=Min82566)
in0Max31877 = tf.constant([[[0.2823, 0.5775], [0.048, 0.014]]])
in1Max31877 = tf.constant([[[0.4889, 0.3247], [0.2914, 0.419]]])
in0Con71377 = tf.constant([[[[[0.1175], [0.6456]], [[0.5616], [0.7526]]], [[[0.8121], [0.9491]], [[0.9567], [0.7938]]]]])
in0Min26908 = tf.constant([[[[[0.9452, 0.4172], [0.3044, 0.2802]], [[0.7662, 0.8099], [0.0354, 0.4434]]], [[[0.8819, 0.6293], [0.1479, 0.191]], [[0.4059, 0.4065], [0.7395, 0.456]]]]])
in1Min26908 = tf.constant([[[[[0.79, 0.9004], [0.3833, 0.3646]], [[0.1853, 0.1427], [0.115, 0.9583]]], [[[0.9057, 0.156], [0.7234, 0.6567]], [[0.1343, 0.652], [0.7186, 0.2682]]]]])
print (np.array2string(model.predict([in0Max31877,in1Max31877,in0Con71377,in0Min26908,in1Min26908],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min82566.png')

LMax31877 = maximum_layer([[[[0.2823, 0.5775], [0.048, 0.014]]], [[[0.4889, 0.3247], [0.2914, 0.419]]]], Max31877), 
LThr64165 = thresholded_relu_layer(Max31877, 7.995053639349126, Thr64165), 
LRes88295 = reshape_layer(Thr64165, [2, 2, 1], Res88295), 
LRes54243 = reshape_layer(Res88295, [2, 2, 1, 1], Res54243), 
LZer19291 = zero_padding3D_layer(Res54243, 0, 0, 0, 0, 1, 0, Zer19291), 
LCon71377 = concatenate_layer([Zer19291,[[[[[0.1175], [0.6456]], [[0.5616], [0.7526]]], [[[0.8121], [0.9491]], [[0.9567], [0.7938]]]]]], 4, Con71377), 
LMin26908 = minimum_layer([[[[[[0.9452, 0.4172], [0.3044, 0.2802]], [[0.7662, 0.8099], [0.0354, 0.4434]]], [[[0.8819, 0.6293], [0.1479, 0.191]], [[0.4059, 0.4065], [0.7395, 0.456]]]]], [[[[[0.79, 0.9004], [0.3833, 0.3646]], [[0.1853, 0.1427], [0.115, 0.9583]]], [[[0.9057, 0.156], [0.7234, 0.6567]], [[0.1343, 0.652], [0.7186, 0.2682]]]]]], Min26908), 
LMin82566 = minimum_layer([Con71377,Min26908], Min82566), 
exec_layers([LMax31877,LThr64165,LRes88295,LRes54243,LZer19291,LCon71377,LMin26908,LMin82566],["Max31877","Thr64165","Res88295","Res54243","Zer19291","Con71377","Min26908","Min82566"],Min82566,"Min82566")

Actual (Unparsed): [[[[[0.0000000, 0.1175000], [0.0000000, 0.2802000]], [[0.0000000, 0.1427000], [0.0000000, 0.4434000]]], [[[0.0000000, 0.1560000], [0.0000000, 0.1910000]], [[0.0000000, 0.4065000], [0.0000000, 0.2682000]]]]]

Expected (Unparsed): [[[[[0,0.1175],[0,0.2802]],[[0,0.1427],[0,0.4434]]],[[[0,0.156],[0,0.191]],[[0,0.4065],[0,0.2682]]]]]

Actual:   [[[[[0, 0.1175], [0, 0.2802]], [[0, 0.1427], [0, 0.4434]]], [[[0, 0.156], [0, 0.191]], [[0, 0.4065], [0, 0.2682]]]]]

Expected: [[[[[0, 0.1175], [0, 0.2802]], [[0, 0.1427], [0, 0.4434]]], [[[0, 0.156], [0, 0.191]], [[0, 0.4065], [0, 0.2682]]]]]