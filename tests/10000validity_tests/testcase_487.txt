import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe47298 = tf.keras.layers.Input(shape=([1, 2, 2]))

PRe47298 = keras.layers.PReLU(name = 'PRe47298', input_shape=(1, 2, 2))(in0PRe47298)
ELU97230 = keras.layers.ELU(alpha=-9.464181110595138, name = 'ELU97230', )(PRe47298)
Sep5859 = keras.layers.SeparableConv2D(3, (1, 2),strides=(2, 2), padding='same', name = 'Sep5859', )(ELU97230)
Res3844 = keras.layers.Reshape((1, 3), name = 'Res3844', )(Sep5859)
GRU20298 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU20298', )(Res3844)
model = tf.keras.models.Model(inputs=[in0PRe47298], outputs=GRU20298)
w = model.get_layer('PRe47298').get_weights() 
w[0] = np.array([[[0.5925, 0.1049], [0.4814, 0.4008]]])
model.get_layer('PRe47298').set_weights(w) 
w = model.get_layer('Sep5859').get_weights() 
w[0] = np.array([[[[0.9281], [0.2415]], [[0.6815], [0.5638]]]])
w[1] = np.array([[[[0.2619, 0.3083, 0.4321], [0.7135, 0.5582, 0.7189]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep5859').set_weights(w) 
w = model.get_layer('GRU20298').get_weights() 
w[0] = np.array([[1, 10, 3, 6, 10, 4], [2, 3, 7, 9, 7, 5], [10, 8, 7, 6, 9, 4]])
w[1] = np.array([[3, 6, 9, 9, 7, 3], [6, 8, 1, 6, 6, 4]])
w[2] = np.array([9, 10, 2, 5, 9, 7])
model.get_layer('GRU20298').set_weights(w) 
in0PRe47298 = tf.constant([[[[0.065, 0.1799], [0.5528, 0.021]]]])
print (np.array2string(model.predict([in0PRe47298],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU20298.png')

LPRe47298 = prelu_layer([[[[0.065, 0.1799], [0.5528, 0.021]]]], [[[0.5925, 0.1049], [0.4814, 0.4008]]], PRe47298), 
LELU97230 = elu_layer(PRe47298, -9.464181110595138, ELU97230), 
LSep5859 = separable_conv2D_layer(ELU97230, 1, 2,[[[[[0.9281], [0.2415]], [[0.6815], [0.5638]]]],[[[[0.2619, 0.3083, 0.4321], [0.7135, 0.5582, 0.7189]]]]],[0, 0, 0], 2, 2, true, Sep5859), 
LRes3844 = reshape_layer(Sep5859, [1, 3], Res3844), 
LGRU20298 = gru_layer(Res3844,[[1, 10, 3, 6, 10, 4], [2, 3, 7, 9, 7, 5], [10, 8, 7, 6, 9, 4]],[[3, 6, 9, 9, 7, 3], [6, 8, 1, 6, 6, 4]],[9, 10, 2, 5, 9, 7], false, GRU20298), 
exec_layers([LPRe47298,LELU97230,LSep5859,LRes3844,LGRU20298],["PRe47298","ELU97230","Sep5859","Res3844","GRU20298"],GRU20298,"GRU20298")

Actual (Unparsed): [[0.0000077, 0.0000010]]

Expected (Unparsed): [[7.724485159159931e-6,9.51974011773346e-7]]

Actual:   [[0, 0]]

Expected: [[0, 0]]