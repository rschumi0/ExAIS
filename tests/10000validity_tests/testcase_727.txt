import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul8785 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Mul8785 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Mul8785 = keras.layers.Multiply(name = 'Mul8785', )([in0Mul8785,in1Mul8785])
Res317 = keras.layers.Reshape((2, 1, 2), name = 'Res317', )(Mul8785)
Max66723 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max66723', )(Res317)
model = tf.keras.models.Model(inputs=[in0Mul8785,in1Mul8785], outputs=Max66723)
in0Mul8785 = tf.constant([[[[[0.523, 0.8333]]], [[[0.2753, 0.8464]]]]])
in1Mul8785 = tf.constant([[[[[0.8871, 0.5199]]], [[[0.1534, 0.0807]]]]])
print (np.array2string(model.predict([in0Mul8785,in1Mul8785],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max66723.png')

LMul8785 = multiply_layer([[[[[[0.523, 0.8333]]], [[[0.2753, 0.8464]]]]], [[[[[0.8871, 0.5199]]], [[[0.1534, 0.0807]]]]]], Mul8785), 
LRes317 = reshape_layer(Mul8785, [2, 1, 2], Res317), 
LMax66723 = max_pool2D_layer(Res317, 1, 1, Max66723), 
exec_layers([LMul8785,LRes317,LMax66723],["Mul8785","Res317","Max66723"],Max66723,"Max66723")

Actual (Unparsed): [[[[0.4639533, 0.4332327]], [[0.0422310, 0.0683045]]]]

Expected (Unparsed): [[[[0.4639533,0.43323267000000004]],[[0.04223102,0.06830448]]]]

Actual:   [[[[0.464, 0.4333]], [[0.0423, 0.0684]]]]

Expected: [[[[0.464, 0.4333]], [[0.0423, 0.0684]]]]