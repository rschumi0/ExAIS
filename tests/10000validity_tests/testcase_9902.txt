import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max23782 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max23782 = tf.keras.layers.Input(shape=([2, 2, 2]))

Max23782 = keras.layers.Maximum(name = 'Max23782', )([in0Max23782,in1Max23782])
Glo33744 = keras.layers.GlobalAveragePooling2D(name = 'Glo33744', )(Max23782)
ReL69518 = keras.layers.ReLU(max_value=2.752615873906665, negative_slope=1.2226071749603777, threshold=9.867022126107194, name = 'ReL69518', )(Glo33744)
Den21455 = keras.layers.Dense(2,name = 'Den21455', )(ReL69518)
model = tf.keras.models.Model(inputs=[in0Max23782,in1Max23782], outputs=Den21455)
w = model.get_layer('Den21455').get_weights() 
w[0] = np.array([[0.5918, 0.4827], [0.6492, 0.6574]])
w[1] = np.array([0.1348, 0.7741])
model.get_layer('Den21455').set_weights(w) 
in0Max23782 = tf.constant([[[[0.6804, 0.4088], [0.63, 0.7229]], [[0.0452, 0.6778], [0.1567, 0.1616]]]])
in1Max23782 = tf.constant([[[[0.8176, 0.7688], [0.9382, 0.1852]], [[0.1396, 0.3595], [0.1297, 0.3228]]]])
print (np.array2string(model.predict([in0Max23782,in1Max23782],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den21455.png')

LMax23782 = maximum_layer([[[[[0.6804, 0.4088], [0.63, 0.7229]], [[0.0452, 0.6778], [0.1567, 0.1616]]]], [[[[0.8176, 0.7688], [0.9382, 0.1852]], [[0.1396, 0.3595], [0.1297, 0.3228]]]]], Max23782), 
LGlo33744 = global_average_pooling2D_layer(Max23782, Glo33744), 
LReL69518 = relu_layer(Glo33744, 2.752615873906665, 1.2226071749603777, 9.867022126107194, ReL69518), 
LDen21455 = dense_layer(ReL69518, [[0.5918, 0.4827], [0.6492, 0.6574]],[0.1348, 0.7741], Den21455), 
exec_layers([LMax23782,LGlo33744,LReL69518,LDen21455],["Max23782","Glo33744","ReL69518","Den21455"],Den21455,"Den21455")

Actual (Unparsed): [[-13.9702551, -12.1759328]]

Expected (Unparsed): [[-13.970255115756153,-12.175932785120814]]

Actual:   [[-13.9702, -12.1759]]

Expected: [[-13.9702, -12.1759]]