import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub25247 = tf.keras.layers.Input(shape=([3, 2, 3, 3]))
in1Sub25247 = tf.keras.layers.Input(shape=([3, 2, 3, 3]))

Sub25247 = keras.layers.Subtract(name = 'Sub25247', )([in0Sub25247,in1Sub25247])
Con64266 = keras.layers.Conv3D(4, (1, 2, 3),strides=(1, 6, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con64266', )(Sub25247)
model = tf.keras.models.Model(inputs=[in0Sub25247,in1Sub25247], outputs=Con64266)
w = model.get_layer('Con64266').get_weights() 
w[0] = np.array([[[[[0.8387, 0.9698, 0.5174, 0.6424], [0.8285, 0.7166, 0.3066, 0.3113], [0.5921, 0.8217, 0.8324, 0.5869]], [[0.779, 0.7157, 0.2589, 0.6021], [0.4619, 0.5062, 0.5227, 0.581], [0.9293, 0.4506, 0.7456, 0.6652]], [[0.7651, 0.4034, 0.934, 0.7307], [0.4983, 0.6567, 0.7886, 0.5171], [0.6943, 0.7206, 0.1755, 0.2851]]], [[[0.4774, 0.4967, 0.5703, 0.389], [0.1224, 0.9871, 0.5725, 0.6064], [0.536, 0.1497, 0.4146, 0.8007]], [[0.1576, 0.7629, 0.238, 0.5121], [0.0555, 0.1947, 0.7939, 0.3663], [0.7661, 0.7838, 0.1424, 0.773]], [[0.7317, 0.1361, 0.8678, 0.2438], [0.0273, 0.016, 0.3086, 0.8031], [0.4372, 0.6677, 0.3055, 0.3862]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con64266').set_weights(w) 
in0Sub25247 = tf.constant([[[[[0.8162, 0.7679, 0.2934], [0.1848, 0.5211, 0.9592], [0.1396, 0.6896, 0.5038]], [[0.3859, 0.5093, 0.0104], [0.7934, 0.2428, 0.1554], [0.4184, 0.4819, 0.7778]]], [[[0.1271, 0.4288, 0.551], [0.306, 0.5088, 0.0503], [0.3395, 0.0747, 0.0151]], [[0.1802, 0.8819, 0.2851], [0.1926, 0.0924, 0.0468], [0.5944, 0.6284, 0.0731]]], [[[0.2642, 0.851, 0.8765], [0.2551, 0.6392, 0.6479], [0.7802, 0.6203, 0.4213]], [[0.5174, 0.488, 0.9515], [0.1237, 0.2375, 0.7414], [0.2424, 0.0656, 0.7717]]]]])
in1Sub25247 = tf.constant([[[[[0.9457, 0.7021, 0.7525], [0.8205, 0.1269, 0.0276], [0.3001, 0.8294, 0.1247]], [[0.0592, 0.058, 0.5666], [0.2738, 0.2853, 0.6983], [0.0622, 0.3876, 0.9122]]], [[[0.2936, 0.7824, 0.0708], [0.3829, 0.33, 0.4014], [0.2633, 0.2895, 0.1755]], [[0.4309, 0.4435, 0.6027], [0.2547, 0.2667, 0.104], [0.0183, 0.0697, 0.9206]]], [[[0.9549, 0.0084, 0.2506], [0.8218, 0.805, 0.8571], [0.0182, 0.5895, 0.2263]], [[0.5587, 0.7996, 0.6071], [0.9162, 0.9625, 0.2495], [0.5616, 0.1363, 0.9567]]]]])
print (np.array2string(model.predict([in0Sub25247,in1Sub25247],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con64266.png')

LSub25247 = subtract_layer([[[[[0.8162, 0.7679, 0.2934], [0.1848, 0.5211, 0.9592], [0.1396, 0.6896, 0.5038]], [[0.3859, 0.5093, 0.0104], [0.7934, 0.2428, 0.1554], [0.4184, 0.4819, 0.7778]]], [[[0.1271, 0.4288, 0.551], [0.306, 0.5088, 0.0503], [0.3395, 0.0747, 0.0151]], [[0.1802, 0.8819, 0.2851], [0.1926, 0.0924, 0.0468], [0.5944, 0.6284, 0.0731]]], [[[0.2642, 0.851, 0.8765], [0.2551, 0.6392, 0.6479], [0.7802, 0.6203, 0.4213]], [[0.5174, 0.488, 0.9515], [0.1237, 0.2375, 0.7414], [0.2424, 0.0656, 0.7717]]]]], [[[[[0.9457, 0.7021, 0.7525], [0.8205, 0.1269, 0.0276], [0.3001, 0.8294, 0.1247]], [[0.0592, 0.058, 0.5666], [0.2738, 0.2853, 0.6983], [0.0622, 0.3876, 0.9122]]], [[[0.2936, 0.7824, 0.0708], [0.3829, 0.33, 0.4014], [0.2633, 0.2895, 0.1755]], [[0.4309, 0.4435, 0.6027], [0.2547, 0.2667, 0.104], [0.0183, 0.0697, 0.9206]]], [[[0.9549, 0.0084, 0.2506], [0.8218, 0.805, 0.8571], [0.0182, 0.5895, 0.2263]], [[0.5587, 0.7996, 0.6071], [0.9162, 0.9625, 0.2495], [0.5616, 0.1363, 0.9567]]]]], Sub25247), 
LCon64266 = conv3D_layer(Sub25247, 1, 2, 3,[[[[[0.8387, 0.9698, 0.5174, 0.6424], [0.8285, 0.7166, 0.3066, 0.3113], [0.5921, 0.8217, 0.8324, 0.5869]], [[0.779, 0.7157, 0.2589, 0.6021], [0.4619, 0.5062, 0.5227, 0.581], [0.9293, 0.4506, 0.7456, 0.6652]], [[0.7651, 0.4034, 0.934, 0.7307], [0.4983, 0.6567, 0.7886, 0.5171], [0.6943, 0.7206, 0.1755, 0.2851]]], [[[0.4774, 0.4967, 0.5703, 0.389], [0.1224, 0.9871, 0.5725, 0.6064], [0.536, 0.1497, 0.4146, 0.8007]], [[0.1576, 0.7629, 0.238, 0.5121], [0.0555, 0.1947, 0.7939, 0.3663], [0.7661, 0.7838, 0.1424, 0.773]], [[0.7317, 0.1361, 0.8678, 0.2438], [0.0273, 0.016, 0.3086, 0.8031], [0.4372, 0.6677, 0.3055, 0.3862]]]]],[0, 0, 0, 0], 1, 6, 1, false, 1, 1, 1, Con64266), 
exec_layers([LSub25247,LCon64266],["Sub25247","Con64266"],Con64266,"Con64266")

Actual (Unparsed): [[[[[0.0785686, 0.2726391, 0.6373144, -0.0507324]]], [[[-0.8452506, -0.7129177, 0.1190303, -0.1763014]]], [[[0.5327701, -0.4722190, -0.3058097, -0.1889228]]]]]

Expected (Unparsed): [[[[[0.07856861000000015,0.2726391100000001,0.6373144500000001,-0.05073241999999975]]],[[[-0.8452505499999998,-0.7129176399999998,0.11903026000000011,-0.1763013999999998]]],[[[0.5327701400000002,-0.47221892000000076,-0.30580966000000015,-0.18892276000000005]]]]]

Actual:   [[[[[0.0786, 0.2727, 0.6374, -0.0507]]], [[[-0.8452, -0.7129, 0.1191, -0.1763]]], [[[0.5328, -0.4722, -0.3058, -0.1889]]]]]

Expected: [[[[[0.0786, 0.2727, 0.6374, -0.0507]]], [[[-0.8452, -0.7129, 0.1191, -0.1763]]], [[[0.5328, -0.4722, -0.3058, -0.1889]]]]]