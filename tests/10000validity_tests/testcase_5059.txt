import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min85422 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min85422 = tf.keras.layers.Input(shape=([2, 1, 1]))

Min85422 = keras.layers.Minimum(name = 'Min85422', )([in0Min85422,in1Min85422])
Res63754 = keras.layers.Reshape((2, 1), name = 'Res63754', )(Min85422)
GRU3341 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU3341', )(Res63754)
model = tf.keras.models.Model(inputs=[in0Min85422,in1Min85422], outputs=GRU3341)
w = model.get_layer('GRU3341').get_weights() 
w[0] = np.array([[10, 9, 2, 10, 5, 2]])
w[1] = np.array([[10, 8, 5, 4, 1, 3], [6, 5, 6, 5, 9, 10]])
w[2] = np.array([4, 6, 4, 7, 9, 6])
model.get_layer('GRU3341').set_weights(w) 
in0Min85422 = tf.constant([[[[0.851]], [[0.2722]]]])
in1Min85422 = tf.constant([[[[0.1402]], [[0.3429]]]])
print (np.array2string(model.predict([in0Min85422,in1Min85422],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU3341.png')

LMin85422 = minimum_layer([[[[[0.851]], [[0.2722]]]], [[[[0.1402]], [[0.3429]]]]], Min85422), 
LRes63754 = reshape_layer(Min85422, [2, 1], Res63754), 
LGRU3341 = gru_layer(Res63754,[[10, 9, 2, 10, 5, 2]],[[10, 8, 5, 4, 1, 3], [6, 5, 6, 5, 9, 10]],[4, 6, 4, 7, 9, 6], false, GRU3341), 
exec_layers([LMin85422,LRes63754,LGRU3341],["Min85422","Res63754","GRU3341"],GRU3341,"GRU3341")

Actual (Unparsed): [[0.0056273, 0.0009068]]

Expected (Unparsed): [[0.00562733262891453,0.0009068357215369513]]

Actual:   [[0.0057, 0.001]]

Expected: [[0.0057, 0.001]]