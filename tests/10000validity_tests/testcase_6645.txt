import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub23314 = tf.keras.layers.Input(shape=([3]))
in1Sub23314 = tf.keras.layers.Input(shape=([3]))
in0Con46285 = tf.keras.layers.Input(shape=([3, 2]))
in0Per38630 = tf.keras.layers.Input(shape=([3, 3]))
in0Con77727 = tf.keras.layers.Input(shape=([3, 3, 5, 2]))
in0Sub37100 = tf.keras.layers.Input(shape=([2, 2, 3, 3]))
in1Sub37100 = tf.keras.layers.Input(shape=([2, 2, 3, 3]))

Sub23314 = keras.layers.Subtract(name = 'Sub23314', )([in0Sub23314,in1Sub23314])
Res56849 = keras.layers.Reshape((3, 1), name = 'Res56849', )(Sub23314)
Con46285 = keras.layers.Concatenate(axis=2, name = 'Con46285', )([Res56849,in0Con46285])
Per38630 = keras.layers.Permute((1,2), name = 'Per38630',)(in0Per38630)
Ave74331 = keras.layers.Average(name = 'Ave74331', )([Con46285,Per38630])
Res26755 = keras.layers.Reshape((3, 3, 1), name = 'Res26755', )(Ave74331)
Res24880 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res24880', )(Res26755)
Zer23738 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (4, 0)), name = 'Zer23738', )(Res24880)
Con77727 = keras.layers.Concatenate(axis=4, name = 'Con77727', )([Zer23738,in0Con77727])
Sub37100 = keras.layers.Subtract(name = 'Sub37100', )([in0Sub37100,in1Sub37100])
ELU4234 = keras.layers.ELU(alpha=-1.8538103869872646, name = 'ELU4234', )(Sub37100)
Zer25327 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (2, 0)), name = 'Zer25327', )(ELU4234)
Add23282 = keras.layers.Add(name = 'Add23282', )([Con77727,Zer25327])
Den7630 = keras.layers.Dense(4,name = 'Den7630', )(Add23282)
model = tf.keras.models.Model(inputs=[in0Sub23314,in1Sub23314,in0Con46285,in0Per38630,in0Con77727,in0Sub37100,in1Sub37100], outputs=Den7630)
w = model.get_layer('Den7630').get_weights() 
w[0] = np.array([[0.6738, 0.776, 0.8285, 0.753], [0.1782, 0.2778, 0.1545, 0.5318], [0.1188, 0.3633, 0.0733, 0.9308]])
w[1] = np.array([0.5042, 0.6097, 0.8099, 0.041])
model.get_layer('Den7630').set_weights(w) 
in0Sub23314 = tf.constant([[0.5438, 0.9071, 0.1288]])
in1Sub23314 = tf.constant([[0.7686, 0.0165, 0.1994]])
in0Con46285 = tf.constant([[[0.3056, 0.9064], [0.9312, 0.892], [0.3909, 0.4752]]])
in0Per38630 = tf.constant([[[1.5175, 1.3838, 1.4359], [1.4646, 1.1678, 1.8377], [1.6376, 1.5388, 1.7158]]])
in0Con77727 = tf.constant([[[[[0.8872, 0.2651], [0.1357, 0.7976], [0.1596, 0.5854], [0.1638, 0.9929], [0.7005, 0.4299]], [[0.8246, 0.0233], [0.4816, 0.4651], [0.9757, 0.3327], [0.7965, 0.5477], [0.939, 0.2498]], [[0.9897, 0.6927], [0.3297, 0.6874], [0.4694, 0.1309], [0.7065, 0.6691], [0.4289, 0.0876]]], [[[0.6685, 0.5352], [0.169, 0.7358], [0.7547, 0.3908], [0.1639, 0.6285], [0.522, 0.6001]], [[0.0495, 0.799], [0.4741, 0.909], [0.5203, 0.6336], [0.0928, 0.0804], [0.722, 0.5672]], [[0.0844, 0.7651], [0.098, 0.6287], [0.0945, 0.7001], [0.8089, 0.8743], [0.5671, 0.2228]]], [[[0.7792, 0.7839], [0.1304, 0.5241], [0.1484, 0.7696], [0.8733, 0.0216], [0.4025, 0.0468]], [[0.1462, 0.7295], [0.7448, 0.2512], [0.067, 0.526], [0.3279, 0.3522], [0.7409, 0.7737]], [[0.8151, 0.608], [0.3143, 0.8358], [0.3632, 0.5351], [0.3744, 0.6508], [0.5271, 0.1249]]]]])
in0Sub37100 = tf.constant([[[[[0.9773, 0.9306, 0.8376], [0.8503, 0.3058, 0.1246], [0.0364, 0.0432, 0.7334]], [[0.5395, 0.5725, 0.8026], [0.2508, 0.3144, 0.4311], [0.93, 0.1047, 0.1027]]], [[[0.6686, 0.0423, 0.6863], [0.2872, 0.6514, 0.1844], [0.0115, 0.177, 0.0456]], [[0.7029, 0.3668, 0.2601], [0.1777, 0.6764, 0.4209], [0.4754, 0.5057, 0.1067]]]]])
in1Sub37100 = tf.constant([[[[[0.8631, 0.643, 0.5898], [0.7619, 0.418, 0.6425], [0.1318, 0.0336, 0.9092]], [[0.6678, 0.364, 0.4209], [0.8939, 0.9011, 0.3132], [0.2847, 0.2778, 0.2482]]], [[[0.2375, 0.3328, 0.2325], [0.3548, 0.8405, 0.8867], [0.6847, 0.9845, 0.706]], [[0.3604, 0.6232, 0.9827], [0.7601, 0.5365, 0.4799], [0.469, 0.4717, 0.1657]]]]])
print (np.array2string(model.predict([in0Sub23314,in1Sub23314,in0Con46285,in0Per38630,in0Con77727,in0Sub37100,in1Sub37100],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den7630.png')

LSub23314 = subtract_layer([[0.5438, 0.9071, 0.1288]], [[0.7686, 0.0165, 0.1994]], Sub23314), 
LRes56849 = reshape_layer(Sub23314, [3, 1], Res56849), 
LCon46285 = concatenate_layer([Res56849,[[[0.3056, 0.9064], [0.9312, 0.892], [0.3909, 0.4752]]]], 2, Con46285), 
LPer38630 = permute_layer([[[1.5175, 1.3838, 1.4359], [1.4646, 1.1678, 1.8377], [1.6376, 1.5388, 1.7158]]], 1,2, Per38630), 
LAve74331 = average_layer([Con46285,Per38630], Ave74331), 
LRes26755 = reshape_layer(Ave74331, [3, 3, 1], Res26755), 
LRes24880 = reshape_layer(Res26755, [3, 3, 1, 1], Res24880), 
LZer23738 = zero_padding3D_layer(Res24880, 0, 0, 0, 0, 4, 0, Zer23738), 
LCon77727 = concatenate_layer([Zer23738,[[[[[0.8872, 0.2651], [0.1357, 0.7976], [0.1596, 0.5854], [0.1638, 0.9929], [0.7005, 0.4299]], [[0.8246, 0.0233], [0.4816, 0.4651], [0.9757, 0.3327], [0.7965, 0.5477], [0.939, 0.2498]], [[0.9897, 0.6927], [0.3297, 0.6874], [0.4694, 0.1309], [0.7065, 0.6691], [0.4289, 0.0876]]], [[[0.6685, 0.5352], [0.169, 0.7358], [0.7547, 0.3908], [0.1639, 0.6285], [0.522, 0.6001]], [[0.0495, 0.799], [0.4741, 0.909], [0.5203, 0.6336], [0.0928, 0.0804], [0.722, 0.5672]], [[0.0844, 0.7651], [0.098, 0.6287], [0.0945, 0.7001], [0.8089, 0.8743], [0.5671, 0.2228]]], [[[0.7792, 0.7839], [0.1304, 0.5241], [0.1484, 0.7696], [0.8733, 0.0216], [0.4025, 0.0468]], [[0.1462, 0.7295], [0.7448, 0.2512], [0.067, 0.526], [0.3279, 0.3522], [0.7409, 0.7737]], [[0.8151, 0.608], [0.3143, 0.8358], [0.3632, 0.5351], [0.3744, 0.6508], [0.5271, 0.1249]]]]]], 4, Con77727), 
LSub37100 = subtract_layer([[[[[0.9773, 0.9306, 0.8376], [0.8503, 0.3058, 0.1246], [0.0364, 0.0432, 0.7334]], [[0.5395, 0.5725, 0.8026], [0.2508, 0.3144, 0.4311], [0.93, 0.1047, 0.1027]]], [[[0.6686, 0.0423, 0.6863], [0.2872, 0.6514, 0.1844], [0.0115, 0.177, 0.0456]], [[0.7029, 0.3668, 0.2601], [0.1777, 0.6764, 0.4209], [0.4754, 0.5057, 0.1067]]]]], [[[[[0.8631, 0.643, 0.5898], [0.7619, 0.418, 0.6425], [0.1318, 0.0336, 0.9092]], [[0.6678, 0.364, 0.4209], [0.8939, 0.9011, 0.3132], [0.2847, 0.2778, 0.2482]]], [[[0.2375, 0.3328, 0.2325], [0.3548, 0.8405, 0.8867], [0.6847, 0.9845, 0.706]], [[0.3604, 0.6232, 0.9827], [0.7601, 0.5365, 0.4799], [0.469, 0.4717, 0.1657]]]]], Sub37100), 
LELU4234 = elu_layer(Sub37100, -1.8538103869872646, ELU4234), 
LZer25327 = zero_padding3D_layer(ELU4234, 1, 0, 1, 0, 2, 0, Zer25327), 
LAdd23282 = add_layer([Con77727,Zer25327], Add23282), 
LDen7630 = dense_layer(Add23282, [[0.6738, 0.776, 0.8285, 0.753], [0.1782, 0.2778, 0.1545, 0.5318], [0.1188, 0.3633, 0.0733, 0.9308]],[0.5042, 0.6097, 0.8099, 0.041], Den7630), 
exec_layers([LSub23314,LRes56849,LCon46285,LPer38630,LAve74331,LRes26755,LRes24880,LZer23738,LCon77727,LSub37100,LELU4234,LZer25327,LAdd23282,LDen7630],["Sub23314","Res56849","Con46285","Per38630","Ave74331","Res26755","Res24880","Zer23738","Con77727","Sub37100","ELU4234","Zer25327","Add23282","Den7630"],Den7630,"Den7630")

Actual (Unparsed): [[[[[0.6937929, 0.9524750, 0.9664042, 0.7595680], [0.6231366, 0.9371655, 0.8893297, 0.8555713], [0.6021862, 0.8667127, 0.8774680, 0.6707656], [0.6513457, 1.0159242, 0.9079867, 1.0523002], [1.1156119, 1.4620492, 1.4851399, 1.3003784]], [[0.6539118, 0.8472388, 0.9390086, 0.5012099], [0.6452750, 0.9124593, 0.9183990, 0.7300299], [0.7175945, 1.0016194, 0.9850326, 0.8695544], [0.7112031, 1.0299471, 0.9731057, 0.9743779], [1.2703649, 1.6167937, 1.6731198, 1.4089331]], [[0.7628573, 1.1362966, 1.0135836, 1.2120877], [0.6446157, 0.9510231, 0.9112251, 0.8561664], [0.6033980, 0.7876553, 0.8920173, 0.4124686], [0.7095874, 1.0490497, 0.9680993, 1.0395150], [1.3801577, 1.6694859, 1.8528839, 1.2325031]]], [[[0.6869085, 0.9898475, 0.9524134, 0.8946725], [0.6217288, 0.9239644, 0.8899446, 0.8157569], [0.6851146, 0.9613333, 0.9551468, 0.8061061], [0.6080728, 0.8835655, 0.8812916, 0.7131698], [1.4619792, 1.8865455, 1.9101779, 1.7639055]], [[0.6079421, 0.9137278, 0.8761145, 0.8110333], [0.6966738, 1.0716447, 0.9497781, 1.1392236], [0.8298260, 1.2429664, 1.0939419, 1.3770409], [0.7139384, 1.0601900, 0.9886972, 1.0338950], [1.5582685, 2.0728857, 1.9956762, 2.1534834]], [[0.6101340, 0.9111072, 0.8790216, 0.7980390], [0.5963532, 0.8653311, 0.8711247, 0.6783104], [0.8371170, 1.2601088, 1.1209458, 1.3771583], [1.5053380, 2.1058159, 1.8632549, 2.4944155], [2.0684945, 2.5811129, 2.6431820, 2.4539611]]], [[[0.7361808, 1.1109526, 0.9877463, 1.1850327], [0.5897004, 0.8363307, 0.8684633, 0.5981790], [0.6220734, 0.9305212, 0.8892395, 0.8362628], [0.6623881, 0.8601500, 0.9464081, 0.5255262], [1.1094076, 1.3465129, 1.5246464, 0.8885864]], [[0.6169174, 0.9153417, 0.8859602, 0.7977678], [0.6667659, 0.9078664, 0.9433846, 0.6709016], [1.0062993, 1.4486416, 1.3214451, 1.5617915], [0.8541588, 1.3513205, 1.1046800, 1.6749336], [2.2796989, 3.1609706, 2.7572901, 3.9458351]], [[0.7216812, 1.0570212, 0.9803994, 1.0403966], [0.6595013, 1.0006587, 0.9197235, 0.9861074], [1.0512951, 1.6337706, 1.3236900, 2.1008957], [1.2371874, 1.6626366, 1.6228538, 1.6353503], [1.3741042, 1.7046105, 1.8264545, 1.3842416]]]]]

Expected (Unparsed): [[[[[0.6937929199999999,0.95247499,0.96640423,0.7595680400000001],[0.6231366199999999,0.93716554,0.8893297299999999,0.85557134],[0.60218624,0.8667127000000001,0.8774680199999999,0.6707656000000001],[0.65134568,1.01592421,0.90798667,1.05230016],[1.1156118499999998,1.46204917,1.485139895,1.30037837]],[[0.65391176,0.8472387699999999,0.93900859,0.50120992],[0.6452749999999999,0.91245931,0.91839903,0.73002996],[0.7175945,1.00161937,0.9850325600000001,0.86955442],[0.71120306,1.02994711,0.9731056599999999,0.9743778599999999],[1.2703649,1.6167937400000003,1.6731197899999999,1.40893314]],[[0.7628573,1.13629657,1.0135835599999998,1.2120876200000001],[0.6446156599999999,0.9510230799999999,0.91122507,0.85616638],[0.603398,0.78765529,0.89201727,0.41246864],[0.70958738,1.0490497300000001,0.96809928,1.03951498],[1.3801577299999996,1.6694859,1.8528839049999999,1.23250305]]],[[[0.68690846,0.98984746,0.9524134099999999,0.89467246],[0.6217288400000001,0.92396434,0.88994464,0.81575684],[0.68511458,0.9613333000000001,0.95514679,0.8061061],[0.60807278,0.88356547,0.8812916,0.71316982],[1.4619791599999998,1.8865455299999998,1.91017793,1.76390548]],[[0.6079421,0.9137278,0.8761144499999999,0.8110333],[0.69667382,1.07164468,0.94977815,1.13922358],[0.8298260599999999,1.24296644,1.0939418699999999,1.37704094],[0.7139384142290255,1.0601899744184387,0.988697168117615,1.0338950174640749],[1.5582685338899085,2.072885688360067,1.9956762334678282,2.153483405166682]],[[0.61013396,0.9111071500000001,0.87902163,0.7980389999999999],[0.59635316,0.8653311100000001,0.8711247099999999,0.67831036],[0.8371169337147735,1.260108744456314,1.1209458054536803,1.3771582234479436],[1.5053380253758797,2.1058159598577952,1.863254974967638,2.4944155131785024],[2.0684944779157592,2.581112902933152,2.6431820275987934,2.453961144553564]]],[[[0.73618076,1.1109526299999999,0.9877462699999999,1.18503268],[0.58970036,0.8363306500000001,0.86846333,0.598179],[0.62207336,0.9305212,0.88923948,0.8362628],[0.66238814,0.8601500200000001,0.9464081299999999,0.52552622],[1.1094076400000001,1.34651294,1.5246464400000002,0.88858644]],[[0.6169174399999999,0.91534171,0.88596025,0.79776776],[0.6667659199999999,0.9078664000000001,0.9433845599999999,0.6709016],[1.0062992646446811,1.4486415395639307,1.321445083925944,1.5617914519082015],[0.8541588429565836,1.3513205829153208,1.1046800668797179,1.6749336981136906],[2.2796988996959016,3.160970570548098,2.7572901138953108,3.9458351433815944]],[[0.72168122,1.05702118,0.98039935,1.04039658],[0.6595013000000001,1.00065868,0.91972349,0.98610738],[1.0512951493998313,1.6337706243752768,1.323690044621745,2.10089573774701],[1.2371874342520583,1.662636534419697,1.6228537520794348,1.6353502353107923],[1.3741042014291465,1.70461052871388,1.8264545206460978,1.3842416000189361]]]]]

Actual:   [[[[[0.6938, 0.9525, 0.9665, 0.7596], [0.6232, 0.9372, 0.8894, 0.8556], [0.6022, 0.8668, 0.8775, 0.6708], [0.6514, 1.016, 0.908, 1.0524], [1.1157, 1.4621, 1.4852, 1.3004]], [[0.654, 0.8473, 0.9391, 0.5013], [0.6453, 0.9125, 0.9184, 0.7301], [0.7176, 1.0017, 0.9851, 0.8696], [0.7113, 1.03, 0.9732, 0.9744], [1.2704, 1.6168, 1.6732, 1.409]], [[0.7629, 1.1363, 1.0136, 1.2121], [0.6447, 0.9511, 0.9113, 0.8562], [0.6034, 0.7877, 0.8921, 0.4125], [0.7096, 1.0491, 0.9681, 1.0396], [1.3802, 1.6695, 1.8529, 1.2326]]], [[[0.687, 0.9899, 0.9525, 0.8947], [0.6218, 0.924, 0.89, 0.8158], [0.6852, 0.9614, 0.9552, 0.8062], [0.6081, 0.8836, 0.8813, 0.7132], [1.462, 1.8866, 1.9102, 1.764]], [[0.608, 0.9138, 0.8762, 0.8111], [0.6967, 1.0717, 0.9498, 1.1393], [0.8299, 1.243, 1.094, 1.3771], [0.714, 1.0602, 0.9887, 1.0339], [1.5583, 2.0729, 1.9957, 2.1535]], [[0.6102, 0.9112, 0.8791, 0.7981], [0.5964, 0.8654, 0.8712, 0.6784], [0.8372, 1.2602, 1.121, 1.3772], [1.5054, 2.1059, 1.8633, 2.4945], [2.0685, 2.5812, 2.6432, 2.454]]], [[[0.7362, 1.111, 0.9878, 1.1851], [0.5898, 0.8364, 0.8685, 0.5982], [0.6221, 0.9306, 0.8893, 0.8363], [0.6624, 0.8602, 0.9465, 0.5256], [1.1095, 1.3466, 1.5247, 0.8886]], [[0.617, 0.9154, 0.886, 0.7978], [0.6668, 0.9079, 0.9434, 0.671], [1.0063, 1.4487, 1.3215, 1.5618], [0.8542, 1.3514, 1.1047, 1.675], [2.2797, 3.161, 2.7573, 3.9459]], [[0.7217, 1.0571, 0.9804, 1.0404], [0.6596, 1.0007, 0.9198, 0.9862], [1.0513, 1.6338, 1.3237, 2.1009], [1.2372, 1.6627, 1.6229, 1.6354], [1.3742, 1.7047, 1.8265, 1.3843]]]]]

Expected: [[[[[0.6938, 0.9525, 0.9665, 0.7596], [0.6232, 0.9372, 0.8894, 0.8556], [0.6022, 0.8668, 0.8775, 0.6708], [0.6514, 1.016, 0.908, 1.0524], [1.1157, 1.4621, 1.4852, 1.3004]], [[0.654, 0.8473, 0.9391, 0.5013], [0.6453, 0.9125, 0.9184, 0.7301], [0.7176, 1.0017, 0.9851, 0.8696], [0.7113, 1.03, 0.9732, 0.9744], [1.2704, 1.6168, 1.6732, 1.409]], [[0.7629, 1.1363, 1.0136, 1.2121], [0.6447, 0.9511, 0.9113, 0.8562], [0.6034, 0.7877, 0.8921, 0.4125], [0.7096, 1.0491, 0.9681, 1.0396], [1.3802, 1.6695, 1.8529, 1.2326]]], [[[0.687, 0.9899, 0.9525, 0.8947], [0.6218, 0.924, 0.89, 0.8158], [0.6852, 0.9614, 0.9552, 0.8062], [0.6081, 0.8836, 0.8813, 0.7132], [1.462, 1.8866, 1.9102, 1.764]], [[0.608, 0.9138, 0.8762, 0.8111], [0.6967, 1.0717, 0.9498, 1.1393], [0.8299, 1.243, 1.094, 1.3771], [0.714, 1.0602, 0.9887, 1.0339], [1.5583, 2.0729, 1.9957, 2.1535]], [[0.6102, 0.9112, 0.8791, 0.7981], [0.5964, 0.8654, 0.8712, 0.6784], [0.8372, 1.2602, 1.121, 1.3772], [1.5054, 2.1059, 1.8633, 2.4945], [2.0685, 2.5812, 2.6432, 2.454]]], [[[0.7362, 1.111, 0.9878, 1.1851], [0.5898, 0.8364, 0.8685, 0.5982], [0.6221, 0.9306, 0.8893, 0.8363], [0.6624, 0.8602, 0.9465, 0.5256], [1.1095, 1.3466, 1.5247, 0.8886]], [[0.617, 0.9154, 0.886, 0.7978], [0.6668, 0.9079, 0.9434, 0.671], [1.0063, 1.4487, 1.3215, 1.5618], [0.8542, 1.3514, 1.1047, 1.675], [2.2797, 3.161, 2.7573, 3.9459]], [[0.7217, 1.0571, 0.9804, 1.0404], [0.6596, 1.0007, 0.9198, 0.9862], [1.0513, 1.6338, 1.3237, 2.1009], [1.2372, 1.6627, 1.6229, 1.6354], [1.3742, 1.7047, 1.8265, 1.3843]]]]]