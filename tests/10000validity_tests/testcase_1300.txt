import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max34430 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max34430 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Cro65320 = tf.keras.layers.Input(shape=([1, 3, 1]))

Max34430 = keras.layers.Maximum(name = 'Max34430', )([in0Max34430,in1Max34430])
Res70280 = keras.layers.Reshape((2, 1), name = 'Res70280', )(Max34430)
Per59026 = keras.layers.Permute((2,1), name = 'Per59026',)(Res70280)
GRU37314 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU37314', )(Per59026)
Res57395 = keras.layers.Reshape((2, 1), name = 'Res57395', )(GRU37314)
Res38333 = keras.layers.Reshape((2, 1, 1), name = 'Res38333', )(Res57395)
Cro65320 = keras.layers.Cropping2D(cropping=((0, 0), (1, 1)), name = 'Cro65320', )(in0Cro65320)
Zer20171 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer20171', )(Cro65320)
Max15088 = keras.layers.Maximum(name = 'Max15088', )([Res38333,Zer20171])
model = tf.keras.models.Model(inputs=[in0Max34430,in1Max34430,in0Cro65320], outputs=Max15088)
w = model.get_layer('GRU37314').get_weights() 
w[0] = np.array([[5, 3, 10, 5, 7, 5], [5, 5, 3, 9, 6, 7]])
w[1] = np.array([[3, 6, 8, 10, 8, 8], [2, 5, 2, 2, 6, 10]])
w[2] = np.array([[4, 5, 10, 3, 9, 4], [7, 7, 8, 10, 7, 1]])
model.get_layer('GRU37314').set_weights(w) 
in0Max34430 = tf.constant([[[[0.0992]], [[0.4829]]]])
in1Max34430 = tf.constant([[[[0.6129]], [[0.7125]]]])
in0Cro65320 = tf.constant([[[[1.4348], [1.5033], [1.3366]]]])
print (np.array2string(model.predict([in0Max34430,in1Max34430,in0Cro65320],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max15088.png')

LMax34430 = maximum_layer([[[[[0.0992]], [[0.4829]]]], [[[[0.6129]], [[0.7125]]]]], Max34430), 
LRes70280 = reshape_layer(Max34430, [2, 1], Res70280), 
LPer59026 = permute_layer(Res70280, 2,1, Per59026), 
LGRU37314 = gru_layer(Per59026,[[5, 3, 10, 5, 7, 5], [5, 5, 3, 9, 6, 7]],[[3, 6, 8, 10, 8, 8], [2, 5, 2, 2, 6, 10]],[[4, 5, 10, 3, 9, 4], [7, 7, 8, 10, 7, 1]], true, GRU37314), 
LRes57395 = reshape_layer(GRU37314, [2, 1], Res57395), 
LRes38333 = reshape_layer(Res57395, [2, 1, 1], Res38333), 
LCro65320 = cropping2D_layer([[[[1.4348], [1.5033], [1.3366]]]], 0, 0, 1, 1, Cro65320), 
LZer20171 = zero_padding2D_layer(Cro65320, 1, 0, 0, 0, Zer20171), 
LMax15088 = maximum_layer([Res38333,Zer20171], Max15088), 
exec_layers([LMax34430,LRes70280,LPer59026,LGRU37314,LRes57395,LRes38333,LCro65320,LZer20171,LMax15088],["Max34430","Res70280","Per59026","GRU37314","Res57395","Res38333","Cro65320","Zer20171","Max15088"],Max15088,"Max15088")

Actual (Unparsed): [[[[0.0000000]], [[1.5033000]]]]

Expected (Unparsed): [[[[2.2115214548534823e-8]],[[1.5033]]]]

Actual:   [[[[0]], [[1.5033]]]]

Expected: [[[[0]], [[1.5033]]]]