import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot38142 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot38142 = tf.keras.layers.Input(shape=([3, 2]))
in0Con4744 = tf.keras.layers.Input(shape=([1, 3, 1, 1]))
in0Con16043 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Dot38142 = keras.layers.Dot(axes=(1, 1), name = 'Dot38142', )([in0Dot38142,in1Dot38142])
Sep35107 = keras.layers.SeparableConv1D(3, (2),strides=(2), padding='same', name = 'Sep35107', )(Dot38142)
Res38335 = keras.layers.Reshape((1, 3, 1), name = 'Res38335', )(Sep35107)
Res59606 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res59606', )(Res38335)
Con4744 = keras.layers.Concatenate(axis=4, name = 'Con4744', )([Res59606,in0Con4744])
Con16043 = keras.layers.Conv3D(2, (1, 2, 1),strides=(2, 2, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con16043', )(in0Con16043)
Zer47253 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer47253', )(Con16043)
Mul51698 = keras.layers.Multiply(name = 'Mul51698', )([Con4744,Zer47253])
Res81755 = keras.layers.Reshape((1, 3, 2), name = 'Res81755', )(Mul51698)
Con75880 = keras.layers.Conv2D(2, (1, 2),strides=(1, 6), padding='valid', dilation_rate=(1, 1), name = 'Con75880', )(Res81755)
Glo5844 = keras.layers.GlobalAveragePooling2D(name = 'Glo5844', )(Con75880)
model = tf.keras.models.Model(inputs=[in0Dot38142,in1Dot38142,in0Con4744,in0Con16043], outputs=Glo5844)
w = model.get_layer('Sep35107').get_weights() 
w[0] = np.array([[[0.8952], [0.5708]], [[0.8376], [0.825]]])
w[1] = np.array([[[0.4299, 0.5765, 0.3877], [0.2224, 0.4729, 0.7763]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep35107').set_weights(w) 
w = model.get_layer('Con16043').get_weights() 
w[0] = np.array([[[[[0.0086, 0.7183]]], [[[0.0951, 0.145]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con16043').set_weights(w) 
w = model.get_layer('Con75880').get_weights() 
w[0] = np.array([[[[0.1909, 0.2824], [0.3598, 0.8953]], [[0.7626, 0.0885], [0.3663, 0.8903]]]])
w[1] = np.array([0, 0])
model.get_layer('Con75880').set_weights(w) 
in0Dot38142 = tf.constant([[[0.5896, 0.6377], [0.8461, 0.6975], [0.4183, 0.0379]]])
in1Dot38142 = tf.constant([[[0.3501, 0.0125], [0.8213, 0.9014], [0.2839, 0.688]]])
in0Con4744 = tf.constant([[[[[0.5626]], [[0.1811]], [[0.9206]]]]])
in0Con16043 = tf.constant([[[[[0.1615]], [[0.0291]]], [[[0.9699]], [[0.1584]]]]])
print (np.array2string(model.predict([in0Dot38142,in1Dot38142,in0Con4744,in0Con16043],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo5844.png')

LDot38142 = dot_layer([[[0.5896, 0.6377], [0.8461, 0.6975], [0.4183, 0.0379]]], [[[0.3501, 0.0125], [0.8213, 0.9014], [0.2839, 0.688]]], 1, 1, Dot38142), 
LSep35107 = separable_conv1D_layer(Dot38142, 2,[[[[0.8952], [0.5708]], [[0.8376], [0.825]]],[[[0.4299, 0.5765, 0.3877], [0.2224, 0.4729, 0.7763]]]],[0, 0, 0], 2, true, Sep35107), 
LRes38335 = reshape_layer(Sep35107, [1, 3, 1], Res38335), 
LRes59606 = reshape_layer(Res38335, [1, 3, 1, 1], Res59606), 
LCon4744 = concatenate_layer([Res59606,[[[[[0.5626]], [[0.1811]], [[0.9206]]]]]], 4, Con4744), 
LCon16043 = conv3D_layer([[[[[0.1615]], [[0.0291]]], [[[0.9699]], [[0.1584]]]]], 1, 2, 1,[[[[[0.0086, 0.7183]]], [[[0.0951, 0.145]]]]],[0, 0], 2, 2, 1, false, 1, 1, 1, Con16043), 
LZer47253 = zero_padding3D_layer(Con16043, 0, 0, 2, 0, 0, 0, Zer47253), 
LMul51698 = multiply_layer([Con4744,Zer47253], Mul51698), 
LRes81755 = reshape_layer(Mul51698, [1, 3, 2], Res81755), 
LCon75880 = conv2D_layer(Res81755, 1, 2,[[[[0.1909, 0.2824], [0.3598, 0.8953]], [[0.7626, 0.0885], [0.3663, 0.8903]]]],[0, 0], 1, 6, false, 1, 1, Con75880), 
LGlo5844 = global_average_pooling2D_layer(Con75880, Glo5844), 
exec_layers([LDot38142,LSep35107,LRes38335,LRes59606,LCon4744,LCon16043,LZer47253,LMul51698,LRes81755,LCon75880,LGlo5844],["Dot38142","Sep35107","Res38335","Res59606","Con4744","Con16043","Zer47253","Mul51698","Res81755","Con75880","Glo5844"],Glo5844,"Glo5844")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0]]

Actual:   [[0, 0]]

Expected: [[0, 0]]