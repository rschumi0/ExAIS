import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max42311 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max42311 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Dot66594 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot66594 = tf.keras.layers.Input(shape=([3, 2]))
in0Con10538 = tf.keras.layers.Input(shape=([1]))

Max42311 = keras.layers.Maximum(name = 'Max42311', )([in0Max42311,in1Max42311])
Res91147 = keras.layers.Reshape((1, 2), name = 'Res91147', )(Max42311)
Con38954 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con38954', )(Res91147)
Fla30990 = keras.layers.Flatten(name = 'Fla30990', )(Con38954)
Dot66594 = keras.layers.Dot(axes=(2, 2), name = 'Dot66594', )([in0Dot66594,in1Dot66594])
Res98461 = keras.layers.Reshape((3, 3, 1), name = 'Res98461', )(Dot66594)
Res48164 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res48164', )(Res98461)
Glo1731 = keras.layers.GlobalMaxPool3D(name = 'Glo1731', )(Res48164)
Con10538 = keras.layers.Concatenate(axis=1, name = 'Con10538', )([Glo1731,in0Con10538])
Max84858 = keras.layers.Maximum(name = 'Max84858', )([Fla30990,Con10538])
model = tf.keras.models.Model(inputs=[in0Max42311,in1Max42311,in0Dot66594,in1Dot66594,in0Con10538], outputs=Max84858)
w = model.get_layer('Con38954').get_weights() 
w[0] = np.array([[[0.3224, 0.2744], [0.9923, 0.4871]]])
w[1] = np.array([0, 0])
model.get_layer('Con38954').set_weights(w) 
in0Max42311 = tf.constant([[[[0.318, 0.8125]]]])
in1Max42311 = tf.constant([[[[0.4986, 0.3277]]]])
in0Dot66594 = tf.constant([[[0.1396, 0.4833], [0.1261, 0.0527], [0.5526, 0.0678]]])
in1Dot66594 = tf.constant([[[0.8713, 0.8339], [0.8431, 0.2075], [0.2333, 0.4134]]])
in0Con10538 = tf.constant([[0.1571]])
print (np.array2string(model.predict([in0Max42311,in1Max42311,in0Dot66594,in1Dot66594,in0Con10538],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max84858.png')

LMax42311 = maximum_layer([[[[[0.318, 0.8125]]]], [[[[0.4986, 0.3277]]]]], Max42311), 
LRes91147 = reshape_layer(Max42311, [1, 2], Res91147), 
LCon38954 = conv1D_layer(Res91147, 1,[[[0.3224, 0.2744], [0.9923, 0.4871]]],[0, 0], 1, false, 1, Con38954), 
LFla30990 = flatten_layer(Con38954, Fla30990), 
LDot66594 = dot_layer([[[0.1396, 0.4833], [0.1261, 0.0527], [0.5526, 0.0678]]], [[[0.8713, 0.8339], [0.8431, 0.2075], [0.2333, 0.4134]]], 2, 2, Dot66594), 
LRes98461 = reshape_layer(Dot66594, [3, 3, 1], Res98461), 
LRes48164 = reshape_layer(Res98461, [3, 3, 1, 1], Res48164), 
LGlo1731 = global_max_pool3D_layer(Res48164, Glo1731), 
LCon10538 = concatenate_layer([Glo1731,[[0.1571]]], 1, Con10538), 
LMax84858 = maximum_layer([Fla30990,Con10538], Max84858), 
exec_layers([LMax42311,LRes91147,LCon38954,LFla30990,LDot66594,LRes98461,LRes48164,LGlo1731,LCon10538,LMax84858],["Max42311","Res91147","Con38954","Fla30990","Dot66594","Res98461","Res48164","Glo1731","Con10538","Max84858"],Max84858,"Max84858")

Actual (Unparsed): [[0.9669924, 0.5325846]]

Expected (Unparsed): [[0.9669923899999999,0.53258459]]

Actual:   [[0.967, 0.5326]]

Expected: [[0.967, 0.5326]]