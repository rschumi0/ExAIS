import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul17514 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul17514 = tf.keras.layers.Input(shape=([2, 1]))
in0Con51110 = tf.keras.layers.Input(shape=([2, 1]))
in0PRe66005 = tf.keras.layers.Input(shape=([1, 2]))

Mul17514 = keras.layers.Multiply(name = 'Mul17514', )([in0Mul17514,in1Mul17514])
Con51110 = keras.layers.Concatenate(axis=2, name = 'Con51110', )([Mul17514,in0Con51110])
PRe66005 = keras.layers.PReLU(name = 'PRe66005', input_shape=(1, 2))(in0PRe66005)
Sof81574 = keras.layers.Softmax(axis=1, name = 'Sof81574', )(PRe66005)
Zer14445 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer14445', )(Sof81574)
Add32262 = keras.layers.Add(name = 'Add32262', )([Con51110,Zer14445])
model = tf.keras.models.Model(inputs=[in0Mul17514,in1Mul17514,in0Con51110,in0PRe66005], outputs=Add32262)
w = model.get_layer('PRe66005').get_weights() 
w[0] = np.array([[0.0854, 0.3861]])
model.get_layer('PRe66005').set_weights(w) 
in0Mul17514 = tf.constant([[[0.3883], [0.645]]])
in1Mul17514 = tf.constant([[[0.5828], [0.6267]]])
in0Con51110 = tf.constant([[[0.6335], [0.6792]]])
in0PRe66005 = tf.constant([[[0.3558, 0.8049]]])
print (np.array2string(model.predict([in0Mul17514,in1Mul17514,in0Con51110,in0PRe66005],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add32262.png')

LMul17514 = multiply_layer([[[[0.3883], [0.645]]], [[[0.5828], [0.6267]]]], Mul17514), 
LCon51110 = concatenate_layer([Mul17514,[[[0.6335], [0.6792]]]], 2, Con51110), 
LPRe66005 = prelu_layer([[[0.3558, 0.8049]]], [[0.0854, 0.3861]], PRe66005), 
LSof81574 = softmax_layer(PRe66005, 1, Sof81574), 
LZer14445 = zero_padding1D_layer(Sof81574, 1, 0, Zer14445), 
LAdd32262 = add_layer([Con51110,Zer14445], Add32262), 
exec_layers([LMul17514,LCon51110,LPRe66005,LSof81574,LZer14445,LAdd32262],["Mul17514","Con51110","PRe66005","Sof81574","Zer14445","Add32262"],Add32262,"Add32262")

Actual (Unparsed): [[[0.2263012, 0.6335000], [1.4042215, 1.6792000]]]

Expected (Unparsed): [[[0.22630124,0.6335],[1.4042215,1.6792]]]

Actual:   [[[0.2264, 0.6335], [1.4043, 1.6792]]]

Expected: [[[0.2264, 0.6335], [1.4043, 1.6792]]]