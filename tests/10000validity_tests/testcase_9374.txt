import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add95390 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add95390 = tf.keras.layers.Input(shape=([2, 1, 1]))

Add95390 = keras.layers.Add(name = 'Add95390', )([in0Add95390,in1Add95390])
Res91731 = keras.layers.Reshape((2, 1), name = 'Res91731', )(Add95390)
Glo81503 = keras.layers.GlobalMaxPool1D(name = 'Glo81503', )(Res91731)
Thr43156 = keras.layers.ThresholdedReLU(theta=9.23859376601018, name = 'Thr43156', )(Glo81503)
ReL129 = keras.layers.ReLU(max_value=5.591542784815796, negative_slope=8.595491301265993, threshold=2.391456955815563, name = 'ReL129', )(Thr43156)
model = tf.keras.models.Model(inputs=[in0Add95390,in1Add95390], outputs=ReL129)
in0Add95390 = tf.constant([[[[0.6149]], [[0.7042]]]])
in1Add95390 = tf.constant([[[[0.2339]], [[0.2794]]]])
print (np.array2string(model.predict([in0Add95390,in1Add95390],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL129.png')

LAdd95390 = add_layer([[[[[0.6149]], [[0.7042]]]], [[[[0.2339]], [[0.2794]]]]], Add95390), 
LRes91731 = reshape_layer(Add95390, [2, 1], Res91731), 
LGlo81503 = global_max_pool1D_layer(Res91731, Glo81503), 
LThr43156 = thresholded_relu_layer(Glo81503, 9.23859376601018, Thr43156), 
LReL129 = relu_layer(Thr43156, 5.591542784815796, 8.595491301265993, 2.391456955815563, ReL129), 
exec_layers([LAdd95390,LRes91731,LGlo81503,LThr43156,LReL129],["Add95390","Res91731","Glo81503","Thr43156","ReL129"],ReL129,"ReL129")

Actual (Unparsed): [[-20.5557475]]

Expected (Unparsed): [[-20.555747461064723]]

Actual:   [[-20.5557]]

Expected: [[-20.5557]]