import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub92414 = tf.keras.layers.Input(shape=([2, 3, 2]))
in1Sub92414 = tf.keras.layers.Input(shape=([2, 3, 2]))
in0Cro37729 = tf.keras.layers.Input(shape=([4, 4, 1, 4]))

Sub92414 = keras.layers.Subtract(name = 'Sub92414', )([in0Sub92414,in1Sub92414])
Zer62995 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer62995', )(Sub92414)
Cro37729 = keras.layers.Cropping3D(cropping=((1, 0), (3, 0), (0, 0)), name = 'Cro37729', )(in0Cro37729)
Res27059 = keras.layers.Reshape((3, 1, 4), name = 'Res27059', )(Cro37729)
Loc93302 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 1), name = 'Loc93302', )(Res27059)
ReL51398 = keras.layers.ReLU(max_value=8.173327126153135, negative_slope=4.563346958122987, threshold=4.663221380010131, name = 'ReL51398', )(Loc93302)
Zer65022 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer65022', )(ReL51398)
Sub83759 = keras.layers.Subtract(name = 'Sub83759', )([Zer62995,Zer65022])
model = tf.keras.models.Model(inputs=[in0Sub92414,in1Sub92414,in0Cro37729], outputs=Sub83759)
w = model.get_layer('Loc93302').get_weights() 
w[0] = np.array([[[0.4388, 0.8146], [0.9166, 0.2803], [0.6427, 0.8119], [0.5795, 0.9229]], [[0.2595, 0.2203], [0.8678, 0.37], [0.9615, 0.377], [0.3865, 0.1849]], [[0.0255, 0.0751], [0.7189, 0.2831], [0.1247, 0.8742], [0.5878, 0.6317]]])
w[1] = np.array([[[0, 0]], [[0, 0]], [[0, 0]]])
model.get_layer('Loc93302').set_weights(w) 
in0Sub92414 = tf.constant([[[[0.7772, 0.3324], [0.917, 0.6241], [0.3018, 0.4879]], [[0.957, 0.4941], [0.3495, 0.6564], [0.4926, 0.4053]]]])
in1Sub92414 = tf.constant([[[[0.294, 0.9023], [0.4256, 0.4919], [0.345, 0.3214]], [[0.5322, 0.6638], [0.904, 0.0497], [0.9965, 0.2681]]]])
in0Cro37729 = tf.constant([[[[[1.3009, 1.708, 1.8759, 1.4796]], [[1.5169, 1.6376, 1.6491, 1.5011]], [[1.2268, 1.1727, 1.1182, 1.5546]], [[1.2511, 1.3673, 1.5845, 1.3398]]], [[[1.3003, 1.0512, 1.3983, 1.1]], [[1.7131, 1.8214, 1.6961, 1.6915]], [[1.7444, 1.5948, 1.3798, 1.0804]], [[1.842, 1.6453, 1.169, 1.5087]]], [[[1.2652, 1.6254, 1.8617, 1.1615]], [[1.3472, 1.9357, 1.7758, 1.5476]], [[1.6777, 1.9456, 1.7129, 1.9598]], [[1.493, 1.992, 1.6843, 1.321]]], [[[1.6006, 1.7864, 1.07, 1.4424]], [[1.2351, 1.8455, 1.844, 1.2188]], [[1.3475, 1.8305, 1.9915, 1.573]], [[1.9611, 1.2223, 1.2682, 1.0172]]]]])
print (np.array2string(model.predict([in0Sub92414,in1Sub92414,in0Cro37729],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub83759.png')

LSub92414 = subtract_layer([[[[0.7772, 0.3324], [0.917, 0.6241], [0.3018, 0.4879]], [[0.957, 0.4941], [0.3495, 0.6564], [0.4926, 0.4053]]]], [[[[0.294, 0.9023], [0.4256, 0.4919], [0.345, 0.3214]], [[0.5322, 0.6638], [0.904, 0.0497], [0.9965, 0.2681]]]], Sub92414), 
LZer62995 = zero_padding2D_layer(Sub92414, 1, 0, 2, 0, Zer62995), 
LCro37729 = cropping3D_layer([[[[[1.3009, 1.708, 1.8759, 1.4796]], [[1.5169, 1.6376, 1.6491, 1.5011]], [[1.2268, 1.1727, 1.1182, 1.5546]], [[1.2511, 1.3673, 1.5845, 1.3398]]], [[[1.3003, 1.0512, 1.3983, 1.1]], [[1.7131, 1.8214, 1.6961, 1.6915]], [[1.7444, 1.5948, 1.3798, 1.0804]], [[1.842, 1.6453, 1.169, 1.5087]]], [[[1.2652, 1.6254, 1.8617, 1.1615]], [[1.3472, 1.9357, 1.7758, 1.5476]], [[1.6777, 1.9456, 1.7129, 1.9598]], [[1.493, 1.992, 1.6843, 1.321]]], [[[1.6006, 1.7864, 1.07, 1.4424]], [[1.2351, 1.8455, 1.844, 1.2188]], [[1.3475, 1.8305, 1.9915, 1.573]], [[1.9611, 1.2223, 1.2682, 1.0172]]]]], 1, 0, 3, 0, 0, 0, Cro37729), 
LRes27059 = reshape_layer(Cro37729, [3, 1, 4], Res27059), 
LLoc93302 = locally_connected2D_layer(Res27059, 1, 1,[[[0.4388, 0.8146], [0.9166, 0.2803], [0.6427, 0.8119], [0.5795, 0.9229]], [[0.2595, 0.2203], [0.8678, 0.37], [0.9615, 0.377], [0.3865, 0.1849]], [[0.0255, 0.0751], [0.7189, 0.2831], [0.1247, 0.8742], [0.5878, 0.6317]]],[[[0, 0]], [[0, 0]], [[0, 0]]], 1, 1, Loc93302), 
LReL51398 = relu_layer(Loc93302, 8.173327126153135, 4.563346958122987, 4.663221380010131, ReL51398), 
LZer65022 = zero_padding2D_layer(ReL51398, 0, 0, 4, 0, Zer65022), 
LSub83759 = subtract_layer(Zer62995,Zer65022, Sub83759), 
exec_layers([LSub92414,LZer62995,LCro37729,LRes27059,LLoc93302,LReL51398,LZer65022,LSub83759],["Sub92414","Zer62995","Cro37729","Res27059","Loc93302","ReL51398","Zer65022","Sub83759"],Sub83759,"Sub83759")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [3.2913678, 1.6430797]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.4832000, -0.5699000], [0.4914000, 0.1322000], [1.8602149, 12.5698573]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.4248000, -0.1697000], [-0.5545000, 0.6067000], [13.0877876, 11.1744939]]]]

Expected (Unparsed): [[[[0,0],[0,0],[0,0],[0,0],[3.2913680692538883,1.6430798922582]],[[0,0],[0,0],[0.4832,-0.5699000000000001],[0.49140000000000006,0.13219999999999998],[1.8602145923064473,12.569857193162417]],[[0,0],[0,0],[0.42479999999999996,-0.16969999999999996],[-0.5545,0.6067],[13.087787787562283,11.174494091573091]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0], [0, 0], [3.2914, 1.6431]], [[0, 0], [0, 0], [0.4832, -0.5699], [0.4914, 0.1322], [1.8603, 12.5699]], [[0, 0], [0, 0], [0.4248, -0.1697], [-0.5545, 0.6067], [13.0878, 11.1745]]]]

Expected: [[[[0, 0], [0, 0], [0, 0], [0, 0], [3.2914, 1.6431]], [[0, 0], [0, 0], [0.4832, -0.5699], [0.4915, 0.1322], [1.8603, 12.5699]], [[0, 0], [0, 0], [0.4248, -0.1696], [-0.5545, 0.6067], [13.0878, 11.1745]]]]