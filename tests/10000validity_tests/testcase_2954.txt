import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave46963 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave46963 = tf.keras.layers.Input(shape=([1, 2]))
in0Ave97739 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Ave97739 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Ave46963 = keras.layers.Average(name = 'Ave46963', )([in0Ave46963,in1Ave46963])
Res60303 = keras.layers.Reshape((1, 2, 1), name = 'Res60303', )(Ave46963)
Res18169 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res18169', )(Res60303)
Zer43966 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer43966', )(Res18169)
Ave97739 = keras.layers.Average(name = 'Ave97739', )([in0Ave97739,in1Ave97739])
Max67532 = keras.layers.Maximum(name = 'Max67532', )([Zer43966,Ave97739])
model = tf.keras.models.Model(inputs=[in0Ave46963,in1Ave46963,in0Ave97739,in1Ave97739], outputs=Max67532)
in0Ave46963 = tf.constant([[[0.7183, 0.0294]]])
in1Ave46963 = tf.constant([[[0.777, 0.024]]])
in0Ave97739 = tf.constant([[[[[0.0175], [0.1691]], [[0.4538], [0.2374]]], [[[0.5569], [0.7381]], [[0.0469], [0.1458]]]]])
in1Ave97739 = tf.constant([[[[[0.7116], [0.617]], [[0.1152], [0.4877]]], [[[0.928], [0.6256]], [[0.8459], [0.4601]]]]])
print (np.array2string(model.predict([in0Ave46963,in1Ave46963,in0Ave97739,in1Ave97739],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max67532.png')

LAve46963 = average_layer([[[[0.7183, 0.0294]]], [[[0.777, 0.024]]]], Ave46963), 
LRes60303 = reshape_layer(Ave46963, [1, 2, 1], Res60303), 
LRes18169 = reshape_layer(Res60303, [1, 2, 1, 1], Res18169), 
LZer43966 = zero_padding3D_layer(Res18169, 1, 0, 0, 0, 1, 0, Zer43966), 
LAve97739 = average_layer([[[[[[0.0175], [0.1691]], [[0.4538], [0.2374]]], [[[0.5569], [0.7381]], [[0.0469], [0.1458]]]]], [[[[[0.7116], [0.617]], [[0.1152], [0.4877]]], [[[0.928], [0.6256]], [[0.8459], [0.4601]]]]]], Ave97739), 
LMax67532 = maximum_layer([Zer43966,Ave97739], Max67532), 
exec_layers([LAve46963,LRes60303,LRes18169,LZer43966,LAve97739,LMax67532],["Ave46963","Res60303","Res18169","Zer43966","Ave97739","Max67532"],Max67532,"Max67532")

Actual (Unparsed): [[[[[0.3645500], [0.3930500]], [[0.2845000], [0.3625500]]], [[[0.7424500], [0.7476500]], [[0.4464000], [0.3029500]]]]]

Expected (Unparsed): [[[[[0.36455],[0.39305]],[[0.2845],[0.36255000000000004]]],[[[0.74245],[0.74765]],[[0.4464],[0.30295]]]]]

Actual:   [[[[[0.3646], [0.3931]], [[0.2845], [0.3626]]], [[[0.7425], [0.7477]], [[0.4464], [0.303]]]]]

Expected: [[[[[0.3646], [0.3931]], [[0.2845], [0.3626]]], [[[0.7425], [0.7477]], [[0.4464], [0.303]]]]]