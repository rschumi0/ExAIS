import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max30323 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Max30323 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con55699 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Max85502 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max85502 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Ave10568 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave10568 = tf.keras.layers.Input(shape=([2, 2]))
in0Con21058 = tf.keras.layers.Input(shape=([8]))

Max30323 = keras.layers.Maximum(name = 'Max30323', )([in0Max30323,in1Max30323])
Res98188 = keras.layers.Reshape((1, 2, 1), name = 'Res98188', )(Max30323)
Zer5336 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer5336', )(Res98188)
Con55699 = keras.layers.Concatenate(axis=3, name = 'Con55699', )([Zer5336,in0Con55699])
Max85502 = keras.layers.Maximum(name = 'Max85502', )([in0Max85502,in1Max85502])
Zer20582 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer20582', )(Max85502)
Sub97738 = keras.layers.Subtract(name = 'Sub97738', )([Con55699,Zer20582])
Res57525 = keras.layers.Reshape((2, 6), name = 'Res57525', )(Sub97738)
Fla57716 = keras.layers.Flatten(name = 'Fla57716', )(Res57525)
Ave10568 = keras.layers.Average(name = 'Ave10568', )([in0Ave10568,in1Ave10568])
Res73061 = keras.layers.Reshape((2, 2, 1), name = 'Res73061', )(Ave10568)
Sep95191 = keras.layers.SeparableConv2D(4, (2, 2),strides=(2, 2), padding='same', name = 'Sep95191', )(Res73061)
Glo44325 = keras.layers.GlobalAveragePooling2D(name = 'Glo44325', )(Sep95191)
Con21058 = keras.layers.Concatenate(axis=1, name = 'Con21058', )([Glo44325,in0Con21058])
Ave58841 = keras.layers.Average(name = 'Ave58841', )([Fla57716,Con21058])
model = tf.keras.models.Model(inputs=[in0Max30323,in1Max30323,in0Con55699,in0Max85502,in1Max85502,in0Ave10568,in1Ave10568,in0Con21058], outputs=Ave58841)
w = model.get_layer('Sep95191').get_weights() 
w[0] = np.array([[[[0.4885]], [[0.8996]]], [[[0.7047]], [[0.1462]]]])
w[1] = np.array([[[[0.8555, 0.6171, 0.8448, 0.6382]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep95191').set_weights(w) 
in0Max30323 = tf.constant([[[[[0.9842]], [[0.3772]]]]])
in1Max30323 = tf.constant([[[[[0.5059]], [[0.3058]]]]])
in0Con55699 = tf.constant([[[[0.0871], [0.9062], [0.1406]], [[0.7717], [0.2586], [0.1412]]]])
in0Max85502 = tf.constant([[[[0.6532, 0.1868]], [[0.6821, 0.8951]]]])
in1Max85502 = tf.constant([[[[0.0671, 0.6667]], [[0.6852, 0.2525]]]])
in0Ave10568 = tf.constant([[[0.8661, 0.9997], [0.202, 0.1575]]])
in1Ave10568 = tf.constant([[[0.291, 0.2763], [0.9064, 0.6766]]])
in0Con21058 = tf.constant([[0.7442, 0.4383, 0.5914, 0.6002, 0.9832, 0.4763, 0.5514, 0.1727]])
print (np.array2string(model.predict([in0Max30323,in1Max30323,in0Con55699,in0Max85502,in1Max85502,in0Ave10568,in1Ave10568,in0Con21058],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave58841.png')

LMax30323 = maximum_layer([[[[[[0.9842]], [[0.3772]]]]], [[[[[0.5059]], [[0.3058]]]]]], Max30323), 
LRes98188 = reshape_layer(Max30323, [1, 2, 1], Res98188), 
LZer5336 = zero_padding2D_layer(Res98188, 1, 0, 1, 0, Zer5336), 
LCon55699 = concatenate_layer([Zer5336,[[[[0.0871], [0.9062], [0.1406]], [[0.7717], [0.2586], [0.1412]]]]], 3, Con55699), 
LMax85502 = maximum_layer([[[[[0.6532, 0.1868]], [[0.6821, 0.8951]]]], [[[[0.0671, 0.6667]], [[0.6852, 0.2525]]]]], Max85502), 
LZer20582 = zero_padding2D_layer(Max85502, 0, 0, 2, 0, Zer20582), 
LSub97738 = subtract_layer(Con55699,Zer20582, Sub97738), 
LRes57525 = reshape_layer(Sub97738, [2, 6], Res57525), 
LFla57716 = flatten_layer(Res57525, Fla57716), 
LAve10568 = average_layer([[[[0.8661, 0.9997], [0.202, 0.1575]]], [[[0.291, 0.2763], [0.9064, 0.6766]]]], Ave10568), 
LRes73061 = reshape_layer(Ave10568, [2, 2, 1], Res73061), 
LSep95191 = separable_conv2D_layer(Res73061, 2, 2,[[[[[0.4885]], [[0.8996]]], [[[0.7047]], [[0.1462]]]],[[[[0.8555, 0.6171, 0.8448, 0.6382]]]]],[0, 0, 0, 0], 2, 2, true, Sep95191), 
LGlo44325 = global_average_pooling2D_layer(Sep95191, Glo44325), 
LCon21058 = concatenate_layer([Glo44325,[[0.7442, 0.4383, 0.5914, 0.6002, 0.9832, 0.4763, 0.5514, 0.1727]]], 1, Con21058), 
LAve58841 = average_layer([Fla57716,Con21058], Ave58841), 
exec_layers([LMax30323,LRes98188,LZer5336,LCon55699,LMax85502,LZer20582,LSub97738,LRes57525,LFla57716,LAve10568,LRes73061,LSep95191,LGlo44325,LCon21058,LAve58841],["Max30323","Res98188","Zer5336","Con55699","Max85502","Zer20582","Sub97738","Res57525","Fla57716","Ave10568","Res73061","Sep95191","Glo44325","Con21058","Ave58841"],Ave58841,"Ave58841")

Actual (Unparsed): [[0.5595329, 0.4471593, 0.5525347, 0.8705096, 0.0455000, -0.0439000, 0.2957000, 0.6859500, 0.9837000, 0.3674500, 0.1217000, -0.2906000]]

Expected (Unparsed): [[0.5595328989187501,0.44715929505874996,0.55253464992,0.8705095804675,0.045499999999999985,-0.043899999999999995,0.2957,0.6859500000000001,0.9837,0.36745,0.12169999999999997,-0.2906]]

Actual:   [[0.5596, 0.4472, 0.5526, 0.8706, 0.0455, -0.0439, 0.2957, 0.686, 0.9837, 0.3675, 0.1217, -0.2906]]

Expected: [[0.5596, 0.4472, 0.5526, 0.8706, 0.0455, -0.0438, 0.2957, 0.686, 0.9837, 0.3675, 0.1217, -0.2906]]