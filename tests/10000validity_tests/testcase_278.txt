import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min24355 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min24355 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Zer95378 = tf.keras.layers.Input(shape=([1, 3, 1, 1]))

Min24355 = keras.layers.Minimum(name = 'Min24355', )([in0Min24355,in1Min24355])
Res56091 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res56091', )(Min24355)
Zer15922 = keras.layers.ZeroPadding3D(padding=((2, 0), (4, 0), (2, 0)), name = 'Zer15922', )(Res56091)
Zer95378 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer95378', )(in0Zer95378)
Max78906 = keras.layers.Maximum(name = 'Max78906', )([Zer15922,Zer95378])
Res31693 = keras.layers.Reshape((3, 5, 3), name = 'Res31693', )(Max78906)
Res19992 = keras.layers.Reshape((3, 15), name = 'Res19992', )(Res31693)
Max72454 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max72454', )(Res19992)
Loc60824 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc60824', )(Max72454)
model = tf.keras.models.Model(inputs=[in0Min24355,in1Min24355,in0Zer95378], outputs=Loc60824)
w = model.get_layer('Loc60824').get_weights() 
w[0] = np.array([[[0.4845, 0.4484, 0.8323, 0.2239], [0.1303, 0.806, 0.8779, 0.8939], [0.0272, 0.9353, 0.2298, 0.4477], [0.218, 0.0105, 0.5486, 0.8068], [0.3808, 0.6503, 0.0284, 0.1743], [0.0156, 0.8703, 0.2388, 0.8115], [0.4092, 0.5501, 0.221, 0.9879], [0.0081, 0.1334, 0.0426, 0.0064], [0.9783, 0.4703, 0.2978, 0.1619], [0.4132, 0.6762, 0.369, 0.7255], [0.8595, 0.6393, 0.611, 0.5633], [0.5787, 0.3329, 0.0085, 0.7977], [0.2312, 0.4101, 0.269, 0.9955], [0.4801, 0.6474, 0.7616, 0.7313], [0.3451, 0.6821, 0.1882, 0.0131]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc60824').set_weights(w) 
in0Min24355 = tf.constant([[[[0.1341]]]])
in1Min24355 = tf.constant([[[[0.5538]]]])
in0Zer95378 = tf.constant([[[[[1.2078]], [[1.1059]], [[1.2903]]]]])
print (np.array2string(model.predict([in0Min24355,in1Min24355,in0Zer95378],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc60824.png')

LMin24355 = minimum_layer([[[[[0.1341]]]], [[[[0.5538]]]]], Min24355), 
LRes56091 = reshape_layer(Min24355, [1, 1, 1, 1], Res56091), 
LZer15922 = zero_padding3D_layer(Res56091, 2, 0, 4, 0, 2, 0, Zer15922), 
LZer95378 = zero_padding3D_layer([[[[[1.2078]], [[1.1059]], [[1.2903]]]]], 1, 1, 1, 1, 1, 1, Zer95378), 
LMax78906 = maximum_layer([Zer15922,Zer95378], Max78906), 
LRes31693 = reshape_layer(Max78906, [3, 5, 3], Res31693), 
LRes19992 = reshape_layer(Res31693, [3, 15], Res19992), 
LMax72454 = max_pool1D_layer(Res19992, 2, Max72454), 
LLoc60824 = locally_connected1D_layer(Max72454, 1,[[[0.4845, 0.4484, 0.8323, 0.2239], [0.1303, 0.806, 0.8779, 0.8939], [0.0272, 0.9353, 0.2298, 0.4477], [0.218, 0.0105, 0.5486, 0.8068], [0.3808, 0.6503, 0.0284, 0.1743], [0.0156, 0.8703, 0.2388, 0.8115], [0.4092, 0.5501, 0.221, 0.9879], [0.0081, 0.1334, 0.0426, 0.0064], [0.9783, 0.4703, 0.2978, 0.1619], [0.4132, 0.6762, 0.369, 0.7255], [0.8595, 0.6393, 0.611, 0.5633], [0.5787, 0.3329, 0.0085, 0.7977], [0.2312, 0.4101, 0.269, 0.9955], [0.4801, 0.6474, 0.7616, 0.7313], [0.3451, 0.6821, 0.1882, 0.0131]]],[[0, 0, 0, 0]], 1, Loc60824), 
exec_layers([LMin24355,LRes56091,LZer15922,LZer95378,LMax78906,LRes31693,LRes19992,LMax72454,LLoc60824],["Min24355","Res56091","Zer15922","Zer95378","Max78906","Res31693","Res19992","Max72454","Loc60824"],Loc60824,"Loc60824")

Actual (Unparsed): [[[1.5779009, 1.7578482, 0.8697862, 0.9444233]]]

Expected (Unparsed): [[[1.57790088,1.7578481899999998,0.86978616,0.94442329]]]

Actual:   [[[1.578, 1.7579, 0.8698, 0.9445]]]

Expected: [[[1.578, 1.7579, 0.8698, 0.9445]]]