import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max3153 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Add42537 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Add42537 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con62633 = tf.keras.layers.Input(shape=([7]))
in0Con61905 = tf.keras.layers.Input(shape=([8, 1, 1]))
in0Max24153 = tf.keras.layers.Input(shape=([1, 1, 2]))

Max3153 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max3153', )(in0Max3153)
Res12532 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res12532', )(Max3153)
Con21002 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con21002', )(Res12532)
Res61707 = keras.layers.Reshape((1, 2, 4), name = 'Res61707', )(Con21002)
Res65388 = keras.layers.Reshape((1, 8), name = 'Res65388', )(Res61707)
Fla19759 = keras.layers.Flatten(name = 'Fla19759', )(Res65388)
Add42537 = keras.layers.Add(name = 'Add42537', )([in0Add42537,in1Add42537])
Res12214 = keras.layers.Reshape((1, 1, 2), name = 'Res12214', )(Add42537)
Res21101 = keras.layers.Reshape((1, 2), name = 'Res21101', )(Res12214)
Res10936 = keras.layers.Reshape((1, 2, 1), name = 'Res10936', )(Res21101)
Glo80615 = keras.layers.GlobalAveragePooling2D(name = 'Glo80615', )(Res10936)
Con62633 = keras.layers.Concatenate(axis=1, name = 'Con62633', )([Glo80615,in0Con62633])
Max56004 = keras.layers.Maximum(name = 'Max56004', )([Fla19759,Con62633])
Res85 = keras.layers.Reshape((8, 1), name = 'Res85', )(Max56004)
Res56301 = keras.layers.Reshape((8, 1, 1), name = 'Res56301', )(Res85)
Con61905 = keras.layers.Concatenate(axis=3, name = 'Con61905', )([Res56301,in0Con61905])
Max24153 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max24153', )(in0Max24153)
Zer75551 = keras.layers.ZeroPadding2D(padding=((7, 0), (0, 0)), name = 'Zer75551', )(Max24153)
Max5583 = keras.layers.Maximum(name = 'Max5583', )([Con61905,Zer75551])
model = tf.keras.models.Model(inputs=[in0Max3153,in0Add42537,in1Add42537,in0Con62633,in0Con61905,in0Max24153], outputs=Max5583)
w = model.get_layer('Con21002').get_weights() 
w[0] = np.array([[[[[0.3317, 0.6231, 0.5879, 0.4]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con21002').set_weights(w) 
in0Max3153 = tf.constant([[[[1.5223], [1.0718]]]])
in0Add42537 = tf.constant([[[[[0.8962, 0.7289]]]]])
in1Add42537 = tf.constant([[[[[0.929, 0.8954]]]]])
in0Con62633 = tf.constant([[0.5243, 0.6688, 0.093, 0.2356, 0.0635, 0.9025, 0.786]])
in0Con61905 = tf.constant([[[[0.3923]], [[0.2607]], [[0.1085]], [[0.7828]], [[0.0273]], [[0.2236]], [[0.1219]], [[0.1968]]]])
in0Max24153 = tf.constant([[[[1.1095, 1.5187]]]])
print (np.array2string(model.predict([in0Max3153,in0Add42537,in1Add42537,in0Con62633,in0Con61905,in0Max24153],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max5583.png')

LMax3153 = max_pool2D_layer([[[[1.5223], [1.0718]]]], 1, 1, Max3153), 
LRes12532 = reshape_layer(Max3153, [1, 2, 1, 1], Res12532), 
LCon21002 = conv3D_layer(Res12532, 1, 1, 1,[[[[[0.3317, 0.6231, 0.5879, 0.4]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con21002), 
LRes61707 = reshape_layer(Con21002, [1, 2, 4], Res61707), 
LRes65388 = reshape_layer(Res61707, [1, 8], Res65388), 
LFla19759 = flatten_layer(Res65388, Fla19759), 
LAdd42537 = add_layer([[[[[[0.8962, 0.7289]]]]], [[[[[0.929, 0.8954]]]]]], Add42537), 
LRes12214 = reshape_layer(Add42537, [1, 1, 2], Res12214), 
LRes21101 = reshape_layer(Res12214, [1, 2], Res21101), 
LRes10936 = reshape_layer(Res21101, [1, 2, 1], Res10936), 
LGlo80615 = global_average_pooling2D_layer(Res10936, Glo80615), 
LCon62633 = concatenate_layer([Glo80615,[[0.5243, 0.6688, 0.093, 0.2356, 0.0635, 0.9025, 0.786]]], 1, Con62633), 
LMax56004 = maximum_layer([Fla19759,Con62633], Max56004), 
LRes85 = reshape_layer(Max56004, [8, 1], Res85), 
LRes56301 = reshape_layer(Res85, [8, 1, 1], Res56301), 
LCon61905 = concatenate_layer([Res56301,[[[[0.3923]], [[0.2607]], [[0.1085]], [[0.7828]], [[0.0273]], [[0.2236]], [[0.1219]], [[0.1968]]]]], 3, Con61905), 
LMax24153 = max_pool2D_layer([[[[1.1095, 1.5187]]]], 1, 1, Max24153), 
LZer75551 = zero_padding2D_layer(Max24153, 7, 0, 0, 0, Zer75551), 
LMax5583 = maximum_layer([Con61905,Zer75551], Max5583), 
exec_layers([LMax3153,LRes12532,LCon21002,LRes61707,LRes65388,LFla19759,LAdd42537,LRes12214,LRes21101,LRes10936,LGlo80615,LCon62633,LMax56004,LRes85,LRes56301,LCon61905,LMax24153,LZer75551,LMax5583],["Max3153","Res12532","Con21002","Res61707","Res65388","Fla19759","Add42537","Res12214","Res21101","Res10936","Glo80615","Con62633","Max56004","Res85","Res56301","Con61905","Max24153","Zer75551","Max5583"],Max5583,"Max5583")

Actual (Unparsed): [[[[1.7247500, 0.3923000]], [[0.9485451, 0.2607000]], [[0.8949602, 0.1085000]], [[0.6089200, 0.7828000]], [[0.3555161, 0.0273000]], [[0.6678386, 0.2236000]], [[0.9025000, 0.1219000]], [[1.1095001, 1.5187000]]]]

Expected (Unparsed): [[[[1.72475,0.3923]],[[0.94854513,0.2607]],[[0.8949601699999999,0.1085]],[[0.60892,0.7828]],[[0.35551606,0.0273]],[[0.6678385800000001,0.2236]],[[0.9025,0.1219]],[[1.1095,1.5187]]]]

Actual:   [[[[1.7248, 0.3923]], [[0.9486, 0.2607]], [[0.895, 0.1085]], [[0.609, 0.7828]], [[0.3556, 0.0273]], [[0.6679, 0.2236]], [[0.9025, 0.1219]], [[1.1096, 1.5187]]]]

Expected: [[[[1.7248, 0.3923]], [[0.9486, 0.2607]], [[0.895, 0.1085]], [[0.609, 0.7828]], [[0.3556, 0.0273]], [[0.6679, 0.2236]], [[0.9025, 0.1219]], [[1.1095, 1.5187]]]]