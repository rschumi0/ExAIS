import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo47964 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Con8116 = tf.keras.layers.Input(shape=([2, 3]))
in0Dot40035 = tf.keras.layers.Input(shape=([2]))
in1Dot40035 = tf.keras.layers.Input(shape=([2]))
in0Con27497 = tf.keras.layers.Input(shape=([2, 3]))
in0Per2691 = tf.keras.layers.Input(shape=([4, 2]))

Glo47964 = keras.layers.GlobalAveragePooling3D(name = 'Glo47964', )(in0Glo47964)
Res59031 = keras.layers.Reshape((1, 1), name = 'Res59031', )(Glo47964)
Res17469 = keras.layers.Reshape((1, 1, 1), name = 'Res17469', )(Res59031)
Res94323 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res94323', )(Res17469)
Up_50075 = keras.layers.UpSampling3D(size=(2, 1, 1), name = 'Up_50075', )(Res94323)
Res5788 = keras.layers.Reshape((2, 1, 1), name = 'Res5788', )(Up_50075)
Res86661 = keras.layers.Reshape((2, 1), name = 'Res86661', )(Res5788)
Con8116 = keras.layers.Concatenate(axis=2, name = 'Con8116', )([Res86661,in0Con8116])
Dot40035 = keras.layers.Dot(axes=(1, 1), name = 'Dot40035', )([in0Dot40035,in1Dot40035])
Res19950 = keras.layers.Reshape((1, 1), name = 'Res19950', )(Dot40035)
Zer75953 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer75953', )(Res19950)
Con27497 = keras.layers.Concatenate(axis=2, name = 'Con27497', )([Zer75953,in0Con27497])
Per2691 = keras.layers.Permute((2,1), name = 'Per2691',)(in0Per2691)
Min5410 = keras.layers.Minimum(name = 'Min5410', )([Con27497,Per2691])
Sub41517 = keras.layers.Subtract(name = 'Sub41517', )([Con8116,Min5410])
model = tf.keras.models.Model(inputs=[in0Glo47964,in0Con8116,in0Dot40035,in1Dot40035,in0Con27497,in0Per2691], outputs=Sub41517)
in0Glo47964 = tf.constant([[[[[1.1333]]], [[[1.7152]]]]])
in0Con8116 = tf.constant([[[0.2623, 0.8149, 0.2442], [0.7564, 0.5989, 0.4365]]])
in0Dot40035 = tf.constant([[0.4578, 0.0886]])
in1Dot40035 = tf.constant([[0.5438, 0.8981]])
in0Con27497 = tf.constant([[[0.9856, 0.2051, 0.832], [0.6493, 0.8392, 0.7077]]])
in0Per2691 = tf.constant([[[1.6462, 1.8167], [1.6799, 1.5539], [1.1533, 1.8037], [1.673, 1.638]]])
print (np.array2string(model.predict([in0Glo47964,in0Con8116,in0Dot40035,in1Dot40035,in0Con27497,in0Per2691],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub41517.png')

LGlo47964 = global_average_pooling3D_layer([[[[[1.1333]]], [[[1.7152]]]]], Glo47964), 
LRes59031 = reshape_layer(Glo47964, [1, 1], Res59031), 
LRes17469 = reshape_layer(Res59031, [1, 1, 1], Res17469), 
LRes94323 = reshape_layer(Res17469, [1, 1, 1, 1], Res94323), 
LUp_50075 = up_sampling3D_layer(Res94323, 2, 1, 1, Up_50075), 
LRes5788 = reshape_layer(Up_50075, [2, 1, 1], Res5788), 
LRes86661 = reshape_layer(Res5788, [2, 1], Res86661), 
LCon8116 = concatenate_layer([Res86661,[[[0.2623, 0.8149, 0.2442], [0.7564, 0.5989, 0.4365]]]], 2, Con8116), 
LDot40035 = dot_layer([[0.4578, 0.0886]], [[0.5438, 0.8981]], 1, 1, Dot40035), 
LRes19950 = reshape_layer(Dot40035, [1, 1], Res19950), 
LZer75953 = zero_padding1D_layer(Res19950, 1, 0, Zer75953), 
LCon27497 = concatenate_layer([Zer75953,[[[0.9856, 0.2051, 0.832], [0.6493, 0.8392, 0.7077]]]], 2, Con27497), 
LPer2691 = permute_layer([[[1.6462, 1.8167], [1.6799, 1.5539], [1.1533, 1.8037], [1.673, 1.638]]], 2,1, Per2691), 
LMin5410 = minimum_layer([Con27497,Per2691], Min5410), 
LSub41517 = subtract_layer(Con8116,Min5410, Sub41517), 
exec_layers([LGlo47964,LRes59031,LRes17469,LRes94323,LUp_50075,LRes5788,LRes86661,LCon8116,LDot40035,LRes19950,LZer75953,LCon27497,LPer2691,LMin5410,LSub41517],["Glo47964","Res59031","Res17469","Res94323","Up_50075","Res5788","Res86661","Con8116","Dot40035","Res19950","Zer75953","Con27497","Per2691","Min5410","Sub41517"],Sub41517,"Sub41517")

Actual (Unparsed): [[[1.4242499, -0.7233000, 0.6098000, -0.5878000], [1.0957266, 0.1071000, -0.2403000, -0.2712000]]]

Expected (Unparsed): [[[1.42425,-0.7233,0.6097999999999999,-0.5878],[1.0957267000000002,0.10709999999999997,-0.24029999999999996,-0.2712]]]

Actual:   [[[1.4243, -0.7233, 0.6098, -0.5878], [1.0958, 0.1071, -0.2403, -0.2712]]]

Expected: [[[1.4243, -0.7233, 0.6098, -0.5878], [1.0958, 0.1071, -0.2402, -0.2712]]]