import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo80464 = tf.keras.layers.Input(shape=([1, 1]))
in0Con62497 = tf.keras.layers.Input(shape=([1, 3, 3]))
in0Con91846 = tf.keras.layers.Input(shape=([1, 2, 2]))

Glo80464 = keras.layers.GlobalAveragePooling1D(name = 'Glo80464', )(in0Glo80464)
Res74844 = keras.layers.Reshape((1, 1), name = 'Res74844', )(Glo80464)
Res96515 = keras.layers.Reshape((1, 1, 1), name = 'Res96515', )(Res74844)
Zer33667 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer33667', )(Res96515)
Con62497 = keras.layers.Concatenate(axis=3, name = 'Con62497', )([Zer33667,in0Con62497])
Con91846 = keras.layers.Conv2DTranspose(4, (1, 2),strides=(1, 1), padding='valid', name = 'Con91846', )(in0Con91846)
Add49661 = keras.layers.Add(name = 'Add49661', )([Con62497,Con91846])
Res9303 = keras.layers.Reshape((1, 12), name = 'Res9303', )(Add49661)
Sim29457 = keras.layers.SimpleRNN(2,name = 'Sim29457', )(Res9303)
model = tf.keras.models.Model(inputs=[in0Glo80464,in0Con62497,in0Con91846], outputs=Sim29457)
w = model.get_layer('Con91846').get_weights() 
w[0] = np.array([[[[0.3476, 0.3087], [0.6244, 0.3101], [0.0729, 0.4862], [0.0171, 0.9537]], [[0.2754, 0.1696], [0.8295, 0.165], [0.9185, 0.5683], [0.0406, 0.97]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con91846').set_weights(w) 
w = model.get_layer('Sim29457').get_weights() 
w[0] = np.array([[9, 10], [6, 2], [6, 7], [9, 4], [8, 4], [10, 6], [5, 3], [10, 6], [5, 2], [7, 3], [5, 8], [5, 4]])
w[1] = np.array([[8, 7], [8, 10]])
w[2] = np.array([5, 1])
model.get_layer('Sim29457').set_weights(w) 
in0Glo80464 = tf.constant([[[1.978]]])
in0Con62497 = tf.constant([[[[0.1186, 0.0068, 0.8074], [0.8542, 0.2165, 0.8585], [0.9423, 0.753, 0.7317]]]])
in0Con91846 = tf.constant([[[[0.5447, 0.1767], [0.7564, 0.5418]]]])
print (np.array2string(model.predict([in0Glo80464,in0Con62497,in0Con91846],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim29457.png')

LGlo80464 = global_average_pooling1D_layer([[[1.978]]], Glo80464), 
LRes74844 = reshape_layer(Glo80464, [1, 1], Res74844), 
LRes96515 = reshape_layer(Res74844, [1, 1, 1], Res96515), 
LZer33667 = zero_padding2D_layer(Res96515, 0, 0, 2, 0, Zer33667), 
LCon62497 = concatenate_layer([Zer33667,[[[[0.1186, 0.0068, 0.8074], [0.8542, 0.2165, 0.8585], [0.9423, 0.753, 0.7317]]]]], 3, Con62497), 
LCon91846 = conv2D_transpose_layer([[[[0.5447, 0.1767], [0.7564, 0.5418]]]], 1, 2,[[[[0.3476, 0.3087], [0.6244, 0.3101], [0.0729, 0.4862], [0.0171, 0.9537]], [[0.2754, 0.1696], [0.8295, 0.165], [0.9185, 0.5683], [0.0406, 0.97]]]],[0, 0, 0, 0], 1, 1, false, Con91846), 
LAdd49661 = add_layer([Con62497,Con91846], Add49661), 
LRes9303 = reshape_layer(Add49661, [1, 12], Res9303), 
LSim29457 = simple_rnn_layer(Res9303,[[9, 10], [6, 2], [6, 7], [9, 4], [8, 4], [10, 6], [5, 3], [10, 6], [5, 2], [7, 3], [5, 8], [5, 4]],[[8, 7], [8, 10]],[5, 1], Sim29457), 
exec_layers([LGlo80464,LRes74844,LRes96515,LZer33667,LCon62497,LCon91846,LAdd49661,LRes9303,LSim29457],["Glo80464","Res74844","Res96515","Zer33667","Con62497","Con91846","Add49661","Res9303","Sim29457"],Sim29457,"Sim29457")

Actual (Unparsed): [[1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0]]

Actual:   [[1, 1]]

Expected: [[1, 1]]