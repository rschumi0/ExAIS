import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave2803 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave2803 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Dot17807 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot17807 = tf.keras.layers.Input(shape=([2, 3]))
in0Min25432 = tf.keras.layers.Input(shape=([2, 1]))
in1Min25432 = tf.keras.layers.Input(shape=([2, 1]))
in0Con55136 = tf.keras.layers.Input(shape=([3, 2]))
in0Con42265 = tf.keras.layers.Input(shape=([4, 9]))

Ave2803 = keras.layers.Average(name = 'Ave2803', )([in0Ave2803,in1Ave2803])
Res56614 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res56614', )(Ave2803)
Zer40204 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer40204', )(Res56614)
Res34062 = keras.layers.Reshape((4, 4, 3), name = 'Res34062', )(Zer40204)
Res88416 = keras.layers.Reshape((4, 12), name = 'Res88416', )(Res34062)
Dot17807 = keras.layers.Dot(axes=(1, 1), name = 'Dot17807', )([in0Dot17807,in1Dot17807])
Min25432 = keras.layers.Minimum(name = 'Min25432', )([in0Min25432,in1Min25432])
Zer2001 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer2001', )(Min25432)
Con55136 = keras.layers.Concatenate(axis=2, name = 'Con55136', )([Zer2001,in0Con55136])
Max71752 = keras.layers.Maximum(name = 'Max71752', )([Dot17807,Con55136])
Zer26554 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer26554', )(Max71752)
Con42265 = keras.layers.Concatenate(axis=2, name = 'Con42265', )([Zer26554,in0Con42265])
Mul99184 = keras.layers.Multiply(name = 'Mul99184', )([Res88416,Con42265])
model = tf.keras.models.Model(inputs=[in0Ave2803,in1Ave2803,in0Dot17807,in1Dot17807,in0Min25432,in1Min25432,in0Con55136,in0Con42265], outputs=Mul99184)
in0Ave2803 = tf.constant([[[[0.6912], [0.5781]], [[0.0341], [0.913]]]])
in1Ave2803 = tf.constant([[[[0.4667], [0.1743]], [[0.3132], [0.734]]]])
in0Dot17807 = tf.constant([[[0.0969, 0.9486, 0.9661], [0.9657, 0.2849, 0.5765]]])
in1Dot17807 = tf.constant([[[0.849, 0.4473, 0.8925], [0.0476, 0.2048, 0.2763]]])
in0Min25432 = tf.constant([[[0.515], [0.0323]]])
in1Min25432 = tf.constant([[[0.8454], [0.0152]]])
in0Con55136 = tf.constant([[[0.393, 0.4311], [0.5124, 0.4234], [0.1154, 0.8896]]])
in0Con42265 = tf.constant([[[0.5749, 0.7372, 0.007, 0.7715, 0.4209, 0.1885, 0.5299, 0.4813, 0.8328], [0.0656, 0.6234, 0.6308, 0.2526, 0.325, 0.9582, 0.2818, 0.836, 0.8477], [0.9315, 0.7968, 0.0704, 0.8785, 0.2096, 0.5801, 0.5356, 0.9562, 0.7024], [0.5408, 0.8958, 0.5748, 0.4446, 0.2155, 0.5227, 0.8145, 0.8693, 0.3245]]])
print (np.array2string(model.predict([in0Ave2803,in1Ave2803,in0Dot17807,in1Dot17807,in0Min25432,in1Min25432,in0Con55136,in0Con42265],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul99184.png')

LAve2803 = average_layer([[[[[0.6912], [0.5781]], [[0.0341], [0.913]]]], [[[[0.4667], [0.1743]], [[0.3132], [0.734]]]]], Ave2803), 
LRes56614 = reshape_layer(Ave2803, [2, 2, 1, 1], Res56614), 
LZer40204 = zero_padding3D_layer(Res56614, 1, 1, 1, 1, 1, 1, Zer40204), 
LRes34062 = reshape_layer(Zer40204, [4, 4, 3], Res34062), 
LRes88416 = reshape_layer(Res34062, [4, 12], Res88416), 
LDot17807 = dot_layer([[[0.0969, 0.9486, 0.9661], [0.9657, 0.2849, 0.5765]]], [[[0.849, 0.4473, 0.8925], [0.0476, 0.2048, 0.2763]]], 1, 1, Dot17807), 
LMin25432 = minimum_layer([[[[0.515], [0.0323]]], [[[0.8454], [0.0152]]]], Min25432), 
LZer2001 = zero_padding1D_layer(Min25432, 1, 0, Zer2001), 
LCon55136 = concatenate_layer([Zer2001,[[[0.393, 0.4311], [0.5124, 0.4234], [0.1154, 0.8896]]]], 2, Con55136), 
LMax71752 = maximum_layer([Dot17807,Con55136], Max71752), 
LZer26554 = zero_padding1D_layer(Max71752, 1, 0, Zer26554), 
LCon42265 = concatenate_layer([Zer26554,[[[0.5749, 0.7372, 0.007, 0.7715, 0.4209, 0.1885, 0.5299, 0.4813, 0.8328], [0.0656, 0.6234, 0.6308, 0.2526, 0.325, 0.9582, 0.2818, 0.836, 0.8477], [0.9315, 0.7968, 0.0704, 0.8785, 0.2096, 0.5801, 0.5356, 0.9562, 0.7024], [0.5408, 0.8958, 0.5748, 0.4446, 0.2155, 0.5227, 0.8145, 0.8693, 0.3245]]]], 2, Con42265), 
LMul99184 = multiply_layer([Res88416,Con42265], Mul99184), 
exec_layers([LAve2803,LRes56614,LZer40204,LRes34062,LRes88416,LDot17807,LMin25432,LZer2001,LCon55136,LMax71752,LZer26554,LCon42265,LMul99184],["Ave2803","Res56614","Zer40204","Res34062","Res88416","Dot17807","Min25432","Zer2001","Con55136","Max71752","Zer26554","Con42265","Mul99184"],Mul99184,"Mul99184")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.3609174, 0.0000000, 0.0000000, 0.1222650, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.1383643, 0.0000000, 0.0000000, 0.1726056, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.36091743000000004,0.0,0.0,0.122265,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.13836431999999999,0.0,0.0,0.1726056,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]]]

Actual:   [[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0.361, 0, 0, 0.1223, 0, 0, 0, 0], [0, 0, 0, 0, 0.1384, 0, 0, 0.1727, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0.361, 0, 0, 0.1223, 0, 0, 0, 0], [0, 0, 0, 0, 0.1384, 0, 0, 0.1727, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]