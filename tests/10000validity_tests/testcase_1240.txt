import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min24477 = tf.keras.layers.Input(shape=([1, 2]))
in1Min24477 = tf.keras.layers.Input(shape=([1, 2]))

Min24477 = keras.layers.Minimum(name = 'Min24477', )([in0Min24477,in1Min24477])
Res12139 = keras.layers.Reshape((1, 2, 1), name = 'Res12139', )(Min24477)
Zer53494 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer53494', )(Res12139)
Res40925 = keras.layers.Reshape((3, 4, 1, 1), name = 'Res40925', )(Zer53494)
Up_1815 = keras.layers.UpSampling3D(size=(1, 1, 1), name = 'Up_1815', )(Res40925)
Res95390 = keras.layers.Reshape((3, 4, 1), name = 'Res95390', )(Up_1815)
Res7270 = keras.layers.Reshape((3, 4), name = 'Res7270', )(Res95390)
Loc68670 = keras.layers.LocallyConnected1D(4, (2),strides=(1), name = 'Loc68670', )(Res7270)
model = tf.keras.models.Model(inputs=[in0Min24477,in1Min24477], outputs=Loc68670)
w = model.get_layer('Loc68670').get_weights() 
w[0] = np.array([[[0.4352, 0.7391, 0.1369, 0.0822], [0.6719, 0.2496, 0.8664, 0.6597], [0.7334, 0.3452, 0.0095, 0.9723], [0.8526, 0.9934, 0.2433, 0.3124], [0.5168, 0.8627, 0.3985, 0.8438], [0.3402, 0.9104, 0.7993, 0.4226], [0.0772, 0.3566, 0.1397, 0.7269], [0.4926, 0.3398, 0.1522, 0.4876]], [[0.3242, 0.2961, 0.852, 0.9917], [0.3687, 0.3744, 0.4572, 0.4478], [0.8031, 0.0094, 0.1779, 0.2471], [0.2123, 0.1088, 0.9433, 0.6337], [0.4359, 0.1795, 0.795, 0.8042], [0.271, 0.1185, 0.1109, 0.998], [0.2699, 0.3231, 0.0446, 0.7107], [0.3588, 0.237, 0.5669, 0.765]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc68670').set_weights(w) 
in0Min24477 = tf.constant([[[0.3914, 0.703]]])
in1Min24477 = tf.constant([[[0.4, 0.0368]]])
print (np.array2string(model.predict([in0Min24477,in1Min24477],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc68670.png')

LMin24477 = minimum_layer([[[[0.3914, 0.703]]], [[[0.4, 0.0368]]]], Min24477), 
LRes12139 = reshape_layer(Min24477, [1, 2, 1], Res12139), 
LZer53494 = zero_padding2D_layer(Res12139, 1, 1, 1, 1, Zer53494), 
LRes40925 = reshape_layer(Zer53494, [3, 4, 1, 1], Res40925), 
LUp_1815 = up_sampling3D_layer(Res40925, 1, 1, 1, Up_1815), 
LRes95390 = reshape_layer(Up_1815, [3, 4, 1], Res95390), 
LRes7270 = reshape_layer(Res95390, [3, 4], Res7270), 
LLoc68670 = locally_connected1D_layer(Res7270, 2,[[[0.4352, 0.7391, 0.1369, 0.0822], [0.6719, 0.2496, 0.8664, 0.6597], [0.7334, 0.3452, 0.0095, 0.9723], [0.8526, 0.9934, 0.2433, 0.3124], [0.5168, 0.8627, 0.3985, 0.8438], [0.3402, 0.9104, 0.7993, 0.4226], [0.0772, 0.3566, 0.1397, 0.7269], [0.4926, 0.3398, 0.1522, 0.4876]], [[0.3242, 0.2961, 0.852, 0.9917], [0.3687, 0.3744, 0.4572, 0.4478], [0.8031, 0.0094, 0.1779, 0.2471], [0.2123, 0.1088, 0.9433, 0.6337], [0.4359, 0.1795, 0.795, 0.8042], [0.271, 0.1185, 0.1109, 0.998], [0.2699, 0.3231, 0.0446, 0.7107], [0.3588, 0.237, 0.5669, 0.765]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc68670), 
exec_layers([LMin24477,LRes12139,LZer53494,LRes40925,LUp_1815,LRes95390,LRes7270,LLoc68670],["Min24477","Res12139","Zer53494","Res40925","Up_1815","Res95390","Res7270","Loc68670"],Loc68670,"Loc68670")

Actual (Unparsed): [[[0.1359952, 0.3694534, 0.3179870, 0.1921556], [0.1738633, 0.1468861, 0.1854948, 0.1843622]]]

Expected (Unparsed): [[[0.13599524000000002,0.36945344,0.31798698000000003,0.19215556],[0.17386326000000002,0.14688608,0.18549480000000002,0.1843622]]]

Actual:   [[[0.136, 0.3695, 0.318, 0.1922], [0.1739, 0.1469, 0.1855, 0.1844]]]

Expected: [[[0.136, 0.3695, 0.318, 0.1922], [0.1739, 0.1469, 0.1855, 0.1844]]]