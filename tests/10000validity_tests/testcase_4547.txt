import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo31901 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0PRe1422 = tf.keras.layers.Input(shape=([1, 1, 2]))

Glo31901 = keras.layers.GlobalAveragePooling2D(name = 'Glo31901', )(in0Glo31901)
Res4119 = keras.layers.Reshape((1, 1), name = 'Res4119', )(Glo31901)
Sep636 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep636', )(Res4119)
Res67010 = keras.layers.Reshape((1, 3, 1), name = 'Res67010', )(Sep636)
Res19530 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res19530', )(Res67010)
Con86017 = keras.layers.Conv3DTranspose(2, (1, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con86017', )(Res19530)
Res38797 = keras.layers.Reshape((1, 3, 2), name = 'Res38797', )(Con86017)
PRe1422 = keras.layers.PReLU(name = 'PRe1422', input_shape=(1, 1, 2))(in0PRe1422)
Zer5889 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer5889', )(PRe1422)
Add24506 = keras.layers.Add(name = 'Add24506', )([Res38797,Zer5889])
PRe54785 = keras.layers.PReLU(name = 'PRe54785', )(Add24506)
model = tf.keras.models.Model(inputs=[in0Glo31901,in0PRe1422], outputs=PRe54785)
w = model.get_layer('Sep636').get_weights() 
w[0] = np.array([[[0.8115]]])
w[1] = np.array([[[0.2719, 0.5177, 0.8557]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep636').set_weights(w) 
w = model.get_layer('Con86017').get_weights() 
w[0] = np.array([[[[[0.0058], [0.3115]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con86017').set_weights(w) 
w = model.get_layer('PRe1422').get_weights() 
w[0] = np.array([[[0.3145, 0.6076]]])
model.get_layer('PRe1422').set_weights(w) 
w = model.get_layer('PRe54785').get_weights() 
w[0] = np.array([[[0.3327, 0.6855], [0.3703, 0.2307], [0.5995, 0.7998]]])
model.get_layer('PRe54785').set_weights(w) 
in0Glo31901 = tf.constant([[[[1.7764]]]])
in0PRe1422 = tf.constant([[[[0.0615, 0.6207]]]])
print (np.array2string(model.predict([in0Glo31901,in0PRe1422],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe54785.png')

LGlo31901 = global_average_pooling2D_layer([[[[1.7764]]]], Glo31901), 
LRes4119 = reshape_layer(Glo31901, [1, 1], Res4119), 
LSep636 = separable_conv1D_layer(Res4119, 1,[[[[0.8115]]],[[[0.2719, 0.5177, 0.8557]]]],[0, 0, 0], 1, false, Sep636), 
LRes67010 = reshape_layer(Sep636, [1, 3, 1], Res67010), 
LRes19530 = reshape_layer(Res67010, [1, 3, 1, 1], Res19530), 
LCon86017 = conv3D_transpose_layer(Res19530, 1, 1, 1,[[[[[0.0058], [0.3115]]]]],[0, 0], 1, 1, 1, true, Con86017), 
LRes38797 = reshape_layer(Con86017, [1, 3, 2], Res38797), 
LPRe1422 = prelu_layer([[[[0.0615, 0.6207]]]], [[[0.3145, 0.6076]]], PRe1422), 
LZer5889 = zero_padding2D_layer(PRe1422, 0, 0, 2, 0, Zer5889), 
LAdd24506 = add_layer([Res38797,Zer5889], Add24506), 
LPRe54785 = prelu_layer(Add24506, [[[0.3327, 0.6855], [0.3703, 0.2307], [0.5995, 0.7998]]], PRe54785), 
exec_layers([LGlo31901,LRes4119,LSep636,LRes67010,LRes19530,LCon86017,LRes38797,LPRe1422,LZer5889,LAdd24506,LPRe54785],["Glo31901","Res4119","Sep636","Res67010","Res19530","Con86017","Res38797","PRe1422","Zer5889","Add24506","PRe54785"],PRe54785,"PRe54785")

Actual (Unparsed): [[[[0.0022734, 0.1220946], [0.0043285, 0.2324692], [0.0686545, 1.0049456]]]]

Expected (Unparsed): [[[[0.0022733509731719995,0.12209462554190999],[0.004328480319276,0.23246924473353],[0.068654492194716,1.00494557218173]]]]

Actual:   [[[[0.0023, 0.1221], [0.0044, 0.2325], [0.0687, 1.005]]]]

Expected: [[[[0.0023, 0.1221], [0.0044, 0.2325], [0.0687, 1.005]]]]