import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot8955 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot8955 = tf.keras.layers.Input(shape=([2, 2]))
in0Min80996 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Min80996 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Dot8955 = keras.layers.Dot(axes=(1, 2), name = 'Dot8955', )([in0Dot8955,in1Dot8955])
Zer13318 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer13318', )(Dot8955)
Min80996 = keras.layers.Minimum(name = 'Min80996', )([in0Min80996,in1Min80996])
Res46423 = keras.layers.Reshape((1, 1, 2), name = 'Res46423', )(Min80996)
Res47366 = keras.layers.Reshape((1, 2), name = 'Res47366', )(Res46423)
Zer4006 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer4006', )(Res47366)
Max51148 = keras.layers.Maximum(name = 'Max51148', )([Zer13318,Zer4006])
model = tf.keras.models.Model(inputs=[in0Dot8955,in1Dot8955,in0Min80996,in1Min80996], outputs=Max51148)
in0Dot8955 = tf.constant([[[0.5894, 0.9134], [0.6683, 0.7959]]])
in1Dot8955 = tf.constant([[[0.9463, 0.0406], [0.4525, 0.3039]]])
in0Min80996 = tf.constant([[[[[0.8943, 0.1883]]]]])
in1Min80996 = tf.constant([[[[[0.4486, 0.9318]]]]])
print (np.array2string(model.predict([in0Dot8955,in1Dot8955,in0Min80996,in1Min80996],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max51148.png')

LDot8955 = dot_layer([[[0.5894, 0.9134], [0.6683, 0.7959]]], [[[0.9463, 0.0406], [0.4525, 0.3039]]], 1, 2, Dot8955), 
LZer13318 = zero_padding1D_layer(Dot8955, 1, 0, Zer13318), 
LMin80996 = minimum_layer([[[[[[0.8943, 0.1883]]]]], [[[[[0.4486, 0.9318]]]]]], Min80996), 
LRes46423 = reshape_layer(Min80996, [1, 1, 2], Res46423), 
LRes47366 = reshape_layer(Res46423, [1, 2], Res47366), 
LZer4006 = zero_padding1D_layer(Res47366, 1, 1, Zer4006), 
LMax51148 = maximum_layer([Zer13318,Zer4006], Max51148), 
exec_layers([LDot8955,LZer13318,LMin80996,LRes46423,LRes47366,LZer4006,LMax51148],["Dot8955","Zer13318","Min80996","Res46423","Res47366","Zer4006","Max51148"],Max51148,"Max51148")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.5848822, 0.4697999], [0.8966640, 0.6551875]]]

Expected (Unparsed): [[[0,0],[0.5848822,0.46979987],[0.89666396,0.65518751]]]

Actual:   [[[0, 0], [0.5849, 0.4698], [0.8967, 0.6552]]]

Expected: [[[0, 0], [0.5849, 0.4698], [0.8967, 0.6552]]]