import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave10634 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Ave10634 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Ave60968 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Ave60968 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Ave10634 = keras.layers.Average(name = 'Ave10634', )([in0Ave10634,in1Ave10634])
Res46670 = keras.layers.Reshape((1, 2, 4), name = 'Res46670', )(Ave10634)
Zer95489 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer95489', )(Res46670)
Res65106 = keras.layers.Reshape((3, 4, 4, 1), name = 'Res65106', )(Zer95489)
Ave60968 = keras.layers.Average(name = 'Ave60968', )([in0Ave60968,in1Ave60968])
Zer40790 = keras.layers.ZeroPadding3D(padding=((1, 0), (2, 0), (3, 0)), name = 'Zer40790', )(Ave60968)
Ave34008 = keras.layers.Average(name = 'Ave34008', )([Res65106,Zer40790])
model = tf.keras.models.Model(inputs=[in0Ave10634,in1Ave10634,in0Ave60968,in1Ave60968], outputs=Ave34008)
in0Ave10634 = tf.constant([[[[[0.0442, 0.975], [0.2382, 0.8616]], [[0.2646, 0.5101], [0.4247, 0.2346]]]]])
in1Ave10634 = tf.constant([[[[[0.2222, 0.1143], [0.6624, 0.9305]], [[0.7415, 0.0178], [0.0659, 0.1345]]]]])
in0Ave60968 = tf.constant([[[[[0.0399]], [[0.0526]]], [[[0.5198]], [[0.9386]]]]])
in1Ave60968 = tf.constant([[[[[0.0703]], [[0.8321]]], [[[0.4069]], [[0.9963]]]]])
print (np.array2string(model.predict([in0Ave10634,in1Ave10634,in0Ave60968,in1Ave60968],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave34008.png')

LAve10634 = average_layer([[[[[[0.0442, 0.975], [0.2382, 0.8616]], [[0.2646, 0.5101], [0.4247, 0.2346]]]]], [[[[[0.2222, 0.1143], [0.6624, 0.9305]], [[0.7415, 0.0178], [0.0659, 0.1345]]]]]], Ave10634), 
LRes46670 = reshape_layer(Ave10634, [1, 2, 4], Res46670), 
LZer95489 = zero_padding2D_layer(Res46670, 1, 1, 1, 1, Zer95489), 
LRes65106 = reshape_layer(Zer95489, [3, 4, 4, 1], Res65106), 
LAve60968 = average_layer([[[[[[0.0399]], [[0.0526]]], [[[0.5198]], [[0.9386]]]]], [[[[[0.0703]], [[0.8321]]], [[[0.4069]], [[0.9963]]]]]], Ave60968), 
LZer40790 = zero_padding3D_layer(Ave60968, 1, 0, 2, 0, 3, 0, Zer40790), 
LAve34008 = average_layer([Res65106,Zer40790], Ave34008), 
exec_layers([LAve10634,LRes46670,LZer95489,LRes65106,LAve60968,LZer40790,LAve34008],["Ave10634","Res46670","Zer95489","Res65106","Ave60968","Zer40790","Ave34008"],Ave34008,"Ave34008")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0666000], [0.2723250], [0.2251500], [0.4480250]], [[0.2515250], [0.1319750], [0.1226500], [0.1198250]], [[0.0000000], [0.0000000], [0.0000000], [0.2211750]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.2316750]], [[0.0000000], [0.0000000], [0.0000000], [0.4837250]]]]]

Expected (Unparsed): [[[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]]],[[[0],[0],[0],[0]],[[0.0666],[0.272325],[0.22515],[0.448025]],[[0.251525],[0.131975],[0.12265000000000001],[0.11982499999999999]],[[0],[0],[0],[0.22117499999999998]]],[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0.23167500000000002]],[[0],[0],[0],[0.48372499999999996]]]]]

Actual:   [[[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0.0666], [0.2724], [0.2252], [0.4481]], [[0.2516], [0.132], [0.1227], [0.1199]], [[0], [0], [0], [0.2212]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0.2317]], [[0], [0], [0], [0.4838]]]]]

Expected: [[[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]], [[[0], [0], [0], [0]], [[0.0666], [0.2724], [0.2252], [0.4481]], [[0.2516], [0.132], [0.1227], [0.1199]], [[0], [0], [0], [0.2212]]], [[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0.2317]], [[0], [0], [0], [0.4838]]]]]