import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max66182 = tf.keras.layers.Input(shape=([1, 1, 1]))

Max66182 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max66182', )(in0Max66182)
Sof31135 = keras.layers.Softmax(axis=1, name = 'Sof31135', )(Max66182)
Res5492 = keras.layers.Reshape((1, 1), name = 'Res5492', )(Sof31135)
LST63239 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST63239', )(Res5492)
Res65298 = keras.layers.Reshape((2, 1), name = 'Res65298', )(LST63239)
Max35558 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max35558', )(Res65298)
model = tf.keras.models.Model(inputs=[in0Max66182], outputs=Max35558)
w = model.get_layer('LST63239').get_weights() 
w[0] = np.array([[9, 10, 7, 6, 6, 5, 7, 6]])
w[1] = np.array([[4, 2, 8, 1, 3, 9, 7, 7], [8, 2, 10, 1, 10, 6, 9, 2]])
w[2] = np.array([10, 7, 4, 2, 1, 3, 2, 1])
model.get_layer('LST63239').set_weights(w) 
in0Max66182 = tf.constant([[[[1.5385]]]])
print (np.array2string(model.predict([in0Max66182],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max35558.png')

LMax66182 = max_pool2D_layer([[[[1.5385]]]], 1, 1, Max66182), 
LSof31135 = softmax_layer(Max66182, 1, Sof31135), 
LRes5492 = reshape_layer(Sof31135, [1, 1], Res5492), 
LLST63239 = lstm_layer(Res5492,[[9, 10, 7, 6, 6, 5, 7, 6]],[[4, 2, 8, 1, 3, 9, 7, 7], [8, 2, 10, 1, 10, 6, 9, 2]],[10, 7, 4, 2, 1, 3, 2, 1], LST63239), 
LRes65298 = reshape_layer(LST63239, [2, 1], Res65298), 
LMax35558 = max_pool1D_layer(Res65298, 2, Max35558), 
exec_layers([LMax66182,LSof31135,LRes5492,LLST63239,LRes65298,LMax35558],["Max66182","Sof31135","Res5492","LST63239","Res65298","Max35558"],Max35558,"Max35558")

Actual (Unparsed): [[[0.7614995]]]

Expected (Unparsed): [[[0.761499478659502]]]

Actual:   [[[0.7615]]]

Expected: [[[0.7615]]]