import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min85196 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Min85196 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Min85196 = keras.layers.Minimum(name = 'Min85196', )([in0Min85196,in1Min85196])
Res2780 = keras.layers.Reshape((2, 1, 2), name = 'Res2780', )(Min85196)
Res66067 = keras.layers.Reshape((2, 2), name = 'Res66067', )(Res2780)
GRU37287 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU37287', )(Res66067)
model = tf.keras.models.Model(inputs=[in0Min85196,in1Min85196], outputs=GRU37287)
w = model.get_layer('GRU37287').get_weights() 
w[0] = np.array([[1, 5, 5], [2, 9, 6]])
w[1] = np.array([[2, 4, 5]])
w[2] = np.array([[6, 9, 4], [2, 6, 6]])
model.get_layer('GRU37287').set_weights(w) 
in0Min85196 = tf.constant([[[[[0.7648, 0.9435]]], [[[0.3181, 0.9251]]]]])
in1Min85196 = tf.constant([[[[[0.119, 0.7878]]], [[[0.3637, 0.8111]]]]])
print (np.array2string(model.predict([in0Min85196,in1Min85196],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU37287.png')

LMin85196 = minimum_layer([[[[[[0.7648, 0.9435]]], [[[0.3181, 0.9251]]]]], [[[[[0.119, 0.7878]]], [[[0.3637, 0.8111]]]]]], Min85196), 
LRes2780 = reshape_layer(Min85196, [2, 1, 2], Res2780), 
LRes66067 = reshape_layer(Res2780, [2, 2], Res66067), 
LGRU37287 = gru_layer(Res66067,[[1, 5, 5], [2, 9, 6]],[[2, 4, 5]],[[6, 9, 4], [2, 6, 6]], true, GRU37287), 
exec_layers([LMin85196,LRes2780,LRes66067,LGRU37287],["Min85196","Res2780","Res66067","GRU37287"],GRU37287,"GRU37287")

Actual (Unparsed): [[0.0001098]]

Expected (Unparsed): [[0.00010979314075151606]]

Actual:   [[0.0002]]

Expected: [[0.0002]]