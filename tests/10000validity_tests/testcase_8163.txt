import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul45642 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul45642 = tf.keras.layers.Input(shape=([2, 1]))
in0Con9975 = tf.keras.layers.Input(shape=([2, 5]))
in0Max99518 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Max99518 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Mul45642 = keras.layers.Multiply(name = 'Mul45642', )([in0Mul45642,in1Mul45642])
Con9975 = keras.layers.Concatenate(axis=2, name = 'Con9975', )([Mul45642,in0Con9975])
Max99518 = keras.layers.Maximum(name = 'Max99518', )([in0Max99518,in1Max99518])
Res28166 = keras.layers.Reshape((2, 1, 2), name = 'Res28166', )(Max99518)
Zer61317 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer61317', )(Res28166)
Res67194 = keras.layers.Reshape((4, 6), name = 'Res67194', )(Zer61317)
Zer61880 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer61880', )(Res67194)
Dot2325 = keras.layers.Dot(axes=(2, 2), name = 'Dot2325', )([Con9975,Zer61880])
model = tf.keras.models.Model(inputs=[in0Mul45642,in1Mul45642,in0Con9975,in0Max99518,in1Max99518], outputs=Dot2325)
in0Mul45642 = tf.constant([[[0.5889], [0.6173]]])
in1Mul45642 = tf.constant([[[0.423], [0.9715]]])
in0Con9975 = tf.constant([[[0.5333, 0.6462, 0.5452, 0.8426, 0.5682], [0.2822, 0.8163, 0.8051, 0.2479, 0.8821]]])
in0Max99518 = tf.constant([[[[[0.8784, 0.207]]], [[[0.8782, 0.096]]]]])
in1Max99518 = tf.constant([[[[[0.1623, 0.7564]]], [[[0.5744, 0.3587]]]]])
print (np.array2string(model.predict([in0Mul45642,in1Mul45642,in0Con9975,in0Max99518,in1Max99518],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot2325.png')

LMul45642 = multiply_layer([[[[0.5889], [0.6173]]], [[[0.423], [0.9715]]]], Mul45642), 
LCon9975 = concatenate_layer([Mul45642,[[[0.5333, 0.6462, 0.5452, 0.8426, 0.5682], [0.2822, 0.8163, 0.8051, 0.2479, 0.8821]]]], 2, Con9975), 
LMax99518 = maximum_layer([[[[[[0.8784, 0.207]]], [[[0.8782, 0.096]]]]], [[[[[0.1623, 0.7564]]], [[[0.5744, 0.3587]]]]]], Max99518), 
LRes28166 = reshape_layer(Max99518, [2, 1, 2], Res28166), 
LZer61317 = zero_padding2D_layer(Res28166, 1, 1, 1, 1, Zer61317), 
LRes67194 = reshape_layer(Zer61317, [4, 6], Res67194), 
LZer61880 = zero_padding1D_layer(Res67194, 2, 0, Zer61880), 
LDot2325 = dot_layer(Con9975,Zer61880, 2, 2, Dot2325), 
exec_layers([LMul45642,LCon9975,LMax99518,LRes28166,LZer61317,LRes67194,LZer61880,LDot2325],["Mul45642","Con9975","Max99518","Res28166","Zer61317","Res67194","Zer61880","Dot2325"],Dot2325,"Dot2325")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.9800114, 0.7630561, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 1.3260156, 1.0056640, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.9800113599999999,0.76305608,0.0],[0.0,0.0,0.0,1.32601556,1.0056640300000002,0.0]]]

Actual:   [[[0, 0, 0, 0.9801, 0.7631, 0], [0, 0, 0, 1.3261, 1.0057, 0]]]

Expected: [[[0, 0, 0, 0.9801, 0.7631, 0], [0, 0, 0, 1.3261, 1.0057, 0]]]