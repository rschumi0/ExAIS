import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max32541 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Max32541 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Max32541 = keras.layers.Maximum(name = 'Max32541', )([in0Max32541,in1Max32541])
Lay55415 = keras.layers.LayerNormalization(axis=1, epsilon=1.935924169791595, name = 'Lay55415', )(Max32541)
model = tf.keras.models.Model(inputs=[in0Max32541,in1Max32541], outputs=Lay55415)
in0Max32541 = tf.constant([[[[[0.8734, 0.5995], [0.5096, 0.2988]]], [[[0.5808, 0.605], [0.3255, 0.9743]]]]])
in1Max32541 = tf.constant([[[[[0.6774, 0.4089], [0.6093, 0.746]]], [[[0.8338, 0.8556], [0.6739, 0.3248]]]]])
print (np.array2string(model.predict([in0Max32541,in1Max32541],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay55415.png')

LMax32541 = maximum_layer([[[[[[0.8734, 0.5995], [0.5096, 0.2988]]], [[[0.5808, 0.605], [0.3255, 0.9743]]]]], [[[[[0.6774, 0.4089], [0.6093, 0.746]]], [[[0.8338, 0.8556], [0.6739, 0.3248]]]]]], Max32541), 
LLay55415 = layer_normalization_layer(Max32541, 1, 1.935924169791595, Lay55415), 
exec_layers([LMax32541,LLay55415],["Max32541","Lay55415"],Lay55415,"Lay55415")

Actual (Unparsed): [[[[[0.0142291, -0.0916440], [-0.0232082, -0.0817665]]], [[[-0.0142291, 0.0916440], [0.0232082, 0.0817665]]]]]

Expected (Unparsed): [[[[[0.014229087489073332,-0.09164398656970049],[-0.0232081947370196,-0.08176643776431165]]],[[[-0.014229087489073252,0.09164398656970049],[0.02320819473701968,0.08176643776431174]]]]]

Actual:   [[[[[0.0143, -0.0916], [-0.0232, -0.0817]]], [[[-0.0142, 0.0917], [0.0233, 0.0818]]]]]

Expected: [[[[[0.0143, -0.0916], [-0.0232, -0.0817]]], [[[-0.0142, 0.0917], [0.0233, 0.0818]]]]]