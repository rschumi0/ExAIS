import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con26148 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con33851 = tf.keras.layers.Input(shape=([2, 1]))
in0Sep58600 = tf.keras.layers.Input(shape=([1, 1]))

Con26148 = keras.layers.Conv2DTranspose(2, (2, 1),strides=(1, 1), padding='same', name = 'Con26148', )(in0Con26148)
Res66561 = keras.layers.Reshape((2, 2), name = 'Res66561', )(Con26148)
Con33851 = keras.layers.Concatenate(axis=2, name = 'Con33851', )([Res66561,in0Con33851])
Sep58600 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep58600', )(in0Sep58600)
Res7612 = keras.layers.Reshape((1, 3, 1), name = 'Res7612', )(Sep58600)
Max22286 = keras.layers.MaxPool2D(pool_size=(1, 3), strides=(1, 1), padding='same', name = 'Max22286', )(Res7612)
Res43718 = keras.layers.Reshape((1, 3), name = 'Res43718', )(Max22286)
Dot76825 = keras.layers.Dot(axes=(2, 2), name = 'Dot76825', )([Con33851,Res43718])
Res27937 = keras.layers.Reshape((2, 1, 1), name = 'Res27937', )(Dot76825)
Res95505 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res95505', )(Res27937)
Glo61476 = keras.layers.GlobalMaxPool3D(name = 'Glo61476', )(Res95505)
ReL17349 = keras.layers.ReLU(max_value=5.435910250495307, negative_slope=1.344984137354968, threshold=8.39587326479064, name = 'ReL17349', )(Glo61476)
model = tf.keras.models.Model(inputs=[in0Con26148,in0Con33851,in0Sep58600], outputs=ReL17349)
w = model.get_layer('Con26148').get_weights() 
w[0] = np.array([[[[0.6189], [0.1979]]], [[[0.5849], [0.3542]]]])
w[1] = np.array([0, 0])
model.get_layer('Con26148').set_weights(w) 
w = model.get_layer('Sep58600').get_weights() 
w[0] = np.array([[[0.3212]]])
w[1] = np.array([[[0.0896, 0.3978, 0.9642]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep58600').set_weights(w) 
in0Con26148 = tf.constant([[[[0.8005]], [[0.9802]]]])
in0Con33851 = tf.constant([[[0.8876], [0.8212]]])
in0Sep58600 = tf.constant([[[0.9066]]])
print (np.array2string(model.predict([in0Con26148,in0Con33851,in0Sep58600],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL17349.png')

LCon26148 = conv2D_transpose_layer([[[[0.8005]], [[0.9802]]]], 2, 1,[[[[0.6189], [0.1979]]], [[[0.5849], [0.3542]]]],[0, 0], 1, 1, true, Con26148), 
LRes66561 = reshape_layer(Con26148, [2, 2], Res66561), 
LCon33851 = concatenate_layer([Res66561,[[[0.8876], [0.8212]]]], 2, Con33851), 
LSep58600 = separable_conv1D_layer([[[0.9066]]], 1,[[[[0.3212]]],[[[0.0896, 0.3978, 0.9642]]]],[0, 0, 0], 1, false, Sep58600), 
LRes7612 = reshape_layer(Sep58600, [1, 3, 1], Res7612), 
LMax22286 = max_pool2D_layer(Res7612, 1, 3, 1, 1, true, Max22286), 
LRes43718 = reshape_layer(Max22286, [1, 3], Res43718), 
LDot76825 = dot_layer(Con33851,Res43718, 2, 2, Dot76825), 
LRes27937 = reshape_layer(Dot76825, [2, 1, 1], Res27937), 
LRes95505 = reshape_layer(Res27937, [2, 1, 1, 1], Res95505), 
LGlo61476 = global_max_pool3D_layer(Res95505, Glo61476), 
LReL17349 = relu_layer(Glo61476, 5.435910250495307, 1.344984137354968, 8.39587326479064, ReL17349), 
exec_layers([LCon26148,LRes66561,LCon33851,LSep58600,LRes7612,LMax22286,LRes43718,LDot76825,LRes27937,LRes95505,LGlo61476,LReL17349],["Con26148","Res66561","Con33851","Sep58600","Res7612","Max22286","Res43718","Dot76825","Res27937","Res95505","Glo61476","ReL17349"],ReL17349,"ReL17349")

Actual (Unparsed): [[-10.6344059]]

Expected (Unparsed): [[-10.63440587752258]]

Actual:   [[-10.6344]]

Expected: [[-10.6344]]