import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul32846 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul32846 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Ave20782 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave20782 = tf.keras.layers.Input(shape=([2, 2, 1]))

Mul32846 = keras.layers.Multiply(name = 'Mul32846', )([in0Mul32846,in1Mul32846])
Res89556 = keras.layers.Reshape((1, 2), name = 'Res89556', )(Mul32846)
Loc29657 = keras.layers.LocallyConnected1D(3, (1),strides=(6), name = 'Loc29657', )(Res89556)
Res31075 = keras.layers.Reshape((1, 3, 1), name = 'Res31075', )(Loc29657)
Zer73992 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer73992', )(Res31075)
Ave20782 = keras.layers.Average(name = 'Ave20782', )([in0Ave20782,in1Ave20782])
Zer36293 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer36293', )(Ave20782)
Min84483 = keras.layers.Minimum(name = 'Min84483', )([Zer73992,Zer36293])
model = tf.keras.models.Model(inputs=[in0Mul32846,in1Mul32846,in0Ave20782,in1Ave20782], outputs=Min84483)
w = model.get_layer('Loc29657').get_weights() 
w[0] = np.array([[[0.9878, 0.4745, 0.0823], [0.8298, 0.5802, 0.5164]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc29657').set_weights(w) 
in0Mul32846 = tf.constant([[[[0.5284, 0.4249]]]])
in1Mul32846 = tf.constant([[[[0.6147, 0.912]]]])
in0Ave20782 = tf.constant([[[[0.6062], [0.518]], [[0.7399], [0.5075]]]])
in1Ave20782 = tf.constant([[[[0.9061], [0.4445]], [[0.3518], [0.8377]]]])
print (np.array2string(model.predict([in0Mul32846,in1Mul32846,in0Ave20782,in1Ave20782],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min84483.png')

LMul32846 = multiply_layer([[[[[0.5284, 0.4249]]]], [[[[0.6147, 0.912]]]]], Mul32846), 
LRes89556 = reshape_layer(Mul32846, [1, 2], Res89556), 
LLoc29657 = locally_connected1D_layer(Res89556, 1,[[[0.9878, 0.4745, 0.0823], [0.8298, 0.5802, 0.5164]]],[[0, 0, 0]], 6, Loc29657), 
LRes31075 = reshape_layer(Loc29657, [1, 3, 1], Res31075), 
LZer73992 = zero_padding2D_layer(Res31075, 1, 0, 1, 0, Zer73992), 
LAve20782 = average_layer([[[[[0.6062], [0.518]], [[0.7399], [0.5075]]]], [[[[0.9061], [0.4445]], [[0.3518], [0.8377]]]]], Ave20782), 
LZer36293 = zero_padding2D_layer(Ave20782, 0, 0, 2, 0, Zer36293), 
LMin84483 = minimum_layer([Zer73992,Zer36293], Min84483), 
exec_layers([LMul32846,LRes89556,LLoc29657,LRes31075,LZer73992,LAve20782,LZer36293,LMin84483],["Mul32846","Res89556","Loc29657","Res31075","Zer73992","Ave20782","Zer36293","Min84483"],Min84483,"Min84483")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.3789538], [0.2268412]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[0],[0.37895375501999995],[0.22684119992399998]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [0], [0.379], [0.2269]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [0], [0.379], [0.2269]]]]