import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer12271 = tf.keras.layers.Input(shape=([2, 4]))
in0Mul29728 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul29728 = tf.keras.layers.Input(shape=([2, 2]))
in0Con3304 = tf.keras.layers.Input(shape=([4, 2]))
in0Min21938 = tf.keras.layers.Input(shape=([2, 2]))
in1Min21938 = tf.keras.layers.Input(shape=([2, 2]))

Zer12271 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer12271', )(in0Zer12271)
Mul29728 = keras.layers.Multiply(name = 'Mul29728', )([in0Mul29728,in1Mul29728])
Zer64280 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer64280', )(Mul29728)
Con3304 = keras.layers.Concatenate(axis=2, name = 'Con3304', )([Zer64280,in0Con3304])
Mul78476 = keras.layers.Multiply(name = 'Mul78476', )([Zer12271,Con3304])
Res16519 = keras.layers.Reshape((4, 4, 1), name = 'Res16519', )(Mul78476)
Min21938 = keras.layers.Minimum(name = 'Min21938', )([in0Min21938,in1Min21938])
Res45823 = keras.layers.Reshape((2, 2, 1), name = 'Res45823', )(Min21938)
Max17273 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max17273', )(Res45823)
Zer8116 = keras.layers.ZeroPadding2D(padding=((3, 0), (2, 0)), name = 'Zer8116', )(Max17273)
Add99247 = keras.layers.Add(name = 'Add99247', )([Res16519,Zer8116])
model = tf.keras.models.Model(inputs=[in0Zer12271,in0Mul29728,in1Mul29728,in0Con3304,in0Min21938,in1Min21938], outputs=Add99247)
in0Zer12271 = tf.constant([[[1.7346, 1.0218, 1.0443, 1.7719], [1.9423, 1.5745, 1.9025, 1.4648]]])
in0Mul29728 = tf.constant([[[0.422, 0.6571], [0.2165, 0.6485]]])
in1Mul29728 = tf.constant([[[0.7638, 0.4491], [0.761, 0.4813]]])
in0Con3304 = tf.constant([[[0.2142, 0.4876], [0.7206, 0.1303], [0.6051, 0.4373], [0.2805, 0.6269]]])
in0Min21938 = tf.constant([[[0.5018, 0.5587], [0.6408, 0.1004]]])
in1Min21938 = tf.constant([[[0.8733, 0.4316], [0.0968, 0.7018]]])
print (np.array2string(model.predict([in0Zer12271,in0Mul29728,in1Mul29728,in0Con3304,in0Min21938,in1Min21938],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add99247.png')

LZer12271 = zero_padding1D_layer([[[1.7346, 1.0218, 1.0443, 1.7719], [1.9423, 1.5745, 1.9025, 1.4648]]], 1, 1, Zer12271), 
LMul29728 = multiply_layer([[[[0.422, 0.6571], [0.2165, 0.6485]]], [[[0.7638, 0.4491], [0.761, 0.4813]]]], Mul29728), 
LZer64280 = zero_padding1D_layer(Mul29728, 2, 0, Zer64280), 
LCon3304 = concatenate_layer([Zer64280,[[[0.2142, 0.4876], [0.7206, 0.1303], [0.6051, 0.4373], [0.2805, 0.6269]]]], 2, Con3304), 
LMul78476 = multiply_layer([Zer12271,Con3304], Mul78476), 
LRes16519 = reshape_layer(Mul78476, [4, 4, 1], Res16519), 
LMin21938 = minimum_layer([[[[0.5018, 0.5587], [0.6408, 0.1004]]], [[[0.8733, 0.4316], [0.0968, 0.7018]]]], Min21938), 
LRes45823 = reshape_layer(Min21938, [2, 2, 1], Res45823), 
LMax17273 = max_pool2D_layer(Res45823, 2, 1, Max17273), 
LZer8116 = zero_padding2D_layer(Max17273, 3, 0, 2, 0, Zer8116), 
LAdd99247 = add_layer([Res16519,Zer8116], Add99247), 
exec_layers([LZer12271,LMul29728,LZer64280,LCon3304,LMul78476,LRes16519,LMin21938,LRes45823,LMax17273,LZer8116,LAdd99247],["Zer12271","Mul29728","Zer64280","Con3304","Mul78476","Res16519","Min21938","Res45823","Max17273","Zer8116","Add99247"],Add99247,"Add99247")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.7525226], [0.2308786]], [[0.6260491], [0.4646406], [1.1512027], [0.6405570]], [[0.0000000], [0.0000000], [0.5018000], [0.4316000]]]]

Expected (Unparsed): [[[[0],[0],[0.0],[0.0]],[[0.0],[0.0],[0.75252258],[0.23087857]],[[0.6260491282799999],[0.46464063394500005],[1.15120275],[0.64055704]],[[0.0],[0.0],[0.5018],[0.4316]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [0], [0.7526], [0.2309]], [[0.6261], [0.4647], [1.1513], [0.6406]], [[0], [0], [0.5018], [0.4316]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [0], [0.7526], [0.2309]], [[0.6261], [0.4647], [1.1513], [0.6406]], [[0], [0], [0.5018], [0.4316]]]]