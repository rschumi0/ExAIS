import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat85473 = tf.keras.layers.Input(shape=([3]))
in0Add25195 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add25195 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con8376 = tf.keras.layers.Input(shape=([3, 1]))
in0Max88060 = tf.keras.layers.Input(shape=([1, 2]))
in1Max88060 = tf.keras.layers.Input(shape=([1, 2]))

Bat85473 = keras.layers.BatchNormalization(axis=1, epsilon=0.7448795395873495,  name = 'Bat85473', )(in0Bat85473)
Res42777 = keras.layers.Reshape((3, 1), name = 'Res42777', )(Bat85473)
Add25195 = keras.layers.Add(name = 'Add25195', )([in0Add25195,in1Add25195])
Res38672 = keras.layers.Reshape((1, 1), name = 'Res38672', )(Add25195)
Dot54778 = keras.layers.Dot(axes=(2, 2), name = 'Dot54778', )([Res42777,Res38672])
Con8376 = keras.layers.Concatenate(axis=2, name = 'Con8376', )([Dot54778,in0Con8376])
Max88060 = keras.layers.Maximum(name = 'Max88060', )([in0Max88060,in1Max88060])
Zer33195 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer33195', )(Max88060)
Sub29244 = keras.layers.Subtract(name = 'Sub29244', )([Con8376,Zer33195])
Res88424 = keras.layers.Reshape((3, 2, 1), name = 'Res88424', )(Sub29244)
Cro89039 = keras.layers.Cropping2D(cropping=((2, 0), (1, 0)), name = 'Cro89039', )(Res88424)
model = tf.keras.models.Model(inputs=[in0Bat85473,in0Add25195,in1Add25195,in0Con8376,in0Max88060,in1Max88060], outputs=Cro89039)
w = model.get_layer('Bat85473').get_weights() 
w[0] = np.array([0.0264, 0.3462, 0.9622])
w[1] = np.array([0.1717, 0.7898, 0.6493])
w[2] = np.array([0.0016, 0.5444, 0.0005])
w[3] = np.array([0.055, 0.5967, 0.4753])
model.get_layer('Bat85473').set_weights(w) 
in0Bat85473 = tf.constant([[1.927, 1.4116, 1.0412]])
in0Add25195 = tf.constant([[[[0.9617]]]])
in1Add25195 = tf.constant([[[[0.768]]]])
in0Con8376 = tf.constant([[[0.541], [0.9857], [0.2022]]])
in0Max88060 = tf.constant([[[0.698, 0.4089]]])
in1Max88060 = tf.constant([[[0.9497, 0.2973]]])
print (np.array2string(model.predict([in0Bat85473,in0Add25195,in1Add25195,in0Con8376,in0Max88060,in1Max88060],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro89039.png')

LBat85473 = batch_normalization_layer([[1.927, 1.4116, 1.0412]], 1, 0.7448795395873495, [0.0264, 0.3462, 0.9622], [0.1717, 0.7898, 0.6493], [0.0016, 0.5444, 0.0005], [0.055, 0.5967, 0.4753], Bat85473), 
LRes42777 = reshape_layer(Bat85473, [3, 1], Res42777), 
LAdd25195 = add_layer([[[[[0.9617]]]], [[[[0.768]]]]], Add25195), 
LRes38672 = reshape_layer(Add25195, [1, 1], Res38672), 
LDot54778 = dot_layer(Res42777,Res38672, 2, 2, Dot54778), 
LCon8376 = concatenate_layer([Dot54778,[[[0.541], [0.9857], [0.2022]]]], 2, Con8376), 
LMax88060 = maximum_layer([[[[0.698, 0.4089]]], [[[0.9497, 0.2973]]]], Max88060), 
LZer33195 = zero_padding1D_layer(Max88060, 2, 0, Zer33195), 
LSub29244 = subtract_layer(Con8376,Zer33195, Sub29244), 
LRes88424 = reshape_layer(Sub29244, [3, 2, 1], Res88424), 
LCro89039 = cropping2D_layer(Res88424, 2, 0, 1, 0, Cro89039), 
exec_layers([LBat85473,LRes42777,LAdd25195,LRes38672,LDot54778,LCon8376,LMax88060,LZer33195,LSub29244,LRes88424,LCro89039],["Bat85473","Res42777","Add25195","Res38672","Dot54778","Con8376","Max88060","Zer33195","Sub29244","Res88424","Cro89039"],Cro89039,"Cro89039")

Actual (Unparsed): [[[[-0.2067000]]]]

Expected (Unparsed): [[[[-0.2067]]]]

Actual:   [[[[-0.2067]]]]

Expected: [[[[-0.2067]]]]