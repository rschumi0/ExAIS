import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave8460 = tf.keras.layers.Input(shape=([1, 1]))
in0Con92088 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Max89384 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max89384 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Ave24005 = tf.keras.layers.Input(shape=([2, 2]))
in0Add21216 = tf.keras.layers.Input(shape=([2, 1]))
in1Add21216 = tf.keras.layers.Input(shape=([2, 1]))
in0Con82993 = tf.keras.layers.Input(shape=([2, 2]))
in0Con58305 = tf.keras.layers.Input(shape=([2, 1]))

Ave8460 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave8460', )(in0Ave8460)
Res29853 = keras.layers.Reshape((1, 1, 1), name = 'Res29853', )(Ave8460)
Res75683 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res75683', )(Res29853)
Zer29057 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer29057', )(Res75683)
Con92088 = keras.layers.Concatenate(axis=4, name = 'Con92088', )([Zer29057,in0Con92088])
Max89384 = keras.layers.Maximum(name = 'Max89384', )([in0Max89384,in1Max89384])
ELU12347 = keras.layers.ELU(alpha=-0.6727721121232495, name = 'ELU12347', )(Max89384)
Mul14426 = keras.layers.Multiply(name = 'Mul14426', )([Con92088,ELU12347])
Res14189 = keras.layers.Reshape((2, 2, 2), name = 'Res14189', )(Mul14426)
Res61180 = keras.layers.Reshape((2, 4), name = 'Res61180', )(Res14189)
Ave24005 = keras.layers.AveragePooling1D(pool_size=(1), strides=(2), padding='valid', name = 'Ave24005', )(in0Ave24005)
Res89632 = keras.layers.Reshape((1, 2, 1), name = 'Res89632', )(Ave24005)
Sep13839 = keras.layers.SeparableConv2D(3, (1, 2),strides=(1, 1), padding='valid', name = 'Sep13839', )(Res89632)
Res82267 = keras.layers.Reshape((1, 3), name = 'Res82267', )(Sep13839)
Zer66339 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer66339', )(Res82267)
Add21216 = keras.layers.Add(name = 'Add21216', )([in0Add21216,in1Add21216])
Con82993 = keras.layers.Concatenate(axis=2, name = 'Con82993', )([Add21216,in0Con82993])
Min15473 = keras.layers.Minimum(name = 'Min15473', )([Zer66339,Con82993])
Con58305 = keras.layers.Concatenate(axis=2, name = 'Con58305', )([Min15473,in0Con58305])
Add94970 = keras.layers.Add(name = 'Add94970', )([Res61180,Con58305])
model = tf.keras.models.Model(inputs=[in0Ave8460,in0Con92088,in0Max89384,in1Max89384,in0Ave24005,in0Add21216,in1Add21216,in0Con82993,in0Con58305], outputs=Add94970)
w = model.get_layer('Sep13839').get_weights() 
w[0] = np.array([[[[0.3237]], [[0.2169]]]])
w[1] = np.array([[[[0.0647, 0.3419, 0.2922]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep13839').set_weights(w) 
in0Ave8460 = tf.constant([[[1.2715]]])
in0Con92088 = tf.constant([[[[[0.8993]], [[0.7731]]], [[[0.2158]], [[0.0543]]]]])
in0Max89384 = tf.constant([[[[[0.7011, 0.1277]], [[0.6417, 0.5241]]], [[[0.6564, 0.1702]], [[0.4755, 0.0034]]]]])
in1Max89384 = tf.constant([[[[[0.5638, 0.6325]], [[0.2297, 0.5333]]], [[[0.4507, 0.4157]], [[0.5006, 0.8427]]]]])
in0Ave24005 = tf.constant([[[1.026, 1.3654], [1.5428, 1.4533]]])
in0Add21216 = tf.constant([[[0.5247], [0.8638]]])
in1Add21216 = tf.constant([[[0.3695], [0.8983]]])
in0Con82993 = tf.constant([[[0.043, 0.3791], [0.1835, 0.8356]]])
in0Con58305 = tf.constant([[[0.9877], [0.5304]]])
print (np.array2string(model.predict([in0Ave8460,in0Con92088,in0Max89384,in1Max89384,in0Ave24005,in0Add21216,in1Add21216,in0Con82993,in0Con58305],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add94970.png')

LAve8460 = average_pooling1D_layer([[[1.2715]]], 1, Ave8460), 
LRes29853 = reshape_layer(Ave8460, [1, 1, 1], Res29853), 
LRes75683 = reshape_layer(Res29853, [1, 1, 1, 1], Res75683), 
LZer29057 = zero_padding3D_layer(Res75683, 1, 0, 1, 0, 0, 0, Zer29057), 
LCon92088 = concatenate_layer([Zer29057,[[[[[0.8993]], [[0.7731]]], [[[0.2158]], [[0.0543]]]]]], 4, Con92088), 
LMax89384 = maximum_layer([[[[[[0.7011, 0.1277]], [[0.6417, 0.5241]]], [[[0.6564, 0.1702]], [[0.4755, 0.0034]]]]], [[[[[0.5638, 0.6325]], [[0.2297, 0.5333]]], [[[0.4507, 0.4157]], [[0.5006, 0.8427]]]]]], Max89384), 
LELU12347 = elu_layer(Max89384, -0.6727721121232495, ELU12347), 
LMul14426 = multiply_layer([Con92088,ELU12347], Mul14426), 
LRes14189 = reshape_layer(Mul14426, [2, 2, 2], Res14189), 
LRes61180 = reshape_layer(Res14189, [2, 4], Res61180), 
LAve24005 = average_pooling1D_layer([[[1.026, 1.3654], [1.5428, 1.4533]]], 1, 2, false, Ave24005), 
LRes89632 = reshape_layer(Ave24005, [1, 2, 1], Res89632), 
LSep13839 = separable_conv2D_layer(Res89632, 1, 2,[[[[[0.3237]], [[0.2169]]]],[[[[0.0647, 0.3419, 0.2922]]]]],[0, 0, 0], 1, 1, false, Sep13839), 
LRes82267 = reshape_layer(Sep13839, [1, 3], Res82267), 
LZer66339 = zero_padding1D_layer(Res82267, 1, 0, Zer66339), 
LAdd21216 = add_layer([[[[0.5247], [0.8638]]], [[[0.3695], [0.8983]]]], Add21216), 
LCon82993 = concatenate_layer([Add21216,[[[0.043, 0.3791], [0.1835, 0.8356]]]], 2, Con82993), 
LMin15473 = minimum_layer([Zer66339,Con82993], Min15473), 
LCon58305 = concatenate_layer([Min15473,[[[0.9877], [0.5304]]]], 2, Con58305), 
LAdd94970 = add_layer([Res61180,Con58305], Add94970), 
exec_layers([LAve8460,LRes29853,LRes75683,LZer29057,LCon92088,LMax89384,LELU12347,LMul14426,LRes14189,LRes61180,LAve24005,LRes89632,LSep13839,LRes82267,LZer66339,LAdd21216,LCon82993,LMin15473,LCon58305,LAdd94970],["Ave8460","Res29853","Res75683","Zer29057","Con92088","Max89384","ELU12347","Mul14426","Res14189","Res61180","Ave24005","Res89632","Sep13839","Res82267","Zer66339","Add21216","Con82993","Min15473","Con58305","Add94970"],Add94970,"Add94970")

Actual (Unparsed): [[[0.0000000, 0.5688072, 0.0000000, 1.3999942], [0.0406492, 0.2732081, 0.8200938, 0.5761586]]]

Expected (Unparsed): [[[0.0,0.56880725,0.0,1.39999423],[0.040649163461999996,0.27320806,0.8200938206120001,0.57615861]]]

Actual:   [[[0, 0.5689, 0, 1.4], [0.0407, 0.2733, 0.8201, 0.5762]]]

Expected: [[[0, 0.5689, 0, 1.4], [0.0407, 0.2733, 0.8201, 0.5762]]]