import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc71961 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave90303 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave90303 = tf.keras.layers.Input(shape=([1, 1]))
in0Con3301 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave81661 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave81661 = tf.keras.layers.Input(shape=([1, 2]))

Loc71961 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc71961', )(in0Loc71961)
Ave90303 = keras.layers.Average(name = 'Ave90303', )([in0Ave90303,in1Ave90303])
Con3301 = keras.layers.Concatenate(axis=2, name = 'Con3301', )([Ave90303,in0Con3301])
Ave81661 = keras.layers.Average(name = 'Ave81661', )([in0Ave81661,in1Ave81661])
Mul19645 = keras.layers.Multiply(name = 'Mul19645', )([Con3301,Ave81661])
Cro18288 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro18288', )(Mul19645)
Dot17966 = keras.layers.Dot(axes=(1, 1), name = 'Dot17966', )([Loc71961,Cro18288])
model = tf.keras.models.Model(inputs=[in0Loc71961,in0Ave90303,in1Ave90303,in0Con3301,in0Ave81661,in1Ave81661], outputs=Dot17966)
w = model.get_layer('Loc71961').get_weights() 
w[0] = np.array([[[0.3105, 0.5362, 0.9543]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc71961').set_weights(w) 
in0Loc71961 = tf.constant([[[0.7853]]])
in0Ave90303 = tf.constant([[[0.1018]]])
in1Ave90303 = tf.constant([[[0.9847]]])
in0Con3301 = tf.constant([[[0.3198]]])
in0Ave81661 = tf.constant([[[0.5229, 0.7738]]])
in1Ave81661 = tf.constant([[[0.4497, 0.3438]]])
print (np.array2string(model.predict([in0Loc71961,in0Ave90303,in1Ave90303,in0Con3301,in0Ave81661,in1Ave81661],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot17966.png')

LLoc71961 = locally_connected1D_layer([[[0.7853]]], 1,[[[0.3105, 0.5362, 0.9543]]],[[0, 0, 0]], 1, Loc71961), 
LAve90303 = average_layer([[[[0.1018]]], [[[0.9847]]]], Ave90303), 
LCon3301 = concatenate_layer([Ave90303,[[[0.3198]]]], 2, Con3301), 
LAve81661 = average_layer([[[[0.5229, 0.7738]]], [[[0.4497, 0.3438]]]], Ave81661), 
LMul19645 = multiply_layer([Con3301,Ave81661], Mul19645), 
LCro18288 = cropping1D_layer(Mul19645, 0, 0, Cro18288), 
LDot17966 = dot_layer(Loc71961,Cro18288, 1, 1, Dot17966), 
exec_layers([LLoc71961,LAve90303,LCon3301,LAve81661,LMul19645,LCro18288,LDot17966],["Loc71961","Ave90303","Con3301","Ave81661","Mul19645","Cro18288","Dot17966"],Dot17966,"Dot17966")

Actual (Unparsed): [[[0.0644171, 0.0435745], [0.1112414, 0.0752484], [0.1979815, 0.1339231]]]

Expected (Unparsed): [[[0.06441710551023375,0.043574464518156],[0.11124139122250352,0.0752483989521264],[0.19798146147638027,0.1339230643789896]]]

Actual:   [[[0.0645, 0.0436], [0.1113, 0.0753], [0.198, 0.134]]]

Expected: [[[0.0645, 0.0436], [0.1113, 0.0753], [0.198, 0.134]]]