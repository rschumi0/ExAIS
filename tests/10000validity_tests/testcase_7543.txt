import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave26259 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave26259 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Ave26259 = keras.layers.Average(name = 'Ave26259', )([in0Ave26259,in1Ave26259])
Res47061 = keras.layers.Reshape((1, 1, 2), name = 'Res47061', )(Ave26259)
Dep20347 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep20347', )(Res47061)
Res55601 = keras.layers.Reshape((1, 2), name = 'Res55601', )(Dep20347)
Loc98128 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc98128', )(Res55601)
LST37080 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST37080', )(Loc98128)
Sof41054 = keras.layers.Softmax(axis=1, name = 'Sof41054', )(LST37080)
model = tf.keras.models.Model(inputs=[in0Ave26259,in1Ave26259], outputs=Sof41054)
w = model.get_layer('Dep20347').get_weights() 
w[0] = np.array([[[[0.7964], [0.2496]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep20347').set_weights(w) 
w = model.get_layer('Loc98128').get_weights() 
w[0] = np.array([[[0.2038, 0.1201, 0.3233], [0.9069, 0.7044, 0.6419]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc98128').set_weights(w) 
w = model.get_layer('LST37080').get_weights() 
w[0] = np.array([[4, 9, 8, 9, 8, 7, 8, 6], [9, 3, 3, 4, 6, 2, 6, 2], [5, 5, 6, 4, 5, 8, 4, 1]])
w[1] = np.array([[10, 7, 1, 10, 4, 1, 3, 2], [10, 3, 9, 6, 9, 6, 5, 10]])
w[2] = np.array([10, 2, 1, 9, 4, 2, 10, 5])
model.get_layer('LST37080').set_weights(w) 
in0Ave26259 = tf.constant([[[[[0.2958], [0.6665]]]]])
in1Ave26259 = tf.constant([[[[[0.2739], [0.877]]]]])
print (np.array2string(model.predict([in0Ave26259,in1Ave26259],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof41054.png')

LAve26259 = average_layer([[[[[[0.2958], [0.6665]]]]], [[[[[0.2739], [0.877]]]]]], Ave26259), 
LRes47061 = reshape_layer(Ave26259, [1, 1, 2], Res47061), 
LDep20347 = depthwise_conv2D_layer(Res47061, 1, 1,[[[[0.7964], [0.2496]]]],[0, 0], 1, 1, true, Dep20347), 
LRes55601 = reshape_layer(Dep20347, [1, 2], Res55601), 
LLoc98128 = locally_connected1D_layer(Res55601, 1,[[[0.2038, 0.1201, 0.3233], [0.9069, 0.7044, 0.6419]]],[[0, 0, 0]], 1, Loc98128), 
LLST37080 = lstm_layer(Loc98128,[[4, 9, 8, 9, 8, 7, 8, 6], [9, 3, 3, 4, 6, 2, 6, 2], [5, 5, 6, 4, 5, 8, 4, 1]],[[10, 7, 1, 10, 4, 1, 3, 2], [10, 3, 9, 6, 9, 6, 5, 10]],[10, 2, 1, 9, 4, 2, 10, 5], LST37080), 
LSof41054 = softmax_layer(LST37080, 1, Sof41054), 
exec_layers([LAve26259,LRes47061,LDep20347,LRes55601,LLoc98128,LLST37080,LSof41054],["Ave26259","Res47061","Dep20347","Res55601","Loc98128","LST37080","Sof41054"],Sof41054,"Sof41054")

Actual (Unparsed): [[0.5006500, 0.4993500]]

Expected (Unparsed): [[0.5006499857801395,0.4993500142198604]]

Actual:   [[0.5007, 0.4994]]

Expected: [[0.5007, 0.4994]]