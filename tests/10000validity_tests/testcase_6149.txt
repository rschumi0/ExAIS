import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min75288 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min75288 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con41461 = tf.keras.layers.Input(shape=([1]))
in0GRU20818 = tf.keras.layers.Input(shape=([1, 1]))
in0Con87204 = tf.keras.layers.Input(shape=([1, 2]))
in0Max40362 = tf.keras.layers.Input(shape=([1, 1]))
in1Max40362 = tf.keras.layers.Input(shape=([1, 1]))
in0Con83542 = tf.keras.layers.Input(shape=([1, 2]))
in0Dot54260 = tf.keras.layers.Input(shape=([2]))
in1Dot54260 = tf.keras.layers.Input(shape=([2]))

Min75288 = keras.layers.Minimum(name = 'Min75288', )([in0Min75288,in1Min75288])
Res25211 = keras.layers.Reshape((2, 1), name = 'Res25211', )(Min75288)
Cro45875 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro45875', )(Res25211)
Fla23884 = keras.layers.Flatten(name = 'Fla23884', )(Cro45875)
Con41461 = keras.layers.Concatenate(axis=1, name = 'Con41461', )([Fla23884,in0Con41461])
GRU20818 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU20818', )(in0GRU20818)
ELU52023 = keras.layers.ELU(alpha=-8.20839486109189, name = 'ELU52023', )(GRU20818)
Sub27610 = keras.layers.Subtract(name = 'Sub27610', )([Con41461,ELU52023])
Res21722 = keras.layers.Reshape((2, 1), name = 'Res21722', )(Sub27610)
Cro76517 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro76517', )(Res21722)
Con87204 = keras.layers.Concatenate(axis=2, name = 'Con87204', )([Cro76517,in0Con87204])
Max40362 = keras.layers.Maximum(name = 'Max40362', )([in0Max40362,in1Max40362])
Con83542 = keras.layers.Concatenate(axis=2, name = 'Con83542', )([Max40362,in0Con83542])
Dot54260 = keras.layers.Dot(axes=(1, 1), name = 'Dot54260', )([in0Dot54260,in1Dot54260])
Res9835 = keras.layers.Reshape((1, 1), name = 'Res9835', )(Dot54260)
Sep32597 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep32597', )(Res9835)
Max39537 = keras.layers.Maximum(name = 'Max39537', )([Con83542,Sep32597])
Max15534 = keras.layers.Maximum(name = 'Max15534', )([Con87204,Max39537])
model = tf.keras.models.Model(inputs=[in0Min75288,in1Min75288,in0Con41461,in0GRU20818,in0Con87204,in0Max40362,in1Max40362,in0Con83542,in0Dot54260,in1Dot54260], outputs=Max15534)
w = model.get_layer('GRU20818').get_weights() 
w[0] = np.array([[3, 9, 4, 3, 3, 9]])
w[1] = np.array([[10, 10, 7, 10, 5, 5], [4, 8, 4, 7, 3, 6]])
w[2] = np.array([1, 1, 2, 9, 6, 9])
model.get_layer('GRU20818').set_weights(w) 
w = model.get_layer('Sep32597').get_weights() 
w[0] = np.array([[[0.0912]]])
w[1] = np.array([[[0.8071, 0.4651, 0.6475]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep32597').set_weights(w) 
in0Min75288 = tf.constant([[[[0.4826]], [[0.3318]]]])
in1Min75288 = tf.constant([[[[0.4328]], [[0.8564]]]])
in0Con41461 = tf.constant([[0.6655]])
in0GRU20818 = tf.constant([[[8]]])
in0Con87204 = tf.constant([[[0.6705, 0.5315]]])
in0Max40362 = tf.constant([[[0.6462]]])
in1Max40362 = tf.constant([[[0.1431]]])
in0Con83542 = tf.constant([[[0.1522, 0.5038]]])
in0Dot54260 = tf.constant([[0.6612, 0.877]])
in1Dot54260 = tf.constant([[0.8956, 0.8246]])
print (np.array2string(model.predict([in0Min75288,in1Min75288,in0Con41461,in0GRU20818,in0Con87204,in0Max40362,in1Max40362,in0Con83542,in0Dot54260,in1Dot54260],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max15534.png')

LMin75288 = minimum_layer([[[[[0.4826]], [[0.3318]]]], [[[[0.4328]], [[0.8564]]]]], Min75288), 
LRes25211 = reshape_layer(Min75288, [2, 1], Res25211), 
LCro45875 = cropping1D_layer(Res25211, 0, 1, Cro45875), 
LFla23884 = flatten_layer(Cro45875, Fla23884), 
LCon41461 = concatenate_layer([Fla23884,[[0.6655]]], 1, Con41461), 
LGRU20818 = gru_layer([[[8]]],[[3, 9, 4, 3, 3, 9]],[[10, 10, 7, 10, 5, 5], [4, 8, 4, 7, 3, 6]],[1, 1, 2, 9, 6, 9], false, GRU20818), 
LELU52023 = elu_layer(GRU20818, -8.20839486109189, ELU52023), 
LSub27610 = subtract_layer(Con41461,ELU52023, Sub27610), 
LRes21722 = reshape_layer(Sub27610, [2, 1], Res21722), 
LCro76517 = cropping1D_layer(Res21722, 1, 0, Cro76517), 
LCon87204 = concatenate_layer([Cro76517,[[[0.6705, 0.5315]]]], 2, Con87204), 
LMax40362 = maximum_layer([[[[0.6462]]], [[[0.1431]]]], Max40362), 
LCon83542 = concatenate_layer([Max40362,[[[0.1522, 0.5038]]]], 2, Con83542), 
LDot54260 = dot_layer([[0.6612, 0.877]], [[0.8956, 0.8246]], 1, 1, Dot54260), 
LRes9835 = reshape_layer(Dot54260, [1, 1], Res9835), 
LSep32597 = separable_conv1D_layer(Res9835, 1,[[[[0.0912]]],[[[0.8071, 0.4651, 0.6475]]]],[0, 0, 0], 1, false, Sep32597), 
LMax39537 = maximum_layer([Con83542,Sep32597], Max39537), 
LMax15534 = maximum_layer([Con87204,Max39537], Max15534), 
exec_layers([LMin75288,LRes25211,LCro45875,LFla23884,LCon41461,LGRU20818,LELU52023,LSub27610,LRes21722,LCro76517,LCon87204,LMax40362,LCon83542,LDot54260,LRes9835,LSep32597,LMax39537,LMax15534],["Min75288","Res25211","Cro45875","Fla23884","Con41461","GRU20818","ELU52023","Sub27610","Res21722","Cro76517","Con87204","Max40362","Con83542","Dot54260","Res9835","Sep32597","Max39537","Max15534"],Max15534,"Max15534")

Actual (Unparsed): [[[0.6655000, 0.6705000, 0.5315000]]]

Expected (Unparsed): [[[0.6655,0.6705,0.5315]]]

Actual:   [[[0.6655, 0.6705, 0.5315]]]

Expected: [[[0.6655, 0.6705, 0.5315]]]