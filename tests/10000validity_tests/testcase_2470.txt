import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo30328 = tf.keras.layers.Input(shape=([1, 2]))

Glo30328 = keras.layers.GlobalMaxPool1D(name = 'Glo30328', )(in0Glo30328)
Res83391 = keras.layers.Reshape((2, 1), name = 'Res83391', )(Glo30328)
Up_58226 = keras.layers.UpSampling1D(size=(2), name = 'Up_58226', )(Res83391)
Res92537 = keras.layers.Reshape((4, 1, 1), name = 'Res92537', )(Up_58226)
PRe91300 = keras.layers.PReLU(name = 'PRe91300', )(Res92537)
model = tf.keras.models.Model(inputs=[in0Glo30328], outputs=PRe91300)
w = model.get_layer('PRe91300').get_weights() 
w[0] = np.array([[[0.3297]], [[0.225]], [[0.3151]], [[0.3219]]])
model.get_layer('PRe91300').set_weights(w) 
in0Glo30328 = tf.constant([[[1.5709, 1.5989]]])
print (np.array2string(model.predict([in0Glo30328],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe91300.png')

LGlo30328 = global_max_pool1D_layer([[[1.5709, 1.5989]]], Glo30328), 
LRes83391 = reshape_layer(Glo30328, [2, 1], Res83391), 
LUp_58226 = up_sampling1D_layer(Res83391, 2, Up_58226), 
LRes92537 = reshape_layer(Up_58226, [4, 1, 1], Res92537), 
LPRe91300 = prelu_layer(Res92537, [[[0.3297]], [[0.225]], [[0.3151]], [[0.3219]]], PRe91300), 
exec_layers([LGlo30328,LRes83391,LUp_58226,LRes92537,LPRe91300],["Glo30328","Res83391","Up_58226","Res92537","PRe91300"],PRe91300,"PRe91300")

Actual (Unparsed): [[[[1.5709000]], [[1.5709000]], [[1.5989000]], [[1.5989000]]]]

Expected (Unparsed): [[[[1.5709]],[[1.5709]],[[1.5989]],[[1.5989]]]]

Actual:   [[[[1.5709]], [[1.5709]], [[1.5989]], [[1.5989]]]]

Expected: [[[[1.5709]], [[1.5709]], [[1.5989]], [[1.5989]]]]