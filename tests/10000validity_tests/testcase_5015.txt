import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave30708 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave30708 = tf.keras.layers.Input(shape=([2, 2]))
in0Con1569 = tf.keras.layers.Input(shape=([3, 1]))
in0Sub33029 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub33029 = tf.keras.layers.Input(shape=([3, 2]))
in0Con37702 = tf.keras.layers.Input(shape=([3, 1]))
in0Sub48177 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub48177 = tf.keras.layers.Input(shape=([3, 3]))

Ave30708 = keras.layers.Average(name = 'Ave30708', )([in0Ave30708,in1Ave30708])
ELU43715 = keras.layers.ELU(alpha=-0.6255481678886845, name = 'ELU43715', )(Ave30708)
Res42190 = keras.layers.Reshape((2, 2, 1), name = 'Res42190', )(ELU43715)
PRe80181 = keras.layers.PReLU(name = 'PRe80181', )(Res42190)
Res62075 = keras.layers.Reshape((2, 2), name = 'Res62075', )(PRe80181)
Zer51735 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer51735', )(Res62075)
Con1569 = keras.layers.Concatenate(axis=2, name = 'Con1569', )([Zer51735,in0Con1569])
Sub33029 = keras.layers.Subtract(name = 'Sub33029', )([in0Sub33029,in1Sub33029])
Con37702 = keras.layers.Concatenate(axis=2, name = 'Con37702', )([Sub33029,in0Con37702])
Sub48177 = keras.layers.Subtract(name = 'Sub48177', )([in0Sub48177,in1Sub48177])
Max66103 = keras.layers.Maximum(name = 'Max66103', )([Con37702,Sub48177])
Mul63680 = keras.layers.Multiply(name = 'Mul63680', )([Con1569,Max66103])
model = tf.keras.models.Model(inputs=[in0Ave30708,in1Ave30708,in0Con1569,in0Sub33029,in1Sub33029,in0Con37702,in0Sub48177,in1Sub48177], outputs=Mul63680)
w = model.get_layer('PRe80181').get_weights() 
w[0] = np.array([[[0.1069], [0.6188]], [[0.7801], [0.9408]]])
model.get_layer('PRe80181').set_weights(w) 
in0Ave30708 = tf.constant([[[0.06, 0.0888], [0.073, 0.2256]]])
in1Ave30708 = tf.constant([[[0.3108, 0.0943], [0.2703, 0.3631]]])
in0Con1569 = tf.constant([[[0.6218], [0.1759], [0.3627]]])
in0Sub33029 = tf.constant([[[0.1644, 0.1513], [0.5655, 0.6958], [0.7829, 0.3106]]])
in1Sub33029 = tf.constant([[[0.693, 0.9283], [0.0042, 0.1697], [0.964, 0.0908]]])
in0Con37702 = tf.constant([[[0.8717], [0.567], [0.8649]]])
in0Sub48177 = tf.constant([[[0.0455, 0.2308, 0.4319], [0.1732, 0.1641, 0.7821], [0.6687, 0.4712, 0.3324]]])
in1Sub48177 = tf.constant([[[0.079, 0.6479, 0.0676], [0.8101, 0.1561, 0.0786], [0.0702, 0.6087, 0.687]]])
print (np.array2string(model.predict([in0Ave30708,in1Ave30708,in0Con1569,in0Sub33029,in1Sub33029,in0Con37702,in0Sub48177,in1Sub48177],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul63680.png')

LAve30708 = average_layer([[[[0.06, 0.0888], [0.073, 0.2256]]], [[[0.3108, 0.0943], [0.2703, 0.3631]]]], Ave30708), 
LELU43715 = elu_layer(Ave30708, -0.6255481678886845, ELU43715), 
LRes42190 = reshape_layer(ELU43715, [2, 2, 1], Res42190), 
LPRe80181 = prelu_layer(Res42190, [[[0.1069], [0.6188]], [[0.7801], [0.9408]]], PRe80181), 
LRes62075 = reshape_layer(PRe80181, [2, 2], Res62075), 
LZer51735 = zero_padding1D_layer(Res62075, 1, 0, Zer51735), 
LCon1569 = concatenate_layer([Zer51735,[[[0.6218], [0.1759], [0.3627]]]], 2, Con1569), 
LSub33029 = subtract_layer([[[0.1644, 0.1513], [0.5655, 0.6958], [0.7829, 0.3106]]], [[[0.693, 0.9283], [0.0042, 0.1697], [0.964, 0.0908]]], Sub33029), 
LCon37702 = concatenate_layer([Sub33029,[[[0.8717], [0.567], [0.8649]]]], 2, Con37702), 
LSub48177 = subtract_layer([[[0.0455, 0.2308, 0.4319], [0.1732, 0.1641, 0.7821], [0.6687, 0.4712, 0.3324]]], [[[0.079, 0.6479, 0.0676], [0.8101, 0.1561, 0.0786], [0.0702, 0.6087, 0.687]]], Sub48177), 
LMax66103 = maximum_layer([Con37702,Sub48177], Max66103), 
LMul63680 = multiply_layer([Con1569,Max66103], Mul63680), 
exec_layers([LAve30708,LELU43715,LRes42190,LPRe80181,LRes62075,LZer51735,LCon1569,LSub33029,LCon37702,LSub48177,LMax66103,LMul63680],["Ave30708","ELU43715","Res42190","PRe80181","Res62075","Zer51735","Con1569","Sub33029","Con37702","Sub48177","Max66103","Mul63680"],Mul63680,"Mul63680")

Actual (Unparsed): [[[-0.0000000, -0.0000000, 0.5420231], [0.1040650, 0.0481645, 0.1237457], [0.1027325, 0.0646981, 0.3136992]]]

Expected (Unparsed): [[[-0.0,-0.0,0.54202306],[0.10406502000000001,0.048164454999999995,0.12374565],[0.10273252499999999,0.06469812999999999,0.31369923]]]

Actual:   [[[-0, -0, 0.5421], [0.1041, 0.0482, 0.1238], [0.1028, 0.0647, 0.3137]]]

Expected: [[[-0, -0, 0.5421], [0.1041, 0.0482, 0.1238], [0.1028, 0.0647, 0.3137]]]