import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min80307 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Min80307 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0PRe68542 = tf.keras.layers.Input(shape=([2, 2]))

Min80307 = keras.layers.Minimum(name = 'Min80307', )([in0Min80307,in1Min80307])
Res5233 = keras.layers.Reshape((2, 2, 2), name = 'Res5233', )(Min80307)
Res97590 = keras.layers.Reshape((2, 4), name = 'Res97590', )(Res5233)
PRe68542 = keras.layers.PReLU(name = 'PRe68542', input_shape=(2, 2))(in0PRe68542)
Den93559 = keras.layers.Dense(2,name = 'Den93559', )(PRe68542)
Thr55102 = keras.layers.ThresholdedReLU(theta=7.597717750093573, name = 'Thr55102', )(Den93559)
Dot85235 = keras.layers.Dot(axes=(1, 1), name = 'Dot85235', )([Res97590,Thr55102])
model = tf.keras.models.Model(inputs=[in0Min80307,in1Min80307,in0PRe68542], outputs=Dot85235)
w = model.get_layer('PRe68542').get_weights() 
w[0] = np.array([[0.2531, 0.7953], [0.13, 0.0921]])
model.get_layer('PRe68542').set_weights(w) 
w = model.get_layer('Den93559').get_weights() 
w[0] = np.array([[0.4816, 0.462], [0.7066, 0.7886]])
w[1] = np.array([0.4052, 0.5814])
model.get_layer('Den93559').set_weights(w) 
in0Min80307 = tf.constant([[[[[0.4643, 0.8329]], [[0.6001, 0.4717]]], [[[0.8897, 0.2266]], [[0.9216, 0.9552]]]]])
in1Min80307 = tf.constant([[[[[0.5453, 0.4253]], [[0.8488, 0.4097]]], [[[0.5258, 0.429]], [[0.1027, 0.9956]]]]])
in0PRe68542 = tf.constant([[[0.6336, 0.2926], [0.5174, 0.3509]]])
print (np.array2string(model.predict([in0Min80307,in1Min80307,in0PRe68542],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot85235.png')

LMin80307 = minimum_layer([[[[[[0.4643, 0.8329]], [[0.6001, 0.4717]]], [[[0.8897, 0.2266]], [[0.9216, 0.9552]]]]], [[[[[0.5453, 0.4253]], [[0.8488, 0.4097]]], [[[0.5258, 0.429]], [[0.1027, 0.9956]]]]]], Min80307), 
LRes5233 = reshape_layer(Min80307, [2, 2, 2], Res5233), 
LRes97590 = reshape_layer(Res5233, [2, 4], Res97590), 
LPRe68542 = prelu_layer([[[0.6336, 0.2926], [0.5174, 0.3509]]], [[0.2531, 0.7953], [0.13, 0.0921]], PRe68542), 
LDen93559 = dense_layer(PRe68542, [[0.4816, 0.462], [0.7066, 0.7886]],[0.4052, 0.5814], Den93559), 
LThr55102 = thresholded_relu_layer(Den93559, 7.597717750093573, Thr55102), 
LDot85235 = dot_layer(Res97590,Thr55102, 1, 1, Dot85235), 
exec_layers([LMin80307,LRes5233,LRes97590,LPRe68542,LDen93559,LThr55102,LDot85235],["Min80307","Res5233","Res97590","PRe68542","Den93559","Thr55102","Dot85235"],Dot85235,"Dot85235")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0],[0.0,0.0],[0.0,0.0],[0.0,0.0]]]

Actual:   [[[0, 0], [0, 0], [0, 0], [0, 0]]]

Expected: [[[0, 0], [0, 0], [0, 0], [0, 0]]]