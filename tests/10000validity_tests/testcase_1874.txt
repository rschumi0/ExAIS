import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max10438 = tf.keras.layers.Input(shape=([1, 1]))
in1Max10438 = tf.keras.layers.Input(shape=([1, 1]))

Max10438 = keras.layers.Maximum(name = 'Max10438', )([in0Max10438,in1Max10438])
Res28129 = keras.layers.Reshape((1, 1, 1), name = 'Res28129', )(Max10438)
Sep82498 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='same', name = 'Sep82498', )(Res28129)
Mas52906 = keras.layers.Masking(mask_value=2, name = 'Mas52906', )(Sep82498)
model = tf.keras.models.Model(inputs=[in0Max10438,in1Max10438], outputs=Mas52906)
w = model.get_layer('Sep82498').get_weights() 
w[0] = np.array([[[[0.0008]]]])
w[1] = np.array([[[[0.1645, 0.7495]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep82498').set_weights(w) 
in0Max10438 = tf.constant([[[0.0244]]])
in1Max10438 = tf.constant([[[0.9293]]])
print (np.array2string(model.predict([in0Max10438,in1Max10438],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas52906.png')

LMax10438 = maximum_layer([[[[0.0244]]], [[[0.9293]]]], Max10438), 
LRes28129 = reshape_layer(Max10438, [1, 1, 1], Res28129), 
LSep82498 = separable_conv2D_layer(Res28129, 1, 1,[[[[[0.0008]]]],[[[[0.1645, 0.7495]]]]],[0, 0], 1, 1, true, Sep82498), 
LMas52906 = masking_layer(Sep82498, 2, Mas52906), 
exec_layers([LMax10438,LRes28129,LSep82498,LMas52906],["Max10438","Res28129","Sep82498","Mas52906"],Mas52906,"Mas52906")

Actual (Unparsed): [[[[0.0001223, 0.0005572]]]]

Expected (Unparsed): [[[[0.00012229588,0.0005572082800000001]]]]

Actual:   [[[[0.0002, 0.0006]]]]

Expected: [[[[0.0002, 0.0006]]]]