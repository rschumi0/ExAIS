import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max95079 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Max95079 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Max95079 = keras.layers.Maximum(name = 'Max95079', )([in0Max95079,in1Max95079])
Bat43524 = keras.layers.BatchNormalization(axis=1, epsilon=0.26853942424063926,  name = 'Bat43524', )(Max95079)
model = tf.keras.models.Model(inputs=[in0Max95079,in1Max95079], outputs=Bat43524)
w = model.get_layer('Bat43524').get_weights() 
w[0] = np.array([0.2454, 0.3878])
w[1] = np.array([0.7939, 0.7295])
w[2] = np.array([0.8832, 0.4498])
w[3] = np.array([0.1297, 0.0646])
model.get_layer('Bat43524').set_weights(w) 
in0Max95079 = tf.constant([[[[[0.3043]], [[0.7653]]], [[[0.5067]], [[0.6007]]]]])
in1Max95079 = tf.constant([[[[[0.622]], [[0.1924]]], [[[0.1701]], [[0.6752]]]]])
print (np.array2string(model.predict([in0Max95079,in1Max95079],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat43524.png')

LMax95079 = maximum_layer([[[[[[0.3043]], [[0.7653]]], [[[0.5067]], [[0.6007]]]]], [[[[[0.622]], [[0.1924]]], [[[0.1701]], [[0.6752]]]]]], Max95079), 
LBat43524 = batch_normalization_layer(Max95079, 1, 0.26853942424063926, [0.2454, 0.3878], [0.7939, 0.7295], [0.8832, 0.4498], [0.1297, 0.0646], Bat43524), 
exec_layers([LMax95079,LBat43524],["Max95079","Bat43524"],Bat43524,"Bat43524")

Actual (Unparsed): [[[[[0.6923276]], [[0.7480524]]], [[[0.7677302]], [[0.8809428]]]]]

Expected (Unparsed): [[[[[0.6923276254883509]],[[0.7480524389168323]]],[[[0.7677302427558405]],[[0.8809428245547701]]]]]

Actual:   [[[[[0.6924]], [[0.7481]]], [[[0.7678]], [[0.881]]]]]

Expected: [[[[[0.6924]], [[0.7481]]], [[[0.7678]], [[0.881]]]]]