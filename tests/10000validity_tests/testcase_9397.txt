import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min96410 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Min96410 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0PRe24030 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con16936 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Ave40828 = tf.keras.layers.Input(shape=([2, 1]))
in0Con39565 = tf.keras.layers.Input(shape=([2, 1]))

Min96410 = keras.layers.Minimum(name = 'Min96410', )([in0Min96410,in1Min96410])
Zer22777 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer22777', )(Min96410)
PRe24030 = keras.layers.PReLU(name = 'PRe24030', input_shape=(2, 1, 1))(in0PRe24030)
Con16936 = keras.layers.Concatenate(axis=3, name = 'Con16936', )([PRe24030,in0Con16936])
Max27697 = keras.layers.Maximum(name = 'Max27697', )([Zer22777,Con16936])
Lea55460 = keras.layers.LeakyReLU(alpha=9.599118068359497, name = 'Lea55460', )(Max27697)
Res79689 = keras.layers.Reshape((2, 2), name = 'Res79689', )(Lea55460)
Ave40828 = keras.layers.AveragePooling1D(pool_size=(2), strides=(2), padding='same', name = 'Ave40828', )(in0Ave40828)
Zer64923 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer64923', )(Ave40828)
Con39565 = keras.layers.Concatenate(axis=2, name = 'Con39565', )([Zer64923,in0Con39565])
Max64778 = keras.layers.Maximum(name = 'Max64778', )([Res79689,Con39565])
model = tf.keras.models.Model(inputs=[in0Min96410,in1Min96410,in0PRe24030,in0Con16936,in0Ave40828,in0Con39565], outputs=Max64778)
w = model.get_layer('PRe24030').get_weights() 
w[0] = np.array([[[0.1504]], [[0.2438]]])
model.get_layer('PRe24030').set_weights(w) 
in0Min96410 = tf.constant([[[[0.7204, 0.4978]]]])
in1Min96410 = tf.constant([[[[0.9826, 0.7186]]]])
in0PRe24030 = tf.constant([[[[0.7818]], [[0.615]]]])
in0Con16936 = tf.constant([[[[0.4353]], [[0.4847]]]])
in0Ave40828 = tf.constant([[[1.1808], [1.6354]]])
in0Con39565 = tf.constant([[[0.5061], [0.9664]]])
print (np.array2string(model.predict([in0Min96410,in1Min96410,in0PRe24030,in0Con16936,in0Ave40828,in0Con39565],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max64778.png')

LMin96410 = minimum_layer([[[[[0.7204, 0.4978]]]], [[[[0.9826, 0.7186]]]]], Min96410), 
LZer22777 = zero_padding2D_layer(Min96410, 1, 0, 0, 0, Zer22777), 
LPRe24030 = prelu_layer([[[[0.7818]], [[0.615]]]], [[[0.1504]], [[0.2438]]], PRe24030), 
LCon16936 = concatenate_layer([PRe24030,[[[[0.4353]], [[0.4847]]]]], 3, Con16936), 
LMax27697 = maximum_layer([Zer22777,Con16936], Max27697), 
LLea55460 = leaky_relu_layer(Max27697, 9.599118068359497, Lea55460), 
LRes79689 = reshape_layer(Lea55460, [2, 2], Res79689), 
LAve40828 = average_pooling1D_layer([[[1.1808], [1.6354]]], 2, 2, true, Ave40828), 
LZer64923 = zero_padding1D_layer(Ave40828, 1, 0, Zer64923), 
LCon39565 = concatenate_layer([Zer64923,[[[0.5061], [0.9664]]]], 2, Con39565), 
LMax64778 = maximum_layer([Res79689,Con39565], Max64778), 
exec_layers([LMin96410,LZer22777,LPRe24030,LCon16936,LMax27697,LLea55460,LRes79689,LAve40828,LZer64923,LCon39565,LMax64778],["Min96410","Zer22777","PRe24030","Con16936","Max27697","Lea55460","Res79689","Ave40828","Zer64923","Con39565","Max64778"],Max64778,"Max64778")

Actual (Unparsed): [[[0.7818000, 0.5061000], [1.4081000, 0.9664000]]]

Expected (Unparsed): [[[0.7818,0.5061],[1.4081000000000001,0.9664]]]

Actual:   [[[0.7818, 0.5061], [1.4081, 0.9664]]]

Expected: [[[0.7818, 0.5061], [1.4082, 0.9664]]]