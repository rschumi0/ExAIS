import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep29421 = tf.keras.layers.Input(shape=([2, 2, 2]))

Sep29421 = keras.layers.SeparableConv2D(4, (1, 2),strides=(2, 2), padding='same', name = 'Sep29421', )(in0Sep29421)
Res9576 = keras.layers.Reshape((1, 4), name = 'Res9576', )(Sep29421)
Max18391 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='valid', name = 'Max18391', )(Res9576)
model = tf.keras.models.Model(inputs=[in0Sep29421], outputs=Max18391)
w = model.get_layer('Sep29421').get_weights() 
w[0] = np.array([[[[0.1649], [0.1226]], [[0.1201], [0.3878]]]])
w[1] = np.array([[[[0.9759, 0.237, 0.8667, 0.0643], [0.3152, 0.5702, 0.9206, 0.4206]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep29421').set_weights(w) 
in0Sep29421 = tf.constant([[[[0.3754, 0.3833], [0.9261, 0.6204]], [[0.2841, 0.5135], [0.2827, 0.9995]]]])
print (np.array2string(model.predict([in0Sep29421],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max18391.png')

LSep29421 = separable_conv2D_layer([[[[0.3754, 0.3833], [0.9261, 0.6204]], [[0.2841, 0.5135], [0.2827, 0.9995]]]], 1, 2,[[[[[0.1649], [0.1226]], [[0.1201], [0.3878]]]],[[[[0.9759, 0.237, 0.8667, 0.0643], [0.3152, 0.5702, 0.9206, 0.4206]]]]],[0, 0, 0, 0], 2, 2, true, Sep29421), 
LRes9576 = reshape_layer(Sep29421, [1, 4], Res9576), 
LMax18391 = max_pool1D_layer(Res9576, 1, 1, false, Max18391), 
exec_layers([LSep29421,LRes9576,LMax18391],["Sep29421","Res9576","Max18391"],Max18391,"Max18391")

Actual (Unparsed): [[[0.2596021, 0.2050116, 0.4147997, 0.1320898]]]

Expected (Unparsed): [[[0.259602065753,0.20501157833,0.41479965248899997,0.13208983912099997]]]

Actual:   [[[0.2597, 0.2051, 0.4148, 0.1321]]]

Expected: [[[0.2597, 0.2051, 0.4148, 0.1321]]]