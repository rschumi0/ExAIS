import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave41247 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Dot4386 = tf.keras.layers.Input(shape=([3]))
in1Dot4386 = tf.keras.layers.Input(shape=([3]))
in0Con14925 = tf.keras.layers.Input(shape=([2]))

Ave41247 = keras.layers.AveragePooling2D(pool_size=(2, 1), strides=(2, 4), padding='valid', name = 'Ave41247', )(in0Ave41247)
Res56569 = keras.layers.Reshape((1, 1), name = 'Res56569', )(Ave41247)
Sim66801 = keras.layers.SimpleRNN(3,name = 'Sim66801', )(Res56569)
Dot4386 = keras.layers.Dot(axes=(1, 1), name = 'Dot4386', )([in0Dot4386,in1Dot4386])
Lea3311 = keras.layers.LeakyReLU(alpha=7.70696950371857, name = 'Lea3311', )(Dot4386)
Res13664 = keras.layers.Reshape((1, 1), name = 'Res13664', )(Lea3311)
Res64373 = keras.layers.Reshape((1, 1, 1), name = 'Res64373', )(Res13664)
Res13799 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res13799', )(Res64373)
Glo27485 = keras.layers.GlobalAveragePooling3D(name = 'Glo27485', )(Res13799)
Con14925 = keras.layers.Concatenate(axis=1, name = 'Con14925', )([Glo27485,in0Con14925])
Ave11434 = keras.layers.Average(name = 'Ave11434', )([Sim66801,Con14925])
model = tf.keras.models.Model(inputs=[in0Ave41247,in0Dot4386,in1Dot4386,in0Con14925], outputs=Ave11434)
w = model.get_layer('Sim66801').get_weights() 
w[0] = np.array([[10, 4, 4]])
w[1] = np.array([[2, 9, 1], [10, 5, 4], [10, 10, 1]])
w[2] = np.array([4, 10, 9])
model.get_layer('Sim66801').set_weights(w) 
in0Ave41247 = tf.constant([[[[1.771]], [[1.2652]]]])
in0Dot4386 = tf.constant([[0.7438, 0.3626, 0.6168]])
in1Dot4386 = tf.constant([[0.8315, 0.1531, 0.9085]])
in0Con14925 = tf.constant([[0.6131, 0.5814]])
print (np.array2string(model.predict([in0Ave41247,in0Dot4386,in1Dot4386,in0Con14925],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave11434.png')

LAve41247 = average_pooling2D_layer([[[[1.771]], [[1.2652]]]], 2, 1, 2, 4, false, Ave41247), 
LRes56569 = reshape_layer(Ave41247, [1, 1], Res56569), 
LSim66801 = simple_rnn_layer(Res56569,[[10, 4, 4]],[[2, 9, 1], [10, 5, 4], [10, 10, 1]],[4, 10, 9], Sim66801), 
LDot4386 = dot_layer([[0.7438, 0.3626, 0.6168]], [[0.8315, 0.1531, 0.9085]], 1, 1, Dot4386), 
LLea3311 = leaky_relu_layer(Dot4386, 7.70696950371857, Lea3311), 
LRes13664 = reshape_layer(Lea3311, [1, 1], Res13664), 
LRes64373 = reshape_layer(Res13664, [1, 1, 1], Res64373), 
LRes13799 = reshape_layer(Res64373, [1, 1, 1, 1], Res13799), 
LGlo27485 = global_average_pooling3D_layer(Res13799, Glo27485), 
LCon14925 = concatenate_layer([Glo27485,[[0.6131, 0.5814]]], 1, Con14925), 
LAve11434 = average_layer([Sim66801,Con14925], Ave11434), 
exec_layers([LAve41247,LRes56569,LSim66801,LDot4386,LLea3311,LRes13664,LRes64373,LRes13799,LGlo27485,LCon14925,LAve11434],["Ave41247","Res56569","Sim66801","Dot4386","Lea3311","Res13664","Res64373","Res13799","Glo27485","Con14925","Ave11434"],Ave11434,"Ave11434")

Actual (Unparsed): [[1.1171733, 0.8065500, 0.7907000]]

Expected (Unparsed): [[1.11717328,0.806549999999989,0.7906999999999191]]

Actual:   [[1.1172, 0.8066, 0.7907]]

Expected: [[1.1172, 0.8066, 0.7907]]