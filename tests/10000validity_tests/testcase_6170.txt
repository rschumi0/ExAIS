import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den80904 = tf.keras.layers.Input(shape=([4, 3]))

Den80904 = keras.layers.Dense(3,name = 'Den80904', )(in0Den80904)
Res43800 = keras.layers.Reshape((4, 3, 1), name = 'Res43800', )(Den80904)
Max42016 = keras.layers.MaxPool2D(pool_size=(2, 2), strides=(1, 6), padding='same', name = 'Max42016', )(Res43800)
Lay64984 = keras.layers.LayerNormalization(axis=1, epsilon=2.399208094640491, name = 'Lay64984', )(Max42016)
Res18875 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res18875', )(Lay64984)
PRe26036 = keras.layers.PReLU(name = 'PRe26036', )(Res18875)
Res25453 = keras.layers.Reshape((4, 1, 1), name = 'Res25453', )(PRe26036)
Glo19723 = keras.layers.GlobalMaxPool2D(name = 'Glo19723', )(Res25453)
model = tf.keras.models.Model(inputs=[in0Den80904], outputs=Glo19723)
w = model.get_layer('Den80904').get_weights() 
w[0] = np.array([[0.2298, 0.5227, 0.4166], [0.8657, 0.6147, 0.7784], [0.8307, 0.7435, 0.307]])
w[1] = np.array([0.384, 0.5935, 0.5095])
model.get_layer('Den80904').set_weights(w) 
w = model.get_layer('PRe26036').get_weights() 
w[0] = np.array([[[[0.4841]]], [[[0.9743]]], [[[0.7845]]], [[[0.7107]]]])
model.get_layer('PRe26036').set_weights(w) 
in0Den80904 = tf.constant([[[0.9487, 0.9869, 0.6781], [0.9168, 0.5393, 0.7483], [0.3742, 0.0897, 0.5371], [0.1118, 0.5075, 0.9465]]])
print (np.array2string(model.predict([in0Den80904],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo19723.png')

LDen80904 = dense_layer([[[0.9487, 0.9869, 0.6781], [0.9168, 0.5393, 0.7483], [0.3742, 0.0897, 0.5371], [0.1118, 0.5075, 0.9465]]], [[0.2298, 0.5227, 0.4166], [0.8657, 0.6147, 0.7784], [0.8307, 0.7435, 0.307]],[0.384, 0.5935, 0.5095], Den80904), 
LRes43800 = reshape_layer(Den80904, [4, 3, 1], Res43800), 
LMax42016 = max_pool2D_layer(Res43800, 2, 2, 1, 6, true, Max42016), 
LLay64984 = layer_normalization_layer(Max42016, 1, 2.399208094640491, Lay64984), 
LRes18875 = reshape_layer(Lay64984, [4, 1, 1, 1], Res18875), 
LPRe26036 = prelu_layer(Res18875, [[[[0.4841]]], [[[0.9743]]], [[[0.7845]]], [[[0.7107]]]], PRe26036), 
LRes25453 = reshape_layer(PRe26036, [4, 1, 1], Res25453), 
LGlo19723 = global_max_pool2D_layer(Res25453, Glo19723), 
exec_layers([LDen80904,LRes43800,LMax42016,LLay64984,LRes18875,LPRe26036,LRes25453,LGlo19723],["Den80904","Res43800","Max42016","Lay64984","Res18875","PRe26036","Res25453","Glo19723"],Glo19723,"Glo19723")

Actual (Unparsed): [[0.2084416]]

Expected (Unparsed): [[0.20844157301935393]]

Actual:   [[0.2085]]

Expected: [[0.2085]]