import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla41973 = tf.keras.layers.Input(shape=([2, 1]))
in0Con98143 = tf.keras.layers.Input(shape=([4, 1]))
in0Ave81021 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave81021 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Add82211 = tf.keras.layers.Input(shape=([1, 2]))
in1Add82211 = tf.keras.layers.Input(shape=([1, 2]))
in0Up_22063 = tf.keras.layers.Input(shape=([2, 2]))
in0Con56891 = tf.keras.layers.Input(shape=([4, 1]))
in0Dot21721 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot21721 = tf.keras.layers.Input(shape=([2, 3]))

Fla41973 = keras.layers.Flatten(name = 'Fla41973', )(in0Fla41973)
Res35980 = keras.layers.Reshape((2, 1), name = 'Res35980', )(Fla41973)
Zer49930 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer49930', )(Res35980)
Con98143 = keras.layers.Concatenate(axis=2, name = 'Con98143', )([Zer49930,in0Con98143])
Ave81021 = keras.layers.Average(name = 'Ave81021', )([in0Ave81021,in1Ave81021])
Res4080 = keras.layers.Reshape((1, 2), name = 'Res4080', )(Ave81021)
Add82211 = keras.layers.Add(name = 'Add82211', )([in0Add82211,in1Add82211])
Max34653 = keras.layers.Maximum(name = 'Max34653', )([Res4080,Add82211])
Zer645 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer645', )(Max34653)
Up_22063 = keras.layers.UpSampling1D(size=(2), name = 'Up_22063', )(in0Up_22063)
Sub58036 = keras.layers.Subtract(name = 'Sub58036', )([Zer645,Up_22063])
Mul44395 = keras.layers.Multiply(name = 'Mul44395', )([Con98143,Sub58036])
Con56891 = keras.layers.Concatenate(axis=2, name = 'Con56891', )([Mul44395,in0Con56891])
Dot21721 = keras.layers.Dot(axes=(1, 1), name = 'Dot21721', )([in0Dot21721,in1Dot21721])
Zer37621 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer37621', )(Dot21721)
Min11082 = keras.layers.Minimum(name = 'Min11082', )([Con56891,Zer37621])
model = tf.keras.models.Model(inputs=[in0Fla41973,in0Con98143,in0Ave81021,in1Ave81021,in0Add82211,in1Add82211,in0Up_22063,in0Con56891,in0Dot21721,in1Dot21721], outputs=Min11082)
in0Fla41973 = tf.constant([[[1.6266], [1.8139]]])
in0Con98143 = tf.constant([[[0.1745], [0.2412], [0.0703], [0.8027]]])
in0Ave81021 = tf.constant([[[[0.6251, 0.8094]]]])
in1Ave81021 = tf.constant([[[[0.3006, 0.0777]]]])
in0Add82211 = tf.constant([[[0.2063, 0.5365]]])
in1Add82211 = tf.constant([[[0.9653, 0.8332]]])
in0Up_22063 = tf.constant([[[1.5626, 1.0839], [1.3189, 1.6978]]])
in0Con56891 = tf.constant([[[0.8868], [0.1031], [0.4396], [0.1374]]])
in0Dot21721 = tf.constant([[[0.8089, 0.8698, 0.0213], [0.1927, 0.3589, 0.7796]]])
in1Dot21721 = tf.constant([[[0.2175, 0.9489, 0.1784], [0.9844, 0.6619, 0.4123]]])
print (np.array2string(model.predict([in0Fla41973,in0Con98143,in0Ave81021,in1Ave81021,in0Add82211,in1Add82211,in0Up_22063,in0Con56891,in0Dot21721,in1Dot21721],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min11082.png')

LFla41973 = flatten_layer([[[1.6266], [1.8139]]], Fla41973), 
LRes35980 = reshape_layer(Fla41973, [2, 1], Res35980), 
LZer49930 = zero_padding1D_layer(Res35980, 2, 0, Zer49930), 
LCon98143 = concatenate_layer([Zer49930,[[[0.1745], [0.2412], [0.0703], [0.8027]]]], 2, Con98143), 
LAve81021 = average_layer([[[[[0.6251, 0.8094]]]], [[[[0.3006, 0.0777]]]]], Ave81021), 
LRes4080 = reshape_layer(Ave81021, [1, 2], Res4080), 
LAdd82211 = add_layer([[[[0.2063, 0.5365]]], [[[0.9653, 0.8332]]]], Add82211), 
LMax34653 = maximum_layer([Res4080,Add82211], Max34653), 
LZer645 = zero_padding1D_layer(Max34653, 3, 0, Zer645), 
LUp_22063 = up_sampling1D_layer([[[1.5626, 1.0839], [1.3189, 1.6978]]], 2, Up_22063), 
LSub58036 = subtract_layer(Zer645,Up_22063, Sub58036), 
LMul44395 = multiply_layer([Con98143,Sub58036], Mul44395), 
LCon56891 = concatenate_layer([Mul44395,[[[0.8868], [0.1031], [0.4396], [0.1374]]]], 2, Con56891), 
LDot21721 = dot_layer([[[0.8089, 0.8698, 0.0213], [0.1927, 0.3589, 0.7796]]], [[[0.2175, 0.9489, 0.1784], [0.9844, 0.6619, 0.4123]]], 1, 1, Dot21721), 
LZer37621 = zero_padding1D_layer(Dot21721, 1, 0, Zer37621), 
LMin11082 = minimum_layer([Con56891,Zer37621], Min11082), 
exec_layers([LFla41973,LRes35980,LZer49930,LCon98143,LAve81021,LRes4080,LAdd82211,LMax34653,LZer645,LUp_22063,LSub58036,LMul44395,LCon56891,LDot21721,LZer37621,LMin11082],["Fla41973","Res35980","Zer49930","Con98143","Ave81021","Res4080","Add82211","Max34653","Zer645","Up_22063","Sub58036","Mul44395","Con56891","Dot21721","Zer37621","Min11082"],Min11082,"Min11082")

Actual (Unparsed): [[[0.0000000, -0.1891405, 0.0000000], [-0.0000000, -0.2614367, 0.1031000], [-2.1453228, -0.1193553, 0.3031468], [-0.2671874, -0.2633659, 0.1374000]]]

Expected (Unparsed): [[[-0.0,-0.18914055,0],[-0.0,-0.26143668000000003,0.1031],[-2.14532274,-0.11935534,0.30314679],[-0.26718747,-0.26336587000000006,0.1374]]]

Actual:   [[[0, -0.1891, 0], [-0, -0.2614, 0.1031], [-2.1453, -0.1193, 0.3032], [-0.2671, -0.2633, 0.1374]]]

Expected: [[[-0, -0.1891, 0], [-0, -0.2614, 0.1031], [-2.1453, -0.1193, 0.3032], [-0.2671, -0.2633, 0.1374]]]