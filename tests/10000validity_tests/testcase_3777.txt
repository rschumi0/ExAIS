import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul65340 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Mul65340 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Ave77189 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave77189 = tf.keras.layers.Input(shape=([1, 1]))
in0Con36954 = tf.keras.layers.Input(shape=([2, 1, 1, 3]))
in0Ave59616 = tf.keras.layers.Input(shape=([1, 2, 1]))

Mul65340 = keras.layers.Multiply(name = 'Mul65340', )([in0Mul65340,in1Mul65340])
Res81269 = keras.layers.Reshape((2, 1, 1), name = 'Res81269', )(Mul65340)
Res40599 = keras.layers.Reshape((2, 1), name = 'Res40599', )(Res81269)
Ave77189 = keras.layers.Average(name = 'Ave77189', )([in0Ave77189,in1Ave77189])
Zer70004 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer70004', )(Ave77189)
Mul75532 = keras.layers.Multiply(name = 'Mul75532', )([Res40599,Zer70004])
Res83155 = keras.layers.Reshape((2, 1, 1), name = 'Res83155', )(Mul75532)
Ave45691 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 8), padding='valid', name = 'Ave45691', )(Res83155)
Res94793 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res94793', )(Ave45691)
Con36954 = keras.layers.Concatenate(axis=4, name = 'Con36954', )([Res94793,in0Con36954])
Ave59616 = keras.layers.AveragePooling2D(pool_size=(1, 2), strides=(1, 9), padding='valid', name = 'Ave59616', )(in0Ave59616)
Res16886 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res16886', )(Ave59616)
Con34413 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con34413', )(Res16886)
Zer86471 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer86471', )(Con34413)
Mul26833 = keras.layers.Multiply(name = 'Mul26833', )([Con36954,Zer86471])
model = tf.keras.models.Model(inputs=[in0Mul65340,in1Mul65340,in0Ave77189,in1Ave77189,in0Con36954,in0Ave59616], outputs=Mul26833)
w = model.get_layer('Con34413').get_weights() 
w[0] = np.array([[[[[0.2537, 0.5542, 0.9246, 0.6544]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con34413').set_weights(w) 
in0Mul65340 = tf.constant([[[[[0.0061]]], [[[0.6188]]]]])
in1Mul65340 = tf.constant([[[[[0.0965]]], [[[0.5663]]]]])
in0Ave77189 = tf.constant([[[0.3886]]])
in1Ave77189 = tf.constant([[[0.6508]]])
in0Con36954 = tf.constant([[[[[0.4848, 0.0179, 0.3981]]], [[[0.4065, 0.8026, 0.7762]]]]])
in0Ave59616 = tf.constant([[[[1.7342], [1.3936]]]])
print (np.array2string(model.predict([in0Mul65340,in1Mul65340,in0Ave77189,in1Ave77189,in0Con36954,in0Ave59616],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul26833.png')

LMul65340 = multiply_layer([[[[[[0.0061]]], [[[0.6188]]]]], [[[[[0.0965]]], [[[0.5663]]]]]], Mul65340), 
LRes81269 = reshape_layer(Mul65340, [2, 1, 1], Res81269), 
LRes40599 = reshape_layer(Res81269, [2, 1], Res40599), 
LAve77189 = average_layer([[[[0.3886]]], [[[0.6508]]]], Ave77189), 
LZer70004 = zero_padding1D_layer(Ave77189, 1, 0, Zer70004), 
LMul75532 = multiply_layer([Res40599,Zer70004], Mul75532), 
LRes83155 = reshape_layer(Mul75532, [2, 1, 1], Res83155), 
LAve45691 = average_pooling2D_layer(Res83155, 1, 1, 1, 8, false, Ave45691), 
LRes94793 = reshape_layer(Ave45691, [2, 1, 1, 1], Res94793), 
LCon36954 = concatenate_layer([Res94793,[[[[[0.4848, 0.0179, 0.3981]]], [[[0.4065, 0.8026, 0.7762]]]]]], 4, Con36954), 
LAve59616 = average_pooling2D_layer([[[[1.7342], [1.3936]]]], 1, 2, 1, 9, false, Ave59616), 
LRes16886 = reshape_layer(Ave59616, [1, 1, 1, 1], Res16886), 
LCon34413 = conv3D_layer(Res16886, 1, 1, 1,[[[[[0.2537, 0.5542, 0.9246, 0.6544]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con34413), 
LZer86471 = zero_padding3D_layer(Con34413, 1, 0, 0, 0, 0, 0, Zer86471), 
LMul26833 = multiply_layer([Con36954,Zer86471], Mul26833), 
exec_layers([LMul65340,LRes81269,LRes40599,LAve77189,LZer70004,LMul75532,LRes83155,LAve45691,LRes94793,LCon36954,LAve59616,LRes16886,LCon34413,LZer86471,LMul26833],["Mul65340","Res81269","Res40599","Ave77189","Zer70004","Mul75532","Res83155","Ave45691","Res94793","Con36954","Ave59616","Res16886","Con34413","Zer86471","Mul26833"],Mul26833,"Mul26833")

Actual (Unparsed): [[[[[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0722568, 0.3523190, 1.1605451, 0.7943756]]]]]

Expected (Unparsed): [[[[[0.0,0.0,0.0,0.0]]],[[[0.07225685092235551,0.35231898896999997,1.1605451050439999,0.7943756233919999]]]]]

Actual:   [[[[[0, 0, 0, 0]]], [[[0.0723, 0.3524, 1.1606, 0.7944]]]]]

Expected: [[[[[0, 0, 0, 0]]], [[[0.0723, 0.3524, 1.1606, 0.7944]]]]]