import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max58047 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Max58047 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Con53272 = tf.keras.layers.Input(shape=([4, 1]))
in0Zer68877 = tf.keras.layers.Input(shape=([2, 2]))

Max58047 = keras.layers.Maximum(name = 'Max58047', )([in0Max58047,in1Max58047])
Res90803 = keras.layers.Reshape((2, 1, 1), name = 'Res90803', )(Max58047)
Res75845 = keras.layers.Reshape((2, 1), name = 'Res75845', )(Res90803)
Fla24990 = keras.layers.Flatten(name = 'Fla24990', )(Res75845)
Res43490 = keras.layers.Reshape((2, 1), name = 'Res43490', )(Fla24990)
PRe88552 = keras.layers.PReLU(name = 'PRe88552', )(Res43490)
Zer972 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer972', )(PRe88552)
Con53272 = keras.layers.Concatenate(axis=2, name = 'Con53272', )([Zer972,in0Con53272])
Zer68877 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer68877', )(in0Zer68877)
Sub99264 = keras.layers.Subtract(name = 'Sub99264', )([Con53272,Zer68877])
Res50659 = keras.layers.Reshape((4, 2, 1), name = 'Res50659', )(Sub99264)
Res19375 = keras.layers.Reshape((4, 2, 1, 1), name = 'Res19375', )(Res50659)
Zer22351 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer22351', )(Res19375)
model = tf.keras.models.Model(inputs=[in0Max58047,in1Max58047,in0Con53272,in0Zer68877], outputs=Zer22351)
w = model.get_layer('PRe88552').get_weights() 
w[0] = np.array([[0.8344], [0.7892]])
model.get_layer('PRe88552').set_weights(w) 
in0Max58047 = tf.constant([[[[[0.8358]]], [[[0.4755]]]]])
in1Max58047 = tf.constant([[[[[0.2028]]], [[[0.742]]]]])
in0Con53272 = tf.constant([[[0.9283], [0.3018], [0.5038], [0.2304]]])
in0Zer68877 = tf.constant([[[1.5566, 1.7836], [1.182, 1.0425]]])
print (np.array2string(model.predict([in0Max58047,in1Max58047,in0Con53272,in0Zer68877],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer22351.png')

LMax58047 = maximum_layer([[[[[[0.8358]]], [[[0.4755]]]]], [[[[[0.2028]]], [[[0.742]]]]]], Max58047), 
LRes90803 = reshape_layer(Max58047, [2, 1, 1], Res90803), 
LRes75845 = reshape_layer(Res90803, [2, 1], Res75845), 
LFla24990 = flatten_layer(Res75845, Fla24990), 
LRes43490 = reshape_layer(Fla24990, [2, 1], Res43490), 
LPRe88552 = prelu_layer(Res43490, [[0.8344], [0.7892]], PRe88552), 
LZer972 = zero_padding1D_layer(PRe88552, 2, 0, Zer972), 
LCon53272 = concatenate_layer([Zer972,[[[0.9283], [0.3018], [0.5038], [0.2304]]]], 2, Con53272), 
LZer68877 = zero_padding1D_layer([[[1.5566, 1.7836], [1.182, 1.0425]]], 1, 1, Zer68877), 
LSub99264 = subtract_layer(Con53272,Zer68877, Sub99264), 
LRes50659 = reshape_layer(Sub99264, [4, 2, 1], Res50659), 
LRes19375 = reshape_layer(Res50659, [4, 2, 1, 1], Res19375), 
LZer22351 = zero_padding3D_layer(Res19375, 1, 1, 1, 1, 1, 1, Zer22351), 
exec_layers([LMax58047,LRes90803,LRes75845,LFla24990,LRes43490,LPRe88552,LZer972,LCon53272,LZer68877,LSub99264,LRes50659,LRes19375,LZer22351],["Max58047","Res90803","Res75845","Fla24990","Res43490","PRe88552","Zer972","Con53272","Zer68877","Sub99264","Res50659","Res19375","Zer22351"],Zer22351,"Zer22351")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.9283000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-1.5566000], [0.0000000]], [[0.0000000], [-1.4818000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.3462000], [0.0000000]], [[0.0000000], [-0.5387000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.7420000], [0.0000000]], [[0.0000000], [0.2304000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0.9283],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[-1.5566],[0]],[[0],[-1.4818],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[-0.34619999999999995],[0]],[[0],[-0.5387],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.742],[0]],[[0],[0.2304],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0.9283], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-1.5566], [0]], [[0], [-1.4818], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.3462], [0]], [[0], [-0.5387], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.742], [0]], [[0], [0.2304], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0.9283], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-1.5566], [0]], [[0], [-1.4818], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0.3461], [0]], [[0], [-0.5387], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.742], [0]], [[0], [0.2304], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]