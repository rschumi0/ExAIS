import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add23095 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Add23095 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Add23095 = keras.layers.Add(name = 'Add23095', )([in0Add23095,in1Add23095])
Res79009 = keras.layers.Reshape((2, 1, 4), name = 'Res79009', )(Add23095)
Sep87036 = keras.layers.SeparableConv2D(3, (2, 1),strides=(1, 1), padding='same', name = 'Sep87036', )(Res79009)
Res65003 = keras.layers.Reshape((2, 1, 3, 1), name = 'Res65003', )(Sep87036)
Con74927 = keras.layers.Conv3D(3, (2, 1, 2),strides=(1, 1, 3), padding='same', dilation_rate=(1, 1, 1), name = 'Con74927', )(Res65003)
model = tf.keras.models.Model(inputs=[in0Add23095,in1Add23095], outputs=Con74927)
w = model.get_layer('Sep87036').get_weights() 
w[0] = np.array([[[[0.1421], [0.2452], [0.5312], [0.1985]]], [[[0.3011], [0.3731], [0.5961], [0.3509]]]])
w[1] = np.array([[[[0.0412, 0.3662, 0.8138], [0.2127, 0.3373, 0.3818], [0.4941, 0.4205, 0.4262], [0.7758, 0.1275, 0.9877]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep87036').set_weights(w) 
w = model.get_layer('Con74927').get_weights() 
w[0] = np.array([[[[[0.295, 0.0358, 0.6802]], [[0.9664, 0.8129, 0.2287]]]], [[[[0.5526, 0.5455, 0.5997]], [[0.2519, 0.143, 0.9913]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con74927').set_weights(w) 
in0Add23095 = tf.constant([[[[[0.2248, 0.1599], [0.2429, 0.4281]]], [[[0.8717, 0.3765], [0.0232, 0.0168]]]]])
in1Add23095 = tf.constant([[[[[0.1279, 0.962], [0.1445, 0.8286]]], [[[0.9634, 0.0798], [0.4339, 0.5676]]]]])
print (np.array2string(model.predict([in0Add23095,in1Add23095],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con74927.png')

LAdd23095 = add_layer([[[[[[0.2248, 0.1599], [0.2429, 0.4281]]], [[[0.8717, 0.3765], [0.0232, 0.0168]]]]], [[[[[0.1279, 0.962], [0.1445, 0.8286]]], [[[0.9634, 0.0798], [0.4339, 0.5676]]]]]], Add23095), 
LRes79009 = reshape_layer(Add23095, [2, 1, 4], Res79009), 
LSep87036 = separable_conv2D_layer(Res79009, 2, 1,[[[[[0.1421], [0.2452], [0.5312], [0.1985]]], [[[0.3011], [0.3731], [0.5961], [0.3509]]]],[[[[0.0412, 0.3662, 0.8138], [0.2127, 0.3373, 0.3818], [0.4941, 0.4205, 0.4262], [0.7758, 0.1275, 0.9877]]]]],[0, 0, 0], 1, 1, true, Sep87036), 
LRes65003 = reshape_layer(Sep87036, [2, 1, 3, 1], Res65003), 
LCon74927 = conv3D_layer(Res65003, 2, 1, 2,[[[[[0.295, 0.0358, 0.6802]], [[0.9664, 0.8129, 0.2287]]]], [[[[0.5526, 0.5455, 0.5997]], [[0.2519, 0.143, 0.9913]]]]],[0, 0, 0], 1, 1, 3, true, 1, 1, 1, Con74927), 
exec_layers([LAdd23095,LRes79009,LSep87036,LRes65003,LCon74927],["Add23095","Res79009","Sep87036","Res65003","Con74927"],Con74927,"Con74927")

Actual (Unparsed): [[[[[1.0159273, 0.7066142, 1.0205637]]], [[[0.3138508, 0.2120797, 0.2235193]]]]]

Expected (Unparsed): [[[[[1.0159272955679781,0.70661421379337,1.0205636613846425]]],[[[0.313850845695824,0.2120797032649138,0.2235192718625582]]]]]

Actual:   [[[[[1.016, 0.7067, 1.0206]]], [[[0.3139, 0.2121, 0.2236]]]]]

Expected: [[[[[1.016, 0.7067, 1.0206]]], [[[0.3139, 0.2121, 0.2236]]]]]