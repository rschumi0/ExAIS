import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add67038 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add67038 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Add70907 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add70907 = tf.keras.layers.Input(shape=([2, 1, 1]))

Add67038 = keras.layers.Add(name = 'Add67038', )([in0Add67038,in1Add67038])
Res17477 = keras.layers.Reshape((1, 4), name = 'Res17477', )(Add67038)
Sep66336 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep66336', )(Res17477)
Res49126 = keras.layers.Reshape((1, 2, 1), name = 'Res49126', )(Sep66336)
Zer46956 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer46956', )(Res49126)
Add70907 = keras.layers.Add(name = 'Add70907', )([in0Add70907,in1Add70907])
ReL92543 = keras.layers.ReLU(max_value=3.2192478569112164, negative_slope=1.8988759270784201, threshold=8.201474803825846, name = 'ReL92543', )(Add70907)
Zer53933 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer53933', )(ReL92543)
Min73448 = keras.layers.Minimum(name = 'Min73448', )([Zer46956,Zer53933])
model = tf.keras.models.Model(inputs=[in0Add67038,in1Add67038,in0Add70907,in1Add70907], outputs=Min73448)
w = model.get_layer('Sep66336').get_weights() 
w[0] = np.array([[[0.2514], [0.701], [0.4213], [0.7508]]])
w[1] = np.array([[[0.1811, 0.602], [0.6346, 0.0947], [0.6295, 0.3461], [0.8229, 0.6613]]])
w[2] = np.array([0, 0])
model.get_layer('Sep66336').set_weights(w) 
in0Add67038 = tf.constant([[[[0.6872, 0.7498], [0.1717, 0.3774]]]])
in1Add67038 = tf.constant([[[[0.091, 0.8742], [0.6843, 0.6672]]]])
in0Add70907 = tf.constant([[[[0.6454]], [[0.4231]]]])
in1Add70907 = tf.constant([[[[0.5266]], [[0.2203]]]])
print (np.array2string(model.predict([in0Add67038,in1Add67038,in0Add70907,in1Add70907],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min73448.png')

LAdd67038 = add_layer([[[[[0.6872, 0.7498], [0.1717, 0.3774]]]], [[[[0.091, 0.8742], [0.6843, 0.6672]]]]], Add67038), 
LRes17477 = reshape_layer(Add67038, [1, 4], Res17477), 
LSep66336 = separable_conv1D_layer(Res17477, 1,[[[[0.2514], [0.701], [0.4213], [0.7508]]],[[[0.1811, 0.602], [0.6346, 0.0947], [0.6295, 0.3461], [0.8229, 0.6613]]]],[0, 0], 1, true, Sep66336), 
LRes49126 = reshape_layer(Sep66336, [1, 2, 1], Res49126), 
LZer46956 = zero_padding2D_layer(Res49126, 1, 0, 1, 0, Zer46956), 
LAdd70907 = add_layer([[[[[0.6454]], [[0.4231]]]], [[[[0.5266]], [[0.2203]]]]], Add70907), 
LReL92543 = relu_layer(Add70907, 3.2192478569112164, 1.8988759270784201, 8.201474803825846, ReL92543), 
LZer53933 = zero_padding2D_layer(ReL92543, 0, 0, 2, 0, Zer53933), 
LMin73448 = minimum_layer([Zer46956,Zer53933], Min73448), 
exec_layers([LAdd67038,LRes17477,LSep66336,LRes49126,LZer46956,LAdd70907,LReL92543,LZer53933,LMin73448],["Add67038","Res17477","Sep66336","Res49126","Zer46956","Add70907","ReL92543","Zer53933","Min73448"],Min73448,"Min73448")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [-13.3481005]], [[0.0000000], [0.0000000], [-14.3518463]]]]

Expected (Unparsed): [[[[0],[0],[-13.3481004849892]],[[0],[0],[-14.351846300042851]]]]

Actual:   [[[[0], [0], [-13.3481]], [[0], [0], [-14.3518]]]]

Expected: [[[[0], [0], [-13.3481]], [[0], [0], [-14.3518]]]]