import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST63921 = tf.keras.layers.Input(shape=([1, 2]))
in0Con33506 = tf.keras.layers.Input(shape=([6]))
in0Loc70927 = tf.keras.layers.Input(shape=([2, 1]))
in0Sub81744 = tf.keras.layers.Input(shape=([3]))
in1Sub81744 = tf.keras.layers.Input(shape=([3]))
in0Con52822 = tf.keras.layers.Input(shape=([5]))

LST63921 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST63921', )(in0LST63921)
Con33506 = keras.layers.Concatenate(axis=1, name = 'Con33506', )([LST63921,in0Con33506])
Loc70927 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc70927', )(in0Loc70927)
Fla51431 = keras.layers.Flatten(name = 'Fla51431', )(Loc70927)
Sub81744 = keras.layers.Subtract(name = 'Sub81744', )([in0Sub81744,in1Sub81744])
Con52822 = keras.layers.Concatenate(axis=1, name = 'Con52822', )([Sub81744,in0Con52822])
Add61904 = keras.layers.Add(name = 'Add61904', )([Fla51431,Con52822])
Min43253 = keras.layers.Minimum(name = 'Min43253', )([Con33506,Add61904])
model = tf.keras.models.Model(inputs=[in0LST63921,in0Con33506,in0Loc70927,in0Sub81744,in1Sub81744,in0Con52822], outputs=Min43253)
w = model.get_layer('LST63921').get_weights() 
w[0] = np.array([[6, 5, 3, 5, 2, 9, 2, 2], [7, 4, 10, 4, 2, 7, 6, 2]])
w[1] = np.array([[1, 3, 3, 4, 4, 5, 7, 8], [1, 4, 2, 4, 10, 4, 8, 9]])
w[2] = np.array([8, 10, 10, 6, 6, 4, 9, 8])
model.get_layer('LST63921').set_weights(w) 
w = model.get_layer('Loc70927').get_weights() 
w[0] = np.array([[[0.5134, 0.87, 0.7116, 0.8027]], [[0.8877, 0.6001, 0.8819, 0.6864]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc70927').set_weights(w) 
in0LST63921 = tf.constant([[[7, 5]]])
in0Con33506 = tf.constant([[0.6546, 0.5996, 0.8019, 0.3809, 0.0517, 0.7611]])
in0Loc70927 = tf.constant([[[0.5079], [0.8242]]])
in0Sub81744 = tf.constant([[0.5707, 0.0838, 0.6252]])
in1Sub81744 = tf.constant([[0.2964, 0.6691, 0.6014]])
in0Con52822 = tf.constant([[0.3014, 0.57, 0.479, 0.342, 0.5592]])
print (np.array2string(model.predict([in0LST63921,in0Con33506,in0Loc70927,in0Sub81744,in1Sub81744,in0Con52822],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min43253.png')

LLST63921 = lstm_layer([[[7, 5]]],[[6, 5, 3, 5, 2, 9, 2, 2], [7, 4, 10, 4, 2, 7, 6, 2]],[[1, 3, 3, 4, 4, 5, 7, 8], [1, 4, 2, 4, 10, 4, 8, 9]],[8, 10, 10, 6, 6, 4, 9, 8], LST63921), 
LCon33506 = concatenate_layer([LST63921,[[0.6546, 0.5996, 0.8019, 0.3809, 0.0517, 0.7611]]], 1, Con33506), 
LLoc70927 = locally_connected1D_layer([[[0.5079], [0.8242]]], 1,[[[0.5134, 0.87, 0.7116, 0.8027]], [[0.8877, 0.6001, 0.8819, 0.6864]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc70927), 
LFla51431 = flatten_layer(Loc70927, Fla51431), 
LSub81744 = subtract_layer([[0.5707, 0.0838, 0.6252]], [[0.2964, 0.6691, 0.6014]], Sub81744), 
LCon52822 = concatenate_layer([Sub81744,[[0.3014, 0.57, 0.479, 0.342, 0.5592]]], 1, Con52822), 
LAdd61904 = add_layer([Fla51431,Con52822], Add61904), 
LMin43253 = minimum_layer([Con33506,Add61904], Min43253), 
exec_layers([LLST63921,LCon33506,LLoc70927,LFla51431,LSub81744,LCon52822,LAdd61904,LMin43253],["LST63921","Con33506","Loc70927","Fla51431","Sub81744","Con52822","Add61904","Min43253"],Min43253,"Min43253")

Actual (Unparsed): [[0.5350558, -0.1434270, 0.3852216, 0.5996000, 0.8019000, 0.3809000, 0.0517000, 0.7611000]]

Expected (Unparsed): [[0.5350558599999999,-0.14342700000000003,0.38522164,0.5996,0.8019,0.3809,0.0517,0.7611]]

Actual:   [[0.5351, -0.1434, 0.3853, 0.5996, 0.8019, 0.3809, 0.0517, 0.7611]]

Expected: [[0.5351, -0.1434, 0.3853, 0.5996, 0.8019, 0.3809, 0.0517, 0.7611]]