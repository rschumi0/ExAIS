import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub45926 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub45926 = tf.keras.layers.Input(shape=([3, 3]))
in0Con38734 = tf.keras.layers.Input(shape=([3, 1]))
in0Min49103 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Min49103 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Con2410 = tf.keras.layers.Input(shape=([2, 1]))
in0Max57794 = tf.keras.layers.Input(shape=([1, 1, 2]))

Sub45926 = keras.layers.Subtract(name = 'Sub45926', )([in0Sub45926,in1Sub45926])
Sep14298 = keras.layers.SeparableConv1D(3, (2),strides=(3), padding='same', name = 'Sep14298', )(Sub45926)
Fla78149 = keras.layers.Flatten(name = 'Fla78149', )(Sep14298)
Fla18005 = keras.layers.Flatten(name = 'Fla18005', )(Fla78149)
Res21526 = keras.layers.Reshape((3, 1), name = 'Res21526', )(Fla18005)
Con38734 = keras.layers.Concatenate(axis=2, name = 'Con38734', )([Res21526,in0Con38734])
Min49103 = keras.layers.Minimum(name = 'Min49103', )([in0Min49103,in1Min49103])
Res15422 = keras.layers.Reshape((2, 1, 1), name = 'Res15422', )(Min49103)
Res53495 = keras.layers.Reshape((2, 1), name = 'Res53495', )(Res15422)
Glo7444 = keras.layers.GlobalMaxPool1D(name = 'Glo7444', )(Res53495)
Den67891 = keras.layers.Dense(2,name = 'Den67891', )(Glo7444)
Res48958 = keras.layers.Reshape((2, 1), name = 'Res48958', )(Den67891)
Con2410 = keras.layers.Concatenate(axis=2, name = 'Con2410', )([Res48958,in0Con2410])
Max57794 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max57794', )(in0Max57794)
Res83904 = keras.layers.Reshape((1, 2), name = 'Res83904', )(Max57794)
Cro86427 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro86427', )(Res83904)
Zer13113 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer13113', )(Cro86427)
Min41920 = keras.layers.Minimum(name = 'Min41920', )([Con2410,Zer13113])
Zer59783 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer59783', )(Min41920)
Min27640 = keras.layers.Minimum(name = 'Min27640', )([Con38734,Zer59783])
model = tf.keras.models.Model(inputs=[in0Sub45926,in1Sub45926,in0Con38734,in0Min49103,in1Min49103,in0Con2410,in0Max57794], outputs=Min27640)
w = model.get_layer('Sep14298').get_weights() 
w[0] = np.array([[[0.8896], [0.1091], [0.7553]], [[0.585], [0.6654], [0.237]]])
w[1] = np.array([[[0.136, 0.4709, 0.3542], [0.2101, 0.2447, 0.8668], [0.4458, 0.1714, 0.1579]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep14298').set_weights(w) 
w = model.get_layer('Den67891').get_weights() 
w[0] = np.array([[0.6147, 0.164]])
w[1] = np.array([0.7559, 0.2945])
model.get_layer('Den67891').set_weights(w) 
in0Sub45926 = tf.constant([[[0.9276, 0.8781, 0.4783], [0.6013, 0.0541, 0.4189], [0.2498, 0.8349, 0.8423]]])
in1Sub45926 = tf.constant([[[0.2857, 0.5043, 0.4076], [0.4472, 0.9739, 0.0141], [0.4149, 0.4598, 0.0214]]])
in0Con38734 = tf.constant([[[0.2483], [0.1426], [0.0538]]])
in0Min49103 = tf.constant([[[[[0.8278]]], [[[0.0923]]]]])
in1Min49103 = tf.constant([[[[[0.5609]]], [[[0.4314]]]]])
in0Con2410 = tf.constant([[[0.8369], [0.6503]]])
in0Max57794 = tf.constant([[[[1.4751, 1.4157]]]])
print (np.array2string(model.predict([in0Sub45926,in1Sub45926,in0Con38734,in0Min49103,in1Min49103,in0Con2410,in0Max57794],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min27640.png')

LSub45926 = subtract_layer([[[0.9276, 0.8781, 0.4783], [0.6013, 0.0541, 0.4189], [0.2498, 0.8349, 0.8423]]], [[[0.2857, 0.5043, 0.4076], [0.4472, 0.9739, 0.0141], [0.4149, 0.4598, 0.0214]]], Sub45926), 
LSep14298 = separable_conv1D_layer(Sub45926, 2,[[[[0.8896], [0.1091], [0.7553]], [[0.585], [0.6654], [0.237]]],[[[0.136, 0.4709, 0.3542], [0.2101, 0.2447, 0.8668], [0.4458, 0.1714, 0.1579]]]],[0, 0, 0], 3, true, Sep14298), 
LFla78149 = flatten_layer(Sep14298, Fla78149), 
LFla18005 = flatten_layer(Fla78149, Fla18005), 
LRes21526 = reshape_layer(Fla18005, [3, 1], Res21526), 
LCon38734 = concatenate_layer([Res21526,[[[0.2483], [0.1426], [0.0538]]]], 2, Con38734), 
LMin49103 = minimum_layer([[[[[[0.8278]]], [[[0.0923]]]]], [[[[[0.5609]]], [[[0.4314]]]]]], Min49103), 
LRes15422 = reshape_layer(Min49103, [2, 1, 1], Res15422), 
LRes53495 = reshape_layer(Res15422, [2, 1], Res53495), 
LGlo7444 = global_max_pool1D_layer(Res53495, Glo7444), 
LDen67891 = dense_layer(Glo7444, [[0.6147, 0.164]],[0.7559, 0.2945], Den67891), 
LRes48958 = reshape_layer(Den67891, [2, 1], Res48958), 
LCon2410 = concatenate_layer([Res48958,[[[0.8369], [0.6503]]]], 2, Con2410), 
LMax57794 = max_pool2D_layer([[[[1.4751, 1.4157]]]], 1, 1, Max57794), 
LRes83904 = reshape_layer(Max57794, [1, 2], Res83904), 
LCro86427 = cropping1D_layer(Res83904, 0, 0, Cro86427), 
LZer13113 = zero_padding1D_layer(Cro86427, 1, 0, Zer13113), 
LMin41920 = minimum_layer([Con2410,Zer13113], Min41920), 
LZer59783 = zero_padding1D_layer(Min41920, 1, 0, Zer59783), 
LMin27640 = minimum_layer([Con38734,Zer59783], Min27640), 
exec_layers([LSub45926,LSep14298,LFla78149,LFla18005,LRes21526,LCon38734,LMin49103,LRes15422,LRes53495,LGlo7444,LDen67891,LRes48958,LCon2410,LMax57794,LRes83904,LCro86427,LZer13113,LMin41920,LZer59783,LMin27640],["Sub45926","Sep14298","Fla78149","Fla18005","Res21526","Con38734","Min49103","Res15422","Res53495","Glo7444","Den67891","Res48958","Con2410","Max57794","Res83904","Cro86427","Zer13113","Min41920","Zer59783","Min27640"],Min27640,"Min27640")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [-0.2373911, 0.0538000]]]

Expected (Unparsed): [[[0,0],[0,0],[-0.23739110735499996,0.0538]]]

Actual:   [[[0, 0], [0, 0], [-0.2373, 0.0538]]]

Expected: [[[0, 0], [0, 0], [-0.2373, 0.0538]]]