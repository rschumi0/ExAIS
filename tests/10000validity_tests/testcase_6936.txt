import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub23702 = tf.keras.layers.Input(shape=([2, 3, 2, 3]))
in1Sub23702 = tf.keras.layers.Input(shape=([2, 3, 2, 3]))

Sub23702 = keras.layers.Subtract(name = 'Sub23702', )([in0Sub23702,in1Sub23702])
Res85094 = keras.layers.Reshape((2, 3, 6), name = 'Res85094', )(Sub23702)
Res79340 = keras.layers.Reshape((2, 18), name = 'Res79340', )(Res85094)
Ave6055 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave6055', )(Res79340)
model = tf.keras.models.Model(inputs=[in0Sub23702,in1Sub23702], outputs=Ave6055)
in0Sub23702 = tf.constant([[[[[0.0264, 0.4579, 0.9018], [0.6163, 0.973, 0.7655]], [[0.746, 0.26, 0.6404], [0.1665, 0.2813, 0.5551]], [[0.0667, 0.8529, 0.9317], [0.7227, 0.0617, 0.2146]]], [[[0.3219, 0.6603, 0.7913], [0.8408, 0.9543, 0.4036]], [[0.5203, 0.7531, 0.2232], [0.7749, 0.2925, 0.7291]], [[0.0807, 0.571, 0.8451], [0.3194, 0.2036, 0.0263]]]]])
in1Sub23702 = tf.constant([[[[[0.8524, 0.4344, 0.8213], [0.7018, 0.6715, 0.1847]], [[0.4618, 0.3977, 0.1253], [0.9932, 0.748, 0.1638]], [[0.4966, 0.8678, 0.0329], [0.9915, 0.8335, 0.1214]]], [[[0.1016, 0.3107, 0.8674], [0.7565, 0.389, 0.987]], [[0.3319, 0.1958, 0.1591], [0.1161, 0.2373, 0.0287]], [[0.8798, 0.5468, 0.7024], [0.9749, 0.5846, 0.7284]]]]])
print (np.array2string(model.predict([in0Sub23702,in1Sub23702],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave6055.png')

LSub23702 = subtract_layer([[[[[0.0264, 0.4579, 0.9018], [0.6163, 0.973, 0.7655]], [[0.746, 0.26, 0.6404], [0.1665, 0.2813, 0.5551]], [[0.0667, 0.8529, 0.9317], [0.7227, 0.0617, 0.2146]]], [[[0.3219, 0.6603, 0.7913], [0.8408, 0.9543, 0.4036]], [[0.5203, 0.7531, 0.2232], [0.7749, 0.2925, 0.7291]], [[0.0807, 0.571, 0.8451], [0.3194, 0.2036, 0.0263]]]]], [[[[[0.8524, 0.4344, 0.8213], [0.7018, 0.6715, 0.1847]], [[0.4618, 0.3977, 0.1253], [0.9932, 0.748, 0.1638]], [[0.4966, 0.8678, 0.0329], [0.9915, 0.8335, 0.1214]]], [[[0.1016, 0.3107, 0.8674], [0.7565, 0.389, 0.987]], [[0.3319, 0.1958, 0.1591], [0.1161, 0.2373, 0.0287]], [[0.8798, 0.5468, 0.7024], [0.9749, 0.5846, 0.7284]]]]], Sub23702), 
LRes85094 = reshape_layer(Sub23702, [2, 3, 6], Res85094), 
LRes79340 = reshape_layer(Res85094, [2, 18], Res79340), 
LAve6055 = average_pooling1D_layer(Res79340, 1, Ave6055), 
exec_layers([LSub23702,LRes85094,LRes79340,LAve6055],["Sub23702","Res85094","Res79340","Ave6055"],Ave6055,"Ave6055")

Actual (Unparsed): [[[-0.8260000, 0.0235000, 0.0804999, -0.0855000, 0.3015000, 0.5808000, 0.2842000, -0.1377000, 0.5151000, -0.8267000, -0.4667000, 0.3913000, -0.4299000, -0.0149000, 0.8988000, -0.2688000, -0.7718000, 0.0932000], [0.2203000, 0.3496000, -0.0761000, 0.0843000, 0.5653000, -0.5834000, 0.1884000, 0.5573000, 0.0641000, 0.6588000, 0.0552000, 0.7004000, -0.7991000, 0.0242000, 0.1427000, -0.6555000, -0.3810000, -0.7021000]]]

Expected (Unparsed): [[[-0.8260000000000001,0.023499999999999965,0.08050000000000002,-0.08550000000000002,0.3015,0.5808,0.2842,-0.1377,0.5151,-0.8267,-0.4667,0.39130000000000004,-0.4299,-0.014900000000000024,0.8987999999999999,-0.26880000000000004,-0.7718,0.09320000000000002],[0.22030000000000002,0.3496,-0.07609999999999995,0.08430000000000004,0.5653,-0.5833999999999999,0.1884,0.5573,0.06410000000000002,0.6588,0.05519999999999997,0.7004,-0.7991,0.0242,0.14269999999999994,-0.6555,-0.381,-0.7021000000000001]]]

Actual:   [[[-0.826, 0.0235, 0.0805, -0.0855, 0.3015, 0.5808, 0.2842, -0.1377, 0.5151, -0.8267, -0.4667, 0.3913, -0.4299, -0.0149, 0.8988, -0.2688, -0.7718, 0.0932], [0.2203, 0.3496, -0.0761, 0.0843, 0.5653, -0.5834, 0.1884, 0.5573, 0.0641, 0.6588, 0.0552, 0.7004, -0.7991, 0.0242, 0.1427, -0.6555, -0.381, -0.7021]]]

Expected: [[[-0.826, 0.0235, 0.0806, -0.0855, 0.3015, 0.5808, 0.2842, -0.1377, 0.5151, -0.8267, -0.4667, 0.3914, -0.4299, -0.0149, 0.8988, -0.2688, -0.7718, 0.0933], [0.2204, 0.3496, -0.076, 0.0844, 0.5653, -0.5833, 0.1884, 0.5573, 0.0642, 0.6588, 0.0552, 0.7004, -0.7991, 0.0242, 0.1427, -0.6555, -0.381, -0.7021]]]