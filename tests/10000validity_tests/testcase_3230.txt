import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ELU47304 = tf.keras.layers.Input(shape=([2, 2, 2]))

ELU47304 = keras.layers.ELU(alpha=-3.347043942341368, name = 'ELU47304', input_shape=(2, 2, 2))(in0ELU47304)
Sep67002 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='valid', name = 'Sep67002', )(ELU47304)
Mas4571 = keras.layers.Masking(mask_value=2, name = 'Mas4571', )(Sep67002)
Res98123 = keras.layers.Reshape((2, 6), name = 'Res98123', )(Mas4571)
Max77908 = keras.layers.MaxPool1D(pool_size=(2), strides=(4), padding='valid', name = 'Max77908', )(Res98123)
model = tf.keras.models.Model(inputs=[in0ELU47304], outputs=Max77908)
w = model.get_layer('Sep67002').get_weights() 
w[0] = np.array([[[[0.141], [0.5776]]]])
w[1] = np.array([[[[0.5808, 0.3838, 0.6218], [0.1145, 0.3282, 0.9832]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep67002').set_weights(w) 
in0ELU47304 = tf.constant([[[[0.0279, 0.2539], [0.1029, 0.2908]], [[0.3683, 0.6709], [0.6547, 0.4543]]]])
print (np.array2string(model.predict([in0ELU47304],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max77908.png')

LELU47304 = elu_layer([[[[0.0279, 0.2539], [0.1029, 0.2908]], [[0.3683, 0.6709], [0.6547, 0.4543]]]], -3.347043942341368, ELU47304), 
LSep67002 = separable_conv2D_layer(ELU47304, 1, 1,[[[[[0.141], [0.5776]]]],[[[[0.5808, 0.3838, 0.6218], [0.1145, 0.3282, 0.9832]]]]],[0, 0, 0], 1, 1, false, Sep67002), 
LMas4571 = masking_layer(Sep67002, 2, Mas4571), 
LRes98123 = reshape_layer(Mas4571, [2, 6], Res98123), 
LMax77908 = max_pool1D_layer(Res98123, 2, 4, false, Max77908), 
exec_layers([LELU47304,LSep67002,LMas4571,LRes98123,LMax77908],["ELU47304","Sep67002","Mas4571","Res98123","Max77908"],Max77908,"Max77908")

Actual (Unparsed): [[[0.0745312, 0.1471122, 0.4132919, 0.0836604, 0.1215505, 0.3153953]]]

Expected (Unparsed): [[[0.07453122392,0.14711223502800003,0.41329190162800006,0.08366043751999999,0.12155050203599999,0.315395335036]]]

Actual:   [[[0.0746, 0.1472, 0.4133, 0.0837, 0.1216, 0.3154]]]

Expected: [[[0.0746, 0.1472, 0.4133, 0.0837, 0.1216, 0.3154]]]