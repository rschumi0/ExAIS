import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot93572 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot93572 = tf.keras.layers.Input(shape=([2, 3]))
in0PRe85199 = tf.keras.layers.Input(shape=([1, 1]))
in0Con12562 = tf.keras.layers.Input(shape=([3, 2]))

Dot93572 = keras.layers.Dot(axes=(1, 1), name = 'Dot93572', )([in0Dot93572,in1Dot93572])
PRe85199 = keras.layers.PReLU(name = 'PRe85199', input_shape=(1, 1))(in0PRe85199)
Zer93020 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer93020', )(PRe85199)
Con12562 = keras.layers.Concatenate(axis=2, name = 'Con12562', )([Zer93020,in0Con12562])
Ave78139 = keras.layers.Average(name = 'Ave78139', )([Dot93572,Con12562])
Max44709 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='valid', name = 'Max44709', )(Ave78139)
model = tf.keras.models.Model(inputs=[in0Dot93572,in1Dot93572,in0PRe85199,in0Con12562], outputs=Max44709)
w = model.get_layer('PRe85199').get_weights() 
w[0] = np.array([[0.7283]])
model.get_layer('PRe85199').set_weights(w) 
in0Dot93572 = tf.constant([[[0.7206, 0.0751, 0.1949], [0.3215, 0.5936, 0.178]]])
in1Dot93572 = tf.constant([[[0.7956, 0.7432, 0.9203], [0.0733, 0.5308, 0.729]]])
in0PRe85199 = tf.constant([[[0.7723]]])
in0Con12562 = tf.constant([[[0.0115, 0.2636], [0.1707, 0.5598], [0.2138, 0.4326]]])
print (np.array2string(model.predict([in0Dot93572,in1Dot93572,in0PRe85199,in0Con12562],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max44709.png')

LDot93572 = dot_layer([[[0.7206, 0.0751, 0.1949], [0.3215, 0.5936, 0.178]]], [[[0.7956, 0.7432, 0.9203], [0.0733, 0.5308, 0.729]]], 1, 1, Dot93572), 
LPRe85199 = prelu_layer([[[0.7723]]], [[0.7283]], PRe85199), 
LZer93020 = zero_padding1D_layer(PRe85199, 2, 0, Zer93020), 
LCon12562 = concatenate_layer([Zer93020,[[[0.0115, 0.2636], [0.1707, 0.5598], [0.2138, 0.4326]]]], 2, Con12562), 
LAve78139 = average_layer([Dot93572,Con12562], Ave78139), 
LMax44709 = max_pool1D_layer(Ave78139, 2, 1, false, Max44709), 
exec_layers([LDot93572,LPRe85199,LZer93020,LCon12562,LAve78139,LMax44709],["Dot93572","PRe85199","Zer93020","Con12562","Ave78139","Max44709"],Max44709,"Max44709")

Actual (Unparsed): [[[0.2984377, 0.3588511, 0.5805708], [0.4702049, 0.2707986, 0.5308245]]]

Expected (Unparsed): [[[0.29843765499999997,0.35885106,0.58057084],[0.47020492,0.2707986,0.530824465]]]

Actual:   [[[0.2985, 0.3589, 0.5806], [0.4703, 0.2708, 0.5309]]]

Expected: [[[0.2985, 0.3589, 0.5806], [0.4703, 0.2708, 0.5309]]]