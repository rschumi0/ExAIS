import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add45809 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add45809 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con54797 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Max60823 = tf.keras.layers.Input(shape=([1, 1]))
in1Max60823 = tf.keras.layers.Input(shape=([1, 1]))

Add45809 = keras.layers.Add(name = 'Add45809', )([in0Add45809,in1Add45809])
Con54797 = keras.layers.Concatenate(axis=3, name = 'Con54797', )([Add45809,in0Con54797])
Max60823 = keras.layers.Maximum(name = 'Max60823', )([in0Max60823,in1Max60823])
Res5944 = keras.layers.Reshape((1, 1, 1), name = 'Res5944', )(Max60823)
Ave29905 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave29905', )(Res5944)
Res31567 = keras.layers.Reshape((1, 1), name = 'Res31567', )(Ave29905)
Max71409 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='same', name = 'Max71409', )(Res31567)
Res52911 = keras.layers.Reshape((1, 1, 1), name = 'Res52911', )(Max71409)
Sep8289 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='valid', name = 'Sep8289', )(Res52911)
Zer15462 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer15462', )(Sep8289)
Max70558 = keras.layers.Maximum(name = 'Max70558', )([Con54797,Zer15462])
model = tf.keras.models.Model(inputs=[in0Add45809,in1Add45809,in0Con54797,in0Max60823,in1Max60823], outputs=Max70558)
w = model.get_layer('Sep8289').get_weights() 
w[0] = np.array([[[[0.174]]]])
w[1] = np.array([[[[0.1872, 0.1152, 0.2721]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep8289').set_weights(w) 
in0Add45809 = tf.constant([[[[0.6344], [0.965]]]])
in1Add45809 = tf.constant([[[[0.1659], [0.9372]]]])
in0Con54797 = tf.constant([[[[0.1849, 0.0006], [0.7219, 0.5376]]]])
in0Max60823 = tf.constant([[[0.461]]])
in1Max60823 = tf.constant([[[0.7174]]])
print (np.array2string(model.predict([in0Add45809,in1Add45809,in0Con54797,in0Max60823,in1Max60823],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max70558.png')

LAdd45809 = add_layer([[[[[0.6344], [0.965]]]], [[[[0.1659], [0.9372]]]]], Add45809), 
LCon54797 = concatenate_layer([Add45809,[[[[0.1849, 0.0006], [0.7219, 0.5376]]]]], 3, Con54797), 
LMax60823 = maximum_layer([[[[0.461]]], [[[0.7174]]]], Max60823), 
LRes5944 = reshape_layer(Max60823, [1, 1, 1], Res5944), 
LAve29905 = average_pooling2D_layer(Res5944, 1, 1, Ave29905), 
LRes31567 = reshape_layer(Ave29905, [1, 1], Res31567), 
LMax71409 = max_pool1D_layer(Res31567, 1, 1, true, Max71409), 
LRes52911 = reshape_layer(Max71409, [1, 1, 1], Res52911), 
LSep8289 = separable_conv2D_layer(Res52911, 1, 1,[[[[[0.174]]]],[[[[0.1872, 0.1152, 0.2721]]]]],[0, 0, 0], 1, 1, false, Sep8289), 
LZer15462 = zero_padding2D_layer(Sep8289, 0, 0, 1, 0, Zer15462), 
LMax70558 = maximum_layer([Con54797,Zer15462], Max70558), 
exec_layers([LAdd45809,LCon54797,LMax60823,LRes5944,LAve29905,LRes31567,LMax71409,LRes52911,LSep8289,LZer15462,LMax70558],["Add45809","Con54797","Max60823","Res5944","Ave29905","Res31567","Max71409","Res52911","Sep8289","Zer15462","Max70558"],Max70558,"Max70558")

Actual (Unparsed): [[[[0.8003000, 0.1849000, 0.0006000], [1.9022000, 0.7219000, 0.5376000]]]]

Expected (Unparsed): [[[[0.8003,0.1849,0.0006],[1.9022000000000001,0.7219,0.5376]]]]

Actual:   [[[[0.8003, 0.1849, 0.0006], [1.9022, 0.7219, 0.5376]]]]

Expected: [[[[0.8003, 0.1849, 0.0006], [1.9023, 0.7219, 0.5376]]]]