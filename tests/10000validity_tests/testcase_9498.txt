import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max96803 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max96803 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Fla28692 = tf.keras.layers.Input(shape=([1]))
in0Con22895 = tf.keras.layers.Input(shape=([3]))
in0Con43696 = tf.keras.layers.Input(shape=([4, 3, 1]))
in0Add83540 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add83540 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Up_3513 = tf.keras.layers.Input(shape=([4, 1, 3]))
in0Sub49143 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub49143 = tf.keras.layers.Input(shape=([3, 3]))
in0Con14772 = tf.keras.layers.Input(shape=([8, 3]))

Max96803 = keras.layers.Maximum(name = 'Max96803', )([in0Max96803,in1Max96803])
Res42731 = keras.layers.Reshape((2, 2), name = 'Res42731', )(Max96803)
Fla82910 = keras.layers.Flatten(name = 'Fla82910', )(Res42731)
Fla28692 = keras.layers.Flatten(name = 'Fla28692', )(in0Fla28692)
Con22895 = keras.layers.Concatenate(axis=1, name = 'Con22895', )([Fla28692,in0Con22895])
Mul55481 = keras.layers.Multiply(name = 'Mul55481', )([Fla82910,Con22895])
Res80346 = keras.layers.Reshape((4, 1), name = 'Res80346', )(Mul55481)
Res69461 = keras.layers.Reshape((4, 1, 1), name = 'Res69461', )(Res80346)
Zer19791 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer19791', )(Res69461)
Con43696 = keras.layers.Concatenate(axis=3, name = 'Con43696', )([Zer19791,in0Con43696])
Add83540 = keras.layers.Add(name = 'Add83540', )([in0Add83540,in1Add83540])
Zer8300 = keras.layers.ZeroPadding2D(padding=((3, 0), (1, 0)), name = 'Zer8300', )(Add83540)
Mul1116 = keras.layers.Multiply(name = 'Mul1116', )([Con43696,Zer8300])
Res52107 = keras.layers.Reshape((4, 6), name = 'Res52107', )(Mul1116)
Zer33947 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer33947', )(Res52107)
Up_3513 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_3513', )(in0Up_3513)
Res71578 = keras.layers.Reshape((8, 3), name = 'Res71578', )(Up_3513)
Sub49143 = keras.layers.Subtract(name = 'Sub49143', )([in0Sub49143,in1Sub49143])
Zer56996 = keras.layers.ZeroPadding1D(padding=((5, 0)), name = 'Zer56996', )(Sub49143)
Ave73358 = keras.layers.Average(name = 'Ave73358', )([Res71578,Zer56996])
Con14772 = keras.layers.Concatenate(axis=2, name = 'Con14772', )([Ave73358,in0Con14772])
Sub95322 = keras.layers.Subtract(name = 'Sub95322', )([Zer33947,Con14772])
Sim39801 = keras.layers.SimpleRNN(2,name = 'Sim39801', )(Sub95322)
model = tf.keras.models.Model(inputs=[in0Max96803,in1Max96803,in0Fla28692,in0Con22895,in0Con43696,in0Add83540,in1Add83540,in0Up_3513,in0Sub49143,in1Sub49143,in0Con14772], outputs=Sim39801)
w = model.get_layer('Sim39801').get_weights() 
w[0] = np.array([[7, 6], [10, 5], [6, 3], [1, 9], [1, 10], [9, 8]])
w[1] = np.array([[7, 9], [8, 7]])
w[2] = np.array([10, 1])
model.get_layer('Sim39801').set_weights(w) 
in0Max96803 = tf.constant([[[[0.5088, 0.303]], [[0.3071, 0.7382]]]])
in1Max96803 = tf.constant([[[[0.5736, 0.1457]], [[0.2424, 0.6713]]]])
in0Fla28692 = tf.constant([[1.1454]])
in0Con22895 = tf.constant([[0.1636, 0.0869, 0.5628]])
in0Con43696 = tf.constant([[[[0.4176], [0.7675], [0.0508]], [[0.4446], [0.0236], [0.0349]], [[0.9369], [0.2034], [0.3889]], [[0.8651], [0.6719], [0.6441]]]])
in0Add83540 = tf.constant([[[[0.2089, 0.2269], [0.9117, 0.0158]]]])
in1Add83540 = tf.constant([[[[0.8309, 0.2079], [0.523, 0.5887]]]])
in0Up_3513 = tf.constant([[[[1.3513, 1.2839, 1.8386]], [[1.4774, 1.0386, 1.3115]], [[1.3818, 1.9839, 1.5768]], [[1.8962, 1.837, 1.658]]]])
in0Sub49143 = tf.constant([[[0.2546, 0.4202, 0.5063], [0.2428, 0.0884, 0.3888], [0.9122, 0.7067, 0.727]]])
in1Sub49143 = tf.constant([[[0.7827, 0.4641, 0.7321], [0.1363, 0.2925, 0.4007], [0.9892, 0.7432, 0.2818]]])
in0Con14772 = tf.constant([[[0.1682, 0.9927, 0.6583], [0.0678, 0.2616, 0.2583], [0.1796, 0.4569, 0.353], [0.7977, 0.4352, 0.6311], [0.9612, 0.6389, 0.663], [0.1269, 0.6196, 0.4649], [0.9319, 0.0411, 0.6854], [0.2299, 0.4164, 0.1624]]])
print (np.array2string(model.predict([in0Max96803,in1Max96803,in0Fla28692,in0Con22895,in0Con43696,in0Add83540,in1Add83540,in0Up_3513,in0Sub49143,in1Sub49143,in0Con14772],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim39801.png')

LMax96803 = maximum_layer([[[[[0.5088, 0.303]], [[0.3071, 0.7382]]]], [[[[0.5736, 0.1457]], [[0.2424, 0.6713]]]]], Max96803), 
LRes42731 = reshape_layer(Max96803, [2, 2], Res42731), 
LFla82910 = flatten_layer(Res42731, Fla82910), 
LFla28692 = flatten_layer([[1.1454]], Fla28692), 
LCon22895 = concatenate_layer([Fla28692,[[0.1636, 0.0869, 0.5628]]], 1, Con22895), 
LMul55481 = multiply_layer([Fla82910,Con22895], Mul55481), 
LRes80346 = reshape_layer(Mul55481, [4, 1], Res80346), 
LRes69461 = reshape_layer(Res80346, [4, 1, 1], Res69461), 
LZer19791 = zero_padding2D_layer(Res69461, 0, 0, 2, 0, Zer19791), 
LCon43696 = concatenate_layer([Zer19791,[[[[0.4176], [0.7675], [0.0508]], [[0.4446], [0.0236], [0.0349]], [[0.9369], [0.2034], [0.3889]], [[0.8651], [0.6719], [0.6441]]]]], 3, Con43696), 
LAdd83540 = add_layer([[[[[0.2089, 0.2269], [0.9117, 0.0158]]]], [[[[0.8309, 0.2079], [0.523, 0.5887]]]]], Add83540), 
LZer8300 = zero_padding2D_layer(Add83540, 3, 0, 1, 0, Zer8300), 
LMul1116 = multiply_layer([Con43696,Zer8300], Mul1116), 
LRes52107 = reshape_layer(Mul1116, [4, 6], Res52107), 
LZer33947 = zero_padding1D_layer(Res52107, 4, 0, Zer33947), 
LUp_3513 = up_sampling2D_layer([[[[1.3513, 1.2839, 1.8386]], [[1.4774, 1.0386, 1.3115]], [[1.3818, 1.9839, 1.5768]], [[1.8962, 1.837, 1.658]]]], 2, 1, Up_3513), 
LRes71578 = reshape_layer(Up_3513, [8, 3], Res71578), 
LSub49143 = subtract_layer([[[0.2546, 0.4202, 0.5063], [0.2428, 0.0884, 0.3888], [0.9122, 0.7067, 0.727]]], [[[0.7827, 0.4641, 0.7321], [0.1363, 0.2925, 0.4007], [0.9892, 0.7432, 0.2818]]], Sub49143), 
LZer56996 = zero_padding1D_layer(Sub49143, 5, 0, Zer56996), 
LAve73358 = average_layer([Res71578,Zer56996], Ave73358), 
LCon14772 = concatenate_layer([Ave73358,[[[0.1682, 0.9927, 0.6583], [0.0678, 0.2616, 0.2583], [0.1796, 0.4569, 0.353], [0.7977, 0.4352, 0.6311], [0.9612, 0.6389, 0.663], [0.1269, 0.6196, 0.4649], [0.9319, 0.0411, 0.6854], [0.2299, 0.4164, 0.1624]]]], 2, Con14772), 
LSub95322 = subtract_layer(Zer33947,Con14772, Sub95322), 
LSim39801 = simple_rnn_layer(Sub95322,[[7, 6], [10, 5], [6, 3], [1, 9], [1, 10], [9, 8]],[[7, 9], [8, 7]],[10, 1], Sim39801), 
exec_layers([LMax96803,LRes42731,LFla82910,LFla28692,LCon22895,LMul55481,LRes80346,LRes69461,LZer19791,LCon43696,LAdd83540,LZer8300,LMul1116,LRes52107,LZer33947,LUp_3513,LRes71578,LSub49143,LZer56996,LAve73358,LCon14772,LSub95322,LSim39801],["Max96803","Res42731","Fla82910","Fla28692","Con22895","Mul55481","Res80346","Res69461","Zer19791","Con43696","Add83540","Zer8300","Mul1116","Res52107","Zer33947","Up_3513","Res71578","Sub49143","Zer56996","Ave73358","Con14772","Sub95322","Sim39801"],Sim39801,"Sim39801")

Actual (Unparsed): [[-1.0000000, -1.0000000]]

Expected (Unparsed): [[-1.0,-1.0]]

Actual:   [[-1, -1]]

Expected: [[-1, -1]]