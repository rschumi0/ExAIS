import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_26209 = tf.keras.layers.Input(shape=([4, 3]))
in0Ave39299 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Ave39299 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Up_26209 = keras.layers.UpSampling1D(size=(1), name = 'Up_26209', )(in0Up_26209)
Res71840 = keras.layers.Reshape((4, 3, 1), name = 'Res71840', )(Up_26209)
Res50731 = keras.layers.Reshape((4, 3, 1, 1), name = 'Res50731', )(Res71840)
Ave39299 = keras.layers.Average(name = 'Ave39299', )([in0Ave39299,in1Ave39299])
Zer49902 = keras.layers.ZeroPadding3D(padding=((3, 0), (2, 0), (0, 0)), name = 'Zer49902', )(Ave39299)
Add35887 = keras.layers.Add(name = 'Add35887', )([Res50731,Zer49902])
Res62529 = keras.layers.Reshape((4, 3, 1), name = 'Res62529', )(Add35887)
Ave91223 = keras.layers.AveragePooling2D(pool_size=(4, 3), strides=(1, 3), padding='same', name = 'Ave91223', )(Res62529)
Sof91165 = keras.layers.Softmax(axis=1, name = 'Sof91165', )(Ave91223)
model = tf.keras.models.Model(inputs=[in0Up_26209,in0Ave39299,in1Ave39299], outputs=Sof91165)
in0Up_26209 = tf.constant([[[1.8561, 1.4952, 1.9663], [1.5698, 1.6181, 1.3793], [1.9316, 1.4571, 1.7385], [1.479, 1.1747, 1.8404]]])
in0Ave39299 = tf.constant([[[[[0.2105]]]]])
in1Ave39299 = tf.constant([[[[[0.882]]]]])
print (np.array2string(model.predict([in0Up_26209,in0Ave39299,in1Ave39299],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof91165.png')

LUp_26209 = up_sampling1D_layer([[[1.8561, 1.4952, 1.9663], [1.5698, 1.6181, 1.3793], [1.9316, 1.4571, 1.7385], [1.479, 1.1747, 1.8404]]], 1, Up_26209), 
LRes71840 = reshape_layer(Up_26209, [4, 3, 1], Res71840), 
LRes50731 = reshape_layer(Res71840, [4, 3, 1, 1], Res50731), 
LAve39299 = average_layer([[[[[[0.2105]]]]], [[[[[0.882]]]]]], Ave39299), 
LZer49902 = zero_padding3D_layer(Ave39299, 3, 0, 2, 0, 0, 0, Zer49902), 
LAdd35887 = add_layer([Res50731,Zer49902], Add35887), 
LRes62529 = reshape_layer(Add35887, [4, 3, 1], Res62529), 
LAve91223 = average_pooling2D_layer(Res62529, 4, 3, 1, 3, true, Ave91223), 
LSof91165 = softmax_layer(Ave91223, 1, Sof91165), 
exec_layers([LUp_26209,LRes71840,LRes50731,LAve39299,LZer49902,LAdd35887,LRes62529,LAve91223,LSof91165],["Up_26209","Res71840","Res50731","Ave39299","Zer49902","Add35887","Res62529","Ave91223","Sof91165"],Sof91165,"Sof91165")

Actual (Unparsed): [[[[0.2500221]], [[0.2507806]], [[0.2424375]], [[0.2567598]]]]

Expected (Unparsed): [[[[0.25002211197722385]],[[0.25078061886665237]],[[0.24243746632643107]],[[0.25675980282969274]]]]

Actual:   [[[[0.2501]], [[0.2508]], [[0.2425]], [[0.2568]]]]

Expected: [[[[0.2501]], [[0.2508]], [[0.2425]], [[0.2568]]]]