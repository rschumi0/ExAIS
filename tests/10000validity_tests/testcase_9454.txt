import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave8264 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave8264 = tf.keras.layers.Input(shape=([1, 1]))
in0Con75930 = tf.keras.layers.Input(shape=([1, 8]))
in0Ave35518 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave35518 = tf.keras.layers.Input(shape=([2, 2]))

Ave8264 = keras.layers.Average(name = 'Ave8264', )([in0Ave8264,in1Ave8264])
Fla93541 = keras.layers.Flatten(name = 'Fla93541', )(Ave8264)
Res28898 = keras.layers.Reshape((1, 1), name = 'Res28898', )(Fla93541)
Res26203 = keras.layers.Reshape((1, 1, 1), name = 'Res26203', )(Res28898)
Dep26871 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep26871', )(Res26203)
Res86633 = keras.layers.Reshape((1, 1), name = 'Res86633', )(Dep26871)
Con75930 = keras.layers.Concatenate(axis=2, name = 'Con75930', )([Res86633,in0Con75930])
Ave35518 = keras.layers.Average(name = 'Ave35518', )([in0Ave35518,in1Ave35518])
Fla58923 = keras.layers.Flatten(name = 'Fla58923', )(Ave35518)
Res17675 = keras.layers.Reshape((4, 1), name = 'Res17675', )(Fla58923)
Res20253 = keras.layers.Reshape((4, 1, 1), name = 'Res20253', )(Res17675)
Res45767 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res45767', )(Res20253)
Zer39839 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer39839', )(Res45767)
Res31397 = keras.layers.Reshape((6, 3, 3), name = 'Res31397', )(Zer39839)
Res42330 = keras.layers.Reshape((6, 9), name = 'Res42330', )(Res31397)
Dot45862 = keras.layers.Dot(axes=(2, 2), name = 'Dot45862', )([Con75930,Res42330])
ELU77927 = keras.layers.ELU(alpha=6.283129435331002, name = 'ELU77927', )(Dot45862)
model = tf.keras.models.Model(inputs=[in0Ave8264,in1Ave8264,in0Con75930,in0Ave35518,in1Ave35518], outputs=ELU77927)
w = model.get_layer('Dep26871').get_weights() 
w[0] = np.array([[[[0.2605]]]])
w[1] = np.array([0])
model.get_layer('Dep26871').set_weights(w) 
in0Ave8264 = tf.constant([[[0.9407]]])
in1Ave8264 = tf.constant([[[0.9289]]])
in0Con75930 = tf.constant([[[0.737, 0.8849, 0.8142, 0.6829, 0.6209, 0.353, 0.1941, 0.2629]]])
in0Ave35518 = tf.constant([[[0.4563, 0.2394], [0.41, 0.9211]]])
in1Ave35518 = tf.constant([[[0.4393, 0.2984], [0.0262, 0.9692]]])
print (np.array2string(model.predict([in0Ave8264,in1Ave8264,in0Con75930,in0Ave35518,in1Ave35518],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU77927.png')

LAve8264 = average_layer([[[[0.9407]]], [[[0.9289]]]], Ave8264), 
LFla93541 = flatten_layer(Ave8264, Fla93541), 
LRes28898 = reshape_layer(Fla93541, [1, 1], Res28898), 
LRes26203 = reshape_layer(Res28898, [1, 1, 1], Res26203), 
LDep26871 = depthwise_conv2D_layer(Res26203, 1, 1,[[[[0.2605]]]],[0], 1, 1, true, Dep26871), 
LRes86633 = reshape_layer(Dep26871, [1, 1], Res86633), 
LCon75930 = concatenate_layer([Res86633,[[[0.737, 0.8849, 0.8142, 0.6829, 0.6209, 0.353, 0.1941, 0.2629]]]], 2, Con75930), 
LAve35518 = average_layer([[[[0.4563, 0.2394], [0.41, 0.9211]]], [[[0.4393, 0.2984], [0.0262, 0.9692]]]], Ave35518), 
LFla58923 = flatten_layer(Ave35518, Fla58923), 
LRes17675 = reshape_layer(Fla58923, [4, 1], Res17675), 
LRes20253 = reshape_layer(Res17675, [4, 1, 1], Res20253), 
LRes45767 = reshape_layer(Res20253, [4, 1, 1, 1], Res45767), 
LZer39839 = zero_padding3D_layer(Res45767, 1, 1, 1, 1, 1, 1, Zer39839), 
LRes31397 = reshape_layer(Zer39839, [6, 3, 3], Res31397), 
LRes42330 = reshape_layer(Res31397, [6, 9], Res42330), 
LDot45862 = dot_layer(Con75930,Res42330, 2, 2, Dot45862), 
LELU77927 = elu_layer(Dot45862, 6.283129435331002, ELU77927), 
exec_layers([LAve8264,LFla93541,LRes28898,LRes26203,LDep26871,LRes86633,LCon75930,LAve35518,LFla58923,LRes17675,LRes20253,LRes45767,LZer39839,LRes31397,LRes42330,LDot45862,LELU77927],["Ave8264","Fla93541","Res28898","Res26203","Dep26871","Res86633","Con75930","Ave35518","Fla58923","Res17675","Res20253","Res45767","Zer39839","Res31397","Res42330","Dot45862","ELU77927"],ELU77927,"ELU77927")

Actual (Unparsed): [[[0.0000000, 0.3058026, 0.1836318, 0.1489405, 0.6454430, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.30580261999999997,0.18363181,0.14894048999999998,0.6454429349999999,0.0]]]

Actual:   [[[0, 0.3059, 0.1837, 0.149, 0.6455, 0]]]

Expected: [[[0, 0.3059, 0.1837, 0.149, 0.6455, 0]]]