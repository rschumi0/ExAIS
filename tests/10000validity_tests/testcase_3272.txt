import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST65024 = tf.keras.layers.Input(shape=([3, 2]))

LST65024 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST65024', )(in0LST65024)
Res25792 = keras.layers.Reshape((2, 1), name = 'Res25792', )(LST65024)
Res84682 = keras.layers.Reshape((2, 1, 1), name = 'Res84682', )(Res25792)
Glo36678 = keras.layers.GlobalMaxPool2D(name = 'Glo36678', )(Res84682)
model = tf.keras.models.Model(inputs=[in0LST65024], outputs=Glo36678)
w = model.get_layer('LST65024').get_weights() 
w[0] = np.array([[6, 5, 10, 10, 9, 4, 3, 8], [7, 8, 6, 3, 7, 4, 9, 4]])
w[1] = np.array([[9, 7, 8, 7, 9, 4, 1, 6], [5, 10, 6, 7, 1, 3, 2, 10]])
w[2] = np.array([7, 5, 1, 8, 10, 8, 9, 8])
model.get_layer('LST65024').set_weights(w) 
in0LST65024 = tf.constant([[[7, 10], [10, 6], [2, 8]]])
print (np.array2string(model.predict([in0LST65024],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo36678.png')

LLST65024 = lstm_layer([[[7, 10], [10, 6], [2, 8]]],[[6, 5, 10, 10, 9, 4, 3, 8], [7, 8, 6, 3, 7, 4, 9, 4]],[[9, 7, 8, 7, 9, 4, 1, 6], [5, 10, 6, 7, 1, 3, 2, 10]],[7, 5, 1, 8, 10, 8, 9, 8], LST65024), 
LRes25792 = reshape_layer(LST65024, [2, 1], Res25792), 
LRes84682 = reshape_layer(Res25792, [2, 1, 1], Res84682), 
LGlo36678 = global_max_pool2D_layer(Res84682, Glo36678), 
exec_layers([LLST65024,LRes25792,LRes84682,LGlo36678],["LST65024","Res25792","Res84682","Glo36678"],Glo36678,"Glo36678")

Actual (Unparsed): [[0.9950548]]

Expected (Unparsed): [[0.9950547536867305]]

Actual:   [[0.9951]]

Expected: [[0.9951]]