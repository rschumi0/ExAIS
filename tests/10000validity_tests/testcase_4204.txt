import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min13177 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Min13177 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Min13177 = keras.layers.Minimum(name = 'Min13177', )([in0Min13177,in1Min13177])
Res14186 = keras.layers.Reshape((1, 1, 2), name = 'Res14186', )(Min13177)
Sep85678 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='same', name = 'Sep85678', )(Res14186)
model = tf.keras.models.Model(inputs=[in0Min13177,in1Min13177], outputs=Sep85678)
w = model.get_layer('Sep85678').get_weights() 
w[0] = np.array([[[[0.8785], [0.9615]]]])
w[1] = np.array([[[[0.2653, 0.4136], [0.7446, 0.2585]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep85678').set_weights(w) 
in0Min13177 = tf.constant([[[[[0.9695, 0.6458]]]]])
in1Min13177 = tf.constant([[[[[0.9967, 0.1873]]]]])
print (np.array2string(model.predict([in0Min13177,in1Min13177],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep85678.png')

LMin13177 = minimum_layer([[[[[[0.9695, 0.6458]]]]], [[[[[0.9967, 0.1873]]]]]], Min13177), 
LRes14186 = reshape_layer(Min13177, [1, 1, 2], Res14186), 
LSep85678 = separable_conv2D_layer(Res14186, 1, 1,[[[[[0.8785], [0.9615]]]],[[[[0.2653, 0.4136], [0.7446, 0.2585]]]]],[0, 0], 1, 1, true, Sep85678), 
exec_layers([LMin13177,LRes14186,LSep85678],["Min13177","Res14186","Sep85678"],Sep85678,"Sep85678")

Actual (Unparsed): [[[[0.3600518, 0.3988185]]]]

Expected (Unparsed): [[[[0.36005176764499996,0.39881849177499995]]]]

Actual:   [[[[0.3601, 0.3989]]]]

Expected: [[[[0.3601, 0.3989]]]]