import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo52010 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Con38376 = tf.keras.layers.Input(shape=([3, 2, 1]))
in0Sub88603 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub88603 = tf.keras.layers.Input(shape=([3, 2, 2]))
in0Min87796 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Min87796 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Min46421 = tf.keras.layers.Input(shape=([2, 1]))
in1Min46421 = tf.keras.layers.Input(shape=([2, 1]))
in0Con84959 = tf.keras.layers.Input(shape=([2, 3]))
in0Con95844 = tf.keras.layers.Input(shape=([2, 4, 1]))
in0Sub92532 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub92532 = tf.keras.layers.Input(shape=([2, 2, 2]))

Glo52010 = keras.layers.GlobalMaxPool3D(name = 'Glo52010', )(in0Glo52010)
Res91566 = keras.layers.Reshape((2, 1), name = 'Res91566', )(Glo52010)
Res67229 = keras.layers.Reshape((2, 1, 1), name = 'Res67229', )(Res91566)
Zer19869 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer19869', )(Res67229)
Con38376 = keras.layers.Concatenate(axis=3, name = 'Con38376', )([Zer19869,in0Con38376])
Sub88603 = keras.layers.Subtract(name = 'Sub88603', )([in0Sub88603,in1Sub88603])
Ave10321 = keras.layers.Average(name = 'Ave10321', )([Con38376,Sub88603])
Zer88865 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer88865', )(Ave10321)
Min87796 = keras.layers.Minimum(name = 'Min87796', )([in0Min87796,in1Min87796])
Res6015 = keras.layers.Reshape((2, 2, 2), name = 'Res6015', )(Min87796)
Res97768 = keras.layers.Reshape((2, 4), name = 'Res97768', )(Res6015)
Min46421 = keras.layers.Minimum(name = 'Min46421', )([in0Min46421,in1Min46421])
Con84959 = keras.layers.Concatenate(axis=2, name = 'Con84959', )([Min46421,in0Con84959])
Sub92301 = keras.layers.Subtract(name = 'Sub92301', )([Res97768,Con84959])
Res15277 = keras.layers.Reshape((2, 4, 1), name = 'Res15277', )(Sub92301)
Con95844 = keras.layers.Concatenate(axis=3, name = 'Con95844', )([Res15277,in0Con95844])
Sub92532 = keras.layers.Subtract(name = 'Sub92532', )([in0Sub92532,in1Sub92532])
Zer3317 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer3317', )(Sub92532)
Ave60425 = keras.layers.Average(name = 'Ave60425', )([Con95844,Zer3317])
Zer95554 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer95554', )(Ave60425)
Sub96961 = keras.layers.Subtract(name = 'Sub96961', )([Zer88865,Zer95554])
model = tf.keras.models.Model(inputs=[in0Glo52010,in0Con38376,in0Sub88603,in1Sub88603,in0Min87796,in1Min87796,in0Min46421,in1Min46421,in0Con84959,in0Con95844,in0Sub92532,in1Sub92532], outputs=Sub96961)
in0Glo52010 = tf.constant([[[[[1.6153, 1.0494]], [[1.6436, 1.2244]]]]])
in0Con38376 = tf.constant([[[[0.4473], [0.7079]], [[0.5672], [0.0376]], [[0.6294], [0.0181]]]])
in0Sub88603 = tf.constant([[[[0.1031, 0.9533], [0.0083, 0.762]], [[0.7034, 0.2687], [0.6257, 0.272]], [[0.3252, 0.5361], [0.1067, 0.2454]]]])
in1Sub88603 = tf.constant([[[[0.2314, 0.7552], [0.2991, 0.8921]], [[0.0167, 0.476], [0.9472, 0.5136]], [[0.3386, 0.2602], [0.7003, 0.9076]]]])
in0Min87796 = tf.constant([[[[[0.2574], [0.4181]], [[0.7539], [0.1277]]], [[[0.6592], [0.3327]], [[0.6701], [0.5954]]]]])
in1Min87796 = tf.constant([[[[[0.3849], [0.8738]], [[0.2112], [0.5154]]], [[[0.3682], [0.3727]], [[0.3409], [0.7798]]]]])
in0Min46421 = tf.constant([[[0.2995], [0.378]]])
in1Min46421 = tf.constant([[[0.9032], [0.066]]])
in0Con84959 = tf.constant([[[0.3517, 0.5063, 0.8299], [0.2757, 0.9648, 0.1466]]])
in0Con95844 = tf.constant([[[[0.9956], [0.5575], [0.618], [0.1673]], [[0.438], [0.0369], [0.5624], [0.9798]]]])
in0Sub92532 = tf.constant([[[[0.0737, 0.9489], [0.8704, 0.6261]], [[0.5549, 0.5519], [0.4674, 0.3509]]]])
in1Sub92532 = tf.constant([[[[0.9977, 0.7246], [0.9249, 0.046]], [[0.8004, 0.5436], [0.0951, 0.5039]]]])
print (np.array2string(model.predict([in0Glo52010,in0Con38376,in0Sub88603,in1Sub88603,in0Min87796,in1Min87796,in0Min46421,in1Min46421,in0Con84959,in0Con95844,in0Sub92532,in1Sub92532],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub96961.png')

LGlo52010 = global_max_pool3D_layer([[[[[1.6153, 1.0494]], [[1.6436, 1.2244]]]]], Glo52010), 
LRes91566 = reshape_layer(Glo52010, [2, 1], Res91566), 
LRes67229 = reshape_layer(Res91566, [2, 1, 1], Res67229), 
LZer19869 = zero_padding2D_layer(Res67229, 1, 0, 1, 0, Zer19869), 
LCon38376 = concatenate_layer([Zer19869,[[[[0.4473], [0.7079]], [[0.5672], [0.0376]], [[0.6294], [0.0181]]]]], 3, Con38376), 
LSub88603 = subtract_layer([[[[0.1031, 0.9533], [0.0083, 0.762]], [[0.7034, 0.2687], [0.6257, 0.272]], [[0.3252, 0.5361], [0.1067, 0.2454]]]], [[[[0.2314, 0.7552], [0.2991, 0.8921]], [[0.0167, 0.476], [0.9472, 0.5136]], [[0.3386, 0.2602], [0.7003, 0.9076]]]], Sub88603), 
LAve10321 = average_layer([Con38376,Sub88603], Ave10321), 
LZer88865 = zero_padding2D_layer(Ave10321, 0, 0, 4, 0, Zer88865), 
LMin87796 = minimum_layer([[[[[[0.2574], [0.4181]], [[0.7539], [0.1277]]], [[[0.6592], [0.3327]], [[0.6701], [0.5954]]]]], [[[[[0.3849], [0.8738]], [[0.2112], [0.5154]]], [[[0.3682], [0.3727]], [[0.3409], [0.7798]]]]]], Min87796), 
LRes6015 = reshape_layer(Min87796, [2, 2, 2], Res6015), 
LRes97768 = reshape_layer(Res6015, [2, 4], Res97768), 
LMin46421 = minimum_layer([[[[0.2995], [0.378]]], [[[0.9032], [0.066]]]], Min46421), 
LCon84959 = concatenate_layer([Min46421,[[[0.3517, 0.5063, 0.8299], [0.2757, 0.9648, 0.1466]]]], 2, Con84959), 
LSub92301 = subtract_layer(Res97768,Con84959, Sub92301), 
LRes15277 = reshape_layer(Sub92301, [2, 4, 1], Res15277), 
LCon95844 = concatenate_layer([Res15277,[[[[0.9956], [0.5575], [0.618], [0.1673]], [[0.438], [0.0369], [0.5624], [0.9798]]]]], 3, Con95844), 
LSub92532 = subtract_layer([[[[0.0737, 0.9489], [0.8704, 0.6261]], [[0.5549, 0.5519], [0.4674, 0.3509]]]], [[[[0.9977, 0.7246], [0.9249, 0.046]], [[0.8004, 0.5436], [0.0951, 0.5039]]]], Sub92532), 
LZer3317 = zero_padding2D_layer(Sub92532, 0, 0, 2, 0, Zer3317), 
LAve60425 = average_layer([Con95844,Zer3317], Ave60425), 
LZer95554 = zero_padding2D_layer(Ave60425, 1, 0, 2, 0, Zer95554), 
LSub96961 = subtract_layer(Zer88865,Zer95554, Sub96961), 
exec_layers([LGlo52010,LRes91566,LRes67229,LZer19869,LCon38376,LSub88603,LAve10321,LZer88865,LMin87796,LRes6015,LRes97768,LMin46421,LCon84959,LSub92301,LRes15277,LCon95844,LSub92532,LZer3317,LAve60425,LZer95554,LSub96961],["Glo52010","Res91566","Res67229","Zer19869","Con38376","Sub88603","Ave10321","Zer88865","Min87796","Res6015","Res97768","Min46421","Con84959","Sub92301","Res15277","Con95844","Sub92532","Zer3317","Ave60425","Zer95554","Sub96961"],Sub96961,"Sub96961")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [-0.0641500, 0.3227000], [-0.1454000, 0.2889000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0210500, -0.4978000], [-0.0332000, -0.2787500], [0.9529000, -0.2412000], [1.0394000, -0.4757000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [-0.1511000, -0.2190000], [-0.0285000, -0.0184500], [0.4280000, 0.1673000], [-0.0951500, -0.7354500]]]]

Expected (Unparsed): [[[[0,0],[0,0],[0,0],[0,0],[-0.06415,0.3227],[-0.1454,0.2889]],[[0,0],[0,0],[0.021049999999999985,-0.4978],[-0.03320000000000001,-0.27875],[0.9529000000000001,-0.24119999999999994],[1.0393999999999999,-0.47569999999999996]],[[0,0],[0,0],[-0.1511,-0.219],[-0.028499999999999998,-0.01845],[0.42800000000000005,0.1673],[-0.09515000000000001,-0.7354499999999999]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0], [0, 0], [-0.0641, 0.3227], [-0.1454, 0.2889]], [[0, 0], [0, 0], [0.0211, -0.4978], [-0.0332, -0.2787], [0.9529, -0.2412], [1.0394, -0.4757]], [[0, 0], [0, 0], [-0.1511, -0.219], [-0.0285, -0.0184], [0.428, 0.1673], [-0.0951, -0.7354]]]]

Expected: [[[[0, 0], [0, 0], [0, 0], [0, 0], [-0.0641, 0.3227], [-0.1454, 0.2889]], [[0, 0], [0, 0], [0.0211, -0.4978], [-0.0332, -0.2787], [0.953, -0.2411], [1.0394, -0.4756]], [[0, 0], [0, 0], [-0.1511, -0.219], [-0.0284, -0.0184], [0.4281, 0.1673], [-0.0951, -0.7354]]]]