import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL91906 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Add52840 = tf.keras.layers.Input(shape=([2, 1]))
in1Add52840 = tf.keras.layers.Input(shape=([2, 1]))
in0Con26238 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot22112 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot22112 = tf.keras.layers.Input(shape=([3, 3]))
in0Con45488 = tf.keras.layers.Input(shape=([3, 1]))

ReL91906 = keras.layers.ReLU(max_value=4.608471702679048, negative_slope=6.5363204483952675, threshold=8.16125228405313, name = 'ReL91906', input_shape=(1, 2, 2))(in0ReL91906)
ELU6855 = keras.layers.ELU(alpha=-8.686440614010511, name = 'ELU6855', )(ReL91906)
Res66300 = keras.layers.Reshape((1, 4), name = 'Res66300', )(ELU6855)
Zer6278 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer6278', )(Res66300)
Add52840 = keras.layers.Add(name = 'Add52840', )([in0Add52840,in1Add52840])
Max29219 = keras.layers.MaxPool1D(pool_size=(1), strides=(3), padding='same', name = 'Max29219', )(Add52840)
Zer4184 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer4184', )(Max29219)
Con26238 = keras.layers.Concatenate(axis=2, name = 'Con26238', )([Zer4184,in0Con26238])
Dot22112 = keras.layers.Dot(axes=(1, 1), name = 'Dot22112', )([in0Dot22112,in1Dot22112])
Add76073 = keras.layers.Add(name = 'Add76073', )([Con26238,Dot22112])
Con45488 = keras.layers.Concatenate(axis=2, name = 'Con45488', )([Add76073,in0Con45488])
Sub41870 = keras.layers.Subtract(name = 'Sub41870', )([Zer6278,Con45488])
model = tf.keras.models.Model(inputs=[in0ReL91906,in0Add52840,in1Add52840,in0Con26238,in0Dot22112,in1Dot22112,in0Con45488], outputs=Sub41870)
in0ReL91906 = tf.constant([[[[0.0685, 0.615], [0.6307, 0.8279]]]])
in0Add52840 = tf.constant([[[0.8519], [0.9934]]])
in1Add52840 = tf.constant([[[0.0204], [0.4307]]])
in0Con26238 = tf.constant([[[0.1807, 0.7612], [0.3515, 0.2318], [0.0943, 0.8736]]])
in0Dot22112 = tf.constant([[[0.425, 0.0838, 0.8275], [0.7062, 0.8897, 0.98], [0.8506, 0.2415, 0.1282]]])
in1Dot22112 = tf.constant([[[0.0408, 0.1833, 0.9959], [0.0716, 0.3325, 0.0626], [0.012, 0.4466, 0.4969]]])
in0Con45488 = tf.constant([[[0.4711], [0.064], [0.9973]]])
print (np.array2string(model.predict([in0ReL91906,in0Add52840,in1Add52840,in0Con26238,in0Dot22112,in1Dot22112,in0Con45488],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub41870.png')

LReL91906 = relu_layer([[[[0.0685, 0.615], [0.6307, 0.8279]]]], 4.608471702679048, 6.5363204483952675, 8.16125228405313, ReL91906), 
LELU6855 = elu_layer(ReL91906, -8.686440614010511, ELU6855), 
LRes66300 = reshape_layer(ELU6855, [1, 4], Res66300), 
LZer6278 = zero_padding1D_layer(Res66300, 1, 1, Zer6278), 
LAdd52840 = add_layer([[[[0.8519], [0.9934]]], [[[0.0204], [0.4307]]]], Add52840), 
LMax29219 = max_pool1D_layer(Add52840, 1, 3, true, Max29219), 
LZer4184 = zero_padding1D_layer(Max29219, 2, 0, Zer4184), 
LCon26238 = concatenate_layer([Zer4184,[[[0.1807, 0.7612], [0.3515, 0.2318], [0.0943, 0.8736]]]], 2, Con26238), 
LDot22112 = dot_layer([[[0.425, 0.0838, 0.8275], [0.7062, 0.8897, 0.98], [0.8506, 0.2415, 0.1282]]], [[[0.0408, 0.1833, 0.9959], [0.0716, 0.3325, 0.0626], [0.012, 0.4466, 0.4969]]], 1, 1, Dot22112), 
LAdd76073 = add_layer([Con26238,Dot22112], Add76073), 
LCon45488 = concatenate_layer([Add76073,[[[0.4711], [0.064], [0.9973]]]], 2, Con45488), 
LSub41870 = subtract_layer(Zer6278,Con45488, Sub41870), 
exec_layers([LReL91906,LELU6855,LRes66300,LZer6278,LAdd52840,LMax29219,LZer4184,LCon26238,LDot22112,LAdd76073,LCon45488,LSub41870],["ReL91906","ELU6855","Res66300","Zer6278","Add52840","Max29219","Zer4184","Con26238","Dot22112","Add76073","Con45488","Sub41870"],Sub41870,"Sub41870")

Actual (Unparsed): [[[-0.0781111, -0.8732920, -1.6513288, -0.4711000], [8.6164211, 7.9159009, 8.1954876, 8.6224406], [-0.9777684, -0.6290849, -1.8227578, -0.9973000]]]

Expected (Unparsed): [[[-0.07811112,-0.8732919600000001,-1.6513287600000002,-0.4711],[8.61642105401051,7.915900924010511,8.19548762401051,8.622440614010511],[-0.9777684,-0.62908487,-1.82275783,-0.9973]]]

Actual:   [[[-0.0781, -0.8732, -1.6513, -0.4711], [8.6165, 7.916, 8.1955, 8.6225], [-0.9777, -0.629, -1.8227, -0.9973]]]

Expected: [[[-0.0781, -0.8732, -1.6513, -0.4711], [8.6165, 7.916, 8.1955, 8.6225], [-0.9777, -0.629, -1.8227, -0.9973]]]