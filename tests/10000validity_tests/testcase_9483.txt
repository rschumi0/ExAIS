import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer58434 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave77868 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave77868 = tf.keras.layers.Input(shape=([2, 1]))
in0Con38524 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave58321 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave58321 = tf.keras.layers.Input(shape=([2, 2, 2]))

Zer58434 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer58434', )(in0Zer58434)
Glo24084 = keras.layers.GlobalAveragePooling1D(name = 'Glo24084', )(Zer58434)
Res7094 = keras.layers.Reshape((1, 1), name = 'Res7094', )(Glo24084)
Zer13803 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer13803', )(Res7094)
Ave77868 = keras.layers.Average(name = 'Ave77868', )([in0Ave77868,in1Ave77868])
Sub70546 = keras.layers.Subtract(name = 'Sub70546', )([Zer13803,Ave77868])
Per66949 = keras.layers.Permute((2,1), name = 'Per66949',)(Sub70546)
Res55363 = keras.layers.Reshape((1, 2, 1), name = 'Res55363', )(Per66949)
Zer62096 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer62096', )(Res55363)
Con38524 = keras.layers.Concatenate(axis=3, name = 'Con38524', )([Zer62096,in0Con38524])
Ave58321 = keras.layers.Average(name = 'Ave58321', )([in0Ave58321,in1Ave58321])
Add31611 = keras.layers.Add(name = 'Add31611', )([Con38524,Ave58321])
model = tf.keras.models.Model(inputs=[in0Zer58434,in0Ave77868,in1Ave77868,in0Con38524,in0Ave58321,in1Ave58321], outputs=Add31611)
in0Zer58434 = tf.constant([[[1.5317], [1.4593]]])
in0Ave77868 = tf.constant([[[0.7474], [0.8187]]])
in1Ave77868 = tf.constant([[[0.9364], [0.0465]]])
in0Con38524 = tf.constant([[[[0.2134], [0.3848]], [[0.3067], [0.5753]]]])
in0Ave58321 = tf.constant([[[[0.6684, 0.212], [0.9387, 0.775]], [[0.5283, 0.1902], [0.2342, 0.8596]]]])
in1Ave58321 = tf.constant([[[[0.8765, 0.5453], [0.2299, 0.8614]], [[0.6985, 0.0894], [0.6518, 0.3255]]]])
print (np.array2string(model.predict([in0Zer58434,in0Ave77868,in1Ave77868,in0Con38524,in0Ave58321,in1Ave58321],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add31611.png')

LZer58434 = zero_padding1D_layer([[[1.5317], [1.4593]]], 1, 1, Zer58434), 
LGlo24084 = global_average_pooling1D_layer(Zer58434, Glo24084), 
LRes7094 = reshape_layer(Glo24084, [1, 1], Res7094), 
LZer13803 = zero_padding1D_layer(Res7094, 1, 0, Zer13803), 
LAve77868 = average_layer([[[[0.7474], [0.8187]]], [[[0.9364], [0.0465]]]], Ave77868), 
LSub70546 = subtract_layer(Zer13803,Ave77868, Sub70546), 
LPer66949 = permute_layer(Sub70546, 2,1, Per66949), 
LRes55363 = reshape_layer(Per66949, [1, 2, 1], Res55363), 
LZer62096 = zero_padding2D_layer(Res55363, 1, 0, 0, 0, Zer62096), 
LCon38524 = concatenate_layer([Zer62096,[[[[0.2134], [0.3848]], [[0.3067], [0.5753]]]]], 3, Con38524), 
LAve58321 = average_layer([[[[[0.6684, 0.212], [0.9387, 0.775]], [[0.5283, 0.1902], [0.2342, 0.8596]]]], [[[[0.8765, 0.5453], [0.2299, 0.8614]], [[0.6985, 0.0894], [0.6518, 0.3255]]]]], Ave58321), 
LAdd31611 = add_layer([Con38524,Ave58321], Add31611), 
exec_layers([LZer58434,LGlo24084,LRes7094,LZer13803,LAve77868,LSub70546,LPer66949,LRes55363,LZer62096,LCon38524,LAve58321,LAdd31611],["Zer58434","Glo24084","Res7094","Zer13803","Ave77868","Sub70546","Per66949","Res55363","Zer62096","Con38524","Ave58321","Add31611"],Add31611,"Add31611")

Actual (Unparsed): [[[[0.7724500, 0.5920500], [0.5843000, 1.2030000]], [[-0.2285000, 0.4465000], [0.7581500, 1.1678500]]]]

Expected (Unparsed): [[[[0.77245,0.59205],[0.5843,1.203]],[[-0.22850000000000004,0.4465],[0.7581500000000001,1.16785]]]]

Actual:   [[[[0.7725, 0.5921], [0.5843, 1.203]], [[-0.2285, 0.4465], [0.7582, 1.1679]]]]

Expected: [[[[0.7725, 0.5921], [0.5843, 1.203]], [[-0.2285, 0.4465], [0.7582, 1.1679]]]]