import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per55385 = tf.keras.layers.Input(shape=([2, 3]))
in0Sub46063 = tf.keras.layers.Input(shape=([3]))
in1Sub46063 = tf.keras.layers.Input(shape=([3]))
in0Con21490 = tf.keras.layers.Input(shape=([3, 1]))
in0Dot60613 = tf.keras.layers.Input(shape=([3]))
in1Dot60613 = tf.keras.layers.Input(shape=([3]))
in0Con21048 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave90743 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave90743 = tf.keras.layers.Input(shape=([1, 2]))

Per55385 = keras.layers.Permute((2,1), name = 'Per55385',)(in0Per55385)
Sub46063 = keras.layers.Subtract(name = 'Sub46063', )([in0Sub46063,in1Sub46063])
Res93348 = keras.layers.Reshape((3, 1), name = 'Res93348', )(Sub46063)
Cro92956 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro92956', )(Res93348)
Lay74463 = keras.layers.LayerNormalization(axis=2, epsilon=2.0868207628712687, name = 'Lay74463', )(Cro92956)
Con21490 = keras.layers.Concatenate(axis=2, name = 'Con21490', )([Lay74463,in0Con21490])
Min88881 = keras.layers.Minimum(name = 'Min88881', )([Per55385,Con21490])
Dot60613 = keras.layers.Dot(axes=(1, 1), name = 'Dot60613', )([in0Dot60613,in1Dot60613])
Res81447 = keras.layers.Reshape((1, 1), name = 'Res81447', )(Dot60613)
Con21048 = keras.layers.Concatenate(axis=2, name = 'Con21048', )([Res81447,in0Con21048])
Ave90743 = keras.layers.Average(name = 'Ave90743', )([in0Ave90743,in1Ave90743])
Min14080 = keras.layers.Minimum(name = 'Min14080', )([Con21048,Ave90743])
Zer61893 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer61893', )(Min14080)
Sub4692 = keras.layers.Subtract(name = 'Sub4692', )([Min88881,Zer61893])
model = tf.keras.models.Model(inputs=[in0Per55385,in0Sub46063,in1Sub46063,in0Con21490,in0Dot60613,in1Dot60613,in0Con21048,in0Ave90743,in1Ave90743], outputs=Sub4692)
in0Per55385 = tf.constant([[[1.469, 1.7654, 1.3605], [1.5574, 1.027, 1.3811]]])
in0Sub46063 = tf.constant([[0.5861, 0.946, 0.8603]])
in1Sub46063 = tf.constant([[0.4241, 0.5191, 0.0155]])
in0Con21490 = tf.constant([[[0.6158], [0.7476], [0.2088]]])
in0Dot60613 = tf.constant([[0.2451, 0.2464, 0.7324]])
in1Dot60613 = tf.constant([[0.1323, 0.3514, 0.9424]])
in0Con21048 = tf.constant([[[0.7795]]])
in0Ave90743 = tf.constant([[[0.0785, 0.7804]]])
in1Ave90743 = tf.constant([[[0.7828, 0.1515]]])
print (np.array2string(model.predict([in0Per55385,in0Sub46063,in1Sub46063,in0Con21490,in0Dot60613,in1Dot60613,in0Con21048,in0Ave90743,in1Ave90743],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub4692.png')

LPer55385 = permute_layer([[[1.469, 1.7654, 1.3605], [1.5574, 1.027, 1.3811]]], 2,1, Per55385), 
LSub46063 = subtract_layer([[0.5861, 0.946, 0.8603]], [[0.4241, 0.5191, 0.0155]], Sub46063), 
LRes93348 = reshape_layer(Sub46063, [3, 1], Res93348), 
LCro92956 = cropping1D_layer(Res93348, 0, 0, Cro92956), 
LLay74463 = layer_normalization_layer(Cro92956, 2, 2.0868207628712687, Lay74463), 
LCon21490 = concatenate_layer([Lay74463,[[[0.6158], [0.7476], [0.2088]]]], 2, Con21490), 
LMin88881 = minimum_layer([Per55385,Con21490], Min88881), 
LDot60613 = dot_layer([[0.2451, 0.2464, 0.7324]], [[0.1323, 0.3514, 0.9424]], 1, 1, Dot60613), 
LRes81447 = reshape_layer(Dot60613, [1, 1], Res81447), 
LCon21048 = concatenate_layer([Res81447,[[[0.7795]]]], 2, Con21048), 
LAve90743 = average_layer([[[[0.0785, 0.7804]]], [[[0.7828, 0.1515]]]], Ave90743), 
LMin14080 = minimum_layer([Con21048,Ave90743], Min14080), 
LZer61893 = zero_padding1D_layer(Min14080, 2, 0, Zer61893), 
LSub4692 = subtract_layer(Min88881,Zer61893, Sub4692), 
exec_layers([LPer55385,LSub46063,LRes93348,LCro92956,LLay74463,LCon21490,LMin88881,LDot60613,LRes81447,LCon21048,LAve90743,LMin14080,LZer61893,LSub4692],["Per55385","Sub46063","Res93348","Cro92956","Lay74463","Con21490","Min88881","Dot60613","Res81447","Con21048","Ave90743","Min14080","Zer61893","Sub4692"],Sub4692,"Sub4692")

Actual (Unparsed): [[[0.0000000, 0.6158000], [0.0000000, 0.7476000], [-0.4306500, -0.2571500]]]

Expected (Unparsed): [[[0.0,0.6158],[0.0,0.7476],[-0.43065000000000003,-0.25715]]]

Actual:   [[[0, 0.6158], [0, 0.7476], [-0.4306, -0.2571]]]

Expected: [[[0, 0.6158], [0, 0.7476], [-0.4306, -0.2571]]]