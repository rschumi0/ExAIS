import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub60399 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub60399 = tf.keras.layers.Input(shape=([3, 2]))
in0Con38728 = tf.keras.layers.Input(shape=([1, 1]))
in0Bat87097 = tf.keras.layers.Input(shape=([1, 2]))

Sub60399 = keras.layers.Subtract(name = 'Sub60399', )([in0Sub60399,in1Sub60399])
Res93152 = keras.layers.Reshape((3, 2, 1), name = 'Res93152', )(Sub60399)
Res1771 = keras.layers.Reshape((3, 2, 1, 1), name = 'Res1771', )(Res93152)
Glo4431 = keras.layers.GlobalMaxPool3D(name = 'Glo4431', )(Res1771)
Res69390 = keras.layers.Reshape((1, 1), name = 'Res69390', )(Glo4431)
Con38728 = keras.layers.Concatenate(axis=2, name = 'Con38728', )([Res69390,in0Con38728])
Bat87097 = keras.layers.BatchNormalization(axis=1, epsilon=0.3536067908321393,  name = 'Bat87097', )(in0Bat87097)
Sub59243 = keras.layers.Subtract(name = 'Sub59243', )([Con38728,Bat87097])
model = tf.keras.models.Model(inputs=[in0Sub60399,in1Sub60399,in0Con38728,in0Bat87097], outputs=Sub59243)
w = model.get_layer('Bat87097').get_weights() 
w[0] = np.array([0.7338])
w[1] = np.array([0.0104])
w[2] = np.array([0.8302])
w[3] = np.array([0.4412])
model.get_layer('Bat87097').set_weights(w) 
in0Sub60399 = tf.constant([[[0.9354, 0.1888], [0.391, 0.8447], [0.2876, 0.4972]]])
in1Sub60399 = tf.constant([[[0.1728, 0.8489], [0.3394, 0.115], [0.3731, 0.6719]]])
in0Con38728 = tf.constant([[[0.9699]]])
in0Bat87097 = tf.constant([[[1.4528, 1.4793]]])
print (np.array2string(model.predict([in0Sub60399,in1Sub60399,in0Con38728,in0Bat87097],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub59243.png')

LSub60399 = subtract_layer([[[0.9354, 0.1888], [0.391, 0.8447], [0.2876, 0.4972]]], [[[0.1728, 0.8489], [0.3394, 0.115], [0.3731, 0.6719]]], Sub60399), 
LRes93152 = reshape_layer(Sub60399, [3, 2, 1], Res93152), 
LRes1771 = reshape_layer(Res93152, [3, 2, 1, 1], Res1771), 
LGlo4431 = global_max_pool3D_layer(Res1771, Glo4431), 
LRes69390 = reshape_layer(Glo4431, [1, 1], Res69390), 
LCon38728 = concatenate_layer([Res69390,[[[0.9699]]]], 2, Con38728), 
LBat87097 = batch_normalization_layer([[[1.4528, 1.4793]]], 1, 0.3536067908321393, [0.7338], [0.0104], [0.8302], [0.4412], Bat87097), 
LSub59243 = subtract_layer(Con38728,Bat87097, Sub59243), 
exec_layers([LSub60399,LRes93152,LRes1771,LGlo4431,LRes69390,LCon38728,LBat87097,LSub59243],["Sub60399","Res93152","Res1771","Glo4431","Res69390","Con38728","Bat87097","Sub59243"],Sub59243,"Sub59243")

Actual (Unparsed): [[[0.2397446, 0.4252328]]]

Expected (Unparsed): [[[0.23974464087178748,0.42523277608396615]]]

Actual:   [[[0.2398, 0.4253]]]

Expected: [[[0.2398, 0.4253]]]