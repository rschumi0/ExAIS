import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep42332 = tf.keras.layers.Input(shape=([1, 2]))

Sep42332 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep42332', )(in0Sep42332)
Bat32740 = keras.layers.BatchNormalization(axis=1, epsilon=0.3717830016423467,  name = 'Bat32740', )(Sep42332)
Sof36594 = keras.layers.Softmax(axis=1, name = 'Sof36594', )(Bat32740)
Res5413 = keras.layers.Reshape((1, 4, 1), name = 'Res5413', )(Sof36594)
Loc44404 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 4), name = 'Loc44404', )(Res5413)
model = tf.keras.models.Model(inputs=[in0Sep42332], outputs=Loc44404)
w = model.get_layer('Sep42332').get_weights() 
w[0] = np.array([[[0.6085], [0.6095]]])
w[1] = np.array([[[0.2787, 0.9763, 0.5699, 0.1552], [0.0877, 0.8796, 0.1073, 0.7548]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep42332').set_weights(w) 
w = model.get_layer('Bat32740').get_weights() 
w[0] = np.array([0.4878])
w[1] = np.array([0.4024])
w[2] = np.array([0.6845])
w[3] = np.array([0.4918])
model.get_layer('Bat32740').set_weights(w) 
w = model.get_layer('Loc44404').get_weights() 
w[0] = np.array([[[0.1533, 0.2935, 0.3967]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc44404').set_weights(w) 
in0Sep42332 = tf.constant([[[0.3947, 0.6329]]])
print (np.array2string(model.predict([in0Sep42332],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc44404.png')

LSep42332 = separable_conv1D_layer([[[0.3947, 0.6329]]], 1,[[[[0.6085], [0.6095]]],[[[0.2787, 0.9763, 0.5699, 0.1552], [0.0877, 0.8796, 0.1073, 0.7548]]]],[0, 0, 0, 0], 1, false, Sep42332), 
LBat32740 = batch_normalization_layer(Sep42332, 1, 0.3717830016423467, [0.4878], [0.4024], [0.6845], [0.4918], Bat32740), 
LSof36594 = softmax_layer(Bat32740, 1, Sof36594), 
LRes5413 = reshape_layer(Sof36594, [1, 4, 1], Res5413), 
LLoc44404 = locally_connected2D_layer(Res5413, 1, 1,[[[0.1533, 0.2935, 0.3967]]],[[[0, 0, 0]]], 1, 4, Loc44404), 
exec_layers([LSep42332,LBat32740,LSof36594,LRes5413,LLoc44404],["Sep42332","Bat32740","Sof36594","Res5413","Loc44404"],Loc44404,"Loc44404")

Actual (Unparsed): [[[[0.1533000, 0.2935000, 0.3967000]]]]

Expected (Unparsed): [[[[0.1533,0.2935,0.3967]]]]

Actual:   [[[[0.1533, 0.2935, 0.3967]]]]

Expected: [[[[0.1533, 0.2935, 0.3967]]]]