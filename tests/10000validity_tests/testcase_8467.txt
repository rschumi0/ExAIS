import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe52924 = tf.keras.layers.Input(shape=([1, 1]))
in0Con10451 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot56673 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot56673 = tf.keras.layers.Input(shape=([3, 3]))
in0Cro89411 = tf.keras.layers.Input(shape=([4, 3]))

PRe52924 = keras.layers.PReLU(name = 'PRe52924', input_shape=(1, 1))(in0PRe52924)
Zer29464 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer29464', )(PRe52924)
Con10451 = keras.layers.Concatenate(axis=2, name = 'Con10451', )([Zer29464,in0Con10451])
Dot56673 = keras.layers.Dot(axes=(1, 2), name = 'Dot56673', )([in0Dot56673,in1Dot56673])
Add99585 = keras.layers.Add(name = 'Add99585', )([Con10451,Dot56673])
Cro89411 = keras.layers.Cropping1D(cropping=((3, 0)), name = 'Cro89411', )(in0Cro89411)
Zer76288 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer76288', )(Cro89411)
Mul46282 = keras.layers.Multiply(name = 'Mul46282', )([Add99585,Zer76288])
model = tf.keras.models.Model(inputs=[in0PRe52924,in0Con10451,in0Dot56673,in1Dot56673,in0Cro89411], outputs=Mul46282)
w = model.get_layer('PRe52924').get_weights() 
w[0] = np.array([[0.9319]])
model.get_layer('PRe52924').set_weights(w) 
in0PRe52924 = tf.constant([[[0.3525]]])
in0Con10451 = tf.constant([[[0.6398, 0.1637], [0.8861, 0.2059], [0.7688, 0.591]]])
in0Dot56673 = tf.constant([[[0.1023, 0.9275, 0.4993], [0.4848, 0.6873, 0.9132], [0.624, 0.0637, 0.5259]]])
in1Dot56673 = tf.constant([[[0.6705, 0.4912, 0.1605], [0.4245, 0.6701, 0.8389], [0.1713, 0.1756, 0.8144]]])
in0Cro89411 = tf.constant([[[1.4141, 1.9613, 1.1663], [1.8381, 1.3627, 1.8573], [1.5423, 1.9049, 1.6473], [1.8547, 1.8642, 1.2701]]])
print (np.array2string(model.predict([in0PRe52924,in0Con10451,in0Dot56673,in1Dot56673,in0Cro89411],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul46282.png')

LPRe52924 = prelu_layer([[[0.3525]]], [[0.9319]], PRe52924), 
LZer29464 = zero_padding1D_layer(PRe52924, 2, 0, Zer29464), 
LCon10451 = concatenate_layer([Zer29464,[[[0.6398, 0.1637], [0.8861, 0.2059], [0.7688, 0.591]]]], 2, Con10451), 
LDot56673 = dot_layer([[[0.1023, 0.9275, 0.4993], [0.4848, 0.6873, 0.9132], [0.624, 0.0637, 0.5259]]], [[[0.6705, 0.4912, 0.1605], [0.4245, 0.6701, 0.8389], [0.1713, 0.1756, 0.8144]]], 1, 2, Dot56673), 
LAdd99585 = add_layer([Con10451,Dot56673], Add99585), 
LCro89411 = cropping1D_layer([[[1.4141, 1.9613, 1.1663], [1.8381, 1.3627, 1.8573], [1.5423, 1.9049, 1.6473], [1.8547, 1.8642, 1.2701]]], 3, 0, Cro89411), 
LZer76288 = zero_padding1D_layer(Cro89411, 2, 0, Zer76288), 
LMul46282 = multiply_layer([Add99585,Zer76288], Mul46282), 
exec_layers([LPRe52924,LZer29464,LCon10451,LDot56673,LAdd99585,LCro89411,LZer76288,LMul46282],["PRe52924","Zer29464","Con10451","Dot56673","Add99585","Cro89411","Zer76288","Mul46282"],Mul46282,"Mul46282")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [2.2632003, 3.7915324, 1.6069064]]]

Expected (Unparsed): [[[0.0,0.0,0.0],[0.0,0.0,0.0],[2.263200345768,3.791532400656,1.606906349997]]]

Actual:   [[[0, 0, 0], [0, 0, 0], [2.2633, 3.7916, 1.607]]]

Expected: [[[0, 0, 0], [0, 0, 0], [2.2633, 3.7916, 1.607]]]