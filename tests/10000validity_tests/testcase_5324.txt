import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul11795 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul11795 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Add39152 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Add39152 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Mul11795 = keras.layers.Multiply(name = 'Mul11795', )([in0Mul11795,in1Mul11795])
Bat38375 = keras.layers.BatchNormalization(axis=1, epsilon=0.8345099750637526,  name = 'Bat38375', )(Mul11795)
Res97852 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res97852', )(Bat38375)
Add39152 = keras.layers.Add(name = 'Add39152', )([in0Add39152,in1Add39152])
Zer88496 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer88496', )(Add39152)
Add42963 = keras.layers.Add(name = 'Add42963', )([Res97852,Zer88496])
Res63542 = keras.layers.Reshape((2, 2, 2), name = 'Res63542', )(Add42963)
Res82815 = keras.layers.Reshape((2, 4), name = 'Res82815', )(Res63542)
Per72141 = keras.layers.Permute((1,2), name = 'Per72141',)(Res82815)
Up_85748 = keras.layers.UpSampling1D(size=(1), name = 'Up_85748', )(Per72141)
model = tf.keras.models.Model(inputs=[in0Mul11795,in1Mul11795,in0Add39152,in1Add39152], outputs=Up_85748)
w = model.get_layer('Bat38375').get_weights() 
w[0] = np.array([0.9461, 0.7953])
w[1] = np.array([0.981, 0.123])
w[2] = np.array([0.7574, 0.7138])
w[3] = np.array([0.3319, 0.2453])
model.get_layer('Bat38375').set_weights(w) 
in0Mul11795 = tf.constant([[[[0.3595, 0.2346], [0.0647, 0.4962]], [[0.8917, 0.8639], [0.4942, 0.7875]]]])
in1Mul11795 = tf.constant([[[[0.9756, 0.7465], [0.3076, 0.0683]], [[0.0358, 0.9163], [0.1208, 0.0515]]]])
in0Add39152 = tf.constant([[[[[0.1114]], [[0.147]]], [[[0.0405]], [[0.1997]]]]])
in1Add39152 = tf.constant([[[[[0.4326]], [[0.9792]]], [[[0.3011]], [[0.9086]]]]])
print (np.array2string(model.predict([in0Mul11795,in1Mul11795,in0Add39152,in1Add39152],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_85748.png')

LMul11795 = multiply_layer([[[[[0.3595, 0.2346], [0.0647, 0.4962]], [[0.8917, 0.8639], [0.4942, 0.7875]]]], [[[[0.9756, 0.7465], [0.3076, 0.0683]], [[0.0358, 0.9163], [0.1208, 0.0515]]]]], Mul11795), 
LBat38375 = batch_normalization_layer(Mul11795, 1, 0.8345099750637526, [0.9461, 0.7953], [0.981, 0.123], [0.7574, 0.7138], [0.3319, 0.2453], Bat38375), 
LRes97852 = reshape_layer(Bat38375, [2, 2, 2, 1], Res97852), 
LAdd39152 = add_layer([[[[[[0.1114]], [[0.147]]], [[[0.0405]], [[0.1997]]]]], [[[[[0.4326]], [[0.9792]]], [[[0.3011]], [[0.9086]]]]]], Add39152), 
LZer88496 = zero_padding3D_layer(Add39152, 0, 0, 0, 0, 1, 0, Zer88496), 
LAdd42963 = add_layer([Res97852,Zer88496], Add42963), 
LRes63542 = reshape_layer(Add42963, [2, 2, 2], Res63542), 
LRes82815 = reshape_layer(Res63542, [2, 4], Res82815), 
LPer72141 = permute_layer(Res82815, 1,2, Per72141), 
LUp_85748 = up_sampling1D_layer(Per72141, 1, Up_85748), 
exec_layers([LMul11795,LBat38375,LRes97852,LAdd39152,LZer88496,LAdd42963,LRes63542,LRes82815,LPer72141,LUp_85748],["Mul11795","Bat38375","Res97852","Add39152","Zer88496","Add42963","Res63542","Res82815","Per72141","Up_85748"],Up_85748,"Up_85748")

Actual (Unparsed): [[[0.6247495, 1.0149219, 0.3349406, 1.4733950], [-0.3988713, 0.5241374, -0.3776127, 0.7160362]]]

Expected (Unparsed): [[[0.6247494955663134,1.0149219146934763,0.3349406118915149,1.4733949547827399],[-0.39887133856041834,0.5241373981368791,-0.3776127299560539,0.7160361843074314]]]

Actual:   [[[0.6248, 1.015, 0.335, 1.4734], [-0.3988, 0.5242, -0.3776, 0.7161]]]

Expected: [[[0.6248, 1.015, 0.335, 1.4734], [-0.3988, 0.5242, -0.3776, 0.7161]]]