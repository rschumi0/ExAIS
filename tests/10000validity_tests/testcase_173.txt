import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer15143 = tf.keras.layers.Input(shape=([4, 2, 1]))

Zer15143 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer15143', )(in0Zer15143)
Res10436 = keras.layers.Reshape((6, 4), name = 'Res10436', )(Zer15143)
Con15538 = keras.layers.Conv1D(4, (4),strides=(1), padding='valid', dilation_rate=(1), name = 'Con15538', )(Res10436)
model = tf.keras.models.Model(inputs=[in0Zer15143], outputs=Con15538)
w = model.get_layer('Con15538').get_weights() 
w[0] = np.array([[[0.5164, 0.8988, 0.2477, 0.6427], [0.1599, 0.6034, 0.6577, 0.1578], [0.0149, 0.16, 0.8141, 0.5398], [0.3814, 0.2909, 0.1471, 0.0735]], [[0.3882, 0.4596, 0.8648, 0.5385], [0.4271, 0.721, 0.1726, 0.2677], [0.3273, 0.2802, 0.7769, 0.6578], [0.4047, 0.2192, 0.8278, 0.7425]], [[0.2235, 0.8741, 0.1079, 0.5318], [0.7627, 0.7702, 0.5849, 0.8309], [0.6935, 0.8562, 0.4113, 0.1603], [0.6423, 0.0184, 0.0763, 0.2167]], [[0.6388, 0.5, 0.6929, 0.039], [0.4308, 0.9037, 0.3397, 0.6722], [0.9851, 0.9132, 0.9649, 0.6585], [0.2858, 0.733, 0.6092, 0.1282]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con15538').set_weights(w) 
in0Zer15143 = tf.constant([[[[1.8796], [1.6266]], [[1.1785], [1.8852]], [[1.9458], [1.7731]], [[1.6519], [1.1587]]]])
print (np.array2string(model.predict([in0Zer15143],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con15538.png')

LZer15143 = zero_padding2D_layer([[[[1.8796], [1.6266]], [[1.1785], [1.8852]], [[1.9458], [1.7731]], [[1.6519], [1.1587]]]], 1, 1, 1, 1, Zer15143), 
LRes10436 = reshape_layer(Zer15143, [6, 4], Res10436), 
LCon15538 = conv1D_layer(Res10436, 4,[[[0.5164, 0.8988, 0.2477, 0.6427], [0.1599, 0.6034, 0.6577, 0.1578], [0.0149, 0.16, 0.8141, 0.5398], [0.3814, 0.2909, 0.1471, 0.0735]], [[0.3882, 0.4596, 0.8648, 0.5385], [0.4271, 0.721, 0.1726, 0.2677], [0.3273, 0.2802, 0.7769, 0.6578], [0.4047, 0.2192, 0.8278, 0.7425]], [[0.2235, 0.8741, 0.1079, 0.5318], [0.7627, 0.7702, 0.5849, 0.8309], [0.6935, 0.8562, 0.4113, 0.1603], [0.6423, 0.0184, 0.0763, 0.2167]], [[0.6388, 0.5, 0.6929, 0.039], [0.4308, 0.9037, 0.3397, 0.6722], [0.9851, 0.9132, 0.9649, 0.6585], [0.2858, 0.733, 0.6092, 0.1282]]],[0, 0, 0, 0], 1, false, 1, Con15538), 
exec_layers([LZer15143,LRes10436,LCon15538],["Zer15143","Res10436","Con15538"],Con15538,"Con15538")

Actual (Unparsed): [[[6.1263230, 7.7103683, 5.4246644, 5.3301128], [6.0119281, 8.3400685, 7.7750035, 6.5046129], [3.6913810, 5.1768557, 5.4659769, 4.4491375]]]

Expected (Unparsed): [[[6.1263229400000005,7.710368240000001,5.4246643599999995,5.33011272],[6.01192809,8.34006843,7.77500347,6.504612849999999],[3.6913810200000006,5.17685564,5.4659768600000005,4.44913742]]]

Actual:   [[[6.1264, 7.7104, 5.4247, 5.3302], [6.012, 8.3401, 7.7751, 6.5047], [3.6914, 5.1769, 5.466, 4.4492]]]

Expected: [[[6.1264, 7.7104, 5.4247, 5.3302], [6.012, 8.3401, 7.7751, 6.5047], [3.6914, 5.1769, 5.466, 4.4492]]]