import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max45018 = tf.keras.layers.Input(shape=([2, 1]))
in1Max45018 = tf.keras.layers.Input(shape=([2, 1]))
in0Con5479 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Max30686 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Max30686 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Max45018 = keras.layers.Maximum(name = 'Max45018', )([in0Max45018,in1Max45018])
Res27803 = keras.layers.Reshape((2, 1, 1), name = 'Res27803', )(Max45018)
Res86693 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res86693', )(Res27803)
Con5479 = keras.layers.Concatenate(axis=4, name = 'Con5479', )([Res86693,in0Con5479])
Max30686 = keras.layers.Maximum(name = 'Max30686', )([in0Max30686,in1Max30686])
Sub94062 = keras.layers.Subtract(name = 'Sub94062', )([Con5479,Max30686])
ELU55996 = keras.layers.ELU(alpha=-5.825420890730017, name = 'ELU55996', )(Sub94062)
model = tf.keras.models.Model(inputs=[in0Max45018,in1Max45018,in0Con5479,in0Max30686,in1Max30686], outputs=ELU55996)
in0Max45018 = tf.constant([[[0.5598], [0.9751]]])
in1Max45018 = tf.constant([[[0.0731], [0.9424]]])
in0Con5479 = tf.constant([[[[[0.5128]]], [[[0.6094]]]]])
in0Max30686 = tf.constant([[[[[0.7365, 0.3272]]], [[[0.2187, 0.3855]]]]])
in1Max30686 = tf.constant([[[[[0.0509, 0.7583]]], [[[0.9902, 0.3368]]]]])
print (np.array2string(model.predict([in0Max45018,in1Max45018,in0Con5479,in0Max30686,in1Max30686],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU55996.png')

LMax45018 = maximum_layer([[[[0.5598], [0.9751]]], [[[0.0731], [0.9424]]]], Max45018), 
LRes27803 = reshape_layer(Max45018, [2, 1, 1], Res27803), 
LRes86693 = reshape_layer(Res27803, [2, 1, 1, 1], Res86693), 
LCon5479 = concatenate_layer([Res86693,[[[[[0.5128]]], [[[0.6094]]]]]], 4, Con5479), 
LMax30686 = maximum_layer([[[[[[0.7365, 0.3272]]], [[[0.2187, 0.3855]]]]], [[[[[0.0509, 0.7583]]], [[[0.9902, 0.3368]]]]]], Max30686), 
LSub94062 = subtract_layer(Con5479,Max30686, Sub94062), 
LELU55996 = elu_layer(Sub94062, -5.825420890730017, ELU55996), 
exec_layers([LMax45018,LRes27803,LRes86693,LCon5479,LMax30686,LSub94062,LELU55996],["Max45018","Res27803","Res86693","Con5479","Max30686","Sub94062","ELU55996"],ELU55996,"ELU55996")

Actual (Unparsed): [[[[[0.9435367, 1.2681169]]], [[[0.0873031, 0.2239000]]]]]

Expected (Unparsed): [[[[[0.9435366865400417,1.2681167442178765]]],[[[0.08730305853353422,0.22390000000000004]]]]]

Actual:   [[[[[0.9436, 1.2682]]], [[[0.0874, 0.2239]]]]]

Expected: [[[[[0.9436, 1.2682]]], [[[0.0874, 0.224]]]]]