import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas26977 = tf.keras.layers.Input(shape=([1, 1]))
in0Min43756 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min43756 = tf.keras.layers.Input(shape=([1, 1, 1]))

Mas26977 = keras.layers.Masking(mask_value=2, name = 'Mas26977', )(in0Mas26977)
Bat72725 = keras.layers.BatchNormalization(axis=2, epsilon=0.480270856935352,  name = 'Bat72725', )(Mas26977)
Con61849 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con61849', )(Bat72725)
Res82079 = keras.layers.Reshape((1, 3, 1), name = 'Res82079', )(Con61849)
Min43756 = keras.layers.Minimum(name = 'Min43756', )([in0Min43756,in1Min43756])
Sof43220 = keras.layers.Softmax(axis=1, name = 'Sof43220', )(Min43756)
Zer84865 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer84865', )(Sof43220)
Ave7882 = keras.layers.Average(name = 'Ave7882', )([Res82079,Zer84865])
model = tf.keras.models.Model(inputs=[in0Mas26977,in0Min43756,in1Min43756], outputs=Ave7882)
w = model.get_layer('Bat72725').get_weights() 
w[0] = np.array([0.2113])
w[1] = np.array([0.1919])
w[2] = np.array([0.7711])
w[3] = np.array([0.3555])
model.get_layer('Bat72725').set_weights(w) 
w = model.get_layer('Con61849').get_weights() 
w[0] = np.array([[[0.9602, 0.5762, 0.5521]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con61849').set_weights(w) 
in0Mas26977 = tf.constant([[[1.7516]]])
in0Min43756 = tf.constant([[[[0.2742]]]])
in1Min43756 = tf.constant([[[[0.2933]]]])
print (np.array2string(model.predict([in0Mas26977,in0Min43756,in1Min43756],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave7882.png')

LMas26977 = masking_layer([[[1.7516]]], 2, Mas26977), 
LBat72725 = batch_normalization_layer(Mas26977, 2, 0.480270856935352, [0.2113], [0.1919], [0.7711], [0.3555], Bat72725), 
LCon61849 = conv1D_layer(Bat72725, 1,[[[0.9602, 0.5762, 0.5521]]],[0, 0, 0], 1, true, 1, Con61849), 
LRes82079 = reshape_layer(Con61849, [1, 3, 1], Res82079), 
LMin43756 = minimum_layer([[[[[0.2742]]]], [[[[0.2933]]]]], Min43756), 
LSof43220 = softmax_layer(Min43756, 1, Sof43220), 
LZer84865 = zero_padding2D_layer(Sof43220, 0, 0, 2, 0, Zer84865), 
LAve7882 = average_layer([Res82079,Zer84865], Ave7882), 
exec_layers([LMas26977,LBat72725,LCon61849,LRes82079,LMin43756,LSof43220,LZer84865,LAve7882],["Mas26977","Bat72725","Con61849","Res82079","Min43756","Sof43220","Zer84865","Ave7882"],Ave7882,"Ave7882")

Actual (Unparsed): [[[[0.2009328], [0.1205764], [0.6155332]]]]

Expected (Unparsed): [[[[0.20093276678789335],[0.12057640098227884],[0.6155332019824994]]]]

Actual:   [[[[0.201], [0.1206], [0.6156]]]]

Expected: [[[[0.201], [0.1206], [0.6156]]]]