import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add99567 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add99567 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con43057 = tf.keras.layers.Input(shape=([2, 2, 3, 1]))
in0Add32540 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Add32540 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Add99567 = keras.layers.Add(name = 'Add99567', )([in0Add99567,in1Add99567])
Res22453 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res22453', )(Add99567)
Zer73985 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer73985', )(Res22453)
Con43057 = keras.layers.Concatenate(axis=4, name = 'Con43057', )([Zer73985,in0Con43057])
Add32540 = keras.layers.Add(name = 'Add32540', )([in0Add32540,in1Add32540])
Zer77187 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer77187', )(Add32540)
Ave55176 = keras.layers.Average(name = 'Ave55176', )([Con43057,Zer77187])
model = tf.keras.models.Model(inputs=[in0Add99567,in1Add99567,in0Con43057,in0Add32540,in1Add32540], outputs=Ave55176)
in0Add99567 = tf.constant([[[[0.4438], [0.6465]], [[0.9308], [0.5864]]]])
in1Add99567 = tf.constant([[[[0.0488], [0.6994]], [[0.9549], [0.1601]]]])
in0Con43057 = tf.constant([[[[[0.3259], [0.4832], [0.3646]], [[0.3871], [0.8615], [0.3623]]], [[[0.5451], [0.6479], [0.0241]], [[0.991], [0.0746], [0.7622]]]]])
in0Add32540 = tf.constant([[[[[0.7579, 0.4532], [0.8076, 0.476]], [[0.061, 0.6993], [0.1267, 0.9226]]]]])
in1Add32540 = tf.constant([[[[[0.0853, 0.6435], [0.0149, 0.0184]], [[0.5153, 0.1586], [0.7188, 0.6303]]]]])
print (np.array2string(model.predict([in0Add99567,in1Add99567,in0Con43057,in0Add32540,in1Add32540],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave55176.png')

LAdd99567 = add_layer([[[[[0.4438], [0.6465]], [[0.9308], [0.5864]]]], [[[[0.0488], [0.6994]], [[0.9549], [0.1601]]]]], Add99567), 
LRes22453 = reshape_layer(Add99567, [2, 2, 1, 1], Res22453), 
LZer73985 = zero_padding3D_layer(Res22453, 0, 0, 0, 0, 2, 0, Zer73985), 
LCon43057 = concatenate_layer([Zer73985,[[[[[0.3259], [0.4832], [0.3646]], [[0.3871], [0.8615], [0.3623]]], [[[0.5451], [0.6479], [0.0241]], [[0.991], [0.0746], [0.7622]]]]]], 4, Con43057), 
LAdd32540 = add_layer([[[[[[0.7579, 0.4532], [0.8076, 0.476]], [[0.061, 0.6993], [0.1267, 0.9226]]]]], [[[[[0.0853, 0.6435], [0.0149, 0.0184]], [[0.5153, 0.1586], [0.7188, 0.6303]]]]]], Add32540), 
LZer77187 = zero_padding3D_layer(Add32540, 1, 0, 0, 0, 1, 0, Zer77187), 
LAve55176 = average_layer([Con43057,Zer77187], Ave55176), 
exec_layers([LAdd99567,LRes22453,LZer73985,LCon43057,LAdd32540,LZer77187,LAve55176],["Add99567","Res22453","Zer73985","Con43057","Add32540","Zer77187","Ave55176"],Ave55176,"Ave55176")

Actual (Unparsed): [[[[[0.0000000, 0.1629500], [0.0000000, 0.2416000], [0.2463000, 0.1823000]], [[0.0000000, 0.1935500], [0.0000000, 0.4307500], [0.6729500, 0.1811500]]], [[[0.0000000, 0.2725500], [0.4216000, 0.8723000], [1.3541000, 0.2592500]], [[0.0000000, 0.4955000], [0.2881500, 0.4662500], [0.7960000, 1.1575500]]]]]

Expected (Unparsed): [[[[[0,0.16295],[0,0.2416],[0.2463,0.1823]],[[0,0.19355],[0,0.43075],[0.6729499999999999,0.18115]]],[[[0,0.27255],[0.42160000000000003,0.8723000000000001],[1.3540999999999999,0.25925]],[[0,0.4955],[0.28815,0.46625],[0.796,1.15755]]]]]

Actual:   [[[[[0, 0.163], [0, 0.2416], [0.2463, 0.1823]], [[0, 0.1936], [0, 0.4308], [0.673, 0.1812]]], [[[0, 0.2726], [0.4216, 0.8723], [1.3541, 0.2593]], [[0, 0.4955], [0.2882, 0.4663], [0.796, 1.1576]]]]]

Expected: [[[[[0, 0.163], [0, 0.2416], [0.2463, 0.1823]], [[0, 0.1936], [0, 0.4308], [0.673, 0.1812]]], [[[0, 0.2726], [0.4217, 0.8724], [1.3541, 0.2593]], [[0, 0.4955], [0.2882, 0.4663], [0.796, 1.1576]]]]]