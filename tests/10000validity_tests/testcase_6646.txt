import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer27329 = tf.keras.layers.Input(shape=([4, 1, 1, 1]))

Zer27329 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer27329', )(in0Zer27329)
Res47478 = keras.layers.Reshape((6, 3, 3), name = 'Res47478', )(Zer27329)
Res95836 = keras.layers.Reshape((6, 9), name = 'Res95836', )(Res47478)
Sim25983 = keras.layers.SimpleRNN(3,name = 'Sim25983', )(Res95836)
Res82485 = keras.layers.Reshape((3, 1), name = 'Res82485', )(Sim25983)
Per69658 = keras.layers.Permute((1,2), name = 'Per69658',)(Res82485)
model = tf.keras.models.Model(inputs=[in0Zer27329], outputs=Per69658)
w = model.get_layer('Sim25983').get_weights() 
w[0] = np.array([[1, 6, 9], [6, 3, 2], [8, 2, 5], [10, 2, 5], [2, 9, 5], [8, 6, 10], [10, 10, 1], [5, 4, 6], [6, 8, 5]])
w[1] = np.array([[7, 4, 7], [2, 7, 10], [4, 4, 7]])
w[2] = np.array([2, 9, 5])
model.get_layer('Sim25983').set_weights(w) 
in0Zer27329 = tf.constant([[[[[1.42]]], [[[1.2832]]], [[[1.6725]]], [[[1.7162]]]]])
print (np.array2string(model.predict([in0Zer27329],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per69658.png')

LZer27329 = zero_padding3D_layer([[[[[1.42]]], [[[1.2832]]], [[[1.6725]]], [[[1.7162]]]]], 1, 1, 1, 1, 1, 1, Zer27329), 
LRes47478 = reshape_layer(Zer27329, [6, 3, 3], Res47478), 
LRes95836 = reshape_layer(Res47478, [6, 9], Res95836), 
LSim25983 = simple_rnn_layer(Res95836,[[1, 6, 9], [6, 3, 2], [8, 2, 5], [10, 2, 5], [2, 9, 5], [8, 6, 10], [10, 10, 1], [5, 4, 6], [6, 8, 5]],[[7, 4, 7], [2, 7, 10], [4, 4, 7]],[2, 9, 5], Sim25983), 
LRes82485 = reshape_layer(Sim25983, [3, 1], Res82485), 
LPer69658 = permute_layer(Res82485, 1,2, Per69658), 
exec_layers([LZer27329,LRes47478,LRes95836,LSim25983,LRes82485,LPer69658],["Zer27329","Res47478","Res95836","Sim25983","Res82485","Per69658"],Per69658,"Per69658")

Actual (Unparsed): [[[1.0000000], [1.0000000], [1.0000000]]]

Expected (Unparsed): [[[0.9999999999998128],[1.0],[1.0]]]

Actual:   [[[1], [1], [1]]]

Expected: [[[1], [1], [1]]]