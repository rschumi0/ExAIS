import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con1949 = tf.keras.layers.Input(shape=([2, 1, 2]))

Con1949 = keras.layers.Conv2DTranspose(4, (2, 1),strides=(1, 1), padding='same', name = 'Con1949', )(in0Con1949)
Res12198 = keras.layers.Reshape((2, 4), name = 'Res12198', )(Con1949)
Max38319 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max38319', )(Res12198)
Res46694 = keras.layers.Reshape((2, 4, 1), name = 'Res46694', )(Max38319)
Loc63958 = keras.layers.LocallyConnected2D(2, (2, 3),strides=(11, 1), name = 'Loc63958', )(Res46694)
model = tf.keras.models.Model(inputs=[in0Con1949], outputs=Loc63958)
w = model.get_layer('Con1949').get_weights() 
w[0] = np.array([[[[0.5804, 0.9084], [0.8228, 0.8538], [0.7089, 0.7648], [0.5523, 0.7466]]], [[[0.8897, 0.2573], [0.8303, 0.7129], [0.2438, 0.857], [0.7006, 0.5056]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con1949').set_weights(w) 
w = model.get_layer('Loc63958').get_weights() 
w[0] = np.array([[[0.9281, 0.0539], [0.9817, 0.0985], [0.4406, 0.4557], [0.6097, 0.0516], [0.8052, 0.0189], [0.4973, 0.1847]], [[0.3732, 0.9065], [0.7483, 0.1154], [0.1344, 0.2607], [0.6791, 0.266], [0.7208, 0.4662], [0.287, 0.0973]]])
w[1] = np.array([[[0, 0], [0, 0]]])
model.get_layer('Loc63958').set_weights(w) 
in0Con1949 = tf.constant([[[[0.8006, 0.5445]], [[0.346, 0.1677]]]])
print (np.array2string(model.predict([in0Con1949],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc63958.png')

LCon1949 = conv2D_transpose_layer([[[[0.8006, 0.5445]], [[0.346, 0.1677]]]], 2, 1,[[[[0.5804, 0.9084], [0.8228, 0.8538], [0.7089, 0.7648], [0.5523, 0.7466]]], [[[0.8897, 0.2573], [0.8303, 0.7129], [0.2438, 0.857], [0.7006, 0.5056]]]],[0, 0, 0, 0], 1, 1, true, Con1949), 
LRes12198 = reshape_layer(Con1949, [2, 4], Res12198), 
LMax38319 = max_pool1D_layer(Res12198, 1, Max38319), 
LRes46694 = reshape_layer(Max38319, [2, 4, 1], Res46694), 
LLoc63958 = locally_connected2D_layer(Res46694, 2, 3,[[[0.9281, 0.0539], [0.9817, 0.0985], [0.4406, 0.4557], [0.6097, 0.0516], [0.8052, 0.0189], [0.4973, 0.1847]], [[0.3732, 0.9065], [0.7483, 0.1154], [0.1344, 0.2607], [0.6791, 0.266], [0.7208, 0.4662], [0.287, 0.0973]]],[[[0, 0], [0, 0]]], 11, 1, Loc63958), 
exec_layers([LCon1949,LRes12198,LMax38319,LRes46694,LLoc63958],["Con1949","Res12198","Max38319","Res46694","Loc63958"],Loc63958,"Loc63958")

Actual (Unparsed): [[[[4.8691605, 0.8922064], [3.3523682, 2.3420856]]]]

Expected (Unparsed): [[[[4.869160552618999,0.892206436283],[3.352368299061,2.342085613324]]]]

Actual:   [[[[4.8692, 0.8923], [3.3524, 2.3421]]]]

Expected: [[[[4.8692, 0.8923], [3.3524, 2.3421]]]]