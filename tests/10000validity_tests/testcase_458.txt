import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max42180 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Max42180 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Glo90 = tf.keras.layers.Input(shape=([1, 2, 2]))

Max42180 = keras.layers.Maximum(name = 'Max42180', )([in0Max42180,in1Max42180])
Res2429 = keras.layers.Reshape((1, 1, 4), name = 'Res2429', )(Max42180)
Sep52961 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep52961', )(Res2429)
Res35365 = keras.layers.Reshape((1, 2), name = 'Res35365', )(Sep52961)
Fla55118 = keras.layers.Flatten(name = 'Fla55118', )(Res35365)
Glo90 = keras.layers.GlobalAveragePooling2D(name = 'Glo90', )(in0Glo90)
Max22696 = keras.layers.Maximum(name = 'Max22696', )([Fla55118,Glo90])
model = tf.keras.models.Model(inputs=[in0Max42180,in1Max42180,in0Glo90], outputs=Max22696)
w = model.get_layer('Sep52961').get_weights() 
w[0] = np.array([[[[0.9968], [0.8408], [0.1344], [0.0134]]]])
w[1] = np.array([[[[0.7593, 0.9731], [0.8404, 0.7701], [0.1221, 0.1905], [0.8247, 0.1861]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep52961').set_weights(w) 
in0Max42180 = tf.constant([[[[[0.1807, 0.9688], [0.4102, 0.8391]]]]])
in1Max42180 = tf.constant([[[[[0.1256, 0.0138], [0.9285, 0.7899]]]]])
in0Glo90 = tf.constant([[[[1.69, 1.6665], [1.757, 1.8698]]]])
print (np.array2string(model.predict([in0Max42180,in1Max42180,in0Glo90],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max22696.png')

LMax42180 = maximum_layer([[[[[[0.1807, 0.9688], [0.4102, 0.8391]]]]], [[[[[0.1256, 0.0138], [0.9285, 0.7899]]]]]], Max42180), 
LRes2429 = reshape_layer(Max42180, [1, 1, 4], Res2429), 
LSep52961 = separable_conv2D_layer(Res2429, 1, 1,[[[[[0.9968], [0.8408], [0.1344], [0.0134]]]],[[[[0.7593, 0.9731], [0.8404, 0.7701], [0.1221, 0.1905], [0.8247, 0.1861]]]]],[0, 0], 1, 1, false, Sep52961), 
LRes35365 = reshape_layer(Sep52961, [1, 2], Res35365), 
LFla55118 = flatten_layer(Res35365, Fla55118), 
LGlo90 = global_average_pooling2D_layer([[[[1.69, 1.6665], [1.757, 1.8698]]]], Glo90), 
LMax22696 = maximum_layer([Fla55118,Glo90], Max22696), 
exec_layers([LMax42180,LRes2429,LSep52961,LRes35365,LFla55118,LGlo90,LMax22696],["Max42180","Res2429","Sep52961","Res35365","Fla55118","Glo90","Max22696"],Max22696,"Max22696")

Actual (Unparsed): [[1.7235000, 1.7681500]]

Expected (Unparsed): [[1.7235,1.7681499999999999]]

Actual:   [[1.7235, 1.7682]]

Expected: [[1.7235, 1.7682]]