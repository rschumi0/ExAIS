import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL55351 = tf.keras.layers.Input(shape=([2, 2]))
in0Con2968 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Sep39874 = tf.keras.layers.Input(shape=([1, 2, 2]))

ReL55351 = keras.layers.ReLU(max_value=8.870043044552588, negative_slope=0.5453816050668792, threshold=7.374080928568532, name = 'ReL55351', input_shape=(2, 2))(in0ReL55351)
Res88156 = keras.layers.Reshape((2, 2, 1), name = 'Res88156', )(ReL55351)
Con2968 = keras.layers.Concatenate(axis=3, name = 'Con2968', )([Res88156,in0Con2968])
Sep39874 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='same', name = 'Sep39874', )(in0Sep39874)
Zer9320 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer9320', )(Sep39874)
Add23224 = keras.layers.Add(name = 'Add23224', )([Con2968,Zer9320])
Sof42877 = keras.layers.Softmax(axis=1, name = 'Sof42877', )(Add23224)
ReL50233 = keras.layers.ReLU(max_value=9.311487210886902, negative_slope=0.7493919320434462, threshold=4.08664372503094, name = 'ReL50233', )(Sof42877)
model = tf.keras.models.Model(inputs=[in0ReL55351,in0Con2968,in0Sep39874], outputs=ReL50233)
w = model.get_layer('Sep39874').get_weights() 
w[0] = np.array([[[[0.177], [0.7917]]]])
w[1] = np.array([[[[0.0961, 0.0852], [0.3024, 0.3929]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep39874').set_weights(w) 
in0ReL55351 = tf.constant([[[0.6262, 0.7384], [0.4216, 0.9058]]])
in0Con2968 = tf.constant([[[[0.1622], [0.4384]], [[0.8095], [0.856]]]])
in0Sep39874 = tf.constant([[[[0.6495, 0.3923], [0.9048, 0.2757]]]])
print (np.array2string(model.predict([in0ReL55351,in0Con2968,in0Sep39874],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL50233.png')

LReL55351 = relu_layer([[[0.6262, 0.7384], [0.4216, 0.9058]]], 8.870043044552588, 0.5453816050668792, 7.374080928568532, ReL55351), 
LRes88156 = reshape_layer(ReL55351, [2, 2, 1], Res88156), 
LCon2968 = concatenate_layer([Res88156,[[[[0.1622], [0.4384]], [[0.8095], [0.856]]]]], 3, Con2968), 
LSep39874 = separable_conv2D_layer([[[[0.6495, 0.3923], [0.9048, 0.2757]]]], 1, 1,[[[[[0.177], [0.7917]]]],[[[[0.0961, 0.0852], [0.3024, 0.3929]]]]],[0, 0], 1, 1, true, Sep39874), 
LZer9320 = zero_padding2D_layer(Sep39874, 1, 0, 0, 0, Zer9320), 
LAdd23224 = add_layer([Con2968,Zer9320], Add23224), 
LSof42877 = softmax_layer(Add23224, 1, Sof42877), 
LReL50233 = relu_layer(Sof42877, 9.311487210886902, 0.7493919320434462, 4.08664372503094, ReL50233), 
exec_layers([LReL55351,LRes88156,LCon2968,LSep39874,LZer9320,LAdd23224,LSof42877,LReL50233],["ReL55351","Res88156","Con2968","Sep39874","Zer9320","Add23224","Sof42877","ReL50233"],ReL50233,"ReL50233")

Actual (Unparsed): [[[[-2.6865622, -2.8268074], [-2.7200753, -2.7825601]], [[-2.6890415, -2.5487963], [-2.6555284, -2.5930436]]]]

Expected (Unparsed): [[[[-2.6865622494269057,-2.826807403969096],[-2.7200753169536696,-2.782560129619609]],[[-2.6890414918779717,-2.548796337335782],[-2.6555284243512083,-2.593043611685269]]]]

Actual:   [[[[-2.6865, -2.8268], [-2.72, -2.7825]], [[-2.689, -2.5487], [-2.6555, -2.593]]]]

Expected: [[[[-2.6865, -2.8268], [-2.72, -2.7825]], [[-2.689, -2.5487], [-2.6555, -2.593]]]]