import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim85528 = tf.keras.layers.Input(shape=([3, 1]))

Sim85528 = keras.layers.SimpleRNN(2,name = 'Sim85528', )(in0Sim85528)
Res13958 = keras.layers.Reshape((2, 1), name = 'Res13958', )(Sim85528)
Res12246 = keras.layers.Reshape((2, 1, 1), name = 'Res12246', )(Res13958)
Res52294 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res52294', )(Res12246)
Zer56775 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer56775', )(Res52294)
Res51340 = keras.layers.Reshape((4, 3, 3), name = 'Res51340', )(Zer56775)
Res74208 = keras.layers.Reshape((4, 9), name = 'Res74208', )(Res51340)
Sim75670 = keras.layers.SimpleRNN(3,name = 'Sim75670', )(Res74208)
Res89314 = keras.layers.Reshape((3, 1), name = 'Res89314', )(Sim75670)
GRU43599 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU43599', )(Res89314)
model = tf.keras.models.Model(inputs=[in0Sim85528], outputs=GRU43599)
w = model.get_layer('Sim85528').get_weights() 
w[0] = np.array([[5, 7]])
w[1] = np.array([[9, 2], [8, 5]])
w[2] = np.array([8, 7])
model.get_layer('Sim85528').set_weights(w) 
w = model.get_layer('Sim75670').get_weights() 
w[0] = np.array([[9, 10, 8], [6, 2, 8], [5, 7, 5], [6, 1, 10], [6, 4, 4], [1, 6, 1], [4, 3, 7], [2, 10, 9], [2, 4, 5]])
w[1] = np.array([[10, 7, 7], [1, 9, 2], [7, 9, 4]])
w[2] = np.array([3, 1, 5])
model.get_layer('Sim75670').set_weights(w) 
w = model.get_layer('GRU43599').get_weights() 
w[0] = np.array([[4, 1, 1]])
w[1] = np.array([[7, 7, 5]])
w[2] = np.array([[8, 3, 9], [6, 10, 8]])
model.get_layer('GRU43599').set_weights(w) 
in0Sim85528 = tf.constant([[[6], [1], [8]]])
print (np.array2string(model.predict([in0Sim85528],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU43599.png')

LSim85528 = simple_rnn_layer([[[6], [1], [8]]],[[5, 7]],[[9, 2], [8, 5]],[8, 7], Sim85528), 
LRes13958 = reshape_layer(Sim85528, [2, 1], Res13958), 
LRes12246 = reshape_layer(Res13958, [2, 1, 1], Res12246), 
LRes52294 = reshape_layer(Res12246, [2, 1, 1, 1], Res52294), 
LZer56775 = zero_padding3D_layer(Res52294, 1, 1, 1, 1, 1, 1, Zer56775), 
LRes51340 = reshape_layer(Zer56775, [4, 3, 3], Res51340), 
LRes74208 = reshape_layer(Res51340, [4, 9], Res74208), 
LSim75670 = simple_rnn_layer(Res74208,[[9, 10, 8], [6, 2, 8], [5, 7, 5], [6, 1, 10], [6, 4, 4], [1, 6, 1], [4, 3, 7], [2, 10, 9], [2, 4, 5]],[[10, 7, 7], [1, 9, 2], [7, 9, 4]],[3, 1, 5], Sim75670), 
LRes89314 = reshape_layer(Sim75670, [3, 1], Res89314), 
LGRU43599 = gru_layer(Res89314,[[4, 1, 1]],[[7, 7, 5]],[[8, 3, 9], [6, 10, 8]], true, GRU43599), 
exec_layers([LSim85528,LRes13958,LRes12246,LRes52294,LZer56775,LRes51340,LRes74208,LSim75670,LRes89314,LGRU43599],["Sim85528","Res13958","Res12246","Res52294","Zer56775","Res51340","Res74208","Sim75670","Res89314","GRU43599"],GRU43599,"GRU43599")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[4.56899329184557e-8]]

Actual:   [[0]]

Expected: [[0]]