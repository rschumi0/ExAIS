import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL10387 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con75626 = tf.keras.layers.Input(shape=([1, 5]))
in0Con43940 = tf.keras.layers.Input(shape=([2, 2, 2]))

ReL10387 = keras.layers.ReLU(max_value=4.151934304731369, negative_slope=3.7785797872185483, threshold=6.74278362342187, name = 'ReL10387', input_shape=(2, 1, 1))(in0ReL10387)
Glo9152 = keras.layers.GlobalMaxPool2D(name = 'Glo9152', )(ReL10387)
Res76936 = keras.layers.Reshape((1, 1), name = 'Res76936', )(Glo9152)
Glo12104 = keras.layers.GlobalAveragePooling1D(name = 'Glo12104', )(Res76936)
Res12588 = keras.layers.Reshape((1, 1), name = 'Res12588', )(Glo12104)
Con75626 = keras.layers.Concatenate(axis=2, name = 'Con75626', )([Res12588,in0Con75626])
Con43940 = keras.layers.Conv2DTranspose(3, (2, 2),strides=(2, 1), padding='same', name = 'Con43940', )(in0Con43940)
Res30209 = keras.layers.Reshape((4, 6), name = 'Res30209', )(Con43940)
Cro75399 = keras.layers.Cropping1D(cropping=((2, 1)), name = 'Cro75399', )(Res30209)
Sub8443 = keras.layers.Subtract(name = 'Sub8443', )([Con75626,Cro75399])
model = tf.keras.models.Model(inputs=[in0ReL10387,in0Con75626,in0Con43940], outputs=Sub8443)
w = model.get_layer('Con43940').get_weights() 
w[0] = np.array([[[[0.1878, 0.4052], [0.1927, 0.0064], [0.3865, 0.3142]], [[0.6449, 0.3743], [0.0931, 0.7735], [0.7574, 0.0756]]], [[[0.6368, 0.7966], [0.6909, 0.0905], [0.4203, 0.065]], [[0.9445, 0.9888], [0.4129, 0.2644], [0.9986, 0.3985]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con43940').set_weights(w) 
in0ReL10387 = tf.constant([[[[0.7504]], [[0.6741]]]])
in0Con75626 = tf.constant([[[0.1606, 0.0442, 0.7711, 0.7918, 0.8182]]])
in0Con43940 = tf.constant([[[[0.3385, 0.3719], [0.6622, 0.0524]], [[0.39, 0.2968], [0.8885, 0.9329]]]])
print (np.array2string(model.predict([in0ReL10387,in0Con75626,in0Con43940],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub8443.png')

LReL10387 = relu_layer([[[[0.7504]], [[0.6741]]]], 4.151934304731369, 3.7785797872185483, 6.74278362342187, ReL10387), 
LGlo9152 = global_max_pool2D_layer(ReL10387, Glo9152), 
LRes76936 = reshape_layer(Glo9152, [1, 1], Res76936), 
LGlo12104 = global_average_pooling1D_layer(Res76936, Glo12104), 
LRes12588 = reshape_layer(Glo12104, [1, 1], Res12588), 
LCon75626 = concatenate_layer([Res12588,[[[0.1606, 0.0442, 0.7711, 0.7918, 0.8182]]]], 2, Con75626), 
LCon43940 = conv2D_transpose_layer([[[[0.3385, 0.3719], [0.6622, 0.0524]], [[0.39, 0.2968], [0.8885, 0.9329]]]], 2, 2,[[[[0.1878, 0.4052], [0.1927, 0.0064], [0.3865, 0.3142]], [[0.6449, 0.3743], [0.0931, 0.7735], [0.7574, 0.0756]]], [[[0.6368, 0.7966], [0.6909, 0.0905], [0.4203, 0.065]], [[0.9445, 0.9888], [0.4129, 0.2644], [0.9986, 0.3985]]]],[0, 0, 0], 2, 1, true, Con43940), 
LRes30209 = reshape_layer(Con43940, [4, 6], Res30209), 
LCro75399 = cropping1D_layer(Res30209, 2, 1, Cro75399), 
LSub8443 = subtract_layer(Con75626,Cro75399, Sub8443), 
exec_layers([LReL10387,LGlo9152,LRes76936,LGlo12104,LRes12588,LCon75626,LCon43940,LRes30209,LCro75399,LSub8443],["ReL10387","Glo9152","Res76936","Glo12104","Res12588","Con75626","Con43940","Res30209","Cro75399","Sub8443"],Sub8443,"Sub8443")

Actual (Unparsed): [[[-22.8362050, 0.0835475, -0.1997896, -0.1363746, 0.3487317, -0.1361465]]]

Expected (Unparsed): [[[-22.83620499672132,0.08354747999999998,-0.19978955999999998,-0.1363746200000001,0.3487316899999999,-0.1361465099999999]]]

Actual:   [[[-22.8362, 0.0836, -0.1997, -0.1363, 0.3488, -0.1361]]]

Expected: [[[-22.8362, 0.0836, -0.1997, -0.1363, 0.3488, -0.1361]]]