import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST12231 = tf.keras.layers.Input(shape=([1, 2]))

LST12231 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST12231', )(in0LST12231)
Res97846 = keras.layers.Reshape((3, 1), name = 'Res97846', )(LST12231)
GRU64208 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU64208', )(Res97846)
model = tf.keras.models.Model(inputs=[in0LST12231], outputs=GRU64208)
w = model.get_layer('LST12231').get_weights() 
w[0] = np.array([[5, 4, 9, 2, 9, 3, 9, 9, 1, 10, 5, 6], [7, 5, 9, 2, 4, 2, 9, 5, 2, 4, 4, 4]])
w[1] = np.array([[10, 9, 9, 3, 6, 8, 1, 1, 9, 10, 10, 2], [3, 3, 8, 4, 4, 7, 10, 5, 6, 1, 10, 8], [8, 4, 8, 3, 6, 1, 6, 7, 10, 9, 9, 5]])
w[2] = np.array([3, 8, 9, 4, 1, 5, 4, 9, 10, 8, 3, 6])
model.get_layer('LST12231').set_weights(w) 
w = model.get_layer('GRU64208').get_weights() 
w[0] = np.array([[8, 2, 5, 3, 6, 6]])
w[1] = np.array([[1, 9, 4, 6, 2, 7], [9, 4, 6, 10, 7, 5]])
w[2] = np.array([[5, 7, 8, 6, 2, 7], [8, 10, 4, 7, 5, 9]])
model.get_layer('GRU64208').set_weights(w) 
in0LST12231 = tf.constant([[[2, 7]]])
print (np.array2string(model.predict([in0LST12231],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU64208.png')

LLST12231 = lstm_layer([[[2, 7]]],[[5, 4, 9, 2, 9, 3, 9, 9, 1, 10, 5, 6], [7, 5, 9, 2, 4, 2, 9, 5, 2, 4, 4, 4]],[[10, 9, 9, 3, 6, 8, 1, 1, 9, 10, 10, 2], [3, 3, 8, 4, 4, 7, 10, 5, 6, 1, 10, 8], [8, 4, 8, 3, 6, 1, 6, 7, 10, 9, 9, 5]],[3, 8, 9, 4, 1, 5, 4, 9, 10, 8, 3, 6], LST12231), 
LRes97846 = reshape_layer(LST12231, [3, 1], Res97846), 
LGRU64208 = gru_layer(Res97846,[[8, 2, 5, 3, 6, 6]],[[1, 9, 4, 6, 2, 7], [9, 4, 6, 10, 7, 5]],[[5, 7, 8, 6, 2, 7], [8, 10, 4, 7, 5, 9]], true, GRU64208), 
exec_layers([LLST12231,LRes97846,LGRU64208],["LST12231","Res97846","GRU64208"],GRU64208,"GRU64208")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[1.5319473608636667e-8,2.7077136843659147e-8]]

Actual:   [[0, 0]]

Expected: [[0, 0]]