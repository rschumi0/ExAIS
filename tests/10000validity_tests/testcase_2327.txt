import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU50222 = tf.keras.layers.Input(shape=([1, 3]))

GRU50222 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU50222', )(in0GRU50222)
Res56004 = keras.layers.Reshape((2, 1), name = 'Res56004', )(GRU50222)
Res4313 = keras.layers.Reshape((2, 1, 1), name = 'Res4313', )(Res56004)
Con99833 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con99833', )(Res4313)
Res91753 = keras.layers.Reshape((2, 1, 4, 1), name = 'Res91753', )(Con99833)
Cro26444 = keras.layers.Cropping3D(cropping=((0, 1), (0, 0), (3, 0)), name = 'Cro26444', )(Res91753)
model = tf.keras.models.Model(inputs=[in0GRU50222], outputs=Cro26444)
w = model.get_layer('GRU50222').get_weights() 
w[0] = np.array([[1, 1, 3, 4, 3, 10], [10, 6, 1, 4, 7, 6], [9, 10, 4, 2, 8, 4]])
w[1] = np.array([[9, 2, 2, 9, 10, 10], [7, 9, 3, 4, 1, 3]])
w[2] = np.array([8, 5, 10, 3, 1, 2])
model.get_layer('GRU50222').set_weights(w) 
w = model.get_layer('Con99833').get_weights() 
w[0] = np.array([[[[0.213, 0.6146, 0.9776, 0.1902]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con99833').set_weights(w) 
in0GRU50222 = tf.constant([[[4, 1, 8]]])
print (np.array2string(model.predict([in0GRU50222],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro26444.png')

LGRU50222 = gru_layer([[[4, 1, 8]]],[[1, 1, 3, 4, 3, 10], [10, 6, 1, 4, 7, 6], [9, 10, 4, 2, 8, 4]],[[9, 2, 2, 9, 10, 10], [7, 9, 3, 4, 1, 3]],[8, 5, 10, 3, 1, 2], false, GRU50222), 
LRes56004 = reshape_layer(GRU50222, [2, 1], Res56004), 
LRes4313 = reshape_layer(Res56004, [2, 1, 1], Res4313), 
LCon99833 = conv2D_layer(Res4313, 1, 1,[[[[0.213, 0.6146, 0.9776, 0.1902]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con99833), 
LRes91753 = reshape_layer(Con99833, [2, 1, 4, 1], Res91753), 
LCro26444 = cropping3D_layer(Res91753, 0, 1, 0, 0, 3, 0, Cro26444), 
exec_layers([LGRU50222,LRes56004,LRes4313,LCon99833,LRes91753,LCro26444],["GRU50222","Res56004","Res4313","Con99833","Res91753","Cro26444"],Cro26444,"Cro26444")

Actual (Unparsed): [[[[[0.0000000]]]]]

Expected (Unparsed): [[[[[0.0]]]]]

Actual:   [[[[[0]]]]]

Expected: [[[[[0]]]]]