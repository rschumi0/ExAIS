import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub28707 = tf.keras.layers.Input(shape=([3]))
in1Sub28707 = tf.keras.layers.Input(shape=([3]))

Sub28707 = keras.layers.Subtract(name = 'Sub28707', )([in0Sub28707,in1Sub28707])
Res78381 = keras.layers.Reshape((3, 1), name = 'Res78381', )(Sub28707)
LST38560 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST38560', )(Res78381)
model = tf.keras.models.Model(inputs=[in0Sub28707,in1Sub28707], outputs=LST38560)
w = model.get_layer('LST38560').get_weights() 
w[0] = np.array([[10, 9, 9, 3]])
w[1] = np.array([[10, 5, 4, 1]])
w[2] = np.array([2, 9, 2, 6])
model.get_layer('LST38560').set_weights(w) 
in0Sub28707 = tf.constant([[0.4498, 0.9898, 0.8379]])
in1Sub28707 = tf.constant([[0.2563, 0.7839, 0.312]])
print (np.array2string(model.predict([in0Sub28707,in1Sub28707],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST38560.png')

LSub28707 = subtract_layer([[0.4498, 0.9898, 0.8379]], [[0.2563, 0.7839, 0.312]], Sub28707), 
LRes78381 = reshape_layer(Sub28707, [3, 1], Res78381), 
LLST38560 = lstm_layer(Res78381,[[10, 9, 9, 3]],[[10, 5, 4, 1]],[2, 9, 2, 6], LST38560), 
exec_layers([LSub28707,LRes78381,LLST38560],["Sub28707","Res78381","LST38560"],LST38560,"LST38560")

Actual (Unparsed): [[0.9946560]]

Expected (Unparsed): [[0.9946560048222002]]

Actual:   [[0.9947]]

Expected: [[0.9947]]