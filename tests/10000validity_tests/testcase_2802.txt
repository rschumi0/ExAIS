import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max52694 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max52694 = tf.keras.layers.Input(shape=([2, 1, 2]))

Max52694 = keras.layers.Maximum(name = 'Max52694', )([in0Max52694,in1Max52694])
Res28666 = keras.layers.Reshape((2, 2), name = 'Res28666', )(Max52694)
Sep11275 = keras.layers.SeparableConv1D(3, (2),strides=(2), padding='valid', name = 'Sep11275', )(Res28666)
model = tf.keras.models.Model(inputs=[in0Max52694,in1Max52694], outputs=Sep11275)
w = model.get_layer('Sep11275').get_weights() 
w[0] = np.array([[[0.1444], [0.693]], [[0.3941], [0.9836]]])
w[1] = np.array([[[0.4293, 0.6837, 0.126], [0.466, 0.5144, 0.4832]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep11275').set_weights(w) 
in0Max52694 = tf.constant([[[[0.0374, 0.2461]], [[0.9543, 0.3252]]]])
in1Max52694 = tf.constant([[[[0.3442, 0.6517]], [[0.5663, 0.528]]]])
print (np.array2string(model.predict([in0Max52694,in1Max52694],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep11275.png')

LMax52694 = maximum_layer([[[[[0.0374, 0.2461]], [[0.9543, 0.3252]]]], [[[[0.3442, 0.6517]], [[0.5663, 0.528]]]]], Max52694), 
LRes28666 = reshape_layer(Max52694, [2, 2], Res28666), 
LSep11275 = separable_conv1D_layer(Res28666, 2,[[[[0.1444], [0.693]], [[0.3941], [0.9836]]],[[[0.4293, 0.6837, 0.126], [0.466, 0.5144, 0.4832]]]],[0, 0, 0], 2, false, Sep11275), 
exec_layers([LMax52694,LRes28666,LSep11275],["Max52694","Res28666","Sep11275"],Sep11275,"Sep11275")

Actual (Unparsed): [[[0.6352641, 0.7905805, 0.5228220]]]

Expected (Unparsed): [[[0.635264060223,0.7905804677669999,0.52282197834]]]

Actual:   [[[0.6353, 0.7906, 0.5229]]]

Expected: [[[0.6353, 0.7906, 0.5229]]]