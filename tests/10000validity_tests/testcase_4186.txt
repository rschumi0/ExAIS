import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea72321 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Lea72321 = keras.layers.LeakyReLU(alpha=6.230611018073961, name = 'Lea72321', input_shape=(1, 1, 1, 2))(in0Lea72321)
Res22820 = keras.layers.Reshape((1, 1, 2), name = 'Res22820', )(Lea72321)
Res39540 = keras.layers.Reshape((1, 2), name = 'Res39540', )(Res22820)
Ave53288 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave53288', )(Res39540)
Res99411 = keras.layers.Reshape((1, 2, 1), name = 'Res99411', )(Ave53288)
Loc62390 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(1, 1), name = 'Loc62390', )(Res99411)
model = tf.keras.models.Model(inputs=[in0Lea72321], outputs=Loc62390)
w = model.get_layer('Loc62390').get_weights() 
w[0] = np.array([[[0.4142, 0.1442]], [[0.7606, 0.7982]]])
w[1] = np.array([[[0, 0], [0, 0]]])
model.get_layer('Loc62390').set_weights(w) 
in0Lea72321 = tf.constant([[[[[0.9494, 0.9596]]]]])
print (np.array2string(model.predict([in0Lea72321],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc62390.png')

LLea72321 = leaky_relu_layer([[[[[0.9494, 0.9596]]]]], 6.230611018073961, Lea72321), 
LRes22820 = reshape_layer(Lea72321, [1, 1, 2], Res22820), 
LRes39540 = reshape_layer(Res22820, [1, 2], Res39540), 
LAve53288 = average_pooling1D_layer(Res39540, 1, Ave53288), 
LRes99411 = reshape_layer(Ave53288, [1, 2, 1], Res99411), 
LLoc62390 = locally_connected2D_layer(Res99411, 1, 1,[[[0.4142, 0.1442]], [[0.7606, 0.7982]]],[[[0, 0], [0, 0]]], 1, 1, Loc62390), 
exec_layers([LLea72321,LRes22820,LRes39540,LAve53288,LRes99411,LLoc62390],["Lea72321","Res22820","Res39540","Ave53288","Res99411","Loc62390"],Loc62390,"Loc62390")

Actual (Unparsed): [[[[0.3932415, 0.1369035], [0.7298717, 0.7659527]]]]

Expected (Unparsed): [[[[0.39324148000000003,0.13690348],[0.7298717600000001,0.76595272]]]]

Actual:   [[[[0.3933, 0.137], [0.7299, 0.766]]]]

Expected: [[[[0.3933, 0.137], [0.7299, 0.766]]]]