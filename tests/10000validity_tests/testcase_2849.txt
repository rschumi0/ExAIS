import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub22439 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub22439 = tf.keras.layers.Input(shape=([2, 3]))
in0Ave73431 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave73431 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con67454 = tf.keras.layers.Input(shape=([1, 8]))
in0Zer91269 = tf.keras.layers.Input(shape=([3, 1, 4]))
in0Ave90300 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave90300 = tf.keras.layers.Input(shape=([1, 1, 1]))

Sub22439 = keras.layers.Subtract(name = 'Sub22439', )([in0Sub22439,in1Sub22439])
Res32213 = keras.layers.Reshape((2, 3, 1), name = 'Res32213', )(Sub22439)
Zer73997 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer73997', )(Res32213)
Ave73431 = keras.layers.Average(name = 'Ave73431', )([in0Ave73431,in1Ave73431])
Res30353 = keras.layers.Reshape((1, 4), name = 'Res30353', )(Ave73431)
Con67454 = keras.layers.Concatenate(axis=2, name = 'Con67454', )([Res30353,in0Con67454])
Zer91269 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer91269', )(in0Zer91269)
Res25016 = keras.layers.Reshape((5, 12), name = 'Res25016', )(Zer91269)
Dot5284 = keras.layers.Dot(axes=(2, 2), name = 'Dot5284', )([Con67454,Res25016])
Res5216 = keras.layers.Reshape((1, 5, 1), name = 'Res5216', )(Dot5284)
Ave90300 = keras.layers.Average(name = 'Ave90300', )([in0Ave90300,in1Ave90300])
Zer99128 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer99128', )(Ave90300)
Min94117 = keras.layers.Minimum(name = 'Min94117', )([Res5216,Zer99128])
Zer34374 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer34374', )(Min94117)
Ave55575 = keras.layers.Average(name = 'Ave55575', )([Zer73997,Zer34374])
model = tf.keras.models.Model(inputs=[in0Sub22439,in1Sub22439,in0Ave73431,in1Ave73431,in0Con67454,in0Zer91269,in0Ave90300,in1Ave90300], outputs=Ave55575)
in0Sub22439 = tf.constant([[[0.4016, 0.5166, 0.5993], [0.4261, 0.7782, 0.4389]]])
in1Sub22439 = tf.constant([[[0.3021, 0.4024, 0.5462], [0.8911, 0.5204, 0.3216]]])
in0Ave73431 = tf.constant([[[[0.7982, 0.7416], [0.1382, 0.9446]]]])
in1Ave73431 = tf.constant([[[[0.6289, 0.6004], [0.1333, 0.4546]]]])
in0Con67454 = tf.constant([[[0.728, 0.806, 0.6335, 0.0487, 0.7876, 0.089, 0.3015, 0.5634]]])
in0Zer91269 = tf.constant([[[[1.3548, 1.5777, 1.1416, 1.5419]], [[1.1867, 1.1444, 1.1339, 1.4608]], [[1.1531, 1.1269, 1.2918, 1.5358]]]])
in0Ave90300 = tf.constant([[[[0.6235]]]])
in1Ave90300 = tf.constant([[[[0.2998]]]])
print (np.array2string(model.predict([in0Sub22439,in1Sub22439,in0Ave73431,in1Ave73431,in0Con67454,in0Zer91269,in0Ave90300,in1Ave90300],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave55575.png')

LSub22439 = subtract_layer([[[0.4016, 0.5166, 0.5993], [0.4261, 0.7782, 0.4389]]], [[[0.3021, 0.4024, 0.5462], [0.8911, 0.5204, 0.3216]]], Sub22439), 
LRes32213 = reshape_layer(Sub22439, [2, 3, 1], Res32213), 
LZer73997 = zero_padding2D_layer(Res32213, 0, 0, 4, 0, Zer73997), 
LAve73431 = average_layer([[[[[0.7982, 0.7416], [0.1382, 0.9446]]]], [[[[0.6289, 0.6004], [0.1333, 0.4546]]]]], Ave73431), 
LRes30353 = reshape_layer(Ave73431, [1, 4], Res30353), 
LCon67454 = concatenate_layer([Res30353,[[[0.728, 0.806, 0.6335, 0.0487, 0.7876, 0.089, 0.3015, 0.5634]]]], 2, Con67454), 
LZer91269 = zero_padding2D_layer([[[[1.3548, 1.5777, 1.1416, 1.5419]], [[1.1867, 1.1444, 1.1339, 1.4608]], [[1.1531, 1.1269, 1.2918, 1.5358]]]], 1, 1, 1, 1, Zer91269), 
LRes25016 = reshape_layer(Zer91269, [5, 12], Res25016), 
LDot5284 = dot_layer(Con67454,Res25016, 2, 2, Dot5284), 
LRes5216 = reshape_layer(Dot5284, [1, 5, 1], Res5216), 
LAve90300 = average_layer([[[[[0.6235]]]], [[[[0.2998]]]]], Ave90300), 
LZer99128 = zero_padding2D_layer(Ave90300, 0, 0, 4, 0, Zer99128), 
LMin94117 = minimum_layer([Res5216,Zer99128], Min94117), 
LZer34374 = zero_padding2D_layer(Min94117, 1, 0, 2, 0, Zer34374), 
LAve55575 = average_layer([Zer73997,Zer34374], Ave55575), 
exec_layers([LSub22439,LRes32213,LZer73997,LAve73431,LRes30353,LCon67454,LZer91269,LRes25016,LDot5284,LRes5216,LAve90300,LZer99128,LMin94117,LZer34374,LAve55575],["Sub22439","Res32213","Zer73997","Ave73431","Res30353","Con67454","Zer91269","Res25016","Dot5284","Res5216","Ave90300","Zer99128","Min94117","Zer34374","Ave55575"],Ave55575,"Ave55575")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0497500], [0.0571000], [0.0265500]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [-0.2325000], [0.1289000], [0.0586500]]]]

Expected (Unparsed): [[[[0],[0],[0],[0],[0.049750000000000016],[0.057099999999999984],[0.026550000000000018]],[[0],[0],[0.0],[0],[-0.2325],[0.12890000000000001],[0.05865000000000001]]]]

Actual:   [[[[0], [0], [0], [0], [0.0498], [0.0571], [0.0266]], [[0], [0], [0], [0], [-0.2325], [0.1289], [0.0587]]]]

Expected: [[[[0], [0], [0], [0], [0.0498], [0.0571], [0.0266]], [[0], [0], [0], [0], [-0.2325], [0.129], [0.0587]]]]