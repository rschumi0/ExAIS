import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave98219 = tf.keras.layers.Input(shape=([2, 1]))
in0Con1185 = tf.keras.layers.Input(shape=([2, 3, 3, 1]))
in0Min94880 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Min94880 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Add2533 = tf.keras.layers.Input(shape=([1, 1]))
in1Add2533 = tf.keras.layers.Input(shape=([1, 1]))

Ave98219 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave98219', )(in0Ave98219)
Res33283 = keras.layers.Reshape((2, 1, 1), name = 'Res33283', )(Ave98219)
Res45308 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res45308', )(Res33283)
Zer79083 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (2, 0)), name = 'Zer79083', )(Res45308)
Con1185 = keras.layers.Concatenate(axis=4, name = 'Con1185', )([Zer79083,in0Con1185])
Min94880 = keras.layers.Minimum(name = 'Min94880', )([in0Min94880,in1Min94880])
Zer63590 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer63590', )(Min94880)
Sub67046 = keras.layers.Subtract(name = 'Sub67046', )([Con1185,Zer63590])
Res25802 = keras.layers.Reshape((2, 3, 6), name = 'Res25802', )(Sub67046)
Res85191 = keras.layers.Reshape((2, 18), name = 'Res85191', )(Res25802)
Ave63417 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='same', name = 'Ave63417', )(Res85191)
Add2533 = keras.layers.Add(name = 'Add2533', )([in0Add2533,in1Add2533])
Zer69729 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer69729', )(Add2533)
Dot98202 = keras.layers.Dot(axes=(1, 1), name = 'Dot98202', )([Ave63417,Zer69729])
model = tf.keras.models.Model(inputs=[in0Ave98219,in0Con1185,in0Min94880,in1Min94880,in0Add2533,in1Add2533], outputs=Dot98202)
in0Ave98219 = tf.constant([[[1.6606], [1.7286]]])
in0Con1185 = tf.constant([[[[[0.6059], [0.0751], [0.1171]], [[0.0439], [0.2681], [0.7891]], [[0.9656], [0.5146], [0.5969]]], [[[0.949], [0.7103], [0.5955]], [[0.4855], [0.7465], [0.3956]], [[0.6174], [0.0383], [0.9559]]]]])
in0Min94880 = tf.constant([[[[[0.9509, 0.0715], [0.2243, 0.3343]], [[0.262, 0.5425], [0.4711, 0.0832]]]]])
in1Min94880 = tf.constant([[[[[0.9791, 0.9959], [0.7424, 0.51]], [[0.2211, 0.1092], [0.8584, 0.8068]]]]])
in0Add2533 = tf.constant([[[0.3673]]])
in1Add2533 = tf.constant([[[0.3437]]])
print (np.array2string(model.predict([in0Ave98219,in0Con1185,in0Min94880,in1Min94880,in0Add2533,in1Add2533],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot98202.png')

LAve98219 = average_pooling1D_layer([[[1.6606], [1.7286]]], 1, Ave98219), 
LRes33283 = reshape_layer(Ave98219, [2, 1, 1], Res33283), 
LRes45308 = reshape_layer(Res33283, [2, 1, 1, 1], Res45308), 
LZer79083 = zero_padding3D_layer(Res45308, 0, 0, 2, 0, 2, 0, Zer79083), 
LCon1185 = concatenate_layer([Zer79083,[[[[[0.6059], [0.0751], [0.1171]], [[0.0439], [0.2681], [0.7891]], [[0.9656], [0.5146], [0.5969]]], [[[0.949], [0.7103], [0.5955]], [[0.4855], [0.7465], [0.3956]], [[0.6174], [0.0383], [0.9559]]]]]], 4, Con1185), 
LMin94880 = minimum_layer([[[[[[0.9509, 0.0715], [0.2243, 0.3343]], [[0.262, 0.5425], [0.4711, 0.0832]]]]], [[[[[0.9791, 0.9959], [0.7424, 0.51]], [[0.2211, 0.1092], [0.8584, 0.8068]]]]]], Min94880), 
LZer63590 = zero_padding3D_layer(Min94880, 1, 0, 1, 0, 1, 0, Zer63590), 
LSub67046 = subtract_layer(Con1185,Zer63590, Sub67046), 
LRes25802 = reshape_layer(Sub67046, [2, 3, 6], Res25802), 
LRes85191 = reshape_layer(Res25802, [2, 18], Res85191), 
LAve63417 = average_pooling1D_layer(Res85191, 1, 1, true, Ave63417), 
LAdd2533 = add_layer([[[[0.3673]]], [[[0.3437]]]], Add2533), 
LZer69729 = zero_padding1D_layer(Add2533, 1, 0, Zer69729), 
LDot98202 = dot_layer(Ave63417,Zer69729, 1, 1, Dot98202), 
exec_layers([LAve98219,LRes33283,LRes45308,LZer79083,LCon1185,LMin94880,LZer63590,LSub67046,LRes25802,LRes85191,LAve63417,LAdd2533,LZer69729,LDot98202],["Ave98219","Res33283","Res45308","Zer79083","Con1185","Min94880","Zer63590","Sub67046","Res25802","Res85191","Ave63417","Add2533","Zer69729","Dot98202"],Dot98202,"Dot98202")

Actual (Unparsed): [[[0.0000000], [0.6747390], [0.0000000], [0.5050233], [0.0000000], [0.4234005], [0.0000000], [0.3451905], [-0.6760899], [0.4799250], [-0.1594773], [0.0435843], [0.0000000], [0.4389714], [-0.1572021], [-0.0504099], [0.8940825], [0.6204897]]]

Expected (Unparsed): [[[0.0],[0.6747390000000001],[0.0],[0.5050233000000001],[0.0],[0.42340050000000007],[0.0],[0.3451905],[-0.6760899],[0.4799250000000001],[-0.15947730000000002],[0.04358430000000002],[0.0],[0.4389714],[-0.1572021],[-0.05040990000000001],[0.8940825],[0.6204897000000001]]]

Actual:   [[[0], [0.6748], [0], [0.5051], [0], [0.4235], [0], [0.3452], [-0.676], [0.48], [-0.1594], [0.0436], [0], [0.439], [-0.1572], [-0.0504], [0.8941], [0.6205]]]

Expected: [[[0], [0.6748], [0], [0.5051], [0], [0.4235], [0], [0.3452], [-0.676], [0.48], [-0.1594], [0.0436], [0], [0.439], [-0.1572], [-0.0504], [0.8941], [0.6205]]]