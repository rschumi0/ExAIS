import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max77019 = tf.keras.layers.Input(shape=([2, 2, 1]))

Max77019 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(1, 2), padding='same', name = 'Max77019', )(in0Max77019)
Res95370 = keras.layers.Reshape((2, 1), name = 'Res95370', )(Max77019)
Glo67944 = keras.layers.GlobalMaxPool1D(name = 'Glo67944', )(Res95370)
Mas48675 = keras.layers.Masking(mask_value=2, name = 'Mas48675', )(Glo67944)
Lay37589 = keras.layers.LayerNormalization(axis=1, epsilon=1.0732054773533126, name = 'Lay37589', )(Mas48675)
Res34022 = keras.layers.Reshape((1, 1), name = 'Res34022', )(Lay37589)
Res95824 = keras.layers.Reshape((1, 1, 1), name = 'Res95824', )(Res34022)
Con71916 = keras.layers.Conv2D(4, (1, 1),strides=(1, 2), padding='same', dilation_rate=(1, 1), name = 'Con71916', )(Res95824)
model = tf.keras.models.Model(inputs=[in0Max77019], outputs=Con71916)
w = model.get_layer('Con71916').get_weights() 
w[0] = np.array([[[[0.4958, 0.1927, 0.0517, 0.176]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con71916').set_weights(w) 
in0Max77019 = tf.constant([[[[1.6413], [1.4714]], [[1.2206], [1.7781]]]])
print (np.array2string(model.predict([in0Max77019],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con71916.png')

LMax77019 = max_pool2D_layer([[[[1.6413], [1.4714]], [[1.2206], [1.7781]]]], 2, 1, 1, 2, true, Max77019), 
LRes95370 = reshape_layer(Max77019, [2, 1], Res95370), 
LGlo67944 = global_max_pool1D_layer(Res95370, Glo67944), 
LMas48675 = masking_layer(Glo67944, 2, Mas48675), 
LLay37589 = layer_normalization_layer(Mas48675, 1, 1.0732054773533126, Lay37589), 
LRes34022 = reshape_layer(Lay37589, [1, 1], Res34022), 
LRes95824 = reshape_layer(Res34022, [1, 1, 1], Res95824), 
LCon71916 = conv2D_layer(Res95824, 1, 1,[[[[0.4958, 0.1927, 0.0517, 0.176]]]],[0, 0, 0, 0], 1, 2, true, 1, 1, Con71916), 
exec_layers([LMax77019,LRes95370,LGlo67944,LMas48675,LLay37589,LRes34022,LRes95824,LCon71916],["Max77019","Res95370","Glo67944","Mas48675","Lay37589","Res34022","Res95824","Con71916"],Con71916,"Con71916")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0.0,0.0,0.0,0.0]]]]

Actual:   [[[[0, 0, 0, 0]]]]

Expected: [[[[0, 0, 0, 0]]]]