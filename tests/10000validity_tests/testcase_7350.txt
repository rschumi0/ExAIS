import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min60349 = tf.keras.layers.Input(shape=([2, 2]))
in1Min60349 = tf.keras.layers.Input(shape=([2, 2]))
in0Max20789 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con72842 = tf.keras.layers.Input(shape=([2, 1]))
in0Max30720 = tf.keras.layers.Input(shape=([2, 2]))
in1Max30720 = tf.keras.layers.Input(shape=([2, 2]))

Min60349 = keras.layers.Minimum(name = 'Min60349', )([in0Min60349,in1Min60349])
Res2168 = keras.layers.Reshape((2, 2, 1), name = 'Res2168', )(Min60349)
Dep29478 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='same', name = 'Dep29478', )(Res2168)
Res28916 = keras.layers.Reshape((2, 2), name = 'Res28916', )(Dep29478)
Max20789 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max20789', )(in0Max20789)
Res22206 = keras.layers.Reshape((1, 1), name = 'Res22206', )(Max20789)
Zer36189 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer36189', )(Res22206)
Con72842 = keras.layers.Concatenate(axis=2, name = 'Con72842', )([Zer36189,in0Con72842])
Max30720 = keras.layers.Maximum(name = 'Max30720', )([in0Max30720,in1Max30720])
Mul52834 = keras.layers.Multiply(name = 'Mul52834', )([Con72842,Max30720])
Ave69064 = keras.layers.Average(name = 'Ave69064', )([Res28916,Mul52834])
Thr54792 = keras.layers.ThresholdedReLU(theta=0.5043193107637209, name = 'Thr54792', )(Ave69064)
Res81738 = keras.layers.Reshape((2, 2, 1), name = 'Res81738', )(Thr54792)
Con61908 = keras.layers.Conv2DTranspose(2, (1, 2),strides=(1, 1), padding='valid', name = 'Con61908', )(Res81738)
model = tf.keras.models.Model(inputs=[in0Min60349,in1Min60349,in0Max20789,in0Con72842,in0Max30720,in1Max30720], outputs=Con61908)
w = model.get_layer('Dep29478').get_weights() 
w[0] = np.array([[[[0.0423]]], [[[0.495]]]])
w[1] = np.array([0])
model.get_layer('Dep29478').set_weights(w) 
w = model.get_layer('Con61908').get_weights() 
w[0] = np.array([[[[0.677], [0.812]], [[0.9929], [0.029]]]])
w[1] = np.array([0, 0])
model.get_layer('Con61908').set_weights(w) 
in0Min60349 = tf.constant([[[0.0696, 0.5209], [0.939, 0.0502]]])
in1Min60349 = tf.constant([[[0.4638, 0.6693], [0.4934, 0.3381]]])
in0Max20789 = tf.constant([[[[1.5809]]]])
in0Con72842 = tf.constant([[[0.3501], [0.1593]]])
in0Max30720 = tf.constant([[[0.4248, 0.2098], [0.9988, 0.9885]]])
in1Max30720 = tf.constant([[[0.1595, 0.4972], [0.791, 0.7657]]])
print (np.array2string(model.predict([in0Min60349,in1Min60349,in0Max20789,in0Con72842,in0Max30720,in1Max30720],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con61908.png')

LMin60349 = minimum_layer([[[[0.0696, 0.5209], [0.939, 0.0502]]], [[[0.4638, 0.6693], [0.4934, 0.3381]]]], Min60349), 
LRes2168 = reshape_layer(Min60349, [2, 2, 1], Res2168), 
LDep29478 = depthwise_conv2D_layer(Res2168, 2, 1,[[[[0.0423]]], [[[0.495]]]],[0], 1, 1, true, Dep29478), 
LRes28916 = reshape_layer(Dep29478, [2, 2], Res28916), 
LMax20789 = max_pool2D_layer([[[[1.5809]]]], 1, 1, Max20789), 
LRes22206 = reshape_layer(Max20789, [1, 1], Res22206), 
LZer36189 = zero_padding1D_layer(Res22206, 1, 0, Zer36189), 
LCon72842 = concatenate_layer([Zer36189,[[[0.3501], [0.1593]]]], 2, Con72842), 
LMax30720 = maximum_layer([[[[0.4248, 0.2098], [0.9988, 0.9885]]], [[[0.1595, 0.4972], [0.791, 0.7657]]]], Max30720), 
LMul52834 = multiply_layer([Con72842,Max30720], Mul52834), 
LAve69064 = average_layer([Res28916,Mul52834], Ave69064), 
LThr54792 = thresholded_relu_layer(Ave69064, 0.5043193107637209, Thr54792), 
LRes81738 = reshape_layer(Thr54792, [2, 2, 1], Res81738), 
LCon61908 = conv2D_transpose_layer(Res81738, 1, 2,[[[[0.677], [0.812]], [[0.9929], [0.029]]]],[0, 0], 1, 1, false, Con61908), 
exec_layers([LMin60349,LRes2168,LDep29478,LRes28916,LMax20789,LRes22206,LZer36189,LCon72842,LMax30720,LMul52834,LAve69064,LThr54792,LRes81738,LCon61908],["Min60349","Res2168","Dep29478","Res28916","Max20789","Res22206","Zer36189","Con72842","Max30720","Mul52834","Ave69064","Thr54792","Res81738","Con61908"],Con61908,"Con61908")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.5415572, 0.6495487], [0.7942573, 0.0231982], [0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0.0,0.0],[0.0,0.0],[0.0,0.0]],[[0.54155726099,0.64954873844],[0.794257318223,0.023198169230000003],[0.0,0.0]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0]], [[0.5416, 0.6496], [0.7943, 0.0232], [0, 0]]]]

Expected: [[[[0, 0], [0, 0], [0, 0]], [[0.5416, 0.6496], [0.7943, 0.0232], [0, 0]]]]