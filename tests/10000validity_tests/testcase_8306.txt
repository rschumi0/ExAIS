import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul6213 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Mul6213 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Glo44982 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con59594 = tf.keras.layers.Input(shape=([3]))
in0Add54991 = tf.keras.layers.Input(shape=([2, 1]))
in1Add54991 = tf.keras.layers.Input(shape=([2, 1]))

Mul6213 = keras.layers.Multiply(name = 'Mul6213', )([in0Mul6213,in1Mul6213])
Res16125 = keras.layers.Reshape((2, 2, 1), name = 'Res16125', )(Mul6213)
Res80423 = keras.layers.Reshape((2, 2), name = 'Res80423', )(Res16125)
Fla96160 = keras.layers.Flatten(name = 'Fla96160', )(Res80423)
Glo44982 = keras.layers.GlobalAveragePooling3D(name = 'Glo44982', )(in0Glo44982)
Con59594 = keras.layers.Concatenate(axis=1, name = 'Con59594', )([Glo44982,in0Con59594])
Add99230 = keras.layers.Add(name = 'Add99230', )([Fla96160,Con59594])
Res69663 = keras.layers.Reshape((4, 1), name = 'Res69663', )(Add99230)
Add54991 = keras.layers.Add(name = 'Add54991', )([in0Add54991,in1Add54991])
Zer48579 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer48579', )(Add54991)
Ave8227 = keras.layers.Average(name = 'Ave8227', )([Res69663,Zer48579])
Mas42042 = keras.layers.Masking(mask_value=1, name = 'Mas42042', )(Ave8227)
model = tf.keras.models.Model(inputs=[in0Mul6213,in1Mul6213,in0Glo44982,in0Con59594,in0Add54991,in1Add54991], outputs=Mas42042)
in0Mul6213 = tf.constant([[[[[0.1032]], [[0.1247]]], [[[0.1891]], [[0.7422]]]]])
in1Mul6213 = tf.constant([[[[[0.2819]], [[0.2698]]], [[[0.7844]], [[0.7051]]]]])
in0Glo44982 = tf.constant([[[[[1.6805], [1.253]]]]])
in0Con59594 = tf.constant([[0.0228, 0.0514, 0.8098]])
in0Add54991 = tf.constant([[[0.806], [0.5951]]])
in1Add54991 = tf.constant([[[0.7936], [0.6466]]])
print (np.array2string(model.predict([in0Mul6213,in1Mul6213,in0Glo44982,in0Con59594,in0Add54991,in1Add54991],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas42042.png')

LMul6213 = multiply_layer([[[[[[0.1032]], [[0.1247]]], [[[0.1891]], [[0.7422]]]]], [[[[[0.2819]], [[0.2698]]], [[[0.7844]], [[0.7051]]]]]], Mul6213), 
LRes16125 = reshape_layer(Mul6213, [2, 2, 1], Res16125), 
LRes80423 = reshape_layer(Res16125, [2, 2], Res80423), 
LFla96160 = flatten_layer(Res80423, Fla96160), 
LGlo44982 = global_average_pooling3D_layer([[[[[1.6805], [1.253]]]]], Glo44982), 
LCon59594 = concatenate_layer([Glo44982,[[0.0228, 0.0514, 0.8098]]], 1, Con59594), 
LAdd99230 = add_layer([Fla96160,Con59594], Add99230), 
LRes69663 = reshape_layer(Add99230, [4, 1], Res69663), 
LAdd54991 = add_layer([[[[0.806], [0.5951]]], [[[0.7936], [0.6466]]]], Add54991), 
LZer48579 = zero_padding1D_layer(Add54991, 2, 0, Zer48579), 
LAve8227 = average_layer([Res69663,Zer48579], Ave8227), 
LMas42042 = masking_layer(Ave8227, 1, Mas42042), 
exec_layers([LMul6213,LRes16125,LRes80423,LFla96160,LGlo44982,LCon59594,LAdd99230,LRes69663,LAdd54991,LZer48579,LAve8227,LMas42042],["Mul6213","Res16125","Res80423","Fla96160","Glo44982","Con59594","Add99230","Res69663","Add54991","Zer48579","Ave8227","Mas42042"],Mas42042,"Mas42042")

Actual (Unparsed): [[[0.7479211], [0.0282220], [0.8996650], [1.2874126]]]

Expected (Unparsed): [[[0.74792104],[0.02822203],[0.89966502],[1.2874126099999998]]]

Actual:   [[[0.748], [0.0283], [0.8997], [1.2875]]]

Expected: [[[0.748], [0.0283], [0.8997], [1.2875]]]