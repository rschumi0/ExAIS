import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul93002 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul93002 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Max5480 = tf.keras.layers.Input(shape=([1, 1]))
in1Max5480 = tf.keras.layers.Input(shape=([1, 1]))
in0Con15651 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot13073 = tf.keras.layers.Input(shape=([2]))
in1Dot13073 = tf.keras.layers.Input(shape=([2]))
in0Con65317 = tf.keras.layers.Input(shape=([1]))

Mul93002 = keras.layers.Multiply(name = 'Mul93002', )([in0Mul93002,in1Mul93002])
Res19164 = keras.layers.Reshape((1, 2), name = 'Res19164', )(Mul93002)
Max5480 = keras.layers.Maximum(name = 'Max5480', )([in0Max5480,in1Max5480])
Con15651 = keras.layers.Concatenate(axis=2, name = 'Con15651', )([Max5480,in0Con15651])
Sub6227 = keras.layers.Subtract(name = 'Sub6227', )([Res19164,Con15651])
Fla66835 = keras.layers.Flatten(name = 'Fla66835', )(Sub6227)
Dot13073 = keras.layers.Dot(axes=(1, 1), name = 'Dot13073', )([in0Dot13073,in1Dot13073])
Con65317 = keras.layers.Concatenate(axis=1, name = 'Con65317', )([Dot13073,in0Con65317])
Ave90993 = keras.layers.Average(name = 'Ave90993', )([Fla66835,Con65317])
model = tf.keras.models.Model(inputs=[in0Mul93002,in1Mul93002,in0Max5480,in1Max5480,in0Con15651,in0Dot13073,in1Dot13073,in0Con65317], outputs=Ave90993)
in0Mul93002 = tf.constant([[[[0.8912, 0.9761]]]])
in1Mul93002 = tf.constant([[[[0.6152, 0.1145]]]])
in0Max5480 = tf.constant([[[0.5529]]])
in1Max5480 = tf.constant([[[0.6205]]])
in0Con15651 = tf.constant([[[0.8867]]])
in0Dot13073 = tf.constant([[0.9438, 0.3328]])
in1Dot13073 = tf.constant([[0.7128, 0.8011]])
in0Con65317 = tf.constant([[0.1512]])
print (np.array2string(model.predict([in0Mul93002,in1Mul93002,in0Max5480,in1Max5480,in0Con15651,in0Dot13073,in1Dot13073,in0Con65317],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave90993.png')

LMul93002 = multiply_layer([[[[[0.8912, 0.9761]]]], [[[[0.6152, 0.1145]]]]], Mul93002), 
LRes19164 = reshape_layer(Mul93002, [1, 2], Res19164), 
LMax5480 = maximum_layer([[[[0.5529]]], [[[0.6205]]]], Max5480), 
LCon15651 = concatenate_layer([Max5480,[[[0.8867]]]], 2, Con15651), 
LSub6227 = subtract_layer(Res19164,Con15651, Sub6227), 
LFla66835 = flatten_layer(Sub6227, Fla66835), 
LDot13073 = dot_layer([[0.9438, 0.3328]], [[0.7128, 0.8011]], 1, 1, Dot13073), 
LCon65317 = concatenate_layer([Dot13073,[[0.1512]]], 1, Con65317), 
LAve90993 = average_layer([Fla66835,Con65317], Ave90993), 
exec_layers([LMul93002,LRes19164,LMax5480,LCon15651,LSub6227,LFla66835,LDot13073,LCon65317,LAve90993],["Mul93002","Res19164","Max5480","Con15651","Sub6227","Fla66835","Dot13073","Con65317","Ave90993"],Ave90993,"Ave90993")

Actual (Unparsed): [[0.4335565, -0.3118683]]

Expected (Unparsed): [[0.43355648,-0.31186827500000003]]

Actual:   [[0.4336, -0.3118]]

Expected: [[0.4336, -0.3118]]