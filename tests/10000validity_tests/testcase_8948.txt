import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max96583 = tf.keras.layers.Input(shape=([2, 1]))
in1Max96583 = tf.keras.layers.Input(shape=([2, 1]))
in0Sub89931 = tf.keras.layers.Input(shape=([2]))
in1Sub89931 = tf.keras.layers.Input(shape=([2]))

Max96583 = keras.layers.Maximum(name = 'Max96583', )([in0Max96583,in1Max96583])
Fla34488 = keras.layers.Flatten(name = 'Fla34488', )(Max96583)
Sub89931 = keras.layers.Subtract(name = 'Sub89931', )([in0Sub89931,in1Sub89931])
Max68562 = keras.layers.Maximum(name = 'Max68562', )([Fla34488,Sub89931])
Res723 = keras.layers.Reshape((2, 1), name = 'Res723', )(Max68562)
Res89596 = keras.layers.Reshape((2, 1, 1), name = 'Res89596', )(Res723)
Res50044 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res50044', )(Res89596)
Cro1364 = keras.layers.Cropping3D(cropping=((0, 1), (0, 0), (0, 0)), name = 'Cro1364', )(Res50044)
model = tf.keras.models.Model(inputs=[in0Max96583,in1Max96583,in0Sub89931,in1Sub89931], outputs=Cro1364)
in0Max96583 = tf.constant([[[0.7675], [0.3151]]])
in1Max96583 = tf.constant([[[0.997], [0.1288]]])
in0Sub89931 = tf.constant([[0.2816, 0.441]])
in1Sub89931 = tf.constant([[0.2263, 0.0375]])
print (np.array2string(model.predict([in0Max96583,in1Max96583,in0Sub89931,in1Sub89931],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro1364.png')

LMax96583 = maximum_layer([[[[0.7675], [0.3151]]], [[[0.997], [0.1288]]]], Max96583), 
LFla34488 = flatten_layer(Max96583, Fla34488), 
LSub89931 = subtract_layer([[0.2816, 0.441]], [[0.2263, 0.0375]], Sub89931), 
LMax68562 = maximum_layer([Fla34488,Sub89931], Max68562), 
LRes723 = reshape_layer(Max68562, [2, 1], Res723), 
LRes89596 = reshape_layer(Res723, [2, 1, 1], Res89596), 
LRes50044 = reshape_layer(Res89596, [2, 1, 1, 1], Res50044), 
LCro1364 = cropping3D_layer(Res50044, 0, 1, 0, 0, 0, 0, Cro1364), 
exec_layers([LMax96583,LFla34488,LSub89931,LMax68562,LRes723,LRes89596,LRes50044,LCro1364],["Max96583","Fla34488","Sub89931","Max68562","Res723","Res89596","Res50044","Cro1364"],Cro1364,"Cro1364")

Actual (Unparsed): [[[[[0.9970000]]]]]

Expected (Unparsed): [[[[[0.997]]]]]

Actual:   [[[[[0.997]]]]]

Expected: [[[[[0.997]]]]]