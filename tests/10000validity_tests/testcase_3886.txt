import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro32882 = tf.keras.layers.Input(shape=([1, 2]))
in0Con63147 = tf.keras.layers.Input(shape=([1, 1]))
in0Max78624 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max78624 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con54474 = tf.keras.layers.Input(shape=([1, 3]))
in0Max10595 = tf.keras.layers.Input(shape=([1, 2]))
in1Max10595 = tf.keras.layers.Input(shape=([1, 2]))
in0Dot858 = tf.keras.layers.Input(shape=([3]))
in1Dot858 = tf.keras.layers.Input(shape=([3]))
in0Con31626 = tf.keras.layers.Input(shape=([1]))

Cro32882 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro32882', )(in0Cro32882)
Res83989 = keras.layers.Reshape((1, 2, 1), name = 'Res83989', )(Cro32882)
Glo7432 = keras.layers.GlobalAveragePooling2D(name = 'Glo7432', )(Res83989)
Res66919 = keras.layers.Reshape((1, 1), name = 'Res66919', )(Glo7432)
Res44900 = keras.layers.Reshape((1, 1, 1), name = 'Res44900', )(Res66919)
Con21145 = keras.layers.Conv2D(3, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con21145', )(Res44900)
Res8767 = keras.layers.Reshape((1, 3), name = 'Res8767', )(Con21145)
Con63147 = keras.layers.Concatenate(axis=2, name = 'Con63147', )([Res8767,in0Con63147])
Max78624 = keras.layers.Maximum(name = 'Max78624', )([in0Max78624,in1Max78624])
Res99694 = keras.layers.Reshape((1, 1), name = 'Res99694', )(Max78624)
Con54474 = keras.layers.Concatenate(axis=2, name = 'Con54474', )([Res99694,in0Con54474])
Max10595 = keras.layers.Maximum(name = 'Max10595', )([in0Max10595,in1Max10595])
Fla55438 = keras.layers.Flatten(name = 'Fla55438', )(Max10595)
Dot858 = keras.layers.Dot(axes=(1, 1), name = 'Dot858', )([in0Dot858,in1Dot858])
Con31626 = keras.layers.Concatenate(axis=1, name = 'Con31626', )([Dot858,in0Con31626])
Add24152 = keras.layers.Add(name = 'Add24152', )([Fla55438,Con31626])
Res19157 = keras.layers.Reshape((2, 1), name = 'Res19157', )(Add24152)
Sep46327 = keras.layers.SeparableConv1D(4, (2),strides=(2), padding='valid', name = 'Sep46327', )(Res19157)
Mul59810 = keras.layers.Multiply(name = 'Mul59810', )([Con54474,Sep46327])
Ave48331 = keras.layers.Average(name = 'Ave48331', )([Con63147,Mul59810])
model = tf.keras.models.Model(inputs=[in0Cro32882,in0Con63147,in0Max78624,in1Max78624,in0Con54474,in0Max10595,in1Max10595,in0Dot858,in1Dot858,in0Con31626], outputs=Ave48331)
w = model.get_layer('Con21145').get_weights() 
w[0] = np.array([[[[0.1308, 0.0847, 0.233]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con21145').set_weights(w) 
w = model.get_layer('Sep46327').get_weights() 
w[0] = np.array([[[0.6804]], [[0.575]]])
w[1] = np.array([[[0.3721, 0.5781, 0.7621, 0.8491]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep46327').set_weights(w) 
in0Cro32882 = tf.constant([[[1.4213, 1.6312]]])
in0Con63147 = tf.constant([[[0.2691]]])
in0Max78624 = tf.constant([[[[0.2979]]]])
in1Max78624 = tf.constant([[[[0.1459]]]])
in0Con54474 = tf.constant([[[0.8495, 0.4413, 0.7353]]])
in0Max10595 = tf.constant([[[0.3968, 0.2414]]])
in1Max10595 = tf.constant([[[0.2997, 0.0207]]])
in0Dot858 = tf.constant([[0.8269, 0.6451, 0.6972]])
in1Dot858 = tf.constant([[0.6962, 0.4527, 0.7737]])
in0Con31626 = tf.constant([[0.7204]])
print (np.array2string(model.predict([in0Cro32882,in0Con63147,in0Max78624,in1Max78624,in0Con54474,in0Max10595,in1Max10595,in0Dot858,in1Dot858,in0Con31626],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave48331.png')

LCro32882 = cropping1D_layer([[[1.4213, 1.6312]]], 0, 0, Cro32882), 
LRes83989 = reshape_layer(Cro32882, [1, 2, 1], Res83989), 
LGlo7432 = global_average_pooling2D_layer(Res83989, Glo7432), 
LRes66919 = reshape_layer(Glo7432, [1, 1], Res66919), 
LRes44900 = reshape_layer(Res66919, [1, 1, 1], Res44900), 
LCon21145 = conv2D_layer(Res44900, 1, 1,[[[[0.1308, 0.0847, 0.233]]]],[0, 0, 0], 1, 1, true, 1, 1, Con21145), 
LRes8767 = reshape_layer(Con21145, [1, 3], Res8767), 
LCon63147 = concatenate_layer([Res8767,[[[0.2691]]]], 2, Con63147), 
LMax78624 = maximum_layer([[[[[0.2979]]]], [[[[0.1459]]]]], Max78624), 
LRes99694 = reshape_layer(Max78624, [1, 1], Res99694), 
LCon54474 = concatenate_layer([Res99694,[[[0.8495, 0.4413, 0.7353]]]], 2, Con54474), 
LMax10595 = maximum_layer([[[[0.3968, 0.2414]]], [[[0.2997, 0.0207]]]], Max10595), 
LFla55438 = flatten_layer(Max10595, Fla55438), 
LDot858 = dot_layer([[0.8269, 0.6451, 0.6972]], [[0.6962, 0.4527, 0.7737]], 1, 1, Dot858), 
LCon31626 = concatenate_layer([Dot858,[[0.7204]]], 1, Con31626), 
LAdd24152 = add_layer([Fla55438,Con31626], Add24152), 
LRes19157 = reshape_layer(Add24152, [2, 1], Res19157), 
LSep46327 = separable_conv1D_layer(Res19157, 2,[[[[0.6804]], [[0.575]]],[[[0.3721, 0.5781, 0.7621, 0.8491]]]],[0, 0, 0, 0], 2, false, Sep46327), 
LMul59810 = multiply_layer([Con54474,Sep46327], Mul59810), 
LAve48331 = average_layer([Con63147,Mul59810], Ave48331), 
exec_layers([LCro32882,LRes83989,LGlo7432,LRes66919,LRes44900,LCon21145,LRes8767,LCon63147,LMax78624,LRes99694,LCon54474,LMax10595,LFla55438,LDot858,LCon31626,LAdd24152,LRes19157,LSep46327,LMul59810,LAve48331],["Cro32882","Res83989","Glo7432","Res66919","Res44900","Con21145","Res8767","Con63147","Max78624","Res99694","Con54474","Max10595","Fla55438","Dot858","Con31626","Add24152","Res19157","Sep46327","Mul59810","Ave48331"],Ave48331,"Ave48331")

Actual (Unparsed): [[[0.1984965, 0.5018205, 0.4772025, 0.6903533]]]

Expected (Unparsed): [[[0.19849645652813164,0.5018204552245511,0.4772024506967709,0.6903532511665307]]]

Actual:   [[[0.1985, 0.5019, 0.4773, 0.6904]]]

Expected: [[[0.1985, 0.5019, 0.4773, 0.6904]]]