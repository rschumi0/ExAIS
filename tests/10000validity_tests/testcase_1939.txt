import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof127 = tf.keras.layers.Input(shape=([2, 1]))

Sof127 = keras.layers.Softmax(axis=1, name = 'Sof127', input_shape=(2, 1))(in0Sof127)
Res91590 = keras.layers.Reshape((2, 1, 1), name = 'Res91590', )(Sof127)
Dep24775 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='valid', name = 'Dep24775', )(Res91590)
model = tf.keras.models.Model(inputs=[in0Sof127], outputs=Dep24775)
w = model.get_layer('Dep24775').get_weights() 
w[0] = np.array([[[[0.6416]]], [[[0.9012]]]])
w[1] = np.array([0])
model.get_layer('Dep24775').set_weights(w) 
in0Sof127 = tf.constant([[[0.3755], [0.1569]]])
print (np.array2string(model.predict([in0Sof127],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep24775.png')

LSof127 = softmax_layer([[[0.3755], [0.1569]]], 1, Sof127), 
LRes91590 = reshape_layer(Sof127, [2, 1, 1], Res91590), 
LDep24775 = depthwise_conv2D_layer(Res91590, 2, 1,[[[[0.6416]]], [[[0.9012]]]],[0], 1, 1, false, Dep24775), 
exec_layers([LSof127,LRes91590,LDep24775],["Sof127","Res91590","Dep24775"],Dep24775,"Dep24775")

Actual (Unparsed): [[[[0.7572691]]]]

Expected (Unparsed): [[[[0.7572690868386436]]]]

Actual:   [[[[0.7573]]]]

Expected: [[[[0.7573]]]]