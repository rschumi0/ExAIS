import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub95347 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub95347 = tf.keras.layers.Input(shape=([3, 2]))

Sub95347 = keras.layers.Subtract(name = 'Sub95347', )([in0Sub95347,in1Sub95347])
Res20071 = keras.layers.Reshape((3, 2, 1), name = 'Res20071', )(Sub95347)
Res552 = keras.layers.Reshape((3, 2, 1, 1), name = 'Res552', )(Res20071)
Con11205 = keras.layers.Conv3D(4, (3, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con11205', )(Res552)
model = tf.keras.models.Model(inputs=[in0Sub95347,in1Sub95347], outputs=Con11205)
w = model.get_layer('Con11205').get_weights() 
w[0] = np.array([[[[[0.5293, 0.3035, 0.5796, 0.6585]]]], [[[[0.7833, 0.8317, 0.8961, 0.4656]]]], [[[[0.4839, 0.6728, 0.4107, 0.1713]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con11205').set_weights(w) 
in0Sub95347 = tf.constant([[[0.9263, 0.7291], [0.032, 0.6811], [0.4112, 0.2514]]])
in1Sub95347 = tf.constant([[[0.574, 0.2296], [0.2538, 0.1179], [0.5064, 0.0086]]])
print (np.array2string(model.predict([in0Sub95347,in1Sub95347],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con11205.png')

LSub95347 = subtract_layer([[[0.9263, 0.7291], [0.032, 0.6811], [0.4112, 0.2514]]], [[[0.574, 0.2296], [0.2538, 0.1179], [0.5064, 0.0086]]], Sub95347), 
LRes20071 = reshape_layer(Sub95347, [3, 2, 1], Res20071), 
LRes552 = reshape_layer(Res20071, [3, 2, 1, 1], Res552), 
LCon11205 = conv3D_layer(Res552, 3, 1, 1,[[[[[0.5293, 0.3035, 0.5796, 0.6585]]]], [[[[0.7833, 0.8317, 0.8961, 0.4656]]]], [[[[0.4839, 0.6728, 0.4107, 0.1713]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con11205), 
exec_layers([LSub95347,LRes20071,LRes552,LCon11205],["Sub95347","Res20071","Res552","Con11205"],Con11205,"Con11205")

Actual (Unparsed): [[[[[-0.0333308, -0.1415986, -0.0336606, 0.1124117]], [[0.8230308, 0.7833675, 0.8939117, 0.6327383]]]]]

Expected (Unparsed): [[[[[-0.033330829999999964,-0.14159856999999998,-0.03366053999999998,0.11241171000000001]],[[0.82303083,0.78336753,0.89391168,0.6327383099999999]]]]]

Actual:   [[[[[-0.0333, -0.1415, -0.0336, 0.1125]], [[0.8231, 0.7834, 0.894, 0.6328]]]]]

Expected: [[[[[-0.0333, -0.1415, -0.0336, 0.1125]], [[0.8231, 0.7834, 0.894, 0.6328]]]]]