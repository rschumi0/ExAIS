import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe39084 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con56869 = tf.keras.layers.Input(shape=([2, 6, 1]))
in0Max70412 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max70412 = tf.keras.layers.Input(shape=([2, 2, 2]))

PRe39084 = keras.layers.PReLU(name = 'PRe39084', input_shape=(2, 2, 2, 1))(in0PRe39084)
Res60739 = keras.layers.Reshape((2, 2, 2), name = 'Res60739', )(PRe39084)
Res35808 = keras.layers.Reshape((2, 4), name = 'Res35808', )(Res60739)
Glo3916 = keras.layers.GlobalAveragePooling1D(name = 'Glo3916', )(Res35808)
Res24546 = keras.layers.Reshape((4, 1), name = 'Res24546', )(Glo3916)
Sep71525 = keras.layers.SeparableConv1D(4, (2),strides=(4), padding='valid', name = 'Sep71525', )(Res24546)
Res33547 = keras.layers.Reshape((1, 4, 1), name = 'Res33547', )(Sep71525)
Zer29600 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer29600', )(Res33547)
Con56869 = keras.layers.Concatenate(axis=3, name = 'Con56869', )([Zer29600,in0Con56869])
Max70412 = keras.layers.Maximum(name = 'Max70412', )([in0Max70412,in1Max70412])
Zer5578 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer5578', )(Max70412)
Max62830 = keras.layers.Maximum(name = 'Max62830', )([Con56869,Zer5578])
Res60626 = keras.layers.Reshape((2, 12), name = 'Res60626', )(Max62830)
Glo56934 = keras.layers.GlobalMaxPool1D(name = 'Glo56934', )(Res60626)
Res56166 = keras.layers.Reshape((12, 1), name = 'Res56166', )(Glo56934)
Res66007 = keras.layers.Reshape((12, 1, 1), name = 'Res66007', )(Res56166)
Res93456 = keras.layers.Reshape((12, 1, 1, 1), name = 'Res93456', )(Res66007)
Glo22147 = keras.layers.GlobalMaxPool3D(name = 'Glo22147', )(Res93456)
model = tf.keras.models.Model(inputs=[in0PRe39084,in0Con56869,in0Max70412,in1Max70412], outputs=Glo22147)
w = model.get_layer('PRe39084').get_weights() 
w[0] = np.array([[[[0.8261], [0.6366]], [[0.4003], [0.7238]]], [[[0.1071], [0.0684]], [[0.9715], [0.1566]]]])
model.get_layer('PRe39084').set_weights(w) 
w = model.get_layer('Sep71525').get_weights() 
w[0] = np.array([[[0.7883]], [[0.3128]]])
w[1] = np.array([[[0.3224, 0.4325, 0.7043, 0.6436]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep71525').set_weights(w) 
in0PRe39084 = tf.constant([[[[[0.7166], [0.0681]], [[0.6225], [0.1173]]], [[[0.2232], [0.1833]], [[0.0959], [0.33]]]]])
in0Con56869 = tf.constant([[[[0.376], [0.0465], [0.7071], [0.7298], [0.5599], [0.6886]], [[0.7615], [0.8503], [0.4102], [0.3756], [0.5369], [0.3324]]]])
in0Max70412 = tf.constant([[[[0.1113, 0.763], [0.1534, 0.4468]], [[0.4779, 0.0689], [0.356, 0.4818]]]])
in1Max70412 = tf.constant([[[[0.1556, 0.4623], [0.011, 0.384]], [[0.6149, 0.3233], [0.3465, 0.9646]]]])
print (np.array2string(model.predict([in0PRe39084,in0Con56869,in0Max70412,in1Max70412],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo22147.png')

LPRe39084 = prelu_layer([[[[[0.7166], [0.0681]], [[0.6225], [0.1173]]], [[[0.2232], [0.1833]], [[0.0959], [0.33]]]]], [[[[0.8261], [0.6366]], [[0.4003], [0.7238]]], [[[0.1071], [0.0684]], [[0.9715], [0.1566]]]], PRe39084), 
LRes60739 = reshape_layer(PRe39084, [2, 2, 2], Res60739), 
LRes35808 = reshape_layer(Res60739, [2, 4], Res35808), 
LGlo3916 = global_average_pooling1D_layer(Res35808, Glo3916), 
LRes24546 = reshape_layer(Glo3916, [4, 1], Res24546), 
LSep71525 = separable_conv1D_layer(Res24546, 2,[[[[0.7883]], [[0.3128]]],[[[0.3224, 0.4325, 0.7043, 0.6436]]]],[0, 0, 0, 0], 4, false, Sep71525), 
LRes33547 = reshape_layer(Sep71525, [1, 4, 1], Res33547), 
LZer29600 = zero_padding2D_layer(Res33547, 1, 0, 2, 0, Zer29600), 
LCon56869 = concatenate_layer([Zer29600,[[[[0.376], [0.0465], [0.7071], [0.7298], [0.5599], [0.6886]], [[0.7615], [0.8503], [0.4102], [0.3756], [0.5369], [0.3324]]]]], 3, Con56869), 
LMax70412 = maximum_layer([[[[[0.1113, 0.763], [0.1534, 0.4468]], [[0.4779, 0.0689], [0.356, 0.4818]]]], [[[[0.1556, 0.4623], [0.011, 0.384]], [[0.6149, 0.3233], [0.3465, 0.9646]]]]], Max70412), 
LZer5578 = zero_padding2D_layer(Max70412, 0, 0, 4, 0, Zer5578), 
LMax62830 = maximum_layer([Con56869,Zer5578], Max62830), 
LRes60626 = reshape_layer(Max62830, [2, 12], Res60626), 
LGlo56934 = global_max_pool1D_layer(Res60626, Glo56934), 
LRes56166 = reshape_layer(Glo56934, [12, 1], Res56166), 
LRes66007 = reshape_layer(Res56166, [12, 1, 1], Res66007), 
LRes93456 = reshape_layer(Res66007, [12, 1, 1, 1], Res93456), 
LGlo22147 = global_max_pool3D_layer(Res93456, Glo22147), 
exec_layers([LPRe39084,LRes60739,LRes35808,LGlo3916,LRes24546,LSep71525,LRes33547,LZer29600,LCon56869,LMax70412,LZer5578,LMax62830,LRes60626,LGlo56934,LRes56166,LRes66007,LRes93456,LGlo22147],["PRe39084","Res60739","Res35808","Glo3916","Res24546","Sep71525","Res33547","Zer29600","Con56869","Max70412","Zer5578","Max62830","Res60626","Glo56934","Res56166","Res66007","Res93456","Glo22147"],Glo22147,"Glo22147")

Actual (Unparsed): [[0.9646000]]

Expected (Unparsed): [[0.9646]]

Actual:   [[0.9646]]

Expected: [[0.9646]]