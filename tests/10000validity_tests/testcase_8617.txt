import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min14020 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min14020 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con91164 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul48671 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul48671 = tf.keras.layers.Input(shape=([2, 2]))

Min14020 = keras.layers.Minimum(name = 'Min14020', )([in0Min14020,in1Min14020])
Res26943 = keras.layers.Reshape((1, 1), name = 'Res26943', )(Min14020)
Zer45082 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer45082', )(Res26943)
Con91164 = keras.layers.Concatenate(axis=2, name = 'Con91164', )([Zer45082,in0Con91164])
Mul48671 = keras.layers.Multiply(name = 'Mul48671', )([in0Mul48671,in1Mul48671])
Max58554 = keras.layers.Maximum(name = 'Max58554', )([Con91164,Mul48671])
model = tf.keras.models.Model(inputs=[in0Min14020,in1Min14020,in0Con91164,in0Mul48671,in1Mul48671], outputs=Max58554)
in0Min14020 = tf.constant([[[[0.4207]]]])
in1Min14020 = tf.constant([[[[0.2792]]]])
in0Con91164 = tf.constant([[[0.1173], [0.5573]]])
in0Mul48671 = tf.constant([[[0.4028, 0.5439], [0.3347, 0.1001]]])
in1Mul48671 = tf.constant([[[0.5299, 0.8796], [0.5644, 0.4575]]])
print (np.array2string(model.predict([in0Min14020,in1Min14020,in0Con91164,in0Mul48671,in1Mul48671],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max58554.png')

LMin14020 = minimum_layer([[[[[0.4207]]]], [[[[0.2792]]]]], Min14020), 
LRes26943 = reshape_layer(Min14020, [1, 1], Res26943), 
LZer45082 = zero_padding1D_layer(Res26943, 1, 0, Zer45082), 
LCon91164 = concatenate_layer([Zer45082,[[[0.1173], [0.5573]]]], 2, Con91164), 
LMul48671 = multiply_layer([[[[0.4028, 0.5439], [0.3347, 0.1001]]], [[[0.5299, 0.8796], [0.5644, 0.4575]]]], Mul48671), 
LMax58554 = maximum_layer([Con91164,Mul48671], Max58554), 
exec_layers([LMin14020,LRes26943,LZer45082,LCon91164,LMul48671,LMax58554],["Min14020","Res26943","Zer45082","Con91164","Mul48671","Max58554"],Max58554,"Max58554")

Actual (Unparsed): [[[0.2134437, 0.4784144], [0.2792000, 0.5573000]]]

Expected (Unparsed): [[[0.21344372,0.47841444000000005],[0.2792,0.5573]]]

Actual:   [[[0.2135, 0.4785], [0.2792, 0.5573]]]

Expected: [[[0.2135, 0.4785], [0.2792, 0.5573]]]