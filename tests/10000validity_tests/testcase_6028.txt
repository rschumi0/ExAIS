import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max44482 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Max44482 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Sim19265 = tf.keras.layers.Input(shape=([3, 2]))
in0Con23671 = tf.keras.layers.Input(shape=([1]))

Max44482 = keras.layers.Maximum(name = 'Max44482', )([in0Max44482,in1Max44482])
Res76998 = keras.layers.Reshape((1, 2, 2), name = 'Res76998', )(Max44482)
Dep18029 = keras.layers.DepthwiseConv2D((1, 2),strides=(1, 1), padding='valid', name = 'Dep18029', )(Res76998)
Res6920 = keras.layers.Reshape((1, 2), name = 'Res6920', )(Dep18029)
Fla95572 = keras.layers.Flatten(name = 'Fla95572', )(Res6920)
Sim19265 = keras.layers.SimpleRNN(1,name = 'Sim19265', )(in0Sim19265)
Con23671 = keras.layers.Concatenate(axis=1, name = 'Con23671', )([Sim19265,in0Con23671])
Sub71132 = keras.layers.Subtract(name = 'Sub71132', )([Fla95572,Con23671])
model = tf.keras.models.Model(inputs=[in0Max44482,in1Max44482,in0Sim19265,in0Con23671], outputs=Sub71132)
w = model.get_layer('Dep18029').get_weights() 
w[0] = np.array([[[[0.6438], [0.7065]], [[0.1946], [0.4174]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep18029').set_weights(w) 
w = model.get_layer('Sim19265').get_weights() 
w[0] = np.array([[4], [8]])
w[1] = np.array([[5]])
w[2] = np.array([7])
model.get_layer('Sim19265').set_weights(w) 
in0Max44482 = tf.constant([[[[[0.0794, 0.8175]], [[0.2013, 0.2059]]]]])
in1Max44482 = tf.constant([[[[[0.8327, 0.5547]], [[0.3249, 0.5457]]]]])
in0Sim19265 = tf.constant([[[4, 6], [3, 10], [6, 4]]])
in0Con23671 = tf.constant([[0.1091]])
print (np.array2string(model.predict([in0Max44482,in1Max44482,in0Sim19265,in0Con23671],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub71132.png')

LMax44482 = maximum_layer([[[[[[0.0794, 0.8175]], [[0.2013, 0.2059]]]]], [[[[[0.8327, 0.5547]], [[0.3249, 0.5457]]]]]], Max44482), 
LRes76998 = reshape_layer(Max44482, [1, 2, 2], Res76998), 
LDep18029 = depthwise_conv2D_layer(Res76998, 1, 2,[[[[0.6438], [0.7065]], [[0.1946], [0.4174]]]],[0, 0], 1, 1, false, Dep18029), 
LRes6920 = reshape_layer(Dep18029, [1, 2], Res6920), 
LFla95572 = flatten_layer(Res6920, Fla95572), 
LSim19265 = simple_rnn_layer([[[4, 6], [3, 10], [6, 4]]],[[4], [8]],[[5]],[7], Sim19265), 
LCon23671 = concatenate_layer([Sim19265,[[0.1091]]], 1, Con23671), 
LSub71132 = subtract_layer(Fla95572,Con23671, Sub71132), 
exec_layers([LMax44482,LRes76998,LDep18029,LRes6920,LFla95572,LSim19265,LCon23671,LSub71132],["Max44482","Res76998","Dep18029","Res6920","Fla95572","Sim19265","Con23671","Sub71132"],Sub71132,"Sub71132")

Actual (Unparsed): [[-0.4006822, 0.6962389]]

Expected (Unparsed): [[-0.4006822,0.69623893]]

Actual:   [[-0.4006, 0.6963]]

Expected: [[-0.4006, 0.6963]]