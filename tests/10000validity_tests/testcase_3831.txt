import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep7013 = tf.keras.layers.Input(shape=([2, 2, 2]))

Sep7013 = keras.layers.SeparableConv2D(2, (1, 1),strides=(2, 2), padding='valid', name = 'Sep7013', )(in0Sep7013)
PRe82400 = keras.layers.PReLU(name = 'PRe82400', )(Sep7013)
Con88889 = keras.layers.Conv2DTranspose(2, (1, 1),strides=(2, 1), padding='valid', name = 'Con88889', )(PRe82400)
model = tf.keras.models.Model(inputs=[in0Sep7013], outputs=Con88889)
w = model.get_layer('Sep7013').get_weights() 
w[0] = np.array([[[[0.011], [0.9121]]]])
w[1] = np.array([[[[0.806, 0.376], [0.5184, 0.4907]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep7013').set_weights(w) 
w = model.get_layer('PRe82400').get_weights() 
w[0] = np.array([[[0.7584, 0.7408]]])
model.get_layer('PRe82400').set_weights(w) 
w = model.get_layer('Con88889').get_weights() 
w[0] = np.array([[[[0.4691, 0.1264], [0.3759, 0.3602]]]])
w[1] = np.array([0, 0])
model.get_layer('Con88889').set_weights(w) 
in0Sep7013 = tf.constant([[[[0.4348, 0.6034], [0.8089, 0.3148]], [[0.6871, 0.5258], [0.43, 0.3553]]]])
print (np.array2string(model.predict([in0Sep7013],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con88889.png')

LSep7013 = separable_conv2D_layer([[[[0.4348, 0.6034], [0.8089, 0.3148]], [[0.6871, 0.5258], [0.43, 0.3553]]]], 1, 1,[[[[[0.011], [0.9121]]]],[[[[0.806, 0.376], [0.5184, 0.4907]]]]],[0, 0], 2, 2, false, Sep7013), 
LPRe82400 = prelu_layer(Sep7013, [[[0.7584, 0.7408]]], PRe82400), 
LCon88889 = conv2D_transpose_layer(PRe82400, 1, 1,[[[[0.4691, 0.1264], [0.3759, 0.3602]]]],[0, 0], 2, 1, false, Con88889), 
exec_layers([LSep7013,LPRe82400,LCon88889],["Sep7013","PRe82400","Con88889"],Con88889,"Con88889")

Actual (Unparsed): [[[[0.1700091, 0.2066202]], [[0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0.1700091381847488,0.20662022087271803]],[[0,0]]]]

Actual:   [[[[0.1701, 0.2067]], [[0, 0]]]]

Expected: [[[[0.1701, 0.2067]], [[0, 0]]]]