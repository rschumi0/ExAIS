import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo36784 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Glo36784 = keras.layers.GlobalAveragePooling3D(name = 'Glo36784', )(in0Glo36784)
Res90781 = keras.layers.Reshape((1, 1), name = 'Res90781', )(Glo36784)
Glo94250 = keras.layers.GlobalMaxPool1D(name = 'Glo94250', )(Res90781)
Res95972 = keras.layers.Reshape((1, 1), name = 'Res95972', )(Glo94250)
GRU2453 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU2453', )(Res95972)
Res40742 = keras.layers.Reshape((1, 1), name = 'Res40742', )(GRU2453)
Per86601 = keras.layers.Permute((1,2), name = 'Per86601',)(Res40742)
model = tf.keras.models.Model(inputs=[in0Glo36784], outputs=Per86601)
w = model.get_layer('GRU2453').get_weights() 
w[0] = np.array([[3, 5, 6]])
w[1] = np.array([[4, 8, 5]])
w[2] = np.array([[9, 2, 4], [10, 5, 6]])
model.get_layer('GRU2453').set_weights(w) 
in0Glo36784 = tf.constant([[[[[1.703]]]]])
print (np.array2string(model.predict([in0Glo36784],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per86601.png')

LGlo36784 = global_average_pooling3D_layer([[[[[1.703]]]]], Glo36784), 
LRes90781 = reshape_layer(Glo36784, [1, 1], Res90781), 
LGlo94250 = global_max_pool1D_layer(Res90781, Glo94250), 
LRes95972 = reshape_layer(Glo94250, [1, 1], Res95972), 
LGRU2453 = gru_layer(Res95972,[[3, 5, 6]],[[4, 8, 5]],[[9, 2, 4], [10, 5, 6]], true, GRU2453), 
LRes40742 = reshape_layer(GRU2453, [1, 1], Res40742), 
LPer86601 = permute_layer(Res40742, 1,2, Per86601), 
exec_layers([LGlo36784,LRes90781,LGlo94250,LRes95972,LGRU2453,LRes40742,LPer86601],["Glo36784","Res90781","Glo94250","Res95972","GRU2453","Res40742","Per86601"],Per86601,"Per86601")

Actual (Unparsed): [[[0.0000000]]]

Expected (Unparsed): [[[3.385269842226535e-11]]]

Actual:   [[[0]]]

Expected: [[[0]]]