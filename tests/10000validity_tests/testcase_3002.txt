import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave413 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave413 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con21635 = tf.keras.layers.Input(shape=([2, 1]))
in0Add55954 = tf.keras.layers.Input(shape=([2, 2]))
in1Add55954 = tf.keras.layers.Input(shape=([2, 2]))

Ave413 = keras.layers.Average(name = 'Ave413', )([in0Ave413,in1Ave413])
Sof53990 = keras.layers.Softmax(axis=1, name = 'Sof53990', )(Ave413)
Res78364 = keras.layers.Reshape((1, 2), name = 'Res78364', )(Sof53990)
Per82206 = keras.layers.Permute((2,1), name = 'Per82206',)(Res78364)
Con21635 = keras.layers.Concatenate(axis=2, name = 'Con21635', )([Per82206,in0Con21635])
Add55954 = keras.layers.Add(name = 'Add55954', )([in0Add55954,in1Add55954])
Ave34170 = keras.layers.Average(name = 'Ave34170', )([Con21635,Add55954])
model = tf.keras.models.Model(inputs=[in0Ave413,in1Ave413,in0Con21635,in0Add55954,in1Add55954], outputs=Ave34170)
in0Ave413 = tf.constant([[[[0.9596], [0.4851]]]])
in1Ave413 = tf.constant([[[[0.1607], [0.4734]]]])
in0Con21635 = tf.constant([[[0.2142], [0.6377]]])
in0Add55954 = tf.constant([[[0.4705, 0.5054], [0.143, 0.8822]]])
in1Add55954 = tf.constant([[[0.9131, 0.7399], [0.0604, 0.8617]]])
print (np.array2string(model.predict([in0Ave413,in1Ave413,in0Con21635,in0Add55954,in1Add55954],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave34170.png')

LAve413 = average_layer([[[[[0.9596], [0.4851]]]], [[[[0.1607], [0.4734]]]]], Ave413), 
LSof53990 = softmax_layer(Ave413, 1, Sof53990), 
LRes78364 = reshape_layer(Sof53990, [1, 2], Res78364), 
LPer82206 = permute_layer(Res78364, 2,1, Per82206), 
LCon21635 = concatenate_layer([Per82206,[[[0.2142], [0.6377]]]], 2, Con21635), 
LAdd55954 = add_layer([[[[0.4705, 0.5054], [0.143, 0.8822]]], [[[0.9131, 0.7399], [0.0604, 0.8617]]]], Add55954), 
LAve34170 = average_layer([Con21635,Add55954], Ave34170), 
exec_layers([LAve413,LSof53990,LRes78364,LPer82206,LCon21635,LAdd55954,LAve34170],["Ave413","Sof53990","Res78364","Per82206","Con21635","Add55954","Ave34170"],Ave34170,"Ave34170")

Actual (Unparsed): [[[1.1918000, 0.7297500], [0.6017000, 1.1908000]]]

Expected (Unparsed): [[[1.1918,0.7297499999999999],[0.6017,1.1908]]]

Actual:   [[[1.1918, 0.7298], [0.6017, 1.1908]]]

Expected: [[[1.1918, 0.7298], [0.6017, 1.1908]]]