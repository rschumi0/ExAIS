import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add84733 = tf.keras.layers.Input(shape=([2, 1]))
in1Add84733 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave89439 = tf.keras.layers.Input(shape=([1, 1]))

Add84733 = keras.layers.Add(name = 'Add84733', )([in0Add84733,in1Add84733])
LST62374 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST62374', )(Add84733)
Res8639 = keras.layers.Reshape((3, 1), name = 'Res8639', )(LST62374)
Ave89439 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave89439', )(in0Ave89439)
ReL61574 = keras.layers.ReLU(max_value=5.893669847726084, negative_slope=7.290203994935281, threshold=7.17449395182047, name = 'ReL61574', )(Ave89439)
Zer70906 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer70906', )(ReL61574)
Max54597 = keras.layers.Maximum(name = 'Max54597', )([Res8639,Zer70906])
model = tf.keras.models.Model(inputs=[in0Add84733,in1Add84733,in0Ave89439], outputs=Max54597)
w = model.get_layer('LST62374').get_weights() 
w[0] = np.array([[3, 7, 4, 1, 8, 4, 10, 9, 4, 5, 7, 8]])
w[1] = np.array([[8, 8, 10, 3, 2, 7, 2, 2, 5, 10, 6, 5], [1, 4, 1, 5, 2, 5, 2, 8, 5, 9, 1, 3], [10, 9, 8, 8, 1, 3, 5, 9, 6, 5, 4, 10]])
w[2] = np.array([1, 1, 10, 5, 1, 4, 4, 3, 8, 2, 5, 10])
model.get_layer('LST62374').set_weights(w) 
in0Add84733 = tf.constant([[[0.6289], [0.0259]]])
in1Add84733 = tf.constant([[[0.941], [0.6587]]])
in0Ave89439 = tf.constant([[[1.839]]])
print (np.array2string(model.predict([in0Add84733,in1Add84733,in0Ave89439],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max54597.png')

LAdd84733 = add_layer([[[[0.6289], [0.0259]]], [[[0.941], [0.6587]]]], Add84733), 
LLST62374 = lstm_layer(Add84733,[[3, 7, 4, 1, 8, 4, 10, 9, 4, 5, 7, 8]],[[8, 8, 10, 3, 2, 7, 2, 2, 5, 10, 6, 5], [1, 4, 1, 5, 2, 5, 2, 8, 5, 9, 1, 3], [10, 9, 8, 8, 1, 3, 5, 9, 6, 5, 4, 10]],[1, 1, 10, 5, 1, 4, 4, 3, 8, 2, 5, 10], LST62374), 
LRes8639 = reshape_layer(LST62374, [3, 1], Res8639), 
LAve89439 = average_pooling1D_layer([[[1.839]]], 1, Ave89439), 
LReL61574 = relu_layer(Ave89439, 5.893669847726084, 7.290203994935281, 7.17449395182047, ReL61574), 
LZer70906 = zero_padding1D_layer(ReL61574, 2, 0, Zer70906), 
LMax54597 = maximum_layer([Res8639,Zer70906], Max54597), 
exec_layers([LAdd84733,LLST62374,LRes8639,LAve89439,LReL61574,LZer70906,LMax54597],["Add84733","LST62374","Res8639","Ave89439","ReL61574","Zer70906","Max54597"],Max54597,"Max54597")

Actual (Unparsed): [[[0.9637935], [0.9640247], [0.9640276]]]

Expected (Unparsed): [[[0.9637934925145432],[0.9640247091828492],[0.9640275731400125]]]

Actual:   [[[0.9638], [0.9641], [0.9641]]]

Expected: [[[0.9638], [0.9641], [0.9641]]]