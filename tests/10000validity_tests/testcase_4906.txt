import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave62021 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave62021 = tf.keras.layers.Input(shape=([2, 2]))
in0Con79765 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Add76057 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Add76057 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Ave62021 = keras.layers.Average(name = 'Ave62021', )([in0Ave62021,in1Ave62021])
Res29078 = keras.layers.Reshape((2, 2, 1), name = 'Res29078', )(Ave62021)
Res59289 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res59289', )(Res29078)
Con79765 = keras.layers.Concatenate(axis=4, name = 'Con79765', )([Res59289,in0Con79765])
Add76057 = keras.layers.Add(name = 'Add76057', )([in0Add76057,in1Add76057])
Zer35525 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer35525', )(Add76057)
Max60062 = keras.layers.Maximum(name = 'Max60062', )([Con79765,Zer35525])
model = tf.keras.models.Model(inputs=[in0Ave62021,in1Ave62021,in0Con79765,in0Add76057,in1Add76057], outputs=Max60062)
in0Ave62021 = tf.constant([[[0.8296, 0.6122], [0.7915, 0.3891]]])
in1Ave62021 = tf.constant([[[0.5889, 0.4308], [0.8076, 0.5747]]])
in0Con79765 = tf.constant([[[[[0.2412]], [[0.6038]]], [[[0.6033]], [[0.4569]]]]])
in0Add76057 = tf.constant([[[[[0.092, 0.4362]], [[0.3904, 0.8401]]]]])
in1Add76057 = tf.constant([[[[[0.0231, 0.3475]], [[0.5631, 0.9427]]]]])
print (np.array2string(model.predict([in0Ave62021,in1Ave62021,in0Con79765,in0Add76057,in1Add76057],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max60062.png')

LAve62021 = average_layer([[[[0.8296, 0.6122], [0.7915, 0.3891]]], [[[0.5889, 0.4308], [0.8076, 0.5747]]]], Ave62021), 
LRes29078 = reshape_layer(Ave62021, [2, 2, 1], Res29078), 
LRes59289 = reshape_layer(Res29078, [2, 2, 1, 1], Res59289), 
LCon79765 = concatenate_layer([Res59289,[[[[[0.2412]], [[0.6038]]], [[[0.6033]], [[0.4569]]]]]], 4, Con79765), 
LAdd76057 = add_layer([[[[[[0.092, 0.4362]], [[0.3904, 0.8401]]]]], [[[[[0.0231, 0.3475]], [[0.5631, 0.9427]]]]]], Add76057), 
LZer35525 = zero_padding3D_layer(Add76057, 1, 0, 0, 0, 0, 0, Zer35525), 
LMax60062 = maximum_layer([Con79765,Zer35525], Max60062), 
exec_layers([LAve62021,LRes29078,LRes59289,LCon79765,LAdd76057,LZer35525,LMax60062],["Ave62021","Res29078","Res59289","Con79765","Add76057","Zer35525","Max60062"],Max60062,"Max60062")

Actual (Unparsed): [[[[[0.7092500, 0.2412000]], [[0.5215000, 0.6038000]]], [[[0.7995500, 0.7837000]], [[0.9535000, 1.7828000]]]]]

Expected (Unparsed): [[[[[0.7092499999999999,0.2412]],[[0.5215,0.6038]]],[[[0.79955,0.7837]],[[0.9535,1.7828]]]]]

Actual:   [[[[[0.7093, 0.2412]], [[0.5215, 0.6038]]], [[[0.7996, 0.7837]], [[0.9535, 1.7828]]]]]

Expected: [[[[[0.7093, 0.2412]], [[0.5215, 0.6038]]], [[[0.7996, 0.7837]], [[0.9535, 1.7828]]]]]