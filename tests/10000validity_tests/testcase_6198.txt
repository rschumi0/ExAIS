import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea98862 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con60053 = tf.keras.layers.Input(shape=([2, 2, 3]))
in0Dot99646 = tf.keras.layers.Input(shape=([2]))
in1Dot99646 = tf.keras.layers.Input(shape=([2]))
in0Den88769 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con31527 = tf.keras.layers.Input(shape=([2, 2, 1]))

Lea98862 = keras.layers.LeakyReLU(alpha=0.10360180860873669, name = 'Lea98862', input_shape=(2, 2, 2))(in0Lea98862)
Res42667 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res42667', )(Lea98862)
Cro69286 = keras.layers.Cropping3D(cropping=((0, 0), (0, 1), (0, 0)), name = 'Cro69286', )(Res42667)
Res79275 = keras.layers.Reshape((2, 1, 2), name = 'Res79275', )(Cro69286)
Res72506 = keras.layers.Reshape((2, 2), name = 'Res72506', )(Res79275)
Max96717 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max96717', )(Res72506)
Res80805 = keras.layers.Reshape((1, 2, 1), name = 'Res80805', )(Max96717)
Zer51184 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer51184', )(Res80805)
Con60053 = keras.layers.Concatenate(axis=3, name = 'Con60053', )([Zer51184,in0Con60053])
Dot99646 = keras.layers.Dot(axes=(1, 1), name = 'Dot99646', )([in0Dot99646,in1Dot99646])
Res54744 = keras.layers.Reshape((1, 1), name = 'Res54744', )(Dot99646)
Res46607 = keras.layers.Reshape((1, 1, 1), name = 'Res46607', )(Res54744)
Sep5690 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='same', name = 'Sep5690', )(Res46607)
Zer84158 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer84158', )(Sep5690)
Den88769 = keras.layers.Dense(3,name = 'Den88769', )(in0Den88769)
Con31527 = keras.layers.Concatenate(axis=3, name = 'Con31527', )([Den88769,in0Con31527])
Mul89035 = keras.layers.Multiply(name = 'Mul89035', )([Zer84158,Con31527])
Sub90448 = keras.layers.Subtract(name = 'Sub90448', )([Con60053,Mul89035])
model = tf.keras.models.Model(inputs=[in0Lea98862,in0Con60053,in0Dot99646,in1Dot99646,in0Den88769,in0Con31527], outputs=Sub90448)
w = model.get_layer('Sep5690').get_weights() 
w[0] = np.array([[[[0.8277]]]])
w[1] = np.array([[[[0.0369, 0.2207, 0.2294, 0.9693]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep5690').set_weights(w) 
w = model.get_layer('Den88769').get_weights() 
w[0] = np.array([[0.7828, 0.4238, 0.2962], [0.1404, 0.1621, 0.5947]])
w[1] = np.array([0.1912, 0.1833, 0.8421])
model.get_layer('Den88769').set_weights(w) 
in0Lea98862 = tf.constant([[[[0.2746, 0.2741], [0.697, 0.8707]], [[0.3145, 0.8509], [0.0887, 0.4776]]]])
in0Con60053 = tf.constant([[[[0.845, 0.7373, 0.4762], [0.0502, 0.0785, 1]], [[0.7134, 0.5696, 0.5828], [0.2581, 0.8569, 0.7149]]]])
in0Dot99646 = tf.constant([[0.2198, 0.0831]])
in1Dot99646 = tf.constant([[0.5229, 0.6986]])
in0Den88769 = tf.constant([[[[0.3984, 0.9567], [0.8218, 0.1218]], [[0.0662, 0.1751], [0.7965, 0.1203]]]])
in0Con31527 = tf.constant([[[[0.0571], [0.2002]], [[0.9208], [0.2245]]]])
print (np.array2string(model.predict([in0Lea98862,in0Con60053,in0Dot99646,in1Dot99646,in0Den88769,in0Con31527],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub90448.png')

LLea98862 = leaky_relu_layer([[[[0.2746, 0.2741], [0.697, 0.8707]], [[0.3145, 0.8509], [0.0887, 0.4776]]]], 0.10360180860873669, Lea98862), 
LRes42667 = reshape_layer(Lea98862, [2, 2, 2, 1], Res42667), 
LCro69286 = cropping3D_layer(Res42667, 0, 0, 0, 1, 0, 0, Cro69286), 
LRes79275 = reshape_layer(Cro69286, [2, 1, 2], Res79275), 
LRes72506 = reshape_layer(Res79275, [2, 2], Res72506), 
LMax96717 = max_pool1D_layer(Res72506, 2, Max96717), 
LRes80805 = reshape_layer(Max96717, [1, 2, 1], Res80805), 
LZer51184 = zero_padding2D_layer(Res80805, 1, 0, 0, 0, Zer51184), 
LCon60053 = concatenate_layer([Zer51184,[[[[0.845, 0.7373, 0.4762], [0.0502, 0.0785, 1]], [[0.7134, 0.5696, 0.5828], [0.2581, 0.8569, 0.7149]]]]], 3, Con60053), 
LDot99646 = dot_layer([[0.2198, 0.0831]], [[0.5229, 0.6986]], 1, 1, Dot99646), 
LRes54744 = reshape_layer(Dot99646, [1, 1], Res54744), 
LRes46607 = reshape_layer(Res54744, [1, 1, 1], Res46607), 
LSep5690 = separable_conv2D_layer(Res46607, 1, 1,[[[[[0.8277]]]],[[[[0.0369, 0.2207, 0.2294, 0.9693]]]]],[0, 0, 0, 0], 1, 1, true, Sep5690), 
LZer84158 = zero_padding2D_layer(Sep5690, 1, 0, 1, 0, Zer84158), 
LDen88769 = dense_layer([[[[0.3984, 0.9567], [0.8218, 0.1218]], [[0.0662, 0.1751], [0.7965, 0.1203]]]], [[0.7828, 0.4238, 0.2962], [0.1404, 0.1621, 0.5947]],[0.1912, 0.1833, 0.8421], Den88769), 
LCon31527 = concatenate_layer([Den88769,[[[[0.0571], [0.2002]], [[0.9208], [0.2245]]]]], 3, Con31527), 
LMul89035 = multiply_layer([Zer84158,Con31527], Mul89035), 
LSub90448 = subtract_layer(Con60053,Mul89035, Sub90448), 
exec_layers([LLea98862,LRes42667,LCro69286,LRes79275,LRes72506,LMax96717,LRes80805,LZer51184,LCon60053,LDot99646,LRes54744,LRes46607,LSep5690,LZer84158,LDen88769,LCon31527,LMul89035,LSub90448],["Lea98862","Res42667","Cro69286","Res79275","Res72506","Max96717","Res80805","Zer51184","Con60053","Dot99646","Res54744","Res46607","Sep5690","Zer84158","Den88769","Con31527","Mul89035","Sub90448"],Sub90448,"Sub90448")

Actual (Unparsed): [[[[0.0000000, 0.8450000, 0.7373000, 0.4762000], [0.0000000, 0.0502000, 0.0785000, 1.0000000]], [[0.3145000, 0.7134000, 0.5696000, 0.5828000], [0.8465064, 0.2410246, 0.8191416, 0.6837426]]]]

Expected (Unparsed): [[[[0.0,0.845,0.7373,0.4762],[0.0,0.0502,0.0785,1.0]],[[0.3145,0.7134,0.5696,0.5828],[0.846506380787921,0.24102463470519261,0.8191415778613447,0.6837426020551204]]]]

Actual:   [[[[0, 0.845, 0.7373, 0.4762], [0, 0.0502, 0.0785, 1]], [[0.3145, 0.7134, 0.5696, 0.5828], [0.8466, 0.2411, 0.8192, 0.6838]]]]

Expected: [[[[0, 0.845, 0.7373, 0.4762], [0, 0.0502, 0.0785, 1]], [[0.3145, 0.7134, 0.5696, 0.5828], [0.8466, 0.2411, 0.8192, 0.6838]]]]