import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min62674 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min62674 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Sof6988 = tf.keras.layers.Input(shape=([2, 2]))

Min62674 = keras.layers.Minimum(name = 'Min62674', )([in0Min62674,in1Min62674])
Zer82074 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer82074', )(Min62674)
Res44720 = keras.layers.Reshape((4, 3), name = 'Res44720', )(Zer82074)
Glo50910 = keras.layers.GlobalAveragePooling1D(name = 'Glo50910', )(Res44720)
Res80402 = keras.layers.Reshape((3, 1), name = 'Res80402', )(Glo50910)
Zer33965 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer33965', )(Res80402)
Sof6988 = keras.layers.Softmax(axis=1, name = 'Sof6988', input_shape=(2, 2))(in0Sof6988)
Res78411 = keras.layers.Reshape((2, 2, 1), name = 'Res78411', )(Sof6988)
Glo50173 = keras.layers.GlobalAveragePooling2D(name = 'Glo50173', )(Res78411)
Res98416 = keras.layers.Reshape((1, 1), name = 'Res98416', )(Glo50173)
Res73000 = keras.layers.Reshape((1, 1, 1), name = 'Res73000', )(Res98416)
Cro6240 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro6240', )(Res73000)
Res24409 = keras.layers.Reshape((1, 1), name = 'Res24409', )(Cro6240)
Dot95256 = keras.layers.Dot(axes=(2, 1), name = 'Dot95256', )([Zer33965,Res24409])
model = tf.keras.models.Model(inputs=[in0Min62674,in1Min62674,in0Sof6988], outputs=Dot95256)
in0Min62674 = tf.constant([[[[0.625]], [[0.1255]]]])
in1Min62674 = tf.constant([[[[0.004]], [[0.4125]]]])
in0Sof6988 = tf.constant([[[0.5554, 0.7821], [0.9374, 0.1801]]])
print (np.array2string(model.predict([in0Min62674,in1Min62674,in0Sof6988],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot95256.png')

LMin62674 = minimum_layer([[[[[0.625]], [[0.1255]]]], [[[[0.004]], [[0.4125]]]]], Min62674), 
LZer82074 = zero_padding2D_layer(Min62674, 1, 1, 1, 1, Zer82074), 
LRes44720 = reshape_layer(Zer82074, [4, 3], Res44720), 
LGlo50910 = global_average_pooling1D_layer(Res44720, Glo50910), 
LRes80402 = reshape_layer(Glo50910, [3, 1], Res80402), 
LZer33965 = zero_padding1D_layer(Res80402, 2, 0, Zer33965), 
LSof6988 = softmax_layer([[[0.5554, 0.7821], [0.9374, 0.1801]]], 1, Sof6988), 
LRes78411 = reshape_layer(Sof6988, [2, 2, 1], Res78411), 
LGlo50173 = global_average_pooling2D_layer(Res78411, Glo50173), 
LRes98416 = reshape_layer(Glo50173, [1, 1], Res98416), 
LRes73000 = reshape_layer(Res98416, [1, 1, 1], Res73000), 
LCro6240 = cropping2D_layer(Res73000, 0, 0, 0, 0, Cro6240), 
LRes24409 = reshape_layer(Cro6240, [1, 1], Res24409), 
LDot95256 = dot_layer(Zer33965,Res24409, 2, 1, Dot95256), 
exec_layers([LMin62674,LZer82074,LRes44720,LGlo50910,LRes80402,LZer33965,LSof6988,LRes78411,LGlo50173,LRes98416,LRes73000,LCro6240,LRes24409,LDot95256],["Min62674","Zer82074","Res44720","Glo50910","Res80402","Zer33965","Sof6988","Res78411","Glo50173","Res98416","Res73000","Cro6240","Res24409","Dot95256"],Dot95256,"Dot95256")

Actual (Unparsed): [[[0.0000000], [0.0000000], [0.0000000], [0.0161875], [0.0000000]]]

Expected (Unparsed): [[[0.0],[0.0],[0.0],[0.0161875],[0.0]]]

Actual:   [[[0], [0], [0], [0.0162], [0]]]

Expected: [[[0], [0], [0], [0.0162], [0]]]