import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub52358 = tf.keras.layers.Input(shape=([3, 2, 3]))
in1Sub52358 = tf.keras.layers.Input(shape=([3, 2, 3]))
in0Add92137 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Add92137 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Sub52358 = keras.layers.Subtract(name = 'Sub52358', )([in0Sub52358,in1Sub52358])
Res9835 = keras.layers.Reshape((3, 6), name = 'Res9835', )(Sub52358)
Max56726 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max56726', )(Res9835)
Res57967 = keras.layers.Reshape((1, 6, 1), name = 'Res57967', )(Max56726)
Res55019 = keras.layers.Reshape((1, 6, 1, 1), name = 'Res55019', )(Res57967)
Zer71021 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer71021', )(Res55019)
Add92137 = keras.layers.Add(name = 'Add92137', )([in0Add92137,in1Add92137])
Zer19485 = keras.layers.ZeroPadding3D(padding=((0, 0), (4, 0), (1, 0)), name = 'Zer19485', )(Add92137)
Add83952 = keras.layers.Add(name = 'Add83952', )([Zer71021,Zer19485])
Fla8634 = keras.layers.Flatten(name = 'Fla8634', )(Add83952)
Res82408 = keras.layers.Reshape((18, 1), name = 'Res82408', )(Fla8634)
Con76299 = keras.layers.Conv1D(3, (7),strides=(1), padding='valid', dilation_rate=(1), name = 'Con76299', )(Res82408)
model = tf.keras.models.Model(inputs=[in0Sub52358,in1Sub52358,in0Add92137,in1Add92137], outputs=Con76299)
w = model.get_layer('Con76299').get_weights() 
w[0] = np.array([[[0.805, 0.485, 0.375]], [[0.4028, 0.4832, 0.5028]], [[0.4993, 0.9903, 0.8557]], [[0.2961, 0.4677, 0.4696]], [[0.4633, 0.4084, 0.3506]], [[0.3914, 0.628, 0.5955]], [[0.6877, 0.7879, 0.397]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con76299').set_weights(w) 
in0Sub52358 = tf.constant([[[[0.0563, 0.4569, 0.5014], [0.917, 0.3266, 0.0091]], [[0.8938, 0.5853, 0.8591], [0.4406, 0.3416, 0.7492]], [[0.0244, 0.5605, 0.8234], [0.1532, 0.7926, 0.8116]]]])
in1Sub52358 = tf.constant([[[[0.4072, 0.9592, 0.1788], [0.5, 0.7488, 0.3847]], [[0.6067, 0.5494, 0.4653], [0.4676, 0.0505, 0.0947]], [[0.7349, 0.2518, 0.558], [0.7643, 0.8594, 0.4901]]]])
in0Add92137 = tf.constant([[[[[0.0321], [0.8196]], [[0.4905], [0.0713]]]]])
in1Add92137 = tf.constant([[[[[0.808], [0.5111]], [[0.1572], [0.4187]]]]])
print (np.array2string(model.predict([in0Sub52358,in1Sub52358,in0Add92137,in1Add92137],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con76299.png')

LSub52358 = subtract_layer([[[[0.0563, 0.4569, 0.5014], [0.917, 0.3266, 0.0091]], [[0.8938, 0.5853, 0.8591], [0.4406, 0.3416, 0.7492]], [[0.0244, 0.5605, 0.8234], [0.1532, 0.7926, 0.8116]]]], [[[[0.4072, 0.9592, 0.1788], [0.5, 0.7488, 0.3847]], [[0.6067, 0.5494, 0.4653], [0.4676, 0.0505, 0.0947]], [[0.7349, 0.2518, 0.558], [0.7643, 0.8594, 0.4901]]]], Sub52358), 
LRes9835 = reshape_layer(Sub52358, [3, 6], Res9835), 
LMax56726 = max_pool1D_layer(Res9835, 2, Max56726), 
LRes57967 = reshape_layer(Max56726, [1, 6, 1], Res57967), 
LRes55019 = reshape_layer(Res57967, [1, 6, 1, 1], Res55019), 
LZer71021 = zero_padding3D_layer(Res55019, 0, 0, 0, 0, 2, 0, Zer71021), 
LAdd92137 = add_layer([[[[[[0.0321], [0.8196]], [[0.4905], [0.0713]]]]], [[[[[0.808], [0.5111]], [[0.1572], [0.4187]]]]]], Add92137), 
LZer19485 = zero_padding3D_layer(Add92137, 0, 0, 4, 0, 1, 0, Zer19485), 
LAdd83952 = add_layer([Zer71021,Zer19485], Add83952), 
LFla8634 = flatten_layer(Add83952, Fla8634), 
LRes82408 = reshape_layer(Fla8634, [18, 1], Res82408), 
LCon76299 = conv1D_layer(Res82408, 7,[[[0.805, 0.485, 0.375]], [[0.4028, 0.4832, 0.5028]], [[0.4993, 0.9903, 0.8557]], [[0.2961, 0.4677, 0.4696]], [[0.4633, 0.4084, 0.3506]], [[0.3914, 0.628, 0.5955]], [[0.6877, 0.7879, 0.397]]],[0, 0, 0], 1, false, 1, Con76299), 
exec_layers([LSub52358,LRes9835,LMax56726,LRes57967,LRes55019,LZer71021,LAdd92137,LZer19485,LAdd83952,LFla8634,LRes82408,LCon76299],["Sub52358","Res9835","Max56726","Res57967","Res55019","Zer71021","Add92137","Zer19485","Add83952","Fla8634","Res82408","Con76299"],Con76299,"Con76299")

Actual (Unparsed): [[[0.1574003, 0.3068604, 0.2670500], [0.1322764, 0.1533883, 0.1569404], [0.5125618, 0.4663090, 0.2808598], [0.1720582, 0.2828582, 0.2652276], [0.1969081, 0.1781748, 0.1561168], [0.4322746, 0.5301461, 0.3639400], [0.3598381, 0.6518561, 0.5852981], [0.9295555, 1.0225018, 0.6777225], [1.8846097, 2.1914229, 1.4876324], [1.2321990, 1.7745423, 1.6171479], [1.6135244, 1.7670751, 1.4299185], [2.2759443, 3.1012190, 2.4769177]]]

Expected (Unparsed): [[[0.15740029000000003,0.30686033000000007,0.26704992000000005],[0.13227635000000001,0.15338828000000004,0.15694042000000002],[0.51256175,0.46630895000000006,0.28085974],[0.17205819,0.28285817,0.26522753000000004],[0.19690806,0.17817480000000002,0.15611680000000003],[0.43227458,0.5301460600000001,0.36393998000000005],[0.35983814000000003,0.65185614,0.58529816],[0.92955551,1.02250175,0.67772254],[1.8846097,2.19142292,1.4876323500000002],[1.23219895,1.77454234,1.6171478600000002],[1.61352444,1.76707512,1.42991854],[2.2759443399999997,3.10121904,2.4769177]]]

Actual:   [[[0.1575, 0.3069, 0.2671], [0.1323, 0.1534, 0.157], [0.5126, 0.4664, 0.2809], [0.1721, 0.2829, 0.2653], [0.197, 0.1782, 0.1562], [0.4323, 0.5302, 0.364], [0.3599, 0.6519, 0.5853], [0.9296, 1.0226, 0.6778], [1.8847, 2.1915, 1.4877], [1.2322, 1.7746, 1.6172], [1.6136, 1.7671, 1.43], [2.276, 3.1013, 2.477]]]

Expected: [[[0.1575, 0.3069, 0.2671], [0.1323, 0.1534, 0.157], [0.5126, 0.4664, 0.2809], [0.1721, 0.2829, 0.2653], [0.197, 0.1782, 0.1562], [0.4323, 0.5302, 0.364], [0.3599, 0.6519, 0.5853], [0.9296, 1.0226, 0.6778], [1.8847, 2.1915, 1.4877], [1.2322, 1.7746, 1.6172], [1.6136, 1.7671, 1.43], [2.276, 3.1013, 2.477]]]