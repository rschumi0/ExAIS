import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub20996 = tf.keras.layers.Input(shape=([2]))
in1Sub20996 = tf.keras.layers.Input(shape=([2]))

Sub20996 = keras.layers.Subtract(name = 'Sub20996', )([in0Sub20996,in1Sub20996])
Res10809 = keras.layers.Reshape((2, 1), name = 'Res10809', )(Sub20996)
PRe33120 = keras.layers.PReLU(name = 'PRe33120', )(Res10809)
Res80992 = keras.layers.Reshape((2, 1, 1), name = 'Res80992', )(PRe33120)
Res92683 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res92683', )(Res80992)
Zer29000 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer29000', )(Res92683)
model = tf.keras.models.Model(inputs=[in0Sub20996,in1Sub20996], outputs=Zer29000)
w = model.get_layer('PRe33120').get_weights() 
w[0] = np.array([[0.4561], [0.862]])
model.get_layer('PRe33120').set_weights(w) 
in0Sub20996 = tf.constant([[0.9393, 0.7758]])
in1Sub20996 = tf.constant([[0.7856, 0.7522]])
print (np.array2string(model.predict([in0Sub20996,in1Sub20996],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer29000.png')

LSub20996 = subtract_layer([[0.9393, 0.7758]], [[0.7856, 0.7522]], Sub20996), 
LRes10809 = reshape_layer(Sub20996, [2, 1], Res10809), 
LPRe33120 = prelu_layer(Res10809, [[0.4561], [0.862]], PRe33120), 
LRes80992 = reshape_layer(PRe33120, [2, 1, 1], Res80992), 
LRes92683 = reshape_layer(Res80992, [2, 1, 1, 1], Res92683), 
LZer29000 = zero_padding3D_layer(Res92683, 1, 1, 1, 1, 1, 1, Zer29000), 
exec_layers([LSub20996,LRes10809,LPRe33120,LRes80992,LRes92683,LZer29000],["Sub20996","Res10809","PRe33120","Res80992","Res92683","Zer29000"],Zer29000,"Zer29000")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.1537000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0236000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.15370000000000006],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.023600000000000065],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.1537], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.0236], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.1538], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.0237], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]