import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add27476 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Add27476 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Add27476 = keras.layers.Add(name = 'Add27476', )([in0Add27476,in1Add27476])
Glo87279 = keras.layers.GlobalMaxPool3D(name = 'Glo87279', )(Add27476)
Res52024 = keras.layers.Reshape((1, 1), name = 'Res52024', )(Glo87279)
LST25063 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST25063', )(Res52024)
Res30711 = keras.layers.Reshape((3, 1), name = 'Res30711', )(LST25063)
Up_82310 = keras.layers.UpSampling1D(size=(1), name = 'Up_82310', )(Res30711)
Bat85420 = keras.layers.BatchNormalization(axis=2, epsilon=0.9646055102858527,  name = 'Bat85420', )(Up_82310)
model = tf.keras.models.Model(inputs=[in0Add27476,in1Add27476], outputs=Bat85420)
w = model.get_layer('LST25063').get_weights() 
w[0] = np.array([[5, 5, 6, 2, 9, 10, 7, 5, 7, 8, 8, 9]])
w[1] = np.array([[1, 4, 9, 5, 9, 7, 7, 4, 2, 8, 6, 10], [8, 7, 5, 7, 9, 4, 7, 10, 10, 10, 1, 9], [9, 4, 6, 7, 4, 3, 8, 6, 4, 5, 4, 10]])
w[2] = np.array([2, 9, 1, 8, 2, 10, 2, 6, 8, 10, 1, 6])
model.get_layer('LST25063').set_weights(w) 
w = model.get_layer('Bat85420').get_weights() 
w[0] = np.array([0.2201])
w[1] = np.array([0.8929])
w[2] = np.array([0.0339])
w[3] = np.array([0.4339])
model.get_layer('Bat85420').set_weights(w) 
in0Add27476 = tf.constant([[[[[0.0942], [0.0066]]], [[[0.9651], [0.944]]]]])
in1Add27476 = tf.constant([[[[[0.2918], [0.5711]]], [[[0.7746], [0.1633]]]]])
print (np.array2string(model.predict([in0Add27476,in1Add27476],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat85420.png')

LAdd27476 = add_layer([[[[[[0.0942], [0.0066]]], [[[0.9651], [0.944]]]]], [[[[[0.2918], [0.5711]]], [[[0.7746], [0.1633]]]]]], Add27476), 
LGlo87279 = global_max_pool3D_layer(Add27476, Glo87279), 
LRes52024 = reshape_layer(Glo87279, [1, 1], Res52024), 
LLST25063 = lstm_layer(Res52024,[[5, 5, 6, 2, 9, 10, 7, 5, 7, 8, 8, 9]],[[1, 4, 9, 5, 9, 7, 7, 4, 2, 8, 6, 10], [8, 7, 5, 7, 9, 4, 7, 10, 10, 10, 1, 9], [9, 4, 6, 7, 4, 3, 8, 6, 4, 5, 4, 10]],[2, 9, 1, 8, 2, 10, 2, 6, 8, 10, 1, 6], LST25063), 
LRes30711 = reshape_layer(LST25063, [3, 1], Res30711), 
LUp_82310 = up_sampling1D_layer(Res30711, 1, Up_82310), 
LBat85420 = batch_normalization_layer(Up_82310, 2, 0.9646055102858527, [0.2201], [0.8929], [0.0339], [0.4339], Bat85420), 
exec_layers([LAdd27476,LGlo87279,LRes52024,LLST25063,LRes30711,LUp_82310,LBat85420],["Add27476","Glo87279","Res52024","LST25063","Res30711","Up_82310","Bat85420"],Bat85420,"Bat85420")

Actual (Unparsed): [[[1.0283351], [1.0283368], [1.0283360]]]

Expected (Unparsed): [[[1.0283350833938825],[1.0283367995599677],[1.0283360059068025]]]

Actual:   [[[1.0284], [1.0284], [1.0284]]]

Expected: [[[1.0284], [1.0284], [1.0284]]]