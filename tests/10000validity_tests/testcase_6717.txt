import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add36607 = tf.keras.layers.Input(shape=([1, 2]))
in1Add36607 = tf.keras.layers.Input(shape=([1, 2]))
in0Max50595 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max50595 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave59543 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Ave59543 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con33046 = tf.keras.layers.Input(shape=([2, 1]))
in0Con81549 = tf.keras.layers.Input(shape=([1, 2]))

Add36607 = keras.layers.Add(name = 'Add36607', )([in0Add36607,in1Add36607])
Res12272 = keras.layers.Reshape((1, 2, 1), name = 'Res12272', )(Add36607)
Zer56980 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer56980', )(Res12272)
Max50595 = keras.layers.Maximum(name = 'Max50595', )([in0Max50595,in1Max50595])
Mul24147 = keras.layers.Multiply(name = 'Mul24147', )([Zer56980,Max50595])
Res84499 = keras.layers.Reshape((2, 2), name = 'Res84499', )(Mul24147)
Max54587 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='same', name = 'Max54587', )(Res84499)
Res30586 = keras.layers.Reshape((2, 2, 1), name = 'Res30586', )(Max54587)
Res64940 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res64940', )(Res30586)
Ave59543 = keras.layers.Average(name = 'Ave59543', )([in0Ave59543,in1Ave59543])
Add66461 = keras.layers.Add(name = 'Add66461', )([Res64940,Ave59543])
Res84394 = keras.layers.Reshape((2, 2, 1), name = 'Res84394', )(Add66461)
Res88064 = keras.layers.Reshape((2, 2), name = 'Res88064', )(Res84394)
Con33046 = keras.layers.Concatenate(axis=2, name = 'Con33046', )([Res88064,in0Con33046])
Con81549 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con81549', )(in0Con81549)
Zer21314 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer21314', )(Con81549)
Min16745 = keras.layers.Minimum(name = 'Min16745', )([Con33046,Zer21314])
model = tf.keras.models.Model(inputs=[in0Add36607,in1Add36607,in0Max50595,in1Max50595,in0Ave59543,in1Ave59543,in0Con33046,in0Con81549], outputs=Min16745)
w = model.get_layer('Con81549').get_weights() 
w[0] = np.array([[[0.5779, 0.6641, 0.9382], [0.2774, 0.2161, 0.9812]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con81549').set_weights(w) 
in0Add36607 = tf.constant([[[0.4063, 0.6415]]])
in1Add36607 = tf.constant([[[0.25, 0.3043]]])
in0Max50595 = tf.constant([[[[0.3204], [0.8593]], [[0.8985], [0.9087]]]])
in1Max50595 = tf.constant([[[[0.1758], [0.7959]], [[0.6896], [0.8074]]]])
in0Ave59543 = tf.constant([[[[[0.0245]], [[0.8212]]], [[[0.306]], [[0.1567]]]]])
in1Ave59543 = tf.constant([[[[[0.1558]], [[0.2596]]], [[[0.3216]], [[0.1202]]]]])
in0Con33046 = tf.constant([[[0.7926], [0.5109]]])
in0Con81549 = tf.constant([[[0.3891, 0.4596]]])
print (np.array2string(model.predict([in0Add36607,in1Add36607,in0Max50595,in1Max50595,in0Ave59543,in1Ave59543,in0Con33046,in0Con81549],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min16745.png')

LAdd36607 = add_layer([[[[0.4063, 0.6415]]], [[[0.25, 0.3043]]]], Add36607), 
LRes12272 = reshape_layer(Add36607, [1, 2, 1], Res12272), 
LZer56980 = zero_padding2D_layer(Res12272, 1, 0, 0, 0, Zer56980), 
LMax50595 = maximum_layer([[[[[0.3204], [0.8593]], [[0.8985], [0.9087]]]], [[[[0.1758], [0.7959]], [[0.6896], [0.8074]]]]], Max50595), 
LMul24147 = multiply_layer([Zer56980,Max50595], Mul24147), 
LRes84499 = reshape_layer(Mul24147, [2, 2], Res84499), 
LMax54587 = max_pool1D_layer(Res84499, 2, 1, true, Max54587), 
LRes30586 = reshape_layer(Max54587, [2, 2, 1], Res30586), 
LRes64940 = reshape_layer(Res30586, [2, 2, 1, 1], Res64940), 
LAve59543 = average_layer([[[[[[0.0245]], [[0.8212]]], [[[0.306]], [[0.1567]]]]], [[[[[0.1558]], [[0.2596]]], [[[0.3216]], [[0.1202]]]]]], Ave59543), 
LAdd66461 = add_layer([Res64940,Ave59543], Add66461), 
LRes84394 = reshape_layer(Add66461, [2, 2, 1], Res84394), 
LRes88064 = reshape_layer(Res84394, [2, 2], Res88064), 
LCon33046 = concatenate_layer([Res88064,[[[0.7926], [0.5109]]]], 2, Con33046), 
LCon81549 = conv1D_layer([[[0.3891, 0.4596]]], 1,[[[0.5779, 0.6641, 0.9382], [0.2774, 0.2161, 0.9812]]],[0, 0, 0], 1, true, 1, Con81549), 
LZer21314 = zero_padding1D_layer(Con81549, 1, 0, Zer21314), 
LMin16745 = minimum_layer([Con33046,Zer21314], Min16745), 
exec_layers([LAdd36607,LRes12272,LZer56980,LMax50595,LMul24147,LRes84499,LMax54587,LRes30586,LRes64940,LAve59543,LAdd66461,LRes84394,LRes88064,LCon33046,LCon81549,LZer21314,LMin16745],["Add36607","Res12272","Zer56980","Max50595","Mul24147","Res84499","Max54587","Res30586","Res64940","Ave59543","Add66461","Res84394","Res88064","Con33046","Con81549","Zer21314","Min16745"],Min16745,"Min16745")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000], [0.3523539, 0.3577209, 0.5109000]]]

Expected (Unparsed): [[[0,0,0],[0.35235393,0.35772086999999997,0.5109]]]

Actual:   [[[0, 0, 0], [0.3524, 0.3578, 0.5109]]]

Expected: [[[0, 0, 0], [0.3524, 0.3578, 0.5109]]]