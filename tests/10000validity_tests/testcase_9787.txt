import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per55818 = tf.keras.layers.Input(shape=([1, 3]))

Per55818 = keras.layers.Permute((2,1), name = 'Per55818',)(in0Per55818)
Den50460 = keras.layers.Dense(1,name = 'Den50460', )(Per55818)
GRU958 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU958', )(Den50460)
Res43841 = keras.layers.Reshape((3, 1), name = 'Res43841', )(GRU958)
Res53730 = keras.layers.Reshape((3, 1, 1), name = 'Res53730', )(Res43841)
Res10075 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res10075', )(Res53730)
Cro80482 = keras.layers.Cropping3D(cropping=((1, 1), (0, 0), (0, 0)), name = 'Cro80482', )(Res10075)
model = tf.keras.models.Model(inputs=[in0Per55818], outputs=Cro80482)
w = model.get_layer('Den50460').get_weights() 
w[0] = np.array([[0.1175]])
w[1] = np.array([0.5906])
model.get_layer('Den50460').set_weights(w) 
w = model.get_layer('GRU958').get_weights() 
w[0] = np.array([[3, 7, 9, 2, 4, 5, 4, 8, 10]])
w[1] = np.array([[8, 10, 10, 1, 5, 9, 3, 5, 9], [7, 6, 9, 6, 4, 2, 2, 5, 1], [10, 6, 5, 10, 7, 1, 6, 8, 5]])
w[2] = np.array([[3, 8, 10, 10, 1, 5, 5, 6, 8], [3, 10, 8, 3, 6, 10, 3, 1, 7]])
model.get_layer('GRU958').set_weights(w) 
in0Per55818 = tf.constant([[[1.5868, 1.4486, 1.8442]]])
print (np.array2string(model.predict([in0Per55818],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro80482.png')

LPer55818 = permute_layer([[[1.5868, 1.4486, 1.8442]]], 2,1, Per55818), 
LDen50460 = dense_layer(Per55818, [[0.1175]],[0.5906], Den50460), 
LGRU958 = gru_layer(Den50460,[[3, 7, 9, 2, 4, 5, 4, 8, 10]],[[8, 10, 10, 1, 5, 9, 3, 5, 9], [7, 6, 9, 6, 4, 2, 2, 5, 1], [10, 6, 5, 10, 7, 1, 6, 8, 5]],[[3, 8, 10, 10, 1, 5, 5, 6, 8], [3, 10, 8, 3, 6, 10, 3, 1, 7]], true, GRU958), 
LRes43841 = reshape_layer(GRU958, [3, 1], Res43841), 
LRes53730 = reshape_layer(Res43841, [3, 1, 1], Res53730), 
LRes10075 = reshape_layer(Res53730, [3, 1, 1, 1], Res10075), 
LCro80482 = cropping3D_layer(Res10075, 1, 1, 0, 0, 0, 0, Cro80482), 
exec_layers([LPer55818,LDen50460,LGRU958,LRes43841,LRes53730,LRes10075,LCro80482],["Per55818","Den50460","GRU958","Res43841","Res53730","Res10075","Cro80482"],Cro80482,"Cro80482")

Actual (Unparsed): [[[[[0.0000000]]]]]

Expected (Unparsed): [[[[[1.9330248511608547e-10]]]]]

Actual:   [[[[[0]]]]]

Expected: [[[[[0]]]]]