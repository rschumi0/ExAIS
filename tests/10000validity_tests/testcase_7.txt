import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max39766 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max39766 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Dot61933 = tf.keras.layers.Input(shape=([2]))
in1Dot61933 = tf.keras.layers.Input(shape=([2]))
in0Con44696 = tf.keras.layers.Input(shape=([2]))

Max39766 = keras.layers.Maximum(name = 'Max39766', )([in0Max39766,in1Max39766])
Res96675 = keras.layers.Reshape((2, 2, 2), name = 'Res96675', )(Max39766)
Res63024 = keras.layers.Reshape((2, 4), name = 'Res63024', )(Res96675)
Sep83465 = keras.layers.SeparableConv1D(3, (2),strides=(2), padding='valid', name = 'Sep83465', )(Res63024)
Fla41457 = keras.layers.Flatten(name = 'Fla41457', )(Sep83465)
Dot61933 = keras.layers.Dot(axes=(1, 1), name = 'Dot61933', )([in0Dot61933,in1Dot61933])
Con44696 = keras.layers.Concatenate(axis=1, name = 'Con44696', )([Dot61933,in0Con44696])
Max47156 = keras.layers.Maximum(name = 'Max47156', )([Fla41457,Con44696])
model = tf.keras.models.Model(inputs=[in0Max39766,in1Max39766,in0Dot61933,in1Dot61933,in0Con44696], outputs=Max47156)
w = model.get_layer('Sep83465').get_weights() 
w[0] = np.array([[[0.4129], [0.5053], [0.5228], [0.8601]], [[0.884], [0.9045], [0.3293], [0.6757]]])
w[1] = np.array([[[0.4954, 0.722, 0.5689], [0.4425, 0.1357, 0.571], [0.1576, 0.2548, 0.7601], [0.1375, 0.7522, 0.1401]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep83465').set_weights(w) 
in0Max39766 = tf.constant([[[[[0.6637, 0.2033]], [[0.7329, 0.8826]]], [[[0.3425, 0.5768]], [[0.1774, 0.2655]]]]])
in1Max39766 = tf.constant([[[[[0.7267, 0.4449]], [[0.2255, 0.4684]]], [[[0.5623, 0.4026]], [[0.0176, 0.9171]]]]])
in0Dot61933 = tf.constant([[0.0944, 0.2975]])
in1Dot61933 = tf.constant([[0.9891, 0.7261]])
in0Con44696 = tf.constant([[0.2691, 0.5063]])
print (np.array2string(model.predict([in0Max39766,in1Max39766,in0Dot61933,in1Dot61933,in0Con44696],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max47156.png')

LMax39766 = maximum_layer([[[[[[0.6637, 0.2033]], [[0.7329, 0.8826]]], [[[0.3425, 0.5768]], [[0.1774, 0.2655]]]]], [[[[[0.7267, 0.4449]], [[0.2255, 0.4684]]], [[[0.5623, 0.4026]], [[0.0176, 0.9171]]]]]], Max39766), 
LRes96675 = reshape_layer(Max39766, [2, 2, 2], Res96675), 
LRes63024 = reshape_layer(Res96675, [2, 4], Res63024), 
LSep83465 = separable_conv1D_layer(Res63024, 2,[[[[0.4129], [0.5053], [0.5228], [0.8601]], [[0.884], [0.9045], [0.3293], [0.6757]]],[[[0.4954, 0.722, 0.5689], [0.4425, 0.1357, 0.571], [0.1576, 0.2548, 0.7601], [0.1375, 0.7522, 0.1401]]]],[0, 0, 0], 2, false, Sep83465), 
LFla41457 = flatten_layer(Sep83465, Fla41457), 
LDot61933 = dot_layer([[0.0944, 0.2975]], [[0.9891, 0.7261]], 1, 1, Dot61933), 
LCon44696 = concatenate_layer([Dot61933,[[0.2691, 0.5063]]], 1, Con44696), 
LMax47156 = maximum_layer([Fla41457,Con44696], Max47156), 
exec_layers([LMax39766,LRes96675,LRes63024,LSep83465,LFla41457,LDot61933,LCon44696,LMax47156],["Max39766","Res96675","Res63024","Sep83465","Fla41457","Dot61933","Con44696","Max47156"],Max47156,"Max47156")

Actual (Unparsed): [[0.9844126, 1.8264834, 1.4085654]]

Expected (Unparsed): [[0.9844125913459999,1.826483383127,1.4085653624440002]]

Actual:   [[0.9845, 1.8265, 1.4086]]

Expected: [[0.9845, 1.8265, 1.4086]]