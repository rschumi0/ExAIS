import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min16998 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Min16998 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Bat11432 = tf.keras.layers.Input(shape=([1, 4, 2]))

Min16998 = keras.layers.Minimum(name = 'Min16998', )([in0Min16998,in1Min16998])
Res34433 = keras.layers.Reshape((2, 2, 2), name = 'Res34433', )(Min16998)
Cro84541 = keras.layers.Cropping2D(cropping=((0, 1), (0, 1)), name = 'Cro84541', )(Res34433)
Zer5562 = keras.layers.ZeroPadding2D(padding=((0, 0), (3, 0)), name = 'Zer5562', )(Cro84541)
Bat11432 = keras.layers.BatchNormalization(axis=1, epsilon=0.2958426132130564,  name = 'Bat11432', )(in0Bat11432)
Add54524 = keras.layers.Add(name = 'Add54524', )([Zer5562,Bat11432])
Glo45581 = keras.layers.GlobalAveragePooling2D(name = 'Glo45581', )(Add54524)
model = tf.keras.models.Model(inputs=[in0Min16998,in1Min16998,in0Bat11432], outputs=Glo45581)
w = model.get_layer('Bat11432').get_weights() 
w[0] = np.array([0.1315])
w[1] = np.array([0.0536])
w[2] = np.array([0.7535])
w[3] = np.array([0.3997])
model.get_layer('Bat11432').set_weights(w) 
in0Min16998 = tf.constant([[[[[0.1339], [0.4112]], [[0.5609], [0.1882]]], [[[0.7319], [0.9926]], [[0.5891], [0.3219]]]]])
in1Min16998 = tf.constant([[[[[0.0322], [0.3148]], [[0.1873], [0.6049]]], [[[0.8245], [0.2158]], [[0.5543], [0.1516]]]]])
in0Bat11432 = tf.constant([[[[1.8488, 1.0907], [1.2888, 1.2695], [1.5988, 1.9523], [1.8554, 1.6139]]]])
print (np.array2string(model.predict([in0Min16998,in1Min16998,in0Bat11432],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo45581.png')

LMin16998 = minimum_layer([[[[[[0.1339], [0.4112]], [[0.5609], [0.1882]]], [[[0.7319], [0.9926]], [[0.5891], [0.3219]]]]], [[[[[0.0322], [0.3148]], [[0.1873], [0.6049]]], [[[0.8245], [0.2158]], [[0.5543], [0.1516]]]]]], Min16998), 
LRes34433 = reshape_layer(Min16998, [2, 2, 2], Res34433), 
LCro84541 = cropping2D_layer(Res34433, 0, 1, 0, 1, Cro84541), 
LZer5562 = zero_padding2D_layer(Cro84541, 0, 0, 3, 0, Zer5562), 
LBat11432 = batch_normalization_layer([[[[1.8488, 1.0907], [1.2888, 1.2695], [1.5988, 1.9523], [1.8554, 1.6139]]]], 1, 0.2958426132130564, [0.1315], [0.0536], [0.7535], [0.3997], Bat11432), 
LAdd54524 = add_layer([Zer5562,Bat11432], Add54524), 
LGlo45581 = global_average_pooling2D_layer(Add54524, Glo45581), 
exec_layers([LMin16998,LRes34433,LCro84541,LZer5562,LBat11432,LAdd54524,LGlo45581],["Min16998","Res34433","Cro84541","Zer5562","Bat11432","Add54524","Glo45581"],Glo45581,"Glo45581")

Actual (Unparsed): [[0.2026827, 0.2471034]]

Expected (Unparsed): [[0.20268274206847064,0.24710344289793]]

Actual:   [[0.2027, 0.2472]]

Expected: [[0.2027, 0.2472]]