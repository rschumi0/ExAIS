import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub16402 = tf.keras.layers.Input(shape=([3]))
in1Sub16402 = tf.keras.layers.Input(shape=([3]))
in0Con16675 = tf.keras.layers.Input(shape=([3, 3]))
in0Dot59140 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot59140 = tf.keras.layers.Input(shape=([2, 2]))
in0Con76565 = tf.keras.layers.Input(shape=([2, 2]))
in0Con99057 = tf.keras.layers.Input(shape=([1, 1]))

Sub16402 = keras.layers.Subtract(name = 'Sub16402', )([in0Sub16402,in1Sub16402])
Res21183 = keras.layers.Reshape((3, 1), name = 'Res21183', )(Sub16402)
Con16675 = keras.layers.Concatenate(axis=2, name = 'Con16675', )([Res21183,in0Con16675])
Dot59140 = keras.layers.Dot(axes=(1, 1), name = 'Dot59140', )([in0Dot59140,in1Dot59140])
Con76565 = keras.layers.Concatenate(axis=2, name = 'Con76565', )([Dot59140,in0Con76565])
Con99057 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con99057', )(in0Con99057)
Den9066 = keras.layers.Dense(4,name = 'Den9066', )(Con99057)
Zer16297 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer16297', )(Den9066)
Mul70133 = keras.layers.Multiply(name = 'Mul70133', )([Con76565,Zer16297])
Zer62069 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer62069', )(Mul70133)
Add84514 = keras.layers.Add(name = 'Add84514', )([Con16675,Zer62069])
model = tf.keras.models.Model(inputs=[in0Sub16402,in1Sub16402,in0Con16675,in0Dot59140,in1Dot59140,in0Con76565,in0Con99057], outputs=Add84514)
w = model.get_layer('Con99057').get_weights() 
w[0] = np.array([[[0.0028, 0.73, 0.8875, 0.1739]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con99057').set_weights(w) 
w = model.get_layer('Den9066').get_weights() 
w[0] = np.array([[0.8852, 0.8306, 0.4832, 0.4206], [0.9281, 0.0057, 0.2107, 0.9537], [0.8596, 0.6773, 0.1466, 0.0732], [0.2773, 0.1445, 0.0291, 0.7009]])
w[1] = np.array([0.1076, 0.4211, 0.1821, 0.487])
model.get_layer('Den9066').set_weights(w) 
in0Sub16402 = tf.constant([[0.322, 0.9495, 0.4697]])
in1Sub16402 = tf.constant([[0.1808, 0.499, 0.7267]])
in0Con16675 = tf.constant([[[0.8703, 0.5077, 0.014], [0.0403, 0.9731, 0.0481], [0.2082, 0.6332, 0.0288]]])
in0Dot59140 = tf.constant([[[0.7804, 0.8114], [0.1928, 0.7927]]])
in1Dot59140 = tf.constant([[[0.8897, 0.0843], [0.9438, 0.998]]])
in0Con76565 = tf.constant([[[0.6457, 0.4607], [0.1656, 0.0315]]])
in0Con99057 = tf.constant([[[0.1899]]])
print (np.array2string(model.predict([in0Sub16402,in1Sub16402,in0Con16675,in0Dot59140,in1Dot59140,in0Con76565,in0Con99057],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add84514.png')

LSub16402 = subtract_layer([[0.322, 0.9495, 0.4697]], [[0.1808, 0.499, 0.7267]], Sub16402), 
LRes21183 = reshape_layer(Sub16402, [3, 1], Res21183), 
LCon16675 = concatenate_layer([Res21183,[[[0.8703, 0.5077, 0.014], [0.0403, 0.9731, 0.0481], [0.2082, 0.6332, 0.0288]]]], 2, Con16675), 
LDot59140 = dot_layer([[[0.7804, 0.8114], [0.1928, 0.7927]]], [[[0.8897, 0.0843], [0.9438, 0.998]]], 1, 1, Dot59140), 
LCon76565 = concatenate_layer([Dot59140,[[[0.6457, 0.4607], [0.1656, 0.0315]]]], 2, Con76565), 
LCon99057 = conv1D_layer([[[0.1899]]], 1,[[[0.0028, 0.73, 0.8875, 0.1739]]],[0, 0, 0, 0], 1, false, 1, Con99057), 
LDen9066 = dense_layer(Con99057, [[0.8852, 0.8306, 0.4832, 0.4206], [0.9281, 0.0057, 0.2107, 0.9537], [0.8596, 0.6773, 0.1466, 0.0732], [0.2773, 0.1445, 0.0291, 0.7009]],[0.1076, 0.4211, 0.1821, 0.487], Den9066), 
LZer16297 = zero_padding1D_layer(Den9066, 1, 0, Zer16297), 
LMul70133 = multiply_layer([Con76565,Zer16297], Mul70133), 
LZer62069 = zero_padding1D_layer(Mul70133, 1, 0, Zer62069), 
LAdd84514 = add_layer([Con16675,Zer62069], Add84514), 
exec_layers([LSub16402,LRes21183,LCon16675,LDot59140,LCon76565,LCon99057,LDen9066,LZer16297,LMul70133,LZer62069,LAdd84514],["Sub16402","Res21183","Con16675","Dot59140","Con76565","Con99057","Den9066","Zer16297","Mul70133","Zer62069","Add84514"],Add84514,"Add84514")

Actual (Unparsed): [[[0.1412000, 0.8703000, 0.5077000, 0.0140000], [0.4505000, 0.0403000, 0.9731000, 0.0481000], [0.3174402, 0.6734157, 0.6724859, 0.0494298]]]

Expected (Unparsed): [[[0.14120000000000002,0.8703,0.5077,0.014],[0.4505,0.0403,0.9731,0.0481],[0.3174402068947876,0.6734156952096508,0.6724859565777079,0.0494298323620515]]]

Actual:   [[[0.1412, 0.8703, 0.5077, 0.014], [0.4505, 0.0403, 0.9731, 0.0481], [0.3175, 0.6735, 0.6725, 0.0495]]]

Expected: [[[0.1413, 0.8703, 0.5077, 0.014], [0.4505, 0.0403, 0.9731, 0.0481], [0.3175, 0.6735, 0.6725, 0.0495]]]