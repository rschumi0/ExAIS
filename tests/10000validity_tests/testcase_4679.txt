import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub68741 = tf.keras.layers.Input(shape=([2]))
in1Sub68741 = tf.keras.layers.Input(shape=([2]))
in0Con70184 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Mul85414 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul85414 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Ave75492 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave75492 = tf.keras.layers.Input(shape=([1, 1, 2]))

Sub68741 = keras.layers.Subtract(name = 'Sub68741', )([in0Sub68741,in1Sub68741])
Res48792 = keras.layers.Reshape((2, 1), name = 'Res48792', )(Sub68741)
Res72248 = keras.layers.Reshape((2, 1, 1), name = 'Res72248', )(Res48792)
Glo39481 = keras.layers.GlobalAveragePooling2D(name = 'Glo39481', )(Res72248)
Res52817 = keras.layers.Reshape((1, 1), name = 'Res52817', )(Glo39481)
Res16047 = keras.layers.Reshape((1, 1, 1), name = 'Res16047', )(Res52817)
Zer86648 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer86648', )(Res16047)
Con70184 = keras.layers.Concatenate(axis=3, name = 'Con70184', )([Zer86648,in0Con70184])
Mul85414 = keras.layers.Multiply(name = 'Mul85414', )([in0Mul85414,in1Mul85414])
Min25344 = keras.layers.Minimum(name = 'Min25344', )([Con70184,Mul85414])
Cro37056 = keras.layers.Cropping2D(cropping=((0, 0), (0, 1)), name = 'Cro37056', )(Min25344)
Ave75492 = keras.layers.Average(name = 'Ave75492', )([in0Ave75492,in1Ave75492])
Zer95467 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer95467', )(Ave75492)
Ave54415 = keras.layers.Average(name = 'Ave54415', )([Cro37056,Zer95467])
model = tf.keras.models.Model(inputs=[in0Sub68741,in1Sub68741,in0Con70184,in0Mul85414,in1Mul85414,in0Ave75492,in1Ave75492], outputs=Ave54415)
in0Sub68741 = tf.constant([[0.7324, 0.4245]])
in1Sub68741 = tf.constant([[0.0398, 0.9772]])
in0Con70184 = tf.constant([[[[0.52], [0.6727]], [[0.7087], [0.4748]]]])
in0Mul85414 = tf.constant([[[[0.3118, 0.4285], [0.2333, 0.8118]], [[0.8278, 0.8879], [0.5814, 0.9588]]]])
in1Mul85414 = tf.constant([[[[0.7832, 0.5536], [0.9552, 0.5872]], [[0.1126, 0.9467], [0.1549, 0.5418]]]])
in0Ave75492 = tf.constant([[[[0.1473, 0.1814]]]])
in1Ave75492 = tf.constant([[[[0.7643, 0.8047]]]])
print (np.array2string(model.predict([in0Sub68741,in1Sub68741,in0Con70184,in0Mul85414,in1Mul85414,in0Ave75492,in1Ave75492],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave54415.png')

LSub68741 = subtract_layer([[0.7324, 0.4245]], [[0.0398, 0.9772]], Sub68741), 
LRes48792 = reshape_layer(Sub68741, [2, 1], Res48792), 
LRes72248 = reshape_layer(Res48792, [2, 1, 1], Res72248), 
LGlo39481 = global_average_pooling2D_layer(Res72248, Glo39481), 
LRes52817 = reshape_layer(Glo39481, [1, 1], Res52817), 
LRes16047 = reshape_layer(Res52817, [1, 1, 1], Res16047), 
LZer86648 = zero_padding2D_layer(Res16047, 1, 0, 1, 0, Zer86648), 
LCon70184 = concatenate_layer([Zer86648,[[[[0.52], [0.6727]], [[0.7087], [0.4748]]]]], 3, Con70184), 
LMul85414 = multiply_layer([[[[[0.3118, 0.4285], [0.2333, 0.8118]], [[0.8278, 0.8879], [0.5814, 0.9588]]]], [[[[0.7832, 0.5536], [0.9552, 0.5872]], [[0.1126, 0.9467], [0.1549, 0.5418]]]]], Mul85414), 
LMin25344 = minimum_layer([Con70184,Mul85414], Min25344), 
LCro37056 = cropping2D_layer(Min25344, 0, 0, 0, 1, Cro37056), 
LAve75492 = average_layer([[[[[0.1473, 0.1814]]]], [[[[0.7643, 0.8047]]]]], Ave75492), 
LZer95467 = zero_padding2D_layer(Ave75492, 1, 0, 0, 0, Zer95467), 
LAve54415 = average_layer([Cro37056,Zer95467], Ave54415), 
exec_layers([LSub68741,LRes48792,LRes72248,LGlo39481,LRes52817,LRes16047,LZer86648,LCon70184,LMul85414,LMin25344,LCro37056,LAve75492,LZer95467,LAve54415],["Sub68741","Res48792","Res72248","Glo39481","Res52817","Res16047","Zer86648","Con70184","Mul85414","Min25344","Cro37056","Ave75492","Zer95467","Ave54415"],Ave54415,"Ave54415")

Actual (Unparsed): [[[[0.0000000, 0.1186088]], [[0.2279000, 0.6008750]]]]

Expected (Unparsed): [[[[0,0.1186088]],[[0.2279,0.600875]]]]

Actual:   [[[[0, 0.1187]], [[0.2279, 0.6009]]]]

Expected: [[[[0, 0.1187]], [[0.2279, 0.6009]]]]