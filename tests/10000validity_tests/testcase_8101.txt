import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add41637 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Add41637 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Ave68555 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave68555 = tf.keras.layers.Input(shape=([1, 1]))
in0Con61372 = tf.keras.layers.Input(shape=([2, 1]))
in0Con7901 = tf.keras.layers.Input(shape=([2, 2]))
in0Sub70509 = tf.keras.layers.Input(shape=([2, 3, 3]))
in1Sub70509 = tf.keras.layers.Input(shape=([2, 3, 3]))
in0Mul93204 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Mul93204 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con32836 = tf.keras.layers.Input(shape=([2, 3]))

Add41637 = keras.layers.Add(name = 'Add41637', )([in0Add41637,in1Add41637])
Res78651 = keras.layers.Reshape((2, 2, 1), name = 'Res78651', )(Add41637)
Res77295 = keras.layers.Reshape((2, 2), name = 'Res77295', )(Res78651)
Ave68555 = keras.layers.Average(name = 'Ave68555', )([in0Ave68555,in1Ave68555])
Zer66922 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer66922', )(Ave68555)
Con61372 = keras.layers.Concatenate(axis=2, name = 'Con61372', )([Zer66922,in0Con61372])
Mul73559 = keras.layers.Multiply(name = 'Mul73559', )([Res77295,Con61372])
Con7901 = keras.layers.Concatenate(axis=2, name = 'Con7901', )([Mul73559,in0Con7901])
Sub70509 = keras.layers.Subtract(name = 'Sub70509', )([in0Sub70509,in1Sub70509])
Sof87017 = keras.layers.Softmax(axis=1, name = 'Sof87017', )(Sub70509)
Res86433 = keras.layers.Reshape((2, 9), name = 'Res86433', )(Sof87017)
Con63627 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con63627', )(Res86433)
Max4538 = keras.layers.Maximum(name = 'Max4538', )([Con7901,Con63627])
Mul93204 = keras.layers.Multiply(name = 'Mul93204', )([in0Mul93204,in1Mul93204])
Res14977 = keras.layers.Reshape((2, 2, 1), name = 'Res14977', )(Mul93204)
Res57887 = keras.layers.Reshape((2, 2), name = 'Res57887', )(Res14977)
Per26123 = keras.layers.Permute((1,2), name = 'Per26123',)(Res57887)
Den85419 = keras.layers.Dense(1,name = 'Den85419', )(Per26123)
Con32836 = keras.layers.Concatenate(axis=2, name = 'Con32836', )([Den85419,in0Con32836])
Ave32627 = keras.layers.Average(name = 'Ave32627', )([Max4538,Con32836])
model = tf.keras.models.Model(inputs=[in0Add41637,in1Add41637,in0Ave68555,in1Ave68555,in0Con61372,in0Con7901,in0Sub70509,in1Sub70509,in0Mul93204,in1Mul93204,in0Con32836], outputs=Ave32627)
w = model.get_layer('Con63627').get_weights() 
w[0] = np.array([[[0.3542, 0.2995, 0.1664, 0.51], [0.9658, 0.3123, 0.3398, 0.6678], [0.1934, 0.8447, 0.7924, 0.2817], [0.7749, 0.8453, 0.8321, 0.0566], [0.9668, 0.6999, 0.0368, 0.94], [0.4061, 0.6893, 0.5893, 0.5858], [0.6565, 0.9839, 0.1652, 0.8399], [0.529, 0.1084, 0.9654, 0.1913], [0.6821, 0.3041, 0.356, 0.1976]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con63627').set_weights(w) 
w = model.get_layer('Den85419').get_weights() 
w[0] = np.array([[0.1394], [0.9479]])
w[1] = np.array([0.4631])
model.get_layer('Den85419').set_weights(w) 
in0Add41637 = tf.constant([[[[[0.4847]], [[0.4436]]], [[[0.2255]], [[0.2846]]]]])
in1Add41637 = tf.constant([[[[[0.1336]], [[0.5619]]], [[[0.7819]], [[0.9077]]]]])
in0Ave68555 = tf.constant([[[0.4369]]])
in1Ave68555 = tf.constant([[[0.6616]]])
in0Con61372 = tf.constant([[[0.243], [0.5655]]])
in0Con7901 = tf.constant([[[0.4002, 0.7745], [0.7648, 0.4554]]])
in0Sub70509 = tf.constant([[[[0.4963, 0.8675, 0.0551], [0.3652, 0.825, 0.5844], [0.0537, 0.1589, 0.8927]], [[0.9285, 0.5492, 0.3475], [0.5325, 0.7416, 0.8538], [0.3484, 0.4374, 0.1324]]]])
in1Sub70509 = tf.constant([[[[0.5278, 0.1211, 0.0801], [0.4846, 0.0655, 0.9471], [0.1375, 0.9228, 0.0307]], [[0.2193, 0.5157, 0.3187], [0.3388, 0.3785, 0.7143], [0.7872, 0.0366, 0.6422]]]])
in0Mul93204 = tf.constant([[[[[0.1908]], [[0.0228]]], [[[0.369]], [[0.713]]]]])
in1Mul93204 = tf.constant([[[[[0.5897]], [[0.7558]]], [[[0.1441]], [[0.223]]]]])
in0Con32836 = tf.constant([[[0.1152, 0.8764, 0.8682], [0.092, 0.1843, 0.2251]]])
print (np.array2string(model.predict([in0Add41637,in1Add41637,in0Ave68555,in1Ave68555,in0Con61372,in0Con7901,in0Sub70509,in1Sub70509,in0Mul93204,in1Mul93204,in0Con32836],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave32627.png')

LAdd41637 = add_layer([[[[[[0.4847]], [[0.4436]]], [[[0.2255]], [[0.2846]]]]], [[[[[0.1336]], [[0.5619]]], [[[0.7819]], [[0.9077]]]]]], Add41637), 
LRes78651 = reshape_layer(Add41637, [2, 2, 1], Res78651), 
LRes77295 = reshape_layer(Res78651, [2, 2], Res77295), 
LAve68555 = average_layer([[[[0.4369]]], [[[0.6616]]]], Ave68555), 
LZer66922 = zero_padding1D_layer(Ave68555, 1, 0, Zer66922), 
LCon61372 = concatenate_layer([Zer66922,[[[0.243], [0.5655]]]], 2, Con61372), 
LMul73559 = multiply_layer([Res77295,Con61372], Mul73559), 
LCon7901 = concatenate_layer([Mul73559,[[[0.4002, 0.7745], [0.7648, 0.4554]]]], 2, Con7901), 
LSub70509 = subtract_layer([[[[0.4963, 0.8675, 0.0551], [0.3652, 0.825, 0.5844], [0.0537, 0.1589, 0.8927]], [[0.9285, 0.5492, 0.3475], [0.5325, 0.7416, 0.8538], [0.3484, 0.4374, 0.1324]]]], [[[[0.5278, 0.1211, 0.0801], [0.4846, 0.0655, 0.9471], [0.1375, 0.9228, 0.0307]], [[0.2193, 0.5157, 0.3187], [0.3388, 0.3785, 0.7143], [0.7872, 0.0366, 0.6422]]]], Sub70509), 
LSof87017 = softmax_layer(Sub70509, 1, Sof87017), 
LRes86433 = reshape_layer(Sof87017, [2, 9], Res86433), 
LCon63627 = conv1D_layer(Res86433, 1,[[[0.3542, 0.2995, 0.1664, 0.51], [0.9658, 0.3123, 0.3398, 0.6678], [0.1934, 0.8447, 0.7924, 0.2817], [0.7749, 0.8453, 0.8321, 0.0566], [0.9668, 0.6999, 0.0368, 0.94], [0.4061, 0.6893, 0.5893, 0.5858], [0.6565, 0.9839, 0.1652, 0.8399], [0.529, 0.1084, 0.9654, 0.1913], [0.6821, 0.3041, 0.356, 0.1976]]],[0, 0, 0, 0], 1, false, 1, Con63627), 
LMax4538 = maximum_layer([Con7901,Con63627], Max4538), 
LMul93204 = multiply_layer([[[[[[0.1908]], [[0.0228]]], [[[0.369]], [[0.713]]]]], [[[[[0.5897]], [[0.7558]]], [[[0.1441]], [[0.223]]]]]], Mul93204), 
LRes14977 = reshape_layer(Mul93204, [2, 2, 1], Res14977), 
LRes57887 = reshape_layer(Res14977, [2, 2], Res57887), 
LPer26123 = permute_layer(Res57887, 1,2, Per26123), 
LDen85419 = dense_layer(Per26123, [[0.1394], [0.9479]],[0.4631], Den85419), 
LCon32836 = concatenate_layer([Den85419,[[[0.1152, 0.8764, 0.8682], [0.092, 0.1843, 0.2251]]]], 2, Con32836), 
LAve32627 = average_layer([Max4538,Con32836], Ave32627), 
exec_layers([LAdd41637,LRes78651,LRes77295,LAve68555,LZer66922,LCon61372,LMul73559,LCon7901,LSub70509,LSof87017,LRes86433,LCon63627,LMax4538,LMul93204,LRes14977,LRes57887,LPer26123,LDen85419,LCon32836,LAve32627],["Add41637","Res78651","Res77295","Ave68555","Zer66922","Con61372","Mul73559","Con7901","Sub70509","Sof87017","Res86433","Con63627","Max4538","Mul93204","Res14977","Res57887","Per26123","Den85419","Con32836","Ave32627"],Ave32627,"Ave32627")

Actual (Unparsed): [[[1.7329194, 1.3572429, 1.3749888, 1.5607942], [1.5896538, 1.2900571, 1.2770612, 1.1212058]]]

Expected (Unparsed): [[[1.7329194374443626,1.3572429089621487,1.3749888200300517,1.5607942306305762],[1.589653788655638,1.2900570910378515,1.277061179969948,1.1212057693694235]]]

Actual:   [[[1.733, 1.3573, 1.375, 1.5608], [1.5897, 1.2901, 1.2771, 1.1213]]]

Expected: [[[1.733, 1.3573, 1.375, 1.5608], [1.5897, 1.2901, 1.2771, 1.1213]]]