import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con53055 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con69383 = tf.keras.layers.Input(shape=([1, 2, 3, 1]))
in0Ave15366 = tf.keras.layers.Input(shape=([1, 2]))
in0Con66694 = tf.keras.layers.Input(shape=([1, 2, 3, 1]))
in0Min72553 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Min72553 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Con53055 = keras.layers.Conv3DTranspose(2, (1, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con53055', )(in0Con53055)
Res55942 = keras.layers.Reshape((1, 2, 2), name = 'Res55942', )(Con53055)
Cro53212 = keras.layers.Cropping2D(cropping=((0, 0), (1, 0)), name = 'Cro53212', )(Res55942)
Res58770 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res58770', )(Cro53212)
Zer19282 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer19282', )(Res58770)
Con69383 = keras.layers.Concatenate(axis=4, name = 'Con69383', )([Zer19282,in0Con69383])
Ave15366 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave15366', )(in0Ave15366)
Res33119 = keras.layers.Reshape((1, 2, 1), name = 'Res33119', )(Ave15366)
Res64675 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res64675', )(Res33119)
Zer94937 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer94937', )(Res64675)
Con66694 = keras.layers.Concatenate(axis=4, name = 'Con66694', )([Zer94937,in0Con66694])
Min72553 = keras.layers.Minimum(name = 'Min72553', )([in0Min72553,in1Min72553])
ELU37058 = keras.layers.ELU(alpha=-5.841114606818147, name = 'ELU37058', )(Min72553)
Zer36588 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer36588', )(ELU37058)
Min93824 = keras.layers.Minimum(name = 'Min93824', )([Con66694,Zer36588])
Ave7061 = keras.layers.Average(name = 'Ave7061', )([Con69383,Min93824])
model = tf.keras.models.Model(inputs=[in0Con53055,in0Con69383,in0Ave15366,in0Con66694,in0Min72553,in1Min72553], outputs=Ave7061)
w = model.get_layer('Con53055').get_weights() 
w[0] = np.array([[[[[0.3306], [0.2088]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con53055').set_weights(w) 
in0Con53055 = tf.constant([[[[[0.9268]], [[0.4122]]]]])
in0Con69383 = tf.constant([[[[[0.6459], [0.5055], [0.3856]], [[0.572], [0.2495], [0.4945]]]]])
in0Ave15366 = tf.constant([[[1.6299, 1.7887]]])
in0Con66694 = tf.constant([[[[[0.4641], [0.134], [0.1526]], [[0.5952], [0.5307], [0.736]]]]])
in0Min72553 = tf.constant([[[[[0.4778, 0.0785], [0.5938, 0.0954]]]]])
in1Min72553 = tf.constant([[[[[0.6381, 0.3321], [0.0165, 0.5106]]]]])
print (np.array2string(model.predict([in0Con53055,in0Con69383,in0Ave15366,in0Con66694,in0Min72553,in1Min72553],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave7061.png')

LCon53055 = conv3D_transpose_layer([[[[[0.9268]], [[0.4122]]]]], 1, 1, 1,[[[[[0.3306], [0.2088]]]]],[0, 0], 1, 1, 1, true, Con53055), 
LRes55942 = reshape_layer(Con53055, [1, 2, 2], Res55942), 
LCro53212 = cropping2D_layer(Res55942, 0, 0, 1, 0, Cro53212), 
LRes58770 = reshape_layer(Cro53212, [1, 1, 2, 1], Res58770), 
LZer19282 = zero_padding3D_layer(Res58770, 0, 0, 1, 0, 1, 0, Zer19282), 
LCon69383 = concatenate_layer([Zer19282,[[[[[0.6459], [0.5055], [0.3856]], [[0.572], [0.2495], [0.4945]]]]]], 4, Con69383), 
LAve15366 = average_pooling1D_layer([[[1.6299, 1.7887]]], 1, Ave15366), 
LRes33119 = reshape_layer(Ave15366, [1, 2, 1], Res33119), 
LRes64675 = reshape_layer(Res33119, [1, 2, 1, 1], Res64675), 
LZer94937 = zero_padding3D_layer(Res64675, 0, 0, 0, 0, 2, 0, Zer94937), 
LCon66694 = concatenate_layer([Zer94937,[[[[[0.4641], [0.134], [0.1526]], [[0.5952], [0.5307], [0.736]]]]]], 4, Con66694), 
LMin72553 = minimum_layer([[[[[[0.4778, 0.0785], [0.5938, 0.0954]]]]], [[[[[0.6381, 0.3321], [0.0165, 0.5106]]]]]], Min72553), 
LELU37058 = elu_layer(Min72553, -5.841114606818147, ELU37058), 
LZer36588 = zero_padding3D_layer(ELU37058, 0, 0, 1, 0, 1, 0, Zer36588), 
LMin93824 = minimum_layer([Con66694,Zer36588], Min93824), 
LAve7061 = average_layer([Con69383,Min93824], Ave7061), 
exec_layers([LCon53055,LRes55942,LCro53212,LRes58770,LZer19282,LCon69383,LAve15366,LRes33119,LRes64675,LZer94937,LCon66694,LMin72553,LELU37058,LZer36588,LMin93824,LAve7061],["Con53055","Res55942","Cro53212","Res58770","Zer19282","Con69383","Ave15366","Res33119","Res64675","Zer94937","Con66694","Min72553","ELU37058","Zer36588","Min93824","Ave7061"],Ave7061,"Ave7061")

Actual (Unparsed): [[[[[0.0000000, 0.3229500], [0.0000000, 0.2527500], [0.0000000, 0.1928000]], [[0.0000000, 0.2860000], [0.0681367, 0.1640000], [0.0512837, 0.2949500]]]]]

Expected (Unparsed): [[[[[0,0.32295],[0,0.25275],[0,0.1928]],[[0,0.286],[0.06813666,0.164],[0.051283680000000005,0.29495]]]]]

Actual:   [[[[[0, 0.323], [0, 0.2528], [0, 0.1928]], [[0, 0.286], [0.0682, 0.164], [0.0513, 0.295]]]]]

Expected: [[[[[0, 0.323], [0, 0.2528], [0, 0.1928]], [[0, 0.286], [0.0682, 0.164], [0.0513, 0.295]]]]]