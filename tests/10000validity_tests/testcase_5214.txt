import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max87121 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Max87121 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Ave83706 = tf.keras.layers.Input(shape=([1, 2]))
in0Con94757 = tf.keras.layers.Input(shape=([6]))

Max87121 = keras.layers.Maximum(name = 'Max87121', )([in0Max87121,in1Max87121])
Res32678 = keras.layers.Reshape((2, 2, 2), name = 'Res32678', )(Max87121)
Res58425 = keras.layers.Reshape((2, 4), name = 'Res58425', )(Res32678)
Fla22114 = keras.layers.Flatten(name = 'Fla22114', )(Res58425)
Ave83706 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='same', name = 'Ave83706', )(in0Ave83706)
Glo11925 = keras.layers.GlobalMaxPool1D(name = 'Glo11925', )(Ave83706)
Con94757 = keras.layers.Concatenate(axis=1, name = 'Con94757', )([Glo11925,in0Con94757])
Ave90672 = keras.layers.Average(name = 'Ave90672', )([Fla22114,Con94757])
Res83183 = keras.layers.Reshape((8, 1), name = 'Res83183', )(Ave90672)
Res9405 = keras.layers.Reshape((8, 1, 1), name = 'Res9405', )(Res83183)
Zer42501 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer42501', )(Res9405)
model = tf.keras.models.Model(inputs=[in0Max87121,in1Max87121,in0Ave83706,in0Con94757], outputs=Zer42501)
in0Max87121 = tf.constant([[[[[0.5056], [0.9306]], [[0.0431], [0.6734]]], [[[0.4378], [0.14]], [[0.0038], [0.6784]]]]])
in1Max87121 = tf.constant([[[[[0.2425], [0.6032]], [[0.264], [0.9927]]], [[[0.0915], [0.1239]], [[0.6204], [0.3271]]]]])
in0Ave83706 = tf.constant([[[1.4644, 1.5782]]])
in0Con94757 = tf.constant([[0.8945, 0.9667, 0.9382, 0.4964, 0.9168, 0.4636]])
print (np.array2string(model.predict([in0Max87121,in1Max87121,in0Ave83706,in0Con94757],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer42501.png')

LMax87121 = maximum_layer([[[[[[0.5056], [0.9306]], [[0.0431], [0.6734]]], [[[0.4378], [0.14]], [[0.0038], [0.6784]]]]], [[[[[0.2425], [0.6032]], [[0.264], [0.9927]]], [[[0.0915], [0.1239]], [[0.6204], [0.3271]]]]]], Max87121), 
LRes32678 = reshape_layer(Max87121, [2, 2, 2], Res32678), 
LRes58425 = reshape_layer(Res32678, [2, 4], Res58425), 
LFla22114 = flatten_layer(Res58425, Fla22114), 
LAve83706 = average_pooling1D_layer([[[1.4644, 1.5782]]], 1, 1, true, Ave83706), 
LGlo11925 = global_max_pool1D_layer(Ave83706, Glo11925), 
LCon94757 = concatenate_layer([Glo11925,[[0.8945, 0.9667, 0.9382, 0.4964, 0.9168, 0.4636]]], 1, Con94757), 
LAve90672 = average_layer([Fla22114,Con94757], Ave90672), 
LRes83183 = reshape_layer(Ave90672, [8, 1], Res83183), 
LRes9405 = reshape_layer(Res83183, [8, 1, 1], Res9405), 
LZer42501 = zero_padding2D_layer(Res9405, 1, 1, 1, 1, Zer42501), 
exec_layers([LMax87121,LRes32678,LRes58425,LFla22114,LAve83706,LGlo11925,LCon94757,LAve90672,LRes83183,LRes9405,LZer42501],["Max87121","Res32678","Res58425","Fla22114","Ave83706","Glo11925","Con94757","Ave90672","Res83183","Res9405","Zer42501"],Zer42501,"Zer42501")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.9850000], [0.0000000]], [[0.0000000], [1.2544000], [0.0000000]], [[0.0000000], [0.5792500], [0.0000000]], [[0.0000000], [0.9797000], [0.0000000]], [[0.0000000], [0.6880000], [0.0000000]], [[0.0000000], [0.3182000], [0.0000000]], [[0.0000000], [0.7686000], [0.0000000]], [[0.0000000], [0.5710000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[0.985],[0]],[[0],[1.2544],[0]],[[0],[0.57925],[0]],[[0],[0.9797],[0]],[[0],[0.6880000000000001],[0]],[[0],[0.31820000000000004],[0]],[[0],[0.7686],[0]],[[0],[0.571],[0]],[[0],[0],[0]]]]

Actual:   [[[[0], [0], [0]], [[0], [0.985], [0]], [[0], [1.2544], [0]], [[0], [0.5793], [0]], [[0], [0.9797], [0]], [[0], [0.688], [0]], [[0], [0.3182], [0]], [[0], [0.7686], [0]], [[0], [0.571], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [0.985], [0]], [[0], [1.2544], [0]], [[0], [0.5793], [0]], [[0], [0.9797], [0]], [[0], [0.6881], [0]], [[0], [0.3183], [0]], [[0], [0.7686], [0]], [[0], [0.571], [0]], [[0], [0], [0]]]]