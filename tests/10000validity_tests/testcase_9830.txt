import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add67320 = tf.keras.layers.Input(shape=([1, 2]))
in1Add67320 = tf.keras.layers.Input(shape=([1, 2]))

Add67320 = keras.layers.Add(name = 'Add67320', )([in0Add67320,in1Add67320])
Up_87299 = keras.layers.UpSampling1D(size=(2), name = 'Up_87299', )(Add67320)
Ave64755 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='same', name = 'Ave64755', )(Up_87299)
Res39143 = keras.layers.Reshape((2, 2, 1), name = 'Res39143', )(Ave64755)
Loc67795 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc67795', )(Res39143)
model = tf.keras.models.Model(inputs=[in0Add67320,in1Add67320], outputs=Loc67795)
w = model.get_layer('Loc67795').get_weights() 
w[0] = np.array([[[0.632, 0.9455, 0.8485, 0.7499]], [[0.2706, 0.0301, 0.8373, 0.0577]], [[0.2469, 0.0533, 0.5979, 0.7557]], [[0.7258, 0.942, 0.5415, 0.2362]]])
w[1] = np.array([[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0]]])
model.get_layer('Loc67795').set_weights(w) 
in0Add67320 = tf.constant([[[0.2076, 0.4083]]])
in1Add67320 = tf.constant([[[0.3928, 0.733]]])
print (np.array2string(model.predict([in0Add67320,in1Add67320],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc67795.png')

LAdd67320 = add_layer([[[[0.2076, 0.4083]]], [[[0.3928, 0.733]]]], Add67320), 
LUp_87299 = up_sampling1D_layer(Add67320, 2, Up_87299), 
LAve64755 = average_pooling1D_layer(Up_87299, 1, 1, true, Ave64755), 
LRes39143 = reshape_layer(Ave64755, [2, 2, 1], Res39143), 
LLoc67795 = locally_connected2D_layer(Res39143, 1, 1,[[[0.632, 0.9455, 0.8485, 0.7499]], [[0.2706, 0.0301, 0.8373, 0.0577]], [[0.2469, 0.0533, 0.5979, 0.7557]], [[0.7258, 0.942, 0.5415, 0.2362]]],[[[0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0]]], 1, 1, Loc67795), 
exec_layers([LAdd67320,LUp_87299,LAve64755,LRes39143,LLoc67795],["Add67320","Up_87299","Ave64755","Res39143","Loc67795"],Loc67795,"Loc67795")

Actual (Unparsed): [[[[0.3794528, 0.5676782, 0.5094394, 0.4502400], [0.3088358, 0.0343531, 0.9556105, 0.0658530]], [[0.1482388, 0.0320013, 0.3589792, 0.4537223], [0.8283555, 1.0751046, 0.6180139, 0.2695751]]]]

Expected (Unparsed): [[[[0.37945280000000003,0.5676782,0.5094394000000001,0.45023996000000005],[0.30883578,0.034353129999999996,0.9556104900000001,0.06585301]],[[0.14823876000000002,0.03200132,0.35897916,0.45372228000000003],[0.82835554,1.0751046,0.6180139499999999,0.26957506]]]]

Actual:   [[[[0.3795, 0.5677, 0.5095, 0.4503], [0.3089, 0.0344, 0.9557, 0.0659]], [[0.1483, 0.0321, 0.359, 0.4538], [0.8284, 1.0752, 0.6181, 0.2696]]]]

Expected: [[[[0.3795, 0.5677, 0.5095, 0.4503], [0.3089, 0.0344, 0.9557, 0.0659]], [[0.1483, 0.0321, 0.359, 0.4538], [0.8284, 1.0752, 0.6181, 0.2696]]]]