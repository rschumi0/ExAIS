import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr18920 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Dot30775 = tf.keras.layers.Input(shape=([3]))
in1Dot30775 = tf.keras.layers.Input(shape=([3]))
in0Con74941 = tf.keras.layers.Input(shape=([3]))
in0Add55676 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Add55676 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Thr18920 = keras.layers.ThresholdedReLU(theta=0.2216869426425621, name = 'Thr18920', input_shape=(2, 1, 1, 2))(in0Thr18920)
Res50264 = keras.layers.Reshape((2, 1, 2), name = 'Res50264', )(Thr18920)
Res12271 = keras.layers.Reshape((2, 2), name = 'Res12271', )(Res50264)
Fla97939 = keras.layers.Flatten(name = 'Fla97939', )(Res12271)
Dot30775 = keras.layers.Dot(axes=(1, 1), name = 'Dot30775', )([in0Dot30775,in1Dot30775])
Con74941 = keras.layers.Concatenate(axis=1, name = 'Con74941', )([Dot30775,in0Con74941])
Add27280 = keras.layers.Add(name = 'Add27280', )([Fla97939,Con74941])
Res8462 = keras.layers.Reshape((4, 1), name = 'Res8462', )(Add27280)
Add55676 = keras.layers.Add(name = 'Add55676', )([in0Add55676,in1Add55676])
Res4700 = keras.layers.Reshape((4, 1), name = 'Res4700', )(Add55676)
Min97246 = keras.layers.Minimum(name = 'Min97246', )([Res8462,Res4700])
model = tf.keras.models.Model(inputs=[in0Thr18920,in0Dot30775,in1Dot30775,in0Con74941,in0Add55676,in1Add55676], outputs=Min97246)
in0Thr18920 = tf.constant([[[[[0.448, 0.5498]]], [[[0.4668, 0.0833]]]]])
in0Dot30775 = tf.constant([[0.5666, 0.6191, 0.2969]])
in1Dot30775 = tf.constant([[0.1549, 0.2411, 0.2809]])
in0Con74941 = tf.constant([[0.1939, 0.7091, 0.3531]])
in0Add55676 = tf.constant([[[[[0.6796, 0.7415], [0.774, 0.8983]]]]])
in1Add55676 = tf.constant([[[[[0.1118, 0.5637], [0.5027, 0.9637]]]]])
print (np.array2string(model.predict([in0Thr18920,in0Dot30775,in1Dot30775,in0Con74941,in0Add55676,in1Add55676],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min97246.png')

LThr18920 = thresholded_relu_layer([[[[[0.448, 0.5498]]], [[[0.4668, 0.0833]]]]], 0.2216869426425621, Thr18920), 
LRes50264 = reshape_layer(Thr18920, [2, 1, 2], Res50264), 
LRes12271 = reshape_layer(Res50264, [2, 2], Res12271), 
LFla97939 = flatten_layer(Res12271, Fla97939), 
LDot30775 = dot_layer([[0.5666, 0.6191, 0.2969]], [[0.1549, 0.2411, 0.2809]], 1, 1, Dot30775), 
LCon74941 = concatenate_layer([Dot30775,[[0.1939, 0.7091, 0.3531]]], 1, Con74941), 
LAdd27280 = add_layer([Fla97939,Con74941], Add27280), 
LRes8462 = reshape_layer(Add27280, [4, 1], Res8462), 
LAdd55676 = add_layer([[[[[[0.6796, 0.7415], [0.774, 0.8983]]]]], [[[[[0.1118, 0.5637], [0.5027, 0.9637]]]]]], Add55676), 
LRes4700 = reshape_layer(Add55676, [4, 1], Res4700), 
LMin97246 = minimum_layer([Res8462,Res4700], Min97246), 
exec_layers([LThr18920,LRes50264,LRes12271,LFla97939,LDot30775,LCon74941,LAdd27280,LRes8462,LAdd55676,LRes4700,LMin97246],["Thr18920","Res50264","Res12271","Fla97939","Dot30775","Con74941","Add27280","Res8462","Add55676","Res4700","Min97246"],Min97246,"Min97246")

Actual (Unparsed): [[[0.7684306], [0.7437000], [1.1759000], [0.3531000]]]

Expected (Unparsed): [[[0.76843056],[0.7436999999999999],[1.1759],[0.3531]]]

Actual:   [[[0.7685], [0.7437], [1.1759], [0.3531]]]

Expected: [[[0.7685], [0.7437], [1.1759], [0.3531]]]