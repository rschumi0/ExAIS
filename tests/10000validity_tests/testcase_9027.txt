import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas55404 = tf.keras.layers.Input(shape=([4, 4, 3]))

Mas55404 = keras.layers.Masking(mask_value=2, name = 'Mas55404', )(in0Mas55404)
Res63404 = keras.layers.Reshape((4, 12), name = 'Res63404', )(Mas55404)
PRe36626 = keras.layers.PReLU(name = 'PRe36626', )(Res63404)
model = tf.keras.models.Model(inputs=[in0Mas55404], outputs=PRe36626)
w = model.get_layer('PRe36626').get_weights() 
w[0] = np.array([[0.5455, 0.9487, 0.3313, 0.0993, 0.4566, 0.1921, 0.024, 0.4567, 0.9387, 0.9543, 0.1868, 0.2524], [0.3614, 0.5176, 0.2743, 0.4306, 0.2128, 0.7213, 0.7519, 0.0218, 0.1058, 0.4615, 0.6494, 0.1288], [0.2165, 0.4173, 0.0865, 0.9182, 0.628, 0.0372, 0.5183, 0.8722, 0.393, 0.1101, 0.9947, 0.1671], [0.1256, 0.4324, 0.4254, 0.0657, 0.5871, 0.1853, 0.7005, 0.6384, 0.0385, 0.64, 0.5275, 0.9603]])
model.get_layer('PRe36626').set_weights(w) 
in0Mas55404 = tf.constant([[[[1.1799, 1.1351, 1.5686], [1.4615, 1.5532, 1.728], [1.3264, 1.0872, 1.7785], [1.6189, 1.4071, 1.2553]], [[1.3492, 1.5948, 1.0037], [1.452, 1.0829, 1.1499], [1.2305, 1.5486, 1.1045], [1.4158, 1.917, 1.221]], [[1.2879, 1.7352, 1.1749], [1.8369, 1.9397, 1.7759], [1.9763, 1.3815, 1.0151], [1.5949, 1.3089, 1.4571]], [[1.5668, 1.7286, 1.2208], [1.5158, 1.4442, 1.2129], [1.2053, 1.2614, 1.4846], [1.4187, 1.9337, 1.592]]]])
print (np.array2string(model.predict([in0Mas55404],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe36626.png')

LMas55404 = masking_layer([[[[1.1799, 1.1351, 1.5686], [1.4615, 1.5532, 1.728], [1.3264, 1.0872, 1.7785], [1.6189, 1.4071, 1.2553]], [[1.3492, 1.5948, 1.0037], [1.452, 1.0829, 1.1499], [1.2305, 1.5486, 1.1045], [1.4158, 1.917, 1.221]], [[1.2879, 1.7352, 1.1749], [1.8369, 1.9397, 1.7759], [1.9763, 1.3815, 1.0151], [1.5949, 1.3089, 1.4571]], [[1.5668, 1.7286, 1.2208], [1.5158, 1.4442, 1.2129], [1.2053, 1.2614, 1.4846], [1.4187, 1.9337, 1.592]]]], 2, Mas55404), 
LRes63404 = reshape_layer(Mas55404, [4, 12], Res63404), 
LPRe36626 = prelu_layer(Res63404, [[0.5455, 0.9487, 0.3313, 0.0993, 0.4566, 0.1921, 0.024, 0.4567, 0.9387, 0.9543, 0.1868, 0.2524], [0.3614, 0.5176, 0.2743, 0.4306, 0.2128, 0.7213, 0.7519, 0.0218, 0.1058, 0.4615, 0.6494, 0.1288], [0.2165, 0.4173, 0.0865, 0.9182, 0.628, 0.0372, 0.5183, 0.8722, 0.393, 0.1101, 0.9947, 0.1671], [0.1256, 0.4324, 0.4254, 0.0657, 0.5871, 0.1853, 0.7005, 0.6384, 0.0385, 0.64, 0.5275, 0.9603]], PRe36626), 
exec_layers([LMas55404,LRes63404,LPRe36626],["Mas55404","Res63404","PRe36626"],PRe36626,"PRe36626")

Actual (Unparsed): [[[1.1799001, 1.1351000, 1.5686001, 1.4615000, 1.5532000, 1.7280000, 1.3264000, 1.0872000, 1.7785000, 1.6188999, 1.4071000, 1.2553000], [1.3492000, 1.5948000, 1.0037000, 1.4520000, 1.0829000, 1.1499000, 1.2305000, 1.5486000, 1.1045001, 1.4158000, 1.9170001, 1.2210000], [1.2879000, 1.7352000, 1.1749001, 1.8369000, 1.9397000, 1.7759000, 1.9763000, 1.3815000, 1.0151000, 1.5949000, 1.3089000, 1.4571000], [1.5668000, 1.7286000, 1.2208000, 1.5158000, 1.4442000, 1.2129000, 1.2053000, 1.2614000, 1.4845999, 1.4187000, 1.9337000, 1.5920000]]]

Expected (Unparsed): [[[1.1799,1.1351,1.5686,1.4615,1.5532,1.728,1.3264,1.0872,1.7785,1.6189,1.4071,1.2553],[1.3492,1.5948,1.0037,1.452,1.0829,1.1499,1.2305,1.5486,1.1045,1.4158,1.917,1.221],[1.2879,1.7352,1.1749,1.8369,1.9397,1.7759,1.9763,1.3815,1.0151,1.5949,1.3089,1.4571],[1.5668,1.7286,1.2208,1.5158,1.4442,1.2129,1.2053,1.2614,1.4846,1.4187,1.9337,1.592]]]

Actual:   [[[1.18, 1.1351, 1.5687, 1.4615, 1.5532, 1.728, 1.3264, 1.0872, 1.7785, 1.6189, 1.4071, 1.2553], [1.3492, 1.5948, 1.0037, 1.452, 1.0829, 1.1499, 1.2305, 1.5486, 1.1046, 1.4158, 1.9171, 1.221], [1.2879, 1.7352, 1.175, 1.8369, 1.9397, 1.7759, 1.9763, 1.3815, 1.0151, 1.5949, 1.3089, 1.4571], [1.5668, 1.7286, 1.2208, 1.5158, 1.4442, 1.2129, 1.2053, 1.2614, 1.4846, 1.4187, 1.9337, 1.592]]]

Expected: [[[1.1799, 1.1351, 1.5686, 1.4615, 1.5532, 1.728, 1.3264, 1.0872, 1.7785, 1.6189, 1.4071, 1.2553], [1.3492, 1.5948, 1.0037, 1.452, 1.0829, 1.1499, 1.2305, 1.5486, 1.1045, 1.4158, 1.917, 1.221], [1.2879, 1.7352, 1.1749, 1.8369, 1.9397, 1.7759, 1.9763, 1.3815, 1.0151, 1.5949, 1.3089, 1.4571], [1.5668, 1.7286, 1.2208, 1.5158, 1.4442, 1.2129, 1.2053, 1.2614, 1.4846, 1.4187, 1.9337, 1.592]]]