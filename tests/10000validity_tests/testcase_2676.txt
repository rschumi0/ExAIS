import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL45879 = tf.keras.layers.Input(shape=([2, 1]))
in0Lay28994 = tf.keras.layers.Input(shape=([2, 4, 1]))

ReL45879 = keras.layers.ReLU(max_value=5.006384572502547, negative_slope=6.200234190368673, threshold=5.611484067999467, name = 'ReL45879', input_shape=(2, 1))(in0ReL45879)
Res85034 = keras.layers.Reshape((2, 1, 1), name = 'Res85034', )(ReL45879)
Zer65255 = keras.layers.ZeroPadding2D(padding=((0, 0), (3, 0)), name = 'Zer65255', )(Res85034)
Lay28994 = keras.layers.LayerNormalization(axis=2, epsilon=1.5398155382708685, name = 'Lay28994', )(in0Lay28994)
Sub36970 = keras.layers.Subtract(name = 'Sub36970', )([Zer65255,Lay28994])
Loc86025 = keras.layers.LocallyConnected2D(3, (1, 3),strides=(1, 1), name = 'Loc86025', )(Sub36970)
model = tf.keras.models.Model(inputs=[in0ReL45879,in0Lay28994], outputs=Loc86025)
w = model.get_layer('Loc86025').get_weights() 
w[0] = np.array([[[0.5697, 0.3959, 0.5959], [0.5353, 0.4741, 0.0735], [0.3076, 0.2948, 0.9808]], [[0.9996, 0.494, 0.6884], [0.3917, 0.2766, 0.0982], [0.9108, 0.76, 0.9028]], [[0.1536, 0.1583, 0.5357], [0.233, 0.8063, 0.0275], [0.7449, 0.3914, 0.2045]], [[0.5542, 0.2644, 0.3828], [0.3288, 0.2587, 0.7812], [0.7117, 0.9991, 0.3965]]])
w[1] = np.array([[[0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0]]])
model.get_layer('Loc86025').set_weights(w) 
in0ReL45879 = tf.constant([[[0.9529], [0.4307]]])
in0Lay28994 = tf.constant([[[[1.5875], [1.4234], [1.1147], [1.3943]], [[1.299], [1.7734], [1.4243], [1.5284]]]])
print (np.array2string(model.predict([in0ReL45879,in0Lay28994],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc86025.png')

LReL45879 = relu_layer([[[0.9529], [0.4307]]], 5.006384572502547, 6.200234190368673, 5.611484067999467, ReL45879), 
LRes85034 = reshape_layer(ReL45879, [2, 1, 1], Res85034), 
LZer65255 = zero_padding2D_layer(Res85034, 0, 0, 3, 0, Zer65255), 
LLay28994 = layer_normalization_layer([[[[1.5875], [1.4234], [1.1147], [1.3943]], [[1.299], [1.7734], [1.4243], [1.5284]]]], 2, 1.5398155382708685, Lay28994), 
LSub36970 = subtract_layer(Zer65255,Lay28994, Sub36970), 
LLoc86025 = locally_connected2D_layer(Sub36970, 1, 3,[[[0.5697, 0.3959, 0.5959], [0.5353, 0.4741, 0.0735], [0.3076, 0.2948, 0.9808]], [[0.9996, 0.494, 0.6884], [0.3917, 0.2766, 0.0982], [0.9108, 0.76, 0.9028]], [[0.1536, 0.1583, 0.5357], [0.233, 0.8063, 0.0275], [0.7449, 0.3914, 0.2045]], [[0.5542, 0.2644, 0.3828], [0.3288, 0.2587, 0.7812], [0.7117, 0.9991, 0.3965]]],[[[0, 0, 0], [0, 0, 0]], [[0, 0, 0], [0, 0, 0]]], 1, 1, Loc86025), 
exec_layers([LReL45879,LRes85034,LZer65255,LLay28994,LSub36970,LLoc86025],["ReL45879","Res85034","Zer65255","Lay28994","Sub36970","Loc86025"],Loc86025,"Loc86025")

Actual (Unparsed): [[[[-0.0478043, -0.0195963, 0.1064498], [-26.2699440, -21.9193134, -26.0901517]], [[0.0244682, -0.1200935, 0.0961276], [-22.9704787, -32.1502450, -12.7739016]]]]

Expected (Unparsed): [[[[-0.04780433021223528,-0.01959627029159361,0.1064497611628665],[-26.26994393138496,-21.919313307638788,-26.090151631229425]],[[0.024468197473486525,-0.12009353852885679,0.09612764129903942],[-22.970478706703958,-32.150245019438465,-12.773901602760088]]]]

Actual:   [[[[-0.0478, -0.0195, 0.1065], [-26.2699, -21.9193, -26.0901]], [[0.0245, -0.12, 0.0962], [-22.9704, -32.1502, -12.7739]]]]

Expected: [[[[-0.0478, -0.0195, 0.1065], [-26.2699, -21.9193, -26.0901]], [[0.0245, -0.12, 0.0962], [-22.9704, -32.1502, -12.7739]]]]