import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST17419 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave63899 = tf.keras.layers.Input(shape=([2, 2, 1]))

LST17419 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST17419', )(in0LST17419)
Res54963 = keras.layers.Reshape((1, 1), name = 'Res54963', )(LST17419)
Res19248 = keras.layers.Reshape((1, 1, 1), name = 'Res19248', )(Res54963)
Glo95315 = keras.layers.GlobalAveragePooling2D(name = 'Glo95315', )(Res19248)
Lea99348 = keras.layers.LeakyReLU(alpha=1.0756195994854056, name = 'Lea99348', )(Glo95315)
Res58380 = keras.layers.Reshape((1, 1), name = 'Res58380', )(Lea99348)
Ave63899 = keras.layers.AveragePooling2D(pool_size=(2, 2), name = 'Ave63899', )(in0Ave63899)
Res55246 = keras.layers.Reshape((1, 1), name = 'Res55246', )(Ave63899)
Ave94877 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='valid', name = 'Ave94877', )(Res55246)
Min33963 = keras.layers.Minimum(name = 'Min33963', )([Res58380,Ave94877])
model = tf.keras.models.Model(inputs=[in0LST17419,in0Ave63899], outputs=Min33963)
w = model.get_layer('LST17419').get_weights() 
w[0] = np.array([[5, 4, 4, 3]])
w[1] = np.array([[9, 10, 4, 6]])
w[2] = np.array([9, 2, 4, 4])
model.get_layer('LST17419').set_weights(w) 
in0LST17419 = tf.constant([[[5], [2]]])
in0Ave63899 = tf.constant([[[[1.6916], [1.4925]], [[1.9128], [1.8063]]]])
print (np.array2string(model.predict([in0LST17419,in0Ave63899],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min33963.png')

LLST17419 = lstm_layer([[[5], [2]]],[[5, 4, 4, 3]],[[9, 10, 4, 6]],[9, 2, 4, 4], LST17419), 
LRes54963 = reshape_layer(LST17419, [1, 1], Res54963), 
LRes19248 = reshape_layer(Res54963, [1, 1, 1], Res19248), 
LGlo95315 = global_average_pooling2D_layer(Res19248, Glo95315), 
LLea99348 = leaky_relu_layer(Glo95315, 1.0756195994854056, Lea99348), 
LRes58380 = reshape_layer(Lea99348, [1, 1], Res58380), 
LAve63899 = average_pooling2D_layer([[[[1.6916], [1.4925]], [[1.9128], [1.8063]]]], 2, 2, Ave63899), 
LRes55246 = reshape_layer(Ave63899, [1, 1], Res55246), 
LAve94877 = average_pooling1D_layer(Res55246, 1, 1, false, Ave94877), 
LMin33963 = minimum_layer([Res58380,Ave94877], Min33963), 
exec_layers([LLST17419,LRes54963,LRes19248,LGlo95315,LLea99348,LRes58380,LAve63899,LRes55246,LAve94877,LMin33963],["LST17419","Res54963","Res19248","Glo95315","Lea99348","Res58380","Ave63899","Res55246","Ave94877","Min33963"],Min33963,"Min33963")

Actual (Unparsed): [[[0.9640271]]]

Expected (Unparsed): [[[0.9640271249638946]]]

Actual:   [[[0.9641]]]

Expected: [[[0.9641]]]