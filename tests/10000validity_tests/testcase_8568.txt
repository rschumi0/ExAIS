import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max83794 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Max83794 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Min88016 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min88016 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con36492 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max83794 = keras.layers.Maximum(name = 'Max83794', )([in0Max83794,in1Max83794])
Res57101 = keras.layers.Reshape((2, 1, 2), name = 'Res57101', )(Max83794)
Min88016 = keras.layers.Minimum(name = 'Min88016', )([in0Min88016,in1Min88016])
Con36492 = keras.layers.Concatenate(axis=3, name = 'Con36492', )([Min88016,in0Con36492])
Sub50709 = keras.layers.Subtract(name = 'Sub50709', )([Res57101,Con36492])
Res11940 = keras.layers.Reshape((2, 2), name = 'Res11940', )(Sub50709)
Sep4152 = keras.layers.SeparableConv1D(2, (2),strides=(1), padding='same', name = 'Sep4152', )(Res11940)
model = tf.keras.models.Model(inputs=[in0Max83794,in1Max83794,in0Min88016,in1Min88016,in0Con36492], outputs=Sep4152)
w = model.get_layer('Sep4152').get_weights() 
w[0] = np.array([[[0.1038], [0.0485]], [[0.6541], [0.6032]]])
w[1] = np.array([[[0.7572, 0.9178], [0.5103, 0.1526]]])
w[2] = np.array([0, 0])
model.get_layer('Sep4152').set_weights(w) 
in0Max83794 = tf.constant([[[[[0.0923, 0.8216]]], [[[0.2525, 0.6606]]]]])
in1Max83794 = tf.constant([[[[[0.91, 0.2008]]], [[[0.4695, 0.3215]]]]])
in0Min88016 = tf.constant([[[[0.9677]], [[0.5995]]]])
in1Min88016 = tf.constant([[[[0.4207]], [[0.9557]]]])
in0Con36492 = tf.constant([[[[0.094]], [[0.526]]]])
print (np.array2string(model.predict([in0Max83794,in1Max83794,in0Min88016,in1Min88016,in0Con36492],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep4152.png')

LMax83794 = maximum_layer([[[[[[0.0923, 0.8216]]], [[[0.2525, 0.6606]]]]], [[[[[0.91, 0.2008]]], [[[0.4695, 0.3215]]]]]], Max83794), 
LRes57101 = reshape_layer(Max83794, [2, 1, 2], Res57101), 
LMin88016 = minimum_layer([[[[[0.9677]], [[0.5995]]]], [[[[0.4207]], [[0.9557]]]]], Min88016), 
LCon36492 = concatenate_layer([Min88016,[[[[0.094]], [[0.526]]]]], 3, Con36492), 
LSub50709 = subtract_layer(Res57101,Con36492, Sub50709), 
LRes11940 = reshape_layer(Sub50709, [2, 2], Res11940), 
LSep4152 = separable_conv1D_layer(Res11940, 2,[[[[0.1038], [0.0485]], [[0.6541], [0.6032]]],[[[0.7572, 0.9178], [0.5103, 0.1526]]]],[0, 0], 1, true, Sep4152), 
exec_layers([LMax83794,LRes57101,LMin88016,LCon36492,LSub50709,LRes11940,LSep4152],["Max83794","Res57101","Min88016","Con36492","Sub50709","Res11940","Sep4152"],Sep4152,"Sep4152")

Actual (Unparsed): [[[0.0335101, -0.0136541], [-0.0068864, -0.0113886]]]

Expected (Unparsed): [[[0.03351009764399995,-0.013654086916000034],[-0.0068863673700000055,-0.011388605140000004]]]

Actual:   [[[0.0336, -0.0136], [-0.0068, -0.0113]]]

Expected: [[[0.0336, -0.0136], [-0.0068, -0.0113]]]