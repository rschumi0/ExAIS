import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot23755 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot23755 = tf.keras.layers.Input(shape=([3, 3]))

Dot23755 = keras.layers.Dot(axes=(1, 1), name = 'Dot23755', )([in0Dot23755,in1Dot23755])
Res56177 = keras.layers.Reshape((3, 3, 1), name = 'Res56177', )(Dot23755)
Loc30526 = keras.layers.LocallyConnected2D(4, (2, 1),strides=(3, 1), name = 'Loc30526', )(Res56177)
Res56041 = keras.layers.Reshape((1, 3, 4, 1), name = 'Res56041', )(Loc30526)
Con66041 = keras.layers.Conv3DTranspose(4, (1, 1, 4),strides=(1, 1, 1), padding='valid', name = 'Con66041', )(Res56041)
model = tf.keras.models.Model(inputs=[in0Dot23755,in1Dot23755], outputs=Con66041)
w = model.get_layer('Loc30526').get_weights() 
w[0] = np.array([[[0.8176, 0.0444, 0.8665, 0.5201], [0.0711, 0.8507, 0.57, 0.0581]], [[0.5699, 0.6229, 0.2026, 0.7101], [0.6133, 0.89, 0.6424, 0.1702]], [[0.8381, 0.3557, 0.7875, 0.0789], [0.8783, 0.707, 0.5053, 0.6846]]])
w[1] = np.array([[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]])
model.get_layer('Loc30526').set_weights(w) 
w = model.get_layer('Con66041').get_weights() 
w[0] = np.array([[[[[0.0365], [0.421], [0.281], [0.2631]], [[0.8707], [0.5193], [0.1504], [0.2982]], [[0.5503], [0.7152], [0.2466], [0.9317]], [[0.589], [0.561], [0.7828], [0.1046]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con66041').set_weights(w) 
in0Dot23755 = tf.constant([[[0.5113, 0.1976, 0.4362], [0.3082, 0.0527, 0.5176], [0.9579, 0.7354, 0.4715]]])
in1Dot23755 = tf.constant([[[0.8319, 0.7539, 0.3268], [0.2016, 0.9079, 0.4836], [0.9223, 0.3466, 0.1695]]])
print (np.array2string(model.predict([in0Dot23755,in1Dot23755],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con66041.png')

LDot23755 = dot_layer([[[0.5113, 0.1976, 0.4362], [0.3082, 0.0527, 0.5176], [0.9579, 0.7354, 0.4715]]], [[[0.8319, 0.7539, 0.3268], [0.2016, 0.9079, 0.4836], [0.9223, 0.3466, 0.1695]]], 1, 1, Dot23755), 
LRes56177 = reshape_layer(Dot23755, [3, 3, 1], Res56177), 
LLoc30526 = locally_connected2D_layer(Res56177, 2, 1,[[[0.8176, 0.0444, 0.8665, 0.5201], [0.0711, 0.8507, 0.57, 0.0581]], [[0.5699, 0.6229, 0.2026, 0.7101], [0.6133, 0.89, 0.6424, 0.1702]], [[0.8381, 0.3557, 0.7875, 0.0789], [0.8783, 0.707, 0.5053, 0.6846]]],[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]], 3, 1, Loc30526), 
LRes56041 = reshape_layer(Loc30526, [1, 3, 4, 1], Res56041), 
LCon66041 = conv3D_transpose_layer(Res56041, 1, 1, 4,[[[[[0.0365], [0.421], [0.281], [0.2631]], [[0.8707], [0.5193], [0.1504], [0.2982]], [[0.5503], [0.7152], [0.2466], [0.9317]], [[0.589], [0.561], [0.7828], [0.1046]]]]],[0, 0, 0, 0], 1, 1, 1, false, Con66041), 
exec_layers([LDot23755,LRes56177,LLoc30526,LRes56041,LCon66041],["Dot23755","Res56177","Loc30526","Res56041","Con66041"],Con66041,"Con66041")

Actual (Unparsed): [[[[[0.0431269, 0.4974367, 0.3320183, 0.3108684], [1.0575004, 0.9448036, 0.3987819, 0.5593337], [1.3963429, 1.9584862, 0.8801759, 1.7759736], [2.6145280, 2.4160543, 1.5850432, 1.5565182], [2.0487601, 2.0348419, 1.1434412, 1.8696436], [1.4058229, 1.4846968, 1.4986970, 0.8856535], [0.4491763, 0.4278233, 0.5969698, 0.0797688]], [[0.0308567, 0.3559085, 0.2375541, 0.2224217], [0.7734276, 0.8697909, 0.4146746, 0.5213072], [1.3741117, 1.3432140, 0.5006829, 1.2222813], [1.5182556, 1.7922015, 1.2087313, 1.3951039], [1.5571062, 1.3337548, 1.0404421, 0.7997428], [0.7219393, 0.8376129, 0.5789110, 0.7829251], [0.4623989, 0.4404173, 0.6145430, 0.0821170]], [[0.0215209, 0.2482276, 0.1656816, 0.1551275], [0.5251302, 0.4417505, 0.1791612, 0.2605423], [0.6225479, 0.7932264, 0.3302017, 0.7730515], [0.9537883, 0.8908728, 0.6658610, 0.5550125], [0.6175871, 0.6236797, 0.3995294, 0.5409403], [0.3875157, 0.4043914, 0.4254624, 0.2228912], [0.1088151, 0.1036422, 0.1446188, 0.0193244]]]]]

Expected (Unparsed): [[[[[0.043126936652001,0.497436721383354,0.33201833422499405,0.3108684118668894],[1.057500396654177,0.9448036133234583,0.39878189376937967,0.5593337166257539],[1.3963428512751512,1.9584862346539458,0.8801758688897565,1.7759735675354538],[2.614527946912536,2.416054291679954,1.5850432246079393,1.5565181950017628],[2.0487601187928357,2.0348418535650943,1.1434411637107935,1.8696435986694389],[1.4058229138973104,1.484696789460617,1.4986970366466565,0.8856534548729817],[0.449176343968226,0.42782330894087406,0.5969698506932553,0.0797688379950364]],[[0.030856675469011,0.355908503354894,0.23755413169293405,0.2224216798875834],[0.7734276232171813,0.8697908787502613,0.41467462053505666,0.5213071675391949],[1.374111687578091,1.3432140268067012,0.5006828531909688,1.222281248249934],[1.5182555968567206,1.7922014933186077,1.208731245206184,1.395103862259542],[1.557106151030605,1.333754790250024,1.040442055091908,0.7997427551217333],[0.7219392517136682,0.8376128595016571,0.578911011851305,0.7829250950722505],[0.46239887169426896,0.44041726149488103,0.6145430165743189,0.0821170152448566]],[[0.021520916691481498,0.24822755964695098,0.165681577816611,0.1551274844254461],[0.5251302090576222,0.44175051689164524,0.1791612276895194,0.2605423197595689],[0.6225479481442175,0.7932263621592802,0.3302016905524744,0.7730514817863094],[0.953788321295188,0.8908727920243028,0.665861039149964,0.5550125219908764],[0.6175870716914167,0.6236797442125106,0.3995293732254222,0.5409402592543404],[0.38751565488620565,0.4043913777273138,0.42546239992033336,0.22289124792008827],[0.10881508181174099,0.10364220865260901,0.1446187538917332,0.019324376158757397]]]]]

Actual:   [[[[[0.0432, 0.4975, 0.3321, 0.3109], [1.0576, 0.9449, 0.3988, 0.5594], [1.3964, 1.9585, 0.8802, 1.776], [2.6146, 2.4161, 1.5851, 1.5566], [2.0488, 2.0349, 1.1435, 1.8697], [1.4059, 1.4847, 1.4987, 0.8857], [0.4492, 0.4279, 0.597, 0.0798]], [[0.0309, 0.356, 0.2376, 0.2225], [0.7735, 0.8698, 0.4147, 0.5214], [1.3742, 1.3433, 0.5007, 1.2223], [1.5183, 1.7923, 1.2088, 1.3952], [1.5572, 1.3338, 1.0405, 0.7998], [0.722, 0.8377, 0.579, 0.783], [0.4624, 0.4405, 0.6146, 0.0822]], [[0.0216, 0.2483, 0.1657, 0.1552], [0.5252, 0.4418, 0.1792, 0.2606], [0.6226, 0.7933, 0.3303, 0.7731], [0.9538, 0.8909, 0.6659, 0.5551], [0.6176, 0.6237, 0.3996, 0.541], [0.3876, 0.4044, 0.4255, 0.2229], [0.1089, 0.1037, 0.1447, 0.0194]]]]]

Expected: [[[[[0.0432, 0.4975, 0.3321, 0.3109], [1.0576, 0.9449, 0.3988, 0.5594], [1.3964, 1.9585, 0.8802, 1.776], [2.6146, 2.4161, 1.5851, 1.5566], [2.0488, 2.0349, 1.1435, 1.8697], [1.4059, 1.4847, 1.4987, 0.8857], [0.4492, 0.4279, 0.597, 0.0798]], [[0.0309, 0.356, 0.2376, 0.2225], [0.7735, 0.8698, 0.4147, 0.5214], [1.3742, 1.3433, 0.5007, 1.2223], [1.5183, 1.7923, 1.2088, 1.3952], [1.5572, 1.3338, 1.0405, 0.7998], [0.722, 0.8377, 0.579, 0.783], [0.4624, 0.4405, 0.6146, 0.0822]], [[0.0216, 0.2483, 0.1657, 0.1552], [0.5252, 0.4418, 0.1792, 0.2606], [0.6226, 0.7933, 0.3303, 0.7731], [0.9538, 0.8909, 0.6659, 0.5551], [0.6176, 0.6237, 0.3996, 0.541], [0.3876, 0.4044, 0.4255, 0.2229], [0.1089, 0.1037, 0.1447, 0.0194]]]]]