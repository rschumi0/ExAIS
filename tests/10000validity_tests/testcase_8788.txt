import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub6679 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub6679 = tf.keras.layers.Input(shape=([2, 2]))

Sub6679 = keras.layers.Subtract(name = 'Sub6679', )([in0Sub6679,in1Sub6679])
Den94047 = keras.layers.Dense(1,name = 'Den94047', )(Sub6679)
GRU40910 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU40910', )(Den94047)
Lea75091 = keras.layers.LeakyReLU(alpha=5.505040397369187, name = 'Lea75091', )(GRU40910)
model = tf.keras.models.Model(inputs=[in0Sub6679,in1Sub6679], outputs=Lea75091)
w = model.get_layer('Den94047').get_weights() 
w[0] = np.array([[0.9753], [0.159]])
w[1] = np.array([0.8387])
model.get_layer('Den94047').set_weights(w) 
w = model.get_layer('GRU40910').get_weights() 
w[0] = np.array([[2, 8, 1, 10, 1, 2, 5, 4, 2]])
w[1] = np.array([[7, 3, 3, 6, 2, 10, 6, 4, 9], [4, 2, 2, 3, 4, 4, 3, 4, 9], [7, 6, 9, 6, 5, 3, 1, 8, 9]])
w[2] = np.array([[5, 3, 6, 4, 9, 1, 5, 1, 1], [9, 3, 4, 5, 5, 10, 2, 5, 5]])
model.get_layer('GRU40910').set_weights(w) 
in0Sub6679 = tf.constant([[[0.1781, 0.9221], [0.3655, 0.9515]]])
in1Sub6679 = tf.constant([[[0.0923, 0.1675], [0.3079, 0.1167]]])
print (np.array2string(model.predict([in0Sub6679,in1Sub6679],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lea75091.png')

LSub6679 = subtract_layer([[[0.1781, 0.9221], [0.3655, 0.9515]]], [[[0.0923, 0.1675], [0.3079, 0.1167]]], Sub6679), 
LDen94047 = dense_layer(Sub6679, [[0.9753], [0.159]],[0.8387], Den94047), 
LGRU40910 = gru_layer(Den94047,[[2, 8, 1, 10, 1, 2, 5, 4, 2]],[[7, 3, 3, 6, 2, 10, 6, 4, 9], [4, 2, 2, 3, 4, 4, 3, 4, 9], [7, 6, 9, 6, 5, 3, 1, 8, 9]],[[5, 3, 6, 4, 9, 1, 5, 1, 1], [9, 3, 4, 5, 5, 10, 2, 5, 5]], true, GRU40910), 
LLea75091 = leaky_relu_layer(GRU40910, 5.505040397369187, Lea75091), 
exec_layers([LSub6679,LDen94047,LGRU40910,LLea75091],["Sub6679","Den94047","GRU40910","Lea75091"],Lea75091,"Lea75091")

Actual (Unparsed): [[0.0000002, 0.0000013, 0.0000323]]

Expected (Unparsed): [[2.0987048795923022e-7,1.2591722306608462e-6,3.225267297310679e-5]]

Actual:   [[0, 0, 0.0001]]

Expected: [[0, 0, 0.0001]]