import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot39254 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot39254 = tf.keras.layers.Input(shape=([3, 2]))

Dot39254 = keras.layers.Dot(axes=(2, 2), name = 'Dot39254', )([in0Dot39254,in1Dot39254])
Sep13723 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep13723', )(Dot39254)
Sim55986 = keras.layers.SimpleRNN(2,name = 'Sim55986', )(Sep13723)
model = tf.keras.models.Model(inputs=[in0Dot39254,in1Dot39254], outputs=Sim55986)
w = model.get_layer('Sep13723').get_weights() 
w[0] = np.array([[[0.126], [0.5454], [0.2471]]])
w[1] = np.array([[[0.6741, 0.6372, 0.8277, 0.889], [0.77, 0.4912, 0.1851, 0.3431], [0.446, 0.1002, 0.0022, 0.6176]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep13723').set_weights(w) 
w = model.get_layer('Sim55986').get_weights() 
w[0] = np.array([[2, 8], [10, 5], [7, 3], [10, 8]])
w[1] = np.array([[8, 4], [1, 8]])
w[2] = np.array([8, 3])
model.get_layer('Sim55986').set_weights(w) 
in0Dot39254 = tf.constant([[[0.1056, 0.0531], [0.0707, 0.4551], [0.1073, 0.0108]]])
in1Dot39254 = tf.constant([[[0.1109, 0.2553], [0.4966, 0.582], [0.2231, 0.7808]]])
print (np.array2string(model.predict([in0Dot39254,in1Dot39254],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim55986.png')

LDot39254 = dot_layer([[[0.1056, 0.0531], [0.0707, 0.4551], [0.1073, 0.0108]]], [[[0.1109, 0.2553], [0.4966, 0.582], [0.2231, 0.7808]]], 2, 2, Dot39254), 
LSep13723 = separable_conv1D_layer(Dot39254, 1,[[[[0.126], [0.5454], [0.2471]]],[[[0.6741, 0.6372, 0.8277, 0.889], [0.77, 0.4912, 0.1851, 0.3431], [0.446, 0.1002, 0.0022, 0.6176]]]],[0, 0, 0, 0], 1, false, Sep13723), 
LSim55986 = simple_rnn_layer(Sep13723,[[2, 8], [10, 5], [7, 3], [10, 8]],[[8, 4], [1, 8]],[8, 3], Sim55986), 
exec_layers([LDot39254,LSep13723,LSim55986],["Dot39254","Sep13723","Sim55986"],Sim55986,"Sim55986")

Actual (Unparsed): [[1.0000000, 1.0000000]]

Expected (Unparsed): [[0.9999999999999987,0.9999999999999302]]

Actual:   [[1, 1]]

Expected: [[1, 1]]