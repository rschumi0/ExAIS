import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub62022 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub62022 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot6380 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot6380 = tf.keras.layers.Input(shape=([2, 2]))
in0Con76417 = tf.keras.layers.Input(shape=([2, 2]))

Sub62022 = keras.layers.Subtract(name = 'Sub62022', )([in0Sub62022,in1Sub62022])
Res491 = keras.layers.Reshape((2, 4), name = 'Res491', )(Sub62022)
Thr44119 = keras.layers.ThresholdedReLU(theta=4.919705629550423, name = 'Thr44119', )(Res491)
Dot6380 = keras.layers.Dot(axes=(1, 1), name = 'Dot6380', )([in0Dot6380,in1Dot6380])
Con76417 = keras.layers.Concatenate(axis=2, name = 'Con76417', )([Dot6380,in0Con76417])
Min75310 = keras.layers.Minimum(name = 'Min75310', )([Thr44119,Con76417])
Res10201 = keras.layers.Reshape((2, 4, 1), name = 'Res10201', )(Min75310)
Zer25793 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer25793', )(Res10201)
model = tf.keras.models.Model(inputs=[in0Sub62022,in1Sub62022,in0Dot6380,in1Dot6380,in0Con76417], outputs=Zer25793)
in0Sub62022 = tf.constant([[[[0.681, 0.1325], [0.6158, 0.8769]], [[0.9373, 0.8759], [0.1869, 0.6927]]]])
in1Sub62022 = tf.constant([[[[0.8341, 0.2203], [0.3639, 0.9898]], [[0.0489, 0.4836], [0.2642, 0.7256]]]])
in0Dot6380 = tf.constant([[[0.5063, 0.0567], [0.3348, 0.5265]]])
in1Dot6380 = tf.constant([[[0.4048, 0.6859], [0.6965, 0.7897]]])
in0Con76417 = tf.constant([[[0.3152, 0.1781], [0.9504, 0.8346]]])
print (np.array2string(model.predict([in0Sub62022,in1Sub62022,in0Dot6380,in1Dot6380,in0Con76417],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer25793.png')

LSub62022 = subtract_layer([[[[0.681, 0.1325], [0.6158, 0.8769]], [[0.9373, 0.8759], [0.1869, 0.6927]]]], [[[[0.8341, 0.2203], [0.3639, 0.9898]], [[0.0489, 0.4836], [0.2642, 0.7256]]]], Sub62022), 
LRes491 = reshape_layer(Sub62022, [2, 4], Res491), 
LThr44119 = thresholded_relu_layer(Res491, 4.919705629550423, Thr44119), 
LDot6380 = dot_layer([[[0.5063, 0.0567], [0.3348, 0.5265]]], [[[0.4048, 0.6859], [0.6965, 0.7897]]], 1, 1, Dot6380), 
LCon76417 = concatenate_layer([Dot6380,[[[0.3152, 0.1781], [0.9504, 0.8346]]]], 2, Con76417), 
LMin75310 = minimum_layer([Thr44119,Con76417], Min75310), 
LRes10201 = reshape_layer(Min75310, [2, 4, 1], Res10201), 
LZer25793 = zero_padding2D_layer(Res10201, 1, 1, 1, 1, Zer25793), 
exec_layers([LSub62022,LRes491,LThr44119,LDot6380,LCon76417,LMin75310,LRes10201,LZer25793],["Sub62022","Res491","Thr44119","Dot6380","Con76417","Min75310","Res10201","Zer25793"],Zer25793,"Zer25793")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0000000], [-0.0000000], [0.0000000], [-0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [-0.0000000], [-0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0],[0]]]]

Actual:   [[[[0], [0], [0], [0], [0], [0]], [[0], [-0], [-0], [0], [-0], [0]], [[0], [0], [0], [-0], [-0], [0]], [[0], [0], [0], [0], [0], [0]]]]

Expected: [[[[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0], [0]]]]