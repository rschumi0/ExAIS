import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay73487 = tf.keras.layers.Input(shape=([3, 3, 4]))
in0Glo21532 = tf.keras.layers.Input(shape=([2, 2]))

Lay73487 = keras.layers.LayerNormalization(axis=3, epsilon=2.6651520412780743, name = 'Lay73487', )(in0Lay73487)
Res13060 = keras.layers.Reshape((3, 12), name = 'Res13060', )(Lay73487)
Fla62847 = keras.layers.Flatten(name = 'Fla62847', )(Res13060)
Res24517 = keras.layers.Reshape((36, 1), name = 'Res24517', )(Fla62847)
Glo21532 = keras.layers.GlobalMaxPool1D(name = 'Glo21532', )(in0Glo21532)
Res41956 = keras.layers.Reshape((2, 1), name = 'Res41956', )(Glo21532)
PRe83973 = keras.layers.PReLU(name = 'PRe83973', )(Res41956)
Zer72312 = keras.layers.ZeroPadding1D(padding=((34, 0)), name = 'Zer72312', )(PRe83973)
Ave33359 = keras.layers.Average(name = 'Ave33359', )([Res24517,Zer72312])
Glo29964 = keras.layers.GlobalMaxPool1D(name = 'Glo29964', )(Ave33359)
model = tf.keras.models.Model(inputs=[in0Lay73487,in0Glo21532], outputs=Glo29964)
w = model.get_layer('PRe83973').get_weights() 
w[0] = np.array([[0.0652], [0.7392]])
model.get_layer('PRe83973').set_weights(w) 
in0Lay73487 = tf.constant([[[[1.5393, 1.241, 1.7718, 1.8199], [1.0795, 1.2154, 1.2654, 1.8055], [1.5133, 1.3661, 1.2133, 1.9795]], [[1.2769, 1.0331, 1.7046, 1.6573], [1.3562, 1.0011, 1.8927, 1.0513], [1.9575, 1.3544, 1.0787, 1.1562]], [[1.9, 1.6236, 1.081, 1.023], [1.1006, 1.8981, 1.7972, 1.3845], [1.506, 1.1292, 1.297, 1.7218]]]])
in0Glo21532 = tf.constant([[[1.9606, 1.8051], [1.8791, 1.8974]]])
print (np.array2string(model.predict([in0Lay73487,in0Glo21532],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo29964.png')

LLay73487 = layer_normalization_layer([[[[1.5393, 1.241, 1.7718, 1.8199], [1.0795, 1.2154, 1.2654, 1.8055], [1.5133, 1.3661, 1.2133, 1.9795]], [[1.2769, 1.0331, 1.7046, 1.6573], [1.3562, 1.0011, 1.8927, 1.0513], [1.9575, 1.3544, 1.0787, 1.1562]], [[1.9, 1.6236, 1.081, 1.023], [1.1006, 1.8981, 1.7972, 1.3845], [1.506, 1.1292, 1.297, 1.7218]]]], 3, 2.6651520412780743, Lay73487), 
LRes13060 = reshape_layer(Lay73487, [3, 12], Res13060), 
LFla62847 = flatten_layer(Res13060, Fla62847), 
LRes24517 = reshape_layer(Fla62847, [36, 1], Res24517), 
LGlo21532 = global_max_pool1D_layer([[[1.9606, 1.8051], [1.8791, 1.8974]]], Glo21532), 
LRes41956 = reshape_layer(Glo21532, [2, 1], Res41956), 
LPRe83973 = prelu_layer(Res41956, [[0.0652], [0.7392]], PRe83973), 
LZer72312 = zero_padding1D_layer(PRe83973, 34, 0, Zer72312), 
LAve33359 = average_layer([Res24517,Zer72312], Ave33359), 
LGlo29964 = global_max_pool1D_layer(Ave33359, Glo29964), 
exec_layers([LLay73487,LRes13060,LFla62847,LRes24517,LGlo21532,LRes41956,LPRe83973,LZer72312,LAve33359,LGlo29964],["Lay73487","Res13060","Fla62847","Res24517","Glo21532","Res41956","PRe83973","Zer72312","Ave33359","Glo29964"],Glo29964,"Glo29964")

Actual (Unparsed): [[1.0422592]]

Expected (Unparsed): [[1.0422591712647027]]

Actual:   [[1.0423]]

Expected: [[1.0423]]