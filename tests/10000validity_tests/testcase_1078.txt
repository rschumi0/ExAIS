import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max67844 = tf.keras.layers.Input(shape=([2, 2]))
in1Max67844 = tf.keras.layers.Input(shape=([2, 2]))
in0Ave89804 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave89804 = tf.keras.layers.Input(shape=([1, 2]))

Max67844 = keras.layers.Maximum(name = 'Max67844', )([in0Max67844,in1Max67844])
Ave89804 = keras.layers.Average(name = 'Ave89804', )([in0Ave89804,in1Ave89804])
Zer83229 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer83229', )(Ave89804)
Sub49347 = keras.layers.Subtract(name = 'Sub49347', )([Max67844,Zer83229])
Res81694 = keras.layers.Reshape((2, 2, 1), name = 'Res81694', )(Sub49347)
Sep47813 = keras.layers.SeparableConv2D(3, (2, 2),strides=(1, 1), padding='same', name = 'Sep47813', )(Res81694)
model = tf.keras.models.Model(inputs=[in0Max67844,in1Max67844,in0Ave89804,in1Ave89804], outputs=Sep47813)
w = model.get_layer('Sep47813').get_weights() 
w[0] = np.array([[[[0.7092]], [[0.8689]]], [[[0.1264]], [[0.4869]]]])
w[1] = np.array([[[[0.7632, 0.592, 0.8298]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep47813').set_weights(w) 
in0Max67844 = tf.constant([[[0.7957, 0.3779], [0.4219, 0.246]]])
in1Max67844 = tf.constant([[[0.0428, 0.5109], [0.3423, 0.1663]]])
in0Ave89804 = tf.constant([[[0.4616, 0.4454]]])
in1Ave89804 = tf.constant([[[0.7401, 0.706]]])
print (np.array2string(model.predict([in0Max67844,in1Max67844,in0Ave89804,in1Ave89804],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep47813.png')

LMax67844 = maximum_layer([[[[0.7957, 0.3779], [0.4219, 0.246]]], [[[0.0428, 0.5109], [0.3423, 0.1663]]]], Max67844), 
LAve89804 = average_layer([[[[0.4616, 0.4454]]], [[[0.7401, 0.706]]]], Ave89804), 
LZer83229 = zero_padding1D_layer(Ave89804, 1, 0, Zer83229), 
LSub49347 = subtract_layer(Max67844,Zer83229, Sub49347), 
LRes81694 = reshape_layer(Sub49347, [2, 2, 1], Res81694), 
LSep47813 = separable_conv2D_layer(Res81694, 2, 2,[[[[[0.7092]], [[0.8689]]], [[[0.1264]], [[0.4869]]]],[[[[0.7632, 0.592, 0.8298]]]]],[0, 0, 0], 1, 1, true, Sep47813), 
exec_layers([LMax67844,LAve89804,LZer83229,LSub49347,LRes81694,LSep47813],["Max67844","Ave89804","Zer83229","Sub49347","Res81694","Sep47813"],Sep47813,"Sep47813")

Actual (Unparsed): [[[[0.6297020, 0.4884481, 0.6846524], [0.2447248, 0.1898285, 0.2660805]], [[-0.3154975, -0.2447255, -0.3430291], [-0.1784539, -0.1384233, -0.1940265]]]]

Expected (Unparsed): [[[[0.629702002368,0.48844809408,0.684652412952],[0.24472481184000003,0.18982847040000003,0.26608051476000005]],[[-0.315497469744,-0.24472550064,-0.343029088566],[-0.178453896768,-0.13842335808,-0.194026524552]]]]

Actual:   [[[[0.6298, 0.4885, 0.6847], [0.2448, 0.1899, 0.2661]], [[-0.3154, -0.2447, -0.343], [-0.1784, -0.1384, -0.194]]]]

Expected: [[[[0.6298, 0.4885, 0.6847], [0.2448, 0.1899, 0.2661]], [[-0.3154, -0.2447, -0.343], [-0.1784, -0.1384, -0.194]]]]