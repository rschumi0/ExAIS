import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min40318 = tf.keras.layers.Input(shape=([1, 2]))
in1Min40318 = tf.keras.layers.Input(shape=([1, 2]))

Min40318 = keras.layers.Minimum(name = 'Min40318', )([in0Min40318,in1Min40318])
LST39200 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST39200', )(Min40318)
Res68207 = keras.layers.Reshape((2, 1), name = 'Res68207', )(LST39200)
Res44270 = keras.layers.Reshape((2, 1, 1), name = 'Res44270', )(Res68207)
Res19320 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res19320', )(Res44270)
Glo34516 = keras.layers.GlobalAveragePooling3D(name = 'Glo34516', )(Res19320)
model = tf.keras.models.Model(inputs=[in0Min40318,in1Min40318], outputs=Glo34516)
w = model.get_layer('LST39200').get_weights() 
w[0] = np.array([[8, 1, 6, 6, 7, 4, 3, 2], [4, 8, 6, 1, 3, 10, 8, 5]])
w[1] = np.array([[2, 9, 6, 3, 10, 4, 5, 10], [8, 7, 2, 5, 5, 2, 4, 7]])
w[2] = np.array([10, 3, 7, 2, 7, 1, 8, 1])
model.get_layer('LST39200').set_weights(w) 
in0Min40318 = tf.constant([[[0.1057, 0.6686]]])
in1Min40318 = tf.constant([[[0.9477, 0.1464]]])
print (np.array2string(model.predict([in0Min40318,in1Min40318],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo34516.png')

LMin40318 = minimum_layer([[[[0.1057, 0.6686]]], [[[0.9477, 0.1464]]]], Min40318), 
LLST39200 = lstm_layer(Min40318,[[8, 1, 6, 6, 7, 4, 3, 2], [4, 8, 6, 1, 3, 10, 8, 5]],[[2, 9, 6, 3, 10, 4, 5, 10], [8, 7, 2, 5, 5, 2, 4, 7]],[10, 3, 7, 2, 7, 1, 8, 1], LST39200), 
LRes68207 = reshape_layer(LST39200, [2, 1], Res68207), 
LRes44270 = reshape_layer(Res68207, [2, 1, 1], Res44270), 
LRes19320 = reshape_layer(Res44270, [2, 1, 1, 1], Res19320), 
LGlo34516 = global_average_pooling3D_layer(Res19320, Glo34516), 
exec_layers([LMin40318,LLST39200,LRes68207,LRes44270,LRes19320,LGlo34516],["Min40318","LST39200","Res68207","Res44270","Res19320","Glo34516"],Glo34516,"Glo34516")

Actual (Unparsed): [[0.7101651]]

Expected (Unparsed): [[0.7101650572686286]]

Actual:   [[0.7102]]

Expected: [[0.7102]]