import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot27777 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot27777 = tf.keras.layers.Input(shape=([3, 3]))
in0Mul40952 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul40952 = tf.keras.layers.Input(shape=([2, 1, 1]))

Dot27777 = keras.layers.Dot(axes=(1, 1), name = 'Dot27777', )([in0Dot27777,in1Dot27777])
Res40599 = keras.layers.Reshape((3, 3, 1), name = 'Res40599', )(Dot27777)
Mul40952 = keras.layers.Multiply(name = 'Mul40952', )([in0Mul40952,in1Mul40952])
Lea35908 = keras.layers.LeakyReLU(alpha=3.114770561989226, name = 'Lea35908', )(Mul40952)
Zer22662 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer22662', )(Lea35908)
Ave85598 = keras.layers.Average(name = 'Ave85598', )([Res40599,Zer22662])
model = tf.keras.models.Model(inputs=[in0Dot27777,in1Dot27777,in0Mul40952,in1Mul40952], outputs=Ave85598)
in0Dot27777 = tf.constant([[[0.7902, 0.4582, 0.1706], [0.8121, 0.4093, 0.134], [0.6255, 0.2147, 0.7813]]])
in1Dot27777 = tf.constant([[[0.0446, 0.2166, 0.2451], [0.8027, 0.0182, 0.5533], [0.7126, 0.4375, 0.3323]]])
in0Mul40952 = tf.constant([[[[0.2949]], [[0.4419]]]])
in1Mul40952 = tf.constant([[[[0.2244]], [[0.9438]]]])
print (np.array2string(model.predict([in0Dot27777,in1Dot27777,in0Mul40952,in1Mul40952],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave85598.png')

LDot27777 = dot_layer([[[0.7902, 0.4582, 0.1706], [0.8121, 0.4093, 0.134], [0.6255, 0.2147, 0.7813]]], [[[0.0446, 0.2166, 0.2451], [0.8027, 0.0182, 0.5533], [0.7126, 0.4375, 0.3323]]], 1, 1, Dot27777), 
LRes40599 = reshape_layer(Dot27777, [3, 3, 1], Res40599), 
LMul40952 = multiply_layer([[[[[0.2949]], [[0.4419]]]], [[[[0.2244]], [[0.9438]]]]], Mul40952), 
LLea35908 = leaky_relu_layer(Mul40952, 3.114770561989226, Lea35908), 
LZer22662 = zero_padding2D_layer(Lea35908, 1, 0, 2, 0, Zer22662), 
LAve85598 = average_layer([Res40599,Zer22662], Ave85598), 
exec_layers([LDot27777,LRes40599,LMul40952,LLea35908,LZer22662,LAve85598],["Dot27777","Res40599","Mul40952","Lea35908","Zer22662","Ave85598"],Ave85598,"Ave85598")

Actual (Unparsed): [[[[0.5664234], [0.2297969], [0.4254333]], [[0.2509880], [0.1003133], [0.2381454]], [[0.3359625], [0.1906048], [0.3963237]]]]

Expected (Unparsed): [[[[0.566423445],[0.229796895],[0.4254333]],[[0.250988025],[0.10031331499999999],[0.23814543999999999]],[[0.33596247],[0.19060475500000001],[0.396323735]]]]

Actual:   [[[[0.5665], [0.2298], [0.4255]], [[0.251], [0.1004], [0.2382]], [[0.336], [0.1907], [0.3964]]]]

Expected: [[[[0.5665], [0.2298], [0.4255]], [[0.251], [0.1004], [0.2382]], [[0.336], [0.1907], [0.3964]]]]