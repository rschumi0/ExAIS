import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot26187 = tf.keras.layers.Input(shape=([2]))
in1Dot26187 = tf.keras.layers.Input(shape=([2]))
in0Con87237 = tf.keras.layers.Input(shape=([2]))
in0Sub62739 = tf.keras.layers.Input(shape=([3]))
in1Sub62739 = tf.keras.layers.Input(shape=([3]))
in0Con23366 = tf.keras.layers.Input(shape=([1, 5]))
in0Dot43662 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot43662 = tf.keras.layers.Input(shape=([2, 3]))
in0Add37766 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Add37766 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Dot26187 = keras.layers.Dot(axes=(1, 1), name = 'Dot26187', )([in0Dot26187,in1Dot26187])
Con87237 = keras.layers.Concatenate(axis=1, name = 'Con87237', )([Dot26187,in0Con87237])
Sub62739 = keras.layers.Subtract(name = 'Sub62739', )([in0Sub62739,in1Sub62739])
Dot7112 = keras.layers.Dot(axes=(1, 1), name = 'Dot7112', )([Con87237,Sub62739])
Res93244 = keras.layers.Reshape((1, 1), name = 'Res93244', )(Dot7112)
Con23366 = keras.layers.Concatenate(axis=2, name = 'Con23366', )([Res93244,in0Con23366])
Dot43662 = keras.layers.Dot(axes=(1, 1), name = 'Dot43662', )([in0Dot43662,in1Dot43662])
Res46864 = keras.layers.Reshape((3, 3, 1), name = 'Res46864', )(Dot43662)
Up_27802 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_27802', )(Res46864)
Res84498 = keras.layers.Reshape((6, 6), name = 'Res84498', )(Up_27802)
Dot81199 = keras.layers.Dot(axes=(2, 2), name = 'Dot81199', )([Con23366,Res84498])
Res66854 = keras.layers.Reshape((1, 6, 1), name = 'Res66854', )(Dot81199)
Res4101 = keras.layers.Reshape((1, 6, 1, 1), name = 'Res4101', )(Res66854)
Zer28448 = keras.layers.ZeroPadding3D(padding=((1, 0), (4, 0), (1, 0)), name = 'Zer28448', )(Res4101)
Add37766 = keras.layers.Add(name = 'Add37766', )([in0Add37766,in1Add37766])
Zer2164 = keras.layers.ZeroPadding3D(padding=((0, 0), (8, 0), (0, 0)), name = 'Zer2164', )(Add37766)
Max24870 = keras.layers.Maximum(name = 'Max24870', )([Zer28448,Zer2164])
model = tf.keras.models.Model(inputs=[in0Dot26187,in1Dot26187,in0Con87237,in0Sub62739,in1Sub62739,in0Con23366,in0Dot43662,in1Dot43662,in0Add37766,in1Add37766], outputs=Max24870)
in0Dot26187 = tf.constant([[0.221, 0.6674]])
in1Dot26187 = tf.constant([[0.3702, 0.3733]])
in0Con87237 = tf.constant([[0.94, 0.363]])
in0Sub62739 = tf.constant([[0.2779, 0.2908, 0.1517]])
in1Sub62739 = tf.constant([[0.5896, 0.2589, 0.0236]])
in0Con23366 = tf.constant([[[0.6767, 0.5653, 0.2457, 0.2737, 0.7064]]])
in0Dot43662 = tf.constant([[[0.8203, 0.6128, 0.4694], [0.7467, 0.9364, 0.4745]]])
in1Dot43662 = tf.constant([[[0.8604, 0.5578, 0.5392], [0.8943, 0.3303, 0.4723]]])
in0Add37766 = tf.constant([[[[[0.8654], [0.685]], [[0.2322], [0.8288]]], [[[0.5032], [0.9403]], [[0.1218], [0.8949]]]]])
in1Add37766 = tf.constant([[[[[0.5272], [0.326]], [[0.3378], [0.4238]]], [[[0.4212], [0.8814]], [[0.2271], [0.0734]]]]])
print (np.array2string(model.predict([in0Dot26187,in1Dot26187,in0Con87237,in0Sub62739,in1Sub62739,in0Con23366,in0Dot43662,in1Dot43662,in0Add37766,in1Add37766],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max24870.png')

LDot26187 = dot_layer([[0.221, 0.6674]], [[0.3702, 0.3733]], 1, 1, Dot26187), 
LCon87237 = concatenate_layer([Dot26187,[[0.94, 0.363]]], 1, Con87237), 
LSub62739 = subtract_layer([[0.2779, 0.2908, 0.1517]], [[0.5896, 0.2589, 0.0236]], Sub62739), 
LDot7112 = dot_layer(Con87237,Sub62739, 1, 1, Dot7112), 
LRes93244 = reshape_layer(Dot7112, [1, 1], Res93244), 
LCon23366 = concatenate_layer([Res93244,[[[0.6767, 0.5653, 0.2457, 0.2737, 0.7064]]]], 2, Con23366), 
LDot43662 = dot_layer([[[0.8203, 0.6128, 0.4694], [0.7467, 0.9364, 0.4745]]], [[[0.8604, 0.5578, 0.5392], [0.8943, 0.3303, 0.4723]]], 1, 1, Dot43662), 
LRes46864 = reshape_layer(Dot43662, [3, 3, 1], Res46864), 
LUp_27802 = up_sampling2D_layer(Res46864, 2, 2, Up_27802), 
LRes84498 = reshape_layer(Up_27802, [6, 6], Res84498), 
LDot81199 = dot_layer(Con23366,Res84498, 2, 2, Dot81199), 
LRes66854 = reshape_layer(Dot81199, [1, 6, 1], Res66854), 
LRes4101 = reshape_layer(Res66854, [1, 6, 1, 1], Res4101), 
LZer28448 = zero_padding3D_layer(Res4101, 1, 0, 4, 0, 1, 0, Zer28448), 
LAdd37766 = add_layer([[[[[[0.8654], [0.685]], [[0.2322], [0.8288]]], [[[0.5032], [0.9403]], [[0.1218], [0.8949]]]]], [[[[[0.5272], [0.326]], [[0.3378], [0.4238]]], [[[0.4212], [0.8814]], [[0.2271], [0.0734]]]]]], Add37766), 
LZer2164 = zero_padding3D_layer(Add37766, 0, 0, 8, 0, 0, 0, Zer2164), 
LMax24870 = maximum_layer([Zer28448,Zer2164], Max24870), 
exec_layers([LDot26187,LCon87237,LSub62739,LDot7112,LRes93244,LCon23366,LDot43662,LRes46864,LUp_27802,LRes84498,LDot81199,LRes66854,LRes4101,LZer28448,LAdd37766,LZer2164,LMax24870],["Dot26187","Con87237","Sub62739","Dot7112","Res93244","Con23366","Dot43662","Res46864","Up_27802","Res84498","Dot81199","Res66854","Res4101","Zer28448","Add37766","Zer2164","Max24870"],Max24870,"Max24870")

Actual (Unparsed): [[[[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[1.3926000], [1.0110000]], [[0.5700000], [1.2526000]]], [[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [2.2431091]], [[0.0000000], [2.2431091]], [[0.0000000], [2.1724365]], [[0.0000000], [2.1724365]], [[0.9244000], [1.8217000]], [[0.3489000], [1.3455256]]]]]

Expected (Unparsed): [[[[[0],[0]],[[0],[0]],[[0],[0]],[[0],[0]],[[0],[0]],[[0],[0]],[[0],[0]],[[0],[0]],[[1.3925999999999998],[1.0110000000000001]],[[0.57],[1.2526]]],[[[0],[0]],[[0],[0]],[[0],[0]],[[0],[0]],[[0],[2.243109149513086]],[[0],[2.243109149513086]],[[0],[2.172436555959939]],[[0],[2.172436555959939]],[[0.9244],[1.8216999999999999]],[[0.3489],[1.3455255957919934]]]]]

Actual:   [[[[[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[1.3926], [1.011]], [[0.57], [1.2526]]], [[[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [2.2432]], [[0], [2.2432]], [[0], [2.1725]], [[0], [2.1725]], [[0.9244], [1.8217]], [[0.3489], [1.3456]]]]]

Expected: [[[[[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[1.3926], [1.0111]], [[0.57], [1.2526]]], [[[0], [0]], [[0], [0]], [[0], [0]], [[0], [0]], [[0], [2.2432]], [[0], [2.2432]], [[0], [2.1725]], [[0], [2.1725]], [[0.9244], [1.8217]], [[0.3489], [1.3456]]]]]