import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub71620 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in1Sub71620 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))

Sub71620 = keras.layers.Subtract(name = 'Sub71620', )([in0Sub71620,in1Sub71620])
Res4813 = keras.layers.Reshape((2, 2, 6), name = 'Res4813', )(Sub71620)
Res65561 = keras.layers.Reshape((2, 12), name = 'Res65561', )(Res4813)
Sim89099 = keras.layers.SimpleRNN(2,name = 'Sim89099', )(Res65561)
Res9214 = keras.layers.Reshape((2, 1), name = 'Res9214', )(Sim89099)
Res33251 = keras.layers.Reshape((2, 1, 1), name = 'Res33251', )(Res9214)
Sep59671 = keras.layers.SeparableConv2D(2, (2, 1),strides=(1, 1), padding='valid', name = 'Sep59671', )(Res33251)
model = tf.keras.models.Model(inputs=[in0Sub71620,in1Sub71620], outputs=Sep59671)
w = model.get_layer('Sim89099').get_weights() 
w[0] = np.array([[1, 3], [6, 7], [8, 8], [10, 1], [3, 10], [7, 4], [2, 7], [4, 6], [4, 10], [6, 9], [4, 5], [8, 2]])
w[1] = np.array([[5, 8], [9, 3]])
w[2] = np.array([1, 8])
model.get_layer('Sim89099').set_weights(w) 
w = model.get_layer('Sep59671').get_weights() 
w[0] = np.array([[[[0.1659]]], [[[0.5564]]]])
w[1] = np.array([[[[0.3532, 0.1215]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep59671').set_weights(w) 
in0Sub71620 = tf.constant([[[[[0.2806, 0.6885], [0.6889, 0.5971], [0.2447, 0.9471]], [[0.5798, 0.7628], [0.0607, 0.5458], [0.4061, 0.5625]]], [[[0.8628, 0.6699], [0.7672, 0.6466], [0.8083, 0.5086]], [[0.4475, 0.6681], [0.2047, 0.2181], [0.3431, 0.9112]]]]])
in1Sub71620 = tf.constant([[[[[0.631, 0.2706], [0.5637, 0.5646], [0.7162, 0.3489]], [[0.797, 0.8054], [0.7885, 0.9671], [0.0912, 0.0228]]], [[[0.4345, 0.554], [0.0524, 0.7102], [0.12, 0.8256]], [[0.0829, 0.7785], [0.4152, 0.887], [0.69, 0.3055]]]]])
print (np.array2string(model.predict([in0Sub71620,in1Sub71620],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep59671.png')

LSub71620 = subtract_layer([[[[[0.2806, 0.6885], [0.6889, 0.5971], [0.2447, 0.9471]], [[0.5798, 0.7628], [0.0607, 0.5458], [0.4061, 0.5625]]], [[[0.8628, 0.6699], [0.7672, 0.6466], [0.8083, 0.5086]], [[0.4475, 0.6681], [0.2047, 0.2181], [0.3431, 0.9112]]]]], [[[[[0.631, 0.2706], [0.5637, 0.5646], [0.7162, 0.3489]], [[0.797, 0.8054], [0.7885, 0.9671], [0.0912, 0.0228]]], [[[0.4345, 0.554], [0.0524, 0.7102], [0.12, 0.8256]], [[0.0829, 0.7785], [0.4152, 0.887], [0.69, 0.3055]]]]], Sub71620), 
LRes4813 = reshape_layer(Sub71620, [2, 2, 6], Res4813), 
LRes65561 = reshape_layer(Res4813, [2, 12], Res65561), 
LSim89099 = simple_rnn_layer(Res65561,[[1, 3], [6, 7], [8, 8], [10, 1], [3, 10], [7, 4], [2, 7], [4, 6], [4, 10], [6, 9], [4, 5], [8, 2]],[[5, 8], [9, 3]],[1, 8], Sim89099), 
LRes9214 = reshape_layer(Sim89099, [2, 1], Res9214), 
LRes33251 = reshape_layer(Res9214, [2, 1, 1], Res33251), 
LSep59671 = separable_conv2D_layer(Res33251, 2, 1,[[[[[0.1659]]], [[[0.5564]]]],[[[[0.3532, 0.1215]]]]],[0, 0], 1, 1, false, Sep59671), 
exec_layers([LSub71620,LRes4813,LRes65561,LSim89099,LRes9214,LRes33251,LSep59671],["Sub71620","Res4813","Res65561","Sim89099","Res9214","Res33251","Sep59671"],Sep59671,"Sep59671")

Actual (Unparsed): [[[[0.2545218, 0.0875549]]]]

Expected (Unparsed): [[[[0.25452182987827454,0.08755493298474054]]]]

Actual:   [[[[0.2546, 0.0876]]]]

Expected: [[[[0.2546, 0.0876]]]]