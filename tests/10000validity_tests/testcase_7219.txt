import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo28317 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Mul1852 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Mul1852 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Glo28317 = keras.layers.GlobalMaxPool3D(name = 'Glo28317', )(in0Glo28317)
Res69769 = keras.layers.Reshape((2, 1), name = 'Res69769', )(Glo28317)
Res46666 = keras.layers.Reshape((2, 1, 1), name = 'Res46666', )(Res69769)
Mul1852 = keras.layers.Multiply(name = 'Mul1852', )([in0Mul1852,in1Mul1852])
Res47664 = keras.layers.Reshape((2, 2, 1), name = 'Res47664', )(Mul1852)
PRe5710 = keras.layers.PReLU(name = 'PRe5710', )(Res47664)
Cro57582 = keras.layers.Cropping2D(cropping=((1, 0), (0, 1)), name = 'Cro57582', )(PRe5710)
Zer16849 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer16849', )(Cro57582)
Max20153 = keras.layers.Maximum(name = 'Max20153', )([Res46666,Zer16849])
model = tf.keras.models.Model(inputs=[in0Glo28317,in0Mul1852,in1Mul1852], outputs=Max20153)
w = model.get_layer('PRe5710').get_weights() 
w[0] = np.array([[[0.151], [0.371]], [[0.6456], [0.8858]]])
model.get_layer('PRe5710').set_weights(w) 
in0Glo28317 = tf.constant([[[[[1.805, 1.9729]]], [[[1.4495, 1.1626]]]]])
in0Mul1852 = tf.constant([[[[[0.1623]], [[0.8961]]], [[[0.8691]], [[0.3351]]]]])
in1Mul1852 = tf.constant([[[[[0.8257]], [[0.7107]]], [[[0.3392]], [[0.5689]]]]])
print (np.array2string(model.predict([in0Glo28317,in0Mul1852,in1Mul1852],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max20153.png')

LGlo28317 = global_max_pool3D_layer([[[[[1.805, 1.9729]]], [[[1.4495, 1.1626]]]]], Glo28317), 
LRes69769 = reshape_layer(Glo28317, [2, 1], Res69769), 
LRes46666 = reshape_layer(Res69769, [2, 1, 1], Res46666), 
LMul1852 = multiply_layer([[[[[[0.1623]], [[0.8961]]], [[[0.8691]], [[0.3351]]]]], [[[[[0.8257]], [[0.7107]]], [[[0.3392]], [[0.5689]]]]]], Mul1852), 
LRes47664 = reshape_layer(Mul1852, [2, 2, 1], Res47664), 
LPRe5710 = prelu_layer(Res47664, [[[0.151], [0.371]], [[0.6456], [0.8858]]], PRe5710), 
LCro57582 = cropping2D_layer(PRe5710, 1, 0, 0, 1, Cro57582), 
LZer16849 = zero_padding2D_layer(Cro57582, 1, 0, 0, 0, Zer16849), 
LMax20153 = maximum_layer([Res46666,Zer16849], Max20153), 
exec_layers([LGlo28317,LRes69769,LRes46666,LMul1852,LRes47664,LPRe5710,LCro57582,LZer16849,LMax20153],["Glo28317","Res69769","Res46666","Mul1852","Res47664","PRe5710","Cro57582","Zer16849","Max20153"],Max20153,"Max20153")

Actual (Unparsed): [[[[1.8049999]], [[1.9729000]]]]

Expected (Unparsed): [[[[1.805]],[[1.9729]]]]

Actual:   [[[[1.805]], [[1.9729]]]]

Expected: [[[[1.805]], [[1.9729]]]]