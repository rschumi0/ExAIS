import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub42524 = tf.keras.layers.Input(shape=([3, 2, 2, 3]))
in1Sub42524 = tf.keras.layers.Input(shape=([3, 2, 2, 3]))

Sub42524 = keras.layers.Subtract(name = 'Sub42524', )([in0Sub42524,in1Sub42524])
Mas97795 = keras.layers.Masking(mask_value=1, name = 'Mas97795', )(Sub42524)
model = tf.keras.models.Model(inputs=[in0Sub42524,in1Sub42524], outputs=Mas97795)
in0Sub42524 = tf.constant([[[[[0.8551, 0.6774, 0.4632], [0.5841, 0.1512, 0.22]], [[0.0569, 0.6556, 0.7677], [0.3612, 0.6534, 0.6066]]], [[[0.6094, 0.1235, 0.5133], [0.4537, 0.458, 0.356]], [[0.6217, 0.2189, 0.6411], [0.8442, 0.1896, 0.0632]]], [[[0.4543, 0.0502, 0.6273], [0.6508, 0.8691, 0.5762]], [[0.3864, 0.5775, 0.9471], [0.1512, 0.9038, 0.4809]]]]])
in1Sub42524 = tf.constant([[[[[0.4255, 0.0536, 0.3822], [0.1438, 0.1373, 0.4055]], [[0.2919, 0.5008, 0.2892], [0.6995, 0.2891, 0.9618]]], [[[0.1298, 0.2519, 0.7133], [0.8783, 0.2107, 0.0163]], [[0.946, 0.2955, 0.2699], [0.3359, 0.6922, 0.3567]]], [[[0.7449, 0.7666, 0.6823], [0.8571, 0.0647, 0.058]], [[0.3805, 0.4784, 0.1598], [0.7465, 0.033, 0.1803]]]]])
print (np.array2string(model.predict([in0Sub42524,in1Sub42524],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas97795.png')

LSub42524 = subtract_layer([[[[[0.8551, 0.6774, 0.4632], [0.5841, 0.1512, 0.22]], [[0.0569, 0.6556, 0.7677], [0.3612, 0.6534, 0.6066]]], [[[0.6094, 0.1235, 0.5133], [0.4537, 0.458, 0.356]], [[0.6217, 0.2189, 0.6411], [0.8442, 0.1896, 0.0632]]], [[[0.4543, 0.0502, 0.6273], [0.6508, 0.8691, 0.5762]], [[0.3864, 0.5775, 0.9471], [0.1512, 0.9038, 0.4809]]]]], [[[[[0.4255, 0.0536, 0.3822], [0.1438, 0.1373, 0.4055]], [[0.2919, 0.5008, 0.2892], [0.6995, 0.2891, 0.9618]]], [[[0.1298, 0.2519, 0.7133], [0.8783, 0.2107, 0.0163]], [[0.946, 0.2955, 0.2699], [0.3359, 0.6922, 0.3567]]], [[[0.7449, 0.7666, 0.6823], [0.8571, 0.0647, 0.058]], [[0.3805, 0.4784, 0.1598], [0.7465, 0.033, 0.1803]]]]], Sub42524), 
LMas97795 = masking_layer(Sub42524, 1, Mas97795), 
exec_layers([LSub42524,LMas97795],["Sub42524","Mas97795"],Mas97795,"Mas97795")

Actual (Unparsed): [[[[[0.4296000, 0.6238000, 0.0810000], [0.4403000, 0.0139000, -0.1855000]], [[-0.2350000, 0.1548000, 0.4785000], [-0.3383000, 0.3643000, -0.3552000]]], [[[0.4796000, -0.1284000, -0.2000000], [-0.4246000, 0.2473000, 0.3397000]], [[-0.3243000, -0.0766000, 0.3712000], [0.5083000, -0.5026000, -0.2935000]]], [[[-0.2906000, -0.7164000, -0.0549999], [-0.2063000, 0.8044000, 0.5182000]], [[0.0059000, 0.0991000, 0.7873000], [-0.5953000, 0.8708000, 0.3006000]]]]]

Expected (Unparsed): [[[[[0.4296,0.6238,0.08100000000000002],[0.4402999999999999,0.013899999999999996,-0.18550000000000003]],[[-0.235,0.15479999999999994,0.47850000000000004],[-0.3383,0.36429999999999996,-0.35519999999999996]]],[[[0.4796,-0.12840000000000001,-0.20000000000000007],[-0.4246,0.24730000000000002,0.3397]],[[-0.3242999999999999,-0.07659999999999997,0.37120000000000003],[0.5083,-0.5026,-0.2935]]],[[[-0.2906,-0.7163999999999999,-0.05500000000000005],[-0.20629999999999993,0.8044,0.5182]],[[0.005900000000000016,0.09910000000000002,0.7873000000000001],[-0.5953,0.8708,0.3006]]]]]

Actual:   [[[[[0.4296, 0.6238, 0.081], [0.4403, 0.0139, -0.1855]], [[-0.235, 0.1548, 0.4785], [-0.3383, 0.3643, -0.3552]]], [[[0.4796, -0.1284, -0.2], [-0.4246, 0.2473, 0.3397]], [[-0.3243, -0.0766, 0.3712], [0.5083, -0.5026, -0.2935]]], [[[-0.2906, -0.7164, -0.0549], [-0.2063, 0.8044, 0.5182]], [[0.0059, 0.0991, 0.7873], [-0.5953, 0.8708, 0.3006]]]]]

Expected: [[[[[0.4296, 0.6238, 0.0811], [0.4403, 0.0139, -0.1855]], [[-0.235, 0.1548, 0.4786], [-0.3383, 0.3643, -0.3551]]], [[[0.4796, -0.1284, -0.2], [-0.4246, 0.2474, 0.3397]], [[-0.3242, -0.0765, 0.3713], [0.5083, -0.5026, -0.2935]]], [[[-0.2906, -0.7163, -0.055], [-0.2062, 0.8044, 0.5182]], [[0.006, 0.0992, 0.7874], [-0.5953, 0.8708, 0.3006]]]]]