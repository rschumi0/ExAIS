import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe62570 = tf.keras.layers.Input(shape=([1, 2]))
in0Con47282 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con20241 = tf.keras.layers.Input(shape=([1, 1, 2]))

PRe62570 = keras.layers.PReLU(name = 'PRe62570', input_shape=(1, 2))(in0PRe62570)
Res34499 = keras.layers.Reshape((1, 2, 1), name = 'Res34499', )(PRe62570)
Con47282 = keras.layers.Concatenate(axis=3, name = 'Con47282', )([Res34499,in0Con47282])
Con20241 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con20241', )(in0Con20241)
Zer25892 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer25892', )(Con20241)
Min76743 = keras.layers.Minimum(name = 'Min76743', )([Con47282,Zer25892])
Res80734 = keras.layers.Reshape((1, 4), name = 'Res80734', )(Min76743)
Con84268 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con84268', )(Res80734)
model = tf.keras.models.Model(inputs=[in0PRe62570,in0Con47282,in0Con20241], outputs=Con84268)
w = model.get_layer('PRe62570').get_weights() 
w[0] = np.array([[0.3585, 0.8833]])
model.get_layer('PRe62570').set_weights(w) 
w = model.get_layer('Con20241').get_weights() 
w[0] = np.array([[[[0.9294, 0.2502], [0.2017, 0.7164]]]])
w[1] = np.array([0, 0])
model.get_layer('Con20241').set_weights(w) 
w = model.get_layer('Con84268').get_weights() 
w[0] = np.array([[[0.7723, 0.0476], [0.6324, 0.1159], [0.9295, 0.9453], [0.95, 0.4663]]])
w[1] = np.array([0, 0])
model.get_layer('Con84268').set_weights(w) 
in0PRe62570 = tf.constant([[[0.4876, 0.4802]]])
in0Con47282 = tf.constant([[[[0.5848], [0.7947]]]])
in0Con20241 = tf.constant([[[[0.002, 0.9864]]]])
print (np.array2string(model.predict([in0PRe62570,in0Con47282,in0Con20241],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con84268.png')

LPRe62570 = prelu_layer([[[0.4876, 0.4802]]], [[0.3585, 0.8833]], PRe62570), 
LRes34499 = reshape_layer(PRe62570, [1, 2, 1], Res34499), 
LCon47282 = concatenate_layer([Res34499,[[[[0.5848], [0.7947]]]]], 3, Con47282), 
LCon20241 = conv2D_layer([[[[0.002, 0.9864]]]], 1, 1,[[[[0.9294, 0.2502], [0.2017, 0.7164]]]],[0, 0], 1, 1, false, 1, 1, Con20241), 
LZer25892 = zero_padding2D_layer(Con20241, 0, 0, 1, 0, Zer25892), 
LMin76743 = minimum_layer([Con47282,Zer25892], Min76743), 
LRes80734 = reshape_layer(Min76743, [1, 4], Res80734), 
LCon84268 = conv1D_layer(Res80734, 1,[[[0.7723, 0.0476], [0.6324, 0.1159], [0.9295, 0.9453], [0.95, 0.4663]]],[0, 0], 1, true, 1, Con84268), 
exec_layers([LPRe62570,LRes34499,LCon47282,LCon20241,LZer25892,LMin76743,LRes80734,LCon84268],["PRe62570","Res34499","Con47282","Con20241","Zer25892","Min76743","Res80734","Con84268"],Con84268,"Con84268")

Actual (Unparsed): [[[0.8584577, 0.5195785]]]

Expected (Unparsed): [[[0.85845766656,0.519578539272]]]

Actual:   [[[0.8585, 0.5196]]]

Expected: [[[0.8585, 0.5196]]]