import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min54501 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min54501 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dep26756 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Add21548 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Add21548 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Glo36669 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con35112 = tf.keras.layers.Input(shape=([16]))

Min54501 = keras.layers.Minimum(name = 'Min54501', )([in0Min54501,in1Min54501])
Dep26756 = keras.layers.DepthwiseConv2D((2, 1),strides=(2, 2), padding='same', name = 'Dep26756', )(in0Dep26756)
Zer90418 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer90418', )(Dep26756)
Max89404 = keras.layers.Maximum(name = 'Max89404', )([Min54501,Zer90418])
Res2324 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res2324', )(Max89404)
Zer65973 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer65973', )(Res2324)
Add21548 = keras.layers.Add(name = 'Add21548', )([in0Add21548,in1Add21548])
Zer36035 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (2, 0)), name = 'Zer36035', )(Add21548)
Max49940 = keras.layers.Maximum(name = 'Max49940', )([Zer65973,Zer36035])
Fla65110 = keras.layers.Flatten(name = 'Fla65110', )(Max49940)
Glo36669 = keras.layers.GlobalAveragePooling3D(name = 'Glo36669', )(in0Glo36669)
Den86340 = keras.layers.Dense(2,name = 'Den86340', )(Glo36669)
Con35112 = keras.layers.Concatenate(axis=1, name = 'Con35112', )([Den86340,in0Con35112])
Mul45160 = keras.layers.Multiply(name = 'Mul45160', )([Fla65110,Con35112])
model = tf.keras.models.Model(inputs=[in0Min54501,in1Min54501,in0Dep26756,in0Add21548,in1Add21548,in0Glo36669,in0Con35112], outputs=Mul45160)
w = model.get_layer('Dep26756').get_weights() 
w[0] = np.array([[[[0.7342], [0.5007]]], [[[0.9413], [0.3407]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep26756').set_weights(w) 
w = model.get_layer('Den86340').get_weights() 
w[0] = np.array([[0.4362, 0.4976]])
w[1] = np.array([0.7128, 0.1853])
model.get_layer('Den86340').set_weights(w) 
in0Min54501 = tf.constant([[[[0.1289, 0.1675], [0.5592, 0.9585]]]])
in1Min54501 = tf.constant([[[[0.7149, 0.7527], [0.3878, 0.6785]]]])
in0Dep26756 = tf.constant([[[[0.7575, 0.8817]], [[0.8739, 0.403]]]])
in0Add21548 = tf.constant([[[[[0.0118]]], [[[0.147]]]]])
in1Add21548 = tf.constant([[[[[0.039]]], [[[0.6253]]]]])
in0Glo36669 = tf.constant([[[[[1.1388], [1.7305]]]]])
in0Con35112 = tf.constant([[0.8448, 0.3501, 0.824, 0.0111, 0.7133, 0.2724, 0.4798, 0.5335, 0.4306, 0.9118, 0.4534, 0.8709, 0.2666, 0.1284, 0.607, 0.8405]])
print (np.array2string(model.predict([in0Min54501,in1Min54501,in0Dep26756,in0Add21548,in1Add21548,in0Glo36669,in0Con35112],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul45160.png')

LMin54501 = minimum_layer([[[[[0.1289, 0.1675], [0.5592, 0.9585]]]], [[[[0.7149, 0.7527], [0.3878, 0.6785]]]]], Min54501), 
LDep26756 = depthwise_conv2D_layer([[[[0.7575, 0.8817]], [[0.8739, 0.403]]]], 2, 1,[[[[0.7342], [0.5007]]], [[[0.9413], [0.3407]]]],[0, 0], 2, 2, true, Dep26756), 
LZer90418 = zero_padding2D_layer(Dep26756, 0, 0, 1, 0, Zer90418), 
LMax89404 = maximum_layer([Min54501,Zer90418], Max89404), 
LRes2324 = reshape_layer(Max89404, [1, 2, 2, 1], Res2324), 
LZer65973 = zero_padding3D_layer(Res2324, 1, 0, 1, 0, 1, 0, Zer65973), 
LAdd21548 = add_layer([[[[[[0.0118]]], [[[0.147]]]]], [[[[[0.039]]], [[[0.6253]]]]]], Add21548), 
LZer36035 = zero_padding3D_layer(Add21548, 0, 0, 2, 0, 2, 0, Zer36035), 
LMax49940 = maximum_layer([Zer65973,Zer36035], Max49940), 
LFla65110 = flatten_layer(Max49940, Fla65110), 
LGlo36669 = global_average_pooling3D_layer([[[[[1.1388], [1.7305]]]]], Glo36669), 
LDen86340 = dense_layer(Glo36669, [[0.4362, 0.4976]],[0.7128, 0.1853], Den86340), 
LCon35112 = concatenate_layer([Den86340,[[0.8448, 0.3501, 0.824, 0.0111, 0.7133, 0.2724, 0.4798, 0.5335, 0.4306, 0.9118, 0.4534, 0.8709, 0.2666, 0.1284, 0.607, 0.8405]]], 1, Con35112), 
LMul45160 = multiply_layer([Fla65110,Con35112], Mul45160), 
exec_layers([LMin54501,LDep26756,LZer90418,LMax89404,LRes2324,LZer65973,LAdd21548,LZer36035,LMax49940,LFla65110,LGlo36669,LDen86340,LCon35112,LMul45160],["Min54501","Dep26756","Zer90418","Max89404","Res2324","Zer65973","Add21548","Zer36035","Max49940","Fla65110","Glo36669","Den86340","Con35112","Mul45160"],Mul45160,"Mul45160")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0243738, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.1122590, 0.0446555, 0.0000000, 0.8369064, 0.6491181]]

Expected (Unparsed): [[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.02437384,0.0,0.0,0.0,0.0,0.11225900999999999,0.0446555,0.0,0.83690645199,0.6491181500000001]]

Actual:   [[0, 0, 0, 0, 0, 0, 0, 0, 0.0244, 0, 0, 0, 0, 0.1123, 0.0447, 0, 0.837, 0.6492]]

Expected: [[0, 0, 0, 0, 0, 0, 0, 0, 0.0244, 0, 0, 0, 0, 0.1123, 0.0447, 0, 0.837, 0.6492]]