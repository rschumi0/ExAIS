import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU89726 = tf.keras.layers.Input(shape=([2, 1]))

GRU89726 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU89726', )(in0GRU89726)
Den73149 = keras.layers.Dense(3,name = 'Den73149', )(GRU89726)
Fla72965 = keras.layers.Flatten(name = 'Fla72965', )(Den73149)
Res2765 = keras.layers.Reshape((3, 1), name = 'Res2765', )(Fla72965)
Res30925 = keras.layers.Reshape((3, 1, 1), name = 'Res30925', )(Res2765)
Loc88110 = keras.layers.LocallyConnected2D(3, (3, 1),strides=(1, 1), name = 'Loc88110', )(Res30925)
model = tf.keras.models.Model(inputs=[in0GRU89726], outputs=Loc88110)
w = model.get_layer('GRU89726').get_weights() 
w[0] = np.array([[6, 7, 7, 5, 7, 6]])
w[1] = np.array([[6, 10, 4, 2, 1, 1], [6, 1, 3, 2, 9, 10]])
w[2] = np.array([8, 5, 7, 4, 2, 7])
model.get_layer('GRU89726').set_weights(w) 
w = model.get_layer('Den73149').get_weights() 
w[0] = np.array([[0.0627, 0.2123, 0.2018], [0.5998, 0.5023, 0.4813]])
w[1] = np.array([0.3294, 0.3806, 0.3171])
model.get_layer('Den73149').set_weights(w) 
w = model.get_layer('Loc88110').get_weights() 
w[0] = np.array([[[0.2217, 0.793, 0.5953], [0.3434, 0.7634, 0.5542], [0.7707, 0.2129, 0.7402]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc88110').set_weights(w) 
in0GRU89726 = tf.constant([[[2], [2]]])
print (np.array2string(model.predict([in0GRU89726],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc88110.png')

LGRU89726 = gru_layer([[[2], [2]]],[[6, 7, 7, 5, 7, 6]],[[6, 10, 4, 2, 1, 1], [6, 1, 3, 2, 9, 10]],[8, 5, 7, 4, 2, 7], false, GRU89726), 
LDen73149 = dense_layer(GRU89726, [[0.0627, 0.2123, 0.2018], [0.5998, 0.5023, 0.4813]],[0.3294, 0.3806, 0.3171], Den73149), 
LFla72965 = flatten_layer(Den73149, Fla72965), 
LRes2765 = reshape_layer(Fla72965, [3, 1], Res2765), 
LRes30925 = reshape_layer(Res2765, [3, 1, 1], Res30925), 
LLoc88110 = locally_connected2D_layer(Res30925, 3, 1,[[[0.2217, 0.793, 0.5953], [0.3434, 0.7634, 0.5542], [0.7707, 0.2129, 0.7402]]],[[[0, 0, 0]]], 1, 1, Loc88110), 
exec_layers([LGRU89726,LDen73149,LFla72965,LRes2765,LRes30925,LLoc88110],["GRU89726","Den73149","Fla72965","Res2765","Res30925","Loc88110"],Loc88110,"Loc88110")

Actual (Unparsed): [[[[0.4481150, 0.6192748, 0.6417378]]]]

Expected (Unparsed): [[[[0.4481149985784664,0.6192748418250915,0.6417377723671595]]]]

Actual:   [[[[0.4482, 0.6193, 0.6418]]]]

Expected: [[[[0.4482, 0.6193, 0.6418]]]]