import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro99790 = tf.keras.layers.Input(shape=([1, 4]))
in0Dot88776 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot88776 = tf.keras.layers.Input(shape=([3, 2]))
in0Min79907 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min79907 = tf.keras.layers.Input(shape=([2, 2, 1]))

Cro99790 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro99790', )(in0Cro99790)
Res40526 = keras.layers.Reshape((1, 4, 1), name = 'Res40526', )(Cro99790)
Zer9957 = keras.layers.ZeroPadding2D(padding=((1, 0), (3, 0)), name = 'Zer9957', )(Res40526)
Dot88776 = keras.layers.Dot(axes=(1, 1), name = 'Dot88776', )([in0Dot88776,in1Dot88776])
Res59093 = keras.layers.Reshape((2, 2, 1), name = 'Res59093', )(Dot88776)
Res6934 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res6934', )(Res59093)
Zer20075 = keras.layers.ZeroPadding3D(padding=((2, 0), (0, 0), (0, 0)), name = 'Zer20075', )(Res6934)
Min79907 = keras.layers.Minimum(name = 'Min79907', )([in0Min79907,in1Min79907])
Res9473 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res9473', )(Min79907)
Up_38258 = keras.layers.UpSampling3D(size=(2, 1, 1), name = 'Up_38258', )(Res9473)
Ave43957 = keras.layers.Average(name = 'Ave43957', )([Zer20075,Up_38258])
Res42955 = keras.layers.Reshape((4, 2, 1), name = 'Res42955', )(Ave43957)
Cro8338 = keras.layers.Cropping2D(cropping=((2, 0), (1, 0)), name = 'Cro8338', )(Res42955)
Zer6200 = keras.layers.ZeroPadding2D(padding=((0, 0), (6, 0)), name = 'Zer6200', )(Cro8338)
Max31615 = keras.layers.Maximum(name = 'Max31615', )([Zer9957,Zer6200])
model = tf.keras.models.Model(inputs=[in0Cro99790,in0Dot88776,in1Dot88776,in0Min79907,in1Min79907], outputs=Max31615)
in0Cro99790 = tf.constant([[[1.3803, 1.7324, 1.9921, 1.1078]]])
in0Dot88776 = tf.constant([[[0.9476, 0.1532], [0.1996, 0.5293], [0.5352, 0.9006]]])
in1Dot88776 = tf.constant([[[0.2085, 0.4358], [0.2659, 0.7207], [0.7852, 0.3291]]])
in0Min79907 = tf.constant([[[[0.6864], [0.1307]], [[0.8669], [0.499]]]])
in1Min79907 = tf.constant([[[[0.8454], [0.7234]], [[0.3326], [0.3037]]]])
print (np.array2string(model.predict([in0Cro99790,in0Dot88776,in1Dot88776,in0Min79907,in1Min79907],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max31615.png')

LCro99790 = cropping1D_layer([[[1.3803, 1.7324, 1.9921, 1.1078]]], 0, 0, Cro99790), 
LRes40526 = reshape_layer(Cro99790, [1, 4, 1], Res40526), 
LZer9957 = zero_padding2D_layer(Res40526, 1, 0, 3, 0, Zer9957), 
LDot88776 = dot_layer([[[0.9476, 0.1532], [0.1996, 0.5293], [0.5352, 0.9006]]], [[[0.2085, 0.4358], [0.2659, 0.7207], [0.7852, 0.3291]]], 1, 1, Dot88776), 
LRes59093 = reshape_layer(Dot88776, [2, 2, 1], Res59093), 
LRes6934 = reshape_layer(Res59093, [2, 2, 1, 1], Res6934), 
LZer20075 = zero_padding3D_layer(Res6934, 2, 0, 0, 0, 0, 0, Zer20075), 
LMin79907 = minimum_layer([[[[[0.6864], [0.1307]], [[0.8669], [0.499]]]], [[[[0.8454], [0.7234]], [[0.3326], [0.3037]]]]], Min79907), 
LRes9473 = reshape_layer(Min79907, [2, 2, 1, 1], Res9473), 
LUp_38258 = up_sampling3D_layer(Res9473, 2, 1, 1, Up_38258), 
LAve43957 = average_layer([Zer20075,Up_38258], Ave43957), 
LRes42955 = reshape_layer(Ave43957, [4, 2, 1], Res42955), 
LCro8338 = cropping2D_layer(Res42955, 2, 0, 1, 0, Cro8338), 
LZer6200 = zero_padding2D_layer(Cro8338, 0, 0, 6, 0, Zer6200), 
LMax31615 = maximum_layer([Zer9957,Zer6200], Max31615), 
exec_layers([LCro99790,LRes40526,LZer9957,LDot88776,LRes59093,LRes6934,LZer20075,LMin79907,LRes9473,LUp_38258,LAve43957,LRes42955,LCro8338,LZer6200,LMax31615],["Cro99790","Res40526","Zer9957","Dot88776","Res59093","Res6934","Zer20075","Min79907","Res9473","Up_38258","Ave43957","Res42955","Cro8338","Zer6200","Max31615"],Max31615,"Max31615")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.5183251]], [[0.0000000], [0.0000000], [0.0000000], [1.3803000], [1.7323999], [1.9921000], [1.1078000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0],[0],[0],[0.51832506]],[[0],[0],[0],[1.3803],[1.7324],[1.9921],[1.1078]]]]

Actual:   [[[[0], [0], [0], [0], [0], [0], [0.5184]], [[0], [0], [0], [1.3803], [1.7324], [1.9921], [1.1078]]]]

Expected: [[[[0], [0], [0], [0], [0], [0], [0.5184]], [[0], [0], [0], [1.3803], [1.7324], [1.9921], [1.1078]]]]