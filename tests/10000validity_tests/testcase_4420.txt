import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add29444 = tf.keras.layers.Input(shape=([2, 1]))
in1Add29444 = tf.keras.layers.Input(shape=([2, 1]))
in0Thr83292 = tf.keras.layers.Input(shape=([2, 1]))
in0LST97782 = tf.keras.layers.Input(shape=([1, 2]))
in0Con29779 = tf.keras.layers.Input(shape=([3]))

Add29444 = keras.layers.Add(name = 'Add29444', )([in0Add29444,in1Add29444])
Thr83292 = keras.layers.ThresholdedReLU(theta=9.657030943900489, name = 'Thr83292', input_shape=(2, 1))(in0Thr83292)
Dot91458 = keras.layers.Dot(axes=(2, 2), name = 'Dot91458', )([Add29444,Thr83292])
Fla26045 = keras.layers.Flatten(name = 'Fla26045', )(Dot91458)
LST97782 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST97782', )(in0LST97782)
Con29779 = keras.layers.Concatenate(axis=1, name = 'Con29779', )([LST97782,in0Con29779])
Add40612 = keras.layers.Add(name = 'Add40612', )([Fla26045,Con29779])
Lay83613 = keras.layers.LayerNormalization(axis=1, epsilon=2.441685593786891, name = 'Lay83613', )(Add40612)
model = tf.keras.models.Model(inputs=[in0Add29444,in1Add29444,in0Thr83292,in0LST97782,in0Con29779], outputs=Lay83613)
w = model.get_layer('LST97782').get_weights() 
w[0] = np.array([[9, 7, 9, 10], [8, 1, 4, 2]])
w[1] = np.array([[8, 7, 9, 6]])
w[2] = np.array([5, 8, 10, 8])
model.get_layer('LST97782').set_weights(w) 
in0Add29444 = tf.constant([[[0.0659], [0.9314]]])
in1Add29444 = tf.constant([[[0.8718], [0.3443]]])
in0Thr83292 = tf.constant([[[0.7119], [0.7422]]])
in0LST97782 = tf.constant([[[4, 6]]])
in0Con29779 = tf.constant([[0.0224, 0.3928, 0.0425]])
print (np.array2string(model.predict([in0Add29444,in1Add29444,in0Thr83292,in0LST97782,in0Con29779],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay83613.png')

LAdd29444 = add_layer([[[[0.0659], [0.9314]]], [[[0.8718], [0.3443]]]], Add29444), 
LThr83292 = thresholded_relu_layer([[[0.7119], [0.7422]]], 9.657030943900489, Thr83292), 
LDot91458 = dot_layer(Add29444,Thr83292, 2, 2, Dot91458), 
LFla26045 = flatten_layer(Dot91458, Fla26045), 
LLST97782 = lstm_layer([[[4, 6]]],[[9, 7, 9, 10], [8, 1, 4, 2]],[[8, 7, 9, 6]],[5, 8, 10, 8], LST97782), 
LCon29779 = concatenate_layer([LST97782,[[0.0224, 0.3928, 0.0425]]], 1, Con29779), 
LAdd40612 = add_layer([Fla26045,Con29779], Add40612), 
LLay83613 = layer_normalization_layer(Add40612, 1, 2.441685593786891, Lay83613), 
exec_layers([LAdd29444,LThr83292,LDot91458,LFla26045,LLST97782,LCon29779,LAdd40612,LLay83613],["Add29444","Thr83292","Dot91458","Fla26045","LST97782","Con29779","Add40612","Lay83613"],Lay83613,"Lay83613")

Actual (Unparsed): [[0.2870034, -0.1774556, 0.0552784, -0.1648262]]

Expected (Unparsed): [[0.2870033920422705,-0.17745562142473778,0.05527838655147636,-0.16482615716900909]]

Actual:   [[0.2871, -0.1774, 0.0553, -0.1648]]

Expected: [[0.2871, -0.1774, 0.0553, -0.1648]]