import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min32720 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min32720 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con37717 = tf.keras.layers.Input(shape=([1, 2, 1, 3]))
in0PRe27177 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Glo38619 = tf.keras.layers.Input(shape=([1, 2]))
in0Con45836 = tf.keras.layers.Input(shape=([1, 2]))
in0Add63253 = tf.keras.layers.Input(shape=([1, 1]))
in1Add63253 = tf.keras.layers.Input(shape=([1, 1]))
in0Con95553 = tf.keras.layers.Input(shape=([1, 2]))
in0Loc35999 = tf.keras.layers.Input(shape=([2, 1]))
in0Con38443 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Min32720 = keras.layers.Minimum(name = 'Min32720', )([in0Min32720,in1Min32720])
Res96790 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res96790', )(Min32720)
Con37717 = keras.layers.Concatenate(axis=4, name = 'Con37717', )([Res96790,in0Con37717])
PRe27177 = keras.layers.PReLU(name = 'PRe27177', input_shape=(2, 2, 1, 1))(in0PRe27177)
Con6205 = keras.layers.Conv3D(4, (2, 2, 1),strides=(11, 2, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con6205', )(PRe27177)
Zer89624 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer89624', )(Con6205)
Add18300 = keras.layers.Add(name = 'Add18300', )([Con37717,Zer89624])
Glo38619 = keras.layers.GlobalAveragePooling1D(name = 'Glo38619', )(in0Glo38619)
Res46319 = keras.layers.Reshape((2, 1), name = 'Res46319', )(Glo38619)
Cro47857 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro47857', )(Res46319)
Con45836 = keras.layers.Concatenate(axis=2, name = 'Con45836', )([Cro47857,in0Con45836])
Add63253 = keras.layers.Add(name = 'Add63253', )([in0Add63253,in1Add63253])
Con95553 = keras.layers.Concatenate(axis=2, name = 'Con95553', )([Add63253,in0Con95553])
Loc35999 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc35999', )(in0Loc35999)
Min39300 = keras.layers.Minimum(name = 'Min39300', )([Con95553,Loc35999])
Ave39759 = keras.layers.Average(name = 'Ave39759', )([Con45836,Min39300])
Res33168 = keras.layers.Reshape((1, 3, 1), name = 'Res33168', )(Ave39759)
Res75198 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res75198', )(Res33168)
Con20486 = keras.layers.Conv3D(3, (1, 2, 1),strides=(11, 12, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con20486', )(Res75198)
Zer66199 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer66199', )(Con20486)
Con38443 = keras.layers.Concatenate(axis=4, name = 'Con38443', )([Zer66199,in0Con38443])
Mul81133 = keras.layers.Multiply(name = 'Mul81133', )([Add18300,Con38443])
model = tf.keras.models.Model(inputs=[in0Min32720,in1Min32720,in0Con37717,in0PRe27177,in0Glo38619,in0Con45836,in0Add63253,in1Add63253,in0Con95553,in0Loc35999,in0Con38443], outputs=Mul81133)
w = model.get_layer('PRe27177').get_weights() 
w[0] = np.array([[[[0.0811]], [[0.8747]]], [[[0.5111]], [[0.3819]]]])
model.get_layer('PRe27177').set_weights(w) 
w = model.get_layer('Con6205').get_weights() 
w[0] = np.array([[[[[0.3871, 0.821, 0.9716, 0.8235]]], [[[0.3208, 0.7616, 0.7114, 0.7218]]]], [[[[0.2075, 0.3888, 0.8468, 0.3402]]], [[[0.2394, 0.4858, 0.5548, 0.7061]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con6205').set_weights(w) 
w = model.get_layer('Loc35999').get_weights() 
w[0] = np.array([[[0.1131, 0.2357, 0.937], [0.2217, 0.9901, 0.4391]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc35999').set_weights(w) 
w = model.get_layer('Con20486').get_weights() 
w[0] = np.array([[[[[0.8414, 0.5554, 0.5582]]], [[[0.2144, 0.3274, 0.3592]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con20486').set_weights(w) 
in0Min32720 = tf.constant([[[[0.8952], [0.3026]]]])
in1Min32720 = tf.constant([[[[0.0109], [0.7605]]]])
in0Con37717 = tf.constant([[[[[0.1116, 0.9809, 0.6293]], [[0.5115, 0.1157, 0.8044]]]]])
in0PRe27177 = tf.constant([[[[[0.1512]], [[0.9423]]], [[[0.9049]], [[0.9589]]]]])
in0Glo38619 = tf.constant([[[1.3036, 1.2975]]])
in0Con45836 = tf.constant([[[0.7401, 0.8132]]])
in0Add63253 = tf.constant([[[0.4839]]])
in1Add63253 = tf.constant([[[0.351]]])
in0Con95553 = tf.constant([[[0.4292, 0.5766]]])
in0Loc35999 = tf.constant([[[0.2943], [0.6353]]])
in0Con38443 = tf.constant([[[[[0.2438]], [[0.6708]]]]])
print (np.array2string(model.predict([in0Min32720,in1Min32720,in0Con37717,in0PRe27177,in0Glo38619,in0Con45836,in0Add63253,in1Add63253,in0Con95553,in0Loc35999,in0Con38443],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul81133.png')

LMin32720 = minimum_layer([[[[[0.8952], [0.3026]]]], [[[[0.0109], [0.7605]]]]], Min32720), 
LRes96790 = reshape_layer(Min32720, [1, 2, 1, 1], Res96790), 
LCon37717 = concatenate_layer([Res96790,[[[[[0.1116, 0.9809, 0.6293]], [[0.5115, 0.1157, 0.8044]]]]]], 4, Con37717), 
LPRe27177 = prelu_layer([[[[[0.1512]], [[0.9423]]], [[[0.9049]], [[0.9589]]]]], [[[[0.0811]], [[0.8747]]], [[[0.5111]], [[0.3819]]]], PRe27177), 
LCon6205 = conv3D_layer(PRe27177, 2, 2, 1,[[[[[0.3871, 0.821, 0.9716, 0.8235]]], [[[0.3208, 0.7616, 0.7114, 0.7218]]]], [[[[0.2075, 0.3888, 0.8468, 0.3402]]], [[[0.2394, 0.4858, 0.5548, 0.7061]]]]],[0, 0, 0, 0], 11, 2, 1, true, 1, 1, 1, Con6205), 
LZer89624 = zero_padding3D_layer(Con6205, 0, 0, 1, 0, 0, 0, Zer89624), 
LAdd18300 = add_layer([Con37717,Zer89624], Add18300), 
LGlo38619 = global_average_pooling1D_layer([[[1.3036, 1.2975]]], Glo38619), 
LRes46319 = reshape_layer(Glo38619, [2, 1], Res46319), 
LCro47857 = cropping1D_layer(Res46319, 1, 0, Cro47857), 
LCon45836 = concatenate_layer([Cro47857,[[[0.7401, 0.8132]]]], 2, Con45836), 
LAdd63253 = add_layer([[[[0.4839]]], [[[0.351]]]], Add63253), 
LCon95553 = concatenate_layer([Add63253,[[[0.4292, 0.5766]]]], 2, Con95553), 
LLoc35999 = locally_connected1D_layer([[[0.2943], [0.6353]]], 2,[[[0.1131, 0.2357, 0.937], [0.2217, 0.9901, 0.4391]]],[[0, 0, 0]], 1, Loc35999), 
LMin39300 = minimum_layer([Con95553,Loc35999], Min39300), 
LAve39759 = average_layer([Con45836,Min39300], Ave39759), 
LRes33168 = reshape_layer(Ave39759, [1, 3, 1], Res33168), 
LRes75198 = reshape_layer(Res33168, [1, 3, 1, 1], Res75198), 
LCon20486 = conv3D_layer(Res75198, 1, 2, 1,[[[[[0.8414, 0.5554, 0.5582]]], [[[0.2144, 0.3274, 0.3592]]]]],[0, 0, 0], 11, 12, 1, true, 1, 1, 1, Con20486), 
LZer66199 = zero_padding3D_layer(Con20486, 0, 0, 1, 0, 0, 0, Zer66199), 
LCon38443 = concatenate_layer([Zer66199,[[[[[0.2438]], [[0.6708]]]]]], 4, Con38443), 
LMul81133 = multiply_layer([Add18300,Con38443], Mul81133), 
exec_layers([LMin32720,LRes96790,LCon37717,LPRe27177,LCon6205,LZer89624,LAdd18300,LGlo38619,LRes46319,LCro47857,LCon45836,LAdd63253,LCon95553,LLoc35999,LMin39300,LAve39759,LRes33168,LRes75198,LCon20486,LZer66199,LCon38443,LMul81133],["Min32720","Res96790","Con37717","PRe27177","Con6205","Zer89624","Add18300","Glo38619","Res46319","Cro47857","Con45836","Add63253","Con95553","Loc35999","Min39300","Ave39759","Res33168","Res75198","Con20486","Zer66199","Con38443","Mul81133"],Mul81133,"Mul81133")

Actual (Unparsed): [[[[[0.0000000, 0.0000000, 0.0000000, 0.1534233]], [[0.8045774, 1.3027574, 1.3850076, 1.7400495]]]]]

Expected (Unparsed): [[[[[0.0,0.0,0.0,0.15342334]],[[0.8045773494960183,1.3027574139446776,1.3850075654986334,1.7400495719879998]]]]]

Actual:   [[[[[0, 0, 0, 0.1535]], [[0.8046, 1.3028, 1.3851, 1.7401]]]]]

Expected: [[[[[0, 0, 0, 0.1535]], [[0.8046, 1.3028, 1.3851, 1.7401]]]]]