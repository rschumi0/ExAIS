import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc9226 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Add25648 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Add25648 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min24619 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min24619 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Mul84006 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul84006 = tf.keras.layers.Input(shape=([1, 2]))
in0Con31603 = tf.keras.layers.Input(shape=([1, 2]))
in0Con27423 = tf.keras.layers.Input(shape=([2, 8]))

Loc9226 = keras.layers.LocallyConnected2D(2, (2, 1),strides=(1, 1), name = 'Loc9226', )(in0Loc9226)
Zer31415 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer31415', )(Loc9226)
Add25648 = keras.layers.Add(name = 'Add25648', )([in0Add25648,in1Add25648])
Max63086 = keras.layers.Maximum(name = 'Max63086', )([Zer31415,Add25648])
Res62677 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res62677', )(Max63086)
Con40544 = keras.layers.Conv3D(3, (1, 2, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con40544', )(Res62677)
Res95467 = keras.layers.Reshape((2, 2, 6), name = 'Res95467', )(Con40544)
Res42181 = keras.layers.Reshape((2, 12), name = 'Res42181', )(Res95467)
Min24619 = keras.layers.Minimum(name = 'Min24619', )([in0Min24619,in1Min24619])
Res7069 = keras.layers.Reshape((1, 2, 2), name = 'Res7069', )(Min24619)
Res60526 = keras.layers.Reshape((1, 4), name = 'Res60526', )(Res7069)
Mul84006 = keras.layers.Multiply(name = 'Mul84006', )([in0Mul84006,in1Mul84006])
Con31603 = keras.layers.Concatenate(axis=2, name = 'Con31603', )([Mul84006,in0Con31603])
Sub13032 = keras.layers.Subtract(name = 'Sub13032', )([Res60526,Con31603])
Zer66098 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer66098', )(Sub13032)
Con27423 = keras.layers.Concatenate(axis=2, name = 'Con27423', )([Zer66098,in0Con27423])
Min69368 = keras.layers.Minimum(name = 'Min69368', )([Res42181,Con27423])
model = tf.keras.models.Model(inputs=[in0Loc9226,in0Add25648,in1Add25648,in0Min24619,in1Min24619,in0Mul84006,in1Mul84006,in0Con31603,in0Con27423], outputs=Min69368)
w = model.get_layer('Loc9226').get_weights() 
w[0] = np.array([[[0.3388, 0.3839], [0.9653, 0.6774], [0.164, 0.1262], [0.777, 0.0113]], [[0.1187, 0.2451], [0.4688, 0.119], [0.8927, 0.6493], [0.4145, 0.4795]]])
w[1] = np.array([[[0, 0], [0, 0]]])
model.get_layer('Loc9226').set_weights(w) 
w = model.get_layer('Con40544').get_weights() 
w[0] = np.array([[[[[0.4257, 0.6603, 0.7848]]], [[[0.6378, 0.732, 0.3363]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con40544').set_weights(w) 
in0Loc9226 = tf.constant([[[[0.8718, 0.2822], [0.0538, 0.6789]], [[0.2641, 0.4815], [0.5236, 0.3816]]]])
in0Add25648 = tf.constant([[[[0.6401, 0.649], [0.7168, 0.5113]], [[0.0381, 0.0234], [0.632, 0.2899]]]])
in1Add25648 = tf.constant([[[[0.1104, 0.5527], [0.6031, 0.442]], [[0.0092, 0.7209], [0.9313, 0.1859]]]])
in0Min24619 = tf.constant([[[[[0.6085, 0.1547]], [[0.7417, 0.7538]]]]])
in1Min24619 = tf.constant([[[[[0.1628, 0.2024]], [[0.9411, 0.5545]]]]])
in0Mul84006 = tf.constant([[[0.3775, 0.1522]]])
in1Mul84006 = tf.constant([[[0.7974, 0.9603]]])
in0Con31603 = tf.constant([[[0.174, 0.3879]]])
in0Con27423 = tf.constant([[[0.7591, 0.3341, 0.1727, 0.5091, 0.6041, 0.761, 0.165, 0.5001], [0.6322, 0.2194, 0.7857, 0.7696, 0.1526, 0.3606, 0.871, 0.3101]]])
print (np.array2string(model.predict([in0Loc9226,in0Add25648,in1Add25648,in0Min24619,in1Min24619,in0Mul84006,in1Mul84006,in0Con31603,in0Con27423],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min69368.png')

LLoc9226 = locally_connected2D_layer([[[[0.8718, 0.2822], [0.0538, 0.6789]], [[0.2641, 0.4815], [0.5236, 0.3816]]]], 2, 1,[[[0.3388, 0.3839], [0.9653, 0.6774], [0.164, 0.1262], [0.777, 0.0113]], [[0.1187, 0.2451], [0.4688, 0.119], [0.8927, 0.6493], [0.4145, 0.4795]]],[[[0, 0], [0, 0]]], 1, 1, Loc9226), 
LZer31415 = zero_padding2D_layer(Loc9226, 1, 0, 0, 0, Zer31415), 
LAdd25648 = add_layer([[[[[0.6401, 0.649], [0.7168, 0.5113]], [[0.0381, 0.0234], [0.632, 0.2899]]]], [[[[0.1104, 0.5527], [0.6031, 0.442]], [[0.0092, 0.7209], [0.9313, 0.1859]]]]], Add25648), 
LMax63086 = maximum_layer([Zer31415,Add25648], Max63086), 
LRes62677 = reshape_layer(Max63086, [2, 2, 2, 1], Res62677), 
LCon40544 = conv3D_layer(Res62677, 1, 2, 1,[[[[[0.4257, 0.6603, 0.7848]]], [[[0.6378, 0.732, 0.3363]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con40544), 
LRes95467 = reshape_layer(Con40544, [2, 2, 6], Res95467), 
LRes42181 = reshape_layer(Res95467, [2, 12], Res42181), 
LMin24619 = minimum_layer([[[[[[0.6085, 0.1547]], [[0.7417, 0.7538]]]]], [[[[[0.1628, 0.2024]], [[0.9411, 0.5545]]]]]], Min24619), 
LRes7069 = reshape_layer(Min24619, [1, 2, 2], Res7069), 
LRes60526 = reshape_layer(Res7069, [1, 4], Res60526), 
LMul84006 = multiply_layer([[[[0.3775, 0.1522]]], [[[0.7974, 0.9603]]]], Mul84006), 
LCon31603 = concatenate_layer([Mul84006,[[[0.174, 0.3879]]]], 2, Con31603), 
LSub13032 = subtract_layer(Res60526,Con31603, Sub13032), 
LZer66098 = zero_padding1D_layer(Sub13032, 1, 0, Zer66098), 
LCon27423 = concatenate_layer([Zer66098,[[[0.7591, 0.3341, 0.1727, 0.5091, 0.6041, 0.761, 0.165, 0.5001], [0.6322, 0.2194, 0.7857, 0.7696, 0.1526, 0.3606, 0.871, 0.3101]]]], 2, Con27423), 
LMin69368 = minimum_layer([Res42181,Con27423], Min69368), 
exec_layers([LLoc9226,LZer31415,LAdd25648,LMax63086,LRes62677,LCon40544,LRes95467,LRes42181,LMin24619,LRes7069,LRes60526,LMul84006,LCon31603,LSub13032,LZer66098,LCon27423,LMin69368],["Loc9226","Zer31415","Add25648","Max63086","Res62677","Con40544","Res95467","Res42181","Min24619","Res7069","Res60526","Mul84006","Con31603","Sub13032","Zer66098","Con27423","Min69368"],Min69368,"Min69368")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.7591000, 0.3341000, 0.1727000, 0.5091000, 0.6041000, 0.4058198, 0.1650000, 0.5001000], [-0.1382185, 0.0085423, 0.5677000, 0.1666000, 0.6322000, 0.2194000, 0.6654968, 0.7696000, 0.1526000, 0.2626255, 0.4073563, 0.3101000]]]

Expected (Unparsed): [[[0,0,0,0,0.7591,0.3341,0.1727,0.5091,0.6041,0.40581981000000006,0.165,0.5001],[-0.13821850000000002,0.00854234000000001,0.5677000000000001,0.16659999999999997,0.6322,0.2194,0.66549681,0.7696,0.1526,0.26262546631199996,0.4073563434479999,0.3101]]]

Actual:   [[[0, 0, 0, 0, 0.7591, 0.3341, 0.1727, 0.5091, 0.6041, 0.4059, 0.165, 0.5001], [-0.1382, 0.0086, 0.5677, 0.1666, 0.6322, 0.2194, 0.6655, 0.7696, 0.1526, 0.2627, 0.4074, 0.3101]]]

Expected: [[[0, 0, 0, 0, 0.7591, 0.3341, 0.1727, 0.5091, 0.6041, 0.4059, 0.165, 0.5001], [-0.1382, 0.0086, 0.5678, 0.1666, 0.6322, 0.2194, 0.6655, 0.7696, 0.1526, 0.2627, 0.4074, 0.3101]]]