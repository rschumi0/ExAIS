import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc98414 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con81315 = tf.keras.layers.Input(shape=([2, 1]))
in0Loc91303 = tf.keras.layers.Input(shape=([2, 2]))
in0ReL14890 = tf.keras.layers.Input(shape=([2, 1]))
in0Con96467 = tf.keras.layers.Input(shape=([2, 3]))
in0Glo81554 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Cro11839 = tf.keras.layers.Input(shape=([2, 2, 1]))

Loc98414 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc98414', )(in0Loc98414)
Res22664 = keras.layers.Reshape((1, 3), name = 'Res22664', )(Loc98414)
Zer39001 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer39001', )(Res22664)
Con81315 = keras.layers.Concatenate(axis=2, name = 'Con81315', )([Zer39001,in0Con81315])
Loc91303 = keras.layers.LocallyConnected1D(4, (2),strides=(2), name = 'Loc91303', )(in0Loc91303)
Zer75001 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer75001', )(Loc91303)
ReL14890 = keras.layers.ReLU(max_value=1.9233912871787886, negative_slope=0.3048230902576336, threshold=2.649106525454256, name = 'ReL14890', input_shape=(2, 1))(in0ReL14890)
Con96467 = keras.layers.Concatenate(axis=2, name = 'Con96467', )([ReL14890,in0Con96467])
Min38681 = keras.layers.Minimum(name = 'Min38681', )([Zer75001,Con96467])
Ave86410 = keras.layers.Average(name = 'Ave86410', )([Con81315,Min38681])
Res78877 = keras.layers.Reshape((2, 4, 1), name = 'Res78877', )(Ave86410)
Glo81554 = keras.layers.GlobalMaxPool3D(name = 'Glo81554', )(in0Glo81554)
Res414 = keras.layers.Reshape((2, 1), name = 'Res414', )(Glo81554)
Res41943 = keras.layers.Reshape((2, 1, 1), name = 'Res41943', )(Res414)
Cro11839 = keras.layers.Cropping2D(cropping=((0, 0), (1, 0)), name = 'Cro11839', )(in0Cro11839)
Add56932 = keras.layers.Add(name = 'Add56932', )([Res41943,Cro11839])
Zer13786 = keras.layers.ZeroPadding2D(padding=((0, 0), (3, 0)), name = 'Zer13786', )(Add56932)
Add78792 = keras.layers.Add(name = 'Add78792', )([Res78877,Zer13786])
model = tf.keras.models.Model(inputs=[in0Loc98414,in0Con81315,in0Loc91303,in0ReL14890,in0Con96467,in0Glo81554,in0Cro11839], outputs=Add78792)
w = model.get_layer('Loc98414').get_weights() 
w[0] = np.array([[[0.9317, 0.471, 0.9487], [0.5921, 0.0855, 0.1766]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc98414').set_weights(w) 
w = model.get_layer('Loc91303').get_weights() 
w[0] = np.array([[[0.2955, 0.1175, 0.0943, 0.0962], [0.7485, 0.1625, 0.6383, 0.3116], [0.5703, 0.6548, 0.6621, 0.0612], [0.961, 0.3888, 0.8562, 0.638]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc91303').set_weights(w) 
in0Loc98414 = tf.constant([[[[0.5752, 0.6598]]]])
in0Con81315 = tf.constant([[[0.2614], [0.0544]]])
in0Loc91303 = tf.constant([[[0.0752, 0.4932], [0.8679, 0.8583]]])
in0ReL14890 = tf.constant([[[0.3682], [0.5933]]])
in0Con96467 = tf.constant([[[0.1964, 0.3801, 0.4782], [0.5559, 0.375, 0.8613]]])
in0Glo81554 = tf.constant([[[[[1.7607, 1.7769], [1.7287, 1.9749]]], [[[1.3491, 1.4693], [1.3807, 1.0665]]]]])
in0Cro11839 = tf.constant([[[[1.4705], [1.1375]], [[1.4713], [1.4994]]]])
print (np.array2string(model.predict([in0Loc98414,in0Con81315,in0Loc91303,in0ReL14890,in0Con96467,in0Glo81554,in0Cro11839],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add78792.png')

LLoc98414 = locally_connected2D_layer([[[[0.5752, 0.6598]]]], 1, 1,[[[0.9317, 0.471, 0.9487], [0.5921, 0.0855, 0.1766]]],[[[0, 0, 0]]], 1, 1, Loc98414), 
LRes22664 = reshape_layer(Loc98414, [1, 3], Res22664), 
LZer39001 = zero_padding1D_layer(Res22664, 1, 0, Zer39001), 
LCon81315 = concatenate_layer([Zer39001,[[[0.2614], [0.0544]]]], 2, Con81315), 
LLoc91303 = locally_connected1D_layer([[[0.0752, 0.4932], [0.8679, 0.8583]]], 2,[[[0.2955, 0.1175, 0.0943, 0.0962], [0.7485, 0.1625, 0.6383, 0.3116], [0.5703, 0.6548, 0.6621, 0.0612], [0.961, 0.3888, 0.8562, 0.638]]],[[0, 0, 0, 0]], 2, Loc91303), 
LZer75001 = zero_padding1D_layer(Loc91303, 1, 0, Zer75001), 
LReL14890 = relu_layer([[[0.3682], [0.5933]]], 1.9233912871787886, 0.3048230902576336, 2.649106525454256, ReL14890), 
LCon96467 = concatenate_layer([ReL14890,[[[0.1964, 0.3801, 0.4782], [0.5559, 0.375, 0.8613]]]], 2, Con96467), 
LMin38681 = minimum_layer([Zer75001,Con96467], Min38681), 
LAve86410 = average_layer([Con81315,Min38681], Ave86410), 
LRes78877 = reshape_layer(Ave86410, [2, 4, 1], Res78877), 
LGlo81554 = global_max_pool3D_layer([[[[[1.7607, 1.7769], [1.7287, 1.9749]]], [[[1.3491, 1.4693], [1.3807, 1.0665]]]]], Glo81554), 
LRes414 = reshape_layer(Glo81554, [2, 1], Res414), 
LRes41943 = reshape_layer(Res414, [2, 1, 1], Res41943), 
LCro11839 = cropping2D_layer([[[[1.4705], [1.1375]], [[1.4713], [1.4994]]]], 0, 0, 1, 0, Cro11839), 
LAdd56932 = add_layer([Res41943,Cro11839], Add56932), 
LZer13786 = zero_padding2D_layer(Add56932, 0, 0, 3, 0, Zer13786), 
LAdd78792 = add_layer([Res78877,Zer13786], Add78792), 
exec_layers([LLoc98414,LRes22664,LZer39001,LCon81315,LLoc91303,LZer75001,LReL14890,LCon96467,LMin38681,LAve86410,LRes78877,LGlo81554,LRes414,LRes41943,LCro11839,LAdd56932,LZer13786,LAdd78792],["Loc98414","Res22664","Zer39001","Con81315","Loc91303","Zer75001","ReL14890","Con96467","Min38681","Ave86410","Res78877","Glo81554","Res414","Res41943","Cro11839","Add56932","Zer13786","Add78792"],Add78792,"Add78792")

Actual (Unparsed): [[[[-0.3476365], [0.0000000], [0.0000000], [3.0289000]], [[0.1499621], [0.4416160], [0.5186065], [3.8823131]]]]

Expected (Unparsed): [[[[-0.347636487838884],[0],[0],[3.0289]],[[0.14996206096961262],[0.44161605],[0.51860646],[3.8823131200000005]]]]

Actual:   [[[[-0.3476], [0], [0], [3.0289]], [[0.15], [0.4417], [0.5187], [3.8824]]]]

Expected: [[[[-0.3476], [0], [0], [3.0289]], [[0.15], [0.4417], [0.5187], [3.8824]]]]