import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer49335 = tf.keras.layers.Input(shape=([1, 2]))
in0Con89260 = tf.keras.layers.Input(shape=([3, 2, 3]))
in0Add38541 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add38541 = tf.keras.layers.Input(shape=([2, 2, 1]))

Zer49335 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer49335', )(in0Zer49335)
Res9590 = keras.layers.Reshape((3, 2, 1), name = 'Res9590', )(Zer49335)
Con89260 = keras.layers.Concatenate(axis=3, name = 'Con89260', )([Res9590,in0Con89260])
Add38541 = keras.layers.Add(name = 'Add38541', )([in0Add38541,in1Add38541])
Loc93460 = keras.layers.LocallyConnected2D(4, (2, 2),strides=(1, 1), name = 'Loc93460', )(Add38541)
Zer40700 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer40700', )(Loc93460)
Max79472 = keras.layers.Maximum(name = 'Max79472', )([Con89260,Zer40700])
model = tf.keras.models.Model(inputs=[in0Zer49335,in0Con89260,in0Add38541,in1Add38541], outputs=Max79472)
w = model.get_layer('Loc93460').get_weights() 
w[0] = np.array([[[0.848, 0.1186, 0.5755, 0.752], [0.8246, 0.9675, 0.7046, 0.9243], [0.3933, 0.5601, 0.0736, 0.3941], [0.2936, 0.2203, 0.4972, 0.2317]]])
w[1] = np.array([[[0, 0, 0, 0]]])
model.get_layer('Loc93460').set_weights(w) 
in0Zer49335 = tf.constant([[[1.6918, 1.5726]]])
in0Con89260 = tf.constant([[[[0.6203, 0.9256, 0.3069], [0.1848, 0.9155, 0.5361]], [[0.5714, 0.7149, 0.2708], [0.1506, 0.0509, 0.9989]], [[0.0866, 0.2462, 0.3861], [0.1153, 0.842, 0.4243]]]])
in0Add38541 = tf.constant([[[[0.4233], [0.2877]], [[0.4802], [0.7812]]]])
in1Add38541 = tf.constant([[[[0.0351], [0.8169]], [[0.1061], [0.9541]]]])
print (np.array2string(model.predict([in0Zer49335,in0Con89260,in0Add38541,in1Add38541],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max79472.png')

LZer49335 = zero_padding1D_layer([[[1.6918, 1.5726]]], 1, 1, Zer49335), 
LRes9590 = reshape_layer(Zer49335, [3, 2, 1], Res9590), 
LCon89260 = concatenate_layer([Res9590,[[[[0.6203, 0.9256, 0.3069], [0.1848, 0.9155, 0.5361]], [[0.5714, 0.7149, 0.2708], [0.1506, 0.0509, 0.9989]], [[0.0866, 0.2462, 0.3861], [0.1153, 0.842, 0.4243]]]]], 3, Con89260), 
LAdd38541 = add_layer([[[[[0.4233], [0.2877]], [[0.4802], [0.7812]]]], [[[[0.0351], [0.8169]], [[0.1061], [0.9541]]]]], Add38541), 
LLoc93460 = locally_connected2D_layer(Add38541, 2, 2,[[[0.848, 0.1186, 0.5755, 0.752], [0.8246, 0.9675, 0.7046, 0.9243], [0.3933, 0.5601, 0.0736, 0.3941], [0.2936, 0.2203, 0.4972, 0.2317]]],[[[0, 0, 0, 0]]], 1, 1, Loc93460), 
LZer40700 = zero_padding2D_layer(Loc93460, 2, 0, 1, 0, Zer40700), 
LMax79472 = maximum_layer([Con89260,Zer40700], Max79472), 
exec_layers([LZer49335,LRes9590,LCon89260,LAdd38541,LLoc93460,LZer40700,LMax79472],["Zer49335","Res9590","Con89260","Add38541","Loc93460","Zer40700","Max79472"],Max79472,"Max79472")

Actual (Unparsed): [[[[0.0000000, 0.6203000, 0.9256000, 0.3069000], [0.0000000, 0.1848000, 0.9155000, 0.5361000]], [[1.6918000, 0.5714000, 0.7149000, 0.2708000], [1.5726000, 0.1506000, 0.0509000, 0.9989000]], [[0.0000000, 0.0866000, 0.2462000, 0.3861000], [2.0396522, 1.8337400, 1.9480532, 1.9988284]]]]

Expected (Unparsed): [[[[0,0.6203,0.9256,0.3069],[0,0.1848,0.9155,0.5361]],[[1.6918,0.5714,0.7149,0.2708],[1.5726,0.1506,0.0509,0.9989]],[[0,0.0866,0.2462,0.3861],[2.03965223,1.83373996,1.9480532000000002,1.9988284200000002]]]]

Actual:   [[[[0, 0.6203, 0.9256, 0.3069], [0, 0.1848, 0.9155, 0.5361]], [[1.6918, 0.5714, 0.7149, 0.2708], [1.5726, 0.1506, 0.0509, 0.9989]], [[0, 0.0866, 0.2462, 0.3861], [2.0397, 1.8338, 1.9481, 1.9989]]]]

Expected: [[[[0, 0.6203, 0.9256, 0.3069], [0, 0.1848, 0.9155, 0.5361]], [[1.6918, 0.5714, 0.7149, 0.2708], [1.5726, 0.1506, 0.0509, 0.9989]], [[0, 0.0866, 0.2462, 0.3861], [2.0397, 1.8338, 1.9481, 1.9989]]]]