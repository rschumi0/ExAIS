import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min66951 = tf.keras.layers.Input(shape=([2, 2]))
in1Min66951 = tf.keras.layers.Input(shape=([2, 2]))

Min66951 = keras.layers.Minimum(name = 'Min66951', )([in0Min66951,in1Min66951])
Sim16772 = keras.layers.SimpleRNN(2,name = 'Sim16772', )(Min66951)
Res80419 = keras.layers.Reshape((2, 1), name = 'Res80419', )(Sim16772)
Per72567 = keras.layers.Permute((1,2), name = 'Per72567',)(Res80419)
Res45219 = keras.layers.Reshape((2, 1, 1), name = 'Res45219', )(Per72567)
Res57327 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res57327', )(Res45219)
Con81175 = keras.layers.Conv3D(2, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con81175', )(Res57327)
model = tf.keras.models.Model(inputs=[in0Min66951,in1Min66951], outputs=Con81175)
w = model.get_layer('Sim16772').get_weights() 
w[0] = np.array([[1, 8], [9, 9]])
w[1] = np.array([[7, 8], [3, 3]])
w[2] = np.array([9, 7])
model.get_layer('Sim16772').set_weights(w) 
w = model.get_layer('Con81175').get_weights() 
w[0] = np.array([[[[[0.969, 0.3353]]]], [[[[0.5572, 0.1024]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con81175').set_weights(w) 
in0Min66951 = tf.constant([[[0.4882, 0.9262], [0.2484, 0.2603]]])
in1Min66951 = tf.constant([[[0.213, 0.6872], [0.1075, 0.6948]]])
print (np.array2string(model.predict([in0Min66951,in1Min66951],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con81175.png')

LMin66951 = minimum_layer([[[[0.4882, 0.9262], [0.2484, 0.2603]]], [[[0.213, 0.6872], [0.1075, 0.6948]]]], Min66951), 
LSim16772 = simple_rnn_layer(Min66951,[[1, 8], [9, 9]],[[7, 8], [3, 3]],[9, 7], Sim16772), 
LRes80419 = reshape_layer(Sim16772, [2, 1], Res80419), 
LPer72567 = permute_layer(Res80419, 1,2, Per72567), 
LRes45219 = reshape_layer(Per72567, [2, 1, 1], Res45219), 
LRes57327 = reshape_layer(Res45219, [2, 1, 1, 1], Res57327), 
LCon81175 = conv3D_layer(Res57327, 2, 1, 1,[[[[[0.969, 0.3353]]]], [[[[0.5572, 0.1024]]]]],[0, 0], 1, 1, 1, true, 1, 1, 1, Con81175), 
exec_layers([LMin66951,LSim16772,LRes80419,LPer72567,LRes45219,LRes57327,LCon81175],["Min66951","Sim16772","Res80419","Per72567","Res45219","Res57327","Con81175"],Con81175,"Con81175")

Actual (Unparsed): [[[[[1.5262000, 0.4377000]]], [[[0.9690000, 0.3353000]]]]]

Expected (Unparsed): [[[[[1.5262,0.4377]]],[[[0.969,0.3353]]]]]

Actual:   [[[[[1.5262, 0.4377]]], [[[0.969, 0.3353]]]]]

Expected: [[[[[1.5262, 0.4377]]], [[[0.969, 0.3353]]]]]