import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ELU70106 = tf.keras.layers.Input(shape=([2, 1]))

ELU70106 = keras.layers.ELU(alpha=0.36275556065858083, name = 'ELU70106', input_shape=(2, 1))(in0ELU70106)
ReL76693 = keras.layers.ReLU(max_value=2.899858430045152, negative_slope=8.776761609180365, threshold=9.544967941238351, name = 'ReL76693', )(ELU70106)
Per42452 = keras.layers.Permute((1,2), name = 'Per42452',)(ReL76693)
Res53999 = keras.layers.Reshape((2, 1, 1), name = 'Res53999', )(Per42452)
Res2763 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res2763', )(Res53999)
Con20888 = keras.layers.Conv3D(2, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con20888', )(Res2763)
model = tf.keras.models.Model(inputs=[in0ELU70106], outputs=Con20888)
w = model.get_layer('Con20888').get_weights() 
w[0] = np.array([[[[[0.268, 0.0067]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con20888').set_weights(w) 
in0ELU70106 = tf.constant([[[0.2509], [0.9821]]])
print (np.array2string(model.predict([in0ELU70106],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con20888.png')

LELU70106 = elu_layer([[[0.2509], [0.9821]]], 0.36275556065858083, ELU70106), 
LReL76693 = relu_layer(ELU70106, 2.899858430045152, 8.776761609180365, 9.544967941238351, ReL76693), 
LPer42452 = permute_layer(ReL76693, 1,2, Per42452), 
LRes53999 = reshape_layer(Per42452, [2, 1, 1], Res53999), 
LRes2763 = reshape_layer(Res53999, [2, 1, 1, 1], Res2763), 
LCon20888 = conv3D_layer(Res2763, 1, 1, 1,[[[[[0.268, 0.0067]]]]],[0, 0], 1, 1, 1, false, 1, 1, 1, Con20888), 
exec_layers([LELU70106,LReL76693,LPer42452,LRes53999,LRes2763,LCon20888],["ELU70106","ReL76693","Per42452","Res53999","Res2763","Con20888"],Con20888,"Con20888")

Actual (Unparsed): [[[[[-21.8612474, -0.5465312]]], [[[-20.1413391, -0.5035335]]]]]

Expected (Unparsed): [[[[[-21.861247411539637,-0.5465311852884909]]],[[[-20.141339163786075,-0.5035334790946518]]]]]

Actual:   [[[[[-21.8612, -0.5465]]], [[[-20.1413, -0.5035]]]]]

Expected: [[[[[-21.8612, -0.5465]]], [[[-20.1413, -0.5035]]]]]