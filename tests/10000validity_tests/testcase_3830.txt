import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add48455 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Add48455 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Add48455 = keras.layers.Add(name = 'Add48455', )([in0Add48455,in1Add48455])
Res1266 = keras.layers.Reshape((2, 1, 2), name = 'Res1266', )(Add48455)
Glo78368 = keras.layers.GlobalMaxPool2D(name = 'Glo78368', )(Res1266)
Res3963 = keras.layers.Reshape((2, 1), name = 'Res3963', )(Glo78368)
Sim20264 = keras.layers.SimpleRNN(2,name = 'Sim20264', )(Res3963)
Res73278 = keras.layers.Reshape((2, 1), name = 'Res73278', )(Sim20264)
Res34012 = keras.layers.Reshape((2, 1, 1), name = 'Res34012', )(Res73278)
Sep5468 = keras.layers.SeparableConv2D(4, (2, 1),strides=(2, 2), padding='valid', name = 'Sep5468', )(Res34012)
model = tf.keras.models.Model(inputs=[in0Add48455,in1Add48455], outputs=Sep5468)
w = model.get_layer('Sim20264').get_weights() 
w[0] = np.array([[2, 2]])
w[1] = np.array([[10, 9], [4, 7]])
w[2] = np.array([6, 6])
model.get_layer('Sim20264').set_weights(w) 
w = model.get_layer('Sep5468').get_weights() 
w[0] = np.array([[[[0.8336]]], [[[0.8089]]]])
w[1] = np.array([[[[0.0537, 0.5966, 0.0971, 0.3025]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep5468').set_weights(w) 
in0Add48455 = tf.constant([[[[[0.3875, 0.3963]]], [[[0.6248, 0.1646]]]]])
in1Add48455 = tf.constant([[[[[0.7443, 0.1885]]], [[[0.2489, 0.1987]]]]])
print (np.array2string(model.predict([in0Add48455,in1Add48455],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep5468.png')

LAdd48455 = add_layer([[[[[[0.3875, 0.3963]]], [[[0.6248, 0.1646]]]]], [[[[[0.7443, 0.1885]]], [[[0.2489, 0.1987]]]]]], Add48455), 
LRes1266 = reshape_layer(Add48455, [2, 1, 2], Res1266), 
LGlo78368 = global_max_pool2D_layer(Res1266, Glo78368), 
LRes3963 = reshape_layer(Glo78368, [2, 1], Res3963), 
LSim20264 = simple_rnn_layer(Res3963,[[2, 2]],[[10, 9], [4, 7]],[6, 6], Sim20264), 
LRes73278 = reshape_layer(Sim20264, [2, 1], Res73278), 
LRes34012 = reshape_layer(Res73278, [2, 1, 1], Res34012), 
LSep5468 = separable_conv2D_layer(Res34012, 2, 1,[[[[[0.8336]]], [[[0.8089]]]],[[[[0.0537, 0.5966, 0.0971, 0.3025]]]]],[0, 0, 0, 0], 2, 2, false, Sep5468), 
exec_layers([LAdd48455,LRes1266,LGlo78368,LRes3963,LSim20264,LRes73278,LRes34012,LSep5468],["Add48455","Res1266","Glo78368","Res3963","Sim20264","Res73278","Res34012","Sep5468"],Sep5468,"Sep5468")

Actual (Unparsed): [[[[0.0882022, 0.9799155, 0.1594868, 0.4968562]]]]

Expected (Unparsed): [[[[0.08820224999999998,0.9799154999999999,0.15948675,0.49685625]]]]

Actual:   [[[[0.0883, 0.98, 0.1595, 0.4969]]]]

Expected: [[[[0.0883, 0.98, 0.1595, 0.4969]]]]