import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave60537 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave60537 = tf.keras.layers.Input(shape=([2, 2]))
in0Dot1144 = tf.keras.layers.Input(shape=([2]))
in1Dot1144 = tf.keras.layers.Input(shape=([2]))

Ave60537 = keras.layers.Average(name = 'Ave60537', )([in0Ave60537,in1Ave60537])
Res61284 = keras.layers.Reshape((2, 2, 1), name = 'Res61284', )(Ave60537)
Dot1144 = keras.layers.Dot(axes=(1, 1), name = 'Dot1144', )([in0Dot1144,in1Dot1144])
Res89997 = keras.layers.Reshape((1, 1), name = 'Res89997', )(Dot1144)
Res10795 = keras.layers.Reshape((1, 1, 1), name = 'Res10795', )(Res89997)
Cro73340 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro73340', )(Res10795)
Zer33348 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer33348', )(Cro73340)
Mul68567 = keras.layers.Multiply(name = 'Mul68567', )([Res61284,Zer33348])
model = tf.keras.models.Model(inputs=[in0Ave60537,in1Ave60537,in0Dot1144,in1Dot1144], outputs=Mul68567)
in0Ave60537 = tf.constant([[[0.3147, 0.8054], [0.0253, 0.9806]]])
in1Ave60537 = tf.constant([[[0.1196, 0.3115], [0.5492, 0.7824]]])
in0Dot1144 = tf.constant([[0.1934, 0.5734]])
in1Dot1144 = tf.constant([[0.1605, 0.2689]])
print (np.array2string(model.predict([in0Ave60537,in1Ave60537,in0Dot1144,in1Dot1144],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul68567.png')

LAve60537 = average_layer([[[[0.3147, 0.8054], [0.0253, 0.9806]]], [[[0.1196, 0.3115], [0.5492, 0.7824]]]], Ave60537), 
LRes61284 = reshape_layer(Ave60537, [2, 2, 1], Res61284), 
LDot1144 = dot_layer([[0.1934, 0.5734]], [[0.1605, 0.2689]], 1, 1, Dot1144), 
LRes89997 = reshape_layer(Dot1144, [1, 1], Res89997), 
LRes10795 = reshape_layer(Res89997, [1, 1, 1], Res10795), 
LCro73340 = cropping2D_layer(Res10795, 0, 0, 0, 0, Cro73340), 
LZer33348 = zero_padding2D_layer(Cro73340, 1, 0, 1, 0, Zer33348), 
LMul68567 = multiply_layer([Res61284,Zer33348], Mul68567), 
exec_layers([LAve60537,LRes61284,LDot1144,LRes89997,LRes10795,LCro73340,LZer33348,LMul68567],["Ave60537","Res61284","Dot1144","Res89997","Res10795","Cro73340","Zer33348","Mul68567"],Mul68567,"Mul68567")

Actual (Unparsed): [[[[0.0000000], [0.0000000]], [[0.0000000], [0.1632785]]]]

Expected (Unparsed): [[[[0.0],[0.0]],[[0.0],[0.16327844674]]]]

Actual:   [[[[0], [0]], [[0], [0.1633]]]]

Expected: [[[[0], [0]], [[0], [0.1633]]]]