import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max82929 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max82929 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con82465 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con77047 = tf.keras.layers.Input(shape=([2, 2, 2]))

Max82929 = keras.layers.Maximum(name = 'Max82929', )([in0Max82929,in1Max82929])
Zer13287 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer13287', )(Max82929)
Con82465 = keras.layers.Concatenate(axis=3, name = 'Con82465', )([Zer13287,in0Con82465])
Con77047 = keras.layers.Conv2D(3, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con77047', )(in0Con77047)
Add96315 = keras.layers.Add(name = 'Add96315', )([Con82465,Con77047])
model = tf.keras.models.Model(inputs=[in0Max82929,in1Max82929,in0Con82465,in0Con77047], outputs=Add96315)
w = model.get_layer('Con77047').get_weights() 
w[0] = np.array([[[[0.6563, 0.3502, 0.659], [0.8596, 0.2077, 0.7752]], [[0.3704, 0.1051, 0.0228], [0.2308, 0.9036, 0.8774]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con77047').set_weights(w) 
in0Max82929 = tf.constant([[[[0.9536]]]])
in1Max82929 = tf.constant([[[[0.9883]]]])
in0Con82465 = tf.constant([[[[0.1677, 0.5189]], [[0.5525, 0.3457]]]])
in0Con77047 = tf.constant([[[[0.5488, 0.0457], [0.4578, 0.3867]], [[0.0635, 0.1097], [0.7386, 0.0484]]]])
print (np.array2string(model.predict([in0Max82929,in1Max82929,in0Con82465,in0Con77047],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add96315.png')

LMax82929 = maximum_layer([[[[[0.9536]]]], [[[[0.9883]]]]], Max82929), 
LZer13287 = zero_padding2D_layer(Max82929, 1, 0, 0, 0, Zer13287), 
LCon82465 = concatenate_layer([Zer13287,[[[[0.1677, 0.5189]], [[0.5525, 0.3457]]]]], 3, Con82465), 
LCon77047 = conv2D_layer([[[[0.5488, 0.0457], [0.4578, 0.3867]], [[0.0635, 0.1097], [0.7386, 0.0484]]]], 1, 2,[[[[0.6563, 0.3502, 0.659], [0.8596, 0.2077, 0.7752]], [[0.3704, 0.1051, 0.0228], [0.2308, 0.9036, 0.8774]]]],[0, 0, 0], 1, 1, false, 1, 1, Con77047), 
LAdd96315 = add_layer([Con82465,Con77047], Add96315), 
exec_layers([LMax82929,LZer13287,LCon82465,LCon77047,LAdd96315],["Max82929","Zer13287","Con82465","Con77047","Add96315"],Add96315,"Add96315")

Actual (Unparsed): [[[[0.6582806, 0.7669185, 1.2657142]], [[1.4090214, 0.7188835, 0.5318922]]]]

Expected (Unparsed): [[[[0.65828064,0.7669185499999999,1.26571426]],[[1.40902133,0.71888349,0.53189218]]]]

Actual:   [[[[0.6583, 0.767, 1.2658]], [[1.4091, 0.7189, 0.5319]]]]

Expected: [[[[0.6583, 0.767, 1.2658]], [[1.4091, 0.7189, 0.5319]]]]