import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST49178 = tf.keras.layers.Input(shape=([3, 3]))
in0Con18576 = tf.keras.layers.Input(shape=([6, 3, 3, 1]))
in0Zer82880 = tf.keras.layers.Input(shape=([4, 1, 3]))
in0Con50399 = tf.keras.layers.Input(shape=([6, 3, 3, 1]))
in0Mul92079 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Mul92079 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

LST49178 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST49178', )(in0LST49178)
Res39558 = keras.layers.Reshape((2, 1), name = 'Res39558', )(LST49178)
Res3318 = keras.layers.Reshape((2, 1, 1), name = 'Res3318', )(Res39558)
Res73944 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res73944', )(Res3318)
Zer30113 = keras.layers.ZeroPadding3D(padding=((4, 0), (2, 0), (2, 0)), name = 'Zer30113', )(Res73944)
Con18576 = keras.layers.Concatenate(axis=4, name = 'Con18576', )([Zer30113,in0Con18576])
Zer82880 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer82880', )(in0Zer82880)
Res72496 = keras.layers.Reshape((6, 3, 3, 1), name = 'Res72496', )(Zer82880)
Con50399 = keras.layers.Concatenate(axis=4, name = 'Con50399', )([Res72496,in0Con50399])
Mul92079 = keras.layers.Multiply(name = 'Mul92079', )([in0Mul92079,in1Mul92079])
Zer2719 = keras.layers.ZeroPadding3D(padding=((5, 0), (1, 0), (2, 0)), name = 'Zer2719', )(Mul92079)
Mul68945 = keras.layers.Multiply(name = 'Mul68945', )([Con50399,Zer2719])
Mul39107 = keras.layers.Multiply(name = 'Mul39107', )([Con18576,Mul68945])
model = tf.keras.models.Model(inputs=[in0LST49178,in0Con18576,in0Zer82880,in0Con50399,in0Mul92079,in1Mul92079], outputs=Mul39107)
w = model.get_layer('LST49178').get_weights() 
w[0] = np.array([[6, 2, 1, 1, 9, 8, 8, 9], [5, 7, 1, 6, 4, 8, 1, 1], [10, 5, 6, 8, 8, 6, 5, 4]])
w[1] = np.array([[5, 5, 8, 1, 1, 1, 10, 2], [8, 9, 3, 1, 5, 4, 7, 9]])
w[2] = np.array([10, 9, 6, 3, 10, 9, 6, 5])
model.get_layer('LST49178').set_weights(w) 
in0LST49178 = tf.constant([[[7, 6, 8], [7, 2, 3], [5, 6, 7]]])
in0Con18576 = tf.constant([[[[[0.1939], [0.4662], [0.0712]], [[0.104], [0.4248], [0.2203]], [[0.1278], [0.974], [0.3373]]], [[[0.4124], [0.9874], [0.9096]], [[0.0073], [0.8722], [0.9386]], [[0.793], [0.9898], [0.3212]]], [[[0.2791], [0.2882], [0.7969]], [[0.0254], [0.178], [0.9005]], [[0.702], [0.7468], [0.5303]]], [[[0.8606], [0.3219], [0.0025]], [[0.3091], [0.4768], [0.2281]], [[0.9143], [0.233], [0.0123]]], [[[0.9171], [0.7382], [0.6607]], [[0.5897], [0.8301], [0.4987]], [[0.5013], [0.1052], [0.7529]]], [[[0.0238], [0.5862], [0.642]], [[0.8528], [0.0713], [0.3863]], [[0.412], [0.809], [0.1733]]]]])
in0Zer82880 = tf.constant([[[[1.8504, 1.0695, 1.0068]], [[1.883, 1.5474, 1.7905]], [[1.5801, 1.3165, 1.7622]], [[1.2075, 1.3138, 1.1275]]]])
in0Con50399 = tf.constant([[[[[0.9043], [0.4373], [0.0965]], [[0.0653], [0.2004], [0.1748]], [[0.3334], [0.2739], [0.6078]]], [[[0.3896], [0.8613], [0.8698]], [[0.2426], [0.8896], [0.5629]], [[0.2966], [0.1336], [0.9779]]], [[[0.9845], [0.4878], [0.3049]], [[0.311], [0.4893], [0.9582]], [[0.7302], [0.4486], [0.0331]]], [[[0.5089], [0.3039], [0.652]], [[0.6487], [0.8452], [0.7313]], [[0.664], [0.3692], [0.0906]]], [[[0.0333], [0.6539], [0.5046]], [[0.6553], [0.1803], [0.2495]], [[0.8959], [0.1618], [0.2224]]], [[[0.594], [0.0158], [0.17]], [[0.1685], [0.66], [0.5574]], [[0.2506], [0.7801], [0.6391]]]]])
in0Mul92079 = tf.constant([[[[[0.8061, 0.3186]], [[0.2887, 0.7382]]]]])
in1Mul92079 = tf.constant([[[[[0.2565, 0.4477]], [[0.0618, 0.5852]]]]])
print (np.array2string(model.predict([in0LST49178,in0Con18576,in0Zer82880,in0Con50399,in0Mul92079,in1Mul92079],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul39107.png')

LLST49178 = lstm_layer([[[7, 6, 8], [7, 2, 3], [5, 6, 7]]],[[6, 2, 1, 1, 9, 8, 8, 9], [5, 7, 1, 6, 4, 8, 1, 1], [10, 5, 6, 8, 8, 6, 5, 4]],[[5, 5, 8, 1, 1, 1, 10, 2], [8, 9, 3, 1, 5, 4, 7, 9]],[10, 9, 6, 3, 10, 9, 6, 5], LST49178), 
LRes39558 = reshape_layer(LST49178, [2, 1], Res39558), 
LRes3318 = reshape_layer(Res39558, [2, 1, 1], Res3318), 
LRes73944 = reshape_layer(Res3318, [2, 1, 1, 1], Res73944), 
LZer30113 = zero_padding3D_layer(Res73944, 4, 0, 2, 0, 2, 0, Zer30113), 
LCon18576 = concatenate_layer([Zer30113,[[[[[0.1939], [0.4662], [0.0712]], [[0.104], [0.4248], [0.2203]], [[0.1278], [0.974], [0.3373]]], [[[0.4124], [0.9874], [0.9096]], [[0.0073], [0.8722], [0.9386]], [[0.793], [0.9898], [0.3212]]], [[[0.2791], [0.2882], [0.7969]], [[0.0254], [0.178], [0.9005]], [[0.702], [0.7468], [0.5303]]], [[[0.8606], [0.3219], [0.0025]], [[0.3091], [0.4768], [0.2281]], [[0.9143], [0.233], [0.0123]]], [[[0.9171], [0.7382], [0.6607]], [[0.5897], [0.8301], [0.4987]], [[0.5013], [0.1052], [0.7529]]], [[[0.0238], [0.5862], [0.642]], [[0.8528], [0.0713], [0.3863]], [[0.412], [0.809], [0.1733]]]]]], 4, Con18576), 
LZer82880 = zero_padding2D_layer([[[[1.8504, 1.0695, 1.0068]], [[1.883, 1.5474, 1.7905]], [[1.5801, 1.3165, 1.7622]], [[1.2075, 1.3138, 1.1275]]]], 1, 1, 1, 1, Zer82880), 
LRes72496 = reshape_layer(Zer82880, [6, 3, 3, 1], Res72496), 
LCon50399 = concatenate_layer([Res72496,[[[[[0.9043], [0.4373], [0.0965]], [[0.0653], [0.2004], [0.1748]], [[0.3334], [0.2739], [0.6078]]], [[[0.3896], [0.8613], [0.8698]], [[0.2426], [0.8896], [0.5629]], [[0.2966], [0.1336], [0.9779]]], [[[0.9845], [0.4878], [0.3049]], [[0.311], [0.4893], [0.9582]], [[0.7302], [0.4486], [0.0331]]], [[[0.5089], [0.3039], [0.652]], [[0.6487], [0.8452], [0.7313]], [[0.664], [0.3692], [0.0906]]], [[[0.0333], [0.6539], [0.5046]], [[0.6553], [0.1803], [0.2495]], [[0.8959], [0.1618], [0.2224]]], [[[0.594], [0.0158], [0.17]], [[0.1685], [0.66], [0.5574]], [[0.2506], [0.7801], [0.6391]]]]]], 4, Con50399), 
LMul92079 = multiply_layer([[[[[[0.8061, 0.3186]], [[0.2887, 0.7382]]]]], [[[[[0.2565, 0.4477]], [[0.0618, 0.5852]]]]]], Mul92079), 
LZer2719 = zero_padding3D_layer(Mul92079, 5, 0, 1, 0, 2, 0, Zer2719), 
LMul68945 = multiply_layer([Con50399,Zer2719], Mul68945), 
LMul39107 = multiply_layer([Con18576,Mul68945], Mul39107), 
exec_layers([LLST49178,LRes39558,LRes3318,LRes73944,LZer30113,LCon18576,LZer82880,LRes72496,LCon50399,LMul92079,LZer2719,LMul68945,LMul39107],["LST49178","Res39558","Res3318","Res73944","Zer30113","Con18576","Zer82880","Res72496","Con50399","Mul92079","Zer2719","Mul68945","Mul39107"],Mul39107,"Mul39107")

Actual (Unparsed): [[[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0307132]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0478460]]]]]

Expected (Unparsed): [[[[[0,0.0],[0,0.0],[0,0.0]],[[0,0.0],[0,0.0],[0,0.0]],[[0,0.0],[0,0.0],[0,0.0]]],[[[0,0.0],[0,0.0],[0,0.0]],[[0.0,0.0],[0.0,0.0],[0.0,0.0]],[[0,0.0],[0,0.0],[0,0.0]]],[[[0,0.0],[0,0.0],[0,0.0]],[[0.0,0.0],[0.0,0.0],[0.0,0.0]],[[0,0.0],[0,0.0],[0,0.0]]],[[[0,0.0],[0,0.0],[0,0.0]],[[0.0,0.0],[0.0,0.0],[0.0,0.0]],[[0,0.0],[0,0.0],[0,0.0]]],[[[0,0.0],[0,0.0],[0,0.0]],[[0.0,0.0],[0.0,0.0],[0.0,0.0]],[[0,0.0],[0,0.0],[0.0,0.0]]],[[[0,0.0],[0,0.0],[0,0.0]],[[0,0.0],[0,0.0],[0.0,0.030713162557136398]],[[0,0.0],[0,0.0],[0.0,0.0478460113076792]]]]]

Actual:   [[[[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0.0308]], [[0, 0], [0, 0], [0, 0.0479]]]]]

Expected: [[[[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0]]], [[[0, 0], [0, 0], [0, 0]], [[0, 0], [0, 0], [0, 0.0308]], [[0, 0], [0, 0], [0, 0.0479]]]]]