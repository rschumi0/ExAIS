import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc58144 = tf.keras.layers.Input(shape=([2, 1]))
in0Con46401 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Add2175 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add2175 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con39001 = tf.keras.layers.Input(shape=([2, 1]))
in0Con7358 = tf.keras.layers.Input(shape=([4, 2]))

Loc58144 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc58144', )(in0Loc58144)
Con95441 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con95441', )(Loc58144)
Res44079 = keras.layers.Reshape((2, 2, 1), name = 'Res44079', )(Con95441)
Con46401 = keras.layers.Concatenate(axis=3, name = 'Con46401', )([Res44079,in0Con46401])
Add2175 = keras.layers.Add(name = 'Add2175', )([in0Add2175,in1Add2175])
Zer44269 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer44269', )(Add2175)
Ave73174 = keras.layers.Average(name = 'Ave73174', )([Con46401,Zer44269])
Res55639 = keras.layers.Reshape((2, 4), name = 'Res55639', )(Ave73174)
Zer82503 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer82503', )(Res55639)
Con39001 = keras.layers.Conv1D(2, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con39001', )(in0Con39001)
Zer51136 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer51136', )(Con39001)
Con7358 = keras.layers.Concatenate(axis=2, name = 'Con7358', )([Zer51136,in0Con7358])
Min56968 = keras.layers.Minimum(name = 'Min56968', )([Zer82503,Con7358])
Res75807 = keras.layers.Reshape((4, 4, 1), name = 'Res75807', )(Min56968)
Up_17621 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_17621', )(Res75807)
model = tf.keras.models.Model(inputs=[in0Loc58144,in0Con46401,in0Add2175,in1Add2175,in0Con39001,in0Con7358], outputs=Up_17621)
w = model.get_layer('Loc58144').get_weights() 
w[0] = np.array([[[0.6863, 0.2143, 0.023, 0.6626]], [[0.648, 0.752, 0.1507, 0.4546]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc58144').set_weights(w) 
w = model.get_layer('Con95441').get_weights() 
w[0] = np.array([[[0.4447, 0.0512], [0.3369, 0.94], [0.0814, 0.0374], [0.0004, 0.858]]])
w[1] = np.array([0, 0])
model.get_layer('Con95441').set_weights(w) 
w = model.get_layer('Con39001').get_weights() 
w[0] = np.array([[[0.904, 0.0053]], [[0.92, 0.2256]]])
w[1] = np.array([0, 0])
model.get_layer('Con39001').set_weights(w) 
in0Loc58144 = tf.constant([[[0.9042], [0.1481]]])
in0Con46401 = tf.constant([[[[0.6197], [0.6288]], [[0.9364], [0.0591]]]])
in0Add2175 = tf.constant([[[[0.1365, 0.9622], [0.0829, 0.386]]]])
in1Add2175 = tf.constant([[[[0.5512, 0.0231], [0.6672, 0.4214]]]])
in0Con39001 = tf.constant([[[0.8778], [0.0839]]])
in0Con7358 = tf.constant([[[0.9521, 0.5068], [0.8641, 0.3867], [0.9083, 0.9314], [0.2934, 0.993]]])
print (np.array2string(model.predict([in0Loc58144,in0Con46401,in0Add2175,in1Add2175,in0Con39001,in0Con7358],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_17621.png')

LLoc58144 = locally_connected1D_layer([[[0.9042], [0.1481]]], 1,[[[0.6863, 0.2143, 0.023, 0.6626]], [[0.648, 0.752, 0.1507, 0.4546]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc58144), 
LCon95441 = conv1D_layer(Loc58144, 1,[[[0.4447, 0.0512], [0.3369, 0.94], [0.0814, 0.0374], [0.0004, 0.858]]],[0, 0], 1, false, 1, Con95441), 
LRes44079 = reshape_layer(Con95441, [2, 2, 1], Res44079), 
LCon46401 = concatenate_layer([Res44079,[[[[0.6197], [0.6288]], [[0.9364], [0.0591]]]]], 3, Con46401), 
LAdd2175 = add_layer([[[[[0.1365, 0.9622], [0.0829, 0.386]]]], [[[[0.5512, 0.0231], [0.6672, 0.4214]]]]], Add2175), 
LZer44269 = zero_padding2D_layer(Add2175, 1, 0, 0, 0, Zer44269), 
LAve73174 = average_layer([Con46401,Zer44269], Ave73174), 
LRes55639 = reshape_layer(Ave73174, [2, 4], Res55639), 
LZer82503 = zero_padding1D_layer(Res55639, 1, 1, Zer82503), 
LCon39001 = conv1D_layer([[[0.8778], [0.0839]]], 2,[[[0.904, 0.0053]], [[0.92, 0.2256]]],[0, 0], 1, false, 1, Con39001), 
LZer51136 = zero_padding1D_layer(Con39001, 3, 0, Zer51136), 
LCon7358 = concatenate_layer([Zer51136,[[[0.9521, 0.5068], [0.8641, 0.3867], [0.9083, 0.9314], [0.2934, 0.993]]]], 2, Con7358), 
LMin56968 = minimum_layer([Zer82503,Con7358], Min56968), 
LRes75807 = reshape_layer(Min56968, [4, 4, 1], Res75807), 
LUp_17621 = up_sampling2D_layer(Res75807, 2, 1, Up_17621), 
exec_layers([LLoc58144,LCon95441,LRes44079,LCon46401,LAdd2175,LZer44269,LAve73174,LRes55639,LZer82503,LCon39001,LZer51136,LCon7358,LMin56968,LRes75807,LUp_17621],["Loc58144","Con95441","Res44079","Con46401","Add2175","Zer44269","Ave73174","Res55639","Zer82503","Con39001","Zer51136","Con7358","Min56968","Res75807","Up_17621"],Up_17621,"Up_17621")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.3643707], [0.3144000]], [[0.0000000], [0.0000000], [0.3643707], [0.3144000]], [[0.0000000], [0.0000000], [0.4591516], [0.4332500]], [[0.0000000], [0.0000000], [0.4591516], [0.4332500]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0.364370700276],[0.3144]],[[0],[0],[0.364370700276],[0.3144]],[[0],[0],[0.45915158994899996],[0.43325]],[[0],[0],[0.45915158994899996],[0.43325]],[[0],[0],[0],[0]],[[0],[0],[0],[0]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0.3644], [0.3144]], [[0], [0], [0.3644], [0.3144]], [[0], [0], [0.4592], [0.4333]], [[0], [0], [0.4592], [0.4333]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0.3644], [0.3144]], [[0], [0], [0.3644], [0.3144]], [[0], [0], [0.4592], [0.4333]], [[0], [0], [0.4592], [0.4333]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]