import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave31175 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave31175 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con4434 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Max31749 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Max31749 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Min78287 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Min78287 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con77731 = tf.keras.layers.Input(shape=([2, 1, 2]))

Ave31175 = keras.layers.Average(name = 'Ave31175', )([in0Ave31175,in1Ave31175])
Zer20077 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer20077', )(Ave31175)
Con4434 = keras.layers.Concatenate(axis=4, name = 'Con4434', )([Zer20077,in0Con4434])
Max31749 = keras.layers.Maximum(name = 'Max31749', )([in0Max31749,in1Max31749])
Min93135 = keras.layers.Minimum(name = 'Min93135', )([Con4434,Max31749])
Res70112 = keras.layers.Reshape((2, 1, 4), name = 'Res70112', )(Min93135)
Min78287 = keras.layers.Minimum(name = 'Min78287', )([in0Min78287,in1Min78287])
Con77731 = keras.layers.Concatenate(axis=3, name = 'Con77731', )([Min78287,in0Con77731])
Mul3436 = keras.layers.Multiply(name = 'Mul3436', )([Res70112,Con77731])
model = tf.keras.models.Model(inputs=[in0Ave31175,in1Ave31175,in0Con4434,in0Max31749,in1Max31749,in0Min78287,in1Min78287,in0Con77731], outputs=Mul3436)
in0Ave31175 = tf.constant([[[[[0.5897], [0.1181]]]]])
in1Ave31175 = tf.constant([[[[[0.2235], [0.3368]]]]])
in0Con4434 = tf.constant([[[[[0.4888], [0.4594]]], [[[0.758], [0.3345]]]]])
in0Max31749 = tf.constant([[[[[0.0109, 0.9862], [0.0678, 0.2804]]], [[[0.2343, 0.0872], [0.4328, 0.9691]]]]])
in1Max31749 = tf.constant([[[[[0.2726, 0.617], [0.0793, 0.986]]], [[[0.5379, 0.8664], [0.2014, 0.979]]]]])
in0Min78287 = tf.constant([[[[0.9332, 0.8298]], [[0.7146, 0.5213]]]])
in1Min78287 = tf.constant([[[[0.2689, 0.0077]], [[0.3191, 0.0928]]]])
in0Con77731 = tf.constant([[[[0.4469, 0.1323]], [[0.228, 0.4735]]]])
print (np.array2string(model.predict([in0Ave31175,in1Ave31175,in0Con4434,in0Max31749,in1Max31749,in0Min78287,in1Min78287,in0Con77731],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul3436.png')

LAve31175 = average_layer([[[[[[0.5897], [0.1181]]]]], [[[[[0.2235], [0.3368]]]]]], Ave31175), 
LZer20077 = zero_padding3D_layer(Ave31175, 1, 0, 0, 0, 0, 0, Zer20077), 
LCon4434 = concatenate_layer([Zer20077,[[[[[0.4888], [0.4594]]], [[[0.758], [0.3345]]]]]], 4, Con4434), 
LMax31749 = maximum_layer([[[[[[0.0109, 0.9862], [0.0678, 0.2804]]], [[[0.2343, 0.0872], [0.4328, 0.9691]]]]], [[[[[0.2726, 0.617], [0.0793, 0.986]]], [[[0.5379, 0.8664], [0.2014, 0.979]]]]]], Max31749), 
LMin93135 = minimum_layer([Con4434,Max31749], Min93135), 
LRes70112 = reshape_layer(Min93135, [2, 1, 4], Res70112), 
LMin78287 = minimum_layer([[[[[0.9332, 0.8298]], [[0.7146, 0.5213]]]], [[[[0.2689, 0.0077]], [[0.3191, 0.0928]]]]], Min78287), 
LCon77731 = concatenate_layer([Min78287,[[[[0.4469, 0.1323]], [[0.228, 0.4735]]]]], 3, Con77731), 
LMul3436 = multiply_layer([Res70112,Con77731], Mul3436), 
exec_layers([LAve31175,LZer20077,LCon4434,LMax31749,LMin93135,LRes70112,LMin78287,LCon77731,LMul3436],["Ave31175","Zer20077","Con4434","Max31749","Min93135","Res70112","Min78287","Con77731","Mul3436"],Mul3436,"Mul3436")

Actual (Unparsed): [[[[0.0000000, 0.0037638, 0.0000000, 0.0607786]], [[0.1297461, 0.0703424, 0.0518586, 0.1583858]]]]

Expected (Unparsed): [[[[0.0,0.00376376,0.0,0.06077862]],[[0.12974606,0.0703424,0.0518586,0.15838575]]]]

Actual:   [[[[0, 0.0038, 0, 0.0608]], [[0.1298, 0.0704, 0.0519, 0.1584]]]]

Expected: [[[[0, 0.0038, 0, 0.0608]], [[0.1298, 0.0704, 0.0519, 0.1584]]]]