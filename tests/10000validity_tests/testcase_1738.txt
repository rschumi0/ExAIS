import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min56532 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min56532 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Min56532 = keras.layers.Minimum(name = 'Min56532', )([in0Min56532,in1Min56532])
Up_51513 = keras.layers.UpSampling3D(size=(2, 2, 2), name = 'Up_51513', )(Min56532)
Res94927 = keras.layers.Reshape((2, 4, 4), name = 'Res94927', )(Up_51513)
Res31594 = keras.layers.Reshape((2, 16), name = 'Res31594', )(Res94927)
LST28505 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST28505', )(Res31594)
model = tf.keras.models.Model(inputs=[in0Min56532,in1Min56532], outputs=LST28505)
w = model.get_layer('LST28505').get_weights() 
w[0] = np.array([[4, 5, 6, 4, 4, 9, 10, 7], [5, 9, 10, 9, 2, 5, 4, 2], [2, 4, 1, 6, 5, 7, 10, 6], [8, 9, 1, 5, 8, 3, 5, 2], [8, 9, 8, 6, 2, 2, 10, 6], [10, 1, 4, 4, 10, 5, 6, 8], [7, 10, 7, 8, 4, 8, 5, 6], [8, 10, 7, 3, 10, 10, 5, 5], [2, 3, 2, 1, 7, 6, 2, 3], [7, 3, 2, 2, 8, 10, 6, 5], [7, 7, 3, 10, 8, 10, 3, 1], [7, 7, 4, 1, 1, 1, 10, 9], [6, 2, 10, 6, 7, 3, 5, 2], [7, 3, 4, 2, 10, 7, 6, 3], [9, 2, 4, 1, 6, 2, 5, 9], [9, 9, 8, 5, 6, 10, 8, 4]])
w[1] = np.array([[2, 7, 7, 9, 6, 6, 8, 3], [3, 9, 5, 10, 2, 7, 2, 7]])
w[2] = np.array([5, 5, 7, 2, 3, 7, 8, 7])
model.get_layer('LST28505').set_weights(w) 
in0Min56532 = tf.constant([[[[[0.2587, 0.9604]], [[0.8998, 0.1625]]]]])
in1Min56532 = tf.constant([[[[[0.2641, 0.8531]], [[0.2465, 0.573]]]]])
print (np.array2string(model.predict([in0Min56532,in1Min56532],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST28505.png')

LMin56532 = minimum_layer([[[[[[0.2587, 0.9604]], [[0.8998, 0.1625]]]]], [[[[[0.2641, 0.8531]], [[0.2465, 0.573]]]]]], Min56532), 
LUp_51513 = up_sampling3D_layer(Min56532, 2, 2, 2, Up_51513), 
LRes94927 = reshape_layer(Up_51513, [2, 4, 4], Res94927), 
LRes31594 = reshape_layer(Res94927, [2, 16], Res31594), 
LLST28505 = lstm_layer(Res31594,[[4, 5, 6, 4, 4, 9, 10, 7], [5, 9, 10, 9, 2, 5, 4, 2], [2, 4, 1, 6, 5, 7, 10, 6], [8, 9, 1, 5, 8, 3, 5, 2], [8, 9, 8, 6, 2, 2, 10, 6], [10, 1, 4, 4, 10, 5, 6, 8], [7, 10, 7, 8, 4, 8, 5, 6], [8, 10, 7, 3, 10, 10, 5, 5], [2, 3, 2, 1, 7, 6, 2, 3], [7, 3, 2, 2, 8, 10, 6, 5], [7, 7, 3, 10, 8, 10, 3, 1], [7, 7, 4, 1, 1, 1, 10, 9], [6, 2, 10, 6, 7, 3, 5, 2], [7, 3, 4, 2, 10, 7, 6, 3], [9, 2, 4, 1, 6, 2, 5, 9], [9, 9, 8, 5, 6, 10, 8, 4]],[[2, 7, 7, 9, 6, 6, 8, 3], [3, 9, 5, 10, 2, 7, 2, 7]],[5, 5, 7, 2, 3, 7, 8, 7], LST28505), 
exec_layers([LMin56532,LUp_51513,LRes94927,LRes31594,LLST28505],["Min56532","Up_51513","Res94927","Res31594","LST28505"],LST28505,"LST28505")

Actual (Unparsed): [[0.9640276, 0.9640276]]

Expected (Unparsed): [[0.9640275800758169,0.9640275800758169]]

Actual:   [[0.9641, 0.9641]]

Expected: [[0.9641, 0.9641]]