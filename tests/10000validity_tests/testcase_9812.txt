import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul38716 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Mul38716 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Glo99479 = tf.keras.layers.Input(shape=([1, 1]))
in0Con65975 = tf.keras.layers.Input(shape=([3]))
in0Dep4218 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con90135 = tf.keras.layers.Input(shape=([4, 3, 2]))
in0Sub15851 = tf.keras.layers.Input(shape=([2, 2, 3]))
in1Sub15851 = tf.keras.layers.Input(shape=([2, 2, 3]))

Mul38716 = keras.layers.Multiply(name = 'Mul38716', )([in0Mul38716,in1Mul38716])
Res25414 = keras.layers.Reshape((2, 2, 1), name = 'Res25414', )(Mul38716)
Res59625 = keras.layers.Reshape((2, 2), name = 'Res59625', )(Res25414)
Fla14496 = keras.layers.Flatten(name = 'Fla14496', )(Res59625)
Glo99479 = keras.layers.GlobalAveragePooling1D(name = 'Glo99479', )(in0Glo99479)
Con65975 = keras.layers.Concatenate(axis=1, name = 'Con65975', )([Glo99479,in0Con65975])
Add32529 = keras.layers.Add(name = 'Add32529', )([Fla14496,Con65975])
Res86941 = keras.layers.Reshape((4, 1), name = 'Res86941', )(Add32529)
Res29782 = keras.layers.Reshape((4, 1, 1), name = 'Res29782', )(Res86941)
Dep4218 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep4218', )(in0Dep4218)
Zer51996 = keras.layers.ZeroPadding2D(padding=((3, 0), (0, 0)), name = 'Zer51996', )(Dep4218)
Max38454 = keras.layers.Maximum(name = 'Max38454', )([Res29782,Zer51996])
Zer44026 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer44026', )(Max38454)
Con90135 = keras.layers.Concatenate(axis=3, name = 'Con90135', )([Zer44026,in0Con90135])
Sub15851 = keras.layers.Subtract(name = 'Sub15851', )([in0Sub15851,in1Sub15851])
Lay21503 = keras.layers.LayerNormalization(axis=1, epsilon=2.3122452915331673, name = 'Lay21503', )(Sub15851)
Zer78731 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer78731', )(Lay21503)
Mul77773 = keras.layers.Multiply(name = 'Mul77773', )([Con90135,Zer78731])
Cro43548 = keras.layers.Cropping2D(cropping=((2, 0), (1, 0)), name = 'Cro43548', )(Mul77773)
Res61486 = keras.layers.Reshape((2, 2, 3, 1), name = 'Res61486', )(Cro43548)
Zer4929 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer4929', )(Res61486)
model = tf.keras.models.Model(inputs=[in0Mul38716,in1Mul38716,in0Glo99479,in0Con65975,in0Dep4218,in0Con90135,in0Sub15851,in1Sub15851], outputs=Zer4929)
w = model.get_layer('Dep4218').get_weights() 
w[0] = np.array([[[[0.2569]]]])
w[1] = np.array([0])
model.get_layer('Dep4218').set_weights(w) 
in0Mul38716 = tf.constant([[[[[0.5038]], [[0.2678]]], [[[0.3846]], [[0.7612]]]]])
in1Mul38716 = tf.constant([[[[[0.582]], [[0.7144]]], [[[0.3471]], [[0.4936]]]]])
in0Glo99479 = tf.constant([[[1.5114]]])
in0Con65975 = tf.constant([[0.1904, 0.8997, 0.4677]])
in0Dep4218 = tf.constant([[[[0.5385]]]])
in0Con90135 = tf.constant([[[[0.1496, 0.7813], [0.5965, 0.0628], [0.3862, 0.9577]], [[0.5062, 0.3529], [0.5519, 0.1633], [0.4212, 0.2923]], [[0.6486, 0.5782], [0.0445, 0.8261], [0.2832, 0.5465]], [[0.9185, 0.6146], [0.6824, 0.3405], [0.4322, 0.5187]]]])
in0Sub15851 = tf.constant([[[[0.7005, 0.383, 0.3973], [0.3738, 0.9891, 0.6006]], [[0.9793, 0.7716, 0.3909], [0.8575, 0.6025, 0.0029]]]])
in1Sub15851 = tf.constant([[[[0.1108, 0.387, 0.9891], [0.7682, 0.6812, 0.462]], [[0.6252, 0.4869, 0.5198], [0.8161, 0.6266, 0.7712]]]])
print (np.array2string(model.predict([in0Mul38716,in1Mul38716,in0Glo99479,in0Con65975,in0Dep4218,in0Con90135,in0Sub15851,in1Sub15851],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer4929.png')

LMul38716 = multiply_layer([[[[[[0.5038]], [[0.2678]]], [[[0.3846]], [[0.7612]]]]], [[[[[0.582]], [[0.7144]]], [[[0.3471]], [[0.4936]]]]]], Mul38716), 
LRes25414 = reshape_layer(Mul38716, [2, 2, 1], Res25414), 
LRes59625 = reshape_layer(Res25414, [2, 2], Res59625), 
LFla14496 = flatten_layer(Res59625, Fla14496), 
LGlo99479 = global_average_pooling1D_layer([[[1.5114]]], Glo99479), 
LCon65975 = concatenate_layer([Glo99479,[[0.1904, 0.8997, 0.4677]]], 1, Con65975), 
LAdd32529 = add_layer([Fla14496,Con65975], Add32529), 
LRes86941 = reshape_layer(Add32529, [4, 1], Res86941), 
LRes29782 = reshape_layer(Res86941, [4, 1, 1], Res29782), 
LDep4218 = depthwise_conv2D_layer([[[[0.5385]]]], 1, 1,[[[[0.2569]]]],[0], 1, 1, true, Dep4218), 
LZer51996 = zero_padding2D_layer(Dep4218, 3, 0, 0, 0, Zer51996), 
LMax38454 = maximum_layer([Res29782,Zer51996], Max38454), 
LZer44026 = zero_padding2D_layer(Max38454, 0, 0, 2, 0, Zer44026), 
LCon90135 = concatenate_layer([Zer44026,[[[[0.1496, 0.7813], [0.5965, 0.0628], [0.3862, 0.9577]], [[0.5062, 0.3529], [0.5519, 0.1633], [0.4212, 0.2923]], [[0.6486, 0.5782], [0.0445, 0.8261], [0.2832, 0.5465]], [[0.9185, 0.6146], [0.6824, 0.3405], [0.4322, 0.5187]]]]], 3, Con90135), 
LSub15851 = subtract_layer([[[[0.7005, 0.383, 0.3973], [0.3738, 0.9891, 0.6006]], [[0.9793, 0.7716, 0.3909], [0.8575, 0.6025, 0.0029]]]], [[[[0.1108, 0.387, 0.9891], [0.7682, 0.6812, 0.462]], [[0.6252, 0.4869, 0.5198], [0.8161, 0.6266, 0.7712]]]], Sub15851), 
LLay21503 = layer_normalization_layer(Sub15851, 1, 2.3122452915331673, Lay21503), 
LZer78731 = zero_padding2D_layer(Lay21503, 2, 0, 1, 0, Zer78731), 
LMul77773 = multiply_layer([Con90135,Zer78731], Mul77773), 
LCro43548 = cropping2D_layer(Mul77773, 2, 0, 1, 0, Cro43548), 
LRes61486 = reshape_layer(Cro43548, [2, 2, 3, 1], Res61486), 
LZer4929 = zero_padding3D_layer(Res61486, 1, 1, 1, 1, 1, 1, Zer4929), 
exec_layers([LMul38716,LRes25414,LRes59625,LFla14496,LGlo99479,LCon65975,LAdd32529,LRes86941,LRes29782,LDep4218,LZer51996,LMax38454,LZer44026,LCon90135,LSub15851,LLay21503,LZer78731,LMul77773,LCro43548,LRes61486,LZer4929],["Mul38716","Res25414","Res59625","Fla14496","Glo99479","Con65975","Add32529","Res86941","Res29782","Dep4218","Zer51996","Max38454","Zer44026","Con90135","Sub15851","Lay21503","Zer78731","Mul77773","Cro43548","Res61486","Zer4929"],Zer4929,"Zer4929")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [-0.0042054], [-0.1243081], [0.0000000]], [[0.0000000], [-0.1465577], [0.0307335], [0.1561722], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0000000], [0.0644898], [0.0512370], [0.0000000]], [[0.0000000], [0.1196395], [-0.0469033], [-0.1482278], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[0.0],[-0.0042054432591859614],[-0.12430811256557017],[0]],[[0],[-0.14655769357159915],[0.030733487783833374],[0.15617215174653482],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[-0.0],[0.06448976359704495],[0.051237032234083824],[0]],[[0],[0.11963951620904492],[-0.04690329597518638],[-0.14822780441157848],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [-0.0042], [-0.1243], [0]], [[0], [-0.1465], [0.0308], [0.1562], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [-0], [0.0645], [0.0513], [0]], [[0], [0.1197], [-0.0469], [-0.1482], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]]]]

Expected: [[[[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [-0.0042], [-0.1243], [0]], [[0], [-0.1465], [0.0308], [0.1562], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [-0], [0.0645], [0.0513], [0]], [[0], [0.1197], [-0.0469], [-0.1482], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]]]]