import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul10409 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul10409 = tf.keras.layers.Input(shape=([2, 1]))
in0Con56441 = tf.keras.layers.Input(shape=([2, 1, 3, 1]))
in0Mul61029 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Mul61029 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con68660 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con14470 = tf.keras.layers.Input(shape=([2, 4]))

Mul10409 = keras.layers.Multiply(name = 'Mul10409', )([in0Mul10409,in1Mul10409])
Res66283 = keras.layers.Reshape((2, 1, 1), name = 'Res66283', )(Mul10409)
Res36575 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res36575', )(Res66283)
Zer94019 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer94019', )(Res36575)
Con56441 = keras.layers.Concatenate(axis=4, name = 'Con56441', )([Zer94019,in0Con56441])
Mul61029 = keras.layers.Multiply(name = 'Mul61029', )([in0Mul61029,in1Mul61029])
Con37587 = keras.layers.Conv3D(2, (1, 1, 2),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con37587', )(Mul61029)
Zer79791 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer79791', )(Con37587)
Sub69445 = keras.layers.Subtract(name = 'Sub69445', )([Con56441,Zer79791])
Res36205 = keras.layers.Reshape((2, 1, 6), name = 'Res36205', )(Sub69445)
Res61602 = keras.layers.Reshape((2, 6), name = 'Res61602', )(Res36205)
Con68660 = keras.layers.Conv3D(2, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con68660', )(in0Con68660)
Res63626 = keras.layers.Reshape((1, 1, 2), name = 'Res63626', )(Con68660)
Res78558 = keras.layers.Reshape((1, 2), name = 'Res78558', )(Res63626)
Per15276 = keras.layers.Permute((1,2), name = 'Per15276',)(Res78558)
Zer98280 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer98280', )(Per15276)
Con14470 = keras.layers.Concatenate(axis=2, name = 'Con14470', )([Zer98280,in0Con14470])
Add60558 = keras.layers.Add(name = 'Add60558', )([Res61602,Con14470])
model = tf.keras.models.Model(inputs=[in0Mul10409,in1Mul10409,in0Con56441,in0Mul61029,in1Mul61029,in0Con68660,in0Con14470], outputs=Add60558)
w = model.get_layer('Con37587').get_weights() 
w[0] = np.array([[[[[0.5853, 0.2658]], [[0.6587, 0.4198]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con37587').set_weights(w) 
w = model.get_layer('Con68660').get_weights() 
w[0] = np.array([[[[[0.824, 0.8343], [0.5658, 0.1757]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con68660').set_weights(w) 
in0Mul10409 = tf.constant([[[0.9472], [0.5606]]])
in1Mul10409 = tf.constant([[[0.0342], [0.5504]]])
in0Con56441 = tf.constant([[[[[0.9694], [0.3873], [0.2198]]], [[[0.1606], [0.3806], [0.0763]]]]])
in0Mul61029 = tf.constant([[[[[0.1658], [0.4678]]]]])
in1Mul61029 = tf.constant([[[[[0.8206], [0.5218]]]]])
in0Con68660 = tf.constant([[[[[0.9785, 0.848]]]]])
in0Con14470 = tf.constant([[[0.3631, 0.3483, 0.0963, 0.0206], [0.8655, 0.5056, 0.0255, 0.1133]]])
print (np.array2string(model.predict([in0Mul10409,in1Mul10409,in0Con56441,in0Mul61029,in1Mul61029,in0Con68660,in0Con14470],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add60558.png')

LMul10409 = multiply_layer([[[[0.9472], [0.5606]]], [[[0.0342], [0.5504]]]], Mul10409), 
LRes66283 = reshape_layer(Mul10409, [2, 1, 1], Res66283), 
LRes36575 = reshape_layer(Res66283, [2, 1, 1, 1], Res36575), 
LZer94019 = zero_padding3D_layer(Res36575, 0, 0, 0, 0, 2, 0, Zer94019), 
LCon56441 = concatenate_layer([Zer94019,[[[[[0.9694], [0.3873], [0.2198]]], [[[0.1606], [0.3806], [0.0763]]]]]], 4, Con56441), 
LMul61029 = multiply_layer([[[[[[0.1658], [0.4678]]]]], [[[[[0.8206], [0.5218]]]]]], Mul61029), 
LCon37587 = conv3D_layer(Mul61029, 1, 1, 2,[[[[[0.5853, 0.2658]], [[0.6587, 0.4198]]]]],[0, 0], 1, 1, 1, true, 1, 1, 1, Con37587), 
LZer79791 = zero_padding3D_layer(Con37587, 1, 0, 0, 0, 1, 0, Zer79791), 
LSub69445 = subtract_layer(Con56441,Zer79791, Sub69445), 
LRes36205 = reshape_layer(Sub69445, [2, 1, 6], Res36205), 
LRes61602 = reshape_layer(Res36205, [2, 6], Res61602), 
LCon68660 = conv3D_layer([[[[[0.9785, 0.848]]]]], 1, 1, 1,[[[[[0.824, 0.8343], [0.5658, 0.1757]]]]],[0, 0], 1, 1, 1, true, 1, 1, 1, Con68660), 
LRes63626 = reshape_layer(Con68660, [1, 1, 2], Res63626), 
LRes78558 = reshape_layer(Res63626, [1, 2], Res78558), 
LPer15276 = permute_layer(Res78558, 1,2, Per15276), 
LZer98280 = zero_padding1D_layer(Per15276, 1, 0, Zer98280), 
LCon14470 = concatenate_layer([Zer98280,[[[0.3631, 0.3483, 0.0963, 0.0206], [0.8655, 0.5056, 0.0255, 0.1133]]]], 2, Con14470), 
LAdd60558 = add_layer([Res61602,Con14470], Add60558), 
exec_layers([LMul10409,LRes66283,LRes36575,LZer94019,LCon56441,LMul61029,LCon37587,LZer79791,LSub69445,LRes36205,LRes61602,LCon68660,LRes63626,LRes78558,LPer15276,LZer98280,LCon14470,LAdd60558],["Mul10409","Res66283","Res36575","Zer94019","Con56441","Mul61029","Con37587","Zer79791","Sub69445","Res36205","Res61602","Con68660","Res63626","Res78558","Per15276","Zer98280","Con14470","Add60558"],Add60558,"Add60558")

Actual (Unparsed): [[[0.0000000, 0.9694000, 0.3631000, 0.7356000, 0.1286942, 0.2404000], [1.2860824, 1.1259562, 0.6250793, 0.7475641, 0.1911837, 0.1247188]]]

Expected (Unparsed): [[[0,0.9694,0.3631,0.7356,0.12869424000000002,0.2404],[1.2860824,1.1259561500000002,0.6250793486080001,0.747564096224,0.19118365718799996,0.12471874096800001]]]

Actual:   [[[0, 0.9694, 0.3631, 0.7356, 0.1287, 0.2404], [1.2861, 1.126, 0.6251, 0.7476, 0.1912, 0.1248]]]

Expected: [[[0, 0.9694, 0.3631, 0.7356, 0.1287, 0.2404], [1.2861, 1.126, 0.6251, 0.7476, 0.1912, 0.1248]]]