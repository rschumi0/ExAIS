import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro70486 = tf.keras.layers.Input(shape=([3, 2, 3, 3]))

Cro70486 = keras.layers.Cropping3D(cropping=((2, 0), (1, 0), (1, 1)), name = 'Cro70486', )(in0Cro70486)
Sof63394 = keras.layers.Softmax(axis=1, name = 'Sof63394', )(Cro70486)
Res68693 = keras.layers.Reshape((1, 1, 3), name = 'Res68693', )(Sof63394)
Sep52315 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep52315', )(Res68693)
model = tf.keras.models.Model(inputs=[in0Cro70486], outputs=Sep52315)
w = model.get_layer('Sep52315').get_weights() 
w[0] = np.array([[[[0.8479], [0.8542], [0.5141]]]])
w[1] = np.array([[[[0.4454, 0.3964, 0.2693, 0.017], [0.0031, 0.8049, 0.8659, 0.3635], [0.039, 0.0986, 0.2382, 0.9408]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep52315').set_weights(w) 
in0Cro70486 = tf.constant([[[[[1.6199, 1.8519, 1.9578], [1.7704, 1.2562, 1.9856], [1.2755, 1.7675, 1.2838]], [[1.7336, 1.4784, 1.6248], [1.357, 1.5661, 1.7272], [1.2308, 1.3227, 1.1596]]], [[[1.5948, 1.6665, 1.3729], [1.8177, 1.8842, 1.4881], [1.4538, 1.4184, 1.8802]], [[1.0153, 1.5069, 1.6829], [1.8568, 1.178, 1.0336], [1.553, 1.0403, 1.0405]]], [[[1.5487, 1.8558, 1.2519], [1.5965, 1.7242, 1.2394], [1.1421, 1.8079, 1.4066]], [[1.5688, 1.2661, 1.1468], [1.2397, 1.5874, 1.2493], [1.092, 1.323, 1.6687]]]]])
print (np.array2string(model.predict([in0Cro70486],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep52315.png')

LCro70486 = cropping3D_layer([[[[[1.6199, 1.8519, 1.9578], [1.7704, 1.2562, 1.9856], [1.2755, 1.7675, 1.2838]], [[1.7336, 1.4784, 1.6248], [1.357, 1.5661, 1.7272], [1.2308, 1.3227, 1.1596]]], [[[1.5948, 1.6665, 1.3729], [1.8177, 1.8842, 1.4881], [1.4538, 1.4184, 1.8802]], [[1.0153, 1.5069, 1.6829], [1.8568, 1.178, 1.0336], [1.553, 1.0403, 1.0405]]], [[[1.5487, 1.8558, 1.2519], [1.5965, 1.7242, 1.2394], [1.1421, 1.8079, 1.4066]], [[1.5688, 1.2661, 1.1468], [1.2397, 1.5874, 1.2493], [1.092, 1.323, 1.6687]]]]], 2, 0, 1, 0, 1, 1, Cro70486), 
LSof63394 = softmax_layer(Cro70486, 1, Sof63394), 
LRes68693 = reshape_layer(Sof63394, [1, 1, 3], Res68693), 
LSep52315 = separable_conv2D_layer(Res68693, 1, 1,[[[[[0.8479], [0.8542], [0.5141]]]],[[[[0.4454, 0.3964, 0.2693, 0.017], [0.0031, 0.8049, 0.8659, 0.3635], [0.039, 0.0986, 0.2382, 0.9408]]]]],[0, 0, 0, 0], 1, 1, false, Sep52315), 
exec_layers([LCro70486,LSof63394,LRes68693,LSep52315],["Cro70486","Sof63394","Res68693","Sep52315"],Sep52315,"Sep52315")

Actual (Unparsed): [[[[0.4003526, 1.0743434, 1.0904499, 0.8085813]]]]

Expected (Unparsed): [[[[0.40035258,1.0743434,1.09044987,0.80858128]]]]

Actual:   [[[[0.4004, 1.0744, 1.0905, 0.8086]]]]

Expected: [[[[0.4004, 1.0744, 1.0905, 0.8086]]]]