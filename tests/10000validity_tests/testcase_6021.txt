import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave67698 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave67698 = tf.keras.layers.Input(shape=([1, 2, 2]))

Ave67698 = keras.layers.Average(name = 'Ave67698', )([in0Ave67698,in1Ave67698])
Glo3496 = keras.layers.GlobalAveragePooling2D(name = 'Glo3496', )(Ave67698)
Bat33394 = keras.layers.BatchNormalization(axis=1, epsilon=0.5718797246494512,  name = 'Bat33394', )(Glo3496)
Res1639 = keras.layers.Reshape((2, 1), name = 'Res1639', )(Bat33394)
Sep56494 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='valid', name = 'Sep56494', )(Res1639)
model = tf.keras.models.Model(inputs=[in0Ave67698,in1Ave67698], outputs=Sep56494)
w = model.get_layer('Bat33394').get_weights() 
w[0] = np.array([0.3193, 0.7227])
w[1] = np.array([0.978, 0.701])
w[2] = np.array([0.3941, 0.731])
w[3] = np.array([0.4856, 0.9302])
model.get_layer('Bat33394').set_weights(w) 
w = model.get_layer('Sep56494').get_weights() 
w[0] = np.array([[[0.2648]]])
w[1] = np.array([[[0.8371, 0.1579]]])
w[2] = np.array([0, 0])
model.get_layer('Sep56494').set_weights(w) 
in0Ave67698 = tf.constant([[[[0.9367, 0.5137], [0.8967, 0.1974]]]])
in1Ave67698 = tf.constant([[[[0.5465, 0.7505], [0.8972, 0.0574]]]])
print (np.array2string(model.predict([in0Ave67698,in1Ave67698],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep56494.png')

LAve67698 = average_layer([[[[[0.9367, 0.5137], [0.8967, 0.1974]]]], [[[[0.5465, 0.7505], [0.8972, 0.0574]]]]], Ave67698), 
LGlo3496 = global_average_pooling2D_layer(Ave67698, Glo3496), 
LBat33394 = batch_normalization_layer(Glo3496, 1, 0.5718797246494512, [0.3193, 0.7227], [0.978, 0.701], [0.3941, 0.731], [0.4856, 0.9302], Bat33394), 
LRes1639 = reshape_layer(Bat33394, [2, 1], Res1639), 
LSep56494 = separable_conv1D_layer(Res1639, 1,[[[[0.2648]]],[[[0.8371, 0.1579]]]],[0, 0], 1, false, Sep56494), 
exec_layers([LAve67698,LGlo3496,LBat33394,LRes1639,LSep56494],["Ave67698","Glo3496","Bat33394","Res1639","Sep56494"],Sep56494,"Sep56494")

Actual (Unparsed): [[[0.2460509, 0.0464120], [0.1094748, 0.0206500]]]

Expected (Unparsed): [[[0.2460509479498627,0.04641195159632461],[0.10947483652968905,0.020649954232514516]]]

Actual:   [[[0.2461, 0.0465], [0.1095, 0.0207]]]

Expected: [[[0.2461, 0.0465], [0.1095, 0.0207]]]