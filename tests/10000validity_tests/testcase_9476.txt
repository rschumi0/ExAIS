import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave83343 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave83343 = tf.keras.layers.Input(shape=([1, 1, 2]))

Ave83343 = keras.layers.Average(name = 'Ave83343', )([in0Ave83343,in1Ave83343])
Res3943 = keras.layers.Reshape((1, 2), name = 'Res3943', )(Ave83343)
Sep34018 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep34018', )(Res3943)
model = tf.keras.models.Model(inputs=[in0Ave83343,in1Ave83343], outputs=Sep34018)
w = model.get_layer('Sep34018').get_weights() 
w[0] = np.array([[[0.9984], [0.7765]]])
w[1] = np.array([[[0.6325, 0.6439, 0.7175], [0.6141, 0.2742, 0.711]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep34018').set_weights(w) 
in0Ave83343 = tf.constant([[[[0.767, 0.2687]]]])
in1Ave83343 = tf.constant([[[[0.7129, 0.8418]]]])
print (np.array2string(model.predict([in0Ave83343,in1Ave83343],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep34018.png')

LAve83343 = average_layer([[[[[0.767, 0.2687]]]], [[[[0.7129, 0.8418]]]]], Ave83343), 
LRes3943 = reshape_layer(Ave83343, [1, 2], Res3943), 
LSep34018 = separable_conv1D_layer(Res3943, 1,[[[[0.9984], [0.7765]]],[[[0.6325, 0.6439, 0.7175], [0.6141, 0.2742, 0.711]]]],[0, 0, 0], 1, false, Sep34018), 
exec_layers([LAve83343,LRes3943,LSep34018],["Ave83343","Res3943","Sep34018"],Sep34018,"Sep34018")

Actual (Unparsed): [[[0.7320398, 0.5939133, 0.8366135]]]

Expected (Unparsed): [[[0.7320397585124999,0.593913254487,0.836613467775]]]

Actual:   [[[0.7321, 0.594, 0.8367]]]

Expected: [[[0.7321, 0.594, 0.8367]]]