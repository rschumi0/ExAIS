import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot41521 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot41521 = tf.keras.layers.Input(shape=([2, 3]))
in0PRe13239 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con24108 = tf.keras.layers.Input(shape=([3, 3, 1, 1]))
in0Max21032 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Max21032 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Dot41521 = keras.layers.Dot(axes=(1, 1), name = 'Dot41521', )([in0Dot41521,in1Dot41521])
PRe13239 = keras.layers.PReLU(name = 'PRe13239', input_shape=(1, 1, 1, 1))(in0PRe13239)
Res36727 = keras.layers.Reshape((1, 1, 1), name = 'Res36727', )(PRe13239)
Res20485 = keras.layers.Reshape((1, 1), name = 'Res20485', )(Res36727)
Con17350 = keras.layers.Conv1D(3, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con17350', )(Res20485)
Zer9252 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer9252', )(Con17350)
Sub42007 = keras.layers.Subtract(name = 'Sub42007', )([Dot41521,Zer9252])
Res52064 = keras.layers.Reshape((3, 3, 1), name = 'Res52064', )(Sub42007)
Res75910 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res75910', )(Res52064)
Con24108 = keras.layers.Concatenate(axis=4, name = 'Con24108', )([Res75910,in0Con24108])
Max21032 = keras.layers.Maximum(name = 'Max21032', )([in0Max21032,in1Max21032])
Zer68593 = keras.layers.ZeroPadding3D(padding=((2, 0), (1, 0), (0, 0)), name = 'Zer68593', )(Max21032)
Min32060 = keras.layers.Minimum(name = 'Min32060', )([Con24108,Zer68593])
model = tf.keras.models.Model(inputs=[in0Dot41521,in1Dot41521,in0PRe13239,in0Con24108,in0Max21032,in1Max21032], outputs=Min32060)
w = model.get_layer('PRe13239').get_weights() 
w[0] = np.array([[[[0.0034]]]])
model.get_layer('PRe13239').set_weights(w) 
w = model.get_layer('Con17350').get_weights() 
w[0] = np.array([[[0.5117, 0.272, 0.3388]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con17350').set_weights(w) 
in0Dot41521 = tf.constant([[[0.3565, 0.6939, 0.1432], [0.3798, 0.6029, 0.138]]])
in1Dot41521 = tf.constant([[[0.3287, 0.1612, 0.5556], [0.5445, 0.7618, 0.0176]]])
in0PRe13239 = tf.constant([[[[[0.1667]]]]])
in0Con24108 = tf.constant([[[[[0.6245]], [[0.9116]], [[0.7875]]], [[[0.2473]], [[0.6842]], [[0.3329]]], [[[0.5314]], [[0.728]], [[0.7864]]]]])
in0Max21032 = tf.constant([[[[[0.1679, 0.0904]], [[0.8931, 0.202]]]]])
in1Max21032 = tf.constant([[[[[0.1917, 0.4636]], [[0.658, 0.935]]]]])
print (np.array2string(model.predict([in0Dot41521,in1Dot41521,in0PRe13239,in0Con24108,in0Max21032,in1Max21032],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min32060.png')

LDot41521 = dot_layer([[[0.3565, 0.6939, 0.1432], [0.3798, 0.6029, 0.138]]], [[[0.3287, 0.1612, 0.5556], [0.5445, 0.7618, 0.0176]]], 1, 1, Dot41521), 
LPRe13239 = prelu_layer([[[[[0.1667]]]]], [[[[0.0034]]]], PRe13239), 
LRes36727 = reshape_layer(PRe13239, [1, 1, 1], Res36727), 
LRes20485 = reshape_layer(Res36727, [1, 1], Res20485), 
LCon17350 = conv1D_layer(Res20485, 1,[[[0.5117, 0.272, 0.3388]]],[0, 0, 0], 1, false, 1, Con17350), 
LZer9252 = zero_padding1D_layer(Con17350, 2, 0, Zer9252), 
LSub42007 = subtract_layer(Dot41521,Zer9252, Sub42007), 
LRes52064 = reshape_layer(Sub42007, [3, 3, 1], Res52064), 
LRes75910 = reshape_layer(Res52064, [3, 3, 1, 1], Res75910), 
LCon24108 = concatenate_layer([Res75910,[[[[[0.6245]], [[0.9116]], [[0.7875]]], [[[0.2473]], [[0.6842]], [[0.3329]]], [[[0.5314]], [[0.728]], [[0.7864]]]]]], 4, Con24108), 
LMax21032 = maximum_layer([[[[[[0.1679, 0.0904]], [[0.8931, 0.202]]]]], [[[[[0.1917, 0.4636]], [[0.658, 0.935]]]]]], Max21032), 
LZer68593 = zero_padding3D_layer(Max21032, 2, 0, 1, 0, 0, 0, Zer68593), 
LMin32060 = minimum_layer([Con24108,Zer68593], Min32060), 
exec_layers([LDot41521,LPRe13239,LRes36727,LRes20485,LCon17350,LZer9252,LSub42007,LRes52064,LRes75910,LCon24108,LMax21032,LZer68593,LMin32060],["Dot41521","PRe13239","Res36727","Res20485","Con17350","Zer9252","Sub42007","Res52064","Res75910","Con24108","Max21032","Zer68593","Min32060"],Min32060,"Min32060")

Actual (Unparsed): [[[[[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]], [[0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000]], [[0.0828698, 0.4636000]], [[0.0255128, 0.7864000]]]]]

Expected (Unparsed): [[[[[0,0]],[[0,0]],[[0,0]]],[[[0,0]],[[0,0]],[[0,0]]],[[[0,0]],[[0.08286984,0.4636]],[[0.025512759999999995,0.7864]]]]]

Actual:   [[[[[0, 0]], [[0, 0]], [[0, 0]]], [[[0, 0]], [[0, 0]], [[0, 0]]], [[[0, 0]], [[0.0829, 0.4636]], [[0.0256, 0.7864]]]]]

Expected: [[[[[0, 0]], [[0, 0]], [[0, 0]]], [[[0, 0]], [[0, 0]], [[0, 0]]], [[[0, 0]], [[0.0829, 0.4636]], [[0.0256, 0.7864]]]]]