import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo26791 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Up_33992 = tf.keras.layers.Input(shape=([1, 1]))

Glo26791 = keras.layers.GlobalMaxPool2D(name = 'Glo26791', )(in0Glo26791)
Res23083 = keras.layers.Reshape((2, 1), name = 'Res23083', )(Glo26791)
Up_33992 = keras.layers.UpSampling1D(size=(2), name = 'Up_33992', )(in0Up_33992)
Add76864 = keras.layers.Add(name = 'Add76864', )([Res23083,Up_33992])
Res56285 = keras.layers.Reshape((2, 1, 1), name = 'Res56285', )(Add76864)
PRe46783 = keras.layers.PReLU(name = 'PRe46783', )(Res56285)
model = tf.keras.models.Model(inputs=[in0Glo26791,in0Up_33992], outputs=PRe46783)
w = model.get_layer('PRe46783').get_weights() 
w[0] = np.array([[[0.589]], [[0.7672]]])
model.get_layer('PRe46783').set_weights(w) 
in0Glo26791 = tf.constant([[[[1.1267, 1.9726]]]])
in0Up_33992 = tf.constant([[[1.5692]]])
print (np.array2string(model.predict([in0Glo26791,in0Up_33992],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe46783.png')

LGlo26791 = global_max_pool2D_layer([[[[1.1267, 1.9726]]]], Glo26791), 
LRes23083 = reshape_layer(Glo26791, [2, 1], Res23083), 
LUp_33992 = up_sampling1D_layer([[[1.5692]]], 2, Up_33992), 
LAdd76864 = add_layer([Res23083,Up_33992], Add76864), 
LRes56285 = reshape_layer(Add76864, [2, 1, 1], Res56285), 
LPRe46783 = prelu_layer(Res56285, [[[0.589]], [[0.7672]]], PRe46783), 
exec_layers([LGlo26791,LRes23083,LUp_33992,LAdd76864,LRes56285,LPRe46783],["Glo26791","Res23083","Up_33992","Add76864","Res56285","PRe46783"],PRe46783,"PRe46783")

Actual (Unparsed): [[[[2.6959001]], [[3.5418000]]]]

Expected (Unparsed): [[[[2.6959]],[[3.5418]]]]

Actual:   [[[[2.696]], [[3.5418]]]]

Expected: [[[[2.6959]], [[3.5418]]]]