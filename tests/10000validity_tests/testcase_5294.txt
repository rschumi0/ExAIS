import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave2487 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave2487 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con9216 = tf.keras.layers.Input(shape=([2, 3, 3, 1]))
in0ELU65269 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Sub80598 = tf.keras.layers.Input(shape=([3]))
in1Sub80598 = tf.keras.layers.Input(shape=([3]))
in0Min49312 = tf.keras.layers.Input(shape=([2, 2]))
in1Min49312 = tf.keras.layers.Input(shape=([2, 2]))
in0Con31482 = tf.keras.layers.Input(shape=([3, 3, 5]))

Ave2487 = keras.layers.Average(name = 'Ave2487', )([in0Ave2487,in1Ave2487])
Res72281 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res72281', )(Ave2487)
Zer60564 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer60564', )(Res72281)
Con9216 = keras.layers.Concatenate(axis=4, name = 'Con9216', )([Zer60564,in0Con9216])
ELU65269 = keras.layers.ELU(alpha=-4.964573462808486, name = 'ELU65269', input_shape=(2, 1, 1, 2))(in0ELU65269)
Zer66957 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (2, 0)), name = 'Zer66957', )(ELU65269)
Mul72911 = keras.layers.Multiply(name = 'Mul72911', )([Con9216,Zer66957])
Res14741 = keras.layers.Reshape((2, 3, 6), name = 'Res14741', )(Mul72911)
Zer70695 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer70695', )(Res14741)
Sub80598 = keras.layers.Subtract(name = 'Sub80598', )([in0Sub80598,in1Sub80598])
Res75652 = keras.layers.Reshape((3, 1), name = 'Res75652', )(Sub80598)
Res15434 = keras.layers.Reshape((3, 1, 1), name = 'Res15434', )(Res75652)
Zer14565 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer14565', )(Res15434)
Min49312 = keras.layers.Minimum(name = 'Min49312', )([in0Min49312,in1Min49312])
Res69014 = keras.layers.Reshape((2, 2, 1), name = 'Res69014', )(Min49312)
Dep96185 = keras.layers.DepthwiseConv2D((2, 1),strides=(1, 1), padding='valid', name = 'Dep96185', )(Res69014)
Zer30429 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer30429', )(Dep96185)
Sub97939 = keras.layers.Subtract(name = 'Sub97939', )([Zer14565,Zer30429])
Con31482 = keras.layers.Concatenate(axis=3, name = 'Con31482', )([Sub97939,in0Con31482])
Add80540 = keras.layers.Add(name = 'Add80540', )([Zer70695,Con31482])
Res13827 = keras.layers.Reshape((3, 18), name = 'Res13827', )(Add80540)
Ave36160 = keras.layers.AveragePooling1D(pool_size=(1), strides=(3), padding='valid', name = 'Ave36160', )(Res13827)
model = tf.keras.models.Model(inputs=[in0Ave2487,in1Ave2487,in0Con9216,in0ELU65269,in0Sub80598,in1Sub80598,in0Min49312,in1Min49312,in0Con31482], outputs=Ave36160)
w = model.get_layer('Dep96185').get_weights() 
w[0] = np.array([[[[0.816]]], [[[0.9476]]]])
w[1] = np.array([0])
model.get_layer('Dep96185').set_weights(w) 
in0Ave2487 = tf.constant([[[[0.4462, 0.7999], [0.4676, 0.3508]]]])
in1Ave2487 = tf.constant([[[[0.6682, 0.6139], [0.4076, 0.2977]]]])
in0Con9216 = tf.constant([[[[[0.8065], [0.5994], [0.9628]], [[0.5289], [0.755], [0.5983]], [[0.5059], [0.5955], [0.5655]]], [[[0.1042], [0.1798], [0.1861]], [[0.8332], [0.3974], [0.7763]], [[0.0933], [0.2369], [0.3688]]]]])
in0ELU65269 = tf.constant([[[[[0.6595, 0.885]]], [[[0.2486, 0.3796]]]]])
in0Sub80598 = tf.constant([[0.5992, 0.5813, 0.5084]])
in1Sub80598 = tf.constant([[0.1527, 0.0695, 0.2729]])
in0Min49312 = tf.constant([[[0.0753, 0.3489], [0.4587, 0.3147]]])
in1Min49312 = tf.constant([[[0.232, 0.6579], [0.1687, 0.7504]]])
in0Con31482 = tf.constant([[[[0.3254, 0.8376, 0.413, 0.567, 0.3958], [0.3531, 0.8695, 0.631, 0.2778, 0.8549], [0.7543, 0.2518, 0.1688, 0.7577, 0.3665]], [[0.3646, 0.4984, 0.7356, 0.2085, 0.6386], [0.1304, 0.336, 0.0363, 0.5345, 0.2021], [0.2087, 0.2788, 0.5704, 0.5963, 0.5715]], [[0.3276, 0.6327, 0.9982, 0.2166, 0.1684], [0.4869, 0.7228, 0.5736, 0.5763, 0.9961], [0.0165, 0.0883, 0.6279, 0.94, 0.3321]]]])
print (np.array2string(model.predict([in0Ave2487,in1Ave2487,in0Con9216,in0ELU65269,in0Sub80598,in1Sub80598,in0Min49312,in1Min49312,in0Con31482],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave36160.png')

LAve2487 = average_layer([[[[[0.4462, 0.7999], [0.4676, 0.3508]]]], [[[[0.6682, 0.6139], [0.4076, 0.2977]]]]], Ave2487), 
LRes72281 = reshape_layer(Ave2487, [1, 2, 2, 1], Res72281), 
LZer60564 = zero_padding3D_layer(Res72281, 1, 0, 1, 0, 1, 0, Zer60564), 
LCon9216 = concatenate_layer([Zer60564,[[[[[0.8065], [0.5994], [0.9628]], [[0.5289], [0.755], [0.5983]], [[0.5059], [0.5955], [0.5655]]], [[[0.1042], [0.1798], [0.1861]], [[0.8332], [0.3974], [0.7763]], [[0.0933], [0.2369], [0.3688]]]]]], 4, Con9216), 
LELU65269 = elu_layer([[[[[0.6595, 0.885]]], [[[0.2486, 0.3796]]]]], -4.964573462808486, ELU65269), 
LZer66957 = zero_padding3D_layer(ELU65269, 0, 0, 2, 0, 2, 0, Zer66957), 
LMul72911 = multiply_layer([Con9216,Zer66957], Mul72911), 
LRes14741 = reshape_layer(Mul72911, [2, 3, 6], Res14741), 
LZer70695 = zero_padding2D_layer(Res14741, 1, 0, 0, 0, Zer70695), 
LSub80598 = subtract_layer([[0.5992, 0.5813, 0.5084]], [[0.1527, 0.0695, 0.2729]], Sub80598), 
LRes75652 = reshape_layer(Sub80598, [3, 1], Res75652), 
LRes15434 = reshape_layer(Res75652, [3, 1, 1], Res15434), 
LZer14565 = zero_padding2D_layer(Res15434, 0, 0, 2, 0, Zer14565), 
LMin49312 = minimum_layer([[[[0.0753, 0.3489], [0.4587, 0.3147]]], [[[0.232, 0.6579], [0.1687, 0.7504]]]], Min49312), 
LRes69014 = reshape_layer(Min49312, [2, 2, 1], Res69014), 
LDep96185 = depthwise_conv2D_layer(Res69014, 2, 1,[[[[0.816]]], [[[0.9476]]]],[0], 1, 1, false, Dep96185), 
LZer30429 = zero_padding2D_layer(Dep96185, 2, 0, 1, 0, Zer30429), 
LSub97939 = subtract_layer(Zer14565,Zer30429, Sub97939), 
LCon31482 = concatenate_layer([Sub97939,[[[[0.3254, 0.8376, 0.413, 0.567, 0.3958], [0.3531, 0.8695, 0.631, 0.2778, 0.8549], [0.7543, 0.2518, 0.1688, 0.7577, 0.3665]], [[0.3646, 0.4984, 0.7356, 0.2085, 0.6386], [0.1304, 0.336, 0.0363, 0.5345, 0.2021], [0.2087, 0.2788, 0.5704, 0.5963, 0.5715]], [[0.3276, 0.6327, 0.9982, 0.2166, 0.1684], [0.4869, 0.7228, 0.5736, 0.5763, 0.9961], [0.0165, 0.0883, 0.6279, 0.94, 0.3321]]]]], 3, Con31482), 
LAdd80540 = add_layer([Zer70695,Con31482], Add80540), 
LRes13827 = reshape_layer(Add80540, [3, 18], Res13827), 
LAve36160 = average_pooling1D_layer(Res13827, 1, 3, false, Ave36160), 
exec_layers([LAve2487,LRes72281,LZer60564,LCon9216,LELU65269,LZer66957,LMul72911,LRes14741,LZer70695,LSub80598,LRes75652,LRes15434,LZer14565,LMin49312,LRes69014,LDep96185,LZer30429,LSub97939,LCon31482,LAdd80540,LRes13827,LAve36160],["Ave2487","Res72281","Zer60564","Con9216","ELU65269","Zer66957","Mul72911","Res14741","Zer70695","Sub80598","Res75652","Res15434","Zer14565","Min49312","Res69014","Dep96185","Zer30429","Sub97939","Con31482","Add80540","Res13827","Ave36160"],Ave36160,"Ave36160")

Actual (Unparsed): [[[0.0000000, 0.3254000, 0.8376000, 0.4130000, 0.5670000, 0.3958000, 0.0000000, 0.3531000, 0.8695000, 0.6310000, 0.2778000, 0.8549000, 0.4465000, 0.7543000, 0.2518000, 0.1688000, 0.7577000, 0.3665000]]]

Expected (Unparsed): [[[0,0.3254,0.8376,0.413,0.567,0.3958,0,0.3531,0.8695,0.631,0.2778,0.8549,0.44649999999999995,0.7543,0.2518,0.1688,0.7577,0.3665]]]

Actual:   [[[0, 0.3254, 0.8376, 0.413, 0.567, 0.3958, 0, 0.3531, 0.8695, 0.631, 0.2778, 0.8549, 0.4465, 0.7543, 0.2518, 0.1688, 0.7577, 0.3665]]]

Expected: [[[0, 0.3254, 0.8376, 0.413, 0.567, 0.3958, 0, 0.3531, 0.8695, 0.631, 0.2778, 0.8549, 0.4465, 0.7543, 0.2518, 0.1688, 0.7577, 0.3665]]]