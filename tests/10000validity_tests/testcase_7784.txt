import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla57262 = tf.keras.layers.Input(shape=([1]))
in0Con84312 = tf.keras.layers.Input(shape=([1, 3]))
in0Den86132 = tf.keras.layers.Input(shape=([5, 3, 2]))

Fla57262 = keras.layers.Flatten(name = 'Fla57262', )(in0Fla57262)
Res8856 = keras.layers.Reshape((1, 1), name = 'Res8856', )(Fla57262)
Con84312 = keras.layers.Concatenate(axis=2, name = 'Con84312', )([Res8856,in0Con84312])
Den86132 = keras.layers.Dense(1,name = 'Den86132', )(in0Den86132)
Res1596 = keras.layers.Reshape((5, 3, 1, 1), name = 'Res1596', )(Den86132)
Up_2450 = keras.layers.UpSampling3D(size=(2, 1, 2), name = 'Up_2450', )(Res1596)
Up_82865 = keras.layers.UpSampling3D(size=(1, 2, 1), name = 'Up_82865', )(Up_2450)
Res95762 = keras.layers.Reshape((10, 6, 2), name = 'Res95762', )(Up_82865)
Res26638 = keras.layers.Reshape((10, 12), name = 'Res26638', )(Res95762)
Sep54242 = keras.layers.SeparableConv1D(4, (8),strides=(7), padding='valid', name = 'Sep54242', )(Res26638)
Add90399 = keras.layers.Add(name = 'Add90399', )([Con84312,Sep54242])
Res10220 = keras.layers.Reshape((1, 4, 1), name = 'Res10220', )(Add90399)
PRe26056 = keras.layers.PReLU(name = 'PRe26056', )(Res10220)
model = tf.keras.models.Model(inputs=[in0Fla57262,in0Con84312,in0Den86132], outputs=PRe26056)
w = model.get_layer('Den86132').get_weights() 
w[0] = np.array([[0.6926], [0.3786]])
w[1] = np.array([0.3696])
model.get_layer('Den86132').set_weights(w) 
w = model.get_layer('Sep54242').get_weights() 
w[0] = np.array([[[0.0933], [0.6497], [0.7743], [0.2625], [0.924], [0.6362], [0.8863], [0.1938], [0.419], [0.8717], [0.9738], [0.432]], [[0.9404], [0.2237], [0.9845], [0.4428], [0.5184], [0.7238], [0.7676], [0.2152], [0.4435], [0.1611], [0.8998], [0.1106]], [[0.8585], [0.8828], [0.4311], [0.1601], [0.675], [0.3977], [0.2995], [0.6195], [0.2165], [0.5924], [0.3277], [0.0063]], [[0.485], [0.2407], [0.7786], [0.4215], [0.8404], [0.0174], [0.4241], [0.6876], [0.1833], [0.4116], [0.9585], [0.7253]], [[0.4425], [0.7734], [0.3757], [0.6316], [0.2802], [0.2279], [0.6202], [0.1251], [0.4498], [0.342], [0.4228], [0.3789]], [[0.1672], [0.2395], [0.7347], [0.7761], [0.19], [0.3253], [0.5848], [0.7891], [0.0382], [0.9034], [0.5054], [0.012]], [[0.9355], [0.7483], [0.8903], [0.3548], [0.6015], [0.1283], [0.7839], [0.547], [0.9841], [0.866], [0.6326], [0.3915]], [[0.3846], [0.7713], [0.4742], [0.6593], [0.2001], [0.183], [0.8882], [0.1245], [0.6816], [0.4184], [0.787], [0.9983]]])
w[1] = np.array([[[0.8774, 0.1865, 0.2615, 0.4226], [0.6921, 0.9779, 0.1112, 0.5121], [0.2145, 0.8683, 0.5847, 0.6652], [0.5857, 0.7536, 0.9304, 0.4604], [0.1129, 0.7701, 0.3737, 0.369], [0.2962, 0.9304, 0.8242, 0.9662], [0.5917, 0.801, 0.1904, 0.7057], [0.9209, 0.411, 0.8058, 0.2268], [0.151, 0.9269, 0.7584, 0.7055], [0.3792, 0.6202, 0.1048, 0.4597], [0.8801, 0.3129, 0.0514, 0.8779], [0.9967, 0.7917, 0.1884, 0.7519]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep54242').set_weights(w) 
w = model.get_layer('PRe26056').get_weights() 
w[0] = np.array([[[0.1651], [0.178], [0.5259], [0.3276]]])
model.get_layer('PRe26056').set_weights(w) 
in0Fla57262 = tf.constant([[1.7046]])
in0Con84312 = tf.constant([[[0.6739, 0.3544, 0.2735]]])
in0Den86132 = tf.constant([[[[0.9712, 0.2686], [0.7872, 0.5623], [0.0098, 0.2526]], [[0.0884, 0.6952], [0.5915, 0.3179], [0.8475, 0.5985]], [[0.0457, 0.0472], [0.465, 0.4955], [0.0104, 0.1724]], [[0.2771, 0.1286], [0.5835, 0.0238], [0.3954, 0.6421]], [[0.1105, 0.6211], [0.5187, 0.211], [0.3639, 0.6857]]]])
print (np.array2string(model.predict([in0Fla57262,in0Con84312,in0Den86132],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe26056.png')

LFla57262 = flatten_layer([[1.7046]], Fla57262), 
LRes8856 = reshape_layer(Fla57262, [1, 1], Res8856), 
LCon84312 = concatenate_layer([Res8856,[[[0.6739, 0.3544, 0.2735]]]], 2, Con84312), 
LDen86132 = dense_layer([[[[0.9712, 0.2686], [0.7872, 0.5623], [0.0098, 0.2526]], [[0.0884, 0.6952], [0.5915, 0.3179], [0.8475, 0.5985]], [[0.0457, 0.0472], [0.465, 0.4955], [0.0104, 0.1724]], [[0.2771, 0.1286], [0.5835, 0.0238], [0.3954, 0.6421]], [[0.1105, 0.6211], [0.5187, 0.211], [0.3639, 0.6857]]]], [[0.6926], [0.3786]],[0.3696], Den86132), 
LRes1596 = reshape_layer(Den86132, [5, 3, 1, 1], Res1596), 
LUp_2450 = up_sampling3D_layer(Res1596, 2, 1, 2, Up_2450), 
LUp_82865 = up_sampling3D_layer(Up_2450, 1, 2, 1, Up_82865), 
LRes95762 = reshape_layer(Up_82865, [10, 6, 2], Res95762), 
LRes26638 = reshape_layer(Res95762, [10, 12], Res26638), 
LSep54242 = separable_conv1D_layer(Res26638, 8,[[[[0.0933], [0.6497], [0.7743], [0.2625], [0.924], [0.6362], [0.8863], [0.1938], [0.419], [0.8717], [0.9738], [0.432]], [[0.9404], [0.2237], [0.9845], [0.4428], [0.5184], [0.7238], [0.7676], [0.2152], [0.4435], [0.1611], [0.8998], [0.1106]], [[0.8585], [0.8828], [0.4311], [0.1601], [0.675], [0.3977], [0.2995], [0.6195], [0.2165], [0.5924], [0.3277], [0.0063]], [[0.485], [0.2407], [0.7786], [0.4215], [0.8404], [0.0174], [0.4241], [0.6876], [0.1833], [0.4116], [0.9585], [0.7253]], [[0.4425], [0.7734], [0.3757], [0.6316], [0.2802], [0.2279], [0.6202], [0.1251], [0.4498], [0.342], [0.4228], [0.3789]], [[0.1672], [0.2395], [0.7347], [0.7761], [0.19], [0.3253], [0.5848], [0.7891], [0.0382], [0.9034], [0.5054], [0.012]], [[0.9355], [0.7483], [0.8903], [0.3548], [0.6015], [0.1283], [0.7839], [0.547], [0.9841], [0.866], [0.6326], [0.3915]], [[0.3846], [0.7713], [0.4742], [0.6593], [0.2001], [0.183], [0.8882], [0.1245], [0.6816], [0.4184], [0.787], [0.9983]]],[[[0.8774, 0.1865, 0.2615, 0.4226], [0.6921, 0.9779, 0.1112, 0.5121], [0.2145, 0.8683, 0.5847, 0.6652], [0.5857, 0.7536, 0.9304, 0.4604], [0.1129, 0.7701, 0.3737, 0.369], [0.2962, 0.9304, 0.8242, 0.9662], [0.5917, 0.801, 0.1904, 0.7057], [0.9209, 0.411, 0.8058, 0.2268], [0.151, 0.9269, 0.7584, 0.7055], [0.3792, 0.6202, 0.1048, 0.4597], [0.8801, 0.3129, 0.0514, 0.8779], [0.9967, 0.7917, 0.1884, 0.7519]]]],[0, 0, 0, 0], 7, false, Sep54242), 
LAdd90399 = add_layer([Con84312,Sep54242], Add90399), 
LRes10220 = reshape_layer(Add90399, [1, 4, 1], Res10220), 
LPRe26056 = prelu_layer(Res10220, [[[0.1651], [0.178], [0.5259], [0.3276]]], PRe26056), 
exec_layers([LFla57262,LRes8856,LCon84312,LDen86132,LRes1596,LUp_2450,LUp_82865,LRes95762,LRes26638,LSep54242,LAdd90399,LRes10220,LPRe26056],["Fla57262","Res8856","Con84312","Den86132","Res1596","Up_2450","Up_82865","Res95762","Res26638","Sep54242","Add90399","Res10220","PRe26056"],PRe26056,"PRe26056")

Actual (Unparsed): [[[[23.5923477], [28.1900840], [16.1996764], [24.0871540]]]]

Expected (Unparsed): [[[[23.592347684277748],[28.190083982988213],[16.199676392247365],[24.08715397295396]]]]

Actual:   [[[[23.5924], [28.1901], [16.1997], [24.0872]]]]

Expected: [[[[23.5924], [28.1901], [16.1997], [24.0872]]]]