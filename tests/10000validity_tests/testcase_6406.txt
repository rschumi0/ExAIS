import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul57727 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul57727 = tf.keras.layers.Input(shape=([2, 2]))
in0ReL28797 = tf.keras.layers.Input(shape=([2, 2]))

Mul57727 = keras.layers.Multiply(name = 'Mul57727', )([in0Mul57727,in1Mul57727])
ReL28797 = keras.layers.ReLU(max_value=8.266517838144422, negative_slope=5.078066055713856, threshold=4.346234630261941, name = 'ReL28797', input_shape=(2, 2))(in0ReL28797)
Mul68597 = keras.layers.Multiply(name = 'Mul68597', )([Mul57727,ReL28797])
model = tf.keras.models.Model(inputs=[in0Mul57727,in1Mul57727,in0ReL28797], outputs=Mul68597)
in0Mul57727 = tf.constant([[[0.5641, 0.5065], [0.7383, 0.0405]]])
in1Mul57727 = tf.constant([[[0.9358, 0.0277], [0.1727, 0.4963]]])
in0ReL28797 = tf.constant([[[0.3015, 0.2509], [0.6181, 0.6718]]])
print (np.array2string(model.predict([in0Mul57727,in1Mul57727,in0ReL28797],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul68597.png')

LMul57727 = multiply_layer([[[[0.5641, 0.5065], [0.7383, 0.0405]]], [[[0.9358, 0.0277], [0.1727, 0.4963]]]], Mul57727), 
LReL28797 = relu_layer([[[0.3015, 0.2509], [0.6181, 0.6718]]], 8.266517838144422, 5.078066055713856, 4.346234630261941, ReL28797), 
LMul68597 = multiply_layer([Mul57727,ReL28797], Mul68597), 
exec_layers([LMul57727,LReL28797,LMul68597],["Mul57727","ReL28797","Mul68597"],Mul68597,"Mul68597")

Actual (Unparsed): [[[-10.8424530, -0.2917742], [-2.4138771, -0.3750491]]]

Expected (Unparsed): [[[-10.842452291718244,-0.29177424803028695],[-2.4138770132840968,-0.37504913642770593]]]

Actual:   [[[-10.8424, -0.2917], [-2.4138, -0.375]]]

Expected: [[[-10.8424, -0.2917], [-2.4138, -0.375]]]