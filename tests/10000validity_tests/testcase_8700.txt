import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max69874 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Max69874 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Max17520 = tf.keras.layers.Input(shape=([2, 2]))
in0Con6238 = tf.keras.layers.Input(shape=([2, 3, 1]))

Max69874 = keras.layers.Maximum(name = 'Max69874', )([in0Max69874,in1Max69874])
Res16953 = keras.layers.Reshape((2, 1, 2), name = 'Res16953', )(Max69874)
Zer56816 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer56816', )(Res16953)
Max17520 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max17520', )(in0Max17520)
Res98572 = keras.layers.Reshape((1, 2, 1), name = 'Res98572', )(Max17520)
Cro3409 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro3409', )(Res98572)
Zer36492 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer36492', )(Cro3409)
Con6238 = keras.layers.Concatenate(axis=3, name = 'Con6238', )([Zer36492,in0Con6238])
Ave20715 = keras.layers.Average(name = 'Ave20715', )([Zer56816,Con6238])
model = tf.keras.models.Model(inputs=[in0Max69874,in1Max69874,in0Max17520,in0Con6238], outputs=Ave20715)
in0Max69874 = tf.constant([[[[[0.176, 0.9278]]], [[[0.178, 0.8097]]]]])
in1Max69874 = tf.constant([[[[[0.9316, 0.0364]]], [[[0.105, 0.9307]]]]])
in0Max17520 = tf.constant([[[1.8232, 1.8329], [1.7955, 1.5949]]])
in0Con6238 = tf.constant([[[[0.9132], [0.7099], [0.7001]], [[0.3967], [0.8466], [0.9232]]]])
print (np.array2string(model.predict([in0Max69874,in1Max69874,in0Max17520,in0Con6238],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave20715.png')

LMax69874 = maximum_layer([[[[[[0.176, 0.9278]]], [[[0.178, 0.8097]]]]], [[[[[0.9316, 0.0364]]], [[[0.105, 0.9307]]]]]], Max69874), 
LRes16953 = reshape_layer(Max69874, [2, 1, 2], Res16953), 
LZer56816 = zero_padding2D_layer(Res16953, 0, 0, 2, 0, Zer56816), 
LMax17520 = max_pool1D_layer([[[1.8232, 1.8329], [1.7955, 1.5949]]], 2, Max17520), 
LRes98572 = reshape_layer(Max17520, [1, 2, 1], Res98572), 
LCro3409 = cropping2D_layer(Res98572, 0, 0, 0, 0, Cro3409), 
LZer36492 = zero_padding2D_layer(Cro3409, 1, 0, 1, 0, Zer36492), 
LCon6238 = concatenate_layer([Zer36492,[[[[0.9132], [0.7099], [0.7001]], [[0.3967], [0.8466], [0.9232]]]]], 3, Con6238), 
LAve20715 = average_layer([Zer56816,Con6238], Ave20715), 
exec_layers([LMax69874,LRes16953,LZer56816,LMax17520,LRes98572,LCro3409,LZer36492,LCon6238,LAve20715],["Max69874","Res16953","Zer56816","Max17520","Res98572","Cro3409","Zer36492","Con6238","Ave20715"],Ave20715,"Ave20715")

Actual (Unparsed): [[[[0.0000000, 0.4566000], [0.0000000, 0.3549500], [0.4658000, 0.8139500]], [[0.0000000, 0.1983500], [0.9116000, 0.4233000], [1.0054500, 0.9269500]]]]

Expected (Unparsed): [[[[0,0.4566],[0,0.35495],[0.4658,0.81395]],[[0,0.19835],[0.9116,0.4233],[1.00545,0.9269499999999999]]]]

Actual:   [[[[0, 0.4566], [0, 0.355], [0.4658, 0.814]], [[0, 0.1984], [0.9116, 0.4233], [1.0055, 0.927]]]]

Expected: [[[[0, 0.4566], [0, 0.355], [0.4658, 0.814]], [[0, 0.1984], [0.9116, 0.4233], [1.0055, 0.927]]]]