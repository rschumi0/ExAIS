import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL19365 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Glo32958 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

ReL19365 = keras.layers.ReLU(max_value=6.944719013340809, negative_slope=5.255493672951276, threshold=9.253887834694975, name = 'ReL19365', input_shape=(1, 2, 2, 1))(in0ReL19365)
Mas91516 = keras.layers.Masking(mask_value=2, name = 'Mas91516', )(ReL19365)
Res99127 = keras.layers.Reshape((1, 2, 2), name = 'Res99127', )(Mas91516)
Glo43111 = keras.layers.GlobalAveragePooling2D(name = 'Glo43111', )(Res99127)
Res25343 = keras.layers.Reshape((2, 1), name = 'Res25343', )(Glo43111)
Sep50047 = keras.layers.SeparableConv1D(2, (2),strides=(1), padding='valid', name = 'Sep50047', )(Res25343)
Res32591 = keras.layers.Reshape((1, 2, 1), name = 'Res32591', )(Sep50047)
Glo32958 = keras.layers.GlobalMaxPool3D(name = 'Glo32958', )(in0Glo32958)
Res3519 = keras.layers.Reshape((1, 1), name = 'Res3519', )(Glo32958)
Res72466 = keras.layers.Reshape((1, 1, 1), name = 'Res72466', )(Res3519)
Res41504 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res41504', )(Res72466)
Up_18054 = keras.layers.UpSampling3D(size=(1, 2, 1), name = 'Up_18054', )(Res41504)
Res23507 = keras.layers.Reshape((1, 2, 1), name = 'Res23507', )(Up_18054)
Max13002 = keras.layers.Maximum(name = 'Max13002', )([Res32591,Res23507])
model = tf.keras.models.Model(inputs=[in0ReL19365,in0Glo32958], outputs=Max13002)
w = model.get_layer('Sep50047').get_weights() 
w[0] = np.array([[[0.9215]], [[0.2681]]])
w[1] = np.array([[[0.6651, 0.9342]]])
w[2] = np.array([0, 0])
model.get_layer('Sep50047').set_weights(w) 
in0ReL19365 = tf.constant([[[[[0.3365], [0.1933]], [[0.091], [0.5051]]]]])
in0Glo32958 = tf.constant([[[[[1.8223]], [[1.5865]]], [[[1.6823]], [[1.2685]]]]])
print (np.array2string(model.predict([in0ReL19365,in0Glo32958],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max13002.png')

LReL19365 = relu_layer([[[[[0.3365], [0.1933]], [[0.091], [0.5051]]]]], 6.944719013340809, 5.255493672951276, 9.253887834694975, ReL19365), 
LMas91516 = masking_layer(ReL19365, 2, Mas91516), 
LRes99127 = reshape_layer(Mas91516, [1, 2, 2], Res99127), 
LGlo43111 = global_average_pooling2D_layer(Res99127, Glo43111), 
LRes25343 = reshape_layer(Glo43111, [2, 1], Res25343), 
LSep50047 = separable_conv1D_layer(Res25343, 2,[[[[0.9215]], [[0.2681]]],[[[0.6651, 0.9342]]]],[0, 0], 1, false, Sep50047), 
LRes32591 = reshape_layer(Sep50047, [1, 2, 1], Res32591), 
LGlo32958 = global_max_pool3D_layer([[[[[1.8223]], [[1.5865]]], [[[1.6823]], [[1.2685]]]]], Glo32958), 
LRes3519 = reshape_layer(Glo32958, [1, 1], Res3519), 
LRes72466 = reshape_layer(Res3519, [1, 1, 1], Res72466), 
LRes41504 = reshape_layer(Res72466, [1, 1, 1, 1], Res41504), 
LUp_18054 = up_sampling3D_layer(Res41504, 1, 2, 1, Up_18054), 
LRes23507 = reshape_layer(Up_18054, [1, 2, 1], Res23507), 
LMax13002 = maximum_layer([Res32591,Res23507], Max13002), 
exec_layers([LReL19365,LMas91516,LRes99127,LGlo43111,LRes25343,LSep50047,LRes32591,LGlo32958,LRes3519,LRes72466,LRes41504,LUp_18054,LRes23507,LMax13002],["ReL19365","Mas91516","Res99127","Glo43111","Res25343","Sep50047","Res32591","Glo32958","Res3519","Res72466","Res41504","Up_18054","Res23507","Max13002"],Max13002,"Max13002")

Actual (Unparsed): [[[[1.8223000], [1.8223000]]]]

Expected (Unparsed): [[[[1.8223],[1.8223]]]]

Actual:   [[[[1.8223], [1.8223]]]]

Expected: [[[[1.8223], [1.8223]]]]