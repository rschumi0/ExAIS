import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro43292 = tf.keras.layers.Input(shape=([4, 1, 2]))
in0Add7552 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add7552 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Sub53100 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub53100 = tf.keras.layers.Input(shape=([3, 3]))

Cro43292 = keras.layers.Cropping2D(cropping=((1, 1), (0, 0)), name = 'Cro43292', )(in0Cro43292)
Glo21651 = keras.layers.GlobalAveragePooling2D(name = 'Glo21651', )(Cro43292)
Res42023 = keras.layers.Reshape((2, 1), name = 'Res42023', )(Glo21651)
Add7552 = keras.layers.Add(name = 'Add7552', )([in0Add7552,in1Add7552])
Res49370 = keras.layers.Reshape((1, 1), name = 'Res49370', )(Add7552)
Dot73279 = keras.layers.Dot(axes=(2, 2), name = 'Dot73279', )([Res42023,Res49370])
Res13733 = keras.layers.Reshape((2, 1, 1), name = 'Res13733', )(Dot73279)
Zer27143 = keras.layers.ZeroPadding2D(padding=((3, 0), (4, 0)), name = 'Zer27143', )(Res13733)
Sub53100 = keras.layers.Subtract(name = 'Sub53100', )([in0Sub53100,in1Sub53100])
Res84183 = keras.layers.Reshape((3, 3, 1), name = 'Res84183', )(Sub53100)
Zer91074 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer91074', )(Res84183)
Sub22426 = keras.layers.Subtract(name = 'Sub22426', )([Zer27143,Zer91074])
model = tf.keras.models.Model(inputs=[in0Cro43292,in0Add7552,in1Add7552,in0Sub53100,in1Sub53100], outputs=Sub22426)
in0Cro43292 = tf.constant([[[[1.1167, 1.0854]], [[1.1129, 1.8273]], [[1.823, 1.8097]], [[1.1651, 1.2074]]]])
in0Add7552 = tf.constant([[[[0.2111]]]])
in1Add7552 = tf.constant([[[[0.294]]]])
in0Sub53100 = tf.constant([[[0.3011, 0.8099, 0.6474], [0.6577, 0.3362, 0.211], [0.6476, 0.5626, 0.3714]]])
in1Sub53100 = tf.constant([[[0.3787, 0.0242, 0.7582], [0.5562, 0.5612, 0.7719], [0.191, 0.547, 0.268]]])
print (np.array2string(model.predict([in0Cro43292,in0Add7552,in1Add7552,in0Sub53100,in1Sub53100],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub22426.png')

LCro43292 = cropping2D_layer([[[[1.1167, 1.0854]], [[1.1129, 1.8273]], [[1.823, 1.8097]], [[1.1651, 1.2074]]]], 1, 1, 0, 0, Cro43292), 
LGlo21651 = global_average_pooling2D_layer(Cro43292, Glo21651), 
LRes42023 = reshape_layer(Glo21651, [2, 1], Res42023), 
LAdd7552 = add_layer([[[[[0.2111]]]], [[[[0.294]]]]], Add7552), 
LRes49370 = reshape_layer(Add7552, [1, 1], Res49370), 
LDot73279 = dot_layer(Res42023,Res49370, 2, 2, Dot73279), 
LRes13733 = reshape_layer(Dot73279, [2, 1, 1], Res13733), 
LZer27143 = zero_padding2D_layer(Res13733, 3, 0, 4, 0, Zer27143), 
LSub53100 = subtract_layer([[[0.3011, 0.8099, 0.6474], [0.6577, 0.3362, 0.211], [0.6476, 0.5626, 0.3714]]], [[[0.3787, 0.0242, 0.7582], [0.5562, 0.5612, 0.7719], [0.191, 0.547, 0.268]]], Sub53100), 
LRes84183 = reshape_layer(Sub53100, [3, 3, 1], Res84183), 
LZer91074 = zero_padding2D_layer(Res84183, 1, 1, 1, 1, Zer91074), 
LSub22426 = subtract_layer(Zer27143,Zer91074, Sub22426), 
exec_layers([LCro43292,LGlo21651,LRes42023,LAdd7552,LRes49370,LDot73279,LRes13733,LZer27143,LSub53100,LRes84183,LZer91074,LSub22426],["Cro43292","Glo21651","Res42023","Add7552","Res49370","Dot73279","Res13733","Zer27143","Sub53100","Res84183","Zer91074","Sub22426"],Sub22426,"Sub22426")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0776000], [-0.7857000], [0.1108000], [0.0000000]], [[0.0000000], [-0.1015000], [0.2250000], [0.5609000], [0.0000000]], [[0.0000000], [-0.4566000], [-0.0156000], [-0.1034000], [0.7414615]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.9185243]]]]

Expected (Unparsed): [[[[0],[0],[0],[0],[0]],[[0],[0.0776],[-0.7857],[0.11080000000000001],[0]],[[0],[-0.10149999999999992],[0.22500000000000003],[0.5609000000000001],[0]],[[0],[-0.45659999999999995],[-0.015599999999999947],[-0.10339999999999999],[0.741461545]],[[0],[0],[0],[0],[0.91852435]]]]

Actual:   [[[[0], [0], [0], [0], [0]], [[0], [0.0776], [-0.7857], [0.1108], [0]], [[0], [-0.1015], [0.225], [0.5609], [0]], [[0], [-0.4566], [-0.0156], [-0.1034], [0.7415]], [[0], [0], [0], [0], [0.9186]]]]

Expected: [[[[0], [0], [0], [0], [0]], [[0], [0.0776], [-0.7857], [0.1109], [0]], [[0], [-0.1014], [0.2251], [0.561], [0]], [[0], [-0.4565], [-0.0155], [-0.1033], [0.7415]], [[0], [0], [0], [0], [0.9186]]]]