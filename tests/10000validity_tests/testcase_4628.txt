import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min30122 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min30122 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Con63558 = tf.keras.layers.Input(shape=([3, 2, 1]))
in0Sub19696 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub19696 = tf.keras.layers.Input(shape=([3, 2, 2]))

Min30122 = keras.layers.Minimum(name = 'Min30122', )([in0Min30122,in1Min30122])
Res3428 = keras.layers.Reshape((1, 2, 2), name = 'Res3428', )(Min30122)
Zer99386 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer99386', )(Res3428)
Con63558 = keras.layers.Concatenate(axis=3, name = 'Con63558', )([Zer99386,in0Con63558])
Sub19696 = keras.layers.Subtract(name = 'Sub19696', )([in0Sub19696,in1Sub19696])
Con39749 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con39749', )(Sub19696)
ELU24387 = keras.layers.ELU(alpha=1.463080415312099, name = 'ELU24387', )(Con39749)
Sep88903 = keras.layers.SeparableConv2D(3, (1, 2),strides=(1, 1), padding='same', name = 'Sep88903', )(ELU24387)
Min38176 = keras.layers.Minimum(name = 'Min38176', )([Con63558,Sep88903])
model = tf.keras.models.Model(inputs=[in0Min30122,in1Min30122,in0Con63558,in0Sub19696,in1Sub19696], outputs=Min38176)
w = model.get_layer('Con39749').get_weights() 
w[0] = np.array([[[[0.7923, 0.2417], [0.004, 0.8872]]]])
w[1] = np.array([0, 0])
model.get_layer('Con39749').set_weights(w) 
w = model.get_layer('Sep88903').get_weights() 
w[0] = np.array([[[[0.7408], [0.4457]], [[0.0641], [0.5781]]]])
w[1] = np.array([[[[0.8487, 0.8105, 0.3823], [0.7746, 0.8236, 0.566]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep88903').set_weights(w) 
in0Min30122 = tf.constant([[[[[0.9212, 0.0825]], [[0.2757, 0.5739]]]]])
in1Min30122 = tf.constant([[[[[0.0503, 0.3233]], [[0.1679, 0.4749]]]]])
in0Con63558 = tf.constant([[[[0.0633], [0.6747]], [[0.0098], [0.6069]], [[0.7436], [0.9365]]]])
in0Sub19696 = tf.constant([[[[0.6733, 0.942], [0.359, 0.816]], [[0.5742, 0.3828], [0.3563, 0.884]], [[0.3747, 0.6647], [0.0523, 0.1895]]]])
in1Sub19696 = tf.constant([[[[0.023, 0.1897], [0.2012, 0.1983]], [[0.851, 0.0681], [0.3469, 0.0635]], [[0.7524, 0.4294], [0.8969, 0.3018]]]])
print (np.array2string(model.predict([in0Min30122,in1Min30122,in0Con63558,in0Sub19696,in1Sub19696],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min38176.png')

LMin30122 = minimum_layer([[[[[[0.9212, 0.0825]], [[0.2757, 0.5739]]]]], [[[[[0.0503, 0.3233]], [[0.1679, 0.4749]]]]]], Min30122), 
LRes3428 = reshape_layer(Min30122, [1, 2, 2], Res3428), 
LZer99386 = zero_padding2D_layer(Res3428, 2, 0, 0, 0, Zer99386), 
LCon63558 = concatenate_layer([Zer99386,[[[[0.0633], [0.6747]], [[0.0098], [0.6069]], [[0.7436], [0.9365]]]]], 3, Con63558), 
LSub19696 = subtract_layer([[[[0.6733, 0.942], [0.359, 0.816]], [[0.5742, 0.3828], [0.3563, 0.884]], [[0.3747, 0.6647], [0.0523, 0.1895]]]], [[[[0.023, 0.1897], [0.2012, 0.1983]], [[0.851, 0.0681], [0.3469, 0.0635]], [[0.7524, 0.4294], [0.8969, 0.3018]]]], Sub19696), 
LCon39749 = conv2D_layer(Sub19696, 1, 1,[[[[0.7923, 0.2417], [0.004, 0.8872]]]],[0, 0], 1, 1, true, 1, 1, Con39749), 
LELU24387 = elu_layer(Con39749, 1.463080415312099, ELU24387), 
LSep88903 = separable_conv2D_layer(ELU24387, 1, 2,[[[[[0.7408], [0.4457]], [[0.0641], [0.5781]]]],[[[[0.8487, 0.8105, 0.3823], [0.7746, 0.8236, 0.566]]]]],[0, 0, 0], 1, 1, true, Sep88903), 
LMin38176 = minimum_layer([Con63558,Sep88903], Min38176), 
exec_layers([LMin30122,LRes3428,LZer99386,LCon63558,LSub19696,LCon39749,LELU24387,LSep88903,LMin38176],["Min30122","Res3428","Zer99386","Con63558","Sub19696","Con39749","ELU24387","Sep88903","Min38176"],Min38176,"Min38176")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0633000], [0.0000000, 0.0000000, 0.1839771]], [[0.0000000, 0.0000000, 0.0098000], [0.0000000, 0.0000000, 0.1872484]], [[-0.4071883, -0.4030525, -0.2201538], [-0.5813102, -0.5694721, -0.2989369]]]]

Expected (Unparsed): [[[[0,0,0.0633],[0,0,0.18397708231154158]],[[0,0,0.0098],[0,0,0.18724843111641679]],[[-0.40718835381221735,-0.40305251727346336,-0.22015383605044753],[-0.5813102354712167,-0.5694720753090446,-0.29893686345773507]]]]

Actual:   [[[[0, 0, 0.0633], [0, 0, 0.184]], [[0, 0, 0.0098], [0, 0, 0.1873]], [[-0.4071, -0.403, -0.2201], [-0.5813, -0.5694, -0.2989]]]]

Expected: [[[[0, 0, 0.0633], [0, 0, 0.184]], [[0, 0, 0.0098], [0, 0, 0.1873]], [[-0.4071, -0.403, -0.2201], [-0.5813, -0.5694, -0.2989]]]]