import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo70628 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Glo70628 = keras.layers.GlobalMaxPool3D(name = 'Glo70628', )(in0Glo70628)
Res23928 = keras.layers.Reshape((1, 1), name = 'Res23928', )(Glo70628)
Sim9484 = keras.layers.SimpleRNN(2,name = 'Sim9484', )(Res23928)
Res40996 = keras.layers.Reshape((2, 1), name = 'Res40996', )(Sim9484)
Res60885 = keras.layers.Reshape((2, 1, 1), name = 'Res60885', )(Res40996)
Zer45922 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer45922', )(Res60885)
model = tf.keras.models.Model(inputs=[in0Glo70628], outputs=Zer45922)
w = model.get_layer('Sim9484').get_weights() 
w[0] = np.array([[8, 6]])
w[1] = np.array([[7, 8], [10, 7]])
w[2] = np.array([10, 5])
model.get_layer('Sim9484').set_weights(w) 
in0Glo70628 = tf.constant([[[[[1.2721]]], [[[1.711]]]]])
print (np.array2string(model.predict([in0Glo70628],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer45922.png')

LGlo70628 = global_max_pool3D_layer([[[[[1.2721]]], [[[1.711]]]]], Glo70628), 
LRes23928 = reshape_layer(Glo70628, [1, 1], Res23928), 
LSim9484 = simple_rnn_layer(Res23928,[[8, 6]],[[7, 8], [10, 7]],[10, 5], Sim9484), 
LRes40996 = reshape_layer(Sim9484, [2, 1], Res40996), 
LRes60885 = reshape_layer(Res40996, [2, 1, 1], Res60885), 
LZer45922 = zero_padding2D_layer(Res60885, 1, 1, 1, 1, Zer45922), 
exec_layers([LGlo70628,LRes23928,LSim9484,LRes40996,LRes60885,LZer45922],["Glo70628","Res23928","Sim9484","Res40996","Res60885","Zer45922"],Zer45922,"Zer45922")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.0000000], [0.0000000]], [[0.0000000], [1.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[1.0],[0]],[[0],[0.9999999999998901],[0]],[[0],[0],[0]]]]

Actual:   [[[[0], [0], [0]], [[0], [1], [0]], [[0], [1], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [1], [0]], [[0], [1], [0]], [[0], [0], [0]]]]