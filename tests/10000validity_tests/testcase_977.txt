import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min4543 = tf.keras.layers.Input(shape=([1, 2]))
in1Min4543 = tf.keras.layers.Input(shape=([1, 2]))
in0PRe3106 = tf.keras.layers.Input(shape=([2, 1]))

Min4543 = keras.layers.Minimum(name = 'Min4543', )([in0Min4543,in1Min4543])
Res73660 = keras.layers.Reshape((1, 2, 1), name = 'Res73660', )(Min4543)
PRe3106 = keras.layers.PReLU(name = 'PRe3106', input_shape=(2, 1))(in0PRe3106)
Res29726 = keras.layers.Reshape((2, 1, 1), name = 'Res29726', )(PRe3106)
Ave11117 = keras.layers.AveragePooling2D(pool_size=(2, 1), strides=(2, 1), padding='same', name = 'Ave11117', )(Res29726)
Zer86900 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer86900', )(Ave11117)
Sub50791 = keras.layers.Subtract(name = 'Sub50791', )([Res73660,Zer86900])
Den60885 = keras.layers.Dense(2,name = 'Den60885', )(Sub50791)
model = tf.keras.models.Model(inputs=[in0Min4543,in1Min4543,in0PRe3106], outputs=Den60885)
w = model.get_layer('PRe3106').get_weights() 
w[0] = np.array([[0.925], [0.7075]])
model.get_layer('PRe3106').set_weights(w) 
w = model.get_layer('Den60885').get_weights() 
w[0] = np.array([[0.815, 0.0603]])
w[1] = np.array([0.2385, 0.7114])
model.get_layer('Den60885').set_weights(w) 
in0Min4543 = tf.constant([[[0.5119, 0.6684]]])
in1Min4543 = tf.constant([[[0.8433, 0.2565]]])
in0PRe3106 = tf.constant([[[0.7265], [0.192]]])
print (np.array2string(model.predict([in0Min4543,in1Min4543,in0PRe3106],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den60885.png')

LMin4543 = minimum_layer([[[[0.5119, 0.6684]]], [[[0.8433, 0.2565]]]], Min4543), 
LRes73660 = reshape_layer(Min4543, [1, 2, 1], Res73660), 
LPRe3106 = prelu_layer([[[0.7265], [0.192]]], [[0.925], [0.7075]], PRe3106), 
LRes29726 = reshape_layer(PRe3106, [2, 1, 1], Res29726), 
LAve11117 = average_pooling2D_layer(Res29726, 2, 1, 2, 1, true, Ave11117), 
LZer86900 = zero_padding2D_layer(Ave11117, 0, 0, 1, 0, Zer86900), 
LSub50791 = subtract_layer(Res73660,Zer86900, Sub50791), 
LDen60885 = dense_layer(Sub50791, [[0.815, 0.0603]],[0.2385, 0.7114], Den60885), 
exec_layers([LMin4543,LRes73660,LPRe3106,LRes29726,LAve11117,LZer86900,LSub50791,LDen60885],["Min4543","Res73660","PRe3106","Res29726","Ave11117","Zer86900","Sub50791","Den60885"],Den60885,"Den60885")

Actual (Unparsed): [[[[0.6556985, 0.7422676], [0.0732588, 0.6991742]]]]

Expected (Unparsed): [[[[0.6556985,0.74226757],[0.07325874999999996,0.699174175]]]]

Actual:   [[[[0.6557, 0.7423], [0.0733, 0.6992]]]]

Expected: [[[[0.6557, 0.7423], [0.0733, 0.6992]]]]