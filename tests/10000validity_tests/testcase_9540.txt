import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe77588 = tf.keras.layers.Input(shape=([1, 2]))
in0Con14318 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Min18249 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Min18249 = tf.keras.layers.Input(shape=([1, 1, 2]))

PRe77588 = keras.layers.PReLU(name = 'PRe77588', input_shape=(1, 2))(in0PRe77588)
Res46019 = keras.layers.Reshape((1, 2, 1), name = 'Res46019', )(PRe77588)
Res13682 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res13682', )(Res46019)
Glo38662 = keras.layers.GlobalMaxPool3D(name = 'Glo38662', )(Res13682)
Res88129 = keras.layers.Reshape((1, 1), name = 'Res88129', )(Glo38662)
Res12124 = keras.layers.Reshape((1, 1, 1), name = 'Res12124', )(Res88129)
Con14318 = keras.layers.Concatenate(axis=3, name = 'Con14318', )([Res12124,in0Con14318])
Min18249 = keras.layers.Minimum(name = 'Min18249', )([in0Min18249,in1Min18249])
Add59877 = keras.layers.Add(name = 'Add59877', )([Con14318,Min18249])
Sof49165 = keras.layers.Softmax(axis=1, name = 'Sof49165', )(Add59877)
model = tf.keras.models.Model(inputs=[in0PRe77588,in0Con14318,in0Min18249,in1Min18249], outputs=Sof49165)
w = model.get_layer('PRe77588').get_weights() 
w[0] = np.array([[0.3493, 0.7984]])
model.get_layer('PRe77588').set_weights(w) 
in0PRe77588 = tf.constant([[[0.634, 0.0877]]])
in0Con14318 = tf.constant([[[[0.7119]]]])
in0Min18249 = tf.constant([[[[0.8989, 0.0676]]]])
in1Min18249 = tf.constant([[[[0.652, 0.1326]]]])
print (np.array2string(model.predict([in0PRe77588,in0Con14318,in0Min18249,in1Min18249],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof49165.png')

LPRe77588 = prelu_layer([[[0.634, 0.0877]]], [[0.3493, 0.7984]], PRe77588), 
LRes46019 = reshape_layer(PRe77588, [1, 2, 1], Res46019), 
LRes13682 = reshape_layer(Res46019, [1, 2, 1, 1], Res13682), 
LGlo38662 = global_max_pool3D_layer(Res13682, Glo38662), 
LRes88129 = reshape_layer(Glo38662, [1, 1], Res88129), 
LRes12124 = reshape_layer(Res88129, [1, 1, 1], Res12124), 
LCon14318 = concatenate_layer([Res12124,[[[[0.7119]]]]], 3, Con14318), 
LMin18249 = minimum_layer([[[[[0.8989, 0.0676]]]], [[[[0.652, 0.1326]]]]], Min18249), 
LAdd59877 = add_layer([Con14318,Min18249], Add59877), 
LSof49165 = softmax_layer(Add59877, 1, Sof49165), 
exec_layers([LPRe77588,LRes46019,LRes13682,LGlo38662,LRes88129,LRes12124,LCon14318,LMin18249,LAdd59877,LSof49165],["PRe77588","Res46019","Res13682","Glo38662","Res88129","Res12124","Con14318","Min18249","Add59877","Sof49165"],Sof49165,"Sof49165")

Actual (Unparsed): [[[[1.0000000, 1.0000000]]]]

Expected (Unparsed): [[[[1.0,1.0]]]]

Actual:   [[[[1, 1]]]]

Expected: [[[[1, 1]]]]