import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave69436 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Ave69436 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Ave69436 = keras.layers.Average(name = 'Ave69436', )([in0Ave69436,in1Ave69436])
Up_90812 = keras.layers.UpSampling3D(size=(2, 2, 2), name = 'Up_90812', )(Ave69436)
Res4900 = keras.layers.Reshape((4, 4, 4), name = 'Res4900', )(Up_90812)
Ave93513 = keras.layers.AveragePooling2D(pool_size=(3, 3), name = 'Ave93513', )(Res4900)
model = tf.keras.models.Model(inputs=[in0Ave69436,in1Ave69436], outputs=Ave93513)
in0Ave69436 = tf.constant([[[[[0.0393], [0.9515]], [[0.09], [0.2842]]], [[[0.884], [0.8794]], [[0.818], [0.9167]]]]])
in1Ave69436 = tf.constant([[[[[0.0438], [0.8071]], [[0.4052], [0.2591]]], [[[0.1275], [0.8734]], [[0.9629], [0.7965]]]]])
print (np.array2string(model.predict([in0Ave69436,in1Ave69436],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave93513.png')

LAve69436 = average_layer([[[[[[0.0393], [0.9515]], [[0.09], [0.2842]]], [[[0.884], [0.8794]], [[0.818], [0.9167]]]]], [[[[[0.0438], [0.8071]], [[0.4052], [0.2591]]], [[[0.1275], [0.8734]], [[0.9629], [0.7965]]]]]], Ave69436), 
LUp_90812 = up_sampling3D_layer(Ave69436, 2, 2, 2, Up_90812), 
LRes4900 = reshape_layer(Up_90812, [4, 4, 4], Res4900), 
LAve93513 = average_pooling2D_layer(Res4900, 3, 3, Ave93513), 
exec_layers([LAve69436,LUp_90812,LRes4900,LAve93513],["Ave69436","Up_90812","Res4900","Ave93513"],Ave93513,"Ave93513")

Actual (Unparsed): [[[[0.2848167, 0.2848167, 0.7411000, 0.7411000]]]]

Expected (Unparsed): [[[[0.2848166666666667,0.2848166666666667,0.7411,0.7411]]]]

Actual:   [[[[0.2849, 0.2849, 0.7411, 0.7411]]]]

Expected: [[[[0.2849, 0.2849, 0.7411, 0.7411]]]]