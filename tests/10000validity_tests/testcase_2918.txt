import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add13765 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Add13765 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Mul11624 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul11624 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con62830 = tf.keras.layers.Input(shape=([2, 2, 3]))
in0Glo28346 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Con32775 = tf.keras.layers.Input(shape=([14]))

Add13765 = keras.layers.Add(name = 'Add13765', )([in0Add13765,in1Add13765])
Up_70367 = keras.layers.UpSampling3D(size=(2, 2, 2), name = 'Up_70367', )(Add13765)
Res16633 = keras.layers.Reshape((2, 2, 4), name = 'Res16633', )(Up_70367)
Mul11624 = keras.layers.Multiply(name = 'Mul11624', )([in0Mul11624,in1Mul11624])
Con62830 = keras.layers.Concatenate(axis=3, name = 'Con62830', )([Mul11624,in0Con62830])
Ave96675 = keras.layers.Average(name = 'Ave96675', )([Res16633,Con62830])
Res57358 = keras.layers.Reshape((2, 8), name = 'Res57358', )(Ave96675)
Fla39269 = keras.layers.Flatten(name = 'Fla39269', )(Res57358)
Glo28346 = keras.layers.GlobalMaxPool3D(name = 'Glo28346', )(in0Glo28346)
Con32775 = keras.layers.Concatenate(axis=1, name = 'Con32775', )([Glo28346,in0Con32775])
Ave21901 = keras.layers.Average(name = 'Ave21901', )([Fla39269,Con32775])
model = tf.keras.models.Model(inputs=[in0Add13765,in1Add13765,in0Mul11624,in1Mul11624,in0Con62830,in0Glo28346,in0Con32775], outputs=Ave21901)
in0Add13765 = tf.constant([[[[[0.394, 0.2706]]]]])
in1Add13765 = tf.constant([[[[[0.1905, 0.1021]]]]])
in0Mul11624 = tf.constant([[[[0.9728], [0.5426]], [[0.2681], [0.6545]]]])
in1Mul11624 = tf.constant([[[[0.0377], [0.9864]], [[0.0732], [0.6644]]]])
in0Con62830 = tf.constant([[[[0.9641, 0.7888, 0.7439], [0.7009, 0.0161, 0.5564]], [[0.9069, 0.8966, 0.0225], [0.04, 0.2991, 0.9477]]]])
in0Glo28346 = tf.constant([[[[[1.5807, 1.5154]], [[1.0641, 1.3396]]], [[[1.1378, 1.2766]], [[1.8181, 1.8873]]]]])
in0Con32775 = tf.constant([[0.0429, 0.6553, 0.9733, 0.2432, 0.9205, 0.2619, 0.5631, 0.5635, 0.9452, 0.9433, 0.6351, 0.532, 0.3937, 0.2988]])
print (np.array2string(model.predict([in0Add13765,in1Add13765,in0Mul11624,in1Mul11624,in0Con62830,in0Glo28346,in0Con32775],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave21901.png')

LAdd13765 = add_layer([[[[[[0.394, 0.2706]]]]], [[[[[0.1905, 0.1021]]]]]], Add13765), 
LUp_70367 = up_sampling3D_layer(Add13765, 2, 2, 2, Up_70367), 
LRes16633 = reshape_layer(Up_70367, [2, 2, 4], Res16633), 
LMul11624 = multiply_layer([[[[[0.9728], [0.5426]], [[0.2681], [0.6545]]]], [[[[0.0377], [0.9864]], [[0.0732], [0.6644]]]]], Mul11624), 
LCon62830 = concatenate_layer([Mul11624,[[[[0.9641, 0.7888, 0.7439], [0.7009, 0.0161, 0.5564]], [[0.9069, 0.8966, 0.0225], [0.04, 0.2991, 0.9477]]]]], 3, Con62830), 
LAve96675 = average_layer([Res16633,Con62830], Ave96675), 
LRes57358 = reshape_layer(Ave96675, [2, 8], Res57358), 
LFla39269 = flatten_layer(Res57358, Fla39269), 
LGlo28346 = global_max_pool3D_layer([[[[[1.5807, 1.5154]], [[1.0641, 1.3396]]], [[[1.1378, 1.2766]], [[1.8181, 1.8873]]]]], Glo28346), 
LCon32775 = concatenate_layer([Glo28346,[[0.0429, 0.6553, 0.9733, 0.2432, 0.9205, 0.2619, 0.5631, 0.5635, 0.9452, 0.9433, 0.6351, 0.532, 0.3937, 0.2988]]], 1, Con32775), 
LAve21901 = average_layer([Fla39269,Con32775], Ave21901), 
exec_layers([LAdd13765,LUp_70367,LRes16633,LMul11624,LCon62830,LAve96675,LRes57358,LFla39269,LGlo28346,LCon32775,LAve21901],["Add13765","Up_70367","Res16633","Mul11624","Con62830","Ave96675","Res57358","Fla39269","Glo28346","Con32775","Ave21901"],Ave21901,"Ave21901")

Actual (Unparsed): [[1.0643436, 1.2778500, 0.3647750, 0.6068000, 0.7665801, 0.3900000, 0.6104000, 0.3632250, 0.4325812, 0.6016500, 0.8428750, 0.5704500, 0.5723875, 0.3691750, 0.4177500, 0.4795000]]

Expected (Unparsed): [[1.0643436400000001,1.27785,0.364775,0.6068,0.7665801600000001,0.38999999999999996,0.6104,0.363225,0.43258123000000004,0.60165,0.842875,0.57045,0.57238745,0.36917500000000003,0.41774999999999995,0.47950000000000004]]

Actual:   [[1.0644, 1.2779, 0.3648, 0.6068, 0.7666, 0.39, 0.6104, 0.3633, 0.4326, 0.6017, 0.8429, 0.5705, 0.5724, 0.3692, 0.4178, 0.4795]]

Expected: [[1.0644, 1.2779, 0.3648, 0.6068, 0.7666, 0.39, 0.6104, 0.3633, 0.4326, 0.6017, 0.8429, 0.5705, 0.5724, 0.3692, 0.4178, 0.4796]]