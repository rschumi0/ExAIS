import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min2536 = tf.keras.layers.Input(shape=([1, 1]))
in1Min2536 = tf.keras.layers.Input(shape=([1, 1]))
in0Con91860 = tf.keras.layers.Input(shape=([3, 2, 2]))
in0Sub42182 = tf.keras.layers.Input(shape=([3, 2, 3]))
in1Sub42182 = tf.keras.layers.Input(shape=([3, 2, 3]))
in0Add35549 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add35549 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con86511 = tf.keras.layers.Input(shape=([3, 2, 2]))
in0Max68532 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max68532 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con1944 = tf.keras.layers.Input(shape=([3, 2, 2]))

Min2536 = keras.layers.Minimum(name = 'Min2536', )([in0Min2536,in1Min2536])
Res31705 = keras.layers.Reshape((1, 1, 1), name = 'Res31705', )(Min2536)
Zer14369 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer14369', )(Res31705)
Con91860 = keras.layers.Concatenate(axis=3, name = 'Con91860', )([Zer14369,in0Con91860])
Sub42182 = keras.layers.Subtract(name = 'Sub42182', )([in0Sub42182,in1Sub42182])
Ave70453 = keras.layers.Average(name = 'Ave70453', )([Con91860,Sub42182])
Add35549 = keras.layers.Add(name = 'Add35549', )([in0Add35549,in1Add35549])
Zer3957 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer3957', )(Add35549)
Con86511 = keras.layers.Concatenate(axis=3, name = 'Con86511', )([Zer3957,in0Con86511])
Ave42377 = keras.layers.Average(name = 'Ave42377', )([Ave70453,Con86511])
Max68532 = keras.layers.Maximum(name = 'Max68532', )([in0Max68532,in1Max68532])
Zer24253 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer24253', )(Max68532)
Con1944 = keras.layers.Concatenate(axis=3, name = 'Con1944', )([Zer24253,in0Con1944])
Sub58454 = keras.layers.Subtract(name = 'Sub58454', )([Ave42377,Con1944])
Fla58652 = keras.layers.Flatten(name = 'Fla58652', )(Sub58454)
model = tf.keras.models.Model(inputs=[in0Min2536,in1Min2536,in0Con91860,in0Sub42182,in1Sub42182,in0Add35549,in1Add35549,in0Con86511,in0Max68532,in1Max68532,in0Con1944], outputs=Fla58652)
in0Min2536 = tf.constant([[[0.7218]]])
in1Min2536 = tf.constant([[[0.5872]]])
in0Con91860 = tf.constant([[[[0.2689, 0.4572], [0.5986, 0.0776]], [[0.642, 0.8777], [0.2629, 0.6892]], [[0.0959, 0.4729], [0.3115, 0.0123]]]])
in0Sub42182 = tf.constant([[[[0.0475, 0.1209, 0.7513], [0.0933, 0.3828, 0.7119]], [[0.1038, 0.3448, 0.6988], [0.3724, 0.5046, 0.7223]], [[0.8529, 0.5623, 0.9569], [0.956, 0.1509, 0.8551]]]])
in1Sub42182 = tf.constant([[[[0.0471, 0.4872, 0.8006], [0.7827, 0.0918, 0.8706]], [[0.2147, 0.1837, 0.4036], [0.2742, 0.0949, 0.9107]], [[0.582, 0.3633, 0.621], [0.3702, 0.1431, 0.1132]]]])
in0Add35549 = tf.constant([[[[0.7429]], [[0.5192]]]])
in1Add35549 = tf.constant([[[[0.988]], [[0.3843]]]])
in0Con86511 = tf.constant([[[[0.7626, 0.4613], [0.6546, 0.6422]], [[0.9655, 0.1018], [0.4256, 0.2755]], [[0.9763, 0.6288], [0.4093, 0.8159]]]])
in0Max68532 = tf.constant([[[[0.5254], [0.6199]], [[0.1818], [0.416]]]])
in1Max68532 = tf.constant([[[[0.7323], [0.2713]], [[0.265], [0.7479]]]])
in0Con1944 = tf.constant([[[[0.3541, 0.7554], [0.9885, 0.1646]], [[0.5331, 0.5364], [0.7131, 0.4667]], [[0.0708, 0.4104], [0.2343, 0.7133]]]])
print (np.array2string(model.predict([in0Min2536,in1Min2536,in0Con91860,in0Sub42182,in1Sub42182,in0Add35549,in1Add35549,in0Con86511,in0Max68532,in1Max68532,in0Con1944],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla58652.png')

LMin2536 = minimum_layer([[[[0.7218]]], [[[0.5872]]]], Min2536), 
LRes31705 = reshape_layer(Min2536, [1, 1, 1], Res31705), 
LZer14369 = zero_padding2D_layer(Res31705, 2, 0, 1, 0, Zer14369), 
LCon91860 = concatenate_layer([Zer14369,[[[[0.2689, 0.4572], [0.5986, 0.0776]], [[0.642, 0.8777], [0.2629, 0.6892]], [[0.0959, 0.4729], [0.3115, 0.0123]]]]], 3, Con91860), 
LSub42182 = subtract_layer([[[[0.0475, 0.1209, 0.7513], [0.0933, 0.3828, 0.7119]], [[0.1038, 0.3448, 0.6988], [0.3724, 0.5046, 0.7223]], [[0.8529, 0.5623, 0.9569], [0.956, 0.1509, 0.8551]]]], [[[[0.0471, 0.4872, 0.8006], [0.7827, 0.0918, 0.8706]], [[0.2147, 0.1837, 0.4036], [0.2742, 0.0949, 0.9107]], [[0.582, 0.3633, 0.621], [0.3702, 0.1431, 0.1132]]]], Sub42182), 
LAve70453 = average_layer([Con91860,Sub42182], Ave70453), 
LAdd35549 = add_layer([[[[[0.7429]], [[0.5192]]]], [[[[0.988]], [[0.3843]]]]], Add35549), 
LZer3957 = zero_padding2D_layer(Add35549, 1, 0, 1, 0, Zer3957), 
LCon86511 = concatenate_layer([Zer3957,[[[[0.7626, 0.4613], [0.6546, 0.6422]], [[0.9655, 0.1018], [0.4256, 0.2755]], [[0.9763, 0.6288], [0.4093, 0.8159]]]]], 3, Con86511), 
LAve42377 = average_layer([Ave70453,Con86511], Ave42377), 
LMax68532 = maximum_layer([[[[[0.5254], [0.6199]], [[0.1818], [0.416]]]], [[[[0.7323], [0.2713]], [[0.265], [0.7479]]]]], Max68532), 
LZer24253 = zero_padding2D_layer(Max68532, 1, 0, 0, 0, Zer24253), 
LCon1944 = concatenate_layer([Zer24253,[[[[0.3541, 0.7554], [0.9885, 0.1646]], [[0.5331, 0.5364], [0.7131, 0.4667]], [[0.0708, 0.4104], [0.2343, 0.7133]]]]], 3, Con1944), 
LSub58454 = subtract_layer(Ave42377,Con1944, Sub58454), 
LFla58652 = flatten_layer(Sub58454, Fla58652), 
exec_layers([LMin2536,LRes31705,LZer14369,LCon91860,LSub42182,LAve70453,LAdd35549,LZer3957,LCon86511,LAve42377,LMax68532,LZer24253,LCon1944,LSub58454,LFla58652],["Min2536","Res31705","Zer14369","Con91860","Sub42182","Ave70453","Add35549","Zer3957","Con86511","Ave42377","Max68532","Zer24253","Con1944","Sub58454","Fla58652"],Fla58652,"Fla58652")

Actual (Unparsed): [[0.0001000, 0.0028500, -0.4227750, -0.1723500, -0.4388000, 0.1362250, -0.7600250, 0.1504250, -0.1922750, 0.2701000, -0.3321500, -0.2037500, -0.1972750, 0.4910750, 0.1062000, -0.0029000, 0.0501750, -0.1168000]]

Expected (Unparsed): [[9.99999999999994e-5,0.0028499999999999637,-0.42277499999999996,-0.17235,-0.4388000000000001,0.136225,-0.760025,0.15042500000000003,-0.19227499999999997,0.2701,-0.33214999999999995,-0.20375,-0.197275,0.49107500000000004,0.10619999999999996,-0.0029000000000000137,0.050175000000000025,-0.11680000000000001]]

Actual:   [[0.0001, 0.0029, -0.4227, -0.1723, -0.4388, 0.1363, -0.76, 0.1505, -0.1922, 0.2701, -0.3321, -0.2037, -0.1972, 0.4911, 0.1062, -0.0029, 0.0502, -0.1168]]

Expected: [[0.0001, 0.0029, -0.4227, -0.1723, -0.4388, 0.1363, -0.76, 0.1505, -0.1922, 0.2701, -0.3321, -0.2037, -0.1972, 0.4911, 0.1062, -0.0029, 0.0502, -0.1168]]