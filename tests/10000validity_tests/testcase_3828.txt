import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max33581 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Max33581 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Max33581 = keras.layers.Maximum(name = 'Max33581', )([in0Max33581,in1Max33581])
Res57844 = keras.layers.Reshape((1, 2, 2), name = 'Res57844', )(Max33581)
Res47571 = keras.layers.Reshape((1, 4), name = 'Res47571', )(Res57844)
Res46320 = keras.layers.Reshape((1, 4, 1), name = 'Res46320', )(Res47571)
Glo24080 = keras.layers.GlobalMaxPool2D(name = 'Glo24080', )(Res46320)
model = tf.keras.models.Model(inputs=[in0Max33581,in1Max33581], outputs=Glo24080)
in0Max33581 = tf.constant([[[[[0.7802], [0.7728]], [[0.7293], [0.4728]]]]])
in1Max33581 = tf.constant([[[[[0.3392], [0.0553]], [[0.7482], [0.6485]]]]])
print (np.array2string(model.predict([in0Max33581,in1Max33581],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo24080.png')

LMax33581 = maximum_layer([[[[[[0.7802], [0.7728]], [[0.7293], [0.4728]]]]], [[[[[0.3392], [0.0553]], [[0.7482], [0.6485]]]]]], Max33581), 
LRes57844 = reshape_layer(Max33581, [1, 2, 2], Res57844), 
LRes47571 = reshape_layer(Res57844, [1, 4], Res47571), 
LRes46320 = reshape_layer(Res47571, [1, 4, 1], Res46320), 
LGlo24080 = global_max_pool2D_layer(Res46320, Glo24080), 
exec_layers([LMax33581,LRes57844,LRes47571,LRes46320,LGlo24080],["Max33581","Res57844","Res47571","Res46320","Glo24080"],Glo24080,"Glo24080")

Actual (Unparsed): [[0.7802000]]

Expected (Unparsed): [[0.7802]]

Actual:   [[0.7802]]

Expected: [[0.7802]]