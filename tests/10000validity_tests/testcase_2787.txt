import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot69336 = tf.keras.layers.Input(shape=([3]))
in1Dot69336 = tf.keras.layers.Input(shape=([3]))

Dot69336 = keras.layers.Dot(axes=(1, 1), name = 'Dot69336', )([in0Dot69336,in1Dot69336])
Res46330 = keras.layers.Reshape((1, 1), name = 'Res46330', )(Dot69336)
Res80664 = keras.layers.Reshape((1, 1, 1), name = 'Res80664', )(Res46330)
Dep95667 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep95667', )(Res80664)
Res17177 = keras.layers.Reshape((1, 1), name = 'Res17177', )(Dep95667)
LST60170 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST60170', )(Res17177)
model = tf.keras.models.Model(inputs=[in0Dot69336,in1Dot69336], outputs=LST60170)
w = model.get_layer('Dep95667').get_weights() 
w[0] = np.array([[[[0.4051]]]])
w[1] = np.array([0])
model.get_layer('Dep95667').set_weights(w) 
w = model.get_layer('LST60170').get_weights() 
w[0] = np.array([[4, 7, 7, 10, 2, 8, 10, 7, 8, 6, 9, 9]])
w[1] = np.array([[2, 9, 9, 9, 3, 5, 1, 6, 3, 9, 4, 3], [3, 9, 5, 9, 3, 4, 10, 8, 8, 3, 8, 1], [6, 8, 4, 2, 3, 6, 7, 5, 9, 10, 2, 1]])
w[2] = np.array([8, 8, 2, 2, 8, 1, 2, 2, 10, 8, 10, 8])
model.get_layer('LST60170').set_weights(w) 
in0Dot69336 = tf.constant([[0.0798, 0.308, 0.8113]])
in1Dot69336 = tf.constant([[0.7264, 0.2273, 0.5125]])
print (np.array2string(model.predict([in0Dot69336,in1Dot69336],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST60170.png')

LDot69336 = dot_layer([[0.0798, 0.308, 0.8113]], [[0.7264, 0.2273, 0.5125]], 1, 1, Dot69336), 
LRes46330 = reshape_layer(Dot69336, [1, 1], Res46330), 
LRes80664 = reshape_layer(Res46330, [1, 1, 1], Res80664), 
LDep95667 = depthwise_conv2D_layer(Res80664, 1, 1,[[[[0.4051]]]],[0], 1, 1, false, Dep95667), 
LRes17177 = reshape_layer(Dep95667, [1, 1], Res17177), 
LLST60170 = lstm_layer(Res17177,[[4, 7, 7, 10, 2, 8, 10, 7, 8, 6, 9, 9]],[[2, 9, 9, 9, 3, 5, 1, 6, 3, 9, 4, 3], [3, 9, 5, 9, 3, 4, 10, 8, 8, 3, 8, 1], [6, 8, 4, 2, 3, 6, 7, 5, 9, 10, 2, 1]],[8, 8, 2, 2, 8, 1, 2, 2, 10, 8, 10, 8], LST60170), 
exec_layers([LDot69336,LRes46330,LRes80664,LDep95667,LRes17177,LLST60170],["Dot69336","Res46330","Res80664","Dep95667","Res17177","LST60170"],LST60170,"LST60170")

Actual (Unparsed): [[0.7612798, 0.7608546, 0.7494851]]

Expected (Unparsed): [[0.7612798206440161,0.7608546377923059,0.749485148527215]]

Actual:   [[0.7613, 0.7609, 0.7495]]

Expected: [[0.7613, 0.7609, 0.7495]]