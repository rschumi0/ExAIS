import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo96797 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con66897 = tf.keras.layers.Input(shape=([1, 2]))
in0Cro39808 = tf.keras.layers.Input(shape=([1, 3]))
in0Bat12266 = tf.keras.layers.Input(shape=([4, 2]))
in0Con64757 = tf.keras.layers.Input(shape=([4, 1]))
in0Max1077 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Max1077 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Glo96797 = keras.layers.GlobalMaxPool2D(name = 'Glo96797', )(in0Glo96797)
Res64605 = keras.layers.Reshape((1, 1), name = 'Res64605', )(Glo96797)
Con66897 = keras.layers.Concatenate(axis=2, name = 'Con66897', )([Res64605,in0Con66897])
Cro39808 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro39808', )(in0Cro39808)
Max67496 = keras.layers.Maximum(name = 'Max67496', )([Con66897,Cro39808])
Zer6010 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer6010', )(Max67496)
Bat12266 = keras.layers.BatchNormalization(axis=2, epsilon=0.6650284841637164,  name = 'Bat12266', )(in0Bat12266)
Con64757 = keras.layers.Concatenate(axis=2, name = 'Con64757', )([Bat12266,in0Con64757])
Mul82159 = keras.layers.Multiply(name = 'Mul82159', )([Zer6010,Con64757])
Res61941 = keras.layers.Reshape((4, 3, 1), name = 'Res61941', )(Mul82159)
Res46753 = keras.layers.Reshape((4, 3, 1, 1), name = 'Res46753', )(Res61941)
Max1077 = keras.layers.Maximum(name = 'Max1077', )([in0Max1077,in1Max1077])
Zer84311 = keras.layers.ZeroPadding3D(padding=((3, 0), (2, 0), (0, 0)), name = 'Zer84311', )(Max1077)
Mul28392 = keras.layers.Multiply(name = 'Mul28392', )([Res46753,Zer84311])
model = tf.keras.models.Model(inputs=[in0Glo96797,in0Con66897,in0Cro39808,in0Bat12266,in0Con64757,in0Max1077,in1Max1077], outputs=Mul28392)
w = model.get_layer('Bat12266').get_weights() 
w[0] = np.array([0.3727, 0.908])
w[1] = np.array([0.1732, 0.1511])
w[2] = np.array([0.6482, 0.5127])
w[3] = np.array([0.4015, 0.9035])
model.get_layer('Bat12266').set_weights(w) 
in0Glo96797 = tf.constant([[[[1.0879], [1.0098]], [[1.4177], [1.6357]]]])
in0Con66897 = tf.constant([[[0.3459, 0.859]]])
in0Cro39808 = tf.constant([[[1.7699, 1.1973, 1.7243]]])
in0Bat12266 = tf.constant([[[1.6851, 1.8751], [1.1686, 1.4107], [1.9371, 1.019], [1.2315, 1.981]]])
in0Con64757 = tf.constant([[[0.2676], [0.5629], [0.3772], [0.7452]]])
in0Max1077 = tf.constant([[[[[0.0444]]]]])
in1Max1077 = tf.constant([[[[[0.5338]]]]])
print (np.array2string(model.predict([in0Glo96797,in0Con66897,in0Cro39808,in0Bat12266,in0Con64757,in0Max1077,in1Max1077],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul28392.png')

LGlo96797 = global_max_pool2D_layer([[[[1.0879], [1.0098]], [[1.4177], [1.6357]]]], Glo96797), 
LRes64605 = reshape_layer(Glo96797, [1, 1], Res64605), 
LCon66897 = concatenate_layer([Res64605,[[[0.3459, 0.859]]]], 2, Con66897), 
LCro39808 = cropping1D_layer([[[1.7699, 1.1973, 1.7243]]], 0, 0, Cro39808), 
LMax67496 = maximum_layer([Con66897,Cro39808], Max67496), 
LZer6010 = zero_padding1D_layer(Max67496, 3, 0, Zer6010), 
LBat12266 = batch_normalization_layer([[[1.6851, 1.8751], [1.1686, 1.4107], [1.9371, 1.019], [1.2315, 1.981]]], 2, 0.6650284841637164, [0.3727, 0.908], [0.1732, 0.1511], [0.6482, 0.5127], [0.4015, 0.9035], Bat12266), 
LCon64757 = concatenate_layer([Bat12266,[[[0.2676], [0.5629], [0.3772], [0.7452]]]], 2, Con64757), 
LMul82159 = multiply_layer([Zer6010,Con64757], Mul82159), 
LRes61941 = reshape_layer(Mul82159, [4, 3, 1], Res61941), 
LRes46753 = reshape_layer(Res61941, [4, 3, 1, 1], Res46753), 
LMax1077 = maximum_layer([[[[[[0.0444]]]]], [[[[[0.5338]]]]]], Max1077), 
LZer84311 = zero_padding3D_layer(Max1077, 3, 0, 2, 0, 0, 0, Zer84311), 
LMul28392 = multiply_layer([Res46753,Zer84311], Mul28392), 
exec_layers([LGlo96797,LRes64605,LCon66897,LCro39808,LMax67496,LZer6010,LBat12266,LCon64757,LMul82159,LRes61941,LRes46753,LMax1077,LZer84311,LMul28392],["Glo96797","Res64605","Con66897","Cro39808","Max67496","Zer6010","Bat12266","Con64757","Mul82159","Res61941","Res46753","Max1077","Zer84311","Mul28392"],Mul28392,"Mul28392")

Actual (Unparsed): [[[[[0.0000000]], [[0.0000000]], [[0.0000000]]], [[[0.0000000]], [[0.0000000]], [[0.0000000]]], [[[0.0000000]], [[0.0000000]], [[0.0000000]]], [[[0.0000000]], [[0.0000000]], [[0.6859054]]]]]

Expected (Unparsed): [[[[[0.0]],[[0.0]],[[0.0]]],[[[0.0]],[[0.0]],[[0.0]]],[[[0.0]],[[0.0]],[[0.0]]],[[[0.0]],[[0.0]],[[0.6859054345680001]]]]]

Actual:   [[[[[0]], [[0]], [[0]]], [[[0]], [[0]], [[0]]], [[[0]], [[0]], [[0]]], [[[0]], [[0]], [[0.686]]]]]

Expected: [[[[[0]], [[0]], [[0]]], [[[0]], [[0]], [[0]]], [[[0]], [[0]], [[0]]], [[[0]], [[0]], [[0.686]]]]]