import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max95327 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Max95327 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Max95327 = keras.layers.Maximum(name = 'Max95327', )([in0Max95327,in1Max95327])
Res57117 = keras.layers.Reshape((1, 1, 4), name = 'Res57117', )(Max95327)
Sep19023 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep19023', )(Res57117)
Zer93340 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer93340', )(Sep19023)
Max29106 = keras.layers.MaxPool2D(pool_size=(1, 2), name = 'Max29106', )(Zer93340)
Res37723 = keras.layers.Reshape((3, 1, 3, 1), name = 'Res37723', )(Max29106)
Zer32456 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer32456', )(Res37723)
model = tf.keras.models.Model(inputs=[in0Max95327,in1Max95327], outputs=Zer32456)
w = model.get_layer('Sep19023').get_weights() 
w[0] = np.array([[[[0.6246], [0.7376], [0.4626], [0.2337]]]])
w[1] = np.array([[[[0.5933, 0.6206, 0.617], [0.474, 0.5728, 0.7401], [0.7534, 0.5183, 0.5232], [0.415, 0.0092, 0.2761]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep19023').set_weights(w) 
in0Max95327 = tf.constant([[[[[0.3351, 0.6954], [0.8898, 0.2171]]]]])
in1Max95327 = tf.constant([[[[[0.4184, 0.3762], [0.03, 0.4161]]]]])
print (np.array2string(model.predict([in0Max95327,in1Max95327],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer32456.png')

LMax95327 = maximum_layer([[[[[[0.3351, 0.6954], [0.8898, 0.2171]]]]], [[[[[0.4184, 0.3762], [0.03, 0.4161]]]]]], Max95327), 
LRes57117 = reshape_layer(Max95327, [1, 1, 4], Res57117), 
LSep19023 = separable_conv2D_layer(Res57117, 1, 1,[[[[[0.6246], [0.7376], [0.4626], [0.2337]]]],[[[[0.5933, 0.6206, 0.617], [0.474, 0.5728, 0.7401], [0.7534, 0.5183, 0.5232], [0.415, 0.0092, 0.2761]]]]],[0, 0, 0], 1, 1, true, Sep19023), 
LZer93340 = zero_padding2D_layer(Sep19023, 1, 1, 1, 1, Zer93340), 
LMax29106 = max_pool2D_layer(Zer93340, 1, 2, Max29106), 
LRes37723 = reshape_layer(Max29106, [3, 1, 3, 1], Res37723), 
LZer32456 = zero_padding3D_layer(Res37723, 1, 1, 1, 1, 1, 1, Zer32456), 
exec_layers([LMax95327,LRes57117,LSep19023,LZer93340,LMax29106,LRes37723,LZer32456],["Max95327","Res57117","Sep19023","Zer93340","Max29106","Res37723","Zer32456"],Zer32456,"Zer32456")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.7486474], [0.6702257], [0.7830686], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[0.748647361854],[0.6702256896240001],[0.7830685730970001],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]]],[[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]],[[0],[0],[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0.7487], [0.6703], [0.7831], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]]]]

Expected: [[[[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0.7487], [0.6703], [0.7831], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]], [[[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]], [[0], [0], [0], [0], [0]]]]]