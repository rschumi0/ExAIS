import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add9864 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Add9864 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Add9864 = keras.layers.Add(name = 'Add9864', )([in0Add9864,in1Add9864])
Bat26922 = keras.layers.BatchNormalization(axis=1, epsilon=0.24740795731790113,  name = 'Bat26922', )(Add9864)
Res22940 = keras.layers.Reshape((1, 2, 2), name = 'Res22940', )(Bat26922)
Res72552 = keras.layers.Reshape((1, 4), name = 'Res72552', )(Res22940)
Zer89266 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer89266', )(Res72552)
model = tf.keras.models.Model(inputs=[in0Add9864,in1Add9864], outputs=Zer89266)
w = model.get_layer('Bat26922').get_weights() 
w[0] = np.array([0.5898])
w[1] = np.array([0.6124])
w[2] = np.array([0.3987])
w[3] = np.array([0.995])
model.get_layer('Bat26922').set_weights(w) 
in0Add9864 = tf.constant([[[[[0.2695], [0.6536]], [[0.1084], [0.4159]]]]])
in1Add9864 = tf.constant([[[[[0.9527], [0.1772]], [[0.3116], [0.2028]]]]])
print (np.array2string(model.predict([in0Add9864,in1Add9864],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer89266.png')

LAdd9864 = add_layer([[[[[[0.2695], [0.6536]], [[0.1084], [0.4159]]]]], [[[[[0.9527], [0.1772]], [[0.3116], [0.2028]]]]]], Add9864), 
LBat26922 = batch_normalization_layer(Add9864, 1, 0.24740795731790113, [0.5898], [0.6124], [0.3987], [0.995], Bat26922), 
LRes22940 = reshape_layer(Bat26922, [1, 2, 2], Res22940), 
LRes72552 = reshape_layer(Res22940, [1, 4], Res72552), 
LZer89266 = zero_padding1D_layer(Res72552, 1, 1, Zer89266), 
exec_layers([LAdd9864,LBat26922,LRes22940,LRes72552,LZer89266],["Add9864","Bat26922","Res22940","Res72552","Zer89266"],Zer89266,"Zer89266")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [1.0481489, 0.8410425, 0.6236707, 0.7288114], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0],[1.0481488599936266,0.8410424801496614,0.6236707355408188,0.7288113530037619],[0,0,0,0]]]

Actual:   [[[0, 0, 0, 0], [1.0482, 0.8411, 0.6237, 0.7289], [0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0], [1.0482, 0.8411, 0.6237, 0.7289], [0, 0, 0, 0]]]