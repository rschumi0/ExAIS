import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max16686 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max16686 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max16686 = keras.layers.Maximum(name = 'Max16686', )([in0Max16686,in1Max16686])
Res39804 = keras.layers.Reshape((2, 1), name = 'Res39804', )(Max16686)
Cro82976 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro82976', )(Res39804)
Loc5288 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc5288', )(Cro82976)
model = tf.keras.models.Model(inputs=[in0Max16686,in1Max16686], outputs=Loc5288)
w = model.get_layer('Loc5288').get_weights() 
w[0] = np.array([[[0.8528, 0.2101, 0.8376]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc5288').set_weights(w) 
in0Max16686 = tf.constant([[[[0.6768]], [[0.3807]]]])
in1Max16686 = tf.constant([[[[0.4399]], [[0.2033]]]])
print (np.array2string(model.predict([in0Max16686,in1Max16686],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc5288.png')

LMax16686 = maximum_layer([[[[[0.6768]], [[0.3807]]]], [[[[0.4399]], [[0.2033]]]]], Max16686), 
LRes39804 = reshape_layer(Max16686, [2, 1], Res39804), 
LCro82976 = cropping1D_layer(Res39804, 0, 1, Cro82976), 
LLoc5288 = locally_connected1D_layer(Cro82976, 1,[[[0.8528, 0.2101, 0.8376]]],[[0, 0, 0]], 1, Loc5288), 
exec_layers([LMax16686,LRes39804,LCro82976,LLoc5288],["Max16686","Res39804","Cro82976","Loc5288"],Loc5288,"Loc5288")

Actual (Unparsed): [[[0.5771751, 0.1421957, 0.5668877]]]

Expected (Unparsed): [[[0.57717504,0.14219568,0.56688768]]]

Actual:   [[[0.5772, 0.1422, 0.5669]]]

Expected: [[[0.5772, 0.1422, 0.5669]]]