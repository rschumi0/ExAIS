import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot88665 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot88665 = tf.keras.layers.Input(shape=([3, 2]))
in0PRe24892 = tf.keras.layers.Input(shape=([1, 2, 2]))

Dot88665 = keras.layers.Dot(axes=(2, 2), name = 'Dot88665', )([in0Dot88665,in1Dot88665])
Res29447 = keras.layers.Reshape((3, 3, 1), name = 'Res29447', )(Dot88665)
Glo83247 = keras.layers.GlobalAveragePooling2D(name = 'Glo83247', )(Res29447)
Res86390 = keras.layers.Reshape((1, 1), name = 'Res86390', )(Glo83247)
Zer56448 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer56448', )(Res86390)
PRe24892 = keras.layers.PReLU(name = 'PRe24892', input_shape=(1, 2, 2))(in0PRe24892)
Bat27570 = keras.layers.BatchNormalization(axis=1, epsilon=0.540414596692646,  name = 'Bat27570', )(PRe24892)
Res53197 = keras.layers.Reshape((1, 4), name = 'Res53197', )(Bat27570)
Per29377 = keras.layers.Permute((2,1), name = 'Per29377',)(Res53197)
Max74662 = keras.layers.Maximum(name = 'Max74662', )([Zer56448,Per29377])
Res48320 = keras.layers.Reshape((4, 1, 1), name = 'Res48320', )(Max74662)
Res33203 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res33203', )(Res48320)
Glo29940 = keras.layers.GlobalMaxPool3D(name = 'Glo29940', )(Res33203)
model = tf.keras.models.Model(inputs=[in0Dot88665,in1Dot88665,in0PRe24892], outputs=Glo29940)
w = model.get_layer('PRe24892').get_weights() 
w[0] = np.array([[[0.6845, 0.2375], [0.8091, 0.2492]]])
model.get_layer('PRe24892').set_weights(w) 
w = model.get_layer('Bat27570').get_weights() 
w[0] = np.array([0.0408])
w[1] = np.array([0.6572])
w[2] = np.array([0.8656])
w[3] = np.array([0.4392])
model.get_layer('Bat27570').set_weights(w) 
in0Dot88665 = tf.constant([[[0.8513, 0.4383], [0.5297, 0.7109], [0.675, 0.5598]]])
in1Dot88665 = tf.constant([[[0.7136, 0.4396], [0.0328, 0.3398], [0.6177, 0.15]]])
in0PRe24892 = tf.constant([[[[0.6967, 0.5022], [0.7035, 0.3275]]]])
print (np.array2string(model.predict([in0Dot88665,in1Dot88665,in0PRe24892],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo29940.png')

LDot88665 = dot_layer([[[0.8513, 0.4383], [0.5297, 0.7109], [0.675, 0.5598]]], [[[0.7136, 0.4396], [0.0328, 0.3398], [0.6177, 0.15]]], 2, 2, Dot88665), 
LRes29447 = reshape_layer(Dot88665, [3, 3, 1], Res29447), 
LGlo83247 = global_average_pooling2D_layer(Res29447, Glo83247), 
LRes86390 = reshape_layer(Glo83247, [1, 1], Res86390), 
LZer56448 = zero_padding1D_layer(Res86390, 3, 0, Zer56448), 
LPRe24892 = prelu_layer([[[[0.6967, 0.5022], [0.7035, 0.3275]]]], [[[0.6845, 0.2375], [0.8091, 0.2492]]], PRe24892), 
LBat27570 = batch_normalization_layer(PRe24892, 1, 0.540414596692646, [0.0408], [0.6572], [0.8656], [0.4392], Bat27570), 
LRes53197 = reshape_layer(Bat27570, [1, 4], Res53197), 
LPer29377 = permute_layer(Res53197, 2,1, Per29377), 
LMax74662 = maximum_layer([Zer56448,Per29377], Max74662), 
LRes48320 = reshape_layer(Max74662, [4, 1, 1], Res48320), 
LRes33203 = reshape_layer(Res48320, [4, 1, 1, 1], Res33203), 
LGlo29940 = global_max_pool3D_layer(Res33203, Glo29940), 
exec_layers([LDot88665,LRes29447,LGlo83247,LRes86390,LZer56448,LPRe24892,LBat27570,LRes53197,LPer29377,LMax74662,LRes48320,LRes33203,LGlo29940],["Dot88665","Res29447","Glo83247","Res86390","Zer56448","PRe24892","Bat27570","Res53197","Per29377","Max74662","Res48320","Res33203","Glo29940"],Glo29940,"Glo29940")

Actual (Unparsed): [[0.6505179]]

Expected (Unparsed): [[0.6505178602517955]]

Actual:   [[0.6506]]

Expected: [[0.6506]]