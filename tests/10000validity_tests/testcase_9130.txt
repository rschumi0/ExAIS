import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot16692 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot16692 = tf.keras.layers.Input(shape=([3, 2]))
in0Sub6164 = tf.keras.layers.Input(shape=([3, 3, 2, 2]))
in1Sub6164 = tf.keras.layers.Input(shape=([3, 3, 2, 2]))

Dot16692 = keras.layers.Dot(axes=(2, 2), name = 'Dot16692', )([in0Dot16692,in1Dot16692])
Sub6164 = keras.layers.Subtract(name = 'Sub6164', )([in0Sub6164,in1Sub6164])
Res1713 = keras.layers.Reshape((3, 3, 4), name = 'Res1713', )(Sub6164)
Res69096 = keras.layers.Reshape((3, 12), name = 'Res69096', )(Res1713)
Dot85938 = keras.layers.Dot(axes=(1, 1), name = 'Dot85938', )([Dot16692,Res69096])
Res45892 = keras.layers.Reshape((3, 12, 1), name = 'Res45892', )(Dot85938)
Glo71588 = keras.layers.GlobalAveragePooling2D(name = 'Glo71588', )(Res45892)
model = tf.keras.models.Model(inputs=[in0Dot16692,in1Dot16692,in0Sub6164,in1Sub6164], outputs=Glo71588)
in0Dot16692 = tf.constant([[[0.3323, 0.6592], [0.3809, 0.5321], [0.6086, 0.0256]]])
in1Dot16692 = tf.constant([[[0.4097, 0.2843], [0.0926, 0.5651], [0.3863, 0.7007]]])
in0Sub6164 = tf.constant([[[[[0.832, 0.0539], [0.7795, 0.3137]], [[0.0775, 0.4475], [0.4319, 0.2676]], [[0.697, 0.6447], [0.4775, 0.3633]]], [[[0.6455, 0.8529], [0.0504, 0.6658]], [[0.509, 0.1567], [0.3531, 0.6182]], [[0.471, 0.357], [0.07, 0.2686]]], [[[0.7938, 0.2708], [0.421, 0.0456]], [[0.0472, 0.4586], [0.3813, 0.4973]], [[0.8741, 0.7826], [0.7194, 0.5477]]]]])
in1Sub6164 = tf.constant([[[[[0.0365, 0.2896], [0.5406, 0.1176]], [[0.8512, 0.6575], [0.9695, 0.4075]], [[0.8957, 0.8503], [0.4497, 0.7459]]], [[[0.0409, 0.6843], [0.8967, 0.6715]], [[0.4491, 0.725], [0.5988, 0.8324]], [[0.1672, 0.3058], [0.33, 0.365]]], [[[0.3387, 0.4868], [0.6119, 0.6436]], [[0.8614, 0.4607], [0.4405, 0.6825]], [[0.5238, 0.2467], [0.0822, 0.0112]]]]])
print (np.array2string(model.predict([in0Dot16692,in1Dot16692,in0Sub6164,in1Sub6164],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo71588.png')

LDot16692 = dot_layer([[[0.3323, 0.6592], [0.3809, 0.5321], [0.6086, 0.0256]]], [[[0.4097, 0.2843], [0.0926, 0.5651], [0.3863, 0.7007]]], 2, 2, Dot16692), 
LSub6164 = subtract_layer([[[[[0.832, 0.0539], [0.7795, 0.3137]], [[0.0775, 0.4475], [0.4319, 0.2676]], [[0.697, 0.6447], [0.4775, 0.3633]]], [[[0.6455, 0.8529], [0.0504, 0.6658]], [[0.509, 0.1567], [0.3531, 0.6182]], [[0.471, 0.357], [0.07, 0.2686]]], [[[0.7938, 0.2708], [0.421, 0.0456]], [[0.0472, 0.4586], [0.3813, 0.4973]], [[0.8741, 0.7826], [0.7194, 0.5477]]]]], [[[[[0.0365, 0.2896], [0.5406, 0.1176]], [[0.8512, 0.6575], [0.9695, 0.4075]], [[0.8957, 0.8503], [0.4497, 0.7459]]], [[[0.0409, 0.6843], [0.8967, 0.6715]], [[0.4491, 0.725], [0.5988, 0.8324]], [[0.1672, 0.3058], [0.33, 0.365]]], [[[0.3387, 0.4868], [0.6119, 0.6436]], [[0.8614, 0.4607], [0.4405, 0.6825]], [[0.5238, 0.2467], [0.0822, 0.0112]]]]], Sub6164), 
LRes1713 = reshape_layer(Sub6164, [3, 3, 4], Res1713), 
LRes69096 = reshape_layer(Res1713, [3, 12], Res69096), 
LDot85938 = dot_layer(Dot16692,Res69096, 1, 1, Dot85938), 
LRes45892 = reshape_layer(Dot85938, [3, 12, 1], Res45892), 
LGlo71588 = global_average_pooling2D_layer(Res45892, Glo71588), 
exec_layers([LDot16692,LSub6164,LRes1713,LRes69096,LDot85938,LRes45892,LGlo71588],["Dot16692","Sub6164","Res1713","Res69096","Dot85938","Res45892","Glo71588"],Glo71588,"Glo71588")

Actual (Unparsed): [[-0.0787878]]

Expected (Unparsed): [[-0.07878783657325002]]

Actual:   [[-0.0787]]

Expected: [[-0.0787]]