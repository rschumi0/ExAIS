import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot35287 = tf.keras.layers.Input(shape=([2]))
in1Dot35287 = tf.keras.layers.Input(shape=([2]))
in0Min98649 = tf.keras.layers.Input(shape=([2, 1]))
in1Min98649 = tf.keras.layers.Input(shape=([2, 1]))

Dot35287 = keras.layers.Dot(axes=(1, 1), name = 'Dot35287', )([in0Dot35287,in1Dot35287])
Res49388 = keras.layers.Reshape((1, 1), name = 'Res49388', )(Dot35287)
Res59735 = keras.layers.Reshape((1, 1, 1), name = 'Res59735', )(Res49388)
Glo34851 = keras.layers.GlobalAveragePooling2D(name = 'Glo34851', )(Res59735)
Res95360 = keras.layers.Reshape((1, 1), name = 'Res95360', )(Glo34851)
Min98649 = keras.layers.Minimum(name = 'Min98649', )([in0Min98649,in1Min98649])
Res42261 = keras.layers.Reshape((2, 1, 1), name = 'Res42261', )(Min98649)
Glo74128 = keras.layers.GlobalAveragePooling2D(name = 'Glo74128', )(Res42261)
Res9094 = keras.layers.Reshape((1, 1), name = 'Res9094', )(Glo74128)
Res62761 = keras.layers.Reshape((1, 1, 1), name = 'Res62761', )(Res9094)
Dep23727 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep23727', )(Res62761)
Res3971 = keras.layers.Reshape((1, 1), name = 'Res3971', )(Dep23727)
Add16824 = keras.layers.Add(name = 'Add16824', )([Res95360,Res3971])
model = tf.keras.models.Model(inputs=[in0Dot35287,in1Dot35287,in0Min98649,in1Min98649], outputs=Add16824)
w = model.get_layer('Dep23727').get_weights() 
w[0] = np.array([[[[0.0303]]]])
w[1] = np.array([0])
model.get_layer('Dep23727').set_weights(w) 
in0Dot35287 = tf.constant([[0.2954, 0.6399]])
in1Dot35287 = tf.constant([[0.6059, 0.3101]])
in0Min98649 = tf.constant([[[0.3659], [0.5487]]])
in1Min98649 = tf.constant([[[0.5036], [0.1302]]])
print (np.array2string(model.predict([in0Dot35287,in1Dot35287,in0Min98649,in1Min98649],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add16824.png')

LDot35287 = dot_layer([[0.2954, 0.6399]], [[0.6059, 0.3101]], 1, 1, Dot35287), 
LRes49388 = reshape_layer(Dot35287, [1, 1], Res49388), 
LRes59735 = reshape_layer(Res49388, [1, 1, 1], Res59735), 
LGlo34851 = global_average_pooling2D_layer(Res59735, Glo34851), 
LRes95360 = reshape_layer(Glo34851, [1, 1], Res95360), 
LMin98649 = minimum_layer([[[[0.3659], [0.5487]]], [[[0.5036], [0.1302]]]], Min98649), 
LRes42261 = reshape_layer(Min98649, [2, 1, 1], Res42261), 
LGlo74128 = global_average_pooling2D_layer(Res42261, Glo74128), 
LRes9094 = reshape_layer(Glo74128, [1, 1], Res9094), 
LRes62761 = reshape_layer(Res9094, [1, 1, 1], Res62761), 
LDep23727 = depthwise_conv2D_layer(Res62761, 1, 1,[[[[0.0303]]]],[0], 1, 1, true, Dep23727), 
LRes3971 = reshape_layer(Dep23727, [1, 1], Res3971), 
LAdd16824 = add_layer([Res95360,Res3971], Add16824), 
exec_layers([LDot35287,LRes49388,LRes59735,LGlo34851,LRes95360,LMin98649,LRes42261,LGlo74128,LRes9094,LRes62761,LDep23727,LRes3971,LAdd16824],["Dot35287","Res49388","Res59735","Glo34851","Res95360","Min98649","Res42261","Glo74128","Res9094","Res62761","Dep23727","Res3971","Add16824"],Add16824,"Add16824")

Actual (Unparsed): [[[0.3849318]]]

Expected (Unparsed): [[[0.384931765]]]

Actual:   [[[0.385]]]

Expected: [[[0.385]]]