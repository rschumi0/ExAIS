import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr51804 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con39607 = tf.keras.layers.Input(shape=([1, 2]))
in0Thr91260 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con55952 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Mul63324 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul63324 = tf.keras.layers.Input(shape=([2, 2, 2]))

Thr51804 = keras.layers.ThresholdedReLU(theta=9.396909763675767, name = 'Thr51804', input_shape=(1, 1, 2))(in0Thr51804)
Res36167 = keras.layers.Reshape((1, 2), name = 'Res36167', )(Thr51804)
Con39607 = keras.layers.Concatenate(axis=2, name = 'Con39607', )([Res36167,in0Con39607])
Thr91260 = keras.layers.ThresholdedReLU(theta=7.175045773920997, name = 'Thr91260', input_shape=(1, 2, 1, 1))(in0Thr91260)
Res21951 = keras.layers.Reshape((1, 2, 1), name = 'Res21951', )(Thr91260)
Res94769 = keras.layers.Reshape((1, 2), name = 'Res94769', )(Res21951)
Glo66399 = keras.layers.GlobalMaxPool1D(name = 'Glo66399', )(Res94769)
Res62082 = keras.layers.Reshape((2, 1), name = 'Res62082', )(Glo66399)
Res4403 = keras.layers.Reshape((2, 1, 1), name = 'Res4403', )(Res62082)
Zer49070 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer49070', )(Res4403)
Con55952 = keras.layers.Concatenate(axis=3, name = 'Con55952', )([Zer49070,in0Con55952])
Mul63324 = keras.layers.Multiply(name = 'Mul63324', )([in0Mul63324,in1Mul63324])
Max62813 = keras.layers.Maximum(name = 'Max62813', )([Con55952,Mul63324])
Res63204 = keras.layers.Reshape((2, 4), name = 'Res63204', )(Max62813)
Dot49424 = keras.layers.Dot(axes=(2, 2), name = 'Dot49424', )([Con39607,Res63204])
LST54632 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST54632', )(Dot49424)
model = tf.keras.models.Model(inputs=[in0Thr51804,in0Con39607,in0Thr91260,in0Con55952,in0Mul63324,in1Mul63324], outputs=LST54632)
w = model.get_layer('LST54632').get_weights() 
w[0] = np.array([[2, 7, 1, 3, 3, 5, 5, 6], [5, 5, 3, 1, 4, 4, 7, 2]])
w[1] = np.array([[1, 4, 5, 9, 7, 4, 6, 6], [3, 8, 4, 8, 2, 7, 9, 1]])
w[2] = np.array([2, 6, 6, 7, 1, 7, 3, 5])
model.get_layer('LST54632').set_weights(w) 
in0Thr51804 = tf.constant([[[[0.895, 0.7001]]]])
in0Con39607 = tf.constant([[[0.1511, 0.8866]]])
in0Thr91260 = tf.constant([[[[[0.3953]], [[0.3509]]]]])
in0Con55952 = tf.constant([[[[0.8083], [0.3008]], [[0.9214], [0.1948]]]])
in0Mul63324 = tf.constant([[[[0.5759, 0.2684], [0.6306, 0.5547]], [[0.9047, 0.3777], [0.2193, 0.8705]]]])
in1Mul63324 = tf.constant([[[[0.8247, 0.9619], [0.7892, 0.5854]], [[0.377, 0.0921], [0.6331, 0.9887]]]])
print (np.array2string(model.predict([in0Thr51804,in0Con39607,in0Thr91260,in0Con55952,in0Mul63324,in1Mul63324],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST54632.png')

LThr51804 = thresholded_relu_layer([[[[0.895, 0.7001]]]], 9.396909763675767, Thr51804), 
LRes36167 = reshape_layer(Thr51804, [1, 2], Res36167), 
LCon39607 = concatenate_layer([Res36167,[[[0.1511, 0.8866]]]], 2, Con39607), 
LThr91260 = thresholded_relu_layer([[[[[0.3953]], [[0.3509]]]]], 7.175045773920997, Thr91260), 
LRes21951 = reshape_layer(Thr91260, [1, 2, 1], Res21951), 
LRes94769 = reshape_layer(Res21951, [1, 2], Res94769), 
LGlo66399 = global_max_pool1D_layer(Res94769, Glo66399), 
LRes62082 = reshape_layer(Glo66399, [2, 1], Res62082), 
LRes4403 = reshape_layer(Res62082, [2, 1, 1], Res4403), 
LZer49070 = zero_padding2D_layer(Res4403, 0, 0, 1, 0, Zer49070), 
LCon55952 = concatenate_layer([Zer49070,[[[[0.8083], [0.3008]], [[0.9214], [0.1948]]]]], 3, Con55952), 
LMul63324 = multiply_layer([[[[[0.5759, 0.2684], [0.6306, 0.5547]], [[0.9047, 0.3777], [0.2193, 0.8705]]]], [[[[0.8247, 0.9619], [0.7892, 0.5854]], [[0.377, 0.0921], [0.6331, 0.9887]]]]], Mul63324), 
LMax62813 = maximum_layer([Con55952,Mul63324], Max62813), 
LRes63204 = reshape_layer(Max62813, [2, 4], Res63204), 
LDot49424 = dot_layer(Con39607,Res63204, 2, 2, Dot49424), 
LLST54632 = lstm_layer(Dot49424,[[2, 7, 1, 3, 3, 5, 5, 6], [5, 5, 3, 1, 4, 4, 7, 2]],[[1, 4, 5, 9, 7, 4, 6, 6], [3, 8, 4, 8, 2, 7, 9, 1]],[2, 6, 6, 7, 1, 7, 3, 5], LST54632), 
exec_layers([LThr51804,LRes36167,LCon39607,LThr91260,LRes21951,LRes94769,LGlo66399,LRes62082,LRes4403,LZer49070,LCon55952,LMul63324,LMax62813,LRes63204,LDot49424,LLST54632],["Thr51804","Res36167","Con39607","Thr91260","Res21951","Res94769","Glo66399","Res62082","Res4403","Zer49070","Con55952","Mul63324","Max62813","Res63204","Dot49424","LST54632"],LST54632,"LST54632")

Actual (Unparsed): [[0.7609991, 0.7614715]]

Expected (Unparsed): [[0.7609991039275236,0.7614714625962197]]

Actual:   [[0.761, 0.7615]]

Expected: [[0.761, 0.7615]]