import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot26857 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot26857 = tf.keras.layers.Input(shape=([2, 3]))
in0Min10901 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min10901 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Lea18823 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Dot26857 = keras.layers.Dot(axes=(2, 2), name = 'Dot26857', )([in0Dot26857,in1Dot26857])
Res49775 = keras.layers.Reshape((2, 2, 1), name = 'Res49775', )(Dot26857)
Res27299 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res27299', )(Res49775)
Zer52570 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer52570', )(Res27299)
Glo33699 = keras.layers.GlobalMaxPool3D(name = 'Glo33699', )(Zer52570)
Res58406 = keras.layers.Reshape((1, 1), name = 'Res58406', )(Glo33699)
Res34612 = keras.layers.Reshape((1, 1, 1), name = 'Res34612', )(Res58406)
Res93637 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res93637', )(Res34612)
Zer58559 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (2, 0)), name = 'Zer58559', )(Res93637)
Min10901 = keras.layers.Minimum(name = 'Min10901', )([in0Min10901,in1Min10901])
Res86537 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res86537', )(Min10901)
Zer28263 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer28263', )(Res86537)
Lea18823 = keras.layers.LeakyReLU(alpha=4.651330153366319, name = 'Lea18823', input_shape=(1, 1, 2, 1))(in0Lea18823)
Zer23118 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer23118', )(Lea18823)
Max85504 = keras.layers.Maximum(name = 'Max85504', )([Zer28263,Zer23118])
Sub22605 = keras.layers.Subtract(name = 'Sub22605', )([Zer58559,Max85504])
model = tf.keras.models.Model(inputs=[in0Dot26857,in1Dot26857,in0Min10901,in1Min10901,in0Lea18823], outputs=Sub22605)
in0Dot26857 = tf.constant([[[0.0567, 0.9034, 0.4557], [0.7876, 0.1232, 0.3154]]])
in1Dot26857 = tf.constant([[[0.0207, 0.555, 0.2575], [0.8869, 0.7046, 0.2314]]])
in0Min10901 = tf.constant([[[[0.195], [0.9864]]]])
in1Min10901 = tf.constant([[[[0.083], [0.465]]]])
in0Lea18823 = tf.constant([[[[[0.3299], [0.4946]]]]])
print (np.array2string(model.predict([in0Dot26857,in1Dot26857,in0Min10901,in1Min10901,in0Lea18823],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub22605.png')

LDot26857 = dot_layer([[[0.0567, 0.9034, 0.4557], [0.7876, 0.1232, 0.3154]]], [[[0.0207, 0.555, 0.2575], [0.8869, 0.7046, 0.2314]]], 2, 2, Dot26857), 
LRes49775 = reshape_layer(Dot26857, [2, 2, 1], Res49775), 
LRes27299 = reshape_layer(Res49775, [2, 2, 1, 1], Res27299), 
LZer52570 = zero_padding3D_layer(Res27299, 1, 1, 1, 1, 1, 1, Zer52570), 
LGlo33699 = global_max_pool3D_layer(Zer52570, Glo33699), 
LRes58406 = reshape_layer(Glo33699, [1, 1], Res58406), 
LRes34612 = reshape_layer(Res58406, [1, 1, 1], Res34612), 
LRes93637 = reshape_layer(Res34612, [1, 1, 1, 1], Res93637), 
LZer58559 = zero_padding3D_layer(Res93637, 0, 0, 1, 0, 2, 0, Zer58559), 
LMin10901 = minimum_layer([[[[[0.195], [0.9864]]]], [[[[0.083], [0.465]]]]], Min10901), 
LRes86537 = reshape_layer(Min10901, [1, 2, 1, 1], Res86537), 
LZer28263 = zero_padding3D_layer(Res86537, 0, 0, 0, 0, 2, 0, Zer28263), 
LLea18823 = leaky_relu_layer([[[[[0.3299], [0.4946]]]]], 4.651330153366319, Lea18823), 
LZer23118 = zero_padding3D_layer(Lea18823, 0, 0, 1, 0, 1, 0, Zer23118), 
LMax85504 = maximum_layer([Zer28263,Zer23118], Max85504), 
LSub22605 = subtract_layer(Zer58559,Max85504, Sub22605), 
exec_layers([LDot26857,LRes49775,LRes27299,LZer52570,LGlo33699,LRes58406,LRes34612,LRes93637,LZer58559,LMin10901,LRes86537,LZer28263,LLea18823,LZer23118,LMax85504,LSub22605],["Dot26857","Res49775","Res27299","Zer52570","Glo33699","Res58406","Res34612","Res93637","Zer58559","Min10901","Res86537","Zer28263","Lea18823","Zer23118","Max85504","Sub22605"],Sub22605,"Sub22605")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [-0.0830000]], [[0.0000000], [-0.3299000], [0.3637127]]]]]

Expected (Unparsed): [[[[[0],[0],[-0.083]],[[0],[-0.3299],[0.36371272000000004]]]]]

Actual:   [[[[[0], [0], [-0.083]], [[0], [-0.3299], [0.3638]]]]]

Expected: [[[[[0], [0], [-0.083]], [[0], [-0.3299], [0.3638]]]]]