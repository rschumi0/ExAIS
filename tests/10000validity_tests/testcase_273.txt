import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer47456 = tf.keras.layers.Input(shape=([4, 2]))
in0Con91744 = tf.keras.layers.Input(shape=([2, 2]))
in0Add47341 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add47341 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0ReL49367 = tf.keras.layers.Input(shape=([2, 1]))

Zer47456 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer47456', )(in0Zer47456)
Res23659 = keras.layers.Reshape((6, 2, 1), name = 'Res23659', )(Zer47456)
Sep62658 = keras.layers.SeparableConv2D(2, (5, 2),strides=(5, 5), padding='same', name = 'Sep62658', )(Res23659)
Res48217 = keras.layers.Reshape((2, 2), name = 'Res48217', )(Sep62658)
Con91744 = keras.layers.Concatenate(axis=2, name = 'Con91744', )([Res48217,in0Con91744])
Add47341 = keras.layers.Add(name = 'Add47341', )([in0Add47341,in1Add47341])
Res3083 = keras.layers.Reshape((2, 2), name = 'Res3083', )(Add47341)
Loc21491 = keras.layers.LocallyConnected1D(4, (2),strides=(1), name = 'Loc21491', )(Res3083)
Zer80733 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer80733', )(Loc21491)
Add93085 = keras.layers.Add(name = 'Add93085', )([Con91744,Zer80733])
Res3142 = keras.layers.Reshape((2, 4, 1), name = 'Res3142', )(Add93085)
Res33605 = keras.layers.Reshape((2, 4, 1, 1), name = 'Res33605', )(Res3142)
Zer90380 = keras.layers.ZeroPadding3D(padding=((4, 0), (1, 0), (2, 0)), name = 'Zer90380', )(Res33605)
ReL49367 = keras.layers.ReLU(max_value=0.2808851980815448, negative_slope=8.442862074956556, threshold=9.577223884693316, name = 'ReL49367', input_shape=(2, 1))(in0ReL49367)
Res51924 = keras.layers.Reshape((2, 1, 1), name = 'Res51924', )(ReL49367)
Con24687 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 1), padding='valid', name = 'Con24687', )(Res51924)
Res5203 = keras.layers.Reshape((2, 3), name = 'Res5203', )(Con24687)
Zer89687 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer89687', )(Res5203)
Res71375 = keras.layers.Reshape((4, 3, 1), name = 'Res71375', )(Zer89687)
Res35302 = keras.layers.Reshape((4, 3, 1, 1), name = 'Res35302', )(Res71375)
Zer34843 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer34843', )(Res35302)
Mul23421 = keras.layers.Multiply(name = 'Mul23421', )([Zer90380,Zer34843])
model = tf.keras.models.Model(inputs=[in0Zer47456,in0Con91744,in0Add47341,in1Add47341,in0ReL49367], outputs=Mul23421)
w = model.get_layer('Sep62658').get_weights() 
w[0] = np.array([[[[0.79]], [[0.305]]], [[[0.2066]], [[0.2466]]], [[[0.5898]], [[0.5643]]], [[[0.3199]], [[0.9503]]], [[[0.7028]], [[0.3146]]]])
w[1] = np.array([[[[0.7975, 0.2675]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep62658').set_weights(w) 
w = model.get_layer('Loc21491').get_weights() 
w[0] = np.array([[[0.4896, 0.9496, 0.0774, 0.4705], [0.1268, 0.0745, 0.7208, 0.083], [0.7802, 0.0267, 0.6698, 0.836], [0.0112, 0.6492, 0.0897, 0.246]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc21491').set_weights(w) 
w = model.get_layer('Con24687').get_weights() 
w[0] = np.array([[[[0.5124], [0.076], [0.4089]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con24687').set_weights(w) 
in0Zer47456 = tf.constant([[[1.4596, 1.8578], [1.2066, 1.3439], [1.4631, 1.1934], [1.6286, 1.6162]]])
in0Con91744 = tf.constant([[[0.2704, 0.2956], [0.38, 0.3186]]])
in0Add47341 = tf.constant([[[[0.5095, 0.9915]], [[0.9221, 0.8889]]]])
in1Add47341 = tf.constant([[[[0.0767, 0.794]], [[0.1735, 0.1448]]]])
in0ReL49367 = tf.constant([[[0.9249], [0.6125]]])
print (np.array2string(model.predict([in0Zer47456,in0Con91744,in0Add47341,in1Add47341,in0ReL49367],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul23421.png')

LZer47456 = zero_padding1D_layer([[[1.4596, 1.8578], [1.2066, 1.3439], [1.4631, 1.1934], [1.6286, 1.6162]]], 1, 1, Zer47456), 
LRes23659 = reshape_layer(Zer47456, [6, 2, 1], Res23659), 
LSep62658 = separable_conv2D_layer(Res23659, 5, 2,[[[[[0.79]], [[0.305]]], [[[0.2066]], [[0.2466]]], [[[0.5898]], [[0.5643]]], [[[0.3199]], [[0.9503]]], [[[0.7028]], [[0.3146]]]],[[[[0.7975, 0.2675]]]]],[0, 0], 5, 5, true, Sep62658), 
LRes48217 = reshape_layer(Sep62658, [2, 2], Res48217), 
LCon91744 = concatenate_layer([Res48217,[[[0.2704, 0.2956], [0.38, 0.3186]]]], 2, Con91744), 
LAdd47341 = add_layer([[[[[0.5095, 0.9915]], [[0.9221, 0.8889]]]], [[[[0.0767, 0.794]], [[0.1735, 0.1448]]]]], Add47341), 
LRes3083 = reshape_layer(Add47341, [2, 2], Res3083), 
LLoc21491 = locally_connected1D_layer(Res3083, 2,[[[0.4896, 0.9496, 0.0774, 0.4705], [0.1268, 0.0745, 0.7208, 0.083], [0.7802, 0.0267, 0.6698, 0.836], [0.0112, 0.6492, 0.0897, 0.246]]],[[0, 0, 0, 0]], 1, Loc21491), 
LZer80733 = zero_padding1D_layer(Loc21491, 1, 0, Zer80733), 
LAdd93085 = add_layer([Con91744,Zer80733], Add93085), 
LRes3142 = reshape_layer(Add93085, [2, 4, 1], Res3142), 
LRes33605 = reshape_layer(Res3142, [2, 4, 1, 1], Res33605), 
LZer90380 = zero_padding3D_layer(Res33605, 4, 0, 1, 0, 2, 0, Zer90380), 
LReL49367 = relu_layer([[[0.9249], [0.6125]]], 0.2808851980815448, 8.442862074956556, 9.577223884693316, ReL49367), 
LRes51924 = reshape_layer(ReL49367, [2, 1, 1], Res51924), 
LCon24687 = conv2D_transpose_layer(Res51924, 1, 1,[[[[0.5124], [0.076], [0.4089]]]],[0, 0, 0], 1, 1, false, Con24687), 
LRes5203 = reshape_layer(Con24687, [2, 3], Res5203), 
LZer89687 = zero_padding1D_layer(Res5203, 1, 1, Zer89687), 
LRes71375 = reshape_layer(Zer89687, [4, 3, 1], Res71375), 
LRes35302 = reshape_layer(Res71375, [4, 3, 1, 1], Res35302), 
LZer34843 = zero_padding3D_layer(Res35302, 1, 1, 1, 1, 1, 1, Zer34843), 
LMul23421 = multiply_layer([Zer90380,Zer34843], Mul23421), 
exec_layers([LZer47456,LRes23659,LSep62658,LRes48217,LCon91744,LAdd47341,LRes3083,LLoc21491,LZer80733,LAdd93085,LRes3142,LRes33605,LZer90380,LReL49367,LRes51924,LCon24687,LRes5203,LZer89687,LRes71375,LRes35302,LZer34843,LMul23421],["Zer47456","Res23659","Sep62658","Res48217","Con91744","Add47341","Res3083","Loc21491","Zer80733","Add93085","Res3142","Res33605","Zer90380","ReL49367","Res51924","Con24687","Res5203","Zer89687","Res71375","Res35302","Zer34843","Mul23421"],Mul23421,"Mul23421")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0000000], [0.0000000]], [[0.0000000], [-0.0000000], [0.0000000]], [[0.0000000], [-0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0000000], [0.0000000]], [[0.0000000], [-0.0000000], [0.0000000]], [[0.0000000], [-0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[-0.0],[0]],[[0],[-0.0],[0]],[[0],[-0.0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[-0.0],[0]],[[0],[-0.0],[0]],[[0],[-0.0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0.0]],[[0],[0],[0.0]],[[0],[0],[0.0]],[[0],[0],[0.0]]],[[[0],[0],[0]],[[0],[0],[0.0]],[[0],[0],[0.0]],[[0],[0],[0.0]],[[0],[0],[0.0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0], [0]], [[0], [-0], [0]], [[0], [-0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0], [0]], [[0], [-0], [0]], [[0], [-0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0], [0]], [[0], [-0], [0]], [[0], [-0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [-0], [0]], [[0], [-0], [0]], [[0], [-0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]