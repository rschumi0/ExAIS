import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max85434 = tf.keras.layers.Input(shape=([2, 1]))
in1Max85434 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot89120 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot89120 = tf.keras.layers.Input(shape=([3, 2]))

Max85434 = keras.layers.Maximum(name = 'Max85434', )([in0Max85434,in1Max85434])
Res11241 = keras.layers.Reshape((2, 1, 1), name = 'Res11241', )(Max85434)
Sep62363 = keras.layers.SeparableConv2D(3, (2, 1),strides=(1, 1), padding='valid', name = 'Sep62363', )(Res11241)
Res54965 = keras.layers.Reshape((1, 3), name = 'Res54965', )(Sep62363)
Zer62465 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer62465', )(Res54965)
Dot89120 = keras.layers.Dot(axes=(2, 2), name = 'Dot89120', )([in0Dot89120,in1Dot89120])
Sof45324 = keras.layers.Softmax(axis=1, name = 'Sof45324', )(Dot89120)
Min41474 = keras.layers.Minimum(name = 'Min41474', )([Zer62465,Sof45324])
model = tf.keras.models.Model(inputs=[in0Max85434,in1Max85434,in0Dot89120,in1Dot89120], outputs=Min41474)
w = model.get_layer('Sep62363').get_weights() 
w[0] = np.array([[[[0.5362]]], [[[0.229]]]])
w[1] = np.array([[[[0.6802, 0.7037, 0.2533]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep62363').set_weights(w) 
in0Max85434 = tf.constant([[[0.048], [0.8532]]])
in1Max85434 = tf.constant([[[0.5261], [0.8126]]])
in0Dot89120 = tf.constant([[[0.569, 0.8357], [0.377, 0.3008], [0.2309, 0.0467]]])
in1Dot89120 = tf.constant([[[0.2784, 0.8342], [0.3232, 0.378], [0.9108, 0.8126]]])
print (np.array2string(model.predict([in0Max85434,in1Max85434,in0Dot89120,in1Dot89120],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min41474.png')

LMax85434 = maximum_layer([[[[0.048], [0.8532]]], [[[0.5261], [0.8126]]]], Max85434), 
LRes11241 = reshape_layer(Max85434, [2, 1, 1], Res11241), 
LSep62363 = separable_conv2D_layer(Res11241, 2, 1,[[[[[0.5362]]], [[[0.229]]]],[[[[0.6802, 0.7037, 0.2533]]]]],[0, 0, 0], 1, 1, false, Sep62363), 
LRes54965 = reshape_layer(Sep62363, [1, 3], Res54965), 
LZer62465 = zero_padding1D_layer(Res54965, 2, 0, Zer62465), 
LDot89120 = dot_layer([[[0.569, 0.8357], [0.377, 0.3008], [0.2309, 0.0467]]], [[[0.2784, 0.8342], [0.3232, 0.378], [0.9108, 0.8126]]], 2, 2, Dot89120), 
LSof45324 = softmax_layer(Dot89120, 1, Sof45324), 
LMin41474 = minimum_layer([Zer62465,Sof45324], Min41474), 
exec_layers([LMax85434,LRes11241,LSep62363,LRes54965,LZer62465,LDot89120,LSof45324,LMin41474],["Max85434","Res11241","Sep62363","Res54965","Zer62465","Dot89120","Sof45324","Min41474"],Min41474,"Min41474")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.2267922, 0.2734392, 0.1209451]]]

Expected (Unparsed): [[[0,0,0],[0,0,0],[0.22679217599795612,0.27343921345210315,0.12094508114600001]]]

Actual:   [[[0, 0, 0], [0, 0, 0], [0.2268, 0.2735, 0.121]]]

Expected: [[[0, 0, 0], [0, 0, 0], [0.2268, 0.2735, 0.121]]]