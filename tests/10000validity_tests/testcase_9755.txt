import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max59932 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max59932 = tf.keras.layers.Input(shape=([2, 1, 2]))

Max59932 = keras.layers.Maximum(name = 'Max59932', )([in0Max59932,in1Max59932])
Loc1333 = keras.layers.LocallyConnected2D(4, (2, 1),strides=(1, 1), name = 'Loc1333', )(Max59932)
model = tf.keras.models.Model(inputs=[in0Max59932,in1Max59932], outputs=Loc1333)
w = model.get_layer('Loc1333').get_weights() 
w[0] = np.array([[[0.2706, 0.886, 0.2351, 0.9837], [0.5311, 0.9349, 0.1078, 0.5496], [0.3121, 0.8144, 0.7347, 0.1151], [0.2223, 0.3565, 0.0396, 0.5551]]])
w[1] = np.array([[[0, 0, 0, 0]]])
model.get_layer('Loc1333').set_weights(w) 
in0Max59932 = tf.constant([[[[0.7244, 0.5331]], [[0.8181, 0.2004]]]])
in1Max59932 = tf.constant([[[[0.7578, 0.1056]], [[0.8988, 0.5376]]]])
print (np.array2string(model.predict([in0Max59932,in1Max59932],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc1333.png')

LMax59932 = maximum_layer([[[[[0.7244, 0.5331]], [[0.8181, 0.2004]]]], [[[[0.7578, 0.1056]], [[0.8988, 0.5376]]]]], Max59932), 
LLoc1333 = locally_connected2D_layer(Max59932, 2, 1,[[[0.2706, 0.886, 0.2351, 0.9837], [0.5311, 0.9349, 0.1078, 0.5496], [0.3121, 0.8144, 0.7347, 0.1151], [0.2223, 0.3565, 0.0396, 0.5551]]],[[[0, 0, 0, 0]]], 1, 1, Loc1333), 
exec_layers([LMax59932,LLoc1333],["Max59932","Loc1333"],Loc1333,"Loc1333")

Actual (Unparsed): [[[[0.8882141, 2.0934431, 0.9172643, 1.4403132]]]]

Expected (Unparsed): [[[[0.8882140500000001,2.0934431100000004,0.9172642800000002,1.44031326]]]]

Actual:   [[[[0.8883, 2.0935, 0.9173, 1.4404]]]]

Expected: [[[[0.8883, 2.0935, 0.9173, 1.4404]]]]