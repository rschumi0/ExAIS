import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con99484 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Dot17805 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot17805 = tf.keras.layers.Input(shape=([2, 3]))
in0Con23864 = tf.keras.layers.Input(shape=([5]))

Con99484 = keras.layers.Conv2D(3, (2, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con99484', )(in0Con99484)
PRe19038 = keras.layers.PReLU(name = 'PRe19038', )(Con99484)
Res37826 = keras.layers.Reshape((2, 3), name = 'Res37826', )(PRe19038)
Fla94048 = keras.layers.Flatten(name = 'Fla94048', )(Res37826)
Dot17805 = keras.layers.Dot(axes=(1, 1), name = 'Dot17805', )([in0Dot17805,in1Dot17805])
Res74777 = keras.layers.Reshape((3, 3, 1), name = 'Res74777', )(Dot17805)
Zer96951 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer96951', )(Res74777)
Res31169 = keras.layers.Reshape((5, 5), name = 'Res31169', )(Zer96951)
Up_7818 = keras.layers.UpSampling1D(size=(1), name = 'Up_7818', )(Res31169)
Res80765 = keras.layers.Reshape((5, 5, 1), name = 'Res80765', )(Up_7818)
Res63682 = keras.layers.Reshape((5, 5, 1, 1), name = 'Res63682', )(Res80765)
Glo1894 = keras.layers.GlobalAveragePooling3D(name = 'Glo1894', )(Res63682)
Con23864 = keras.layers.Concatenate(axis=1, name = 'Con23864', )([Glo1894,in0Con23864])
Min23011 = keras.layers.Minimum(name = 'Min23011', )([Fla94048,Con23864])
model = tf.keras.models.Model(inputs=[in0Con99484,in0Dot17805,in1Dot17805,in0Con23864], outputs=Min23011)
w = model.get_layer('Con99484').get_weights() 
w[0] = np.array([[[[0.1381, 0.4117, 0.4519]]], [[[0.4619, 0.1505, 0.5049]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con99484').set_weights(w) 
w = model.get_layer('PRe19038').get_weights() 
w[0] = np.array([[[0.1664, 0.4773, 0.5152]], [[0.9475, 0.9743, 0.7767]]])
model.get_layer('PRe19038').set_weights(w) 
in0Con99484 = tf.constant([[[[0.7274]], [[0.4816]]]])
in0Dot17805 = tf.constant([[[0.9431, 0.0501, 0.8432], [0.2129, 0.6873, 0.3262]]])
in1Dot17805 = tf.constant([[[0.1004, 0.7132, 0.208], [0.3063, 0.0308, 0.1461]]])
in0Con23864 = tf.constant([[0.2647, 0.5945, 0.1342, 0.232, 0.8319]])
print (np.array2string(model.predict([in0Con99484,in0Dot17805,in1Dot17805,in0Con23864],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min23011.png')

LCon99484 = conv2D_layer([[[[0.7274]], [[0.4816]]]], 2, 1,[[[[0.1381, 0.4117, 0.4519]]], [[[0.4619, 0.1505, 0.5049]]]],[0, 0, 0], 1, 1, true, 1, 1, Con99484), 
LPRe19038 = prelu_layer(Con99484, [[[0.1664, 0.4773, 0.5152]], [[0.9475, 0.9743, 0.7767]]], PRe19038), 
LRes37826 = reshape_layer(PRe19038, [2, 3], Res37826), 
LFla94048 = flatten_layer(Res37826, Fla94048), 
LDot17805 = dot_layer([[[0.9431, 0.0501, 0.8432], [0.2129, 0.6873, 0.3262]]], [[[0.1004, 0.7132, 0.208], [0.3063, 0.0308, 0.1461]]], 1, 1, Dot17805), 
LRes74777 = reshape_layer(Dot17805, [3, 3, 1], Res74777), 
LZer96951 = zero_padding2D_layer(Res74777, 1, 1, 1, 1, Zer96951), 
LRes31169 = reshape_layer(Zer96951, [5, 5], Res31169), 
LUp_7818 = up_sampling1D_layer(Res31169, 1, Up_7818), 
LRes80765 = reshape_layer(Up_7818, [5, 5, 1], Res80765), 
LRes63682 = reshape_layer(Res80765, [5, 5, 1, 1], Res63682), 
LGlo1894 = global_average_pooling3D_layer(Res63682, Glo1894), 
LCon23864 = concatenate_layer([Glo1894,[[0.2647, 0.5945, 0.1342, 0.232, 0.8319]]], 1, Con23864), 
LMin23011 = minimum_layer([Fla94048,Con23864], Min23011), 
exec_layers([LCon99484,LPRe19038,LRes37826,LFla94048,LDot17805,LRes74777,LZer96951,LRes31169,LUp_7818,LRes80765,LRes63682,LGlo1894,LCon23864,LMin23011],["Con99484","PRe19038","Res37826","Fla94048","Dot17805","Res74777","Zer96951","Res31169","Up_7818","Res80765","Res63682","Glo1894","Con23864","Min23011"],Min23011,"Min23011")

Actual (Unparsed): [[0.0987465, 0.2647000, 0.5718719, 0.0665090, 0.1982747, 0.2176350]]

Expected (Unparsed): [[0.09874650880000001,0.2647,0.5718719,0.06650895999999999,0.19827472,0.21763504]]

Actual:   [[0.0988, 0.2647, 0.5719, 0.0666, 0.1983, 0.2177]]

Expected: [[0.0988, 0.2647, 0.5719, 0.0666, 0.1983, 0.2177]]