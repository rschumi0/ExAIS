import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat92269 = tf.keras.layers.Input(shape=([3]))
in0Glo50660 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Con33930 = tf.keras.layers.Input(shape=([2, 1]))
in0Max37464 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max37464 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Sof27413 = tf.keras.layers.Input(shape=([2, 2]))
in0Sub47121 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub47121 = tf.keras.layers.Input(shape=([3, 2]))

Bat92269 = keras.layers.BatchNormalization(axis=1, epsilon=0.5090429190107766,  name = 'Bat92269', )(in0Bat92269)
Res19097 = keras.layers.Reshape((3, 1), name = 'Res19097', )(Bat92269)
Glo50660 = keras.layers.GlobalAveragePooling3D(name = 'Glo50660', )(in0Glo50660)
Res18379 = keras.layers.Reshape((2, 1), name = 'Res18379', )(Glo50660)
Con33930 = keras.layers.Concatenate(axis=2, name = 'Con33930', )([Res18379,in0Con33930])
Max37464 = keras.layers.Maximum(name = 'Max37464', )([in0Max37464,in1Max37464])
Res18832 = keras.layers.Reshape((1, 2), name = 'Res18832', )(Max37464)
Zer7720 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer7720', )(Res18832)
Sof27413 = keras.layers.Softmax(axis=1, name = 'Sof27413', input_shape=(2, 2))(in0Sof27413)
Max80619 = keras.layers.Maximum(name = 'Max80619', )([Zer7720,Sof27413])
Min77144 = keras.layers.Minimum(name = 'Min77144', )([Con33930,Max80619])
Zer72292 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer72292', )(Min77144)
Sub47121 = keras.layers.Subtract(name = 'Sub47121', )([in0Sub47121,in1Sub47121])
Max8600 = keras.layers.Maximum(name = 'Max8600', )([Zer72292,Sub47121])
Dot91013 = keras.layers.Dot(axes=(1, 1), name = 'Dot91013', )([Res19097,Max8600])
model = tf.keras.models.Model(inputs=[in0Bat92269,in0Glo50660,in0Con33930,in0Max37464,in1Max37464,in0Sof27413,in0Sub47121,in1Sub47121], outputs=Dot91013)
w = model.get_layer('Bat92269').get_weights() 
w[0] = np.array([0.9524, 0.3364, 0.6614])
w[1] = np.array([0.2685, 0.5994, 0.3503])
w[2] = np.array([0.8523, 0.1616, 0.83])
w[3] = np.array([0.0208, 0.4196, 0.3252])
model.get_layer('Bat92269').set_weights(w) 
in0Bat92269 = tf.constant([[1.466, 1.8938, 1.2455]])
in0Glo50660 = tf.constant([[[[[1.0234, 1.3579], [1.5012, 1.7085]], [[1.3258, 1.9902], [1.6974, 1.664]]]]])
in0Con33930 = tf.constant([[[0.2462], [0.4437]]])
in0Max37464 = tf.constant([[[[0.439], [0.3771]]]])
in1Max37464 = tf.constant([[[[0.217], [0.9672]]]])
in0Sof27413 = tf.constant([[[0.1386, 0.0481], [0.1992, 0.0101]]])
in0Sub47121 = tf.constant([[[0.0037, 0.4107], [0.7839, 0.1231], [0.8397, 0.0835]]])
in1Sub47121 = tf.constant([[[0.5257, 0.0208], [0.9218, 0.5192], [0.5303, 0.1785]]])
print (np.array2string(model.predict([in0Bat92269,in0Glo50660,in0Con33930,in0Max37464,in1Max37464,in0Sof27413,in0Sub47121,in1Sub47121],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot91013.png')

LBat92269 = batch_normalization_layer([[1.466, 1.8938, 1.2455]], 1, 0.5090429190107766, [0.9524, 0.3364, 0.6614], [0.2685, 0.5994, 0.3503], [0.8523, 0.1616, 0.83], [0.0208, 0.4196, 0.3252], Bat92269), 
LRes19097 = reshape_layer(Bat92269, [3, 1], Res19097), 
LGlo50660 = global_average_pooling3D_layer([[[[[1.0234, 1.3579], [1.5012, 1.7085]], [[1.3258, 1.9902], [1.6974, 1.664]]]]], Glo50660), 
LRes18379 = reshape_layer(Glo50660, [2, 1], Res18379), 
LCon33930 = concatenate_layer([Res18379,[[[0.2462], [0.4437]]]], 2, Con33930), 
LMax37464 = maximum_layer([[[[[0.439], [0.3771]]]], [[[[0.217], [0.9672]]]]], Max37464), 
LRes18832 = reshape_layer(Max37464, [1, 2], Res18832), 
LZer7720 = zero_padding1D_layer(Res18832, 1, 0, Zer7720), 
LSof27413 = softmax_layer([[[0.1386, 0.0481], [0.1992, 0.0101]]], 1, Sof27413), 
LMax80619 = maximum_layer([Zer7720,Sof27413], Max80619), 
LMin77144 = minimum_layer([Con33930,Max80619], Min77144), 
LZer72292 = zero_padding1D_layer(Min77144, 1, 0, Zer72292), 
LSub47121 = subtract_layer([[[0.0037, 0.4107], [0.7839, 0.1231], [0.8397, 0.0835]]], [[[0.5257, 0.0208], [0.9218, 0.5192], [0.5303, 0.1785]]], Sub47121), 
LMax8600 = maximum_layer([Zer72292,Sub47121], Max8600), 
LDot91013 = dot_layer(Res19097,Max8600, 1, 1, Dot91013), 
exec_layers([LBat92269,LRes19097,LGlo50660,LRes18379,LCon33930,LMax37464,LRes18832,LZer7720,LSof27413,LMax80619,LMin77144,LZer72292,LSub47121,LMax8600,LDot91013],["Bat92269","Res19097","Glo50660","Res18379","Con33930","Max37464","Res18832","Zer7720","Sof27413","Max80619","Min77144","Zer72292","Sub47121","Max8600","Dot91013"],Dot91013,"Dot91013")

Actual (Unparsed): [[[0.9192573, 1.0031411]]]

Expected (Unparsed): [[[0.9192572973577798,1.003141148965236]]]

Actual:   [[[0.9193, 1.0032]]]

Expected: [[[0.9193, 1.0032]]]