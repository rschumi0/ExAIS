import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min73078 = tf.keras.layers.Input(shape=([2, 1]))
in1Min73078 = tf.keras.layers.Input(shape=([2, 1]))
in0Con5649 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul69426 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul69426 = tf.keras.layers.Input(shape=([1, 1]))

Min73078 = keras.layers.Minimum(name = 'Min73078', )([in0Min73078,in1Min73078])
Con5649 = keras.layers.Concatenate(axis=2, name = 'Con5649', )([Min73078,in0Con5649])
Mul69426 = keras.layers.Multiply(name = 'Mul69426', )([in0Mul69426,in1Mul69426])
Res96624 = keras.layers.Reshape((1, 1, 1), name = 'Res96624', )(Mul69426)
Res78056 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res78056', )(Res96624)
Con3764 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con3764', )(Res78056)
Res58579 = keras.layers.Reshape((1, 1, 3), name = 'Res58579', )(Con3764)
Res9469 = keras.layers.Reshape((1, 3), name = 'Res9469', )(Res58579)
Con54074 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con54074', )(Res9469)
Zer87428 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer87428', )(Con54074)
Max37600 = keras.layers.Maximum(name = 'Max37600', )([Con5649,Zer87428])
model = tf.keras.models.Model(inputs=[in0Min73078,in1Min73078,in0Con5649,in0Mul69426,in1Mul69426], outputs=Max37600)
w = model.get_layer('Con3764').get_weights() 
w[0] = np.array([[[[[0.8433], [0.1164], [0.5497]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con3764').set_weights(w) 
w = model.get_layer('Con54074').get_weights() 
w[0] = np.array([[[0.2245, 0.3956], [0.8996, 0.2489], [0.9626, 0.7041]]])
w[1] = np.array([0, 0])
model.get_layer('Con54074').set_weights(w) 
in0Min73078 = tf.constant([[[0.377], [0.5882]]])
in1Min73078 = tf.constant([[[0.0705], [0.439]]])
in0Con5649 = tf.constant([[[0.7709], [0.5377]]])
in0Mul69426 = tf.constant([[[0.5428]]])
in1Mul69426 = tf.constant([[[0.7474]]])
print (np.array2string(model.predict([in0Min73078,in1Min73078,in0Con5649,in0Mul69426,in1Mul69426],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max37600.png')

LMin73078 = minimum_layer([[[[0.377], [0.5882]]], [[[0.0705], [0.439]]]], Min73078), 
LCon5649 = concatenate_layer([Min73078,[[[0.7709], [0.5377]]]], 2, Con5649), 
LMul69426 = multiply_layer([[[[0.5428]]], [[[0.7474]]]], Mul69426), 
LRes96624 = reshape_layer(Mul69426, [1, 1, 1], Res96624), 
LRes78056 = reshape_layer(Res96624, [1, 1, 1, 1], Res78056), 
LCon3764 = conv3D_transpose_layer(Res78056, 1, 1, 1,[[[[[0.8433], [0.1164], [0.5497]]]]],[0, 0, 0], 1, 1, 1, false, Con3764), 
LRes58579 = reshape_layer(Con3764, [1, 1, 3], Res58579), 
LRes9469 = reshape_layer(Res58579, [1, 3], Res9469), 
LCon54074 = conv1D_layer(Res9469, 1,[[[0.2245, 0.3956], [0.8996, 0.2489], [0.9626, 0.7041]]],[0, 0], 1, false, 1, Con54074), 
LZer87428 = zero_padding1D_layer(Con54074, 1, 0, Zer87428), 
LMax37600 = maximum_layer([Con5649,Zer87428], Max37600), 
exec_layers([LMin73078,LCon5649,LMul69426,LRes96624,LRes78056,LCon3764,LRes58579,LRes9469,LCon54074,LZer87428,LMax37600],["Min73078","Con5649","Mul69426","Res96624","Res78056","Con3764","Res58579","Res9469","Con54074","Zer87428","Max37600"],Max37600,"Max37600")

Actual (Unparsed): [[[0.0705000, 0.7709000], [0.4390000, 0.5377000]]]

Expected (Unparsed): [[[0.0705,0.7709],[0.439,0.5377]]]

Actual:   [[[0.0705, 0.7709], [0.439, 0.5377]]]

Expected: [[[0.0705, 0.7709], [0.439, 0.5377]]]