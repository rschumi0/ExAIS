import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas57331 = tf.keras.layers.Input(shape=([3]))
in0Ave61652 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave61652 = tf.keras.layers.Input(shape=([1, 2, 1]))

Mas57331 = keras.layers.Masking(mask_value=1, name = 'Mas57331', )(in0Mas57331)
Res57515 = keras.layers.Reshape((3, 1), name = 'Res57515', )(Mas57331)
Res41872 = keras.layers.Reshape((3, 1, 1), name = 'Res41872', )(Res57515)
Zer87061 = keras.layers.ZeroPadding2D(padding=((0, 0), (3, 0)), name = 'Zer87061', )(Res41872)
Ave61652 = keras.layers.Average(name = 'Ave61652', )([in0Ave61652,in1Ave61652])
Zer74035 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer74035', )(Ave61652)
Add95100 = keras.layers.Add(name = 'Add95100', )([Zer87061,Zer74035])
model = tf.keras.models.Model(inputs=[in0Mas57331,in0Ave61652,in1Ave61652], outputs=Add95100)
in0Mas57331 = tf.constant([[1.5276, 1.0539, 1.6969]])
in0Ave61652 = tf.constant([[[[0.8933], [0.2329]]]])
in1Ave61652 = tf.constant([[[[0.1202], [0.136]]]])
print (np.array2string(model.predict([in0Mas57331,in0Ave61652,in1Ave61652],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add95100.png')

LMas57331 = masking_layer([[1.5276, 1.0539, 1.6969]], 1, Mas57331), 
LRes57515 = reshape_layer(Mas57331, [3, 1], Res57515), 
LRes41872 = reshape_layer(Res57515, [3, 1, 1], Res41872), 
LZer87061 = zero_padding2D_layer(Res41872, 0, 0, 3, 0, Zer87061), 
LAve61652 = average_layer([[[[[0.8933], [0.2329]]]], [[[[0.1202], [0.136]]]]], Ave61652), 
LZer74035 = zero_padding2D_layer(Ave61652, 1, 1, 1, 1, Zer74035), 
LAdd95100 = add_layer([Zer87061,Zer74035], Add95100), 
exec_layers([LMas57331,LRes57515,LRes41872,LZer87061,LAve61652,LZer74035,LAdd95100],["Mas57331","Res57515","Res41872","Zer87061","Ave61652","Zer74035","Add95100"],Add95100,"Add95100")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [1.5276000]], [[0.0000000], [0.5067500], [0.1844500], [1.0539000]], [[0.0000000], [0.0000000], [0.0000000], [1.6969000]]]]

Expected (Unparsed): [[[[0],[0],[0],[1.5276]],[[0],[0.50675],[0.18445],[1.0539]],[[0],[0],[0],[1.6969]]]]

Actual:   [[[[0], [0], [0], [1.5276]], [[0], [0.5068], [0.1845], [1.0539]], [[0], [0], [0], [1.6969]]]]

Expected: [[[[0], [0], [0], [1.5276]], [[0], [0.5068], [0.1845], [1.0539]], [[0], [0], [0], [1.6969]]]]