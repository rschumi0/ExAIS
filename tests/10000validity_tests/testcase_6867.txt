import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep878 = tf.keras.layers.Input(shape=([2, 2]))

Sep878 = keras.layers.SeparableConv1D(3, (1),strides=(2), padding='same', name = 'Sep878', )(in0Sep878)
Bat27138 = keras.layers.BatchNormalization(axis=1, epsilon=0.7313082181847993,  name = 'Bat27138', )(Sep878)
ReL53511 = keras.layers.ReLU(max_value=1.4042792967593036, negative_slope=4.7631558503055516, threshold=7.034060006163734, name = 'ReL53511', )(Bat27138)
Res53070 = keras.layers.Reshape((1, 3, 1), name = 'Res53070', )(ReL53511)
Res50277 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res50277', )(Res53070)
Con19335 = keras.layers.Conv3D(4, (1, 3, 1),strides=(9, 1, 12), padding='valid', dilation_rate=(1, 1, 1), name = 'Con19335', )(Res50277)
model = tf.keras.models.Model(inputs=[in0Sep878], outputs=Con19335)
w = model.get_layer('Sep878').get_weights() 
w[0] = np.array([[[0.2161], [0.0158]]])
w[1] = np.array([[[0.6767, 0.2626, 0.594], [0.6805, 0.8119, 0.5954]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep878').set_weights(w) 
w = model.get_layer('Bat27138').get_weights() 
w[0] = np.array([0.8154])
w[1] = np.array([0.6275])
w[2] = np.array([0.4454])
w[3] = np.array([0.9768])
model.get_layer('Bat27138').set_weights(w) 
w = model.get_layer('Con19335').get_weights() 
w[0] = np.array([[[[[0.5311, 0.8104, 0.154, 0.3658]]], [[[0.2593, 0.8605, 0.2967, 0.9652]]], [[[0.6268, 0.3633, 0.7553, 0.9585]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con19335').set_weights(w) 
in0Sep878 = tf.constant([[[0.2661, 0.7775], [0.9826, 0.9826]]])
print (np.array2string(model.predict([in0Sep878],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con19335.png')

LSep878 = separable_conv1D_layer([[[0.2661, 0.7775], [0.9826, 0.9826]]], 1,[[[[0.2161], [0.0158]]],[[[0.6767, 0.2626, 0.594], [0.6805, 0.8119, 0.5954]]]],[0, 0, 0], 2, true, Sep878), 
LBat27138 = batch_normalization_layer(Sep878, 1, 0.7313082181847993, [0.8154], [0.6275], [0.4454], [0.9768], Bat27138), 
LReL53511 = relu_layer(Bat27138, 1.4042792967593036, 4.7631558503055516, 7.034060006163734, ReL53511), 
LRes53070 = reshape_layer(ReL53511, [1, 3, 1], Res53070), 
LRes50277 = reshape_layer(Res53070, [1, 3, 1, 1], Res50277), 
LCon19335 = conv3D_layer(Res50277, 1, 3, 1,[[[[[0.5311, 0.8104, 0.154, 0.3658]]], [[[0.2593, 0.8605, 0.2967, 0.9652]]], [[[0.6268, 0.3633, 0.7553, 0.9585]]]]],[0, 0, 0, 0], 9, 1, 12, false, 1, 1, 1, Con19335), 
exec_layers([LSep878,LBat27138,LReL53511,LRes53070,LRes50277,LCon19335],["Sep878","Bat27138","ReL53511","Res53070","Res50277","Con19335"],Con19335,"Con19335")

Actual (Unparsed): [[[[[-44.9511190, -64.5442515, -38.2610641, -72.6540629]]]]]

Expected (Unparsed): [[[[[-44.95111899172195,-64.54425145083277,-38.26106414429488,-72.65406285293005]]]]]

Actual:   [[[[[-44.9511, -64.5442, -38.261, -72.654]]]]]

Expected: [[[[[-44.9511, -64.5442, -38.261, -72.654]]]]]