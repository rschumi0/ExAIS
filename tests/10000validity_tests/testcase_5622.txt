import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro56404 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con61544 = tf.keras.layers.Input(shape=([14, 2, 1, 1]))
in0Con10976 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Cro56404 = keras.layers.Cropping3D(cropping=((0, 0), (1, 0), (0, 0)), name = 'Cro56404', )(in0Cro56404)
Lea43701 = keras.layers.LeakyReLU(alpha=3.1156136296284225, name = 'Lea43701', )(Cro56404)
Res56064 = keras.layers.Reshape((1, 1, 1), name = 'Res56064', )(Lea43701)
Res57753 = keras.layers.Reshape((1, 1), name = 'Res57753', )(Res56064)
Per204 = keras.layers.Permute((1,2), name = 'Per204',)(Res57753)
Res72413 = keras.layers.Reshape((1, 1, 1), name = 'Res72413', )(Per204)
Res31539 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res31539', )(Res72413)
Zer30729 = keras.layers.ZeroPadding3D(padding=((13, 0), (1, 0), (0, 0)), name = 'Zer30729', )(Res31539)
Con61544 = keras.layers.Concatenate(axis=4, name = 'Con61544', )([Zer30729,in0Con61544])
Con10976 = keras.layers.Conv3DTranspose(2, (2, 2, 1),strides=(7, 1, 1), padding='same', name = 'Con10976', )(in0Con10976)
Sub29827 = keras.layers.Subtract(name = 'Sub29827', )([Con61544,Con10976])
Res56081 = keras.layers.Reshape((14, 2, 2), name = 'Res56081', )(Sub29827)
Con33010 = keras.layers.Conv2D(4, (11, 2),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con33010', )(Res56081)
model = tf.keras.models.Model(inputs=[in0Cro56404,in0Con61544,in0Con10976], outputs=Con33010)
w = model.get_layer('Con10976').get_weights() 
w[0] = np.array([[[[[0.3662], [0.595]]], [[[0.4918], [0.0052]]]], [[[[0.6893], [0.0213]]], [[[0.4323], [0.4713]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con10976').set_weights(w) 
w = model.get_layer('Con33010').get_weights() 
w[0] = np.array([[[[0.9725, 0.6282, 0.95, 0.9447], [0.6833, 0.1369, 0.035, 0.0515]], [[0.8713, 0.0487, 0.0723, 0.7275], [0.8148, 0.7122, 0.5007, 0.5284]]], [[[0.5017, 0.0639, 0.064, 0.9638], [0.2328, 0.6535, 0.533, 0.8008]], [[0.7644, 0.6744, 0.5637, 0.4746], [0.1302, 0.7142, 0.5546, 0.7062]]], [[[0.7052, 0.25, 0.3699, 0.4389], [0.9099, 0.8748, 0.7086, 0.3744]], [[0.1916, 0.8707, 0.7149, 0.7153], [0.5637, 0.0146, 0.1494, 0.2001]]], [[[0.0383, 0.4441, 0.0709, 0.1574], [0.7435, 0.9957, 0.5154, 0.098]], [[0.3805, 0.6809, 0.0988, 0.3139], [0.9496, 0.863, 0.8212, 0.0608]]], [[[0.3459, 0.2609, 0.6047, 0.1616], [0.5128, 0.1213, 0.2562, 0.2893]], [[0.3279, 0.7711, 0.6168, 0.7621], [0.2944, 0.2928, 0.6302, 0.4135]]], [[[0.408, 0.2478, 0.9456, 0.9905], [0.2828, 0.2146, 0.4524, 0.5756]], [[0.7307, 0.4059, 0.8417, 0.7273], [0.5089, 0.7818, 0.883, 0.3933]]], [[[0.8802, 0.8855, 0.6134, 0.1601], [0.959, 0.0942, 0.0455, 0.0735]], [[0.5604, 0.1, 0.3181, 0.0893], [0.4099, 0.2129, 0.438, 0.1953]]], [[[0.1285, 0.5154, 0.8902, 0.3815], [0.361, 0.9839, 0.4312, 0.9329]], [[0.7833, 0.4454, 0.3197, 0.9657], [0.4917, 0.6363, 0.0926, 0.7369]]], [[[0.4588, 0.692, 0.7433, 0.0178], [0.3167, 0.1117, 0.8243, 0.7439]], [[0.7244, 0.6148, 0.5633, 0.225], [0.9674, 0.3318, 0.5524, 0.4341]]], [[[0.2409, 0.4614, 0.9553, 0.2791], [0.275, 0.8612, 0.4572, 0.3067]], [[0.5761, 0.0399, 0.3802, 0.9882], [0.5788, 0.6726, 0.4821, 0.5909]]], [[[0.4268, 0.066, 0.9619, 0.6557], [0.939, 0.9721, 0.1088, 0.2653]], [[0.5517, 0.7668, 0.8449, 0.6185], [0.6765, 0.2893, 0.1387, 0.9015]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con33010').set_weights(w) 
in0Cro56404 = tf.constant([[[[[1.271]], [[1.1268]]]]])
in0Con61544 = tf.constant([[[[[0.901]], [[0.4904]]], [[[0.4522]], [[0.5208]]], [[[0.3321]], [[0.0337]]], [[[0.6121]], [[0.078]]], [[[0.7993]], [[0.7952]]], [[[0.9488]], [[0.1247]]], [[[0.8175]], [[0.7952]]], [[[0.6261]], [[0.8155]]], [[[0.6575]], [[0.1014]]], [[[0.8115]], [[0.9416]]], [[[0.583]], [[0.1247]]], [[[0.3441]], [[0.1061]]], [[[0.5601]], [[0.2818]]], [[[0.7973]], [[0.4299]]]]])
in0Con10976 = tf.constant([[[[[0.986]], [[0.0022]]], [[[0.1577]], [[0.8612]]]]])
print (np.array2string(model.predict([in0Cro56404,in0Con61544,in0Con10976],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con33010.png')

LCro56404 = cropping3D_layer([[[[[1.271]], [[1.1268]]]]], 0, 0, 1, 0, 0, 0, Cro56404), 
LLea43701 = leaky_relu_layer(Cro56404, 3.1156136296284225, Lea43701), 
LRes56064 = reshape_layer(Lea43701, [1, 1, 1], Res56064), 
LRes57753 = reshape_layer(Res56064, [1, 1], Res57753), 
LPer204 = permute_layer(Res57753, 1,2, Per204), 
LRes72413 = reshape_layer(Per204, [1, 1, 1], Res72413), 
LRes31539 = reshape_layer(Res72413, [1, 1, 1, 1], Res31539), 
LZer30729 = zero_padding3D_layer(Res31539, 13, 0, 1, 0, 0, 0, Zer30729), 
LCon61544 = concatenate_layer([Zer30729,[[[[[0.901]], [[0.4904]]], [[[0.4522]], [[0.5208]]], [[[0.3321]], [[0.0337]]], [[[0.6121]], [[0.078]]], [[[0.7993]], [[0.7952]]], [[[0.9488]], [[0.1247]]], [[[0.8175]], [[0.7952]]], [[[0.6261]], [[0.8155]]], [[[0.6575]], [[0.1014]]], [[[0.8115]], [[0.9416]]], [[[0.583]], [[0.1247]]], [[[0.3441]], [[0.1061]]], [[[0.5601]], [[0.2818]]], [[[0.7973]], [[0.4299]]]]]], 4, Con61544), 
LCon10976 = conv3D_transpose_layer([[[[[0.986]], [[0.0022]]], [[[0.1577]], [[0.8612]]]]], 2, 2, 1,[[[[[0.3662], [0.595]]], [[[0.4918], [0.0052]]]], [[[[0.6893], [0.0213]]], [[[0.4323], [0.4713]]]]],[0, 0], 7, 1, 1, true, Con10976), 
LSub29827 = subtract_layer(Con61544,Con10976, Sub29827), 
LRes56081 = reshape_layer(Sub29827, [14, 2, 2], Res56081), 
LCon33010 = conv2D_layer(Res56081, 11, 2,[[[[0.9725, 0.6282, 0.95, 0.9447], [0.6833, 0.1369, 0.035, 0.0515]], [[0.8713, 0.0487, 0.0723, 0.7275], [0.8148, 0.7122, 0.5007, 0.5284]]], [[[0.5017, 0.0639, 0.064, 0.9638], [0.2328, 0.6535, 0.533, 0.8008]], [[0.7644, 0.6744, 0.5637, 0.4746], [0.1302, 0.7142, 0.5546, 0.7062]]], [[[0.7052, 0.25, 0.3699, 0.4389], [0.9099, 0.8748, 0.7086, 0.3744]], [[0.1916, 0.8707, 0.7149, 0.7153], [0.5637, 0.0146, 0.1494, 0.2001]]], [[[0.0383, 0.4441, 0.0709, 0.1574], [0.7435, 0.9957, 0.5154, 0.098]], [[0.3805, 0.6809, 0.0988, 0.3139], [0.9496, 0.863, 0.8212, 0.0608]]], [[[0.3459, 0.2609, 0.6047, 0.1616], [0.5128, 0.1213, 0.2562, 0.2893]], [[0.3279, 0.7711, 0.6168, 0.7621], [0.2944, 0.2928, 0.6302, 0.4135]]], [[[0.408, 0.2478, 0.9456, 0.9905], [0.2828, 0.2146, 0.4524, 0.5756]], [[0.7307, 0.4059, 0.8417, 0.7273], [0.5089, 0.7818, 0.883, 0.3933]]], [[[0.8802, 0.8855, 0.6134, 0.1601], [0.959, 0.0942, 0.0455, 0.0735]], [[0.5604, 0.1, 0.3181, 0.0893], [0.4099, 0.2129, 0.438, 0.1953]]], [[[0.1285, 0.5154, 0.8902, 0.3815], [0.361, 0.9839, 0.4312, 0.9329]], [[0.7833, 0.4454, 0.3197, 0.9657], [0.4917, 0.6363, 0.0926, 0.7369]]], [[[0.4588, 0.692, 0.7433, 0.0178], [0.3167, 0.1117, 0.8243, 0.7439]], [[0.7244, 0.6148, 0.5633, 0.225], [0.9674, 0.3318, 0.5524, 0.4341]]], [[[0.2409, 0.4614, 0.9553, 0.2791], [0.275, 0.8612, 0.4572, 0.3067]], [[0.5761, 0.0399, 0.3802, 0.9882], [0.5788, 0.6726, 0.4821, 0.5909]]], [[[0.4268, 0.066, 0.9619, 0.6557], [0.939, 0.9721, 0.1088, 0.2653]], [[0.5517, 0.7668, 0.8449, 0.6185], [0.6765, 0.2893, 0.1387, 0.9015]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con33010), 
exec_layers([LCro56404,LLea43701,LRes56064,LRes57753,LPer204,LRes72413,LRes31539,LZer30729,LCon61544,LCon10976,LSub29827,LRes56081,LCon33010],["Cro56404","Lea43701","Res56064","Res57753","Per204","Res72413","Res31539","Zer30729","Con61544","Con10976","Sub29827","Res56081","Con33010"],Con33010,"Con33010")

Actual (Unparsed): [[[[1.4926153, 2.1911975, 0.8737768, 1.4590058], [-0.0114323, 0.4579090, -0.0442327, 0.0995319]], [[2.8328220, 2.4745864, 1.2017438, 2.0462049], [1.0147909, 0.8871571, 0.2853210, 0.5860854]], [[3.3355378, 2.9513982, 1.9375297, 2.7726712], [0.9677015, 1.9250012, 0.4536582, 0.8442380]], [[3.6033484, 2.2517344, 1.9558164, 1.7887181], [0.9361232, 0.5188567, 0.0783832, 0.2785655]], [[3.6663980, 4.1445245, 2.3964283, 3.0661520], [0.9575026, 1.6144884, 0.2853361, 1.2728916]], [[3.3223871, 4.0122495, 3.1787268, 2.4004385], [1.0848582, 0.6457137, -0.3416878, 0.0278774]], [[4.3644742, 4.5363593, 4.0048989, 2.3109068], [0.8754306, 0.4705103, 0.5024417, 0.7085194]], [[5.1515809, 5.1959026, 3.5590009, 4.2695896], [1.2894540, 1.6598278, 0.8218518, 1.3621549]], [[6.5684465, 6.6872171, 4.9310975, 4.3598339], [2.6383617, 2.1614428, 1.5863231, 1.3426847]], [[6.3002709, 4.7271391, 4.9333327, 4.8383244], [2.1842787, 2.0806763, 2.3704266, 1.6079925]], [[4.9416863, 3.9009104, 4.3979889, 3.9423113], [1.6241370, 1.6737146, 2.0705356, 1.4353504]], [[5.4560828, 4.4995346, 3.1659673, 3.4271491], [1.3221054, 2.1291982, 1.6917013, 0.6581729]], [[3.7072906, 2.3175643, 2.4190257, 1.3346491], [1.9820849, 1.8174580, 1.1964935, -0.2168287]], [[2.6784071, 3.2590899, 3.5369307, 2.7784483], [0.4997390, 0.8211803, 1.3487018, 1.6314376]]]]

Expected (Unparsed): [[[[1.492615253514,2.19119746811,0.8737768017260003,1.4590057329319996],[-0.011432243471999878,0.45790903044600006,-0.04423264605800001,0.09953186292399985]],[[2.832822009268,2.4745863382340003,1.2017437817060004,2.0462049066],[1.014790877316,0.88715712008,0.2853210274520001,0.58608543601]],[[3.3355377945799995,2.9513981627879997,1.937529704764,2.77267111729],[0.9677014500660001,1.92500124228,0.45365824328800003,0.8442380462679999]],[[3.6033483071400005,2.2517343420100007,1.9558163366290005,1.7887179795459995],[0.9361232130480001,0.5188566505270001,0.07838321977899997,0.27856547842199997]],[[3.666397930746,4.144524464383,2.396428240019999,3.066151925641001],[0.957502591965,1.6144883386459998,0.28533603891300013,1.272891564518]],[[3.3223870047630006,4.012249431399,3.178726777993001,2.400438377182],[1.084858173385,0.645713674903,-0.3416878621499998,0.02787734774100018]],[[4.364474072655,4.536359218298,4.004898807169001,2.3109067490839994],[0.8754305561870002,0.4705102543750001,0.5024417016020002,0.70851933986]],[[5.151580744511,5.195902462535999,3.55900078569,4.26958957],[1.289453992084,1.659827707797,0.821851748531,1.362154809944]],[[6.568446447197999,6.687217054979002,4.931097427145,4.3598338713030005],[2.638361677562,2.16144285697,1.586323105802,1.3426846849210001]],[[6.300270846965999,4.727138997910999,4.933332586387001,4.838324418531001],[2.184278708341,2.0806763169180003,2.370426621191,1.607992514267]],[[4.941686262469,3.900910402154999,4.397988887385,3.942311293777],[1.624137004828,1.673714589192,2.070535655625,1.435350410556]],[[5.456082771242,4.499534502397,3.1659672187999996,3.4271490838190006],[1.322105362311,2.129198158754,1.691701303365,0.6581728629770002]],[[3.7072905895110004,2.317564203248,2.4190256478710004,1.334649031024],[1.9820848453429996,1.817458007076,1.1964935311099998,-0.2168287090319999]],[[2.678407108774999,3.2590899036059997,3.53693078455,2.7784483334049996],[0.49973898834400005,0.821180269533,1.34870186855,1.631437667656]]]]

Actual:   [[[[1.4927, 2.1912, 0.8738, 1.4591], [-0.0114, 0.458, -0.0442, 0.0996]], [[2.8329, 2.4746, 1.2018, 2.0463], [1.0148, 0.8872, 0.2854, 0.5861]], [[3.3356, 2.9514, 1.9376, 2.7727], [0.9678, 1.9251, 0.4537, 0.8443]], [[3.6034, 2.2518, 1.9559, 1.7888], [0.9362, 0.5189, 0.0784, 0.2786]], [[3.6664, 4.1446, 2.3965, 3.0662], [0.9576, 1.6145, 0.2854, 1.2729]], [[3.3224, 4.0123, 3.1788, 2.4005], [1.0849, 0.6458, -0.3416, 0.0279]], [[4.3645, 4.5364, 4.0049, 2.311], [0.8755, 0.4706, 0.5025, 0.7086]], [[5.1516, 5.196, 3.5591, 4.2696], [1.2895, 1.6599, 0.8219, 1.3622]], [[6.5685, 6.6873, 4.9311, 4.3599], [2.6384, 2.1615, 1.5864, 1.3427]], [[6.3003, 4.7272, 4.9334, 4.8384], [2.1843, 2.0807, 2.3705, 1.608]], [[4.9417, 3.901, 4.398, 3.9424], [1.6242, 1.6738, 2.0706, 1.4354]], [[5.4561, 4.4996, 3.166, 3.4272], [1.3222, 2.1292, 1.6918, 0.6582]], [[3.7073, 2.3176, 2.4191, 1.3347], [1.9821, 1.8175, 1.1965, -0.2168]], [[2.6785, 3.2591, 3.537, 2.7785], [0.4998, 0.8212, 1.3488, 1.6315]]]]

Expected: [[[[1.4927, 2.1912, 0.8738, 1.4591], [-0.0114, 0.458, -0.0442, 0.0996]], [[2.8329, 2.4746, 1.2018, 2.0463], [1.0148, 0.8872, 0.2854, 0.5861]], [[3.3356, 2.9514, 1.9376, 2.7727], [0.9678, 1.9251, 0.4537, 0.8443]], [[3.6034, 2.2518, 1.9559, 1.7888], [0.9362, 0.5189, 0.0784, 0.2786]], [[3.6664, 4.1446, 2.3965, 3.0662], [0.9576, 1.6145, 0.2854, 1.2729]], [[3.3224, 4.0123, 3.1788, 2.4005], [1.0849, 0.6458, -0.3416, 0.0279]], [[4.3645, 4.5364, 4.0049, 2.311], [0.8755, 0.4706, 0.5025, 0.7086]], [[5.1516, 5.196, 3.5591, 4.2696], [1.2895, 1.6599, 0.8219, 1.3622]], [[6.5685, 6.6873, 4.9311, 4.3599], [2.6384, 2.1615, 1.5864, 1.3427]], [[6.3003, 4.7272, 4.9334, 4.8384], [2.1843, 2.0807, 2.3705, 1.608]], [[4.9417, 3.901, 4.398, 3.9424], [1.6242, 1.6738, 2.0706, 1.4354]], [[5.4561, 4.4996, 3.166, 3.4272], [1.3222, 2.1292, 1.6918, 0.6582]], [[3.7073, 2.3176, 2.4191, 1.3347], [1.9821, 1.8175, 1.1965, -0.2168]], [[2.6785, 3.2591, 3.537, 2.7785], [0.4998, 0.8212, 1.3488, 1.6315]]]]