import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo13407 = tf.keras.layers.Input(shape=([2, 2]))
in0Add61907 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Add61907 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sub64924 = tf.keras.layers.Input(shape=([3]))
in1Sub64924 = tf.keras.layers.Input(shape=([3]))
in0Con69195 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Con80352 = tf.keras.layers.Input(shape=([3, 3, 2]))

Glo13407 = keras.layers.GlobalMaxPool1D(name = 'Glo13407', )(in0Glo13407)
Res84396 = keras.layers.Reshape((2, 1), name = 'Res84396', )(Glo13407)
Res48242 = keras.layers.Reshape((2, 1, 1), name = 'Res48242', )(Res84396)
Res44086 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res44086', )(Res48242)
Con41642 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con41642', )(Res44086)
Res93170 = keras.layers.Reshape((2, 1, 4), name = 'Res93170', )(Con41642)
Zer78830 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer78830', )(Res93170)
Add61907 = keras.layers.Add(name = 'Add61907', )([in0Add61907,in1Add61907])
Zer45272 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer45272', )(Add61907)
Sub64924 = keras.layers.Subtract(name = 'Sub64924', )([in0Sub64924,in1Sub64924])
Res42124 = keras.layers.Reshape((3, 1), name = 'Res42124', )(Sub64924)
Res26209 = keras.layers.Reshape((3, 1, 1), name = 'Res26209', )(Res42124)
Ave94208 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave94208', )(Res26209)
Zer70178 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer70178', )(Ave94208)
Con69195 = keras.layers.Concatenate(axis=3, name = 'Con69195', )([Zer70178,in0Con69195])
Mul96399 = keras.layers.Multiply(name = 'Mul96399', )([Zer45272,Con69195])
Con80352 = keras.layers.Concatenate(axis=3, name = 'Con80352', )([Mul96399,in0Con80352])
Min92149 = keras.layers.Minimum(name = 'Min92149', )([Zer78830,Con80352])
model = tf.keras.models.Model(inputs=[in0Glo13407,in0Add61907,in1Add61907,in0Sub64924,in1Sub64924,in0Con69195,in0Con80352], outputs=Min92149)
w = model.get_layer('Con41642').get_weights() 
w[0] = np.array([[[[[0.2111, 0.1342, 0.248, 0.9031]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con41642').set_weights(w) 
in0Glo13407 = tf.constant([[[1.196, 1.2121], [1.6079, 1.608]]])
in0Add61907 = tf.constant([[[[0.1277, 0.2804], [0.9445, 0.4961]], [[0.4534, 0.0312], [0.1565, 0.3018]]]])
in1Add61907 = tf.constant([[[[0.7627, 0.0416], [0.0836, 0.7424]], [[0.1086, 0.5954], [0.2199, 0.2]]]])
in0Sub64924 = tf.constant([[0.9813, 0.9408, 0.9386]])
in1Sub64924 = tf.constant([[0.8977, 0.7821, 0.0602]])
in0Con69195 = tf.constant([[[[0.5558], [0.8179], [0.3057]], [[0.7396], [0.4126], [0.3153]], [[0.3373], [0.3009], [0.9949]]]])
in0Con80352 = tf.constant([[[[0.7002, 0.7047], [0.5403, 0.1698], [0.5221, 0.4629]], [[0.4476, 0.5487], [0.9454, 0.4362], [0.2631, 0.2722]], [[0.4784, 0.9471], [0.7084, 0.8111], [0.6224, 0.174]]]])
print (np.array2string(model.predict([in0Glo13407,in0Add61907,in1Add61907,in0Sub64924,in1Sub64924,in0Con69195,in0Con80352],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min92149.png')

LGlo13407 = global_max_pool1D_layer([[[1.196, 1.2121], [1.6079, 1.608]]], Glo13407), 
LRes84396 = reshape_layer(Glo13407, [2, 1], Res84396), 
LRes48242 = reshape_layer(Res84396, [2, 1, 1], Res48242), 
LRes44086 = reshape_layer(Res48242, [2, 1, 1, 1], Res44086), 
LCon41642 = conv3D_layer(Res44086, 1, 1, 1,[[[[[0.2111, 0.1342, 0.248, 0.9031]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con41642), 
LRes93170 = reshape_layer(Con41642, [2, 1, 4], Res93170), 
LZer78830 = zero_padding2D_layer(Res93170, 1, 0, 2, 0, Zer78830), 
LAdd61907 = add_layer([[[[[0.1277, 0.2804], [0.9445, 0.4961]], [[0.4534, 0.0312], [0.1565, 0.3018]]]], [[[[0.7627, 0.0416], [0.0836, 0.7424]], [[0.1086, 0.5954], [0.2199, 0.2]]]]], Add61907), 
LZer45272 = zero_padding2D_layer(Add61907, 1, 0, 1, 0, Zer45272), 
LSub64924 = subtract_layer([[0.9813, 0.9408, 0.9386]], [[0.8977, 0.7821, 0.0602]], Sub64924), 
LRes42124 = reshape_layer(Sub64924, [3, 1], Res42124), 
LRes26209 = reshape_layer(Res42124, [3, 1, 1], Res26209), 
LAve94208 = average_pooling2D_layer(Res26209, 1, 1, Ave94208), 
LZer70178 = zero_padding2D_layer(Ave94208, 0, 0, 2, 0, Zer70178), 
LCon69195 = concatenate_layer([Zer70178,[[[[0.5558], [0.8179], [0.3057]], [[0.7396], [0.4126], [0.3153]], [[0.3373], [0.3009], [0.9949]]]]], 3, Con69195), 
LMul96399 = multiply_layer([Zer45272,Con69195], Mul96399), 
LCon80352 = concatenate_layer([Mul96399,[[[[0.7002, 0.7047], [0.5403, 0.1698], [0.5221, 0.4629]], [[0.4476, 0.5487], [0.9454, 0.4362], [0.2631, 0.2722]], [[0.4784, 0.9471], [0.7084, 0.8111], [0.6224, 0.174]]]]], 3, Con80352), 
LMin92149 = minimum_layer([Zer78830,Con80352], Min92149), 
exec_layers([LGlo13407,LRes84396,LRes48242,LRes44086,LCon41642,LRes93170,LZer78830,LAdd61907,LZer45272,LSub64924,LRes42124,LRes26209,LAve94208,LZer70178,LCon69195,LMul96399,LCon80352,LMin92149],["Glo13407","Res84396","Res48242","Res44086","Con41642","Res93170","Zer78830","Add61907","Zer45272","Sub64924","Res42124","Res26209","Ave94208","Zer70178","Con69195","Mul96399","Con80352","Min92149"],Min92149,"Min92149")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.1631595, 0.2157802, 0.2631000, 0.2722000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.3306298, 0.2157936, 0.3987840, 0.1740000]]]]

Expected (Unparsed): [[[[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0.16315946999999995,0.21578018000000004,0.2631,0.2722]],[[0,0,0,0],[0,0,0,0],[0.33062976,0.21579360000000003,0.398784,0.174]]]]

Actual:   [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0.1632, 0.2158, 0.2631, 0.2722]], [[0, 0, 0, 0], [0, 0, 0, 0], [0.3307, 0.2158, 0.3988, 0.174]]]]

Expected: [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0.1632, 0.2158, 0.2631, 0.2722]], [[0, 0, 0, 0], [0, 0, 0, 0], [0.3307, 0.2158, 0.3988, 0.174]]]]