import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave1053 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave1053 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con16924 = tf.keras.layers.Input(shape=([2, 1]))
in0Add28401 = tf.keras.layers.Input(shape=([2, 2]))
in1Add28401 = tf.keras.layers.Input(shape=([2, 2]))
in0Glo76640 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con81167 = tf.keras.layers.Input(shape=([2]))

Ave1053 = keras.layers.Average(name = 'Ave1053', )([in0Ave1053,in1Ave1053])
Res50994 = keras.layers.Reshape((2, 1), name = 'Res50994', )(Ave1053)
Per64539 = keras.layers.Permute((1,2), name = 'Per64539',)(Res50994)
Con16924 = keras.layers.Concatenate(axis=2, name = 'Con16924', )([Per64539,in0Con16924])
Add28401 = keras.layers.Add(name = 'Add28401', )([in0Add28401,in1Add28401])
Min79191 = keras.layers.Minimum(name = 'Min79191', )([Con16924,Add28401])
Fla56674 = keras.layers.Flatten(name = 'Fla56674', )(Min79191)
Glo76640 = keras.layers.GlobalAveragePooling2D(name = 'Glo76640', )(in0Glo76640)
Con81167 = keras.layers.Concatenate(axis=1, name = 'Con81167', )([Glo76640,in0Con81167])
Max64358 = keras.layers.Maximum(name = 'Max64358', )([Fla56674,Con81167])
model = tf.keras.models.Model(inputs=[in0Ave1053,in1Ave1053,in0Con16924,in0Add28401,in1Add28401,in0Glo76640,in0Con81167], outputs=Max64358)
in0Ave1053 = tf.constant([[[[0.9172]], [[0.0305]]]])
in1Ave1053 = tf.constant([[[[0.4085]], [[0.6891]]]])
in0Con16924 = tf.constant([[[0.8766], [0.3022]]])
in0Add28401 = tf.constant([[[0.4427, 0.8381], [0.4313, 0.6254]]])
in1Add28401 = tf.constant([[[0.9137, 0.7228], [0.3675, 0.8788]]])
in0Glo76640 = tf.constant([[[[1.432, 1.5267], [1.4887, 1.5562]], [[1.0357, 1.8183], [1.9363, 1.5154]]]])
in0Con81167 = tf.constant([[0.4019, 0.9197]])
print (np.array2string(model.predict([in0Ave1053,in1Ave1053,in0Con16924,in0Add28401,in1Add28401,in0Glo76640,in0Con81167],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max64358.png')

LAve1053 = average_layer([[[[[0.9172]], [[0.0305]]]], [[[[0.4085]], [[0.6891]]]]], Ave1053), 
LRes50994 = reshape_layer(Ave1053, [2, 1], Res50994), 
LPer64539 = permute_layer(Res50994, 1,2, Per64539), 
LCon16924 = concatenate_layer([Per64539,[[[0.8766], [0.3022]]]], 2, Con16924), 
LAdd28401 = add_layer([[[[0.4427, 0.8381], [0.4313, 0.6254]]], [[[0.9137, 0.7228], [0.3675, 0.8788]]]], Add28401), 
LMin79191 = minimum_layer([Con16924,Add28401], Min79191), 
LFla56674 = flatten_layer(Min79191, Fla56674), 
LGlo76640 = global_average_pooling2D_layer([[[[1.432, 1.5267], [1.4887, 1.5562]], [[1.0357, 1.8183], [1.9363, 1.5154]]]], Glo76640), 
LCon81167 = concatenate_layer([Glo76640,[[0.4019, 0.9197]]], 1, Con81167), 
LMax64358 = maximum_layer([Fla56674,Con81167], Max64358), 
exec_layers([LAve1053,LRes50994,LPer64539,LCon16924,LAdd28401,LMin79191,LFla56674,LGlo76640,LCon81167,LMax64358],["Ave1053","Res50994","Per64539","Con16924","Add28401","Min79191","Fla56674","Glo76640","Con81167","Max64358"],Max64358,"Max64358")

Actual (Unparsed): [[1.4731750, 1.6041500, 0.4019000, 0.9197000]]

Expected (Unparsed): [[1.473175,1.6041499999999997,0.4019,0.9197]]

Actual:   [[1.4732, 1.6042, 0.4019, 0.9197]]

Expected: [[1.4732, 1.6042, 0.4019, 0.9197]]