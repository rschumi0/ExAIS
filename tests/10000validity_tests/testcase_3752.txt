import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro3177 = tf.keras.layers.Input(shape=([1, 1]))
in0Max5542 = tf.keras.layers.Input(shape=([2, 1]))
in1Max5542 = tf.keras.layers.Input(shape=([2, 1]))

Cro3177 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro3177', )(in0Cro3177)
Max5542 = keras.layers.Maximum(name = 'Max5542', )([in0Max5542,in1Max5542])
Res45508 = keras.layers.Reshape((2, 1, 1), name = 'Res45508', )(Max5542)
Sep40395 = keras.layers.SeparableConv2D(4, (2, 1),strides=(2, 2), padding='same', name = 'Sep40395', )(Res45508)
Res14639 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res14639', )(Sep40395)
Cro10529 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (2, 0)), name = 'Cro10529', )(Res14639)
Res53094 = keras.layers.Reshape((1, 1, 2), name = 'Res53094', )(Cro10529)
Res7596 = keras.layers.Reshape((1, 2), name = 'Res7596', )(Res53094)
Dot6876 = keras.layers.Dot(axes=(2, 1), name = 'Dot6876', )([Cro3177,Res7596])
model = tf.keras.models.Model(inputs=[in0Cro3177,in0Max5542,in1Max5542], outputs=Dot6876)
w = model.get_layer('Sep40395').get_weights() 
w[0] = np.array([[[[0.5445]]], [[[0.3445]]]])
w[1] = np.array([[[[0.9097, 0.9232, 0.5534, 0.0594]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep40395').set_weights(w) 
in0Cro3177 = tf.constant([[[1.8223]]])
in0Max5542 = tf.constant([[[0.2312], [0.0452]]])
in1Max5542 = tf.constant([[[0.3292], [0.4372]]])
print (np.array2string(model.predict([in0Cro3177,in0Max5542,in1Max5542],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot6876.png')

LCro3177 = cropping1D_layer([[[1.8223]]], 0, 0, Cro3177), 
LMax5542 = maximum_layer([[[[0.2312], [0.0452]]], [[[0.3292], [0.4372]]]], Max5542), 
LRes45508 = reshape_layer(Max5542, [2, 1, 1], Res45508), 
LSep40395 = separable_conv2D_layer(Res45508, 2, 1,[[[[[0.5445]]], [[[0.3445]]]],[[[[0.9097, 0.9232, 0.5534, 0.0594]]]]],[0, 0, 0, 0], 2, 2, true, Sep40395), 
LRes14639 = reshape_layer(Sep40395, [1, 1, 4, 1], Res14639), 
LCro10529 = cropping3D_layer(Res14639, 0, 0, 0, 0, 2, 0, Cro10529), 
LRes53094 = reshape_layer(Cro10529, [1, 1, 2], Res53094), 
LRes7596 = reshape_layer(Res53094, [1, 2], Res7596), 
LDot6876 = dot_layer(Cro3177,Res7596, 2, 1, Dot6876), 
exec_layers([LCro3177,LMax5542,LRes45508,LSep40395,LRes14639,LCro10529,LRes53094,LRes7596,LDot6876],["Cro3177","Max5542","Res45508","Sep40395","Res14639","Cro10529","Res53094","Res7596","Dot6876"],Dot6876,"Dot6876")

Actual (Unparsed): [[[0.3326557, 0.0357061]]]

Expected (Unparsed): [[[0.332655726697136,0.035706089927376]]]

Actual:   [[[0.3327, 0.0358]]]

Expected: [[[0.3327, 0.0358]]]