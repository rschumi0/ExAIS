import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST95307 = tf.keras.layers.Input(shape=([1, 2]))
in0Con20591 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave93623 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave93623 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min56915 = tf.keras.layers.Input(shape=([2, 1]))
in1Min56915 = tf.keras.layers.Input(shape=([2, 1]))
in0Con88218 = tf.keras.layers.Input(shape=([7]))

LST95307 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST95307', )(in0LST95307)
Res90236 = keras.layers.Reshape((1, 1), name = 'Res90236', )(LST95307)
Res21188 = keras.layers.Reshape((1, 1, 1), name = 'Res21188', )(Res90236)
Zer61067 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer61067', )(Res21188)
Con20591 = keras.layers.Concatenate(axis=3, name = 'Con20591', )([Zer61067,in0Con20591])
Ave93623 = keras.layers.Average(name = 'Ave93623', )([in0Ave93623,in1Ave93623])
Ave16132 = keras.layers.Average(name = 'Ave16132', )([Con20591,Ave93623])
Thr79310 = keras.layers.ThresholdedReLU(theta=1.5460049225799104, name = 'Thr79310', )(Ave16132)
Res32173 = keras.layers.Reshape((2, 4), name = 'Res32173', )(Thr79310)
Fla66626 = keras.layers.Flatten(name = 'Fla66626', )(Res32173)
Min56915 = keras.layers.Minimum(name = 'Min56915', )([in0Min56915,in1Min56915])
Glo33252 = keras.layers.GlobalMaxPool1D(name = 'Glo33252', )(Min56915)
Con88218 = keras.layers.Concatenate(axis=1, name = 'Con88218', )([Glo33252,in0Con88218])
Mul95194 = keras.layers.Multiply(name = 'Mul95194', )([Fla66626,Con88218])
model = tf.keras.models.Model(inputs=[in0LST95307,in0Con20591,in0Ave93623,in1Ave93623,in0Min56915,in1Min56915,in0Con88218], outputs=Mul95194)
w = model.get_layer('LST95307').get_weights() 
w[0] = np.array([[9, 3, 8, 9], [10, 3, 3, 6]])
w[1] = np.array([[8, 2, 4, 7]])
w[2] = np.array([7, 4, 7, 9])
model.get_layer('LST95307').set_weights(w) 
in0LST95307 = tf.constant([[[3, 5]]])
in0Con20591 = tf.constant([[[[0.0502], [0.3777]], [[0.8832], [0.8332]]]])
in0Ave93623 = tf.constant([[[[0.6434, 0.4733], [0.651, 0.1722]], [[0.9159, 0.706], [0.8643, 0.5334]]]])
in1Ave93623 = tf.constant([[[[0.5583, 0.5513], [0.9375, 0.2402]], [[0.0869, 0.6507], [0.2352, 0.2152]]]])
in0Min56915 = tf.constant([[[0.3908], [0.9261]]])
in1Min56915 = tf.constant([[[0.4061], [0.2428]]])
in0Con88218 = tf.constant([[0.6586, 0.1951, 0.558, 0.7956, 0.5233, 0.9472, 0.9925]])
print (np.array2string(model.predict([in0LST95307,in0Con20591,in0Ave93623,in1Ave93623,in0Min56915,in1Min56915,in0Con88218],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul95194.png')

LLST95307 = lstm_layer([[[3, 5]]],[[9, 3, 8, 9], [10, 3, 3, 6]],[[8, 2, 4, 7]],[7, 4, 7, 9], LST95307), 
LRes90236 = reshape_layer(LST95307, [1, 1], Res90236), 
LRes21188 = reshape_layer(Res90236, [1, 1, 1], Res21188), 
LZer61067 = zero_padding2D_layer(Res21188, 1, 0, 1, 0, Zer61067), 
LCon20591 = concatenate_layer([Zer61067,[[[[0.0502], [0.3777]], [[0.8832], [0.8332]]]]], 3, Con20591), 
LAve93623 = average_layer([[[[[0.6434, 0.4733], [0.651, 0.1722]], [[0.9159, 0.706], [0.8643, 0.5334]]]], [[[[0.5583, 0.5513], [0.9375, 0.2402]], [[0.0869, 0.6507], [0.2352, 0.2152]]]]], Ave93623), 
LAve16132 = average_layer([Con20591,Ave93623], Ave16132), 
LThr79310 = thresholded_relu_layer(Ave16132, 1.5460049225799104, Thr79310), 
LRes32173 = reshape_layer(Thr79310, [2, 4], Res32173), 
LFla66626 = flatten_layer(Res32173, Fla66626), 
LMin56915 = minimum_layer([[[[0.3908], [0.9261]]], [[[0.4061], [0.2428]]]], Min56915), 
LGlo33252 = global_max_pool1D_layer(Min56915, Glo33252), 
LCon88218 = concatenate_layer([Glo33252,[[0.6586, 0.1951, 0.558, 0.7956, 0.5233, 0.9472, 0.9925]]], 1, Con88218), 
LMul95194 = multiply_layer([Fla66626,Con88218], Mul95194), 
exec_layers([LLST95307,LRes90236,LRes21188,LZer61067,LCon20591,LAve93623,LAve16132,LThr79310,LRes32173,LFla66626,LMin56915,LGlo33252,LCon88218,LMul95194],["LST95307","Res90236","Res21188","Zer61067","Con20591","Ave93623","Ave16132","Thr79310","Res32173","Fla66626","Min56915","Glo33252","Con88218","Mul95194"],Mul95194,"Mul95194")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0]]

Actual:   [[0, 0, 0, 0, 0, 0, 0, 0]]

Expected: [[0, 0, 0, 0, 0, 0, 0, 0]]