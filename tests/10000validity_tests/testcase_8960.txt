import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro57387 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Min82783 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min82783 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con97883 = tf.keras.layers.Input(shape=([1, 2, 1]))

Cro57387 = keras.layers.Cropping2D(cropping=((2, 0), (2, 0)), name = 'Cro57387', )(in0Cro57387)
Mas25316 = keras.layers.Masking(mask_value=1, name = 'Mas25316', )(Cro57387)
Zer83945 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer83945', )(Mas25316)
Min82783 = keras.layers.Minimum(name = 'Min82783', )([in0Min82783,in1Min82783])
Con97883 = keras.layers.Concatenate(axis=3, name = 'Con97883', )([Min82783,in0Con97883])
Ave31721 = keras.layers.Average(name = 'Ave31721', )([Zer83945,Con97883])
Res4476 = keras.layers.Reshape((1, 6), name = 'Res4476', )(Ave31721)
Per61884 = keras.layers.Permute((2,1), name = 'Per61884',)(Res4476)
Res50125 = keras.layers.Reshape((6, 1, 1), name = 'Res50125', )(Per61884)
Res82477 = keras.layers.Reshape((6, 1, 1, 1), name = 'Res82477', )(Res50125)
Up_67357 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_67357', )(Res82477)
model = tf.keras.models.Model(inputs=[in0Cro57387,in0Min82783,in1Min82783,in0Con97883], outputs=Up_67357)
in0Cro57387 = tf.constant([[[[1.2644, 1.217, 1.3973], [1.1522, 1.3735, 1.1622], [1.5302, 1.6592, 1.133]], [[1.5304, 1.3853, 1.2893], [1.0555, 1.3831, 1.9872], [1.4248, 1.5561, 1.3498]], [[1.2076, 1.5552, 1.0796], [1.319, 1.8379, 1.611], [1.9002, 1.5478, 1.3274]]]])
in0Min82783 = tf.constant([[[[0.5212, 0.632], [0.591, 0.3792]]]])
in1Min82783 = tf.constant([[[[0.3067, 0.7154], [0.2483, 0.2858]]]])
in0Con97883 = tf.constant([[[[0.092], [0.4816]]]])
print (np.array2string(model.predict([in0Cro57387,in0Min82783,in1Min82783,in0Con97883],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_67357.png')

LCro57387 = cropping2D_layer([[[[1.2644, 1.217, 1.3973], [1.1522, 1.3735, 1.1622], [1.5302, 1.6592, 1.133]], [[1.5304, 1.3853, 1.2893], [1.0555, 1.3831, 1.9872], [1.4248, 1.5561, 1.3498]], [[1.2076, 1.5552, 1.0796], [1.319, 1.8379, 1.611], [1.9002, 1.5478, 1.3274]]]], 2, 0, 2, 0, Cro57387), 
LMas25316 = masking_layer(Cro57387, 1, Mas25316), 
LZer83945 = zero_padding2D_layer(Mas25316, 0, 0, 1, 0, Zer83945), 
LMin82783 = minimum_layer([[[[[0.5212, 0.632], [0.591, 0.3792]]]], [[[[0.3067, 0.7154], [0.2483, 0.2858]]]]], Min82783), 
LCon97883 = concatenate_layer([Min82783,[[[[0.092], [0.4816]]]]], 3, Con97883), 
LAve31721 = average_layer([Zer83945,Con97883], Ave31721), 
LRes4476 = reshape_layer(Ave31721, [1, 6], Res4476), 
LPer61884 = permute_layer(Res4476, 2,1, Per61884), 
LRes50125 = reshape_layer(Per61884, [6, 1, 1], Res50125), 
LRes82477 = reshape_layer(Res50125, [6, 1, 1, 1], Res82477), 
LUp_67357 = up_sampling3D_layer(Res82477, 1, 1, 2, Up_67357), 
exec_layers([LCro57387,LMas25316,LZer83945,LMin82783,LCon97883,LAve31721,LRes4476,LPer61884,LRes50125,LRes82477,LUp_67357],["Cro57387","Mas25316","Zer83945","Min82783","Con97883","Ave31721","Res4476","Per61884","Res50125","Res82477","Up_67357"],Up_67357,"Up_67357")

Actual (Unparsed): [[[[[0.1533500], [0.1533500]]], [[[0.3160000], [0.3160000]]], [[[0.0460000], [0.0460000]]], [[[1.0742500], [1.0742500]]], [[[0.9168000], [0.9168000]]], [[[0.9045000], [0.9045000]]]]]

Expected (Unparsed): [[[[[0.15335],[0.15335]]],[[[0.316],[0.316]]],[[[0.046],[0.046]]],[[[1.07425],[1.07425]]],[[[0.9168000000000001],[0.9168000000000001]]],[[[0.9045],[0.9045]]]]]

Actual:   [[[[[0.1534], [0.1534]]], [[[0.316], [0.316]]], [[[0.046], [0.046]]], [[[1.0743], [1.0743]]], [[[0.9168], [0.9168]]], [[[0.9045], [0.9045]]]]]

Expected: [[[[[0.1534], [0.1534]]], [[[0.316], [0.316]]], [[[0.046], [0.046]]], [[[1.0743], [1.0743]]], [[[0.9169], [0.9169]]], [[[0.9045], [0.9045]]]]]