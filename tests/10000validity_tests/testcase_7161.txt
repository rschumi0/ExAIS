import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub83794 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in1Sub83794 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))

Sub83794 = keras.layers.Subtract(name = 'Sub83794', )([in0Sub83794,in1Sub83794])
Res51470 = keras.layers.Reshape((2, 2, 6), name = 'Res51470', )(Sub83794)
Res95229 = keras.layers.Reshape((2, 12), name = 'Res95229', )(Res51470)
Sim9299 = keras.layers.SimpleRNN(1,name = 'Sim9299', )(Res95229)
model = tf.keras.models.Model(inputs=[in0Sub83794,in1Sub83794], outputs=Sim9299)
w = model.get_layer('Sim9299').get_weights() 
w[0] = np.array([[9], [6], [1], [7], [1], [7], [8], [2], [8], [7], [1], [7]])
w[1] = np.array([[1]])
w[2] = np.array([10])
model.get_layer('Sim9299').set_weights(w) 
in0Sub83794 = tf.constant([[[[[0.5204, 0.1128], [0.6497, 0.5695], [0.6797, 0.1075]], [[0.1606, 0.6002], [0.5507, 0.4176], [0.3245, 0.4203]]], [[[0.4222, 0.8129], [0.5272, 0.7145], [0.1017, 0.4798]], [[0.2579, 0.398], [0.0329, 0.6251], [0.8541, 0.6964]]]]])
in1Sub83794 = tf.constant([[[[[0.3364, 0.9785], [0.7184, 0.0915], [0.4069, 0.9709]], [[0.2156, 0.5081], [0.9195, 0.942], [0.9435, 0.5766]]], [[[0.102, 0.3287], [0.8406, 0.8008], [0.9085, 0.4244]], [[0.6361, 0.9855], [0.2956, 0.9587], [0.4819, 0.3312]]]]])
print (np.array2string(model.predict([in0Sub83794,in1Sub83794],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim9299.png')

LSub83794 = subtract_layer([[[[[0.5204, 0.1128], [0.6497, 0.5695], [0.6797, 0.1075]], [[0.1606, 0.6002], [0.5507, 0.4176], [0.3245, 0.4203]]], [[[0.4222, 0.8129], [0.5272, 0.7145], [0.1017, 0.4798]], [[0.2579, 0.398], [0.0329, 0.6251], [0.8541, 0.6964]]]]], [[[[[0.3364, 0.9785], [0.7184, 0.0915], [0.4069, 0.9709]], [[0.2156, 0.5081], [0.9195, 0.942], [0.9435, 0.5766]]], [[[0.102, 0.3287], [0.8406, 0.8008], [0.9085, 0.4244]], [[0.6361, 0.9855], [0.2956, 0.9587], [0.4819, 0.3312]]]]], Sub83794), 
LRes51470 = reshape_layer(Sub83794, [2, 2, 6], Res51470), 
LRes95229 = reshape_layer(Res51470, [2, 12], Res95229), 
LSim9299 = simple_rnn_layer(Res95229,[[9], [6], [1], [7], [1], [7], [8], [2], [8], [7], [1], [7]],[[1]],[10], Sim9299), 
exec_layers([LSub83794,LRes51470,LRes95229,LSim9299],["Sub83794","Res51470","Res95229","Sim9299"],Sim9299,"Sim9299")

Actual (Unparsed): [[0.9999996]]

Expected (Unparsed): [[0.9999996228563663]]

Actual:   [[1]]

Expected: [[1]]