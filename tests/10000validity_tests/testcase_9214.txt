import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max45217 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Max45217 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Con44402 = tf.keras.layers.Input(shape=([2, 2]))

Max45217 = keras.layers.Maximum(name = 'Max45217', )([in0Max45217,in1Max45217])
ELU14815 = keras.layers.ELU(alpha=-7.801272993600302, name = 'ELU14815', )(Max45217)
Res69549 = keras.layers.Reshape((1, 2, 2), name = 'Res69549', )(ELU14815)
Res33283 = keras.layers.Reshape((1, 4), name = 'Res33283', )(Res69549)
Fla8947 = keras.layers.Flatten(name = 'Fla8947', )(Res33283)
Con44402 = keras.layers.Conv1D(4, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con44402', )(in0Con44402)
Glo32542 = keras.layers.GlobalMaxPool1D(name = 'Glo32542', )(Con44402)
Mul54108 = keras.layers.Multiply(name = 'Mul54108', )([Fla8947,Glo32542])
Thr49476 = keras.layers.ThresholdedReLU(theta=3.6856963082286396, name = 'Thr49476', )(Mul54108)
model = tf.keras.models.Model(inputs=[in0Max45217,in1Max45217,in0Con44402], outputs=Thr49476)
w = model.get_layer('Con44402').get_weights() 
w[0] = np.array([[[0.4736, 0.4373, 0.2897, 0.1578], [0.0147, 0.9022, 0.118, 0.6834]], [[0.9145, 0.5224, 0.2828, 0.6375], [0.2783, 0.8638, 0.3113, 0.8648]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con44402').set_weights(w) 
in0Max45217 = tf.constant([[[[[0.2875, 0.9202]], [[0.8784, 0.2752]]]]])
in1Max45217 = tf.constant([[[[[0.6864, 0.4089]], [[0.216, 0.2846]]]]])
in0Con44402 = tf.constant([[[0.7492, 0.1128], [0.9448, 0.23]]])
print (np.array2string(model.predict([in0Max45217,in1Max45217,in0Con44402],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr49476.png')

LMax45217 = maximum_layer([[[[[[0.2875, 0.9202]], [[0.8784, 0.2752]]]]], [[[[[0.6864, 0.4089]], [[0.216, 0.2846]]]]]], Max45217), 
LELU14815 = elu_layer(Max45217, -7.801272993600302, ELU14815), 
LRes69549 = reshape_layer(ELU14815, [1, 2, 2], Res69549), 
LRes33283 = reshape_layer(Res69549, [1, 4], Res33283), 
LFla8947 = flatten_layer(Res33283, Fla8947), 
LCon44402 = conv1D_layer([[[0.7492, 0.1128], [0.9448, 0.23]]], 2,[[[0.4736, 0.4373, 0.2897, 0.1578], [0.0147, 0.9022, 0.118, 0.6834]], [[0.9145, 0.5224, 0.2828, 0.6375], [0.2783, 0.8638, 0.3113, 0.8648]]],[0, 0, 0, 0], 1, false, 1, Con44402), 
LGlo32542 = global_max_pool1D_layer(Con44402, Glo32542), 
LMul54108 = multiply_layer([Fla8947,Glo32542], Mul54108), 
LThr49476 = thresholded_relu_layer(Mul54108, 3.6856963082286396, Thr49476), 
exec_layers([LMax45217,LELU14815,LRes69549,LRes33283,LFla8947,LCon44402,LGlo32542,LMul54108,LThr49476],["Max45217","ELU14815","Res69549","Res33283","Fla8947","Con44402","Glo32542","Mul54108","Thr49476"],Thr49476,"Thr49476")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0,0,0,0]]

Actual:   [[0, 0, 0, 0]]

Expected: [[0, 0, 0, 0]]