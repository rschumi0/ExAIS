import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer11952 = tf.keras.layers.Input(shape=([3, 2, 3]))
in0Sub5301 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Sub5301 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Con7307 = tf.keras.layers.Input(shape=([2, 6, 4, 2]))

Zer11952 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer11952', )(in0Zer11952)
Res68171 = keras.layers.Reshape((5, 4, 3, 1), name = 'Res68171', )(Zer11952)
Con23835 = keras.layers.Conv3D(4, (2, 2, 1),strides=(7, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con23835', )(Res68171)
Zer84757 = keras.layers.ZeroPadding3D(padding=((1, 0), (2, 0), (1, 0)), name = 'Zer84757', )(Con23835)
Sub5301 = keras.layers.Subtract(name = 'Sub5301', )([in0Sub5301,in1Sub5301])
Zer24554 = keras.layers.ZeroPadding3D(padding=((0, 0), (4, 0), (2, 0)), name = 'Zer24554', )(Sub5301)
Con7307 = keras.layers.Concatenate(axis=4, name = 'Con7307', )([Zer24554,in0Con7307])
Sub87216 = keras.layers.Subtract(name = 'Sub87216', )([Zer84757,Con7307])
model = tf.keras.models.Model(inputs=[in0Zer11952,in0Sub5301,in1Sub5301,in0Con7307], outputs=Sub87216)
w = model.get_layer('Con23835').get_weights() 
w[0] = np.array([[[[[0.3001, 0.982, 0.39, 0.2754]]], [[[0.2395, 0.0928, 0.726, 0.664]]]], [[[[0.044, 0.0631, 0.2748, 0.0818]]], [[[0.6164, 0.1026, 0.6312, 0.436]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con23835').set_weights(w) 
in0Zer11952 = tf.constant([[[[1.181, 1.0237, 1.4455], [1.8865, 1.8694, 1.6596]], [[1.8003, 1.1329, 1.2084], [1.7367, 1.7294, 1.1365]], [[1.4335, 1.1717, 1.8794], [1.446, 1.8086, 1.6246]]]])
in0Sub5301 = tf.constant([[[[[0.934, 0.2365], [0.6816, 0.5385]], [[0.2899, 0.7249], [0.2697, 0.6465]]], [[[0.1107, 0.8478], [0.1197, 0.4636]], [[0.0197, 0.6296], [0.1665, 0.0176]]]]])
in1Sub5301 = tf.constant([[[[[0.9913, 0.8545], [0.19, 0.9568]], [[0.7092, 0.4972], [0.2579, 0.2187]]], [[[0.7746, 0.8633], [0.4342, 0.6421]], [[0.6675, 0.5437], [0.6318, 0.2633]]]]])
in0Con7307 = tf.constant([[[[[0.4854, 0.3369], [0.924, 0.8806], [0.426, 0.9745], [0.5468, 0.3743]], [[0.8059, 0.3301], [0.3536, 0.6028], [0.5434, 0.4883], [0.0873, 0.242]], [[0.583, 0.2619], [0.6455, 0.8016], [0.3566, 0.6346], [0.7043, 0.1651]], [[0.601, 0.7905], [0.669, 0.5857], [0.5266, 0.4512], [0.8051, 0.9825]], [[0.6147, 0.3717], [0.948, 0.4065], [0.3859, 0.0144], [0.0191, 0.1009]], [[0.3233, 0.6157], [0.6882, 0.6674], [0.7637, 0.086], [0.9115, 0.4691]]], [[[0.9758, 0.4448], [0.7483, 0.5484], [0.8321, 0.7816], [0.8142, 0.0203]], [[0.4526, 0.0541], [0.9634, 0.113], [0.9481, 0.3888], [0.3081, 0.7716]], [[0.9232, 0.9319], [0.4837, 0.0125], [0.7137, 0.7144], [0.1442, 0.0255]], [[0.4264, 0.4409], [0.036, 0.3554], [0.7259, 0.589], [0.6364, 0.3615]], [[0.9711, 0.7161], [0.2696, 0.558], [0.7403, 0.4087], [0.8131, 0.3615]], [[0.0059, 0.8823], [0.5968, 0.2419], [0.2201, 0.8419], [0.8608, 0.2589]]]]])
print (np.array2string(model.predict([in0Zer11952,in0Sub5301,in1Sub5301,in0Con7307],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub87216.png')

LZer11952 = zero_padding2D_layer([[[[1.181, 1.0237, 1.4455], [1.8865, 1.8694, 1.6596]], [[1.8003, 1.1329, 1.2084], [1.7367, 1.7294, 1.1365]], [[1.4335, 1.1717, 1.8794], [1.446, 1.8086, 1.6246]]]], 1, 1, 1, 1, Zer11952), 
LRes68171 = reshape_layer(Zer11952, [5, 4, 3, 1], Res68171), 
LCon23835 = conv3D_layer(Res68171, 2, 2, 1,[[[[[0.3001, 0.982, 0.39, 0.2754]]], [[[0.2395, 0.0928, 0.726, 0.664]]]], [[[[0.044, 0.0631, 0.2748, 0.0818]]], [[[0.6164, 0.1026, 0.6312, 0.436]]]]],[0, 0, 0, 0], 7, 1, 1, true, 1, 1, 1, Con23835), 
LZer84757 = zero_padding3D_layer(Con23835, 1, 0, 2, 0, 1, 0, Zer84757), 
LSub5301 = subtract_layer([[[[[0.934, 0.2365], [0.6816, 0.5385]], [[0.2899, 0.7249], [0.2697, 0.6465]]], [[[0.1107, 0.8478], [0.1197, 0.4636]], [[0.0197, 0.6296], [0.1665, 0.0176]]]]], [[[[[0.9913, 0.8545], [0.19, 0.9568]], [[0.7092, 0.4972], [0.2579, 0.2187]]], [[[0.7746, 0.8633], [0.4342, 0.6421]], [[0.6675, 0.5437], [0.6318, 0.2633]]]]], Sub5301), 
LZer24554 = zero_padding3D_layer(Sub5301, 0, 0, 4, 0, 2, 0, Zer24554), 
LCon7307 = concatenate_layer([Zer24554,[[[[[0.4854, 0.3369], [0.924, 0.8806], [0.426, 0.9745], [0.5468, 0.3743]], [[0.8059, 0.3301], [0.3536, 0.6028], [0.5434, 0.4883], [0.0873, 0.242]], [[0.583, 0.2619], [0.6455, 0.8016], [0.3566, 0.6346], [0.7043, 0.1651]], [[0.601, 0.7905], [0.669, 0.5857], [0.5266, 0.4512], [0.8051, 0.9825]], [[0.6147, 0.3717], [0.948, 0.4065], [0.3859, 0.0144], [0.0191, 0.1009]], [[0.3233, 0.6157], [0.6882, 0.6674], [0.7637, 0.086], [0.9115, 0.4691]]], [[[0.9758, 0.4448], [0.7483, 0.5484], [0.8321, 0.7816], [0.8142, 0.0203]], [[0.4526, 0.0541], [0.9634, 0.113], [0.9481, 0.3888], [0.3081, 0.7716]], [[0.9232, 0.9319], [0.4837, 0.0125], [0.7137, 0.7144], [0.1442, 0.0255]], [[0.4264, 0.4409], [0.036, 0.3554], [0.7259, 0.589], [0.6364, 0.3615]], [[0.9711, 0.7161], [0.2696, 0.558], [0.7403, 0.4087], [0.8131, 0.3615]], [[0.0059, 0.8823], [0.5968, 0.2419], [0.2201, 0.8419], [0.8608, 0.2589]]]]]], 4, Con7307), 
LSub87216 = subtract_layer(Zer84757,Con7307, Sub87216), 
exec_layers([LZer11952,LRes68171,LCon23835,LZer84757,LSub5301,LZer24554,LCon7307,LSub87216],["Zer11952","Res68171","Con23835","Zer84757","Sub5301","Zer24554","Con7307","Sub87216"],Sub87216,"Sub87216")

Actual (Unparsed): [[[[[0.0000000, 0.0000000, -0.4854000, -0.3369000], [0.0000000, 0.0000000, -0.9240000, -0.8806000], [0.0000000, 0.0000000, -0.4260000, -0.9745000], [0.0000000, 0.0000000, -0.5468000, -0.3743000]], [[0.0000000, 0.0000000, -0.8059000, -0.3301000], [0.0000000, 0.0000000, -0.3536000, -0.6028000], [0.0000000, 0.0000000, -0.5434000, -0.4883000], [0.0000000, 0.0000000, -0.0873000, -0.2420000]], [[0.0000000, 0.0000000, -0.5830000, -0.2619000], [0.0000000, 0.0000000, -0.6455000, -0.8016000], [0.0000000, 0.0000000, -0.3566000, -0.6346000], [0.0000000, 0.0000000, -0.7043000, -0.1651000]], [[0.0000000, 0.0000000, -0.6010000, -0.7905000], [0.0000000, 0.0000000, -0.6690000, -0.5857000], [0.0000000, 0.0000000, -0.5266000, -0.4512000], [0.0000000, 0.0000000, -0.8051000, -0.9825000]], [[0.0000000, 0.0000000, -0.6147000, -0.3717000], [0.0000000, 0.0000000, -0.9480000, -0.4065000], [0.0573000, 0.6180000, -0.3859000, -0.0144000], [-0.4916000, 0.4183000, -0.0191000, -0.1009000]], [[0.0000000, 0.0000000, -0.3233000, -0.6157000], [0.0000000, 0.0000000, -0.6882000, -0.6674000], [0.4193000, -0.2277000, -0.7637000, -0.0860000], [-0.0118000, -0.4278000, -0.9115000, -0.4691000]]], [[[0.0000000, 0.0000000, -0.9758000, -0.4448000], [0.0000000, 0.0000000, -0.7483000, -0.5484000], [0.0000000, 0.0000000, -0.8321000, -0.7816000], [0.0000000, 0.0000000, -0.8142000, -0.0203000]], [[0.0000000, 0.0000000, -0.4526000, -0.0541000], [0.0000000, 0.0000000, -0.9634000, -0.1130000], [0.0000000, 0.0000000, -0.9481000, -0.3888000], [0.0000000, 0.0000000, -0.3081000, -0.7716000]], [[0.0000000, 0.0000000, -0.9232000, -0.9319000], [0.7279684, 0.1211706, 0.2617472, 0.5024160], [0.6310087, 0.1050316, -0.0675406, -0.2680668], [0.8910062, 0.1483083, 0.7681996, 0.6047380]], [[0.0000000, 0.0000000, -0.4264000, -0.4409000], [1.2148026, 0.2680760, 1.4792976, 0.5637198], [1.1973410, 0.2563959, 0.7353781, 0.3097971], [1.0865795, 0.2614860, 0.8083630, 0.4803275]], [[0.0000000, 0.0000000, -0.9711000, -0.7161000], [0.0830060, 0.1190382, 0.2488102, -0.4036843], [0.7461536, 0.1334592, -0.2265889, -0.2557831], [0.3875224, 0.2832207, -0.3570419, -0.2257447]], [[0.0000000, 0.0000000, -0.0059000, -0.8823000], [0.0000000, 0.0000000, -0.5968000, -0.2419000], [0.6478000, -0.0859000, -0.2201000, -0.8419000], [0.4653000, 0.2457000, -0.8608000, -0.2589000]]]]]

Expected (Unparsed): [[[[[0,0,-0.4854,-0.3369],[0,0,-0.924,-0.8806],[0,0,-0.426,-0.9745],[0,0,-0.5468,-0.3743]],[[0,0,-0.8059,-0.3301],[0,0,-0.3536,-0.6028],[0,0,-0.5434,-0.4883],[0,0,-0.0873,-0.242]],[[0,0,-0.583,-0.2619],[0,0,-0.6455,-0.8016],[0,0,-0.3566,-0.6346],[0,0,-0.7043,-0.1651]],[[0,0,-0.601,-0.7905],[0,0,-0.669,-0.5857],[0,0,-0.5266,-0.4512],[0,0,-0.8051,-0.9825]],[[0,0,-0.6147,-0.3717],[0,0,-0.948,-0.4065],[0.05729999999999991,0.6180000000000001,-0.3859,-0.0144],[-0.4916,0.4183,-0.0191,-0.1009]],[[0,0,-0.3233,-0.6157],[0,0,-0.6882,-0.6674],[0.41930000000000006,-0.2277,-0.7637,-0.086],[-0.011799999999999977,-0.42779999999999996,-0.9115,-0.4691]]],[[[0,0,-0.9758,-0.4448],[0,0,-0.7483,-0.5484],[0,0,-0.8321,-0.7816],[0,0,-0.8142,-0.0203]],[[0,0,-0.4526,-0.0541],[0,0,-0.9634,-0.113],[0,0,-0.9481,-0.3888],[0,0,-0.3081,-0.7716]],[[0,0,-0.9232,-0.9319],[0.7279684,0.1211706,0.26174719999999996,0.5024160000000001],[0.63100868,0.10503162,-0.06754055999999997,-0.2680668],[0.8910062,0.1483083,0.7681996,0.604738]],[[0,0,-0.4264,-0.4409],[1.2148025999999998,0.268076,1.4792976,0.5637198000000001],[1.19734096,0.25639591,0.7353780400000001,0.30979705999999996],[1.0865794399999997,0.26148601,0.8083629200000001,0.48032749999999996]],[[0,0,-0.9711,-0.7161],[0.083006,0.11903815000000001,0.24881020000000004,-0.40368430000000005],[0.7461536,0.13345913999999998,-0.22658888,-0.25578308000000005],[0.3875224,0.28322076,-0.35704192000000007,-0.22574471999999998]],[[0,0,-0.0059,-0.8823],[0.0,0.0,-0.5968,-0.2419],[0.6477999999999999,-0.08590000000000009,-0.2201,-0.8419],[0.46530000000000005,0.24569999999999997,-0.8608,-0.2589]]]]]

Actual:   [[[[[0, 0, -0.4854, -0.3369], [0, 0, -0.924, -0.8806], [0, 0, -0.426, -0.9745], [0, 0, -0.5468, -0.3743]], [[0, 0, -0.8059, -0.3301], [0, 0, -0.3536, -0.6028], [0, 0, -0.5434, -0.4883], [0, 0, -0.0873, -0.242]], [[0, 0, -0.583, -0.2619], [0, 0, -0.6455, -0.8016], [0, 0, -0.3566, -0.6346], [0, 0, -0.7043, -0.1651]], [[0, 0, -0.601, -0.7905], [0, 0, -0.669, -0.5857], [0, 0, -0.5266, -0.4512], [0, 0, -0.8051, -0.9825]], [[0, 0, -0.6147, -0.3717], [0, 0, -0.948, -0.4065], [0.0573, 0.618, -0.3859, -0.0144], [-0.4916, 0.4183, -0.0191, -0.1009]], [[0, 0, -0.3233, -0.6157], [0, 0, -0.6882, -0.6674], [0.4193, -0.2277, -0.7637, -0.086], [-0.0118, -0.4278, -0.9115, -0.4691]]], [[[0, 0, -0.9758, -0.4448], [0, 0, -0.7483, -0.5484], [0, 0, -0.8321, -0.7816], [0, 0, -0.8142, -0.0203]], [[0, 0, -0.4526, -0.0541], [0, 0, -0.9634, -0.113], [0, 0, -0.9481, -0.3888], [0, 0, -0.3081, -0.7716]], [[0, 0, -0.9232, -0.9319], [0.728, 0.1212, 0.2618, 0.5025], [0.6311, 0.1051, -0.0675, -0.268], [0.8911, 0.1484, 0.7682, 0.6048]], [[0, 0, -0.4264, -0.4409], [1.2149, 0.2681, 1.4793, 0.5638], [1.1974, 0.2564, 0.7354, 0.3098], [1.0866, 0.2615, 0.8084, 0.4804]], [[0, 0, -0.9711, -0.7161], [0.0831, 0.1191, 0.2489, -0.4036], [0.7462, 0.1335, -0.2265, -0.2557], [0.3876, 0.2833, -0.357, -0.2257]], [[0, 0, -0.0059, -0.8823], [0, 0, -0.5968, -0.2419], [0.6478, -0.0859, -0.2201, -0.8419], [0.4653, 0.2457, -0.8608, -0.2589]]]]]

Expected: [[[[[0, 0, -0.4854, -0.3369], [0, 0, -0.924, -0.8806], [0, 0, -0.426, -0.9745], [0, 0, -0.5468, -0.3743]], [[0, 0, -0.8059, -0.3301], [0, 0, -0.3536, -0.6028], [0, 0, -0.5434, -0.4883], [0, 0, -0.0873, -0.242]], [[0, 0, -0.583, -0.2619], [0, 0, -0.6455, -0.8016], [0, 0, -0.3566, -0.6346], [0, 0, -0.7043, -0.1651]], [[0, 0, -0.601, -0.7905], [0, 0, -0.669, -0.5857], [0, 0, -0.5266, -0.4512], [0, 0, -0.8051, -0.9825]], [[0, 0, -0.6147, -0.3717], [0, 0, -0.948, -0.4065], [0.0573, 0.6181, -0.3859, -0.0144], [-0.4916, 0.4183, -0.0191, -0.1009]], [[0, 0, -0.3233, -0.6157], [0, 0, -0.6882, -0.6674], [0.4194, -0.2277, -0.7637, -0.086], [-0.0117, -0.4277, -0.9115, -0.4691]]], [[[0, 0, -0.9758, -0.4448], [0, 0, -0.7483, -0.5484], [0, 0, -0.8321, -0.7816], [0, 0, -0.8142, -0.0203]], [[0, 0, -0.4526, -0.0541], [0, 0, -0.9634, -0.113], [0, 0, -0.9481, -0.3888], [0, 0, -0.3081, -0.7716]], [[0, 0, -0.9232, -0.9319], [0.728, 0.1212, 0.2618, 0.5025], [0.6311, 0.1051, -0.0675, -0.268], [0.8911, 0.1484, 0.7682, 0.6048]], [[0, 0, -0.4264, -0.4409], [1.2149, 0.2681, 1.4793, 0.5638], [1.1974, 0.2564, 0.7354, 0.3098], [1.0866, 0.2615, 0.8084, 0.4804]], [[0, 0, -0.9711, -0.7161], [0.0831, 0.1191, 0.2489, -0.4036], [0.7462, 0.1335, -0.2265, -0.2557], [0.3876, 0.2833, -0.357, -0.2257]], [[0, 0, -0.0059, -0.8823], [0, 0, -0.5968, -0.2419], [0.6478, -0.0859, -0.2201, -0.8419], [0.4654, 0.2457, -0.8608, -0.2589]]]]]