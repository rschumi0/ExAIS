import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add28359 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Add28359 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Add28359 = keras.layers.Add(name = 'Add28359', )([in0Add28359,in1Add28359])
Res5849 = keras.layers.Reshape((1, 1, 4), name = 'Res5849', )(Add28359)
Res15591 = keras.layers.Reshape((1, 4), name = 'Res15591', )(Res5849)
Ave60072 = keras.layers.AveragePooling1D(pool_size=(1), strides=(5), padding='same', name = 'Ave60072', )(Res15591)
Res5401 = keras.layers.Reshape((1, 4, 1), name = 'Res5401', )(Ave60072)
Sep9851 = keras.layers.SeparableConv2D(4, (1, 2),strides=(1, 1), padding='valid', name = 'Sep9851', )(Res5401)
model = tf.keras.models.Model(inputs=[in0Add28359,in1Add28359], outputs=Sep9851)
w = model.get_layer('Sep9851').get_weights() 
w[0] = np.array([[[[0.5926]], [[0.987]]]])
w[1] = np.array([[[[0.0692, 0.9365, 0.1124, 0.2004]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep9851').set_weights(w) 
in0Add28359 = tf.constant([[[[[0.2858, 0.9974], [0.4983, 0.4602]]]]])
in1Add28359 = tf.constant([[[[[0.5175, 0.7205], [0.1747, 0.4273]]]]])
print (np.array2string(model.predict([in0Add28359,in1Add28359],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep9851.png')

LAdd28359 = add_layer([[[[[[0.2858, 0.9974], [0.4983, 0.4602]]]]], [[[[[0.5175, 0.7205], [0.1747, 0.4273]]]]]], Add28359), 
LRes5849 = reshape_layer(Add28359, [1, 1, 4], Res5849), 
LRes15591 = reshape_layer(Res5849, [1, 4], Res15591), 
LAve60072 = average_pooling1D_layer(Res15591, 1, 5, true, Ave60072), 
LRes5401 = reshape_layer(Ave60072, [1, 4, 1], Res5401), 
LSep9851 = separable_conv2D_layer(Res5401, 1, 2,[[[[[0.5926]], [[0.987]]]],[[[[0.0692, 0.9365, 0.1124, 0.2004]]]]],[0, 0, 0, 0], 1, 1, false, Sep9851), 
exec_layers([LAdd28359,LRes5849,LRes15591,LAve60072,LRes5401,LSep9851],["Add28359","Res5849","Res15591","Ave60072","Res5401","Sep9851"],Sep9851,"Sep9851")

Actual (Unparsed): [[[[0.1502749, 2.0337061, 0.2440882, 0.4351892], [0.1164137, 1.5754538, 0.1890881, 0.3371286], [0.0882149, 1.1938336, 0.1432855, 0.2554664]]]]

Expected (Unparsed): [[[[0.15027491929599998,2.03370609712,0.24408816371199998,0.435189217152],[0.11641367496800001,1.57545385271,0.189088107896,0.33712861941600003],[0.08821493516000001,1.19383362395,0.14328553052,0.25546637291999996]]]]

Actual:   [[[[0.1503, 2.0338, 0.2441, 0.4352], [0.1165, 1.5755, 0.1891, 0.3372], [0.0883, 1.1939, 0.1433, 0.2555]]]]

Expected: [[[[0.1503, 2.0338, 0.2441, 0.4352], [0.1165, 1.5755, 0.1891, 0.3372], [0.0883, 1.1939, 0.1433, 0.2555]]]]