import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave49234 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave49234 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con98 = tf.keras.layers.Input(shape=([14]))
in0Min92197 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Min92197 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Glo1333 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Con68800 = tf.keras.layers.Input(shape=([14]))

Ave49234 = keras.layers.Average(name = 'Ave49234', )([in0Ave49234,in1Ave49234])
Res21207 = keras.layers.Reshape((1, 2), name = 'Res21207', )(Ave49234)
Fla59099 = keras.layers.Flatten(name = 'Fla59099', )(Res21207)
Con98 = keras.layers.Concatenate(axis=1, name = 'Con98', )([Fla59099,in0Con98])
Min92197 = keras.layers.Minimum(name = 'Min92197', )([in0Min92197,in1Min92197])
Res11299 = keras.layers.Reshape((2, 2, 4), name = 'Res11299', )(Min92197)
Res66153 = keras.layers.Reshape((2, 8), name = 'Res66153', )(Res11299)
Fla39908 = keras.layers.Flatten(name = 'Fla39908', )(Res66153)
Glo1333 = keras.layers.GlobalMaxPool3D(name = 'Glo1333', )(in0Glo1333)
Con68800 = keras.layers.Concatenate(axis=1, name = 'Con68800', )([Glo1333,in0Con68800])
Add84177 = keras.layers.Add(name = 'Add84177', )([Fla39908,Con68800])
Max41139 = keras.layers.Maximum(name = 'Max41139', )([Con98,Add84177])
model = tf.keras.models.Model(inputs=[in0Ave49234,in1Ave49234,in0Con98,in0Min92197,in1Min92197,in0Glo1333,in0Con68800], outputs=Max41139)
in0Ave49234 = tf.constant([[[[0.2547], [0.6036]]]])
in1Ave49234 = tf.constant([[[[0.1132], [0.5181]]]])
in0Con98 = tf.constant([[0.3455, 0.1704, 0.207, 0.96, 0.2328, 0.3761, 0.7986, 0.2867, 0.8198, 0.338, 0.617, 0.5046, 0.6927, 0.8812]])
in0Min92197 = tf.constant([[[[[0.6073, 0.44], [0.3757, 0.6782]], [[0.6033, 0.2928], [0.4186, 0.8427]]], [[[0.6049, 0.2889], [0.4549, 0.5451]], [[0.4259, 0.6496], [0.6467, 0.9781]]]]])
in1Min92197 = tf.constant([[[[[0.0571, 0.5626], [0.011, 0.9755]], [[0.9851, 0.5031], [0.7339, 0.4422]]], [[[0.9166, 0.3257], [0.1863, 0.0969]], [[0.7201, 0.6407], [0.6312, 0.4182]]]]])
in0Glo1333 = tf.constant([[[[[1.0485, 1.0882]], [[1.476, 1.1055]]]]])
in0Con68800 = tf.constant([[0.3276, 0.0128, 0.5512, 0.0424, 0.2929, 0.724, 0.705, 0.9755, 0.7971, 0.3308, 0.706, 0.4751, 0.215, 0.8949]])
print (np.array2string(model.predict([in0Ave49234,in1Ave49234,in0Con98,in0Min92197,in1Min92197,in0Glo1333,in0Con68800],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max41139.png')

LAve49234 = average_layer([[[[[0.2547], [0.6036]]]], [[[[0.1132], [0.5181]]]]], Ave49234), 
LRes21207 = reshape_layer(Ave49234, [1, 2], Res21207), 
LFla59099 = flatten_layer(Res21207, Fla59099), 
LCon98 = concatenate_layer([Fla59099,[[0.3455, 0.1704, 0.207, 0.96, 0.2328, 0.3761, 0.7986, 0.2867, 0.8198, 0.338, 0.617, 0.5046, 0.6927, 0.8812]]], 1, Con98), 
LMin92197 = minimum_layer([[[[[[0.6073, 0.44], [0.3757, 0.6782]], [[0.6033, 0.2928], [0.4186, 0.8427]]], [[[0.6049, 0.2889], [0.4549, 0.5451]], [[0.4259, 0.6496], [0.6467, 0.9781]]]]], [[[[[0.0571, 0.5626], [0.011, 0.9755]], [[0.9851, 0.5031], [0.7339, 0.4422]]], [[[0.9166, 0.3257], [0.1863, 0.0969]], [[0.7201, 0.6407], [0.6312, 0.4182]]]]]], Min92197), 
LRes11299 = reshape_layer(Min92197, [2, 2, 4], Res11299), 
LRes66153 = reshape_layer(Res11299, [2, 8], Res66153), 
LFla39908 = flatten_layer(Res66153, Fla39908), 
LGlo1333 = global_max_pool3D_layer([[[[[1.0485, 1.0882]], [[1.476, 1.1055]]]]], Glo1333), 
LCon68800 = concatenate_layer([Glo1333,[[0.3276, 0.0128, 0.5512, 0.0424, 0.2929, 0.724, 0.705, 0.9755, 0.7971, 0.3308, 0.706, 0.4751, 0.215, 0.8949]]], 1, Con68800), 
LAdd84177 = add_layer([Fla39908,Con68800], Add84177), 
LMax41139 = maximum_layer([Con98,Add84177], Max41139), 
exec_layers([LAve49234,LRes21207,LFla59099,LCon98,LMin92197,LRes11299,LRes66153,LFla39908,LGlo1333,LCon68800,LAdd84177,LMax41139],["Ave49234","Res21207","Fla59099","Con98","Min92197","Res11299","Res66153","Fla39908","Glo1333","Con68800","Add84177","Max41139"],Max41139,"Max41139")

Actual (Unparsed): [[1.5331000, 1.5455000, 0.3455000, 0.6910000, 1.1544999, 0.9600000, 0.7115000, 1.1662000, 1.3099000, 1.2644000, 0.9834000, 0.4277000, 1.1319000, 1.1158000, 0.8462000, 1.3131000]]

Expected (Unparsed): [[1.5331,1.5454999999999999,0.3455,0.6910000000000001,1.1545,0.96,0.7115,1.1662,1.3098999999999998,1.2644,0.9834,0.42769999999999997,1.1319,1.1158000000000001,0.8462,1.3131]]

Actual:   [[1.5331, 1.5455, 0.3455, 0.691, 1.1545, 0.96, 0.7115, 1.1662, 1.3099, 1.2644, 0.9834, 0.4277, 1.1319, 1.1158, 0.8462, 1.3131]]

Expected: [[1.5331, 1.5455, 0.3455, 0.6911, 1.1545, 0.96, 0.7115, 1.1662, 1.3099, 1.2644, 0.9834, 0.4277, 1.1319, 1.1159, 0.8462, 1.3131]]