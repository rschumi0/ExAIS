import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul81629 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul81629 = tf.keras.layers.Input(shape=([2, 2]))
in0Min27351 = tf.keras.layers.Input(shape=([2, 2]))
in1Min27351 = tf.keras.layers.Input(shape=([2, 2]))

Mul81629 = keras.layers.Multiply(name = 'Mul81629', )([in0Mul81629,in1Mul81629])
ReL23751 = keras.layers.ReLU(max_value=6.701518321539651, negative_slope=2.9181615867462067, threshold=4.873654457288794, name = 'ReL23751', )(Mul81629)
Min27351 = keras.layers.Minimum(name = 'Min27351', )([in0Min27351,in1Min27351])
Dot52264 = keras.layers.Dot(axes=(2, 2), name = 'Dot52264', )([ReL23751,Min27351])
model = tf.keras.models.Model(inputs=[in0Mul81629,in1Mul81629,in0Min27351,in1Min27351], outputs=Dot52264)
in0Mul81629 = tf.constant([[[0.2045, 0.9496], [0.2329, 0.9102]]])
in1Mul81629 = tf.constant([[[0.3933, 0.322], [0.4663, 0.4534]]])
in0Min27351 = tf.constant([[[0.716, 0.0864], [0.3272, 0.9922]]])
in1Min27351 = tf.constant([[[0.3374, 0.4177], [0.4551, 0.9319]]])
print (np.array2string(model.predict([in0Mul81629,in1Mul81629,in0Min27351,in1Min27351],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot52264.png')

LMul81629 = multiply_layer([[[[0.2045, 0.9496], [0.2329, 0.9102]]], [[[0.3933, 0.322], [0.4663, 0.4534]]]], Mul81629), 
LReL23751 = relu_layer(Mul81629, 6.701518321539651, 2.9181615867462067, 4.873654457288794, ReL23751), 
LMin27351 = minimum_layer([[[[0.716, 0.0864], [0.3272, 0.9922]]], [[[0.3374, 0.4177], [0.4551, 0.9319]]]], Min27351), 
LDot52264 = dot_layer(ReL23751,Min27351, 2, 2, Dot52264), 
exec_layers([LMul81629,LReL23751,LMin27351,LDot52264],["Mul81629","ReL23751","Min27351","Dot52264"],Dot52264,"Dot52264")

Actual (Unparsed): [[[-5.8710465, -16.9987395], [-5.8163533, -16.6810965]]]

Expected (Unparsed): [[[-5.871046658149402,-16.998739177601284],[-5.816353417958107,-16.681096236489836]]]

Actual:   [[[-5.871, -16.9987], [-5.8163, -16.681]]]

Expected: [[[-5.871, -16.9987], [-5.8163, -16.681]]]