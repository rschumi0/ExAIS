import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min37427 = tf.keras.layers.Input(shape=([2, 1]))
in1Min37427 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot55292 = tf.keras.layers.Input(shape=([2]))
in1Dot55292 = tf.keras.layers.Input(shape=([2]))
in0Con79981 = tf.keras.layers.Input(shape=([8]))

Min37427 = keras.layers.Minimum(name = 'Min37427', )([in0Min37427,in1Min37427])
Res23919 = keras.layers.Reshape((2, 1, 1), name = 'Res23919', )(Min37427)
Res67129 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res67129', )(Res23919)
Con41298 = keras.layers.Conv3DTranspose(3, (2, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con41298', )(Res67129)
Res84780 = keras.layers.Reshape((3, 1, 3), name = 'Res84780', )(Con41298)
Res11793 = keras.layers.Reshape((3, 3), name = 'Res11793', )(Res84780)
Fla82312 = keras.layers.Flatten(name = 'Fla82312', )(Res11793)
Dot55292 = keras.layers.Dot(axes=(1, 1), name = 'Dot55292', )([in0Dot55292,in1Dot55292])
Con79981 = keras.layers.Concatenate(axis=1, name = 'Con79981', )([Dot55292,in0Con79981])
Max67915 = keras.layers.Maximum(name = 'Max67915', )([Fla82312,Con79981])
model = tf.keras.models.Model(inputs=[in0Min37427,in1Min37427,in0Dot55292,in1Dot55292,in0Con79981], outputs=Max67915)
w = model.get_layer('Con41298').get_weights() 
w[0] = np.array([[[[[0.715], [0.3013], [0.9007]]]], [[[[0.8064], [0.0449], [0.9863]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con41298').set_weights(w) 
in0Min37427 = tf.constant([[[0.1095], [0.6625]]])
in1Min37427 = tf.constant([[[0.0124], [0.0938]]])
in0Dot55292 = tf.constant([[0.8494, 0.0692]])
in1Dot55292 = tf.constant([[0.4795, 0.5346]])
in0Con79981 = tf.constant([[0.2387, 0.9904, 0.2234, 0.1366, 0.8446, 0.8066, 0.2178, 0.285]])
print (np.array2string(model.predict([in0Min37427,in1Min37427,in0Dot55292,in1Dot55292,in0Con79981],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max67915.png')

LMin37427 = minimum_layer([[[[0.1095], [0.6625]]], [[[0.0124], [0.0938]]]], Min37427), 
LRes23919 = reshape_layer(Min37427, [2, 1, 1], Res23919), 
LRes67129 = reshape_layer(Res23919, [2, 1, 1, 1], Res67129), 
LCon41298 = conv3D_transpose_layer(Res67129, 2, 1, 1,[[[[[0.715], [0.3013], [0.9007]]]], [[[[0.8064], [0.0449], [0.9863]]]]],[0, 0, 0], 1, 1, 1, false, Con41298), 
LRes84780 = reshape_layer(Con41298, [3, 1, 3], Res84780), 
LRes11793 = reshape_layer(Res84780, [3, 3], Res11793), 
LFla82312 = flatten_layer(Res11793, Fla82312), 
LDot55292 = dot_layer([[0.8494, 0.0692]], [[0.4795, 0.5346]], 1, 1, Dot55292), 
LCon79981 = concatenate_layer([Dot55292,[[0.2387, 0.9904, 0.2234, 0.1366, 0.8446, 0.8066, 0.2178, 0.285]]], 1, Con79981), 
LMax67915 = maximum_layer([Fla82312,Con79981], Max67915), 
exec_layers([LMin37427,LRes23919,LRes67129,LCon41298,LRes84780,LRes11793,LFla82312,LDot55292,LCon79981,LMax67915],["Min37427","Res23919","Res67129","Con41298","Res84780","Res11793","Fla82312","Dot55292","Con79981","Max67915"],Max67915,"Max67915")

Actual (Unparsed): [[0.4442816, 0.2387000, 0.9904000, 0.2234000, 0.1366000, 0.8446000, 0.8066000, 0.2178000, 0.2850000]]

Expected (Unparsed): [[0.44428162000000004,0.2387,0.9904,0.2234,0.1366,0.8446,0.8066,0.2178,0.285]]

Actual:   [[0.4443, 0.2387, 0.9904, 0.2234, 0.1366, 0.8446, 0.8066, 0.2178, 0.285]]

Expected: [[0.4443, 0.2387, 0.9904, 0.2234, 0.1366, 0.8446, 0.8066, 0.2178, 0.285]]