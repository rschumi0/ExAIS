import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub29335 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub29335 = tf.keras.layers.Input(shape=([3, 2, 2]))

Sub29335 = keras.layers.Subtract(name = 'Sub29335', )([in0Sub29335,in1Sub29335])
Res49970 = keras.layers.Reshape((3, 4), name = 'Res49970', )(Sub29335)
Con64097 = keras.layers.Conv1D(2, (3),strides=(1), padding='same', dilation_rate=(1), name = 'Con64097', )(Res49970)
model = tf.keras.models.Model(inputs=[in0Sub29335,in1Sub29335], outputs=Con64097)
w = model.get_layer('Con64097').get_weights() 
w[0] = np.array([[[0.5843, 0.788], [0.0082, 0.8646], [0.5701, 0.1603], [0.4683, 0.7688]], [[0.0522, 0.0776], [0.7012, 0.391], [0.8714, 0.7781], [0.1627, 0.0693]], [[0.8334, 0.0254], [0.6336, 0.2578], [0.7078, 0.5002], [0.6789, 0.4933]]])
w[1] = np.array([0, 0])
model.get_layer('Con64097').set_weights(w) 
in0Sub29335 = tf.constant([[[[0.8917, 0.3692], [0.1167, 0.9722]], [[0.6717, 0.2681], [0.2122, 0.4522]], [[0.5793, 0.3566], [0.6766, 0.7567]]]])
in1Sub29335 = tf.constant([[[[0.8556, 0.8846], [0.7522, 0.8871]], [[0.6667, 0.0242], [0.7943, 0.6684]], [[0.1211, 0.666], [0.49, 0.6623]]]])
print (np.array2string(model.predict([in0Sub29335,in1Sub29335],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con64097.png')

LSub29335 = subtract_layer([[[[0.8917, 0.3692], [0.1167, 0.9722]], [[0.6717, 0.2681], [0.2122, 0.4522]], [[0.5793, 0.3566], [0.6766, 0.7567]]]], [[[[0.8556, 0.8846], [0.7522, 0.8871]], [[0.6667, 0.0242], [0.7943, 0.6684]], [[0.1211, 0.666], [0.49, 0.6623]]]], Sub29335), 
LRes49970 = reshape_layer(Sub29335, [3, 4], Res49970), 
LCon64097 = conv1D_layer(Res49970, 3,[[[0.5843, 0.788], [0.0082, 0.8646], [0.5701, 0.1603], [0.4683, 0.7688]], [[0.0522, 0.0776], [0.7012, 0.391], [0.8714, 0.7781], [0.1627, 0.0693]], [[0.8334, 0.0254], [0.6336, 0.2578], [0.7078, 0.5002], [0.6789, 0.4933]]],[0, 0], 1, true, 1, Con64097), 
exec_layers([LSub29335,LRes49970,LCon64097],["Sub29335","Res49970","Con64097"],Con64097,"Con64097")

Actual (Unparsed): [[[-1.2995295, -1.0221186], [-0.2947217, -0.7539958], [-0.4432514, 0.0216070]]]

Expected (Unparsed): [[[-1.2995295100000002,-1.02211862],[-0.29472159000000003,-0.7539957800000003],[-0.4432513100000001,0.021607049999999985]]]

Actual:   [[[-1.2995, -1.0221], [-0.2947, -0.7539], [-0.4432, 0.0217]]]

Expected: [[[-1.2995, -1.0221], [-0.2947, -0.7539], [-0.4432, 0.0217]]]