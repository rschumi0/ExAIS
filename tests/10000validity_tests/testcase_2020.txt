import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave90058 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave90058 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con24992 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sub21596 = tf.keras.layers.Input(shape=([2, 2, 3]))
in1Sub21596 = tf.keras.layers.Input(shape=([2, 2, 3]))

Ave90058 = keras.layers.Average(name = 'Ave90058', )([in0Ave90058,in1Ave90058])
Zer83742 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer83742', )(Ave90058)
Con24992 = keras.layers.Concatenate(axis=3, name = 'Con24992', )([Zer83742,in0Con24992])
Sub21596 = keras.layers.Subtract(name = 'Sub21596', )([in0Sub21596,in1Sub21596])
Ave56411 = keras.layers.Average(name = 'Ave56411', )([Con24992,Sub21596])
model = tf.keras.models.Model(inputs=[in0Ave90058,in1Ave90058,in0Con24992,in0Sub21596,in1Sub21596], outputs=Ave56411)
in0Ave90058 = tf.constant([[[[0.9871], [0.2136]]]])
in1Ave90058 = tf.constant([[[[0.8825], [0.4617]]]])
in0Con24992 = tf.constant([[[[0.8815, 0.7603], [0.9243, 0.9395]], [[0.9123, 0.1097], [0.6798, 0.2892]]]])
in0Sub21596 = tf.constant([[[[0.2925, 0.1048, 0.9686], [0.8235, 0.4093, 0.8044]], [[0.4213, 0.2477, 0.8964], [0.2262, 0.9322, 0.4115]]]])
in1Sub21596 = tf.constant([[[[0.899, 0.5903, 0.9192], [0.1753, 0.49, 0.1201]], [[0.8291, 0.6089, 0.4964], [0.4574, 0.147, 0.435]]]])
print (np.array2string(model.predict([in0Ave90058,in1Ave90058,in0Con24992,in0Sub21596,in1Sub21596],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave56411.png')

LAve90058 = average_layer([[[[[0.9871], [0.2136]]]], [[[[0.8825], [0.4617]]]]], Ave90058), 
LZer83742 = zero_padding2D_layer(Ave90058, 1, 0, 0, 0, Zer83742), 
LCon24992 = concatenate_layer([Zer83742,[[[[0.8815, 0.7603], [0.9243, 0.9395]], [[0.9123, 0.1097], [0.6798, 0.2892]]]]], 3, Con24992), 
LSub21596 = subtract_layer([[[[0.2925, 0.1048, 0.9686], [0.8235, 0.4093, 0.8044]], [[0.4213, 0.2477, 0.8964], [0.2262, 0.9322, 0.4115]]]], [[[[0.899, 0.5903, 0.9192], [0.1753, 0.49, 0.1201]], [[0.8291, 0.6089, 0.4964], [0.4574, 0.147, 0.435]]]], Sub21596), 
LAve56411 = average_layer([Con24992,Sub21596], Ave56411), 
exec_layers([LAve90058,LZer83742,LCon24992,LSub21596,LAve56411],["Ave90058","Zer83742","Con24992","Sub21596","Ave56411"],Ave56411,"Ave56411")

Actual (Unparsed): [[[[-0.3032500, 0.1980000, 0.4048500], [0.3241000, 0.4218000, 0.8119000]], [[0.2635000, 0.2755500, 0.2548500], [0.0532250, 0.7325000, 0.1328500]]]]

Expected (Unparsed): [[[[-0.30325,0.19799999999999995,0.40485],[0.3241,0.4218,0.8119000000000001]],[[0.2635,0.27555,0.25484999999999997],[0.05322500000000002,0.7324999999999999,0.13285]]]]

Actual:   [[[[-0.3032, 0.198, 0.4049], [0.3241, 0.4218, 0.8119]], [[0.2635, 0.2756, 0.2549], [0.0533, 0.7325, 0.1329]]]]

Expected: [[[[-0.3032, 0.198, 0.4049], [0.3241, 0.4218, 0.812]], [[0.2635, 0.2756, 0.2549], [0.0533, 0.7325, 0.1329]]]]