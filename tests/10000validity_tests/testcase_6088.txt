import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con18131 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Sof89461 = tf.keras.layers.Input(shape=([2, 2]))

Con18131 = keras.layers.Conv3D(2, (1, 1, 1),strides=(7, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con18131', )(in0Con18131)
Res48763 = keras.layers.Reshape((1, 1, 2), name = 'Res48763', )(Con18131)
Res85985 = keras.layers.Reshape((1, 2), name = 'Res85985', )(Res48763)
Zer61763 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer61763', )(Res85985)
Sof89461 = keras.layers.Softmax(axis=1, name = 'Sof89461', input_shape=(2, 2))(in0Sof89461)
Lay91825 = keras.layers.LayerNormalization(axis=2, epsilon=2.295674447084206, name = 'Lay91825', )(Sof89461)
Max7326 = keras.layers.Maximum(name = 'Max7326', )([Zer61763,Lay91825])
Bat2048 = keras.layers.BatchNormalization(axis=1, epsilon=0.5803574384438915,  name = 'Bat2048', )(Max7326)
model = tf.keras.models.Model(inputs=[in0Con18131,in0Sof89461], outputs=Bat2048)
w = model.get_layer('Con18131').get_weights() 
w[0] = np.array([[[[[0.7535, 0.2949]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con18131').set_weights(w) 
w = model.get_layer('Bat2048').get_weights() 
w[0] = np.array([0.2574, 0.5971])
w[1] = np.array([0.9479, 0.7411])
w[2] = np.array([0.9694, 0.0967])
w[3] = np.array([0.5908, 0.9839])
model.get_layer('Bat2048').set_weights(w) 
in0Con18131 = tf.constant([[[[[0.9081]]], [[[0.2869]]]]])
in0Sof89461 = tf.constant([[[0.0494, 0.513], [0.3488, 0.7488]]])
print (np.array2string(model.predict([in0Con18131,in0Sof89461],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat2048.png')

LCon18131 = conv3D_layer([[[[[0.9081]]], [[[0.2869]]]]], 1, 1, 1,[[[[[0.7535, 0.2949]]]]],[0, 0], 7, 1, 1, false, 1, 1, 1, Con18131), 
LRes48763 = reshape_layer(Con18131, [1, 1, 2], Res48763), 
LRes85985 = reshape_layer(Res48763, [1, 2], Res85985), 
LZer61763 = zero_padding1D_layer(Res85985, 1, 0, Zer61763), 
LSof89461 = softmax_layer([[[0.0494, 0.513], [0.3488, 0.7488]]], 1, Sof89461), 
LLay91825 = layer_normalization_layer(Sof89461, 2, 2.295674447084206, Lay91825), 
LMax7326 = maximum_layer([Zer61763,Lay91825], Max7326), 
LBat2048 = batch_normalization_layer(Max7326, 1, 0.5803574384438915, [0.2574, 0.5971], [0.9479, 0.7411], [0.9694, 0.0967], [0.5908, 0.9839], Bat2048), 
exec_layers([LCon18131,LRes48763,LRes85985,LZer61763,LSof89461,LLay91825,LMax7326,LBat2048],["Con18131","Res48763","Res85985","Zer61763","Sof89461","Lay91825","Max7326","Bat2048"],Bat2048,"Bat2048")

Actual (Unparsed): [[[0.7173294, 0.7185552], [1.0216048, 0.8227845]]]

Expected (Unparsed): [[[0.7173294065342886,0.7185552093551847],[1.021604778199031,0.8227844973968657]]]

Actual:   [[[0.7174, 0.7186], [1.0217, 0.8228]]]

Expected: [[[0.7174, 0.7186], [1.0217, 0.8228]]]