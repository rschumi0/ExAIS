import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea49160 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Max33540 = tf.keras.layers.Input(shape=([2, 2]))

Lea49160 = keras.layers.LeakyReLU(alpha=6.283322774729091, name = 'Lea49160', input_shape=(1, 2, 1))(in0Lea49160)
Res59372 = keras.layers.Reshape((1, 2), name = 'Res59372', )(Lea49160)
Zer25810 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer25810', )(Res59372)
Max33540 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max33540', )(in0Max33540)
Dot52910 = keras.layers.Dot(axes=(1, 1), name = 'Dot52910', )([Zer25810,Max33540])
Res67086 = keras.layers.Reshape((2, 2, 1), name = 'Res67086', )(Dot52910)
Res19184 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res19184', )(Res67086)
Cro75619 = keras.layers.Cropping3D(cropping=((1, 0), (0, 1), (0, 0)), name = 'Cro75619', )(Res19184)
Res45815 = keras.layers.Reshape((1, 1, 1), name = 'Res45815', )(Cro75619)
Res33917 = keras.layers.Reshape((1, 1), name = 'Res33917', )(Res45815)
Res3721 = keras.layers.Reshape((1, 1, 1), name = 'Res3721', )(Res33917)
Zer5640 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer5640', )(Res3721)
model = tf.keras.models.Model(inputs=[in0Lea49160,in0Max33540], outputs=Zer5640)
in0Lea49160 = tf.constant([[[[0.9513], [0.9585]]]])
in0Max33540 = tf.constant([[[1.0924, 1.0888], [1.7923, 1.7039]]])
print (np.array2string(model.predict([in0Lea49160,in0Max33540],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer5640.png')

LLea49160 = leaky_relu_layer([[[[0.9513], [0.9585]]]], 6.283322774729091, Lea49160), 
LRes59372 = reshape_layer(Lea49160, [1, 2], Res59372), 
LZer25810 = zero_padding1D_layer(Res59372, 1, 0, Zer25810), 
LMax33540 = max_pool1D_layer([[[1.0924, 1.0888], [1.7923, 1.7039]]], 1, Max33540), 
LDot52910 = dot_layer(Zer25810,Max33540, 1, 1, Dot52910), 
LRes67086 = reshape_layer(Dot52910, [2, 2, 1], Res67086), 
LRes19184 = reshape_layer(Res67086, [2, 2, 1, 1], Res19184), 
LCro75619 = cropping3D_layer(Res19184, 1, 0, 0, 1, 0, 0, Cro75619), 
LRes45815 = reshape_layer(Cro75619, [1, 1, 1], Res45815), 
LRes33917 = reshape_layer(Res45815, [1, 1], Res33917), 
LRes3721 = reshape_layer(Res33917, [1, 1, 1], Res3721), 
LZer5640 = zero_padding2D_layer(Res3721, 1, 1, 1, 1, Zer5640), 
exec_layers([LLea49160,LRes59372,LZer25810,LMax33540,LDot52910,LRes67086,LRes19184,LCro75619,LRes45815,LRes33917,LRes3721,LZer5640],["Lea49160","Res59372","Zer25810","Max33540","Dot52910","Res67086","Res19184","Cro75619","Res45815","Res33917","Res3721","Zer5640"],Zer5640,"Zer5640")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.7179196], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[1.71791955],[0]],[[0],[0],[0]]]]

Actual:   [[[[0], [0], [0]], [[0], [1.718], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [1.718], [0]], [[0], [0], [0]]]]