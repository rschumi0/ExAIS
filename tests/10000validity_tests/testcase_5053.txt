import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul3251 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Mul3251 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Mul3251 = keras.layers.Multiply(name = 'Mul3251', )([in0Mul3251,in1Mul3251])
Res17717 = keras.layers.Reshape((1, 2, 4), name = 'Res17717', )(Mul3251)
Loc82488 = keras.layers.LocallyConnected2D(4, (1, 1),strides=(1, 1), name = 'Loc82488', )(Res17717)
Res25400 = keras.layers.Reshape((1, 8), name = 'Res25400', )(Loc82488)
Glo55248 = keras.layers.GlobalMaxPool1D(name = 'Glo55248', )(Res25400)
model = tf.keras.models.Model(inputs=[in0Mul3251,in1Mul3251], outputs=Glo55248)
w = model.get_layer('Loc82488').get_weights() 
w[0] = np.array([[[0.391, 0.8937, 0.2433, 0.0128], [0.4275, 0.5339, 0.1753, 0.7889], [0.7708, 0.4117, 0.7037, 0.1842], [0.5847, 0.6851, 0.9478, 0.1341]], [[0.6559, 0.1073, 0.323, 0.0321], [0.0911, 0.4581, 0.0175, 0.2158], [0.8728, 0.4092, 0.1301, 0.191], [0.5063, 0.9137, 0.4291, 0.2734]]])
w[1] = np.array([[[0, 0, 0, 0], [0, 0, 0, 0]]])
model.get_layer('Loc82488').set_weights(w) 
in0Mul3251 = tf.constant([[[[[0.7969, 0.136], [0.1846, 0.684]], [[0.2963, 0.5882], [0.6497, 0.9738]]]]])
in1Mul3251 = tf.constant([[[[[0.0774, 0.9486], [0.8557, 0.2716]], [[0.0911, 0.4959], [0.9919, 0.119]]]]])
print (np.array2string(model.predict([in0Mul3251,in1Mul3251],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo55248.png')

LMul3251 = multiply_layer([[[[[[0.7969, 0.136], [0.1846, 0.684]], [[0.2963, 0.5882], [0.6497, 0.9738]]]]], [[[[[0.0774, 0.9486], [0.8557, 0.2716]], [[0.0911, 0.4959], [0.9919, 0.119]]]]]], Mul3251), 
LRes17717 = reshape_layer(Mul3251, [1, 2, 4], Res17717), 
LLoc82488 = locally_connected2D_layer(Res17717, 1, 1,[[[0.391, 0.8937, 0.2433, 0.0128], [0.4275, 0.5339, 0.1753, 0.7889], [0.7708, 0.4117, 0.7037, 0.1842], [0.5847, 0.6851, 0.9478, 0.1341]], [[0.6559, 0.1073, 0.323, 0.0321], [0.0911, 0.4581, 0.0175, 0.2158], [0.8728, 0.4092, 0.1301, 0.191], [0.5063, 0.9137, 0.4291, 0.2734]]],[[[0, 0, 0, 0], [0, 0, 0, 0]]], 1, 1, Loc82488), 
LRes25400 = reshape_layer(Loc82488, [1, 8], Res25400), 
LGlo55248 = global_max_pool1D_layer(Res25400, Glo55248), 
exec_layers([LMul3251,LRes17717,LLoc82488,LRes25400,LGlo55248],["Mul3251","Res17717","Loc82488","Res25400","Glo55248"],Glo55248,"Glo55248")

Actual (Unparsed): [[0.3096481, 0.3163088, 0.3248571, 0.1565742, 0.6654136, 0.5061042, 0.1473896, 0.2185826]]

Expected (Unparsed): [[0.309648078316,0.316308782476,0.32485713201199995,0.156574166172,0.6654136209690001,0.506104150763,0.147389624703,0.218582568067]]

Actual:   [[0.3097, 0.3164, 0.3249, 0.1566, 0.6655, 0.5062, 0.1474, 0.2186]]

Expected: [[0.3097, 0.3164, 0.3249, 0.1566, 0.6655, 0.5062, 0.1474, 0.2186]]