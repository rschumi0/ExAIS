import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min39992 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min39992 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con23155 = tf.keras.layers.Input(shape=([8, 3, 2, 1]))
in0Up_12718 = tf.keras.layers.Input(shape=([4, 3, 2, 1]))
in0Con268 = tf.keras.layers.Input(shape=([8, 3, 2, 1]))
in0Add57896 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Add57896 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Min39992 = keras.layers.Minimum(name = 'Min39992', )([in0Min39992,in1Min39992])
Con35397 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con35397', )(Min39992)
Res67690 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res67690', )(Con35397)
Zer48622 = keras.layers.ZeroPadding3D(padding=((6, 0), (2, 0), (0, 0)), name = 'Zer48622', )(Res67690)
Con23155 = keras.layers.Concatenate(axis=4, name = 'Con23155', )([Zer48622,in0Con23155])
Up_12718 = keras.layers.UpSampling3D(size=(2, 1, 1), name = 'Up_12718', )(in0Up_12718)
Con268 = keras.layers.Concatenate(axis=4, name = 'Con268', )([Up_12718,in0Con268])
Add57896 = keras.layers.Add(name = 'Add57896', )([in0Add57896,in1Add57896])
Zer89346 = keras.layers.ZeroPadding3D(padding=((7, 0), (1, 0), (1, 0)), name = 'Zer89346', )(Add57896)
Min53638 = keras.layers.Minimum(name = 'Min53638', )([Con268,Zer89346])
Ave85505 = keras.layers.Average(name = 'Ave85505', )([Con23155,Min53638])
Res25788 = keras.layers.Reshape((8, 3, 4), name = 'Res25788', )(Ave85505)
Up_93446 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_93446', )(Res25788)
model = tf.keras.models.Model(inputs=[in0Min39992,in1Min39992,in0Con23155,in0Up_12718,in0Con268,in0Add57896,in1Add57896], outputs=Up_93446)
w = model.get_layer('Con35397').get_weights() 
w[0] = np.array([[[[0.1441, 0.1824]]]])
w[1] = np.array([0, 0])
model.get_layer('Con35397').set_weights(w) 
in0Min39992 = tf.constant([[[[0.3745]], [[0.6279]]]])
in1Min39992 = tf.constant([[[[0.3799]], [[0.2747]]]])
in0Con23155 = tf.constant([[[[[0.8681], [0.0442]], [[0.4492], [0.0706]], [[0.7452], [0.2299]]], [[[0.2824], [0.6816]], [[0.1651], [0.9075]], [[0.7878], [0.7704]]], [[[0.2653], [0.1646]], [[0.1109], [0.1224]], [[0.8207], [0.5147]]], [[[0.1907], [0.9578]], [[0.4949], [0.8866]], [[0.6648], [0.2505]]], [[[0.5773], [0.9879]], [[0.7126], [0.5261]], [[0.1888], [0.5053]]], [[[0.4022], [0.8147]], [[0.7667], [0.7539]], [[0.8834], [0.6547]]], [[[0.6189], [0.9353]], [[0.2039], [0.1766]], [[0.4751], [0.1264]]], [[[0.6181], [0.3305]], [[0.2583], [0.4828]], [[0.0031], [0.2624]]]]])
in0Up_12718 = tf.constant([[[[[1.694], [1.4046]], [[1.192], [1.4241]], [[1.6057], [1.9407]]], [[[1.8842], [1.355]], [[1.7119], [1.0977]], [[1.5574], [1.9345]]], [[[1.3018], [1.3012]], [[1.2781], [1.4978]], [[1.9591], [1.3394]]], [[[1.233], [1.8509]], [[1.2607], [1.1561]], [[1.0013], [1.4552]]]]])
in0Con268 = tf.constant([[[[[0.3026], [0.7573]], [[0.2328], [0.5042]], [[0.0955], [0.6135]]], [[[0.029], [0.9331]], [[0.2369], [0.8187]], [[0.8031], [0.305]]], [[[0.7966], [0.958]], [[0.8462], [0.9505]], [[0.5766], [0.1381]]], [[[0.3638], [0.7523]], [[0.5657], [0.7611]], [[0.4882], [0.6098]]], [[[0.9165], [0.472]], [[0.6222], [0.9741]], [[0.1977], [0.6674]]], [[[0.2009], [0.0012]], [[0.5314], [0.7851]], [[0.3281], [0.8537]]], [[[0.3729], [0.9692]], [[0.9085], [0.6857]], [[0.105], [0.5971]]], [[[0.8285], [0.8884]], [[0.3317], [0.5933]], [[0.4641], [0.2451]]]]])
in0Add57896 = tf.constant([[[[[0.2235, 0.0322]], [[0.9103, 0.4838]]]]])
in1Add57896 = tf.constant([[[[[0.5294, 0.7133]], [[0.4475, 0.8654]]]]])
print (np.array2string(model.predict([in0Min39992,in1Min39992,in0Con23155,in0Up_12718,in0Con268,in0Add57896,in1Add57896],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_93446.png')

LMin39992 = minimum_layer([[[[[0.3745]], [[0.6279]]]], [[[[0.3799]], [[0.2747]]]]], Min39992), 
LCon35397 = conv2D_layer(Min39992, 1, 1,[[[[0.1441, 0.1824]]]],[0, 0], 1, 1, false, 1, 1, Con35397), 
LRes67690 = reshape_layer(Con35397, [2, 1, 2, 1], Res67690), 
LZer48622 = zero_padding3D_layer(Res67690, 6, 0, 2, 0, 0, 0, Zer48622), 
LCon23155 = concatenate_layer([Zer48622,[[[[[0.8681], [0.0442]], [[0.4492], [0.0706]], [[0.7452], [0.2299]]], [[[0.2824], [0.6816]], [[0.1651], [0.9075]], [[0.7878], [0.7704]]], [[[0.2653], [0.1646]], [[0.1109], [0.1224]], [[0.8207], [0.5147]]], [[[0.1907], [0.9578]], [[0.4949], [0.8866]], [[0.6648], [0.2505]]], [[[0.5773], [0.9879]], [[0.7126], [0.5261]], [[0.1888], [0.5053]]], [[[0.4022], [0.8147]], [[0.7667], [0.7539]], [[0.8834], [0.6547]]], [[[0.6189], [0.9353]], [[0.2039], [0.1766]], [[0.4751], [0.1264]]], [[[0.6181], [0.3305]], [[0.2583], [0.4828]], [[0.0031], [0.2624]]]]]], 4, Con23155), 
LUp_12718 = up_sampling3D_layer([[[[[1.694], [1.4046]], [[1.192], [1.4241]], [[1.6057], [1.9407]]], [[[1.8842], [1.355]], [[1.7119], [1.0977]], [[1.5574], [1.9345]]], [[[1.3018], [1.3012]], [[1.2781], [1.4978]], [[1.9591], [1.3394]]], [[[1.233], [1.8509]], [[1.2607], [1.1561]], [[1.0013], [1.4552]]]]], 2, 1, 1, Up_12718), 
LCon268 = concatenate_layer([Up_12718,[[[[[0.3026], [0.7573]], [[0.2328], [0.5042]], [[0.0955], [0.6135]]], [[[0.029], [0.9331]], [[0.2369], [0.8187]], [[0.8031], [0.305]]], [[[0.7966], [0.958]], [[0.8462], [0.9505]], [[0.5766], [0.1381]]], [[[0.3638], [0.7523]], [[0.5657], [0.7611]], [[0.4882], [0.6098]]], [[[0.9165], [0.472]], [[0.6222], [0.9741]], [[0.1977], [0.6674]]], [[[0.2009], [0.0012]], [[0.5314], [0.7851]], [[0.3281], [0.8537]]], [[[0.3729], [0.9692]], [[0.9085], [0.6857]], [[0.105], [0.5971]]], [[[0.8285], [0.8884]], [[0.3317], [0.5933]], [[0.4641], [0.2451]]]]]], 4, Con268), 
LAdd57896 = add_layer([[[[[[0.2235, 0.0322]], [[0.9103, 0.4838]]]]], [[[[[0.5294, 0.7133]], [[0.4475, 0.8654]]]]]], Add57896), 
LZer89346 = zero_padding3D_layer(Add57896, 7, 0, 1, 0, 1, 0, Zer89346), 
LMin53638 = minimum_layer([Con268,Zer89346], Min53638), 
LAve85505 = average_layer([Con23155,Min53638], Ave85505), 
LRes25788 = reshape_layer(Ave85505, [8, 3, 4], Res25788), 
LUp_93446 = up_sampling2D_layer(Res25788, 2, 1, Up_93446), 
exec_layers([LMin39992,LCon35397,LRes67690,LZer48622,LCon23155,LUp_12718,LCon268,LAdd57896,LZer89346,LMin53638,LAve85505,LRes25788,LUp_93446],["Min39992","Con35397","Res67690","Zer48622","Con23155","Up_12718","Con268","Add57896","Zer89346","Min53638","Ave85505","Res25788","Up_93446"],Up_93446,"Up_93446")

Actual (Unparsed): [[[[0.0000000, 0.4340500, 0.0000000, 0.0221000], [0.0000000, 0.2246000, 0.0000000, 0.0353000], [0.0000000, 0.3726000, 0.0000000, 0.1149500]], [[0.0000000, 0.4340500, 0.0000000, 0.0221000], [0.0000000, 0.2246000, 0.0000000, 0.0353000], [0.0000000, 0.3726000, 0.0000000, 0.1149500]], [[0.0000000, 0.1412000, 0.0000000, 0.3408000], [0.0000000, 0.0825500, 0.0000000, 0.4537500], [0.0000000, 0.3939000, 0.0000000, 0.3852000]], [[0.0000000, 0.1412000, 0.0000000, 0.3408000], [0.0000000, 0.0825500, 0.0000000, 0.4537500], [0.0000000, 0.3939000, 0.0000000, 0.3852000]], [[0.0000000, 0.1326500, 0.0000000, 0.0823000], [0.0000000, 0.0554500, 0.0000000, 0.0612000], [0.0000000, 0.4103500, 0.0000000, 0.2573500]], [[0.0000000, 0.1326500, 0.0000000, 0.0823000], [0.0000000, 0.0554500, 0.0000000, 0.0612000], [0.0000000, 0.4103500, 0.0000000, 0.2573500]], [[0.0000000, 0.0953500, 0.0000000, 0.4789000], [0.0000000, 0.2474500, 0.0000000, 0.4433000], [0.0000000, 0.3324000, 0.0000000, 0.1252500]], [[0.0000000, 0.0953500, 0.0000000, 0.4789000], [0.0000000, 0.2474500, 0.0000000, 0.4433000], [0.0000000, 0.3324000, 0.0000000, 0.1252500]], [[0.0000000, 0.2886500, 0.0000000, 0.4939500], [0.0000000, 0.3563000, 0.0000000, 0.2630500], [0.0000000, 0.0944000, 0.0000000, 0.2526500]], [[0.0000000, 0.2886500, 0.0000000, 0.4939500], [0.0000000, 0.3563000, 0.0000000, 0.2630500], [0.0000000, 0.0944000, 0.0000000, 0.2526500]], [[0.0000000, 0.2011000, 0.0000000, 0.4073500], [0.0000000, 0.3833500, 0.0000000, 0.3769500], [0.0000000, 0.4417000, 0.0000000, 0.3273500]], [[0.0000000, 0.2011000, 0.0000000, 0.4073500], [0.0000000, 0.3833500, 0.0000000, 0.3769500], [0.0000000, 0.4417000, 0.0000000, 0.3273500]], [[0.0000000, 0.3094500, 0.0000000, 0.4676500], [0.0000000, 0.1019500, 0.0000000, 0.0883000], [0.0269827, 0.2375500, 0.0341544, 0.0632000]], [[0.0000000, 0.3094500, 0.0000000, 0.4676500], [0.0000000, 0.1019500, 0.0000000, 0.0883000], [0.0269827, 0.2375500, 0.0341544, 0.0632000]], [[0.0000000, 0.3090500, 0.0000000, 0.1652500], [0.0000000, 0.1291500, 0.3764500, 0.5380500], [0.0197921, 0.0015500, 0.7039526, 0.2537500]], [[0.0000000, 0.3090500, 0.0000000, 0.1652500], [0.0000000, 0.1291500, 0.3764500, 0.5380500], [0.0197921, 0.0015500, 0.7039526, 0.2537500]]]]

Expected (Unparsed): [[[[0,0.43405,0,0.0221],[0,0.2246,0,0.0353],[0,0.3726,0,0.11495]],[[0,0.43405,0,0.0221],[0,0.2246,0,0.0353],[0,0.3726,0,0.11495]],[[0,0.1412,0,0.3408],[0,0.08255,0,0.45375],[0,0.3939,0,0.3852]],[[0,0.1412,0,0.3408],[0,0.08255,0,0.45375],[0,0.3939,0,0.3852]],[[0,0.13265,0,0.0823],[0,0.05545,0,0.0612],[0,0.41035,0,0.25735]],[[0,0.13265,0,0.0823],[0,0.05545,0,0.0612],[0,0.41035,0,0.25735]],[[0,0.09535,0,0.4789],[0,0.24745,0,0.4433],[0,0.3324,0,0.12525]],[[0,0.09535,0,0.4789],[0,0.24745,0,0.4433],[0,0.3324,0,0.12525]],[[0,0.28865,0,0.49395],[0,0.3563,0,0.26305],[0,0.0944,0,0.25265]],[[0,0.28865,0,0.49395],[0,0.3563,0,0.26305],[0,0.0944,0,0.25265]],[[0,0.2011,0,0.40735],[0,0.38335,0,0.37695],[0,0.4417,0,0.32735]],[[0,0.2011,0,0.40735],[0,0.38335,0,0.37695],[0,0.4417,0,0.32735]],[[0,0.30945,0,0.46765],[0,0.10195,0,0.0883],[0.026982725000000003,0.23755,0.0341544,0.0632]],[[0,0.30945,0,0.46765],[0,0.10195,0,0.0883],[0.026982725000000003,0.23755,0.0341544,0.0632]],[[0,0.30905,0,0.16525],[0,0.12915,0.37645,0.53805],[0.019792135000000002,0.00155,0.70395264,0.25375000000000003]],[[0,0.30905,0,0.16525],[0,0.12915,0.37645,0.53805],[0.019792135000000002,0.00155,0.70395264,0.25375000000000003]]]]

Actual:   [[[[0, 0.4341, 0, 0.0221], [0, 0.2246, 0, 0.0353], [0, 0.3726, 0, 0.115]], [[0, 0.4341, 0, 0.0221], [0, 0.2246, 0, 0.0353], [0, 0.3726, 0, 0.115]], [[0, 0.1412, 0, 0.3408], [0, 0.0826, 0, 0.4538], [0, 0.3939, 0, 0.3852]], [[0, 0.1412, 0, 0.3408], [0, 0.0826, 0, 0.4538], [0, 0.3939, 0, 0.3852]], [[0, 0.1327, 0, 0.0823], [0, 0.0555, 0, 0.0612], [0, 0.4104, 0, 0.2574]], [[0, 0.1327, 0, 0.0823], [0, 0.0555, 0, 0.0612], [0, 0.4104, 0, 0.2574]], [[0, 0.0954, 0, 0.4789], [0, 0.2475, 0, 0.4433], [0, 0.3324, 0, 0.1253]], [[0, 0.0954, 0, 0.4789], [0, 0.2475, 0, 0.4433], [0, 0.3324, 0, 0.1253]], [[0, 0.2887, 0, 0.494], [0, 0.3563, 0, 0.2631], [0, 0.0944, 0, 0.2527]], [[0, 0.2887, 0, 0.494], [0, 0.3563, 0, 0.2631], [0, 0.0944, 0, 0.2527]], [[0, 0.2011, 0, 0.4074], [0, 0.3834, 0, 0.377], [0, 0.4417, 0, 0.3274]], [[0, 0.2011, 0, 0.4074], [0, 0.3834, 0, 0.377], [0, 0.4417, 0, 0.3274]], [[0, 0.3095, 0, 0.4677], [0, 0.102, 0, 0.0883], [0.027, 0.2376, 0.0342, 0.0632]], [[0, 0.3095, 0, 0.4677], [0, 0.102, 0, 0.0883], [0.027, 0.2376, 0.0342, 0.0632]], [[0, 0.3091, 0, 0.1653], [0, 0.1292, 0.3765, 0.5381], [0.0198, 0.0016, 0.704, 0.2538]], [[0, 0.3091, 0, 0.1653], [0, 0.1292, 0.3765, 0.5381], [0.0198, 0.0016, 0.704, 0.2538]]]]

Expected: [[[[0, 0.4341, 0, 0.0221], [0, 0.2246, 0, 0.0353], [0, 0.3726, 0, 0.115]], [[0, 0.4341, 0, 0.0221], [0, 0.2246, 0, 0.0353], [0, 0.3726, 0, 0.115]], [[0, 0.1412, 0, 0.3408], [0, 0.0826, 0, 0.4538], [0, 0.3939, 0, 0.3852]], [[0, 0.1412, 0, 0.3408], [0, 0.0826, 0, 0.4538], [0, 0.3939, 0, 0.3852]], [[0, 0.1327, 0, 0.0823], [0, 0.0555, 0, 0.0612], [0, 0.4104, 0, 0.2574]], [[0, 0.1327, 0, 0.0823], [0, 0.0555, 0, 0.0612], [0, 0.4104, 0, 0.2574]], [[0, 0.0954, 0, 0.4789], [0, 0.2475, 0, 0.4433], [0, 0.3324, 0, 0.1253]], [[0, 0.0954, 0, 0.4789], [0, 0.2475, 0, 0.4433], [0, 0.3324, 0, 0.1253]], [[0, 0.2887, 0, 0.494], [0, 0.3563, 0, 0.2631], [0, 0.0944, 0, 0.2527]], [[0, 0.2887, 0, 0.494], [0, 0.3563, 0, 0.2631], [0, 0.0944, 0, 0.2527]], [[0, 0.2011, 0, 0.4074], [0, 0.3834, 0, 0.377], [0, 0.4417, 0, 0.3274]], [[0, 0.2011, 0, 0.4074], [0, 0.3834, 0, 0.377], [0, 0.4417, 0, 0.3274]], [[0, 0.3095, 0, 0.4677], [0, 0.102, 0, 0.0883], [0.027, 0.2376, 0.0342, 0.0632]], [[0, 0.3095, 0, 0.4677], [0, 0.102, 0, 0.0883], [0.027, 0.2376, 0.0342, 0.0632]], [[0, 0.3091, 0, 0.1653], [0, 0.1292, 0.3765, 0.5381], [0.0198, 0.0016, 0.704, 0.2538]], [[0, 0.3091, 0, 0.1653], [0, 0.1292, 0.3765, 0.5381], [0.0198, 0.0016, 0.704, 0.2538]]]]