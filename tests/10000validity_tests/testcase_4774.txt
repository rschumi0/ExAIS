import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add4079 = tf.keras.layers.Input(shape=([2, 1]))
in1Add4079 = tf.keras.layers.Input(shape=([2, 1]))
in0Con53118 = tf.keras.layers.Input(shape=([4, 2]))
in0Ave6861 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave6861 = tf.keras.layers.Input(shape=([2, 1]))

Add4079 = keras.layers.Add(name = 'Add4079', )([in0Add4079,in1Add4079])
Zer70927 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer70927', )(Add4079)
Con53118 = keras.layers.Concatenate(axis=2, name = 'Con53118', )([Zer70927,in0Con53118])
Ave6861 = keras.layers.Average(name = 'Ave6861', )([in0Ave6861,in1Ave6861])
Den61614 = keras.layers.Dense(3,name = 'Den61614', )(Ave6861)
Up_30459 = keras.layers.UpSampling1D(size=(2), name = 'Up_30459', )(Den61614)
Ave98097 = keras.layers.Average(name = 'Ave98097', )([Con53118,Up_30459])
model = tf.keras.models.Model(inputs=[in0Add4079,in1Add4079,in0Con53118,in0Ave6861,in1Ave6861], outputs=Ave98097)
w = model.get_layer('Den61614').get_weights() 
w[0] = np.array([[0.1992, 0.0245, 0.0917]])
w[1] = np.array([0.4368, 0.0775, 0.5179])
model.get_layer('Den61614').set_weights(w) 
in0Add4079 = tf.constant([[[0.3109], [0.4088]]])
in1Add4079 = tf.constant([[[0.8698], [0.1032]]])
in0Con53118 = tf.constant([[[0.5595, 0.5553], [0.0608, 0.4316], [0.3426, 0.8902], [0.37, 0.3952]]])
in0Ave6861 = tf.constant([[[0.7163], [0.3911]]])
in1Ave6861 = tf.constant([[[0.9694], [0.4438]]])
print (np.array2string(model.predict([in0Add4079,in1Add4079,in0Con53118,in0Ave6861,in1Ave6861],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave98097.png')

LAdd4079 = add_layer([[[[0.3109], [0.4088]]], [[[0.8698], [0.1032]]]], Add4079), 
LZer70927 = zero_padding1D_layer(Add4079, 2, 0, Zer70927), 
LCon53118 = concatenate_layer([Zer70927,[[[0.5595, 0.5553], [0.0608, 0.4316], [0.3426, 0.8902], [0.37, 0.3952]]]], 2, Con53118), 
LAve6861 = average_layer([[[[0.7163], [0.3911]]], [[[0.9694], [0.4438]]]], Ave6861), 
LDen61614 = dense_layer(Ave6861, [[0.1992, 0.0245, 0.0917]],[0.4368, 0.0775, 0.5179], Den61614), 
LUp_30459 = up_sampling1D_layer(Den61614, 2, Up_30459), 
LAve98097 = average_layer([Con53118,Up_30459], Ave98097), 
exec_layers([LAdd4079,LZer70927,LCon53118,LAve6861,LDen61614,LUp_30459,LAve98097],["Add4079","Zer70927","Con53118","Ave6861","Den61614","Up_30459","Ave98097"],Ave98097,"Ave98097")

Actual (Unparsed): [[[0.3023479, 0.3288249, 0.5752447], [0.3023479, 0.0794749, 0.5133947], [0.8503280, 0.2151638, 0.7231901], [0.5159780, 0.2288638, 0.4756901]]]

Expected (Unparsed): [[[0.30234786,0.3288249125,0.5752446725],[0.30234786,0.0794749125,0.5133946725],[0.8503280200000001,0.21516376250000002,0.7231900824999999],[0.51597802,0.2288637625,0.4756900825]]]

Actual:   [[[0.3024, 0.3289, 0.5753], [0.3024, 0.0795, 0.5134], [0.8504, 0.2152, 0.7232], [0.516, 0.2289, 0.4757]]]

Expected: [[[0.3024, 0.3289, 0.5753], [0.3024, 0.0795, 0.5134], [0.8504, 0.2152, 0.7232], [0.516, 0.2289, 0.4757]]]