import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min59706 = tf.keras.layers.Input(shape=([2, 2]))
in1Min59706 = tf.keras.layers.Input(shape=([2, 2]))
in0Con20173 = tf.keras.layers.Input(shape=([5, 5, 1]))
in0Bat94095 = tf.keras.layers.Input(shape=([3, 3, 2]))

Min59706 = keras.layers.Minimum(name = 'Min59706', )([in0Min59706,in1Min59706])
Glo59876 = keras.layers.GlobalAveragePooling1D(name = 'Glo59876', )(Min59706)
Res55719 = keras.layers.Reshape((2, 1), name = 'Res55719', )(Glo59876)
Res98399 = keras.layers.Reshape((2, 1, 1), name = 'Res98399', )(Res55719)
Cro2404 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro2404', )(Res98399)
Zer29076 = keras.layers.ZeroPadding2D(padding=((3, 0), (4, 0)), name = 'Zer29076', )(Cro2404)
Con20173 = keras.layers.Concatenate(axis=3, name = 'Con20173', )([Zer29076,in0Con20173])
Bat94095 = keras.layers.BatchNormalization(axis=3, epsilon=0.1344621645591081,  name = 'Bat94095', )(in0Bat94095)
Zer58974 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer58974', )(Bat94095)
Min23657 = keras.layers.Minimum(name = 'Min23657', )([Con20173,Zer58974])
Res81710 = keras.layers.Reshape((5, 5, 2, 1), name = 'Res81710', )(Min23657)
Glo77848 = keras.layers.GlobalMaxPool3D(name = 'Glo77848', )(Res81710)
Res70659 = keras.layers.Reshape((1, 1), name = 'Res70659', )(Glo77848)
Res21755 = keras.layers.Reshape((1, 1, 1), name = 'Res21755', )(Res70659)
Up_50879 = keras.layers.UpSampling2D(size=(1, 1), name = 'Up_50879', )(Res21755)
model = tf.keras.models.Model(inputs=[in0Min59706,in1Min59706,in0Con20173,in0Bat94095], outputs=Up_50879)
w = model.get_layer('Bat94095').get_weights() 
w[0] = np.array([0.2249, 0.0173])
w[1] = np.array([0.9636, 0.8258])
w[2] = np.array([0.1335, 0.8401])
w[3] = np.array([0.698, 0.5])
model.get_layer('Bat94095').set_weights(w) 
in0Min59706 = tf.constant([[[0.3825, 0.9517], [0.0257, 0.0286]]])
in1Min59706 = tf.constant([[[0.5839, 0.4418], [0.6132, 0.7181]]])
in0Con20173 = tf.constant([[[[0.5246], [0.4313], [0.9915], [0.6652], [0.0876]], [[0.0978], [0.0268], [0.0194], [0.5891], [0.3733]], [[0.5384], [0.5907], [0.3402], [0.5129], [0.6158]], [[0.081], [0.819], [0.6409], [0.8127], [0.74]], [[0.0715], [0.4919], [0.3495], [0.8338], [0.6966]]]])
in0Bat94095 = tf.constant([[[[1.8764, 1.2558], [1.6858, 1.3369], [1.9516, 1.5489]], [[1.347, 1.5733], [1.2362, 1.6643], [1.6983, 1.7146]], [[1.9407, 1.2816], [1.9905, 1.7], [1.0044, 1.7909]]]])
print (np.array2string(model.predict([in0Min59706,in1Min59706,in0Con20173,in0Bat94095],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_50879.png')

LMin59706 = minimum_layer([[[[0.3825, 0.9517], [0.0257, 0.0286]]], [[[0.5839, 0.4418], [0.6132, 0.7181]]]], Min59706), 
LGlo59876 = global_average_pooling1D_layer(Min59706, Glo59876), 
LRes55719 = reshape_layer(Glo59876, [2, 1], Res55719), 
LRes98399 = reshape_layer(Res55719, [2, 1, 1], Res98399), 
LCro2404 = cropping2D_layer(Res98399, 0, 0, 0, 0, Cro2404), 
LZer29076 = zero_padding2D_layer(Cro2404, 3, 0, 4, 0, Zer29076), 
LCon20173 = concatenate_layer([Zer29076,[[[[0.5246], [0.4313], [0.9915], [0.6652], [0.0876]], [[0.0978], [0.0268], [0.0194], [0.5891], [0.3733]], [[0.5384], [0.5907], [0.3402], [0.5129], [0.6158]], [[0.081], [0.819], [0.6409], [0.8127], [0.74]], [[0.0715], [0.4919], [0.3495], [0.8338], [0.6966]]]]], 3, Con20173), 
LBat94095 = batch_normalization_layer([[[[1.8764, 1.2558], [1.6858, 1.3369], [1.9516, 1.5489]], [[1.347, 1.5733], [1.2362, 1.6643], [1.6983, 1.7146]], [[1.9407, 1.2816], [1.9905, 1.7], [1.0044, 1.7909]]]], 3, 0.1344621645591081, [0.2249, 0.0173], [0.9636, 0.8258], [0.1335, 0.8401], [0.698, 0.5], Bat94095), 
LZer58974 = zero_padding2D_layer(Bat94095, 1, 1, 1, 1, Zer58974), 
LMin23657 = minimum_layer([Con20173,Zer58974], Min23657), 
LRes81710 = reshape_layer(Min23657, [5, 5, 2, 1], Res81710), 
LGlo77848 = global_max_pool3D_layer(Res81710, Glo77848), 
LRes70659 = reshape_layer(Glo77848, [1, 1], Res70659), 
LRes21755 = reshape_layer(Res70659, [1, 1, 1], Res21755), 
LUp_50879 = up_sampling2D_layer(Res21755, 1, 1, Up_50879), 
exec_layers([LMin59706,LGlo59876,LRes55719,LRes98399,LCro2404,LZer29076,LCon20173,LBat94095,LZer58974,LMin23657,LRes81710,LGlo77848,LRes70659,LRes21755,LUp_50879],["Min59706","Glo59876","Res55719","Res98399","Cro2404","Zer29076","Con20173","Bat94095","Zer58974","Min23657","Res81710","Glo77848","Res70659","Res21755","Up_50879"],Up_50879,"Up_50879")

Actual (Unparsed): [[[[0.8190000]]]]

Expected (Unparsed): [[[[0.819]]]]

Actual:   [[[[0.819]]]]

Expected: [[[[0.819]]]]