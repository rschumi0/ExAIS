import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub62458 = tf.keras.layers.Input(shape=([2]))
in1Sub62458 = tf.keras.layers.Input(shape=([2]))
in0Con69080 = tf.keras.layers.Input(shape=([4, 1, 1]))
in0Max78822 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max78822 = tf.keras.layers.Input(shape=([2, 1, 2]))

Sub62458 = keras.layers.Subtract(name = 'Sub62458', )([in0Sub62458,in1Sub62458])
Res22133 = keras.layers.Reshape((2, 1), name = 'Res22133', )(Sub62458)
Zer10878 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer10878', )(Res22133)
Res57807 = keras.layers.Reshape((4, 1, 1), name = 'Res57807', )(Zer10878)
Con69080 = keras.layers.Concatenate(axis=3, name = 'Con69080', )([Res57807,in0Con69080])
Max78822 = keras.layers.Maximum(name = 'Max78822', )([in0Max78822,in1Max78822])
Zer36765 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer36765', )(Max78822)
Add88072 = keras.layers.Add(name = 'Add88072', )([Con69080,Zer36765])
model = tf.keras.models.Model(inputs=[in0Sub62458,in1Sub62458,in0Con69080,in0Max78822,in1Max78822], outputs=Add88072)
in0Sub62458 = tf.constant([[0.9751, 0.453]])
in1Sub62458 = tf.constant([[0.5534, 0.5789]])
in0Con69080 = tf.constant([[[[0.1204]], [[0.6256]], [[0.6598]], [[0.4916]]]])
in0Max78822 = tf.constant([[[[0.3669, 0.3329]], [[0.7423, 0.3212]]]])
in1Max78822 = tf.constant([[[[0.7944, 0.9567]], [[0.9776, 0.0246]]]])
print (np.array2string(model.predict([in0Sub62458,in1Sub62458,in0Con69080,in0Max78822,in1Max78822],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add88072.png')

LSub62458 = subtract_layer([[0.9751, 0.453]], [[0.5534, 0.5789]], Sub62458), 
LRes22133 = reshape_layer(Sub62458, [2, 1], Res22133), 
LZer10878 = zero_padding1D_layer(Res22133, 1, 1, Zer10878), 
LRes57807 = reshape_layer(Zer10878, [4, 1, 1], Res57807), 
LCon69080 = concatenate_layer([Res57807,[[[[0.1204]], [[0.6256]], [[0.6598]], [[0.4916]]]]], 3, Con69080), 
LMax78822 = maximum_layer([[[[[0.3669, 0.3329]], [[0.7423, 0.3212]]]], [[[[0.7944, 0.9567]], [[0.9776, 0.0246]]]]], Max78822), 
LZer36765 = zero_padding2D_layer(Max78822, 2, 0, 0, 0, Zer36765), 
LAdd88072 = add_layer([Con69080,Zer36765], Add88072), 
exec_layers([LSub62458,LRes22133,LZer10878,LRes57807,LCon69080,LMax78822,LZer36765,LAdd88072],["Sub62458","Res22133","Zer10878","Res57807","Con69080","Max78822","Zer36765","Add88072"],Add88072,"Add88072")

Actual (Unparsed): [[[[0.0000000, 0.1204000]], [[0.4217000, 0.6256000]], [[0.6685000, 1.6165000]], [[0.9776000, 0.8128000]]]]

Expected (Unparsed): [[[[0,0.1204]],[[0.42169999999999996,0.6256]],[[0.6685000000000001,1.6165]],[[0.9776,0.8128]]]]

Actual:   [[[[0, 0.1204]], [[0.4217, 0.6256]], [[0.6685, 1.6165]], [[0.9776, 0.8128]]]]

Expected: [[[[0, 0.1204]], [[0.4217, 0.6256]], [[0.6686, 1.6165]], [[0.9776, 0.8128]]]]