import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min69629 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Min69629 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Min69629 = keras.layers.Minimum(name = 'Min69629', )([in0Min69629,in1Min69629])
Res91401 = keras.layers.Reshape((1, 2, 4), name = 'Res91401', )(Min69629)
Con81880 = keras.layers.Conv2DTranspose(4, (1, 2),strides=(1, 1), padding='valid', name = 'Con81880', )(Res91401)
Res48399 = keras.layers.Reshape((1, 12), name = 'Res48399', )(Con81880)
Glo63025 = keras.layers.GlobalMaxPool1D(name = 'Glo63025', )(Res48399)
Res75501 = keras.layers.Reshape((12, 1), name = 'Res75501', )(Glo63025)
Res43674 = keras.layers.Reshape((12, 1, 1), name = 'Res43674', )(Res75501)
Ave88728 = keras.layers.AveragePooling2D(pool_size=(6, 1), strides=(10, 6), padding='valid', name = 'Ave88728', )(Res43674)
model = tf.keras.models.Model(inputs=[in0Min69629,in1Min69629], outputs=Ave88728)
w = model.get_layer('Con81880').get_weights() 
w[0] = np.array([[[[0.0535, 0.2826, 0.1523, 0.6122], [0.474, 0.1735, 0.7894, 0.8811], [0.323, 0.0155, 0.713, 0.1752], [0.1964, 0.4603, 0.7274, 0.5038]], [[0.2415, 0.118, 0.3622, 0.3031], [0.0684, 0.4092, 0.4659, 0.4456], [0.0433, 0.0532, 0.0728, 0.9776], [0.9982, 0.0831, 0.3203, 0.9121]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con81880').set_weights(w) 
in0Min69629 = tf.constant([[[[[0.6117, 0.9288], [0.3834, 0.6032]], [[0.8783, 0.3282], [0.7841, 0.7975]]]]])
in1Min69629 = tf.constant([[[[[0.2733, 0.6939], [0.6633, 0.2795]], [[0.0122, 0.12], [0.5378, 0.0692]]]]])
print (np.array2string(model.predict([in0Min69629,in1Min69629],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave88728.png')

LMin69629 = minimum_layer([[[[[[0.6117, 0.9288], [0.3834, 0.6032]], [[0.8783, 0.3282], [0.7841, 0.7975]]]]], [[[[[0.2733, 0.6939], [0.6633, 0.2795]], [[0.0122, 0.12], [0.5378, 0.0692]]]]]], Min69629), 
LRes91401 = reshape_layer(Min69629, [1, 2, 4], Res91401), 
LCon81880 = conv2D_transpose_layer(Res91401, 1, 2,[[[[0.0535, 0.2826, 0.1523, 0.6122], [0.474, 0.1735, 0.7894, 0.8811], [0.323, 0.0155, 0.713, 0.1752], [0.1964, 0.4603, 0.7274, 0.5038]], [[0.2415, 0.118, 0.3622, 0.3031], [0.0684, 0.4092, 0.4659, 0.4456], [0.0433, 0.0532, 0.0728, 0.9776], [0.9982, 0.0831, 0.3203, 0.9121]]]],[0, 0, 0, 0], 1, 1, false, Con81880), 
LRes48399 = reshape_layer(Con81880, [1, 12], Res48399), 
LGlo63025 = global_max_pool1D_layer(Res48399, Glo63025), 
LRes75501 = reshape_layer(Glo63025, [12, 1], Res75501), 
LRes43674 = reshape_layer(Res75501, [12, 1, 1], Res43674), 
LAve88728 = average_pooling2D_layer(Res43674, 6, 1, 10, 6, false, Ave88728), 
exec_layers([LMin69629,LRes91401,LCon81880,LRes48399,LGlo63025,LRes75501,LRes43674,LAve88728],["Min69629","Res91401","Con81880","Res48399","Glo63025","Res75501","Res43674","Ave88728"],Ave88728,"Ave88728")

Actual (Unparsed): [[[[0.6835739]]]]

Expected (Unparsed): [[[[0.6835738716666667]]]]

Actual:   [[[[0.6836]]]]

Expected: [[[[0.6836]]]]