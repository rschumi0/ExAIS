import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min36552 = tf.keras.layers.Input(shape=([2, 2]))
in1Min36552 = tf.keras.layers.Input(shape=([2, 2]))
in0Con28470 = tf.keras.layers.Input(shape=([2, 1]))
in0Lea52131 = tf.keras.layers.Input(shape=([2, 2]))

Min36552 = keras.layers.Minimum(name = 'Min36552', )([in0Min36552,in1Min36552])
LST23199 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST23199', )(Min36552)
Res93357 = keras.layers.Reshape((1, 1), name = 'Res93357', )(LST23199)
Zer48593 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer48593', )(Res93357)
Con28470 = keras.layers.Concatenate(axis=2, name = 'Con28470', )([Zer48593,in0Con28470])
Lea52131 = keras.layers.LeakyReLU(alpha=8.193059280843414, name = 'Lea52131', input_shape=(2, 2))(in0Lea52131)
ReL13670 = keras.layers.ReLU(max_value=8.953747601143515, negative_slope=7.538747826657613, threshold=0.12740852723925888, name = 'ReL13670', )(Lea52131)
Max37911 = keras.layers.Maximum(name = 'Max37911', )([Con28470,ReL13670])
model = tf.keras.models.Model(inputs=[in0Min36552,in1Min36552,in0Con28470,in0Lea52131], outputs=Max37911)
w = model.get_layer('LST23199').get_weights() 
w[0] = np.array([[7, 10, 9, 7], [6, 2, 7, 6]])
w[1] = np.array([[4, 8, 4, 1]])
w[2] = np.array([7, 10, 9, 10])
model.get_layer('LST23199').set_weights(w) 
in0Min36552 = tf.constant([[[0.6574, 0.9197], [0.1335, 0.8798]]])
in1Min36552 = tf.constant([[[0.6479, 0.2918], [0.2864, 0.6326]]])
in0Con28470 = tf.constant([[[0.1133], [0.662]]])
in0Lea52131 = tf.constant([[[0.7642, 0.6016], [0.9838, 0.0877]]])
print (np.array2string(model.predict([in0Min36552,in1Min36552,in0Con28470,in0Lea52131],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max37911.png')

LMin36552 = minimum_layer([[[[0.6574, 0.9197], [0.1335, 0.8798]]], [[[0.6479, 0.2918], [0.2864, 0.6326]]]], Min36552), 
LLST23199 = lstm_layer(Min36552,[[7, 10, 9, 7], [6, 2, 7, 6]],[[4, 8, 4, 1]],[7, 10, 9, 10], LST23199), 
LRes93357 = reshape_layer(LST23199, [1, 1], Res93357), 
LZer48593 = zero_padding1D_layer(Res93357, 1, 0, Zer48593), 
LCon28470 = concatenate_layer([Zer48593,[[[0.1133], [0.662]]]], 2, Con28470), 
LLea52131 = leaky_relu_layer([[[0.7642, 0.6016], [0.9838, 0.0877]]], 8.193059280843414, Lea52131), 
LReL13670 = relu_layer(Lea52131, 8.953747601143515, 7.538747826657613, 0.12740852723925888, ReL13670), 
LMax37911 = maximum_layer([Con28470,ReL13670], Max37911), 
exec_layers([LMin36552,LLST23199,LRes93357,LZer48593,LCon28470,LLea52131,LReL13670,LMax37911],["Min36552","LST23199","Res93357","Zer48593","Con28470","Lea52131","ReL13670","Max37911"],Max37911,"Max37911")

Actual (Unparsed): [[[0.7642000, 0.6016000], [0.9838000, 0.6620000]]]

Expected (Unparsed): [[[0.7642,0.6016],[0.9838,0.662]]]

Actual:   [[[0.7642, 0.6016], [0.9838, 0.662]]]

Expected: [[[0.7642, 0.6016], [0.9838, 0.662]]]