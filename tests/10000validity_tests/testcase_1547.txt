import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per52782 = tf.keras.layers.Input(shape=([3, 4]))

Per52782 = keras.layers.Permute((1,2), name = 'Per52782',)(in0Per52782)
Den92550 = keras.layers.Dense(1,name = 'Den92550', )(Per52782)
Res28482 = keras.layers.Reshape((3, 1, 1), name = 'Res28482', )(Den92550)
Sep49507 = keras.layers.SeparableConv2D(4, (2, 1),strides=(3, 3), padding='valid', name = 'Sep49507', )(Res28482)
Cro54987 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro54987', )(Sep49507)
Zer62527 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer62527', )(Cro54987)
model = tf.keras.models.Model(inputs=[in0Per52782], outputs=Zer62527)
w = model.get_layer('Den92550').get_weights() 
w[0] = np.array([[0.6747], [0.8983], [0.3797], [0.7523]])
w[1] = np.array([0.5134])
model.get_layer('Den92550').set_weights(w) 
w = model.get_layer('Sep49507').get_weights() 
w[0] = np.array([[[[0.7643]]], [[[0.9129]]]])
w[1] = np.array([[[[0.6657, 0.4084, 0.9061, 0.8916]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep49507').set_weights(w) 
in0Per52782 = tf.constant([[[1.3232, 1.091, 1.6424, 1.9489], [1.7123, 1.1886, 1.1916, 1.1426], [1.672, 1.8918, 1.6788, 1.2928]]])
print (np.array2string(model.predict([in0Per52782],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer62527.png')

LPer52782 = permute_layer([[[1.3232, 1.091, 1.6424, 1.9489], [1.7123, 1.1886, 1.1916, 1.1426], [1.672, 1.8918, 1.6788, 1.2928]]], 1,2, Per52782), 
LDen92550 = dense_layer(Per52782, [[0.6747], [0.8983], [0.3797], [0.7523]],[0.5134], Den92550), 
LRes28482 = reshape_layer(Den92550, [3, 1, 1], Res28482), 
LSep49507 = separable_conv2D_layer(Res28482, 2, 1,[[[[[0.7643]]], [[[0.9129]]]],[[[[0.6657, 0.4084, 0.9061, 0.8916]]]]],[0, 0, 0, 0], 3, 3, false, Sep49507), 
LCro54987 = cropping2D_layer(Sep49507, 0, 0, 0, 0, Cro54987), 
LZer62527 = zero_padding2D_layer(Cro54987, 1, 1, 1, 1, Zer62527), 
exec_layers([LPer52782,LDen92550,LRes28482,LSep49507,LCro54987,LZer62527],["Per52782","Den92550","Res28482","Sep49507","Cro54987","Zer62527"],Zer62527,"Zer62527")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [4.7376625, 2.9065065, 6.4485444, 6.3453506], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[4.737662586242031,2.906506534807339,6.448544493606587,6.34535070135706],[0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0,0,0,0]]]]

Actual:   [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [4.7377, 2.9066, 6.4486, 6.3454], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]]

Expected: [[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [4.7377, 2.9066, 6.4486, 6.3454], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]]