import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep17138 = tf.keras.layers.Input(shape=([2, 2]))
in0Min42095 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min42095 = tf.keras.layers.Input(shape=([1, 1, 1]))

Sep17138 = keras.layers.SeparableConv1D(2, (1),strides=(2), padding='same', name = 'Sep17138', )(in0Sep17138)
Res47333 = keras.layers.Reshape((1, 2, 1), name = 'Res47333', )(Sep17138)
Min42095 = keras.layers.Minimum(name = 'Min42095', )([in0Min42095,in1Min42095])
Zer50085 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer50085', )(Min42095)
Ave87292 = keras.layers.Average(name = 'Ave87292', )([Res47333,Zer50085])
model = tf.keras.models.Model(inputs=[in0Sep17138,in0Min42095,in1Min42095], outputs=Ave87292)
w = model.get_layer('Sep17138').get_weights() 
w[0] = np.array([[[0.6808], [0.6244]]])
w[1] = np.array([[[0.42, 0.4826], [0.812, 0.6431]]])
w[2] = np.array([0, 0])
model.get_layer('Sep17138').set_weights(w) 
in0Sep17138 = tf.constant([[[0.4647, 0.0514], [0.8982, 0.5285]]])
in0Min42095 = tf.constant([[[[0.1031]]]])
in1Min42095 = tf.constant([[[[0.0972]]]])
print (np.array2string(model.predict([in0Sep17138,in0Min42095,in1Min42095],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave87292.png')

LSep17138 = separable_conv1D_layer([[[0.4647, 0.0514], [0.8982, 0.5285]]], 1,[[[[0.6808], [0.6244]]],[[[0.42, 0.4826], [0.812, 0.6431]]]],[0, 0], 2, true, Sep17138), 
LRes47333 = reshape_layer(Sep17138, [1, 2, 1], Res47333), 
LMin42095 = minimum_layer([[[[[0.1031]]]], [[[[0.0972]]]]], Min42095), 
LZer50085 = zero_padding2D_layer(Min42095, 0, 0, 1, 0, Zer50085), 
LAve87292 = average_layer([Res47333,Zer50085], Ave87292), 
exec_layers([LSep17138,LRes47333,LMin42095,LZer50085,LAve87292],["Sep17138","Res47333","Min42095","Zer50085","Ave87292"],Ave87292,"Ave87292")

Actual (Unparsed): [[[[0.0794675], [0.1352594]]]]

Expected (Unparsed): [[[[0.07946745856],[0.135259417636]]]]

Actual:   [[[[0.0795], [0.1353]]]]

Expected: [[[[0.0795], [0.1353]]]]