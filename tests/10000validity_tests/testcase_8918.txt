import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add90425 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Add90425 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Add90425 = keras.layers.Add(name = 'Add90425', )([in0Add90425,in1Add90425])
Zer70732 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer70732', )(Add90425)
Res46064 = keras.layers.Reshape((4, 4, 6), name = 'Res46064', )(Zer70732)
Res27379 = keras.layers.Reshape((4, 24), name = 'Res27379', )(Res46064)
GRU26745 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU26745', )(Res27379)
model = tf.keras.models.Model(inputs=[in0Add90425,in1Add90425], outputs=GRU26745)
w = model.get_layer('GRU26745').get_weights() 
w[0] = np.array([[1, 2, 5, 3, 2, 10, 4, 8, 1], [3, 10, 7, 9, 8, 2, 9, 7, 1], [1, 1, 7, 10, 4, 8, 2, 6, 7], [10, 7, 2, 4, 1, 5, 4, 4, 6], [6, 4, 8, 5, 1, 5, 6, 8, 9], [9, 10, 6, 8, 6, 8, 3, 3, 10], [2, 1, 4, 5, 6, 5, 10, 1, 1], [6, 5, 2, 7, 4, 7, 3, 1, 2], [10, 1, 5, 6, 4, 2, 9, 1, 7], [7, 5, 8, 4, 7, 10, 7, 10, 4], [1, 8, 3, 4, 7, 3, 7, 1, 1], [3, 6, 10, 9, 6, 8, 1, 2, 1], [3, 2, 3, 3, 3, 10, 7, 7, 3], [4, 6, 1, 8, 2, 5, 2, 5, 10], [10, 7, 1, 3, 2, 6, 8, 4, 10], [9, 5, 10, 5, 6, 3, 9, 5, 4], [2, 3, 7, 1, 10, 5, 3, 9, 1], [4, 10, 8, 4, 10, 8, 4, 8, 1], [5, 4, 4, 4, 3, 3, 6, 3, 1], [10, 2, 4, 7, 4, 4, 9, 1, 10], [4, 7, 9, 9, 9, 6, 10, 8, 10], [7, 2, 2, 9, 9, 3, 7, 8, 5], [8, 1, 3, 2, 1, 9, 5, 1, 2], [8, 9, 6, 7, 8, 8, 10, 3, 6]])
w[1] = np.array([[2, 9, 4, 10, 6, 4, 2, 4, 6], [9, 5, 10, 6, 6, 7, 5, 3, 9], [6, 4, 5, 1, 3, 10, 2, 1, 5]])
w[2] = np.array([[2, 2, 9, 10, 9, 1, 6, 2, 1], [7, 4, 4, 4, 6, 4, 8, 6, 7]])
model.get_layer('GRU26745').set_weights(w) 
in0Add90425 = tf.constant([[[[[0.3153, 0.1622]], [[0.9789, 0.3985]]], [[[0.007, 0.8231]], [[0.0892, 0.182]]]]])
in1Add90425 = tf.constant([[[[[0.5071, 0.5407]], [[0.3789, 0.0531]]], [[[0.3456, 0.0642]], [[0.5716, 0.5762]]]]])
print (np.array2string(model.predict([in0Add90425,in1Add90425],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU26745.png')

LAdd90425 = add_layer([[[[[[0.3153, 0.1622]], [[0.9789, 0.3985]]], [[[0.007, 0.8231]], [[0.0892, 0.182]]]]], [[[[[0.5071, 0.5407]], [[0.3789, 0.0531]]], [[[0.3456, 0.0642]], [[0.5716, 0.5762]]]]]], Add90425), 
LZer70732 = zero_padding3D_layer(Add90425, 1, 1, 1, 1, 1, 1, Zer70732), 
LRes46064 = reshape_layer(Zer70732, [4, 4, 6], Res46064), 
LRes27379 = reshape_layer(Res46064, [4, 24], Res27379), 
LGRU26745 = gru_layer(Res27379,[[1, 2, 5, 3, 2, 10, 4, 8, 1], [3, 10, 7, 9, 8, 2, 9, 7, 1], [1, 1, 7, 10, 4, 8, 2, 6, 7], [10, 7, 2, 4, 1, 5, 4, 4, 6], [6, 4, 8, 5, 1, 5, 6, 8, 9], [9, 10, 6, 8, 6, 8, 3, 3, 10], [2, 1, 4, 5, 6, 5, 10, 1, 1], [6, 5, 2, 7, 4, 7, 3, 1, 2], [10, 1, 5, 6, 4, 2, 9, 1, 7], [7, 5, 8, 4, 7, 10, 7, 10, 4], [1, 8, 3, 4, 7, 3, 7, 1, 1], [3, 6, 10, 9, 6, 8, 1, 2, 1], [3, 2, 3, 3, 3, 10, 7, 7, 3], [4, 6, 1, 8, 2, 5, 2, 5, 10], [10, 7, 1, 3, 2, 6, 8, 4, 10], [9, 5, 10, 5, 6, 3, 9, 5, 4], [2, 3, 7, 1, 10, 5, 3, 9, 1], [4, 10, 8, 4, 10, 8, 4, 8, 1], [5, 4, 4, 4, 3, 3, 6, 3, 1], [10, 2, 4, 7, 4, 4, 9, 1, 10], [4, 7, 9, 9, 9, 6, 10, 8, 10], [7, 2, 2, 9, 9, 3, 7, 8, 5], [8, 1, 3, 2, 1, 9, 5, 1, 2], [8, 9, 6, 7, 8, 8, 10, 3, 6]],[[2, 9, 4, 10, 6, 4, 2, 4, 6], [9, 5, 10, 6, 6, 7, 5, 3, 9], [6, 4, 5, 1, 3, 10, 2, 1, 5]],[[2, 2, 9, 10, 9, 1, 6, 2, 1], [7, 4, 4, 4, 6, 4, 8, 6, 7]], true, GRU26745), 
exec_layers([LAdd90425,LZer70732,LRes46064,LRes27379,LGRU26745],["Add90425","Zer70732","Res46064","Res27379","GRU26745"],GRU26745,"GRU26745")

Actual (Unparsed): [[0.0002440, 0.0049062, 0.0000045]]

Expected (Unparsed): [[0.00024402753073657786,0.004906184568038634,4.464326076234027e-6]]

Actual:   [[0.0003, 0.005, 0]]

Expected: [[0.0003, 0.005, 0]]