import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub47711 = tf.keras.layers.Input(shape=([3]))
in1Sub47711 = tf.keras.layers.Input(shape=([3]))

Sub47711 = keras.layers.Subtract(name = 'Sub47711', )([in0Sub47711,in1Sub47711])
Res69501 = keras.layers.Reshape((3, 1), name = 'Res69501', )(Sub47711)
GRU62958 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU62958', )(Res69501)
Res84423 = keras.layers.Reshape((2, 1), name = 'Res84423', )(GRU62958)
Res99379 = keras.layers.Reshape((2, 1, 1), name = 'Res99379', )(Res84423)
Max92800 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max92800', )(Res99379)
Res11621 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res11621', )(Max92800)
PRe13511 = keras.layers.PReLU(name = 'PRe13511', )(Res11621)
model = tf.keras.models.Model(inputs=[in0Sub47711,in1Sub47711], outputs=PRe13511)
w = model.get_layer('GRU62958').get_weights() 
w[0] = np.array([[3, 9, 4, 7, 5, 3]])
w[1] = np.array([[1, 9, 10, 8, 9, 6], [7, 10, 1, 9, 7, 9]])
w[2] = np.array([[2, 3, 9, 10, 8, 10], [6, 7, 4, 3, 2, 4]])
model.get_layer('GRU62958').set_weights(w) 
w = model.get_layer('PRe13511').get_weights() 
w[0] = np.array([[[[0.5075]]]])
model.get_layer('PRe13511').set_weights(w) 
in0Sub47711 = tf.constant([[0.3156, 0.0648, 0.2719]])
in1Sub47711 = tf.constant([[0.5374, 0.8947, 0.3336]])
print (np.array2string(model.predict([in0Sub47711,in1Sub47711],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe13511.png')

LSub47711 = subtract_layer([[0.3156, 0.0648, 0.2719]], [[0.5374, 0.8947, 0.3336]], Sub47711), 
LRes69501 = reshape_layer(Sub47711, [3, 1], Res69501), 
LGRU62958 = gru_layer(Res69501,[[3, 9, 4, 7, 5, 3]],[[1, 9, 10, 8, 9, 6], [7, 10, 1, 9, 7, 9]],[[2, 3, 9, 10, 8, 10], [6, 7, 4, 3, 2, 4]], true, GRU62958), 
LRes84423 = reshape_layer(GRU62958, [2, 1], Res84423), 
LRes99379 = reshape_layer(Res84423, [2, 1, 1], Res99379), 
LMax92800 = max_pool2D_layer(Res99379, 2, 1, Max92800), 
LRes11621 = reshape_layer(Max92800, [1, 1, 1, 1], Res11621), 
LPRe13511 = prelu_layer(Res11621, [[[[0.5075]]]], PRe13511), 
exec_layers([LSub47711,LRes69501,LGRU62958,LRes84423,LRes99379,LMax92800,LRes11621,LPRe13511],["Sub47711","Res69501","GRU62958","Res84423","Res99379","Max92800","Res11621","PRe13511"],PRe13511,"PRe13511")

Actual (Unparsed): [[[[[0.0734371]]]]]

Expected (Unparsed): [[[[[0.07343711141367162]]]]]

Actual:   [[[[[0.0735]]]]]

Expected: [[[[[0.0735]]]]]