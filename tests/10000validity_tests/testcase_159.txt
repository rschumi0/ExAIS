import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max75680 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Max75680 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Zer39766 = tf.keras.layers.Input(shape=([4, 4, 1]))
in0Con2688 = tf.keras.layers.Input(shape=([6, 6, 1]))

Max75680 = keras.layers.Maximum(name = 'Max75680', )([in0Max75680,in1Max75680])
Res97677 = keras.layers.Reshape((1, 1, 2), name = 'Res97677', )(Max75680)
Zer93 = keras.layers.ZeroPadding2D(padding=((5, 0), (5, 0)), name = 'Zer93', )(Res97677)
Zer39766 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer39766', )(in0Zer39766)
Con2688 = keras.layers.Concatenate(axis=3, name = 'Con2688', )([Zer39766,in0Con2688])
Ave95377 = keras.layers.Average(name = 'Ave95377', )([Zer93,Con2688])
model = tf.keras.models.Model(inputs=[in0Max75680,in1Max75680,in0Zer39766,in0Con2688], outputs=Ave95377)
in0Max75680 = tf.constant([[[[[0.8768, 0.1719]]]]])
in1Max75680 = tf.constant([[[[[0.6679, 0.7164]]]]])
in0Zer39766 = tf.constant([[[[1.7407], [1.1614], [1.8558], [1.4594]], [[1.5339], [1.0552], [1.1624], [1.7423]], [[1.9478], [1.6744], [1.4407], [1.4715]], [[1.2976], [1.0942], [1.5739], [1.6003]]]])
in0Con2688 = tf.constant([[[[0.9187], [0.4278], [0.4305], [0.8528], [0.064], [0.4686]], [[0.2016], [0.0157], [0.2844], [0.4271], [0.7943], [0.0937]], [[0.2688], [0.7193], [0.8996], [0.472], [0.1436], [0.8755]], [[0.8946], [0.3669], [0.0119], [0.3708], [0.2147], [0.8924]], [[0.5834], [0.1347], [0.6412], [0.1794], [0.4424], [0.8692]], [[0.3987], [0.2765], [0.1093], [0.4833], [0.0162], [0.317]]]])
print (np.array2string(model.predict([in0Max75680,in1Max75680,in0Zer39766,in0Con2688],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave95377.png')

LMax75680 = maximum_layer([[[[[[0.8768, 0.1719]]]]], [[[[[0.6679, 0.7164]]]]]], Max75680), 
LRes97677 = reshape_layer(Max75680, [1, 1, 2], Res97677), 
LZer93 = zero_padding2D_layer(Res97677, 5, 0, 5, 0, Zer93), 
LZer39766 = zero_padding2D_layer([[[[1.7407], [1.1614], [1.8558], [1.4594]], [[1.5339], [1.0552], [1.1624], [1.7423]], [[1.9478], [1.6744], [1.4407], [1.4715]], [[1.2976], [1.0942], [1.5739], [1.6003]]]], 1, 1, 1, 1, Zer39766), 
LCon2688 = concatenate_layer([Zer39766,[[[[0.9187], [0.4278], [0.4305], [0.8528], [0.064], [0.4686]], [[0.2016], [0.0157], [0.2844], [0.4271], [0.7943], [0.0937]], [[0.2688], [0.7193], [0.8996], [0.472], [0.1436], [0.8755]], [[0.8946], [0.3669], [0.0119], [0.3708], [0.2147], [0.8924]], [[0.5834], [0.1347], [0.6412], [0.1794], [0.4424], [0.8692]], [[0.3987], [0.2765], [0.1093], [0.4833], [0.0162], [0.317]]]]], 3, Con2688), 
LAve95377 = average_layer([Zer93,Con2688], Ave95377), 
exec_layers([LMax75680,LRes97677,LZer93,LZer39766,LCon2688,LAve95377],["Max75680","Res97677","Zer93","Zer39766","Con2688","Ave95377"],Ave95377,"Ave95377")

Actual (Unparsed): [[[[0.0000000, 0.4593500], [0.0000000, 0.2139000], [0.0000000, 0.2152500], [0.0000000, 0.4264000], [0.0000000, 0.0320000], [0.0000000, 0.2343000]], [[0.0000000, 0.1008000], [0.8703500, 0.0078500], [0.5807000, 0.1422000], [0.9279000, 0.2135500], [0.7297000, 0.3971500], [0.0000000, 0.0468500]], [[0.0000000, 0.1344000], [0.7669500, 0.3596500], [0.5276000, 0.4498000], [0.5812000, 0.2360000], [0.8711500, 0.0718000], [0.0000000, 0.4377500]], [[0.0000000, 0.4473000], [0.9739000, 0.1834500], [0.8372000, 0.0059500], [0.7203500, 0.1854000], [0.7357500, 0.1073500], [0.0000000, 0.4462000]], [[0.0000000, 0.2917000], [0.6488000, 0.0673500], [0.5471000, 0.3206000], [0.7869500, 0.0897000], [0.8001500, 0.2212000], [0.0000000, 0.4346000]], [[0.0000000, 0.1993500], [0.0000000, 0.1382500], [0.0000000, 0.0546500], [0.0000000, 0.2416500], [0.0000000, 0.0081000], [0.4384000, 0.5167000]]]]

Expected (Unparsed): [[[[0,0.45935],[0,0.2139],[0,0.21525],[0,0.4264],[0,0.032],[0,0.2343]],[[0,0.1008],[0.87035,0.00785],[0.5807,0.1422],[0.9279,0.21355],[0.7297,0.39715],[0,0.04685]],[[0,0.1344],[0.76695,0.35965],[0.5276,0.4498],[0.5812,0.236],[0.87115,0.0718],[0,0.43775]],[[0,0.4473],[0.9739,0.18345],[0.8372,0.00595],[0.72035,0.1854],[0.73575,0.10735],[0,0.4462]],[[0,0.2917],[0.6488,0.06735],[0.5471,0.3206],[0.78695,0.0897],[0.80015,0.2212],[0,0.4346]],[[0,0.19935],[0,0.13825],[0,0.05465],[0,0.24165],[0,0.0081],[0.4384,0.5167]]]]

Actual:   [[[[0, 0.4594], [0, 0.2139], [0, 0.2153], [0, 0.4264], [0, 0.032], [0, 0.2343]], [[0, 0.1008], [0.8704, 0.0079], [0.5807, 0.1422], [0.9279, 0.2136], [0.7297, 0.3972], [0, 0.0469]], [[0, 0.1344], [0.767, 0.3597], [0.5276, 0.4498], [0.5812, 0.236], [0.8712, 0.0718], [0, 0.4378]], [[0, 0.4473], [0.9739, 0.1835], [0.8372, 0.006], [0.7204, 0.1854], [0.7358, 0.1074], [0, 0.4462]], [[0, 0.2917], [0.6488, 0.0674], [0.5471, 0.3206], [0.787, 0.0897], [0.8002, 0.2212], [0, 0.4346]], [[0, 0.1994], [0, 0.1383], [0, 0.0547], [0, 0.2417], [0, 0.0081], [0.4384, 0.5167]]]]

Expected: [[[[0, 0.4594], [0, 0.2139], [0, 0.2153], [0, 0.4264], [0, 0.032], [0, 0.2343]], [[0, 0.1008], [0.8704, 0.0079], [0.5807, 0.1422], [0.9279, 0.2136], [0.7297, 0.3972], [0, 0.0469]], [[0, 0.1344], [0.767, 0.3597], [0.5276, 0.4498], [0.5812, 0.236], [0.8712, 0.0718], [0, 0.4378]], [[0, 0.4473], [0.9739, 0.1835], [0.8372, 0.006], [0.7204, 0.1854], [0.7358, 0.1074], [0, 0.4462]], [[0, 0.2917], [0.6488, 0.0674], [0.5471, 0.3206], [0.787, 0.0897], [0.8002, 0.2212], [0, 0.4346]], [[0, 0.1994], [0, 0.1383], [0, 0.0547], [0, 0.2417], [0, 0.0081], [0.4384, 0.5167]]]]