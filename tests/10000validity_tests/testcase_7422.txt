import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max18638 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max18638 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Glo73444 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con74123 = tf.keras.layers.Input(shape=([3]))
in0Zer51849 = tf.keras.layers.Input(shape=([3, 1]))

Max18638 = keras.layers.Maximum(name = 'Max18638', )([in0Max18638,in1Max18638])
Res85064 = keras.layers.Reshape((2, 2), name = 'Res85064', )(Max18638)
Fla24922 = keras.layers.Flatten(name = 'Fla24922', )(Res85064)
Glo73444 = keras.layers.GlobalAveragePooling2D(name = 'Glo73444', )(in0Glo73444)
Con74123 = keras.layers.Concatenate(axis=1, name = 'Con74123', )([Glo73444,in0Con74123])
Max78420 = keras.layers.Maximum(name = 'Max78420', )([Fla24922,Con74123])
Res8818 = keras.layers.Reshape((4, 1), name = 'Res8818', )(Max78420)
Zer51849 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer51849', )(in0Zer51849)
Ave31052 = keras.layers.AveragePooling1D(pool_size=(2), strides=(1), padding='valid', name = 'Ave31052', )(Zer51849)
Sub1937 = keras.layers.Subtract(name = 'Sub1937', )([Res8818,Ave31052])
model = tf.keras.models.Model(inputs=[in0Max18638,in1Max18638,in0Glo73444,in0Con74123,in0Zer51849], outputs=Sub1937)
in0Max18638 = tf.constant([[[[0.4734, 0.8688]], [[0.698, 0.8297]]]])
in1Max18638 = tf.constant([[[[0.0788, 0.3763]], [[0.4822, 0.6829]]]])
in0Glo73444 = tf.constant([[[[1.7962], [1.0843]]]])
in0Con74123 = tf.constant([[0.5325, 0.9168, 0.1014]])
in0Zer51849 = tf.constant([[[1.534], [1.613], [1.7637]]])
print (np.array2string(model.predict([in0Max18638,in1Max18638,in0Glo73444,in0Con74123,in0Zer51849],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub1937.png')

LMax18638 = maximum_layer([[[[[0.4734, 0.8688]], [[0.698, 0.8297]]]], [[[[0.0788, 0.3763]], [[0.4822, 0.6829]]]]], Max18638), 
LRes85064 = reshape_layer(Max18638, [2, 2], Res85064), 
LFla24922 = flatten_layer(Res85064, Fla24922), 
LGlo73444 = global_average_pooling2D_layer([[[[1.7962], [1.0843]]]], Glo73444), 
LCon74123 = concatenate_layer([Glo73444,[[0.5325, 0.9168, 0.1014]]], 1, Con74123), 
LMax78420 = maximum_layer([Fla24922,Con74123], Max78420), 
LRes8818 = reshape_layer(Max78420, [4, 1], Res8818), 
LZer51849 = zero_padding1D_layer([[[1.534], [1.613], [1.7637]]], 1, 1, Zer51849), 
LAve31052 = average_pooling1D_layer(Zer51849, 2, 1, false, Ave31052), 
LSub1937 = subtract_layer(Res8818,Ave31052, Sub1937), 
exec_layers([LMax18638,LRes85064,LFla24922,LGlo73444,LCon74123,LMax78420,LRes8818,LZer51849,LAve31052,LSub1937],["Max18638","Res85064","Fla24922","Glo73444","Con74123","Max78420","Res8818","Zer51849","Ave31052","Sub1937"],Sub1937,"Sub1937")

Actual (Unparsed): [[[0.6732500], [-0.7047001], [-0.7715500], [-0.0521500]]]

Expected (Unparsed): [[[0.67325],[-0.7047000000000001],[-0.7715500000000001],[-0.05215000000000003]]]

Actual:   [[[0.6733], [-0.7047], [-0.7715], [-0.0521]]]

Expected: [[[0.6733], [-0.7047], [-0.7715], [-0.0521]]]