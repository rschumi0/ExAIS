import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add50186 = tf.keras.layers.Input(shape=([1, 1]))
in1Add50186 = tf.keras.layers.Input(shape=([1, 1]))
in0Con95200 = tf.keras.layers.Input(shape=([1, 6]))
in0LST47396 = tf.keras.layers.Input(shape=([3, 3]))
in0Cro14634 = tf.keras.layers.Input(shape=([3, 4, 2]))

Add50186 = keras.layers.Add(name = 'Add50186', )([in0Add50186,in1Add50186])
Con66416 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con66416', )(Add50186)
Con95200 = keras.layers.Concatenate(axis=2, name = 'Con95200', )([Con66416,in0Con95200])
LST47396 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST47396', )(in0LST47396)
Res35059 = keras.layers.Reshape((2, 1), name = 'Res35059', )(LST47396)
Zer86100 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer86100', )(Res35059)
Cro14634 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro14634', )(in0Cro14634)
Res7349 = keras.layers.Reshape((3, 8), name = 'Res7349', )(Cro14634)
Dot42981 = keras.layers.Dot(axes=(1, 1), name = 'Dot42981', )([Zer86100,Res7349])
Add7020 = keras.layers.Add(name = 'Add7020', )([Con95200,Dot42981])
Res94232 = keras.layers.Reshape((1, 8, 1), name = 'Res94232', )(Add7020)
Res10985 = keras.layers.Reshape((1, 8, 1, 1), name = 'Res10985', )(Res94232)
Glo27053 = keras.layers.GlobalAveragePooling3D(name = 'Glo27053', )(Res10985)
model = tf.keras.models.Model(inputs=[in0Add50186,in1Add50186,in0Con95200,in0LST47396,in0Cro14634], outputs=Glo27053)
w = model.get_layer('Con66416').get_weights() 
w[0] = np.array([[[0.1778, 0.5422]]])
w[1] = np.array([0, 0])
model.get_layer('Con66416').set_weights(w) 
w = model.get_layer('LST47396').get_weights() 
w[0] = np.array([[10, 4, 4, 8, 2, 2, 5, 3], [3, 5, 10, 3, 8, 4, 3, 1], [3, 5, 9, 3, 2, 6, 7, 3]])
w[1] = np.array([[9, 4, 5, 3, 3, 8, 10, 6], [2, 4, 9, 9, 7, 2, 1, 1]])
w[2] = np.array([7, 1, 10, 1, 2, 2, 10, 6])
model.get_layer('LST47396').set_weights(w) 
in0Add50186 = tf.constant([[[0.9003]]])
in1Add50186 = tf.constant([[[0.6105]]])
in0Con95200 = tf.constant([[[0.8015, 0.4975, 0.6209, 0.5748, 0.2043, 0.9067]]])
in0LST47396 = tf.constant([[[7, 7, 9], [5, 2, 6], [10, 8, 8]]])
in0Cro14634 = tf.constant([[[[1.1128, 1.8961], [1.6554, 1.8691], [1.9678, 1.671], [1.3739, 1.9285]], [[1.9806, 1.877], [1.1043, 1.603], [1.0063, 1.0674], [1.492, 1.9414]], [[1.0643, 1.3858], [1.1929, 1.9068], [1.5431, 1.8267], [1.6086, 1.1275]]]])
print (np.array2string(model.predict([in0Add50186,in1Add50186,in0Con95200,in0LST47396,in0Cro14634],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo27053.png')

LAdd50186 = add_layer([[[[0.9003]]], [[[0.6105]]]], Add50186), 
LCon66416 = conv1D_layer(Add50186, 1,[[[0.1778, 0.5422]]],[0, 0], 1, false, 1, Con66416), 
LCon95200 = concatenate_layer([Con66416,[[[0.8015, 0.4975, 0.6209, 0.5748, 0.2043, 0.9067]]]], 2, Con95200), 
LLST47396 = lstm_layer([[[7, 7, 9], [5, 2, 6], [10, 8, 8]]],[[10, 4, 4, 8, 2, 2, 5, 3], [3, 5, 10, 3, 8, 4, 3, 1], [3, 5, 9, 3, 2, 6, 7, 3]],[[9, 4, 5, 3, 3, 8, 10, 6], [2, 4, 9, 9, 7, 2, 1, 1]],[7, 1, 10, 1, 2, 2, 10, 6], LST47396), 
LRes35059 = reshape_layer(LST47396, [2, 1], Res35059), 
LZer86100 = zero_padding1D_layer(Res35059, 1, 0, Zer86100), 
LCro14634 = cropping2D_layer([[[[1.1128, 1.8961], [1.6554, 1.8691], [1.9678, 1.671], [1.3739, 1.9285]], [[1.9806, 1.877], [1.1043, 1.603], [1.0063, 1.0674], [1.492, 1.9414]], [[1.0643, 1.3858], [1.1929, 1.9068], [1.5431, 1.8267], [1.6086, 1.1275]]]], 0, 0, 0, 0, Cro14634), 
LRes7349 = reshape_layer(Cro14634, [3, 8], Res7349), 
LDot42981 = dot_layer(Zer86100,Res7349, 1, 1, Dot42981), 
LAdd7020 = add_layer([Con95200,Dot42981], Add7020), 
LRes94232 = reshape_layer(Add7020, [1, 8, 1], Res94232), 
LRes10985 = reshape_layer(Res94232, [1, 8, 1, 1], Res10985), 
LGlo27053 = global_average_pooling3D_layer(Res10985, Glo27053), 
exec_layers([LAdd50186,LCon66416,LCon95200,LLST47396,LRes35059,LZer86100,LCro14634,LRes7349,LDot42981,LAdd7020,LRes94232,LRes10985,LGlo27053],["Add50186","Con66416","Con95200","LST47396","Res35059","Zer86100","Cro14634","Res7349","Dot42981","Add7020","Res94232","Res10985","Glo27053"],Glo27053,"Glo27053")

Actual (Unparsed): [[3.5379796]]

Expected (Unparsed): [[3.537979584881579]]

Actual:   [[3.538]]

Expected: [[3.538]]