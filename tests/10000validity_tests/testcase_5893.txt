import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul67702 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul67702 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Sof77456 = tf.keras.layers.Input(shape=([1, 2]))
in0Con50328 = tf.keras.layers.Input(shape=([2]))
in0Min79583 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min79583 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Sub45851 = tf.keras.layers.Input(shape=([3]))
in1Sub45851 = tf.keras.layers.Input(shape=([3]))
in0Con44953 = tf.keras.layers.Input(shape=([1]))

Mul67702 = keras.layers.Multiply(name = 'Mul67702', )([in0Mul67702,in1Mul67702])
Res48537 = keras.layers.Reshape((1, 2), name = 'Res48537', )(Mul67702)
Sof77456 = keras.layers.Softmax(axis=1, name = 'Sof77456', input_shape=(1, 2))(in0Sof77456)
Sub13172 = keras.layers.Subtract(name = 'Sub13172', )([Res48537,Sof77456])
Sof95881 = keras.layers.Softmax(axis=1, name = 'Sof95881', )(Sub13172)
Fla53722 = keras.layers.Flatten(name = 'Fla53722', )(Sof95881)
Con50328 = keras.layers.Concatenate(axis=1, name = 'Con50328', )([Fla53722,in0Con50328])
Min79583 = keras.layers.Minimum(name = 'Min79583', )([in0Min79583,in1Min79583])
Res49499 = keras.layers.Reshape((1, 2, 2), name = 'Res49499', )(Min79583)
Res55460 = keras.layers.Reshape((1, 4), name = 'Res55460', )(Res49499)
Glo82529 = keras.layers.GlobalAveragePooling1D(name = 'Glo82529', )(Res55460)
Sub45851 = keras.layers.Subtract(name = 'Sub45851', )([in0Sub45851,in1Sub45851])
Con44953 = keras.layers.Concatenate(axis=1, name = 'Con44953', )([Sub45851,in0Con44953])
Max19390 = keras.layers.Maximum(name = 'Max19390', )([Glo82529,Con44953])
Ave24233 = keras.layers.Average(name = 'Ave24233', )([Con50328,Max19390])
model = tf.keras.models.Model(inputs=[in0Mul67702,in1Mul67702,in0Sof77456,in0Con50328,in0Min79583,in1Min79583,in0Sub45851,in1Sub45851,in0Con44953], outputs=Ave24233)
in0Mul67702 = tf.constant([[[[0.0246], [0.0016]]]])
in1Mul67702 = tf.constant([[[[0.4224], [0.8236]]]])
in0Sof77456 = tf.constant([[[0.5387, 0.2863]]])
in0Con50328 = tf.constant([[0.5049, 0.9979]])
in0Min79583 = tf.constant([[[[[0.0358], [0.704]], [[0.5825], [0.6428]]]]])
in1Min79583 = tf.constant([[[[[0.9593], [0.9427]], [[0.1454], [0.0068]]]]])
in0Sub45851 = tf.constant([[0.4542, 0.4908, 0.6703]])
in1Sub45851 = tf.constant([[0.891, 0.212, 0.3749]])
in0Con44953 = tf.constant([[0.1337]])
print (np.array2string(model.predict([in0Mul67702,in1Mul67702,in0Sof77456,in0Con50328,in0Min79583,in1Min79583,in0Sub45851,in1Sub45851,in0Con44953],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave24233.png')

LMul67702 = multiply_layer([[[[[0.0246], [0.0016]]]], [[[[0.4224], [0.8236]]]]], Mul67702), 
LRes48537 = reshape_layer(Mul67702, [1, 2], Res48537), 
LSof77456 = softmax_layer([[[0.5387, 0.2863]]], 1, Sof77456), 
LSub13172 = subtract_layer(Res48537,Sof77456, Sub13172), 
LSof95881 = softmax_layer(Sub13172, 1, Sof95881), 
LFla53722 = flatten_layer(Sof95881, Fla53722), 
LCon50328 = concatenate_layer([Fla53722,[[0.5049, 0.9979]]], 1, Con50328), 
LMin79583 = minimum_layer([[[[[[0.0358], [0.704]], [[0.5825], [0.6428]]]]], [[[[[0.9593], [0.9427]], [[0.1454], [0.0068]]]]]], Min79583), 
LRes49499 = reshape_layer(Min79583, [1, 2, 2], Res49499), 
LRes55460 = reshape_layer(Res49499, [1, 4], Res55460), 
LGlo82529 = global_average_pooling1D_layer(Res55460, Glo82529), 
LSub45851 = subtract_layer([[0.4542, 0.4908, 0.6703]], [[0.891, 0.212, 0.3749]], Sub45851), 
LCon44953 = concatenate_layer([Sub45851,[[0.1337]]], 1, Con44953), 
LMax19390 = maximum_layer([Glo82529,Con44953], Max19390), 
LAve24233 = average_layer([Con50328,Max19390], Ave24233), 
exec_layers([LMul67702,LRes48537,LSof77456,LSub13172,LSof95881,LFla53722,LCon50328,LMin79583,LRes49499,LRes55460,LGlo82529,LSub45851,LCon44953,LMax19390,LAve24233],["Mul67702","Res48537","Sof77456","Sub13172","Sof95881","Fla53722","Con50328","Min79583","Res49499","Res55460","Glo82529","Sub45851","Con44953","Max19390","Ave24233"],Ave24233,"Ave24233")

Actual (Unparsed): [[0.5179000, 0.8520000, 0.4001500, 0.5658000]]

Expected (Unparsed): [[0.5179,0.852,0.40015,0.5658]]

Actual:   [[0.5179, 0.852, 0.4002, 0.5658]]

Expected: [[0.5179, 0.852, 0.4002, 0.5658]]