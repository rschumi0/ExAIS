import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul1296 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul1296 = tf.keras.layers.Input(shape=([1, 2]))
in0Con93608 = tf.keras.layers.Input(shape=([3, 1]))
in0Max10444 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max10444 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con3149 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot82424 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot82424 = tf.keras.layers.Input(shape=([3, 3]))

Mul1296 = keras.layers.Multiply(name = 'Mul1296', )([in0Mul1296,in1Mul1296])
Zer92642 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer92642', )(Mul1296)
Con93608 = keras.layers.Concatenate(axis=2, name = 'Con93608', )([Zer92642,in0Con93608])
Max10444 = keras.layers.Maximum(name = 'Max10444', )([in0Max10444,in1Max10444])
Res10350 = keras.layers.Reshape((1, 1), name = 'Res10350', )(Max10444)
Zer13500 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer13500', )(Res10350)
Con3149 = keras.layers.Concatenate(axis=2, name = 'Con3149', )([Zer13500,in0Con3149])
Dot82424 = keras.layers.Dot(axes=(1, 2), name = 'Dot82424', )([in0Dot82424,in1Dot82424])
Max65423 = keras.layers.Maximum(name = 'Max65423', )([Con3149,Dot82424])
Ave61602 = keras.layers.Average(name = 'Ave61602', )([Con93608,Max65423])
model = tf.keras.models.Model(inputs=[in0Mul1296,in1Mul1296,in0Con93608,in0Max10444,in1Max10444,in0Con3149,in0Dot82424,in1Dot82424], outputs=Ave61602)
in0Mul1296 = tf.constant([[[0.5855, 0.7604]]])
in1Mul1296 = tf.constant([[[0.9997, 0.2376]]])
in0Con93608 = tf.constant([[[0.8627], [0.9613], [0.6921]]])
in0Max10444 = tf.constant([[[[0.0331]]]])
in1Max10444 = tf.constant([[[[0.1976]]]])
in0Con3149 = tf.constant([[[0.3253, 0.0346], [0.9468, 0.9929], [0.5427, 0.3063]]])
in0Dot82424 = tf.constant([[[0.2197, 0.0553, 0.7477], [0.5435, 0.5311, 0.7168], [0.5539, 0.8, 0.9126]]])
in1Dot82424 = tf.constant([[[0.2705, 0.5763, 0.9908], [0.2419, 0.195, 0.1839], [0.9946, 0.7141, 0.8188]]])
print (np.array2string(model.predict([in0Mul1296,in1Mul1296,in0Con93608,in0Max10444,in1Max10444,in0Con3149,in0Dot82424,in1Dot82424],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave61602.png')

LMul1296 = multiply_layer([[[[0.5855, 0.7604]]], [[[0.9997, 0.2376]]]], Mul1296), 
LZer92642 = zero_padding1D_layer(Mul1296, 2, 0, Zer92642), 
LCon93608 = concatenate_layer([Zer92642,[[[0.8627], [0.9613], [0.6921]]]], 2, Con93608), 
LMax10444 = maximum_layer([[[[[0.0331]]]], [[[[0.1976]]]]], Max10444), 
LRes10350 = reshape_layer(Max10444, [1, 1], Res10350), 
LZer13500 = zero_padding1D_layer(Res10350, 2, 0, Zer13500), 
LCon3149 = concatenate_layer([Zer13500,[[[0.3253, 0.0346], [0.9468, 0.9929], [0.5427, 0.3063]]]], 2, Con3149), 
LDot82424 = dot_layer([[[0.2197, 0.0553, 0.7477], [0.5435, 0.5311, 0.7168], [0.5539, 0.8, 0.9126]]], [[[0.2705, 0.5763, 0.9908], [0.2419, 0.195, 0.1839], [0.9946, 0.7141, 0.8188]]], 1, 2, Dot82424), 
LMax65423 = maximum_layer([Con3149,Dot82424], Max65423), 
LAve61602 = average_layer([Con93608,Max65423], Ave61602), 
exec_layers([LMul1296,LZer92642,LCon93608,LMax10444,LRes10350,LZer13500,LCon3149,LDot82424,LMax65423,LAve61602],["Mul1296","Zer92642","Con93608","Max10444","Res10350","Zer13500","Con3149","Dot82424","Max65423","Ave61602"],Ave61602,"Ave61602")

Actual (Unparsed): [[[0.4607260, 0.1626500, 0.9614301], [0.5568358, 0.4734000, 1.0252999], [1.0524366, 0.3616855, 1.3474330]]]

Expected (Unparsed): [[[0.46072601,0.16265,0.961430145],[0.55683579,0.4734,1.025299945],[1.05243656,0.36168552,1.34743309]]]

Actual:   [[[0.4608, 0.1627, 0.9615], [0.5569, 0.4734, 1.0253], [1.0525, 0.3617, 1.3475]]]

Expected: [[[0.4608, 0.1627, 0.9615], [0.5569, 0.4734, 1.0253], [1.0525, 0.3617, 1.3475]]]