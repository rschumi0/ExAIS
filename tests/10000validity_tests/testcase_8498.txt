import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min4243 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min4243 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Con58744 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Min4243 = keras.layers.Minimum(name = 'Min4243', )([in0Min4243,in1Min4243])
Res54556 = keras.layers.Reshape((1, 2, 2), name = 'Res54556', )(Min4243)
Con58744 = keras.layers.Conv3D(3, (1, 2, 2),strides=(1, 1, 9), padding='valid', dilation_rate=(1, 1, 1), name = 'Con58744', )(in0Con58744)
Res83000 = keras.layers.Reshape((1, 1, 3), name = 'Res83000', )(Con58744)
Loc89327 = keras.layers.LocallyConnected2D(2, (1, 1),strides=(9, 1), name = 'Loc89327', )(Res83000)
Zer18465 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer18465', )(Loc89327)
Ave58345 = keras.layers.Average(name = 'Ave58345', )([Res54556,Zer18465])
ReL38456 = keras.layers.ReLU(max_value=5.806900075230295, negative_slope=2.5205444134470705, threshold=0.7431250041626403, name = 'ReL38456', )(Ave58345)
model = tf.keras.models.Model(inputs=[in0Min4243,in1Min4243,in0Con58744], outputs=ReL38456)
w = model.get_layer('Con58744').get_weights() 
w[0] = np.array([[[[[0.2654, 0.1107, 0.6545]], [[0.863, 0.9439, 0.0495]]], [[[0.0434, 0.1141, 0.1297]], [[0.8271, 0.1703, 0.3791]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con58744').set_weights(w) 
w = model.get_layer('Loc89327').get_weights() 
w[0] = np.array([[[0.612, 0.6954], [0.4799, 0.0489], [0.5483, 0.9656]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc89327').set_weights(w) 
in0Min4243 = tf.constant([[[[[0.3414, 0.5103]], [[0.4705, 0.3369]]]]])
in1Min4243 = tf.constant([[[[[0.3026, 0.8997]], [[0.8598, 0.2527]]]]])
in0Con58744 = tf.constant([[[[[0.1755], [0.3763]], [[0.3833], [0.9365]]]]])
print (np.array2string(model.predict([in0Min4243,in1Min4243,in0Con58744],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL38456.png')

LMin4243 = minimum_layer([[[[[[0.3414, 0.5103]], [[0.4705, 0.3369]]]]], [[[[[0.3026, 0.8997]], [[0.8598, 0.2527]]]]]], Min4243), 
LRes54556 = reshape_layer(Min4243, [1, 2, 2], Res54556), 
LCon58744 = conv3D_layer([[[[[0.1755], [0.3763]], [[0.3833], [0.9365]]]]], 1, 2, 2,[[[[[0.2654, 0.1107, 0.6545]], [[0.863, 0.9439, 0.0495]]], [[[0.0434, 0.1141, 0.1297]], [[0.8271, 0.1703, 0.3791]]]]],[0, 0, 0], 1, 1, 9, false, 1, 1, 1, Con58744), 
LRes83000 = reshape_layer(Con58744, [1, 1, 3], Res83000), 
LLoc89327 = locally_connected2D_layer(Res83000, 1, 1,[[[0.612, 0.6954], [0.4799, 0.0489], [0.5483, 0.9656]]],[[[0, 0]]], 9, 1, Loc89327), 
LZer18465 = zero_padding2D_layer(Loc89327, 0, 0, 1, 0, Zer18465), 
LAve58345 = average_layer([Res54556,Zer18465], Ave58345), 
LReL38456 = relu_layer(Ave58345, 5.806900075230295, 2.5205444134470705, 0.7431250041626403, ReL38456), 
exec_layers([LMin4243,LRes54556,LCon58744,LRes83000,LLoc89327,LZer18465,LAve58345,LReL38456],["Min4243","Res54556","Con58744","Res83000","Loc89327","Zer18465","Ave58345","ReL38456"],ReL38456,"ReL38456")

Actual (Unparsed): [[[[-1.4917212, -1.2299627], [0.8771956, 0.8045517]]]]

Expected (Unparsed): [[[[-1.4917212079804323,-1.2299626706439541],[0.877195640079,0.8045517130519999]]]]

Actual:   [[[[-1.4917, -1.2299], [0.8772, 0.8046]]]]

Expected: [[[[-1.4917, -1.2299], [0.8772, 0.8046]]]]