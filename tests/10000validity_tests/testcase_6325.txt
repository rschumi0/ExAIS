import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo56875 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Glo56875 = keras.layers.GlobalMaxPool3D(name = 'Glo56875', )(in0Glo56875)
Fla80510 = keras.layers.Flatten(name = 'Fla80510', )(Glo56875)
Res91591 = keras.layers.Reshape((2, 1), name = 'Res91591', )(Fla80510)
Res58020 = keras.layers.Reshape((2, 1, 1), name = 'Res58020', )(Res91591)
Sep68586 = keras.layers.SeparableConv2D(3, (2, 1),strides=(2, 2), padding='valid', name = 'Sep68586', )(Res58020)
model = tf.keras.models.Model(inputs=[in0Glo56875], outputs=Sep68586)
w = model.get_layer('Sep68586').get_weights() 
w[0] = np.array([[[[0.3607]]], [[[0.3889]]]])
w[1] = np.array([[[[0.9107, 0.9506, 0.1808]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep68586').set_weights(w) 
in0Glo56875 = tf.constant([[[[[1.0434, 1.8808]], [[1.2963, 1.0382]]]]])
print (np.array2string(model.predict([in0Glo56875],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep68586.png')

LGlo56875 = global_max_pool3D_layer([[[[[1.0434, 1.8808]], [[1.2963, 1.0382]]]]], Glo56875), 
LFla80510 = flatten_layer(Glo56875, Fla80510), 
LRes91591 = reshape_layer(Fla80510, [2, 1], Res91591), 
LRes58020 = reshape_layer(Res91591, [2, 1, 1], Res58020), 
LSep68586 = separable_conv2D_layer(Res58020, 2, 1,[[[[[0.3607]]], [[[0.3889]]]],[[[[0.9107, 0.9506, 0.1808]]]]],[0, 0, 0], 2, 2, false, Sep68586), 
exec_layers([LGlo56875,LFla80510,LRes91591,LRes58020,LSep68586],["Glo56875","Fla80510","Res91591","Res58020","Sep68586"],Sep68586,"Sep68586")

Actual (Unparsed): [[[[1.0919462, 1.1397870, 0.2167826]]]]

Expected (Unparsed): [[[[1.091946175271,1.139787014618,0.216782550224]]]]

Actual:   [[[[1.092, 1.1398, 0.2168]]]]

Expected: [[[[1.092, 1.1398, 0.2168]]]]