import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul51516 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul51516 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0GRU55362 = tf.keras.layers.Input(shape=([2, 2]))
in0Con55418 = tf.keras.layers.Input(shape=([2, 1]))

Mul51516 = keras.layers.Multiply(name = 'Mul51516', )([in0Mul51516,in1Mul51516])
Res19591 = keras.layers.Reshape((1, 2), name = 'Res19591', )(Mul51516)
Zer62051 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer62051', )(Res19591)
GRU55362 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU55362', )(in0GRU55362)
Lea44381 = keras.layers.LeakyReLU(alpha=0.43777034984590424, name = 'Lea44381', )(GRU55362)
Res9618 = keras.layers.Reshape((2, 1), name = 'Res9618', )(Lea44381)
Ave37460 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave37460', )(Res9618)
Con55418 = keras.layers.Concatenate(axis=2, name = 'Con55418', )([Ave37460,in0Con55418])
Mul71582 = keras.layers.Multiply(name = 'Mul71582', )([Zer62051,Con55418])
model = tf.keras.models.Model(inputs=[in0Mul51516,in1Mul51516,in0GRU55362,in0Con55418], outputs=Mul71582)
w = model.get_layer('GRU55362').get_weights() 
w[0] = np.array([[2, 9, 8, 7, 8, 3], [9, 9, 3, 9, 4, 1]])
w[1] = np.array([[3, 6, 3, 3, 10, 4], [8, 7, 6, 8, 1, 10]])
w[2] = np.array([7, 4, 6, 1, 2, 5])
model.get_layer('GRU55362').set_weights(w) 
in0Mul51516 = tf.constant([[[[0.8578], [0.3424]]]])
in1Mul51516 = tf.constant([[[[0.4655], [0.2444]]]])
in0GRU55362 = tf.constant([[[7, 8], [10, 8]]])
in0Con55418 = tf.constant([[[0.6169], [0.9345]]])
print (np.array2string(model.predict([in0Mul51516,in1Mul51516,in0GRU55362,in0Con55418],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul71582.png')

LMul51516 = multiply_layer([[[[[0.8578], [0.3424]]]], [[[[0.4655], [0.2444]]]]], Mul51516), 
LRes19591 = reshape_layer(Mul51516, [1, 2], Res19591), 
LZer62051 = zero_padding1D_layer(Res19591, 1, 0, Zer62051), 
LGRU55362 = gru_layer([[[7, 8], [10, 8]]],[[2, 9, 8, 7, 8, 3], [9, 9, 3, 9, 4, 1]],[[3, 6, 3, 3, 10, 4], [8, 7, 6, 8, 1, 10]],[7, 4, 6, 1, 2, 5], false, GRU55362), 
LLea44381 = leaky_relu_layer(GRU55362, 0.43777034984590424, Lea44381), 
LRes9618 = reshape_layer(Lea44381, [2, 1], Res9618), 
LAve37460 = average_pooling1D_layer(Res9618, 1, Ave37460), 
LCon55418 = concatenate_layer([Ave37460,[[[0.6169], [0.9345]]]], 2, Con55418), 
LMul71582 = multiply_layer([Zer62051,Con55418], Mul71582), 
exec_layers([LMul51516,LRes19591,LZer62051,LGRU55362,LLea44381,LRes9618,LAve37460,LCon55418,LMul71582],["Mul51516","Res19591","Zer62051","GRU55362","Lea44381","Res9618","Ave37460","Con55418","Mul71582"],Mul71582,"Mul71582")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0782014]]]

Expected (Unparsed): [[[0.0,0.0],[0.0,0.07820135232]]]

Actual:   [[[0, 0], [0, 0.0783]]]

Expected: [[[0, 0], [0, 0.0783]]]