import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min14117 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min14117 = tf.keras.layers.Input(shape=([2, 1, 1]))

Min14117 = keras.layers.Minimum(name = 'Min14117', )([in0Min14117,in1Min14117])
Con28422 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con28422', )(Min14117)
Res50389 = keras.layers.Reshape((2, 1, 4, 1), name = 'Res50389', )(Con28422)
Glo27299 = keras.layers.GlobalMaxPool3D(name = 'Glo27299', )(Res50389)
model = tf.keras.models.Model(inputs=[in0Min14117,in1Min14117], outputs=Glo27299)
w = model.get_layer('Con28422').get_weights() 
w[0] = np.array([[[[0.7053, 0.4235, 0.7383, 0.7443]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con28422').set_weights(w) 
in0Min14117 = tf.constant([[[[0.5069]], [[0.187]]]])
in1Min14117 = tf.constant([[[[0.7323]], [[0.9674]]]])
print (np.array2string(model.predict([in0Min14117,in1Min14117],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo27299.png')

LMin14117 = minimum_layer([[[[[0.5069]], [[0.187]]]], [[[[0.7323]], [[0.9674]]]]], Min14117), 
LCon28422 = conv2D_layer(Min14117, 1, 1,[[[[0.7053, 0.4235, 0.7383, 0.7443]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con28422), 
LRes50389 = reshape_layer(Con28422, [2, 1, 4, 1], Res50389), 
LGlo27299 = global_max_pool3D_layer(Res50389, Glo27299), 
exec_layers([LMin14117,LCon28422,LRes50389,LGlo27299],["Min14117","Con28422","Res50389","Glo27299"],Glo27299,"Glo27299")

Actual (Unparsed): [[0.3772857]]

Expected (Unparsed): [[0.37728567]]

Actual:   [[0.3773]]

Expected: [[0.3773]]