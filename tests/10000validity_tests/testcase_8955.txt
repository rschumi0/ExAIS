import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer43121 = tf.keras.layers.Input(shape=([3, 3]))
in0Dot29150 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot29150 = tf.keras.layers.Input(shape=([3, 3]))

Zer43121 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer43121', )(in0Zer43121)
Dot29150 = keras.layers.Dot(axes=(2, 1), name = 'Dot29150', )([in0Dot29150,in1Dot29150])
Zer55244 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer55244', )(Dot29150)
Sub40670 = keras.layers.Subtract(name = 'Sub40670', )([Zer43121,Zer55244])
Glo87215 = keras.layers.GlobalAveragePooling1D(name = 'Glo87215', )(Sub40670)
Res5944 = keras.layers.Reshape((3, 1), name = 'Res5944', )(Glo87215)
Zer98708 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer98708', )(Res5944)
model = tf.keras.models.Model(inputs=[in0Zer43121,in0Dot29150,in1Dot29150], outputs=Zer98708)
in0Zer43121 = tf.constant([[[1.2116, 1.1853, 1.7197], [1.6937, 1.5438, 1.5025], [1.7223, 1.2579, 1.8901]]])
in0Dot29150 = tf.constant([[[0.2008, 0.4409, 0.4502], [0.7084, 0.0825, 0.942], [0.8695, 0.5985, 0.1911]]])
in1Dot29150 = tf.constant([[[0.0069, 0.6762, 0.2948], [0.3194, 0.1277, 0.5256], [0.1101, 0.0563, 0.9318]]])
print (np.array2string(model.predict([in0Zer43121,in0Dot29150,in1Dot29150],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer98708.png')

LZer43121 = zero_padding1D_layer([[[1.2116, 1.1853, 1.7197], [1.6937, 1.5438, 1.5025], [1.7223, 1.2579, 1.8901]]], 1, 1, Zer43121), 
LDot29150 = dot_layer([[[0.2008, 0.4409, 0.4502], [0.7084, 0.0825, 0.942], [0.8695, 0.5985, 0.1911]]], [[[0.0069, 0.6762, 0.2948], [0.3194, 0.1277, 0.5256], [0.1101, 0.0563, 0.9318]]], 2, 1, Dot29150), 
LZer55244 = zero_padding1D_layer(Dot29150, 2, 0, Zer55244), 
LSub40670 = subtract_layer(Zer43121,Zer55244, Sub40670), 
LGlo87215 = global_average_pooling1D_layer(Sub40670, Glo87215), 
LRes5944 = reshape_layer(Glo87215, [3, 1], Res5944), 
LZer98708 = zero_padding1D_layer(Res5944, 1, 1, Zer98708), 
exec_layers([LZer43121,LDot29150,LZer55244,LSub40670,LGlo87215,LRes5944,LZer98708],["Zer43121","Dot29150","Zer55244","Sub40670","Glo87215","Res5944","Zer98708"],Zer98708,"Zer98708")

Actual (Unparsed): [[[0.0000000], [0.8165341], [0.5103673], [0.5045899], [0.0000000]]]

Expected (Unparsed): [[[0],[0.8165341560000001],[0.5103673280000001],[0.504589932],[0]]]

Actual:   [[[0], [0.8166], [0.5104], [0.5046], [0]]]

Expected: [[[0], [0.8166], [0.5104], [0.5046], [0]]]