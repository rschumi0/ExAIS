import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave51320 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Ave51320 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Ave51320 = keras.layers.Average(name = 'Ave51320', )([in0Ave51320,in1Ave51320])
Thr4712 = keras.layers.ThresholdedReLU(theta=2.3954622678614967, name = 'Thr4712', )(Ave51320)
Con32609 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 1, 1), padding='same', name = 'Con32609', )(Thr4712)
Glo35627 = keras.layers.GlobalAveragePooling3D(name = 'Glo35627', )(Con32609)
Res94894 = keras.layers.Reshape((3, 1), name = 'Res94894', )(Glo35627)
LST47485 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST47485', )(Res94894)
model = tf.keras.models.Model(inputs=[in0Ave51320,in1Ave51320], outputs=LST47485)
w = model.get_layer('Con32609').get_weights() 
w[0] = np.array([[[[[0.9572], [0.5723], [0.0801]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con32609').set_weights(w) 
w = model.get_layer('LST47485').get_weights() 
w[0] = np.array([[5, 3, 1, 9, 2, 3, 1, 3, 7, 3, 10, 10]])
w[1] = np.array([[2, 2, 4, 6, 7, 3, 2, 8, 7, 3, 2, 4], [5, 2, 4, 9, 9, 2, 9, 8, 8, 8, 3, 2], [6, 3, 4, 6, 6, 7, 7, 2, 6, 1, 6, 4]])
w[2] = np.array([9, 2, 4, 5, 3, 6, 3, 8, 8, 6, 9, 2])
model.get_layer('LST47485').set_weights(w) 
in0Ave51320 = tf.constant([[[[[0.7776]]]]])
in1Ave51320 = tf.constant([[[[[0.9462]]]]])
print (np.array2string(model.predict([in0Ave51320,in1Ave51320],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST47485.png')

LAve51320 = average_layer([[[[[[0.7776]]]]], [[[[[0.9462]]]]]], Ave51320), 
LThr4712 = thresholded_relu_layer(Ave51320, 2.3954622678614967, Thr4712), 
LCon32609 = conv3D_transpose_layer(Thr4712, 1, 1, 1,[[[[[0.9572], [0.5723], [0.0801]]]]],[0, 0, 0], 1, 1, 1, true, Con32609), 
LGlo35627 = global_average_pooling3D_layer(Con32609, Glo35627), 
LRes94894 = reshape_layer(Glo35627, [3, 1], Res94894), 
LLST47485 = lstm_layer(Res94894,[[5, 3, 1, 9, 2, 3, 1, 3, 7, 3, 10, 10]],[[2, 2, 4, 6, 7, 3, 2, 8, 7, 3, 2, 4], [5, 2, 4, 9, 9, 2, 9, 8, 8, 8, 3, 2], [6, 3, 4, 6, 6, 7, 7, 2, 6, 1, 6, 4]],[9, 2, 4, 5, 3, 6, 3, 8, 8, 6, 9, 2], LST47485), 
exec_layers([LAve51320,LThr4712,LCon32609,LGlo35627,LRes94894,LLST47485],["Ave51320","Thr4712","Con32609","Glo35627","Res94894","LST47485"],LST47485,"LST47485")

Actual (Unparsed): [[0.9950045, 0.9937132, 0.9948650]]

Expected (Unparsed): [[0.9950044738821933,0.9937131627967887,0.9948650478359541]]

Actual:   [[0.9951, 0.9938, 0.9949]]

Expected: [[0.9951, 0.9938, 0.9949]]