import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul68987 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul68987 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con35894 = tf.keras.layers.Input(shape=([1, 1, 1, 3]))
in0Cro11293 = tf.keras.layers.Input(shape=([4, 3, 3, 4]))

Mul68987 = keras.layers.Multiply(name = 'Mul68987', )([in0Mul68987,in1Mul68987])
ELU54234 = keras.layers.ELU(alpha=4.009302976587691, name = 'ELU54234', )(Mul68987)
Res39263 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res39263', )(ELU54234)
Glo19699 = keras.layers.GlobalMaxPool3D(name = 'Glo19699', )(Res39263)
Res38154 = keras.layers.Reshape((1, 1), name = 'Res38154', )(Glo19699)
Res23202 = keras.layers.Reshape((1, 1, 1), name = 'Res23202', )(Res38154)
Res10481 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res10481', )(Res23202)
Con35894 = keras.layers.Concatenate(axis=4, name = 'Con35894', )([Res10481,in0Con35894])
Cro11293 = keras.layers.Cropping3D(cropping=((3, 0), (2, 0), (2, 0)), name = 'Cro11293', )(in0Cro11293)
Add2418 = keras.layers.Add(name = 'Add2418', )([Con35894,Cro11293])
Res93659 = keras.layers.Reshape((1, 1, 4), name = 'Res93659', )(Add2418)
Res52671 = keras.layers.Reshape((1, 4), name = 'Res52671', )(Res93659)
LST47210 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST47210', )(Res52671)
model = tf.keras.models.Model(inputs=[in0Mul68987,in1Mul68987,in0Con35894,in0Cro11293], outputs=LST47210)
w = model.get_layer('LST47210').get_weights() 
w[0] = np.array([[3, 6, 6, 6, 8, 6, 4, 8, 1, 1, 5, 2], [4, 3, 5, 6, 8, 6, 8, 10, 5, 1, 3, 5], [6, 5, 1, 2, 9, 6, 9, 10, 9, 10, 8, 1], [7, 10, 4, 1, 1, 4, 10, 5, 4, 3, 3, 1]])
w[1] = np.array([[4, 2, 5, 4, 4, 9, 2, 1, 6, 2, 7, 1], [6, 8, 1, 8, 6, 9, 6, 2, 9, 1, 4, 5], [5, 10, 9, 5, 8, 6, 9, 4, 5, 5, 5, 5]])
w[2] = np.array([10, 5, 10, 8, 7, 3, 3, 2, 3, 2, 2, 2])
model.get_layer('LST47210').set_weights(w) 
in0Mul68987 = tf.constant([[[[0.1953, 0.6045], [0.1586, 0.1216]]]])
in1Mul68987 = tf.constant([[[[0.9414, 0.5543], [0.1813, 0.0868]]]])
in0Con35894 = tf.constant([[[[[0.6978, 0.1047, 0.1899]]]]])
in0Cro11293 = tf.constant([[[[[1.1558, 1.0444, 1.0812, 1.1235], [1.4379, 1.5598, 1.4024, 1.6661], [1.2555, 1.5776, 1.8983, 1.4532]], [[1.7621, 1.0624, 1.1091, 1.7869], [1.1817, 1.8709, 1.8185, 1.9498], [1.9916, 1.789, 1.4596, 1.9915]], [[1.1307, 1.5318, 1.3049, 1.0886], [1.2467, 1.6688, 1.3243, 1.2062], [1.5583, 1.1008, 1.9244, 1.8464]]], [[[1.25, 1.413, 1.3906, 1.2528], [1.4492, 1.1557, 1.7483, 1.5627], [1.7354, 1.8622, 1.9297, 1.0437]], [[1.8269, 1.4046, 1.5882, 1.7357], [1.5532, 1.1081, 1.6366, 1.5279], [1.4785, 1.8986, 1.604, 1.9469]], [[1.5693, 1.6411, 1.2013, 1.7036], [1.1151, 1.7412, 1.0672, 1.3541], [1.7056, 1.0296, 1.5238, 1.2649]]], [[[1.442, 1.9251, 1.3164, 1.4446], [1.7206, 1.8833, 1.731, 1.6972], [1.8611, 1.1738, 1.1894, 1.9907]], [[1.5763, 1.1057, 1.4073, 1.8895], [1.7769, 1.9177, 1.4662, 1.3974], [1.4898, 1.6886, 1.6978, 1.5791]], [[1.7306, 1.7837, 1.1103, 1.8856], [1.0171, 1.5536, 1.1947, 1.1955], [1.8337, 1.2264, 1.341, 1.2008]]], [[[1.7678, 1.1935, 1.7679, 1.919], [1.2241, 1.1812, 1.8233, 1.7887], [1.5956, 1.1183, 1.7479, 1.0223]], [[1.5174, 1.8664, 1.5106, 1.6307], [1.3659, 1.359, 1.1238, 1.8088], [1.4761, 1.1148, 1.924, 1.1781]], [[1.6452, 1.5338, 1.6642, 1.7168], [1.3693, 1.8633, 1.9058, 1.0794], [1.9114, 1.2305, 1.1224, 1.4042]]]]])
print (np.array2string(model.predict([in0Mul68987,in1Mul68987,in0Con35894,in0Cro11293],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST47210.png')

LMul68987 = multiply_layer([[[[[0.1953, 0.6045], [0.1586, 0.1216]]]], [[[[0.9414, 0.5543], [0.1813, 0.0868]]]]], Mul68987), 
LELU54234 = elu_layer(Mul68987, 4.009302976587691, ELU54234), 
LRes39263 = reshape_layer(ELU54234, [1, 2, 2, 1], Res39263), 
LGlo19699 = global_max_pool3D_layer(Res39263, Glo19699), 
LRes38154 = reshape_layer(Glo19699, [1, 1], Res38154), 
LRes23202 = reshape_layer(Res38154, [1, 1, 1], Res23202), 
LRes10481 = reshape_layer(Res23202, [1, 1, 1, 1], Res10481), 
LCon35894 = concatenate_layer([Res10481,[[[[[0.6978, 0.1047, 0.1899]]]]]], 4, Con35894), 
LCro11293 = cropping3D_layer([[[[[1.1558, 1.0444, 1.0812, 1.1235], [1.4379, 1.5598, 1.4024, 1.6661], [1.2555, 1.5776, 1.8983, 1.4532]], [[1.7621, 1.0624, 1.1091, 1.7869], [1.1817, 1.8709, 1.8185, 1.9498], [1.9916, 1.789, 1.4596, 1.9915]], [[1.1307, 1.5318, 1.3049, 1.0886], [1.2467, 1.6688, 1.3243, 1.2062], [1.5583, 1.1008, 1.9244, 1.8464]]], [[[1.25, 1.413, 1.3906, 1.2528], [1.4492, 1.1557, 1.7483, 1.5627], [1.7354, 1.8622, 1.9297, 1.0437]], [[1.8269, 1.4046, 1.5882, 1.7357], [1.5532, 1.1081, 1.6366, 1.5279], [1.4785, 1.8986, 1.604, 1.9469]], [[1.5693, 1.6411, 1.2013, 1.7036], [1.1151, 1.7412, 1.0672, 1.3541], [1.7056, 1.0296, 1.5238, 1.2649]]], [[[1.442, 1.9251, 1.3164, 1.4446], [1.7206, 1.8833, 1.731, 1.6972], [1.8611, 1.1738, 1.1894, 1.9907]], [[1.5763, 1.1057, 1.4073, 1.8895], [1.7769, 1.9177, 1.4662, 1.3974], [1.4898, 1.6886, 1.6978, 1.5791]], [[1.7306, 1.7837, 1.1103, 1.8856], [1.0171, 1.5536, 1.1947, 1.1955], [1.8337, 1.2264, 1.341, 1.2008]]], [[[1.7678, 1.1935, 1.7679, 1.919], [1.2241, 1.1812, 1.8233, 1.7887], [1.5956, 1.1183, 1.7479, 1.0223]], [[1.5174, 1.8664, 1.5106, 1.6307], [1.3659, 1.359, 1.1238, 1.8088], [1.4761, 1.1148, 1.924, 1.1781]], [[1.6452, 1.5338, 1.6642, 1.7168], [1.3693, 1.8633, 1.9058, 1.0794], [1.9114, 1.2305, 1.1224, 1.4042]]]]], 3, 0, 2, 0, 2, 0, Cro11293), 
LAdd2418 = add_layer([Con35894,Cro11293], Add2418), 
LRes93659 = reshape_layer(Add2418, [1, 1, 4], Res93659), 
LRes52671 = reshape_layer(Res93659, [1, 4], Res52671), 
LLST47210 = lstm_layer(Res52671,[[3, 6, 6, 6, 8, 6, 4, 8, 1, 1, 5, 2], [4, 3, 5, 6, 8, 6, 8, 10, 5, 1, 3, 5], [6, 5, 1, 2, 9, 6, 9, 10, 9, 10, 8, 1], [7, 10, 4, 1, 1, 4, 10, 5, 4, 3, 3, 1]],[[4, 2, 5, 4, 4, 9, 2, 1, 6, 2, 7, 1], [6, 8, 1, 8, 6, 9, 6, 2, 9, 1, 4, 5], [5, 10, 9, 5, 8, 6, 9, 4, 5, 5, 5, 5]],[10, 5, 10, 8, 7, 3, 3, 2, 3, 2, 2, 2], LST47210), 
exec_layers([LMul68987,LELU54234,LRes39263,LGlo19699,LRes38154,LRes23202,LRes10481,LCon35894,LCro11293,LAdd2418,LRes93659,LRes52671,LLST47210],["Mul68987","ELU54234","Res39263","Glo19699","Res38154","Res23202","Res10481","Con35894","Cro11293","Add2418","Res93659","Res52671","LST47210"],LST47210,"LST47210")

Actual (Unparsed): [[0.7615942, 0.7615942, 0.7615942]]

Expected (Unparsed): [[0.7615941558935492,0.761594155955763,0.7615941514951988]]

Actual:   [[0.7616, 0.7616, 0.7616]]

Expected: [[0.7616, 0.7616, 0.7616]]