import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave21381 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave21381 = tf.keras.layers.Input(shape=([1, 2]))
in0Con56779 = tf.keras.layers.Input(shape=([2, 2]))

Ave21381 = keras.layers.Average(name = 'Ave21381', )([in0Ave21381,in1Ave21381])
Sof18056 = keras.layers.Softmax(axis=1, name = 'Sof18056', )(Ave21381)
Con56779 = keras.layers.Conv1D(2, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con56779', )(in0Con56779)
Max58142 = keras.layers.Maximum(name = 'Max58142', )([Sof18056,Con56779])
model = tf.keras.models.Model(inputs=[in0Ave21381,in1Ave21381,in0Con56779], outputs=Max58142)
w = model.get_layer('Con56779').get_weights() 
w[0] = np.array([[[0.0211, 0.7645], [0.6189, 0.1887]], [[0.1697, 0.3158], [0.8553, 0.7719]]])
w[1] = np.array([0, 0])
model.get_layer('Con56779').set_weights(w) 
in0Ave21381 = tf.constant([[[0.5443, 0.2442]]])
in1Ave21381 = tf.constant([[[0.0062, 0.3781]]])
in0Con56779 = tf.constant([[[0.511, 0.5574], [0.7561, 0.4029]]])
print (np.array2string(model.predict([in0Ave21381,in1Ave21381,in0Con56779],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max58142.png')

LAve21381 = average_layer([[[[0.5443, 0.2442]]], [[[0.0062, 0.3781]]]], Ave21381), 
LSof18056 = softmax_layer(Ave21381, 1, Sof18056), 
LCon56779 = conv1D_layer([[[0.511, 0.5574], [0.7561, 0.4029]]], 2,[[[0.0211, 0.7645], [0.6189, 0.1887]], [[0.1697, 0.3158], [0.8553, 0.7719]]],[0, 0], 1, false, 1, Con56779), 
LMax58142 = maximum_layer([Sof18056,Con56779], Max58142), 
exec_layers([LAve21381,LSof18056,LCon56779,LMax58142],["Ave21381","Sof18056","Con56779","Max58142"],Max58142,"Max58142")

Actual (Unparsed): [[[1.0000000, 1.0456158]]]

Expected (Unparsed): [[[1.0,1.04561577]]]

Actual:   [[[1, 1.0457]]]

Expected: [[[1, 1.0457]]]