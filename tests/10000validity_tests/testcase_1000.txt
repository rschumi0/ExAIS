import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub78715 = tf.keras.layers.Input(shape=([2]))
in1Sub78715 = tf.keras.layers.Input(shape=([2]))
in0Con17840 = tf.keras.layers.Input(shape=([2, 1, 3, 1]))
in0Add64777 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Add64777 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Max99344 = tf.keras.layers.Input(shape=([1, 2]))
in1Max99344 = tf.keras.layers.Input(shape=([1, 2]))
in0Con87929 = tf.keras.layers.Input(shape=([2, 4]))

Sub78715 = keras.layers.Subtract(name = 'Sub78715', )([in0Sub78715,in1Sub78715])
Res17060 = keras.layers.Reshape((2, 1), name = 'Res17060', )(Sub78715)
Res69637 = keras.layers.Reshape((2, 1, 1), name = 'Res69637', )(Res17060)
Res3414 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res3414', )(Res69637)
Zer89452 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer89452', )(Res3414)
Con17840 = keras.layers.Concatenate(axis=4, name = 'Con17840', )([Zer89452,in0Con17840])
Add64777 = keras.layers.Add(name = 'Add64777', )([in0Add64777,in1Add64777])
Zer77486 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer77486', )(Add64777)
Min72756 = keras.layers.Minimum(name = 'Min72756', )([Con17840,Zer77486])
Res15230 = keras.layers.Reshape((2, 1, 6), name = 'Res15230', )(Min72756)
Res63849 = keras.layers.Reshape((2, 6), name = 'Res63849', )(Res15230)
Max99344 = keras.layers.Maximum(name = 'Max99344', )([in0Max99344,in1Max99344])
Zer13183 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer13183', )(Max99344)
Con87929 = keras.layers.Concatenate(axis=2, name = 'Con87929', )([Zer13183,in0Con87929])
Ave60647 = keras.layers.Average(name = 'Ave60647', )([Res63849,Con87929])
model = tf.keras.models.Model(inputs=[in0Sub78715,in1Sub78715,in0Con17840,in0Add64777,in1Add64777,in0Max99344,in1Max99344,in0Con87929], outputs=Ave60647)
in0Sub78715 = tf.constant([[0.9746, 0.6225]])
in1Sub78715 = tf.constant([[0.9391, 0.4305]])
in0Con17840 = tf.constant([[[[[0.6526], [0.8657], [0.6648]]], [[[0.7269], [0.7593], [0.1899]]]]])
in0Add64777 = tf.constant([[[[[0.8038, 0.9615], [0.3862, 0.8954]]]]])
in1Add64777 = tf.constant([[[[[0.7105, 0.8156], [0.9829, 0.3048]]]]])
in0Max99344 = tf.constant([[[0.2818, 0.2608]]])
in1Max99344 = tf.constant([[[0.1963, 0.4338]]])
in0Con87929 = tf.constant([[[0.2369, 0.8075, 0.3082, 0.552], [0.423, 0.4465, 0.5571, 0.4079]]])
print (np.array2string(model.predict([in0Sub78715,in1Sub78715,in0Con17840,in0Add64777,in1Add64777,in0Max99344,in1Max99344,in0Con87929],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave60647.png')

LSub78715 = subtract_layer([[0.9746, 0.6225]], [[0.9391, 0.4305]], Sub78715), 
LRes17060 = reshape_layer(Sub78715, [2, 1], Res17060), 
LRes69637 = reshape_layer(Res17060, [2, 1, 1], Res69637), 
LRes3414 = reshape_layer(Res69637, [2, 1, 1, 1], Res3414), 
LZer89452 = zero_padding3D_layer(Res3414, 0, 0, 0, 0, 2, 0, Zer89452), 
LCon17840 = concatenate_layer([Zer89452,[[[[[0.6526], [0.8657], [0.6648]]], [[[0.7269], [0.7593], [0.1899]]]]]], 4, Con17840), 
LAdd64777 = add_layer([[[[[[0.8038, 0.9615], [0.3862, 0.8954]]]]], [[[[[0.7105, 0.8156], [0.9829, 0.3048]]]]]], Add64777), 
LZer77486 = zero_padding3D_layer(Add64777, 1, 0, 0, 0, 1, 0, Zer77486), 
LMin72756 = minimum_layer([Con17840,Zer77486], Min72756), 
LRes15230 = reshape_layer(Min72756, [2, 1, 6], Res15230), 
LRes63849 = reshape_layer(Res15230, [2, 6], Res63849), 
LMax99344 = maximum_layer([[[[0.2818, 0.2608]]], [[[0.1963, 0.4338]]]], Max99344), 
LZer13183 = zero_padding1D_layer(Max99344, 1, 0, Zer13183), 
LCon87929 = concatenate_layer([Zer13183,[[[0.2369, 0.8075, 0.3082, 0.552], [0.423, 0.4465, 0.5571, 0.4079]]]], 2, Con87929), 
LAve60647 = average_layer([Res63849,Con87929], Ave60647), 
exec_layers([LSub78715,LRes17060,LRes69637,LRes3414,LZer89452,LCon17840,LAdd64777,LZer77486,LMin72756,LRes15230,LRes63849,LMax99344,LZer13183,LCon87929,LAve60647],["Sub78715","Res17060","Res69637","Res3414","Zer89452","Con17840","Add64777","Zer77486","Min72756","Res15230","Res63849","Max99344","Zer13183","Con87929","Ave60647"],Ave60647,"Ave60647")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.1184500, 0.4037500, 0.1541000, 0.2760000], [0.1409000, 0.2169000, 0.2115000, 0.6029000, 0.3745500, 0.2989000]]]

Expected (Unparsed): [[[0,0,0.11845,0.40375,0.1541,0.276],[0.1409,0.2169,0.2115,0.6029,0.37455000000000005,0.2989]]]

Actual:   [[[0, 0, 0.1185, 0.4038, 0.1541, 0.276], [0.1409, 0.2169, 0.2115, 0.6029, 0.3746, 0.2989]]]

Expected: [[[0, 0, 0.1185, 0.4038, 0.1541, 0.276], [0.1409, 0.2169, 0.2115, 0.6029, 0.3746, 0.2989]]]