import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub13397 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub13397 = tf.keras.layers.Input(shape=([3, 2, 2]))
in0Con38048 = tf.keras.layers.Input(shape=([2, 1, 2]))

Sub13397 = keras.layers.Subtract(name = 'Sub13397', )([in0Sub13397,in1Sub13397])
Con38048 = keras.layers.Conv2D(2, (1, 1),strides=(1, 12), padding='valid', dilation_rate=(1, 1), name = 'Con38048', )(in0Con38048)
Zer80588 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer80588', )(Con38048)
Max79844 = keras.layers.Maximum(name = 'Max79844', )([Sub13397,Zer80588])
model = tf.keras.models.Model(inputs=[in0Sub13397,in1Sub13397,in0Con38048], outputs=Max79844)
w = model.get_layer('Con38048').get_weights() 
w[0] = np.array([[[[0.6675, 0.0719], [0.008, 0.1633]]]])
w[1] = np.array([0, 0])
model.get_layer('Con38048').set_weights(w) 
in0Sub13397 = tf.constant([[[[0.9083, 0.3046], [0.3954, 0.8436]], [[0.6072, 0.0867], [0.2177, 0.8968]], [[0.4718, 0.058], [0.5184, 0.9815]]]])
in1Sub13397 = tf.constant([[[[0.5191, 0.3017], [0.1726, 0.3675]], [[0.5997, 0.7317], [0.7979, 0.6197]], [[0.7537, 0.0743], [0.2988, 0.5813]]]])
in0Con38048 = tf.constant([[[[0.5948, 0.8164]], [[0.7747, 0.0613]]]])
print (np.array2string(model.predict([in0Sub13397,in1Sub13397,in0Con38048],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max79844.png')

LSub13397 = subtract_layer([[[[0.9083, 0.3046], [0.3954, 0.8436]], [[0.6072, 0.0867], [0.2177, 0.8968]], [[0.4718, 0.058], [0.5184, 0.9815]]]], [[[[0.5191, 0.3017], [0.1726, 0.3675]], [[0.5997, 0.7317], [0.7979, 0.6197]], [[0.7537, 0.0743], [0.2988, 0.5813]]]], Sub13397), 
LCon38048 = conv2D_layer([[[[0.5948, 0.8164]], [[0.7747, 0.0613]]]], 1, 1,[[[[0.6675, 0.0719], [0.008, 0.1633]]]],[0, 0], 1, 12, false, 1, 1, Con38048), 
LZer80588 = zero_padding2D_layer(Con38048, 1, 0, 1, 0, Zer80588), 
LMax79844 = maximum_layer([Sub13397,Zer80588], Max79844), 
exec_layers([LSub13397,LCon38048,LZer80588,LMax79844],["Sub13397","Con38048","Zer80588","Max79844"],Max79844,"Max79844")

Actual (Unparsed): [[[[0.3892000, 0.0029000], [0.2228000, 0.4761000]], [[0.0075001, 0.0000000], [0.4035602, 0.2771000]], [[0.0000000, 0.0000000], [0.5176026, 0.4002000]]]]

Expected (Unparsed): [[[[0.3892,0.002899999999999958],[0.22279999999999997,0.4761]],[[0.007499999999999951,0],[0.4035602,0.2771]],[[0,0],[0.51760265,0.4002]]]]

Actual:   [[[[0.3892, 0.0029], [0.2228, 0.4761]], [[0.0076, 0], [0.4036, 0.2771]], [[0, 0], [0.5177, 0.4002]]]]

Expected: [[[[0.3892, 0.0029], [0.2228, 0.4761]], [[0.0075, 0], [0.4036, 0.2771]], [[0, 0], [0.5177, 0.4002]]]]