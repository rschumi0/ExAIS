import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc84804 = tf.keras.layers.Input(shape=([2, 1]))

Loc84804 = keras.layers.LocallyConnected1D(2, (2),strides=(1), name = 'Loc84804', )(in0Loc84804)
Glo15091 = keras.layers.GlobalMaxPool1D(name = 'Glo15091', )(Loc84804)
model = tf.keras.models.Model(inputs=[in0Loc84804], outputs=Glo15091)
w = model.get_layer('Loc84804').get_weights() 
w[0] = np.array([[[0.9761, 0.4619], [0.3044, 0.991]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc84804').set_weights(w) 
in0Loc84804 = tf.constant([[[0.4593], [0.1597]]])
print (np.array2string(model.predict([in0Loc84804],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo15091.png')

LLoc84804 = locally_connected1D_layer([[[0.4593], [0.1597]]], 2,[[[0.9761, 0.4619], [0.3044, 0.991]]],[[0, 0]], 1, Loc84804), 
LGlo15091 = global_max_pool1D_layer(Loc84804, Glo15091), 
exec_layers([LLoc84804,LGlo15091],["Loc84804","Glo15091"],Glo15091,"Glo15091")

Actual (Unparsed): [[0.4969354, 0.3704134]]

Expected (Unparsed): [[0.49693540999999997,0.37041336999999996]]

Actual:   [[0.497, 0.3705]]

Expected: [[0.497, 0.3705]]