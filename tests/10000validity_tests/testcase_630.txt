import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add90097 = tf.keras.layers.Input(shape=([2, 2]))
in1Add90097 = tf.keras.layers.Input(shape=([2, 2]))
in0Add70878 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Add70878 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Mul9218 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul9218 = tf.keras.layers.Input(shape=([2, 2]))
in0Add98750 = tf.keras.layers.Input(shape=([1, 2]))
in1Add98750 = tf.keras.layers.Input(shape=([1, 2]))
in0Con30542 = tf.keras.layers.Input(shape=([2, 2]))
in0Con23124 = tf.keras.layers.Input(shape=([2, 4]))

Add90097 = keras.layers.Add(name = 'Add90097', )([in0Add90097,in1Add90097])
Res79813 = keras.layers.Reshape((2, 2, 1), name = 'Res79813', )(Add90097)
Con68742 = keras.layers.Conv2DTranspose(4, (2, 2),strides=(1, 1), padding='same', name = 'Con68742', )(Res79813)
Res50981 = keras.layers.Reshape((2, 8), name = 'Res50981', )(Con68742)
Add70878 = keras.layers.Add(name = 'Add70878', )([in0Add70878,in1Add70878])
Res93993 = keras.layers.Reshape((2, 4), name = 'Res93993', )(Add70878)
Mul9218 = keras.layers.Multiply(name = 'Mul9218', )([in0Mul9218,in1Mul9218])
Add98750 = keras.layers.Add(name = 'Add98750', )([in0Add98750,in1Add98750])
Zer29213 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer29213', )(Add98750)
Min54878 = keras.layers.Minimum(name = 'Min54878', )([Mul9218,Zer29213])
Con30542 = keras.layers.Concatenate(axis=2, name = 'Con30542', )([Min54878,in0Con30542])
Add16382 = keras.layers.Add(name = 'Add16382', )([Res93993,Con30542])
Con23124 = keras.layers.Concatenate(axis=2, name = 'Con23124', )([Add16382,in0Con23124])
Max36906 = keras.layers.Maximum(name = 'Max36906', )([Res50981,Con23124])
model = tf.keras.models.Model(inputs=[in0Add90097,in1Add90097,in0Add70878,in1Add70878,in0Mul9218,in1Mul9218,in0Add98750,in1Add98750,in0Con30542,in0Con23124], outputs=Max36906)
w = model.get_layer('Con68742').get_weights() 
w[0] = np.array([[[[0.0235], [0.0324], [0.3572], [0.7216]], [[0.7884], [0.7025], [0.1601], [0.55]]], [[[0.6045], [0.0316], [0.5512], [0.7401]], [[0.8457], [0.842], [0.8162], [0.4756]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con68742').set_weights(w) 
in0Add90097 = tf.constant([[[0.923, 0.0715], [0.9605, 0.0872]]])
in1Add90097 = tf.constant([[[0.773, 0.8346], [0.9813, 0.7776]]])
in0Add70878 = tf.constant([[[[0.1651, 0.4932], [0.0897, 0.1101]], [[0.4795, 0.4425], [0.0429, 0.8369]]]])
in1Add70878 = tf.constant([[[[0.5465, 0.3724], [0.3522, 0.1335]], [[0.0566, 0.8543], [0.9966, 0.6703]]]])
in0Mul9218 = tf.constant([[[0.166, 0.9554], [0.9635, 0.0353]]])
in1Mul9218 = tf.constant([[[0.5741, 0.8084], [0.2806, 0.1366]]])
in0Add98750 = tf.constant([[[0.6592, 0.0643]]])
in1Add98750 = tf.constant([[[0.2114, 0.0432]]])
in0Con30542 = tf.constant([[[0.173, 0.6067], [0.2256, 0.4261]]])
in0Con23124 = tf.constant([[[0.7901, 0.4024, 0.5496, 0.448], [0.6741, 0.8779, 0.0333, 0.6188]]])
print (np.array2string(model.predict([in0Add90097,in1Add90097,in0Add70878,in1Add70878,in0Mul9218,in1Mul9218,in0Add98750,in1Add98750,in0Con30542,in0Con23124],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max36906.png')

LAdd90097 = add_layer([[[[0.923, 0.0715], [0.9605, 0.0872]]], [[[0.773, 0.8346], [0.9813, 0.7776]]]], Add90097), 
LRes79813 = reshape_layer(Add90097, [2, 2, 1], Res79813), 
LCon68742 = conv2D_transpose_layer(Res79813, 2, 2,[[[[0.0235], [0.0324], [0.3572], [0.7216]], [[0.7884], [0.7025], [0.1601], [0.55]]], [[[0.6045], [0.0316], [0.5512], [0.7401]], [[0.8457], [0.842], [0.8162], [0.4756]]]],[0, 0, 0, 0], 1, 1, true, Con68742), 
LRes50981 = reshape_layer(Con68742, [2, 8], Res50981), 
LAdd70878 = add_layer([[[[[0.1651, 0.4932], [0.0897, 0.1101]], [[0.4795, 0.4425], [0.0429, 0.8369]]]], [[[[0.5465, 0.3724], [0.3522, 0.1335]], [[0.0566, 0.8543], [0.9966, 0.6703]]]]], Add70878), 
LRes93993 = reshape_layer(Add70878, [2, 4], Res93993), 
LMul9218 = multiply_layer([[[[0.166, 0.9554], [0.9635, 0.0353]]], [[[0.5741, 0.8084], [0.2806, 0.1366]]]], Mul9218), 
LAdd98750 = add_layer([[[[0.6592, 0.0643]]], [[[0.2114, 0.0432]]]], Add98750), 
LZer29213 = zero_padding1D_layer(Add98750, 1, 0, Zer29213), 
LMin54878 = minimum_layer([Mul9218,Zer29213], Min54878), 
LCon30542 = concatenate_layer([Min54878,[[[0.173, 0.6067], [0.2256, 0.4261]]]], 2, Con30542), 
LAdd16382 = add_layer([Res93993,Con30542], Add16382), 
LCon23124 = concatenate_layer([Add16382,[[[0.7901, 0.4024, 0.5496, 0.448], [0.6741, 0.8779, 0.0333, 0.6188]]]], 2, Con23124), 
LMax36906 = maximum_layer([Res50981,Con23124], Max36906), 
exec_layers([LAdd90097,LRes79813,LCon68742,LRes50981,LAdd70878,LRes93993,LMul9218,LAdd98750,LZer29213,LMin54878,LCon30542,LAdd16382,LCon23124,LMax36906],["Add90097","Res79813","Con68742","Res50981","Add70878","Res93993","Mul9218","Add98750","Zer29213","Min54878","Con30542","Add16382","Con23124","Max36906"],Max36906,"Max36906")

Actual (Unparsed): [[[0.7116000, 0.8656000, 0.6149000, 1.2238336, 1.3584197, 1.2207976, 0.5951885, 1.5866417], [1.0708643, 1.3016220, 1.6284461, 2.6564125, 3.5332825, 2.8487988, 2.5035062, 3.1692519]]]

Expected (Unparsed): [[[0.7116,0.8656,0.6149,1.2238336,1.3584197500000001,1.22079764,0.59518852,1.5866417600000002],[1.0708643000000002,1.30162198,1.6284461600000002,2.65641248,3.5332825700000003,2.84879878,2.5035062600000004,3.16925189]]]

Actual:   [[[0.7116, 0.8656, 0.6149, 1.2239, 1.3585, 1.2208, 0.5952, 1.5867], [1.0709, 1.3017, 1.6285, 2.6565, 3.5333, 2.8488, 2.5036, 3.1693]]]

Expected: [[[0.7116, 0.8656, 0.6149, 1.2239, 1.3585, 1.2208, 0.5952, 1.5867], [1.0709, 1.3017, 1.6285, 2.6565, 3.5333, 2.8488, 2.5036, 3.1693]]]