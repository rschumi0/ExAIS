import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave60988 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave60988 = tf.keras.layers.Input(shape=([1, 2]))

Ave60988 = keras.layers.Average(name = 'Ave60988', )([in0Ave60988,in1Ave60988])
Res63525 = keras.layers.Reshape((1, 2, 1), name = 'Res63525', )(Ave60988)
PRe84477 = keras.layers.PReLU(name = 'PRe84477', )(Res63525)
model = tf.keras.models.Model(inputs=[in0Ave60988,in1Ave60988], outputs=PRe84477)
w = model.get_layer('PRe84477').get_weights() 
w[0] = np.array([[[0.6972], [0.1876]]])
model.get_layer('PRe84477').set_weights(w) 
in0Ave60988 = tf.constant([[[0.9714, 0.9322]]])
in1Ave60988 = tf.constant([[[0.0971, 0.0311]]])
print (np.array2string(model.predict([in0Ave60988,in1Ave60988],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe84477.png')

LAve60988 = average_layer([[[[0.9714, 0.9322]]], [[[0.0971, 0.0311]]]], Ave60988), 
LRes63525 = reshape_layer(Ave60988, [1, 2, 1], Res63525), 
LPRe84477 = prelu_layer(Res63525, [[[0.6972], [0.1876]]], PRe84477), 
exec_layers([LAve60988,LRes63525,LPRe84477],["Ave60988","Res63525","PRe84477"],PRe84477,"PRe84477")

Actual (Unparsed): [[[[0.5342500], [0.4816500]]]]

Expected (Unparsed): [[[[0.53425],[0.48165]]]]

Actual:   [[[[0.5343], [0.4817]]]]

Expected: [[[[0.5343], [0.4817]]]]