import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave47678 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave47678 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con86389 = tf.keras.layers.Input(shape=([2, 1]))
in0ReL37233 = tf.keras.layers.Input(shape=([2, 2]))

Ave47678 = keras.layers.Average(name = 'Ave47678', )([in0Ave47678,in1Ave47678])
Mas35449 = keras.layers.Masking(mask_value=1, name = 'Mas35449', )(Ave47678)
Res69022 = keras.layers.Reshape((2, 1), name = 'Res69022', )(Mas35449)
Con86389 = keras.layers.Concatenate(axis=2, name = 'Con86389', )([Res69022,in0Con86389])
ReL37233 = keras.layers.ReLU(max_value=7.837703253668046, negative_slope=7.859665915680452, threshold=5.946967885472164, name = 'ReL37233', input_shape=(2, 2))(in0ReL37233)
Add87702 = keras.layers.Add(name = 'Add87702', )([Con86389,ReL37233])
Sof43387 = keras.layers.Softmax(axis=1, name = 'Sof43387', )(Add87702)
model = tf.keras.models.Model(inputs=[in0Ave47678,in1Ave47678,in0Con86389,in0ReL37233], outputs=Sof43387)
in0Ave47678 = tf.constant([[[[0.4044]], [[0.4998]]]])
in1Ave47678 = tf.constant([[[[0.0318]], [[0.7945]]]])
in0Con86389 = tf.constant([[[0.6697], [0.472]]])
in0ReL37233 = tf.constant([[[0.0291, 0.4242], [0.5342, 0.2417]]])
print (np.array2string(model.predict([in0Ave47678,in1Ave47678,in0Con86389,in0ReL37233],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof43387.png')

LAve47678 = average_layer([[[[[0.4044]], [[0.4998]]]], [[[[0.0318]], [[0.7945]]]]], Ave47678), 
LMas35449 = masking_layer(Ave47678, 1, Mas35449), 
LRes69022 = reshape_layer(Mas35449, [2, 1], Res69022), 
LCon86389 = concatenate_layer([Res69022,[[[0.6697], [0.472]]]], 2, Con86389), 
LReL37233 = relu_layer([[[0.0291, 0.4242], [0.5342, 0.2417]]], 7.837703253668046, 7.859665915680452, 5.946967885472164, ReL37233), 
LAdd87702 = add_layer([Con86389,ReL37233], Add87702), 
LSof43387 = softmax_layer(Add87702, 1, Sof43387), 
exec_layers([LAve47678,LMas35449,LRes69022,LCon86389,LReL37233,LAdd87702,LSof43387],["Ave47678","Mas35449","Res69022","Con86389","ReL37233","Add87702","Sof43387"],Sof43387,"Sof43387")

Actual (Unparsed): [[[0.0121408, 0.8364556], [0.9878592, 0.1635444]]]

Expected (Unparsed): [[[0.012140814897518174,0.8364556139534469],[0.9878591851024818,0.16354438604655314]]]

Actual:   [[[0.0122, 0.8365], [0.9879, 0.1636]]]

Expected: [[[0.0122, 0.8365], [0.9879, 0.1636]]]