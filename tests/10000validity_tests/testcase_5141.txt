import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot70131 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot70131 = tf.keras.layers.Input(shape=([2, 3]))

Dot70131 = keras.layers.Dot(axes=(1, 1), name = 'Dot70131', )([in0Dot70131,in1Dot70131])
Res63551 = keras.layers.Reshape((3, 3, 1), name = 'Res63551', )(Dot70131)
Res39151 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res39151', )(Res63551)
Glo35576 = keras.layers.GlobalMaxPool3D(name = 'Glo35576', )(Res39151)
Res19282 = keras.layers.Reshape((1, 1), name = 'Res19282', )(Glo35576)
Per29494 = keras.layers.Permute((2,1), name = 'Per29494',)(Res19282)
model = tf.keras.models.Model(inputs=[in0Dot70131,in1Dot70131], outputs=Per29494)
in0Dot70131 = tf.constant([[[0.1842, 0.7317, 0.0735], [0.0695, 0.8825, 0.8681]]])
in1Dot70131 = tf.constant([[[0.4484, 0.8779, 0.597], [0.5997, 0.8532, 0.4688]]])
print (np.array2string(model.predict([in0Dot70131,in1Dot70131],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per29494.png')

LDot70131 = dot_layer([[[0.1842, 0.7317, 0.0735], [0.0695, 0.8825, 0.8681]]], [[[0.4484, 0.8779, 0.597], [0.5997, 0.8532, 0.4688]]], 1, 1, Dot70131), 
LRes63551 = reshape_layer(Dot70131, [3, 3, 1], Res63551), 
LRes39151 = reshape_layer(Res63551, [3, 3, 1, 1], Res39151), 
LGlo35576 = global_max_pool3D_layer(Res39151, Glo35576), 
LRes19282 = reshape_layer(Glo35576, [1, 1], Res19282), 
LPer29494 = permute_layer(Res19282, 2,1, Per29494), 
exec_layers([LDot70131,LRes63551,LRes39151,LGlo35576,LRes19282,LPer29494],["Dot70131","Res63551","Res39151","Glo35576","Res19282","Per29494"],Per29494,"Per29494")

Actual (Unparsed): [[[1.3953084]]]

Expected (Unparsed): [[[1.39530843]]]

Actual:   [[[1.3954]]]

Expected: [[[1.3954]]]