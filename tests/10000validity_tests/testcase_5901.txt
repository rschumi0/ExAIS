import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul59652 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Mul59652 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Mul59652 = keras.layers.Multiply(name = 'Mul59652', )([in0Mul59652,in1Mul59652])
Res86937 = keras.layers.Reshape((2, 1, 2), name = 'Res86937', )(Mul59652)
Res38508 = keras.layers.Reshape((2, 2), name = 'Res38508', )(Res86937)
Glo11469 = keras.layers.GlobalMaxPool1D(name = 'Glo11469', )(Res38508)
model = tf.keras.models.Model(inputs=[in0Mul59652,in1Mul59652], outputs=Glo11469)
in0Mul59652 = tf.constant([[[[[0.6428, 0.0239]]], [[[0.7329, 0.2898]]]]])
in1Mul59652 = tf.constant([[[[[0.5755, 0.4322]]], [[[0.0648, 0.5809]]]]])
print (np.array2string(model.predict([in0Mul59652,in1Mul59652],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo11469.png')

LMul59652 = multiply_layer([[[[[[0.6428, 0.0239]]], [[[0.7329, 0.2898]]]]], [[[[[0.5755, 0.4322]]], [[[0.0648, 0.5809]]]]]], Mul59652), 
LRes86937 = reshape_layer(Mul59652, [2, 1, 2], Res86937), 
LRes38508 = reshape_layer(Res86937, [2, 2], Res38508), 
LGlo11469 = global_max_pool1D_layer(Res38508, Glo11469), 
exec_layers([LMul59652,LRes86937,LRes38508,LGlo11469],["Mul59652","Res86937","Res38508","Glo11469"],Glo11469,"Glo11469")

Actual (Unparsed): [[0.3699314, 0.1683448]]

Expected (Unparsed): [[0.3699314,0.16834482]]

Actual:   [[0.37, 0.1684]]

Expected: [[0.37, 0.1684]]