import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub56574 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in1Sub56574 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))

Sub56574 = keras.layers.Subtract(name = 'Sub56574', )([in0Sub56574,in1Sub56574])
Res36341 = keras.layers.Reshape((2, 2, 6), name = 'Res36341', )(Sub56574)
Con69405 = keras.layers.Conv2D(2, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con69405', )(Res36341)
model = tf.keras.models.Model(inputs=[in0Sub56574,in1Sub56574], outputs=Con69405)
w = model.get_layer('Con69405').get_weights() 
w[0] = np.array([[[[0.3691, 0.8706], [0.3718, 0.9214], [0.0587, 0.6791], [0.4932, 0.785], [0.6068, 0.8643], [0.6705, 0.3338]], [[0.6265, 0.9963], [0.3501, 0.9008], [0.8553, 0.0142], [0.5369, 0.5022], [0.2065, 0.793], [0.2007, 0.0132]]]])
w[1] = np.array([0, 0])
model.get_layer('Con69405').set_weights(w) 
in0Sub56574 = tf.constant([[[[[0.4949, 0.2412], [0.7353, 0.2776], [0.4187, 0.3789]], [[0.1336, 0.4005], [0.0474, 0.4417], [0.0132, 0.319]]], [[[0.8717, 0.7442], [0.6663, 0.4366], [0.8064, 0.4917]], [[0.1649, 0.0065], [0.4471, 0.8801], [0.9885, 0.3707]]]]])
in1Sub56574 = tf.constant([[[[[0.9712, 0.0771], [0.2385, 0.5711], [0.768, 0.6363]], [[0.0523, 0.5567], [0.2574, 0.8703], [0.9693, 0.5758]]], [[[0.5159, 0.7208], [0.427, 0.2449], [0.264, 0.7016]], [[0.2667, 0.2153], [0.4935, 0.5627], [0.1157, 0.3191]]]]])
print (np.array2string(model.predict([in0Sub56574,in1Sub56574],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con69405.png')

LSub56574 = subtract_layer([[[[[0.4949, 0.2412], [0.7353, 0.2776], [0.4187, 0.3789]], [[0.1336, 0.4005], [0.0474, 0.4417], [0.0132, 0.319]]], [[[0.8717, 0.7442], [0.6663, 0.4366], [0.8064, 0.4917]], [[0.1649, 0.0065], [0.4471, 0.8801], [0.9885, 0.3707]]]]], [[[[[0.9712, 0.0771], [0.2385, 0.5711], [0.768, 0.6363]], [[0.0523, 0.5567], [0.2574, 0.8703], [0.9693, 0.5758]]], [[[0.5159, 0.7208], [0.427, 0.2449], [0.264, 0.7016]], [[0.2667, 0.2153], [0.4935, 0.5627], [0.1157, 0.3191]]]]], Sub56574), 
LRes36341 = reshape_layer(Sub56574, [2, 2, 6], Res36341), 
LCon69405 = conv2D_layer(Res36341, 1, 2,[[[[0.3691, 0.8706], [0.3718, 0.9214], [0.0587, 0.6791], [0.4932, 0.785], [0.6068, 0.8643], [0.6705, 0.3338]], [[0.6265, 0.9963], [0.3501, 0.9008], [0.8553, 0.0142], [0.5369, 0.5022], [0.2065, 0.793], [0.2007, 0.0132]]]],[0, 0], 1, 1, false, 1, 1, Con69405), 
exec_layers([LSub56574,LRes36341,LCon69405],["Sub56574","Res36341","Con69405"],Con69405,"Con69405")

Actual (Unparsed): [[[[-1.2773779, -1.5838135]], [[0.6214465, 1.6050856]]]]

Expected (Unparsed): [[[[-1.27737785,-1.5838135199999999]],[[0.6214464999999999,1.6050856100000002]]]]

Actual:   [[[[-1.2773, -1.5838]], [[0.6215, 1.6051]]]]

Expected: [[[[-1.2773, -1.5838]], [[0.6215, 1.6051]]]]