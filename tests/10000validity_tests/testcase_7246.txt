import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep96878 = tf.keras.layers.Input(shape=([1, 1]))

Sep96878 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='same', name = 'Sep96878', )(in0Sep96878)
Zer25924 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer25924', )(Sep96878)
Res7813 = keras.layers.Reshape((3, 3, 1), name = 'Res7813', )(Zer25924)
Sep73238 = keras.layers.SeparableConv2D(3, (2, 2),strides=(1, 1), padding='same', name = 'Sep73238', )(Res7813)
model = tf.keras.models.Model(inputs=[in0Sep96878], outputs=Sep73238)
w = model.get_layer('Sep96878').get_weights() 
w[0] = np.array([[[0.229]]])
w[1] = np.array([[[0.9752, 0.9714, 0.5406]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep96878').set_weights(w) 
w = model.get_layer('Sep73238').get_weights() 
w[0] = np.array([[[[0.5706]], [[0.2076]]], [[[0.6782]], [[0.653]]]])
w[1] = np.array([[[[0.1693, 0.4969, 0.8655]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep73238').set_weights(w) 
in0Sep96878 = tf.constant([[[0.5953]]])
print (np.array2string(model.predict([in0Sep96878],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep73238.png')

LSep96878 = separable_conv1D_layer([[[0.5953]]], 1,[[[[0.229]]],[[[0.9752, 0.9714, 0.5406]]]],[0, 0, 0], 1, true, Sep96878), 
LZer25924 = zero_padding1D_layer(Sep96878, 1, 1, Zer25924), 
LRes7813 = reshape_layer(Zer25924, [3, 3, 1], Res7813), 
LSep73238 = separable_conv2D_layer(Res7813, 2, 2,[[[[[0.5706]], [[0.2076]]], [[[0.6782]], [[0.653]]]],[[[[0.1693, 0.4969, 0.8655]]]]],[0, 0, 0], 1, 1, true, Sep73238), 
exec_layers([LSep96878,LZer25924,LRes7813,LSep73238],["Sep96878","Zer25924","Res7813","Sep73238"],Sep73238,"Sep73238")

Actual (Unparsed): [[[[0.0299044, 0.0877701, 0.1528778], [0.0233523, 0.0685396, 0.1193822], [0.0084618, 0.0248356, 0.0432586]], [[0.0174969, 0.0513539, 0.0894482], [0.0153828, 0.0451488, 0.0786402], [0.0071193, 0.0208953, 0.0363954]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0.02990435254791267,0.08777006958687422,0.1528778330196008],[0.023352294374762834,0.06853960469474099,0.11938222552485075],[0.00846178818322216,0.02483557323238683,0.043258580464139273]],[[0.017496918003145342,0.0513539194079322,0.08944821341832425],[0.015382771954527657,0.04514884456116239,0.07864021929500112],[0.007119280945659928,0.020895278806251735,0.03639537896319355]],[[0.0,0.0,0.0],[0.0,0.0,0.0],[0.0,0.0,0.0]]]]

Actual:   [[[[0.03, 0.0878, 0.1529], [0.0234, 0.0686, 0.1194], [0.0085, 0.0249, 0.0433]], [[0.0175, 0.0514, 0.0895], [0.0154, 0.0452, 0.0787], [0.0072, 0.0209, 0.0364]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]

Expected: [[[[0.03, 0.0878, 0.1529], [0.0234, 0.0686, 0.1194], [0.0085, 0.0249, 0.0433]], [[0.0175, 0.0514, 0.0895], [0.0154, 0.0452, 0.0787], [0.0072, 0.0209, 0.0364]], [[0, 0, 0], [0, 0, 0], [0, 0, 0]]]]