import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST5807 = tf.keras.layers.Input(shape=([2, 3]))

LST5807 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST5807', )(in0LST5807)
Res55143 = keras.layers.Reshape((1, 1), name = 'Res55143', )(LST5807)
Res64481 = keras.layers.Reshape((1, 1, 1), name = 'Res64481', )(Res55143)
Dep98260 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep98260', )(Res64481)
ELU21517 = keras.layers.ELU(alpha=6.6443623031536845, name = 'ELU21517', )(Dep98260)
Zer22704 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer22704', )(ELU21517)
Ave57566 = keras.layers.AveragePooling2D(pool_size=(1, 2), name = 'Ave57566', )(Zer22704)
ReL74855 = keras.layers.ReLU(max_value=4.214306730938683, negative_slope=1.14498485993546, threshold=4.519026597837977, name = 'ReL74855', )(Ave57566)
model = tf.keras.models.Model(inputs=[in0LST5807], outputs=ReL74855)
w = model.get_layer('LST5807').get_weights() 
w[0] = np.array([[3, 7, 3, 8], [9, 10, 5, 3], [10, 10, 5, 4]])
w[1] = np.array([[4, 4, 9, 3]])
w[2] = np.array([1, 5, 1, 3])
model.get_layer('LST5807').set_weights(w) 
w = model.get_layer('Dep98260').get_weights() 
w[0] = np.array([[[[0.5311]]]])
w[1] = np.array([0])
model.get_layer('Dep98260').set_weights(w) 
in0LST5807 = tf.constant([[[2, 8, 5], [1, 5, 5]]])
print (np.array2string(model.predict([in0LST5807],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL74855.png')

LLST5807 = lstm_layer([[[2, 8, 5], [1, 5, 5]]],[[3, 7, 3, 8], [9, 10, 5, 3], [10, 10, 5, 4]],[[4, 4, 9, 3]],[1, 5, 1, 3], LST5807), 
LRes55143 = reshape_layer(LST5807, [1, 1], Res55143), 
LRes64481 = reshape_layer(Res55143, [1, 1, 1], Res64481), 
LDep98260 = depthwise_conv2D_layer(Res64481, 1, 1,[[[[0.5311]]]],[0], 1, 1, false, Dep98260), 
LELU21517 = elu_layer(Dep98260, 6.6443623031536845, ELU21517), 
LZer22704 = zero_padding2D_layer(ELU21517, 1, 1, 1, 1, Zer22704), 
LAve57566 = average_pooling2D_layer(Zer22704, 1, 2, Ave57566), 
LReL74855 = relu_layer(Ave57566, 4.214306730938683, 1.14498485993546, 4.519026597837977, ReL74855), 
exec_layers([LLST5807,LRes55143,LRes64481,LDep98260,LELU21517,LZer22704,LAve57566,LReL74855],["LST5807","Res55143","Res64481","Dep98260","ELU21517","Zer22704","Ave57566","ReL74855"],ReL74855,"ReL74855")

Actual (Unparsed): [[[[-5.1742170]], [[-4.8811037]], [[-5.1742170]]]]

Expected (Unparsed): [[[[-5.174217036170134]],[[-4.881103747136111]],[[-5.174217036170134]]]]

Actual:   [[[[-5.1742]], [[-4.8811]], [[-5.1742]]]]

Expected: [[[[-5.1742]], [[-4.8811]], [[-5.1742]]]]