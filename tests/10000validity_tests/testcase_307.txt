import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul83871 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul83871 = tf.keras.layers.Input(shape=([2, 2, 1]))

Mul83871 = keras.layers.Multiply(name = 'Mul83871', )([in0Mul83871,in1Mul83871])
Res65666 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res65666', )(Mul83871)
Zer59209 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer59209', )(Res65666)
Res20767 = keras.layers.Reshape((4, 4, 3), name = 'Res20767', )(Zer59209)
Max77382 = keras.layers.MaxPool2D(pool_size=(1, 2), name = 'Max77382', )(Res20767)
model = tf.keras.models.Model(inputs=[in0Mul83871,in1Mul83871], outputs=Max77382)
in0Mul83871 = tf.constant([[[[0.6471], [0.4104]], [[0.7557], [0.2227]]]])
in1Mul83871 = tf.constant([[[[0.0998], [0.6988]], [[0.4683], [0.0811]]]])
print (np.array2string(model.predict([in0Mul83871,in1Mul83871],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max77382.png')

LMul83871 = multiply_layer([[[[[0.6471], [0.4104]], [[0.7557], [0.2227]]]], [[[[0.0998], [0.6988]], [[0.4683], [0.0811]]]]], Mul83871), 
LRes65666 = reshape_layer(Mul83871, [2, 2, 1, 1], Res65666), 
LZer59209 = zero_padding3D_layer(Res65666, 1, 1, 1, 1, 1, 1, Zer59209), 
LRes20767 = reshape_layer(Zer59209, [4, 4, 3], Res20767), 
LMax77382 = max_pool2D_layer(Res20767, 1, 2, Max77382), 
exec_layers([LMul83871,LRes65666,LZer59209,LRes20767,LMax77382],["Mul83871","Res65666","Zer59209","Res20767","Max77382"],Max77382,"Max77382")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0645806, 0.0000000], [0.0000000, 0.2867875, 0.0000000]], [[0.0000000, 0.3538943, 0.0000000], [0.0000000, 0.0180610, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0,0,0],[0,0,0]],[[0,0.06458058,0],[0,0.28678751999999996,0]],[[0,0.35389431,0],[0,0.018060970000000003,0]],[[0,0,0],[0,0,0]]]]

Actual:   [[[[0, 0, 0], [0, 0, 0]], [[0, 0.0646, 0], [0, 0.2868, 0]], [[0, 0.3539, 0], [0, 0.0181, 0]], [[0, 0, 0], [0, 0, 0]]]]

Expected: [[[[0, 0, 0], [0, 0, 0]], [[0, 0.0646, 0], [0, 0.2868, 0]], [[0, 0.3539, 0], [0, 0.0181, 0]], [[0, 0, 0], [0, 0, 0]]]]