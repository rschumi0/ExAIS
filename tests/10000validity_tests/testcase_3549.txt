import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul59876 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul59876 = tf.keras.layers.Input(shape=([2, 1]))
in0Bat26991 = tf.keras.layers.Input(shape=([1]))
in0Con31390 = tf.keras.layers.Input(shape=([1]))

Mul59876 = keras.layers.Multiply(name = 'Mul59876', )([in0Mul59876,in1Mul59876])
Fla71456 = keras.layers.Flatten(name = 'Fla71456', )(Mul59876)
Bat26991 = keras.layers.BatchNormalization(axis=1, epsilon=0.604306344612564,  name = 'Bat26991', )(in0Bat26991)
Con31390 = keras.layers.Concatenate(axis=1, name = 'Con31390', )([Bat26991,in0Con31390])
Min29656 = keras.layers.Minimum(name = 'Min29656', )([Fla71456,Con31390])
Mas13705 = keras.layers.Masking(mask_value=2, name = 'Mas13705', )(Min29656)
model = tf.keras.models.Model(inputs=[in0Mul59876,in1Mul59876,in0Bat26991,in0Con31390], outputs=Mas13705)
w = model.get_layer('Bat26991').get_weights() 
w[0] = np.array([0.8325])
w[1] = np.array([0.8559])
w[2] = np.array([0.7189])
w[3] = np.array([0.4351])
model.get_layer('Bat26991').set_weights(w) 
in0Mul59876 = tf.constant([[[0.049], [0.7255]]])
in1Mul59876 = tf.constant([[[0.9463], [0.2956]]])
in0Bat26991 = tf.constant([[1.7007]])
in0Con31390 = tf.constant([[0.5856]])
print (np.array2string(model.predict([in0Mul59876,in1Mul59876,in0Bat26991,in0Con31390],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas13705.png')

LMul59876 = multiply_layer([[[[0.049], [0.7255]]], [[[0.9463], [0.2956]]]], Mul59876), 
LFla71456 = flatten_layer(Mul59876, Fla71456), 
LBat26991 = batch_normalization_layer([[1.7007]], 1, 0.604306344612564, [0.8325], [0.8559], [0.7189], [0.4351], Bat26991), 
LCon31390 = concatenate_layer([Bat26991,[[0.5856]]], 1, Con31390), 
LMin29656 = minimum_layer([Fla71456,Con31390], Min29656), 
LMas13705 = masking_layer(Min29656, 2, Mas13705), 
exec_layers([LMul59876,LFla71456,LBat26991,LCon31390,LMin29656,LMas13705],["Mul59876","Fla71456","Bat26991","Con31390","Min29656","Mas13705"],Mas13705,"Mas13705")

Actual (Unparsed): [[0.0463687, 0.2144578]]

Expected (Unparsed): [[0.046368700000000006,0.2144578]]

Actual:   [[0.0464, 0.2145]]

Expected: [[0.0464, 0.2145]]