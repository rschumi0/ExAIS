import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max76059 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max76059 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Max97055 = tf.keras.layers.Input(shape=([2, 1]))
in1Max97055 = tf.keras.layers.Input(shape=([2, 1]))
in0Con45713 = tf.keras.layers.Input(shape=([1]))
in0Glo85567 = tf.keras.layers.Input(shape=([2, 2]))
in0Con3341 = tf.keras.layers.Input(shape=([2]))

Max76059 = keras.layers.Maximum(name = 'Max76059', )([in0Max76059,in1Max76059])
Res25349 = keras.layers.Reshape((2, 2), name = 'Res25349', )(Max76059)
Fla47701 = keras.layers.Flatten(name = 'Fla47701', )(Res25349)
Max97055 = keras.layers.Maximum(name = 'Max97055', )([in0Max97055,in1Max97055])
Res88206 = keras.layers.Reshape((2, 1, 1), name = 'Res88206', )(Max97055)
Res95842 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res95842', )(Res88206)
Cro66225 = keras.layers.Cropping3D(cropping=((1, 0), (0, 0), (0, 0)), name = 'Cro66225', )(Res95842)
Res16213 = keras.layers.Reshape((1, 1, 1), name = 'Res16213', )(Cro66225)
Res4317 = keras.layers.Reshape((1, 1), name = 'Res4317', )(Res16213)
Fla97955 = keras.layers.Flatten(name = 'Fla97955', )(Res4317)
Con45713 = keras.layers.Concatenate(axis=1, name = 'Con45713', )([Fla97955,in0Con45713])
Glo85567 = keras.layers.GlobalAveragePooling1D(name = 'Glo85567', )(in0Glo85567)
Ave90190 = keras.layers.Average(name = 'Ave90190', )([Con45713,Glo85567])
Con3341 = keras.layers.Concatenate(axis=1, name = 'Con3341', )([Ave90190,in0Con3341])
Add45977 = keras.layers.Add(name = 'Add45977', )([Fla47701,Con3341])
model = tf.keras.models.Model(inputs=[in0Max76059,in1Max76059,in0Max97055,in1Max97055,in0Con45713,in0Glo85567,in0Con3341], outputs=Add45977)
in0Max76059 = tf.constant([[[[0.4669, 0.5668]], [[0.9665, 0.5439]]]])
in1Max76059 = tf.constant([[[[0.5992, 0.1173]], [[0.569, 0.8716]]]])
in0Max97055 = tf.constant([[[0.3707], [0.8107]]])
in1Max97055 = tf.constant([[[0.3116], [0.9373]]])
in0Con45713 = tf.constant([[0.857]])
in0Glo85567 = tf.constant([[[1.3225, 1.3057], [1.9903, 1.4519]]])
in0Con3341 = tf.constant([[0.0483, 0.6447]])
print (np.array2string(model.predict([in0Max76059,in1Max76059,in0Max97055,in1Max97055,in0Con45713,in0Glo85567,in0Con3341],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add45977.png')

LMax76059 = maximum_layer([[[[[0.4669, 0.5668]], [[0.9665, 0.5439]]]], [[[[0.5992, 0.1173]], [[0.569, 0.8716]]]]], Max76059), 
LRes25349 = reshape_layer(Max76059, [2, 2], Res25349), 
LFla47701 = flatten_layer(Res25349, Fla47701), 
LMax97055 = maximum_layer([[[[0.3707], [0.8107]]], [[[0.3116], [0.9373]]]], Max97055), 
LRes88206 = reshape_layer(Max97055, [2, 1, 1], Res88206), 
LRes95842 = reshape_layer(Res88206, [2, 1, 1, 1], Res95842), 
LCro66225 = cropping3D_layer(Res95842, 1, 0, 0, 0, 0, 0, Cro66225), 
LRes16213 = reshape_layer(Cro66225, [1, 1, 1], Res16213), 
LRes4317 = reshape_layer(Res16213, [1, 1], Res4317), 
LFla97955 = flatten_layer(Res4317, Fla97955), 
LCon45713 = concatenate_layer([Fla97955,[[0.857]]], 1, Con45713), 
LGlo85567 = global_average_pooling1D_layer([[[1.3225, 1.3057], [1.9903, 1.4519]]], Glo85567), 
LAve90190 = average_layer([Con45713,Glo85567], Ave90190), 
LCon3341 = concatenate_layer([Ave90190,[[0.0483, 0.6447]]], 1, Con3341), 
LAdd45977 = add_layer([Fla47701,Con3341], Add45977), 
exec_layers([LMax76059,LRes25349,LFla47701,LMax97055,LRes88206,LRes95842,LCro66225,LRes16213,LRes4317,LFla97955,LCon45713,LGlo85567,LAve90190,LCon3341,LAdd45977],["Max76059","Res25349","Fla47701","Max97055","Res88206","Res95842","Cro66225","Res16213","Res4317","Fla97955","Con45713","Glo85567","Ave90190","Con3341","Add45977"],Add45977,"Add45977")

Actual (Unparsed): [[1.8960500, 1.6847000, 1.0148000, 1.5163000]]

Expected (Unparsed): [[1.89605,1.6847,1.0148,1.5163000000000002]]

Actual:   [[1.8961, 1.6847, 1.0148, 1.5163]]

Expected: [[1.8961, 1.6847, 1.0148, 1.5164]]