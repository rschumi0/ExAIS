import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_73752 = tf.keras.layers.Input(shape=([1, 4, 4]))

Up_73752 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_73752', )(in0Up_73752)
Res43572 = keras.layers.Reshape((1, 32), name = 'Res43572', )(Up_73752)
Per57203 = keras.layers.Permute((1,2), name = 'Per57203',)(Res43572)
Den1162 = keras.layers.Dense(1,name = 'Den1162', )(Per57203)
model = tf.keras.models.Model(inputs=[in0Up_73752], outputs=Den1162)
w = model.get_layer('Den1162').get_weights() 
w[0] = np.array([[0.4685], [0.8094], [0.3658], [0.5375], [0.3368], [0.1125], [0.7256], [0.9612], [0.9263], [0.3981], [0.1815], [0.2025], [0.5564], [0.0598], [0.9436], [0.6906], [0.5948], [0.5499], [0.9982], [0.7844], [0.8182], [0.7835], [0.9881], [0.9296], [0.0795], [0.6755], [0.4435], [0.6573], [0.7844], [0.3575], [0.2646], [0.6998]])
w[1] = np.array([0.6702])
model.get_layer('Den1162').set_weights(w) 
in0Up_73752 = tf.constant([[[[1.1587, 1.3851, 1.9196, 1.6764], [1.9218, 1.7085, 1.4966, 1.9416], [1.8921, 1.4598, 1.38, 1.5371], [1.6622, 1.8974, 1.4465, 1.8245]]]])
print (np.array2string(model.predict([in0Up_73752],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den1162.png')

LUp_73752 = up_sampling2D_layer([[[[1.1587, 1.3851, 1.9196, 1.6764], [1.9218, 1.7085, 1.4966, 1.9416], [1.8921, 1.4598, 1.38, 1.5371], [1.6622, 1.8974, 1.4465, 1.8245]]]], 1, 2, Up_73752), 
LRes43572 = reshape_layer(Up_73752, [1, 32], Res43572), 
LPer57203 = permute_layer(Res43572, 1,2, Per57203), 
LDen1162 = dense_layer(Per57203, [[0.4685], [0.8094], [0.3658], [0.5375], [0.3368], [0.1125], [0.7256], [0.9612], [0.9263], [0.3981], [0.1815], [0.2025], [0.5564], [0.0598], [0.9436], [0.6906], [0.5948], [0.5499], [0.9982], [0.7844], [0.8182], [0.7835], [0.9881], [0.9296], [0.0795], [0.6755], [0.4435], [0.6573], [0.7844], [0.3575], [0.2646], [0.6998]],[0.6702], Den1162), 
exec_layers([LUp_73752,LRes43572,LPer57203,LDen1162],["Up_73752","Res43572","Per57203","Den1162"],Den1162,"Den1162")

Actual (Unparsed): [[[31.4293417]]]

Expected (Unparsed): [[[31.429341950000005]]]

Actual:   [[[31.4294]]]

Expected: [[[31.4294]]]