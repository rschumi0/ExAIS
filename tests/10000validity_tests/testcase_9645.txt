import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max65983 = tf.keras.layers.Input(shape=([1, 1]))
in1Max65983 = tf.keras.layers.Input(shape=([1, 1]))
in0Con43412 = tf.keras.layers.Input(shape=([8, 2, 4, 1]))
in0Up_94571 = tf.keras.layers.Input(shape=([4, 2, 1, 2]))

Max65983 = keras.layers.Maximum(name = 'Max65983', )([in0Max65983,in1Max65983])
Res39136 = keras.layers.Reshape((1, 1, 1), name = 'Res39136', )(Max65983)
Con70256 = keras.layers.Conv2D(3, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con70256', )(Res39136)
Res42252 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res42252', )(Con70256)
Zer21634 = keras.layers.ZeroPadding3D(padding=((7, 0), (1, 0), (1, 0)), name = 'Zer21634', )(Res42252)
Con43412 = keras.layers.Concatenate(axis=4, name = 'Con43412', )([Zer21634,in0Con43412])
Up_94571 = keras.layers.UpSampling3D(size=(2, 1, 2), name = 'Up_94571', )(in0Up_94571)
Zer51744 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer51744', )(Up_94571)
Min90339 = keras.layers.Minimum(name = 'Min90339', )([Con43412,Zer51744])
model = tf.keras.models.Model(inputs=[in0Max65983,in1Max65983,in0Con43412,in0Up_94571], outputs=Min90339)
w = model.get_layer('Con70256').get_weights() 
w[0] = np.array([[[[0.6158, 0.7368, 0.2542]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con70256').set_weights(w) 
in0Max65983 = tf.constant([[[0.7604]]])
in1Max65983 = tf.constant([[[0.3335]]])
in0Con43412 = tf.constant([[[[[0.7168], [0.622], [0.715], [0.1445]], [[0.3577], [0.0744], [0.2186], [0.6116]]], [[[0.1264], [0.7648], [0.8594], [0.0049]], [[0.3371], [0.8612], [0.349], [0.035]]], [[[0.2222], [0.1554], [0.9739], [0.7652]], [[0.2001], [0.6869], [0.8413], [0.2521]]], [[[0.8597], [0.4496], [0.9121], [0.3206]], [[0.1531], [0.6423], [0.0491], [0.3413]]], [[[0.3915], [0.1876], [0.7975], [0.165]], [[0.7714], [0.7954], [0.6454], [0.4294]]], [[[0.325], [0.6718], [0.0615], [0.299]], [[0.3836], [0.0901], [0.6969], [0.3247]]], [[[0.8714], [0.4259], [0.758], [0.5182]], [[0.0056], [0.9376], [0.7026], [0.922]]], [[[0.2668], [0.5217], [0.0948], [0.929]], [[0.83], [0.9122], [0.6664], [0.3534]]]]])
in0Up_94571 = tf.constant([[[[[1.9032, 1.5513]], [[1.4167, 1.0476]]], [[[1.8374, 1.8888]], [[1.7687, 1.8608]]], [[[1.9122, 1.5299]], [[1.0677, 1.4194]]], [[[1.0334, 1.2333]], [[1.1029, 1.4971]]]]])
print (np.array2string(model.predict([in0Max65983,in1Max65983,in0Con43412,in0Up_94571],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min90339.png')

LMax65983 = maximum_layer([[[[0.7604]]], [[[0.3335]]]], Max65983), 
LRes39136 = reshape_layer(Max65983, [1, 1, 1], Res39136), 
LCon70256 = conv2D_layer(Res39136, 1, 1,[[[[0.6158, 0.7368, 0.2542]]]],[0, 0, 0], 1, 1, false, 1, 1, Con70256), 
LRes42252 = reshape_layer(Con70256, [1, 1, 3, 1], Res42252), 
LZer21634 = zero_padding3D_layer(Res42252, 7, 0, 1, 0, 1, 0, Zer21634), 
LCon43412 = concatenate_layer([Zer21634,[[[[[0.7168], [0.622], [0.715], [0.1445]], [[0.3577], [0.0744], [0.2186], [0.6116]]], [[[0.1264], [0.7648], [0.8594], [0.0049]], [[0.3371], [0.8612], [0.349], [0.035]]], [[[0.2222], [0.1554], [0.9739], [0.7652]], [[0.2001], [0.6869], [0.8413], [0.2521]]], [[[0.8597], [0.4496], [0.9121], [0.3206]], [[0.1531], [0.6423], [0.0491], [0.3413]]], [[[0.3915], [0.1876], [0.7975], [0.165]], [[0.7714], [0.7954], [0.6454], [0.4294]]], [[[0.325], [0.6718], [0.0615], [0.299]], [[0.3836], [0.0901], [0.6969], [0.3247]]], [[[0.8714], [0.4259], [0.758], [0.5182]], [[0.0056], [0.9376], [0.7026], [0.922]]], [[[0.2668], [0.5217], [0.0948], [0.929]], [[0.83], [0.9122], [0.6664], [0.3534]]]]]], 4, Con43412), 
LUp_94571 = up_sampling3D_layer([[[[[1.9032, 1.5513]], [[1.4167, 1.0476]]], [[[1.8374, 1.8888]], [[1.7687, 1.8608]]], [[[1.9122, 1.5299]], [[1.0677, 1.4194]]], [[[1.0334, 1.2333]], [[1.1029, 1.4971]]]]], 2, 1, 2, Up_94571), 
LZer51744 = zero_padding3D_layer(Up_94571, 0, 0, 0, 0, 2, 0, Zer51744), 
LMin90339 = minimum_layer([Con43412,Zer51744], Min90339), 
exec_layers([LMax65983,LRes39136,LCon70256,LRes42252,LZer21634,LCon43412,LUp_94571,LZer51744,LMin90339],["Max65983","Res39136","Con70256","Res42252","Zer21634","Con43412","Up_94571","Zer51744","Min90339"],Min90339,"Min90339")

Actual (Unparsed): [[[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.7150000], [0.0000000, 0.1445000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.2186000], [0.0000000, 0.6116000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.8594000], [0.0000000, 0.0049000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.3490000], [0.0000000, 0.0350000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.9739000], [0.0000000, 0.7652000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.8413000], [0.0000000, 0.2521000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.9121000], [0.0000000, 0.3206000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0491000], [0.0000000, 0.3413000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.7975000], [0.0000000, 0.1650000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.6454000], [0.0000000, 0.4294000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0615000], [0.0000000, 0.2990000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.6969000], [0.0000000, 0.3247000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.7580000], [0.0000000, 0.5182000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.7026000], [0.0000000, 0.9220000]]], [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0948000], [0.0000000, 0.9290000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.5602627, 0.6664000], [0.1932937, 0.3534000]]]]]

Expected (Unparsed): [[[[[0,0],[0,0],[0,0.715],[0,0.1445]],[[0,0],[0,0],[0,0.2186],[0,0.6116]]],[[[0,0],[0,0],[0,0.8594],[0,0.0049]],[[0,0],[0,0],[0,0.349],[0,0.035]]],[[[0,0],[0,0],[0,0.9739],[0,0.7652]],[[0,0],[0,0],[0,0.8413],[0,0.2521]]],[[[0,0],[0,0],[0,0.9121],[0,0.3206]],[[0,0],[0,0],[0,0.0491],[0,0.3413]]],[[[0,0],[0,0],[0,0.7975],[0,0.165]],[[0,0],[0,0],[0,0.6454],[0,0.4294]]],[[[0,0],[0,0],[0,0.0615],[0,0.299]],[[0,0],[0,0],[0,0.6969],[0,0.3247]]],[[[0,0],[0,0],[0,0.758],[0,0.5182]],[[0,0],[0,0],[0,0.7026],[0,0.922]]],[[[0,0],[0,0],[0,0.0948],[0,0.929]],[[0,0],[0,0],[0.56026272,0.6664],[0.19329367999999997,0.3534]]]]]

Actual:   [[[[[0, 0], [0, 0], [0, 0.715], [0, 0.1445]], [[0, 0], [0, 0], [0, 0.2186], [0, 0.6116]]], [[[0, 0], [0, 0], [0, 0.8594], [0, 0.0049]], [[0, 0], [0, 0], [0, 0.349], [0, 0.035]]], [[[0, 0], [0, 0], [0, 0.9739], [0, 0.7652]], [[0, 0], [0, 0], [0, 0.8413], [0, 0.2521]]], [[[0, 0], [0, 0], [0, 0.9121], [0, 0.3206]], [[0, 0], [0, 0], [0, 0.0491], [0, 0.3413]]], [[[0, 0], [0, 0], [0, 0.7975], [0, 0.165]], [[0, 0], [0, 0], [0, 0.6454], [0, 0.4294]]], [[[0, 0], [0, 0], [0, 0.0615], [0, 0.299]], [[0, 0], [0, 0], [0, 0.6969], [0, 0.3247]]], [[[0, 0], [0, 0], [0, 0.758], [0, 0.5182]], [[0, 0], [0, 0], [0, 0.7026], [0, 0.922]]], [[[0, 0], [0, 0], [0, 0.0948], [0, 0.929]], [[0, 0], [0, 0], [0.5603, 0.6664], [0.1933, 0.3534]]]]]

Expected: [[[[[0, 0], [0, 0], [0, 0.715], [0, 0.1445]], [[0, 0], [0, 0], [0, 0.2186], [0, 0.6116]]], [[[0, 0], [0, 0], [0, 0.8594], [0, 0.0049]], [[0, 0], [0, 0], [0, 0.349], [0, 0.035]]], [[[0, 0], [0, 0], [0, 0.9739], [0, 0.7652]], [[0, 0], [0, 0], [0, 0.8413], [0, 0.2521]]], [[[0, 0], [0, 0], [0, 0.9121], [0, 0.3206]], [[0, 0], [0, 0], [0, 0.0491], [0, 0.3413]]], [[[0, 0], [0, 0], [0, 0.7975], [0, 0.165]], [[0, 0], [0, 0], [0, 0.6454], [0, 0.4294]]], [[[0, 0], [0, 0], [0, 0.0615], [0, 0.299]], [[0, 0], [0, 0], [0, 0.6969], [0, 0.3247]]], [[[0, 0], [0, 0], [0, 0.758], [0, 0.5182]], [[0, 0], [0, 0], [0, 0.7026], [0, 0.922]]], [[[0, 0], [0, 0], [0, 0.0948], [0, 0.929]], [[0, 0], [0, 0], [0.5603, 0.6664], [0.1933, 0.3534]]]]]