import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe95806 = tf.keras.layers.Input(shape=([1, 2]))

PRe95806 = keras.layers.PReLU(name = 'PRe95806', input_shape=(1, 2))(in0PRe95806)
Con430 = keras.layers.Conv1D(2, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con430', )(PRe95806)
Mas68371 = keras.layers.Masking(mask_value=1, name = 'Mas68371', )(Con430)
model = tf.keras.models.Model(inputs=[in0PRe95806], outputs=Mas68371)
w = model.get_layer('PRe95806').get_weights() 
w[0] = np.array([[0.6575, 0.7097]])
model.get_layer('PRe95806').set_weights(w) 
w = model.get_layer('Con430').get_weights() 
w[0] = np.array([[[0.681, 0.0864], [0.6709, 0.0337]]])
w[1] = np.array([0, 0])
model.get_layer('Con430').set_weights(w) 
in0PRe95806 = tf.constant([[[0.7103, 0.5435]]])
print (np.array2string(model.predict([in0PRe95806],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas68371.png')

LPRe95806 = prelu_layer([[[0.7103, 0.5435]]], [[0.6575, 0.7097]], PRe95806), 
LCon430 = conv1D_layer(PRe95806, 1,[[[0.681, 0.0864], [0.6709, 0.0337]]],[0, 0], 1, true, 1, Con430), 
LMas68371 = masking_layer(Con430, 1, Mas68371), 
exec_layers([LPRe95806,LCon430,LMas68371],["PRe95806","Con430","Mas68371"],Mas68371,"Mas68371")

Actual (Unparsed): [[[0.8483485, 0.0796859]]]

Expected (Unparsed): [[[0.84834845,0.07968587]]]

Actual:   [[[0.8484, 0.0797]]]

Expected: [[[0.8484, 0.0797]]]