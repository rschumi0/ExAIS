import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max44723 = tf.keras.layers.Input(shape=([1, 2]))
in1Max44723 = tf.keras.layers.Input(shape=([1, 2]))
in0Con74176 = tf.keras.layers.Input(shape=([2, 3, 1, 1]))
in0Min55691 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Min55691 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Max44723 = keras.layers.Maximum(name = 'Max44723', )([in0Max44723,in1Max44723])
Res64392 = keras.layers.Reshape((1, 2, 1), name = 'Res64392', )(Max44723)
Res30427 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res30427', )(Res64392)
Zer38961 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer38961', )(Res30427)
Con74176 = keras.layers.Concatenate(axis=4, name = 'Con74176', )([Zer38961,in0Con74176])
Min55691 = keras.layers.Minimum(name = 'Min55691', )([in0Min55691,in1Min55691])
Zer60516 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer60516', )(Min55691)
Ave12967 = keras.layers.Average(name = 'Ave12967', )([Con74176,Zer60516])
model = tf.keras.models.Model(inputs=[in0Max44723,in1Max44723,in0Con74176,in0Min55691,in1Min55691], outputs=Ave12967)
in0Max44723 = tf.constant([[[0.8712, 0.6388]]])
in1Max44723 = tf.constant([[[0.5847, 0.4063]]])
in0Con74176 = tf.constant([[[[[0.5161]], [[0.6224]], [[0.1052]]], [[[0.7871]], [[0.1231]], [[0.5011]]]]])
in0Min55691 = tf.constant([[[[[0.5796, 0.5581]]], [[[0.4086, 0.3068]]]]])
in1Min55691 = tf.constant([[[[[0.2471, 0.5449]]], [[[0.1212, 0.134]]]]])
print (np.array2string(model.predict([in0Max44723,in1Max44723,in0Con74176,in0Min55691,in1Min55691],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave12967.png')

LMax44723 = maximum_layer([[[[0.8712, 0.6388]]], [[[0.5847, 0.4063]]]], Max44723), 
LRes64392 = reshape_layer(Max44723, [1, 2, 1], Res64392), 
LRes30427 = reshape_layer(Res64392, [1, 2, 1, 1], Res30427), 
LZer38961 = zero_padding3D_layer(Res30427, 1, 0, 1, 0, 0, 0, Zer38961), 
LCon74176 = concatenate_layer([Zer38961,[[[[[0.5161]], [[0.6224]], [[0.1052]]], [[[0.7871]], [[0.1231]], [[0.5011]]]]]], 4, Con74176), 
LMin55691 = minimum_layer([[[[[[0.5796, 0.5581]]], [[[0.4086, 0.3068]]]]], [[[[[0.2471, 0.5449]]], [[[0.1212, 0.134]]]]]], Min55691), 
LZer60516 = zero_padding3D_layer(Min55691, 0, 0, 2, 0, 0, 0, Zer60516), 
LAve12967 = average_layer([Con74176,Zer60516], Ave12967), 
exec_layers([LMax44723,LRes64392,LRes30427,LZer38961,LCon74176,LMin55691,LZer60516,LAve12967],["Max44723","Res64392","Res30427","Zer38961","Con74176","Min55691","Zer60516","Ave12967"],Ave12967,"Ave12967")

Actual (Unparsed): [[[[[0.0000000, 0.2580500]], [[0.0000000, 0.3112000]], [[0.1235500, 0.3250500]]], [[[0.0000000, 0.3935500]], [[0.4356000, 0.0615500]], [[0.3800000, 0.3175500]]]]]

Expected (Unparsed): [[[[[0,0.25805]],[[0,0.3112]],[[0.12355,0.32505]]],[[[0,0.39355]],[[0.4356,0.06155]],[[0.38,0.31755]]]]]

Actual:   [[[[[0, 0.2581]], [[0, 0.3112]], [[0.1236, 0.3251]]], [[[0, 0.3936]], [[0.4356, 0.0616]], [[0.38, 0.3176]]]]]

Expected: [[[[[0, 0.2581]], [[0, 0.3112]], [[0.1236, 0.3251]]], [[[0, 0.3936]], [[0.4356, 0.0616]], [[0.38, 0.3176]]]]]