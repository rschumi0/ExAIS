import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo46580 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Min1054 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min1054 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con25463 = tf.keras.layers.Input(shape=([1, 1]))
in0Add5702 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Add5702 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Min45692 = tf.keras.layers.Input(shape=([1, 1]))
in1Min45692 = tf.keras.layers.Input(shape=([1, 1]))
in0Glo82863 = tf.keras.layers.Input(shape=([2, 1]))
in0Con82582 = tf.keras.layers.Input(shape=([1]))

Glo46580 = keras.layers.GlobalAveragePooling3D(name = 'Glo46580', )(in0Glo46580)
Res95046 = keras.layers.Reshape((1, 1), name = 'Res95046', )(Glo46580)
Res5397 = keras.layers.Reshape((1, 1, 1), name = 'Res5397', )(Res95046)
Min1054 = keras.layers.Minimum(name = 'Min1054', )([in0Min1054,in1Min1054])
Mul77527 = keras.layers.Multiply(name = 'Mul77527', )([Res5397,Min1054])
Res72125 = keras.layers.Reshape((1, 1), name = 'Res72125', )(Mul77527)
Con25463 = keras.layers.Concatenate(axis=2, name = 'Con25463', )([Res72125,in0Con25463])
Add5702 = keras.layers.Add(name = 'Add5702', )([in0Add5702,in1Add5702])
Res4470 = keras.layers.Reshape((1, 2, 2), name = 'Res4470', )(Add5702)
Res84452 = keras.layers.Reshape((1, 4), name = 'Res84452', )(Res4470)
Sep84616 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep84616', )(Res84452)
Max63092 = keras.layers.Maximum(name = 'Max63092', )([Con25463,Sep84616])
Fla17330 = keras.layers.Flatten(name = 'Fla17330', )(Max63092)
Min45692 = keras.layers.Minimum(name = 'Min45692', )([in0Min45692,in1Min45692])
Fla504 = keras.layers.Flatten(name = 'Fla504', )(Min45692)
Glo82863 = keras.layers.GlobalMaxPool1D(name = 'Glo82863', )(in0Glo82863)
Dot84552 = keras.layers.Dot(axes=(1, 1), name = 'Dot84552', )([Fla504,Glo82863])
Con82582 = keras.layers.Concatenate(axis=1, name = 'Con82582', )([Dot84552,in0Con82582])
Max80964 = keras.layers.Maximum(name = 'Max80964', )([Fla17330,Con82582])
Res10196 = keras.layers.Reshape((2, 1), name = 'Res10196', )(Max80964)
Sim68038 = keras.layers.SimpleRNN(3,name = 'Sim68038', )(Res10196)
model = tf.keras.models.Model(inputs=[in0Glo46580,in0Min1054,in1Min1054,in0Con25463,in0Add5702,in1Add5702,in0Min45692,in1Min45692,in0Glo82863,in0Con82582], outputs=Sim68038)
w = model.get_layer('Sep84616').get_weights() 
w[0] = np.array([[[0.6761], [0.3112], [0.8287], [0.1323]]])
w[1] = np.array([[[0.4592, 0.5621], [0.7278, 0.9465], [0.8305, 0.0931], [0.1118, 0.2539]]])
w[2] = np.array([0, 0])
model.get_layer('Sep84616').set_weights(w) 
w = model.get_layer('Sim68038').get_weights() 
w[0] = np.array([[9, 10, 3]])
w[1] = np.array([[9, 10, 2], [2, 1, 5], [7, 8, 1]])
w[2] = np.array([7, 4, 5])
model.get_layer('Sim68038').set_weights(w) 
in0Glo46580 = tf.constant([[[[[1.5181], [1.3913]]]]])
in0Min1054 = tf.constant([[[[0.7658]]]])
in1Min1054 = tf.constant([[[[0.1035]]]])
in0Con25463 = tf.constant([[[0.2959]]])
in0Add5702 = tf.constant([[[[[0.3618], [0.5591]], [[0.089], [0.188]]]]])
in1Add5702 = tf.constant([[[[[0.1311], [0.3286]], [[0.7801], [0.8906]]]]])
in0Min45692 = tf.constant([[[0.5318]]])
in1Min45692 = tf.constant([[[0.2233]]])
in0Glo82863 = tf.constant([[[1.7072], [1.6008]]])
in0Con82582 = tf.constant([[0.0529]])
print (np.array2string(model.predict([in0Glo46580,in0Min1054,in1Min1054,in0Con25463,in0Add5702,in1Add5702,in0Min45692,in1Min45692,in0Glo82863,in0Con82582],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim68038.png')

LGlo46580 = global_average_pooling3D_layer([[[[[1.5181], [1.3913]]]]], Glo46580), 
LRes95046 = reshape_layer(Glo46580, [1, 1], Res95046), 
LRes5397 = reshape_layer(Res95046, [1, 1, 1], Res5397), 
LMin1054 = minimum_layer([[[[[0.7658]]]], [[[[0.1035]]]]], Min1054), 
LMul77527 = multiply_layer([Res5397,Min1054], Mul77527), 
LRes72125 = reshape_layer(Mul77527, [1, 1], Res72125), 
LCon25463 = concatenate_layer([Res72125,[[[0.2959]]]], 2, Con25463), 
LAdd5702 = add_layer([[[[[[0.3618], [0.5591]], [[0.089], [0.188]]]]], [[[[[0.1311], [0.3286]], [[0.7801], [0.8906]]]]]], Add5702), 
LRes4470 = reshape_layer(Add5702, [1, 2, 2], Res4470), 
LRes84452 = reshape_layer(Res4470, [1, 4], Res84452), 
LSep84616 = separable_conv1D_layer(Res84452, 1,[[[[0.6761], [0.3112], [0.8287], [0.1323]]],[[[0.4592, 0.5621], [0.7278, 0.9465], [0.8305, 0.0931], [0.1118, 0.2539]]]],[0, 0], 1, true, Sep84616), 
LMax63092 = maximum_layer([Con25463,Sep84616], Max63092), 
LFla17330 = flatten_layer(Max63092, Fla17330), 
LMin45692 = minimum_layer([[[[0.5318]]], [[[0.2233]]]], Min45692), 
LFla504 = flatten_layer(Min45692, Fla504), 
LGlo82863 = global_max_pool1D_layer([[[1.7072], [1.6008]]], Glo82863), 
LDot84552 = dot_layer(Fla504,Glo82863, 1, 1, Dot84552), 
LCon82582 = concatenate_layer([Dot84552,[[0.0529]]], 1, Con82582), 
LMax80964 = maximum_layer([Fla17330,Con82582], Max80964), 
LRes10196 = reshape_layer(Max80964, [2, 1], Res10196), 
LSim68038 = simple_rnn_layer(Res10196,[[9, 10, 3]],[[9, 10, 2], [2, 1, 5], [7, 8, 1]],[7, 4, 5], Sim68038), 
exec_layers([LGlo46580,LRes95046,LRes5397,LMin1054,LMul77527,LRes72125,LCon25463,LAdd5702,LRes4470,LRes84452,LSep84616,LMax63092,LFla17330,LMin45692,LFla504,LGlo82863,LDot84552,LCon82582,LMax80964,LRes10196,LSim68038],["Glo46580","Res95046","Res5397","Min1054","Mul77527","Res72125","Con25463","Add5702","Res4470","Res84452","Sep84616","Max63092","Fla17330","Min45692","Fla504","Glo82863","Dot84552","Con82582","Max80964","Res10196","Sim68038"],Sim68038,"Sim68038")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0,0.9999999999996277]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]