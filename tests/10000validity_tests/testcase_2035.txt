import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave25391 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Ave25391 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Ave25391 = keras.layers.Average(name = 'Ave25391', )([in0Ave25391,in1Ave25391])
Res95570 = keras.layers.Reshape((2, 1, 2), name = 'Res95570', )(Ave25391)
Res60781 = keras.layers.Reshape((2, 2), name = 'Res60781', )(Res95570)
Sim94472 = keras.layers.SimpleRNN(2,name = 'Sim94472', )(Res60781)
ELU32525 = keras.layers.ELU(alpha=-5.430561811795023, name = 'ELU32525', )(Sim94472)
Res42354 = keras.layers.Reshape((2, 1), name = 'Res42354', )(ELU32525)
Res91600 = keras.layers.Reshape((2, 1, 1), name = 'Res91600', )(Res42354)
Res47061 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res47061', )(Res91600)
Cro47650 = keras.layers.Cropping3D(cropping=((0, 1), (0, 0), (0, 0)), name = 'Cro47650', )(Res47061)
Fla67488 = keras.layers.Flatten(name = 'Fla67488', )(Cro47650)
model = tf.keras.models.Model(inputs=[in0Ave25391,in1Ave25391], outputs=Fla67488)
w = model.get_layer('Sim94472').get_weights() 
w[0] = np.array([[10, 10], [2, 10]])
w[1] = np.array([[4, 1], [5, 2]])
w[2] = np.array([5, 9])
model.get_layer('Sim94472').set_weights(w) 
in0Ave25391 = tf.constant([[[[[0.3885], [0.1105]]], [[[0.8666], [0.2465]]]]])
in1Ave25391 = tf.constant([[[[[0.1059], [0.6175]]], [[[0.9216], [0.8193]]]]])
print (np.array2string(model.predict([in0Ave25391,in1Ave25391],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla67488.png')

LAve25391 = average_layer([[[[[[0.3885], [0.1105]]], [[[0.8666], [0.2465]]]]], [[[[[0.1059], [0.6175]]], [[[0.9216], [0.8193]]]]]], Ave25391), 
LRes95570 = reshape_layer(Ave25391, [2, 1, 2], Res95570), 
LRes60781 = reshape_layer(Res95570, [2, 2], Res60781), 
LSim94472 = simple_rnn_layer(Res60781,[[10, 10], [2, 10]],[[4, 1], [5, 2]],[5, 9], Sim94472), 
LELU32525 = elu_layer(Sim94472, -5.430561811795023, ELU32525), 
LRes42354 = reshape_layer(ELU32525, [2, 1], Res42354), 
LRes91600 = reshape_layer(Res42354, [2, 1, 1], Res91600), 
LRes47061 = reshape_layer(Res91600, [2, 1, 1, 1], Res47061), 
LCro47650 = cropping3D_layer(Res47061, 0, 1, 0, 0, 0, 0, Cro47650), 
LFla67488 = flatten_layer(Cro47650, Fla67488), 
exec_layers([LAve25391,LRes95570,LRes60781,LSim94472,LELU32525,LRes42354,LRes91600,LRes47061,LCro47650,LFla67488],["Ave25391","Res95570","Res60781","Sim94472","ELU32525","Res42354","Res91600","Res47061","Cro47650","Fla67488"],Fla67488,"Fla67488")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[1.0]]

Actual:   [[1]]

Expected: [[1]]