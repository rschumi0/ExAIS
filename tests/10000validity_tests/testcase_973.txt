import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave7048 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Ave7048 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con17209 = tf.keras.layers.Input(shape=([2, 68]))
in0Mul46863 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul46863 = tf.keras.layers.Input(shape=([1, 1]))
in0Con99711 = tf.keras.layers.Input(shape=([1, 1]))
in0Min40224 = tf.keras.layers.Input(shape=([1, 2]))
in1Min40224 = tf.keras.layers.Input(shape=([1, 2]))

Ave7048 = keras.layers.Average(name = 'Ave7048', )([in0Ave7048,in1Ave7048])
Lea21558 = keras.layers.LeakyReLU(alpha=9.108795493503175, name = 'Lea21558', )(Ave7048)
Res58482 = keras.layers.Reshape((2, 2, 2), name = 'Res58482', )(Lea21558)
Res43894 = keras.layers.Reshape((2, 4), name = 'Res43894', )(Res58482)
Con17209 = keras.layers.Concatenate(axis=2, name = 'Con17209', )([Res43894,in0Con17209])
Mul46863 = keras.layers.Multiply(name = 'Mul46863', )([in0Mul46863,in1Mul46863])
Con99711 = keras.layers.Concatenate(axis=2, name = 'Con99711', )([Mul46863,in0Con99711])
Min40224 = keras.layers.Minimum(name = 'Min40224', )([in0Min40224,in1Min40224])
Max55140 = keras.layers.Maximum(name = 'Max55140', )([Con99711,Min40224])
Res14979 = keras.layers.Reshape((1, 2, 1), name = 'Res14979', )(Max55140)
Res99127 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res99127', )(Res14979)
Con18228 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 12, 1), padding='same', name = 'Con18228', )(Res99127)
Res10773 = keras.layers.Reshape((1, 24, 3), name = 'Res10773', )(Con18228)
Res96703 = keras.layers.Reshape((1, 72), name = 'Res96703', )(Res10773)
Zer47071 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer47071', )(Res96703)
Dot62993 = keras.layers.Dot(axes=(2, 2), name = 'Dot62993', )([Con17209,Zer47071])
model = tf.keras.models.Model(inputs=[in0Ave7048,in1Ave7048,in0Con17209,in0Mul46863,in1Mul46863,in0Con99711,in0Min40224,in1Min40224], outputs=Dot62993)
w = model.get_layer('Con18228').get_weights() 
w[0] = np.array([[[[[0.0699], [0.5084], [0.3698]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con18228').set_weights(w) 
in0Ave7048 = tf.constant([[[[[0.1763], [0.9544]], [[0.1303], [0.8857]]], [[[0.2856], [0.7458]], [[0.3603], [0.6098]]]]])
in1Ave7048 = tf.constant([[[[[0.2156], [0.7443]], [[0.7785], [0.0463]]], [[[0.4611], [0.2018]], [[0.2176], [0.4031]]]]])
in0Con17209 = tf.constant([[[0.0696, 0.8324, 0.6081, 0.3, 0.3537, 0.7397, 0.3822, 0.0291, 0.9919, 0.4272, 0.3593, 0.0511, 0.8635, 0.9748, 0.174, 0.3594, 0.2021, 0.2347, 0.8698, 0.2211, 0.4461, 0.8709, 0.4382, 0.7025, 0.8337, 0.9449, 0.8972, 0.5739, 0.8928, 0.2233, 0.5914, 0.8521, 0.4226, 0.7409, 0.7327, 0.1107, 0.042, 0.794, 0.0707, 0.3487, 0.8887, 0.4633, 0.9789, 0.6453, 0.5918, 0.9687, 0.1741, 0.0477, 0.2129, 0.6433, 0.7507, 0.1406, 0.4541, 0.0818, 0.2, 0.5292, 0.0622, 0.0656, 0.6144, 0.0281, 0.0273, 0.1949, 0.3278, 0.6966, 0.8673, 0.7711, 0.8324, 0.9844], [0.018, 0.3626, 0.9308, 0.1604, 0.1083, 0.6586, 0.7292, 0.8851, 0.6896, 0.6736, 0.2622, 0.2565, 0.8088, 0.0966, 0.2459, 0.9117, 0.6676, 0.5983, 0.7067, 0.7963, 0.496, 0.2053, 0.9988, 0.0311, 0.6794, 0.432, 0.0381, 0.8949, 0.1288, 0.7184, 0.4089, 0.3233, 0.8587, 0.8661, 0.3748, 0.4775, 0.7473, 0.5855, 0.719, 0.877, 0.4924, 0.9738, 0.7746, 0.3089, 0.8497, 0.7249, 0.9638, 0.2284, 0.3398, 0.1448, 0.6601, 0.6464, 0.7481, 0.5866, 0.2111, 0.5644, 0.9019, 0.7549, 0.5161, 0.8613, 0.4094, 0.4364, 0.6383, 0.1625, 0.2711, 0.6046, 0.5505, 0.6289]]])
in0Mul46863 = tf.constant([[[0.1623]]])
in1Mul46863 = tf.constant([[[0.0851]]])
in0Con99711 = tf.constant([[[0.1216]]])
in0Min40224 = tf.constant([[[0.2803, 0.3832]]])
in1Min40224 = tf.constant([[[0.015, 0.6872]]])
print (np.array2string(model.predict([in0Ave7048,in1Ave7048,in0Con17209,in0Mul46863,in1Mul46863,in0Con99711,in0Min40224,in1Min40224],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot62993.png')

LAve7048 = average_layer([[[[[[0.1763], [0.9544]], [[0.1303], [0.8857]]], [[[0.2856], [0.7458]], [[0.3603], [0.6098]]]]], [[[[[0.2156], [0.7443]], [[0.7785], [0.0463]]], [[[0.4611], [0.2018]], [[0.2176], [0.4031]]]]]], Ave7048), 
LLea21558 = leaky_relu_layer(Ave7048, 9.108795493503175, Lea21558), 
LRes58482 = reshape_layer(Lea21558, [2, 2, 2], Res58482), 
LRes43894 = reshape_layer(Res58482, [2, 4], Res43894), 
LCon17209 = concatenate_layer([Res43894,[[[0.0696, 0.8324, 0.6081, 0.3, 0.3537, 0.7397, 0.3822, 0.0291, 0.9919, 0.4272, 0.3593, 0.0511, 0.8635, 0.9748, 0.174, 0.3594, 0.2021, 0.2347, 0.8698, 0.2211, 0.4461, 0.8709, 0.4382, 0.7025, 0.8337, 0.9449, 0.8972, 0.5739, 0.8928, 0.2233, 0.5914, 0.8521, 0.4226, 0.7409, 0.7327, 0.1107, 0.042, 0.794, 0.0707, 0.3487, 0.8887, 0.4633, 0.9789, 0.6453, 0.5918, 0.9687, 0.1741, 0.0477, 0.2129, 0.6433, 0.7507, 0.1406, 0.4541, 0.0818, 0.2, 0.5292, 0.0622, 0.0656, 0.6144, 0.0281, 0.0273, 0.1949, 0.3278, 0.6966, 0.8673, 0.7711, 0.8324, 0.9844], [0.018, 0.3626, 0.9308, 0.1604, 0.1083, 0.6586, 0.7292, 0.8851, 0.6896, 0.6736, 0.2622, 0.2565, 0.8088, 0.0966, 0.2459, 0.9117, 0.6676, 0.5983, 0.7067, 0.7963, 0.496, 0.2053, 0.9988, 0.0311, 0.6794, 0.432, 0.0381, 0.8949, 0.1288, 0.7184, 0.4089, 0.3233, 0.8587, 0.8661, 0.3748, 0.4775, 0.7473, 0.5855, 0.719, 0.877, 0.4924, 0.9738, 0.7746, 0.3089, 0.8497, 0.7249, 0.9638, 0.2284, 0.3398, 0.1448, 0.6601, 0.6464, 0.7481, 0.5866, 0.2111, 0.5644, 0.9019, 0.7549, 0.5161, 0.8613, 0.4094, 0.4364, 0.6383, 0.1625, 0.2711, 0.6046, 0.5505, 0.6289]]]], 2, Con17209), 
LMul46863 = multiply_layer([[[[0.1623]]], [[[0.0851]]]], Mul46863), 
LCon99711 = concatenate_layer([Mul46863,[[[0.1216]]]], 2, Con99711), 
LMin40224 = minimum_layer([[[[0.2803, 0.3832]]], [[[0.015, 0.6872]]]], Min40224), 
LMax55140 = maximum_layer([Con99711,Min40224], Max55140), 
LRes14979 = reshape_layer(Max55140, [1, 2, 1], Res14979), 
LRes99127 = reshape_layer(Res14979, [1, 2, 1, 1], Res99127), 
LCon18228 = conv3D_transpose_layer(Res99127, 1, 1, 1,[[[[[0.0699], [0.5084], [0.3698]]]]],[0, 0, 0], 1, 12, 1, true, Con18228), 
LRes10773 = reshape_layer(Con18228, [1, 24, 3], Res10773), 
LRes96703 = reshape_layer(Res10773, [1, 72], Res96703), 
LZer47071 = zero_padding1D_layer(Res96703, 1, 0, Zer47071), 
LDot62993 = dot_layer(Con17209,Zer47071, 2, 2, Dot62993), 
exec_layers([LAve7048,LLea21558,LRes58482,LRes43894,LCon17209,LMul46863,LCon99711,LMin40224,LMax55140,LRes14979,LRes99127,LCon18228,LRes10773,LRes96703,LZer47071,LDot62993],["Ave7048","Lea21558","Res58482","Res43894","Con17209","Mul46863","Con99711","Min40224","Max55140","Res14979","Res99127","Con18228","Res10773","Res96703","Zer47071","Dot62993"],Dot62993,"Dot62993")

Actual (Unparsed): [[[0.0000000, 0.2686931], [0.0000000, 0.2504529]]]

Expected (Unparsed): [[[0.0,0.268693072707],[0.0,0.250452875837]]]

Actual:   [[[0, 0.2687], [0, 0.2505]]]

Expected: [[[0, 0.2687], [0, 0.2505]]]