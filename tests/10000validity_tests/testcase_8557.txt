import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla66205 = tf.keras.layers.Input(shape=([2, 4, 1]))

Fla66205 = keras.layers.Flatten(name = 'Fla66205', )(in0Fla66205)
Bat43223 = keras.layers.BatchNormalization(axis=1, epsilon=0.15057511952204006,  name = 'Bat43223', )(Fla66205)
Res44315 = keras.layers.Reshape((8, 1), name = 'Res44315', )(Bat43223)
GRU97225 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU97225', )(Res44315)
model = tf.keras.models.Model(inputs=[in0Fla66205], outputs=GRU97225)
w = model.get_layer('Bat43223').get_weights() 
w[0] = np.array([0.7414, 0.9157, 0.8748, 0.1729, 0.6227, 0.7937, 0.1557, 0.7186])
w[1] = np.array([0.1865, 0.5168, 0.3245, 0.384, 0.6829, 0.1025, 0.5987, 0.9018])
w[2] = np.array([0.5302, 0.7379, 0.2909, 0.7327, 0.1615, 0.5888, 0.4302, 0.0075])
w[3] = np.array([0.0825, 0.0994, 0.7072, 0.6832, 0.8898, 0.2401, 0.0906, 0.222])
model.get_layer('Bat43223').set_weights(w) 
w = model.get_layer('GRU97225').get_weights() 
w[0] = np.array([[8, 2, 7]])
w[1] = np.array([[2, 3, 7]])
w[2] = np.array([[7, 2, 7], [7, 3, 5]])
model.get_layer('GRU97225').set_weights(w) 
in0Fla66205 = tf.constant([[[[1.65], [1.2768], [1.5821], [1.5058]], [[1.8664], [1.5268], [1.7957], [1.6593]]]])
print (np.array2string(model.predict([in0Fla66205],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU97225.png')

LFla66205 = flatten_layer([[[[1.65], [1.2768], [1.5821], [1.5058]], [[1.8664], [1.5268], [1.7957], [1.6593]]]], Fla66205), 
LBat43223 = batch_normalization_layer(Fla66205, 1, 0.15057511952204006, [0.7414, 0.9157, 0.8748, 0.1729, 0.6227, 0.7937, 0.1557, 0.7186], [0.1865, 0.5168, 0.3245, 0.384, 0.6829, 0.1025, 0.5987, 0.9018], [0.5302, 0.7379, 0.2909, 0.7327, 0.1615, 0.5888, 0.4302, 0.0075], [0.0825, 0.0994, 0.7072, 0.6832, 0.8898, 0.2401, 0.0906, 0.222], Bat43223), 
LRes44315 = reshape_layer(Bat43223, [8, 1], Res44315), 
LGRU97225 = gru_layer(Res44315,[[8, 2, 7]],[[2, 3, 7]],[[7, 2, 7], [7, 3, 5]], true, GRU97225), 
exec_layers([LFla66205,LBat43223,LRes44315,LGRU97225],["Fla66205","Bat43223","Res44315","GRU97225"],GRU97225,"GRU97225")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[1.2195995876843023e-8]]

Actual:   [[0]]

Expected: [[0]]