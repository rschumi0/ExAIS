import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave24720 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Ave24720 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Dot20113 = tf.keras.layers.Input(shape=([2]))
in1Dot20113 = tf.keras.layers.Input(shape=([2]))
in0Con3890 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Max47638 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max47638 = tf.keras.layers.Input(shape=([2, 1, 2]))

Ave24720 = keras.layers.Average(name = 'Ave24720', )([in0Ave24720,in1Ave24720])
Zer89595 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer89595', )(Ave24720)
Dot20113 = keras.layers.Dot(axes=(1, 1), name = 'Dot20113', )([in0Dot20113,in1Dot20113])
Res79986 = keras.layers.Reshape((1, 1), name = 'Res79986', )(Dot20113)
Res41499 = keras.layers.Reshape((1, 1, 1), name = 'Res41499', )(Res79986)
Zer78448 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer78448', )(Res41499)
Con3890 = keras.layers.Concatenate(axis=3, name = 'Con3890', )([Zer78448,in0Con3890])
Max47638 = keras.layers.Maximum(name = 'Max47638', )([in0Max47638,in1Max47638])
Max51342 = keras.layers.Maximum(name = 'Max51342', )([Con3890,Max47638])
Res16730 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res16730', )(Max51342)
Con14510 = keras.layers.Conv3D(2, (2, 1, 2),strides=(1, 6, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con14510', )(Res16730)
Add75082 = keras.layers.Add(name = 'Add75082', )([Zer89595,Con14510])
model = tf.keras.models.Model(inputs=[in0Ave24720,in1Ave24720,in0Dot20113,in1Dot20113,in0Con3890,in0Max47638,in1Max47638], outputs=Add75082)
w = model.get_layer('Con14510').get_weights() 
w[0] = np.array([[[[[0.3743, 0.3952]], [[0.7015, 0.736]]]], [[[[0.4817, 0.3544]], [[0.3669, 0.3576]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con14510').set_weights(w) 
in0Ave24720 = tf.constant([[[[[0.4621, 0.7965], [0.5638, 1]]]]])
in1Ave24720 = tf.constant([[[[[0.9474, 0.6131], [0.7852, 0.3967]]]]])
in0Dot20113 = tf.constant([[0.8911, 0.1932]])
in1Dot20113 = tf.constant([[0.6077, 0.3511]])
in0Con3890 = tf.constant([[[[0.4291]], [[0.0803]]]])
in0Max47638 = tf.constant([[[[0.2719, 0.1326]], [[0.6293, 0.6222]]]])
in1Max47638 = tf.constant([[[[0.0501, 0.2226]], [[0.1655, 0.1473]]]])
print (np.array2string(model.predict([in0Ave24720,in1Ave24720,in0Dot20113,in1Dot20113,in0Con3890,in0Max47638,in1Max47638],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add75082.png')

LAve24720 = average_layer([[[[[[0.4621, 0.7965], [0.5638, 1]]]]], [[[[[0.9474, 0.6131], [0.7852, 0.3967]]]]]], Ave24720), 
LZer89595 = zero_padding3D_layer(Ave24720, 1, 0, 0, 0, 0, 0, Zer89595), 
LDot20113 = dot_layer([[0.8911, 0.1932]], [[0.6077, 0.3511]], 1, 1, Dot20113), 
LRes79986 = reshape_layer(Dot20113, [1, 1], Res79986), 
LRes41499 = reshape_layer(Res79986, [1, 1, 1], Res41499), 
LZer78448 = zero_padding2D_layer(Res41499, 1, 0, 0, 0, Zer78448), 
LCon3890 = concatenate_layer([Zer78448,[[[[0.4291]], [[0.0803]]]]], 3, Con3890), 
LMax47638 = maximum_layer([[[[[0.2719, 0.1326]], [[0.6293, 0.6222]]]], [[[[0.0501, 0.2226]], [[0.1655, 0.1473]]]]], Max47638), 
LMax51342 = maximum_layer([Con3890,Max47638], Max51342), 
LRes16730 = reshape_layer(Max51342, [2, 1, 2, 1], Res16730), 
LCon14510 = conv3D_layer(Res16730, 2, 1, 2,[[[[[0.3743, 0.3952]], [[0.7015, 0.736]]]], [[[[0.4817, 0.3544]], [[0.3669, 0.3576]]]]],[0, 0], 1, 6, 1, true, 1, 1, 1, Con14510), 
LAdd75082 = add_layer([Zer89595,Con14510], Add75082), 
exec_layers([LAve24720,LZer89595,LDot20113,LRes79986,LRes41499,LZer78448,LCon3890,LMax47638,LMax51342,LRes16730,LCon14510,LAdd75082],["Ave24720","Zer89595","Dot20113","Res79986","Res41499","Zer78448","Con3890","Max47638","Max51342","Res16730","Con14510","Add75082"],Add75082,"Add75082")

Actual (Unparsed): [[[[[0.9342048, 0.8687951], [0.4603259, 0.3900880]]], [[[1.3767703, 1.4114386], [0.9073895, 0.9442434]]]]]

Expected (Unparsed): [[[[[0.9342048099999999,0.8687951199999999],[0.46032587,0.390088]]],[[[1.37677029,1.4114385600000001],[0.90738946,0.94424344]]]]]

Actual:   [[[[[0.9343, 0.8688], [0.4604, 0.3901]]], [[[1.3768, 1.4115], [0.9074, 0.9443]]]]]

Expected: [[[[[0.9343, 0.8688], [0.4604, 0.3901]]], [[[1.3768, 1.4115], [0.9074, 0.9443]]]]]