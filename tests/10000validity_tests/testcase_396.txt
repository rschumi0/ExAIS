import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo42647 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Sub38065 = tf.keras.layers.Input(shape=([3]))
in1Sub38065 = tf.keras.layers.Input(shape=([3]))
in0Con80420 = tf.keras.layers.Input(shape=([2]))

Glo42647 = keras.layers.GlobalMaxPool3D(name = 'Glo42647', )(in0Glo42647)
Res78571 = keras.layers.Reshape((2, 1), name = 'Res78571', )(Glo42647)
Sep38204 = keras.layers.SeparableConv1D(3, (2),strides=(2), padding='valid', name = 'Sep38204', )(Res78571)
Fla32656 = keras.layers.Flatten(name = 'Fla32656', )(Sep38204)
Sub38065 = keras.layers.Subtract(name = 'Sub38065', )([in0Sub38065,in1Sub38065])
Res11267 = keras.layers.Reshape((3, 1), name = 'Res11267', )(Sub38065)
Res60959 = keras.layers.Reshape((3, 1, 1), name = 'Res60959', )(Res11267)
Res73619 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res73619', )(Res60959)
Cro5266 = keras.layers.Cropping3D(cropping=((2, 0), (0, 0), (0, 0)), name = 'Cro5266', )(Res73619)
Lay95491 = keras.layers.LayerNormalization(axis=2, epsilon=1.736251453698819, name = 'Lay95491', )(Cro5266)
Res9070 = keras.layers.Reshape((1, 1, 1), name = 'Res9070', )(Lay95491)
Res2893 = keras.layers.Reshape((1, 1), name = 'Res2893', )(Res9070)
Glo54783 = keras.layers.GlobalMaxPool1D(name = 'Glo54783', )(Res2893)
Con80420 = keras.layers.Concatenate(axis=1, name = 'Con80420', )([Glo54783,in0Con80420])
Ave16929 = keras.layers.Average(name = 'Ave16929', )([Fla32656,Con80420])
model = tf.keras.models.Model(inputs=[in0Glo42647,in0Sub38065,in1Sub38065,in0Con80420], outputs=Ave16929)
w = model.get_layer('Sep38204').get_weights() 
w[0] = np.array([[[0.3295]], [[0.9009]]])
w[1] = np.array([[[0.6179, 0.901, 0.1068]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep38204').set_weights(w) 
in0Glo42647 = tf.constant([[[[[1.4284, 1.7908]], [[1.5632, 1.763]]], [[[1.7905, 1.288]], [[1.9512, 1.7264]]]]])
in0Sub38065 = tf.constant([[0.7551, 0.3989, 0.1217]])
in1Sub38065 = tf.constant([[0.4471, 0.6953, 0.8928]])
in0Con80420 = tf.constant([[0.1074, 0.8938]])
print (np.array2string(model.predict([in0Glo42647,in0Sub38065,in1Sub38065,in0Con80420],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave16929.png')

LGlo42647 = global_max_pool3D_layer([[[[[1.4284, 1.7908]], [[1.5632, 1.763]]], [[[1.7905, 1.288]], [[1.9512, 1.7264]]]]], Glo42647), 
LRes78571 = reshape_layer(Glo42647, [2, 1], Res78571), 
LSep38204 = separable_conv1D_layer(Res78571, 2,[[[[0.3295]], [[0.9009]]],[[[0.6179, 0.901, 0.1068]]]],[0, 0, 0], 2, false, Sep38204), 
LFla32656 = flatten_layer(Sep38204, Fla32656), 
LSub38065 = subtract_layer([[0.7551, 0.3989, 0.1217]], [[0.4471, 0.6953, 0.8928]], Sub38065), 
LRes11267 = reshape_layer(Sub38065, [3, 1], Res11267), 
LRes60959 = reshape_layer(Res11267, [3, 1, 1], Res60959), 
LRes73619 = reshape_layer(Res60959, [3, 1, 1, 1], Res73619), 
LCro5266 = cropping3D_layer(Res73619, 2, 0, 0, 0, 0, 0, Cro5266), 
LLay95491 = layer_normalization_layer(Cro5266, 2, 1.736251453698819, Lay95491), 
LRes9070 = reshape_layer(Lay95491, [1, 1, 1], Res9070), 
LRes2893 = reshape_layer(Res9070, [1, 1], Res2893), 
LGlo54783 = global_max_pool1D_layer(Res2893, Glo54783), 
LCon80420 = concatenate_layer([Glo54783,[[0.1074, 0.8938]]], 1, Con80420), 
LAve16929 = average_layer([Fla32656,Con80420], Ave16929), 
exec_layers([LGlo42647,LRes78571,LSep38204,LFla32656,LSub38065,LRes11267,LRes60959,LRes73619,LCro5266,LLay95491,LRes9070,LRes2893,LGlo54783,LCon80420,LAve16929],["Glo42647","Res78571","Sep38204","Fla32656","Sub38065","Res11267","Res60959","Res73619","Cro5266","Lay95491","Res9070","Res2893","Glo54783","Con80420","Ave16929"],Ave16929,"Ave16929")

Actual (Unparsed): [[0.6970691, 1.0701416, 0.5673839]]

Expected (Unparsed): [[0.697069092474,1.07014158006,0.567383863208]]

Actual:   [[0.6971, 1.0702, 0.5674]]

Expected: [[0.6971, 1.0702, 0.5674]]