import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub45021 = tf.keras.layers.Input(shape=([3]))
in1Sub45021 = tf.keras.layers.Input(shape=([3]))
in0Max67842 = tf.keras.layers.Input(shape=([1, 1]))
in1Max67842 = tf.keras.layers.Input(shape=([1, 1]))

Sub45021 = keras.layers.Subtract(name = 'Sub45021', )([in0Sub45021,in1Sub45021])
Res66284 = keras.layers.Reshape((3, 1), name = 'Res66284', )(Sub45021)
Max67842 = keras.layers.Maximum(name = 'Max67842', )([in0Max67842,in1Max67842])
Res15869 = keras.layers.Reshape((1, 1, 1), name = 'Res15869', )(Max67842)
Res68136 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res68136', )(Res15869)
Con35749 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 8, 8), padding='same', dilation_rate=(1, 1, 1), name = 'Con35749', )(Res68136)
Bat50469 = keras.layers.BatchNormalization(axis=2, epsilon=0.7696935891549654,  name = 'Bat50469', )(Con35749)
Res65653 = keras.layers.Reshape((3, 1), name = 'Res65653', )(Bat50469)
Max62425 = keras.layers.Maximum(name = 'Max62425', )([Res66284,Res65653])
model = tf.keras.models.Model(inputs=[in0Sub45021,in1Sub45021,in0Max67842,in1Max67842], outputs=Max62425)
w = model.get_layer('Con35749').get_weights() 
w[0] = np.array([[[[[0.7935, 0.4819, 0.2102]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con35749').set_weights(w) 
w = model.get_layer('Bat50469').get_weights() 
w[0] = np.array([0.6413])
w[1] = np.array([0.4316])
w[2] = np.array([0.492])
w[3] = np.array([0.9497])
model.get_layer('Bat50469').set_weights(w) 
in0Sub45021 = tf.constant([[0.7204, 0.5346, 0.5089]])
in1Sub45021 = tf.constant([[0.8992, 0.5654, 0.5993]])
in0Max67842 = tf.constant([[[0.2913]]])
in1Max67842 = tf.constant([[[0.2749]]])
print (np.array2string(model.predict([in0Sub45021,in1Sub45021,in0Max67842,in1Max67842],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max62425.png')

LSub45021 = subtract_layer([[0.7204, 0.5346, 0.5089]], [[0.8992, 0.5654, 0.5993]], Sub45021), 
LRes66284 = reshape_layer(Sub45021, [3, 1], Res66284), 
LMax67842 = maximum_layer([[[[0.2913]]], [[[0.2749]]]], Max67842), 
LRes15869 = reshape_layer(Max67842, [1, 1, 1], Res15869), 
LRes68136 = reshape_layer(Res15869, [1, 1, 1, 1], Res68136), 
LCon35749 = conv3D_layer(Res68136, 1, 1, 1,[[[[[0.7935, 0.4819, 0.2102]]]]],[0, 0, 0], 1, 8, 8, true, 1, 1, 1, Con35749), 
LBat50469 = batch_normalization_layer(Con35749, 2, 0.7696935891549654, [0.6413], [0.4316], [0.492], [0.9497], Bat50469), 
LRes65653 = reshape_layer(Bat50469, [3, 1], Res65653), 
LMax62425 = maximum_layer([Res66284,Res65653], Max62425), 
exec_layers([LSub45021,LRes66284,LMax67842,LRes15869,LRes68136,LCon35749,LBat50469,LRes65653,LMax62425],["Sub45021","Res66284","Max67842","Res15869","Res68136","Con35749","Bat50469","Res65653","Max62425"],Max62425,"Max62425")

Actual (Unparsed): [[[0.3040236], [0.2596310], [0.2209227]]]

Expected (Unparsed): [[[0.3040236498043768],[0.2596309536870184],[0.22092268817005348]]]

Actual:   [[[0.3041], [0.2597], [0.221]]]

Expected: [[[0.3041], [0.2597], [0.221]]]