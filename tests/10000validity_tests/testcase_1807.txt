import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro92601 = tf.keras.layers.Input(shape=([1, 2]))

Cro92601 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro92601', )(in0Cro92601)
Res66364 = keras.layers.Reshape((1, 2, 1), name = 'Res66364', )(Cro92601)
Sep12180 = keras.layers.SeparableConv2D(2, (1, 2),strides=(1, 1), padding='same', name = 'Sep12180', )(Res66364)
Res45545 = keras.layers.Reshape((1, 4), name = 'Res45545', )(Sep12180)
Zer53659 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer53659', )(Res45545)
Sim91545 = keras.layers.SimpleRNN(3,name = 'Sim91545', )(Zer53659)
model = tf.keras.models.Model(inputs=[in0Cro92601], outputs=Sim91545)
w = model.get_layer('Sep12180').get_weights() 
w[0] = np.array([[[[0.8664]], [[0.4701]]]])
w[1] = np.array([[[[0.2134, 0.581]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep12180').set_weights(w) 
w = model.get_layer('Sim91545').get_weights() 
w[0] = np.array([[6, 4, 8], [2, 4, 5], [6, 9, 1], [9, 3, 10]])
w[1] = np.array([[8, 3, 7], [4, 7, 2], [10, 10, 1]])
w[2] = np.array([4, 5, 1])
model.get_layer('Sim91545').set_weights(w) 
in0Cro92601 = tf.constant([[[1.646, 1.7815]]])
print (np.array2string(model.predict([in0Cro92601],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim91545.png')

LCro92601 = cropping1D_layer([[[1.646, 1.7815]]], 0, 0, Cro92601), 
LRes66364 = reshape_layer(Cro92601, [1, 2, 1], Res66364), 
LSep12180 = separable_conv2D_layer(Res66364, 1, 2,[[[[[0.8664]], [[0.4701]]]],[[[[0.2134, 0.581]]]]],[0, 0], 1, 1, true, Sep12180), 
LRes45545 = reshape_layer(Sep12180, [1, 4], Res45545), 
LZer53659 = zero_padding1D_layer(Res45545, 1, 1, Zer53659), 
LSim91545 = simple_rnn_layer(Zer53659,[[6, 4, 8], [2, 4, 5], [6, 9, 1], [9, 3, 10]],[[8, 3, 7], [4, 7, 2], [10, 10, 1]],[4, 5, 1], Sim91545), 
exec_layers([LCro92601,LRes66364,LSep12180,LRes45545,LZer53659,LSim91545],["Cro92601","Res66364","Sep12180","Res45545","Zer53659","Sim91545"],Sim91545,"Sim91545")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0,0.9999999994421064]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]