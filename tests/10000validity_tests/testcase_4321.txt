import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave53847 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave53847 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Mul15250 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul15250 = tf.keras.layers.Input(shape=([1, 2, 1]))

Ave53847 = keras.layers.Average(name = 'Ave53847', )([in0Ave53847,in1Ave53847])
Zer35674 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer35674', )(Ave53847)
Mul15250 = keras.layers.Multiply(name = 'Mul15250', )([in0Mul15250,in1Mul15250])
Mul59440 = keras.layers.Multiply(name = 'Mul59440', )([Zer35674,Mul15250])
Max59746 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(1, 1), padding='same', name = 'Max59746', )(Mul59440)
Res25802 = keras.layers.Reshape((1, 2), name = 'Res25802', )(Max59746)
Sep93092 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='same', name = 'Sep93092', )(Res25802)
model = tf.keras.models.Model(inputs=[in0Ave53847,in1Ave53847,in0Mul15250,in1Mul15250], outputs=Sep93092)
w = model.get_layer('Sep93092').get_weights() 
w[0] = np.array([[[0.4315], [0.5828]]])
w[1] = np.array([[[0.9221, 0.95, 0.1447], [0.6024, 0.6807, 0.2252]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep93092').set_weights(w) 
in0Ave53847 = tf.constant([[[[0.8391]]]])
in1Ave53847 = tf.constant([[[[0.3342]]]])
in0Mul15250 = tf.constant([[[[0.2948], [0.8852]]]])
in1Mul15250 = tf.constant([[[[0.4039], [0.3336]]]])
print (np.array2string(model.predict([in0Ave53847,in1Ave53847,in0Mul15250,in1Mul15250],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep93092.png')

LAve53847 = average_layer([[[[[0.8391]]]], [[[[0.3342]]]]], Ave53847), 
LZer35674 = zero_padding2D_layer(Ave53847, 0, 0, 1, 0, Zer35674), 
LMul15250 = multiply_layer([[[[[0.2948], [0.8852]]]], [[[[0.4039], [0.3336]]]]], Mul15250), 
LMul59440 = multiply_layer([Zer35674,Mul15250], Mul59440), 
LMax59746 = max_pool2D_layer(Mul59440, 2, 1, 1, 1, true, Max59746), 
LRes25802 = reshape_layer(Max59746, [1, 2], Res25802), 
LSep93092 = separable_conv1D_layer(Res25802, 1,[[[[0.4315], [0.5828]]],[[[0.9221, 0.95, 0.1447], [0.6024, 0.6807, 0.2252]]]],[0, 0, 0], 1, true, Sep93092), 
exec_layers([LAve53847,LZer35674,LMul15250,LMul59440,LMax59746,LRes25802,LSep93092],["Ave53847","Zer35674","Mul15250","Mul59440","Max59746","Res25802","Sep93092"],Sep93092,"Sep93092")

Actual (Unparsed): [[[0.0608207, 0.0687261, 0.0227371]]]

Expected (Unparsed): [[[0.06082064598238696,0.06872611839344422,0.022737067521968034]]]

Actual:   [[[0.0609, 0.0688, 0.0228]]]

Expected: [[[0.0609, 0.0688, 0.0228]]]