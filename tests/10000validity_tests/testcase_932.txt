import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max49764 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max49764 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Add36314 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Add36314 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con22525 = tf.keras.layers.Input(shape=([1, 3]))
in0Con70720 = tf.keras.layers.Input(shape=([2, 6, 3, 1]))
in0Sub32877 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in1Sub32877 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in0Con56692 = tf.keras.layers.Input(shape=([2]))
in0Loc98160 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot65932 = tf.keras.layers.Input(shape=([3]))
in1Dot65932 = tf.keras.layers.Input(shape=([3]))
in0Con89388 = tf.keras.layers.Input(shape=([3]))

Max49764 = keras.layers.Maximum(name = 'Max49764', )([in0Max49764,in1Max49764])
Res34629 = keras.layers.Reshape((1, 4), name = 'Res34629', )(Max49764)
Add36314 = keras.layers.Add(name = 'Add36314', )([in0Add36314,in1Add36314])
Res75709 = keras.layers.Reshape((1, 1, 1), name = 'Res75709', )(Add36314)
Res54292 = keras.layers.Reshape((1, 1), name = 'Res54292', )(Res75709)
Cro20641 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro20641', )(Res54292)
Con22525 = keras.layers.Concatenate(axis=2, name = 'Con22525', )([Cro20641,in0Con22525])
Sub14979 = keras.layers.Subtract(name = 'Sub14979', )([Res34629,Con22525])
Res13682 = keras.layers.Reshape((1, 4, 1), name = 'Res13682', )(Sub14979)
Res56643 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res56643', )(Res13682)
Zer50041 = keras.layers.ZeroPadding3D(padding=((1, 0), (2, 0), (2, 0)), name = 'Zer50041', )(Res56643)
Con70720 = keras.layers.Concatenate(axis=4, name = 'Con70720', )([Zer50041,in0Con70720])
Sub32877 = keras.layers.Subtract(name = 'Sub32877', )([in0Sub32877,in1Sub32877])
Zer74508 = keras.layers.ZeroPadding3D(padding=((0, 0), (4, 0), (0, 0)), name = 'Zer74508', )(Sub32877)
Mul7336 = keras.layers.Multiply(name = 'Mul7336', )([Con70720,Zer74508])
Glo28722 = keras.layers.GlobalMaxPool3D(name = 'Glo28722', )(Mul7336)
Con56692 = keras.layers.Concatenate(axis=1, name = 'Con56692', )([Glo28722,in0Con56692])
Loc98160 = keras.layers.LocallyConnected1D(4, (2),strides=(2), name = 'Loc98160', )(in0Loc98160)
Fla78001 = keras.layers.Flatten(name = 'Fla78001', )(Loc98160)
Dot65932 = keras.layers.Dot(axes=(1, 1), name = 'Dot65932', )([in0Dot65932,in1Dot65932])
Res20287 = keras.layers.Reshape((1, 1), name = 'Res20287', )(Dot65932)
Res11377 = keras.layers.Reshape((1, 1, 1), name = 'Res11377', )(Res20287)
Res34862 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res34862', )(Res11377)
Glo51946 = keras.layers.GlobalMaxPool3D(name = 'Glo51946', )(Res34862)
Con89388 = keras.layers.Concatenate(axis=1, name = 'Con89388', )([Glo51946,in0Con89388])
Add64580 = keras.layers.Add(name = 'Add64580', )([Fla78001,Con89388])
Sub20466 = keras.layers.Subtract(name = 'Sub20466', )([Con56692,Add64580])
model = tf.keras.models.Model(inputs=[in0Max49764,in1Max49764,in0Add36314,in1Add36314,in0Con22525,in0Con70720,in0Sub32877,in1Sub32877,in0Con56692,in0Loc98160,in0Dot65932,in1Dot65932,in0Con89388], outputs=Sub20466)
w = model.get_layer('Loc98160').get_weights() 
w[0] = np.array([[[0.149, 0.7189, 0.8155, 0.0475], [0.3788, 0.6007, 0.9601, 0.8391]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc98160').set_weights(w) 
in0Max49764 = tf.constant([[[[0.1594, 0.3267], [0.448, 0.6655]]]])
in1Max49764 = tf.constant([[[[0.2226, 0.352], [0.9391, 0.6102]]]])
in0Add36314 = tf.constant([[[[[0.8087]]]]])
in1Add36314 = tf.constant([[[[[0.4052]]]]])
in0Con22525 = tf.constant([[[0.4024, 0.5563, 0.5976]]])
in0Con70720 = tf.constant([[[[[0.387], [0.0744], [0.3682]], [[0.2874], [0.4491], [0.5008]], [[0.6481], [0.9747], [0.4715]], [[0.0989], [0.9624], [0.7774]], [[0.4407], [0.2825], [0.0257]], [[0.0561], [0.4993], [0.3099]]], [[[0.3323], [0.6306], [0.5162]], [[0.7103], [0.9373], [0.4633]], [[0.3152], [0.1394], [0.5788]], [[0.1738], [0.0429], [0.822]], [[0.9047], [0.5789], [0.6384]], [[0.7882], [0.5047], [0.0835]]]]])
in0Sub32877 = tf.constant([[[[[0.467, 0.7057], [0.001, 0.8531], [0.3883, 0.1275]], [[0.7076, 0.8892], [0.3522, 0.5497], [0.2881, 0.6514]]], [[[0.2245, 0.9195], [0.4343, 0.7464], [0.1032, 0.0017]], [[0.1882, 0.6929], [0.2149, 0.0468], [0.5773, 0.3324]]]]])
in1Sub32877 = tf.constant([[[[[0.2721, 0.8021], [0.5911, 0.6972], [0.8245, 0.3552]], [[0.1262, 0.1759], [0.2421, 0.9738], [0.0897, 0.0696]]], [[[0.2313, 0.1943], [0.0618, 0.7951], [0.2035, 0.8933]], [[0.7952, 0.0572], [0.3924, 0.9793], [0.3541, 0.2856]]]]])
in0Con56692 = tf.constant([[0.995, 0.9498]])
in0Loc98160 = tf.constant([[[0.3455], [0.6376]]])
in0Dot65932 = tf.constant([[0.8815, 0.5149, 0.3047]])
in1Dot65932 = tf.constant([[0.773, 0.8239, 0.667]])
in0Con89388 = tf.constant([[0.7326, 0.9849, 0.2771]])
print (np.array2string(model.predict([in0Max49764,in1Max49764,in0Add36314,in1Add36314,in0Con22525,in0Con70720,in0Sub32877,in1Sub32877,in0Con56692,in0Loc98160,in0Dot65932,in1Dot65932,in0Con89388],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub20466.png')

LMax49764 = maximum_layer([[[[[0.1594, 0.3267], [0.448, 0.6655]]]], [[[[0.2226, 0.352], [0.9391, 0.6102]]]]], Max49764), 
LRes34629 = reshape_layer(Max49764, [1, 4], Res34629), 
LAdd36314 = add_layer([[[[[[0.8087]]]]], [[[[[0.4052]]]]]], Add36314), 
LRes75709 = reshape_layer(Add36314, [1, 1, 1], Res75709), 
LRes54292 = reshape_layer(Res75709, [1, 1], Res54292), 
LCro20641 = cropping1D_layer(Res54292, 0, 0, Cro20641), 
LCon22525 = concatenate_layer([Cro20641,[[[0.4024, 0.5563, 0.5976]]]], 2, Con22525), 
LSub14979 = subtract_layer(Res34629,Con22525, Sub14979), 
LRes13682 = reshape_layer(Sub14979, [1, 4, 1], Res13682), 
LRes56643 = reshape_layer(Res13682, [1, 4, 1, 1], Res56643), 
LZer50041 = zero_padding3D_layer(Res56643, 1, 0, 2, 0, 2, 0, Zer50041), 
LCon70720 = concatenate_layer([Zer50041,[[[[[0.387], [0.0744], [0.3682]], [[0.2874], [0.4491], [0.5008]], [[0.6481], [0.9747], [0.4715]], [[0.0989], [0.9624], [0.7774]], [[0.4407], [0.2825], [0.0257]], [[0.0561], [0.4993], [0.3099]]], [[[0.3323], [0.6306], [0.5162]], [[0.7103], [0.9373], [0.4633]], [[0.3152], [0.1394], [0.5788]], [[0.1738], [0.0429], [0.822]], [[0.9047], [0.5789], [0.6384]], [[0.7882], [0.5047], [0.0835]]]]]], 4, Con70720), 
LSub32877 = subtract_layer([[[[[0.467, 0.7057], [0.001, 0.8531], [0.3883, 0.1275]], [[0.7076, 0.8892], [0.3522, 0.5497], [0.2881, 0.6514]]], [[[0.2245, 0.9195], [0.4343, 0.7464], [0.1032, 0.0017]], [[0.1882, 0.6929], [0.2149, 0.0468], [0.5773, 0.3324]]]]], [[[[[0.2721, 0.8021], [0.5911, 0.6972], [0.8245, 0.3552]], [[0.1262, 0.1759], [0.2421, 0.9738], [0.0897, 0.0696]]], [[[0.2313, 0.1943], [0.0618, 0.7951], [0.2035, 0.8933]], [[0.7952, 0.0572], [0.3924, 0.9793], [0.3541, 0.2856]]]]], Sub32877), 
LZer74508 = zero_padding3D_layer(Sub32877, 0, 0, 4, 0, 0, 0, Zer74508), 
LMul7336 = multiply_layer([Con70720,Zer74508], Mul7336), 
LGlo28722 = global_max_pool3D_layer(Mul7336, Glo28722), 
LCon56692 = concatenate_layer([Glo28722,[[0.995, 0.9498]]], 1, Con56692), 
LLoc98160 = locally_connected1D_layer([[[0.3455], [0.6376]]], 2,[[[0.149, 0.7189, 0.8155, 0.0475], [0.3788, 0.6007, 0.9601, 0.8391]]],[[0, 0, 0, 0]], 2, Loc98160), 
LFla78001 = flatten_layer(Loc98160, Fla78001), 
LDot65932 = dot_layer([[0.8815, 0.5149, 0.3047]], [[0.773, 0.8239, 0.667]], 1, 1, Dot65932), 
LRes20287 = reshape_layer(Dot65932, [1, 1], Res20287), 
LRes11377 = reshape_layer(Res20287, [1, 1, 1], Res11377), 
LRes34862 = reshape_layer(Res11377, [1, 1, 1, 1], Res34862), 
LGlo51946 = global_max_pool3D_layer(Res34862, Glo51946), 
LCon89388 = concatenate_layer([Glo51946,[[0.7326, 0.9849, 0.2771]]], 1, Con89388), 
LAdd64580 = add_layer([Fla78001,Con89388], Add64580), 
LSub20466 = subtract_layer(Con56692,Add64580, Sub20466), 
exec_layers([LMax49764,LRes34629,LAdd36314,LRes75709,LRes54292,LCro20641,LCon22525,LSub14979,LRes13682,LRes56643,LZer50041,LCon70720,LSub32877,LZer74508,LMul7336,LGlo28722,LCon56692,LLoc98160,LFla78001,LDot65932,LRes20287,LRes11377,LRes34862,LGlo51946,LCon89388,LAdd64580,LSub20466],["Max49764","Res34629","Add36314","Res75709","Res54292","Cro20641","Con22525","Sub14979","Res13682","Res56643","Zer50041","Con70720","Sub32877","Zer74508","Mul7336","Glo28722","Con56692","Loc98160","Fla78001","Dot65932","Res20287","Res11377","Res34862","Glo51946","Con89388","Add64580","Sub20466"],Sub20466,"Sub20466")

Actual (Unparsed): [[-1.5867076, -0.7078978, -0.8838150, 0.1212786]]

Expected (Unparsed): [[-1.5867076100000002,-0.70789783,-0.8838150099999998,0.12127859000000007]]

Actual:   [[-1.5867, -0.7078, -0.8838, 0.1213]]

Expected: [[-1.5867, -0.7078, -0.8838, 0.1213]]