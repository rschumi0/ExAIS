import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo46882 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Glo46882 = keras.layers.GlobalMaxPool3D(name = 'Glo46882', )(in0Glo46882)
Res98871 = keras.layers.Reshape((1, 1), name = 'Res98871', )(Glo46882)
Res45626 = keras.layers.Reshape((1, 1, 1), name = 'Res45626', )(Res98871)
Sep88897 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep88897', )(Res45626)
Con28904 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con28904', )(Sep88897)
model = tf.keras.models.Model(inputs=[in0Glo46882], outputs=Con28904)
w = model.get_layer('Sep88897').get_weights() 
w[0] = np.array([[[[0.4064]]]])
w[1] = np.array([[[[0.9071, 0.3406]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep88897').set_weights(w) 
w = model.get_layer('Con28904').get_weights() 
w[0] = np.array([[[[0.213, 0.2766, 0.6413, 0.6199], [0.5201, 0.0498, 0.5236, 0.2212]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con28904').set_weights(w) 
in0Glo46882 = tf.constant([[[[[1.8377]]], [[[1.1882]]]]])
print (np.array2string(model.predict([in0Glo46882],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con28904.png')

LGlo46882 = global_max_pool3D_layer([[[[[1.8377]]], [[[1.1882]]]]], Glo46882), 
LRes98871 = reshape_layer(Glo46882, [1, 1], Res98871), 
LRes45626 = reshape_layer(Res98871, [1, 1, 1], Res45626), 
LSep88897 = separable_conv2D_layer(Res45626, 1, 1,[[[[[0.4064]]]],[[[[0.9071, 0.3406]]]]],[0, 0], 1, 1, false, Sep88897), 
LCon28904 = conv2D_layer(Sep88897, 1, 1,[[[[0.213, 0.2766, 0.6413, 0.6199], [0.5201, 0.0498, 0.5236, 0.2212]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con28904), 
exec_layers([LGlo46882,LRes98871,LRes45626,LSep88897,LCon28904],["Glo46882","Res98871","Res45626","Sep88897","Con28904"],Con28904,"Con28904")

Actual (Unparsed): [[[[0.2765989, 0.2000532, 0.5676452, 0.4762248]]]]

Expected (Unparsed): [[[[0.27659891164110084,0.2000531921297472,0.5676452213861792,0.4762248433429728]]]]

Actual:   [[[[0.2766, 0.2001, 0.5677, 0.4763]]]]

Expected: [[[[0.2766, 0.2001, 0.5677, 0.4763]]]]