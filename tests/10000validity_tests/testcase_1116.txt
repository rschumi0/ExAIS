import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min41540 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min41540 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Ave61595 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave61595 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con50488 = tf.keras.layers.Input(shape=([2, 3, 1]))

Min41540 = keras.layers.Minimum(name = 'Min41540', )([in0Min41540,in1Min41540])
ReL4937 = keras.layers.ReLU(max_value=6.983024531969842, negative_slope=3.369174114271758, threshold=4.0885630102936155, name = 'ReL4937', )(Min41540)
Res12842 = keras.layers.Reshape((1, 2, 2), name = 'Res12842', )(ReL4937)
Max3812 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(6, 1), padding='valid', name = 'Max3812', )(Res12842)
Zer87908 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer87908', )(Max3812)
Ave61595 = keras.layers.Average(name = 'Ave61595', )([in0Ave61595,in1Ave61595])
Zer32278 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer32278', )(Ave61595)
Con50488 = keras.layers.Concatenate(axis=3, name = 'Con50488', )([Zer32278,in0Con50488])
Max6464 = keras.layers.Maximum(name = 'Max6464', )([Zer87908,Con50488])
model = tf.keras.models.Model(inputs=[in0Min41540,in1Min41540,in0Ave61595,in1Ave61595,in0Con50488], outputs=Max6464)
in0Min41540 = tf.constant([[[[[0.6481], [0.5666]], [[0.4005], [0.4785]]]]])
in1Min41540 = tf.constant([[[[[0.7627], [0.8618]], [[0.7644], [0.9455]]]]])
in0Ave61595 = tf.constant([[[[0.0427]], [[0.0915]]]])
in1Ave61595 = tf.constant([[[[0.7686]], [[0.6641]]]])
in0Con50488 = tf.constant([[[[0.2996], [0.9637], [0.7417]], [[0.5459], [0.7849], [0.5764]]]])
print (np.array2string(model.predict([in0Min41540,in1Min41540,in0Ave61595,in1Ave61595,in0Con50488],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max6464.png')

LMin41540 = minimum_layer([[[[[[0.6481], [0.5666]], [[0.4005], [0.4785]]]]], [[[[[0.7627], [0.8618]], [[0.7644], [0.9455]]]]]], Min41540), 
LReL4937 = relu_layer(Min41540, 6.983024531969842, 3.369174114271758, 4.0885630102936155, ReL4937), 
LRes12842 = reshape_layer(ReL4937, [1, 2, 2], Res12842), 
LMax3812 = max_pool2D_layer(Res12842, 1, 1, 6, 1, false, Max3812), 
LZer87908 = zero_padding2D_layer(Max3812, 1, 0, 1, 0, Zer87908), 
LAve61595 = average_layer([[[[[0.0427]], [[0.0915]]]], [[[[0.7686]], [[0.6641]]]]], Ave61595), 
LZer32278 = zero_padding2D_layer(Ave61595, 0, 0, 2, 0, Zer32278), 
LCon50488 = concatenate_layer([Zer32278,[[[[0.2996], [0.9637], [0.7417]], [[0.5459], [0.7849], [0.5764]]]]], 3, Con50488), 
LMax6464 = maximum_layer([Zer87908,Con50488], Max6464), 
exec_layers([LMin41540,LReL4937,LRes12842,LMax3812,LZer87908,LAve61595,LZer32278,LCon50488,LMax6464],["Min41540","ReL4937","Res12842","Max3812","Zer87908","Ave61595","Zer32278","Con50488","Max6464"],Max6464,"Max6464")

Actual (Unparsed): [[[[0.0000000, 0.2996000], [0.0000000, 0.9637000], [0.4056500, 0.7417000]], [[0.0000000, 0.5459000], [0.0000000, 0.7849000], [0.3778000, 0.5764000]]]]

Expected (Unparsed): [[[[0,0.2996],[0,0.9637],[0.40564999999999996,0.7417]],[[0,0.5459],[0,0.7849],[0.3778,0.5764]]]]

Actual:   [[[[0, 0.2996], [0, 0.9637], [0.4057, 0.7417]], [[0, 0.5459], [0, 0.7849], [0.3778, 0.5764]]]]

Expected: [[[[0, 0.2996], [0, 0.9637], [0.4057, 0.7417]], [[0, 0.5459], [0, 0.7849], [0.3778, 0.5764]]]]