import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max45815 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Max45815 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Con93108 = tf.keras.layers.Input(shape=([1, 4, 1]))
in0Ave43828 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave43828 = tf.keras.layers.Input(shape=([1, 1, 2]))

Max45815 = keras.layers.Maximum(name = 'Max45815', )([in0Max45815,in1Max45815])
Res19158 = keras.layers.Reshape((1, 1, 4), name = 'Res19158', )(Max45815)
Res70517 = keras.layers.Reshape((1, 4), name = 'Res70517', )(Res19158)
Res94621 = keras.layers.Reshape((1, 4, 1), name = 'Res94621', )(Res70517)
Dep2852 = keras.layers.DepthwiseConv2D((1, 4),strides=(1, 1), padding='same', name = 'Dep2852', )(Res94621)
Con93108 = keras.layers.Concatenate(axis=3, name = 'Con93108', )([Dep2852,in0Con93108])
Ave43828 = keras.layers.Average(name = 'Ave43828', )([in0Ave43828,in1Ave43828])
Zer99092 = keras.layers.ZeroPadding2D(padding=((0, 0), (3, 0)), name = 'Zer99092', )(Ave43828)
Min36000 = keras.layers.Minimum(name = 'Min36000', )([Con93108,Zer99092])
model = tf.keras.models.Model(inputs=[in0Max45815,in1Max45815,in0Con93108,in0Ave43828,in1Ave43828], outputs=Min36000)
w = model.get_layer('Dep2852').get_weights() 
w[0] = np.array([[[[0.7974]], [[0.609]], [[0.4603]], [[0.4724]]]])
w[1] = np.array([0])
model.get_layer('Dep2852').set_weights(w) 
in0Max45815 = tf.constant([[[[[0.2536, 0.5695], [0.2888, 0.1988]]]]])
in1Max45815 = tf.constant([[[[[0.8657, 0.7159], [0.326, 0.4419]]]]])
in0Con93108 = tf.constant([[[[0.823], [0.4605], [0.3134], [0.038]]]])
in0Ave43828 = tf.constant([[[[0.4798, 0.5185]]]])
in1Ave43828 = tf.constant([[[[0.8252, 0.4832]]]])
print (np.array2string(model.predict([in0Max45815,in1Max45815,in0Con93108,in0Ave43828,in1Ave43828],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min36000.png')

LMax45815 = maximum_layer([[[[[[0.2536, 0.5695], [0.2888, 0.1988]]]]], [[[[[0.8657, 0.7159], [0.326, 0.4419]]]]]], Max45815), 
LRes19158 = reshape_layer(Max45815, [1, 1, 4], Res19158), 
LRes70517 = reshape_layer(Res19158, [1, 4], Res70517), 
LRes94621 = reshape_layer(Res70517, [1, 4, 1], Res94621), 
LDep2852 = depthwise_conv2D_layer(Res94621, 1, 4,[[[[0.7974]], [[0.609]], [[0.4603]], [[0.4724]]]],[0], 1, 1, true, Dep2852), 
LCon93108 = concatenate_layer([Dep2852,[[[[0.823], [0.4605], [0.3134], [0.038]]]]], 3, Con93108), 
LAve43828 = average_layer([[[[[0.4798, 0.5185]]]], [[[[0.8252, 0.4832]]]]], Ave43828), 
LZer99092 = zero_padding2D_layer(Ave43828, 0, 0, 3, 0, Zer99092), 
LMin36000 = minimum_layer([Con93108,Zer99092], Min36000), 
exec_layers([LMax45815,LRes19158,LRes70517,LRes94621,LDep2852,LCon93108,LAve43828,LZer99092,LMin36000],["Max45815","Res19158","Res70517","Res94621","Dep2852","Con93108","Ave43828","Zer99092","Min36000"],Min36000,"Min36000")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.5290695, 0.0380000]]]]

Expected (Unparsed): [[[[0,0],[0,0],[0,0],[0.5290695000000001,0.038]]]]

Actual:   [[[[0, 0], [0, 0], [0, 0], [0.5291, 0.038]]]]

Expected: [[[[0, 0], [0, 0], [0, 0], [0.5291, 0.038]]]]