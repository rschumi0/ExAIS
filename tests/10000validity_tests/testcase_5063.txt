import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot32342 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot32342 = tf.keras.layers.Input(shape=([2, 3]))
in0Con9527 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Min60988 = tf.keras.layers.Input(shape=([1, 1]))
in1Min60988 = tf.keras.layers.Input(shape=([1, 1]))
in0Con89659 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Mul9080 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul9080 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Ave79596 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave79596 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Dot32342 = keras.layers.Dot(axes=(1, 1), name = 'Dot32342', )([in0Dot32342,in1Dot32342])
Res59985 = keras.layers.Reshape((3, 3, 1), name = 'Res59985', )(Dot32342)
Con9527 = keras.layers.Concatenate(axis=3, name = 'Con9527', )([Res59985,in0Con9527])
Min60988 = keras.layers.Minimum(name = 'Min60988', )([in0Min60988,in1Min60988])
Res4748 = keras.layers.Reshape((1, 1, 1), name = 'Res4748', )(Min60988)
Zer68262 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer68262', )(Res4748)
Con89659 = keras.layers.Concatenate(axis=3, name = 'Con89659', )([Zer68262,in0Con89659])
Mul9080 = keras.layers.Multiply(name = 'Mul9080', )([in0Mul9080,in1Mul9080])
Sub97002 = keras.layers.Subtract(name = 'Sub97002', )([Con89659,Mul9080])
Zer9674 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer9674', )(Sub97002)
Min85519 = keras.layers.Minimum(name = 'Min85519', )([Con9527,Zer9674])
Res71519 = keras.layers.Reshape((3, 3, 2, 1), name = 'Res71519', )(Min85519)
Ave79596 = keras.layers.Average(name = 'Ave79596', )([in0Ave79596,in1Ave79596])
Zer29779 = keras.layers.ZeroPadding3D(padding=((2, 0), (2, 0), (0, 0)), name = 'Zer29779', )(Ave79596)
Sub45355 = keras.layers.Subtract(name = 'Sub45355', )([Res71519,Zer29779])
model = tf.keras.models.Model(inputs=[in0Dot32342,in1Dot32342,in0Con9527,in0Min60988,in1Min60988,in0Con89659,in0Mul9080,in1Mul9080,in0Ave79596,in1Ave79596], outputs=Sub45355)
in0Dot32342 = tf.constant([[[0.8106, 0.243, 0.0437], [0.4017, 0.8937, 0.7024]]])
in1Dot32342 = tf.constant([[[0.079, 0.6657, 0.5467], [0.7032, 0.1326, 0.264]]])
in0Con9527 = tf.constant([[[[0.984], [0.8696], [0.9814]], [[0.4748], [0.492], [0.9634]], [[0.079], [0.655], [0.8914]]]])
in0Min60988 = tf.constant([[[0.2764]]])
in1Min60988 = tf.constant([[[0.2039]]])
in0Con89659 = tf.constant([[[[0.762]], [[0.2917]]]])
in0Mul9080 = tf.constant([[[[0.1235, 0.0893]], [[0.1546, 0.1203]]]])
in1Mul9080 = tf.constant([[[[0.1014, 0.3187]], [[0.2456, 0.499]]]])
in0Ave79596 = tf.constant([[[[[0.2867], [0.0457]]]]])
in1Ave79596 = tf.constant([[[[[0.2408], [0.3616]]]]])
print (np.array2string(model.predict([in0Dot32342,in1Dot32342,in0Con9527,in0Min60988,in1Min60988,in0Con89659,in0Mul9080,in1Mul9080,in0Ave79596,in1Ave79596],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub45355.png')

LDot32342 = dot_layer([[[0.8106, 0.243, 0.0437], [0.4017, 0.8937, 0.7024]]], [[[0.079, 0.6657, 0.5467], [0.7032, 0.1326, 0.264]]], 1, 1, Dot32342), 
LRes59985 = reshape_layer(Dot32342, [3, 3, 1], Res59985), 
LCon9527 = concatenate_layer([Res59985,[[[[0.984], [0.8696], [0.9814]], [[0.4748], [0.492], [0.9634]], [[0.079], [0.655], [0.8914]]]]], 3, Con9527), 
LMin60988 = minimum_layer([[[[0.2764]]], [[[0.2039]]]], Min60988), 
LRes4748 = reshape_layer(Min60988, [1, 1, 1], Res4748), 
LZer68262 = zero_padding2D_layer(Res4748, 1, 0, 0, 0, Zer68262), 
LCon89659 = concatenate_layer([Zer68262,[[[[0.762]], [[0.2917]]]]], 3, Con89659), 
LMul9080 = multiply_layer([[[[[0.1235, 0.0893]], [[0.1546, 0.1203]]]], [[[[0.1014, 0.3187]], [[0.2456, 0.499]]]]], Mul9080), 
LSub97002 = subtract_layer(Con89659,Mul9080, Sub97002), 
LZer9674 = zero_padding2D_layer(Sub97002, 1, 0, 2, 0, Zer9674), 
LMin85519 = minimum_layer([Con9527,Zer9674], Min85519), 
LRes71519 = reshape_layer(Min85519, [3, 3, 2, 1], Res71519), 
LAve79596 = average_layer([[[[[[0.2867], [0.0457]]]]], [[[[[0.2408], [0.3616]]]]]], Ave79596), 
LZer29779 = zero_padding3D_layer(Ave79596, 2, 0, 2, 0, 0, 0, Zer29779), 
LSub45355 = subtract_layer(Res71519,Zer29779, Sub45355), 
exec_layers([LDot32342,LRes59985,LCon9527,LMin60988,LRes4748,LZer68262,LCon89659,LMul9080,LSub97002,LZer9674,LMin85519,LRes71519,LAve79596,LZer29779,LSub45355],["Dot32342","Res59985","Con9527","Min60988","Res4748","Zer68262","Con89659","Mul9080","Sub97002","Zer9674","Min85519","Res71519","Ave79596","Zer29779","Sub45355"],Sub45355,"Sub45355")

Actual (Unparsed): [[[[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[-0.0125229], [0.7335401]]], [[[0.0000000], [0.0000000]], [[0.0000000], [0.0000000]], [[-0.0978198], [0.0280203]]]]]

Expected (Unparsed): [[[[[0],[0]],[[0],[0]],[[0],[0]]],[[[0],[0]],[[0],[0]],[[-0.0125229],[0.73354009]]],[[[0],[0]],[[0],[0]],[[-0.09781975999999998],[0.028020299999999998]]]]]

Actual:   [[[[[0], [0]], [[0], [0]], [[0], [0]]], [[[0], [0]], [[0], [0]], [[-0.0125], [0.7336]]], [[[0], [0]], [[0], [0]], [[-0.0978], [0.0281]]]]]

Expected: [[[[[0], [0]], [[0], [0]], [[0], [0]]], [[[0], [0]], [[0], [0]], [[-0.0125], [0.7336]]], [[[0], [0]], [[0], [0]], [[-0.0978], [0.0281]]]]]