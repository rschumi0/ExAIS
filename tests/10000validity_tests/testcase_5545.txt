import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max60703 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max60703 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Max60703 = keras.layers.Maximum(name = 'Max60703', )([in0Max60703,in1Max60703])
Res60297 = keras.layers.Reshape((2, 2, 2), name = 'Res60297', )(Max60703)
Dep95969 = keras.layers.DepthwiseConv2D((2, 2),strides=(1, 1), padding='valid', name = 'Dep95969', )(Res60297)
model = tf.keras.models.Model(inputs=[in0Max60703,in1Max60703], outputs=Dep95969)
w = model.get_layer('Dep95969').get_weights() 
w[0] = np.array([[[[0.5139], [0.6302]], [[0.8828], [0.8482]]], [[[0.9674], [0.6119]], [[0.4631], [0.5637]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep95969').set_weights(w) 
in0Max60703 = tf.constant([[[[[0.2343, 0.2635]], [[0.8261, 0.5484]]], [[[0.2162, 0.3676]], [[0.9901, 0.4854]]]]])
in1Max60703 = tf.constant([[[[[0.0331, 0.7237]], [[0.3765, 0.9756]]], [[[0.4393, 0.3508]], [[0.2705, 0.0211]]]]])
print (np.array2string(model.predict([in0Max60703,in1Max60703],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep95969.png')

LMax60703 = maximum_layer([[[[[[0.2343, 0.2635]], [[0.8261, 0.5484]]], [[[0.2162, 0.3676]], [[0.9901, 0.4854]]]]], [[[[[0.0331, 0.7237]], [[0.3765, 0.9756]]], [[[0.4393, 0.3508]], [[0.2705, 0.0211]]]]]], Max60703), 
LRes60297 = reshape_layer(Max60703, [2, 2, 2], Res60297), 
LDep95969 = depthwise_conv2D_layer(Res60297, 2, 2,[[[[0.5139], [0.6302]], [[0.8828], [0.8482]]], [[[0.9674], [0.6119]], [[0.4631], [0.5637]]]],[0, 0], 1, 1, false, Dep95969), 
exec_layers([LMax60703,LRes60297,LDep95969],["Max60703","Res60297","Dep95969"],Dep95969,"Dep95969")

Actual (Unparsed): [[[[1.7331820, 1.7821341]]]]

Expected (Unparsed): [[[[1.7331819800000003,1.78213408]]]]

Actual:   [[[[1.7332, 1.7822]]]]

Expected: [[[[1.7332, 1.7822]]]]