import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay4898 = tf.keras.layers.Input(shape=([4, 4]))

Lay4898 = keras.layers.LayerNormalization(axis=2, epsilon=2.325114408333902, name = 'Lay4898', )(in0Lay4898)
Glo50590 = keras.layers.GlobalMaxPool1D(name = 'Glo50590', )(Lay4898)
Res77634 = keras.layers.Reshape((4, 1), name = 'Res77634', )(Glo50590)
Res39737 = keras.layers.Reshape((4, 1, 1), name = 'Res39737', )(Res77634)
Res39939 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res39939', )(Res39737)
Glo59157 = keras.layers.GlobalMaxPool3D(name = 'Glo59157', )(Res39939)
Res30135 = keras.layers.Reshape((1, 1), name = 'Res30135', )(Glo59157)
Con606 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con606', )(Res30135)
model = tf.keras.models.Model(inputs=[in0Lay4898], outputs=Con606)
w = model.get_layer('Con606').get_weights() 
w[0] = np.array([[[0.9114, 0.5381, 0.7627, 0.0066]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con606').set_weights(w) 
in0Lay4898 = tf.constant([[[1.4751, 1.9655, 1.8619, 1.3868], [1.2051, 1.3272, 1.2063, 1.5403], [1.0838, 1.9347, 1.8896, 1.1138], [1.0462, 1.9982, 1.2304, 1.7396]]])
print (np.array2string(model.predict([in0Lay4898],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con606.png')

LLay4898 = layer_normalization_layer([[[1.4751, 1.9655, 1.8619, 1.3868], [1.2051, 1.3272, 1.2063, 1.5403], [1.0838, 1.9347, 1.8896, 1.1138], [1.0462, 1.9982, 1.2304, 1.7396]]], 2, 2.325114408333902, Lay4898), 
LGlo50590 = global_max_pool1D_layer(Lay4898, Glo50590), 
LRes77634 = reshape_layer(Glo50590, [4, 1], Res77634), 
LRes39737 = reshape_layer(Res77634, [4, 1, 1], Res39737), 
LRes39939 = reshape_layer(Res39737, [4, 1, 1, 1], Res39939), 
LGlo59157 = global_max_pool3D_layer(Res39939, Glo59157), 
LRes30135 = reshape_layer(Glo59157, [1, 1], Res30135), 
LCon606 = conv1D_layer(Res30135, 1,[[[0.9114, 0.5381, 0.7627, 0.0066]]],[0, 0, 0, 0], 1, false, 1, Con606), 
exec_layers([LLay4898,LGlo50590,LRes77634,LRes39737,LRes39939,LGlo59157,LRes30135,LCon606],["Lay4898","Glo50590","Res77634","Res39737","Res39939","Glo59157","Res30135","Con606"],Con606,"Con606")

Actual (Unparsed): [[[0.2867562, 0.1693038, 0.2399703, 0.0020766]]]

Expected (Unparsed): [[[0.28675618632575267,0.16930382253882767,0.23997031304657845,0.002076575411180566]]]

Actual:   [[[0.2868, 0.1694, 0.24, 0.0021]]]

Expected: [[[0.2868, 0.1694, 0.24, 0.0021]]]