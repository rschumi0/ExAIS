import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul95126 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Mul95126 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Con20277 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Min79784 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Min79784 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Ave62446 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave62446 = tf.keras.layers.Input(shape=([2, 2]))
in0Con38164 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Sep68084 = tf.keras.layers.Input(shape=([2, 1, 2]))

Mul95126 = keras.layers.Multiply(name = 'Mul95126', )([in0Mul95126,in1Mul95126])
Res5118 = keras.layers.Reshape((2, 1, 1), name = 'Res5118', )(Mul95126)
Zer8884 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer8884', )(Res5118)
Con20277 = keras.layers.Concatenate(axis=3, name = 'Con20277', )([Zer8884,in0Con20277])
Min79784 = keras.layers.Minimum(name = 'Min79784', )([in0Min79784,in1Min79784])
Res60966 = keras.layers.Reshape((1, 2), name = 'Res60966', )(Min79784)
Zer32352 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer32352', )(Res60966)
Ave62446 = keras.layers.Average(name = 'Ave62446', )([in0Ave62446,in1Ave62446])
Mul7728 = keras.layers.Multiply(name = 'Mul7728', )([Zer32352,Ave62446])
Res77874 = keras.layers.Reshape((2, 2, 1), name = 'Res77874', )(Mul7728)
Con38164 = keras.layers.Concatenate(axis=3, name = 'Con38164', )([Res77874,in0Con38164])
Sep68084 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep68084', )(in0Sep68084)
Zer5757 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer5757', )(Sep68084)
Min90012 = keras.layers.Minimum(name = 'Min90012', )([Con38164,Zer5757])
Min78663 = keras.layers.Minimum(name = 'Min78663', )([Con20277,Min90012])
model = tf.keras.models.Model(inputs=[in0Mul95126,in1Mul95126,in0Con20277,in0Min79784,in1Min79784,in0Ave62446,in1Ave62446,in0Con38164,in0Sep68084], outputs=Min78663)
w = model.get_layer('Sep68084').get_weights() 
w[0] = np.array([[[[0.2975], [0.606]]]])
w[1] = np.array([[[[0.357, 0.3189], [0.6263, 0.7519]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep68084').set_weights(w) 
in0Mul95126 = tf.constant([[[[[0.1568]]], [[[0.5458]]]]])
in1Mul95126 = tf.constant([[[[[0.1687]]], [[[0.4239]]]]])
in0Con20277 = tf.constant([[[[0.7258], [0.8544]], [[0.8653], [0.9993]]]])
in0Min79784 = tf.constant([[[[0.7425, 0.9504]]]])
in1Min79784 = tf.constant([[[[0.8441, 0.8459]]]])
in0Ave62446 = tf.constant([[[0.3713, 0.7605], [0.2046, 0.0396]]])
in1Ave62446 = tf.constant([[[0.9025, 0.4218], [0.2376, 0.4286]]])
in0Con38164 = tf.constant([[[[0.5895], [0.2689]], [[0.5168], [0.19]]]])
in0Sep68084 = tf.constant([[[[0.4895, 0.7926]], [[0.5511, 0.2167]]]])
print (np.array2string(model.predict([in0Mul95126,in1Mul95126,in0Con20277,in0Min79784,in1Min79784,in0Ave62446,in1Ave62446,in0Con38164,in0Sep68084],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min78663.png')

LMul95126 = multiply_layer([[[[[[0.1568]]], [[[0.5458]]]]], [[[[[0.1687]]], [[[0.4239]]]]]], Mul95126), 
LRes5118 = reshape_layer(Mul95126, [2, 1, 1], Res5118), 
LZer8884 = zero_padding2D_layer(Res5118, 0, 0, 1, 0, Zer8884), 
LCon20277 = concatenate_layer([Zer8884,[[[[0.7258], [0.8544]], [[0.8653], [0.9993]]]]], 3, Con20277), 
LMin79784 = minimum_layer([[[[[0.7425, 0.9504]]]], [[[[0.8441, 0.8459]]]]], Min79784), 
LRes60966 = reshape_layer(Min79784, [1, 2], Res60966), 
LZer32352 = zero_padding1D_layer(Res60966, 1, 0, Zer32352), 
LAve62446 = average_layer([[[[0.3713, 0.7605], [0.2046, 0.0396]]], [[[0.9025, 0.4218], [0.2376, 0.4286]]]], Ave62446), 
LMul7728 = multiply_layer([Zer32352,Ave62446], Mul7728), 
LRes77874 = reshape_layer(Mul7728, [2, 2, 1], Res77874), 
LCon38164 = concatenate_layer([Res77874,[[[[0.5895], [0.2689]], [[0.5168], [0.19]]]]], 3, Con38164), 
LSep68084 = separable_conv2D_layer([[[[0.4895, 0.7926]], [[0.5511, 0.2167]]]], 1, 1,[[[[[0.2975], [0.606]]]],[[[[0.357, 0.3189], [0.6263, 0.7519]]]]],[0, 0], 1, 1, false, Sep68084), 
LZer5757 = zero_padding2D_layer(Sep68084, 0, 0, 1, 0, Zer5757), 
LMin90012 = minimum_layer([Con38164,Zer5757], Min90012), 
LMin78663 = minimum_layer([Con20277,Min90012], Min78663), 
exec_layers([LMul95126,LRes5118,LZer8884,LCon20277,LMin79784,LRes60966,LZer32352,LAve62446,LMul7728,LRes77874,LCon38164,LSep68084,LZer5757,LMin90012,LMin78663],["Mul95126","Res5118","Zer8884","Con20277","Min79784","Res60966","Zer32352","Ave62446","Mul7728","Res77874","Con38164","Sep68084","Zer5757","Min90012","Min78663"],Min78663,"Min78663")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.2689000]], [[0.0000000, 0.0000000], [0.1407768, 0.1510240]]]]

Expected (Unparsed): [[[[0,0],[0.0,0.2689]],[[0,0],[0.14077679451,0.151024030905]]]]

Actual:   [[[[0, 0], [0, 0.2689]], [[0, 0], [0.1408, 0.1511]]]]

Expected: [[[[0, 0], [0, 0.2689]], [[0, 0], [0.1408, 0.1511]]]]