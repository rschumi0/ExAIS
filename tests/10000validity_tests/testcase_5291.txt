import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave43954 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave43954 = tf.keras.layers.Input(shape=([2, 2, 2]))

Ave43954 = keras.layers.Average(name = 'Ave43954', )([in0Ave43954,in1Ave43954])
Res45343 = keras.layers.Reshape((2, 4), name = 'Res45343', )(Ave43954)
Loc81936 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc81936', )(Res45343)
model = tf.keras.models.Model(inputs=[in0Ave43954,in1Ave43954], outputs=Loc81936)
w = model.get_layer('Loc81936').get_weights() 
w[0] = np.array([[[0.371, 0.5796, 0.5681], [0.4084, 0.7805, 0.1565], [0.846, 0.2671, 0.5059], [0.5637, 0.6632, 0.6617], [0.6548, 0.9191, 0.43], [0.3798, 0.5558, 0.3294], [0.355, 0.1624, 0.9696], [0.0299, 0.3149, 0.8993]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc81936').set_weights(w) 
in0Ave43954 = tf.constant([[[[0.0232, 0.096], [0.6621, 0.9573]], [[0.6686, 0.4624], [0.2802, 0.1124]]]])
in1Ave43954 = tf.constant([[[[0.3622, 0.5257], [0.0383, 0.5127]], [[0.2276, 0.6032], [0.7086, 0.88]]]])
print (np.array2string(model.predict([in0Ave43954,in1Ave43954],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc81936.png')

LAve43954 = average_layer([[[[[0.0232, 0.096], [0.6621, 0.9573]], [[0.6686, 0.4624], [0.2802, 0.1124]]]], [[[[0.3622, 0.5257], [0.0383, 0.5127]], [[0.2276, 0.6032], [0.7086, 0.88]]]]], Ave43954), 
LRes45343 = reshape_layer(Ave43954, [2, 4], Res45343), 
LLoc81936 = locally_connected1D_layer(Res45343, 2,[[[0.371, 0.5796, 0.5681], [0.4084, 0.7805, 0.1565], [0.846, 0.2671, 0.5059], [0.5637, 0.6632, 0.6617], [0.6548, 0.9191, 0.43], [0.3798, 0.5558, 0.3294], [0.355, 0.1624, 0.9696], [0.0299, 0.3149, 0.8993]]],[[0, 0, 0]], 1, Loc81936), 
exec_layers([LAve43954,LRes45343,LLoc81936],["Ave43954","Res45343","Loc81936"],Loc81936,"Loc81936")

Actual (Unparsed): [[[1.5951533, 1.8798207, 2.1154268]]]

Expected (Unparsed): [[[1.59515324,1.8798206549999996,2.115426795]]]

Actual:   [[[1.5952, 1.8799, 2.1155]]]

Expected: [[[1.5952, 1.8799, 2.1155]]]