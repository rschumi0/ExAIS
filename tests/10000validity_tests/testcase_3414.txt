import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min3390 = tf.keras.layers.Input(shape=([2, 1]))
in1Min3390 = tf.keras.layers.Input(shape=([2, 1]))
in0ELU77996 = tf.keras.layers.Input(shape=([2, 1, 2]))

Min3390 = keras.layers.Minimum(name = 'Min3390', )([in0Min3390,in1Min3390])
Per42671 = keras.layers.Permute((1,2), name = 'Per42671',)(Min3390)
Res19024 = keras.layers.Reshape((2, 1, 1), name = 'Res19024', )(Per42671)
ELU77996 = keras.layers.ELU(alpha=0.5051214134797455, name = 'ELU77996', input_shape=(2, 1, 2))(in0ELU77996)
Res93301 = keras.layers.Reshape((2, 2), name = 'Res93301', )(ELU77996)
PRe60332 = keras.layers.PReLU(name = 'PRe60332', )(Res93301)
Res47641 = keras.layers.Reshape((2, 2, 1), name = 'Res47641', )(PRe60332)
Res58334 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res58334', )(Res47641)
Cro40018 = keras.layers.Cropping3D(cropping=((0, 0), (1, 0), (0, 0)), name = 'Cro40018', )(Res58334)
Res92184 = keras.layers.Reshape((2, 1, 1), name = 'Res92184', )(Cro40018)
Sub94319 = keras.layers.Subtract(name = 'Sub94319', )([Res19024,Res92184])
model = tf.keras.models.Model(inputs=[in0Min3390,in1Min3390,in0ELU77996], outputs=Sub94319)
w = model.get_layer('PRe60332').get_weights() 
w[0] = np.array([[0.1164, 0.4673], [0.4776, 0.1271]])
model.get_layer('PRe60332').set_weights(w) 
in0Min3390 = tf.constant([[[0.2574], [0.5785]]])
in1Min3390 = tf.constant([[[0.063], [0.5368]]])
in0ELU77996 = tf.constant([[[[0.52, 0.8885]], [[0.4761, 0.7134]]]])
print (np.array2string(model.predict([in0Min3390,in1Min3390,in0ELU77996],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub94319.png')

LMin3390 = minimum_layer([[[[0.2574], [0.5785]]], [[[0.063], [0.5368]]]], Min3390), 
LPer42671 = permute_layer(Min3390, 1,2, Per42671), 
LRes19024 = reshape_layer(Per42671, [2, 1, 1], Res19024), 
LELU77996 = elu_layer([[[[0.52, 0.8885]], [[0.4761, 0.7134]]]], 0.5051214134797455, ELU77996), 
LRes93301 = reshape_layer(ELU77996, [2, 2], Res93301), 
LPRe60332 = prelu_layer(Res93301, [[0.1164, 0.4673], [0.4776, 0.1271]], PRe60332), 
LRes47641 = reshape_layer(PRe60332, [2, 2, 1], Res47641), 
LRes58334 = reshape_layer(Res47641, [2, 2, 1, 1], Res58334), 
LCro40018 = cropping3D_layer(Res58334, 0, 0, 1, 0, 0, 0, Cro40018), 
LRes92184 = reshape_layer(Cro40018, [2, 1, 1], Res92184), 
LSub94319 = subtract_layer(Res19024,Res92184, Sub94319), 
exec_layers([LMin3390,LPer42671,LRes19024,LELU77996,LRes93301,LPRe60332,LRes47641,LRes58334,LCro40018,LRes92184,LSub94319],["Min3390","Per42671","Res19024","ELU77996","Res93301","PRe60332","Res47641","Res58334","Cro40018","Res92184","Sub94319"],Sub94319,"Sub94319")

Actual (Unparsed): [[[[-0.8255000]], [[-0.1766000]]]]

Expected (Unparsed): [[[[-0.8254999999999999]],[[-0.17659999999999998]]]]

Actual:   [[[[-0.8255]], [[-0.1766]]]]

Expected: [[[[-0.8254]], [[-0.1765]]]]