import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max10764 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Max10764 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Glo13136 = tf.keras.layers.Input(shape=([1, 1, 2]))

Max10764 = keras.layers.Maximum(name = 'Max10764', )([in0Max10764,in1Max10764])
Res90006 = keras.layers.Reshape((2, 2, 1), name = 'Res90006', )(Max10764)
Res96830 = keras.layers.Reshape((2, 2), name = 'Res96830', )(Res90006)
Glo31340 = keras.layers.GlobalAveragePooling1D(name = 'Glo31340', )(Res96830)
Glo13136 = keras.layers.GlobalAveragePooling2D(name = 'Glo13136', )(in0Glo13136)
Max23688 = keras.layers.Maximum(name = 'Max23688', )([Glo31340,Glo13136])
Res19417 = keras.layers.Reshape((2, 1), name = 'Res19417', )(Max23688)
Sep21559 = keras.layers.SeparableConv1D(3, (2),strides=(1), padding='valid', name = 'Sep21559', )(Res19417)
Den52989 = keras.layers.Dense(3,name = 'Den52989', )(Sep21559)
model = tf.keras.models.Model(inputs=[in0Max10764,in1Max10764,in0Glo13136], outputs=Den52989)
w = model.get_layer('Sep21559').get_weights() 
w[0] = np.array([[[0.4178]], [[0.8558]]])
w[1] = np.array([[[0.6048, 0.6808, 0.8146]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep21559').set_weights(w) 
w = model.get_layer('Den52989').get_weights() 
w[0] = np.array([[0.2081, 0.6775, 0.698], [0.093, 0.408, 0.5142], [0.1055, 0.1644, 0.1496]])
w[1] = np.array([0.1647, 0.1821, 0.336])
model.get_layer('Den52989').set_weights(w) 
in0Max10764 = tf.constant([[[[[0.2032]], [[0.7092]]], [[[0.3213]], [[0.7033]]]]])
in1Max10764 = tf.constant([[[[[0.3442]], [[0.1921]]], [[[0.4954]], [[0.3389]]]]])
in0Glo13136 = tf.constant([[[[1.397, 1.7741]]]])
print (np.array2string(model.predict([in0Max10764,in1Max10764,in0Glo13136],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den52989.png')

LMax10764 = maximum_layer([[[[[[0.2032]], [[0.7092]]], [[[0.3213]], [[0.7033]]]]], [[[[[0.3442]], [[0.1921]]], [[[0.4954]], [[0.3389]]]]]], Max10764), 
LRes90006 = reshape_layer(Max10764, [2, 2, 1], Res90006), 
LRes96830 = reshape_layer(Res90006, [2, 2], Res96830), 
LGlo31340 = global_average_pooling1D_layer(Res96830, Glo31340), 
LGlo13136 = global_average_pooling2D_layer([[[[1.397, 1.7741]]]], Glo13136), 
LMax23688 = maximum_layer([Glo31340,Glo13136], Max23688), 
LRes19417 = reshape_layer(Max23688, [2, 1], Res19417), 
LSep21559 = separable_conv1D_layer(Res19417, 2,[[[[0.4178]], [[0.8558]]],[[[0.6048, 0.6808, 0.8146]]]],[0, 0, 0], 1, false, Sep21559), 
LDen52989 = dense_layer(Sep21559, [[0.2081, 0.6775, 0.698], [0.093, 0.408, 0.5142], [0.1055, 0.1644, 0.1496]],[0.1647, 0.1821, 0.336], Den52989), 
exec_layers([LMax10764,LRes90006,LRes96830,LGlo31340,LGlo13136,LMax23688,LRes19417,LSep21559,LDen52989],["Max10764","Res90006","Res96830","Glo31340","Glo13136","Max23688","Res19417","Sep21559","Den52989"],Den52989,"Den52989")

Actual (Unparsed): [[[0.7429726, 1.9087158, 2.2153077]]]

Expected (Unparsed): [[[0.7429726180019404,1.9087158685469232,2.2153077847578495]]]

Actual:   [[[0.743, 1.9088, 2.2154]]]

Expected: [[[0.743, 1.9088, 2.2154]]]