import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot83902 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot83902 = tf.keras.layers.Input(shape=([2, 3]))
in0Mas51909 = tf.keras.layers.Input(shape=([2]))
in0Con9974 = tf.keras.layers.Input(shape=([2]))

Dot83902 = keras.layers.Dot(axes=(2, 2), name = 'Dot83902', )([in0Dot83902,in1Dot83902])
Fla1337 = keras.layers.Flatten(name = 'Fla1337', )(Dot83902)
Mas51909 = keras.layers.Masking(mask_value=1, name = 'Mas51909', )(in0Mas51909)
Con9974 = keras.layers.Concatenate(axis=1, name = 'Con9974', )([Mas51909,in0Con9974])
Mul26316 = keras.layers.Multiply(name = 'Mul26316', )([Fla1337,Con9974])
Res95654 = keras.layers.Reshape((4, 1), name = 'Res95654', )(Mul26316)
Ave79733 = keras.layers.AveragePooling1D(pool_size=(2), strides=(1), padding='valid', name = 'Ave79733', )(Res95654)
Res23101 = keras.layers.Reshape((3, 1, 1), name = 'Res23101', )(Ave79733)
Res3307 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res3307', )(Res23101)
Glo42389 = keras.layers.GlobalAveragePooling3D(name = 'Glo42389', )(Res3307)
model = tf.keras.models.Model(inputs=[in0Dot83902,in1Dot83902,in0Mas51909,in0Con9974], outputs=Glo42389)
in0Dot83902 = tf.constant([[[0.5877, 0.2171, 0.035], [0.7644, 0.5054, 0.8844]]])
in1Dot83902 = tf.constant([[[0.2293, 0.6988, 0.4213], [0.6055, 0.651, 0.6449]]])
in0Mas51909 = tf.constant([[1.5762, 1.4351]])
in0Con9974 = tf.constant([[0.8481, 0.5192]])
print (np.array2string(model.predict([in0Dot83902,in1Dot83902,in0Mas51909,in0Con9974],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo42389.png')

LDot83902 = dot_layer([[[0.5877, 0.2171, 0.035], [0.7644, 0.5054, 0.8844]]], [[[0.2293, 0.6988, 0.4213], [0.6055, 0.651, 0.6449]]], 2, 2, Dot83902), 
LFla1337 = flatten_layer(Dot83902, Fla1337), 
LMas51909 = masking_layer([[1.5762, 1.4351]], 1, Mas51909), 
LCon9974 = concatenate_layer([Mas51909,[[0.8481, 0.5192]]], 1, Con9974), 
LMul26316 = multiply_layer([Fla1337,Con9974], Mul26316), 
LRes95654 = reshape_layer(Mul26316, [4, 1], Res95654), 
LAve79733 = average_pooling1D_layer(Res95654, 2, 1, false, Ave79733), 
LRes23101 = reshape_layer(Ave79733, [3, 1, 1], Res23101), 
LRes3307 = reshape_layer(Res23101, [3, 1, 1, 1], Res3307), 
LGlo42389 = global_average_pooling3D_layer(Res3307, Glo42389), 
exec_layers([LDot83902,LFla1337,LMas51909,LCon9974,LMul26316,LRes95654,LAve79733,LRes23101,LRes3307,LGlo42389],["Dot83902","Fla1337","Mas51909","Con9974","Mul26316","Res95654","Ave79733","Res23101","Res3307","Glo42389"],Glo42389,"Glo42389")

Actual (Unparsed): [[0.7003658]]

Expected (Unparsed): [[0.7003658082186667]]

Actual:   [[0.7004]]

Expected: [[0.7004]]