import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min78951 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Min78951 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Min78951 = keras.layers.Minimum(name = 'Min78951', )([in0Min78951,in1Min78951])
Res46077 = keras.layers.Reshape((2, 2, 1), name = 'Res46077', )(Min78951)
Res24174 = keras.layers.Reshape((2, 2), name = 'Res24174', )(Res46077)
Cro60509 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro60509', )(Res24174)
LST64729 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST64729', )(Cro60509)
model = tf.keras.models.Model(inputs=[in0Min78951,in1Min78951], outputs=LST64729)
w = model.get_layer('LST64729').get_weights() 
w[0] = np.array([[2, 1, 9, 6, 5, 10, 2, 1], [7, 8, 1, 9, 5, 8, 5, 7]])
w[1] = np.array([[4, 1, 9, 2, 3, 3, 1, 7], [4, 8, 10, 8, 10, 4, 8, 3]])
w[2] = np.array([1, 7, 3, 10, 9, 6, 7, 3])
model.get_layer('LST64729').set_weights(w) 
in0Min78951 = tf.constant([[[[[0.1692]], [[0.4709]]], [[[0.5141]], [[0.6447]]]]])
in1Min78951 = tf.constant([[[[[0.0354]], [[0.67]]], [[[0.17]], [[0.7233]]]]])
print (np.array2string(model.predict([in0Min78951,in1Min78951],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST64729.png')

LMin78951 = minimum_layer([[[[[[0.1692]], [[0.4709]]], [[[0.5141]], [[0.6447]]]]], [[[[[0.0354]], [[0.67]]], [[[0.17]], [[0.7233]]]]]], Min78951), 
LRes46077 = reshape_layer(Min78951, [2, 2, 1], Res46077), 
LRes24174 = reshape_layer(Res46077, [2, 2], Res24174), 
LCro60509 = cropping1D_layer(Res24174, 0, 0, Cro60509), 
LLST64729 = lstm_layer(Cro60509,[[2, 1, 9, 6, 5, 10, 2, 1], [7, 8, 1, 9, 5, 8, 5, 7]],[[4, 1, 9, 2, 3, 3, 1, 7], [4, 8, 10, 8, 10, 4, 8, 3]],[1, 7, 3, 10, 9, 6, 7, 3], LST64729), 
exec_layers([LMin78951,LRes46077,LRes24174,LCro60509,LLST64729],["Min78951","Res46077","Res24174","Cro60509","LST64729"],LST64729,"LST64729")

Actual (Unparsed): [[0.9631311, 0.9640259]]

Expected (Unparsed): [[0.9631311107780033,0.9640259139804142]]

Actual:   [[0.9632, 0.9641]]

Expected: [[0.9632, 0.9641]]