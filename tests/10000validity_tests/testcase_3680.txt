import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul26645 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Mul26645 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Up_56299 = tf.keras.layers.Input(shape=([2, 1]))
in0Con21799 = tf.keras.layers.Input(shape=([7]))

Mul26645 = keras.layers.Multiply(name = 'Mul26645', )([in0Mul26645,in1Mul26645])
Res83602 = keras.layers.Reshape((2, 2, 2), name = 'Res83602', )(Mul26645)
Res95690 = keras.layers.Reshape((2, 4), name = 'Res95690', )(Res83602)
Fla37610 = keras.layers.Flatten(name = 'Fla37610', )(Res95690)
Up_56299 = keras.layers.UpSampling1D(size=(1), name = 'Up_56299', )(in0Up_56299)
Res21571 = keras.layers.Reshape((2, 1, 1), name = 'Res21571', )(Up_56299)
Res34929 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res34929', )(Res21571)
Glo76434 = keras.layers.GlobalAveragePooling3D(name = 'Glo76434', )(Res34929)
Con21799 = keras.layers.Concatenate(axis=1, name = 'Con21799', )([Glo76434,in0Con21799])
Sub93021 = keras.layers.Subtract(name = 'Sub93021', )([Fla37610,Con21799])
model = tf.keras.models.Model(inputs=[in0Mul26645,in1Mul26645,in0Up_56299,in0Con21799], outputs=Sub93021)
in0Mul26645 = tf.constant([[[[[0.2862], [0.7398]], [[0.4034], [0.5918]]], [[[0.6469], [0.4267]], [[0.799], [0.9271]]]]])
in1Mul26645 = tf.constant([[[[[0.48], [0.1878]], [[0.1793], [0.3748]]], [[[0.4334], [0.888]], [[0.3241], [0.0448]]]]])
in0Up_56299 = tf.constant([[[1.5697], [1.4162]]])
in0Con21799 = tf.constant([[0.0873, 0.909, 0.6195, 0.5856, 0.2691, 0.3324, 0.2241]])
print (np.array2string(model.predict([in0Mul26645,in1Mul26645,in0Up_56299,in0Con21799],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub93021.png')

LMul26645 = multiply_layer([[[[[[0.2862], [0.7398]], [[0.4034], [0.5918]]], [[[0.6469], [0.4267]], [[0.799], [0.9271]]]]], [[[[[0.48], [0.1878]], [[0.1793], [0.3748]]], [[[0.4334], [0.888]], [[0.3241], [0.0448]]]]]], Mul26645), 
LRes83602 = reshape_layer(Mul26645, [2, 2, 2], Res83602), 
LRes95690 = reshape_layer(Res83602, [2, 4], Res95690), 
LFla37610 = flatten_layer(Res95690, Fla37610), 
LUp_56299 = up_sampling1D_layer([[[1.5697], [1.4162]]], 1, Up_56299), 
LRes21571 = reshape_layer(Up_56299, [2, 1, 1], Res21571), 
LRes34929 = reshape_layer(Res21571, [2, 1, 1, 1], Res34929), 
LGlo76434 = global_average_pooling3D_layer(Res34929, Glo76434), 
LCon21799 = concatenate_layer([Glo76434,[[0.0873, 0.909, 0.6195, 0.5856, 0.2691, 0.3324, 0.2241]]], 1, Con21799), 
LSub93021 = subtract_layer(Fla37610,Con21799, Sub93021), 
exec_layers([LMul26645,LRes83602,LRes95690,LFla37610,LUp_56299,LRes21571,LRes34929,LGlo76434,LCon21799,LSub93021],["Mul26645","Res83602","Res95690","Fla37610","Up_56299","Res21571","Res34929","Glo76434","Con21799","Sub93021"],Sub93021,"Sub93021")

Actual (Unparsed): [[-1.3555740, 0.0516344, -0.8366704, -0.3976934, -0.3052336, 0.1098096, -0.0734441, -0.1825659]]

Expected (Unparsed): [[-1.355574,0.05163443999999999,-0.83667038,-0.39769336000000005,-0.30523353999999997,0.10980960000000001,-0.07344409999999996,-0.18256592]]

Actual:   [[-1.3555, 0.0517, -0.8366, -0.3976, -0.3052, 0.1099, -0.0734, -0.1825]]

Expected: [[-1.3555, 0.0517, -0.8366, -0.3976, -0.3052, 0.1099, -0.0734, -0.1825]]