import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub42020 = tf.keras.layers.Input(shape=([3]))
in1Sub42020 = tf.keras.layers.Input(shape=([3]))

Sub42020 = keras.layers.Subtract(name = 'Sub42020', )([in0Sub42020,in1Sub42020])
Fla12978 = keras.layers.Flatten(name = 'Fla12978', )(Sub42020)
Res80213 = keras.layers.Reshape((3, 1), name = 'Res80213', )(Fla12978)
LST66442 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST66442', )(Res80213)
model = tf.keras.models.Model(inputs=[in0Sub42020,in1Sub42020], outputs=LST66442)
w = model.get_layer('LST66442').get_weights() 
w[0] = np.array([[5, 4, 8, 10]])
w[1] = np.array([[1, 5, 7, 1]])
w[2] = np.array([6, 10, 8, 9])
model.get_layer('LST66442').set_weights(w) 
in0Sub42020 = tf.constant([[0.9345, 0.2632, 0.9833]])
in1Sub42020 = tf.constant([[0.9523, 0.056, 0.8533]])
print (np.array2string(model.predict([in0Sub42020,in1Sub42020],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='LST66442.png')

LSub42020 = subtract_layer([[0.9345, 0.2632, 0.9833]], [[0.9523, 0.056, 0.8533]], Sub42020), 
LFla12978 = flatten_layer(Sub42020, Fla12978), 
LRes80213 = reshape_layer(Fla12978, [3, 1], Res80213), 
LLST66442 = lstm_layer(Res80213,[[5, 4, 8, 10]],[[1, 5, 7, 1]],[6, 10, 8, 9], LST66442), 
exec_layers([LSub42020,LFla12978,LRes80213,LLST66442],["Sub42020","Fla12978","Res80213","LST66442"],LST66442,"LST66442")

Actual (Unparsed): [[0.9950063]]

Expected (Unparsed): [[0.9950062664874805]]

Actual:   [[0.9951]]

Expected: [[0.9951]]