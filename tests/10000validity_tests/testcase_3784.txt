import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot44853 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot44853 = tf.keras.layers.Input(shape=([2, 2]))
in0Con26164 = tf.keras.layers.Input(shape=([2, 1]))
in0Add92032 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Add92032 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Glo73059 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con79965 = tf.keras.layers.Input(shape=([1]))
in0Con55210 = tf.keras.layers.Input(shape=([3, 1]))
in0Mul76541 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Mul76541 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Min7486 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Min7486 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Sub5753 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub5753 = tf.keras.layers.Input(shape=([3, 3]))
in0Con70446 = tf.keras.layers.Input(shape=([3, 1]))

Dot44853 = keras.layers.Dot(axes=(2, 2), name = 'Dot44853', )([in0Dot44853,in1Dot44853])
Con26164 = keras.layers.Concatenate(axis=2, name = 'Con26164', )([Dot44853,in0Con26164])
Add92032 = keras.layers.Add(name = 'Add92032', )([in0Add92032,in1Add92032])
Res70906 = keras.layers.Reshape((1, 1, 1), name = 'Res70906', )(Add92032)
Loc7766 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc7766', )(Res70906)
Res19480 = keras.layers.Reshape((1, 3), name = 'Res19480', )(Loc7766)
Fla56936 = keras.layers.Flatten(name = 'Fla56936', )(Res19480)
Glo73059 = keras.layers.GlobalMaxPool2D(name = 'Glo73059', )(in0Glo73059)
Con79965 = keras.layers.Concatenate(axis=1, name = 'Con79965', )([Glo73059,in0Con79965])
Ave25967 = keras.layers.Average(name = 'Ave25967', )([Fla56936,Con79965])
Res24412 = keras.layers.Reshape((3, 1), name = 'Res24412', )(Ave25967)
Sep34089 = keras.layers.SeparableConv1D(3, (2),strides=(1), padding='valid', name = 'Sep34089', )(Res24412)
Min21565 = keras.layers.Minimum(name = 'Min21565', )([Con26164,Sep34089])
Zer41742 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer41742', )(Min21565)
Con55210 = keras.layers.Concatenate(axis=2, name = 'Con55210', )([Zer41742,in0Con55210])
Mul76541 = keras.layers.Multiply(name = 'Mul76541', )([in0Mul76541,in1Mul76541])
Res45677 = keras.layers.Reshape((1, 2, 2), name = 'Res45677', )(Mul76541)
Res65483 = keras.layers.Reshape((1, 4), name = 'Res65483', )(Res45677)
Zer54050 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer54050', )(Res65483)
Min7486 = keras.layers.Minimum(name = 'Min7486', )([in0Min7486,in1Min7486])
Res78716 = keras.layers.Reshape((2, 2, 2), name = 'Res78716', )(Min7486)
Res30049 = keras.layers.Reshape((2, 4), name = 'Res30049', )(Res78716)
Zer52703 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer52703', )(Res30049)
Sub5753 = keras.layers.Subtract(name = 'Sub5753', )([in0Sub5753,in1Sub5753])
Con70446 = keras.layers.Concatenate(axis=2, name = 'Con70446', )([Sub5753,in0Con70446])
Ave95106 = keras.layers.Average(name = 'Ave95106', )([Zer52703,Con70446])
Sub42157 = keras.layers.Subtract(name = 'Sub42157', )([Zer54050,Ave95106])
Ave77588 = keras.layers.Average(name = 'Ave77588', )([Con55210,Sub42157])
model = tf.keras.models.Model(inputs=[in0Dot44853,in1Dot44853,in0Con26164,in0Add92032,in1Add92032,in0Glo73059,in0Con79965,in0Con55210,in0Mul76541,in1Mul76541,in0Min7486,in1Min7486,in0Sub5753,in1Sub5753,in0Con70446], outputs=Ave77588)
w = model.get_layer('Loc7766').get_weights() 
w[0] = np.array([[[0.0664, 0.1381, 0.4206]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc7766').set_weights(w) 
w = model.get_layer('Sep34089').get_weights() 
w[0] = np.array([[[0.6798]], [[0.0184]]])
w[1] = np.array([[[0.2081, 0.1437, 0.0121]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep34089').set_weights(w) 
in0Dot44853 = tf.constant([[[0.7609, 0.4293], [0.7504, 0.3554]]])
in1Dot44853 = tf.constant([[[0.0227, 0.6682], [0.5112, 0.9656]]])
in0Con26164 = tf.constant([[[0.6046], [0.0842]]])
in0Add92032 = tf.constant([[[[[0.7319]]]]])
in1Add92032 = tf.constant([[[[[0.8161]]]]])
in0Glo73059 = tf.constant([[[[1.0198, 1.3373]], [[1.9423, 1.862]]]])
in0Con79965 = tf.constant([[0.2241]])
in0Con55210 = tf.constant([[[0.7501], [0.1842], [0.0306]]])
in0Mul76541 = tf.constant([[[[[0.6828, 0.4002]], [[0.7806, 0.9372]]]]])
in1Mul76541 = tf.constant([[[[[0.0694, 0.0279]], [[0.4847, 0.2078]]]]])
in0Min7486 = tf.constant([[[[[0.284, 0.7797]], [[0.1999, 0.8968]]], [[[0.8107, 0.1489]], [[0.5669, 0.2079]]]]])
in1Min7486 = tf.constant([[[[[0.1723, 0.3825]], [[0.5062, 0.0811]]], [[[0.7509, 0.3625]], [[0.5, 0.6487]]]]])
in0Sub5753 = tf.constant([[[0.1604, 0.7402, 0.108], [0.9807, 0.6313, 0.5046], [0.4082, 0.2064, 0.971]]])
in1Sub5753 = tf.constant([[[0.4274, 0.5557, 0.3864], [0.7951, 0.379, 0.6689], [0.568, 0.8938, 0.3373]]])
in0Con70446 = tf.constant([[[0.5511], [0.7677], [0.0841]]])
print (np.array2string(model.predict([in0Dot44853,in1Dot44853,in0Con26164,in0Add92032,in1Add92032,in0Glo73059,in0Con79965,in0Con55210,in0Mul76541,in1Mul76541,in0Min7486,in1Min7486,in0Sub5753,in1Sub5753,in0Con70446],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave77588.png')

LDot44853 = dot_layer([[[0.7609, 0.4293], [0.7504, 0.3554]]], [[[0.0227, 0.6682], [0.5112, 0.9656]]], 2, 2, Dot44853), 
LCon26164 = concatenate_layer([Dot44853,[[[0.6046], [0.0842]]]], 2, Con26164), 
LAdd92032 = add_layer([[[[[[0.7319]]]]], [[[[[0.8161]]]]]], Add92032), 
LRes70906 = reshape_layer(Add92032, [1, 1, 1], Res70906), 
LLoc7766 = locally_connected2D_layer(Res70906, 1, 1,[[[0.0664, 0.1381, 0.4206]]],[[[0, 0, 0]]], 1, 1, Loc7766), 
LRes19480 = reshape_layer(Loc7766, [1, 3], Res19480), 
LFla56936 = flatten_layer(Res19480, Fla56936), 
LGlo73059 = global_max_pool2D_layer([[[[1.0198, 1.3373]], [[1.9423, 1.862]]]], Glo73059), 
LCon79965 = concatenate_layer([Glo73059,[[0.2241]]], 1, Con79965), 
LAve25967 = average_layer([Fla56936,Con79965], Ave25967), 
LRes24412 = reshape_layer(Ave25967, [3, 1], Res24412), 
LSep34089 = separable_conv1D_layer(Res24412, 2,[[[[0.6798]], [[0.0184]]],[[[0.2081, 0.1437, 0.0121]]]],[0, 0, 0], 1, false, Sep34089), 
LMin21565 = minimum_layer([Con26164,Sep34089], Min21565), 
LZer41742 = zero_padding1D_layer(Min21565, 1, 0, Zer41742), 
LCon55210 = concatenate_layer([Zer41742,[[[0.7501], [0.1842], [0.0306]]]], 2, Con55210), 
LMul76541 = multiply_layer([[[[[[0.6828, 0.4002]], [[0.7806, 0.9372]]]]], [[[[[0.0694, 0.0279]], [[0.4847, 0.2078]]]]]], Mul76541), 
LRes45677 = reshape_layer(Mul76541, [1, 2, 2], Res45677), 
LRes65483 = reshape_layer(Res45677, [1, 4], Res65483), 
LZer54050 = zero_padding1D_layer(Res65483, 2, 0, Zer54050), 
LMin7486 = minimum_layer([[[[[[0.284, 0.7797]], [[0.1999, 0.8968]]], [[[0.8107, 0.1489]], [[0.5669, 0.2079]]]]], [[[[[0.1723, 0.3825]], [[0.5062, 0.0811]]], [[[0.7509, 0.3625]], [[0.5, 0.6487]]]]]], Min7486), 
LRes78716 = reshape_layer(Min7486, [2, 2, 2], Res78716), 
LRes30049 = reshape_layer(Res78716, [2, 4], Res30049), 
LZer52703 = zero_padding1D_layer(Res30049, 1, 0, Zer52703), 
LSub5753 = subtract_layer([[[0.1604, 0.7402, 0.108], [0.9807, 0.6313, 0.5046], [0.4082, 0.2064, 0.971]]], [[[0.4274, 0.5557, 0.3864], [0.7951, 0.379, 0.6689], [0.568, 0.8938, 0.3373]]], Sub5753), 
LCon70446 = concatenate_layer([Sub5753,[[[0.5511], [0.7677], [0.0841]]]], 2, Con70446), 
LAve95106 = average_layer([Zer52703,Con70446], Ave95106), 
LSub42157 = subtract_layer(Zer54050,Ave95106, Sub42157), 
LAve77588 = average_layer([Con55210,Sub42157], Ave77588), 
exec_layers([LDot44853,LCon26164,LAdd92032,LRes70906,LLoc7766,LRes19480,LFla56936,LGlo73059,LCon79965,LAve25967,LRes24412,LSep34089,LMin21565,LZer41742,LCon55210,LMul76541,LRes45677,LRes65483,LZer54050,LMin7486,LRes78716,LRes30049,LZer52703,LSub5753,LCon70446,LAve95106,LSub42157,LAve77588],["Dot44853","Con26164","Add92032","Res70906","Loc7766","Res19480","Fla56936","Glo73059","Con79965","Ave25967","Res24412","Sep34089","Min21565","Zer41742","Con55210","Mul76541","Res45677","Res65483","Zer54050","Min7486","Res78716","Res30049","Zer52703","Sub5753","Con70446","Ave95106","Sub42157","Ave77588"],Ave77588,"Ave77588")

Actual (Unparsed): [[[0.0667500, -0.0461250, 0.0696000, 0.2372750], [-0.0151602, -0.1073831, -0.0045789, -0.1201000], [-0.0498308, 0.1914806, -0.0899293, 0.0396751]]]

Expected (Unparsed): [[[0.06675,-0.046125,0.06960000000000001,0.23727499999999999],[-0.015160169243828014,-0.10738312744035602,-0.004578955059347999,-0.1201],[-0.049830828640126,0.191480593135098,-0.08992925584596599,0.03967508000000001]]]

Actual:   [[[0.0668, -0.0461, 0.0696, 0.2373], [-0.0151, -0.1073, -0.0045, -0.1201], [-0.0498, 0.1915, -0.0899, 0.0397]]]

Expected: [[[0.0668, -0.0461, 0.0697, 0.2373], [-0.0151, -0.1073, -0.0045, -0.1201], [-0.0498, 0.1915, -0.0899, 0.0397]]]