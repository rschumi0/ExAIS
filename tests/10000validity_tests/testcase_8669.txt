import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max43614 = tf.keras.layers.Input(shape=([1, 1]))
in1Max43614 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot88111 = tf.keras.layers.Input(shape=([3]))
in1Dot88111 = tf.keras.layers.Input(shape=([3]))

Max43614 = keras.layers.Maximum(name = 'Max43614', )([in0Max43614,in1Max43614])
Zer97455 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer97455', )(Max43614)
Dot88111 = keras.layers.Dot(axes=(1, 1), name = 'Dot88111', )([in0Dot88111,in1Dot88111])
Res77606 = keras.layers.Reshape((1, 1), name = 'Res77606', )(Dot88111)
Zer75016 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer75016', )(Res77606)
Lay29828 = keras.layers.LayerNormalization(axis=1, epsilon=1.0033909428428531, name = 'Lay29828', )(Zer75016)
Sub65848 = keras.layers.Subtract(name = 'Sub65848', )([Zer97455,Lay29828])
model = tf.keras.models.Model(inputs=[in0Max43614,in1Max43614,in0Dot88111,in1Dot88111], outputs=Sub65848)
in0Max43614 = tf.constant([[[0.4002]]])
in1Max43614 = tf.constant([[[0.9844]]])
in0Dot88111 = tf.constant([[0.8304, 0.3854, 0.4171]])
in1Dot88111 = tf.constant([[0.178, 0.1019, 0.1288]])
print (np.array2string(model.predict([in0Max43614,in1Max43614,in0Dot88111,in1Dot88111],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub65848.png')

LMax43614 = maximum_layer([[[[0.4002]]], [[[0.9844]]]], Max43614), 
LZer97455 = zero_padding1D_layer(Max43614, 2, 0, Zer97455), 
LDot88111 = dot_layer([[0.8304, 0.3854, 0.4171]], [[0.178, 0.1019, 0.1288]], 1, 1, Dot88111), 
LRes77606 = reshape_layer(Dot88111, [1, 1], Res77606), 
LZer75016 = zero_padding1D_layer(Res77606, 1, 1, Zer75016), 
LLay29828 = layer_normalization_layer(Zer75016, 1, 1.0033909428428531, Lay29828), 
LSub65848 = subtract_layer(Zer97455,Lay29828, Sub65848), 
exec_layers([LMax43614,LZer97455,LDot88111,LRes77606,LZer75016,LLay29828,LSub65848],["Max43614","Zer97455","Dot88111","Res77606","Zer75016","Lay29828","Sub65848"],Sub65848,"Sub65848")

Actual (Unparsed): [[[0.0796232], [-0.1592465], [1.0640232]]]

Expected (Unparsed): [[[0.07962324642376274],[-0.15924649284752548],[1.064023246423763]]]

Actual:   [[[0.0797], [-0.1592], [1.0641]]]

Expected: [[[0.0797], [-0.1592], [1.0641]]]