import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave69004 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Ave69004 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))

Ave69004 = keras.layers.Average(name = 'Ave69004', )([in0Ave69004,in1Ave69004])
Res99399 = keras.layers.Reshape((2, 1, 2), name = 'Res99399', )(Ave69004)
Dep31762 = keras.layers.DepthwiseConv2D((2, 1),strides=(2, 2), padding='same', name = 'Dep31762', )(Res99399)
Sep20014 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep20014', )(Dep31762)
model = tf.keras.models.Model(inputs=[in0Ave69004,in1Ave69004], outputs=Sep20014)
w = model.get_layer('Dep31762').get_weights() 
w[0] = np.array([[[[0.2564], [0.0959]]], [[[0.6858], [0.2769]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep31762').set_weights(w) 
w = model.get_layer('Sep20014').get_weights() 
w[0] = np.array([[[[0.3007], [0.0451]]]])
w[1] = np.array([[[[0.552, 0.4903, 0.3543], [0.6323, 0.3306, 0.0072]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep20014').set_weights(w) 
in0Ave69004 = tf.constant([[[[[0.007, 0.7301]]], [[[0.3592, 0.2374]]]]])
in1Ave69004 = tf.constant([[[[[0.2391, 0.6371]]], [[[0.5687, 0.4798]]]]])
print (np.array2string(model.predict([in0Ave69004,in1Ave69004],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep20014.png')

LAve69004 = average_layer([[[[[[0.007, 0.7301]]], [[[0.3592, 0.2374]]]]], [[[[[0.2391, 0.6371]]], [[[0.5687, 0.4798]]]]]], Ave69004), 
LRes99399 = reshape_layer(Ave69004, [2, 1, 2], Res99399), 
LDep31762 = depthwise_conv2D_layer(Res99399, 2, 1,[[[[0.2564], [0.0959]]], [[[0.6858], [0.2769]]]],[0, 0], 2, 2, true, Dep31762), 
LSep20014 = separable_conv2D_layer(Dep31762, 1, 1,[[[[[0.3007], [0.0451]]]],[[[[0.552, 0.4903, 0.3543], [0.6323, 0.3306, 0.0072]]]]],[0, 0, 0], 1, 1, true, Sep20014), 
exec_layers([LAve69004,LRes99399,LDep31762,LSep20014],["Ave69004","Res99399","Dep31762","Sep20014"],Sep20014,"Sep20014")

Actual (Unparsed): [[[[0.0627510, 0.0540193, 0.0373127]]]]

Expected (Unparsed): [[[[0.0627509991241454,0.0540193406823601,0.037312742420106904]]]]

Actual:   [[[[0.0628, 0.0541, 0.0374]]]]

Expected: [[[[0.0628, 0.0541, 0.0374]]]]