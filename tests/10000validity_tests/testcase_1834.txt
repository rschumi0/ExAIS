import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min61210 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min61210 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con61301 = tf.keras.layers.Input(shape=([4]))
in0Dep56076 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con47594 = tf.keras.layers.Input(shape=([4]))
in0Fla84147 = tf.keras.layers.Input(shape=([2, 3]))
in0Mul71760 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Mul71760 = tf.keras.layers.Input(shape=([1, 1, 1]))

Min61210 = keras.layers.Minimum(name = 'Min61210', )([in0Min61210,in1Min61210])
Res75061 = keras.layers.Reshape((1, 2), name = 'Res75061', )(Min61210)
Fla41855 = keras.layers.Flatten(name = 'Fla41855', )(Res75061)
Con61301 = keras.layers.Concatenate(axis=1, name = 'Con61301', )([Fla41855,in0Con61301])
Dep56076 = keras.layers.DepthwiseConv2D((1, 1),strides=(2, 2), padding='valid', name = 'Dep56076', )(in0Dep56076)
Res15507 = keras.layers.Reshape((1, 2), name = 'Res15507', )(Dep56076)
Fla16571 = keras.layers.Flatten(name = 'Fla16571', )(Res15507)
Con47594 = keras.layers.Concatenate(axis=1, name = 'Con47594', )([Fla16571,in0Con47594])
Fla84147 = keras.layers.Flatten(name = 'Fla84147', )(in0Fla84147)
Ave83658 = keras.layers.Average(name = 'Ave83658', )([Con47594,Fla84147])
Lay91052 = keras.layers.LayerNormalization(axis=1, epsilon=2.8459559908061625, name = 'Lay91052', )(Ave83658)
Ave79121 = keras.layers.Average(name = 'Ave79121', )([Con61301,Lay91052])
Res25876 = keras.layers.Reshape((6, 1), name = 'Res25876', )(Ave79121)
Res82701 = keras.layers.Reshape((6, 1, 1), name = 'Res82701', )(Res25876)
Mul71760 = keras.layers.Multiply(name = 'Mul71760', )([in0Mul71760,in1Mul71760])
Zer60540 = keras.layers.ZeroPadding2D(padding=((5, 0), (0, 0)), name = 'Zer60540', )(Mul71760)
Ave39096 = keras.layers.Average(name = 'Ave39096', )([Res82701,Zer60540])
model = tf.keras.models.Model(inputs=[in0Min61210,in1Min61210,in0Con61301,in0Dep56076,in0Con47594,in0Fla84147,in0Mul71760,in1Mul71760], outputs=Ave39096)
w = model.get_layer('Dep56076').get_weights() 
w[0] = np.array([[[[0.951], [0.3017]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep56076').set_weights(w) 
in0Min61210 = tf.constant([[[[0.6867], [0.5466]]]])
in1Min61210 = tf.constant([[[[0.4078], [0.7674]]]])
in0Con61301 = tf.constant([[0.7355, 0.9352, 0.8241, 0.5835]])
in0Dep56076 = tf.constant([[[[0.3395, 0.4686]], [[0.7491, 0.6703]]]])
in0Con47594 = tf.constant([[0.9686, 0.6603, 0.0026, 0.9013]])
in0Fla84147 = tf.constant([[[1.535, 1.7851, 1.6289], [1.5583, 1.9811, 1.0464]]])
in0Mul71760 = tf.constant([[[[0.2242]]]])
in1Mul71760 = tf.constant([[[[0.7813]]]])
print (np.array2string(model.predict([in0Min61210,in1Min61210,in0Con61301,in0Dep56076,in0Con47594,in0Fla84147,in0Mul71760,in1Mul71760],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave39096.png')

LMin61210 = minimum_layer([[[[[0.6867], [0.5466]]]], [[[[0.4078], [0.7674]]]]], Min61210), 
LRes75061 = reshape_layer(Min61210, [1, 2], Res75061), 
LFla41855 = flatten_layer(Res75061, Fla41855), 
LCon61301 = concatenate_layer([Fla41855,[[0.7355, 0.9352, 0.8241, 0.5835]]], 1, Con61301), 
LDep56076 = depthwise_conv2D_layer([[[[0.3395, 0.4686]], [[0.7491, 0.6703]]]], 1, 1,[[[[0.951], [0.3017]]]],[0, 0], 2, 2, false, Dep56076), 
LRes15507 = reshape_layer(Dep56076, [1, 2], Res15507), 
LFla16571 = flatten_layer(Res15507, Fla16571), 
LCon47594 = concatenate_layer([Fla16571,[[0.9686, 0.6603, 0.0026, 0.9013]]], 1, Con47594), 
LFla84147 = flatten_layer([[[1.535, 1.7851, 1.6289], [1.5583, 1.9811, 1.0464]]], Fla84147), 
LAve83658 = average_layer([Con47594,Fla84147], Ave83658), 
LLay91052 = layer_normalization_layer(Ave83658, 1, 2.8459559908061625, Lay91052), 
LAve79121 = average_layer([Con61301,Lay91052], Ave79121), 
LRes25876 = reshape_layer(Ave79121, [6, 1], Res25876), 
LRes82701 = reshape_layer(Res25876, [6, 1, 1], Res82701), 
LMul71760 = multiply_layer([[[[[0.2242]]]], [[[[0.7813]]]]], Mul71760), 
LZer60540 = zero_padding2D_layer(Mul71760, 5, 0, 0, 0, Zer60540), 
LAve39096 = average_layer([Res82701,Zer60540], Ave39096), 
exec_layers([LMin61210,LRes75061,LFla41855,LCon61301,LDep56076,LRes15507,LFla16571,LCon47594,LFla84147,LAve83658,LLay91052,LAve79121,LRes25876,LRes82701,LMul71760,LZer60540,LAve39096],["Min61210","Res75061","Fla41855","Con61301","Dep56076","Res15507","Fla16571","Con47594","Fla84147","Ave83658","Lay91052","Ave79121","Res25876","Res82701","Mul71760","Zer60540","Ave39096"],Ave39096,"Ave39096")

Actual (Unparsed): [[[[0.0848985]], [[0.1246681]], [[0.2214734]], [[0.2434024]], [[0.1982712]], [[0.2230450]]]]

Expected (Unparsed): [[[[0.0848985448067974]],[[0.12466812777192363]],[[0.22147341615901067]],[[0.2434024150809748]],[[0.1982712243888908]],[[0.22304500179240283]]]]

Actual:   [[[[0.0849]], [[0.1247]], [[0.2215]], [[0.2435]], [[0.1983]], [[0.2231]]]]

Expected: [[[[0.0849]], [[0.1247]], [[0.2215]], [[0.2435]], [[0.1983]], [[0.2231]]]]