import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max68687 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Max68687 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Dot64032 = tf.keras.layers.Input(shape=([3]))
in1Dot64032 = tf.keras.layers.Input(shape=([3]))
in0Con61180 = tf.keras.layers.Input(shape=([3]))

Max68687 = keras.layers.Maximum(name = 'Max68687', )([in0Max68687,in1Max68687])
Res32610 = keras.layers.Reshape((2, 2, 1), name = 'Res32610', )(Max68687)
Res91740 = keras.layers.Reshape((2, 2), name = 'Res91740', )(Res32610)
Fla46658 = keras.layers.Flatten(name = 'Fla46658', )(Res91740)
Dot64032 = keras.layers.Dot(axes=(1, 1), name = 'Dot64032', )([in0Dot64032,in1Dot64032])
Con61180 = keras.layers.Concatenate(axis=1, name = 'Con61180', )([Dot64032,in0Con61180])
Min4315 = keras.layers.Minimum(name = 'Min4315', )([Fla46658,Con61180])
Sof66957 = keras.layers.Softmax(axis=1, name = 'Sof66957', )(Min4315)
model = tf.keras.models.Model(inputs=[in0Max68687,in1Max68687,in0Dot64032,in1Dot64032,in0Con61180], outputs=Sof66957)
in0Max68687 = tf.constant([[[[[0.9119]], [[0.1271]]], [[[0.9759]], [[0.82]]]]])
in1Max68687 = tf.constant([[[[[0.6162]], [[0.7979]]], [[[0.0127]], [[0.8233]]]]])
in0Dot64032 = tf.constant([[0.1259, 0.1258, 0.6697]])
in1Dot64032 = tf.constant([[0.6112, 0.2826, 0.288]])
in0Con61180 = tf.constant([[0.6145, 0.5405, 0.7524]])
print (np.array2string(model.predict([in0Max68687,in1Max68687,in0Dot64032,in1Dot64032,in0Con61180],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof66957.png')

LMax68687 = maximum_layer([[[[[[0.9119]], [[0.1271]]], [[[0.9759]], [[0.82]]]]], [[[[[0.6162]], [[0.7979]]], [[[0.0127]], [[0.8233]]]]]], Max68687), 
LRes32610 = reshape_layer(Max68687, [2, 2, 1], Res32610), 
LRes91740 = reshape_layer(Res32610, [2, 2], Res91740), 
LFla46658 = flatten_layer(Res91740, Fla46658), 
LDot64032 = dot_layer([[0.1259, 0.1258, 0.6697]], [[0.6112, 0.2826, 0.288]], 1, 1, Dot64032), 
LCon61180 = concatenate_layer([Dot64032,[[0.6145, 0.5405, 0.7524]]], 1, Con61180), 
LMin4315 = minimum_layer([Fla46658,Con61180], Min4315), 
LSof66957 = softmax_layer(Min4315, 1, Sof66957), 
exec_layers([LMax68687,LRes32610,LRes91740,LFla46658,LDot64032,LCon61180,LMin4315,LSof66957],["Max68687","Res32610","Res91740","Fla46658","Dot64032","Con61180","Min4315","Sof66957"],Sof66957,"Sof66957")

Actual (Unparsed): [[0.1926428, 0.2624244, 0.2437061, 0.3012267]]

Expected (Unparsed): [[0.19264281942027175,0.2624243992538156,0.24370611136032314,0.30122666996558956]]

Actual:   [[0.1927, 0.2625, 0.2438, 0.3013]]

Expected: [[0.1927, 0.2625, 0.2438, 0.3013]]