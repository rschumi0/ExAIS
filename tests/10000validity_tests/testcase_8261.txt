import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot28331 = tf.keras.layers.Input(shape=([2]))
in1Dot28331 = tf.keras.layers.Input(shape=([2]))

Dot28331 = keras.layers.Dot(axes=(1, 1), name = 'Dot28331', )([in0Dot28331,in1Dot28331])
Res32122 = keras.layers.Reshape((1, 1), name = 'Res32122', )(Dot28331)
Res21389 = keras.layers.Reshape((1, 1, 1), name = 'Res21389', )(Res32122)
Max58342 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max58342', )(Res21389)
Max19690 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Max19690', )(Max58342)
Res5078 = keras.layers.Reshape((1, 1), name = 'Res5078', )(Max19690)
Per23444 = keras.layers.Permute((1,2), name = 'Per23444',)(Res5078)
model = tf.keras.models.Model(inputs=[in0Dot28331,in1Dot28331], outputs=Per23444)
in0Dot28331 = tf.constant([[0.0181, 0.6703]])
in1Dot28331 = tf.constant([[0.9727, 0.9919]])
print (np.array2string(model.predict([in0Dot28331,in1Dot28331],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per23444.png')

LDot28331 = dot_layer([[0.0181, 0.6703]], [[0.9727, 0.9919]], 1, 1, Dot28331), 
LRes32122 = reshape_layer(Dot28331, [1, 1], Res32122), 
LRes21389 = reshape_layer(Res32122, [1, 1, 1], Res21389), 
LMax58342 = max_pool2D_layer(Res21389, 1, 1, Max58342), 
LMax19690 = max_pool2D_layer(Max58342, 1, 1, 1, 1, true, Max19690), 
LRes5078 = reshape_layer(Max19690, [1, 1], Res5078), 
LPer23444 = permute_layer(Res5078, 1,2, Per23444), 
exec_layers([LDot28331,LRes32122,LRes21389,LMax58342,LMax19690,LRes5078,LPer23444],["Dot28331","Res32122","Res21389","Max58342","Max19690","Res5078","Per23444"],Per23444,"Per23444")

Actual (Unparsed): [[[0.6824765]]]

Expected (Unparsed): [[[0.6824764400000001]]]

Actual:   [[[0.6825]]]

Expected: [[[0.6825]]]