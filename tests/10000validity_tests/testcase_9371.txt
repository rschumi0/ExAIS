import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max66039 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Max66039 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0PRe18377 = tf.keras.layers.Input(shape=([1, 2]))

Max66039 = keras.layers.Maximum(name = 'Max66039', )([in0Max66039,in1Max66039])
ReL9897 = keras.layers.ReLU(max_value=8.39669968443734, negative_slope=6.071540655917106, threshold=9.900837886546809, name = 'ReL9897', )(Max66039)
Res35583 = keras.layers.Reshape((1, 2, 4), name = 'Res35583', )(ReL9897)
Res47178 = keras.layers.Reshape((1, 8), name = 'Res47178', )(Res35583)
Sep54649 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep54649', )(Res47178)
PRe18377 = keras.layers.PReLU(name = 'PRe18377', input_shape=(1, 2))(in0PRe18377)
Dot87966 = keras.layers.Dot(axes=(1, 1), name = 'Dot87966', )([Sep54649,PRe18377])
Res58441 = keras.layers.Reshape((4, 2, 1), name = 'Res58441', )(Dot87966)
Res25346 = keras.layers.Reshape((4, 2, 1, 1), name = 'Res25346', )(Res58441)
Glo46812 = keras.layers.GlobalAveragePooling3D(name = 'Glo46812', )(Res25346)
model = tf.keras.models.Model(inputs=[in0Max66039,in1Max66039,in0PRe18377], outputs=Glo46812)
w = model.get_layer('Sep54649').get_weights() 
w[0] = np.array([[[0.0673], [0.1031], [0.2679], [0.1583], [0.1531], [0.9157], [0.5537], [0.7409]]])
w[1] = np.array([[[0.9108, 0.3117, 0.8153, 0.8687], [0.9812, 0.2866, 0.8858, 0.3625], [0.1133, 0.1834, 0.2947, 0.4391], [0.5395, 0.8741, 0.5958, 0.579], [0.865, 0.4922, 0.1568, 0.1769], [0.3533, 0.1682, 0.8912, 0.3468], [0.5916, 0.4301, 0.0903, 0.7113], [0.1454, 0.192, 0.9333, 0.7034]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep54649').set_weights(w) 
w = model.get_layer('PRe18377').get_weights() 
w[0] = np.array([[0.9705, 0.5711]])
model.get_layer('PRe18377').set_weights(w) 
in0Max66039 = tf.constant([[[[[0.4981, 0.9926], [0.1648, 0.4778]], [[0.0953, 0.3474], [0.4278, 0.2343]]]]])
in1Max66039 = tf.constant([[[[[0.1493, 0.9931], [0.5676, 0.5174]], [[0.3758, 0.8627], [0.8697, 0.1988]]]]])
in0PRe18377 = tf.constant([[[0.5553, 0.6907]]])
print (np.array2string(model.predict([in0Max66039,in1Max66039,in0PRe18377],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo46812.png')

LMax66039 = maximum_layer([[[[[[0.4981, 0.9926], [0.1648, 0.4778]], [[0.0953, 0.3474], [0.4278, 0.2343]]]]], [[[[[0.1493, 0.9931], [0.5676, 0.5174]], [[0.3758, 0.8627], [0.8697, 0.1988]]]]]], Max66039), 
LReL9897 = relu_layer(Max66039, 8.39669968443734, 6.071540655917106, 9.900837886546809, ReL9897), 
LRes35583 = reshape_layer(ReL9897, [1, 2, 4], Res35583), 
LRes47178 = reshape_layer(Res35583, [1, 8], Res47178), 
LSep54649 = separable_conv1D_layer(Res47178, 1,[[[[0.0673], [0.1031], [0.2679], [0.1583], [0.1531], [0.9157], [0.5537], [0.7409]]],[[[0.9108, 0.3117, 0.8153, 0.8687], [0.9812, 0.2866, 0.8858, 0.3625], [0.1133, 0.1834, 0.2947, 0.4391], [0.5395, 0.8741, 0.5958, 0.579], [0.865, 0.4922, 0.1568, 0.1769], [0.3533, 0.1682, 0.8912, 0.3468], [0.5916, 0.4301, 0.0903, 0.7113], [0.1454, 0.192, 0.9333, 0.7034]]]],[0, 0, 0, 0], 1, true, Sep54649), 
LPRe18377 = prelu_layer([[[0.5553, 0.6907]]], [[0.9705, 0.5711]], PRe18377), 
LDot87966 = dot_layer(Sep54649,PRe18377, 1, 1, Dot87966), 
LRes58441 = reshape_layer(Dot87966, [4, 2, 1], Res58441), 
LRes25346 = reshape_layer(Res58441, [4, 2, 1, 1], Res25346), 
LGlo46812 = global_average_pooling3D_layer(Res25346, Glo46812), 
exec_layers([LMax66039,LReL9897,LRes35583,LRes47178,LSep54649,LPRe18377,LDot87966,LRes58441,LRes25346,LGlo46812],["Max66039","ReL9897","Res35583","Res47178","Sep54649","PRe18377","Dot87966","Res58441","Res25346","Glo46812"],Glo46812,"Glo46812")

Actual (Unparsed): [[-48.0907746]]

Expected (Unparsed): [[-48.090774972433046]]

Actual:   [[-48.0907]]

Expected: [[-48.0907]]