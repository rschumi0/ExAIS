import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_1807 = tf.keras.layers.Input(shape=([2, 4, 4, 3]))

Up_1807 = keras.layers.UpSampling3D(size=(2, 2, 1), name = 'Up_1807', )(in0Up_1807)
Res45773 = keras.layers.Reshape((4, 8, 12), name = 'Res45773', )(Up_1807)
Dep10146 = keras.layers.DepthwiseConv2D((2, 4),strides=(2, 2), padding='valid', name = 'Dep10146', )(Res45773)
model = tf.keras.models.Model(inputs=[in0Up_1807], outputs=Dep10146)
w = model.get_layer('Dep10146').get_weights() 
w[0] = np.array([[[[0.278], [0.7808], [0.6005], [0.3232], [0.5968], [0.7002], [0.1672], [0.5627], [0.3526], [0.1435], [0.4536], [0.7637]], [[0.6196], [0.648], [0.4279], [0.5161], [0.7837], [0.4387], [0.4952], [0.1796], [0.2041], [0.1269], [0.3443], [0.295]], [[0.3338], [0.2238], [0.9208], [0.7849], [0.1611], [0.4356], [0.8206], [0.7349], [0.5188], [0.4965], [0.8508], [0.7342]], [[0.2791], [0.1162], [0.2422], [0.4609], [0.7041], [0.4748], [0.0127], [0.4431], [0.2513], [0.5753], [0.2788], [0.7025]]], [[[0.9501], [0.6867], [0.893], [0.2886], [0.0577], [0.0493], [0.6431], [0.5539], [0.0796], [0.9987], [0.3926], [0.3835]], [[0.3982], [0.6665], [0.9642], [0.4965], [0.6889], [0.4628], [0.271], [0.364], [0.0257], [0.6106], [0.1873], [0.2508]], [[0.0769], [0.1098], [0.9158], [0.3841], [0.0758], [0.6389], [0.158], [0.2723], [0.313], [0.0688], [0.2204], [0.756]], [[0.7421], [0.4601], [0.3032], [0.4598], [0.9182], [0.641], [0.6071], [0.9292], [0.893], [0.724], [0.5674], [0.891]]]])
w[1] = np.array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0])
model.get_layer('Dep10146').set_weights(w) 
in0Up_1807 = tf.constant([[[[[1.4885, 1.0093, 1.3371], [1.527, 1.3617, 1.2958], [1.1216, 1.8639, 1.2103], [1.5028, 1.5506, 1.6571]], [[1.8229, 1.7506, 1.4708], [1.0538, 1.4719, 1.118], [1.0514, 1.8384, 1.4625], [1.1654, 1.7902, 1.8519]], [[1.8139, 1.9481, 1.3715], [1.4536, 1.4324, 1.0584], [1.4351, 1.078, 1.0677], [1.865, 1.9477, 1.3966]], [[1.9388, 1.6539, 1.6668], [1.461, 1.1581, 1.8185], [1.1339, 1.4709, 1.9896], [1.5931, 1.7416, 1.4904]]], [[[1.5342, 1.0814, 1.6828], [1.5183, 1.6532, 1.4906], [1.0078, 1.8046, 1.8093], [1.5513, 1.5896, 1.2056]], [[1.0382, 1.0736, 1.5328], [1.6678, 1.4431, 1.4745], [1.4438, 1.6415, 1.4487], [1.8929, 1.0288, 1.336]], [[1.5476, 1.2042, 1.6836], [1.2537, 1.4235, 1.8441], [1.096, 1.3622, 1.1488], [1.8558, 1.396, 1.5988]], [[1.6159, 1.9863, 1.0543], [1.1426, 1.4866, 1.9745], [1.5594, 1.0314, 1.7215], [1.398, 1.8815, 1.2544]]]]])
print (np.array2string(model.predict([in0Up_1807],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep10146.png')

LUp_1807 = up_sampling3D_layer([[[[[1.4885, 1.0093, 1.3371], [1.527, 1.3617, 1.2958], [1.1216, 1.8639, 1.2103], [1.5028, 1.5506, 1.6571]], [[1.8229, 1.7506, 1.4708], [1.0538, 1.4719, 1.118], [1.0514, 1.8384, 1.4625], [1.1654, 1.7902, 1.8519]], [[1.8139, 1.9481, 1.3715], [1.4536, 1.4324, 1.0584], [1.4351, 1.078, 1.0677], [1.865, 1.9477, 1.3966]], [[1.9388, 1.6539, 1.6668], [1.461, 1.1581, 1.8185], [1.1339, 1.4709, 1.9896], [1.5931, 1.7416, 1.4904]]], [[[1.5342, 1.0814, 1.6828], [1.5183, 1.6532, 1.4906], [1.0078, 1.8046, 1.8093], [1.5513, 1.5896, 1.2056]], [[1.0382, 1.0736, 1.5328], [1.6678, 1.4431, 1.4745], [1.4438, 1.6415, 1.4487], [1.8929, 1.0288, 1.336]], [[1.5476, 1.2042, 1.6836], [1.2537, 1.4235, 1.8441], [1.096, 1.3622, 1.1488], [1.8558, 1.396, 1.5988]], [[1.6159, 1.9863, 1.0543], [1.1426, 1.4866, 1.9745], [1.5594, 1.0314, 1.7215], [1.398, 1.8815, 1.2544]]]]], 2, 2, 1, Up_1807), 
LRes45773 = reshape_layer(Up_1807, [4, 8, 12], Res45773), 
LDep10146 = depthwise_conv2D_layer(Res45773, 2, 4,[[[[0.278], [0.7808], [0.6005], [0.3232], [0.5968], [0.7002], [0.1672], [0.5627], [0.3526], [0.1435], [0.4536], [0.7637]], [[0.6196], [0.648], [0.4279], [0.5161], [0.7837], [0.4387], [0.4952], [0.1796], [0.2041], [0.1269], [0.3443], [0.295]], [[0.3338], [0.2238], [0.9208], [0.7849], [0.1611], [0.4356], [0.8206], [0.7349], [0.5188], [0.4965], [0.8508], [0.7342]], [[0.2791], [0.1162], [0.2422], [0.4609], [0.7041], [0.4748], [0.0127], [0.4431], [0.2513], [0.5753], [0.2788], [0.7025]]], [[[0.9501], [0.6867], [0.893], [0.2886], [0.0577], [0.0493], [0.6431], [0.5539], [0.0796], [0.9987], [0.3926], [0.3835]], [[0.3982], [0.6665], [0.9642], [0.4965], [0.6889], [0.4628], [0.271], [0.364], [0.0257], [0.6106], [0.1873], [0.2508]], [[0.0769], [0.1098], [0.9158], [0.3841], [0.0758], [0.6389], [0.158], [0.2723], [0.313], [0.0688], [0.2204], [0.756]], [[0.7421], [0.4601], [0.3032], [0.4598], [0.9182], [0.641], [0.6071], [0.9292], [0.893], [0.724], [0.5674], [0.891]]]],[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], 2, 2, false, Dep10146), 
exec_layers([LUp_1807,LRes45773,LDep10146],["Up_1807","Res45773","Dep10146"],Dep10146,"Dep10146")

Actual (Unparsed): [[[[5.9532327, 4.4007435, 7.3617815, 4.6825846, 5.6330286, 4.5881212, 3.4487601, 7.4689195, 3.6912648, 4.9978180, 5.5689462, 8.5161742], [6.6913746, 6.6427453, 7.5110536, 4.7493807, 5.7939965, 4.1640316, 3.9513958, 5.6172126, 3.0780570, 5.6680815, 6.2010576, 7.4419621], [6.8500057, 6.9244978, 7.9279181, 5.4142795, 5.1999976, 5.7304791, 4.0748609, 5.2897022, 4.6384659, 6.4761347, 6.0228850, 6.9603902]], [[4.9322583, 3.9853236, 8.5070173, 5.9515282, 6.1995333, 5.6905778, 3.8965665, 6.9019462, 4.0605325, 6.4454800, 4.1627720, 6.1609039], [4.5477019, 4.0824570, 8.4333826, 5.3290312, 5.7161890, 6.4735316, 4.0279970, 5.9665732, 3.2291831, 7.0184089, 4.0941711, 7.1920673], [5.7895622, 5.1574188, 7.3695385, 4.4242017, 5.7918135, 7.3693563, 4.2203888, 4.7157407, 4.1623618, 6.0950581, 5.5309969, 6.5749616]]]]

Expected (Unparsed): [[[[5.953232659999999,4.40074354,7.36178136,4.68258466,5.63302855,4.588121200000001,3.44876016,7.46891958,3.69126485,4.997818,5.56894616,8.51617433],[6.69137452,6.642745389999999,7.51105348,4.74938064,5.793996569999999,4.164031520000001,3.9513959400000003,5.61721268,3.0780569700000004,5.66808138,6.20105754,7.44196212],[6.8500057299999995,6.924497809999999,7.927917999999999,5.414279540000001,5.199997559999999,5.73047895,4.07486091,5.28970215,4.63846596,6.476134760000001,6.022884899999999,6.96039028]],[[4.932258359999999,3.98532344,8.507017280000001,5.95152818,6.19953324,5.69057795,3.8965666199999998,6.9019461699999995,4.06053267,6.44547995,4.1627719999999995,6.160904],[4.54770182,4.08245678,8.43338288,5.32903121,5.71618921,6.47353173,4.0279971,5.9665732,3.2291830800000003,7.01840881,4.09417104,7.19206756],[5.789562050000001,5.15741877,7.369538760000001,4.4242015,5.7918135699999995,7.369356450000001,4.22038896,4.71574074,4.1623617500000005,6.0950580599999995,5.5309969,6.5749616799999995]]]]

Actual:   [[[[5.9533, 4.4008, 7.3618, 4.6826, 5.6331, 4.5882, 3.4488, 7.469, 3.6913, 4.9979, 5.569, 8.5162], [6.6914, 6.6428, 7.5111, 4.7494, 5.794, 4.1641, 3.9514, 5.6173, 3.0781, 5.6681, 6.2011, 7.442], [6.8501, 6.9245, 7.928, 5.4143, 5.2, 5.7305, 4.0749, 5.2898, 4.6385, 6.4762, 6.0229, 6.9604]], [[4.9323, 3.9854, 8.5071, 5.9516, 6.1996, 5.6906, 3.8966, 6.902, 4.0606, 6.4455, 4.1628, 6.161], [4.5478, 4.0825, 8.4334, 5.3291, 5.7162, 6.4736, 4.028, 5.9666, 3.2292, 7.0185, 4.0942, 7.1921], [5.7896, 5.1575, 7.3696, 4.4243, 5.7919, 7.3694, 4.2204, 4.7158, 4.1624, 6.0951, 5.531, 6.575]]]]

Expected: [[[[5.9533, 4.4008, 7.3618, 4.6826, 5.6331, 4.5882, 3.4488, 7.469, 3.6913, 4.9979, 5.569, 8.5162], [6.6914, 6.6428, 7.5111, 4.7494, 5.794, 4.1641, 3.9514, 5.6173, 3.0781, 5.6681, 6.2011, 7.442], [6.8501, 6.9245, 7.928, 5.4143, 5.2, 5.7305, 4.0749, 5.2898, 4.6385, 6.4762, 6.0229, 6.9604]], [[4.9323, 3.9854, 8.5071, 5.9516, 6.1996, 5.6906, 3.8966, 6.902, 4.0606, 6.4455, 4.1628, 6.161], [4.5478, 4.0825, 8.4334, 5.3291, 5.7162, 6.4736, 4.028, 5.9666, 3.2292, 7.0185, 4.0942, 7.1921], [5.7896, 5.1575, 7.3696, 4.4243, 5.7919, 7.3694, 4.2204, 4.7158, 4.1624, 6.0951, 5.531, 6.575]]]]