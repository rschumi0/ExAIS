import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU59559 = tf.keras.layers.Input(shape=([3, 2]))

GRU59559 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU59559', )(in0GRU59559)
Lay90992 = keras.layers.LayerNormalization(axis=1, epsilon=1.8778332589644395, name = 'Lay90992', )(GRU59559)
model = tf.keras.models.Model(inputs=[in0GRU59559], outputs=Lay90992)
w = model.get_layer('GRU59559').get_weights() 
w[0] = np.array([[4, 5, 7, 8, 9, 4], [3, 1, 8, 2, 2, 7]])
w[1] = np.array([[4, 8, 6, 9, 9, 5], [3, 8, 9, 1, 4, 9]])
w[2] = np.array([[6, 8, 5, 2, 5, 6], [2, 5, 6, 5, 7, 9]])
model.get_layer('GRU59559').set_weights(w) 
in0GRU59559 = tf.constant([[[9, 4], [9, 3], [6, 2]]])
print (np.array2string(model.predict([in0GRU59559],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay90992.png')

LGRU59559 = gru_layer([[[9, 4], [9, 3], [6, 2]]],[[4, 5, 7, 8, 9, 4], [3, 1, 8, 2, 2, 7]],[[4, 8, 6, 9, 9, 5], [3, 8, 9, 1, 4, 9]],[[6, 8, 5, 2, 5, 6], [2, 5, 6, 5, 7, 9]], true, GRU59559), 
LLay90992 = layer_normalization_layer(GRU59559, 1, 1.8778332589644395, Lay90992), 
exec_layers([LGRU59559,LLay90992],["GRU59559","Lay90992"],Lay90992,"Lay90992")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[0.0,0.0]]

Actual:   [[0, 0]]

Expected: [[0, 0]]