import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub2531 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub2531 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Glo14896 = tf.keras.layers.Input(shape=([1, 1]))
in0Con86149 = tf.keras.layers.Input(shape=([26]))

Sub2531 = keras.layers.Subtract(name = 'Sub2531', )([in0Sub2531,in1Sub2531])
Res72053 = keras.layers.Reshape((3, 9), name = 'Res72053', )(Sub2531)
Fla67246 = keras.layers.Flatten(name = 'Fla67246', )(Res72053)
Glo14896 = keras.layers.GlobalAveragePooling1D(name = 'Glo14896', )(in0Glo14896)
Con86149 = keras.layers.Concatenate(axis=1, name = 'Con86149', )([Glo14896,in0Con86149])
Add13987 = keras.layers.Add(name = 'Add13987', )([Fla67246,Con86149])
model = tf.keras.models.Model(inputs=[in0Sub2531,in1Sub2531,in0Glo14896,in0Con86149], outputs=Add13987)
in0Sub2531 = tf.constant([[[[0.8457, 0.333, 0.5468], [0.5615, 0.6914, 0.7661], [0.4534, 0.311, 0.507]], [[0.7061, 0.9329, 0.8635], [0.8703, 0.6343, 0.8667], [0.4323, 0.3787, 0.8168]], [[0.0622, 0.307, 0.0134], [0.9518, 0.9099, 0.6702], [0.4899, 0.6579, 0.1999]]]])
in1Sub2531 = tf.constant([[[[0.1526, 0.3609, 0.1332], [0.3321, 0.562, 0.8913], [0.1643, 0.1695, 0.4695]], [[0.7568, 0.5502, 0.0823], [0.1056, 0.4296, 0.9193], [0.3091, 0.3284, 0.7108]], [[0.8644, 0.6232, 0.2619], [0.2452, 0.3008, 0.4317], [0.5678, 0.0108, 0.9561]]]])
in0Glo14896 = tf.constant([[[1.8595]]])
in0Con86149 = tf.constant([[0.4908, 0.5289, 0.7143, 0.8314, 0.7085, 0.0365, 0.4085, 0.3687, 0.1786, 0.117, 0.9578, 0.9369, 0.9982, 0.8075, 0.592, 0.3139, 0.6094, 0.6512, 0.4794, 0.7344, 0.703, 0.721, 0.2319, 0.3014, 0.3782, 0.2301]])
print (np.array2string(model.predict([in0Sub2531,in1Sub2531,in0Glo14896,in0Con86149],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add13987.png')

LSub2531 = subtract_layer([[[[0.8457, 0.333, 0.5468], [0.5615, 0.6914, 0.7661], [0.4534, 0.311, 0.507]], [[0.7061, 0.9329, 0.8635], [0.8703, 0.6343, 0.8667], [0.4323, 0.3787, 0.8168]], [[0.0622, 0.307, 0.0134], [0.9518, 0.9099, 0.6702], [0.4899, 0.6579, 0.1999]]]], [[[[0.1526, 0.3609, 0.1332], [0.3321, 0.562, 0.8913], [0.1643, 0.1695, 0.4695]], [[0.7568, 0.5502, 0.0823], [0.1056, 0.4296, 0.9193], [0.3091, 0.3284, 0.7108]], [[0.8644, 0.6232, 0.2619], [0.2452, 0.3008, 0.4317], [0.5678, 0.0108, 0.9561]]]], Sub2531), 
LRes72053 = reshape_layer(Sub2531, [3, 9], Res72053), 
LFla67246 = flatten_layer(Res72053, Fla67246), 
LGlo14896 = global_average_pooling1D_layer([[[1.8595]]], Glo14896), 
LCon86149 = concatenate_layer([Glo14896,[[0.4908, 0.5289, 0.7143, 0.8314, 0.7085, 0.0365, 0.4085, 0.3687, 0.1786, 0.117, 0.9578, 0.9369, 0.9982, 0.8075, 0.592, 0.3139, 0.6094, 0.6512, 0.4794, 0.7344, 0.703, 0.721, 0.2319, 0.3014, 0.3782, 0.2301]]], 1, Con86149), 
LAdd13987 = add_layer([Fla67246,Con86149], Add13987), 
exec_layers([LSub2531,LRes72053,LFla67246,LGlo14896,LCon86149,LAdd13987],["Sub2531","Res72053","Fla67246","Glo14896","Con86149","Add13987"],Add13987,"Add13987")

Actual (Unparsed): [[2.5526001, 0.4629000, 0.9425000, 0.9437000, 0.9608000, 0.5833000, 0.3256000, 0.5500000, 0.4062000, 0.1279000, 0.4997000, 1.7390000, 1.7016000, 1.2029000, 0.7549000, 0.7152000, 0.3642000, 0.7154000, -0.1510000, 0.1632000, 0.4859000, 1.4096000, 1.3301000, 0.4704000, 0.2235000, 1.0253000, -0.5261000]]

Expected (Unparsed): [[2.5526,0.46290000000000003,0.9425,0.9437,0.9608,0.5833,0.3256,0.5499999999999999,0.40620000000000006,0.12789999999999993,0.4996999999999999,1.7389999999999999,1.7016,1.2029,0.7549,0.7152000000000001,0.36419999999999997,0.7154,-0.1509999999999999,0.1632,0.4859,1.4096,1.3300999999999998,0.47040000000000004,0.22350000000000003,1.0253,-0.5261]]

Actual:   [[2.5527, 0.4629, 0.9425, 0.9437, 0.9608, 0.5833, 0.3256, 0.55, 0.4062, 0.1279, 0.4997, 1.739, 1.7016, 1.2029, 0.7549, 0.7152, 0.3642, 0.7154, -0.151, 0.1632, 0.4859, 1.4096, 1.3301, 0.4704, 0.2235, 1.0253, -0.5261]]

Expected: [[2.5526, 0.463, 0.9425, 0.9437, 0.9608, 0.5833, 0.3256, 0.55, 0.4063, 0.1279, 0.4997, 1.739, 1.7016, 1.2029, 0.7549, 0.7153, 0.3642, 0.7154, -0.1509, 0.1632, 0.4859, 1.4096, 1.3301, 0.4705, 0.2236, 1.0253, -0.5261]]