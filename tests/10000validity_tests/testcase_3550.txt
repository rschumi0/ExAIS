import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul76488 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul76488 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Max28855 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max28855 = tf.keras.layers.Input(shape=([1, 1, 1]))

Mul76488 = keras.layers.Multiply(name = 'Mul76488', )([in0Mul76488,in1Mul76488])
Max28855 = keras.layers.Maximum(name = 'Max28855', )([in0Max28855,in1Max28855])
Zer83968 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer83968', )(Max28855)
Add9363 = keras.layers.Add(name = 'Add9363', )([Mul76488,Zer83968])
Res34517 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res34517', )(Add9363)
Con51516 = keras.layers.Conv3D(2, (1, 1, 1),strides=(1, 1, 6), padding='valid', dilation_rate=(1, 1, 1), name = 'Con51516', )(Res34517)
Res54342 = keras.layers.Reshape((1, 2, 2), name = 'Res54342', )(Con51516)
Con3023 = keras.layers.Conv2D(3, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con3023', )(Res54342)
model = tf.keras.models.Model(inputs=[in0Mul76488,in1Mul76488,in0Max28855,in1Max28855], outputs=Con3023)
w = model.get_layer('Con51516').get_weights() 
w[0] = np.array([[[[[0.7525, 0.7119]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con51516').set_weights(w) 
w = model.get_layer('Con3023').get_weights() 
w[0] = np.array([[[[0.0911, 0.522, 0.672], [0.264, 0.9757, 0.0788]], [[0.1816, 0.9258, 0.8211], [0.5789, 0.522, 0.6707]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con3023').set_weights(w) 
in0Mul76488 = tf.constant([[[[0.3421], [0.9218]]]])
in1Mul76488 = tf.constant([[[[0.8663], [0.7523]]]])
in0Max28855 = tf.constant([[[[0.7109]]]])
in1Max28855 = tf.constant([[[[0.1574]]]])
print (np.array2string(model.predict([in0Mul76488,in1Mul76488,in0Max28855,in1Max28855],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con3023.png')

LMul76488 = multiply_layer([[[[[0.3421], [0.9218]]]], [[[[0.8663], [0.7523]]]]], Mul76488), 
LMax28855 = maximum_layer([[[[[0.7109]]]], [[[[0.1574]]]]], Max28855), 
LZer83968 = zero_padding2D_layer(Max28855, 0, 0, 1, 0, Zer83968), 
LAdd9363 = add_layer([Mul76488,Zer83968], Add9363), 
LRes34517 = reshape_layer(Add9363, [1, 2, 1, 1], Res34517), 
LCon51516 = conv3D_layer(Res34517, 1, 1, 1,[[[[[0.7525, 0.7119]]]]],[0, 0], 1, 1, 6, false, 1, 1, 1, Con51516), 
LRes54342 = reshape_layer(Con51516, [1, 2, 2], Res54342), 
LCon3023 = conv2D_layer(Res54342, 1, 2,[[[[0.0911, 0.522, 0.672], [0.264, 0.9757, 0.0788]], [[0.1816, 0.9258, 0.8211], [0.5789, 0.522, 0.6707]]]],[0, 0, 0], 1, 1, false, 1, 1, Con3023), 
exec_layers([LMul76488,LMax28855,LZer83968,LAdd9363,LRes34517,LCon51516,LRes54342,LCon3023],["Mul76488","Max28855","Zer83968","Add9363","Res34517","Con51516","Res54342","Con3023"],Con3023,"Con3023")

Actual (Unparsed): [[[[0.8466953, 1.8225203, 1.7047647]]]]

Expected (Unparsed): [[[[0.8466952694989578,1.8225202662776527,1.7047646769142668]]]]

Actual:   [[[[0.8467, 1.8226, 1.7048]]]]

Expected: [[[[0.8467, 1.8226, 1.7048]]]]