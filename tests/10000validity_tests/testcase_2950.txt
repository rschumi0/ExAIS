import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo85742 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Dot71838 = tf.keras.layers.Input(shape=([3]))
in1Dot71838 = tf.keras.layers.Input(shape=([3]))

Glo85742 = keras.layers.GlobalAveragePooling2D(name = 'Glo85742', )(in0Glo85742)
Dot71838 = keras.layers.Dot(axes=(1, 1), name = 'Dot71838', )([in0Dot71838,in1Dot71838])
Mul46594 = keras.layers.Multiply(name = 'Mul46594', )([Glo85742,Dot71838])
Res82475 = keras.layers.Reshape((1, 1), name = 'Res82475', )(Mul46594)
Res29848 = keras.layers.Reshape((1, 1, 1), name = 'Res29848', )(Res82475)
Res64596 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res64596', )(Res29848)
Con7933 = keras.layers.Conv3DTranspose(4, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con7933', )(Res64596)
Sof48519 = keras.layers.Softmax(axis=1, name = 'Sof48519', )(Con7933)
model = tf.keras.models.Model(inputs=[in0Glo85742,in0Dot71838,in1Dot71838], outputs=Sof48519)
w = model.get_layer('Con7933').get_weights() 
w[0] = np.array([[[[[0.5794], [0.099], [0.2315], [0.1667]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con7933').set_weights(w) 
in0Glo85742 = tf.constant([[[[1.0566]], [[1.0373]]]])
in0Dot71838 = tf.constant([[0.4585, 0.9602, 0.9712]])
in1Dot71838 = tf.constant([[0.7479, 0.4909, 0.5935]])
print (np.array2string(model.predict([in0Glo85742,in0Dot71838,in1Dot71838],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof48519.png')

LGlo85742 = global_average_pooling2D_layer([[[[1.0566]], [[1.0373]]]], Glo85742), 
LDot71838 = dot_layer([[0.4585, 0.9602, 0.9712]], [[0.7479, 0.4909, 0.5935]], 1, 1, Dot71838), 
LMul46594 = multiply_layer([Glo85742,Dot71838], Mul46594), 
LRes82475 = reshape_layer(Mul46594, [1, 1], Res82475), 
LRes29848 = reshape_layer(Res82475, [1, 1, 1], Res29848), 
LRes64596 = reshape_layer(Res29848, [1, 1, 1, 1], Res64596), 
LCon7933 = conv3D_transpose_layer(Res64596, 1, 1, 1,[[[[[0.5794], [0.099], [0.2315], [0.1667]]]]],[0, 0, 0, 0], 1, 1, 1, false, Con7933), 
LSof48519 = softmax_layer(Con7933, 1, Sof48519), 
exec_layers([LGlo85742,LDot71838,LMul46594,LRes82475,LRes29848,LRes64596,LCon7933,LSof48519],["Glo85742","Dot71838","Mul46594","Res82475","Res29848","Res64596","Con7933","Sof48519"],Sof48519,"Sof48519")

Actual (Unparsed): [[[[[1.0000000, 1.0000000, 1.0000000, 1.0000000]]]]]

Expected (Unparsed): [[[[[1.0,1.0,1.0,1.0]]]]]

Actual:   [[[[[1, 1, 1, 1]]]]]

Expected: [[[[[1, 1, 1, 1]]]]]