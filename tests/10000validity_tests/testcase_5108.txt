import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max90450 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Max90450 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Max90450 = keras.layers.Maximum(name = 'Max90450', )([in0Max90450,in1Max90450])
Lea93837 = keras.layers.LeakyReLU(alpha=1.3079099034731008, name = 'Lea93837', )(Max90450)
Res96048 = keras.layers.Reshape((1, 1, 4), name = 'Res96048', )(Lea93837)
Res374 = keras.layers.Reshape((1, 4), name = 'Res374', )(Res96048)
Con70161 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con70161', )(Res374)
model = tf.keras.models.Model(inputs=[in0Max90450,in1Max90450], outputs=Con70161)
w = model.get_layer('Con70161').get_weights() 
w[0] = np.array([[[0.0876, 0.2826, 0.3932, 0.9363], [0.2906, 0.7569, 0.5737, 0.7885], [0.1388, 0.155, 0.4769, 0.744], [0.4616, 0.7355, 0.6408, 0.7347]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con70161').set_weights(w) 
in0Max90450 = tf.constant([[[[[0.6799, 0.8928], [0.0414, 0.6478]]]]])
in1Max90450 = tf.constant([[[[[0.279, 0.7593], [0.6912, 0.1937]]]]])
print (np.array2string(model.predict([in0Max90450,in1Max90450],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con70161.png')

LMax90450 = maximum_layer([[[[[[0.6799, 0.8928], [0.0414, 0.6478]]]]], [[[[[0.279, 0.7593], [0.6912, 0.1937]]]]]], Max90450), 
LLea93837 = leaky_relu_layer(Max90450, 1.3079099034731008, Lea93837), 
LRes96048 = reshape_layer(Lea93837, [1, 1, 4], Res96048), 
LRes374 = reshape_layer(Res96048, [1, 4], Res374), 
LCon70161 = conv1D_layer(Res374, 1,[[[0.0876, 0.2826, 0.3932, 0.9363], [0.2906, 0.7569, 0.5737, 0.7885], [0.1388, 0.155, 0.4769, 0.744], [0.4616, 0.7355, 0.6408, 0.7347]]],[0, 0, 0, 0], 1, true, 1, Con70161), 
exec_layers([LMax90450,LLea93837,LRes96048,LRes374,LCon70161],["Max90450","Lea93837","Res96048","Res374","Con70161"],Con70161,"Con70161")

Actual (Unparsed): [[[0.7139700, 1.4514930, 1.5242796, 2.3307546]]]

Expected (Unparsed): [[[0.71396996,1.4514929600000002,1.52427956,2.3307546300000004]]]

Actual:   [[[0.714, 1.4515, 1.5243, 2.3308]]]

Expected: [[[0.714, 1.4515, 1.5243, 2.3308]]]