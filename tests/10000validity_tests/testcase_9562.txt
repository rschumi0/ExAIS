import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per17089 = tf.keras.layers.Input(shape=([2, 1]))
in0Con19885 = tf.keras.layers.Input(shape=([7]))
in0Fla59164 = tf.keras.layers.Input(shape=([3, 3, 1]))

Per17089 = keras.layers.Permute((2,1), name = 'Per17089',)(in0Per17089)
Fla70540 = keras.layers.Flatten(name = 'Fla70540', )(Per17089)
Con19885 = keras.layers.Concatenate(axis=1, name = 'Con19885', )([Fla70540,in0Con19885])
Fla59164 = keras.layers.Flatten(name = 'Fla59164', )(in0Fla59164)
Sub34002 = keras.layers.Subtract(name = 'Sub34002', )([Con19885,Fla59164])
ELU75185 = keras.layers.ELU(alpha=9.625944996775068, name = 'ELU75185', )(Sub34002)
model = tf.keras.models.Model(inputs=[in0Per17089,in0Con19885,in0Fla59164], outputs=ELU75185)
in0Per17089 = tf.constant([[[1.2781], [1.5542]]])
in0Con19885 = tf.constant([[0.0752, 0.4148, 0.8191, 0.4692, 0.9174, 0.8844, 0.7243]])
in0Fla59164 = tf.constant([[[[1.3609], [1.5554], [1.6893]], [[1.1457], [1.6937], [1.0349]], [[1.4504], [1.7887], [1.7654]]]])
print (np.array2string(model.predict([in0Per17089,in0Con19885,in0Fla59164],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU75185.png')

LPer17089 = permute_layer([[[1.2781], [1.5542]]], 2,1, Per17089), 
LFla70540 = flatten_layer(Per17089, Fla70540), 
LCon19885 = concatenate_layer([Fla70540,[[0.0752, 0.4148, 0.8191, 0.4692, 0.9174, 0.8844, 0.7243]]], 1, Con19885), 
LFla59164 = flatten_layer([[[[1.3609], [1.5554], [1.6893]], [[1.1457], [1.6937], [1.0349]], [[1.4504], [1.7887], [1.7654]]]], Fla59164), 
LSub34002 = subtract_layer(Con19885,Fla59164, Sub34002), 
LELU75185 = elu_layer(Sub34002, 9.625944996775068, ELU75185), 
exec_layers([LPer17089,LFla70540,LCon19885,LFla59164,LSub34002,LELU75185],["Per17089","Fla70540","Con19885","Fla59164","Sub34002","ELU75185"],ELU75185,"ELU75185")

Actual (Unparsed): [[-0.7649237, -0.0115438, -7.7097104, -4.9912886, -5.6116485, -4.1587697, -3.9770381, -5.7291201, -6.2273503]]

Expected (Unparsed): [[-0.7649234488143387,-0.011544206087171877,-7.70971050754191,-4.991288633041782,-5.611648726698036,-4.158769848102554,-3.977038100033182,-5.729120239050638,-6.227350180589023]]

Actual:   [[-0.7649, -0.0115, -7.7097, -4.9912, -5.6116, -4.1587, -3.977, -5.7291, -6.2273]]

Expected: [[-0.7649, -0.0115, -7.7097, -4.9912, -5.6116, -4.1587, -3.977, -5.7291, -6.2273]]