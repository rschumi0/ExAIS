import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot31356 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot31356 = tf.keras.layers.Input(shape=([2, 3]))
in0Sub78753 = tf.keras.layers.Input(shape=([2]))
in1Sub78753 = tf.keras.layers.Input(shape=([2]))
in0Con96527 = tf.keras.layers.Input(shape=([2]))

Dot31356 = keras.layers.Dot(axes=(2, 2), name = 'Dot31356', )([in0Dot31356,in1Dot31356])
Fla68157 = keras.layers.Flatten(name = 'Fla68157', )(Dot31356)
Sub78753 = keras.layers.Subtract(name = 'Sub78753', )([in0Sub78753,in1Sub78753])
Con96527 = keras.layers.Concatenate(axis=1, name = 'Con96527', )([Sub78753,in0Con96527])
Ave53136 = keras.layers.Average(name = 'Ave53136', )([Fla68157,Con96527])
model = tf.keras.models.Model(inputs=[in0Dot31356,in1Dot31356,in0Sub78753,in1Sub78753,in0Con96527], outputs=Ave53136)
in0Dot31356 = tf.constant([[[0.2336, 0.4892, 0.0809], [0.7917, 0.7891, 0.6832]]])
in1Dot31356 = tf.constant([[[0.6661, 0.324, 0.1837], [0.8172, 0.4171, 0.4362]]])
in0Sub78753 = tf.constant([[0.1772, 0.5597]])
in1Sub78753 = tf.constant([[0.507, 0.8349]])
in0Con96527 = tf.constant([[0.2397, 0.6088]])
print (np.array2string(model.predict([in0Dot31356,in1Dot31356,in0Sub78753,in1Sub78753,in0Con96527],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave53136.png')

LDot31356 = dot_layer([[[0.2336, 0.4892, 0.0809], [0.7917, 0.7891, 0.6832]]], [[[0.6661, 0.324, 0.1837], [0.8172, 0.4171, 0.4362]]], 2, 2, Dot31356), 
LFla68157 = flatten_layer(Dot31356, Fla68157), 
LSub78753 = subtract_layer([[0.1772, 0.5597]], [[0.507, 0.8349]], Sub78753), 
LCon96527 = concatenate_layer([Sub78753,[[0.2397, 0.6088]]], 1, Con96527), 
LAve53136 = average_layer([Fla68157,Con96527], Ave53136), 
exec_layers([LDot31356,LFla68157,LSub78753,LCon96527,LAve53136],["Dot31356","Fla68157","Sub78753","Con96527","Ave53136"],Ave53136,"Ave53136")

Actual (Unparsed): [[-0.0004185, 0.0775159, 0.5741118, 0.9414613]]

Expected (Unparsed): [[-0.00041845499999998426,0.07751591000000002,0.574111805,0.941461345]]

Actual:   [[-0.0004, 0.0776, 0.5742, 0.9415]]

Expected: [[-0.0004, 0.0776, 0.5742, 0.9415]]