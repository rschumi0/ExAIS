import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot2743 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot2743 = tf.keras.layers.Input(shape=([2, 3]))
in0Min60301 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Min60301 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Dot2743 = keras.layers.Dot(axes=(2, 2), name = 'Dot2743', )([in0Dot2743,in1Dot2743])
Per70219 = keras.layers.Permute((1,2), name = 'Per70219',)(Dot2743)
Res81885 = keras.layers.Reshape((2, 2, 1), name = 'Res81885', )(Per70219)
Res79888 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res79888', )(Res81885)
Zer48582 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer48582', )(Res79888)
Min60301 = keras.layers.Minimum(name = 'Min60301', )([in0Min60301,in1Min60301])
Zer64631 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer64631', )(Min60301)
Mul55802 = keras.layers.Multiply(name = 'Mul55802', )([Zer48582,Zer64631])
model = tf.keras.models.Model(inputs=[in0Dot2743,in1Dot2743,in0Min60301,in1Min60301], outputs=Mul55802)
in0Dot2743 = tf.constant([[[0.2007, 0.3132, 0.2064], [0.4668, 0.7697, 0.1725]]])
in1Dot2743 = tf.constant([[[0.6138, 0.2195, 0.1732], [0.575, 0.7501, 0.9841]]])
in0Min60301 = tf.constant([[[[[0.7601], [0.6217]]]]])
in1Min60301 = tf.constant([[[[[0.1681], [0.1364]]]]])
print (np.array2string(model.predict([in0Dot2743,in1Dot2743,in0Min60301,in1Min60301],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul55802.png')

LDot2743 = dot_layer([[[0.2007, 0.3132, 0.2064], [0.4668, 0.7697, 0.1725]]], [[[0.6138, 0.2195, 0.1732], [0.575, 0.7501, 0.9841]]], 2, 2, Dot2743), 
LPer70219 = permute_layer(Dot2743, 1,2, Per70219), 
LRes81885 = reshape_layer(Per70219, [2, 2, 1], Res81885), 
LRes79888 = reshape_layer(Res81885, [2, 2, 1, 1], Res79888), 
LZer48582 = zero_padding3D_layer(Res79888, 0, 0, 0, 0, 2, 0, Zer48582), 
LMin60301 = minimum_layer([[[[[[0.7601], [0.6217]]]]], [[[[[0.1681], [0.1364]]]]]], Min60301), 
LZer64631 = zero_padding3D_layer(Min60301, 1, 0, 1, 0, 1, 0, Zer64631), 
LMul55802 = multiply_layer([Zer48582,Zer64631], Mul55802), 
exec_layers([LDot2743,LPer70219,LRes81885,LRes79888,LZer48582,LMin60301,LZer64631,LMul55802],["Dot2743","Per70219","Res81885","Res79888","Zer48582","Min60301","Zer64631","Mul55802"],Mul55802,"Mul55802")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.1385168]]]]]

Expected (Unparsed): [[[[[0],[0],[0.0]],[[0],[0],[0.0]]],[[[0],[0],[0.0]],[[0],[0.0],[0.138516821608]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0.1386]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0.1386]]]]]