import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub91550 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub91550 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Mul7752 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul7752 = tf.keras.layers.Input(shape=([2, 2]))
in0Con51618 = tf.keras.layers.Input(shape=([3, 7]))
in0Min23261 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Min23261 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Sub91550 = keras.layers.Subtract(name = 'Sub91550', )([in0Sub91550,in1Sub91550])
Res85982 = keras.layers.Reshape((3, 9), name = 'Res85982', )(Sub91550)
Mul7752 = keras.layers.Multiply(name = 'Mul7752', )([in0Mul7752,in1Mul7752])
Zer12517 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer12517', )(Mul7752)
Con51618 = keras.layers.Concatenate(axis=2, name = 'Con51618', )([Zer12517,in0Con51618])
Ave63110 = keras.layers.Average(name = 'Ave63110', )([Res85982,Con51618])
Res75466 = keras.layers.Reshape((3, 9, 1), name = 'Res75466', )(Ave63110)
Res84637 = keras.layers.Reshape((3, 9, 1, 1), name = 'Res84637', )(Res75466)
Min23261 = keras.layers.Minimum(name = 'Min23261', )([in0Min23261,in1Min23261])
Zer90990 = keras.layers.ZeroPadding3D(padding=((2, 0), (7, 0), (0, 0)), name = 'Zer90990', )(Min23261)
Min56145 = keras.layers.Minimum(name = 'Min56145', )([Res84637,Zer90990])
model = tf.keras.models.Model(inputs=[in0Sub91550,in1Sub91550,in0Mul7752,in1Mul7752,in0Con51618,in0Min23261,in1Min23261], outputs=Min56145)
in0Sub91550 = tf.constant([[[[0.7338, 0.6786, 0.0467], [0.5852, 0.004, 0.7725], [0.3833, 0.9367, 0.4512]], [[0.4136, 0.5118, 0.2083], [0.4269, 0.6087, 0.1156], [0.8082, 0.69, 0.1994]], [[0.3966, 0.2466, 0.743], [0.6595, 0.9368, 0.1717], [0.1604, 0.6536, 0.8781]]]])
in1Sub91550 = tf.constant([[[[0.8047, 0.712, 0.8685], [0.8367, 0.9818, 0.0039], [0.031, 0.4044, 0.5527]], [[0.5636, 0.9533, 0.3077], [0.4537, 0.7842, 0.9122], [0.3014, 0.3804, 0.9049]], [[0.6587, 0.6488, 0.6135], [0.2569, 0.8813, 0.6113], [0.2211, 0.3304, 0.0006]]]])
in0Mul7752 = tf.constant([[[0.7082, 0.5529], [0.8289, 0.7591]]])
in1Mul7752 = tf.constant([[[0.6387, 0.674], [0.7708, 0.1918]]])
in0Con51618 = tf.constant([[[0.5189, 0.7878, 0.5136, 0.6423, 0.7712, 0.5039, 0.3044], [0.9068, 0.2036, 0.6309, 0.9811, 0.9068, 0.8179, 0.6925], [0.568, 0.4066, 0.1515, 0.0208, 0.6452, 0.9732, 0.5659]]])
in0Min23261 = tf.constant([[[[[0.6624]], [[0.1391]]]]])
in1Min23261 = tf.constant([[[[[0.8674]], [[0.2068]]]]])
print (np.array2string(model.predict([in0Sub91550,in1Sub91550,in0Mul7752,in1Mul7752,in0Con51618,in0Min23261,in1Min23261],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min56145.png')

LSub91550 = subtract_layer([[[[0.7338, 0.6786, 0.0467], [0.5852, 0.004, 0.7725], [0.3833, 0.9367, 0.4512]], [[0.4136, 0.5118, 0.2083], [0.4269, 0.6087, 0.1156], [0.8082, 0.69, 0.1994]], [[0.3966, 0.2466, 0.743], [0.6595, 0.9368, 0.1717], [0.1604, 0.6536, 0.8781]]]], [[[[0.8047, 0.712, 0.8685], [0.8367, 0.9818, 0.0039], [0.031, 0.4044, 0.5527]], [[0.5636, 0.9533, 0.3077], [0.4537, 0.7842, 0.9122], [0.3014, 0.3804, 0.9049]], [[0.6587, 0.6488, 0.6135], [0.2569, 0.8813, 0.6113], [0.2211, 0.3304, 0.0006]]]], Sub91550), 
LRes85982 = reshape_layer(Sub91550, [3, 9], Res85982), 
LMul7752 = multiply_layer([[[[0.7082, 0.5529], [0.8289, 0.7591]]], [[[0.6387, 0.674], [0.7708, 0.1918]]]], Mul7752), 
LZer12517 = zero_padding1D_layer(Mul7752, 1, 0, Zer12517), 
LCon51618 = concatenate_layer([Zer12517,[[[0.5189, 0.7878, 0.5136, 0.6423, 0.7712, 0.5039, 0.3044], [0.9068, 0.2036, 0.6309, 0.9811, 0.9068, 0.8179, 0.6925], [0.568, 0.4066, 0.1515, 0.0208, 0.6452, 0.9732, 0.5659]]]], 2, Con51618), 
LAve63110 = average_layer([Res85982,Con51618], Ave63110), 
LRes75466 = reshape_layer(Ave63110, [3, 9, 1], Res75466), 
LRes84637 = reshape_layer(Res75466, [3, 9, 1, 1], Res84637), 
LMin23261 = minimum_layer([[[[[[0.6624]], [[0.1391]]]]], [[[[[0.8674]], [[0.2068]]]]]], Min23261), 
LZer90990 = zero_padding3D_layer(Min23261, 2, 0, 7, 0, 0, 0, Zer90990), 
LMin56145 = minimum_layer([Res84637,Zer90990], Min56145), 
exec_layers([LSub91550,LRes85982,LMul7752,LZer12517,LCon51618,LAve63110,LRes75466,LRes84637,LMin23261,LZer90990,LMin56145],["Sub91550","Res85982","Mul7752","Zer12517","Con51618","Ave63110","Res75466","Res84637","Min23261","Zer90990","Min56145"],Min56145,"Min56145")

Actual (Unparsed): [[[[[-0.0354500]], [[-0.0167000]], [[-0.1514500]], [[0.0000000]], [[-0.2321000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]]], [[[0.0000000]], [[-0.0344227]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[-0.0065000]]], [[[0.0000000]], [[-0.1283023]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[-0.2094000]], [[0.0000000]], [[0.6482000]], [[0.1391000]]]]]

Expected (Unparsed): [[[[[-0.03544999999999998]],[[-0.016699999999999993]],[[-0.15145000000000003]],[[0]],[[-0.23210000000000003]],[[0]],[[0]],[[0]],[[0]]],[[[0]],[[-0.0344227]],[[0]],[[0]],[[0]],[[0]],[[0]],[[0]],[[-0.006500000000000006]]],[[[0]],[[-0.12830231]],[[0]],[[0]],[[0]],[[-0.2094]],[[0]],[[0.6481999999999999]],[[0.1391]]]]]

Actual:   [[[[[-0.0354]], [[-0.0167]], [[-0.1514]], [[0]], [[-0.2321]], [[0]], [[0]], [[0]], [[0]]], [[[0]], [[-0.0344]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[-0.0065]]], [[[0]], [[-0.1283]], [[0]], [[0]], [[0]], [[-0.2094]], [[0]], [[0.6482]], [[0.1391]]]]]

Expected: [[[[[-0.0354]], [[-0.0166]], [[-0.1514]], [[0]], [[-0.2321]], [[0]], [[0]], [[0]], [[0]]], [[[0]], [[-0.0344]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[-0.0065]]], [[[0]], [[-0.1283]], [[0]], [[0]], [[0]], [[-0.2094]], [[0]], [[0.6482]], [[0.1391]]]]]