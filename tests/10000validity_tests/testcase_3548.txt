import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer46215 = tf.keras.layers.Input(shape=([2, 3]))
in0Loc34171 = tf.keras.layers.Input(shape=([1, 2]))
in0Dot39789 = tf.keras.layers.Input(shape=([2]))
in1Dot39789 = tf.keras.layers.Input(shape=([2]))
in0Con55987 = tf.keras.layers.Input(shape=([2]))
in0Con90288 = tf.keras.layers.Input(shape=([9]))

Zer46215 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer46215', )(in0Zer46215)
Fla55664 = keras.layers.Flatten(name = 'Fla55664', )(Zer46215)
Loc34171 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc34171', )(in0Loc34171)
Res32657 = keras.layers.Reshape((1, 4, 1), name = 'Res32657', )(Loc34171)
Res80769 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res80769', )(Res32657)
Cro21014 = keras.layers.Cropping3D(cropping=((0, 0), (0, 1), (0, 0)), name = 'Cro21014', )(Res80769)
Res53458 = keras.layers.Reshape((1, 3, 1), name = 'Res53458', )(Cro21014)
Res29074 = keras.layers.Reshape((1, 3), name = 'Res29074', )(Res53458)
Fla52660 = keras.layers.Flatten(name = 'Fla52660', )(Res29074)
Dot39789 = keras.layers.Dot(axes=(1, 1), name = 'Dot39789', )([in0Dot39789,in1Dot39789])
Con55987 = keras.layers.Concatenate(axis=1, name = 'Con55987', )([Dot39789,in0Con55987])
Sub39325 = keras.layers.Subtract(name = 'Sub39325', )([Fla52660,Con55987])
Con90288 = keras.layers.Concatenate(axis=1, name = 'Con90288', )([Sub39325,in0Con90288])
Max96259 = keras.layers.Maximum(name = 'Max96259', )([Fla55664,Con90288])
model = tf.keras.models.Model(inputs=[in0Zer46215,in0Loc34171,in0Dot39789,in1Dot39789,in0Con55987,in0Con90288], outputs=Max96259)
w = model.get_layer('Loc34171').get_weights() 
w[0] = np.array([[[0.9263, 0.2733, 0.4418, 0.419], [0.4782, 0.9369, 0.6737, 0.5665]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc34171').set_weights(w) 
in0Zer46215 = tf.constant([[[1.1829, 1.2992, 1.9858], [1.111, 1.2952, 1.0733]]])
in0Loc34171 = tf.constant([[[0.2579, 0.6924]]])
in0Dot39789 = tf.constant([[0.026, 0.9249]])
in1Dot39789 = tf.constant([[0.3288, 0.0478]])
in0Con55987 = tf.constant([[0.5847, 0.0449]])
in0Con90288 = tf.constant([[0.5694, 0.1346, 0.0069, 0.8657, 0.8421, 0.9106, 0.459, 0.4774, 0.8701]])
print (np.array2string(model.predict([in0Zer46215,in0Loc34171,in0Dot39789,in1Dot39789,in0Con55987,in0Con90288],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max96259.png')

LZer46215 = zero_padding1D_layer([[[1.1829, 1.2992, 1.9858], [1.111, 1.2952, 1.0733]]], 1, 1, Zer46215), 
LFla55664 = flatten_layer(Zer46215, Fla55664), 
LLoc34171 = locally_connected1D_layer([[[0.2579, 0.6924]]], 1,[[[0.9263, 0.2733, 0.4418, 0.419], [0.4782, 0.9369, 0.6737, 0.5665]]],[[0, 0, 0, 0]], 1, Loc34171), 
LRes32657 = reshape_layer(Loc34171, [1, 4, 1], Res32657), 
LRes80769 = reshape_layer(Res32657, [1, 4, 1, 1], Res80769), 
LCro21014 = cropping3D_layer(Res80769, 0, 0, 0, 1, 0, 0, Cro21014), 
LRes53458 = reshape_layer(Cro21014, [1, 3, 1], Res53458), 
LRes29074 = reshape_layer(Res53458, [1, 3], Res29074), 
LFla52660 = flatten_layer(Res29074, Fla52660), 
LDot39789 = dot_layer([[0.026, 0.9249]], [[0.3288, 0.0478]], 1, 1, Dot39789), 
LCon55987 = concatenate_layer([Dot39789,[[0.5847, 0.0449]]], 1, Con55987), 
LSub39325 = subtract_layer(Fla52660,Con55987, Sub39325), 
LCon90288 = concatenate_layer([Sub39325,[[0.5694, 0.1346, 0.0069, 0.8657, 0.8421, 0.9106, 0.459, 0.4774, 0.8701]]], 1, Con90288), 
LMax96259 = maximum_layer([Fla55664,Con90288], Max96259), 
exec_layers([LZer46215,LFla55664,LLoc34171,LRes32657,LRes80769,LCro21014,LRes53458,LRes29074,LFla52660,LDot39789,LCon55987,LSub39325,LCon90288,LMax96259],["Zer46215","Fla55664","Loc34171","Res32657","Res80769","Cro21014","Res53458","Res29074","Fla52660","Dot39789","Con55987","Sub39325","Con90288","Max96259"],Max96259,"Max96259")

Actual (Unparsed): [[0.5172394, 0.1344936, 0.5355101, 1.1829000, 1.2992001, 1.9858000, 1.1109999, 1.2952000, 1.0733000, 0.4590000, 0.4774000, 0.8701000]]

Expected (Unparsed): [[0.5172394300000001,0.13449363000000003,0.5355101,1.1829,1.2992,1.9858,1.111,1.2952,1.0733,0.459,0.4774,0.8701]]

Actual:   [[0.5173, 0.1345, 0.5356, 1.1829, 1.2993, 1.9858, 1.111, 1.2952, 1.0733, 0.459, 0.4774, 0.8701]]

Expected: [[0.5173, 0.1345, 0.5356, 1.1829, 1.2992, 1.9858, 1.111, 1.2952, 1.0733, 0.459, 0.4774, 0.8701]]