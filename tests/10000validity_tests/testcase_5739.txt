import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro17249 = tf.keras.layers.Input(shape=([1, 3]))
in0Sof24764 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Dot17973 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot17973 = tf.keras.layers.Input(shape=([2, 3]))
in0Mul99412 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul99412 = tf.keras.layers.Input(shape=([1, 1]))
in0Con48171 = tf.keras.layers.Input(shape=([3, 2]))
in0Con2785 = tf.keras.layers.Input(shape=([3, 2]))

Cro17249 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro17249', )(in0Cro17249)
Res34933 = keras.layers.Reshape((1, 3, 1), name = 'Res34933', )(Cro17249)
Zer60887 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer60887', )(Res34933)
Sof24764 = keras.layers.Softmax(axis=1, name = 'Sof24764', input_shape=(2, 1, 1))(in0Sof24764)
Zer98949 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer98949', )(Sof24764)
Ave36154 = keras.layers.Average(name = 'Ave36154', )([Zer60887,Zer98949])
Ave16783 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Ave16783', )(Ave36154)
Res59138 = keras.layers.Reshape((2, 5), name = 'Res59138', )(Ave16783)
Zer67337 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer67337', )(Res59138)
Dot17973 = keras.layers.Dot(axes=(1, 1), name = 'Dot17973', )([in0Dot17973,in1Dot17973])
Mul99412 = keras.layers.Multiply(name = 'Mul99412', )([in0Mul99412,in1Mul99412])
Zer55566 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer55566', )(Mul99412)
Con48171 = keras.layers.Concatenate(axis=2, name = 'Con48171', )([Zer55566,in0Con48171])
Sub53284 = keras.layers.Subtract(name = 'Sub53284', )([Dot17973,Con48171])
Con2785 = keras.layers.Concatenate(axis=2, name = 'Con2785', )([Sub53284,in0Con2785])
Max56719 = keras.layers.Maximum(name = 'Max56719', )([Zer67337,Con2785])
model = tf.keras.models.Model(inputs=[in0Cro17249,in0Sof24764,in0Dot17973,in1Dot17973,in0Mul99412,in1Mul99412,in0Con48171,in0Con2785], outputs=Max56719)
in0Cro17249 = tf.constant([[[1.244, 1.6002, 1.4442]]])
in0Sof24764 = tf.constant([[[[0.7193]], [[0.6251]]]])
in0Dot17973 = tf.constant([[[0.3243, 0.5736, 0.9523], [0.0035, 0.8469, 0.549]]])
in1Dot17973 = tf.constant([[[0.9741, 0.0106, 0.8019], [0.7387, 0.6921, 0.5393]]])
in0Mul99412 = tf.constant([[[0.9259]]])
in1Mul99412 = tf.constant([[[0.2735]]])
in0Con48171 = tf.constant([[[0.5126, 0.8918], [0.6773, 0.0115], [0.703, 0.2676]]])
in0Con2785 = tf.constant([[[0.2535, 0.1771], [0.7854, 0.8775], [0.7077, 0.544]]])
print (np.array2string(model.predict([in0Cro17249,in0Sof24764,in0Dot17973,in1Dot17973,in0Mul99412,in1Mul99412,in0Con48171,in0Con2785],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max56719.png')

LCro17249 = cropping1D_layer([[[1.244, 1.6002, 1.4442]]], 0, 0, Cro17249), 
LRes34933 = reshape_layer(Cro17249, [1, 3, 1], Res34933), 
LZer60887 = zero_padding2D_layer(Res34933, 1, 0, 2, 0, Zer60887), 
LSof24764 = softmax_layer([[[[0.7193]], [[0.6251]]]], 1, Sof24764), 
LZer98949 = zero_padding2D_layer(Sof24764, 0, 0, 4, 0, Zer98949), 
LAve36154 = average_layer([Zer60887,Zer98949], Ave36154), 
LAve16783 = average_pooling2D_layer(Ave36154, 1, 1, 1, 1, true, Ave16783), 
LRes59138 = reshape_layer(Ave16783, [2, 5], Res59138), 
LZer67337 = zero_padding1D_layer(Res59138, 1, 0, Zer67337), 
LDot17973 = dot_layer([[[0.3243, 0.5736, 0.9523], [0.0035, 0.8469, 0.549]]], [[[0.9741, 0.0106, 0.8019], [0.7387, 0.6921, 0.5393]]], 1, 1, Dot17973), 
LMul99412 = multiply_layer([[[[0.9259]]], [[[0.2735]]]], Mul99412), 
LZer55566 = zero_padding1D_layer(Mul99412, 2, 0, Zer55566), 
LCon48171 = concatenate_layer([Zer55566,[[[0.5126, 0.8918], [0.6773, 0.0115], [0.703, 0.2676]]]], 2, Con48171), 
LSub53284 = subtract_layer(Dot17973,Con48171, Sub53284), 
LCon2785 = concatenate_layer([Sub53284,[[[0.2535, 0.1771], [0.7854, 0.8775], [0.7077, 0.544]]]], 2, Con2785), 
LMax56719 = maximum_layer([Zer67337,Con2785], Max56719), 
exec_layers([LCro17249,LRes34933,LZer60887,LSof24764,LZer98949,LAve36154,LAve16783,LRes59138,LZer67337,LDot17973,LMul99412,LZer55566,LCon48171,LSub53284,LCon2785,LMax56719],["Cro17249","Res34933","Zer60887","Sof24764","Zer98949","Ave36154","Ave16783","Res59138","Zer67337","Dot17973","Mul99412","Zer55566","Con48171","Sub53284","Con2785","Max56719"],Max56719,"Max56719")

Actual (Unparsed): [[[0.3184861, 0.0000000, 0.0000000, 0.2535000, 0.1771000], [1.1843487, 0.0000000, 0.9052030, 0.7854000, 0.8775000], [1.0799481, 0.0000000, 0.7921251, 0.8001000, 0.9603337]]]

Expected (Unparsed): [[[0.31848607999999995,0,0,0.2535,0.1771],[1.18434879,0,0.90520301,0.7854,0.8775],[1.0799480800000003,0,0.79212507,0.8001,0.9603336995396732]]]

Actual:   [[[0.3185, 0, 0, 0.2535, 0.1771], [1.1844, 0, 0.9053, 0.7854, 0.8775], [1.08, 0, 0.7922, 0.8001, 0.9604]]]

Expected: [[[0.3185, 0, 0, 0.2535, 0.1771], [1.1844, 0, 0.9053, 0.7854, 0.8775], [1.08, 0, 0.7922, 0.8001, 0.9604]]]