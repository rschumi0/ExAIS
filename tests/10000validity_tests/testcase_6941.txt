import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min65288 = tf.keras.layers.Input(shape=([1, 2]))
in1Min65288 = tf.keras.layers.Input(shape=([1, 2]))
in0Con77456 = tf.keras.layers.Input(shape=([1]))
in0Sim68432 = tf.keras.layers.Input(shape=([1, 3]))

Min65288 = keras.layers.Minimum(name = 'Min65288', )([in0Min65288,in1Min65288])
Fla63603 = keras.layers.Flatten(name = 'Fla63603', )(Min65288)
Con77456 = keras.layers.Concatenate(axis=1, name = 'Con77456', )([Fla63603,in0Con77456])
Sim68432 = keras.layers.SimpleRNN(3,name = 'Sim68432', )(in0Sim68432)
Dot34749 = keras.layers.Dot(axes=(1, 1), name = 'Dot34749', )([Con77456,Sim68432])
model = tf.keras.models.Model(inputs=[in0Min65288,in1Min65288,in0Con77456,in0Sim68432], outputs=Dot34749)
w = model.get_layer('Sim68432').get_weights() 
w[0] = np.array([[3, 9, 3], [6, 7, 8], [8, 9, 5]])
w[1] = np.array([[3, 4, 9], [8, 5, 9], [4, 7, 2]])
w[2] = np.array([6, 2, 5])
model.get_layer('Sim68432').set_weights(w) 
in0Min65288 = tf.constant([[[0.8152, 0.5077]]])
in1Min65288 = tf.constant([[[0.422, 0.9231]]])
in0Con77456 = tf.constant([[0.8522]])
in0Sim68432 = tf.constant([[[9, 5, 8]]])
print (np.array2string(model.predict([in0Min65288,in1Min65288,in0Con77456,in0Sim68432],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot34749.png')

LMin65288 = minimum_layer([[[[0.8152, 0.5077]]], [[[0.422, 0.9231]]]], Min65288), 
LFla63603 = flatten_layer(Min65288, Fla63603), 
LCon77456 = concatenate_layer([Fla63603,[[0.8522]]], 1, Con77456), 
LSim68432 = simple_rnn_layer([[[9, 5, 8]]],[[3, 9, 3], [6, 7, 8], [8, 9, 5]],[[3, 4, 9], [8, 5, 9], [4, 7, 2]],[6, 2, 5], Sim68432), 
LDot34749 = dot_layer(Con77456,Sim68432, 1, 1, Dot34749), 
exec_layers([LMin65288,LFla63603,LCon77456,LSim68432,LDot34749],["Min65288","Fla63603","Con77456","Sim68432","Dot34749"],Dot34749,"Dot34749")

Actual (Unparsed): [[1.7819000]]

Expected (Unparsed): [[1.7818999999999998]]

Actual:   [[1.7819]]

Expected: [[1.7819]]