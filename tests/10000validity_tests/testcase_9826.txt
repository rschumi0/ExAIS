import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub27330 = tf.keras.layers.Input(shape=([2, 3, 3]))
in1Sub27330 = tf.keras.layers.Input(shape=([2, 3, 3]))

Sub27330 = keras.layers.Subtract(name = 'Sub27330', )([in0Sub27330,in1Sub27330])
Res86833 = keras.layers.Reshape((2, 9), name = 'Res86833', )(Sub27330)
PRe26493 = keras.layers.PReLU(name = 'PRe26493', )(Res86833)
model = tf.keras.models.Model(inputs=[in0Sub27330,in1Sub27330], outputs=PRe26493)
w = model.get_layer('PRe26493').get_weights() 
w[0] = np.array([[0.3422, 0.2985, 0.6626, 0.5213, 0.2538, 0.8137, 0.0525, 0.9243, 0.5297], [0.5803, 0.5613, 0.0886, 0.7675, 0.0808, 0.9327, 0.7957, 0.0463, 0.2234]])
model.get_layer('PRe26493').set_weights(w) 
in0Sub27330 = tf.constant([[[[0.9551, 0.6098, 0.7981], [0.3427, 0.3711, 0.6969], [0.0312, 0.7786, 0.8769]], [[0.5571, 0.2084, 0.1232], [0.2198, 0.0575, 0.134], [0.7388, 0.8298, 0.2918]]]])
in1Sub27330 = tf.constant([[[[0.5354, 0.3095, 0.3958], [0.7069, 0.6945, 0.9777], [0.5142, 0.4886, 0.4808]], [[0.1862, 0.5176, 0.5063], [0.8509, 0.3142, 0.6941], [0.2044, 0.4982, 0.4258]]]])
print (np.array2string(model.predict([in0Sub27330,in1Sub27330],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe26493.png')

LSub27330 = subtract_layer([[[[0.9551, 0.6098, 0.7981], [0.3427, 0.3711, 0.6969], [0.0312, 0.7786, 0.8769]], [[0.5571, 0.2084, 0.1232], [0.2198, 0.0575, 0.134], [0.7388, 0.8298, 0.2918]]]], [[[[0.5354, 0.3095, 0.3958], [0.7069, 0.6945, 0.9777], [0.5142, 0.4886, 0.4808]], [[0.1862, 0.5176, 0.5063], [0.8509, 0.3142, 0.6941], [0.2044, 0.4982, 0.4258]]]], Sub27330), 
LRes86833 = reshape_layer(Sub27330, [2, 9], Res86833), 
LPRe26493 = prelu_layer(Res86833, [[0.3422, 0.2985, 0.6626, 0.5213, 0.2538, 0.8137, 0.0525, 0.9243, 0.5297], [0.5803, 0.5613, 0.0886, 0.7675, 0.0808, 0.9327, 0.7957, 0.0463, 0.2234]], PRe26493), 
exec_layers([LSub27330,LRes86833,LPRe26493],["Sub27330","Res86833","PRe26493"],PRe26493,"PRe26493")

Actual (Unparsed): [[[0.4197000, 0.3003000, 0.4023000, -0.1898575, -0.0820789, -0.2284869, -0.0253575, 0.2900000, 0.3961000], [0.3709000, -0.1735540, -0.0339427, -0.4843692, -0.0207414, -0.5224053, 0.5344000, 0.3316000, -0.0299356]]]

Expected (Unparsed): [[[0.41969999999999996,0.3003,0.40230000000000005,-0.18985745999999998,-0.08207892000000001,-0.22848696000000004,-0.025357499999999998,0.29,0.3961],[0.3709,-0.17355395999999995,-0.03394266,-0.48436925,-0.020741359999999997,-0.52240527,0.5344,0.3316,-0.0299356]]]

Actual:   [[[0.4197, 0.3003, 0.4023, -0.1898, -0.082, -0.2284, -0.0253, 0.29, 0.3961], [0.3709, -0.1735, -0.0339, -0.4843, -0.0207, -0.5224, 0.5344, 0.3316, -0.0299]]]

Expected: [[[0.4197, 0.3003, 0.4024, -0.1898, -0.082, -0.2284, -0.0253, 0.29, 0.3961], [0.3709, -0.1735, -0.0339, -0.4843, -0.0207, -0.5224, 0.5344, 0.3316, -0.0299]]]