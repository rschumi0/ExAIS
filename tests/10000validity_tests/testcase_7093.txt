import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub2937 = tf.keras.layers.Input(shape=([2, 3, 3]))
in1Sub2937 = tf.keras.layers.Input(shape=([2, 3, 3]))

Sub2937 = keras.layers.Subtract(name = 'Sub2937', )([in0Sub2937,in1Sub2937])
ReL36262 = keras.layers.ReLU(max_value=1.7182802086606395, negative_slope=8.369564125926772, threshold=4.1748087041043656, name = 'ReL36262', )(Sub2937)
Res24274 = keras.layers.Reshape((2, 9), name = 'Res24274', )(ReL36262)
Glo59364 = keras.layers.GlobalMaxPool1D(name = 'Glo59364', )(Res24274)
Res78727 = keras.layers.Reshape((9, 1), name = 'Res78727', )(Glo59364)
Res55667 = keras.layers.Reshape((9, 1, 1), name = 'Res55667', )(Res78727)
Max95114 = keras.layers.MaxPool2D(pool_size=(7, 1), name = 'Max95114', )(Res55667)
model = tf.keras.models.Model(inputs=[in0Sub2937,in1Sub2937], outputs=Max95114)
in0Sub2937 = tf.constant([[[[0.2496, 0.9464, 0.5215], [0.0635, 0.8867, 0.6183], [0.9469, 0.9038, 0.6752]], [[0.9852, 0.4101, 0.1387], [0.7311, 0.1096, 0.4891], [0.7223, 0.0509, 0.3606]]]])
in1Sub2937 = tf.constant([[[[0.3358, 0.5784, 0.7909], [0.7545, 0.9412, 0.1915], [0.2767, 0.1846, 0.7761]], [[0.4242, 0.4439, 0.1249], [0.535, 0.7022, 0.185], [0.7945, 0.5544, 0.3165]]]])
print (np.array2string(model.predict([in0Sub2937,in1Sub2937],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max95114.png')

LSub2937 = subtract_layer([[[[0.2496, 0.9464, 0.5215], [0.0635, 0.8867, 0.6183], [0.9469, 0.9038, 0.6752]], [[0.9852, 0.4101, 0.1387], [0.7311, 0.1096, 0.4891], [0.7223, 0.0509, 0.3606]]]], [[[[0.3358, 0.5784, 0.7909], [0.7545, 0.9412, 0.1915], [0.2767, 0.1846, 0.7761]], [[0.4242, 0.4439, 0.1249], [0.535, 0.7022, 0.185], [0.7945, 0.5544, 0.3165]]]], Sub2937), 
LReL36262 = relu_layer(Sub2937, 1.7182802086606395, 8.369564125926772, 4.1748087041043656, ReL36262), 
LRes24274 = reshape_layer(ReL36262, [2, 9], Res24274), 
LGlo59364 = global_max_pool1D_layer(Res24274, Glo59364), 
LRes78727 = reshape_layer(Glo59364, [9, 1], Res78727), 
LRes55667 = reshape_layer(Res78727, [9, 1, 1], Res55667), 
LMax95114 = max_pool2D_layer(Res55667, 7, 1, Max95114), 
exec_layers([LSub2937,LReL36262,LRes24274,LGlo59364,LRes78727,LRes55667,LMax95114],["Sub2937","ReL36262","Res24274","Glo59364","Res78727","Res55667","Max95114"],Max95114,"Max95114")

Actual (Unparsed): [[[[-29.3320471]]]]

Expected (Unparsed): [[[[-29.33204728528261]]]]

Actual:   [[[[-29.332]]]]

Expected: [[[[-29.332]]]]