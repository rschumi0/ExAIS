import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot60132 = tf.keras.layers.Input(shape=([3]))
in1Dot60132 = tf.keras.layers.Input(shape=([3]))
in0Con83565 = tf.keras.layers.Input(shape=([2]))
in0Add55983 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add55983 = tf.keras.layers.Input(shape=([1, 1, 1]))

Dot60132 = keras.layers.Dot(axes=(1, 1), name = 'Dot60132', )([in0Dot60132,in1Dot60132])
Con83565 = keras.layers.Concatenate(axis=1, name = 'Con83565', )([Dot60132,in0Con83565])
Add55983 = keras.layers.Add(name = 'Add55983', )([in0Add55983,in1Add55983])
Res88518 = keras.layers.Reshape((1, 1), name = 'Res88518', )(Add55983)
Sim19160 = keras.layers.SimpleRNN(3,name = 'Sim19160', )(Res88518)
Sub53105 = keras.layers.Subtract(name = 'Sub53105', )([Con83565,Sim19160])
model = tf.keras.models.Model(inputs=[in0Dot60132,in1Dot60132,in0Con83565,in0Add55983,in1Add55983], outputs=Sub53105)
w = model.get_layer('Sim19160').get_weights() 
w[0] = np.array([[7, 1, 1]])
w[1] = np.array([[5, 9, 3], [6, 4, 9], [7, 7, 3]])
w[2] = np.array([4, 3, 6])
model.get_layer('Sim19160').set_weights(w) 
in0Dot60132 = tf.constant([[0.3082, 0.2178, 0.1411]])
in1Dot60132 = tf.constant([[0.2557, 0.4892, 0.9105]])
in0Con83565 = tf.constant([[0.985, 0.396]])
in0Add55983 = tf.constant([[[[0.3872]]]])
in1Add55983 = tf.constant([[[[0.7408]]]])
print (np.array2string(model.predict([in0Dot60132,in1Dot60132,in0Con83565,in0Add55983,in1Add55983],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub53105.png')

LDot60132 = dot_layer([[0.3082, 0.2178, 0.1411]], [[0.2557, 0.4892, 0.9105]], 1, 1, Dot60132), 
LCon83565 = concatenate_layer([Dot60132,[[0.985, 0.396]]], 1, Con83565), 
LAdd55983 = add_layer([[[[[0.3872]]]], [[[[0.7408]]]]], Add55983), 
LRes88518 = reshape_layer(Add55983, [1, 1], Res88518), 
LSim19160 = simple_rnn_layer(Res88518,[[7, 1, 1]],[[5, 9, 3], [6, 4, 9], [7, 7, 3]],[4, 3, 6], Sim19160), 
LSub53105 = subtract_layer(Con83565,Sim19160, Sub53105), 
exec_layers([LDot60132,LCon83565,LAdd55983,LRes88518,LSim19160,LSub53105],["Dot60132","Con83565","Add55983","Res88518","Sim19160","Sub53105"],Sub53105,"Sub53105")

Actual (Unparsed): [[-0.6861739, -0.0144807, -0.6039987]]

Expected (Unparsed): [[-0.6861739499070402,-0.01448074345025141,-0.6039987125582693]]

Actual:   [[-0.6861, -0.0144, -0.6039]]

Expected: [[-0.6861, -0.0144, -0.6039]]