import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot37101 = tf.keras.layers.Input(shape=([2]))
in1Dot37101 = tf.keras.layers.Input(shape=([2]))

Dot37101 = keras.layers.Dot(axes=(1, 1), name = 'Dot37101', )([in0Dot37101,in1Dot37101])
Res31140 = keras.layers.Reshape((1, 1), name = 'Res31140', )(Dot37101)
Per18796 = keras.layers.Permute((1,2), name = 'Per18796',)(Res31140)
Res81668 = keras.layers.Reshape((1, 1, 1), name = 'Res81668', )(Per18796)
Zer91075 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer91075', )(Res81668)
model = tf.keras.models.Model(inputs=[in0Dot37101,in1Dot37101], outputs=Zer91075)
in0Dot37101 = tf.constant([[0.0878, 0.1648]])
in1Dot37101 = tf.constant([[0.4541, 0.3957]])
print (np.array2string(model.predict([in0Dot37101,in1Dot37101],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer91075.png')

LDot37101 = dot_layer([[0.0878, 0.1648]], [[0.4541, 0.3957]], 1, 1, Dot37101), 
LRes31140 = reshape_layer(Dot37101, [1, 1], Res31140), 
LPer18796 = permute_layer(Res31140, 1,2, Per18796), 
LRes81668 = reshape_layer(Per18796, [1, 1, 1], Res81668), 
LZer91075 = zero_padding2D_layer(Res81668, 1, 1, 1, 1, Zer91075), 
exec_layers([LDot37101,LRes31140,LPer18796,LRes81668,LZer91075],["Dot37101","Res31140","Per18796","Res81668","Zer91075"],Zer91075,"Zer91075")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.1050813], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[0.10508134],[0]],[[0],[0],[0]]]]

Actual:   [[[[0], [0], [0]], [[0], [0.1051], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [0.1051], [0]], [[0], [0], [0]]]]