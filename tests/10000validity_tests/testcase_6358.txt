import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min94784 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Min94784 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Min94784 = keras.layers.Minimum(name = 'Min94784', )([in0Min94784,in1Min94784])
Res87577 = keras.layers.Reshape((1, 1, 2), name = 'Res87577', )(Min94784)
Sep70730 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep70730', )(Res87577)
model = tf.keras.models.Model(inputs=[in0Min94784,in1Min94784], outputs=Sep70730)
w = model.get_layer('Sep70730').get_weights() 
w[0] = np.array([[[[0.7086], [0.9405]]]])
w[1] = np.array([[[[0.2766, 0.1254, 0.5327], [0.9571, 0.7951, 0.8494]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep70730').set_weights(w) 
in0Min94784 = tf.constant([[[[[0.8421], [0.3259]]]]])
in1Min94784 = tf.constant([[[[[0.5074], [0.7955]]]]])
print (np.array2string(model.predict([in0Min94784,in1Min94784],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep70730.png')

LMin94784 = minimum_layer([[[[[[0.8421], [0.3259]]]]], [[[[[0.5074], [0.7955]]]]]], Min94784), 
LRes87577 = reshape_layer(Min94784, [1, 1, 2], Res87577), 
LSep70730 = separable_conv2D_layer(Res87577, 1, 1,[[[[[0.7086], [0.9405]]]],[[[[0.2766, 0.1254, 0.5327], [0.9571, 0.7951, 0.8494]]]]],[0, 0, 0], 1, 1, true, Sep70730), 
exec_layers([LMin94784,LRes87577,LSep70730],["Min94784","Res87577","Sep70730"],Sep70730,"Sep70730")

Actual (Unparsed): [[[[0.3928095, 0.2887920, 0.4518776]]]]

Expected (Unparsed): [[[[0.39280948686899997,0.288792038601,0.45187759915799997]]]]

Actual:   [[[[0.3929, 0.2888, 0.4519]]]]

Expected: [[[[0.3929, 0.2888, 0.4519]]]]