import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo93406 = tf.keras.layers.Input(shape=([2, 1]))
in0Min76870 = tf.keras.layers.Input(shape=([1, 1]))
in1Min76870 = tf.keras.layers.Input(shape=([1, 1]))

Glo93406 = keras.layers.GlobalAveragePooling1D(name = 'Glo93406', )(in0Glo93406)
Res83347 = keras.layers.Reshape((1, 1), name = 'Res83347', )(Glo93406)
Res35856 = keras.layers.Reshape((1, 1, 1), name = 'Res35856', )(Res83347)
Res47076 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res47076', )(Res35856)
Cro67441 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro67441', )(Res47076)
Res36130 = keras.layers.Reshape((1, 1, 1), name = 'Res36130', )(Cro67441)
Res59693 = keras.layers.Reshape((1, 1), name = 'Res59693', )(Res36130)
LST47578 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST47578', )(Res59693)
Res959 = keras.layers.Reshape((2, 1), name = 'Res959', )(LST47578)
Min76870 = keras.layers.Minimum(name = 'Min76870', )([in0Min76870,in1Min76870])
Zer89800 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer89800', )(Min76870)
Max47011 = keras.layers.Maximum(name = 'Max47011', )([Res959,Zer89800])
model = tf.keras.models.Model(inputs=[in0Glo93406,in0Min76870,in1Min76870], outputs=Max47011)
w = model.get_layer('LST47578').get_weights() 
w[0] = np.array([[4, 2, 1, 9, 1, 4, 7, 1]])
w[1] = np.array([[3, 6, 3, 5, 9, 4, 2, 6], [5, 7, 1, 2, 10, 10, 5, 2]])
w[2] = np.array([8, 6, 6, 8, 2, 1, 2, 1])
model.get_layer('LST47578').set_weights(w) 
in0Glo93406 = tf.constant([[[1.5503], [1.8621]]])
in0Min76870 = tf.constant([[[0.5614]]])
in1Min76870 = tf.constant([[[0.3337]]])
print (np.array2string(model.predict([in0Glo93406,in0Min76870,in1Min76870],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max47011.png')

LGlo93406 = global_average_pooling1D_layer([[[1.5503], [1.8621]]], Glo93406), 
LRes83347 = reshape_layer(Glo93406, [1, 1], Res83347), 
LRes35856 = reshape_layer(Res83347, [1, 1, 1], Res35856), 
LRes47076 = reshape_layer(Res35856, [1, 1, 1, 1], Res47076), 
LCro67441 = cropping3D_layer(Res47076, 0, 0, 0, 0, 0, 0, Cro67441), 
LRes36130 = reshape_layer(Cro67441, [1, 1, 1], Res36130), 
LRes59693 = reshape_layer(Res36130, [1, 1], Res59693), 
LLST47578 = lstm_layer(Res59693,[[4, 2, 1, 9, 1, 4, 7, 1]],[[3, 6, 3, 5, 9, 4, 2, 6], [5, 7, 1, 2, 10, 10, 5, 2]],[8, 6, 6, 8, 2, 1, 2, 1], LST47578), 
LRes959 = reshape_layer(LST47578, [2, 1], Res959), 
LMin76870 = minimum_layer([[[[0.5614]]], [[[0.3337]]]], Min76870), 
LZer89800 = zero_padding1D_layer(Min76870, 1, 0, Zer89800), 
LMax47011 = maximum_layer([Res959,Zer89800], Max47011), 
exec_layers([LGlo93406,LRes83347,LRes35856,LRes47076,LCro67441,LRes36130,LRes59693,LLST47578,LRes959,LMin76870,LZer89800,LMax47011],["Glo93406","Res83347","Res35856","Res47076","Cro67441","Res36130","Res59693","LST47578","Res959","Min76870","Zer89800","Max47011"],Max47011,"Max47011")

Actual (Unparsed): [[[0.7610861], [0.7138796]]]

Expected (Unparsed): [[[0.7610860792541237],[0.7138795990816355]]]

Actual:   [[[0.7611], [0.7139]]]

Expected: [[[0.7611], [0.7139]]]