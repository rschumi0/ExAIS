import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul74319 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul74319 = tf.keras.layers.Input(shape=([2, 2]))

Mul74319 = keras.layers.Multiply(name = 'Mul74319', )([in0Mul74319,in1Mul74319])
Res63696 = keras.layers.Reshape((2, 2, 1), name = 'Res63696', )(Mul74319)
Sep6309 = keras.layers.SeparableConv2D(3, (1, 2),strides=(1, 1), padding='valid', name = 'Sep6309', )(Res63696)
model = tf.keras.models.Model(inputs=[in0Mul74319,in1Mul74319], outputs=Sep6309)
w = model.get_layer('Sep6309').get_weights() 
w[0] = np.array([[[[0.1599]], [[0.2222]]]])
w[1] = np.array([[[[0.5433, 0.7945, 0.2539]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep6309').set_weights(w) 
in0Mul74319 = tf.constant([[[0.1684, 0.1796], [0.6193, 0.5534]]])
in1Mul74319 = tf.constant([[[0.8927, 0.5484], [0.3412, 0.1274]]])
print (np.array2string(model.predict([in0Mul74319,in1Mul74319],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep6309.png')

LMul74319 = multiply_layer([[[[0.1684, 0.1796], [0.6193, 0.5534]]], [[[0.8927, 0.5484], [0.3412, 0.1274]]]], Mul74319), 
LRes63696 = reshape_layer(Mul74319, [2, 2, 1], Res63696), 
LSep6309 = separable_conv2D_layer(Res63696, 1, 2,[[[[[0.1599]], [[0.2222]]]],[[[[0.5433, 0.7945, 0.2539]]]]],[0, 0, 0], 1, 1, false, Sep6309), 
exec_layers([LMul74319,LRes63696,LSep6309],["Mul74319","Res63696","Sep6309"],Sep6309,"Sep6309")

Actual (Unparsed): [[[[0.0249499, 0.0364858, 0.0116598]], [[0.0268681, 0.0392908, 0.0125562]]]]

Expected (Unparsed): [[[[0.024949933486722,0.03648577610013,0.011659834552326002]],[[0.0268680850483188,0.039290803554001996,0.0125562429482204]]]]

Actual:   [[[[0.025, 0.0365, 0.0117]], [[0.0269, 0.0393, 0.0126]]]]

Expected: [[[[0.025, 0.0365, 0.0117]], [[0.0269, 0.0393, 0.0126]]]]