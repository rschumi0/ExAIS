import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo77651 = tf.keras.layers.Input(shape=([1, 1, 1]))

Glo77651 = keras.layers.GlobalMaxPool2D(name = 'Glo77651', )(in0Glo77651)
Res96348 = keras.layers.Reshape((1, 1), name = 'Res96348', )(Glo77651)
Res13094 = keras.layers.Reshape((1, 1, 1), name = 'Res13094', )(Res96348)
Res38291 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res38291', )(Res13094)
Glo87927 = keras.layers.GlobalAveragePooling3D(name = 'Glo87927', )(Res38291)
Res33283 = keras.layers.Reshape((1, 1), name = 'Res33283', )(Glo87927)
Res9691 = keras.layers.Reshape((1, 1, 1), name = 'Res9691', )(Res33283)
Dep82839 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep82839', )(Res9691)
Sof47075 = keras.layers.Softmax(axis=1, name = 'Sof47075', )(Dep82839)
model = tf.keras.models.Model(inputs=[in0Glo77651], outputs=Sof47075)
w = model.get_layer('Dep82839').get_weights() 
w[0] = np.array([[[[0.8686]]]])
w[1] = np.array([0])
model.get_layer('Dep82839').set_weights(w) 
in0Glo77651 = tf.constant([[[[1.9525]]]])
print (np.array2string(model.predict([in0Glo77651],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof47075.png')

LGlo77651 = global_max_pool2D_layer([[[[1.9525]]]], Glo77651), 
LRes96348 = reshape_layer(Glo77651, [1, 1], Res96348), 
LRes13094 = reshape_layer(Res96348, [1, 1, 1], Res13094), 
LRes38291 = reshape_layer(Res13094, [1, 1, 1, 1], Res38291), 
LGlo87927 = global_average_pooling3D_layer(Res38291, Glo87927), 
LRes33283 = reshape_layer(Glo87927, [1, 1], Res33283), 
LRes9691 = reshape_layer(Res33283, [1, 1, 1], Res9691), 
LDep82839 = depthwise_conv2D_layer(Res9691, 1, 1,[[[[0.8686]]]],[0], 1, 1, true, Dep82839), 
LSof47075 = softmax_layer(Dep82839, 1, Sof47075), 
exec_layers([LGlo77651,LRes96348,LRes13094,LRes38291,LGlo87927,LRes33283,LRes9691,LDep82839,LSof47075],["Glo77651","Res96348","Res13094","Res38291","Glo87927","Res33283","Res9691","Dep82839","Sof47075"],Sof47075,"Sof47075")

Actual (Unparsed): [[[[1.0000000]]]]

Expected (Unparsed): [[[[1.0]]]]

Actual:   [[[[1]]]]

Expected: [[[[1]]]]