import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave96645 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave96645 = tf.keras.layers.Input(shape=([2, 1]))
in0Con21542 = tf.keras.layers.Input(shape=([2, 1]))
in0Min94542 = tf.keras.layers.Input(shape=([2, 2]))
in1Min94542 = tf.keras.layers.Input(shape=([2, 2]))

Ave96645 = keras.layers.Average(name = 'Ave96645', )([in0Ave96645,in1Ave96645])
Res24551 = keras.layers.Reshape((2, 1, 1), name = 'Res24551', )(Ave96645)
Ave98854 = keras.layers.AveragePooling2D(pool_size=(2, 1), name = 'Ave98854', )(Res24551)
Res42845 = keras.layers.Reshape((1, 1), name = 'Res42845', )(Ave98854)
Zer43981 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer43981', )(Res42845)
Con21542 = keras.layers.Concatenate(axis=2, name = 'Con21542', )([Zer43981,in0Con21542])
Min94542 = keras.layers.Minimum(name = 'Min94542', )([in0Min94542,in1Min94542])
Mul67253 = keras.layers.Multiply(name = 'Mul67253', )([Con21542,Min94542])
Sep1839 = keras.layers.SeparableConv1D(3, (2),strides=(1), padding='valid', name = 'Sep1839', )(Mul67253)
model = tf.keras.models.Model(inputs=[in0Ave96645,in1Ave96645,in0Con21542,in0Min94542,in1Min94542], outputs=Sep1839)
w = model.get_layer('Sep1839').get_weights() 
w[0] = np.array([[[0.7103], [0.574]], [[0.5201], [0.1457]]])
w[1] = np.array([[[0.5984, 0.89, 0.8106], [0.2005, 0.776, 0.2792]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep1839').set_weights(w) 
in0Ave96645 = tf.constant([[[0.7649], [0.3488]]])
in1Ave96645 = tf.constant([[[0.8655], [0.2839]]])
in0Con21542 = tf.constant([[[0.8571], [0.4366]]])
in0Min94542 = tf.constant([[[0.1965, 0.0233], [0.05, 0.8984]]])
in1Min94542 = tf.constant([[[0.5336, 0.1542], [0.1372, 0.8469]]])
print (np.array2string(model.predict([in0Ave96645,in1Ave96645,in0Con21542,in0Min94542,in1Min94542],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep1839.png')

LAve96645 = average_layer([[[[0.7649], [0.3488]]], [[[0.8655], [0.2839]]]], Ave96645), 
LRes24551 = reshape_layer(Ave96645, [2, 1, 1], Res24551), 
LAve98854 = average_pooling2D_layer(Res24551, 2, 1, Ave98854), 
LRes42845 = reshape_layer(Ave98854, [1, 1], Res42845), 
LZer43981 = zero_padding1D_layer(Res42845, 1, 0, Zer43981), 
LCon21542 = concatenate_layer([Zer43981,[[[0.8571], [0.4366]]]], 2, Con21542), 
LMin94542 = minimum_layer([[[[0.1965, 0.0233], [0.05, 0.8984]]], [[[0.5336, 0.1542], [0.1372, 0.8469]]]], Min94542), 
LMul67253 = multiply_layer([Con21542,Min94542], Mul67253), 
LSep1839 = separable_conv1D_layer(Mul67253, 2,[[[[0.7103], [0.574]], [[0.5201], [0.1457]]],[[[0.5984, 0.89, 0.8106], [0.2005, 0.776, 0.2792]]]],[0, 0, 0], 1, false, Sep1839), 
exec_layers([LAve96645,LRes24551,LAve98854,LRes42845,LZer43981,LCon21542,LMin94542,LMul67253,LSep1839],["Ave96645","Res24551","Ave98854","Res42845","Zer43981","Con21542","Min94542","Mul67253","Sep1839"],Sep1839,"Sep1839")

Actual (Unparsed): [[[0.0219042, 0.0637957, 0.0301683]]]

Expected (Unparsed): [[[0.021904225775749,0.063795717644398,0.0301683067477566]]]

Actual:   [[[0.022, 0.0638, 0.0302]]]

Expected: [[[0.022, 0.0638, 0.0302]]]