import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot59257 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot59257 = tf.keras.layers.Input(shape=([3, 3]))

Dot59257 = keras.layers.Dot(axes=(1, 1), name = 'Dot59257', )([in0Dot59257,in1Dot59257])
PRe49814 = keras.layers.PReLU(name = 'PRe49814', )(Dot59257)
model = tf.keras.models.Model(inputs=[in0Dot59257,in1Dot59257], outputs=PRe49814)
w = model.get_layer('PRe49814').get_weights() 
w[0] = np.array([[0.8437, 0.8608, 0.5008], [0.2243, 0.0965, 0.5198], [0.4989, 0.1873, 0.5701]])
model.get_layer('PRe49814').set_weights(w) 
in0Dot59257 = tf.constant([[[0.0603, 0.8918, 0.6782], [0.1775, 0.48, 0.8161], [0.9152, 0.2537, 0.7562]]])
in1Dot59257 = tf.constant([[[0.4118, 0.5545, 0.572], [0.7631, 0.3024, 0.5329], [0.3901, 0.0829, 0.6783]]])
print (np.array2string(model.predict([in0Dot59257,in1Dot59257],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe49814.png')

LDot59257 = dot_layer([[[0.0603, 0.8918, 0.6782], [0.1775, 0.48, 0.8161], [0.9152, 0.2537, 0.7562]]], [[[0.4118, 0.5545, 0.572], [0.7631, 0.3024, 0.5329], [0.3901, 0.0829, 0.6783]]], 1, 1, Dot59257), 
LPRe49814 = prelu_layer(Dot59257, [[0.8437, 0.8608, 0.5008], [0.2243, 0.0965, 0.5198], [0.4989, 0.1873, 0.5701]], PRe49814), 
exec_layers([LDot59257,LPRe49814],["Dot59257","PRe49814"],PRe49814,"PRe49814")

Actual (Unparsed): [[[0.5173013, 0.1629824, 0.7498615], [0.8324996, 0.6606868, 0.9379863], [1.1970423, 0.6855395, 1.3357606]]]

Expected (Unparsed): [[[0.51730131,0.16298243,0.74986151],[0.8324996100000001,0.6606868300000001,0.93798631],[1.1970422900000002,0.68553952,1.33576055]]]

Actual:   [[[0.5174, 0.163, 0.7499], [0.8325, 0.6607, 0.938], [1.1971, 0.6856, 1.3358]]]

Expected: [[[0.5174, 0.163, 0.7499], [0.8325, 0.6607, 0.938], [1.1971, 0.6856, 1.3358]]]