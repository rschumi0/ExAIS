import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave77041 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave77041 = tf.keras.layers.Input(shape=([1, 1, 2]))

Ave77041 = keras.layers.Average(name = 'Ave77041', )([in0Ave77041,in1Ave77041])
Bat80388 = keras.layers.BatchNormalization(axis=3, epsilon=0.7861025060771694,  name = 'Bat80388', )(Ave77041)
Res67668 = keras.layers.Reshape((1, 2), name = 'Res67668', )(Bat80388)
Sep88868 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep88868', )(Res67668)
model = tf.keras.models.Model(inputs=[in0Ave77041,in1Ave77041], outputs=Sep88868)
w = model.get_layer('Bat80388').get_weights() 
w[0] = np.array([0.3989, 0.2618])
w[1] = np.array([0.5063, 0.4124])
w[2] = np.array([0.8368, 0.8562])
w[3] = np.array([0.5814, 0.5296])
model.get_layer('Bat80388').set_weights(w) 
w = model.get_layer('Sep88868').get_weights() 
w[0] = np.array([[[0.9721], [0.7104]]])
w[1] = np.array([[[0.0053, 0.2657, 0.4075, 0.1684], [0.8908, 0.5128, 0.3732, 0.0688]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep88868').set_weights(w) 
in0Ave77041 = tf.constant([[[[0.1832, 0.3681]]]])
in1Ave77041 = tf.constant([[[[0.4354, 0.7977]]]])
print (np.array2string(model.predict([in0Ave77041,in1Ave77041],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep88868.png')

LAve77041 = average_layer([[[[[0.1832, 0.3681]]]], [[[[0.4354, 0.7977]]]]], Ave77041), 
LBat80388 = batch_normalization_layer(Ave77041, 3, 0.7861025060771694, [0.3989, 0.2618], [0.5063, 0.4124], [0.8368, 0.8562], [0.5814, 0.5296], Bat80388), 
LRes67668 = reshape_layer(Bat80388, [1, 2], Res67668), 
LSep88868 = separable_conv1D_layer(Res67668, 1,[[[[0.9721], [0.7104]]],[[[0.0053, 0.2657, 0.4075, 0.1684], [0.8908, 0.5128, 0.3732, 0.0688]]]],[0, 0, 0, 0], 1, false, Sep88868), 
exec_layers([LAve77041,LBat80388,LRes67668,LSep88868],["Ave77041","Bat80388","Res67668","Sep88868"],Sep88868,"Sep88868")

Actual (Unparsed): [[[0.2231840, 0.2118058, 0.2220804, 0.0705335]]]

Expected (Unparsed): [[[0.223183987547033,0.21180576068701779,0.22208041800090886,0.07053353988204239]]]

Actual:   [[[0.2232, 0.2119, 0.2221, 0.0706]]]

Expected: [[[0.2232, 0.2119, 0.2221, 0.0706]]]