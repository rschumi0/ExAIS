import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro70337 = tf.keras.layers.Input(shape=([4, 2, 4, 4]))
in0Per63861 = tf.keras.layers.Input(shape=([2, 2]))
in0Con84321 = tf.keras.layers.Input(shape=([4, 4, 2, 3]))

Cro70337 = keras.layers.Cropping3D(cropping=((3, 0), (0, 1), (2, 0)), name = 'Cro70337', )(in0Cro70337)
Zer62433 = keras.layers.ZeroPadding3D(padding=((3, 0), (3, 0), (0, 0)), name = 'Zer62433', )(Cro70337)
Per63861 = keras.layers.Permute((1,2), name = 'Per63861',)(in0Per63861)
Res76819 = keras.layers.Reshape((2, 2, 1), name = 'Res76819', )(Per63861)
Res22438 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res22438', )(Res76819)
Up_68272 = keras.layers.UpSampling3D(size=(2, 2, 2), name = 'Up_68272', )(Res22438)
Con84321 = keras.layers.Concatenate(axis=4, name = 'Con84321', )([Up_68272,in0Con84321])
Sub73722 = keras.layers.Subtract(name = 'Sub73722', )([Zer62433,Con84321])
model = tf.keras.models.Model(inputs=[in0Cro70337,in0Per63861,in0Con84321], outputs=Sub73722)
in0Cro70337 = tf.constant([[[[[1.542, 1.9019, 1.2701, 1.3542], [1.1914, 1.6069, 1.1503, 1.7856], [1.3341, 1.4782, 1.8494, 1.8148], [1.8767, 1.2097, 1.9462, 1.3794]], [[1.3483, 1.872, 1.182, 1.6331], [1.096, 1.3895, 1.75, 1.6009], [1.3613, 1.8627, 1.1805, 1.3391], [1.1943, 1.6788, 1.9796, 1.9668]]], [[[1.1673, 1.365, 1.0119, 1.9019], [1.7601, 1.311, 1.8586, 1.2574], [1.1059, 1.809, 1.0264, 1.6313], [1.5137, 1.3438, 1.9344, 1.4575]], [[1.8074, 1.7003, 1.0657, 1.6783], [1.0641, 1.2537, 1.5325, 1.7426], [1.7707, 1.753, 1.5761, 1.8405], [1.7722, 1.0198, 1.198, 1.8428]]], [[[1.6343, 1.2424, 1.203, 1.6298], [1.2093, 1.968, 1.4238, 1.3668], [1.2567, 1.4697, 1.791, 1.8107], [1.949, 1.8936, 1.217, 1.9178]], [[1.967, 1.4856, 1.9668, 1.864], [1.6807, 1.2331, 1.3052, 1.0827], [1.6003, 1.465, 1.7307, 1.0847], [1.8824, 1.3037, 1.0311, 1.6273]]], [[[1.1809, 1.3788, 1.731, 1.2709], [1.5426, 1.8808, 1.239, 1.4803], [1.3666, 1.8569, 1.149, 1.2091], [1.6679, 1.6331, 1.7016, 1.3357]], [[1.0174, 1.3869, 1.3688, 1.4157], [1.5658, 1.1834, 1.8899, 1.9584], [1.5013, 1.2435, 1.8587, 1.8395], [1.1398, 1.8166, 1.1348, 1.5235]]]]])
in0Per63861 = tf.constant([[[1.6015, 1.7918], [1.9397, 1.4824]]])
in0Con84321 = tf.constant([[[[[0.2741, 0.2292, 0.4048], [0.3396, 0.5241, 0.6058]], [[0.0338, 0.9699, 0.3588], [0.1865, 0.9753, 0.1511]], [[0.1739, 0.2145, 0.8868], [0.74, 0.9892, 0.3957]], [[0.2236, 0.0633, 0.7837], [0.704, 0.0486, 0.5044]]], [[[0.5074, 0.3124, 0.4902], [0.0127, 0.5016, 0.5398]], [[0.1932, 0.7098, 0.9149], [0.7189, 0.3493, 0.8]], [[0.5864, 0.1896, 0.668], [0.8067, 0.7791, 0.2008]], [[0.9558, 0.7491, 0.0966], [0.3633, 0.8067, 0.2512]]], [[[0.8924, 0.4402, 0.2772], [0.7321, 0.4883, 0.6807]], [[0.3159, 0.764, 0.5612], [0.6107, 0.1518, 0.4054]], [[0.1273, 0.177, 0.8032], [0.818, 0.6542, 0.4085]], [[0.366, 0.7553, 0.9688], [0.3068, 0.7629, 0.5792]]], [[[0.789, 0.5063, 0.1901], [0.3011, 0.9083, 0.3558]], [[0.5862, 0.7719, 0.2862], [0.4635, 0.0659, 0.5535]], [[0.5582, 0.4214, 0.4105], [0.1911, 0.769, 0.3793]], [[0.3861, 0.5752, 0.4529], [0.372, 0.8769, 0.836]]]]])
print (np.array2string(model.predict([in0Cro70337,in0Per63861,in0Con84321],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub73722.png')

LCro70337 = cropping3D_layer([[[[[1.542, 1.9019, 1.2701, 1.3542], [1.1914, 1.6069, 1.1503, 1.7856], [1.3341, 1.4782, 1.8494, 1.8148], [1.8767, 1.2097, 1.9462, 1.3794]], [[1.3483, 1.872, 1.182, 1.6331], [1.096, 1.3895, 1.75, 1.6009], [1.3613, 1.8627, 1.1805, 1.3391], [1.1943, 1.6788, 1.9796, 1.9668]]], [[[1.1673, 1.365, 1.0119, 1.9019], [1.7601, 1.311, 1.8586, 1.2574], [1.1059, 1.809, 1.0264, 1.6313], [1.5137, 1.3438, 1.9344, 1.4575]], [[1.8074, 1.7003, 1.0657, 1.6783], [1.0641, 1.2537, 1.5325, 1.7426], [1.7707, 1.753, 1.5761, 1.8405], [1.7722, 1.0198, 1.198, 1.8428]]], [[[1.6343, 1.2424, 1.203, 1.6298], [1.2093, 1.968, 1.4238, 1.3668], [1.2567, 1.4697, 1.791, 1.8107], [1.949, 1.8936, 1.217, 1.9178]], [[1.967, 1.4856, 1.9668, 1.864], [1.6807, 1.2331, 1.3052, 1.0827], [1.6003, 1.465, 1.7307, 1.0847], [1.8824, 1.3037, 1.0311, 1.6273]]], [[[1.1809, 1.3788, 1.731, 1.2709], [1.5426, 1.8808, 1.239, 1.4803], [1.3666, 1.8569, 1.149, 1.2091], [1.6679, 1.6331, 1.7016, 1.3357]], [[1.0174, 1.3869, 1.3688, 1.4157], [1.5658, 1.1834, 1.8899, 1.9584], [1.5013, 1.2435, 1.8587, 1.8395], [1.1398, 1.8166, 1.1348, 1.5235]]]]], 3, 0, 0, 1, 2, 0, Cro70337), 
LZer62433 = zero_padding3D_layer(Cro70337, 3, 0, 3, 0, 0, 0, Zer62433), 
LPer63861 = permute_layer([[[1.6015, 1.7918], [1.9397, 1.4824]]], 1,2, Per63861), 
LRes76819 = reshape_layer(Per63861, [2, 2, 1], Res76819), 
LRes22438 = reshape_layer(Res76819, [2, 2, 1, 1], Res22438), 
LUp_68272 = up_sampling3D_layer(Res22438, 2, 2, 2, Up_68272), 
LCon84321 = concatenate_layer([Up_68272,[[[[[0.2741, 0.2292, 0.4048], [0.3396, 0.5241, 0.6058]], [[0.0338, 0.9699, 0.3588], [0.1865, 0.9753, 0.1511]], [[0.1739, 0.2145, 0.8868], [0.74, 0.9892, 0.3957]], [[0.2236, 0.0633, 0.7837], [0.704, 0.0486, 0.5044]]], [[[0.5074, 0.3124, 0.4902], [0.0127, 0.5016, 0.5398]], [[0.1932, 0.7098, 0.9149], [0.7189, 0.3493, 0.8]], [[0.5864, 0.1896, 0.668], [0.8067, 0.7791, 0.2008]], [[0.9558, 0.7491, 0.0966], [0.3633, 0.8067, 0.2512]]], [[[0.8924, 0.4402, 0.2772], [0.7321, 0.4883, 0.6807]], [[0.3159, 0.764, 0.5612], [0.6107, 0.1518, 0.4054]], [[0.1273, 0.177, 0.8032], [0.818, 0.6542, 0.4085]], [[0.366, 0.7553, 0.9688], [0.3068, 0.7629, 0.5792]]], [[[0.789, 0.5063, 0.1901], [0.3011, 0.9083, 0.3558]], [[0.5862, 0.7719, 0.2862], [0.4635, 0.0659, 0.5535]], [[0.5582, 0.4214, 0.4105], [0.1911, 0.769, 0.3793]], [[0.3861, 0.5752, 0.4529], [0.372, 0.8769, 0.836]]]]]], 4, Con84321), 
LSub73722 = subtract_layer(Zer62433,Con84321, Sub73722), 
exec_layers([LCro70337,LZer62433,LPer63861,LRes76819,LRes22438,LUp_68272,LCon84321,LSub73722],["Cro70337","Zer62433","Per63861","Res76819","Res22438","Up_68272","Con84321","Sub73722"],Sub73722,"Sub73722")

Actual (Unparsed): [[[[[-1.6015000, -0.2741000, -0.2292000, -0.4048000], [-1.6015000, -0.3396000, -0.5241000, -0.6058000]], [[-1.6015000, -0.0338000, -0.9699000, -0.3588000], [-1.6015000, -0.1865000, -0.9753000, -0.1511000]], [[-1.7918000, -0.1739000, -0.2145000, -0.8868000], [-1.7918000, -0.7400000, -0.9892000, -0.3957000]], [[-1.7918000, -0.2236000, -0.0633000, -0.7837000], [-1.7918000, -0.7040000, -0.0486000, -0.5044000]]], [[[-1.6015000, -0.5074000, -0.3124000, -0.4902000], [-1.6015000, -0.0127000, -0.5016000, -0.5398000]], [[-1.6015000, -0.1932000, -0.7098000, -0.9149000], [-1.6015000, -0.7189000, -0.3493000, -0.8000000]], [[-1.7918000, -0.5864000, -0.1896000, -0.6680000], [-1.7918000, -0.8067000, -0.7791000, -0.2008000]], [[-1.7918000, -0.9558000, -0.7491000, -0.0966000], [-1.7918000, -0.3633000, -0.8067000, -0.2512000]]], [[[-1.9397000, -0.8924000, -0.4402000, -0.2772000], [-1.9397000, -0.7321000, -0.4883000, -0.6807000]], [[-1.9397000, -0.3159000, -0.7640000, -0.5612000], [-1.9397000, -0.6107000, -0.1518000, -0.4054000]], [[-1.4823999, -0.1273000, -0.1770000, -0.8032000], [-1.4823999, -0.8180000, -0.6542000, -0.4085000]], [[-1.4823999, -0.3660000, -0.7553000, -0.9688000], [-1.4823999, -0.3068000, -0.7629000, -0.5792000]]], [[[-1.9397000, -0.7890000, -0.5063000, -0.1901000], [-1.9397000, -0.3011000, -0.9083000, -0.3558000]], [[-1.9397000, -0.5862000, -0.7719000, -0.2862000], [-1.9397000, -0.4635000, -0.0659000, -0.5535000]], [[-1.4823999, -0.5582000, -0.4214000, -0.4105000], [-1.4823999, -0.1911000, -0.7690000, -0.3793000]], [[-0.1157999, 1.4708000, 0.5738000, 0.7562000], [0.1855000, 1.2611000, 0.8246999, 0.4997000]]]]]

Expected (Unparsed): [[[[[-1.6015,-0.2741,-0.2292,-0.4048],[-1.6015,-0.3396,-0.5241,-0.6058]],[[-1.6015,-0.0338,-0.9699,-0.3588],[-1.6015,-0.1865,-0.9753,-0.1511]],[[-1.7918,-0.1739,-0.2145,-0.8868],[-1.7918,-0.74,-0.9892,-0.3957]],[[-1.7918,-0.2236,-0.0633,-0.7837],[-1.7918,-0.704,-0.0486,-0.5044]]],[[[-1.6015,-0.5074,-0.3124,-0.4902],[-1.6015,-0.0127,-0.5016,-0.5398]],[[-1.6015,-0.1932,-0.7098,-0.9149],[-1.6015,-0.7189,-0.3493,-0.8]],[[-1.7918,-0.5864,-0.1896,-0.668],[-1.7918,-0.8067,-0.7791,-0.2008]],[[-1.7918,-0.9558,-0.7491,-0.0966],[-1.7918,-0.3633,-0.8067,-0.2512]]],[[[-1.9397,-0.8924,-0.4402,-0.2772],[-1.9397,-0.7321,-0.4883,-0.6807]],[[-1.9397,-0.3159,-0.764,-0.5612],[-1.9397,-0.6107,-0.1518,-0.4054]],[[-1.4824,-0.1273,-0.177,-0.8032],[-1.4824,-0.818,-0.6542,-0.4085]],[[-1.4824,-0.366,-0.7553,-0.9688],[-1.4824,-0.3068,-0.7629,-0.5792]]],[[[-1.9397,-0.789,-0.5063,-0.1901],[-1.9397,-0.3011,-0.9083,-0.3558]],[[-1.9397,-0.5862,-0.7719,-0.2862],[-1.9397,-0.4635,-0.0659,-0.5535]],[[-1.4824,-0.5582,-0.4214,-0.4105],[-1.4824,-0.1911,-0.769,-0.3793]],[[-0.1157999999999999,1.4708,0.5738,0.7562],[0.1855,1.2610999999999999,0.8247,0.49970000000000014]]]]]

Actual:   [[[[[-1.6015, -0.2741, -0.2292, -0.4048], [-1.6015, -0.3396, -0.5241, -0.6058]], [[-1.6015, -0.0338, -0.9699, -0.3588], [-1.6015, -0.1865, -0.9753, -0.1511]], [[-1.7918, -0.1739, -0.2145, -0.8868], [-1.7918, -0.74, -0.9892, -0.3957]], [[-1.7918, -0.2236, -0.0633, -0.7837], [-1.7918, -0.704, -0.0486, -0.5044]]], [[[-1.6015, -0.5074, -0.3124, -0.4902], [-1.6015, -0.0127, -0.5016, -0.5398]], [[-1.6015, -0.1932, -0.7098, -0.9149], [-1.6015, -0.7189, -0.3493, -0.8]], [[-1.7918, -0.5864, -0.1896, -0.668], [-1.7918, -0.8067, -0.7791, -0.2008]], [[-1.7918, -0.9558, -0.7491, -0.0966], [-1.7918, -0.3633, -0.8067, -0.2512]]], [[[-1.9397, -0.8924, -0.4402, -0.2772], [-1.9397, -0.7321, -0.4883, -0.6807]], [[-1.9397, -0.3159, -0.764, -0.5612], [-1.9397, -0.6107, -0.1518, -0.4054]], [[-1.4823, -0.1273, -0.177, -0.8032], [-1.4823, -0.818, -0.6542, -0.4085]], [[-1.4823, -0.366, -0.7553, -0.9688], [-1.4823, -0.3068, -0.7629, -0.5792]]], [[[-1.9397, -0.789, -0.5063, -0.1901], [-1.9397, -0.3011, -0.9083, -0.3558]], [[-1.9397, -0.5862, -0.7719, -0.2862], [-1.9397, -0.4635, -0.0659, -0.5535]], [[-1.4823, -0.5582, -0.4214, -0.4105], [-1.4823, -0.1911, -0.769, -0.3793]], [[-0.1157, 1.4708, 0.5738, 0.7562], [0.1855, 1.2611, 0.8247, 0.4997]]]]]

Expected: [[[[[-1.6015, -0.2741, -0.2292, -0.4048], [-1.6015, -0.3396, -0.5241, -0.6058]], [[-1.6015, -0.0338, -0.9699, -0.3588], [-1.6015, -0.1865, -0.9753, -0.1511]], [[-1.7918, -0.1739, -0.2145, -0.8868], [-1.7918, -0.74, -0.9892, -0.3957]], [[-1.7918, -0.2236, -0.0633, -0.7837], [-1.7918, -0.704, -0.0486, -0.5044]]], [[[-1.6015, -0.5074, -0.3124, -0.4902], [-1.6015, -0.0127, -0.5016, -0.5398]], [[-1.6015, -0.1932, -0.7098, -0.9149], [-1.6015, -0.7189, -0.3493, -0.8]], [[-1.7918, -0.5864, -0.1896, -0.668], [-1.7918, -0.8067, -0.7791, -0.2008]], [[-1.7918, -0.9558, -0.7491, -0.0966], [-1.7918, -0.3633, -0.8067, -0.2512]]], [[[-1.9397, -0.8924, -0.4402, -0.2772], [-1.9397, -0.7321, -0.4883, -0.6807]], [[-1.9397, -0.3159, -0.764, -0.5612], [-1.9397, -0.6107, -0.1518, -0.4054]], [[-1.4824, -0.1273, -0.177, -0.8032], [-1.4824, -0.818, -0.6542, -0.4085]], [[-1.4824, -0.366, -0.7553, -0.9688], [-1.4824, -0.3068, -0.7629, -0.5792]]], [[[-1.9397, -0.789, -0.5063, -0.1901], [-1.9397, -0.3011, -0.9083, -0.3558]], [[-1.9397, -0.5862, -0.7719, -0.2862], [-1.9397, -0.4635, -0.0659, -0.5535]], [[-1.4824, -0.5582, -0.4214, -0.4105], [-1.4824, -0.1911, -0.769, -0.3793]], [[-0.1157, 1.4708, 0.5738, 0.7562], [0.1855, 1.2611, 0.8247, 0.4998]]]]]