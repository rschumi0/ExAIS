import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dep39766 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Max87956 = tf.keras.layers.Input(shape=([1, 1]))
in1Max87956 = tf.keras.layers.Input(shape=([1, 1]))

Dep39766 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep39766', )(in0Dep39766)
Glo41665 = keras.layers.GlobalMaxPool2D(name = 'Glo41665', )(Dep39766)
Res43851 = keras.layers.Reshape((2, 1), name = 'Res43851', )(Glo41665)
Zer41454 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer41454', )(Res43851)
Max87956 = keras.layers.Maximum(name = 'Max87956', )([in0Max87956,in1Max87956])
Res96937 = keras.layers.Reshape((1, 1, 1), name = 'Res96937', )(Max87956)
Con20950 = keras.layers.Conv2D(3, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con20950', )(Res96937)
Res34356 = keras.layers.Reshape((1, 3), name = 'Res34356', )(Con20950)
Dot11538 = keras.layers.Dot(axes=(1, 2), name = 'Dot11538', )([Zer41454,Res34356])
model = tf.keras.models.Model(inputs=[in0Dep39766,in0Max87956,in1Max87956], outputs=Dot11538)
w = model.get_layer('Dep39766').get_weights() 
w[0] = np.array([[[[0.8026], [0.9745]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep39766').set_weights(w) 
w = model.get_layer('Con20950').get_weights() 
w[0] = np.array([[[[0.8575, 0.1992, 0.9283]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con20950').set_weights(w) 
in0Dep39766 = tf.constant([[[[0.3574, 0.4723]]]])
in0Max87956 = tf.constant([[[0.7987]]])
in1Max87956 = tf.constant([[[0.5167]]])
print (np.array2string(model.predict([in0Dep39766,in0Max87956,in1Max87956],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot11538.png')

LDep39766 = depthwise_conv2D_layer([[[[0.3574, 0.4723]]]], 1, 1,[[[[0.8026], [0.9745]]]],[0, 0], 1, 1, true, Dep39766), 
LGlo41665 = global_max_pool2D_layer(Dep39766, Glo41665), 
LRes43851 = reshape_layer(Glo41665, [2, 1], Res43851), 
LZer41454 = zero_padding1D_layer(Res43851, 1, 0, Zer41454), 
LMax87956 = maximum_layer([[[[0.7987]]], [[[0.5167]]]], Max87956), 
LRes96937 = reshape_layer(Max87956, [1, 1, 1], Res96937), 
LCon20950 = conv2D_layer(Res96937, 1, 1,[[[[0.8575, 0.1992, 0.9283]]]],[0, 0, 0], 1, 1, true, 1, 1, Con20950), 
LRes34356 = reshape_layer(Con20950, [1, 3], Res34356), 
LDot11538 = dot_layer(Zer41454,Res34356, 1, 2, Dot11538), 
exec_layers([LDep39766,LGlo41665,LRes43851,LZer41454,LMax87956,LRes96937,LCon20950,LRes34356,LDot11538],["Dep39766","Glo41665","Res43851","Zer41454","Max87956","Res96937","Con20950","Res34356","Dot11538"],Dot11538,"Dot11538")

Actual (Unparsed): [[[0.3868873]]]

Expected (Unparsed): [[[0.3868873554105931]]]

Actual:   [[[0.3869]]]

Expected: [[[0.3869]]]