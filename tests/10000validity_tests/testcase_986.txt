import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave32026 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Ave32026 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Min60368 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Min60368 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Con8264 = tf.keras.layers.Input(shape=([7]))

Ave32026 = keras.layers.Average(name = 'Ave32026', )([in0Ave32026,in1Ave32026])
Res44888 = keras.layers.Reshape((1, 2, 4), name = 'Res44888', )(Ave32026)
Res60183 = keras.layers.Reshape((1, 8), name = 'Res60183', )(Res44888)
Fla49512 = keras.layers.Flatten(name = 'Fla49512', )(Res60183)
Min60368 = keras.layers.Minimum(name = 'Min60368', )([in0Min60368,in1Min60368])
Lay44107 = keras.layers.LayerNormalization(axis=2, epsilon=2.7877984448000914, name = 'Lay44107', )(Min60368)
Res28179 = keras.layers.Reshape((1, 2, 4), name = 'Res28179', )(Lay44107)
Res92403 = keras.layers.Reshape((1, 8), name = 'Res92403', )(Res28179)
Res27073 = keras.layers.Reshape((1, 8, 1), name = 'Res27073', )(Res92403)
Res82870 = keras.layers.Reshape((1, 8, 1, 1), name = 'Res82870', )(Res27073)
Glo92617 = keras.layers.GlobalMaxPool3D(name = 'Glo92617', )(Res82870)
Con8264 = keras.layers.Concatenate(axis=1, name = 'Con8264', )([Glo92617,in0Con8264])
Max69504 = keras.layers.Maximum(name = 'Max69504', )([Fla49512,Con8264])
model = tf.keras.models.Model(inputs=[in0Ave32026,in1Ave32026,in0Min60368,in1Min60368,in0Con8264], outputs=Max69504)
in0Ave32026 = tf.constant([[[[[0.4421, 0.1452], [0.6773, 0.2228]], [[0.913, 0.425], [0.5352, 0.6094]]]]])
in1Ave32026 = tf.constant([[[[[0.971, 0.2643], [0.2236, 0.9447]], [[0.2352, 0.1319], [0.0802, 0.5012]]]]])
in0Min60368 = tf.constant([[[[[0.4457, 0.1745], [0.5814, 0.5299]], [[0.8246, 0.7484], [0.0885, 0.5543]]]]])
in1Min60368 = tf.constant([[[[[0.2028, 0.2858], [0.6368, 0.9821]], [[0.3598, 0.9682], [0.0344, 0.6731]]]]])
in0Con8264 = tf.constant([[0.315, 0.4516, 0.4086, 0.2691, 0.5819, 0.453, 0.9844]])
print (np.array2string(model.predict([in0Ave32026,in1Ave32026,in0Min60368,in1Min60368,in0Con8264],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max69504.png')

LAve32026 = average_layer([[[[[[0.4421, 0.1452], [0.6773, 0.2228]], [[0.913, 0.425], [0.5352, 0.6094]]]]], [[[[[0.971, 0.2643], [0.2236, 0.9447]], [[0.2352, 0.1319], [0.0802, 0.5012]]]]]], Ave32026), 
LRes44888 = reshape_layer(Ave32026, [1, 2, 4], Res44888), 
LRes60183 = reshape_layer(Res44888, [1, 8], Res60183), 
LFla49512 = flatten_layer(Res60183, Fla49512), 
LMin60368 = minimum_layer([[[[[[0.4457, 0.1745], [0.5814, 0.5299]], [[0.8246, 0.7484], [0.0885, 0.5543]]]]], [[[[[0.2028, 0.2858], [0.6368, 0.9821]], [[0.3598, 0.9682], [0.0344, 0.6731]]]]]], Min60368), 
LLay44107 = layer_normalization_layer(Min60368, 2, 2.7877984448000914, Lay44107), 
LRes28179 = reshape_layer(Lay44107, [1, 2, 4], Res28179), 
LRes92403 = reshape_layer(Res28179, [1, 8], Res92403), 
LRes27073 = reshape_layer(Res92403, [1, 8, 1], Res27073), 
LRes82870 = reshape_layer(Res27073, [1, 8, 1, 1], Res82870), 
LGlo92617 = global_max_pool3D_layer(Res82870, Glo92617), 
LCon8264 = concatenate_layer([Glo92617,[[0.315, 0.4516, 0.4086, 0.2691, 0.5819, 0.453, 0.9844]]], 1, Con8264), 
LMax69504 = maximum_layer([Fla49512,Con8264], Max69504), 
exec_layers([LAve32026,LRes44888,LRes60183,LFla49512,LMin60368,LLay44107,LRes28179,LRes92403,LRes27073,LRes82870,LGlo92617,LCon8264,LMax69504],["Ave32026","Res44888","Res60183","Fla49512","Min60368","Lay44107","Res28179","Res92403","Res27073","Res82870","Glo92617","Con8264","Max69504"],Max69504,"Max69504")

Actual (Unparsed): [[0.7065500, 0.3150000, 0.4516000, 0.5837500, 0.5741000, 0.5819000, 0.4530000, 0.9844000]]

Expected (Unparsed): [[0.70655,0.315,0.4516,0.58375,0.5741,0.5819,0.453,0.9844]]

Actual:   [[0.7066, 0.315, 0.4516, 0.5838, 0.5741, 0.5819, 0.453, 0.9844]]

Expected: [[0.7066, 0.315, 0.4516, 0.5838, 0.5741, 0.5819, 0.453, 0.9844]]