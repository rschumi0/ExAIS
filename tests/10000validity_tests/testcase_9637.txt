import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul17417 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul17417 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Max62584 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max62584 = tf.keras.layers.Input(shape=([2, 2, 1]))

Mul17417 = keras.layers.Multiply(name = 'Mul17417', )([in0Mul17417,in1Mul17417])
Res55499 = keras.layers.Reshape((2, 1), name = 'Res55499', )(Mul17417)
Zer17847 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer17847', )(Res55499)
Res23297 = keras.layers.Reshape((4, 1, 1), name = 'Res23297', )(Zer17847)
Res67618 = keras.layers.Reshape((4, 1, 1, 1), name = 'Res67618', )(Res23297)
Glo99554 = keras.layers.GlobalMaxPool3D(name = 'Glo99554', )(Res67618)
Res67315 = keras.layers.Reshape((1, 1), name = 'Res67315', )(Glo99554)
Res99543 = keras.layers.Reshape((1, 1, 1), name = 'Res99543', )(Res67315)
Zer46970 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer46970', )(Res99543)
Max62584 = keras.layers.Maximum(name = 'Max62584', )([in0Max62584,in1Max62584])
Sub73425 = keras.layers.Subtract(name = 'Sub73425', )([Zer46970,Max62584])
model = tf.keras.models.Model(inputs=[in0Mul17417,in1Mul17417,in0Max62584,in1Max62584], outputs=Sub73425)
in0Mul17417 = tf.constant([[[[0.7897]], [[0.3785]]]])
in1Mul17417 = tf.constant([[[[0.0321]], [[0.3961]]]])
in0Max62584 = tf.constant([[[[0.9016], [0.8598]], [[0.7735], [0.7415]]]])
in1Max62584 = tf.constant([[[[0.8418], [0.7758]], [[0.5667], [0.9966]]]])
print (np.array2string(model.predict([in0Mul17417,in1Mul17417,in0Max62584,in1Max62584],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub73425.png')

LMul17417 = multiply_layer([[[[[0.7897]], [[0.3785]]]], [[[[0.0321]], [[0.3961]]]]], Mul17417), 
LRes55499 = reshape_layer(Mul17417, [2, 1], Res55499), 
LZer17847 = zero_padding1D_layer(Res55499, 1, 1, Zer17847), 
LRes23297 = reshape_layer(Zer17847, [4, 1, 1], Res23297), 
LRes67618 = reshape_layer(Res23297, [4, 1, 1, 1], Res67618), 
LGlo99554 = global_max_pool3D_layer(Res67618, Glo99554), 
LRes67315 = reshape_layer(Glo99554, [1, 1], Res67315), 
LRes99543 = reshape_layer(Res67315, [1, 1, 1], Res99543), 
LZer46970 = zero_padding2D_layer(Res99543, 1, 0, 1, 0, Zer46970), 
LMax62584 = maximum_layer([[[[[0.9016], [0.8598]], [[0.7735], [0.7415]]]], [[[[0.8418], [0.7758]], [[0.5667], [0.9966]]]]], Max62584), 
LSub73425 = subtract_layer(Zer46970,Max62584, Sub73425), 
exec_layers([LMul17417,LRes55499,LZer17847,LRes23297,LRes67618,LGlo99554,LRes67315,LRes99543,LZer46970,LMax62584,LSub73425],["Mul17417","Res55499","Zer17847","Res23297","Res67618","Glo99554","Res67315","Res99543","Zer46970","Max62584","Sub73425"],Sub73425,"Sub73425")

Actual (Unparsed): [[[[-0.9016000], [-0.8598000]], [[-0.7735000], [-0.8466761]]]]

Expected (Unparsed): [[[[-0.9016],[-0.8598]],[[-0.7735],[-0.8466761500000001]]]]

Actual:   [[[[-0.9016], [-0.8598]], [[-0.7735], [-0.8466]]]]

Expected: [[[[-0.9016], [-0.8598]], [[-0.7735], [-0.8466]]]]