import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min26674 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min26674 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con43410 = tf.keras.layers.Input(shape=([1, 8]))
in0Min94410 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Min94410 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Bat35770 = tf.keras.layers.Input(shape=([2, 2]))

Min26674 = keras.layers.Minimum(name = 'Min26674', )([in0Min26674,in1Min26674])
Res89378 = keras.layers.Reshape((1, 4), name = 'Res89378', )(Min26674)
Con43410 = keras.layers.Concatenate(axis=2, name = 'Con43410', )([Res89378,in0Con43410])
Min94410 = keras.layers.Minimum(name = 'Min94410', )([in0Min94410,in1Min94410])
Res49807 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res49807', )(Min94410)
Con97915 = keras.layers.Conv3DTranspose(2, (1, 1, 2),strides=(1, 1, 1), padding='valid', name = 'Con97915', )(Res49807)
Res59949 = keras.layers.Reshape((1, 2, 6), name = 'Res59949', )(Con97915)
Res97786 = keras.layers.Reshape((1, 12), name = 'Res97786', )(Res59949)
Dot27501 = keras.layers.Dot(axes=(2, 2), name = 'Dot27501', )([Con43410,Res97786])
Fla42307 = keras.layers.Flatten(name = 'Fla42307', )(Dot27501)
Bat35770 = keras.layers.BatchNormalization(axis=1, epsilon=0.4510198629731963,  name = 'Bat35770', )(in0Bat35770)
Res57840 = keras.layers.Reshape((2, 2, 1), name = 'Res57840', )(Bat35770)
Glo78752 = keras.layers.GlobalAveragePooling2D(name = 'Glo78752', )(Res57840)
Min30596 = keras.layers.Minimum(name = 'Min30596', )([Fla42307,Glo78752])
model = tf.keras.models.Model(inputs=[in0Min26674,in1Min26674,in0Con43410,in0Min94410,in1Min94410,in0Bat35770], outputs=Min30596)
w = model.get_layer('Con97915').get_weights() 
w[0] = np.array([[[[[0.8696], [0.7573]], [[0.937], [0.8788]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con97915').set_weights(w) 
w = model.get_layer('Bat35770').get_weights() 
w[0] = np.array([0.9736, 0.5138])
w[1] = np.array([0.5443, 0.0949])
w[2] = np.array([0.1138, 0.6623])
w[3] = np.array([0.0692, 0.2513])
model.get_layer('Bat35770').set_weights(w) 
in0Min26674 = tf.constant([[[[0.0354, 0.543], [0.831, 0.647]]]])
in1Min26674 = tf.constant([[[[0.0446, 0.977], [0.8568, 0.4114]]]])
in0Con43410 = tf.constant([[[0.6756, 0.04, 0.6699, 0.9102, 0.7373, 0.028, 0.2823, 0.5951]]])
in0Min94410 = tf.constant([[[[0.2713, 0.6033], [0.6708, 0.752]]]])
in1Min94410 = tf.constant([[[[0.3877, 0.3339], [0.5022, 0.9246]]]])
in0Bat35770 = tf.constant([[[1.1839, 1.2744], [1.8018, 1.1212]]])
print (np.array2string(model.predict([in0Min26674,in1Min26674,in0Con43410,in0Min94410,in1Min94410,in0Bat35770],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min30596.png')

LMin26674 = minimum_layer([[[[[0.0354, 0.543], [0.831, 0.647]]]], [[[[0.0446, 0.977], [0.8568, 0.4114]]]]], Min26674), 
LRes89378 = reshape_layer(Min26674, [1, 4], Res89378), 
LCon43410 = concatenate_layer([Res89378,[[[0.6756, 0.04, 0.6699, 0.9102, 0.7373, 0.028, 0.2823, 0.5951]]]], 2, Con43410), 
LMin94410 = minimum_layer([[[[[0.2713, 0.6033], [0.6708, 0.752]]]], [[[[0.3877, 0.3339], [0.5022, 0.9246]]]]], Min94410), 
LRes49807 = reshape_layer(Min94410, [1, 2, 2, 1], Res49807), 
LCon97915 = conv3D_transpose_layer(Res49807, 1, 1, 2,[[[[[0.8696], [0.7573]], [[0.937], [0.8788]]]]],[0, 0], 1, 1, 1, false, Con97915), 
LRes59949 = reshape_layer(Con97915, [1, 2, 6], Res59949), 
LRes97786 = reshape_layer(Res59949, [1, 12], Res97786), 
LDot27501 = dot_layer(Con43410,Res97786, 2, 2, Dot27501), 
LFla42307 = flatten_layer(Dot27501, Fla42307), 
LBat35770 = batch_normalization_layer([[[1.1839, 1.2744], [1.8018, 1.1212]]], 1, 0.4510198629731963, [0.9736, 0.5138], [0.5443, 0.0949], [0.1138, 0.6623], [0.0692, 0.2513], Bat35770), 
LRes57840 = reshape_layer(Bat35770, [2, 2, 1], Res57840), 
LGlo78752 = global_average_pooling2D_layer(Res57840, Glo78752), 
LMin30596 = minimum_layer([Fla42307,Glo78752], Min30596), 
exec_layers([LMin26674,LRes89378,LCon43410,LMin94410,LRes49807,LCon97915,LRes59949,LRes97786,LDot27501,LFla42307,LBat35770,LRes57840,LGlo78752,LMin30596],["Min26674","Res89378","Con43410","Min94410","Res49807","Con97915","Res59949","Res97786","Dot27501","Fla42307","Bat35770","Res57840","Glo78752","Min30596"],Min30596,"Min30596")

Actual (Unparsed): [[1.3173725]]

Expected (Unparsed): [[1.3173724665699282]]

Actual:   [[1.3174]]

Expected: [[1.3174]]