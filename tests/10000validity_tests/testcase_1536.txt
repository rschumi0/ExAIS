import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave28376 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Ave28376 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Glo51304 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con85543 = tf.keras.layers.Input(shape=([3]))

Ave28376 = keras.layers.Average(name = 'Ave28376', )([in0Ave28376,in1Ave28376])
Res29663 = keras.layers.Reshape((1, 1, 4), name = 'Res29663', )(Ave28376)
Res35224 = keras.layers.Reshape((1, 4), name = 'Res35224', )(Res29663)
Fla32196 = keras.layers.Flatten(name = 'Fla32196', )(Res35224)
Glo51304 = keras.layers.GlobalMaxPool2D(name = 'Glo51304', )(in0Glo51304)
Con85543 = keras.layers.Concatenate(axis=1, name = 'Con85543', )([Glo51304,in0Con85543])
Mul25848 = keras.layers.Multiply(name = 'Mul25848', )([Fla32196,Con85543])
Fla28308 = keras.layers.Flatten(name = 'Fla28308', )(Mul25848)
model = tf.keras.models.Model(inputs=[in0Ave28376,in1Ave28376,in0Glo51304,in0Con85543], outputs=Fla28308)
in0Ave28376 = tf.constant([[[[[0.8351, 0.2253], [0.8753, 0.1167]]]]])
in1Ave28376 = tf.constant([[[[[0.3206, 0.545], [0.8542, 0.6916]]]]])
in0Glo51304 = tf.constant([[[[1.2545], [1.7415]]]])
in0Con85543 = tf.constant([[0.3168, 0.8861, 0.2877]])
print (np.array2string(model.predict([in0Ave28376,in1Ave28376,in0Glo51304,in0Con85543],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla28308.png')

LAve28376 = average_layer([[[[[[0.8351, 0.2253], [0.8753, 0.1167]]]]], [[[[[0.3206, 0.545], [0.8542, 0.6916]]]]]], Ave28376), 
LRes29663 = reshape_layer(Ave28376, [1, 1, 4], Res29663), 
LRes35224 = reshape_layer(Res29663, [1, 4], Res35224), 
LFla32196 = flatten_layer(Res35224, Fla32196), 
LGlo51304 = global_max_pool2D_layer([[[[1.2545], [1.7415]]]], Glo51304), 
LCon85543 = concatenate_layer([Glo51304,[[0.3168, 0.8861, 0.2877]]], 1, Con85543), 
LMul25848 = multiply_layer([Fla32196,Con85543], Mul25848), 
LFla28308 = flatten_layer(Mul25848, Fla28308), 
exec_layers([LAve28376,LRes29663,LRes35224,LFla32196,LGlo51304,LCon85543,LMul25848,LFla28308],["Ave28376","Res29663","Res35224","Fla32196","Glo51304","Con85543","Mul25848","Fla28308"],Fla28308,"Fla28308")

Actual (Unparsed): [[1.0063258, 0.1220155, 0.7662550, 0.1162740]]

Expected (Unparsed): [[1.006325775,0.12201552,0.766254975,0.11627395500000001]]

Actual:   [[1.0064, 0.1221, 0.7663, 0.1163]]

Expected: [[1.0064, 0.1221, 0.7663, 0.1163]]