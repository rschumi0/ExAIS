import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat268 = tf.keras.layers.Input(shape=([2, 4, 4]))

Bat268 = keras.layers.BatchNormalization(axis=1, epsilon=0.22450883423711154,  name = 'Bat268', )(in0Bat268)
Loc13194 = keras.layers.LocallyConnected2D(2, (2, 1),strides=(1, 7), name = 'Loc13194', )(Bat268)
Res69307 = keras.layers.Reshape((1, 2), name = 'Res69307', )(Loc13194)
Loc29246 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc29246', )(Res69307)
model = tf.keras.models.Model(inputs=[in0Bat268], outputs=Loc29246)
w = model.get_layer('Bat268').get_weights() 
w[0] = np.array([0.4725, 0.3714])
w[1] = np.array([0.0344, 0.0666])
w[2] = np.array([0.8586, 0.4451])
w[3] = np.array([0.3665, 0.7509])
model.get_layer('Bat268').set_weights(w) 
w = model.get_layer('Loc13194').get_weights() 
w[0] = np.array([[[0.4621, 0.0496], [0.6193, 0.6777], [0.4614, 0.8314], [0.05, 0.6406], [0.9614, 0.264], [0.2841, 0.1915], [0.3188, 0.105], [0.4477, 0.3975]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc13194').set_weights(w) 
w = model.get_layer('Loc29246').get_weights() 
w[0] = np.array([[[0.2408, 0.3763, 0.9695, 0.0448], [0.9702, 0.6924, 0.4294, 0.3739]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc29246').set_weights(w) 
in0Bat268 = tf.constant([[[[1.5869, 1.3946, 1.9638, 1.2182], [1.9412, 1.1742, 1.2571, 1.7271], [1.1612, 1.6156, 1.8366, 1.3212], [1.0915, 1.5856, 1.1288, 1.4725]], [[1.0871, 1.5793, 1.0559, 1.9465], [1.4804, 1.401, 1.3156, 1.9613], [1.1903, 1.3448, 1.8971, 1.9165], [1.105, 1.8216, 1.6532, 1.8344]]]])
print (np.array2string(model.predict([in0Bat268],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc29246.png')

LBat268 = batch_normalization_layer([[[[1.5869, 1.3946, 1.9638, 1.2182], [1.9412, 1.1742, 1.2571, 1.7271], [1.1612, 1.6156, 1.8366, 1.3212], [1.0915, 1.5856, 1.1288, 1.4725]], [[1.0871, 1.5793, 1.0559, 1.9465], [1.4804, 1.401, 1.3156, 1.9613], [1.1903, 1.3448, 1.8971, 1.9165], [1.105, 1.8216, 1.6532, 1.8344]]]], 1, 0.22450883423711154, [0.4725, 0.3714], [0.0344, 0.0666], [0.8586, 0.4451], [0.3665, 0.7509], Bat268), 
LLoc13194 = locally_connected2D_layer(Bat268, 2, 1,[[[0.4621, 0.0496], [0.6193, 0.6777], [0.4614, 0.8314], [0.05, 0.6406], [0.9614, 0.264], [0.2841, 0.1915], [0.3188, 0.105], [0.4477, 0.3975]]],[[[0, 0]]], 1, 7, Loc13194), 
LRes69307 = reshape_layer(Loc13194, [1, 2], Res69307), 
LLoc29246 = locally_connected1D_layer(Res69307, 1,[[[0.2408, 0.3763, 0.9695, 0.0448], [0.9702, 0.6924, 0.4294, 0.3739]]],[[0, 0, 0, 0]], 1, Loc29246), 
exec_layers([LBat268,LLoc13194,LRes69307,LLoc29246],["Bat268","Loc13194","Res69307","Loc29246"],Loc29246,"Loc29246")

Actual (Unparsed): [[[1.8270556, 1.6317248, 2.1922546, 0.6271544]]]

Expected (Unparsed): [[[1.8270556715544792,1.6317247732110536,2.1922546279004846,0.6271543757502526]]]

Actual:   [[[1.8271, 1.6318, 2.1923, 0.6272]]]

Expected: [[[1.8271, 1.6318, 2.1923, 0.6272]]]