import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot4559 = tf.keras.layers.Input(shape=([2]))
in1Dot4559 = tf.keras.layers.Input(shape=([2]))
in0Max42605 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Max42605 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Dot4559 = keras.layers.Dot(axes=(1, 1), name = 'Dot4559', )([in0Dot4559,in1Dot4559])
Res17832 = keras.layers.Reshape((1, 1), name = 'Res17832', )(Dot4559)
Con88784 = keras.layers.Conv1D(3, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con88784', )(Res17832)
Res53843 = keras.layers.Reshape((1, 3, 1), name = 'Res53843', )(Con88784)
Res34380 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res34380', )(Res53843)
Max42605 = keras.layers.Maximum(name = 'Max42605', )([in0Max42605,in1Max42605])
Zer98465 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer98465', )(Max42605)
Sub25653 = keras.layers.Subtract(name = 'Sub25653', )([Res34380,Zer98465])
model = tf.keras.models.Model(inputs=[in0Dot4559,in1Dot4559,in0Max42605,in1Max42605], outputs=Sub25653)
w = model.get_layer('Con88784').get_weights() 
w[0] = np.array([[[0.1747, 0.1004, 0.8509]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con88784').set_weights(w) 
in0Dot4559 = tf.constant([[0.8604, 0.9505]])
in1Dot4559 = tf.constant([[0.8194, 0.7549]])
in0Max42605 = tf.constant([[[[[0.1008]]]]])
in1Max42605 = tf.constant([[[[[0.7824]]]]])
print (np.array2string(model.predict([in0Dot4559,in1Dot4559,in0Max42605,in1Max42605],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub25653.png')

LDot4559 = dot_layer([[0.8604, 0.9505]], [[0.8194, 0.7549]], 1, 1, Dot4559), 
LRes17832 = reshape_layer(Dot4559, [1, 1], Res17832), 
LCon88784 = conv1D_layer(Res17832, 1,[[[0.1747, 0.1004, 0.8509]]],[0, 0, 0], 1, false, 1, Con88784), 
LRes53843 = reshape_layer(Con88784, [1, 3, 1], Res53843), 
LRes34380 = reshape_layer(Res53843, [1, 3, 1, 1], Res34380), 
LMax42605 = maximum_layer([[[[[[0.1008]]]]], [[[[[0.7824]]]]]], Max42605), 
LZer98465 = zero_padding3D_layer(Max42605, 0, 0, 2, 0, 0, 0, Zer98465), 
LSub25653 = subtract_layer(Res34380,Zer98465, Sub25653), 
exec_layers([LDot4559,LRes17832,LCon88784,LRes53843,LRes34380,LMax42605,LZer98465,LSub25653],["Dot4559","Res17832","Con88784","Res53843","Res34380","Max42605","Zer98465","Sub25653"],Sub25653,"Sub25653")

Actual (Unparsed): [[[[[0.2485185]], [[0.1428234]], [[0.4280429]]]]]

Expected (Unparsed): [[[[[0.248518473487]],[[0.14282343868400002]],[[0.42804286828900007]]]]]

Actual:   [[[[[0.2486]], [[0.1429]], [[0.4281]]]]]

Expected: [[[[[0.2486]], [[0.1429]], [[0.4281]]]]]