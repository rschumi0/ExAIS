import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave98871 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave98871 = tf.keras.layers.Input(shape=([1, 2]))

Ave98871 = keras.layers.Average(name = 'Ave98871', )([in0Ave98871,in1Ave98871])
Mas47891 = keras.layers.Masking(mask_value=1, name = 'Mas47891', )(Ave98871)
PRe36493 = keras.layers.PReLU(name = 'PRe36493', )(Mas47891)
Res15324 = keras.layers.Reshape((1, 2, 1), name = 'Res15324', )(PRe36493)
Max18605 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Max18605', )(Res15324)
Res86711 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res86711', )(Max18605)
Con59939 = keras.layers.Conv3D(4, (1, 2, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con59939', )(Res86711)
model = tf.keras.models.Model(inputs=[in0Ave98871,in1Ave98871], outputs=Con59939)
w = model.get_layer('PRe36493').get_weights() 
w[0] = np.array([[0.9858, 0.3832]])
model.get_layer('PRe36493').set_weights(w) 
w = model.get_layer('Con59939').get_weights() 
w[0] = np.array([[[[[0.6508, 0.4218, 0.4727, 0.5875]]], [[[0.7446, 0.9519, 0.9991, 0.5446]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con59939').set_weights(w) 
in0Ave98871 = tf.constant([[[0.6165, 0.6145]]])
in1Ave98871 = tf.constant([[[0.0082, 0.6099]]])
print (np.array2string(model.predict([in0Ave98871,in1Ave98871],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con59939.png')

LAve98871 = average_layer([[[[0.6165, 0.6145]]], [[[0.0082, 0.6099]]]], Ave98871), 
LMas47891 = masking_layer(Ave98871, 1, Mas47891), 
LPRe36493 = prelu_layer(Mas47891, [[0.9858, 0.3832]], PRe36493), 
LRes15324 = reshape_layer(PRe36493, [1, 2, 1], Res15324), 
LMax18605 = max_pool2D_layer(Res15324, 1, 1, 1, 1, true, Max18605), 
LRes86711 = reshape_layer(Max18605, [1, 2, 1, 1], Res86711), 
LCon59939 = conv3D_layer(Res86711, 1, 2, 1,[[[[[0.6508, 0.4218, 0.4727, 0.5875]]], [[[0.7446, 0.9519, 0.9991, 0.5446]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con59939), 
exec_layers([LAve98871,LMas47891,LPRe36493,LRes15324,LMax18605,LRes86711,LCon59939],["Ave98871","Mas47891","PRe36493","Res15324","Max18605","Res86711","Con59939"],Con59939,"Con59939")

Actual (Unparsed): [[[[[0.6591215, 0.7145024, 0.7592969, 0.5169097]]]]]

Expected (Unparsed): [[[[[0.6591215000000001,0.7145024100000001,0.759296865,0.516909745]]]]]

Actual:   [[[[[0.6592, 0.7146, 0.7593, 0.517]]]]]

Expected: [[[[[0.6592, 0.7146, 0.7593, 0.517]]]]]