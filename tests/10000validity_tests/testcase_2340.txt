import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub47360 = tf.keras.layers.Input(shape=([3]))
in1Sub47360 = tf.keras.layers.Input(shape=([3]))

Sub47360 = keras.layers.Subtract(name = 'Sub47360', )([in0Sub47360,in1Sub47360])
Res60863 = keras.layers.Reshape((3, 1), name = 'Res60863', )(Sub47360)
Res51606 = keras.layers.Reshape((3, 1, 1), name = 'Res51606', )(Res60863)
Res61034 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res61034', )(Res51606)
Glo99570 = keras.layers.GlobalMaxPool3D(name = 'Glo99570', )(Res61034)
Res34914 = keras.layers.Reshape((1, 1), name = 'Res34914', )(Glo99570)
Res29875 = keras.layers.Reshape((1, 1, 1), name = 'Res29875', )(Res34914)
Con29011 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con29011', )(Res29875)
model = tf.keras.models.Model(inputs=[in0Sub47360,in1Sub47360], outputs=Con29011)
w = model.get_layer('Con29011').get_weights() 
w[0] = np.array([[[[0.4049, 0.1484]]]])
w[1] = np.array([0, 0])
model.get_layer('Con29011').set_weights(w) 
in0Sub47360 = tf.constant([[0.9204, 0.1431, 0.8896]])
in1Sub47360 = tf.constant([[0.6737, 0.3039, 0.7244]])
print (np.array2string(model.predict([in0Sub47360,in1Sub47360],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con29011.png')

LSub47360 = subtract_layer([[0.9204, 0.1431, 0.8896]], [[0.6737, 0.3039, 0.7244]], Sub47360), 
LRes60863 = reshape_layer(Sub47360, [3, 1], Res60863), 
LRes51606 = reshape_layer(Res60863, [3, 1, 1], Res51606), 
LRes61034 = reshape_layer(Res51606, [3, 1, 1, 1], Res61034), 
LGlo99570 = global_max_pool3D_layer(Res61034, Glo99570), 
LRes34914 = reshape_layer(Glo99570, [1, 1], Res34914), 
LRes29875 = reshape_layer(Res34914, [1, 1, 1], Res29875), 
LCon29011 = conv2D_layer(Res29875, 1, 1,[[[[0.4049, 0.1484]]]],[0, 0], 1, 1, true, 1, 1, Con29011), 
exec_layers([LSub47360,LRes60863,LRes51606,LRes61034,LGlo99570,LRes34914,LRes29875,LCon29011],["Sub47360","Res60863","Res51606","Res61034","Glo99570","Res34914","Res29875","Con29011"],Con29011,"Con29011")

Actual (Unparsed): [[[[0.0998888, 0.0366103]]]]

Expected (Unparsed): [[[[0.09988883000000001,0.03661028000000001]]]]

Actual:   [[[[0.0999, 0.0367]]]]

Expected: [[[[0.0999, 0.0367]]]]