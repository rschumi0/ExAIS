import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo49636 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Max53159 = tf.keras.layers.Input(shape=([2, 1]))
in1Max53159 = tf.keras.layers.Input(shape=([2, 1]))
in0Con91095 = tf.keras.layers.Input(shape=([3, 3, 2]))
in0Sub602 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub602 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Add90674 = tf.keras.layers.Input(shape=([1, 1]))
in1Add90674 = tf.keras.layers.Input(shape=([1, 1]))
in0Con86075 = tf.keras.layers.Input(shape=([3, 8]))

Glo49636 = keras.layers.GlobalAveragePooling3D(name = 'Glo49636', )(in0Glo49636)
Max53159 = keras.layers.Maximum(name = 'Max53159', )([in0Max53159,in1Max53159])
GRU80139 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU80139', )(Max53159)
Res43510 = keras.layers.Reshape((2, 1), name = 'Res43510', )(GRU80139)
Res27452 = keras.layers.Reshape((2, 1, 1), name = 'Res27452', )(Res43510)
Zer90478 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer90478', )(Res27452)
Con91095 = keras.layers.Concatenate(axis=3, name = 'Con91095', )([Zer90478,in0Con91095])
Sub602 = keras.layers.Subtract(name = 'Sub602', )([in0Sub602,in1Sub602])
Min1334 = keras.layers.Minimum(name = 'Min1334', )([Con91095,Sub602])
Res98208 = keras.layers.Reshape((3, 9), name = 'Res98208', )(Min1334)
Add90674 = keras.layers.Add(name = 'Add90674', )([in0Add90674,in1Add90674])
Zer22144 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer22144', )(Add90674)
Con86075 = keras.layers.Concatenate(axis=2, name = 'Con86075', )([Zer22144,in0Con86075])
Add71780 = keras.layers.Add(name = 'Add71780', )([Res98208,Con86075])
Sim16497 = keras.layers.SimpleRNN(2,name = 'Sim16497', )(Add71780)
Ave12773 = keras.layers.Average(name = 'Ave12773', )([Glo49636,Sim16497])
model = tf.keras.models.Model(inputs=[in0Glo49636,in0Max53159,in1Max53159,in0Con91095,in0Sub602,in1Sub602,in0Add90674,in1Add90674,in0Con86075], outputs=Ave12773)
w = model.get_layer('GRU80139').get_weights() 
w[0] = np.array([[7, 6, 3, 4, 1, 9]])
w[1] = np.array([[10, 1, 9, 6, 7, 6], [8, 4, 5, 6, 5, 6]])
w[2] = np.array([[6, 7, 8, 3, 2, 1], [9, 4, 8, 8, 6, 8]])
model.get_layer('GRU80139').set_weights(w) 
w = model.get_layer('Sim16497').get_weights() 
w[0] = np.array([[7, 8], [2, 10], [2, 3], [7, 3], [3, 9], [10, 7], [3, 6], [6, 10], [4, 2]])
w[1] = np.array([[5, 2], [1, 9]])
w[2] = np.array([5, 3])
model.get_layer('Sim16497').set_weights(w) 
in0Glo49636 = tf.constant([[[[[1.5023, 1.3844], [1.0906, 1.6892]]]]])
in0Max53159 = tf.constant([[[0.8732], [0.3417]]])
in1Max53159 = tf.constant([[[0.7218], [0.1304]]])
in0Con91095 = tf.constant([[[[0.009, 0.9339], [0.3533, 0.4391], [0.3376, 0.7411]], [[0.5486, 0.8443], [0.5424, 0.4519], [0.4047, 0.4445]], [[0.7438, 0.189], [0.8729, 0.9221], [0.9152, 0.0289]]]])
in0Sub602 = tf.constant([[[[0.6018, 0.0785, 0.9367], [0.5407, 0.6681, 0.5315], [0.5, 0.5491, 0.3237]], [[0.708, 0.6864, 0.5371], [0.9781, 0.4654, 0.4941], [0.686, 0.8047, 0.6867]], [[0.6878, 0.414, 0.9019], [0.5, 0.0882, 0.6785], [0.2718, 0.9135, 0.602]]]])
in1Sub602 = tf.constant([[[[0.6016, 0.8464, 0.7351], [0.5857, 0.1471, 0.277], [0.9293, 0.2716, 0.1214]], [[0.234, 0.6281, 0.1485], [0.6035, 0.5166, 0.8563], [0.387, 0.0157, 0.3571]], [[0.6579, 0.6271, 0.4417], [0.9273, 0.7179, 0.7015], [0.4703, 0.1996, 0.7617]]]])
in0Add90674 = tf.constant([[[0.1631]]])
in1Add90674 = tf.constant([[[0.7953]]])
in0Con86075 = tf.constant([[[0.0704, 0.9765, 0.8729, 0.968, 0.0705, 0.8478, 0.744, 0.0622], [0.9248, 0.7806, 0.7254, 0.0867, 0.3462, 0.8548, 0.0616, 0.9339], [0.8153, 0.6335, 0.6316, 0.6759, 0.8591, 0.2077, 0.1266, 0.9062]]])
print (np.array2string(model.predict([in0Glo49636,in0Max53159,in1Max53159,in0Con91095,in0Sub602,in1Sub602,in0Add90674,in1Add90674,in0Con86075],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave12773.png')

LGlo49636 = global_average_pooling3D_layer([[[[[1.5023, 1.3844], [1.0906, 1.6892]]]]], Glo49636), 
LMax53159 = maximum_layer([[[[0.8732], [0.3417]]], [[[0.7218], [0.1304]]]], Max53159), 
LGRU80139 = gru_layer(Max53159,[[7, 6, 3, 4, 1, 9]],[[10, 1, 9, 6, 7, 6], [8, 4, 5, 6, 5, 6]],[[6, 7, 8, 3, 2, 1], [9, 4, 8, 8, 6, 8]], true, GRU80139), 
LRes43510 = reshape_layer(GRU80139, [2, 1], Res43510), 
LRes27452 = reshape_layer(Res43510, [2, 1, 1], Res27452), 
LZer90478 = zero_padding2D_layer(Res27452, 1, 0, 2, 0, Zer90478), 
LCon91095 = concatenate_layer([Zer90478,[[[[0.009, 0.9339], [0.3533, 0.4391], [0.3376, 0.7411]], [[0.5486, 0.8443], [0.5424, 0.4519], [0.4047, 0.4445]], [[0.7438, 0.189], [0.8729, 0.9221], [0.9152, 0.0289]]]]], 3, Con91095), 
LSub602 = subtract_layer([[[[0.6018, 0.0785, 0.9367], [0.5407, 0.6681, 0.5315], [0.5, 0.5491, 0.3237]], [[0.708, 0.6864, 0.5371], [0.9781, 0.4654, 0.4941], [0.686, 0.8047, 0.6867]], [[0.6878, 0.414, 0.9019], [0.5, 0.0882, 0.6785], [0.2718, 0.9135, 0.602]]]], [[[[0.6016, 0.8464, 0.7351], [0.5857, 0.1471, 0.277], [0.9293, 0.2716, 0.1214]], [[0.234, 0.6281, 0.1485], [0.6035, 0.5166, 0.8563], [0.387, 0.0157, 0.3571]], [[0.6579, 0.6271, 0.4417], [0.9273, 0.7179, 0.7015], [0.4703, 0.1996, 0.7617]]]], Sub602), 
LMin1334 = minimum_layer([Con91095,Sub602], Min1334), 
LRes98208 = reshape_layer(Min1334, [3, 9], Res98208), 
LAdd90674 = add_layer([[[[0.1631]]], [[[0.7953]]]], Add90674), 
LZer22144 = zero_padding1D_layer(Add90674, 2, 0, Zer22144), 
LCon86075 = concatenate_layer([Zer22144,[[[0.0704, 0.9765, 0.8729, 0.968, 0.0705, 0.8478, 0.744, 0.0622], [0.9248, 0.7806, 0.7254, 0.0867, 0.3462, 0.8548, 0.0616, 0.9339], [0.8153, 0.6335, 0.6316, 0.6759, 0.8591, 0.2077, 0.1266, 0.9062]]]], 2, Con86075), 
LAdd71780 = add_layer([Res98208,Con86075], Add71780), 
LSim16497 = simple_rnn_layer(Add71780,[[7, 8], [2, 10], [2, 3], [7, 3], [3, 9], [10, 7], [3, 6], [6, 10], [4, 2]],[[5, 2], [1, 9]],[5, 3], Sim16497), 
LAve12773 = average_layer([Glo49636,Sim16497], Ave12773), 
exec_layers([LGlo49636,LMax53159,LGRU80139,LRes43510,LRes27452,LZer90478,LCon91095,LSub602,LMin1334,LRes98208,LAdd90674,LZer22144,LCon86075,LAdd71780,LSim16497,LAve12773],["Glo49636","Max53159","GRU80139","Res43510","Res27452","Zer90478","Con91095","Sub602","Min1334","Res98208","Add90674","Zer22144","Con86075","Add71780","Sim16497","Ave12773"],Ave12773,"Ave12773")

Actual (Unparsed): [[1.1482250, 1.2684000]]

Expected (Unparsed): [[1.148225,1.2684]]

Actual:   [[1.1483, 1.2684]]

Expected: [[1.1483, 1.2684]]