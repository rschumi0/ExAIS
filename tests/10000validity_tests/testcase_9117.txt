import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo90132 = tf.keras.layers.Input(shape=([2, 2]))

Glo90132 = keras.layers.GlobalMaxPool1D(name = 'Glo90132', )(in0Glo90132)
Bat13103 = keras.layers.BatchNormalization(axis=1, epsilon=0.42598802751730636,  name = 'Bat13103', )(Glo90132)
ReL10792 = keras.layers.ReLU(max_value=8.031668047377762, negative_slope=1.2294813461381733, threshold=7.07760995567413, name = 'ReL10792', )(Bat13103)
Res25271 = keras.layers.Reshape((2, 1), name = 'Res25271', )(ReL10792)
Res88873 = keras.layers.Reshape((2, 1, 1), name = 'Res88873', )(Res25271)
Sep22147 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep22147', )(Res88873)
model = tf.keras.models.Model(inputs=[in0Glo90132], outputs=Sep22147)
w = model.get_layer('Bat13103').get_weights() 
w[0] = np.array([0.8514, 0.4596])
w[1] = np.array([0.6099, 0.1287])
w[2] = np.array([0.9075, 0.1811])
w[3] = np.array([0.1658, 0.8103])
model.get_layer('Bat13103').set_weights(w) 
w = model.get_layer('Sep22147').get_weights() 
w[0] = np.array([[[[0.1206]]]])
w[1] = np.array([[[[0.5746, 0.3807, 0.1201]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep22147').set_weights(w) 
in0Glo90132 = tf.constant([[[1.4002, 1.3029], [1.6744, 1.8482]]])
print (np.array2string(model.predict([in0Glo90132],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep22147.png')

LGlo90132 = global_max_pool1D_layer([[[1.4002, 1.3029], [1.6744, 1.8482]]], Glo90132), 
LBat13103 = batch_normalization_layer(Glo90132, 1, 0.42598802751730636, [0.8514, 0.4596], [0.6099, 0.1287], [0.9075, 0.1811], [0.1658, 0.8103], Bat13103), 
LReL10792 = relu_layer(Bat13103, 8.031668047377762, 1.2294813461381733, 7.07760995567413, ReL10792), 
LRes25271 = reshape_layer(ReL10792, [2, 1], Res25271), 
LRes88873 = reshape_layer(Res25271, [2, 1, 1], Res88873), 
LSep22147 = separable_conv2D_layer(Res88873, 1, 1,[[[[[0.1206]]]],[[[[0.5746, 0.3807, 0.1201]]]]],[0, 0, 0], 1, 1, true, Sep22147), 
exec_layers([LGlo90132,LBat13103,LReL10792,LRes25271,LRes88873,LSep22147],["Glo90132","Bat13103","ReL10792","Res25271","Res88873","Sep22147"],Sep22147,"Sep22147")

Actual (Unparsed): [[[[-0.4787286, -0.3171806, -0.1000614]], [[-0.5333301, -0.3533567, -0.1114740]]]]

Expected (Unparsed): [[[[-0.4787286004409172,-0.3171806094463229,-0.10006144259128812]],[[-0.5333300656291804,-0.3533566933258423,-0.11147396603213465]]]]

Actual:   [[[[-0.4787, -0.3171, -0.1]], [[-0.5333, -0.3533, -0.1114]]]]

Expected: [[[[-0.4787, -0.3171, -0.1]], [[-0.5333, -0.3533, -0.1114]]]]