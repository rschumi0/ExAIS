import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con54997 = tf.keras.layers.Input(shape=([2, 2, 2]))

Con54997 = keras.layers.Conv2D(2, (2, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con54997', )(in0Con54997)
Res88755 = keras.layers.Reshape((1, 4), name = 'Res88755', )(Con54997)
Res25489 = keras.layers.Reshape((1, 4, 1), name = 'Res25489', )(Res88755)
Cro15815 = keras.layers.Cropping2D(cropping=((0, 0), (3, 0)), name = 'Cro15815', )(Res25489)
Res84341 = keras.layers.Reshape((1, 1), name = 'Res84341', )(Cro15815)
Max33506 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='valid', name = 'Max33506', )(Res84341)
model = tf.keras.models.Model(inputs=[in0Con54997], outputs=Max33506)
w = model.get_layer('Con54997').get_weights() 
w[0] = np.array([[[[0.5502, 0.779], [0.6069, 0.7384]]], [[[0.1318, 0.4052], [0.3354, 0.2792]]]])
w[1] = np.array([0, 0])
model.get_layer('Con54997').set_weights(w) 
in0Con54997 = tf.constant([[[[0.2519, 0.037], [0.0128, 0.477]], [[0.3118, 0.0278], [0.3713, 0.2337]]]])
print (np.array2string(model.predict([in0Con54997],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max33506.png')

LCon54997 = conv2D_layer([[[[0.2519, 0.037], [0.0128, 0.477]], [[0.3118, 0.0278], [0.3713, 0.2337]]]], 2, 1,[[[[0.5502, 0.779], [0.6069, 0.7384]]], [[[0.1318, 0.4052], [0.3354, 0.2792]]]],[0, 0], 1, 1, false, 1, 1, Con54997), 
LRes88755 = reshape_layer(Con54997, [1, 4], Res88755), 
LRes25489 = reshape_layer(Res88755, [1, 4, 1], Res25489), 
LCro15815 = cropping2D_layer(Res25489, 0, 0, 3, 0, Cro15815), 
LRes84341 = reshape_layer(Cro15815, [1, 1], Res84341), 
LMax33506 = max_pool1D_layer(Res84341, 1, 1, false, Max33506), 
exec_layers([LCon54997,LRes88755,LRes25489,LCro15815,LRes84341,LMax33506],["Con54997","Res88755","Res25489","Cro15815","Res84341","Max33506"],Max33506,"Max33506")

Actual (Unparsed): [[[0.5778878]]]

Expected (Unparsed): [[[0.5778878]]]

Actual:   [[[0.5779]]]

Expected: [[[0.5779]]]