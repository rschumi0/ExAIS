import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave10818 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave10818 = tf.keras.layers.Input(shape=([2, 1]))
in0Con51472 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Min84279 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Min84279 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Mas49639 = tf.keras.layers.Input(shape=([4, 2, 1]))
in0Con70342 = tf.keras.layers.Input(shape=([1]))

Ave10818 = keras.layers.Average(name = 'Ave10818', )([in0Ave10818,in1Ave10818])
Res98723 = keras.layers.Reshape((2, 1, 1), name = 'Res98723', )(Ave10818)
Con51472 = keras.layers.Concatenate(axis=3, name = 'Con51472', )([Res98723,in0Con51472])
Min84279 = keras.layers.Minimum(name = 'Min84279', )([in0Min84279,in1Min84279])
Zer90699 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer90699', )(Min84279)
Max3739 = keras.layers.Maximum(name = 'Max3739', )([Con51472,Zer90699])
Glo84370 = keras.layers.GlobalAveragePooling2D(name = 'Glo84370', )(Max3739)
Mas49639 = keras.layers.Masking(mask_value=1, name = 'Mas49639', )(in0Mas49639)
Bat48495 = keras.layers.BatchNormalization(axis=2, epsilon=0.7517746201019184,  name = 'Bat48495', )(Mas49639)
Glo51651 = keras.layers.GlobalMaxPool2D(name = 'Glo51651', )(Bat48495)
Con70342 = keras.layers.Concatenate(axis=1, name = 'Con70342', )([Glo51651,in0Con70342])
Mul12186 = keras.layers.Multiply(name = 'Mul12186', )([Glo84370,Con70342])
model = tf.keras.models.Model(inputs=[in0Ave10818,in1Ave10818,in0Con51472,in0Min84279,in1Min84279,in0Mas49639,in0Con70342], outputs=Mul12186)
w = model.get_layer('Bat48495').get_weights() 
w[0] = np.array([0.6291, 0.0948])
w[1] = np.array([0.4488, 0.775])
w[2] = np.array([0.7201, 0.9189])
w[3] = np.array([0.7812, 0.9087])
model.get_layer('Bat48495').set_weights(w) 
in0Ave10818 = tf.constant([[[0.3716], [0.0499]]])
in1Ave10818 = tf.constant([[[0.4721], [0.8794]]])
in0Con51472 = tf.constant([[[[0.0126]], [[0.218]]]])
in0Min84279 = tf.constant([[[[0.5996, 0.8844]]]])
in1Min84279 = tf.constant([[[[0.1851, 0.1673]]]])
in0Mas49639 = tf.constant([[[[1.614], [1.4772]], [[1.8361], [1.6608]], [[1.4543], [1.9929]], [[1.4636], [1.9807]]]])
in0Con70342 = tf.constant([[0.498]])
print (np.array2string(model.predict([in0Ave10818,in1Ave10818,in0Con51472,in0Min84279,in1Min84279,in0Mas49639,in0Con70342],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul12186.png')

LAve10818 = average_layer([[[[0.3716], [0.0499]]], [[[0.4721], [0.8794]]]], Ave10818), 
LRes98723 = reshape_layer(Ave10818, [2, 1, 1], Res98723), 
LCon51472 = concatenate_layer([Res98723,[[[[0.0126]], [[0.218]]]]], 3, Con51472), 
LMin84279 = minimum_layer([[[[[0.5996, 0.8844]]]], [[[[0.1851, 0.1673]]]]], Min84279), 
LZer90699 = zero_padding2D_layer(Min84279, 1, 0, 0, 0, Zer90699), 
LMax3739 = maximum_layer([Con51472,Zer90699], Max3739), 
LGlo84370 = global_average_pooling2D_layer(Max3739, Glo84370), 
LMas49639 = masking_layer([[[[1.614], [1.4772]], [[1.8361], [1.6608]], [[1.4543], [1.9929]], [[1.4636], [1.9807]]]], 1, Mas49639), 
LBat48495 = batch_normalization_layer(Mas49639, 2, 0.7517746201019184, [0.6291, 0.0948], [0.4488, 0.775], [0.7201, 0.9189], [0.7812, 0.9087], Bat48495), 
LGlo51651 = global_max_pool2D_layer(Bat48495, Glo51651), 
LCon70342 = concatenate_layer([Glo51651,[[0.498]]], 1, Con70342), 
LMul12186 = multiply_layer([Glo84370,Con70342], Mul12186), 
exec_layers([LAve10818,LRes98723,LCon51472,LMin84279,LZer90699,LMax3739,LGlo84370,LMas49639,LBat48495,LGlo51651,LCon70342,LMul12186],["Ave10818","Res98723","Con51472","Min84279","Zer90699","Max3739","Glo84370","Mas49639","Bat48495","Glo51651","Con70342","Mul12186"],Mul12186,"Mul12186")

Actual (Unparsed): [[0.4502726, 0.0574194]]

Expected (Unparsed): [[0.45027264347721174,0.0574194]]

Actual:   [[0.4503, 0.0575]]

Expected: [[0.4503, 0.0575]]