import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub72819 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub72819 = tf.keras.layers.Input(shape=([2, 3]))
in0Dot63087 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot63087 = tf.keras.layers.Input(shape=([2, 3]))

Sub72819 = keras.layers.Subtract(name = 'Sub72819', )([in0Sub72819,in1Sub72819])
Max67473 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='valid', name = 'Max67473', )(Sub72819)
Res43143 = keras.layers.Reshape((1, 3, 1), name = 'Res43143', )(Max67473)
Res61209 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res61209', )(Res43143)
Zer77326 = keras.layers.ZeroPadding3D(padding=((4, 0), (2, 0), (2, 0)), name = 'Zer77326', )(Res61209)
Dot63087 = keras.layers.Dot(axes=(1, 1), name = 'Dot63087', )([in0Dot63087,in1Dot63087])
Res13749 = keras.layers.Reshape((3, 3, 1), name = 'Res13749', )(Dot63087)
Res45736 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res45736', )(Res13749)
Zer80778 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer80778', )(Res45736)
Mul91032 = keras.layers.Multiply(name = 'Mul91032', )([Zer77326,Zer80778])
Res9311 = keras.layers.Reshape((5, 5, 3), name = 'Res9311', )(Mul91032)
Res99819 = keras.layers.Reshape((5, 15), name = 'Res99819', )(Res9311)
Max68251 = keras.layers.MaxPool1D(pool_size=(3), name = 'Max68251', )(Res99819)
model = tf.keras.models.Model(inputs=[in0Sub72819,in1Sub72819,in0Dot63087,in1Dot63087], outputs=Max68251)
in0Sub72819 = tf.constant([[[0.0679, 0.2603, 0.3474], [0.9594, 0.7072, 0.9615]]])
in1Sub72819 = tf.constant([[[0.3859, 0.8231, 0.8933], [0.9567, 0.2689, 0.1867]]])
in0Dot63087 = tf.constant([[[0.1177, 0.6781, 0.6579], [0.0735, 0.9508, 0.1703]]])
in1Dot63087 = tf.constant([[[0.6897, 0.8257, 0.4307], [0.8784, 0.252, 0.4978]]])
print (np.array2string(model.predict([in0Sub72819,in1Sub72819,in0Dot63087,in1Dot63087],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max68251.png')

LSub72819 = subtract_layer([[[0.0679, 0.2603, 0.3474], [0.9594, 0.7072, 0.9615]]], [[[0.3859, 0.8231, 0.8933], [0.9567, 0.2689, 0.1867]]], Sub72819), 
LMax67473 = max_pool1D_layer(Sub72819, 2, 1, false, Max67473), 
LRes43143 = reshape_layer(Max67473, [1, 3, 1], Res43143), 
LRes61209 = reshape_layer(Res43143, [1, 3, 1, 1], Res61209), 
LZer77326 = zero_padding3D_layer(Res61209, 4, 0, 2, 0, 2, 0, Zer77326), 
LDot63087 = dot_layer([[[0.1177, 0.6781, 0.6579], [0.0735, 0.9508, 0.1703]]], [[[0.6897, 0.8257, 0.4307], [0.8784, 0.252, 0.4978]]], 1, 1, Dot63087), 
LRes13749 = reshape_layer(Dot63087, [3, 3, 1], Res13749), 
LRes45736 = reshape_layer(Res13749, [3, 3, 1, 1], Res45736), 
LZer80778 = zero_padding3D_layer(Res45736, 1, 1, 1, 1, 1, 1, Zer80778), 
LMul91032 = multiply_layer([Zer77326,Zer80778], Mul91032), 
LRes9311 = reshape_layer(Mul91032, [5, 5, 3], Res9311), 
LRes99819 = reshape_layer(Res9311, [5, 15], Res99819), 
LMax68251 = max_pool1D_layer(Res99819, 3, Max68251), 
exec_layers([LSub72819,LMax67473,LRes43143,LRes61209,LZer77326,LDot63087,LRes13749,LRes45736,LZer80778,LMul91032,LRes9311,LRes99819,LMax68251],["Sub72819","Max67473","Res43143","Res61209","Zer77326","Dot63087","Res13749","Res45736","Zer80778","Mul91032","Res9311","Res99819","Max68251"],Max68251,"Max68251")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0,0.0,0,0,0.0,0,0,0.0,0,0,0,0]]]

Actual:   [[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]]