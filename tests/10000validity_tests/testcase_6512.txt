import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul62739 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Mul62739 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con14803 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Max86419 = tf.keras.layers.Input(shape=([2, 2, 1]))

Mul62739 = keras.layers.Multiply(name = 'Mul62739', )([in0Mul62739,in1Mul62739])
Mas87449 = keras.layers.Masking(mask_value=1, name = 'Mas87449', )(Mul62739)
Con14803 = keras.layers.Concatenate(axis=3, name = 'Con14803', )([Mas87449,in0Con14803])
Max86419 = keras.layers.MaxPool2D(pool_size=(2, 2), name = 'Max86419', )(in0Max86419)
Con45608 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con45608', )(Max86419)
Cro38525 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro38525', )(Con45608)
Max21024 = keras.layers.Maximum(name = 'Max21024', )([Con14803,Cro38525])
model = tf.keras.models.Model(inputs=[in0Mul62739,in1Mul62739,in0Con14803,in0Max86419], outputs=Max21024)
w = model.get_layer('Con45608').get_weights() 
w[0] = np.array([[[[0.7724, 0.2535]]]])
w[1] = np.array([0, 0])
model.get_layer('Con45608').set_weights(w) 
in0Mul62739 = tf.constant([[[[0.3769]]]])
in1Mul62739 = tf.constant([[[[0.8047]]]])
in0Con14803 = tf.constant([[[[0.11]]]])
in0Max86419 = tf.constant([[[[1.7168], [1.6092]], [[1.0035], [1.9013]]]])
print (np.array2string(model.predict([in0Mul62739,in1Mul62739,in0Con14803,in0Max86419],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max21024.png')

LMul62739 = multiply_layer([[[[[0.3769]]]], [[[[0.8047]]]]], Mul62739), 
LMas87449 = masking_layer(Mul62739, 1, Mas87449), 
LCon14803 = concatenate_layer([Mas87449,[[[[0.11]]]]], 3, Con14803), 
LMax86419 = max_pool2D_layer([[[[1.7168], [1.6092]], [[1.0035], [1.9013]]]], 2, 2, Max86419), 
LCon45608 = conv2D_layer(Max86419, 1, 1,[[[[0.7724, 0.2535]]]],[0, 0], 1, 1, true, 1, 1, Con45608), 
LCro38525 = cropping2D_layer(Con45608, 0, 0, 0, 0, Cro38525), 
LMax21024 = maximum_layer([Con14803,Cro38525], Max21024), 
exec_layers([LMul62739,LMas87449,LCon14803,LMax86419,LCon45608,LCro38525,LMax21024],["Mul62739","Mas87449","Con14803","Max86419","Con45608","Cro38525","Max21024"],Max21024,"Max21024")

Actual (Unparsed): [[[[1.4685641, 0.4819795]]]]

Expected (Unparsed): [[[[1.46856412,0.48197955]]]]

Actual:   [[[[1.4686, 0.482]]]]

Expected: [[[[1.4686, 0.482]]]]