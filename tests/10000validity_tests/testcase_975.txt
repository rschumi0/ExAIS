import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot52649 = tf.keras.layers.Input(shape=([2]))
in1Dot52649 = tf.keras.layers.Input(shape=([2]))
in0Con95317 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Mul44576 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul44576 = tf.keras.layers.Input(shape=([2, 1, 1]))

Dot52649 = keras.layers.Dot(axes=(1, 1), name = 'Dot52649', )([in0Dot52649,in1Dot52649])
Res92905 = keras.layers.Reshape((1, 1), name = 'Res92905', )(Dot52649)
Res96664 = keras.layers.Reshape((1, 1, 1), name = 'Res96664', )(Res92905)
Zer42855 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer42855', )(Res96664)
Con95317 = keras.layers.Concatenate(axis=3, name = 'Con95317', )([Zer42855,in0Con95317])
Mul44576 = keras.layers.Multiply(name = 'Mul44576', )([in0Mul44576,in1Mul44576])
Sep29796 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep29796', )(Mul44576)
Max53096 = keras.layers.Maximum(name = 'Max53096', )([Con95317,Sep29796])
model = tf.keras.models.Model(inputs=[in0Dot52649,in1Dot52649,in0Con95317,in0Mul44576,in1Mul44576], outputs=Max53096)
w = model.get_layer('Sep29796').get_weights() 
w[0] = np.array([[[[0.6717]]]])
w[1] = np.array([[[[0.5206, 0.453]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep29796').set_weights(w) 
in0Dot52649 = tf.constant([[0.1858, 0.2407]])
in1Dot52649 = tf.constant([[0.8853, 0.9613]])
in0Con95317 = tf.constant([[[[0.9973]], [[0.4879]]]])
in0Mul44576 = tf.constant([[[[0.1313]], [[0.4525]]]])
in1Mul44576 = tf.constant([[[[0.8503]], [[0.5525]]]])
print (np.array2string(model.predict([in0Dot52649,in1Dot52649,in0Con95317,in0Mul44576,in1Mul44576],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max53096.png')

LDot52649 = dot_layer([[0.1858, 0.2407]], [[0.8853, 0.9613]], 1, 1, Dot52649), 
LRes92905 = reshape_layer(Dot52649, [1, 1], Res92905), 
LRes96664 = reshape_layer(Res92905, [1, 1, 1], Res96664), 
LZer42855 = zero_padding2D_layer(Res96664, 1, 0, 0, 0, Zer42855), 
LCon95317 = concatenate_layer([Zer42855,[[[[0.9973]], [[0.4879]]]]], 3, Con95317), 
LMul44576 = multiply_layer([[[[[0.1313]], [[0.4525]]]], [[[[0.8503]], [[0.5525]]]]], Mul44576), 
LSep29796 = separable_conv2D_layer(Mul44576, 1, 1,[[[[[0.6717]]]],[[[[0.5206, 0.453]]]]],[0, 0], 1, 1, false, Sep29796), 
LMax53096 = maximum_layer([Con95317,Sep29796], Max53096), 
exec_layers([LDot52649,LRes92905,LRes96664,LZer42855,LCon95317,LMul44576,LSep29796,LMax53096],["Dot52649","Res92905","Res96664","Zer42855","Con95317","Mul44576","Sep29796","Max53096"],Max53096,"Max53096")

Actual (Unparsed): [[[[0.0390406, 0.9973000]], [[0.3958737, 0.4879000]]]]

Expected (Unparsed): [[[[0.039040594038817794,0.9973]],[[0.39587364999999997,0.4879]]]]

Actual:   [[[[0.0391, 0.9973]], [[0.3959, 0.4879]]]]

Expected: [[[[0.0391, 0.9973]], [[0.3959, 0.4879]]]]