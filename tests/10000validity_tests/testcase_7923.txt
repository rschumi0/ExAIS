import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con11379 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Con18446 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Dot80916 = tf.keras.layers.Input(shape=([2]))
in1Dot80916 = tf.keras.layers.Input(shape=([2]))
in0Con33774 = tf.keras.layers.Input(shape=([1, 2, 3]))
in0Con13012 = tf.keras.layers.Input(shape=([2, 1, 1]))

Con11379 = keras.layers.Conv3D(3, (1, 2, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con11379', )(in0Con11379)
Res96469 = keras.layers.Reshape((2, 2, 3), name = 'Res96469', )(Con11379)
Up_10752 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_10752', )(Res96469)
Ave47168 = keras.layers.AveragePooling2D(pool_size=(2, 1), strides=(7, 4), padding='same', name = 'Ave47168', )(Up_10752)
Zer76004 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer76004', )(Ave47168)
Con18446 = keras.layers.Concatenate(axis=3, name = 'Con18446', )([Zer76004,in0Con18446])
Dot80916 = keras.layers.Dot(axes=(1, 1), name = 'Dot80916', )([in0Dot80916,in1Dot80916])
Res26523 = keras.layers.Reshape((1, 1), name = 'Res26523', )(Dot80916)
Res27664 = keras.layers.Reshape((1, 1, 1), name = 'Res27664', )(Res26523)
Up_72779 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_72779', )(Res27664)
Con33774 = keras.layers.Concatenate(axis=3, name = 'Con33774', )([Up_72779,in0Con33774])
Con13012 = keras.layers.Conv2D(4, (1, 1),strides=(2, 1), padding='valid', dilation_rate=(1, 1), name = 'Con13012', )(in0Con13012)
Zer5895 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer5895', )(Con13012)
Mul33695 = keras.layers.Multiply(name = 'Mul33695', )([Con33774,Zer5895])
Min60842 = keras.layers.Minimum(name = 'Min60842', )([Con18446,Mul33695])
model = tf.keras.models.Model(inputs=[in0Con11379,in0Con18446,in0Dot80916,in1Dot80916,in0Con33774,in0Con13012], outputs=Min60842)
w = model.get_layer('Con11379').get_weights() 
w[0] = np.array([[[[[1, 0.0992, 0.3796], [0.3732, 0.0811, 0.8281]]], [[[0.9068, 0.4456, 0.1954], [0.2976, 0.5681, 0.7879]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con11379').set_weights(w) 
w = model.get_layer('Con13012').get_weights() 
w[0] = np.array([[[[0.9396, 0.5147, 0.2436, 0.3059]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con13012').set_weights(w) 
in0Con11379 = tf.constant([[[[[0.0195, 0.4712]], [[0.7486, 0.5754]]], [[[0.5147, 0.2501]], [[0.7038, 0.5635]]]]])
in0Con18446 = tf.constant([[[[0.2012], [0.825]]]])
in0Dot80916 = tf.constant([[0.7487, 0.8284]])
in1Dot80916 = tf.constant([[0.5338, 0.2605]])
in0Con33774 = tf.constant([[[[0.5214, 0.5206, 0.5293], [0.1816, 0.1948, 0.7717]]]])
in0Con13012 = tf.constant([[[[0.3419]], [[0.8564]]]])
print (np.array2string(model.predict([in0Con11379,in0Con18446,in0Dot80916,in1Dot80916,in0Con33774,in0Con13012],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min60842.png')

LCon11379 = conv3D_layer([[[[[0.0195, 0.4712]], [[0.7486, 0.5754]]], [[[0.5147, 0.2501]], [[0.7038, 0.5635]]]]], 1, 2, 1,[[[[[1, 0.0992, 0.3796], [0.3732, 0.0811, 0.8281]]], [[[0.9068, 0.4456, 0.1954], [0.2976, 0.5681, 0.7879]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con11379), 
LRes96469 = reshape_layer(Con11379, [2, 2, 3], Res96469), 
LUp_10752 = up_sampling2D_layer(Res96469, 2, 1, Up_10752), 
LAve47168 = average_pooling2D_layer(Up_10752, 2, 1, 7, 4, true, Ave47168), 
LZer76004 = zero_padding2D_layer(Ave47168, 0, 0, 1, 0, Zer76004), 
LCon18446 = concatenate_layer([Zer76004,[[[[0.2012], [0.825]]]]], 3, Con18446), 
LDot80916 = dot_layer([[0.7487, 0.8284]], [[0.5338, 0.2605]], 1, 1, Dot80916), 
LRes26523 = reshape_layer(Dot80916, [1, 1], Res26523), 
LRes27664 = reshape_layer(Res26523, [1, 1, 1], Res27664), 
LUp_72779 = up_sampling2D_layer(Res27664, 1, 2, Up_72779), 
LCon33774 = concatenate_layer([Up_72779,[[[[0.5214, 0.5206, 0.5293], [0.1816, 0.1948, 0.7717]]]]], 3, Con33774), 
LCon13012 = conv2D_layer([[[[0.3419]], [[0.8564]]]], 1, 1,[[[[0.9396, 0.5147, 0.2436, 0.3059]]]],[0, 0, 0, 0], 2, 1, false, 1, 1, Con13012), 
LZer5895 = zero_padding2D_layer(Con13012, 0, 0, 1, 0, Zer5895), 
LMul33695 = multiply_layer([Con33774,Zer5895], Mul33695), 
LMin60842 = minimum_layer([Con18446,Mul33695], Min60842), 
exec_layers([LCon11379,LRes96469,LUp_10752,LAve47168,LZer76004,LCon18446,LDot80916,LRes26523,LRes27664,LUp_72779,LCon33774,LCon13012,LZer5895,LMul33695,LMin60842],["Con11379","Res96469","Up_10752","Ave47168","Zer76004","Con18446","Dot80916","Res26523","Res27664","Up_72779","Con33774","Con13012","Zer5895","Mul33695","Min60842"],Min60842,"Min60842")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.1977142, 0.0319572, 0.0162243, 0.0807100]]]]

Expected (Unparsed): [[[[0,0,0,0.0],[0.1977142132797624,0.031957228888000004,0.016224276432,0.08070994995700001]]]]

Actual:   [[[[0, 0, 0, 0], [0.1978, 0.032, 0.0163, 0.0808]]]]

Expected: [[[[0, 0, 0, 0], [0.1978, 0.032, 0.0163, 0.0808]]]]