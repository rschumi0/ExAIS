import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer23237 = tf.keras.layers.Input(shape=([4, 3, 1, 3]))
in0Min48334 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Min48334 = tf.keras.layers.Input(shape=([1, 1, 2]))

Zer23237 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer23237', )(in0Zer23237)
Res96879 = keras.layers.Reshape((6, 5, 9), name = 'Res96879', )(Zer23237)
Con74583 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con74583', )(Res96879)
Min48334 = keras.layers.Minimum(name = 'Min48334', )([in0Min48334,in1Min48334])
Ave95864 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Ave95864', )(Min48334)
Zer20598 = keras.layers.ZeroPadding2D(padding=((5, 0), (4, 0)), name = 'Zer20598', )(Ave95864)
Max61704 = keras.layers.Maximum(name = 'Max61704', )([Con74583,Zer20598])
Res67315 = keras.layers.Reshape((6, 10), name = 'Res67315', )(Max61704)
Zer29474 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer29474', )(Res67315)
Sep78651 = keras.layers.SeparableConv1D(3, (4),strides=(4), padding='same', name = 'Sep78651', )(Zer29474)
model = tf.keras.models.Model(inputs=[in0Zer23237,in0Min48334,in1Min48334], outputs=Sep78651)
w = model.get_layer('Con74583').get_weights() 
w[0] = np.array([[[[0.199, 0.846], [0.5288, 0.8672], [0.3731, 0.029], [0.3269, 0.885], [0.0279, 0.2772], [0.1845, 0.2423], [0.4033, 0.9759], [0.8083, 0.2858], [0.8813, 0.3801]]]])
w[1] = np.array([0, 0])
model.get_layer('Con74583').set_weights(w) 
w = model.get_layer('Sep78651').get_weights() 
w[0] = np.array([[[0.6748], [0.8561], [0.5036], [0.8587], [0.6297], [0.2387], [0.4433], [0.5522], [0.2668], [0.6106]], [[0.1373], [0.147], [0.7772], [0.1801], [0.809], [0.8028], [0.1316], [0.2949], [0.3665], [0.659]], [[0.1711], [0.1428], [0.9942], [0.5794], [0.9381], [0.5898], [0.9418], [0.7986], [0.5963], [0.2584]], [[0.8361], [0.6168], [0.2781], [0.1417], [0.5378], [0.3142], [0.8568], [0.1471], [0.4261], [0.8786]]])
w[1] = np.array([[[0.6243, 0.7632, 0.7966], [0.2737, 0.8185, 0.8897], [0.2816, 0.9414, 0.8161], [0.3683, 0.0614, 0.1316], [0.3298, 0.0316, 0.2056], [0.2615, 0.6067, 0.3914], [0.9392, 0.8972, 0.6332], [0.1159, 0.7539, 0.5273], [0.4047, 0.2104, 0.1391], [0.0141, 0.6065, 0.5089]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep78651').set_weights(w) 
in0Zer23237 = tf.constant([[[[[1.1514, 1.2974, 1.7445]], [[1.6903, 1.6441, 1.7086]], [[1.2048, 1.2851, 1.2397]]], [[[1.3786, 1.3524, 1.967]], [[1.2606, 1.3069, 1.7249]], [[1.1278, 1.221, 1.4881]]], [[[1.135, 1.0507, 1.4645]], [[1.9685, 1.4551, 1.1361]], [[1.4073, 1.5762, 1.882]]], [[[1.3482, 1.49, 1.793]], [[1.3551, 1.7415, 1.6223]], [[1.6166, 1.1894, 1.131]]]]])
in0Min48334 = tf.constant([[[[0.2466, 0.5465]]]])
in1Min48334 = tf.constant([[[[0.5284, 0.5864]]]])
print (np.array2string(model.predict([in0Zer23237,in0Min48334,in1Min48334],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep78651.png')

LZer23237 = zero_padding3D_layer([[[[[1.1514, 1.2974, 1.7445]], [[1.6903, 1.6441, 1.7086]], [[1.2048, 1.2851, 1.2397]]], [[[1.3786, 1.3524, 1.967]], [[1.2606, 1.3069, 1.7249]], [[1.1278, 1.221, 1.4881]]], [[[1.135, 1.0507, 1.4645]], [[1.9685, 1.4551, 1.1361]], [[1.4073, 1.5762, 1.882]]], [[[1.3482, 1.49, 1.793]], [[1.3551, 1.7415, 1.6223]], [[1.6166, 1.1894, 1.131]]]]], 1, 1, 1, 1, 1, 1, Zer23237), 
LRes96879 = reshape_layer(Zer23237, [6, 5, 9], Res96879), 
LCon74583 = conv2D_layer(Res96879, 1, 1,[[[[0.199, 0.846], [0.5288, 0.8672], [0.3731, 0.029], [0.3269, 0.885], [0.0279, 0.2772], [0.1845, 0.2423], [0.4033, 0.9759], [0.8083, 0.2858], [0.8813, 0.3801]]]],[0, 0], 1, 1, false, 1, 1, Con74583), 
LMin48334 = minimum_layer([[[[[0.2466, 0.5465]]]], [[[[0.5284, 0.5864]]]]], Min48334), 
LAve95864 = average_pooling2D_layer(Min48334, 1, 1, 1, 1, true, Ave95864), 
LZer20598 = zero_padding2D_layer(Ave95864, 5, 0, 4, 0, Zer20598), 
LMax61704 = maximum_layer([Con74583,Zer20598], Max61704), 
LRes67315 = reshape_layer(Max61704, [6, 10], Res67315), 
LZer29474 = zero_padding1D_layer(Res67315, 4, 0, Zer29474), 
LSep78651 = separable_conv1D_layer(Zer29474, 4,[[[[0.6748], [0.8561], [0.5036], [0.8587], [0.6297], [0.2387], [0.4433], [0.5522], [0.2668], [0.6106]], [[0.1373], [0.147], [0.7772], [0.1801], [0.809], [0.8028], [0.1316], [0.2949], [0.3665], [0.659]], [[0.1711], [0.1428], [0.9942], [0.5794], [0.9381], [0.5898], [0.9418], [0.7986], [0.5963], [0.2584]], [[0.8361], [0.6168], [0.2781], [0.1417], [0.5378], [0.3142], [0.8568], [0.1471], [0.4261], [0.8786]]],[[[0.6243, 0.7632, 0.7966], [0.2737, 0.8185, 0.8897], [0.2816, 0.9414, 0.8161], [0.3683, 0.0614, 0.1316], [0.3298, 0.0316, 0.2056], [0.2615, 0.6067, 0.3914], [0.9392, 0.8972, 0.6332], [0.1159, 0.7539, 0.5273], [0.4047, 0.2104, 0.1391], [0.0141, 0.6065, 0.5089]]]],[0, 0, 0], 4, true, Sep78651), 
exec_layers([LZer23237,LRes96879,LCon74583,LMin48334,LAve95864,LZer20598,LMax61704,LRes67315,LZer29474,LSep78651],["Zer23237","Res96879","Con74583","Min48334","Ave95864","Zer20598","Max61704","Res67315","Zer29474","Sep78651"],Sep78651,"Sep78651")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000], [3.0199280, 4.5428946, 3.6226000], [2.6312832, 4.3103004, 3.4861060]]]

Expected (Unparsed): [[[0.0,0.0,0.0],[3.019928049047623,4.542894574067573,3.622600000771089],[2.631283192113954,4.3103003643282225,3.486106034458485]]]

Actual:   [[[0, 0, 0], [3.02, 4.5429, 3.6226], [2.6313, 4.3104, 3.4862]]]

Expected: [[[0, 0, 0], [3.02, 4.5429, 3.6227], [2.6313, 4.3104, 3.4862]]]