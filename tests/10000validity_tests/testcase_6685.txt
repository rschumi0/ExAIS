import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro87872 = tf.keras.layers.Input(shape=([4, 1, 2]))
in0Lay78525 = tf.keras.layers.Input(shape=([2]))

Cro87872 = keras.layers.Cropping2D(cropping=((2, 1), (0, 0)), name = 'Cro87872', )(in0Cro87872)
Res34248 = keras.layers.Reshape((1, 2), name = 'Res34248', )(Cro87872)
Fla10699 = keras.layers.Flatten(name = 'Fla10699', )(Res34248)
Lay78525 = keras.layers.LayerNormalization(axis=1, epsilon=2.4878670442897426, name = 'Lay78525', )(in0Lay78525)
Mul5897 = keras.layers.Multiply(name = 'Mul5897', )([Fla10699,Lay78525])
Res68913 = keras.layers.Reshape((2, 1), name = 'Res68913', )(Mul5897)
Res56287 = keras.layers.Reshape((2, 1, 1), name = 'Res56287', )(Res68913)
Sep28596 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep28596', )(Res56287)
model = tf.keras.models.Model(inputs=[in0Cro87872,in0Lay78525], outputs=Sep28596)
w = model.get_layer('Sep28596').get_weights() 
w[0] = np.array([[[[0.26]]]])
w[1] = np.array([[[[0.6169, 0.9305, 0.8597, 0.7488]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep28596').set_weights(w) 
in0Cro87872 = tf.constant([[[[1.3388, 1.3106]], [[1.1178, 1.8181]], [[1.6786, 1.811]], [[1.4222, 1.3155]]]])
in0Lay78525 = tf.constant([[1.4495, 1.9195]])
print (np.array2string(model.predict([in0Cro87872,in0Lay78525],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep28596.png')

LCro87872 = cropping2D_layer([[[[1.3388, 1.3106]], [[1.1178, 1.8181]], [[1.6786, 1.811]], [[1.4222, 1.3155]]]], 2, 1, 0, 0, Cro87872), 
LRes34248 = reshape_layer(Cro87872, [1, 2], Res34248), 
LFla10699 = flatten_layer(Res34248, Fla10699), 
LLay78525 = layer_normalization_layer([[1.4495, 1.9195]], 1, 2.4878670442897426, Lay78525), 
LMul5897 = multiply_layer([Fla10699,Lay78525], Mul5897), 
LRes68913 = reshape_layer(Mul5897, [2, 1], Res68913), 
LRes56287 = reshape_layer(Res68913, [2, 1, 1], Res56287), 
LSep28596 = separable_conv2D_layer(Res56287, 1, 1,[[[[[0.26]]]],[[[[0.6169, 0.9305, 0.8597, 0.7488]]]]],[0, 0, 0, 0], 1, 1, false, Sep28596), 
exec_layers([LCro87872,LRes34248,LFla10699,LLay78525,LMul5897,LRes68913,LRes56287,LSep28596],["Cro87872","Res34248","Fla10699","Lay78525","Mul5897","Res68913","Res56287","Sep28596"],Sep28596,"Sep28596")

Actual (Unparsed): [[[[-0.0396755, -0.0598444, -0.0552910, -0.0481585]], [[0.0428049, 0.0645647, 0.0596521, 0.0519570]]]]

Expected (Unparsed): [[[[-0.039675477261105416,-0.0598444344163699,-0.055290983630041056,-0.0481585303503254]],[[0.042804890575397346,0.06456467933280471,0.05965207396282882,0.05195704662482985]]]]

Actual:   [[[[-0.0396, -0.0598, -0.0552, -0.0481]], [[0.0429, 0.0646, 0.0597, 0.052]]]]

Expected: [[[[-0.0396, -0.0598, -0.0552, -0.0481]], [[0.0429, 0.0646, 0.0597, 0.052]]]]