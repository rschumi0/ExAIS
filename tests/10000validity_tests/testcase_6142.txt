import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul77478 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Mul77478 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Mul77478 = keras.layers.Multiply(name = 'Mul77478', )([in0Mul77478,in1Mul77478])
Mas94027 = keras.layers.Masking(mask_value=2, name = 'Mas94027', )(Mul77478)
Res58018 = keras.layers.Reshape((1, 1, 2), name = 'Res58018', )(Mas94027)
Res37261 = keras.layers.Reshape((1, 2), name = 'Res37261', )(Res58018)
Sim17234 = keras.layers.SimpleRNN(2,name = 'Sim17234', )(Res37261)
Bat21988 = keras.layers.BatchNormalization(axis=1, epsilon=0.32251747080767,  name = 'Bat21988', )(Sim17234)
model = tf.keras.models.Model(inputs=[in0Mul77478,in1Mul77478], outputs=Bat21988)
w = model.get_layer('Sim17234').get_weights() 
w[0] = np.array([[1, 5], [3, 10]])
w[1] = np.array([[1, 2], [2, 2]])
w[2] = np.array([8, 7])
model.get_layer('Sim17234').set_weights(w) 
w = model.get_layer('Bat21988').get_weights() 
w[0] = np.array([0.013, 0.8286])
w[1] = np.array([0.7615, 0.6165])
w[2] = np.array([0.624, 0.5304])
w[3] = np.array([0.7351, 0.7898])
model.get_layer('Bat21988').set_weights(w) 
in0Mul77478 = tf.constant([[[[[0.886], [0.6927]]]]])
in1Mul77478 = tf.constant([[[[[0.8361], [0.0707]]]]])
print (np.array2string(model.predict([in0Mul77478,in1Mul77478],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat21988.png')

LMul77478 = multiply_layer([[[[[[0.886], [0.6927]]]]], [[[[[0.8361], [0.0707]]]]]], Mul77478), 
LMas94027 = masking_layer(Mul77478, 2, Mas94027), 
LRes58018 = reshape_layer(Mas94027, [1, 1, 2], Res58018), 
LRes37261 = reshape_layer(Res58018, [1, 2], Res37261), 
LSim17234 = simple_rnn_layer(Res37261,[[1, 5], [3, 10]],[[1, 2], [2, 2]],[8, 7], Sim17234), 
LBat21988 = batch_normalization_layer(Sim17234, 1, 0.32251747080767, [0.013, 0.8286], [0.7615, 0.6165], [0.624, 0.5304], [0.7351, 0.7898], Bat21988), 
exec_layers([LMul77478,LMas94027,LRes58018,LRes37261,LSim17234,LBat21988],["Mul77478","Mas94027","Res58018","Res37261","Sim17234","Bat21988"],Bat21988,"Bat21988")

Actual (Unparsed): [[0.7662530, 0.9854425]]

Expected (Unparsed): [[0.7662529893922209,0.985442458612771]]

Actual:   [[0.7663, 0.9855]]

Expected: [[0.7663, 0.9855]]