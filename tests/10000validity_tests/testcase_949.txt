import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe66230 = tf.keras.layers.Input(shape=([1, 1]))
in0Con99435 = tf.keras.layers.Input(shape=([4, 3]))
in0Per59296 = tf.keras.layers.Input(shape=([4, 4]))

PRe66230 = keras.layers.PReLU(name = 'PRe66230', input_shape=(1, 1))(in0PRe66230)
Zer63487 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer63487', )(PRe66230)
Con99435 = keras.layers.Concatenate(axis=2, name = 'Con99435', )([Zer63487,in0Con99435])
Per59296 = keras.layers.Permute((2,1), name = 'Per59296',)(in0Per59296)
Per19129 = keras.layers.Permute((2,1), name = 'Per19129',)(Per59296)
Sof16206 = keras.layers.Softmax(axis=1, name = 'Sof16206', )(Per19129)
Mul68492 = keras.layers.Multiply(name = 'Mul68492', )([Con99435,Sof16206])
Res4089 = keras.layers.Reshape((4, 4, 1), name = 'Res4089', )(Mul68492)
Zer75271 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer75271', )(Res4089)
model = tf.keras.models.Model(inputs=[in0PRe66230,in0Con99435,in0Per59296], outputs=Zer75271)
w = model.get_layer('PRe66230').get_weights() 
w[0] = np.array([[0.4804]])
model.get_layer('PRe66230').set_weights(w) 
in0PRe66230 = tf.constant([[[0.2628]]])
in0Con99435 = tf.constant([[[0.5219, 0.2919, 0.0015], [0.0231, 0.528, 0.6731], [0.0529, 0.6317, 0.7378], [0.6404, 0.7995, 0.4638]]])
in0Per59296 = tf.constant([[[1.8428, 1.3072, 1.9006, 1.8384], [1.4931, 1.6295, 1.4588, 1.2511], [1.3466, 1.5194, 1.0806, 1.0567], [1.1737, 1.2839, 1.2129, 1.6298]]])
print (np.array2string(model.predict([in0PRe66230,in0Con99435,in0Per59296],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer75271.png')

LPRe66230 = prelu_layer([[[0.2628]]], [[0.4804]], PRe66230), 
LZer63487 = zero_padding1D_layer(PRe66230, 3, 0, Zer63487), 
LCon99435 = concatenate_layer([Zer63487,[[[0.5219, 0.2919, 0.0015], [0.0231, 0.528, 0.6731], [0.0529, 0.6317, 0.7378], [0.6404, 0.7995, 0.4638]]]], 2, Con99435), 
LPer59296 = permute_layer([[[1.8428, 1.3072, 1.9006, 1.8384], [1.4931, 1.6295, 1.4588, 1.2511], [1.3466, 1.5194, 1.0806, 1.0567], [1.1737, 1.2839, 1.2129, 1.6298]]], 2,1, Per59296), 
LPer19129 = permute_layer(Per59296, 2,1, Per19129), 
LSof16206 = softmax_layer(Per19129, 1, Sof16206), 
LMul68492 = multiply_layer([Con99435,Sof16206], Mul68492), 
LRes4089 = reshape_layer(Mul68492, [4, 4, 1], Res4089), 
LZer75271 = zero_padding2D_layer(Res4089, 1, 1, 1, 1, Zer75271), 
exec_layers([LPRe66230,LZer63487,LCon99435,LPer59296,LPer19129,LSof16206,LMul68492,LRes4089,LZer75271],["PRe66230","Zer63487","Con99435","Per59296","Per19129","Sof16206","Mul68492","Res4089","Zer75271"],Zer75271,"Zer75271")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.1136130], [0.1128752], [0.0005309], [0.0000000]], [[0.0000000], [0.0000000], [0.0069411], [0.1312584], [0.1324260], [0.0000000]], [[0.0000000], [0.0000000], [0.0142382], [0.1075856], [0.1195104], [0.0000000]], [[0.0000000], [0.0476300], [0.1361987], [0.1554243], [0.1332576], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0],[0],[0]],[[0],[0.0],[0.11361302882679185],[0.11287524605017274],[0.0005309408933719109],[0]],[[0],[0.0],[0.006941062140331918],[0.13125843911548646],[0.13242602969111444],[0]],[[0],[0.0],[0.014238157809463317],[0.10758556792339564],[0.11951036466410671],[0]],[[0],[0.047630023391220105],[0.1361987440844906],[0.15542424554398265],[0.13325755253276772],[0]],[[0],[0],[0],[0],[0],[0]]]]

Actual:   [[[[0], [0], [0], [0], [0], [0]], [[0], [0], [0.1137], [0.1129], [0.0006], [0]], [[0], [0], [0.007], [0.1313], [0.1325], [0]], [[0], [0], [0.0143], [0.1076], [0.1196], [0]], [[0], [0.0477], [0.1362], [0.1555], [0.1333], [0]], [[0], [0], [0], [0], [0], [0]]]]

Expected: [[[[0], [0], [0], [0], [0], [0]], [[0], [0], [0.1137], [0.1129], [0.0006], [0]], [[0], [0], [0.007], [0.1313], [0.1325], [0]], [[0], [0], [0.0143], [0.1076], [0.1196], [0]], [[0], [0.0477], [0.1362], [0.1555], [0.1333], [0]], [[0], [0], [0], [0], [0], [0]]]]