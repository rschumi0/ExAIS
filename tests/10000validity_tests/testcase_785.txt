import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr2356 = tf.keras.layers.Input(shape=([2, 2, 1]))

Thr2356 = keras.layers.ThresholdedReLU(theta=1.8222001596457817, name = 'Thr2356', input_shape=(2, 2, 1))(in0Thr2356)
ReL38271 = keras.layers.ReLU(max_value=0.9997331395687137, negative_slope=1.8249872663066946, threshold=8.825085821303215, name = 'ReL38271', )(Thr2356)
Sep59525 = keras.layers.SeparableConv2D(3, (1, 1),strides=(2, 2), padding='valid', name = 'Sep59525', )(ReL38271)
Res53947 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res53947', )(Sep59525)
Glo40367 = keras.layers.GlobalMaxPool3D(name = 'Glo40367', )(Res53947)
model = tf.keras.models.Model(inputs=[in0Thr2356], outputs=Glo40367)
w = model.get_layer('Sep59525').get_weights() 
w[0] = np.array([[[[0.3474]]]])
w[1] = np.array([[[[0.24, 0.8761, 0.091]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep59525').set_weights(w) 
in0Thr2356 = tf.constant([[[[0.018], [0.0499]], [[0.0476], [0.613]]]])
print (np.array2string(model.predict([in0Thr2356],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo40367.png')

LThr2356 = thresholded_relu_layer([[[[0.018], [0.0499]], [[0.0476], [0.613]]]], 1.8222001596457817, Thr2356), 
LReL38271 = relu_layer(Thr2356, 0.9997331395687137, 1.8249872663066946, 8.825085821303215, ReL38271), 
LSep59525 = separable_conv2D_layer(ReL38271, 1, 1,[[[[[0.3474]]]],[[[[0.24, 0.8761, 0.091]]]]],[0, 0, 0], 2, 2, false, Sep59525), 
LRes53947 = reshape_layer(Sep59525, [1, 1, 3, 1], Res53947), 
LGlo40367 = global_max_pool3D_layer(Res53947, Glo40367), 
exec_layers([LThr2356,LReL38271,LSep59525,LRes53947,LGlo40367],["Thr2356","ReL38271","Sep59525","Res53947","Glo40367"],Glo40367,"Glo40367")

Actual (Unparsed): [[-0.5091550]]

Expected (Unparsed): [[-0.5091549642028935]]

Actual:   [[-0.5091]]

Expected: [[-0.5091]]