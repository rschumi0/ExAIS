import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con48571 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Min26238 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min26238 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con54449 = tf.keras.layers.Input(shape=([5]))

Con48571 = keras.layers.Conv3D(3, (1, 1, 2),strides=(5, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con48571', )(in0Con48571)
Res80234 = keras.layers.Reshape((1, 2, 3), name = 'Res80234', )(Con48571)
Res67529 = keras.layers.Reshape((1, 6), name = 'Res67529', )(Res80234)
Fla58717 = keras.layers.Flatten(name = 'Fla58717', )(Res67529)
Min26238 = keras.layers.Minimum(name = 'Min26238', )([in0Min26238,in1Min26238])
Glo80546 = keras.layers.GlobalMaxPool2D(name = 'Glo80546', )(Min26238)
Con54449 = keras.layers.Concatenate(axis=1, name = 'Con54449', )([Glo80546,in0Con54449])
Max51640 = keras.layers.Maximum(name = 'Max51640', )([Fla58717,Con54449])
model = tf.keras.models.Model(inputs=[in0Con48571,in0Min26238,in1Min26238,in0Con54449], outputs=Max51640)
w = model.get_layer('Con48571').get_weights() 
w[0] = np.array([[[[[0.5967, 0.9557, 0.5408], [0.9209, 0.7699, 0.2543]], [[0.3688, 0.8339, 0.0423], [0.1545, 0.3422, 0.1052]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con48571').set_weights(w) 
in0Con48571 = tf.constant([[[[[0.6472, 0.5752], [0.9936, 0.8237]], [[0.3783, 0.8562], [0.3026, 0.5911]]]]])
in0Min26238 = tf.constant([[[[0.0129]]]])
in1Min26238 = tf.constant([[[[0.4644]]]])
in0Con54449 = tf.constant([[0.1046, 0.6658, 0.5248, 0.7126, 0.9977]])
print (np.array2string(model.predict([in0Con48571,in0Min26238,in1Min26238,in0Con54449],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max51640.png')

LCon48571 = conv3D_layer([[[[[0.6472, 0.5752], [0.9936, 0.8237]], [[0.3783, 0.8562], [0.3026, 0.5911]]]]], 1, 1, 2,[[[[[0.5967, 0.9557, 0.5408], [0.9209, 0.7699, 0.2543]], [[0.3688, 0.8339, 0.0423], [0.1545, 0.3422, 0.1052]]]]],[0, 0, 0], 5, 1, 1, false, 1, 1, 1, Con48571), 
LRes80234 = reshape_layer(Con48571, [1, 2, 3], Res80234), 
LRes67529 = reshape_layer(Res80234, [1, 6], Res67529), 
LFla58717 = flatten_layer(Res67529, Fla58717), 
LMin26238 = minimum_layer([[[[[0.0129]]]], [[[[0.4644]]]]], Min26238), 
LGlo80546 = global_max_pool2D_layer(Min26238, Glo80546), 
LCon54449 = concatenate_layer([Glo80546,[[0.1046, 0.6658, 0.5248, 0.7126, 0.9977]]], 1, Con54449), 
LMax51640 = maximum_layer([Fla58717,Con54449], Max51640), 
exec_layers([LCon48571,LRes80234,LRes67529,LFla58717,LMin26238,LGlo80546,LCon54449,LMax51640],["Con48571","Res80234","Res67529","Fla58717","Min26238","Glo80546","Con54449","Max51640"],Max51640,"Max51640")

Actual (Unparsed): [[1.4095873, 2.1718087, 0.6658000, 1.2171300, 1.4753422, 0.9977000]]

Expected (Unparsed): [[1.40958725,2.1718087,0.6658,1.2171300200000001,1.47534225,0.9977]]

Actual:   [[1.4096, 2.1719, 0.6658, 1.2172, 1.4754, 0.9977]]

Expected: [[1.4096, 2.1719, 0.6658, 1.2172, 1.4754, 0.9977]]