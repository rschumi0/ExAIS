import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min73822 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Min73822 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot76769 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot76769 = tf.keras.layers.Input(shape=([3, 2]))

Min73822 = keras.layers.Minimum(name = 'Min73822', )([in0Min73822,in1Min73822])
Lea58848 = keras.layers.LeakyReLU(alpha=2.435866400871399, name = 'Lea58848', )(Min73822)
Res93801 = keras.layers.Reshape((2, 4), name = 'Res93801', )(Lea58848)
Sim38655 = keras.layers.SimpleRNN(1,name = 'Sim38655', )(Res93801)
Lea99356 = keras.layers.LeakyReLU(alpha=2.501356620516967, name = 'Lea99356', )(Sim38655)
Res54279 = keras.layers.Reshape((1, 1), name = 'Res54279', )(Lea99356)
Dot76769 = keras.layers.Dot(axes=(2, 2), name = 'Dot76769', )([in0Dot76769,in1Dot76769])
Res9251 = keras.layers.Reshape((3, 3, 1), name = 'Res9251', )(Dot76769)
Res85166 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res85166', )(Res9251)
Glo18844 = keras.layers.GlobalMaxPool3D(name = 'Glo18844', )(Res85166)
Res18407 = keras.layers.Reshape((1, 1), name = 'Res18407', )(Glo18844)
Res36763 = keras.layers.Reshape((1, 1, 1), name = 'Res36763', )(Res18407)
Con33030 = keras.layers.Conv2D(2, (1, 1),strides=(11, 1), padding='same', dilation_rate=(1, 1), name = 'Con33030', )(Res36763)
Res54584 = keras.layers.Reshape((1, 2), name = 'Res54584', )(Con33030)
Dot71199 = keras.layers.Dot(axes=(2, 1), name = 'Dot71199', )([Res54279,Res54584])
Sof13385 = keras.layers.Softmax(axis=1, name = 'Sof13385', )(Dot71199)
model = tf.keras.models.Model(inputs=[in0Min73822,in1Min73822,in0Dot76769,in1Dot76769], outputs=Sof13385)
w = model.get_layer('Sim38655').get_weights() 
w[0] = np.array([[7], [9], [10], [7]])
w[1] = np.array([[8]])
w[2] = np.array([5])
model.get_layer('Sim38655').set_weights(w) 
w = model.get_layer('Con33030').get_weights() 
w[0] = np.array([[[[0.3977, 0.935]]]])
w[1] = np.array([0, 0])
model.get_layer('Con33030').set_weights(w) 
in0Min73822 = tf.constant([[[[0.1794, 0.6004], [0.8955, 0.5758]], [[0.8262, 0.478], [0.8309, 0.9001]]]])
in1Min73822 = tf.constant([[[[0.716, 0.9933], [0.9402, 0.9621]], [[0.5931, 0.2804], [0.1999, 0.6126]]]])
in0Dot76769 = tf.constant([[[0.8317, 0.2705], [0.7204, 0.3359], [0.7635, 0.52]]])
in1Dot76769 = tf.constant([[[0.4905, 0.5746], [0.8406, 0.9729], [0.4019, 0.4433]]])
print (np.array2string(model.predict([in0Min73822,in1Min73822,in0Dot76769,in1Dot76769],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof13385.png')

LMin73822 = minimum_layer([[[[[0.1794, 0.6004], [0.8955, 0.5758]], [[0.8262, 0.478], [0.8309, 0.9001]]]], [[[[0.716, 0.9933], [0.9402, 0.9621]], [[0.5931, 0.2804], [0.1999, 0.6126]]]]], Min73822), 
LLea58848 = leaky_relu_layer(Min73822, 2.435866400871399, Lea58848), 
LRes93801 = reshape_layer(Lea58848, [2, 4], Res93801), 
LSim38655 = simple_rnn_layer(Res93801,[[7], [9], [10], [7]],[[8]],[5], Sim38655), 
LLea99356 = leaky_relu_layer(Sim38655, 2.501356620516967, Lea99356), 
LRes54279 = reshape_layer(Lea99356, [1, 1], Res54279), 
LDot76769 = dot_layer([[[0.8317, 0.2705], [0.7204, 0.3359], [0.7635, 0.52]]], [[[0.4905, 0.5746], [0.8406, 0.9729], [0.4019, 0.4433]]], 2, 2, Dot76769), 
LRes9251 = reshape_layer(Dot76769, [3, 3, 1], Res9251), 
LRes85166 = reshape_layer(Res9251, [3, 3, 1, 1], Res85166), 
LGlo18844 = global_max_pool3D_layer(Res85166, Glo18844), 
LRes18407 = reshape_layer(Glo18844, [1, 1], Res18407), 
LRes36763 = reshape_layer(Res18407, [1, 1, 1], Res36763), 
LCon33030 = conv2D_layer(Res36763, 1, 1,[[[[0.3977, 0.935]]]],[0, 0], 11, 1, true, 1, 1, Con33030), 
LRes54584 = reshape_layer(Con33030, [1, 2], Res54584), 
LDot71199 = dot_layer(Res54279,Res54584, 2, 1, Dot71199), 
LSof13385 = softmax_layer(Dot71199, 1, Sof13385), 
exec_layers([LMin73822,LLea58848,LRes93801,LSim38655,LLea99356,LRes54279,LDot76769,LRes9251,LRes85166,LGlo18844,LRes18407,LRes36763,LCon33030,LRes54584,LDot71199,LSof13385],["Min73822","Lea58848","Res93801","Sim38655","Lea99356","Res54279","Dot76769","Res9251","Res85166","Glo18844","Res18407","Res36763","Con33030","Res54584","Dot71199","Sof13385"],Sof13385,"Sof13385")

Actual (Unparsed): [[[1.0000000, 1.0000000]]]

Expected (Unparsed): [[[1.0,1.0]]]

Actual:   [[[1, 1]]]

Expected: [[[1, 1]]]