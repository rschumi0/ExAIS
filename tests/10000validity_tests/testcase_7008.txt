import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo90428 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con29708 = tf.keras.layers.Input(shape=([1, 1, 3]))
in0Cro56867 = tf.keras.layers.Input(shape=([1, 1, 4]))

Glo90428 = keras.layers.GlobalMaxPool2D(name = 'Glo90428', )(in0Glo90428)
Res62548 = keras.layers.Reshape((2, 1), name = 'Res62548', )(Glo90428)
Res57006 = keras.layers.Reshape((2, 1, 1), name = 'Res57006', )(Res62548)
Glo80871 = keras.layers.GlobalMaxPool2D(name = 'Glo80871', )(Res57006)
Res30618 = keras.layers.Reshape((1, 1), name = 'Res30618', )(Glo80871)
Res62863 = keras.layers.Reshape((1, 1, 1), name = 'Res62863', )(Res30618)
Con29708 = keras.layers.Concatenate(axis=3, name = 'Con29708', )([Res62863,in0Con29708])
Cro56867 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro56867', )(in0Cro56867)
Sub65078 = keras.layers.Subtract(name = 'Sub65078', )([Con29708,Cro56867])
Res53471 = keras.layers.Reshape((1, 4), name = 'Res53471', )(Sub65078)
PRe69759 = keras.layers.PReLU(name = 'PRe69759', )(Res53471)
model = tf.keras.models.Model(inputs=[in0Glo90428,in0Con29708,in0Cro56867], outputs=PRe69759)
w = model.get_layer('PRe69759').get_weights() 
w[0] = np.array([[0.393, 0.1988, 0.6956, 0.3772]])
model.get_layer('PRe69759').set_weights(w) 
in0Glo90428 = tf.constant([[[[1.8924, 1.6652]]]])
in0Con29708 = tf.constant([[[[0.6325, 0.2206, 0.8591]]]])
in0Cro56867 = tf.constant([[[[1.2994, 1.2672, 1.7221, 1.4093]]]])
print (np.array2string(model.predict([in0Glo90428,in0Con29708,in0Cro56867],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe69759.png')

LGlo90428 = global_max_pool2D_layer([[[[1.8924, 1.6652]]]], Glo90428), 
LRes62548 = reshape_layer(Glo90428, [2, 1], Res62548), 
LRes57006 = reshape_layer(Res62548, [2, 1, 1], Res57006), 
LGlo80871 = global_max_pool2D_layer(Res57006, Glo80871), 
LRes30618 = reshape_layer(Glo80871, [1, 1], Res30618), 
LRes62863 = reshape_layer(Res30618, [1, 1, 1], Res62863), 
LCon29708 = concatenate_layer([Res62863,[[[[0.6325, 0.2206, 0.8591]]]]], 3, Con29708), 
LCro56867 = cropping2D_layer([[[[1.2994, 1.2672, 1.7221, 1.4093]]]], 0, 0, 0, 0, Cro56867), 
LSub65078 = subtract_layer(Con29708,Cro56867, Sub65078), 
LRes53471 = reshape_layer(Sub65078, [1, 4], Res53471), 
LPRe69759 = prelu_layer(Res53471, [[0.393, 0.1988, 0.6956, 0.3772]], PRe69759), 
exec_layers([LGlo90428,LRes62548,LRes57006,LGlo80871,LRes30618,LRes62863,LCon29708,LCro56867,LSub65078,LRes53471,LPRe69759],["Glo90428","Res62548","Res57006","Glo80871","Res30618","Res62863","Con29708","Cro56867","Sub65078","Res53471","PRe69759"],PRe69759,"PRe69759")

Actual (Unparsed): [[[0.5930001, -0.1261784, -1.0444434, -0.2075354]]]

Expected (Unparsed): [[[0.593,-0.12617836000000004,-1.0444434,-0.20753544]]]

Actual:   [[[0.5931, -0.1261, -1.0444, -0.2075]]]

Expected: [[[0.593, -0.1261, -1.0444, -0.2075]]]