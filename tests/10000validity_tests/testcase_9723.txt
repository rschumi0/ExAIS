import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max88999 = tf.keras.layers.Input(shape=([1, 1]))
in1Max88999 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave595 = tf.keras.layers.Input(shape=([1, 2]))
in0Con23208 = tf.keras.layers.Input(shape=([1, 1]))

Max88999 = keras.layers.Maximum(name = 'Max88999', )([in0Max88999,in1Max88999])
Res79501 = keras.layers.Reshape((1, 1, 1), name = 'Res79501', )(Max88999)
Res1005 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res1005', )(Res79501)
Con16555 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con16555', )(Res1005)
Bat58632 = keras.layers.BatchNormalization(axis=3, epsilon=0.6820147132419756,  name = 'Bat58632', )(Con16555)
Den30641 = keras.layers.Dense(3,name = 'Den30641', )(Bat58632)
Res23461 = keras.layers.Reshape((1, 1, 3), name = 'Res23461', )(Den30641)
Res50314 = keras.layers.Reshape((1, 3), name = 'Res50314', )(Res23461)
Ave595 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave595', )(in0Ave595)
Con23208 = keras.layers.Concatenate(axis=2, name = 'Con23208', )([Ave595,in0Con23208])
Add41093 = keras.layers.Add(name = 'Add41093', )([Res50314,Con23208])
model = tf.keras.models.Model(inputs=[in0Max88999,in1Max88999,in0Ave595,in0Con23208], outputs=Add41093)
w = model.get_layer('Con16555').get_weights() 
w[0] = np.array([[[[[0.3513, 0.9125, 0.3512, 0.2303]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con16555').set_weights(w) 
w = model.get_layer('Bat58632').get_weights() 
w[0] = np.array([0.1916])
w[1] = np.array([0.5014])
w[2] = np.array([0.9243])
w[3] = np.array([0.221])
model.get_layer('Bat58632').set_weights(w) 
w = model.get_layer('Den30641').get_weights() 
w[0] = np.array([[0.4401, 0.3186, 0.2718], [0.4706, 0.0429, 0.0744], [0.2169, 0.4596, 0.3598], [0.9642, 0.168, 0.578]])
w[1] = np.array([0.3031, 0.5242, 0.1828])
model.get_layer('Den30641').set_weights(w) 
in0Max88999 = tf.constant([[[0.0766]]])
in1Max88999 = tf.constant([[[0.3157]]])
in0Ave595 = tf.constant([[[1.9411, 1.7444]]])
in0Con23208 = tf.constant([[[0.6351]]])
print (np.array2string(model.predict([in0Max88999,in1Max88999,in0Ave595,in0Con23208],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add41093.png')

LMax88999 = maximum_layer([[[[0.0766]]], [[[0.3157]]]], Max88999), 
LRes79501 = reshape_layer(Max88999, [1, 1, 1], Res79501), 
LRes1005 = reshape_layer(Res79501, [1, 1, 1, 1], Res1005), 
LCon16555 = conv3D_layer(Res1005, 1, 1, 1,[[[[[0.3513, 0.9125, 0.3512, 0.2303]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con16555), 
LBat58632 = batch_normalization_layer(Con16555, 3, 0.6820147132419756, [0.1916], [0.5014], [0.9243], [0.221], Bat58632), 
LDen30641 = dense_layer(Bat58632, [[0.4401, 0.3186, 0.2718], [0.4706, 0.0429, 0.0744], [0.2169, 0.4596, 0.3598], [0.9642, 0.168, 0.578]],[0.3031, 0.5242, 0.1828], Den30641), 
LRes23461 = reshape_layer(Den30641, [1, 1, 3], Res23461), 
LRes50314 = reshape_layer(Res23461, [1, 3], Res50314), 
LAve595 = average_pooling1D_layer([[[1.9411, 1.7444]]], 1, Ave595), 
LCon23208 = concatenate_layer([Ave595,[[[0.6351]]]], 2, Con23208), 
LAdd41093 = add_layer([Res50314,Con23208], Add41093), 
exec_layers([LMax88999,LRes79501,LRes1005,LCon16555,LBat58632,LDen30641,LRes23461,LRes50314,LAve595,LCon23208,LAdd41093],["Max88999","Res79501","Res1005","Con16555","Bat58632","Den30641","Res23461","Res50314","Ave595","Con23208","Add41093"],Add41093,"Add41093")

Actual (Unparsed): [[[2.9593522, 2.6025559, 1.2493226]]]

Expected (Unparsed): [[[2.959352180900189,2.602555892032749,1.24932257415371]]]

Actual:   [[[2.9594, 2.6026, 1.2494]]]

Expected: [[[2.9594, 2.6026, 1.2494]]]