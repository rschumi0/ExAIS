import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub47984 = tf.keras.layers.Input(shape=([3]))
in1Sub47984 = tf.keras.layers.Input(shape=([3]))
in0Sep67105 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dot84592 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot84592 = tf.keras.layers.Input(shape=([2, 3]))
in0Con63544 = tf.keras.layers.Input(shape=([3, 1]))
in0Con98010 = tf.keras.layers.Input(shape=([3, 4, 1]))
in0Dot45375 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot45375 = tf.keras.layers.Input(shape=([3, 2]))
in0Con51441 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Min96265 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Min96265 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con2123 = tf.keras.layers.Input(shape=([3, 4, 1]))

Sub47984 = keras.layers.Subtract(name = 'Sub47984', )([in0Sub47984,in1Sub47984])
Res32752 = keras.layers.Reshape((3, 1), name = 'Res32752', )(Sub47984)
Res33010 = keras.layers.Reshape((3, 1, 1), name = 'Res33010', )(Res32752)
Res7743 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res7743', )(Res33010)
Con46836 = keras.layers.Conv3D(3, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con46836', )(Res7743)
Res85079 = keras.layers.Reshape((3, 1, 3), name = 'Res85079', )(Con46836)
Zer30706 = keras.layers.ZeroPadding2D(padding=((0, 0), (3, 0)), name = 'Zer30706', )(Res85079)
Sep67105 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='same', name = 'Sep67105', )(in0Sep67105)
Res48743 = keras.layers.Reshape((1, 4), name = 'Res48743', )(Sep67105)
Zer97094 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer97094', )(Res48743)
Dot84592 = keras.layers.Dot(axes=(1, 1), name = 'Dot84592', )([in0Dot84592,in1Dot84592])
Con63544 = keras.layers.Concatenate(axis=2, name = 'Con63544', )([Dot84592,in0Con63544])
Min49240 = keras.layers.Minimum(name = 'Min49240', )([Zer97094,Con63544])
Res92707 = keras.layers.Reshape((3, 4, 1), name = 'Res92707', )(Min49240)
Con98010 = keras.layers.Concatenate(axis=3, name = 'Con98010', )([Res92707,in0Con98010])
Dot45375 = keras.layers.Dot(axes=(2, 2), name = 'Dot45375', )([in0Dot45375,in1Dot45375])
Res30126 = keras.layers.Reshape((3, 3, 1), name = 'Res30126', )(Dot45375)
Con51441 = keras.layers.Concatenate(axis=3, name = 'Con51441', )([Res30126,in0Con51441])
Min96265 = keras.layers.Minimum(name = 'Min96265', )([in0Min96265,in1Min96265])
Zer87416 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer87416', )(Min96265)
Sub25183 = keras.layers.Subtract(name = 'Sub25183', )([Con51441,Zer87416])
Zer48782 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer48782', )(Sub25183)
Min76046 = keras.layers.Minimum(name = 'Min76046', )([Con98010,Zer48782])
Con2123 = keras.layers.Concatenate(axis=3, name = 'Con2123', )([Min76046,in0Con2123])
Min67423 = keras.layers.Minimum(name = 'Min67423', )([Zer30706,Con2123])
model = tf.keras.models.Model(inputs=[in0Sub47984,in1Sub47984,in0Sep67105,in0Dot84592,in1Dot84592,in0Con63544,in0Con98010,in0Dot45375,in1Dot45375,in0Con51441,in0Min96265,in1Min96265,in0Con2123], outputs=Min67423)
w = model.get_layer('Con46836').get_weights() 
w[0] = np.array([[[[[0.8884, 0.733, 0.0383]]]], [[[[0.626, 0.1735, 0.4913]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con46836').set_weights(w) 
w = model.get_layer('Sep67105').get_weights() 
w[0] = np.array([[[[0.6989], [0.5978]]]])
w[1] = np.array([[[[0.1379, 0.405], [0.3649, 0.4706]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep67105').set_weights(w) 
in0Sub47984 = tf.constant([[0.7679, 0.6284, 0.4623]])
in1Sub47984 = tf.constant([[0.2606, 0.7873, 0.3941]])
in0Sep67105 = tf.constant([[[[0.1392, 0.1242], [0.3955, 0.321]]]])
in0Dot84592 = tf.constant([[[0.0657, 0.6454, 0.3838], [0.4348, 0.7843, 0.9719]]])
in1Dot84592 = tf.constant([[[0.8345, 0.5596, 0.5241], [0.9024, 0.2061, 0.0037]]])
in0Con63544 = tf.constant([[[0.554], [0.7462], [0.6871]]])
in0Con98010 = tf.constant([[[[0.2858], [0.8637], [0.7708], [0.7778]], [[0.6722], [0.0119], [0.98], [0.6459]], [[0.8603], [0.8238], [0.461], [0.5349]]]])
in0Dot45375 = tf.constant([[[0.8148, 0.8034], [0.031, 0.2117], [0.1114, 0.8805]]])
in1Dot45375 = tf.constant([[[0.3121, 0.7671], [0.4289, 0.2609], [0.5074, 0.8104]]])
in0Con51441 = tf.constant([[[[0.5453], [0.3932], [0.2751]], [[0.705], [0.4198], [0.8365]], [[0.4843], [0.676], [0.2468]]]])
in0Min96265 = tf.constant([[[[0.3667, 0.7295]], [[0.1996, 0.28]]]])
in1Min96265 = tf.constant([[[[0.187, 0.5041]], [[0.1593, 0.3817]]]])
in0Con2123 = tf.constant([[[[0.7436], [0.1416], [0.7337], [0.0793]], [[0.7522], [0.6717], [0.9366], [0.6626]], [[0.4246], [0.8979], [0.7799], [0.3439]]]])
print (np.array2string(model.predict([in0Sub47984,in1Sub47984,in0Sep67105,in0Dot84592,in1Dot84592,in0Con63544,in0Con98010,in0Dot45375,in1Dot45375,in0Con51441,in0Min96265,in1Min96265,in0Con2123],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min67423.png')

LSub47984 = subtract_layer([[0.7679, 0.6284, 0.4623]], [[0.2606, 0.7873, 0.3941]], Sub47984), 
LRes32752 = reshape_layer(Sub47984, [3, 1], Res32752), 
LRes33010 = reshape_layer(Res32752, [3, 1, 1], Res33010), 
LRes7743 = reshape_layer(Res33010, [3, 1, 1, 1], Res7743), 
LCon46836 = conv3D_layer(Res7743, 2, 1, 1,[[[[[0.8884, 0.733, 0.0383]]]], [[[[0.626, 0.1735, 0.4913]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con46836), 
LRes85079 = reshape_layer(Con46836, [3, 1, 3], Res85079), 
LZer30706 = zero_padding2D_layer(Res85079, 0, 0, 3, 0, Zer30706), 
LSep67105 = separable_conv2D_layer([[[[0.1392, 0.1242], [0.3955, 0.321]]]], 1, 1,[[[[[0.6989], [0.5978]]]],[[[[0.1379, 0.405], [0.3649, 0.4706]]]]],[0, 0], 1, 1, true, Sep67105), 
LRes48743 = reshape_layer(Sep67105, [1, 4], Res48743), 
LZer97094 = zero_padding1D_layer(Res48743, 2, 0, Zer97094), 
LDot84592 = dot_layer([[[0.0657, 0.6454, 0.3838], [0.4348, 0.7843, 0.9719]]], [[[0.8345, 0.5596, 0.5241], [0.9024, 0.2061, 0.0037]]], 1, 1, Dot84592), 
LCon63544 = concatenate_layer([Dot84592,[[[0.554], [0.7462], [0.6871]]]], 2, Con63544), 
LMin49240 = minimum_layer([Zer97094,Con63544], Min49240), 
LRes92707 = reshape_layer(Min49240, [3, 4, 1], Res92707), 
LCon98010 = concatenate_layer([Res92707,[[[[0.2858], [0.8637], [0.7708], [0.7778]], [[0.6722], [0.0119], [0.98], [0.6459]], [[0.8603], [0.8238], [0.461], [0.5349]]]]], 3, Con98010), 
LDot45375 = dot_layer([[[0.8148, 0.8034], [0.031, 0.2117], [0.1114, 0.8805]]], [[[0.3121, 0.7671], [0.4289, 0.2609], [0.5074, 0.8104]]], 2, 2, Dot45375), 
LRes30126 = reshape_layer(Dot45375, [3, 3, 1], Res30126), 
LCon51441 = concatenate_layer([Res30126,[[[[0.5453], [0.3932], [0.2751]], [[0.705], [0.4198], [0.8365]], [[0.4843], [0.676], [0.2468]]]]], 3, Con51441), 
LMin96265 = minimum_layer([[[[[0.3667, 0.7295]], [[0.1996, 0.28]]]], [[[[0.187, 0.5041]], [[0.1593, 0.3817]]]]], Min96265), 
LZer87416 = zero_padding2D_layer(Min96265, 1, 0, 2, 0, Zer87416), 
LSub25183 = subtract_layer(Con51441,Zer87416, Sub25183), 
LZer48782 = zero_padding2D_layer(Sub25183, 0, 0, 1, 0, Zer48782), 
LMin76046 = minimum_layer([Con98010,Zer48782], Min76046), 
LCon2123 = concatenate_layer([Min76046,[[[[0.7436], [0.1416], [0.7337], [0.0793]], [[0.7522], [0.6717], [0.9366], [0.6626]], [[0.4246], [0.8979], [0.7799], [0.3439]]]]], 3, Con2123), 
LMin67423 = minimum_layer([Zer30706,Con2123], Min67423), 
exec_layers([LSub47984,LRes32752,LRes33010,LRes7743,LCon46836,LRes85079,LZer30706,LSep67105,LRes48743,LZer97094,LDot84592,LCon63544,LMin49240,LRes92707,LCon98010,LDot45375,LRes30126,LCon51441,LMin96265,LZer87416,LSub25183,LZer48782,LMin76046,LCon2123,LMin67423],["Sub47984","Res32752","Res33010","Res7743","Con46836","Res85079","Zer30706","Sep67105","Res48743","Zer97094","Dot84592","Con63544","Min49240","Res92707","Con98010","Dot45375","Res30126","Con51441","Min96265","Zer87416","Sub25183","Zer48782","Min76046","Con2123","Min67423"],Min67423,"Min67423")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.2751000, -0.0586380]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [-0.0984735, -0.1046410, 0.0274208]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [0.0605889, -0.0332000, 0.0026121]]]]

Expected (Unparsed): [[[[0,0,0],[0,0,0],[0,0,0],[0,0.2751,-0.05863798000000001]],[[0,0,0],[0,0,0],[0,0,0],[-0.09847356000000004,-0.10464100000000003,0.027420789999999994]],[[0,0,0],[0,0,0],[0,0,0],[0.060588879999999984,-0.033200000000000035,0.0026120599999999994]]]]

Actual:   [[[[0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0.2751, -0.0586]], [[0, 0, 0], [0, 0, 0], [0, 0, 0], [-0.0984, -0.1046, 0.0275]], [[0, 0, 0], [0, 0, 0], [0, 0, 0], [0.0606, -0.0332, 0.0027]]]]

Expected: [[[[0, 0, 0], [0, 0, 0], [0, 0, 0], [0, 0.2751, -0.0586]], [[0, 0, 0], [0, 0, 0], [0, 0, 0], [-0.0984, -0.1046, 0.0275]], [[0, 0, 0], [0, 0, 0], [0, 0, 0], [0.0606, -0.0332, 0.0027]]]]