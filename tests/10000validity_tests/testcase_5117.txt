import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max70937 = tf.keras.layers.Input(shape=([2, 2]))
in1Max70937 = tf.keras.layers.Input(shape=([2, 2]))
in0Ave6980 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave6980 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Dot22534 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot22534 = tf.keras.layers.Input(shape=([3, 3]))

Max70937 = keras.layers.Maximum(name = 'Max70937', )([in0Max70937,in1Max70937])
Ave6980 = keras.layers.Average(name = 'Ave6980', )([in0Ave6980,in1Ave6980])
Res87861 = keras.layers.Reshape((2, 1), name = 'Res87861', )(Ave6980)
Cro37731 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro37731', )(Res87861)
Zer31053 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer31053', )(Cro37731)
Dot82030 = keras.layers.Dot(axes=(1, 1), name = 'Dot82030', )([Max70937,Zer31053])
Zer4403 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer4403', )(Dot82030)
Dot22534 = keras.layers.Dot(axes=(1, 2), name = 'Dot22534', )([in0Dot22534,in1Dot22534])
Fla17441 = keras.layers.Flatten(name = 'Fla17441', )(Dot22534)
Res11383 = keras.layers.Reshape((9, 1), name = 'Res11383', )(Fla17441)
Res82080 = keras.layers.Reshape((9, 1, 1), name = 'Res82080', )(Res11383)
Max43703 = keras.layers.MaxPool2D(pool_size=(9, 1), strides=(1, 1), padding='valid', name = 'Max43703', )(Res82080)
Res53925 = keras.layers.Reshape((1, 1), name = 'Res53925', )(Max43703)
Zer10389 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer10389', )(Res53925)
Add12768 = keras.layers.Add(name = 'Add12768', )([Zer4403,Zer10389])
model = tf.keras.models.Model(inputs=[in0Max70937,in1Max70937,in0Ave6980,in1Ave6980,in0Dot22534,in1Dot22534], outputs=Add12768)
in0Max70937 = tf.constant([[[0.0244, 0.5427], [0.0372, 0.1616]]])
in1Max70937 = tf.constant([[[0.5717, 0.4329], [0.1442, 0.4788]]])
in0Ave6980 = tf.constant([[[[0.5764]], [[0.5505]]]])
in1Ave6980 = tf.constant([[[[0.6492]], [[0.8004]]]])
in0Dot22534 = tf.constant([[[0.517, 0.4478, 0.8987], [0.7866, 0.2719, 0.5331], [0.8248, 0.0964, 0.4161]]])
in1Dot22534 = tf.constant([[[0.368, 0.2551, 0.9676], [0.0012, 0.6014, 0.9004], [0.3356, 0.888, 0.3751]]])
print (np.array2string(model.predict([in0Max70937,in1Max70937,in0Ave6980,in1Ave6980,in0Dot22534,in1Dot22534],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add12768.png')

LMax70937 = maximum_layer([[[[0.0244, 0.5427], [0.0372, 0.1616]]], [[[0.5717, 0.4329], [0.1442, 0.4788]]]], Max70937), 
LAve6980 = average_layer([[[[[0.5764]], [[0.5505]]]], [[[[0.6492]], [[0.8004]]]]], Ave6980), 
LRes87861 = reshape_layer(Ave6980, [2, 1], Res87861), 
LCro37731 = cropping1D_layer(Res87861, 1, 0, Cro37731), 
LZer31053 = zero_padding1D_layer(Cro37731, 1, 0, Zer31053), 
LDot82030 = dot_layer(Max70937,Zer31053, 1, 1, Dot82030), 
LZer4403 = zero_padding1D_layer(Dot82030, 1, 0, Zer4403), 
LDot22534 = dot_layer([[[0.517, 0.4478, 0.8987], [0.7866, 0.2719, 0.5331], [0.8248, 0.0964, 0.4161]]], [[[0.368, 0.2551, 0.9676], [0.0012, 0.6014, 0.9004], [0.3356, 0.888, 0.3751]]], 1, 2, Dot22534), 
LFla17441 = flatten_layer(Dot22534, Fla17441), 
LRes11383 = reshape_layer(Fla17441, [9, 1], Res11383), 
LRes82080 = reshape_layer(Res11383, [9, 1, 1], Res82080), 
LMax43703 = max_pool2D_layer(Res82080, 9, 1, 1, 1, false, Max43703), 
LRes53925 = reshape_layer(Max43703, [1, 1], Res53925), 
LZer10389 = zero_padding1D_layer(Res53925, 1, 1, Zer10389), 
LAdd12768 = add_layer([Zer4403,Zer10389], Add12768), 
exec_layers([LMax70937,LAve6980,LRes87861,LCro37731,LZer31053,LDot82030,LZer4403,LDot22534,LFla17441,LRes11383,LRes82080,LMax43703,LRes53925,LZer10389,LAdd12768],["Max70937","Ave6980","Res87861","Cro37731","Zer31053","Dot82030","Zer4403","Dot22534","Fla17441","Res11383","Res82080","Max43703","Res53925","Zer10389","Add12768"],Add12768,"Add12768")

Actual (Unparsed): [[[0.0000000], [1.3137315], [0.3234055]]]

Expected (Unparsed): [[[0],[1.31373145],[0.32340546]]]

Actual:   [[[0], [1.3138], [0.3235]]]

Expected: [[[0], [1.3138], [0.3235]]]