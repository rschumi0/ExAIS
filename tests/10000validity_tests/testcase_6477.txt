import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave86362 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave86362 = tf.keras.layers.Input(shape=([2, 2]))
in0Max51705 = tf.keras.layers.Input(shape=([1, 2, 1]))

Ave86362 = keras.layers.Average(name = 'Ave86362', )([in0Ave86362,in1Ave86362])
Res42858 = keras.layers.Reshape((2, 2, 1), name = 'Res42858', )(Ave86362)
Max51705 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max51705', )(in0Max51705)
Zer40314 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer40314', )(Max51705)
Add49918 = keras.layers.Add(name = 'Add49918', )([Res42858,Zer40314])
Sof38928 = keras.layers.Softmax(axis=1, name = 'Sof38928', )(Add49918)
model = tf.keras.models.Model(inputs=[in0Ave86362,in1Ave86362,in0Max51705], outputs=Sof38928)
in0Ave86362 = tf.constant([[[0.6458, 0.8053], [0.3372, 0.0757]]])
in1Ave86362 = tf.constant([[[0.1439, 0.3099], [0.0063, 0.0134]]])
in0Max51705 = tf.constant([[[[1.6212], [1.9513]]]])
print (np.array2string(model.predict([in0Ave86362,in1Ave86362,in0Max51705],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof38928.png')

LAve86362 = average_layer([[[[0.6458, 0.8053], [0.3372, 0.0757]]], [[[0.1439, 0.3099], [0.0063, 0.0134]]]], Ave86362), 
LRes42858 = reshape_layer(Ave86362, [2, 2, 1], Res42858), 
LMax51705 = max_pool2D_layer([[[[1.6212], [1.9513]]]], 1, 1, Max51705), 
LZer40314 = zero_padding2D_layer(Max51705, 1, 0, 0, 0, Zer40314), 
LAdd49918 = add_layer([Res42858,Zer40314], Add49918), 
LSof38928 = softmax_layer(Add49918, 1, Sof38928), 
exec_layers([LAve86362,LRes42858,LMax51705,LZer40314,LAdd49918,LSof38928],["Ave86362","Res42858","Max51705","Zer40314","Add49918","Sof38928"],Sof38928,"Sof38928")

Actual (Unparsed): [[[[0.1981178], [0.1918165]], [[0.8018822], [0.8081835]]]]

Expected (Unparsed): [[[[0.19811778586209028],[0.19181649237852996]],[[0.8018822141379097],[0.80818350762147]]]]

Actual:   [[[[0.1982], [0.1919]], [[0.8019], [0.8082]]]]

Expected: [[[[0.1982], [0.1919]], [[0.8019], [0.8082]]]]