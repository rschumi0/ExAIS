import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max97385 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max97385 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con92920 = tf.keras.layers.Input(shape=([2, 2]))
in0Max51894 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max51894 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Mul3928 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul3928 = tf.keras.layers.Input(shape=([2, 1]))
in0Con64221 = tf.keras.layers.Input(shape=([2, 1]))
in0Con99255 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul9684 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul9684 = tf.keras.layers.Input(shape=([2, 1]))

Max97385 = keras.layers.Maximum(name = 'Max97385', )([in0Max97385,in1Max97385])
Res31060 = keras.layers.Reshape((1, 2), name = 'Res31060', )(Max97385)
Zer90130 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer90130', )(Res31060)
Con92920 = keras.layers.Concatenate(axis=2, name = 'Con92920', )([Zer90130,in0Con92920])
Max51894 = keras.layers.Maximum(name = 'Max51894', )([in0Max51894,in1Max51894])
Res45007 = keras.layers.Reshape((2, 2), name = 'Res45007', )(Max51894)
Mul3928 = keras.layers.Multiply(name = 'Mul3928', )([in0Mul3928,in1Mul3928])
Con64221 = keras.layers.Concatenate(axis=2, name = 'Con64221', )([Mul3928,in0Con64221])
Max25380 = keras.layers.Maximum(name = 'Max25380', )([Res45007,Con64221])
Con99255 = keras.layers.Concatenate(axis=2, name = 'Con99255', )([Max25380,in0Con99255])
Mul9684 = keras.layers.Multiply(name = 'Mul9684', )([in0Mul9684,in1Mul9684])
Loc13739 = keras.layers.LocallyConnected1D(4, (2),strides=(11), name = 'Loc13739', )(Mul9684)
Zer98175 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer98175', )(Loc13739)
Add81124 = keras.layers.Add(name = 'Add81124', )([Con99255,Zer98175])
Mul89504 = keras.layers.Multiply(name = 'Mul89504', )([Con92920,Add81124])
model = tf.keras.models.Model(inputs=[in0Max97385,in1Max97385,in0Con92920,in0Max51894,in1Max51894,in0Mul3928,in1Mul3928,in0Con64221,in0Con99255,in0Mul9684,in1Mul9684], outputs=Mul89504)
w = model.get_layer('Loc13739').get_weights() 
w[0] = np.array([[[0.2716, 0.175, 0.9952, 0.5287], [0.2325, 0.2306, 0.7744, 0.1116]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc13739').set_weights(w) 
in0Max97385 = tf.constant([[[[0.2346], [0.1329]]]])
in1Max97385 = tf.constant([[[[0.2166], [0.2758]]]])
in0Con92920 = tf.constant([[[0.8835, 0.7188], [0.8534, 0.1656]]])
in0Max51894 = tf.constant([[[[0.1005, 0.81]], [[0.3298, 0.3673]]]])
in1Max51894 = tf.constant([[[[0.08, 0.2688]], [[0.0695, 0.5132]]]])
in0Mul3928 = tf.constant([[[0.2056], [0.6711]]])
in1Mul3928 = tf.constant([[[0.4329], [0.1707]]])
in0Con64221 = tf.constant([[[0.073], [0.0879]]])
in0Con99255 = tf.constant([[[0.8835, 0.7076], [0.5721, 0.864]]])
in0Mul9684 = tf.constant([[[0.4252], [0.4704]]])
in1Mul9684 = tf.constant([[[0.2282], [0.8536]]])
print (np.array2string(model.predict([in0Max97385,in1Max97385,in0Con92920,in0Max51894,in1Max51894,in0Mul3928,in1Mul3928,in0Con64221,in0Con99255,in0Mul9684,in1Mul9684],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul89504.png')

LMax97385 = maximum_layer([[[[[0.2346], [0.1329]]]], [[[[0.2166], [0.2758]]]]], Max97385), 
LRes31060 = reshape_layer(Max97385, [1, 2], Res31060), 
LZer90130 = zero_padding1D_layer(Res31060, 1, 0, Zer90130), 
LCon92920 = concatenate_layer([Zer90130,[[[0.8835, 0.7188], [0.8534, 0.1656]]]], 2, Con92920), 
LMax51894 = maximum_layer([[[[[0.1005, 0.81]], [[0.3298, 0.3673]]]], [[[[0.08, 0.2688]], [[0.0695, 0.5132]]]]], Max51894), 
LRes45007 = reshape_layer(Max51894, [2, 2], Res45007), 
LMul3928 = multiply_layer([[[[0.2056], [0.6711]]], [[[0.4329], [0.1707]]]], Mul3928), 
LCon64221 = concatenate_layer([Mul3928,[[[0.073], [0.0879]]]], 2, Con64221), 
LMax25380 = maximum_layer([Res45007,Con64221], Max25380), 
LCon99255 = concatenate_layer([Max25380,[[[0.8835, 0.7076], [0.5721, 0.864]]]], 2, Con99255), 
LMul9684 = multiply_layer([[[[0.4252], [0.4704]]], [[[0.2282], [0.8536]]]], Mul9684), 
LLoc13739 = locally_connected1D_layer(Mul9684, 2,[[[0.2716, 0.175, 0.9952, 0.5287], [0.2325, 0.2306, 0.7744, 0.1116]]],[[0, 0, 0, 0]], 11, Loc13739), 
LZer98175 = zero_padding1D_layer(Loc13739, 1, 0, Zer98175), 
LAdd81124 = add_layer([Con99255,Zer98175], Add81124), 
LMul89504 = multiply_layer([Con92920,Add81124], Mul89504), 
exec_layers([LMax97385,LRes31060,LZer90130,LCon92920,LMax51894,LRes45007,LMul3928,LCon64221,LMax25380,LCon99255,LMul9684,LLoc13739,LZer98175,LAdd81124,LMul89504],["Max97385","Res31060","Zer90130","Con92920","Max51894","Res45007","Mul3928","Con64221","Max25380","Con99255","Mul9684","Loc13739","Zer98175","Add81124","Mul89504"],Mul89504,"Mul89504")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.7805722, 0.5086229], [0.1054551, 0.1717611, 0.8360012, 0.1589944]]]

Expected (Unparsed): [[[0.0,0.0,0.78057225,0.50862288],[0.10545505693799039,0.17176106182621118,0.8360012126565377,0.15899441989864319]]]

Actual:   [[[0, 0, 0.7806, 0.5087], [0.1055, 0.1718, 0.8361, 0.159]]]

Expected: [[[0, 0, 0.7806, 0.5087], [0.1055, 0.1718, 0.8361, 0.159]]]