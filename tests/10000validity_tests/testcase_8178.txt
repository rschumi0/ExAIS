import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min76026 = tf.keras.layers.Input(shape=([2, 2]))
in1Min76026 = tf.keras.layers.Input(shape=([2, 2]))
in0Mul59178 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul59178 = tf.keras.layers.Input(shape=([2, 2]))

Min76026 = keras.layers.Minimum(name = 'Min76026', )([in0Min76026,in1Min76026])
Mul59178 = keras.layers.Multiply(name = 'Mul59178', )([in0Mul59178,in1Mul59178])
Ave14255 = keras.layers.Average(name = 'Ave14255', )([Min76026,Mul59178])
model = tf.keras.models.Model(inputs=[in0Min76026,in1Min76026,in0Mul59178,in1Mul59178], outputs=Ave14255)
in0Min76026 = tf.constant([[[0.9903, 0.8756], [0.6451, 0.4475]]])
in1Min76026 = tf.constant([[[0.6981, 0.0881], [0.4313, 0.4167]]])
in0Mul59178 = tf.constant([[[0.9149, 0.7506], [0.6627, 0.7471]]])
in1Mul59178 = tf.constant([[[0.0854, 0.4118], [0.0319, 0.7502]]])
print (np.array2string(model.predict([in0Min76026,in1Min76026,in0Mul59178,in1Mul59178],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave14255.png')

LMin76026 = minimum_layer([[[[0.9903, 0.8756], [0.6451, 0.4475]]], [[[0.6981, 0.0881], [0.4313, 0.4167]]]], Min76026), 
LMul59178 = multiply_layer([[[[0.9149, 0.7506], [0.6627, 0.7471]]], [[[0.0854, 0.4118], [0.0319, 0.7502]]]], Mul59178), 
LAve14255 = average_layer([Min76026,Mul59178], Ave14255), 
exec_layers([LMin76026,LMul59178,LAve14255],["Min76026","Mul59178","Ave14255"],Ave14255,"Ave14255")

Actual (Unparsed): [[[0.3881162, 0.1985985], [0.2262201, 0.4885872]]]

Expected (Unparsed): [[[0.38811623,0.19859854000000002],[0.226220065,0.48858721000000005]]]

Actual:   [[[0.3882, 0.1986], [0.2263, 0.4886]]]

Expected: [[[0.3882, 0.1986], [0.2263, 0.4886]]]