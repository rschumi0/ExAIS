import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave27970 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave27970 = tf.keras.layers.Input(shape=([1, 2]))
in0Dot98717 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot98717 = tf.keras.layers.Input(shape=([2, 2]))

Ave27970 = keras.layers.Average(name = 'Ave27970', )([in0Ave27970,in1Ave27970])
Res99019 = keras.layers.Reshape((1, 2, 1), name = 'Res99019', )(Ave27970)
Res23333 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res23333', )(Res99019)
Zer80113 = keras.layers.ZeroPadding3D(padding=((3, 0), (2, 0), (2, 0)), name = 'Zer80113', )(Res23333)
Dot98717 = keras.layers.Dot(axes=(1, 1), name = 'Dot98717', )([in0Dot98717,in1Dot98717])
Res33492 = keras.layers.Reshape((2, 2, 1), name = 'Res33492', )(Dot98717)
Res86885 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res86885', )(Res33492)
Zer1243 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer1243', )(Res86885)
Min48224 = keras.layers.Minimum(name = 'Min48224', )([Zer80113,Zer1243])
model = tf.keras.models.Model(inputs=[in0Ave27970,in1Ave27970,in0Dot98717,in1Dot98717], outputs=Min48224)
in0Ave27970 = tf.constant([[[0.9866, 0.4771]]])
in1Ave27970 = tf.constant([[[0.8638, 0.6551]]])
in0Dot98717 = tf.constant([[[0.2934, 0.7944], [0.0331, 0.2624]]])
in1Dot98717 = tf.constant([[[0.1406, 0.7479], [0.6517, 0.9394]]])
print (np.array2string(model.predict([in0Ave27970,in1Ave27970,in0Dot98717,in1Dot98717],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min48224.png')

LAve27970 = average_layer([[[[0.9866, 0.4771]]], [[[0.8638, 0.6551]]]], Ave27970), 
LRes99019 = reshape_layer(Ave27970, [1, 2, 1], Res99019), 
LRes23333 = reshape_layer(Res99019, [1, 2, 1, 1], Res23333), 
LZer80113 = zero_padding3D_layer(Res23333, 3, 0, 2, 0, 2, 0, Zer80113), 
LDot98717 = dot_layer([[[0.2934, 0.7944], [0.0331, 0.2624]]], [[[0.1406, 0.7479], [0.6517, 0.9394]]], 1, 1, Dot98717), 
LRes33492 = reshape_layer(Dot98717, [2, 2, 1], Res33492), 
LRes86885 = reshape_layer(Res33492, [2, 2, 1, 1], Res86885), 
LZer1243 = zero_padding3D_layer(Res86885, 1, 1, 1, 1, 1, 1, Zer1243), 
LMin48224 = minimum_layer([Zer80113,Zer1243], Min48224), 
exec_layers([LAve27970,LRes99019,LRes23333,LZer80113,LDot98717,LRes33492,LRes86885,LZer1243,LMin48224],["Ave27970","Res99019","Res23333","Zer80113","Dot98717","Res33492","Res86885","Zer1243","Min48224"],Min48224,"Min48224")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]