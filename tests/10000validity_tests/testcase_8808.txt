import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con32581 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))

Con32581 = keras.layers.Conv3DTranspose(2, (2, 1, 2),strides=(3, 1, 1), padding='valid', name = 'Con32581', )(in0Con32581)
Res93332 = keras.layers.Reshape((6, 1, 6), name = 'Res93332', )(Con32581)
Res38876 = keras.layers.Reshape((6, 6), name = 'Res38876', )(Res93332)
Sim7365 = keras.layers.SimpleRNN(3,name = 'Sim7365', )(Res38876)
Mas46366 = keras.layers.Masking(mask_value=2, name = 'Mas46366', )(Sim7365)
model = tf.keras.models.Model(inputs=[in0Con32581], outputs=Mas46366)
w = model.get_layer('Con32581').get_weights() 
w[0] = np.array([[[[[0.5475], [0.3711]], [[0.521], [0.4076]]]], [[[[0.3973], [0.7994]], [[0.724], [0.1059]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con32581').set_weights(w) 
w = model.get_layer('Sim7365').get_weights() 
w[0] = np.array([[9, 2, 9], [10, 10, 1], [5, 10, 7], [5, 2, 8], [7, 4, 3], [8, 5, 10]])
w[1] = np.array([[2, 1, 1], [3, 4, 4], [3, 4, 8]])
w[2] = np.array([4, 10, 2])
model.get_layer('Sim7365').set_weights(w) 
in0Con32581 = tf.constant([[[[[0.4114], [0.8589]]], [[[0.6165], [0.445]]]]])
print (np.array2string(model.predict([in0Con32581],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas46366.png')

LCon32581 = conv3D_transpose_layer([[[[[0.4114], [0.8589]]], [[[0.6165], [0.445]]]]], 2, 1, 2,[[[[[0.5475], [0.3711]], [[0.521], [0.4076]]]], [[[[0.3973], [0.7994]], [[0.724], [0.1059]]]]],[0, 0], 3, 1, 1, false, Con32581), 
LRes93332 = reshape_layer(Con32581, [6, 1, 6], Res93332), 
LRes38876 = reshape_layer(Res93332, [6, 6], Res38876), 
LSim7365 = simple_rnn_layer(Res38876,[[9, 2, 9], [10, 10, 1], [5, 10, 7], [5, 2, 8], [7, 4, 3], [8, 5, 10]],[[2, 1, 1], [3, 4, 4], [3, 4, 8]],[4, 10, 2], Sim7365), 
LMas46366 = masking_layer(Sim7365, 2, Mas46366), 
exec_layers([LCon32581,LRes93332,LRes38876,LSim7365,LMas46366],["Con32581","Res93332","Res38876","Sim7365","Mas46366"],Mas46366,"Mas46366")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[0.9999999999244973,0.9999999999999999,0.9999999999998128]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]