import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU8740 = tf.keras.layers.Input(shape=([3, 2]))
in0Min57284 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min57284 = tf.keras.layers.Input(shape=([2, 2, 1]))

GRU8740 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU8740', )(in0GRU8740)
Res63050 = keras.layers.Reshape((3, 1), name = 'Res63050', )(GRU8740)
Res99763 = keras.layers.Reshape((3, 1, 1), name = 'Res99763', )(Res63050)
Zer65920 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer65920', )(Res99763)
Min57284 = keras.layers.Minimum(name = 'Min57284', )([in0Min57284,in1Min57284])
Zer11915 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer11915', )(Min57284)
Mul49877 = keras.layers.Multiply(name = 'Mul49877', )([Zer65920,Zer11915])
model = tf.keras.models.Model(inputs=[in0GRU8740,in0Min57284,in1Min57284], outputs=Mul49877)
w = model.get_layer('GRU8740').get_weights() 
w[0] = np.array([[5, 2, 10, 4, 7, 10, 2, 8, 4], [6, 5, 10, 8, 6, 8, 5, 4, 8]])
w[1] = np.array([[4, 4, 10, 2, 1, 2, 7, 2, 1], [3, 2, 4, 2, 10, 1, 3, 7, 10], [10, 8, 3, 1, 3, 4, 1, 7, 9]])
w[2] = np.array([7, 3, 3, 4, 4, 8, 6, 7, 10])
model.get_layer('GRU8740').set_weights(w) 
in0GRU8740 = tf.constant([[[7, 5], [6, 4], [10, 10]]])
in0Min57284 = tf.constant([[[[0.1421], [0.4303]], [[0.8318], [0.0697]]]])
in1Min57284 = tf.constant([[[[0.9254], [0.893]], [[0.6195], [0.2875]]]])
print (np.array2string(model.predict([in0GRU8740,in0Min57284,in1Min57284],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul49877.png')

LGRU8740 = gru_layer([[[7, 5], [6, 4], [10, 10]]],[[5, 2, 10, 4, 7, 10, 2, 8, 4], [6, 5, 10, 8, 6, 8, 5, 4, 8]],[[4, 4, 10, 2, 1, 2, 7, 2, 1], [3, 2, 4, 2, 10, 1, 3, 7, 10], [10, 8, 3, 1, 3, 4, 1, 7, 9]],[7, 3, 3, 4, 4, 8, 6, 7, 10], false, GRU8740), 
LRes63050 = reshape_layer(GRU8740, [3, 1], Res63050), 
LRes99763 = reshape_layer(Res63050, [3, 1, 1], Res99763), 
LZer65920 = zero_padding2D_layer(Res99763, 0, 0, 2, 0, Zer65920), 
LMin57284 = minimum_layer([[[[[0.1421], [0.4303]], [[0.8318], [0.0697]]]], [[[[0.9254], [0.893]], [[0.6195], [0.2875]]]]], Min57284), 
LZer11915 = zero_padding2D_layer(Min57284, 1, 0, 1, 0, Zer11915), 
LMul49877 = multiply_layer([Zer65920,Zer11915], Mul49877), 
exec_layers([LGRU8740,LRes63050,LRes99763,LZer65920,LMin57284,LZer11915,LMul49877],["GRU8740","Res63050","Res99763","Zer65920","Min57284","Zer11915","Mul49877"],Mul49877,"Mul49877")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0.0]],[[0],[0.0],[2.8663738049772295e-16]],[[0],[0.0],[0.0]]]]

Actual:   [[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]