import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con76627 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Glo52881 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con99107 = tf.keras.layers.Input(shape=([3, 4, 3]))
in0Cro40980 = tf.keras.layers.Input(shape=([2, 2, 4]))
in0Con58732 = tf.keras.layers.Input(shape=([3, 4, 2]))

Con76627 = keras.layers.Conv3DTranspose(3, (2, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con76627', )(in0Con76627)
Res65296 = keras.layers.Reshape((3, 2, 6), name = 'Res65296', )(Con76627)
Zer97803 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer97803', )(Res65296)
Glo52881 = keras.layers.GlobalAveragePooling2D(name = 'Glo52881', )(in0Glo52881)
Res27520 = keras.layers.Reshape((1, 1), name = 'Res27520', )(Glo52881)
Res24596 = keras.layers.Reshape((1, 1, 1), name = 'Res24596', )(Res27520)
Zer97744 = keras.layers.ZeroPadding2D(padding=((2, 0), (3, 0)), name = 'Zer97744', )(Res24596)
Con99107 = keras.layers.Concatenate(axis=3, name = 'Con99107', )([Zer97744,in0Con99107])
Cro40980 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro40980', )(in0Cro40980)
Zer66389 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer66389', )(Cro40980)
Mul12820 = keras.layers.Multiply(name = 'Mul12820', )([Con99107,Zer66389])
Con58732 = keras.layers.Concatenate(axis=3, name = 'Con58732', )([Mul12820,in0Con58732])
Min36411 = keras.layers.Minimum(name = 'Min36411', )([Zer97803,Con58732])
Res75964 = keras.layers.Reshape((3, 24), name = 'Res75964', )(Min36411)
LST32205 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST32205', )(Res75964)
Res2441 = keras.layers.Reshape((2, 1), name = 'Res2441', )(LST32205)
Zer32008 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer32008', )(Res2441)
model = tf.keras.models.Model(inputs=[in0Con76627,in0Glo52881,in0Con99107,in0Cro40980,in0Con58732], outputs=Zer32008)
w = model.get_layer('Con76627').get_weights() 
w[0] = np.array([[[[[0.2528, 0.3396], [0.591, 0.0394], [0.4679, 0.9749]]]], [[[[0.7213, 0.0171], [0.9278, 0.6841], [0.4145, 0.3364]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con76627').set_weights(w) 
w = model.get_layer('LST32205').get_weights() 
w[0] = np.array([[3, 4, 7, 9, 2, 8, 10, 5], [7, 10, 10, 4, 3, 7, 10, 8], [7, 1, 2, 9, 1, 5, 10, 1], [7, 10, 10, 9, 2, 6, 5, 6], [4, 9, 1, 2, 6, 6, 6, 5], [5, 7, 4, 7, 4, 9, 6, 8], [5, 8, 7, 6, 8, 10, 2, 4], [6, 9, 3, 6, 2, 4, 10, 1], [5, 9, 6, 1, 4, 5, 1, 3], [3, 6, 8, 1, 8, 7, 5, 2], [6, 4, 8, 7, 6, 3, 2, 8], [8, 7, 5, 1, 4, 1, 9, 5], [5, 9, 6, 7, 3, 5, 3, 7], [5, 7, 5, 2, 1, 2, 9, 1], [6, 10, 4, 7, 3, 4, 4, 10], [8, 10, 7, 8, 4, 2, 9, 8], [8, 2, 2, 4, 8, 5, 8, 2], [5, 8, 4, 7, 7, 9, 5, 8], [7, 5, 8, 6, 1, 10, 2, 10], [5, 3, 10, 7, 2, 9, 10, 5], [6, 10, 10, 4, 8, 7, 3, 9], [10, 6, 5, 5, 3, 7, 1, 6], [5, 5, 4, 8, 9, 4, 4, 2], [1, 9, 4, 8, 3, 10, 7, 4]])
w[1] = np.array([[6, 1, 2, 9, 10, 9, 9, 8], [3, 8, 2, 1, 8, 2, 4, 6]])
w[2] = np.array([6, 3, 7, 7, 5, 1, 1, 7])
model.get_layer('LST32205').set_weights(w) 
in0Con76627 = tf.constant([[[[[0.7154, 0.9933], [0.892, 0.0976]], [[0.9788, 0.4527], [0.9726, 0.6269]]], [[[0.5855, 0.3646], [0.9775, 0.8719]], [[0.0704, 0.8471], [0.6554, 0.734]]]]])
in0Glo52881 = tf.constant([[[[1.9955], [1.0303]], [[1.9222], [1.8223]]]])
in0Con99107 = tf.constant([[[[0.215, 0.2341, 0.02], [0.7107, 0.9506, 0.2141], [0.0214, 0.57, 0.3239], [0.7043, 0.7605, 0.2463]], [[0.8647, 0.9106, 0.4389], [0.4652, 0.8839, 0.6373], [0.8645, 0.4759, 0.6329], [0.6543, 0.8219, 0.8541]], [[0.5037, 0.5604, 0.599], [0.3589, 0.4087, 0.6657], [0.8325, 0.9207, 0.252], [0.8171, 0.6825, 0.4465]]]])
in0Cro40980 = tf.constant([[[[1.2808, 1.9442, 1.0913, 1.1875], [1.7364, 1.9662, 1.499, 1.4893]], [[1.6526, 1.242, 1.2291, 1.9037], [1.3782, 1.4736, 1.5989, 1.5805]]]])
in0Con58732 = tf.constant([[[[0.5278, 0.7038], [0.3182, 0.1605], [0.8076, 0.6432], [0.9818, 0.615]], [[0.1847, 0.5543], [0.3995, 0.0257], [0.4165, 0.3076], [0.7754, 0.4001]], [[0.5832, 0.5143], [0.3299, 0.3178], [0.883, 0.9047], [0.7565, 0.988]]]])
print (np.array2string(model.predict([in0Con76627,in0Glo52881,in0Con99107,in0Cro40980,in0Con58732],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer32008.png')

LCon76627 = conv3D_transpose_layer([[[[[0.7154, 0.9933], [0.892, 0.0976]], [[0.9788, 0.4527], [0.9726, 0.6269]]], [[[0.5855, 0.3646], [0.9775, 0.8719]], [[0.0704, 0.8471], [0.6554, 0.734]]]]], 2, 1, 1,[[[[[0.2528, 0.3396], [0.591, 0.0394], [0.4679, 0.9749]]]], [[[[0.7213, 0.0171], [0.9278, 0.6841], [0.4145, 0.3364]]]]],[0, 0, 0], 1, 1, 1, false, Con76627), 
LRes65296 = reshape_layer(Con76627, [3, 2, 6], Res65296), 
LZer97803 = zero_padding2D_layer(Res65296, 0, 0, 2, 0, Zer97803), 
LGlo52881 = global_average_pooling2D_layer([[[[1.9955], [1.0303]], [[1.9222], [1.8223]]]], Glo52881), 
LRes27520 = reshape_layer(Glo52881, [1, 1], Res27520), 
LRes24596 = reshape_layer(Res27520, [1, 1, 1], Res24596), 
LZer97744 = zero_padding2D_layer(Res24596, 2, 0, 3, 0, Zer97744), 
LCon99107 = concatenate_layer([Zer97744,[[[[0.215, 0.2341, 0.02], [0.7107, 0.9506, 0.2141], [0.0214, 0.57, 0.3239], [0.7043, 0.7605, 0.2463]], [[0.8647, 0.9106, 0.4389], [0.4652, 0.8839, 0.6373], [0.8645, 0.4759, 0.6329], [0.6543, 0.8219, 0.8541]], [[0.5037, 0.5604, 0.599], [0.3589, 0.4087, 0.6657], [0.8325, 0.9207, 0.252], [0.8171, 0.6825, 0.4465]]]]], 3, Con99107), 
LCro40980 = cropping2D_layer([[[[1.2808, 1.9442, 1.0913, 1.1875], [1.7364, 1.9662, 1.499, 1.4893]], [[1.6526, 1.242, 1.2291, 1.9037], [1.3782, 1.4736, 1.5989, 1.5805]]]], 1, 0, 0, 0, Cro40980), 
LZer66389 = zero_padding2D_layer(Cro40980, 1, 1, 1, 1, Zer66389), 
LMul12820 = multiply_layer([Con99107,Zer66389], Mul12820), 
LCon58732 = concatenate_layer([Mul12820,[[[[0.5278, 0.7038], [0.3182, 0.1605], [0.8076, 0.6432], [0.9818, 0.615]], [[0.1847, 0.5543], [0.3995, 0.0257], [0.4165, 0.3076], [0.7754, 0.4001]], [[0.5832, 0.5143], [0.3299, 0.3178], [0.883, 0.9047], [0.7565, 0.988]]]]], 3, Con58732), 
LMin36411 = minimum_layer([Zer97803,Con58732], Min36411), 
LRes75964 = reshape_layer(Min36411, [3, 24], Res75964), 
LLST32205 = lstm_layer(Res75964,[[3, 4, 7, 9, 2, 8, 10, 5], [7, 10, 10, 4, 3, 7, 10, 8], [7, 1, 2, 9, 1, 5, 10, 1], [7, 10, 10, 9, 2, 6, 5, 6], [4, 9, 1, 2, 6, 6, 6, 5], [5, 7, 4, 7, 4, 9, 6, 8], [5, 8, 7, 6, 8, 10, 2, 4], [6, 9, 3, 6, 2, 4, 10, 1], [5, 9, 6, 1, 4, 5, 1, 3], [3, 6, 8, 1, 8, 7, 5, 2], [6, 4, 8, 7, 6, 3, 2, 8], [8, 7, 5, 1, 4, 1, 9, 5], [5, 9, 6, 7, 3, 5, 3, 7], [5, 7, 5, 2, 1, 2, 9, 1], [6, 10, 4, 7, 3, 4, 4, 10], [8, 10, 7, 8, 4, 2, 9, 8], [8, 2, 2, 4, 8, 5, 8, 2], [5, 8, 4, 7, 7, 9, 5, 8], [7, 5, 8, 6, 1, 10, 2, 10], [5, 3, 10, 7, 2, 9, 10, 5], [6, 10, 10, 4, 8, 7, 3, 9], [10, 6, 5, 5, 3, 7, 1, 6], [5, 5, 4, 8, 9, 4, 4, 2], [1, 9, 4, 8, 3, 10, 7, 4]],[[6, 1, 2, 9, 10, 9, 9, 8], [3, 8, 2, 1, 8, 2, 4, 6]],[6, 3, 7, 7, 5, 1, 1, 7], LST32205), 
LRes2441 = reshape_layer(LST32205, [2, 1], Res2441), 
LZer32008 = zero_padding1D_layer(Res2441, 1, 1, Zer32008), 
exec_layers([LCon76627,LRes65296,LZer97803,LGlo52881,LRes27520,LRes24596,LZer97744,LCon99107,LCro40980,LZer66389,LMul12820,LCon58732,LMin36411,LRes75964,LLST32205,LRes2441,LZer32008],["Con76627","Res65296","Zer97803","Glo52881","Res27520","Res24596","Zer97744","Con99107","Cro40980","Zer66389","Mul12820","Con58732","Min36411","Res75964","LST32205","Res2441","Zer32008"],Zer32008,"Zer32008")

Actual (Unparsed): [[[0.0000000], [0.9950548], [0.9950548], [0.0000000]]]

Expected (Unparsed): [[[0],[0.9950547529352856],[0.995054753132422],[0]]]

Actual:   [[[0], [0.9951], [0.9951], [0]]]

Expected: [[[0], [0.9951], [0.9951], [0]]]