import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim28620 = tf.keras.layers.Input(shape=([1, 3]))

Sim28620 = keras.layers.SimpleRNN(3,name = 'Sim28620', )(in0Sim28620)
Res98218 = keras.layers.Reshape((3, 1), name = 'Res98218', )(Sim28620)
Per77831 = keras.layers.Permute((2,1), name = 'Per77831',)(Res98218)
Res69248 = keras.layers.Reshape((1, 3, 1), name = 'Res69248', )(Per77831)
Res52725 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res52725', )(Res69248)
Con50081 = keras.layers.Conv3DTranspose(4, (1, 3, 1),strides=(12, 1, 1), padding='valid', name = 'Con50081', )(Res52725)
model = tf.keras.models.Model(inputs=[in0Sim28620], outputs=Con50081)
w = model.get_layer('Sim28620').get_weights() 
w[0] = np.array([[6, 2, 1], [4, 2, 7], [8, 1, 9]])
w[1] = np.array([[7, 9, 5], [10, 1, 2], [6, 8, 8]])
w[2] = np.array([3, 10, 10])
model.get_layer('Sim28620').set_weights(w) 
w = model.get_layer('Con50081').get_weights() 
w[0] = np.array([[[[[0.8071], [0.1527], [0.3143], [0.6446]]], [[[0.5653], [0.3018], [0.6695], [0.7398]]], [[[0.2485], [0.6615], [0.7647], [0.2405]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con50081').set_weights(w) 
in0Sim28620 = tf.constant([[[4, 4, 4]]])
print (np.array2string(model.predict([in0Sim28620],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con50081.png')

LSim28620 = simple_rnn_layer([[[4, 4, 4]]],[[6, 2, 1], [4, 2, 7], [8, 1, 9]],[[7, 9, 5], [10, 1, 2], [6, 8, 8]],[3, 10, 10], Sim28620), 
LRes98218 = reshape_layer(Sim28620, [3, 1], Res98218), 
LPer77831 = permute_layer(Res98218, 2,1, Per77831), 
LRes69248 = reshape_layer(Per77831, [1, 3, 1], Res69248), 
LRes52725 = reshape_layer(Res69248, [1, 3, 1, 1], Res52725), 
LCon50081 = conv3D_transpose_layer(Res52725, 1, 3, 1,[[[[[0.8071], [0.1527], [0.3143], [0.6446]]], [[[0.5653], [0.3018], [0.6695], [0.7398]]], [[[0.2485], [0.6615], [0.7647], [0.2405]]]]],[0, 0, 0, 0], 12, 1, 1, false, Con50081), 
exec_layers([LSim28620,LRes98218,LPer77831,LRes69248,LRes52725,LCon50081],["Sim28620","Res98218","Per77831","Res69248","Res52725","Con50081"],Con50081,"Con50081")

Actual (Unparsed): [[[[[0.8071000, 0.1527000, 0.3143000, 0.6446000]], [[1.3724000, 0.4545000, 0.9838000, 1.3844000]], [[1.6209000, 1.1160000, 1.7485000, 1.6249000]], [[0.8138000, 0.9633000, 1.4342000, 0.9803000]], [[0.2485000, 0.6615000, 0.7647000, 0.2405000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]]

Expected (Unparsed): [[[[[0.8071,0.1527,0.3143,0.6446]],[[1.3724,0.4545,0.9838,1.3843999999999999]],[[1.6209000000000002,1.116,1.7485000000000002,1.6248999999999998]],[[0.8138000000000001,0.9633,1.4342000000000001,0.9803]],[[0.2485,0.6615,0.7647,0.2405]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]],[[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]],[[0,0,0,0]]]]]

Actual:   [[[[[0.8071, 0.1527, 0.3143, 0.6446]], [[1.3724, 0.4545, 0.9838, 1.3844]], [[1.6209, 1.116, 1.7485, 1.6249]], [[0.8138, 0.9633, 1.4342, 0.9803]], [[0.2485, 0.6615, 0.7647, 0.2405]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]]]]

Expected: [[[[[0.8071, 0.1527, 0.3143, 0.6446]], [[1.3724, 0.4545, 0.9838, 1.3844]], [[1.621, 1.116, 1.7486, 1.6249]], [[0.8139, 0.9633, 1.4343, 0.9803]], [[0.2485, 0.6615, 0.7647, 0.2405]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], [[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]]]]