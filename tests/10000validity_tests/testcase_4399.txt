import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU49304 = tf.keras.layers.Input(shape=([1, 1]))
in0Per94681 = tf.keras.layers.Input(shape=([2, 1]))
in0Con82638 = tf.keras.layers.Input(shape=([1, 1]))
in0Max86857 = tf.keras.layers.Input(shape=([1, 2]))
in0Add61334 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Add61334 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Lea69780 = tf.keras.layers.Input(shape=([1, 1]))

GRU49304 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU49304', )(in0GRU49304)
Res65665 = keras.layers.Reshape((2, 1), name = 'Res65665', )(GRU49304)
Res19689 = keras.layers.Reshape((2, 1, 1), name = 'Res19689', )(Res65665)
Zer3714 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer3714', )(Res19689)
Per94681 = keras.layers.Permute((1,2), name = 'Per94681',)(in0Per94681)
Res77809 = keras.layers.Reshape((2, 1, 1), name = 'Res77809', )(Per94681)
Res43416 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res43416', )(Res77809)
Cro45727 = keras.layers.Cropping3D(cropping=((1, 0), (0, 0), (0, 0)), name = 'Cro45727', )(Res43416)
Res95813 = keras.layers.Reshape((1, 1, 1), name = 'Res95813', )(Cro45727)
Res32453 = keras.layers.Reshape((1, 1), name = 'Res32453', )(Res95813)
Con82638 = keras.layers.Concatenate(axis=2, name = 'Con82638', )([Res32453,in0Con82638])
Max86857 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max86857', )(in0Max86857)
Min25482 = keras.layers.Minimum(name = 'Min25482', )([Con82638,Max86857])
Res25423 = keras.layers.Reshape((1, 2, 1), name = 'Res25423', )(Min25482)
Zer62301 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer62301', )(Res25423)
Add61334 = keras.layers.Add(name = 'Add61334', )([in0Add61334,in1Add61334])
Res66593 = keras.layers.Reshape((2, 1, 1), name = 'Res66593', )(Add61334)
Lea69780 = keras.layers.LeakyReLU(alpha=4.5156853100115235, name = 'Lea69780', input_shape=(1, 1))(in0Lea69780)
Res48435 = keras.layers.Reshape((1, 1, 1), name = 'Res48435', )(Lea69780)
Ave38680 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave38680', )(Res48435)
Zer11292 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer11292', )(Ave38680)
Max78277 = keras.layers.Maximum(name = 'Max78277', )([Res66593,Zer11292])
Zer88167 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer88167', )(Max78277)
Add98801 = keras.layers.Add(name = 'Add98801', )([Zer62301,Zer88167])
Mul87983 = keras.layers.Multiply(name = 'Mul87983', )([Zer3714,Add98801])
model = tf.keras.models.Model(inputs=[in0GRU49304,in0Per94681,in0Con82638,in0Max86857,in0Add61334,in1Add61334,in0Lea69780], outputs=Mul87983)
w = model.get_layer('GRU49304').get_weights() 
w[0] = np.array([[9, 9, 4, 7, 8, 1]])
w[1] = np.array([[4, 9, 9, 9, 2, 4], [3, 2, 10, 2, 6, 9]])
w[2] = np.array([9, 4, 2, 3, 10, 7])
model.get_layer('GRU49304').set_weights(w) 
in0GRU49304 = tf.constant([[[10]]])
in0Per94681 = tf.constant([[[1.5422], [1.1103]]])
in0Con82638 = tf.constant([[[0.7512]]])
in0Max86857 = tf.constant([[[1.5098, 1.6086]]])
in0Add61334 = tf.constant([[[[[0.8617]]], [[[0.6665]]]]])
in1Add61334 = tf.constant([[[[[0.5442]]], [[[0.2883]]]]])
in0Lea69780 = tf.constant([[[0.6687]]])
print (np.array2string(model.predict([in0GRU49304,in0Per94681,in0Con82638,in0Max86857,in0Add61334,in1Add61334,in0Lea69780],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul87983.png')

LGRU49304 = gru_layer([[[10]]],[[9, 9, 4, 7, 8, 1]],[[4, 9, 9, 9, 2, 4], [3, 2, 10, 2, 6, 9]],[9, 4, 2, 3, 10, 7], false, GRU49304), 
LRes65665 = reshape_layer(GRU49304, [2, 1], Res65665), 
LRes19689 = reshape_layer(Res65665, [2, 1, 1], Res19689), 
LZer3714 = zero_padding2D_layer(Res19689, 0, 0, 2, 0, Zer3714), 
LPer94681 = permute_layer([[[1.5422], [1.1103]]], 1,2, Per94681), 
LRes77809 = reshape_layer(Per94681, [2, 1, 1], Res77809), 
LRes43416 = reshape_layer(Res77809, [2, 1, 1, 1], Res43416), 
LCro45727 = cropping3D_layer(Res43416, 1, 0, 0, 0, 0, 0, Cro45727), 
LRes95813 = reshape_layer(Cro45727, [1, 1, 1], Res95813), 
LRes32453 = reshape_layer(Res95813, [1, 1], Res32453), 
LCon82638 = concatenate_layer([Res32453,[[[0.7512]]]], 2, Con82638), 
LMax86857 = max_pool1D_layer([[[1.5098, 1.6086]]], 1, Max86857), 
LMin25482 = minimum_layer([Con82638,Max86857], Min25482), 
LRes25423 = reshape_layer(Min25482, [1, 2, 1], Res25423), 
LZer62301 = zero_padding2D_layer(Res25423, 1, 0, 1, 0, Zer62301), 
LAdd61334 = add_layer([[[[[[0.8617]]], [[[0.6665]]]]], [[[[[0.5442]]], [[[0.2883]]]]]], Add61334), 
LRes66593 = reshape_layer(Add61334, [2, 1, 1], Res66593), 
LLea69780 = leaky_relu_layer([[[0.6687]]], 4.5156853100115235, Lea69780), 
LRes48435 = reshape_layer(Lea69780, [1, 1, 1], Res48435), 
LAve38680 = average_pooling2D_layer(Res48435, 1, 1, Ave38680), 
LZer11292 = zero_padding2D_layer(Ave38680, 1, 0, 0, 0, Zer11292), 
LMax78277 = maximum_layer([Res66593,Zer11292], Max78277), 
LZer88167 = zero_padding2D_layer(Max78277, 0, 0, 2, 0, Zer88167), 
LAdd98801 = add_layer([Zer62301,Zer88167], Add98801), 
LMul87983 = multiply_layer([Zer3714,Add98801], Mul87983), 
exec_layers([LGRU49304,LRes65665,LRes19689,LZer3714,LPer94681,LRes77809,LRes43416,LCro45727,LRes95813,LRes32453,LCon82638,LMax86857,LMin25482,LRes25423,LZer62301,LAdd61334,LRes66593,LLea69780,LRes48435,LAve38680,LZer11292,LMax78277,LZer88167,LAdd98801,LMul87983],["GRU49304","Res65665","Res19689","Zer3714","Per94681","Res77809","Res43416","Cro45727","Res95813","Res32453","Con82638","Max86857","Min25482","Res25423","Zer62301","Add61334","Res66593","Lea69780","Res48435","Ave38680","Zer11292","Max78277","Zer88167","Add98801","Mul87983"],Mul87983,"Mul87983")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0.0]],[[0],[0.0],[0.0]]]]

Actual:   [[[[0], [0], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [0], [0]]]]