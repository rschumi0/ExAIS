import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max7201 = tf.keras.layers.Input(shape=([1, 2]))
in1Max7201 = tf.keras.layers.Input(shape=([1, 2]))
in0Ave93386 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con95096 = tf.keras.layers.Input(shape=([1, 1]))
in0Glo26341 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Mul22239 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Mul22239 = tf.keras.layers.Input(shape=([1, 2, 1]))

Max7201 = keras.layers.Maximum(name = 'Max7201', )([in0Max7201,in1Max7201])
Ave93386 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 1), padding='valid', name = 'Ave93386', )(in0Ave93386)
Res93637 = keras.layers.Reshape((1, 1), name = 'Res93637', )(Ave93386)
Up_58034 = keras.layers.UpSampling1D(size=(1), name = 'Up_58034', )(Res93637)
Con95096 = keras.layers.Concatenate(axis=2, name = 'Con95096', )([Up_58034,in0Con95096])
Mul13143 = keras.layers.Multiply(name = 'Mul13143', )([Max7201,Con95096])
Res50531 = keras.layers.Reshape((1, 2, 1), name = 'Res50531', )(Mul13143)
Glo26341 = keras.layers.GlobalAveragePooling2D(name = 'Glo26341', )(in0Glo26341)
ELU24827 = keras.layers.ELU(alpha=4.457280125925102, name = 'ELU24827', )(Glo26341)
Res14377 = keras.layers.Reshape((1, 1), name = 'Res14377', )(ELU24827)
Res83060 = keras.layers.Reshape((1, 1, 1), name = 'Res83060', )(Res14377)
Zer29317 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer29317', )(Res83060)
Mul22239 = keras.layers.Multiply(name = 'Mul22239', )([in0Mul22239,in1Mul22239])
Sub19929 = keras.layers.Subtract(name = 'Sub19929', )([Zer29317,Mul22239])
Max31716 = keras.layers.Maximum(name = 'Max31716', )([Res50531,Sub19929])
model = tf.keras.models.Model(inputs=[in0Max7201,in1Max7201,in0Ave93386,in0Con95096,in0Glo26341,in0Mul22239,in1Mul22239], outputs=Max31716)
in0Max7201 = tf.constant([[[0.0514, 0.0002]]])
in1Max7201 = tf.constant([[[0.9581, 0.5149]]])
in0Ave93386 = tf.constant([[[[1.4023]]]])
in0Con95096 = tf.constant([[[0.3783]]])
in0Glo26341 = tf.constant([[[[1.85]]]])
in0Mul22239 = tf.constant([[[[0.0794], [0.2595]]]])
in1Mul22239 = tf.constant([[[[0.0333], [0.2807]]]])
print (np.array2string(model.predict([in0Max7201,in1Max7201,in0Ave93386,in0Con95096,in0Glo26341,in0Mul22239,in1Mul22239],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max31716.png')

LMax7201 = maximum_layer([[[[0.0514, 0.0002]]], [[[0.9581, 0.5149]]]], Max7201), 
LAve93386 = average_pooling2D_layer([[[[1.4023]]]], 1, 1, 1, 1, false, Ave93386), 
LRes93637 = reshape_layer(Ave93386, [1, 1], Res93637), 
LUp_58034 = up_sampling1D_layer(Res93637, 1, Up_58034), 
LCon95096 = concatenate_layer([Up_58034,[[[0.3783]]]], 2, Con95096), 
LMul13143 = multiply_layer([Max7201,Con95096], Mul13143), 
LRes50531 = reshape_layer(Mul13143, [1, 2, 1], Res50531), 
LGlo26341 = global_average_pooling2D_layer([[[[1.85]]]], Glo26341), 
LELU24827 = elu_layer(Glo26341, 4.457280125925102, ELU24827), 
LRes14377 = reshape_layer(ELU24827, [1, 1], Res14377), 
LRes83060 = reshape_layer(Res14377, [1, 1, 1], Res83060), 
LZer29317 = zero_padding2D_layer(Res83060, 0, 0, 1, 0, Zer29317), 
LMul22239 = multiply_layer([[[[[0.0794], [0.2595]]]], [[[[0.0333], [0.2807]]]]], Mul22239), 
LSub19929 = subtract_layer(Zer29317,Mul22239, Sub19929), 
LMax31716 = maximum_layer([Res50531,Sub19929], Max31716), 
exec_layers([LMax7201,LAve93386,LRes93637,LUp_58034,LCon95096,LMul13143,LRes50531,LGlo26341,LELU24827,LRes14377,LRes83060,LZer29317,LMul22239,LSub19929,LMax31716],["Max7201","Ave93386","Res93637","Up_58034","Con95096","Mul13143","Res50531","Glo26341","ELU24827","Res14377","Res83060","Zer29317","Mul22239","Sub19929","Max31716"],Max31716,"Max31716")

Actual (Unparsed): [[[[1.3435437], [1.7771584]]]]

Expected (Unparsed): [[[[1.34354363],[1.77715835]]]]

Actual:   [[[[1.3436], [1.7772]]]]

Expected: [[[[1.3436], [1.7772]]]]