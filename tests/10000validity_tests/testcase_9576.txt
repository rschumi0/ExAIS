import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per829 = tf.keras.layers.Input(shape=([1, 2]))

Per829 = keras.layers.Permute((2,1), name = 'Per829',)(in0Per829)
ELU98566 = keras.layers.ELU(alpha=6.443836861173658, name = 'ELU98566', )(Per829)
Res98342 = keras.layers.Reshape((2, 1, 1), name = 'Res98342', )(ELU98566)
Max43798 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max43798', )(Res98342)
Sep18631 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep18631', )(Max43798)
Res16580 = keras.layers.Reshape((1, 4), name = 'Res16580', )(Sep18631)
Sim86774 = keras.layers.SimpleRNN(1,name = 'Sim86774', )(Res16580)
model = tf.keras.models.Model(inputs=[in0Per829], outputs=Sim86774)
w = model.get_layer('Sep18631').get_weights() 
w[0] = np.array([[[[0.5361]]]])
w[1] = np.array([[[[0.0412, 0.8887, 0.3511, 0.0243]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep18631').set_weights(w) 
w = model.get_layer('Sim86774').get_weights() 
w[0] = np.array([[1], [7], [3], [7]])
w[1] = np.array([[5]])
w[2] = np.array([1])
model.get_layer('Sim86774').set_weights(w) 
in0Per829 = tf.constant([[[1.0666, 1.4316]]])
print (np.array2string(model.predict([in0Per829],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim86774.png')

LPer829 = permute_layer([[[1.0666, 1.4316]]], 2,1, Per829), 
LELU98566 = elu_layer(Per829, 6.443836861173658, ELU98566), 
LRes98342 = reshape_layer(ELU98566, [2, 1, 1], Res98342), 
LMax43798 = max_pool2D_layer(Res98342, 2, 1, Max43798), 
LSep18631 = separable_conv2D_layer(Max43798, 1, 1,[[[[[0.5361]]]],[[[[0.0412, 0.8887, 0.3511, 0.0243]]]]],[0, 0, 0, 0], 1, 1, false, Sep18631), 
LRes16580 = reshape_layer(Sep18631, [1, 4], Res16580), 
LSim86774 = simple_rnn_layer(Res16580,[[1], [7], [3], [7]],[[5]],[1], Sim86774), 
exec_layers([LPer829,LELU98566,LRes98342,LMax43798,LSep18631,LRes16580,LSim86774],["Per829","ELU98566","Res98342","Max43798","Sep18631","Res16580","Sim86774"],Sim86774,"Sim86774")

Actual (Unparsed): [[0.9999972]]

Expected (Unparsed): [[0.9999972304027964]]

Actual:   [[1]]

Expected: [[1]]