import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas98560 = tf.keras.layers.Input(shape=([3, 3, 4]))

Mas98560 = keras.layers.Masking(mask_value=1, name = 'Mas98560', )(in0Mas98560)
Res58906 = keras.layers.Reshape((3, 12), name = 'Res58906', )(Mas98560)
Sim1307 = keras.layers.SimpleRNN(3,name = 'Sim1307', )(Res58906)
model = tf.keras.models.Model(inputs=[in0Mas98560], outputs=Sim1307)
w = model.get_layer('Sim1307').get_weights() 
w[0] = np.array([[9, 6, 7], [3, 4, 7], [3, 6, 7], [5, 10, 4], [6, 5, 10], [2, 9, 7], [2, 2, 8], [8, 9, 7], [9, 5, 7], [3, 3, 7], [10, 7, 4], [2, 2, 10]])
w[1] = np.array([[10, 8, 3], [9, 8, 1], [7, 8, 4]])
w[2] = np.array([10, 7, 8])
model.get_layer('Sim1307').set_weights(w) 
in0Mas98560 = tf.constant([[[[1.0385, 1.0061, 1.5874, 1.9189], [1.765, 1.9973, 1.3575, 1.4453], [1.5077, 1.9144, 1.4804, 1.9395]], [[1.4463, 1.3449, 1.2903, 1.2331], [1.2537, 1.0319, 1.5307, 1.9118], [1.9545, 1.8088, 1.707, 1.9296]], [[1.8057, 1.3511, 1.5714, 1.5885], [1.6279, 1.4364, 1.3692, 1.2053], [1.5532, 1.61, 1.4108, 1.0065]]]])
print (np.array2string(model.predict([in0Mas98560],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim1307.png')

LMas98560 = masking_layer([[[[1.0385, 1.0061, 1.5874, 1.9189], [1.765, 1.9973, 1.3575, 1.4453], [1.5077, 1.9144, 1.4804, 1.9395]], [[1.4463, 1.3449, 1.2903, 1.2331], [1.2537, 1.0319, 1.5307, 1.9118], [1.9545, 1.8088, 1.707, 1.9296]], [[1.8057, 1.3511, 1.5714, 1.5885], [1.6279, 1.4364, 1.3692, 1.2053], [1.5532, 1.61, 1.4108, 1.0065]]]], 1, Mas98560), 
LRes58906 = reshape_layer(Mas98560, [3, 12], Res58906), 
LSim1307 = simple_rnn_layer(Res58906,[[9, 6, 7], [3, 4, 7], [3, 6, 7], [5, 10, 4], [6, 5, 10], [2, 9, 7], [2, 2, 8], [8, 9, 7], [9, 5, 7], [3, 3, 7], [10, 7, 4], [2, 2, 10]],[[10, 8, 3], [9, 8, 1], [7, 8, 4]],[10, 7, 8], Sim1307), 
exec_layers([LMas98560,LRes58906,LSim1307],["Mas98560","Res58906","Sim1307"],Sim1307,"Sim1307")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0,1.0]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]