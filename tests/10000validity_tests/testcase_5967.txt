import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den77692 = tf.keras.layers.Input(shape=([2, 2]))
in0Ave70948 = tf.keras.layers.Input(shape=([1, 1]))
in0Con41639 = tf.keras.layers.Input(shape=([1]))
in0Glo37799 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con54656 = tf.keras.layers.Input(shape=([3]))

Den77692 = keras.layers.Dense(2,name = 'Den77692', )(in0Den77692)
Res6246 = keras.layers.Reshape((2, 2, 1), name = 'Res6246', )(Den77692)
Dep55442 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep55442', )(Res6246)
Res61148 = keras.layers.Reshape((2, 2), name = 'Res61148', )(Dep55442)
Fla468 = keras.layers.Flatten(name = 'Fla468', )(Res61148)
Ave70948 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave70948', )(in0Ave70948)
Fla12440 = keras.layers.Flatten(name = 'Fla12440', )(Ave70948)
Con41639 = keras.layers.Concatenate(axis=1, name = 'Con41639', )([Fla12440,in0Con41639])
Glo37799 = keras.layers.GlobalAveragePooling2D(name = 'Glo37799', )(in0Glo37799)
Dot2186 = keras.layers.Dot(axes=(1, 1), name = 'Dot2186', )([Con41639,Glo37799])
Con54656 = keras.layers.Concatenate(axis=1, name = 'Con54656', )([Dot2186,in0Con54656])
Sub41139 = keras.layers.Subtract(name = 'Sub41139', )([Fla468,Con54656])
model = tf.keras.models.Model(inputs=[in0Den77692,in0Ave70948,in0Con41639,in0Glo37799,in0Con54656], outputs=Sub41139)
w = model.get_layer('Den77692').get_weights() 
w[0] = np.array([[0.4807, 0.0954], [0.816, 0.1333]])
w[1] = np.array([0.5362, 0.6336])
model.get_layer('Den77692').set_weights(w) 
w = model.get_layer('Dep55442').get_weights() 
w[0] = np.array([[[[0.0219]]]])
w[1] = np.array([0])
model.get_layer('Dep55442').set_weights(w) 
in0Den77692 = tf.constant([[[0.7559, 0.325], [0.85, 0.784]]])
in0Ave70948 = tf.constant([[[1.5045]]])
in0Con41639 = tf.constant([[0.1838]])
in0Glo37799 = tf.constant([[[[1.0907, 1.6573], [1.1492, 1.9888]]]])
in0Con54656 = tf.constant([[0.1938, 0.7546, 0.6439]])
print (np.array2string(model.predict([in0Den77692,in0Ave70948,in0Con41639,in0Glo37799,in0Con54656],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub41139.png')

LDen77692 = dense_layer([[[0.7559, 0.325], [0.85, 0.784]]], [[0.4807, 0.0954], [0.816, 0.1333]],[0.5362, 0.6336], Den77692), 
LRes6246 = reshape_layer(Den77692, [2, 2, 1], Res6246), 
LDep55442 = depthwise_conv2D_layer(Res6246, 1, 1,[[[[0.0219]]]],[0], 1, 1, true, Dep55442), 
LRes61148 = reshape_layer(Dep55442, [2, 2], Res61148), 
LFla468 = flatten_layer(Res61148, Fla468), 
LAve70948 = average_pooling1D_layer([[[1.5045]]], 1, Ave70948), 
LFla12440 = flatten_layer(Ave70948, Fla12440), 
LCon41639 = concatenate_layer([Fla12440,[[0.1838]]], 1, Con41639), 
LGlo37799 = global_average_pooling2D_layer([[[[1.0907, 1.6573], [1.1492, 1.9888]]]], Glo37799), 
LDot2186 = dot_layer(Con41639,Glo37799, 1, 1, Dot2186), 
LCon54656 = concatenate_layer([Dot2186,[[0.1938, 0.7546, 0.6439]]], 1, Con54656), 
LSub41139 = subtract_layer(Fla468,Con54656, Sub41139), 
exec_layers([LDen77692,LRes6246,LDep55442,LRes61148,LFla468,LAve70948,LFla12440,LCon41639,LGlo37799,LDot2186,LCon54656,LSub41139],["Den77692","Res6246","Dep55442","Res61148","Fla468","Ave70948","Fla12440","Con41639","Glo37799","Dot2186","Con54656","Sub41139"],Sub41139,"Sub41139")

Actual (Unparsed): [[-1.9945331, -0.1773961, -0.7198986, -0.6259596]]

Expected (Unparsed): [[-1.994533096253,-0.177396125616,-0.7198985959,-0.6259595813200001]]

Actual:   [[-1.9945, -0.1773, -0.7198, -0.6259]]

Expected: [[-1.9945, -0.1773, -0.7198, -0.6259]]