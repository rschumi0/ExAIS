import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con88678 = tf.keras.layers.Input(shape=([1, 2, 2]))

Con88678 = keras.layers.Conv2DTranspose(2, (1, 1),strides=(1, 1), padding='valid', name = 'Con88678', )(in0Con88678)
Res37136 = keras.layers.Reshape((1, 4), name = 'Res37136', )(Con88678)
Sep88528 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep88528', )(Res37136)
Res99096 = keras.layers.Reshape((1, 2, 1), name = 'Res99096', )(Sep88528)
Max9899 = keras.layers.MaxPool2D(pool_size=(1, 2), strides=(1, 1), padding='valid', name = 'Max9899', )(Res99096)
model = tf.keras.models.Model(inputs=[in0Con88678], outputs=Max9899)
w = model.get_layer('Con88678').get_weights() 
w[0] = np.array([[[[0.3462, 0.7051], [0.8911, 0.0197]]]])
w[1] = np.array([0, 0])
model.get_layer('Con88678').set_weights(w) 
w = model.get_layer('Sep88528').get_weights() 
w[0] = np.array([[[0.0863], [0.7769], [0.4745], [0.5897]]])
w[1] = np.array([[[0.5426, 0.37], [0.5462, 0.8737], [0.7756, 0.8124], [0.1387, 0.7657]]])
w[2] = np.array([0, 0])
model.get_layer('Sep88528').set_weights(w) 
in0Con88678 = tf.constant([[[[0.342, 0.3961], [0.261, 0.8048]]]])
print (np.array2string(model.predict([in0Con88678],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max9899.png')

LCon88678 = conv2D_transpose_layer([[[[0.342, 0.3961], [0.261, 0.8048]]]], 1, 1,[[[[0.3462, 0.7051], [0.8911, 0.0197]]]],[0, 0], 1, 1, false, Con88678), 
LRes37136 = reshape_layer(Con88678, [1, 4], Res37136), 
LSep88528 = separable_conv1D_layer(Res37136, 1,[[[[0.0863], [0.7769], [0.4745], [0.5897]]],[[[0.5426, 0.37], [0.5462, 0.8737], [0.7756, 0.8124], [0.1387, 0.7657]]]],[0, 0], 1, true, Sep88528), 
LRes99096 = reshape_layer(Sep88528, [1, 2, 1], Res99096), 
LMax9899 = max_pool2D_layer(Res99096, 1, 2, 1, 1, false, Max9899), 
exec_layers([LCon88678,LRes37136,LSep88528,LRes99096,LMax9899],["Con88678","Res37136","Sep88528","Res99096","Max9899"],Max9899,"Max9899")

Actual (Unparsed): [[[[0.5906121]]]]

Expected (Unparsed): [[[[0.5906120840143115]]]]

Actual:   [[[[0.5907]]]]

Expected: [[[[0.5907]]]]