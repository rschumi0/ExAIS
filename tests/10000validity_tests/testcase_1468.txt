import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim15609 = tf.keras.layers.Input(shape=([2, 3]))

Sim15609 = keras.layers.SimpleRNN(1,name = 'Sim15609', )(in0Sim15609)
Res48588 = keras.layers.Reshape((1, 1), name = 'Res48588', )(Sim15609)
Res35404 = keras.layers.Reshape((1, 1, 1), name = 'Res35404', )(Res48588)
Sep43505 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='same', name = 'Sep43505', )(Res35404)
Res86080 = keras.layers.Reshape((1, 4), name = 'Res86080', )(Sep43505)
Fla96107 = keras.layers.Flatten(name = 'Fla96107', )(Res86080)
Lea34675 = keras.layers.LeakyReLU(alpha=0.821960820380148, name = 'Lea34675', )(Fla96107)
model = tf.keras.models.Model(inputs=[in0Sim15609], outputs=Lea34675)
w = model.get_layer('Sim15609').get_weights() 
w[0] = np.array([[9], [8], [3]])
w[1] = np.array([[4]])
w[2] = np.array([3])
model.get_layer('Sim15609').set_weights(w) 
w = model.get_layer('Sep43505').get_weights() 
w[0] = np.array([[[[0.0181]]]])
w[1] = np.array([[[[0.9547, 0.4142, 0.7315, 0.4138]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep43505').set_weights(w) 
in0Sim15609 = tf.constant([[[1, 9, 1], [7, 2, 6]]])
print (np.array2string(model.predict([in0Sim15609],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lea34675.png')

LSim15609 = simple_rnn_layer([[[1, 9, 1], [7, 2, 6]]],[[9], [8], [3]],[[4]],[3], Sim15609), 
LRes48588 = reshape_layer(Sim15609, [1, 1], Res48588), 
LRes35404 = reshape_layer(Res48588, [1, 1, 1], Res35404), 
LSep43505 = separable_conv2D_layer(Res35404, 1, 1,[[[[[0.0181]]]],[[[[0.9547, 0.4142, 0.7315, 0.4138]]]]],[0, 0, 0, 0], 1, 1, true, Sep43505), 
LRes86080 = reshape_layer(Sep43505, [1, 4], Res86080), 
LFla96107 = flatten_layer(Res86080, Fla96107), 
LLea34675 = leaky_relu_layer(Fla96107, 0.821960820380148, Lea34675), 
exec_layers([LSim15609,LRes48588,LRes35404,LSep43505,LRes86080,LFla96107,LLea34675],["Sim15609","Res48588","Res35404","Sep43505","Res86080","Fla96107","Lea34675"],Lea34675,"Lea34675")

Actual (Unparsed): [[0.0172801, 0.0074970, 0.0132402, 0.0074898]]

Expected (Unparsed): [[0.01728007,0.007497020000000001,0.013240150000000003,0.007489780000000001]]

Actual:   [[0.0173, 0.0075, 0.0133, 0.0075]]

Expected: [[0.0173, 0.0075, 0.0133, 0.0075]]