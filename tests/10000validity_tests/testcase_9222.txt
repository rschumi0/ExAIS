import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con67426 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con29414 = tf.keras.layers.Input(shape=([1, 4, 2]))
in0Con10880 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con7836 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con87850 = tf.keras.layers.Input(shape=([11]))

Con67426 = keras.layers.Conv2DTranspose(4, (1, 1),strides=(1, 1), padding='valid', name = 'Con67426', )(in0Con67426)
Res15160 = keras.layers.Reshape((1, 4), name = 'Res15160', )(Con67426)
Max49110 = keras.layers.MaxPool1D(pool_size=(1), strides=(1), padding='same', name = 'Max49110', )(Res15160)
Res45119 = keras.layers.Reshape((1, 4, 1), name = 'Res45119', )(Max49110)
Con29414 = keras.layers.Concatenate(axis=3, name = 'Con29414', )([Res45119,in0Con29414])
Con10880 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 1), padding='same', name = 'Con10880', )(in0Con10880)
Zer91071 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer91071', )(Con10880)
Max76897 = keras.layers.Maximum(name = 'Max76897', )([Con29414,Zer91071])
Res39543 = keras.layers.Reshape((1, 12), name = 'Res39543', )(Max76897)
Fla96041 = keras.layers.Flatten(name = 'Fla96041', )(Res39543)
Con7836 = keras.layers.Conv2D(3, (1, 2),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con7836', )(in0Con7836)
Den24812 = keras.layers.Dense(3,name = 'Den24812', )(Con7836)
Res91303 = keras.layers.Reshape((1, 6), name = 'Res91303', )(Den24812)
Sim39721 = keras.layers.SimpleRNN(1,name = 'Sim39721', )(Res91303)
Con87850 = keras.layers.Concatenate(axis=1, name = 'Con87850', )([Sim39721,in0Con87850])
Add42202 = keras.layers.Add(name = 'Add42202', )([Fla96041,Con87850])
model = tf.keras.models.Model(inputs=[in0Con67426,in0Con29414,in0Con10880,in0Con7836,in0Con87850], outputs=Add42202)
w = model.get_layer('Con67426').get_weights() 
w[0] = np.array([[[[0.0439], [0.5152], [0.0119], [0.0787]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con67426').set_weights(w) 
w = model.get_layer('Con10880').get_weights() 
w[0] = np.array([[[[0.904], [0.2075], [0.5345]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con10880').set_weights(w) 
w = model.get_layer('Con7836').get_weights() 
w[0] = np.array([[[[0.0462, 0.8998, 0.8628], [0.5402, 0.4442, 0.7849]], [[0.5501, 0.2228, 0.4702], [0.757, 0.6364, 0.5146]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con7836').set_weights(w) 
w = model.get_layer('Den24812').get_weights() 
w[0] = np.array([[0.7585, 0.6213, 0.9422], [0.2386, 0.3228, 0.965], [0.4687, 0.1462, 0.8769]])
w[1] = np.array([0.7891, 0.7489, 0.9841])
model.get_layer('Den24812').set_weights(w) 
w = model.get_layer('Sim39721').get_weights() 
w[0] = np.array([[10], [9], [5], [9], [2], [7]])
w[1] = np.array([[5]])
w[2] = np.array([4])
model.get_layer('Sim39721').set_weights(w) 
in0Con67426 = tf.constant([[[[0.3793]]]])
in0Con29414 = tf.constant([[[[0.8804, 0.9895], [0.7033, 0.0323], [0.3663, 0.5474], [0.8938, 0.142]]]])
in0Con10880 = tf.constant([[[[0.1214], [0.1738]]]])
in0Con7836 = tf.constant([[[[0.5554, 0.763], [0.888, 0.105]]]])
in0Con87850 = tf.constant([[0.2499, 0.3361, 0.7866, 0.7484, 0.7436, 0.7447, 0.0489, 0.8903, 0.676, 0.3746, 0.8394]])
print (np.array2string(model.predict([in0Con67426,in0Con29414,in0Con10880,in0Con7836,in0Con87850],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add42202.png')

LCon67426 = conv2D_transpose_layer([[[[0.3793]]]], 1, 1,[[[[0.0439], [0.5152], [0.0119], [0.0787]]]],[0, 0, 0, 0], 1, 1, false, Con67426), 
LRes15160 = reshape_layer(Con67426, [1, 4], Res15160), 
LMax49110 = max_pool1D_layer(Res15160, 1, 1, true, Max49110), 
LRes45119 = reshape_layer(Max49110, [1, 4, 1], Res45119), 
LCon29414 = concatenate_layer([Res45119,[[[[0.8804, 0.9895], [0.7033, 0.0323], [0.3663, 0.5474], [0.8938, 0.142]]]]], 3, Con29414), 
LCon10880 = conv2D_transpose_layer([[[[0.1214], [0.1738]]]], 1, 1,[[[[0.904], [0.2075], [0.5345]]]],[0, 0, 0], 1, 1, true, Con10880), 
LZer91071 = zero_padding2D_layer(Con10880, 0, 0, 2, 0, Zer91071), 
LMax76897 = maximum_layer([Con29414,Zer91071], Max76897), 
LRes39543 = reshape_layer(Max76897, [1, 12], Res39543), 
LFla96041 = flatten_layer(Res39543, Fla96041), 
LCon7836 = conv2D_layer([[[[0.5554, 0.763], [0.888, 0.105]]]], 1, 2,[[[[0.0462, 0.8998, 0.8628], [0.5402, 0.4442, 0.7849]], [[0.5501, 0.2228, 0.4702], [0.757, 0.6364, 0.5146]]]],[0, 0, 0], 1, 1, true, 1, 1, Con7836), 
LDen24812 = dense_layer(Con7836, [[0.7585, 0.6213, 0.9422], [0.2386, 0.3228, 0.965], [0.4687, 0.1462, 0.8769]],[0.7891, 0.7489, 0.9841], Den24812), 
LRes91303 = reshape_layer(Den24812, [1, 6], Res91303), 
LSim39721 = simple_rnn_layer(Res91303,[[10], [9], [5], [9], [2], [7]],[[5]],[4], Sim39721), 
LCon87850 = concatenate_layer([Sim39721,[[0.2499, 0.3361, 0.7866, 0.7484, 0.7436, 0.7447, 0.0489, 0.8903, 0.676, 0.3746, 0.8394]]], 1, Con87850), 
LAdd42202 = add_layer([Fla96041,Con87850], Add42202), 
exec_layers([LCon67426,LRes15160,LMax49110,LRes45119,LCon29414,LCon10880,LZer91071,LMax76897,LRes39543,LFla96041,LCon7836,LDen24812,LRes91303,LSim39721,LCon87850,LAdd42202],["Con67426","Res15160","Max49110","Res45119","Con29414","Con10880","Zer91071","Max76897","Res39543","Fla96041","Con7836","Den24812","Res91303","Sim39721","Con87850","Add42202"],Add42202,"Add42202")

Actual (Unparsed): [[1.0166513, 1.1303000, 1.3256000, 0.9820154, 1.4517000, 0.7759000, 0.8544456, 0.4152000, 1.4377000, 0.8331152, 1.2684000, 0.9814000]]

Expected (Unparsed): [[1.01665127,1.1303,1.3256000000000001,0.98201536,1.4517,0.7759,0.8544456,0.4152,1.4377,0.8331152000000001,1.2684,0.9814]]

Actual:   [[1.0167, 1.1303, 1.3256, 0.9821, 1.4517, 0.7759, 0.8545, 0.4152, 1.4377, 0.8332, 1.2684, 0.9814]]

Expected: [[1.0167, 1.1303, 1.3257, 0.9821, 1.4517, 0.7759, 0.8545, 0.4152, 1.4377, 0.8332, 1.2684, 0.9814]]