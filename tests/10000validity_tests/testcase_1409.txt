import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min40950 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min40950 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Lay44831 = tf.keras.layers.Input(shape=([1]))
in0PRe10395 = tf.keras.layers.Input(shape=([1, 2, 1]))

Min40950 = keras.layers.Minimum(name = 'Min40950', )([in0Min40950,in1Min40950])
Zer48059 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer48059', )(Min40950)
Lay44831 = keras.layers.LayerNormalization(axis=1, epsilon=2.9901287594996013, name = 'Lay44831', )(in0Lay44831)
Res99170 = keras.layers.Reshape((1, 1), name = 'Res99170', )(Lay44831)
Res98336 = keras.layers.Reshape((1, 1, 1), name = 'Res98336', )(Res99170)
Zer94018 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer94018', )(Res98336)
PRe10395 = keras.layers.PReLU(name = 'PRe10395', input_shape=(1, 2, 1))(in0PRe10395)
Sub74660 = keras.layers.Subtract(name = 'Sub74660', )([Zer94018,PRe10395])
Mul30640 = keras.layers.Multiply(name = 'Mul30640', )([Zer48059,Sub74660])
Res8 = keras.layers.Reshape((1, 2), name = 'Res8', )(Mul30640)
Con82947 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con82947', )(Res8)
model = tf.keras.models.Model(inputs=[in0Min40950,in1Min40950,in0Lay44831,in0PRe10395], outputs=Con82947)
w = model.get_layer('PRe10395').get_weights() 
w[0] = np.array([[[0.9847], [0.7414]]])
model.get_layer('PRe10395').set_weights(w) 
w = model.get_layer('Con82947').get_weights() 
w[0] = np.array([[[0.7307, 0.7546, 0.5366, 0.845], [0.3731, 0.9487, 0.4817, 0.7024]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con82947').set_weights(w) 
in0Min40950 = tf.constant([[[[0.0963]]]])
in1Min40950 = tf.constant([[[[0.0958]]]])
in0Lay44831 = tf.constant([[1.2861]])
in0PRe10395 = tf.constant([[[[0.849], [0.3165]]]])
print (np.array2string(model.predict([in0Min40950,in1Min40950,in0Lay44831,in0PRe10395],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con82947.png')

LMin40950 = minimum_layer([[[[[0.0963]]]], [[[[0.0958]]]]], Min40950), 
LZer48059 = zero_padding2D_layer(Min40950, 0, 0, 1, 0, Zer48059), 
LLay44831 = layer_normalization_layer([[1.2861]], 1, 2.9901287594996013, Lay44831), 
LRes99170 = reshape_layer(Lay44831, [1, 1], Res99170), 
LRes98336 = reshape_layer(Res99170, [1, 1, 1], Res98336), 
LZer94018 = zero_padding2D_layer(Res98336, 0, 0, 1, 0, Zer94018), 
LPRe10395 = prelu_layer([[[[0.849], [0.3165]]]], [[[0.9847], [0.7414]]], PRe10395), 
LSub74660 = subtract_layer(Zer94018,PRe10395, Sub74660), 
LMul30640 = multiply_layer([Zer48059,Sub74660], Mul30640), 
LRes8 = reshape_layer(Mul30640, [1, 2], Res8), 
LCon82947 = conv1D_layer(Res8, 1,[[[0.7307, 0.7546, 0.5366, 0.845], [0.3731, 0.9487, 0.4817, 0.7024]]],[0, 0, 0, 0], 1, true, 1, Con82947), 
exec_layers([LMin40950,LZer48059,LLay44831,LRes99170,LRes98336,LZer94018,LPRe10395,LSub74660,LMul30640,LRes8,LCon82947],["Min40950","Zer48059","Lay44831","Res99170","Res98336","Zer94018","PRe10395","Sub74660","Mul30640","Res8","Con82947"],Con82947,"Con82947")

Actual (Unparsed): [[[-0.0113127, -0.0287652, -0.0146055, -0.0212973]]]

Expected (Unparsed): [[[-0.011312653169999999,-0.028765248089999997,-0.01460548119,-0.02129725968]]]

Actual:   [[[-0.0113, -0.0287, -0.0146, -0.0212]]]

Expected: [[[-0.0113, -0.0287, -0.0146, -0.0212]]]