import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max12442 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max12442 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Max12442 = keras.layers.Maximum(name = 'Max12442', )([in0Max12442,in1Max12442])
Res77470 = keras.layers.Reshape((2, 2, 2), name = 'Res77470', )(Max12442)
Res58059 = keras.layers.Reshape((2, 4), name = 'Res58059', )(Res77470)
Con29190 = keras.layers.Conv1D(2, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con29190', )(Res58059)
model = tf.keras.models.Model(inputs=[in0Max12442,in1Max12442], outputs=Con29190)
w = model.get_layer('Con29190').get_weights() 
w[0] = np.array([[[0.7843, 0.2814], [0.2395, 0.4297], [0.0295, 0.1094], [0.7593, 0.424]]])
w[1] = np.array([0, 0])
model.get_layer('Con29190').set_weights(w) 
in0Max12442 = tf.constant([[[[[0.8891, 0.8084]], [[0.916, 0.1338]]], [[[0.3956, 0.9795]], [[0.4007, 0.3683]]]]])
in1Max12442 = tf.constant([[[[[0.1463, 0.4339]], [[0.3112, 0.144]]], [[[0.7637, 0.026]], [[0.9943, 0.8356]]]]])
print (np.array2string(model.predict([in0Max12442,in1Max12442],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con29190.png')

LMax12442 = maximum_layer([[[[[[0.8891, 0.8084]], [[0.916, 0.1338]]], [[[0.3956, 0.9795]], [[0.4007, 0.3683]]]]], [[[[[0.1463, 0.4339]], [[0.3112, 0.144]]], [[[0.7637, 0.026]], [[0.9943, 0.8356]]]]]], Max12442), 
LRes77470 = reshape_layer(Max12442, [2, 2, 2], Res77470), 
LRes58059 = reshape_layer(Res77470, [2, 4], Res58059), 
LCon29190 = conv1D_layer(Res58059, 1,[[[0.7843, 0.2814], [0.2395, 0.4297], [0.0295, 0.1094], [0.7593, 0.424]]],[0, 0], 1, false, 1, Con29190), 
exec_layers([LMax12442,LRes77470,LRes58059,LCon29190],["Max12442","Res77470","Res58059","Con29190"],Con29190,"Con29190")

Actual (Unparsed): [[[1.0272941, 0.7588286], [1.4973631, 1.0988672]]]

Expected (Unparsed): [[[1.02729413,0.75882862],[1.49736309,1.09886715]]]

Actual:   [[[1.0273, 0.7589], [1.4974, 1.0989]]]

Expected: [[[1.0273, 0.7589], [1.4974, 1.0989]]]