import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min63679 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Min63679 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Min63679 = keras.layers.Minimum(name = 'Min63679', )([in0Min63679,in1Min63679])
Lea31983 = keras.layers.LeakyReLU(alpha=0.8332202826420411, name = 'Lea31983', )(Min63679)
Res51593 = keras.layers.Reshape((1, 2, 1), name = 'Res51593', )(Lea31983)
Res25468 = keras.layers.Reshape((1, 2), name = 'Res25468', )(Res51593)
Ave71847 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave71847', )(Res25468)
GRU38154 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU38154', )(Ave71847)
model = tf.keras.models.Model(inputs=[in0Min63679,in1Min63679], outputs=GRU38154)
w = model.get_layer('GRU38154').get_weights() 
w[0] = np.array([[3, 2, 3, 5, 6, 3, 7, 10, 5], [7, 6, 5, 9, 2, 8, 4, 7, 1]])
w[1] = np.array([[1, 1, 8, 8, 10, 8, 5, 1, 3], [6, 10, 9, 2, 1, 5, 6, 4, 8], [8, 8, 7, 7, 10, 9, 5, 9, 6]])
w[2] = np.array([2, 2, 3, 7, 9, 1, 10, 2, 3])
model.get_layer('GRU38154').set_weights(w) 
in0Min63679 = tf.constant([[[[[0.2915]], [[0.6086]]]]])
in1Min63679 = tf.constant([[[[[0.5225]], [[0.061]]]]])
print (np.array2string(model.predict([in0Min63679,in1Min63679],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU38154.png')

LMin63679 = minimum_layer([[[[[[0.2915]], [[0.6086]]]]], [[[[[0.5225]], [[0.061]]]]]], Min63679), 
LLea31983 = leaky_relu_layer(Min63679, 0.8332202826420411, Lea31983), 
LRes51593 = reshape_layer(Lea31983, [1, 2, 1], Res51593), 
LRes25468 = reshape_layer(Res51593, [1, 2], Res25468), 
LAve71847 = average_pooling1D_layer(Res25468, 1, Ave71847), 
LGRU38154 = gru_layer(Ave71847,[[3, 2, 3, 5, 6, 3, 7, 10, 5], [7, 6, 5, 9, 2, 8, 4, 7, 1]],[[1, 1, 8, 8, 10, 8, 5, 1, 3], [6, 10, 9, 2, 1, 5, 6, 4, 8], [8, 8, 7, 7, 10, 9, 5, 9, 6]],[2, 2, 3, 7, 9, 1, 10, 2, 3], false, GRU38154), 
exec_layers([LMin63679,LLea31983,LRes51593,LRes25468,LAve71847,LGRU38154],["Min63679","Lea31983","Res51593","Res25468","Ave71847","GRU38154"],GRU38154,"GRU38154")

Actual (Unparsed): [[0.0355198, 0.0497815, 0.0150718]]

Expected (Unparsed): [[0.035519766284585044,0.04978151473818677,0.01507182675965576]]

Actual:   [[0.0356, 0.0498, 0.0151]]

Expected: [[0.0356, 0.0498, 0.0151]]