import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave43446 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave43446 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Min1341 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Min1341 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con53783 = tf.keras.layers.Input(shape=([2, 3]))
in0Min54639 = tf.keras.layers.Input(shape=([2, 1]))
in1Min54639 = tf.keras.layers.Input(shape=([2, 1]))

Ave43446 = keras.layers.Average(name = 'Ave43446', )([in0Ave43446,in1Ave43446])
Zer17075 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer17075', )(Ave43446)
Min1341 = keras.layers.Minimum(name = 'Min1341', )([in0Min1341,in1Min1341])
Ave31753 = keras.layers.Average(name = 'Ave31753', )([Zer17075,Min1341])
Res9223 = keras.layers.Reshape((2, 2, 2), name = 'Res9223', )(Ave31753)
Res43371 = keras.layers.Reshape((2, 4), name = 'Res43371', )(Res9223)
Con53783 = keras.layers.Concatenate(axis=2, name = 'Con53783', )([Res43371,in0Con53783])
Min54639 = keras.layers.Minimum(name = 'Min54639', )([in0Min54639,in1Min54639])
Dot85871 = keras.layers.Dot(axes=(1, 1), name = 'Dot85871', )([Con53783,Min54639])
model = tf.keras.models.Model(inputs=[in0Ave43446,in1Ave43446,in0Min1341,in1Min1341,in0Con53783,in0Min54639,in1Min54639], outputs=Dot85871)
in0Ave43446 = tf.constant([[[[[0.361]], [[0.4268]]]]])
in1Ave43446 = tf.constant([[[[[0.8821]], [[0.4496]]]]])
in0Min1341 = tf.constant([[[[[0.5542], [0.1541]], [[0.2261], [0.3938]]], [[[0.7288], [0.9996]], [[0.291], [0.2626]]]]])
in1Min1341 = tf.constant([[[[[0.6653], [0.8389]], [[0.8417], [0.8316]]], [[[0.2545], [0.4933]], [[0.051], [0.0509]]]]])
in0Con53783 = tf.constant([[[0.8673, 0.7305, 0.5314], [0.386, 0.3741, 0.3851]]])
in0Min54639 = tf.constant([[[0.1859], [0.9029]]])
in1Min54639 = tf.constant([[[0.9413], [0.5786]]])
print (np.array2string(model.predict([in0Ave43446,in1Ave43446,in0Min1341,in1Min1341,in0Con53783,in0Min54639,in1Min54639],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot85871.png')

LAve43446 = average_layer([[[[[[0.361]], [[0.4268]]]]], [[[[[0.8821]], [[0.4496]]]]]], Ave43446), 
LZer17075 = zero_padding3D_layer(Ave43446, 1, 0, 0, 0, 1, 0, Zer17075), 
LMin1341 = minimum_layer([[[[[[0.5542], [0.1541]], [[0.2261], [0.3938]]], [[[0.7288], [0.9996]], [[0.291], [0.2626]]]]], [[[[[0.6653], [0.8389]], [[0.8417], [0.8316]]], [[[0.2545], [0.4933]], [[0.051], [0.0509]]]]]], Min1341), 
LAve31753 = average_layer([Zer17075,Min1341], Ave31753), 
LRes9223 = reshape_layer(Ave31753, [2, 2, 2], Res9223), 
LRes43371 = reshape_layer(Res9223, [2, 4], Res43371), 
LCon53783 = concatenate_layer([Res43371,[[[0.8673, 0.7305, 0.5314], [0.386, 0.3741, 0.3851]]]], 2, Con53783), 
LMin54639 = minimum_layer([[[[0.1859], [0.9029]]], [[[0.9413], [0.5786]]]], Min54639), 
LDot85871 = dot_layer(Con53783,Min54639, 1, 1, Dot85871), 
exec_layers([LAve43446,LZer17075,LMin1341,LAve31753,LRes9223,LRes43371,LCon53783,LMin54639,LDot85871],["Ave43446","Zer17075","Min1341","Ave31753","Res9223","Res43371","Con53783","Min54639","Dot85871"],Dot85871,"Dot85871")

Actual (Unparsed): [[[0.1251397], [0.3368497], [0.0357703], [0.1781003], [0.3845707], [0.3522542], [0.3216061]]]

Expected (Unparsed): [[[0.12513974],[0.3368497000000001],[0.035770295],[0.17810034000000002],[0.38457067],[0.35225421],[0.32160612]]]

Actual:   [[[0.1252], [0.3369], [0.0358], [0.1782], [0.3846], [0.3523], [0.3217]]]

Expected: [[[0.1252], [0.3369], [0.0358], [0.1782], [0.3846], [0.3523], [0.3217]]]