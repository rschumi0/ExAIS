import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min7920 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min7920 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Con45335 = tf.keras.layers.Input(shape=([2, 1]))
in0Per10699 = tf.keras.layers.Input(shape=([2, 1]))
in0Max31575 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max31575 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con45714 = tf.keras.layers.Input(shape=([2, 1]))

Min7920 = keras.layers.Minimum(name = 'Min7920', )([in0Min7920,in1Min7920])
Res14854 = keras.layers.Reshape((1, 2, 2), name = 'Res14854', )(Min7920)
Glo59992 = keras.layers.GlobalAveragePooling2D(name = 'Glo59992', )(Res14854)
Res19955 = keras.layers.Reshape((2, 1), name = 'Res19955', )(Glo59992)
Con45335 = keras.layers.Concatenate(axis=2, name = 'Con45335', )([Res19955,in0Con45335])
Per10699 = keras.layers.Permute((2,1), name = 'Per10699',)(in0Per10699)
Zer82549 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer82549', )(Per10699)
Max31575 = keras.layers.Maximum(name = 'Max31575', )([in0Max31575,in1Max31575])
Res25268 = keras.layers.Reshape((1, 1), name = 'Res25268', )(Max31575)
Up_58176 = keras.layers.UpSampling1D(size=(2), name = 'Up_58176', )(Res25268)
Con45714 = keras.layers.Concatenate(axis=2, name = 'Con45714', )([Up_58176,in0Con45714])
Ave90378 = keras.layers.Average(name = 'Ave90378', )([Zer82549,Con45714])
Dot61315 = keras.layers.Dot(axes=(2, 2), name = 'Dot61315', )([Con45335,Ave90378])
model = tf.keras.models.Model(inputs=[in0Min7920,in1Min7920,in0Con45335,in0Per10699,in0Max31575,in1Max31575,in0Con45714], outputs=Dot61315)
in0Min7920 = tf.constant([[[[[0.4773, 0.6974]], [[0.4916, 0.6811]]]]])
in1Min7920 = tf.constant([[[[[0.6234, 0.3413]], [[0.3564, 0.0955]]]]])
in0Con45335 = tf.constant([[[0.0888], [0.6334]]])
in0Per10699 = tf.constant([[[1.2079], [1.7072]]])
in0Max31575 = tf.constant([[[[0.2405]]]])
in1Max31575 = tf.constant([[[[0.1613]]]])
in0Con45714 = tf.constant([[[0.0121], [0.7158]]])
print (np.array2string(model.predict([in0Min7920,in1Min7920,in0Con45335,in0Per10699,in0Max31575,in1Max31575,in0Con45714],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot61315.png')

LMin7920 = minimum_layer([[[[[[0.4773, 0.6974]], [[0.4916, 0.6811]]]]], [[[[[0.6234, 0.3413]], [[0.3564, 0.0955]]]]]], Min7920), 
LRes14854 = reshape_layer(Min7920, [1, 2, 2], Res14854), 
LGlo59992 = global_average_pooling2D_layer(Res14854, Glo59992), 
LRes19955 = reshape_layer(Glo59992, [2, 1], Res19955), 
LCon45335 = concatenate_layer([Res19955,[[[0.0888], [0.6334]]]], 2, Con45335), 
LPer10699 = permute_layer([[[1.2079], [1.7072]]], 2,1, Per10699), 
LZer82549 = zero_padding1D_layer(Per10699, 1, 0, Zer82549), 
LMax31575 = maximum_layer([[[[[0.2405]]]], [[[[0.1613]]]]], Max31575), 
LRes25268 = reshape_layer(Max31575, [1, 1], Res25268), 
LUp_58176 = up_sampling1D_layer(Res25268, 2, Up_58176), 
LCon45714 = concatenate_layer([Up_58176,[[[0.0121], [0.7158]]]], 2, Con45714), 
LAve90378 = average_layer([Zer82549,Con45714], Ave90378), 
LDot61315 = dot_layer(Con45335,Ave90378, 2, 2, Dot61315), 
exec_layers([LMin7920,LRes14854,LGlo59992,LRes19955,LCon45335,LPer10699,LZer82549,LMax31575,LRes25268,LUp_58176,LCon45714,LAve90378,LDot61315],["Min7920","Res14854","Glo59992","Res19955","Con45335","Per10699","Zer82549","Max31575","Res25268","Up_58176","Con45714","Ave90378","Dot61315"],Dot61315,"Dot61315")

Actual (Unparsed): [[[0.0506635, 0.4094640], [0.0300947, 0.9255294]]]

Expected (Unparsed): [[[0.0506634525,0.40946396999999995],[0.030094669999999997,0.92552938]]]

Actual:   [[[0.0507, 0.4095], [0.0301, 0.9256]]]

Expected: [[[0.0507, 0.4095], [0.0301, 0.9256]]]