import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max13788 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max13788 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Mul53621 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul53621 = tf.keras.layers.Input(shape=([1, 1]))
in0Con71121 = tf.keras.layers.Input(shape=([2, 1]))
in0Max70038 = tf.keras.layers.Input(shape=([2, 2]))
in1Max70038 = tf.keras.layers.Input(shape=([2, 2]))
in0Con33310 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave86685 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave86685 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul29904 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Mul29904 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Sub2246 = tf.keras.layers.Input(shape=([3]))
in1Sub2246 = tf.keras.layers.Input(shape=([3]))
in0Con86937 = tf.keras.layers.Input(shape=([1]))

Max13788 = keras.layers.Maximum(name = 'Max13788', )([in0Max13788,in1Max13788])
Res87536 = keras.layers.Reshape((2, 2), name = 'Res87536', )(Max13788)
Mul53621 = keras.layers.Multiply(name = 'Mul53621', )([in0Mul53621,in1Mul53621])
Zer11289 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer11289', )(Mul53621)
Con71121 = keras.layers.Concatenate(axis=2, name = 'Con71121', )([Zer11289,in0Con71121])
Mul55217 = keras.layers.Multiply(name = 'Mul55217', )([Res87536,Con71121])
Max70038 = keras.layers.Maximum(name = 'Max70038', )([in0Max70038,in1Max70038])
Res56614 = keras.layers.Reshape((2, 2, 1), name = 'Res56614', )(Max70038)
Res74911 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res74911', )(Res56614)
Glo6611 = keras.layers.GlobalMaxPool3D(name = 'Glo6611', )(Res74911)
Res19973 = keras.layers.Reshape((1, 1), name = 'Res19973', )(Glo6611)
Con33310 = keras.layers.Concatenate(axis=2, name = 'Con33310', )([Res19973,in0Con33310])
Ave86685 = keras.layers.Average(name = 'Ave86685', )([in0Ave86685,in1Ave86685])
Mul53681 = keras.layers.Multiply(name = 'Mul53681', )([Con33310,Ave86685])
Zer51385 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer51385', )(Mul53681)
Dot44866 = keras.layers.Dot(axes=(2, 2), name = 'Dot44866', )([Mul55217,Zer51385])
Fla32838 = keras.layers.Flatten(name = 'Fla32838', )(Dot44866)
Mul29904 = keras.layers.Multiply(name = 'Mul29904', )([in0Mul29904,in1Mul29904])
Res24655 = keras.layers.Reshape((1, 2, 2), name = 'Res24655', )(Mul29904)
Res96237 = keras.layers.Reshape((1, 4), name = 'Res96237', )(Res24655)
Fla50750 = keras.layers.Flatten(name = 'Fla50750', )(Res96237)
Sub2246 = keras.layers.Subtract(name = 'Sub2246', )([in0Sub2246,in1Sub2246])
Con86937 = keras.layers.Concatenate(axis=1, name = 'Con86937', )([Sub2246,in0Con86937])
Mul44257 = keras.layers.Multiply(name = 'Mul44257', )([Fla50750,Con86937])
Sof1370 = keras.layers.Softmax(axis=1, name = 'Sof1370', )(Mul44257)
Min67052 = keras.layers.Minimum(name = 'Min67052', )([Fla32838,Sof1370])
model = tf.keras.models.Model(inputs=[in0Max13788,in1Max13788,in0Mul53621,in1Mul53621,in0Con71121,in0Max70038,in1Max70038,in0Con33310,in0Ave86685,in1Ave86685,in0Mul29904,in1Mul29904,in0Sub2246,in1Sub2246,in0Con86937], outputs=Min67052)
in0Max13788 = tf.constant([[[[0.025, 0.1929]], [[0.0641, 0.6154]]]])
in1Max13788 = tf.constant([[[[0.2344, 0.4154]], [[0.7527, 0.2322]]]])
in0Mul53621 = tf.constant([[[0.8651]]])
in1Mul53621 = tf.constant([[[0.7017]]])
in0Con71121 = tf.constant([[[0.2351], [0.8065]]])
in0Max70038 = tf.constant([[[0.7964, 0.918], [0.0497, 0.2007]]])
in1Max70038 = tf.constant([[[0.7758, 0.6996], [0.6813, 0.0382]]])
in0Con33310 = tf.constant([[[0.6761]]])
in0Ave86685 = tf.constant([[[0.8866, 0.7876]]])
in1Ave86685 = tf.constant([[[0.6018, 0.9046]]])
in0Mul29904 = tf.constant([[[[[0.6075], [0.1323]], [[0.5267], [0.742]]]]])
in1Mul29904 = tf.constant([[[[[0.3071], [0.3096]], [[0.3368], [0.624]]]]])
in0Sub2246 = tf.constant([[0.1363, 0.3945, 0.6499]])
in1Sub2246 = tf.constant([[0.4633, 0.1687, 0.4765]])
in0Con86937 = tf.constant([[0.0326]])
print (np.array2string(model.predict([in0Max13788,in1Max13788,in0Mul53621,in1Mul53621,in0Con71121,in0Max70038,in1Max70038,in0Con33310,in0Ave86685,in1Ave86685,in0Mul29904,in1Mul29904,in0Sub2246,in1Sub2246,in0Con86937],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min67052.png')

LMax13788 = maximum_layer([[[[[0.025, 0.1929]], [[0.0641, 0.6154]]]], [[[[0.2344, 0.4154]], [[0.7527, 0.2322]]]]], Max13788), 
LRes87536 = reshape_layer(Max13788, [2, 2], Res87536), 
LMul53621 = multiply_layer([[[[0.8651]]], [[[0.7017]]]], Mul53621), 
LZer11289 = zero_padding1D_layer(Mul53621, 1, 0, Zer11289), 
LCon71121 = concatenate_layer([Zer11289,[[[0.2351], [0.8065]]]], 2, Con71121), 
LMul55217 = multiply_layer([Res87536,Con71121], Mul55217), 
LMax70038 = maximum_layer([[[[0.7964, 0.918], [0.0497, 0.2007]]], [[[0.7758, 0.6996], [0.6813, 0.0382]]]], Max70038), 
LRes56614 = reshape_layer(Max70038, [2, 2, 1], Res56614), 
LRes74911 = reshape_layer(Res56614, [2, 2, 1, 1], Res74911), 
LGlo6611 = global_max_pool3D_layer(Res74911, Glo6611), 
LRes19973 = reshape_layer(Glo6611, [1, 1], Res19973), 
LCon33310 = concatenate_layer([Res19973,[[[0.6761]]]], 2, Con33310), 
LAve86685 = average_layer([[[[0.8866, 0.7876]]], [[[0.6018, 0.9046]]]], Ave86685), 
LMul53681 = multiply_layer([Con33310,Ave86685], Mul53681), 
LZer51385 = zero_padding1D_layer(Mul53681, 1, 0, Zer51385), 
LDot44866 = dot_layer(Mul55217,Zer51385, 2, 2, Dot44866), 
LFla32838 = flatten_layer(Dot44866, Fla32838), 
LMul29904 = multiply_layer([[[[[[0.6075], [0.1323]], [[0.5267], [0.742]]]]], [[[[[0.3071], [0.3096]], [[0.3368], [0.624]]]]]], Mul29904), 
LRes24655 = reshape_layer(Mul29904, [1, 2, 2], Res24655), 
LRes96237 = reshape_layer(Res24655, [1, 4], Res96237), 
LFla50750 = flatten_layer(Res96237, Fla50750), 
LSub2246 = subtract_layer([[0.1363, 0.3945, 0.6499]], [[0.4633, 0.1687, 0.4765]], Sub2246), 
LCon86937 = concatenate_layer([Sub2246,[[0.0326]]], 1, Con86937), 
LMul44257 = multiply_layer([Fla50750,Con86937], Mul44257), 
LSof1370 = softmax_layer(Mul44257, 1, Sof1370), 
LMin67052 = minimum_layer([Fla32838,Sof1370], Min67052), 
exec_layers([LMax13788,LRes87536,LMul53621,LZer11289,LCon71121,LMul55217,LMax70038,LRes56614,LRes74911,LGlo6611,LRes19973,LCon33310,LAve86685,LMul53681,LZer51385,LDot44866,LFla32838,LMul29904,LRes24655,LRes96237,LFla50750,LSub2246,LCon86937,LMul44257,LSof1370,LMin67052],["Max13788","Res87536","Mul53621","Zer11289","Con71121","Mul55217","Max70038","Res56614","Res74911","Glo6611","Res19973","Con33310","Ave86685","Mul53681","Zer51385","Dot44866","Fla32838","Mul29904","Res24655","Res96237","Fla50750","Sub2246","Con86937","Mul44257","Sof1370","Min67052"],Min67052,"Min67052")

Actual (Unparsed): [[0.0000000, 0.0558665, 0.0000000, 0.2540209]]

Expected (Unparsed): [[0.0,0.055866537094633406,0.0,0.25402088124347405]]

Actual:   [[0, 0.0559, 0, 0.2541]]

Expected: [[0, 0.0559, 0, 0.2541]]