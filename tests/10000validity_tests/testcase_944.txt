import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min3340 = tf.keras.layers.Input(shape=([1, 1]))
in1Min3340 = tf.keras.layers.Input(shape=([1, 1]))
in0Con80703 = tf.keras.layers.Input(shape=([1, 4, 1, 3]))
in0Loc16266 = tf.keras.layers.Input(shape=([2, 2]))
in0Min67659 = tf.keras.layers.Input(shape=([1, 2]))
in1Min67659 = tf.keras.layers.Input(shape=([1, 2]))
in0Con92576 = tf.keras.layers.Input(shape=([2, 3, 3, 3]))
in0Max75539 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max75539 = tf.keras.layers.Input(shape=([1, 2, 1]))

Min3340 = keras.layers.Minimum(name = 'Min3340', )([in0Min3340,in1Min3340])
Res58564 = keras.layers.Reshape((1, 1, 1), name = 'Res58564', )(Min3340)
Res26044 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res26044', )(Res58564)
Zer33492 = keras.layers.ZeroPadding3D(padding=((0, 0), (3, 0), (0, 0)), name = 'Zer33492', )(Res26044)
Con80703 = keras.layers.Concatenate(axis=4, name = 'Con80703', )([Zer33492,in0Con80703])
Loc16266 = keras.layers.LocallyConnected1D(4, (1),strides=(9), name = 'Loc16266', )(in0Loc16266)
Res8538 = keras.layers.Reshape((1, 4, 1), name = 'Res8538', )(Loc16266)
Res24424 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res24424', )(Res8538)
Con15160 = keras.layers.Conv3D(4, (1, 1, 1),strides=(2, 1, 6), padding='same', dilation_rate=(1, 1, 1), name = 'Con15160', )(Res24424)
Max76438 = keras.layers.Maximum(name = 'Max76438', )([Con80703,Con15160])
Lay74052 = keras.layers.LayerNormalization(axis=1, epsilon=1.760663177156091, name = 'Lay74052', )(Max76438)
Zer57654 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (2, 0)), name = 'Zer57654', )(Lay74052)
Min67659 = keras.layers.Minimum(name = 'Min67659', )([in0Min67659,in1Min67659])
Res15435 = keras.layers.Reshape((1, 2, 1), name = 'Res15435', )(Min67659)
Res16626 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res16626', )(Res15435)
Zer82032 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (2, 0)), name = 'Zer82032', )(Res16626)
Con92576 = keras.layers.Concatenate(axis=4, name = 'Con92576', )([Zer82032,in0Con92576])
Max75539 = keras.layers.Maximum(name = 'Max75539', )([in0Max75539,in1Max75539])
Con67906 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(2, 1), padding='valid', name = 'Con67906', )(Max75539)
Res57690 = keras.layers.Reshape((2, 2, 3, 1), name = 'Res57690', )(Con67906)
Con86423 = keras.layers.Conv3D(4, (1, 2, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con86423', )(Res57690)
Zer25934 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer25934', )(Con86423)
Add11517 = keras.layers.Add(name = 'Add11517', )([Con92576,Zer25934])
Zer31919 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer31919', )(Add11517)
Max23262 = keras.layers.Maximum(name = 'Max23262', )([Zer57654,Zer31919])
model = tf.keras.models.Model(inputs=[in0Min3340,in1Min3340,in0Con80703,in0Loc16266,in0Min67659,in1Min67659,in0Con92576,in0Max75539,in1Max75539], outputs=Max23262)
w = model.get_layer('Loc16266').get_weights() 
w[0] = np.array([[[0.8782, 0.7861, 0.3635, 0.9269], [0.7157, 0.8801, 0.994, 0.0419]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc16266').set_weights(w) 
w = model.get_layer('Con15160').get_weights() 
w[0] = np.array([[[[[0.0698, 0.176, 0.6769, 0.7405]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con15160').set_weights(w) 
w = model.get_layer('Con67906').get_weights() 
w[0] = np.array([[[[0.9536], [0.2758], [0.425]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con67906').set_weights(w) 
w = model.get_layer('Con86423').get_weights() 
w[0] = np.array([[[[[0.3501, 0.2554, 0.1458, 0.0105]]], [[[0.0773, 0.9548, 0.2546, 0.4986]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con86423').set_weights(w) 
in0Min3340 = tf.constant([[[0.2249]]])
in1Min3340 = tf.constant([[[0.2376]]])
in0Con80703 = tf.constant([[[[[0.2259, 0.4411, 0.4998]], [[0.6572, 0.9534, 0.9132]], [[0.6572, 0.1644, 0.5928]], [[0.8117, 0.0792, 0.9321]]]]])
in0Loc16266 = tf.constant([[[0.3866, 0.5767], [0.1609, 0.9044]]])
in0Min67659 = tf.constant([[[0.1583, 0.7305]]])
in1Min67659 = tf.constant([[[0.806, 0.2375]]])
in0Con92576 = tf.constant([[[[[0.4847, 0.4039, 0.8813], [0.9538, 0.057, 0.5391], [0.6363, 0.4151, 0.4859]], [[0.0107, 0.197, 0.6954], [0.4226, 0.7447, 0.3829], [0.5182, 0.4004, 0.498]], [[0.8031, 0.9688, 0.9173], [0.9488, 0.879, 0.5257], [0.2657, 0.102, 0.9464]]], [[[0.6549, 0.3882, 0.9489], [0.9326, 0.5607, 0.2584], [0.479, 0.5224, 0.1737]], [[0.1548, 0.2109, 0.3016], [0.3545, 0.7262, 0.3822], [0.0982, 0.5918, 0.9308]], [[0.8181, 0.6301, 0.1824], [0.7709, 0.285, 0.61], [0.9941, 0.2452, 0.8282]]]]])
in0Max75539 = tf.constant([[[[0.2038], [0.2933]]]])
in1Max75539 = tf.constant([[[[0.5622], [0.0234]]]])
print (np.array2string(model.predict([in0Min3340,in1Min3340,in0Con80703,in0Loc16266,in0Min67659,in1Min67659,in0Con92576,in0Max75539,in1Max75539],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max23262.png')

LMin3340 = minimum_layer([[[[0.2249]]], [[[0.2376]]]], Min3340), 
LRes58564 = reshape_layer(Min3340, [1, 1, 1], Res58564), 
LRes26044 = reshape_layer(Res58564, [1, 1, 1, 1], Res26044), 
LZer33492 = zero_padding3D_layer(Res26044, 0, 0, 3, 0, 0, 0, Zer33492), 
LCon80703 = concatenate_layer([Zer33492,[[[[[0.2259, 0.4411, 0.4998]], [[0.6572, 0.9534, 0.9132]], [[0.6572, 0.1644, 0.5928]], [[0.8117, 0.0792, 0.9321]]]]]], 4, Con80703), 
LLoc16266 = locally_connected1D_layer([[[0.3866, 0.5767], [0.1609, 0.9044]]], 1,[[[0.8782, 0.7861, 0.3635, 0.9269], [0.7157, 0.8801, 0.994, 0.0419]]],[[0, 0, 0, 0]], 9, Loc16266), 
LRes8538 = reshape_layer(Loc16266, [1, 4, 1], Res8538), 
LRes24424 = reshape_layer(Res8538, [1, 4, 1, 1], Res24424), 
LCon15160 = conv3D_layer(Res24424, 1, 1, 1,[[[[[0.0698, 0.176, 0.6769, 0.7405]]]]],[0, 0, 0, 0], 2, 1, 6, true, 1, 1, 1, Con15160), 
LMax76438 = maximum_layer([Con80703,Con15160], Max76438), 
LLay74052 = layer_normalization_layer(Max76438, 1, 1.760663177156091, Lay74052), 
LZer57654 = zero_padding3D_layer(Lay74052, 1, 0, 1, 0, 2, 0, Zer57654), 
LMin67659 = minimum_layer([[[[0.1583, 0.7305]]], [[[0.806, 0.2375]]]], Min67659), 
LRes15435 = reshape_layer(Min67659, [1, 2, 1], Res15435), 
LRes16626 = reshape_layer(Res15435, [1, 2, 1, 1], Res16626), 
LZer82032 = zero_padding3D_layer(Res16626, 1, 0, 1, 0, 2, 0, Zer82032), 
LCon92576 = concatenate_layer([Zer82032,[[[[[0.4847, 0.4039, 0.8813], [0.9538, 0.057, 0.5391], [0.6363, 0.4151, 0.4859]], [[0.0107, 0.197, 0.6954], [0.4226, 0.7447, 0.3829], [0.5182, 0.4004, 0.498]], [[0.8031, 0.9688, 0.9173], [0.9488, 0.879, 0.5257], [0.2657, 0.102, 0.9464]]], [[[0.6549, 0.3882, 0.9489], [0.9326, 0.5607, 0.2584], [0.479, 0.5224, 0.1737]], [[0.1548, 0.2109, 0.3016], [0.3545, 0.7262, 0.3822], [0.0982, 0.5918, 0.9308]], [[0.8181, 0.6301, 0.1824], [0.7709, 0.285, 0.61], [0.9941, 0.2452, 0.8282]]]]]], 4, Con92576), 
LMax75539 = maximum_layer([[[[[0.2038], [0.2933]]]], [[[[0.5622], [0.0234]]]]], Max75539), 
LCon67906 = conv2D_transpose_layer(Max75539, 1, 1,[[[[0.9536], [0.2758], [0.425]]]],[0, 0, 0], 2, 1, false, Con67906), 
LRes57690 = reshape_layer(Con67906, [2, 2, 3, 1], Res57690), 
LCon86423 = conv3D_layer(Res57690, 1, 2, 1,[[[[[0.3501, 0.2554, 0.1458, 0.0105]]], [[[0.0773, 0.9548, 0.2546, 0.4986]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con86423), 
LZer25934 = zero_padding3D_layer(Con86423, 0, 0, 2, 0, 0, 0, Zer25934), 
LAdd11517 = add_layer([Con92576,Zer25934], Add11517), 
LZer31919 = zero_padding3D_layer(Add11517, 0, 0, 2, 0, 0, 0, Zer31919), 
LMax23262 = maximum_layer([Zer57654,Zer31919], Max23262), 
exec_layers([LMin3340,LRes58564,LRes26044,LZer33492,LCon80703,LLoc16266,LRes8538,LRes24424,LCon15160,LMax76438,LLay74052,LZer57654,LMin67659,LRes15435,LRes16626,LZer82032,LCon92576,LMax75539,LCon67906,LRes57690,LCon86423,LZer25934,LAdd11517,LZer31919,LMax23262],["Min3340","Res58564","Res26044","Zer33492","Con80703","Loc16266","Res8538","Res24424","Con15160","Max76438","Lay74052","Zer57654","Min67659","Res15435","Res16626","Zer82032","Con92576","Max75539","Con67906","Res57690","Con86423","Zer25934","Add11517","Zer31919","Max23262"],Max23262,"Max23262")

Actual (Unparsed): [[[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.4847000, 0.4039000, 0.8813000], [0.0000000, 0.9538000, 0.0570000, 0.5391000], [0.0000000, 0.6363000, 0.4151000, 0.4859000]], [[0.0000000, 0.0107000, 0.1970000, 0.6954000], [0.0000000, 0.4226000, 0.7447000, 0.3829000], [0.0000000, 0.5182000, 0.4004000, 0.4980000]], [[0.2093136, 1.2070723, 1.1181747, 1.0623831], [0.0605376, 1.0656368, 0.9222021, 0.5676609], [0.0932868, 0.4457422, 0.1685732, 1.0110605]]], [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.0000000, 0.6549000, 0.3882000, 0.9489000], [0.0000000, 0.9326000, 0.5607000, 0.2584000], [0.0000000, 0.4790000, 0.5224000, 0.1737000]], [[0.0000000, 0.1548000, 0.2109000, 0.3016000], [0.0000000, 0.3545000, 0.7262000, 0.3822000], [0.1583000, 0.0982000, 0.5918000, 0.9308000]], [[0.0000000, 0.8181000, 0.6301000, 0.1824000], [0.0000000, 0.7709000, 0.2850000, 0.6100000], [0.2375000, 0.9941000, 0.2452000, 0.8282000]]]]]

Expected (Unparsed): [[[[[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0.4847,0.4039,0.8813],[0,0.9538,0.057,0.5391],[0,0.6363,0.4151,0.4859]],[[0,0.0107,0.197,0.6954],[0,0.4226,0.7447,0.3829],[0,0.5182,0.4004,0.498]],[[0.209313588416,1.2070723473920002,1.118174707584,1.062383068928],[0.06053763389800001,1.065636800976,0.922202122852,0.5676608959839999],[0.09328678175,0.44574220600000003,0.16857324950000002,1.011060554]]],[[[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0,0,0,0],[0,0,0,0],[0.0,0.0,0.0,0.0]],[[0,0.6549,0.3882,0.9489],[0,0.9326,0.5607,0.2584],[0.0,0.479,0.5224,0.1737]],[[0,0.1548,0.2109,0.3016],[0,0.3545,0.7262,0.3822],[0.1583,0.0982,0.5918,0.9308]],[[0,0.8181,0.6301,0.1824],[0,0.7709,0.285,0.61],[0.2375,0.9941,0.2452,0.8282]]]]]

Actual:   [[[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0.4847, 0.4039, 0.8813], [0, 0.9538, 0.057, 0.5391], [0, 0.6363, 0.4151, 0.4859]], [[0, 0.0107, 0.197, 0.6954], [0, 0.4226, 0.7447, 0.3829], [0, 0.5182, 0.4004, 0.498]], [[0.2094, 1.2071, 1.1182, 1.0624], [0.0606, 1.0657, 0.9223, 0.5677], [0.0933, 0.4458, 0.1686, 1.0111]]], [[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0.6549, 0.3882, 0.9489], [0, 0.9326, 0.5607, 0.2584], [0, 0.479, 0.5224, 0.1737]], [[0, 0.1548, 0.2109, 0.3016], [0, 0.3545, 0.7262, 0.3822], [0.1583, 0.0982, 0.5918, 0.9308]], [[0, 0.8181, 0.6301, 0.1824], [0, 0.7709, 0.285, 0.61], [0.2375, 0.9941, 0.2452, 0.8282]]]]]

Expected: [[[[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0.4847, 0.4039, 0.8813], [0, 0.9538, 0.057, 0.5391], [0, 0.6363, 0.4151, 0.4859]], [[0, 0.0107, 0.197, 0.6954], [0, 0.4226, 0.7447, 0.3829], [0, 0.5182, 0.4004, 0.498]], [[0.2094, 1.2071, 1.1182, 1.0624], [0.0606, 1.0657, 0.9223, 0.5677], [0.0933, 0.4458, 0.1686, 1.0111]]], [[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0, 0.6549, 0.3882, 0.9489], [0, 0.9326, 0.5607, 0.2584], [0, 0.479, 0.5224, 0.1737]], [[0, 0.1548, 0.2109, 0.3016], [0, 0.3545, 0.7262, 0.3822], [0.1583, 0.0982, 0.5918, 0.9308]], [[0, 0.8181, 0.6301, 0.1824], [0, 0.7709, 0.285, 0.61], [0.2375, 0.9941, 0.2452, 0.8282]]]]]