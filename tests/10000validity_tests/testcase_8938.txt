import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave82418 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave82418 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Dot14791 = tf.keras.layers.Input(shape=([3]))
in1Dot14791 = tf.keras.layers.Input(shape=([3]))
in0Con22966 = tf.keras.layers.Input(shape=([1]))

Ave82418 = keras.layers.Average(name = 'Ave82418', )([in0Ave82418,in1Ave82418])
Res50775 = keras.layers.Reshape((1, 2), name = 'Res50775', )(Ave82418)
Fla51696 = keras.layers.Flatten(name = 'Fla51696', )(Res50775)
Dot14791 = keras.layers.Dot(axes=(1, 1), name = 'Dot14791', )([in0Dot14791,in1Dot14791])
Con22966 = keras.layers.Concatenate(axis=1, name = 'Con22966', )([Dot14791,in0Con22966])
Max12772 = keras.layers.Maximum(name = 'Max12772', )([Fla51696,Con22966])
Res57159 = keras.layers.Reshape((2, 1), name = 'Res57159', )(Max12772)
Res11092 = keras.layers.Reshape((2, 1, 1), name = 'Res11092', )(Res57159)
Cro2839 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro2839', )(Res11092)
Res59906 = keras.layers.Reshape((1, 1), name = 'Res59906', )(Cro2839)
Sim6764 = keras.layers.SimpleRNN(1,name = 'Sim6764', )(Res59906)
model = tf.keras.models.Model(inputs=[in0Ave82418,in1Ave82418,in0Dot14791,in1Dot14791,in0Con22966], outputs=Sim6764)
w = model.get_layer('Sim6764').get_weights() 
w[0] = np.array([[6]])
w[1] = np.array([[2]])
w[2] = np.array([5])
model.get_layer('Sim6764').set_weights(w) 
in0Ave82418 = tf.constant([[[[0.9784], [0.735]]]])
in1Ave82418 = tf.constant([[[[0.3496], [0.6918]]]])
in0Dot14791 = tf.constant([[0.8463, 0.6788, 0.8248]])
in1Dot14791 = tf.constant([[0.1577, 0.6749, 0.401]])
in0Con22966 = tf.constant([[0.3375]])
print (np.array2string(model.predict([in0Ave82418,in1Ave82418,in0Dot14791,in1Dot14791,in0Con22966],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim6764.png')

LAve82418 = average_layer([[[[[0.9784], [0.735]]]], [[[[0.3496], [0.6918]]]]], Ave82418), 
LRes50775 = reshape_layer(Ave82418, [1, 2], Res50775), 
LFla51696 = flatten_layer(Res50775, Fla51696), 
LDot14791 = dot_layer([[0.8463, 0.6788, 0.8248]], [[0.1577, 0.6749, 0.401]], 1, 1, Dot14791), 
LCon22966 = concatenate_layer([Dot14791,[[0.3375]]], 1, Con22966), 
LMax12772 = maximum_layer([Fla51696,Con22966], Max12772), 
LRes57159 = reshape_layer(Max12772, [2, 1], Res57159), 
LRes11092 = reshape_layer(Res57159, [2, 1, 1], Res11092), 
LCro2839 = cropping2D_layer(Res11092, 1, 0, 0, 0, Cro2839), 
LRes59906 = reshape_layer(Cro2839, [1, 1], Res59906), 
LSim6764 = simple_rnn_layer(Res59906,[[6]],[[2]],[5], Sim6764), 
exec_layers([LAve82418,LRes50775,LFla51696,LDot14791,LCon22966,LMax12772,LRes57159,LRes11092,LCro2839,LRes59906,LSim6764],["Ave82418","Res50775","Fla51696","Dot14791","Con22966","Max12772","Res57159","Res11092","Cro2839","Res59906","Sim6764"],Sim6764,"Sim6764")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[0.9999999826149089]]

Actual:   [[1]]

Expected: [[1]]