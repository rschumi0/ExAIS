import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub74901 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Sub74901 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Sub74901 = keras.layers.Subtract(name = 'Sub74901', )([in0Sub74901,in1Sub74901])
Res25198 = keras.layers.Reshape((2, 2, 4), name = 'Res25198', )(Sub74901)
PRe13338 = keras.layers.PReLU(name = 'PRe13338', )(Res25198)
Res10124 = keras.layers.Reshape((2, 8), name = 'Res10124', )(PRe13338)
Sim86499 = keras.layers.SimpleRNN(3,name = 'Sim86499', )(Res10124)
ELU69402 = keras.layers.ELU(alpha=0.7234309859642796, name = 'ELU69402', )(Sim86499)
model = tf.keras.models.Model(inputs=[in0Sub74901,in1Sub74901], outputs=ELU69402)
w = model.get_layer('PRe13338').get_weights() 
w[0] = np.array([[[0.1658, 0.5331, 0.6859, 0.4561], [0.139, 0.4552, 0.9733, 0.2672]], [[0.3057, 0.8947, 0.7506, 0.8645], [0.4035, 0.7261, 0.0129, 0.4773]]])
model.get_layer('PRe13338').set_weights(w) 
w = model.get_layer('Sim86499').get_weights() 
w[0] = np.array([[1, 2, 9], [4, 9, 6], [8, 8, 10], [3, 2, 4], [9, 8, 4], [1, 4, 6], [3, 7, 5], [3, 10, 8]])
w[1] = np.array([[10, 7, 2], [1, 4, 9], [9, 6, 3]])
w[2] = np.array([1, 2, 3])
model.get_layer('Sim86499').set_weights(w) 
in0Sub74901 = tf.constant([[[[[0.8852, 0.3187], [0.9955, 0.4695]], [[0.0581, 0.677], [0.071, 0.7648]]], [[[0.7758, 0.5271], [0.8945, 0.2424]], [[0.1306, 0.004], [0.5932, 0.8661]]]]])
in1Sub74901 = tf.constant([[[[[0.8433, 0.6491], [0.6413, 0.1244]], [[0.3113, 0.4459], [0.8376, 0.7256]]], [[[0.7613, 0.8236], [0.341, 0.887]], [[0.4512, 0.2239], [0.2881, 0.4062]]]]])
print (np.array2string(model.predict([in0Sub74901,in1Sub74901],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU69402.png')

LSub74901 = subtract_layer([[[[[0.8852, 0.3187], [0.9955, 0.4695]], [[0.0581, 0.677], [0.071, 0.7648]]], [[[0.7758, 0.5271], [0.8945, 0.2424]], [[0.1306, 0.004], [0.5932, 0.8661]]]]], [[[[[0.8433, 0.6491], [0.6413, 0.1244]], [[0.3113, 0.4459], [0.8376, 0.7256]]], [[[0.7613, 0.8236], [0.341, 0.887]], [[0.4512, 0.2239], [0.2881, 0.4062]]]]], Sub74901), 
LRes25198 = reshape_layer(Sub74901, [2, 2, 4], Res25198), 
LPRe13338 = prelu_layer(Res25198, [[[0.1658, 0.5331, 0.6859, 0.4561], [0.139, 0.4552, 0.9733, 0.2672]], [[0.3057, 0.8947, 0.7506, 0.8645], [0.4035, 0.7261, 0.0129, 0.4773]]], PRe13338), 
LRes10124 = reshape_layer(PRe13338, [2, 8], Res10124), 
LSim86499 = simple_rnn_layer(Res10124,[[1, 2, 9], [4, 9, 6], [8, 8, 10], [3, 2, 4], [9, 8, 4], [1, 4, 6], [3, 7, 5], [3, 10, 8]],[[10, 7, 2], [1, 4, 9], [9, 6, 3]],[1, 2, 3], Sim86499), 
LELU69402 = elu_layer(Sim86499, 0.7234309859642796, ELU69402), 
exec_layers([LSub74901,LRes25198,LPRe13338,LRes10124,LSim86499,LELU69402],["Sub74901","Res25198","PRe13338","Res10124","Sim86499","ELU69402"],ELU69402,"ELU69402")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0,0.9999999999280312]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]