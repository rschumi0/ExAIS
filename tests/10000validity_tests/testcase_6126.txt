import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay28038 = tf.keras.layers.Input(shape=([3]))
in0Glo19121 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con53399 = tf.keras.layers.Input(shape=([2]))
in0Con73642 = tf.keras.layers.Input(shape=([3, 3, 3, 1]))
in0Add82721 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Add82721 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Lay28038 = keras.layers.LayerNormalization(axis=1, epsilon=2.136337314147877, name = 'Lay28038', )(in0Lay28038)
Glo19121 = keras.layers.GlobalAveragePooling2D(name = 'Glo19121', )(in0Glo19121)
Con53399 = keras.layers.Concatenate(axis=1, name = 'Con53399', )([Glo19121,in0Con53399])
Mul43585 = keras.layers.Multiply(name = 'Mul43585', )([Lay28038,Con53399])
Res21781 = keras.layers.Reshape((3, 1), name = 'Res21781', )(Mul43585)
Res37809 = keras.layers.Reshape((3, 1, 1), name = 'Res37809', )(Res21781)
Res9525 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res9525', )(Res37809)
Zer17818 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (2, 0)), name = 'Zer17818', )(Res9525)
Con73642 = keras.layers.Concatenate(axis=4, name = 'Con73642', )([Zer17818,in0Con73642])
Add82721 = keras.layers.Add(name = 'Add82721', )([in0Add82721,in1Add82721])
Zer74099 = keras.layers.ZeroPadding3D(padding=((2, 0), (1, 0), (1, 0)), name = 'Zer74099', )(Add82721)
Mul84612 = keras.layers.Multiply(name = 'Mul84612', )([Con73642,Zer74099])
Res55105 = keras.layers.Reshape((3, 3, 6), name = 'Res55105', )(Mul84612)
Sep93827 = keras.layers.SeparableConv2D(3, (3, 2),strides=(2, 2), padding='valid', name = 'Sep93827', )(Res55105)
model = tf.keras.models.Model(inputs=[in0Lay28038,in0Glo19121,in0Con53399,in0Con73642,in0Add82721,in1Add82721], outputs=Sep93827)
w = model.get_layer('Sep93827').get_weights() 
w[0] = np.array([[[[0.2428], [0.122], [0.022], [0.6198], [0.4392], [0.2148]], [[0.8707], [0.9607], [0.6682], [0.352], [0.2162], [0.0823]]], [[[0.724], [0.6355], [0.0024], [0.262], [0.569], [0.2978]], [[0.9937], [0.2049], [0.6918], [0.3698], [0.133], [0.94]]], [[[0.1842], [0.5534], [0.5775], [0.0998], [0.0771], [0.9315]], [[0.1417], [0.6155], [0.8041], [0.2062], [0.2247], [0.5599]]]])
w[1] = np.array([[[[0.9891, 0.4883, 0.7905], [0.4635, 0.3322, 0.4064], [0.955, 0.121, 0.9207], [0.2161, 0.3292, 0.8318], [0.1564, 0.294, 0.3224], [0.5256, 0.6952, 0.3275]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep93827').set_weights(w) 
in0Lay28038 = tf.constant([[1.4739, 1.3578, 1.6665]])
in0Glo19121 = tf.constant([[[[1.312], [1.3701]]]])
in0Con53399 = tf.constant([[0.611, 0.747]])
in0Con73642 = tf.constant([[[[[0.3192], [0.8577], [0.5235]], [[0.8288], [0.3674], [0.5442]], [[0.3678], [0.4258], [0.2099]]], [[[0.2833], [0.1206], [0.0834]], [[0.216], [0.8356], [0.3758]], [[0.2996], [0.1051], [0.8819]]], [[[0.9566], [0.2959], [0.3121]], [[0.4714], [0.8994], [0.4403]], [[0.1708], [0.8234], [0.2323]]]]])
in0Add82721 = tf.constant([[[[[0.1316, 0.1913], [0.7486, 0.0478]], [[0.9713, 0.2837], [0.2298, 0.7855]]]]])
in1Add82721 = tf.constant([[[[[0.4699, 0.0013], [0.4335, 0.3869]], [[0.5543, 0.7968], [0.4067, 0.2301]]]]])
print (np.array2string(model.predict([in0Lay28038,in0Glo19121,in0Con53399,in0Con73642,in0Add82721,in1Add82721],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep93827.png')

LLay28038 = layer_normalization_layer([[1.4739, 1.3578, 1.6665]], 1, 2.136337314147877, Lay28038), 
LGlo19121 = global_average_pooling2D_layer([[[[1.312], [1.3701]]]], Glo19121), 
LCon53399 = concatenate_layer([Glo19121,[[0.611, 0.747]]], 1, Con53399), 
LMul43585 = multiply_layer([Lay28038,Con53399], Mul43585), 
LRes21781 = reshape_layer(Mul43585, [3, 1], Res21781), 
LRes37809 = reshape_layer(Res21781, [3, 1, 1], Res37809), 
LRes9525 = reshape_layer(Res37809, [3, 1, 1, 1], Res9525), 
LZer17818 = zero_padding3D_layer(Res9525, 0, 0, 2, 0, 2, 0, Zer17818), 
LCon73642 = concatenate_layer([Zer17818,[[[[[0.3192], [0.8577], [0.5235]], [[0.8288], [0.3674], [0.5442]], [[0.3678], [0.4258], [0.2099]]], [[[0.2833], [0.1206], [0.0834]], [[0.216], [0.8356], [0.3758]], [[0.2996], [0.1051], [0.8819]]], [[[0.9566], [0.2959], [0.3121]], [[0.4714], [0.8994], [0.4403]], [[0.1708], [0.8234], [0.2323]]]]]], 4, Con73642), 
LAdd82721 = add_layer([[[[[[0.1316, 0.1913], [0.7486, 0.0478]], [[0.9713, 0.2837], [0.2298, 0.7855]]]]], [[[[[0.4699, 0.0013], [0.4335, 0.3869]], [[0.5543, 0.7968], [0.4067, 0.2301]]]]]], Add82721), 
LZer74099 = zero_padding3D_layer(Add82721, 2, 0, 1, 0, 1, 0, Zer74099), 
LMul84612 = multiply_layer([Con73642,Zer74099], Mul84612), 
LRes55105 = reshape_layer(Mul84612, [3, 3, 6], Res55105), 
LSep93827 = separable_conv2D_layer(Res55105, 3, 2,[[[[[0.2428], [0.122], [0.022], [0.6198], [0.4392], [0.2148]], [[0.8707], [0.9607], [0.6682], [0.352], [0.2162], [0.0823]]], [[[0.724], [0.6355], [0.0024], [0.262], [0.569], [0.2978]], [[0.9937], [0.2049], [0.6918], [0.3698], [0.133], [0.94]]], [[[0.1842], [0.5534], [0.5775], [0.0998], [0.0771], [0.9315]], [[0.1417], [0.6155], [0.8041], [0.2062], [0.2247], [0.5599]]]],[[[[0.9891, 0.4883, 0.7905], [0.4635, 0.3322, 0.4064], [0.955, 0.121, 0.9207], [0.2161, 0.3292, 0.8318], [0.1564, 0.294, 0.3224], [0.5256, 0.6952, 0.3275]]]]],[0, 0, 0], 2, 2, false, Sep93827), 
exec_layers([LLay28038,LGlo19121,LCon53399,LMul43585,LRes21781,LRes37809,LRes9525,LZer17818,LCon73642,LAdd82721,LZer74099,LMul84612,LRes55105,LSep93827],["Lay28038","Glo19121","Con53399","Mul43585","Res21781","Res37809","Res9525","Zer17818","Con73642","Add82721","Zer74099","Mul84612","Res55105","Sep93827"],Sep93827,"Sep93827")

Actual (Unparsed): [[[[0.0640442, 0.0862590, 0.0648072]]]]

Expected (Unparsed): [[[[0.0640442323713312,0.0862590469170744,0.0648071640874629]]]]

Actual:   [[[[0.0641, 0.0863, 0.0649]]]]

Expected: [[[[0.0641, 0.0863, 0.0649]]]]