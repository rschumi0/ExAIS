import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim4843 = tf.keras.layers.Input(shape=([1, 2]))
in0Con24775 = tf.keras.layers.Input(shape=([5]))
in0Mul57552 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Mul57552 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Sim4843 = keras.layers.SimpleRNN(3,name = 'Sim4843', )(in0Sim4843)
Con24775 = keras.layers.Concatenate(axis=1, name = 'Con24775', )([Sim4843,in0Con24775])
Mul57552 = keras.layers.Multiply(name = 'Mul57552', )([in0Mul57552,in1Mul57552])
Fla75738 = keras.layers.Flatten(name = 'Fla75738', )(Mul57552)
Max7739 = keras.layers.Maximum(name = 'Max7739', )([Con24775,Fla75738])
model = tf.keras.models.Model(inputs=[in0Sim4843,in0Con24775,in0Mul57552,in1Mul57552], outputs=Max7739)
w = model.get_layer('Sim4843').get_weights() 
w[0] = np.array([[5, 7, 7], [10, 10, 1]])
w[1] = np.array([[9, 10, 7], [1, 8, 2], [4, 7, 9]])
w[2] = np.array([5, 9, 4])
model.get_layer('Sim4843').set_weights(w) 
in0Sim4843 = tf.constant([[[2, 2]]])
in0Con24775 = tf.constant([[0.3147, 0.2191, 0.8795, 0.0162, 0.5194]])
in0Mul57552 = tf.constant([[[[[0.0091, 0.3967], [0.1626, 0.4284]], [[0.2217, 0.0035], [0.9683, 0.2708]]]]])
in1Mul57552 = tf.constant([[[[[0.1769, 0.1592], [0.8214, 0.0101]], [[0.5606, 0.2927], [0.0609, 0.2103]]]]])
print (np.array2string(model.predict([in0Sim4843,in0Con24775,in0Mul57552,in1Mul57552],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max7739.png')

LSim4843 = simple_rnn_layer([[[2, 2]]],[[5, 7, 7], [10, 10, 1]],[[9, 10, 7], [1, 8, 2], [4, 7, 9]],[5, 9, 4], Sim4843), 
LCon24775 = concatenate_layer([Sim4843,[[0.3147, 0.2191, 0.8795, 0.0162, 0.5194]]], 1, Con24775), 
LMul57552 = multiply_layer([[[[[[0.0091, 0.3967], [0.1626, 0.4284]], [[0.2217, 0.0035], [0.9683, 0.2708]]]]], [[[[[0.1769, 0.1592], [0.8214, 0.0101]], [[0.5606, 0.2927], [0.0609, 0.2103]]]]]], Mul57552), 
LFla75738 = flatten_layer(Mul57552, Fla75738), 
LMax7739 = maximum_layer([Con24775,Fla75738], Max7739), 
exec_layers([LSim4843,LCon24775,LMul57552,LFla75738,LMax7739],["Sim4843","Con24775","Mul57552","Fla75738","Max7739"],Max7739,"Max7739")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000, 0.3147000, 0.2191000, 0.8795000, 0.0589695, 0.5194000]]

Expected (Unparsed): [[1.0,1.0,1.0,0.3147,0.2191,0.8795,0.05896947,0.5194]]

Actual:   [[1, 1, 1, 0.3147, 0.2191, 0.8795, 0.059, 0.5194]]

Expected: [[1, 1, 1, 0.3147, 0.2191, 0.8795, 0.059, 0.5194]]