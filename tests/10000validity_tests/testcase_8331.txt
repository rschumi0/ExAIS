import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof90973 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Ave38524 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Ave38524 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con15368 = tf.keras.layers.Input(shape=([2, 1]))
in0Min62564 = tf.keras.layers.Input(shape=([2, 2]))
in1Min62564 = tf.keras.layers.Input(shape=([2, 2]))

Sof90973 = keras.layers.Softmax(axis=1, name = 'Sof90973', input_shape=(2, 1, 1))(in0Sof90973)
Res82025 = keras.layers.Reshape((2, 1), name = 'Res82025', )(Sof90973)
Fla2315 = keras.layers.Flatten(name = 'Fla2315', )(Res82025)
Ave38524 = keras.layers.Average(name = 'Ave38524', )([in0Ave38524,in1Ave38524])
Res32892 = keras.layers.Reshape((2, 2), name = 'Res32892', )(Ave38524)
Glo43434 = keras.layers.GlobalMaxPool1D(name = 'Glo43434', )(Res32892)
Sub17388 = keras.layers.Subtract(name = 'Sub17388', )([Fla2315,Glo43434])
Res77773 = keras.layers.Reshape((2, 1), name = 'Res77773', )(Sub17388)
Con15368 = keras.layers.Concatenate(axis=2, name = 'Con15368', )([Res77773,in0Con15368])
Min62564 = keras.layers.Minimum(name = 'Min62564', )([in0Min62564,in1Min62564])
Sub60375 = keras.layers.Subtract(name = 'Sub60375', )([Con15368,Min62564])
model = tf.keras.models.Model(inputs=[in0Sof90973,in0Ave38524,in1Ave38524,in0Con15368,in0Min62564,in1Min62564], outputs=Sub60375)
in0Sof90973 = tf.constant([[[[0.9591]], [[0.0115]]]])
in0Ave38524 = tf.constant([[[[0.02, 0.3495]], [[0.7653, 0.9577]]]])
in1Ave38524 = tf.constant([[[[0.2977, 0.711]], [[0.311, 0.3771]]]])
in0Con15368 = tf.constant([[[0.8893], [0.5221]]])
in0Min62564 = tf.constant([[[0.5995, 0.1696], [0.9551, 0.5311]]])
in1Min62564 = tf.constant([[[0.5407, 0.0241], [0.5643, 0.4334]]])
print (np.array2string(model.predict([in0Sof90973,in0Ave38524,in1Ave38524,in0Con15368,in0Min62564,in1Min62564],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub60375.png')

LSof90973 = softmax_layer([[[[0.9591]], [[0.0115]]]], 1, Sof90973), 
LRes82025 = reshape_layer(Sof90973, [2, 1], Res82025), 
LFla2315 = flatten_layer(Res82025, Fla2315), 
LAve38524 = average_layer([[[[[0.02, 0.3495]], [[0.7653, 0.9577]]]], [[[[0.2977, 0.711]], [[0.311, 0.3771]]]]], Ave38524), 
LRes32892 = reshape_layer(Ave38524, [2, 2], Res32892), 
LGlo43434 = global_max_pool1D_layer(Res32892, Glo43434), 
LSub17388 = subtract_layer(Fla2315,Glo43434, Sub17388), 
LRes77773 = reshape_layer(Sub17388, [2, 1], Res77773), 
LCon15368 = concatenate_layer([Res77773,[[[0.8893], [0.5221]]]], 2, Con15368), 
LMin62564 = minimum_layer([[[[0.5995, 0.1696], [0.9551, 0.5311]]], [[[0.5407, 0.0241], [0.5643, 0.4334]]]], Min62564), 
LSub60375 = subtract_layer(Con15368,Min62564, Sub60375), 
exec_layers([LSof90973,LRes82025,LFla2315,LAve38524,LRes32892,LGlo43434,LSub17388,LRes77773,LCon15368,LMin62564,LSub60375],["Sof90973","Res82025","Fla2315","Ave38524","Res32892","Glo43434","Sub17388","Res77773","Con15368","Min62564","Sub60375"],Sub60375,"Sub60375")

Actual (Unparsed): [[[-0.3582177, 0.8652000], [-0.9523323, 0.0887000]]]

Expected (Unparsed): [[[-0.35821773740448615,0.8652],[-0.9523322625955138,0.0887]]]

Actual:   [[[-0.3582, 0.8652], [-0.9523, 0.0887]]]

Expected: [[[-0.3582, 0.8652], [-0.9523, 0.0887]]]