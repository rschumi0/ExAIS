import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro9877 = tf.keras.layers.Input(shape=([3, 4, 4]))
in0Con17608 = tf.keras.layers.Input(shape=([1, 11]))
in0Sub72350 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in1Sub72350 = tf.keras.layers.Input(shape=([2, 2, 3, 2]))
in0Con84936 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con82126 = tf.keras.layers.Input(shape=([2, 2, 4]))

Cro9877 = keras.layers.Cropping2D(cropping=((2, 0), (3, 0)), name = 'Cro9877', )(in0Cro9877)
Res92314 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res92314', )(Cro9877)
Glo38896 = keras.layers.GlobalMaxPool3D(name = 'Glo38896', )(Res92314)
Res41105 = keras.layers.Reshape((1, 1), name = 'Res41105', )(Glo38896)
Con17608 = keras.layers.Concatenate(axis=2, name = 'Con17608', )([Res41105,in0Con17608])
Sub72350 = keras.layers.Subtract(name = 'Sub72350', )([in0Sub72350,in1Sub72350])
Res34561 = keras.layers.Reshape((2, 2, 6), name = 'Res34561', )(Sub72350)
Con84936 = keras.layers.Conv2D(2, (2, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con84936', )(in0Con84936)
Zer53351 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer53351', )(Con84936)
Con82126 = keras.layers.Concatenate(axis=3, name = 'Con82126', )([Zer53351,in0Con82126])
Max66133 = keras.layers.Maximum(name = 'Max66133', )([Res34561,Con82126])
Res73764 = keras.layers.Reshape((2, 12), name = 'Res73764', )(Max66133)
Dot51111 = keras.layers.Dot(axes=(2, 2), name = 'Dot51111', )([Con17608,Res73764])
model = tf.keras.models.Model(inputs=[in0Cro9877,in0Con17608,in0Sub72350,in1Sub72350,in0Con84936,in0Con82126], outputs=Dot51111)
w = model.get_layer('Con84936').get_weights() 
w[0] = np.array([[[[0.3039, 0.8587], [0.282, 0.9554]]], [[[0.7068, 0.9752], [0.4533, 0.3465]]]])
w[1] = np.array([0, 0])
model.get_layer('Con84936').set_weights(w) 
in0Cro9877 = tf.constant([[[[1.313, 1.6466, 1.5842, 1.0628], [1.6836, 1.6604, 1.7691, 1.1868], [1.588, 1.3633, 1.5184, 1.6507], [1.0092, 1.7968, 1.4903, 1.8725]], [[1.1948, 1.9164, 1.662, 1.0788], [1.7262, 1.8274, 1.919, 1.1343], [1.6976, 1.9352, 1.1759, 1.5976], [1.8825, 1.7726, 1.946, 1.1711]], [[1.3524, 1.3956, 1.0065, 1.6045], [1.1315, 1.1437, 1.5605, 1.2809], [1.1181, 1.2507, 1.0918, 1.1727], [1.6883, 1.2617, 1.9271, 1.5867]]]])
in0Con17608 = tf.constant([[[0.9152, 0.0089, 0.046, 0.8139, 0.2522, 0.1844, 0.4852, 0.0389, 0.1355, 0.3381, 0.0885]]])
in0Sub72350 = tf.constant([[[[[0.1048, 0.4623], [0.3727, 0.1374], [0.1003, 0.558]], [[0.1779, 0.681], [0.7774, 0.6574], [0.991, 0.5272]]], [[[0.2744, 0.2039], [0.4218, 0.1013], [0.4798, 0.8806]], [[0.2998, 0.3736], [0.4523, 0.6669], [0.7274, 0.7955]]]]])
in1Sub72350 = tf.constant([[[[[0.0958, 0.1663], [0.5684, 0.1847], [0.0747, 0.0421]], [[0.0807, 0.9881], [0.9147, 0.9027], [0.5076, 0.6186]]], [[[0.7263, 0.2548], [0.5736, 0.1067], [0.0161, 0.2113]], [[0.9968, 0.1411], [0.6023, 0.4835], [0.3263, 0.6792]]]]])
in0Con84936 = tf.constant([[[[0.7416, 0.8122]], [[0.6401, 0.7024]]]])
in0Con82126 = tf.constant([[[[0.1417, 0.4341, 0.5285, 0.0846], [0.8638, 0.55, 0.0309, 0.4649]], [[0.1995, 0.4283, 0.7714, 0.3839], [0.7041, 0.6615, 0.32, 0.3559]]]])
print (np.array2string(model.predict([in0Cro9877,in0Con17608,in0Sub72350,in1Sub72350,in0Con84936,in0Con82126],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot51111.png')

LCro9877 = cropping2D_layer([[[[1.313, 1.6466, 1.5842, 1.0628], [1.6836, 1.6604, 1.7691, 1.1868], [1.588, 1.3633, 1.5184, 1.6507], [1.0092, 1.7968, 1.4903, 1.8725]], [[1.1948, 1.9164, 1.662, 1.0788], [1.7262, 1.8274, 1.919, 1.1343], [1.6976, 1.9352, 1.1759, 1.5976], [1.8825, 1.7726, 1.946, 1.1711]], [[1.3524, 1.3956, 1.0065, 1.6045], [1.1315, 1.1437, 1.5605, 1.2809], [1.1181, 1.2507, 1.0918, 1.1727], [1.6883, 1.2617, 1.9271, 1.5867]]]], 2, 0, 3, 0, Cro9877), 
LRes92314 = reshape_layer(Cro9877, [1, 1, 4, 1], Res92314), 
LGlo38896 = global_max_pool3D_layer(Res92314, Glo38896), 
LRes41105 = reshape_layer(Glo38896, [1, 1], Res41105), 
LCon17608 = concatenate_layer([Res41105,[[[0.9152, 0.0089, 0.046, 0.8139, 0.2522, 0.1844, 0.4852, 0.0389, 0.1355, 0.3381, 0.0885]]]], 2, Con17608), 
LSub72350 = subtract_layer([[[[[0.1048, 0.4623], [0.3727, 0.1374], [0.1003, 0.558]], [[0.1779, 0.681], [0.7774, 0.6574], [0.991, 0.5272]]], [[[0.2744, 0.2039], [0.4218, 0.1013], [0.4798, 0.8806]], [[0.2998, 0.3736], [0.4523, 0.6669], [0.7274, 0.7955]]]]], [[[[[0.0958, 0.1663], [0.5684, 0.1847], [0.0747, 0.0421]], [[0.0807, 0.9881], [0.9147, 0.9027], [0.5076, 0.6186]]], [[[0.7263, 0.2548], [0.5736, 0.1067], [0.0161, 0.2113]], [[0.9968, 0.1411], [0.6023, 0.4835], [0.3263, 0.6792]]]]], Sub72350), 
LRes34561 = reshape_layer(Sub72350, [2, 2, 6], Res34561), 
LCon84936 = conv2D_layer([[[[0.7416, 0.8122]], [[0.6401, 0.7024]]]], 2, 1,[[[[0.3039, 0.8587], [0.282, 0.9554]]], [[[0.7068, 0.9752], [0.4533, 0.3465]]]],[0, 0], 1, 1, false, 1, 1, Con84936), 
LZer53351 = zero_padding2D_layer(Con84936, 1, 0, 1, 0, Zer53351), 
LCon82126 = concatenate_layer([Zer53351,[[[[0.1417, 0.4341, 0.5285, 0.0846], [0.8638, 0.55, 0.0309, 0.4649]], [[0.1995, 0.4283, 0.7714, 0.3839], [0.7041, 0.6615, 0.32, 0.3559]]]]], 3, Con82126), 
LMax66133 = maximum_layer([Res34561,Con82126], Max66133), 
LRes73764 = reshape_layer(Max66133, [2, 12], Res73764), 
LDot51111 = dot_layer(Con17608,Res73764, 2, 2, Dot51111), 
exec_layers([LCro9877,LRes92314,LGlo38896,LRes41105,LCon17608,LSub72350,LRes34561,LCon84936,LZer53351,LCon82126,LMax66133,LRes73764,LDot51111],["Cro9877","Res92314","Glo38896","Res41105","Con17608","Sub72350","Res34561","Con84936","Zer53351","Con82126","Max66133","Res73764","Dot51111"],Dot51111,"Dot51111")

Actual (Unparsed): [[[1.2003607, 2.4346296]]]

Expected (Unparsed): [[[1.20036065,2.43462969464]]]

Actual:   [[[1.2004, 2.4347]]]

Expected: [[[1.2004, 2.4347]]]