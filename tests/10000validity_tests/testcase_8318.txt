import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con83669 = tf.keras.layers.Input(shape=([2, 2, 2]))

Con83669 = keras.layers.Conv2D(2, (1, 2),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con83669', )(in0Con83669)
Den95677 = keras.layers.Dense(3,name = 'Den95677', )(Con83669)
Res78063 = keras.layers.Reshape((2, 6), name = 'Res78063', )(Den95677)
GRU10216 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU10216', )(Res78063)
ReL36603 = keras.layers.ReLU(max_value=2.605768517984948, negative_slope=2.8079582898134454, threshold=9.988732316633316, name = 'ReL36603', )(GRU10216)
model = tf.keras.models.Model(inputs=[in0Con83669], outputs=ReL36603)
w = model.get_layer('Con83669').get_weights() 
w[0] = np.array([[[[0.7097, 0.3043], [0.5758, 0.5997]], [[0.4271, 0.3107], [0.8108, 0.6229]]]])
w[1] = np.array([0, 0])
model.get_layer('Con83669').set_weights(w) 
w = model.get_layer('Den95677').get_weights() 
w[0] = np.array([[0.9101, 0.1919, 0.6245], [0.624, 0.0313, 0.9417]])
w[1] = np.array([0.9936, 0.4092, 0.7434])
model.get_layer('Den95677').set_weights(w) 
w = model.get_layer('GRU10216').get_weights() 
w[0] = np.array([[1, 2, 6, 6, 3, 8], [3, 8, 2, 7, 7, 10], [8, 8, 4, 1, 9, 3], [2, 2, 3, 3, 2, 10], [1, 4, 8, 1, 6, 6], [4, 5, 3, 9, 9, 6]])
w[1] = np.array([[5, 2, 6, 4, 7, 9], [2, 9, 7, 3, 9, 8]])
w[2] = np.array([[7, 6, 5, 3, 3, 9], [3, 4, 6, 2, 1, 10]])
model.get_layer('GRU10216').set_weights(w) 
in0Con83669 = tf.constant([[[[0.5841, 0.2166], [0.5093, 0.1734]], [[0.4077, 0.9629], [0.27, 0.1217]]]])
print (np.array2string(model.predict([in0Con83669],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL36603.png')

LCon83669 = conv2D_layer([[[[0.5841, 0.2166], [0.5093, 0.1734]], [[0.4077, 0.9629], [0.27, 0.1217]]]], 1, 2,[[[[0.7097, 0.3043], [0.5758, 0.5997]], [[0.4271, 0.3107], [0.8108, 0.6229]]]],[0, 0], 1, 1, true, 1, 1, Con83669), 
LDen95677 = dense_layer(Con83669, [[0.9101, 0.1919, 0.6245], [0.624, 0.0313, 0.9417]],[0.9936, 0.4092, 0.7434], Den95677), 
LRes78063 = reshape_layer(Den95677, [2, 6], Res78063), 
LGRU10216 = gru_layer(Res78063,[[1, 2, 6, 6, 3, 8], [3, 8, 2, 7, 7, 10], [8, 8, 4, 1, 9, 3], [2, 2, 3, 3, 2, 10], [1, 4, 8, 1, 6, 6], [4, 5, 3, 9, 9, 6]],[[5, 2, 6, 4, 7, 9], [2, 9, 7, 3, 9, 8]],[[7, 6, 5, 3, 3, 9], [3, 4, 6, 2, 1, 10]], true, GRU10216), 
LReL36603 = relu_layer(GRU10216, 2.605768517984948, 2.8079582898134454, 9.988732316633316, ReL36603), 
exec_layers([LCon83669,LDen95677,LRes78063,LGRU10216,LReL36603],["Con83669","Den95677","Res78063","GRU10216","ReL36603"],ReL36603,"ReL36603")

Actual (Unparsed): [[-28.0479437, -28.0479437]]

Expected (Unparsed): [[-28.04794371321798,-28.04794371321798]]

Actual:   [[-28.0479, -28.0479]]

Expected: [[-28.0479, -28.0479]]