import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Thr14070 = tf.keras.layers.Input(shape=([1, 1]))
in0Max43952 = tf.keras.layers.Input(shape=([2, 1]))
in1Max43952 = tf.keras.layers.Input(shape=([2, 1]))
in0Max79338 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con91633 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con7754 = tf.keras.layers.Input(shape=([2, 1, 1]))

Thr14070 = keras.layers.ThresholdedReLU(theta=1.0523101954034546, name = 'Thr14070', input_shape=(1, 1))(in0Thr14070)
Res42848 = keras.layers.Reshape((1, 1, 1), name = 'Res42848', )(Thr14070)
Con61190 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con61190', )(Res42848)
Res24647 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res24647', )(Con61190)
PRe15956 = keras.layers.PReLU(name = 'PRe15956', )(Res24647)
Res95429 = keras.layers.Reshape((1, 1, 4), name = 'Res95429', )(PRe15956)
Zer76215 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer76215', )(Res95429)
Max43952 = keras.layers.Maximum(name = 'Max43952', )([in0Max43952,in1Max43952])
Res6689 = keras.layers.Reshape((2, 1, 1), name = 'Res6689', )(Max43952)
Res95220 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res95220', )(Res6689)
Con48198 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con48198', )(Res95220)
Res41960 = keras.layers.Reshape((2, 1, 3), name = 'Res41960', )(Con48198)
Max79338 = keras.layers.MaxPool2D(pool_size=(2, 1), strides=(1, 1), padding='valid', name = 'Max79338', )(in0Max79338)
Zer34217 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer34217', )(Max79338)
Con91633 = keras.layers.Concatenate(axis=3, name = 'Con91633', )([Zer34217,in0Con91633])
Ave23419 = keras.layers.Average(name = 'Ave23419', )([Res41960,Con91633])
Con7754 = keras.layers.Concatenate(axis=3, name = 'Con7754', )([Ave23419,in0Con7754])
Sub10697 = keras.layers.Subtract(name = 'Sub10697', )([Zer76215,Con7754])
model = tf.keras.models.Model(inputs=[in0Thr14070,in0Max43952,in1Max43952,in0Max79338,in0Con91633,in0Con7754], outputs=Sub10697)
w = model.get_layer('Con61190').get_weights() 
w[0] = np.array([[[[0.3824, 0.8663, 0.5838, 0.6956]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con61190').set_weights(w) 
w = model.get_layer('PRe15956').get_weights() 
w[0] = np.array([[[[0.2149], [0.8396], [0.8024], [0.5467]]]])
model.get_layer('PRe15956').set_weights(w) 
w = model.get_layer('Con48198').get_weights() 
w[0] = np.array([[[[[0.5282, 0.4848, 0.8719]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con48198').set_weights(w) 
in0Thr14070 = tf.constant([[[0.2072]]])
in0Max43952 = tf.constant([[[0.3778], [0.2837]]])
in1Max43952 = tf.constant([[[0.6734], [0.8515]]])
in0Max79338 = tf.constant([[[[1.7641]], [[1.521]]]])
in0Con91633 = tf.constant([[[[0.295, 0.3364]], [[0.5212, 0.4364]]]])
in0Con7754 = tf.constant([[[[0.1134]], [[0.531]]]])
print (np.array2string(model.predict([in0Thr14070,in0Max43952,in1Max43952,in0Max79338,in0Con91633,in0Con7754],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub10697.png')

LThr14070 = thresholded_relu_layer([[[0.2072]]], 1.0523101954034546, Thr14070), 
LRes42848 = reshape_layer(Thr14070, [1, 1, 1], Res42848), 
LCon61190 = conv2D_layer(Res42848, 1, 1,[[[[0.3824, 0.8663, 0.5838, 0.6956]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con61190), 
LRes24647 = reshape_layer(Con61190, [1, 1, 4, 1], Res24647), 
LPRe15956 = prelu_layer(Res24647, [[[[0.2149], [0.8396], [0.8024], [0.5467]]]], PRe15956), 
LRes95429 = reshape_layer(PRe15956, [1, 1, 4], Res95429), 
LZer76215 = zero_padding2D_layer(Res95429, 1, 0, 0, 0, Zer76215), 
LMax43952 = maximum_layer([[[[0.3778], [0.2837]]], [[[0.6734], [0.8515]]]], Max43952), 
LRes6689 = reshape_layer(Max43952, [2, 1, 1], Res6689), 
LRes95220 = reshape_layer(Res6689, [2, 1, 1, 1], Res95220), 
LCon48198 = conv3D_layer(Res95220, 1, 1, 1,[[[[[0.5282, 0.4848, 0.8719]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con48198), 
LRes41960 = reshape_layer(Con48198, [2, 1, 3], Res41960), 
LMax79338 = max_pool2D_layer([[[[1.7641]], [[1.521]]]], 2, 1, 1, 1, false, Max79338), 
LZer34217 = zero_padding2D_layer(Max79338, 1, 0, 0, 0, Zer34217), 
LCon91633 = concatenate_layer([Zer34217,[[[[0.295, 0.3364]], [[0.5212, 0.4364]]]]], 3, Con91633), 
LAve23419 = average_layer([Res41960,Con91633], Ave23419), 
LCon7754 = concatenate_layer([Ave23419,[[[[0.1134]], [[0.531]]]]], 3, Con7754), 
LSub10697 = subtract_layer(Zer76215,Con7754, Sub10697), 
exec_layers([LThr14070,LRes42848,LCon61190,LRes24647,LPRe15956,LRes95429,LZer76215,LMax43952,LRes6689,LRes95220,LCon48198,LRes41960,LMax79338,LZer34217,LCon91633,LAve23419,LCon7754,LSub10697],["Thr14070","Res42848","Con61190","Res24647","PRe15956","Res95429","Zer76215","Max43952","Res6689","Res95220","Con48198","Res41960","Max79338","Zer34217","Con91633","Ave23419","Con7754","Sub10697"],Sub10697,"Sub10697")

Actual (Unparsed): [[[[-0.1778449, -0.3107321, -0.4617687, -0.1134000]], [[-1.1069311, -0.4670036, -0.5894114, -0.5310000]]]]

Expected (Unparsed): [[[[-0.17784494,-0.31073216000000004,-0.46176872999999996,-0.1134]],[[-1.10693115,-0.4670036,-0.589411425,-0.531]]]]

Actual:   [[[[-0.1778, -0.3107, -0.4617, -0.1134]], [[-1.1069, -0.467, -0.5894, -0.531]]]]

Expected: [[[[-0.1778, -0.3107, -0.4617, -0.1134]], [[-1.1069, -0.467, -0.5894, -0.531]]]]