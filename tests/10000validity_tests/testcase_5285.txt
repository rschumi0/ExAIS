import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max17673 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max17673 = tf.keras.layers.Input(shape=([2, 2, 2]))

Max17673 = keras.layers.Maximum(name = 'Max17673', )([in0Max17673,in1Max17673])
Sep88900 = keras.layers.SeparableConv2D(2, (1, 1),strides=(2, 2), padding='same', name = 'Sep88900', )(Max17673)
model = tf.keras.models.Model(inputs=[in0Max17673,in1Max17673], outputs=Sep88900)
w = model.get_layer('Sep88900').get_weights() 
w[0] = np.array([[[[0.9863], [0.7344]]]])
w[1] = np.array([[[[0.967, 0.13], [0.6379, 0.7186]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep88900').set_weights(w) 
in0Max17673 = tf.constant([[[[0.5541, 0.7982], [0.0345, 0.1569]], [[0.7504, 0.9543], [0.177, 0.627]]]])
in1Max17673 = tf.constant([[[[0.9434, 0.8373], [0.5423, 0.1807]], [[0.9883, 0.9965], [0.8506, 0.092]]]])
print (np.array2string(model.predict([in0Max17673,in1Max17673],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep88900.png')

LMax17673 = maximum_layer([[[[[0.5541, 0.7982], [0.0345, 0.1569]], [[0.7504, 0.9543], [0.177, 0.627]]]], [[[[0.9434, 0.8373], [0.5423, 0.1807]], [[0.9883, 0.9965], [0.8506, 0.092]]]]], Max17673), 
LSep88900 = separable_conv2D_layer(Max17673, 1, 1,[[[[[0.9863], [0.7344]]]],[[[[0.967, 0.13], [0.6379, 0.7186]]]]],[0, 0], 2, 2, true, Sep88900), 
exec_layers([LMax17673,LSep88900],["Max17673","Sep88900"],Sep88900,"Sep88900")

Actual (Unparsed): [[[[1.2920228, 0.5628384]]]]

Expected (Unparsed): [[[[1.292022810388,0.5628383726320001]]]]

Actual:   [[[[1.2921, 0.5629]]]]

Expected: [[[[1.2921, 0.5629]]]]