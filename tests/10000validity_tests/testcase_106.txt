import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con27301 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Con27301 = keras.layers.Conv3D(4, (2, 2, 2),strides=(2, 9, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con27301', )(in0Con27301)
Res70626 = keras.layers.Reshape((1, 1, 8), name = 'Res70626', )(Con27301)
Sep93708 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep93708', )(Res70626)
model = tf.keras.models.Model(inputs=[in0Con27301], outputs=Sep93708)
w = model.get_layer('Con27301').get_weights() 
w[0] = np.array([[[[[0.7863, 0.0012, 0.8636, 0.6221]], [[0.4689, 0.7626, 0.9845, 0.6744]]], [[[0.5067, 0.2373, 0.1, 0.1098]], [[0.2584, 0.7191, 0.1247, 0.7054]]]], [[[[0.7045, 0.3209, 0.4081, 0.0438]], [[0.9114, 0.7059, 0.0434, 0.6357]]], [[[0.2469, 0.2485, 0.0191, 0.713]], [[0.5868, 0.5097, 0.2172, 0.0616]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con27301').set_weights(w) 
w = model.get_layer('Sep93708').get_weights() 
w[0] = np.array([[[[0.3794], [0.0471], [0.3212], [0.7065], [0.4238], [0.2318], [0.5294], [0.616]]]])
w[1] = np.array([[[[0.8551, 0.601, 0.6456], [0.4574, 0.558, 0.704], [0.3919, 0.8172, 0.8824], [0.031, 0.0534, 0.6024], [0.3696, 0.4093, 0.0489], [0.6186, 0.5949, 0.9725], [0.3444, 0.2202, 0.5191], [0.5624, 0.5131, 0.1878]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep93708').set_weights(w) 
in0Con27301 = tf.constant([[[[[0.0492], [0.222]], [[0.3576], [0.5207]]], [[[0.8899], [0.2692]], [[0.2153], [0.752]]]]])
print (np.array2string(model.predict([in0Con27301],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep93708.png')

LCon27301 = conv3D_layer([[[[[0.0492], [0.222]], [[0.3576], [0.5207]]], [[[0.8899], [0.2692]], [[0.2153], [0.752]]]]], 2, 2, 2,[[[[[0.7863, 0.0012, 0.8636, 0.6221]], [[0.4689, 0.7626, 0.9845, 0.6744]]], [[[0.5067, 0.2373, 0.1, 0.1098]], [[0.2584, 0.7191, 0.1247, 0.7054]]]], [[[[0.7045, 0.3209, 0.4081, 0.0438]], [[0.9114, 0.7059, 0.0434, 0.6357]]], [[[0.2469, 0.2485, 0.0191, 0.713]], [[0.5868, 0.5097, 0.2172, 0.0616]]]]],[0, 0, 0, 0], 2, 9, 1, true, 1, 1, 1, Con27301), 
LRes70626 = reshape_layer(Con27301, [1, 1, 8], Res70626), 
LSep93708 = separable_conv2D_layer(Res70626, 1, 1,[[[[[0.3794], [0.0471], [0.3212], [0.7065], [0.4238], [0.2318], [0.5294], [0.616]]]],[[[[0.8551, 0.601, 0.6456], [0.4574, 0.558, 0.704], [0.3919, 0.8172, 0.8824], [0.031, 0.0534, 0.6024], [0.3696, 0.4093, 0.0489], [0.6186, 0.5949, 0.9725], [0.3444, 0.2202, 0.5191], [0.5624, 0.5131, 0.1878]]]]],[0, 0, 0], 1, 1, true, Sep93708), 
exec_layers([LCon27301,LRes70626,LSep93708],["Con27301","Res70626","Sep93708"],Sep93708,"Sep93708")

Actual (Unparsed): [[[[1.2699678, 1.2053194, 1.4721428]]]]

Expected (Unparsed): [[[[1.269967817897031,1.2053193781922547,1.472142792365817]]]]

Actual:   [[[[1.27, 1.2054, 1.4722]]]]

Expected: [[[[1.27, 1.2054, 1.4722]]]]