import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add1957 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add1957 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Ave54267 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave54267 = tf.keras.layers.Input(shape=([2, 1]))
in0Sep44577 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con50934 = tf.keras.layers.Input(shape=([2, 1, 1]))

Add1957 = keras.layers.Add(name = 'Add1957', )([in0Add1957,in1Add1957])
Glo9285 = keras.layers.GlobalAveragePooling2D(name = 'Glo9285', )(Add1957)
Res27667 = keras.layers.Reshape((1, 1), name = 'Res27667', )(Glo9285)
Zer41709 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer41709', )(Res27667)
Ave54267 = keras.layers.Average(name = 'Ave54267', )([in0Ave54267,in1Ave54267])
Ave26778 = keras.layers.Average(name = 'Ave26778', )([Zer41709,Ave54267])
Res63814 = keras.layers.Reshape((2, 1, 1), name = 'Res63814', )(Ave26778)
Loc82956 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc82956', )(Res63814)
Sep44577 = keras.layers.SeparableConv2D(2, (2, 2),strides=(2, 2), padding='valid', name = 'Sep44577', )(in0Sep44577)
Zer87047 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer87047', )(Sep44577)
Con50934 = keras.layers.Concatenate(axis=3, name = 'Con50934', )([Zer87047,in0Con50934])
Sub41817 = keras.layers.Subtract(name = 'Sub41817', )([Loc82956,Con50934])
model = tf.keras.models.Model(inputs=[in0Add1957,in1Add1957,in0Ave54267,in1Ave54267,in0Sep44577,in0Con50934], outputs=Sub41817)
w = model.get_layer('Loc82956').get_weights() 
w[0] = np.array([[[0.6834, 0.9925, 0.968]], [[0.9685, 0.8776, 0.8551]]])
w[1] = np.array([[[0, 0, 0]], [[0, 0, 0]]])
model.get_layer('Loc82956').set_weights(w) 
w = model.get_layer('Sep44577').get_weights() 
w[0] = np.array([[[[0.4953], [0.3128]], [[0.6843], [0.7632]]], [[[0.6116], [0.7047]], [[0.1653], [0.4747]]]])
w[1] = np.array([[[[0.3815, 0.3358], [0.4474, 0.9954]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep44577').set_weights(w) 
in0Add1957 = tf.constant([[[[0.993], [0.6615]]]])
in1Add1957 = tf.constant([[[[0.4252], [0.5083]]]])
in0Ave54267 = tf.constant([[[0.2784], [0.3395]]])
in1Ave54267 = tf.constant([[[0.3394], [0.7818]]])
in0Sep44577 = tf.constant([[[[0.0959, 0.9416], [0.1436, 0.2438]], [[0.713, 0.4121], [0.9395, 0.8518]]]])
in0Con50934 = tf.constant([[[[0.0733]], [[0.9779]]]])
print (np.array2string(model.predict([in0Add1957,in1Add1957,in0Ave54267,in1Ave54267,in0Sep44577,in0Con50934],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub41817.png')

LAdd1957 = add_layer([[[[[0.993], [0.6615]]]], [[[[0.4252], [0.5083]]]]], Add1957), 
LGlo9285 = global_average_pooling2D_layer(Add1957, Glo9285), 
LRes27667 = reshape_layer(Glo9285, [1, 1], Res27667), 
LZer41709 = zero_padding1D_layer(Res27667, 1, 0, Zer41709), 
LAve54267 = average_layer([[[[0.2784], [0.3395]]], [[[0.3394], [0.7818]]]], Ave54267), 
LAve26778 = average_layer([Zer41709,Ave54267], Ave26778), 
LRes63814 = reshape_layer(Ave26778, [2, 1, 1], Res63814), 
LLoc82956 = locally_connected2D_layer(Res63814, 1, 1,[[[0.6834, 0.9925, 0.968]], [[0.9685, 0.8776, 0.8551]]],[[[0, 0, 0]], [[0, 0, 0]]], 1, 1, Loc82956), 
LSep44577 = separable_conv2D_layer([[[[0.0959, 0.9416], [0.1436, 0.2438]], [[0.713, 0.4121], [0.9395, 0.8518]]]], 2, 2,[[[[[0.4953], [0.3128]], [[0.6843], [0.7632]]], [[[0.6116], [0.7047]], [[0.1653], [0.4747]]]],[[[[0.3815, 0.3358], [0.4474, 0.9954]]]]],[0, 0], 2, 2, false, Sep44577), 
LZer87047 = zero_padding2D_layer(Sep44577, 1, 0, 0, 0, Zer87047), 
LCon50934 = concatenate_layer([Zer87047,[[[[0.0733]], [[0.9779]]]]], 3, Con50934), 
LSub41817 = subtract_layer(Loc82956,Con50934, Sub41817), 
exec_layers([LAdd1957,LGlo9285,LRes27667,LZer41709,LAve54267,LAve26778,LRes63814,LLoc82956,LSep44577,LZer87047,LCon50934,LSub41817],["Add1957","Glo9285","Res27667","Zer41709","Ave54267","Ave26778","Res63814","Loc82956","Sep44577","Zer87047","Con50934","Sub41817"],Sub41817,"Sub41817")

Actual (Unparsed): [[[[0.1055511, 0.1532916, 0.0762076]], [[0.0910426, -0.6036598, -0.1849444]]]]

Expected (Unparsed): [[[[0.10555112999999998,0.153291625,0.07620759999999996]],[[0.09104258977200008,-0.603659807358,-0.18494439249999994]]]]

Actual:   [[[[0.1056, 0.1533, 0.0763]], [[0.0911, -0.6036, -0.1849]]]]

Expected: [[[[0.1056, 0.1533, 0.0763]], [[0.0911, -0.6036, -0.1849]]]]