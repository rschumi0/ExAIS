import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul76704 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul76704 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con88498 = tf.keras.layers.Input(shape=([6]))
in0Ave62643 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Ave62643 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con84855 = tf.keras.layers.Input(shape=([1, 1]))
in0PRe35230 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Mas98242 = tf.keras.layers.Input(shape=([2, 4, 3]))
in0Con7704 = tf.keras.layers.Input(shape=([5]))
in0Max14722 = tf.keras.layers.Input(shape=([1, 1]))
in1Max14722 = tf.keras.layers.Input(shape=([1, 1]))

Mul76704 = keras.layers.Multiply(name = 'Mul76704', )([in0Mul76704,in1Mul76704])
Res70487 = keras.layers.Reshape((1, 2), name = 'Res70487', )(Mul76704)
Fla18746 = keras.layers.Flatten(name = 'Fla18746', )(Res70487)
Con88498 = keras.layers.Concatenate(axis=1, name = 'Con88498', )([Fla18746,in0Con88498])
Ave62643 = keras.layers.Average(name = 'Ave62643', )([in0Ave62643,in1Ave62643])
Res35149 = keras.layers.Reshape((1, 1), name = 'Res35149', )(Ave62643)
Con84855 = keras.layers.Concatenate(axis=2, name = 'Con84855', )([Res35149,in0Con84855])
PRe35230 = keras.layers.PReLU(name = 'PRe35230', input_shape=(1, 1, 2))(in0PRe35230)
Res53584 = keras.layers.Reshape((1, 2), name = 'Res53584', )(PRe35230)
Dot80898 = keras.layers.Dot(axes=(1, 1), name = 'Dot80898', )([Con84855,Res53584])
Sep26760 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep26760', )(Dot80898)
Fla14428 = keras.layers.Flatten(name = 'Fla14428', )(Sep26760)
Mas98242 = keras.layers.Masking(mask_value=2, name = 'Mas98242', )(in0Mas98242)
Glo28292 = keras.layers.GlobalMaxPool2D(name = 'Glo28292', )(Mas98242)
Con7704 = keras.layers.Concatenate(axis=1, name = 'Con7704', )([Glo28292,in0Con7704])
Add57145 = keras.layers.Add(name = 'Add57145', )([Fla14428,Con7704])
Min91997 = keras.layers.Minimum(name = 'Min91997', )([Con88498,Add57145])
Res99027 = keras.layers.Reshape((8, 1), name = 'Res99027', )(Min91997)
Max14722 = keras.layers.Maximum(name = 'Max14722', )([in0Max14722,in1Max14722])
Zer46836 = keras.layers.ZeroPadding1D(padding=((7, 0)), name = 'Zer46836', )(Max14722)
Sub884 = keras.layers.Subtract(name = 'Sub884', )([Res99027,Zer46836])
model = tf.keras.models.Model(inputs=[in0Mul76704,in1Mul76704,in0Con88498,in0Ave62643,in1Ave62643,in0Con84855,in0PRe35230,in0Mas98242,in0Con7704,in0Max14722,in1Max14722], outputs=Sub884)
w = model.get_layer('PRe35230').get_weights() 
w[0] = np.array([[[0.9147, 0.6416]]])
model.get_layer('PRe35230').set_weights(w) 
w = model.get_layer('Sep26760').get_weights() 
w[0] = np.array([[[0.1722], [0.292]]])
w[1] = np.array([[[0.3732, 0.7095, 0.416, 0.9332], [0.9183, 0.9837, 0.2515, 0.6586]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep26760').set_weights(w) 
in0Mul76704 = tf.constant([[[[0.6394, 0.2558]]]])
in1Mul76704 = tf.constant([[[[0.2414, 0.7118]]]])
in0Con88498 = tf.constant([[0.724, 0.263, 0.8227, 0.5853, 0.5438, 0.1448]])
in0Ave62643 = tf.constant([[[[0.0576]]]])
in1Ave62643 = tf.constant([[[[0.8079]]]])
in0Con84855 = tf.constant([[[0.2269]]])
in0PRe35230 = tf.constant([[[[0.2361, 0.8516]]]])
in0Mas98242 = tf.constant([[[[1.5542, 1.3682, 1.4407], [1.0992, 1.6634, 1.4644], [1.8805, 1.9155, 1.5472], [1.9714, 1.4571, 1.9414]], [[1.3366, 1.3176, 1.1264], [1.3859, 1.6517, 1.8071], [1.4212, 1.2612, 1.9971], [1.9191, 1.262, 1.672]]]])
in0Con7704 = tf.constant([[0.0465, 0.8157, 0.6647, 0.1922, 0.3224]])
in0Max14722 = tf.constant([[[0.5737]]])
in1Max14722 = tf.constant([[[0.0496]]])
print (np.array2string(model.predict([in0Mul76704,in1Mul76704,in0Con88498,in0Ave62643,in1Ave62643,in0Con84855,in0PRe35230,in0Mas98242,in0Con7704,in0Max14722,in1Max14722],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub884.png')

LMul76704 = multiply_layer([[[[[0.6394, 0.2558]]]], [[[[0.2414, 0.7118]]]]], Mul76704), 
LRes70487 = reshape_layer(Mul76704, [1, 2], Res70487), 
LFla18746 = flatten_layer(Res70487, Fla18746), 
LCon88498 = concatenate_layer([Fla18746,[[0.724, 0.263, 0.8227, 0.5853, 0.5438, 0.1448]]], 1, Con88498), 
LAve62643 = average_layer([[[[[0.0576]]]], [[[[0.8079]]]]], Ave62643), 
LRes35149 = reshape_layer(Ave62643, [1, 1], Res35149), 
LCon84855 = concatenate_layer([Res35149,[[[0.2269]]]], 2, Con84855), 
LPRe35230 = prelu_layer([[[[0.2361, 0.8516]]]], [[[0.9147, 0.6416]]], PRe35230), 
LRes53584 = reshape_layer(PRe35230, [1, 2], Res53584), 
LDot80898 = dot_layer(Con84855,Res53584, 1, 1, Dot80898), 
LSep26760 = separable_conv1D_layer(Dot80898, 1,[[[[0.1722], [0.292]]],[[[0.3732, 0.7095, 0.416, 0.9332], [0.9183, 0.9837, 0.2515, 0.6586]]]],[0, 0, 0, 0], 1, false, Sep26760), 
LFla14428 = flatten_layer(Sep26760, Fla14428), 
LMas98242 = masking_layer([[[[1.5542, 1.3682, 1.4407], [1.0992, 1.6634, 1.4644], [1.8805, 1.9155, 1.5472], [1.9714, 1.4571, 1.9414]], [[1.3366, 1.3176, 1.1264], [1.3859, 1.6517, 1.8071], [1.4212, 1.2612, 1.9971], [1.9191, 1.262, 1.672]]]], 2, Mas98242), 
LGlo28292 = global_max_pool2D_layer(Mas98242, Glo28292), 
LCon7704 = concatenate_layer([Glo28292,[[0.0465, 0.8157, 0.6647, 0.1922, 0.3224]]], 1, Con7704), 
LAdd57145 = add_layer([Fla14428,Con7704], Add57145), 
LMin91997 = minimum_layer([Con88498,Add57145], Min91997), 
LRes99027 = reshape_layer(Min91997, [8, 1], Res99027), 
LMax14722 = maximum_layer([[[[0.5737]]], [[[0.0496]]]], Max14722), 
LZer46836 = zero_padding1D_layer(Max14722, 7, 0, Zer46836), 
LSub884 = subtract_layer(Res99027,Zer46836, Sub884), 
exec_layers([LMul76704,LRes70487,LFla18746,LCon88498,LAve62643,LRes35149,LCon84855,LPRe35230,LRes53584,LDot80898,LSep26760,LFla14428,LMas98242,LGlo28292,LCon7704,LAdd57145,LMin91997,LRes99027,LMax14722,LZer46836,LSub884],["Mul76704","Res70487","Fla18746","Con88498","Ave62643","Res35149","Con84855","PRe35230","Res53584","Dot80898","Sep26760","Fla14428","Mas98242","Glo28292","Con7704","Add57145","Min91997","Res99027","Max14722","Zer46836","Sub884"],Sub884,"Sub884")

Actual (Unparsed): [[[0.1543512], [0.1820784], [0.7240000], [0.1337912], [0.8227000], [0.5853000], [0.2102279], [-0.4289000]]]

Expected (Unparsed): [[[0.15435116],[0.18207844],[0.724],[0.133791209467446],[0.8227],[0.5853],[0.210227856547888],[-0.42889999999999995]]]

Actual:   [[[0.1544], [0.1821], [0.724], [0.1338], [0.8227], [0.5853], [0.2103], [-0.4289]]]

Expected: [[[0.1544], [0.1821], [0.724], [0.1338], [0.8227], [0.5853], [0.2103], [-0.4288]]]