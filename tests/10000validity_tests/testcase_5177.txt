import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc39423 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Add94731 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add94731 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con59139 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con26879 = tf.keras.layers.Input(shape=([1, 2, 3]))
in0Con14551 = tf.keras.layers.Input(shape=([1, 2, 2]))

Loc39423 = keras.layers.LocallyConnected2D(3, (2, 1),strides=(1, 10), name = 'Loc39423', )(in0Loc39423)
Zer55853 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer55853', )(Loc39423)
Add94731 = keras.layers.Add(name = 'Add94731', )([in0Add94731,in1Add94731])
Con59139 = keras.layers.Concatenate(axis=3, name = 'Con59139', )([Add94731,in0Con59139])
Add12931 = keras.layers.Add(name = 'Add12931', )([Zer55853,Con59139])
Con70537 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 1), padding='valid', name = 'Con70537', )(Add12931)
Den12737 = keras.layers.Dense(1,name = 'Den12737', )(Con70537)
Con26879 = keras.layers.Concatenate(axis=3, name = 'Con26879', )([Den12737,in0Con26879])
Con14551 = keras.layers.Conv2D(4, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con14551', )(in0Con14551)
Zer72730 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer72730', )(Con14551)
Mul99747 = keras.layers.Multiply(name = 'Mul99747', )([Con26879,Zer72730])
model = tf.keras.models.Model(inputs=[in0Loc39423,in0Add94731,in1Add94731,in0Con59139,in0Con26879,in0Con14551], outputs=Mul99747)
w = model.get_layer('Loc39423').get_weights() 
w[0] = np.array([[[0.0946, 0.0409, 0.4286], [0.3194, 0.6763, 0.8738]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc39423').set_weights(w) 
w = model.get_layer('Con70537').get_weights() 
w[0] = np.array([[[[0.9959, 0.2616, 0.4388], [0.9321, 0.3351, 0.0712], [0.369, 0.671, 0.6362]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con70537').set_weights(w) 
w = model.get_layer('Den12737').get_weights() 
w[0] = np.array([[0.2819], [0.7133], [0.3669]])
w[1] = np.array([0.8965])
model.get_layer('Den12737').set_weights(w) 
w = model.get_layer('Con14551').get_weights() 
w[0] = np.array([[[[0.648, 0.6239, 0.482, 0.34], [0.882, 0.2375, 0.813, 0.5416]], [[0.3022, 0.0558, 0.3557, 0.2376], [0.3997, 0.1343, 0.8966, 0.4368]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con14551').set_weights(w) 
in0Loc39423 = tf.constant([[[[0.1186]], [[0.8603]]]])
in0Add94731 = tf.constant([[[[0.2637], [0.736]]]])
in1Add94731 = tf.constant([[[[0.6599], [0.0983]]]])
in0Con59139 = tf.constant([[[[0.4682, 0.8341], [0.2545, 0.9553]]]])
in0Con26879 = tf.constant([[[[0.8818, 0.2545, 0.1807], [0.8446, 0.7611, 0.8907]]]])
in0Con14551 = tf.constant([[[[0.5113, 0.3818], [0.5045, 0.8635]]]])
print (np.array2string(model.predict([in0Loc39423,in0Add94731,in1Add94731,in0Con59139,in0Con26879,in0Con14551],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul99747.png')

LLoc39423 = locally_connected2D_layer([[[[0.1186]], [[0.8603]]]], 2, 1,[[[0.0946, 0.0409, 0.4286], [0.3194, 0.6763, 0.8738]]],[[[0, 0, 0]]], 1, 10, Loc39423), 
LZer55853 = zero_padding2D_layer(Loc39423, 0, 0, 1, 0, Zer55853), 
LAdd94731 = add_layer([[[[[0.2637], [0.736]]]], [[[[0.6599], [0.0983]]]]], Add94731), 
LCon59139 = concatenate_layer([Add94731,[[[[0.4682, 0.8341], [0.2545, 0.9553]]]]], 3, Con59139), 
LAdd12931 = add_layer([Zer55853,Con59139], Add12931), 
LCon70537 = conv2D_transpose_layer(Add12931, 1, 1,[[[[0.9959, 0.2616, 0.4388], [0.9321, 0.3351, 0.0712], [0.369, 0.671, 0.6362]]]],[0, 0, 0], 1, 1, false, Con70537), 
LDen12737 = dense_layer(Con70537, [[0.2819], [0.7133], [0.3669]],[0.8965], Den12737), 
LCon26879 = concatenate_layer([Den12737,[[[[0.8818, 0.2545, 0.1807], [0.8446, 0.7611, 0.8907]]]]], 3, Con26879), 
LCon14551 = conv2D_layer([[[[0.5113, 0.3818], [0.5045, 0.8635]]]], 1, 2,[[[[0.648, 0.6239, 0.482, 0.34], [0.882, 0.2375, 0.813, 0.5416]], [[0.3022, 0.0558, 0.3557, 0.2376], [0.3997, 0.1343, 0.8966, 0.4368]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con14551), 
LZer72730 = zero_padding2D_layer(Con14551, 0, 0, 1, 0, Zer72730), 
LMul99747 = multiply_layer([Con26879,Zer72730], Mul99747), 
exec_layers([LLoc39423,LZer55853,LAdd94731,LCon59139,LAdd12931,LCon70537,LDen12737,LCon26879,LCon14551,LZer72730,LMul99747],["Loc39423","Zer55853","Add94731","Con59139","Add12931","Con70537","Den12737","Con26879","Con14551","Zer72730","Mul99747"],Mul99747,"Mul99747")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [3.8406134, 0.4677367, 1.1496528, 0.7817414]]]]

Expected (Unparsed): [[[[0.0,0.0,0.0,0.0],[3.8406134150097855,0.46773670971199993,1.149652776225,0.7817414528159999]]]]

Actual:   [[[[0, 0, 0, 0], [3.8407, 0.4678, 1.1497, 0.7818]]]]

Expected: [[[[0, 0, 0, 0], [3.8407, 0.4678, 1.1497, 0.7818]]]]