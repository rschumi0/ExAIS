import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min86320 = tf.keras.layers.Input(shape=([1, 1]))
in1Min86320 = tf.keras.layers.Input(shape=([1, 1]))
in0Max8841 = tf.keras.layers.Input(shape=([1, 1, 1]))

Min86320 = keras.layers.Minimum(name = 'Min86320', )([in0Min86320,in1Min86320])
Res33718 = keras.layers.Reshape((1, 1, 1), name = 'Res33718', )(Min86320)
Res84955 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res84955', )(Res33718)
Glo59021 = keras.layers.GlobalAveragePooling3D(name = 'Glo59021', )(Res84955)
Res17242 = keras.layers.Reshape((1, 1), name = 'Res17242', )(Glo59021)
Res57537 = keras.layers.Reshape((1, 1, 1), name = 'Res57537', )(Res17242)
Dep97290 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep97290', )(Res57537)
Res31351 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res31351', )(Dep97290)
Max8841 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(2, 1), padding='valid', name = 'Max8841', )(in0Max8841)
Res7324 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res7324', )(Max8841)
PRe34390 = keras.layers.PReLU(name = 'PRe34390', )(Res7324)
Ave35765 = keras.layers.Average(name = 'Ave35765', )([Res31351,PRe34390])
model = tf.keras.models.Model(inputs=[in0Min86320,in1Min86320,in0Max8841], outputs=Ave35765)
w = model.get_layer('Dep97290').get_weights() 
w[0] = np.array([[[[0.0371]]]])
w[1] = np.array([0])
model.get_layer('Dep97290').set_weights(w) 
w = model.get_layer('PRe34390').get_weights() 
w[0] = np.array([[[[0.8069]]]])
model.get_layer('PRe34390').set_weights(w) 
in0Min86320 = tf.constant([[[0.964]]])
in1Min86320 = tf.constant([[[0.6454]]])
in0Max8841 = tf.constant([[[[1.0719]]]])
print (np.array2string(model.predict([in0Min86320,in1Min86320,in0Max8841],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave35765.png')

LMin86320 = minimum_layer([[[[0.964]]], [[[0.6454]]]], Min86320), 
LRes33718 = reshape_layer(Min86320, [1, 1, 1], Res33718), 
LRes84955 = reshape_layer(Res33718, [1, 1, 1, 1], Res84955), 
LGlo59021 = global_average_pooling3D_layer(Res84955, Glo59021), 
LRes17242 = reshape_layer(Glo59021, [1, 1], Res17242), 
LRes57537 = reshape_layer(Res17242, [1, 1, 1], Res57537), 
LDep97290 = depthwise_conv2D_layer(Res57537, 1, 1,[[[[0.0371]]]],[0], 1, 1, false, Dep97290), 
LRes31351 = reshape_layer(Dep97290, [1, 1, 1, 1], Res31351), 
LMax8841 = max_pool2D_layer([[[[1.0719]]]], 1, 1, 2, 1, false, Max8841), 
LRes7324 = reshape_layer(Max8841, [1, 1, 1, 1], Res7324), 
LPRe34390 = prelu_layer(Res7324, [[[[0.8069]]]], PRe34390), 
LAve35765 = average_layer([Res31351,PRe34390], Ave35765), 
exec_layers([LMin86320,LRes33718,LRes84955,LGlo59021,LRes17242,LRes57537,LDep97290,LRes31351,LMax8841,LRes7324,LPRe34390,LAve35765],["Min86320","Res33718","Res84955","Glo59021","Res17242","Res57537","Dep97290","Res31351","Max8841","Res7324","PRe34390","Ave35765"],Ave35765,"Ave35765")

Actual (Unparsed): [[[[[0.5479222]]]]]

Expected (Unparsed): [[[[[0.54792217]]]]]

Actual:   [[[[[0.548]]]]]

Expected: [[[[[0.548]]]]]