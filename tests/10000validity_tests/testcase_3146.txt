import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max52433 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max52433 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max52433 = keras.layers.Maximum(name = 'Max52433', )([in0Max52433,in1Max52433])
Con55910 = keras.layers.Conv2D(3, (2, 2),strides=(2, 2), padding='same', dilation_rate=(1, 1), name = 'Con55910', )(Max52433)
Res74096 = keras.layers.Reshape((1, 3), name = 'Res74096', )(Con55910)
Sep18929 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep18929', )(Res74096)
model = tf.keras.models.Model(inputs=[in0Max52433,in1Max52433], outputs=Sep18929)
w = model.get_layer('Con55910').get_weights() 
w[0] = np.array([[[[0.7147, 0.642, 0.0584]], [[0.2357, 0.7504, 0.6805]]], [[[0.6725, 0.0267, 0.1732]], [[0.544, 0.057, 0.8556]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con55910').set_weights(w) 
w = model.get_layer('Sep18929').get_weights() 
w[0] = np.array([[[0.5726], [0.9293], [0.2224]]])
w[1] = np.array([[[0.6446, 0.8732, 0.7988], [0.7821, 0.251, 0.6419], [0.2872, 0.2028, 0.4679]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep18929').set_weights(w) 
in0Max52433 = tf.constant([[[[0.4329]], [[0.0347]]]])
in1Max52433 = tf.constant([[[[0.0438]], [[0.409]]]])
print (np.array2string(model.predict([in0Max52433,in1Max52433],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep18929.png')

LMax52433 = maximum_layer([[[[[0.4329]], [[0.0347]]]], [[[[0.0438]], [[0.409]]]]], Max52433), 
LCon55910 = conv2D_layer(Max52433, 2, 2,[[[[0.7147, 0.642, 0.0584]], [[0.2357, 0.7504, 0.6805]]], [[[0.6725, 0.0267, 0.1732]], [[0.544, 0.057, 0.8556]]]],[0, 0, 0], 2, 2, true, 1, 1, Con55910), 
LRes74096 = reshape_layer(Con55910, [1, 3], Res74096), 
LSep18929 = separable_conv1D_layer(Res74096, 1,[[[[0.5726], [0.9293], [0.2224]]],[[[0.6446, 0.8732, 0.7988], [0.7821, 0.251, 0.6419], [0.2872, 0.2028, 0.4679]]]],[0, 0, 0], 1, false, Sep18929), 
exec_layers([LMax52433,LCon55910,LRes74096,LSep18929],["Max52433","Con55910","Res74096","Sep18929"],Sep18929,"Sep18929")

Actual (Unparsed): [[[0.4317894, 0.3639287, 0.4496233]]]

Expected (Unparsed): [[[0.4317894197830326,0.3639286878548468,0.449623271220415]]]

Actual:   [[[0.4318, 0.364, 0.4497]]]

Expected: [[[0.4318, 0.364, 0.4497]]]