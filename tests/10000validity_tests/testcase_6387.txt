import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub3718 = tf.keras.layers.Input(shape=([2]))
in1Sub3718 = tf.keras.layers.Input(shape=([2]))
in0Mul64781 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul64781 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con64651 = tf.keras.layers.Input(shape=([2, 10]))
in0Zer26740 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con18704 = tf.keras.layers.Input(shape=([4, 4, 1]))
in0Up_10075 = tf.keras.layers.Input(shape=([2, 4, 3]))

Sub3718 = keras.layers.Subtract(name = 'Sub3718', )([in0Sub3718,in1Sub3718])
Res3100 = keras.layers.Reshape((2, 1), name = 'Res3100', )(Sub3718)
Res35907 = keras.layers.Reshape((2, 1, 1), name = 'Res35907', )(Res3100)
Zer37703 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer37703', )(Res35907)
Mul64781 = keras.layers.Multiply(name = 'Mul64781', )([in0Mul64781,in1Mul64781])
Add31689 = keras.layers.Add(name = 'Add31689', )([Zer37703,Mul64781])
Res7630 = keras.layers.Reshape((2, 2), name = 'Res7630', )(Add31689)
Con64651 = keras.layers.Concatenate(axis=2, name = 'Con64651', )([Res7630,in0Con64651])
Zer26740 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer26740', )(in0Zer26740)
Con18704 = keras.layers.Concatenate(axis=3, name = 'Con18704', )([Zer26740,in0Con18704])
Up_10075 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_10075', )(in0Up_10075)
Add55108 = keras.layers.Add(name = 'Add55108', )([Con18704,Up_10075])
Res6732 = keras.layers.Reshape((4, 12), name = 'Res6732', )(Add55108)
Dot32727 = keras.layers.Dot(axes=(2, 2), name = 'Dot32727', )([Con64651,Res6732])
model = tf.keras.models.Model(inputs=[in0Sub3718,in1Sub3718,in0Mul64781,in1Mul64781,in0Con64651,in0Zer26740,in0Con18704,in0Up_10075], outputs=Dot32727)
in0Sub3718 = tf.constant([[0.7502, 0.6554]])
in1Sub3718 = tf.constant([[0.167, 0.025]])
in0Mul64781 = tf.constant([[[[0.6652], [0.5672]], [[0.5604], [0.4568]]]])
in1Mul64781 = tf.constant([[[[0.2969], [0.0335]], [[0.7994], [0.7793]]]])
in0Con64651 = tf.constant([[[0.5663, 0.4629, 0.5794, 0.3139, 0.0662, 0.7902, 0.7459, 0.5134, 0.054, 0.9874], [0.6739, 0.4037, 0.7981, 0.6388, 0.7526, 0.2729, 0.2236, 0.8065, 0.9616, 0.0467]]])
in0Zer26740 = tf.constant([[[[1.817, 1.6145], [1.1116, 1.3554]], [[1.3665, 1.8412], [1.2345, 1.923]]]])
in0Con18704 = tf.constant([[[[0.5485], [0.0008], [0.9361], [0.7746]], [[0.2125], [0.8501], [0.0758], [0.7713]], [[0.3167], [0.0682], [0.7885], [0.3446]], [[0.9335], [0.7118], [0.4526], [0.3737]]]])
in0Up_10075 = tf.constant([[[[1.6903, 1.1702, 1.1192], [1.038, 1.5762, 1.0957], [1.7336, 1.2592, 1.9584], [1.3354, 1.0846, 1.3662]], [[1.0697, 1.5734, 1.2427], [1.2271, 1.0826, 1.5856], [1.8493, 1.5489, 1.2684], [1.7008, 1.3137, 1.6269]]]])
print (np.array2string(model.predict([in0Sub3718,in1Sub3718,in0Mul64781,in1Mul64781,in0Con64651,in0Zer26740,in0Con18704,in0Up_10075],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot32727.png')

LSub3718 = subtract_layer([[0.7502, 0.6554]], [[0.167, 0.025]], Sub3718), 
LRes3100 = reshape_layer(Sub3718, [2, 1], Res3100), 
LRes35907 = reshape_layer(Res3100, [2, 1, 1], Res35907), 
LZer37703 = zero_padding2D_layer(Res35907, 0, 0, 1, 0, Zer37703), 
LMul64781 = multiply_layer([[[[[0.6652], [0.5672]], [[0.5604], [0.4568]]]], [[[[0.2969], [0.0335]], [[0.7994], [0.7793]]]]], Mul64781), 
LAdd31689 = add_layer([Zer37703,Mul64781], Add31689), 
LRes7630 = reshape_layer(Add31689, [2, 2], Res7630), 
LCon64651 = concatenate_layer([Res7630,[[[0.5663, 0.4629, 0.5794, 0.3139, 0.0662, 0.7902, 0.7459, 0.5134, 0.054, 0.9874], [0.6739, 0.4037, 0.7981, 0.6388, 0.7526, 0.2729, 0.2236, 0.8065, 0.9616, 0.0467]]]], 2, Con64651), 
LZer26740 = zero_padding2D_layer([[[[1.817, 1.6145], [1.1116, 1.3554]], [[1.3665, 1.8412], [1.2345, 1.923]]]], 1, 1, 1, 1, Zer26740), 
LCon18704 = concatenate_layer([Zer26740,[[[[0.5485], [0.0008], [0.9361], [0.7746]], [[0.2125], [0.8501], [0.0758], [0.7713]], [[0.3167], [0.0682], [0.7885], [0.3446]], [[0.9335], [0.7118], [0.4526], [0.3737]]]]], 3, Con18704), 
LUp_10075 = up_sampling2D_layer([[[[1.6903, 1.1702, 1.1192], [1.038, 1.5762, 1.0957], [1.7336, 1.2592, 1.9584], [1.3354, 1.0846, 1.3662]], [[1.0697, 1.5734, 1.2427], [1.2271, 1.0826, 1.5856], [1.8493, 1.5489, 1.2684], [1.7008, 1.3137, 1.6269]]]], 2, 1, Up_10075), 
LAdd55108 = add_layer([Con18704,Up_10075], Add55108), 
LRes6732 = reshape_layer(Add55108, [4, 12], Res6732), 
LDot32727 = dot_layer(Con64651,Res6732, 2, 2, Dot32727), 
exec_layers([LSub3718,LRes3100,LRes35907,LZer37703,LMul64781,LAdd31689,LRes7630,LCon64651,LZer26740,LCon18704,LUp_10075,LAdd55108,LRes6732,LDot32727],["Sub3718","Res3100","Res35907","Zer37703","Mul64781","Add31689","Res7630","Con64651","Zer26740","Con18704","Up_10075","Add55108","Res6732","Dot32727"],Dot32727,"Dot32727")

Actual (Unparsed): [[[9.8476571, 12.2001750, 12.8282842, 9.8571669], [9.9282869, 13.2804064, 13.9743238, 11.2523795]]]

Expected (Unparsed): [[[9.847657240804,12.200175120804001,12.828284320316,9.857167100316],[9.928286897176,13.280406317175999,13.974323791287999,11.252379551287998]]]

Actual:   [[[9.8477, 12.2002, 12.8283, 9.8572], [9.9283, 13.2805, 13.9744, 11.2524]]]

Expected: [[[9.8477, 12.2002, 12.8283, 9.8572], [9.9283, 13.2805, 13.9744, 11.2524]]]