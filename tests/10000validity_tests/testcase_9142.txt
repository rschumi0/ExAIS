import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con40843 = tf.keras.layers.Input(shape=([1, 1]))
in0Con25854 = tf.keras.layers.Input(shape=([1, 3, 1]))
in0Ave79056 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave79056 = tf.keras.layers.Input(shape=([1, 1, 2]))

Con40843 = keras.layers.Conv1D(3, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con40843', )(in0Con40843)
Mas47287 = keras.layers.Masking(mask_value=1, name = 'Mas47287', )(Con40843)
Res70326 = keras.layers.Reshape((1, 3, 1), name = 'Res70326', )(Mas47287)
Con25854 = keras.layers.Concatenate(axis=3, name = 'Con25854', )([Res70326,in0Con25854])
Ave79056 = keras.layers.Average(name = 'Ave79056', )([in0Ave79056,in1Ave79056])
Zer84395 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer84395', )(Ave79056)
Add56002 = keras.layers.Add(name = 'Add56002', )([Con25854,Zer84395])
model = tf.keras.models.Model(inputs=[in0Con40843,in0Con25854,in0Ave79056,in1Ave79056], outputs=Add56002)
w = model.get_layer('Con40843').get_weights() 
w[0] = np.array([[[0.1056, 0.459, 0.9201]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con40843').set_weights(w) 
in0Con40843 = tf.constant([[[0.3621]]])
in0Con25854 = tf.constant([[[[0.0641], [0.4358], [0.5019]]]])
in0Ave79056 = tf.constant([[[[0.3889, 0.3723]]]])
in1Ave79056 = tf.constant([[[[0.2278, 0.2403]]]])
print (np.array2string(model.predict([in0Con40843,in0Con25854,in0Ave79056,in1Ave79056],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add56002.png')

LCon40843 = conv1D_layer([[[0.3621]]], 1,[[[0.1056, 0.459, 0.9201]]],[0, 0, 0], 1, true, 1, Con40843), 
LMas47287 = masking_layer(Con40843, 1, Mas47287), 
LRes70326 = reshape_layer(Mas47287, [1, 3, 1], Res70326), 
LCon25854 = concatenate_layer([Res70326,[[[[0.0641], [0.4358], [0.5019]]]]], 3, Con25854), 
LAve79056 = average_layer([[[[[0.3889, 0.3723]]]], [[[[0.2278, 0.2403]]]]], Ave79056), 
LZer84395 = zero_padding2D_layer(Ave79056, 0, 0, 2, 0, Zer84395), 
LAdd56002 = add_layer([Con25854,Zer84395], Add56002), 
exec_layers([LCon40843,LMas47287,LRes70326,LCon25854,LAve79056,LZer84395,LAdd56002],["Con40843","Mas47287","Res70326","Con25854","Ave79056","Zer84395","Add56002"],Add56002,"Add56002")

Actual (Unparsed): [[[[0.0382378, 0.0641000], [0.1662039, 0.4358000], [0.6415182, 0.8082000]]]]

Expected (Unparsed): [[[[0.038237759999999996,0.0641],[0.1662039,0.4358],[0.64151821,0.8082]]]]

Actual:   [[[[0.0383, 0.0641], [0.1663, 0.4358], [0.6416, 0.8082]]]]

Expected: [[[[0.0383, 0.0641], [0.1663, 0.4358], [0.6416, 0.8082]]]]