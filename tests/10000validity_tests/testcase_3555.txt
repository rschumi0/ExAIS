import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add79060 = tf.keras.layers.Input(shape=([1, 1]))
in1Add79060 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot92520 = tf.keras.layers.Input(shape=([2]))
in1Dot92520 = tf.keras.layers.Input(shape=([2]))
in0Sub2419 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))
in1Sub2419 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))

Add79060 = keras.layers.Add(name = 'Add79060', )([in0Add79060,in1Add79060])
Fla55283 = keras.layers.Flatten(name = 'Fla55283', )(Add79060)
Dot92520 = keras.layers.Dot(axes=(1, 1), name = 'Dot92520', )([in0Dot92520,in1Dot92520])
Add20536 = keras.layers.Add(name = 'Add20536', )([Fla55283,Dot92520])
Res83821 = keras.layers.Reshape((1, 1), name = 'Res83821', )(Add20536)
Up_34181 = keras.layers.UpSampling1D(size=(1), name = 'Up_34181', )(Res83821)
Sub2419 = keras.layers.Subtract(name = 'Sub2419', )([in0Sub2419,in1Sub2419])
Res17002 = keras.layers.Reshape((2, 3, 4), name = 'Res17002', )(Sub2419)
Res53558 = keras.layers.Reshape((2, 12), name = 'Res53558', )(Res17002)
LST13585 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST13585', )(Res53558)
Res5579 = keras.layers.Reshape((2, 1), name = 'Res5579', )(LST13585)
Loc43739 = keras.layers.LocallyConnected1D(2, (2),strides=(1), name = 'Loc43739', )(Res5579)
Dot32867 = keras.layers.Dot(axes=(1, 1), name = 'Dot32867', )([Up_34181,Loc43739])
model = tf.keras.models.Model(inputs=[in0Add79060,in1Add79060,in0Dot92520,in1Dot92520,in0Sub2419,in1Sub2419], outputs=Dot32867)
w = model.get_layer('LST13585').get_weights() 
w[0] = np.array([[3, 2, 8, 8, 7, 4, 5, 9], [9, 8, 7, 10, 10, 4, 3, 9], [7, 4, 7, 10, 8, 6, 2, 3], [3, 5, 9, 10, 7, 1, 4, 1], [7, 1, 5, 9, 6, 3, 9, 4], [10, 8, 2, 3, 5, 9, 10, 5], [4, 7, 7, 5, 4, 1, 4, 5], [10, 5, 10, 4, 8, 7, 9, 6], [2, 3, 9, 5, 7, 5, 4, 9], [10, 9, 4, 6, 4, 3, 6, 5], [5, 6, 7, 4, 8, 10, 10, 2], [4, 9, 9, 9, 10, 1, 4, 1]])
w[1] = np.array([[2, 5, 2, 9, 4, 3, 9, 4], [7, 6, 1, 9, 7, 2, 8, 1]])
w[2] = np.array([8, 6, 7, 5, 4, 8, 1, 2])
model.get_layer('LST13585').set_weights(w) 
w = model.get_layer('Loc43739').get_weights() 
w[0] = np.array([[[0.446, 0.4064], [0.0011, 0.3542]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc43739').set_weights(w) 
in0Add79060 = tf.constant([[[0.911]]])
in1Add79060 = tf.constant([[[0.9162]]])
in0Dot92520 = tf.constant([[0.2463, 0.4655]])
in1Dot92520 = tf.constant([[0.3854, 0.6031]])
in0Sub2419 = tf.constant([[[[[0.9902, 0.4884], [0.089, 0.0297]], [[0.958, 0.8478], [0.8793, 0.3555]], [[0.1865, 0.9793], [0.1194, 0.1424]]], [[[0.3095, 0.2814], [0.0602, 0.0983]], [[0.0769, 0.5184], [0.5671, 0.6804]], [[0.0668, 0.3328], [0.3531, 0.5173]]]]])
in1Sub2419 = tf.constant([[[[[0.0628, 0.5289], [0.3218, 0.1478]], [[0.7753, 0.7209], [0.844, 0.1459]], [[0.0694, 0.4002], [0.7893, 0.3053]]], [[[0.6277, 0.4688], [0.9203, 0.1893]], [[0.027, 0.8135], [0.8173, 0.0169]], [[0.5347, 0.5455], [0.8488, 0.5525]]]]])
print (np.array2string(model.predict([in0Add79060,in1Add79060,in0Dot92520,in1Dot92520,in0Sub2419,in1Sub2419],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot32867.png')

LAdd79060 = add_layer([[[[0.911]]], [[[0.9162]]]], Add79060), 
LFla55283 = flatten_layer(Add79060, Fla55283), 
LDot92520 = dot_layer([[0.2463, 0.4655]], [[0.3854, 0.6031]], 1, 1, Dot92520), 
LAdd20536 = add_layer([Fla55283,Dot92520], Add20536), 
LRes83821 = reshape_layer(Add20536, [1, 1], Res83821), 
LUp_34181 = up_sampling1D_layer(Res83821, 1, Up_34181), 
LSub2419 = subtract_layer([[[[[0.9902, 0.4884], [0.089, 0.0297]], [[0.958, 0.8478], [0.8793, 0.3555]], [[0.1865, 0.9793], [0.1194, 0.1424]]], [[[0.3095, 0.2814], [0.0602, 0.0983]], [[0.0769, 0.5184], [0.5671, 0.6804]], [[0.0668, 0.3328], [0.3531, 0.5173]]]]], [[[[[0.0628, 0.5289], [0.3218, 0.1478]], [[0.7753, 0.7209], [0.844, 0.1459]], [[0.0694, 0.4002], [0.7893, 0.3053]]], [[[0.6277, 0.4688], [0.9203, 0.1893]], [[0.027, 0.8135], [0.8173, 0.0169]], [[0.5347, 0.5455], [0.8488, 0.5525]]]]], Sub2419), 
LRes17002 = reshape_layer(Sub2419, [2, 3, 4], Res17002), 
LRes53558 = reshape_layer(Res17002, [2, 12], Res53558), 
LLST13585 = lstm_layer(Res53558,[[3, 2, 8, 8, 7, 4, 5, 9], [9, 8, 7, 10, 10, 4, 3, 9], [7, 4, 7, 10, 8, 6, 2, 3], [3, 5, 9, 10, 7, 1, 4, 1], [7, 1, 5, 9, 6, 3, 9, 4], [10, 8, 2, 3, 5, 9, 10, 5], [4, 7, 7, 5, 4, 1, 4, 5], [10, 5, 10, 4, 8, 7, 9, 6], [2, 3, 9, 5, 7, 5, 4, 9], [10, 9, 4, 6, 4, 3, 6, 5], [5, 6, 7, 4, 8, 10, 10, 2], [4, 9, 9, 9, 10, 1, 4, 1]],[[2, 5, 2, 9, 4, 3, 9, 4], [7, 6, 1, 9, 7, 2, 8, 1]],[8, 6, 7, 5, 4, 8, 1, 2], LST13585), 
LRes5579 = reshape_layer(LST13585, [2, 1], Res5579), 
LLoc43739 = locally_connected1D_layer(Res5579, 2,[[[0.446, 0.4064], [0.0011, 0.3542]]],[[0, 0]], 1, Loc43739), 
LDot32867 = dot_layer(Up_34181,Loc43739, 1, 1, Dot32867), 
exec_layers([LAdd79060,LFla55283,LDot92520,LAdd20536,LRes83821,LUp_34181,LSub2419,LRes17002,LRes53558,LLST13585,LRes5579,LLoc43739,LDot32867],["Add79060","Fla55283","Dot92520","Add20536","Res83821","Up_34181","Sub2419","Res17002","Res53558","LST13585","Res5579","Loc43739","Dot32867"],Dot32867,"Dot32867")

Actual (Unparsed): [[[-0.7168698, -0.6535272]]]

Expected (Unparsed): [[[-0.7168698328424973,-0.6535271577698397]]]

Actual:   [[[-0.7168, -0.6535]]]

Expected: [[[-0.7168, -0.6535]]]