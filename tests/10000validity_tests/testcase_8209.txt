import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add71515 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Add71515 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Add71515 = keras.layers.Add(name = 'Add71515', )([in0Add71515,in1Add71515])
Res33004 = keras.layers.Reshape((2, 2, 2), name = 'Res33004', )(Add71515)
PRe86994 = keras.layers.PReLU(name = 'PRe86994', )(Res33004)
model = tf.keras.models.Model(inputs=[in0Add71515,in1Add71515], outputs=PRe86994)
w = model.get_layer('PRe86994').get_weights() 
w[0] = np.array([[[0.6912, 0.5957], [0.7219, 0.7212]], [[0.7802, 0.1307], [0.3011, 0.0448]]])
model.get_layer('PRe86994').set_weights(w) 
in0Add71515 = tf.constant([[[[[0.5035], [0.3452]], [[0.1655], [0.9122]]], [[[0.6028], [0.4653]], [[0.7286], [0.236]]]]])
in1Add71515 = tf.constant([[[[[0.1591], [0.5367]], [[0.1568], [0.7015]]], [[[0.1445], [0.8078]], [[0.0335], [0.9958]]]]])
print (np.array2string(model.predict([in0Add71515,in1Add71515],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe86994.png')

LAdd71515 = add_layer([[[[[[0.5035], [0.3452]], [[0.1655], [0.9122]]], [[[0.6028], [0.4653]], [[0.7286], [0.236]]]]], [[[[[0.1591], [0.5367]], [[0.1568], [0.7015]]], [[[0.1445], [0.8078]], [[0.0335], [0.9958]]]]]], Add71515), 
LRes33004 = reshape_layer(Add71515, [2, 2, 2], Res33004), 
LPRe86994 = prelu_layer(Res33004, [[[0.6912, 0.5957], [0.7219, 0.7212]], [[0.7802, 0.1307], [0.3011, 0.0448]]], PRe86994), 
exec_layers([LAdd71515,LRes33004,LPRe86994],["Add71515","Res33004","PRe86994"],PRe86994,"PRe86994")

Actual (Unparsed): [[[[0.6626000, 0.8819000], [0.3223000, 1.6137000]], [[0.7473000, 1.2731000], [0.7621000, 1.2318000]]]]

Expected (Unparsed): [[[[0.6626,0.8818999999999999],[0.32230000000000003,1.6137000000000001]],[[0.7473,1.2731],[0.7621,1.2318]]]]

Actual:   [[[[0.6626, 0.8819], [0.3223, 1.6137]], [[0.7473, 1.2731], [0.7621, 1.2318]]]]

Expected: [[[[0.6626, 0.8819], [0.3224, 1.6138]], [[0.7473, 1.2731], [0.7621, 1.2318]]]]