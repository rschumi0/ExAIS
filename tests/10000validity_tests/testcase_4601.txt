import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul65062 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul65062 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Sub18003 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub18003 = tf.keras.layers.Input(shape=([2, 2, 2]))

Mul65062 = keras.layers.Multiply(name = 'Mul65062', )([in0Mul65062,in1Mul65062])
Res25247 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res25247', )(Mul65062)
Up_73649 = keras.layers.UpSampling3D(size=(2, 2, 2), name = 'Up_73649', )(Res25247)
ReL97483 = keras.layers.ReLU(max_value=1.135151059371675, negative_slope=7.52292319819752, threshold=2.1709080425834792, name = 'ReL97483', )(Up_73649)
Res84286 = keras.layers.Reshape((4, 2, 2), name = 'Res84286', )(ReL97483)
Sub18003 = keras.layers.Subtract(name = 'Sub18003', )([in0Sub18003,in1Sub18003])
Zer37468 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer37468', )(Sub18003)
Max32496 = keras.layers.Maximum(name = 'Max32496', )([Res84286,Zer37468])
model = tf.keras.models.Model(inputs=[in0Mul65062,in1Mul65062,in0Sub18003,in1Sub18003], outputs=Max32496)
in0Mul65062 = tf.constant([[[[0.275]], [[0.8296]]]])
in1Mul65062 = tf.constant([[[[0.4487]], [[0.4398]]]])
in0Sub18003 = tf.constant([[[[0.5228, 0.1136], [0.3865, 0.5417]], [[0.8571, 0.7375], [0.3184, 0.3876]]]])
in1Sub18003 = tf.constant([[[[0.6547, 0.8179], [0.6716, 0.0807]], [[0.1485, 0.1734], [0.8021, 0.8414]]]])
print (np.array2string(model.predict([in0Mul65062,in1Mul65062,in0Sub18003,in1Sub18003],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max32496.png')

LMul65062 = multiply_layer([[[[[0.275]], [[0.8296]]]], [[[[0.4487]], [[0.4398]]]]], Mul65062), 
LRes25247 = reshape_layer(Mul65062, [2, 1, 1, 1], Res25247), 
LUp_73649 = up_sampling3D_layer(Res25247, 2, 2, 2, Up_73649), 
LReL97483 = relu_layer(Up_73649, 1.135151059371675, 7.52292319819752, 2.1709080425834792, ReL97483), 
LRes84286 = reshape_layer(ReL97483, [4, 2, 2], Res84286), 
LSub18003 = subtract_layer([[[[0.5228, 0.1136], [0.3865, 0.5417]], [[0.8571, 0.7375], [0.3184, 0.3876]]]], [[[[0.6547, 0.8179], [0.6716, 0.0807]], [[0.1485, 0.1734], [0.8021, 0.8414]]]], Sub18003), 
LZer37468 = zero_padding2D_layer(Sub18003, 2, 0, 0, 0, Zer37468), 
LMax32496 = maximum_layer([Res84286,Zer37468], Max32496), 
exec_layers([LMul65062,LRes25247,LUp_73649,LReL97483,LRes84286,LSub18003,LZer37468,LMax32496],["Mul65062","Res25247","Up_73649","ReL97483","Res84286","Sub18003","Zer37468","Max32496"],Max32496,"Max32496")

Actual (Unparsed): [[[[0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[0.0000000, 0.0000000], [0.0000000, 0.0000000]], [[-0.1319000, -0.7043000], [-0.2851000, 0.4610000]], [[0.7086000, 0.5641000], [-0.4837000, -0.4538000]]]]

Expected (Unparsed): [[[[0,0],[0,0]],[[0,0],[0,0]],[[-0.1318999999999999,-0.7042999999999999],[-0.28509999999999996,0.46099999999999997]],[[0.7086,0.5641],[-0.4837,-0.45380000000000004]]]]

Actual:   [[[[0, 0], [0, 0]], [[0, 0], [0, 0]], [[-0.1319, -0.7043], [-0.2851, 0.461]], [[0.7086, 0.5641], [-0.4837, -0.4538]]]]

Expected: [[[[0, 0], [0, 0]], [[0, 0], [0, 0]], [[-0.1318, -0.7042], [-0.285, 0.461]], [[0.7086, 0.5641], [-0.4837, -0.4538]]]]