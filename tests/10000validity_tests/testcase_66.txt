import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min17715 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Min17715 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con4344 = tf.keras.layers.Input(shape=([1]))
in0Sub46836 = tf.keras.layers.Input(shape=([2]))
in1Sub46836 = tf.keras.layers.Input(shape=([2]))
in0Con59437 = tf.keras.layers.Input(shape=([2, 1]))
in0Sep33345 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Dot55676 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot55676 = tf.keras.layers.Input(shape=([2, 2]))
in0Con53174 = tf.keras.layers.Input(shape=([2, 1]))
in0Ave54577 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave54577 = tf.keras.layers.Input(shape=([1, 1]))

Min17715 = keras.layers.Minimum(name = 'Min17715', )([in0Min17715,in1Min17715])
Res95770 = keras.layers.Reshape((1, 1, 1), name = 'Res95770', )(Min17715)
Res24840 = keras.layers.Reshape((1, 1), name = 'Res24840', )(Res95770)
Fla63490 = keras.layers.Flatten(name = 'Fla63490', )(Res24840)
Con4344 = keras.layers.Concatenate(axis=1, name = 'Con4344', )([Fla63490,in0Con4344])
Sub46836 = keras.layers.Subtract(name = 'Sub46836', )([in0Sub46836,in1Sub46836])
Max3566 = keras.layers.Maximum(name = 'Max3566', )([Con4344,Sub46836])
Res10498 = keras.layers.Reshape((2, 1), name = 'Res10498', )(Max3566)
Con59437 = keras.layers.Concatenate(axis=2, name = 'Con59437', )([Res10498,in0Con59437])
Sep33345 = keras.layers.SeparableConv2D(2, (2, 1),strides=(2, 2), padding='same', name = 'Sep33345', )(in0Sep33345)
Res51711 = keras.layers.Reshape((1, 2), name = 'Res51711', )(Sep33345)
Cro75713 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro75713', )(Res51711)
Zer39965 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer39965', )(Cro75713)
Mul5647 = keras.layers.Multiply(name = 'Mul5647', )([Con59437,Zer39965])
Res78843 = keras.layers.Reshape((2, 2, 1), name = 'Res78843', )(Mul5647)
Dot55676 = keras.layers.Dot(axes=(1, 2), name = 'Dot55676', )([in0Dot55676,in1Dot55676])
Res12569 = keras.layers.Reshape((2, 2, 1), name = 'Res12569', )(Dot55676)
Up_65441 = keras.layers.UpSampling2D(size=(1, 1), name = 'Up_65441', )(Res12569)
Mul34852 = keras.layers.Multiply(name = 'Mul34852', )([Res78843,Up_65441])
Res28997 = keras.layers.Reshape((2, 2), name = 'Res28997', )(Mul34852)
Con53174 = keras.layers.Concatenate(axis=2, name = 'Con53174', )([Res28997,in0Con53174])
Ave54577 = keras.layers.Average(name = 'Ave54577', )([in0Ave54577,in1Ave54577])
Loc40402 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc40402', )(Ave54577)
Zer29943 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer29943', )(Loc40402)
Sub81216 = keras.layers.Subtract(name = 'Sub81216', )([Con53174,Zer29943])
model = tf.keras.models.Model(inputs=[in0Min17715,in1Min17715,in0Con4344,in0Sub46836,in1Sub46836,in0Con59437,in0Sep33345,in0Dot55676,in1Dot55676,in0Con53174,in0Ave54577,in1Ave54577], outputs=Sub81216)
w = model.get_layer('Sep33345').get_weights() 
w[0] = np.array([[[[0.9482]]], [[[0.8898]]]])
w[1] = np.array([[[[0.0001, 0.5022]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep33345').set_weights(w) 
w = model.get_layer('Loc40402').get_weights() 
w[0] = np.array([[[0.9899, 0.8773, 0.3121]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc40402').set_weights(w) 
in0Min17715 = tf.constant([[[[[0.4552]]]]])
in1Min17715 = tf.constant([[[[[0.3006]]]]])
in0Con4344 = tf.constant([[0.3635]])
in0Sub46836 = tf.constant([[0.6316, 0.8816]])
in1Sub46836 = tf.constant([[0.7454, 0.9501]])
in0Con59437 = tf.constant([[[0.4756], [0.1837]]])
in0Sep33345 = tf.constant([[[[0.5665]], [[0.352]]]])
in0Dot55676 = tf.constant([[[0.3188, 0.124], [0.0744, 0.9495]]])
in1Dot55676 = tf.constant([[[0.906, 0.6278], [0.3104, 0.9556]]])
in0Con53174 = tf.constant([[[0.8303], [0.1383]]])
in0Ave54577 = tf.constant([[[0.8111]]])
in1Ave54577 = tf.constant([[[0.4598]]])
print (np.array2string(model.predict([in0Min17715,in1Min17715,in0Con4344,in0Sub46836,in1Sub46836,in0Con59437,in0Sep33345,in0Dot55676,in1Dot55676,in0Con53174,in0Ave54577,in1Ave54577],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub81216.png')

LMin17715 = minimum_layer([[[[[[0.4552]]]]], [[[[[0.3006]]]]]], Min17715), 
LRes95770 = reshape_layer(Min17715, [1, 1, 1], Res95770), 
LRes24840 = reshape_layer(Res95770, [1, 1], Res24840), 
LFla63490 = flatten_layer(Res24840, Fla63490), 
LCon4344 = concatenate_layer([Fla63490,[[0.3635]]], 1, Con4344), 
LSub46836 = subtract_layer([[0.6316, 0.8816]], [[0.7454, 0.9501]], Sub46836), 
LMax3566 = maximum_layer([Con4344,Sub46836], Max3566), 
LRes10498 = reshape_layer(Max3566, [2, 1], Res10498), 
LCon59437 = concatenate_layer([Res10498,[[[0.4756], [0.1837]]]], 2, Con59437), 
LSep33345 = separable_conv2D_layer([[[[0.5665]], [[0.352]]]], 2, 1,[[[[[0.9482]]], [[[0.8898]]]],[[[[0.0001, 0.5022]]]]],[0, 0], 2, 2, true, Sep33345), 
LRes51711 = reshape_layer(Sep33345, [1, 2], Res51711), 
LCro75713 = cropping1D_layer(Res51711, 0, 0, Cro75713), 
LZer39965 = zero_padding1D_layer(Cro75713, 1, 0, Zer39965), 
LMul5647 = multiply_layer([Con59437,Zer39965], Mul5647), 
LRes78843 = reshape_layer(Mul5647, [2, 2, 1], Res78843), 
LDot55676 = dot_layer([[[0.3188, 0.124], [0.0744, 0.9495]]], [[[0.906, 0.6278], [0.3104, 0.9556]]], 1, 2, Dot55676), 
LRes12569 = reshape_layer(Dot55676, [2, 2, 1], Res12569), 
LUp_65441 = up_sampling2D_layer(Res12569, 1, 1, Up_65441), 
LMul34852 = multiply_layer([Res78843,Up_65441], Mul34852), 
LRes28997 = reshape_layer(Mul34852, [2, 2], Res28997), 
LCon53174 = concatenate_layer([Res28997,[[[0.8303], [0.1383]]]], 2, Con53174), 
LAve54577 = average_layer([[[[0.8111]]], [[[0.4598]]]], Ave54577), 
LLoc40402 = locally_connected1D_layer(Ave54577, 1,[[[0.9899, 0.8773, 0.3121]]],[[0, 0, 0]], 1, Loc40402), 
LZer29943 = zero_padding1D_layer(Loc40402, 1, 0, Zer29943), 
LSub81216 = subtract_layer(Con53174,Zer29943, Sub81216), 
exec_layers([LMin17715,LRes95770,LRes24840,LFla63490,LCon4344,LSub46836,LMax3566,LRes10498,LCon59437,LSep33345,LRes51711,LCro75713,LZer39965,LMul5647,LRes78843,LDot55676,LRes12569,LUp_65441,LMul34852,LRes28997,LCon53174,LAve54577,LLoc40402,LZer29943,LSub81216],["Min17715","Res95770","Res24840","Fla63490","Con4344","Sub46836","Max3566","Res10498","Con59437","Sep33345","Res51711","Cro75713","Zer39965","Mul5647","Res78843","Dot55676","Res12569","Up_65441","Mul34852","Res28997","Con53174","Ave54577","Loc40402","Zer29943","Sub81216"],Sub81216,"Sub81216")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.8303000], [-0.6290101, -0.4832801, -0.0600239]]]

Expected (Unparsed): [[[0.0,0.0,0.8303],[-0.6290100565751794,-0.48328008055784355,-0.060023944999999995]]]

Actual:   [[[0, 0, 0.8303], [-0.629, -0.4832, -0.06]]]

Expected: [[[0, 0, 0.8303], [-0.629, -0.4832, -0.06]]]