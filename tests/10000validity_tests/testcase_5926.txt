import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot71363 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot71363 = tf.keras.layers.Input(shape=([3, 3]))
in0Con58606 = tf.keras.layers.Input(shape=([3, 1]))
in0Add38103 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Add38103 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Dot71363 = keras.layers.Dot(axes=(2, 2), name = 'Dot71363', )([in0Dot71363,in1Dot71363])
Con58606 = keras.layers.Concatenate(axis=2, name = 'Con58606', )([Dot71363,in0Con58606])
Add38103 = keras.layers.Add(name = 'Add38103', )([in0Add38103,in1Add38103])
Res45879 = keras.layers.Reshape((2, 2, 2), name = 'Res45879', )(Add38103)
Res53310 = keras.layers.Reshape((2, 4), name = 'Res53310', )(Res45879)
Cro29752 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro29752', )(Res53310)
Zer40039 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer40039', )(Cro29752)
Mul42390 = keras.layers.Multiply(name = 'Mul42390', )([Con58606,Zer40039])
model = tf.keras.models.Model(inputs=[in0Dot71363,in1Dot71363,in0Con58606,in0Add38103,in1Add38103], outputs=Mul42390)
in0Dot71363 = tf.constant([[[0.6949, 0.0985, 0.2611], [0.1573, 0.7938, 0.0144], [0.9869, 0.9755, 0.9832]]])
in1Dot71363 = tf.constant([[[0.6765, 0.4653, 0.066], [0.6793, 0.6679, 0.6861], [0.8989, 0.6067, 0.5525]]])
in0Con58606 = tf.constant([[[0.5247], [0.7743], [0.5974]]])
in0Add38103 = tf.constant([[[[[0.1938, 0.9626]], [[0.7196, 0.2047]]], [[[0.4788, 0.0483]], [[0.566, 0.2728]]]]])
in1Add38103 = tf.constant([[[[[0.4707, 0.6362]], [[0.2429, 0.9152]]], [[[0.8963, 0.4181]], [[0.5454, 0.5349]]]]])
print (np.array2string(model.predict([in0Dot71363,in1Dot71363,in0Con58606,in0Add38103,in1Add38103],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul42390.png')

LDot71363 = dot_layer([[[0.6949, 0.0985, 0.2611], [0.1573, 0.7938, 0.0144], [0.9869, 0.9755, 0.9832]]], [[[0.6765, 0.4653, 0.066], [0.6793, 0.6679, 0.6861], [0.8989, 0.6067, 0.5525]]], 2, 2, Dot71363), 
LCon58606 = concatenate_layer([Dot71363,[[[0.5247], [0.7743], [0.5974]]]], 2, Con58606), 
LAdd38103 = add_layer([[[[[[0.1938, 0.9626]], [[0.7196, 0.2047]]], [[[0.4788, 0.0483]], [[0.566, 0.2728]]]]], [[[[[0.4707, 0.6362]], [[0.2429, 0.9152]]], [[[0.8963, 0.4181]], [[0.5454, 0.5349]]]]]], Add38103), 
LRes45879 = reshape_layer(Add38103, [2, 2, 2], Res45879), 
LRes53310 = reshape_layer(Res45879, [2, 4], Res53310), 
LCro29752 = cropping1D_layer(Res53310, 0, 1, Cro29752), 
LZer40039 = zero_padding1D_layer(Cro29752, 2, 0, Zer40039), 
LMul42390 = multiply_layer([Con58606,Zer40039], Mul42390), 
exec_layers([LDot71363,LCon58606,LAdd38103,LRes45879,LRes53310,LCro29752,LZer40039,LMul42390],["Dot71363","Con58606","Add38103","Res45879","Res53310","Cro29752","Zer40039","Mul42390"],Mul42390,"Mul42390")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.7883822, 3.1920221, 1.9463466, 0.6690283]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0],[0.7883822033999999,3.192022010632,1.94634657525,0.6690282599999999]]]

Actual:   [[[0, 0, 0, 0], [0, 0, 0, 0], [0.7884, 3.1921, 1.9464, 0.6691]]]

Expected: [[[0, 0, 0, 0], [0, 0, 0, 0], [0.7884, 3.1921, 1.9464, 0.6691]]]