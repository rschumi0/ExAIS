import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max85505 = tf.keras.layers.Input(shape=([1, 1]))
in1Max85505 = tf.keras.layers.Input(shape=([1, 1]))
in0Con21455 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul72475 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul72475 = tf.keras.layers.Input(shape=([2, 2]))

Max85505 = keras.layers.Maximum(name = 'Max85505', )([in0Max85505,in1Max85505])
Lay1705 = keras.layers.LayerNormalization(axis=1, epsilon=1.7435332612897119, name = 'Lay1705', )(Max85505)
Zer75138 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer75138', )(Lay1705)
Con21455 = keras.layers.Concatenate(axis=2, name = 'Con21455', )([Zer75138,in0Con21455])
Mul72475 = keras.layers.Multiply(name = 'Mul72475', )([in0Mul72475,in1Mul72475])
Mul31289 = keras.layers.Multiply(name = 'Mul31289', )([Con21455,Mul72475])
ReL39823 = keras.layers.ReLU(max_value=8.065548278548782, negative_slope=2.0298865462515088, threshold=8.025755111781883, name = 'ReL39823', )(Mul31289)
model = tf.keras.models.Model(inputs=[in0Max85505,in1Max85505,in0Con21455,in0Mul72475,in1Mul72475], outputs=ReL39823)
in0Max85505 = tf.constant([[[0.6924]]])
in1Max85505 = tf.constant([[[0.7311]]])
in0Con21455 = tf.constant([[[0.4185], [0.4611]]])
in0Mul72475 = tf.constant([[[0.0462, 0.7505], [0.9495, 0.662]]])
in1Mul72475 = tf.constant([[[0.0758, 0.0716], [0.9257, 0.9052]]])
print (np.array2string(model.predict([in0Max85505,in1Max85505,in0Con21455,in0Mul72475,in1Mul72475],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL39823.png')

LMax85505 = maximum_layer([[[[0.6924]]], [[[0.7311]]]], Max85505), 
LLay1705 = layer_normalization_layer(Max85505, 1, 1.7435332612897119, Lay1705), 
LZer75138 = zero_padding1D_layer(Lay1705, 1, 0, Zer75138), 
LCon21455 = concatenate_layer([Zer75138,[[[0.4185], [0.4611]]]], 2, Con21455), 
LMul72475 = multiply_layer([[[[0.0462, 0.7505], [0.9495, 0.662]]], [[[0.0758, 0.0716], [0.9257, 0.9052]]]], Mul72475), 
LMul31289 = multiply_layer([Con21455,Mul72475], Mul31289), 
LReL39823 = relu_layer(Mul31289, 8.065548278548782, 2.0298865462515088, 8.025755111781883, ReL39823), 
exec_layers([LMax85505,LLay1705,LZer75138,LCon21455,LMul72475,LMul31289,LReL39823],["Max85505","Lay1705","Zer75138","Con21455","Mul72475","Mul31289","ReL39823"],ReL39823,"ReL39823")

Actual (Unparsed): [[[-16.2913723, -16.2457234], [-16.2913723, -15.7304930]]]

Expected (Unparsed): [[[-16.29137232491532,-16.24572335874326],[-16.29137232491532,-15.730493011997451]]]

Actual:   [[[-16.2913, -16.2457], [-16.2913, -15.7304]]]

Expected: [[[-16.2913, -16.2457], [-16.2913, -15.7304]]]