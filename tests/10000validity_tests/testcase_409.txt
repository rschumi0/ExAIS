import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL29096 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Cro67401 = tf.keras.layers.Input(shape=([4, 2]))
in0Add26269 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Add26269 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

ReL29096 = keras.layers.ReLU(max_value=2.9976732111297926, negative_slope=5.658858197803159, threshold=6.121255340587231, name = 'ReL29096', input_shape=(2, 1, 2))(in0ReL29096)
Res19262 = keras.layers.Reshape((2, 2), name = 'Res19262', )(ReL29096)
Cro67401 = keras.layers.Cropping1D(cropping=((2, 0)), name = 'Cro67401', )(in0Cro67401)
Res74533 = keras.layers.Reshape((2, 2, 1), name = 'Res74533', )(Cro67401)
Res21701 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res21701', )(Res74533)
Con17184 = keras.layers.Conv3D(2, (1, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con17184', )(Res21701)
Res32883 = keras.layers.Reshape((2, 2, 2), name = 'Res32883', )(Con17184)
Res92943 = keras.layers.Reshape((2, 4), name = 'Res92943', )(Res32883)
Add26269 = keras.layers.Add(name = 'Add26269', )([in0Add26269,in1Add26269])
Res3898 = keras.layers.Reshape((2, 2, 2), name = 'Res3898', )(Add26269)
Res71750 = keras.layers.Reshape((2, 4), name = 'Res71750', )(Res3898)
Dot51468 = keras.layers.Dot(axes=(2, 2), name = 'Dot51468', )([Res92943,Res71750])
Ave41767 = keras.layers.Average(name = 'Ave41767', )([Res19262,Dot51468])
Sep77418 = keras.layers.SeparableConv1D(2, (2),strides=(1), padding='valid', name = 'Sep77418', )(Ave41767)
model = tf.keras.models.Model(inputs=[in0ReL29096,in0Cro67401,in0Add26269,in1Add26269], outputs=Sep77418)
w = model.get_layer('Con17184').get_weights() 
w[0] = np.array([[[[[0.811, 0.1409]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con17184').set_weights(w) 
w = model.get_layer('Sep77418').get_weights() 
w[0] = np.array([[[0.8328], [0.237]], [[0.189], [0.4654]]])
w[1] = np.array([[[0.4375, 0.0826], [0.4232, 0.2547]]])
w[2] = np.array([0, 0])
model.get_layer('Sep77418').set_weights(w) 
in0ReL29096 = tf.constant([[[[0.416, 0.3214]], [[0.0774, 0.2398]]]])
in0Cro67401 = tf.constant([[[1.1786, 1.0749], [1.725, 1.9894], [1.7634, 1.1199], [1.7063, 1.7778]]])
in0Add26269 = tf.constant([[[[[0.8799], [0.6064]], [[0.5596], [0.6672]]], [[[0.8973], [0.7728]], [[0.4706], [0.5866]]]]])
in1Add26269 = tf.constant([[[[[0.0233], [0.4913]], [[0.3845], [0.7956]]], [[[0.6532], [0.9439]], [[0.8803], [0.3543]]]]])
print (np.array2string(model.predict([in0ReL29096,in0Cro67401,in0Add26269,in1Add26269],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep77418.png')

LReL29096 = relu_layer([[[[0.416, 0.3214]], [[0.0774, 0.2398]]]], 2.9976732111297926, 5.658858197803159, 6.121255340587231, ReL29096), 
LRes19262 = reshape_layer(ReL29096, [2, 2], Res19262), 
LCro67401 = cropping1D_layer([[[1.1786, 1.0749], [1.725, 1.9894], [1.7634, 1.1199], [1.7063, 1.7778]]], 2, 0, Cro67401), 
LRes74533 = reshape_layer(Cro67401, [2, 2, 1], Res74533), 
LRes21701 = reshape_layer(Res74533, [2, 2, 1, 1], Res21701), 
LCon17184 = conv3D_layer(Res21701, 1, 1, 1,[[[[[0.811, 0.1409]]]]],[0, 0], 1, 1, 1, true, 1, 1, 1, Con17184), 
LRes32883 = reshape_layer(Con17184, [2, 2, 2], Res32883), 
LRes92943 = reshape_layer(Res32883, [2, 4], Res92943), 
LAdd26269 = add_layer([[[[[[0.8799], [0.6064]], [[0.5596], [0.6672]]], [[[0.8973], [0.7728]], [[0.4706], [0.5866]]]]], [[[[[0.0233], [0.4913]], [[0.3845], [0.7956]]], [[[0.6532], [0.9439]], [[0.8803], [0.3543]]]]]], Add26269), 
LRes3898 = reshape_layer(Add26269, [2, 2, 2], Res3898), 
LRes71750 = reshape_layer(Res3898, [2, 4], Res71750), 
LDot51468 = dot_layer(Res92943,Res71750, 2, 2, Dot51468), 
LAve41767 = average_layer([Res19262,Dot51468], Ave41767), 
LSep77418 = separable_conv1D_layer(Ave41767, 2,[[[[0.8328], [0.237]], [[0.189], [0.4654]]],[[[0.4375, 0.0826], [0.4232, 0.2547]]]],[0, 0], 1, false, Sep77418), 
exec_layers([LReL29096,LRes19262,LCro67401,LRes74533,LRes21701,LCon17184,LRes32883,LRes92943,LAdd26269,LRes3898,LRes71750,LDot51468,LAve41767,LSep77418],["ReL29096","Res19262","Cro67401","Res74533","Res21701","Con17184","Res32883","Res92943","Add26269","Res3898","Res71750","Dot51468","Ave41767","Sep77418"],Sep77418,"Sep77418")

Actual (Unparsed): [[[-10.9333012, -3.8217042]]]

Expected (Unparsed): [[[-10.93330113290979,-3.8217042166209776]]]

Actual:   [[[-10.9333, -3.8217]]]

Expected: [[[-10.9333, -3.8217]]]