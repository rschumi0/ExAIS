import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot23223 = tf.keras.layers.Input(shape=([2]))
in1Dot23223 = tf.keras.layers.Input(shape=([2]))
in0Con93206 = tf.keras.layers.Input(shape=([2, 2]))
in0Sep45026 = tf.keras.layers.Input(shape=([2, 1]))

Dot23223 = keras.layers.Dot(axes=(1, 1), name = 'Dot23223', )([in0Dot23223,in1Dot23223])
Fla50865 = keras.layers.Flatten(name = 'Fla50865', )(Dot23223)
Res97394 = keras.layers.Reshape((1, 1), name = 'Res97394', )(Fla50865)
Zer38567 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer38567', )(Res97394)
Con93206 = keras.layers.Concatenate(axis=2, name = 'Con93206', )([Zer38567,in0Con93206])
Sep45026 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='same', name = 'Sep45026', )(in0Sep45026)
Sub85200 = keras.layers.Subtract(name = 'Sub85200', )([Con93206,Sep45026])
Glo24906 = keras.layers.GlobalMaxPool1D(name = 'Glo24906', )(Sub85200)
model = tf.keras.models.Model(inputs=[in0Dot23223,in1Dot23223,in0Con93206,in0Sep45026], outputs=Glo24906)
w = model.get_layer('Sep45026').get_weights() 
w[0] = np.array([[[0.9232]]])
w[1] = np.array([[[0.046, 0.5722, 0.141]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep45026').set_weights(w) 
in0Dot23223 = tf.constant([[0.2408, 0.8396]])
in1Dot23223 = tf.constant([[0.1834, 0.7379]])
in0Con93206 = tf.constant([[[0.6043, 0.114], [0.1378, 0.2705]]])
in0Sep45026 = tf.constant([[[0.1036], [0.4823]]])
print (np.array2string(model.predict([in0Dot23223,in1Dot23223,in0Con93206,in0Sep45026],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo24906.png')

LDot23223 = dot_layer([[0.2408, 0.8396]], [[0.1834, 0.7379]], 1, 1, Dot23223), 
LFla50865 = flatten_layer(Dot23223, Fla50865), 
LRes97394 = reshape_layer(Fla50865, [1, 1], Res97394), 
LZer38567 = zero_padding1D_layer(Res97394, 1, 0, Zer38567), 
LCon93206 = concatenate_layer([Zer38567,[[[0.6043, 0.114], [0.1378, 0.2705]]]], 2, Con93206), 
LSep45026 = separable_conv1D_layer([[[0.1036], [0.4823]]], 1,[[[[0.9232]]],[[[0.046, 0.5722, 0.141]]]],[0, 0, 0], 1, true, Sep45026), 
LSub85200 = subtract_layer(Con93206,Sep45026, Sub85200), 
LGlo24906 = global_max_pool1D_layer(Sub85200, Glo24906), 
exec_layers([LDot23223,LFla50865,LRes97394,LZer38567,LCon93206,LSep45026,LSub85200,LGlo24906],["Dot23223","Fla50865","Res97394","Zer38567","Con93206","Sep45026","Sub85200","Glo24906"],Glo24906,"Glo24906")

Actual (Unparsed): [[0.6432217, 0.5495728, 0.2077184]]

Expected (Unparsed): [[0.6432216294399999,0.549572777856,0.20771843024000003]]

Actual:   [[0.6433, 0.5496, 0.2078]]

Expected: [[0.6433, 0.5496, 0.2078]]