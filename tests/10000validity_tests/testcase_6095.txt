import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave70872 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave70872 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Con8680 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Mul39412 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Mul39412 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Ave70872 = keras.layers.Average(name = 'Ave70872', )([in0Ave70872,in1Ave70872])
Lea52361 = keras.layers.LeakyReLU(alpha=0.590612297005653, name = 'Lea52361', )(Ave70872)
Zer96194 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer96194', )(Lea52361)
Con8680 = keras.layers.Concatenate(axis=4, name = 'Con8680', )([Zer96194,in0Con8680])
Mul39412 = keras.layers.Multiply(name = 'Mul39412', )([in0Mul39412,in1Mul39412])
Min66467 = keras.layers.Minimum(name = 'Min66467', )([Con8680,Mul39412])
Res9724 = keras.layers.Reshape((2, 2, 4), name = 'Res9724', )(Min66467)
Res55123 = keras.layers.Reshape((2, 8), name = 'Res55123', )(Res9724)
Max90713 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max90713', )(Res55123)
model = tf.keras.models.Model(inputs=[in0Ave70872,in1Ave70872,in0Con8680,in0Mul39412,in1Mul39412], outputs=Max90713)
in0Ave70872 = tf.constant([[[[[0.9251], [0.3857]]]]])
in1Ave70872 = tf.constant([[[[[0.4218], [0.6645]]]]])
in0Con8680 = tf.constant([[[[[0.6992], [0.5178]], [[0.1157], [0.9497]]], [[[0.0677], [0.911]], [[0.8977], [0.8889]]]]])
in0Mul39412 = tf.constant([[[[[0.3211, 0.5609], [0.1798, 0.0563]], [[0.1734, 0.5175], [0.1163, 0.4647]]], [[[0.818, 0.6875], [0.8979, 0.3153]], [[0.7893, 0.1888], [0.7284, 0.8276]]]]])
in1Mul39412 = tf.constant([[[[[0.8559, 0.1412], [0.5333, 0.157]], [[0.7968, 0.8006], [0.8374, 0.6845]]], [[[0.1053, 0.9553], [0.2938, 0.2055]], [[0.0788, 0.9315], [0.1735, 0.8746]]]]])
print (np.array2string(model.predict([in0Ave70872,in1Ave70872,in0Con8680,in0Mul39412,in1Mul39412],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max90713.png')

LAve70872 = average_layer([[[[[[0.9251], [0.3857]]]]], [[[[[0.4218], [0.6645]]]]]], Ave70872), 
LLea52361 = leaky_relu_layer(Ave70872, 0.590612297005653, Lea52361), 
LZer96194 = zero_padding3D_layer(Lea52361, 1, 0, 1, 0, 0, 0, Zer96194), 
LCon8680 = concatenate_layer([Zer96194,[[[[[0.6992], [0.5178]], [[0.1157], [0.9497]]], [[[0.0677], [0.911]], [[0.8977], [0.8889]]]]]], 4, Con8680), 
LMul39412 = multiply_layer([[[[[[0.3211, 0.5609], [0.1798, 0.0563]], [[0.1734, 0.5175], [0.1163, 0.4647]]], [[[0.818, 0.6875], [0.8979, 0.3153]], [[0.7893, 0.1888], [0.7284, 0.8276]]]]], [[[[[0.8559, 0.1412], [0.5333, 0.157]], [[0.7968, 0.8006], [0.8374, 0.6845]]], [[[0.1053, 0.9553], [0.2938, 0.2055]], [[0.0788, 0.9315], [0.1735, 0.8746]]]]]], Mul39412), 
LMin66467 = minimum_layer([Con8680,Mul39412], Min66467), 
LRes9724 = reshape_layer(Min66467, [2, 2, 4], Res9724), 
LRes55123 = reshape_layer(Res9724, [2, 8], Res55123), 
LMax90713 = max_pool1D_layer(Res55123, 2, Max90713), 
exec_layers([LAve70872,LLea52361,LZer96194,LCon8680,LMul39412,LMin66467,LRes9724,LRes55123,LMax90713],["Ave70872","Lea52361","Zer96194","Con8680","Mul39412","Min66467","Res9724","Res55123","Max90713"],Max90713,"Max90713")

Actual (Unparsed): [[[0.0000000, 0.0791991, 0.0000000, 0.0647941, 0.0621968, 0.1758672, 0.1263774, 0.7238190]]]

Expected (Unparsed): [[[0,0.07919907999999999,0,0.06479415,0.062196839999999996,0.1758672,0.1263774,0.72381896]]]

Actual:   [[[0, 0.0792, 0, 0.0648, 0.0622, 0.1759, 0.1264, 0.7239]]]

Expected: [[[0, 0.0792, 0, 0.0648, 0.0622, 0.1759, 0.1264, 0.7239]]]