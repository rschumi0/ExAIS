import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add4288 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add4288 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con20356 = tf.keras.layers.Input(shape=([2, 7]))
in0Sub58707 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Sub58707 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Dep29790 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con35502 = tf.keras.layers.Input(shape=([1, 2, 2]))

Add4288 = keras.layers.Add(name = 'Add4288', )([in0Add4288,in1Add4288])
ReL40032 = keras.layers.ReLU(max_value=9.826059835848099, negative_slope=3.9140126464904204, threshold=6.661392048373914, name = 'ReL40032', )(Add4288)
Res98022 = keras.layers.Reshape((2, 1), name = 'Res98022', )(ReL40032)
Con20356 = keras.layers.Concatenate(axis=2, name = 'Con20356', )([Res98022,in0Con20356])
Sub58707 = keras.layers.Subtract(name = 'Sub58707', )([in0Sub58707,in1Sub58707])
Res112 = keras.layers.Reshape((2, 2, 4), name = 'Res112', )(Sub58707)
Max51270 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max51270', )(Res112)
Dep29790 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep29790', )(in0Dep29790)
Zer2241 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer2241', )(Dep29790)
Con35502 = keras.layers.Concatenate(axis=3, name = 'Con35502', )([Zer2241,in0Con35502])
Sub84258 = keras.layers.Subtract(name = 'Sub84258', )([Max51270,Con35502])
Res48324 = keras.layers.Reshape((1, 8), name = 'Res48324', )(Sub84258)
Dot26538 = keras.layers.Dot(axes=(2, 2), name = 'Dot26538', )([Con20356,Res48324])
model = tf.keras.models.Model(inputs=[in0Add4288,in1Add4288,in0Con20356,in0Sub58707,in1Sub58707,in0Dep29790,in0Con35502], outputs=Dot26538)
w = model.get_layer('Dep29790').get_weights() 
w[0] = np.array([[[[0.357], [0.7903]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep29790').set_weights(w) 
in0Add4288 = tf.constant([[[[0.4612]], [[0.1567]]]])
in1Add4288 = tf.constant([[[[0.9811]], [[0.1461]]]])
in0Con20356 = tf.constant([[[0.0357, 0.1868, 0.3666, 0.2352, 0.3391, 0.6774, 0.7365], [0.6084, 0.3297, 0.1644, 0.5815, 0.7095, 0.257, 0.569]]])
in0Sub58707 = tf.constant([[[[[0.763, 0.9838], [0.2543, 0.574]], [[0.1584, 0.7083], [0.3671, 0.6803]]], [[[0.0554, 0.0578], [0.7285, 0.8023]], [[0.843, 0.738], [0.1425, 0.3318]]]]])
in1Sub58707 = tf.constant([[[[[0.0063, 0.5304], [0.8787, 0.3305]], [[0.4555, 0.048], [0.5185, 0.2569]]], [[[0.6221, 0.82], [0.8077, 0.7327]], [[0.9259, 0.9054], [0.3097, 0.9477]]]]])
in0Dep29790 = tf.constant([[[[0.5435, 0.2859]]]])
in0Con35502 = tf.constant([[[[0.9117, 0.3352], [0.2948, 0.4652]]]])
print (np.array2string(model.predict([in0Add4288,in1Add4288,in0Con20356,in0Sub58707,in1Sub58707,in0Dep29790,in0Con35502],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot26538.png')

LAdd4288 = add_layer([[[[[0.4612]], [[0.1567]]]], [[[[0.9811]], [[0.1461]]]]], Add4288), 
LReL40032 = relu_layer(Add4288, 9.826059835848099, 3.9140126464904204, 6.661392048373914, ReL40032), 
LRes98022 = reshape_layer(ReL40032, [2, 1], Res98022), 
LCon20356 = concatenate_layer([Res98022,[[[0.0357, 0.1868, 0.3666, 0.2352, 0.3391, 0.6774, 0.7365], [0.6084, 0.3297, 0.1644, 0.5815, 0.7095, 0.257, 0.569]]]], 2, Con20356), 
LSub58707 = subtract_layer([[[[[0.763, 0.9838], [0.2543, 0.574]], [[0.1584, 0.7083], [0.3671, 0.6803]]], [[[0.0554, 0.0578], [0.7285, 0.8023]], [[0.843, 0.738], [0.1425, 0.3318]]]]], [[[[[0.0063, 0.5304], [0.8787, 0.3305]], [[0.4555, 0.048], [0.5185, 0.2569]]], [[[0.6221, 0.82], [0.8077, 0.7327]], [[0.9259, 0.9054], [0.3097, 0.9477]]]]], Sub58707), 
LRes112 = reshape_layer(Sub58707, [2, 2, 4], Res112), 
LMax51270 = max_pool2D_layer(Res112, 2, 1, Max51270), 
LDep29790 = depthwise_conv2D_layer([[[[0.5435, 0.2859]]]], 1, 1,[[[[0.357], [0.7903]]]],[0, 0], 1, 1, true, Dep29790), 
LZer2241 = zero_padding2D_layer(Dep29790, 0, 0, 1, 0, Zer2241), 
LCon35502 = concatenate_layer([Zer2241,[[[[0.9117, 0.3352], [0.2948, 0.4652]]]]], 3, Con35502), 
LSub84258 = subtract_layer(Max51270,Con35502, Sub84258), 
LRes48324 = reshape_layer(Sub84258, [1, 8], Res48324), 
LDot26538 = dot_layer(Con20356,Res48324, 2, 2, Dot26538), 
exec_layers([LAdd4288,LReL40032,LRes98022,LCon20356,LSub58707,LRes112,LMax51270,LDep29790,LZer2241,LCon35502,LSub84258,LRes48324,LDot26538],["Add4288","ReL40032","Res98022","Con20356","Sub58707","Res112","Max51270","Dep29790","Zer2241","Con35502","Sub84258","Res48324","Dot26538"],Dot26538,"Dot26538")

Actual (Unparsed): [[[-15.9109764], [-18.8896997]]]

Expected (Unparsed): [[[-15.910976256786387],[-18.8896993909028]]]

Actual:   [[[-15.9109], [-18.8896]]]

Expected: [[[-15.9109], [-18.8896]]]