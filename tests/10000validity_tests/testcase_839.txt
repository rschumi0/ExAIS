import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot61856 = tf.keras.layers.Input(shape=([3]))
in1Dot61856 = tf.keras.layers.Input(shape=([3]))

Dot61856 = keras.layers.Dot(axes=(1, 1), name = 'Dot61856', )([in0Dot61856,in1Dot61856])
Res6513 = keras.layers.Reshape((1, 1), name = 'Res6513', )(Dot61856)
Res67235 = keras.layers.Reshape((1, 1, 1), name = 'Res67235', )(Res6513)
Res919 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res919', )(Res67235)
Con69460 = keras.layers.Conv3DTranspose(3, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con69460', )(Res919)
Res42043 = keras.layers.Reshape((1, 1, 3), name = 'Res42043', )(Con69460)
Res14066 = keras.layers.Reshape((1, 3), name = 'Res14066', )(Res42043)
Con19869 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con19869', )(Res14066)
GRU21239 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU21239', )(Con19869)
model = tf.keras.models.Model(inputs=[in0Dot61856,in1Dot61856], outputs=GRU21239)
w = model.get_layer('Con69460').get_weights() 
w[0] = np.array([[[[[0.5032], [0.6032], [0.4492]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con69460').set_weights(w) 
w = model.get_layer('Con19869').get_weights() 
w[0] = np.array([[[0.5262, 0.0443, 0.7339, 0.9557], [0.6027, 0.9489, 0.6934, 0.5505], [0.1777, 0.3522, 0.9324, 0.5935]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con19869').set_weights(w) 
w = model.get_layer('GRU21239').get_weights() 
w[0] = np.array([[3, 1, 2, 5, 2, 2], [9, 1, 2, 3, 10, 3], [2, 5, 8, 7, 8, 9], [4, 7, 1, 6, 5, 7]])
w[1] = np.array([[3, 10, 1, 6, 10, 9], [9, 10, 4, 10, 6, 2]])
w[2] = np.array([[4, 6, 9, 1, 8, 7], [1, 2, 2, 6, 9, 4]])
model.get_layer('GRU21239').set_weights(w) 
in0Dot61856 = tf.constant([[0.5443, 0.3605, 0.5616]])
in1Dot61856 = tf.constant([[0.4521, 0.9792, 0.9781]])
print (np.array2string(model.predict([in0Dot61856,in1Dot61856],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU21239.png')

LDot61856 = dot_layer([[0.5443, 0.3605, 0.5616]], [[0.4521, 0.9792, 0.9781]], 1, 1, Dot61856), 
LRes6513 = reshape_layer(Dot61856, [1, 1], Res6513), 
LRes67235 = reshape_layer(Res6513, [1, 1, 1], Res67235), 
LRes919 = reshape_layer(Res67235, [1, 1, 1, 1], Res919), 
LCon69460 = conv3D_transpose_layer(Res919, 1, 1, 1,[[[[[0.5032], [0.6032], [0.4492]]]]],[0, 0, 0], 1, 1, 1, false, Con69460), 
LRes42043 = reshape_layer(Con69460, [1, 1, 3], Res42043), 
LRes14066 = reshape_layer(Res42043, [1, 3], Res14066), 
LCon19869 = conv1D_layer(Res14066, 1,[[[0.5262, 0.0443, 0.7339, 0.9557], [0.6027, 0.9489, 0.6934, 0.5505], [0.1777, 0.3522, 0.9324, 0.5935]]],[0, 0, 0, 0], 1, true, 1, Con19869), 
LGRU21239 = gru_layer(Con19869,[[3, 1, 2, 5, 2, 2], [9, 1, 2, 3, 10, 3], [2, 5, 8, 7, 8, 9], [4, 7, 1, 6, 5, 7]],[[3, 10, 1, 6, 10, 9], [9, 10, 4, 10, 6, 2]],[[4, 6, 9, 1, 8, 7], [1, 2, 2, 6, 9, 4]], true, GRU21239), 
exec_layers([LDot61856,LRes6513,LRes67235,LRes919,LCon69460,LRes42043,LRes14066,LCon19869,LGRU21239],["Dot61856","Res6513","Res67235","Res919","Con69460","Res42043","Res14066","Con19869","GRU21239"],GRU21239,"GRU21239")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[1.0779221959467122e-10,1.04638520070921e-11]]

Actual:   [[0, 0]]

Expected: [[0, 0]]