import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub25109 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub25109 = tf.keras.layers.Input(shape=([2, 2]))
in0Min79413 = tf.keras.layers.Input(shape=([2, 2]))
in1Min79413 = tf.keras.layers.Input(shape=([2, 2]))

Sub25109 = keras.layers.Subtract(name = 'Sub25109', )([in0Sub25109,in1Sub25109])
Min79413 = keras.layers.Minimum(name = 'Min79413', )([in0Min79413,in1Min79413])
Dot33620 = keras.layers.Dot(axes=(1, 1), name = 'Dot33620', )([Sub25109,Min79413])
Res42013 = keras.layers.Reshape((2, 2, 1), name = 'Res42013', )(Dot33620)
Zer75545 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer75545', )(Res42013)
model = tf.keras.models.Model(inputs=[in0Sub25109,in1Sub25109,in0Min79413,in1Min79413], outputs=Zer75545)
in0Sub25109 = tf.constant([[[0.0044, 0.3836], [0.6672, 0.243]]])
in1Sub25109 = tf.constant([[[0.9863, 0.4249], [0.947, 0.8874]]])
in0Min79413 = tf.constant([[[0.0396, 0.1703], [0.5443, 0.9694]]])
in1Min79413 = tf.constant([[[0.4071, 0.5326], [0.0968, 0.1873]]])
print (np.array2string(model.predict([in0Sub25109,in1Sub25109,in0Min79413,in1Min79413],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer75545.png')

LSub25109 = subtract_layer([[[0.0044, 0.3836], [0.6672, 0.243]]], [[[0.9863, 0.4249], [0.947, 0.8874]]], Sub25109), 
LMin79413 = minimum_layer([[[[0.0396, 0.1703], [0.5443, 0.9694]]], [[[0.4071, 0.5326], [0.0968, 0.1873]]]], Min79413), 
LDot33620 = dot_layer(Sub25109,Min79413, 1, 1, Dot33620), 
LRes42013 = reshape_layer(Dot33620, [2, 2, 1], Res42013), 
LZer75545 = zero_padding2D_layer(Res42013, 1, 1, 1, 1, Zer75545), 
exec_layers([LSub25109,LMin79413,LDot33620,LRes42013,LZer75545],["Sub25109","Min79413","Dot33620","Res42013","Zer75545"],Zer75545,"Zer75545")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.0659679], [-0.2196241], [0.0000000]], [[0.0000000], [-0.0640134], [-0.1277295], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[-0.06596788],[-0.21962410999999998],[0]],[[0],[-0.0640134],[-0.12772951],[0]],[[0],[0],[0],[0]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [-0.0659], [-0.2196], [0]], [[0], [-0.064], [-0.1277], [0]], [[0], [0], [0], [0]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [-0.0659], [-0.2196], [0]], [[0], [-0.064], [-0.1277], [0]], [[0], [0], [0], [0]]]]