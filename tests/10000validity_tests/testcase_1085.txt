import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL10421 = tf.keras.layers.Input(shape=([2, 2]))

ReL10421 = keras.layers.ReLU(max_value=8.101740480796908, negative_slope=5.2472184570731075, threshold=1.6901609497878123, name = 'ReL10421', input_shape=(2, 2))(in0ReL10421)
Con78812 = keras.layers.Conv1D(4, (1),strides=(1), padding='same', dilation_rate=(1), name = 'Con78812', )(ReL10421)
model = tf.keras.models.Model(inputs=[in0ReL10421], outputs=Con78812)
w = model.get_layer('Con78812').get_weights() 
w[0] = np.array([[[0.7826, 0.334, 0.5319, 0.8667], [0.8938, 0.2311, 0.3848, 0.7429]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con78812').set_weights(w) 
in0ReL10421 = tf.constant([[[0.5438, 0.8115], [0.4552, 0.5869]]])
print (np.array2string(model.predict([in0ReL10421],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con78812.png')

LReL10421 = relu_layer([[[0.5438, 0.8115], [0.4552, 0.5869]]], 8.101740480796908, 5.2472184570731075, 1.6901609497878123, ReL10421), 
LCon78812 = conv1D_layer(ReL10421, 1,[[[0.7826, 0.334, 0.5319, 0.8667], [0.8938, 0.2311, 0.3848, 0.7429]]],[0, 0, 0, 0], 1, true, 1, Con78812), 
exec_layers([LReL10421,LCon78812],["ReL10421","Con78812"],Con78812,"Con78812")

Actual (Unparsed): [[[-8.8283885, -3.0745715, -4.9736186, -8.6385390], [-10.2455881, -3.5022065, -5.6743974, -9.9169975]]]

Expected (Unparsed): [[[-8.828388574142922,-3.0745714634137906,-4.9736186359632475,-8.638539060505366],[-10.245587978785016,-3.5022064397303674,-5.674397359174027,-9.916997391590204]]]

Actual:   [[[-8.8283, -3.0745, -4.9736, -8.6385], [-10.2455, -3.5022, -5.6743, -9.9169]]]

Expected: [[[-8.8283, -3.0745, -4.9736, -8.6385], [-10.2455, -3.5022, -5.6743, -9.9169]]]