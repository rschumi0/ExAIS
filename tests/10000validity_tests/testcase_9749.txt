import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof20448 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot23628 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot23628 = tf.keras.layers.Input(shape=([2, 3]))

Sof20448 = keras.layers.Softmax(axis=1, name = 'Sof20448', input_shape=(1, 1))(in0Sof20448)
GRU11256 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU11256', )(Sof20448)
Res88661 = keras.layers.Reshape((1, 1), name = 'Res88661', )(GRU11256)
Dot23628 = keras.layers.Dot(axes=(1, 1), name = 'Dot23628', )([in0Dot23628,in1Dot23628])
Res11672 = keras.layers.Reshape((3, 3, 1), name = 'Res11672', )(Dot23628)
Dep62438 = keras.layers.DepthwiseConv2D((3, 3),strides=(1, 1), padding='valid', name = 'Dep62438', )(Res11672)
Res32070 = keras.layers.Reshape((1, 1), name = 'Res32070', )(Dep62438)
Min31264 = keras.layers.Minimum(name = 'Min31264', )([Res88661,Res32070])
model = tf.keras.models.Model(inputs=[in0Sof20448,in0Dot23628,in1Dot23628], outputs=Min31264)
w = model.get_layer('GRU11256').get_weights() 
w[0] = np.array([[4, 6, 2]])
w[1] = np.array([[8, 5, 8]])
w[2] = np.array([[1, 7, 5], [4, 5, 2]])
model.get_layer('GRU11256').set_weights(w) 
w = model.get_layer('Dep62438').get_weights() 
w[0] = np.array([[[[0.0744]], [[0.0992]], [[0.595]]], [[[0.3179]], [[0.5524]], [[0.6246]]], [[[0.2938]], [[0.8992]], [[0.2844]]]])
w[1] = np.array([0])
model.get_layer('Dep62438').set_weights(w) 
in0Sof20448 = tf.constant([[[0.9495]]])
in0Dot23628 = tf.constant([[[0.8163, 0.9698, 0.8982], [0.1043, 0.4292, 0.6538]]])
in1Dot23628 = tf.constant([[[0.4094, 0.0906, 0.0721], [0.2663, 0.2974, 0.9684]]])
print (np.array2string(model.predict([in0Sof20448,in0Dot23628,in1Dot23628],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min31264.png')

LSof20448 = softmax_layer([[[0.9495]]], 1, Sof20448), 
LGRU11256 = gru_layer(Sof20448,[[4, 6, 2]],[[8, 5, 8]],[[1, 7, 5], [4, 5, 2]], true, GRU11256), 
LRes88661 = reshape_layer(GRU11256, [1, 1], Res88661), 
LDot23628 = dot_layer([[[0.8163, 0.9698, 0.8982], [0.1043, 0.4292, 0.6538]]], [[[0.4094, 0.0906, 0.0721], [0.2663, 0.2974, 0.9684]]], 1, 1, Dot23628), 
LRes11672 = reshape_layer(Dot23628, [3, 3, 1], Res11672), 
LDep62438 = depthwise_conv2D_layer(Res11672, 3, 3,[[[[0.0744]], [[0.0992]], [[0.595]]], [[[0.3179]], [[0.5524]], [[0.6246]]], [[[0.2938]], [[0.8992]], [[0.2844]]]],[0], 1, 1, false, Dep62438), 
LRes32070 = reshape_layer(Dep62438, [1, 1], Res32070), 
LMin31264 = minimum_layer([Res88661,Res32070], Min31264), 
exec_layers([LSof20448,LGRU11256,LRes88661,LDot23628,LRes11672,LDep62438,LRes32070,LMin31264],["Sof20448","GRU11256","Res88661","Dot23628","Res11672","Dep62438","Res32070","Min31264"],Min31264,"Min31264")

Actual (Unparsed): [[[0.0001234]]]

Expected (Unparsed): [[[0.00012339457222771937]]]

Actual:   [[[0.0002]]]

Expected: [[[0.0002]]]