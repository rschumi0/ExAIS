import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max8341 = tf.keras.layers.Input(shape=([2, 1]))
in1Max8341 = tf.keras.layers.Input(shape=([2, 1]))

Max8341 = keras.layers.Maximum(name = 'Max8341', )([in0Max8341,in1Max8341])
ReL85381 = keras.layers.ReLU(max_value=5.244096130436516, negative_slope=8.200947213559575, threshold=2.235042577632055, name = 'ReL85381', )(Max8341)
Fla19729 = keras.layers.Flatten(name = 'Fla19729', )(ReL85381)
Res35672 = keras.layers.Reshape((2, 1), name = 'Res35672', )(Fla19729)
Res66349 = keras.layers.Reshape((2, 1, 1), name = 'Res66349', )(Res35672)
Dep74091 = keras.layers.DepthwiseConv2D((2, 1),strides=(2, 2), padding='same', name = 'Dep74091', )(Res66349)
model = tf.keras.models.Model(inputs=[in0Max8341,in1Max8341], outputs=Dep74091)
w = model.get_layer('Dep74091').get_weights() 
w[0] = np.array([[[[0.3906]]], [[[0.378]]]])
w[1] = np.array([0])
model.get_layer('Dep74091').set_weights(w) 
in0Max8341 = tf.constant([[[0.1831], [0.0584]]])
in1Max8341 = tf.constant([[[0.1425], [0.7814]]])
print (np.array2string(model.predict([in0Max8341,in1Max8341],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep74091.png')

LMax8341 = maximum_layer([[[[0.1831], [0.0584]]], [[[0.1425], [0.7814]]]], Max8341), 
LReL85381 = relu_layer(Max8341, 5.244096130436516, 8.200947213559575, 2.235042577632055, ReL85381), 
LFla19729 = flatten_layer(ReL85381, Fla19729), 
LRes35672 = reshape_layer(Fla19729, [2, 1], Res35672), 
LRes66349 = reshape_layer(Res35672, [2, 1, 1], Res66349), 
LDep74091 = depthwise_conv2D_layer(Res66349, 2, 1,[[[[0.3906]]], [[[0.378]]]],[0], 2, 2, true, Dep74091), 
exec_layers([LMax8341,LReL85381,LFla19729,LRes35672,LRes66349,LDep74091],["Max8341","ReL85381","Fla19729","Res35672","Res66349","Dep74091"],Dep74091,"Dep74091")

Actual (Unparsed): [[[[-11.0791980]]]]

Expected (Unparsed): [[[[-11.079198107374147]]]]

Actual:   [[[[-11.0791]]]]

Expected: [[[[-11.0791]]]]