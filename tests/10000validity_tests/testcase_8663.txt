import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul80157 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul80157 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con10125 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Sep5537 = tf.keras.layers.Input(shape=([2, 1, 1]))

Mul80157 = keras.layers.Multiply(name = 'Mul80157', )([in0Mul80157,in1Mul80157])
Con10125 = keras.layers.Concatenate(axis=3, name = 'Con10125', )([Mul80157,in0Con10125])
Sep5537 = keras.layers.SeparableConv2D(2, (2, 1),strides=(1, 1), padding='valid', name = 'Sep5537', )(in0Sep5537)
Zer17487 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer17487', )(Sep5537)
Ave56344 = keras.layers.Average(name = 'Ave56344', )([Con10125,Zer17487])
Res24417 = keras.layers.Reshape((2, 1, 2, 1), name = 'Res24417', )(Ave56344)
PRe18440 = keras.layers.PReLU(name = 'PRe18440', )(Res24417)
model = tf.keras.models.Model(inputs=[in0Mul80157,in1Mul80157,in0Con10125,in0Sep5537], outputs=PRe18440)
w = model.get_layer('Sep5537').get_weights() 
w[0] = np.array([[[[0.9183]]], [[[0.2209]]]])
w[1] = np.array([[[[0.4878, 0.0874]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep5537').set_weights(w) 
w = model.get_layer('PRe18440').get_weights() 
w[0] = np.array([[[[0.5885], [0.1322]]], [[[0.7496], [0.4506]]]])
model.get_layer('PRe18440').set_weights(w) 
in0Mul80157 = tf.constant([[[[0.7894]], [[0.9053]]]])
in1Mul80157 = tf.constant([[[[0.5309]], [[0.3219]]]])
in0Con10125 = tf.constant([[[[0.1928]], [[0.3991]]]])
in0Sep5537 = tf.constant([[[[0.5898]], [[0.5778]]]])
print (np.array2string(model.predict([in0Mul80157,in1Mul80157,in0Con10125,in0Sep5537],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe18440.png')

LMul80157 = multiply_layer([[[[[0.7894]], [[0.9053]]]], [[[[0.5309]], [[0.3219]]]]], Mul80157), 
LCon10125 = concatenate_layer([Mul80157,[[[[0.1928]], [[0.3991]]]]], 3, Con10125), 
LSep5537 = separable_conv2D_layer([[[[0.5898]], [[0.5778]]]], 2, 1,[[[[[0.9183]]], [[[0.2209]]]],[[[[0.4878, 0.0874]]]]],[0, 0], 1, 1, false, Sep5537), 
LZer17487 = zero_padding2D_layer(Sep5537, 1, 0, 0, 0, Zer17487), 
LAve56344 = average_layer([Con10125,Zer17487], Ave56344), 
LRes24417 = reshape_layer(Ave56344, [2, 1, 2, 1], Res24417), 
LPRe18440 = prelu_layer(Res24417, [[[[0.5885], [0.1322]]], [[[0.7496], [0.4506]]]], PRe18440), 
exec_layers([LMul80157,LCon10125,LSep5537,LZer17487,LAve56344,LRes24417,LPRe18440],["Mul80157","Con10125","Sep5537","Zer17487","Ave56344","Res24417","PRe18440"],PRe18440,"PRe18440")

Actual (Unparsed): [[[[[0.2095462], [0.0964000]]], [[[0.3089380], [0.2287962]]]]]

Expected (Unparsed): [[[[[0.20954623],[0.0964]]],[[[0.30893795390400003],[0.228796197032]]]]]

Actual:   [[[[[0.2096], [0.0964]]], [[[0.309], [0.2288]]]]]

Expected: [[[[[0.2096], [0.0964]]], [[[0.309], [0.2288]]]]]