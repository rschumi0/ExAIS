import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min23363 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Min23363 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Fla45208 = tf.keras.layers.Input(shape=([1, 3]))

Min23363 = keras.layers.Minimum(name = 'Min23363', )([in0Min23363,in1Min23363])
Con99849 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con99849', )(Min23363)
Zer97946 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer97946', )(Con99849)
Fla45208 = keras.layers.Flatten(name = 'Fla45208', )(in0Fla45208)
Res76413 = keras.layers.Reshape((3, 1), name = 'Res76413', )(Fla45208)
Res92807 = keras.layers.Reshape((3, 1, 1), name = 'Res92807', )(Res76413)
Sep710 = keras.layers.SeparableConv2D(4, (2, 1),strides=(1, 1), padding='valid', name = 'Sep710', )(Res92807)
Zer61907 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer61907', )(Sep710)
Max87766 = keras.layers.Maximum(name = 'Max87766', )([Zer97946,Zer61907])
model = tf.keras.models.Model(inputs=[in0Min23363,in1Min23363,in0Fla45208], outputs=Max87766)
w = model.get_layer('Con99849').get_weights() 
w[0] = np.array([[[[0.7204, 0.5982, 0.175, 0.4527]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con99849').set_weights(w) 
w = model.get_layer('Sep710').get_weights() 
w[0] = np.array([[[[0.1254]]], [[[0.0059]]]])
w[1] = np.array([[[[0.3208, 0.6027, 0.7509, 0.2112]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep710').set_weights(w) 
in0Min23363 = tf.constant([[[[0.4394], [0.8289]]]])
in1Min23363 = tf.constant([[[[0.3452], [0.6036]]]])
in0Fla45208 = tf.constant([[[1.3891, 1.7698, 1.2149]]])
print (np.array2string(model.predict([in0Min23363,in1Min23363,in0Fla45208],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max87766.png')

LMin23363 = minimum_layer([[[[[0.4394], [0.8289]]]], [[[[0.3452], [0.6036]]]]], Min23363), 
LCon99849 = conv2D_layer(Min23363, 1, 1,[[[[0.7204, 0.5982, 0.175, 0.4527]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con99849), 
LZer97946 = zero_padding2D_layer(Con99849, 1, 0, 1, 0, Zer97946), 
LFla45208 = flatten_layer([[[1.3891, 1.7698, 1.2149]]], Fla45208), 
LRes76413 = reshape_layer(Fla45208, [3, 1], Res76413), 
LRes92807 = reshape_layer(Res76413, [3, 1, 1], Res92807), 
LSep710 = separable_conv2D_layer(Res92807, 2, 1,[[[[[0.1254]]], [[[0.0059]]]],[[[[0.3208, 0.6027, 0.7509, 0.2112]]]]],[0, 0, 0, 0], 1, 1, false, Sep710), 
LZer61907 = zero_padding2D_layer(Sep710, 0, 0, 2, 0, Zer61907), 
LMax87766 = maximum_layer([Zer97946,Zer61907], Max87766), 
exec_layers([LMin23363,LCon99849,LZer97946,LFla45208,LRes76413,LRes92807,LSep710,LZer61907,LMax87766],["Min23363","Con99849","Zer97946","Fla45208","Res76413","Res92807","Sep710","Zer61907","Max87766"],Max87766,"Max87766")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0592309, 0.1112795, 0.1386424, 0.0389949]], [[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.2486821, 0.2064986, 0.0604100, 0.1562720], [0.4348335, 0.3610735, 0.1720318, 0.2732497]]]]

Expected (Unparsed): [[[[0,0,0,0],[0,0,0,0],[0.059230895168,0.11127949039200001,0.138642391464,0.038994903552000006]],[[0,0,0,0],[0.24868208000000003,0.20649863999999998,0.06041,0.15627204],[0.43483344,0.36107352,0.17203181324700004,0.27324972000000003]]]]

Actual:   [[[[0, 0, 0, 0], [0, 0, 0, 0], [0.0593, 0.1113, 0.1387, 0.039]], [[0, 0, 0, 0], [0.2487, 0.2065, 0.0605, 0.1563], [0.4349, 0.3611, 0.1721, 0.2733]]]]

Expected: [[[[0, 0, 0, 0], [0, 0, 0, 0], [0.0593, 0.1113, 0.1387, 0.039]], [[0, 0, 0, 0], [0.2487, 0.2065, 0.0605, 0.1563], [0.4349, 0.3611, 0.1721, 0.2733]]]]