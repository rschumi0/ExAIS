import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add55387 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Add55387 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Con11963 = tf.keras.layers.Input(shape=([2, 2]))
in0Add86424 = tf.keras.layers.Input(shape=([1, 2]))
in1Add86424 = tf.keras.layers.Input(shape=([1, 2]))
in0Con8140 = tf.keras.layers.Input(shape=([6, 2, 1]))
in0Mul72359 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul72359 = tf.keras.layers.Input(shape=([2, 1, 2]))

Add55387 = keras.layers.Add(name = 'Add55387', )([in0Add55387,in1Add55387])
Res27135 = keras.layers.Reshape((2, 1, 4), name = 'Res27135', )(Add55387)
Res44747 = keras.layers.Reshape((2, 4), name = 'Res44747', )(Res27135)
Con11963 = keras.layers.Concatenate(axis=2, name = 'Con11963', )([Res44747,in0Con11963])
Add86424 = keras.layers.Add(name = 'Add86424', )([in0Add86424,in1Add86424])
Res34939 = keras.layers.Reshape((1, 2, 1), name = 'Res34939', )(Add86424)
Cro31719 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro31719', )(Res34939)
Res26473 = keras.layers.Reshape((1, 2), name = 'Res26473', )(Cro31719)
Zer25076 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer25076', )(Res26473)
Dot49807 = keras.layers.Dot(axes=(1, 1), name = 'Dot49807', )([Con11963,Zer25076])
Res60264 = keras.layers.Reshape((6, 2, 1), name = 'Res60264', )(Dot49807)
Con8140 = keras.layers.Concatenate(axis=3, name = 'Con8140', )([Res60264,in0Con8140])
Mul72359 = keras.layers.Multiply(name = 'Mul72359', )([in0Mul72359,in1Mul72359])
Zer67585 = keras.layers.ZeroPadding2D(padding=((4, 0), (1, 0)), name = 'Zer67585', )(Mul72359)
Ave96803 = keras.layers.Average(name = 'Ave96803', )([Con8140,Zer67585])
Res65595 = keras.layers.Reshape((6, 4), name = 'Res65595', )(Ave96803)
Zer19402 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer19402', )(Res65595)
model = tf.keras.models.Model(inputs=[in0Add55387,in1Add55387,in0Con11963,in0Add86424,in1Add86424,in0Con8140,in0Mul72359,in1Mul72359], outputs=Zer19402)
in0Add55387 = tf.constant([[[[[0.3911, 0.8857], [0.7916, 0.1665]]], [[[0.792, 0.8442], [0.5201, 0.3945]]]]])
in1Add55387 = tf.constant([[[[[0.7225, 0.6865], [0.5086, 0.0671]]], [[[0.7361, 0.0751], [0.5439, 0.9334]]]]])
in0Con11963 = tf.constant([[[0.7911, 0.0763], [0.2497, 0.6945]]])
in0Add86424 = tf.constant([[[0.3616, 0.9138]]])
in1Add86424 = tf.constant([[[0.9027, 0.0523]]])
in0Con8140 = tf.constant([[[[0.1016], [0.9111]], [[0.055], [0.6301]], [[0.3502], [0.6864]], [[0.6635], [0.9554]], [[0.0657], [0.6101]], [[0.4489], [0.8726]]]])
in0Mul72359 = tf.constant([[[[0.0193, 0.6883]], [[0.6265, 0.1049]]]])
in1Mul72359 = tf.constant([[[[0.1842, 0.7298]], [[0.883, 0.0413]]]])
print (np.array2string(model.predict([in0Add55387,in1Add55387,in0Con11963,in0Add86424,in1Add86424,in0Con8140,in0Mul72359,in1Mul72359],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer19402.png')

LAdd55387 = add_layer([[[[[[0.3911, 0.8857], [0.7916, 0.1665]]], [[[0.792, 0.8442], [0.5201, 0.3945]]]]], [[[[[0.7225, 0.6865], [0.5086, 0.0671]]], [[[0.7361, 0.0751], [0.5439, 0.9334]]]]]], Add55387), 
LRes27135 = reshape_layer(Add55387, [2, 1, 4], Res27135), 
LRes44747 = reshape_layer(Res27135, [2, 4], Res44747), 
LCon11963 = concatenate_layer([Res44747,[[[0.7911, 0.0763], [0.2497, 0.6945]]]], 2, Con11963), 
LAdd86424 = add_layer([[[[0.3616, 0.9138]]], [[[0.9027, 0.0523]]]], Add86424), 
LRes34939 = reshape_layer(Add86424, [1, 2, 1], Res34939), 
LCro31719 = cropping2D_layer(Res34939, 0, 0, 0, 0, Cro31719), 
LRes26473 = reshape_layer(Cro31719, [1, 2], Res26473), 
LZer25076 = zero_padding1D_layer(Res26473, 1, 0, Zer25076), 
LDot49807 = dot_layer(Con11963,Zer25076, 1, 1, Dot49807), 
LRes60264 = reshape_layer(Dot49807, [6, 2, 1], Res60264), 
LCon8140 = concatenate_layer([Res60264,[[[[0.1016], [0.9111]], [[0.055], [0.6301]], [[0.3502], [0.6864]], [[0.6635], [0.9554]], [[0.0657], [0.6101]], [[0.4489], [0.8726]]]]], 3, Con8140), 
LMul72359 = multiply_layer([[[[[0.0193, 0.6883]], [[0.6265, 0.1049]]]], [[[[0.1842, 0.7298]], [[0.883, 0.0413]]]]], Mul72359), 
LZer67585 = zero_padding2D_layer(Mul72359, 4, 0, 1, 0, Zer67585), 
LAve96803 = average_layer([Con8140,Zer67585], Ave96803), 
LRes65595 = reshape_layer(Ave96803, [6, 4], Res65595), 
LZer19402 = zero_padding1D_layer(Res65595, 1, 1, Zer19402), 
exec_layers([LAdd55387,LRes27135,LRes44747,LCon11963,LAdd86424,LRes34939,LCro31719,LRes26473,LZer25076,LDot49807,LRes60264,LCon8140,LMul72359,LZer67585,LAve96803,LRes65595,LZer19402],["Add55387","Res27135","Res44747","Con11963","Add86424","Res34939","Cro31719","Res26473","Zer25076","Dot49807","Res60264","Con8140","Mul72359","Zer67585","Ave96803","Res65595","Zer19402"],Zer19402,"Zer19402")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.9659884, 0.0508000, 0.7381487, 0.4555500], [0.5811355, 0.0275000, 0.4440679, 0.3150500], [0.6726076, 0.1751000, 0.5139652, 0.3432000], [0.8394320, 0.3317500, 0.6414421, 0.4777000], [0.1578479, 0.0328500, 0.1223951, 0.5562107], [0.4390282, 0.2244500, 0.6120780, 0.4384662], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0],[0.965988415,0.0508,0.738148705,0.45555],[0.581135495,0.0275,0.444067865,0.31505],[0.6726076,0.1751,0.5139652,0.3432],[0.839431985,0.33175,0.641442095,0.4777],[0.157847855,0.03285,0.122395115,0.55621067],[0.439028175,0.22445,0.6120779749999999,0.438466185],[0,0,0,0]]]

Actual:   [[[0, 0, 0, 0], [0.966, 0.0508, 0.7382, 0.4556], [0.5812, 0.0275, 0.4441, 0.3151], [0.6727, 0.1751, 0.514, 0.3432], [0.8395, 0.3318, 0.6415, 0.4777], [0.1579, 0.0329, 0.1224, 0.5563], [0.4391, 0.2245, 0.6121, 0.4385], [0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0], [0.966, 0.0508, 0.7382, 0.4556], [0.5812, 0.0275, 0.4441, 0.3151], [0.6727, 0.1751, 0.514, 0.3432], [0.8395, 0.3318, 0.6415, 0.4777], [0.1579, 0.0329, 0.1224, 0.5563], [0.4391, 0.2245, 0.6121, 0.4385], [0, 0, 0, 0]]]