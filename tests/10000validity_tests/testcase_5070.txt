import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave92097 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave92097 = tf.keras.layers.Input(shape=([2, 2]))

Ave92097 = keras.layers.Average(name = 'Ave92097', )([in0Ave92097,in1Ave92097])
Res70024 = keras.layers.Reshape((2, 2, 1), name = 'Res70024', )(Ave92097)
Sep64160 = keras.layers.SeparableConv2D(3, (1, 2),strides=(2, 2), padding='valid', name = 'Sep64160', )(Res70024)
Glo3450 = keras.layers.GlobalMaxPool2D(name = 'Glo3450', )(Sep64160)
model = tf.keras.models.Model(inputs=[in0Ave92097,in1Ave92097], outputs=Glo3450)
w = model.get_layer('Sep64160').get_weights() 
w[0] = np.array([[[[0.3089]], [[0.8524]]]])
w[1] = np.array([[[[0.0688, 0.8178, 0.2693]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep64160').set_weights(w) 
in0Ave92097 = tf.constant([[[0.1123, 0.1843], [0.7887, 0.4021]]])
in1Ave92097 = tf.constant([[[0.2364, 0.5655], [0.2717, 0.2592]]])
print (np.array2string(model.predict([in0Ave92097,in1Ave92097],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo3450.png')

LAve92097 = average_layer([[[[0.1123, 0.1843], [0.7887, 0.4021]]], [[[0.2364, 0.5655], [0.2717, 0.2592]]]], Ave92097), 
LRes70024 = reshape_layer(Ave92097, [2, 2, 1], Res70024), 
LSep64160 = separable_conv2D_layer(Res70024, 1, 2,[[[[[0.3089]], [[0.8524]]]],[[[[0.0688, 0.8178, 0.2693]]]]],[0, 0, 0], 2, 2, false, Sep64160), 
LGlo3450 = global_max_pool2D_layer(Sep64160, Glo3450), 
exec_layers([LAve92097,LRes70024,LSep64160,LGlo3450],["Ave92097","Res70024","Sep64160","Glo3450"],Glo3450,"Glo3450")

Actual (Unparsed): [[0.0256914, 0.3053841, 0.1005624]]

Expected (Unparsed): [[0.02569139748,0.30538408225499997,0.1005624032175]]

Actual:   [[0.0257, 0.3054, 0.1006]]

Expected: [[0.0257, 0.3054, 0.1006]]