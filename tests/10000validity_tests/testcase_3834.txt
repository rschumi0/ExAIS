import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla4925 = tf.keras.layers.Input(shape=([4, 4]))
in0Per75452 = tf.keras.layers.Input(shape=([1, 1]))

Fla4925 = keras.layers.Flatten(name = 'Fla4925', )(in0Fla4925)
Res31554 = keras.layers.Reshape((16, 1), name = 'Res31554', )(Fla4925)
Per75452 = keras.layers.Permute((2,1), name = 'Per75452',)(in0Per75452)
Zer12246 = keras.layers.ZeroPadding1D(padding=((15, 0)), name = 'Zer12246', )(Per75452)
Mul66913 = keras.layers.Multiply(name = 'Mul66913', )([Res31554,Zer12246])
Zer69432 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer69432', )(Mul66913)
Res12523 = keras.layers.Reshape((18, 1, 1), name = 'Res12523', )(Zer69432)
Max63347 = keras.layers.MaxPool2D(pool_size=(4, 1), strides=(1, 1), padding='valid', name = 'Max63347', )(Res12523)
model = tf.keras.models.Model(inputs=[in0Fla4925,in0Per75452], outputs=Max63347)
in0Fla4925 = tf.constant([[[1.7413, 1.2844, 1.9163, 1.3643], [1.0481, 1.2309, 1.4144, 1.0532], [1.6165, 1.2767, 1.2967, 1.7519], [1.2315, 1.0263, 1.4115, 1.1693]]])
in0Per75452 = tf.constant([[[1.3367]]])
print (np.array2string(model.predict([in0Fla4925,in0Per75452],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max63347.png')

LFla4925 = flatten_layer([[[1.7413, 1.2844, 1.9163, 1.3643], [1.0481, 1.2309, 1.4144, 1.0532], [1.6165, 1.2767, 1.2967, 1.7519], [1.2315, 1.0263, 1.4115, 1.1693]]], Fla4925), 
LRes31554 = reshape_layer(Fla4925, [16, 1], Res31554), 
LPer75452 = permute_layer([[[1.3367]]], 2,1, Per75452), 
LZer12246 = zero_padding1D_layer(Per75452, 15, 0, Zer12246), 
LMul66913 = multiply_layer([Res31554,Zer12246], Mul66913), 
LZer69432 = zero_padding1D_layer(Mul66913, 1, 1, Zer69432), 
LRes12523 = reshape_layer(Zer69432, [18, 1, 1], Res12523), 
LMax63347 = max_pool2D_layer(Res12523, 4, 1, 1, 1, false, Max63347), 
exec_layers([LFla4925,LRes31554,LPer75452,LZer12246,LMul66913,LZer69432,LRes12523,LMax63347],["Fla4925","Res31554","Per75452","Zer12246","Mul66913","Zer69432","Res12523","Max63347"],Max63347,"Max63347")

Actual (Unparsed): [[[[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[0.0000000]], [[1.5630032]], [[1.5630032]]]]

Expected (Unparsed): [[[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[0.0]],[[1.56300331]],[[1.56300331]]]]

Actual:   [[[[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[1.5631]], [[1.5631]]]]

Expected: [[[[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[0]], [[1.5631]], [[1.5631]]]]