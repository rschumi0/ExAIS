import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub14277 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub14277 = tf.keras.layers.Input(shape=([3, 2]))
in0Con18370 = tf.keras.layers.Input(shape=([3, 2]))
in0Con67201 = tf.keras.layers.Input(shape=([2, 1]))
in0Add86043 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Add86043 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con42578 = tf.keras.layers.Input(shape=([11]))

Sub14277 = keras.layers.Subtract(name = 'Sub14277', )([in0Sub14277,in1Sub14277])
Con18370 = keras.layers.Concatenate(axis=2, name = 'Con18370', )([Sub14277,in0Con18370])
Con67201 = keras.layers.Conv1D(4, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con67201', )(in0Con67201)
Zer27135 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer27135', )(Con67201)
Mul7358 = keras.layers.Multiply(name = 'Mul7358', )([Con18370,Zer27135])
Fla41568 = keras.layers.Flatten(name = 'Fla41568', )(Mul7358)
Add86043 = keras.layers.Add(name = 'Add86043', )([in0Add86043,in1Add86043])
Up_10566 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_10566', )(Add86043)
Res85018 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res85018', )(Up_10566)
Glo52799 = keras.layers.GlobalMaxPool3D(name = 'Glo52799', )(Res85018)
Con42578 = keras.layers.Concatenate(axis=1, name = 'Con42578', )([Glo52799,in0Con42578])
Ave85631 = keras.layers.Average(name = 'Ave85631', )([Fla41568,Con42578])
Res24921 = keras.layers.Reshape((12, 1), name = 'Res24921', )(Ave85631)
Res25680 = keras.layers.Reshape((12, 1, 1), name = 'Res25680', )(Res24921)
Up_61094 = keras.layers.UpSampling2D(size=(1, 1), name = 'Up_61094', )(Res25680)
model = tf.keras.models.Model(inputs=[in0Sub14277,in1Sub14277,in0Con18370,in0Con67201,in0Add86043,in1Add86043,in0Con42578], outputs=Up_61094)
w = model.get_layer('Con67201').get_weights() 
w[0] = np.array([[[0.9554, 0.226, 0.0806, 0.5025]], [[0.3088, 0.3574, 0.7002, 0.374]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con67201').set_weights(w) 
in0Sub14277 = tf.constant([[[0.4039, 0.0603], [0.4948, 0.134], [0.7505, 0.3535]]])
in1Sub14277 = tf.constant([[[0.5305, 0.9478], [0.2756, 0.9075], [0.3494, 0.9581]]])
in0Con18370 = tf.constant([[[0.2556, 0.0578], [0.5507, 0.9818], [0.0991, 0.9323]]])
in0Con67201 = tf.constant([[[0.2559], [0.0303]]])
in0Add86043 = tf.constant([[[[0.5628, 0.4886]], [[0.8764, 0.9594]]]])
in1Add86043 = tf.constant([[[[0.309, 0.1445]], [[0.5562, 0.6252]]]])
in0Con42578 = tf.constant([[0.4148, 0.6925, 0.669, 0.004, 0.8186, 0.0876, 0.8456, 0.9726, 0.821, 0.4737, 0.1189]])
print (np.array2string(model.predict([in0Sub14277,in1Sub14277,in0Con18370,in0Con67201,in0Add86043,in1Add86043,in0Con42578],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_61094.png')

LSub14277 = subtract_layer([[[0.4039, 0.0603], [0.4948, 0.134], [0.7505, 0.3535]]], [[[0.5305, 0.9478], [0.2756, 0.9075], [0.3494, 0.9581]]], Sub14277), 
LCon18370 = concatenate_layer([Sub14277,[[[0.2556, 0.0578], [0.5507, 0.9818], [0.0991, 0.9323]]]], 2, Con18370), 
LCon67201 = conv1D_layer([[[0.2559], [0.0303]]], 2,[[[0.9554, 0.226, 0.0806, 0.5025]], [[0.3088, 0.3574, 0.7002, 0.374]]],[0, 0, 0, 0], 1, false, 1, Con67201), 
LZer27135 = zero_padding1D_layer(Con67201, 2, 0, Zer27135), 
LMul7358 = multiply_layer([Con18370,Zer27135], Mul7358), 
LFla41568 = flatten_layer(Mul7358, Fla41568), 
LAdd86043 = add_layer([[[[[0.5628, 0.4886]], [[0.8764, 0.9594]]]], [[[[0.309, 0.1445]], [[0.5562, 0.6252]]]]], Add86043), 
LUp_10566 = up_sampling2D_layer(Add86043, 1, 2, Up_10566), 
LRes85018 = reshape_layer(Up_10566, [2, 2, 2, 1], Res85018), 
LGlo52799 = global_max_pool3D_layer(Res85018, Glo52799), 
LCon42578 = concatenate_layer([Glo52799,[[0.4148, 0.6925, 0.669, 0.004, 0.8186, 0.0876, 0.8456, 0.9726, 0.821, 0.4737, 0.1189]]], 1, Con42578), 
LAve85631 = average_layer([Fla41568,Con42578], Ave85631), 
LRes24921 = reshape_layer(Ave85631, [12, 1], Res24921), 
LRes25680 = reshape_layer(Res24921, [12, 1, 1], Res25680), 
LUp_61094 = up_sampling2D_layer(Res25680, 1, 1, Up_61094), 
exec_layers([LSub14277,LCon18370,LCon67201,LZer27135,LMul7358,LFla41568,LAdd86043,LUp_10566,LRes85018,LGlo52799,LCon42578,LAve85631,LRes24921,LRes25680,LUp_61094],["Sub14277","Con18370","Con67201","Zer27135","Mul7358","Fla41568","Add86043","Up_10566","Res85018","Glo52799","Con42578","Ave85631","Res24921","Res25680","Up_61094"],Up_61094,"Up_61094")

Actual (Unparsed): [[[[0.7923000]], [[0.2074000]], [[0.3462500]], [[0.3345000]], [[0.0020000]], [[0.4093000]], [[0.0438000]], [[0.4228000]], [[0.5372083]], [[0.3897433]], [[0.2389232]], [[0.1246746]]]]

Expected (Unparsed): [[[[0.7923]],[[0.2074]],[[0.34625]],[[0.3345]],[[0.002]],[[0.4093]],[[0.0438]],[[0.4228]],[[0.537208313925]],[[0.389743289974]],[[0.23892325128]],[[0.12467461699250001]]]]

Actual:   [[[[0.7923]], [[0.2074]], [[0.3463]], [[0.3345]], [[0.002]], [[0.4093]], [[0.0438]], [[0.4228]], [[0.5373]], [[0.3898]], [[0.239]], [[0.1247]]]]

Expected: [[[[0.7923]], [[0.2074]], [[0.3463]], [[0.3345]], [[0.002]], [[0.4093]], [[0.0438]], [[0.4228]], [[0.5373]], [[0.3898]], [[0.239]], [[0.1247]]]]