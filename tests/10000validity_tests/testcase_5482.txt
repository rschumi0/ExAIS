import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro41028 = tf.keras.layers.Input(shape=([1, 3, 3]))
in0Con81434 = tf.keras.layers.Input(shape=([1, 1]))
in0Mul53983 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Mul53983 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Cro41028 = keras.layers.Cropping2D(cropping=((0, 0), (0, 1)), name = 'Cro41028', )(in0Cro41028)
Res43069 = keras.layers.Reshape((1, 6), name = 'Res43069', )(Cro41028)
Sep65689 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep65689', )(Res43069)
Con81434 = keras.layers.Concatenate(axis=2, name = 'Con81434', )([Sep65689,in0Con81434])
Mul53983 = keras.layers.Multiply(name = 'Mul53983', )([in0Mul53983,in1Mul53983])
Res45718 = keras.layers.Reshape((2, 1, 4), name = 'Res45718', )(Mul53983)
Res91878 = keras.layers.Reshape((2, 4), name = 'Res91878', )(Res45718)
Dot91544 = keras.layers.Dot(axes=(2, 2), name = 'Dot91544', )([Con81434,Res91878])
model = tf.keras.models.Model(inputs=[in0Cro41028,in0Con81434,in0Mul53983,in1Mul53983], outputs=Dot91544)
w = model.get_layer('Sep65689').get_weights() 
w[0] = np.array([[[0.2436], [0.3362], [0.4342], [0.8779], [0.9947], [0.4087]]])
w[1] = np.array([[[0.3659, 0.4495, 0.4991], [0.7564, 0.4286, 0.7343], [0.7679, 0.5363, 0.6165], [0.8481, 0.4176, 0.6919], [0.1613, 0.4182, 0.6644], [0.7709, 0.9977, 0.4823]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep65689').set_weights(w) 
in0Cro41028 = tf.constant([[[[1.6067, 1.6649, 1.2849], [1.938, 1.2898, 1.5709], [1.3064, 1.235, 1.9569]]]])
in0Con81434 = tf.constant([[[0.966]]])
in0Mul53983 = tf.constant([[[[[0.9624, 0.2443], [0.0931, 0.5768]]], [[[0.4052, 0.1062], [0.8876, 0.2944]]]]])
in1Mul53983 = tf.constant([[[[[0.7752, 0.3681], [0.2172, 0.0104]]], [[[0.8517, 0.3343], [0.0142, 0.9323]]]]])
print (np.array2string(model.predict([in0Cro41028,in0Con81434,in0Mul53983,in1Mul53983],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot91544.png')

LCro41028 = cropping2D_layer([[[[1.6067, 1.6649, 1.2849], [1.938, 1.2898, 1.5709], [1.3064, 1.235, 1.9569]]]], 0, 0, 0, 1, Cro41028), 
LRes43069 = reshape_layer(Cro41028, [1, 6], Res43069), 
LSep65689 = separable_conv1D_layer(Res43069, 1,[[[[0.2436], [0.3362], [0.4342], [0.8779], [0.9947], [0.4087]]],[[[0.3659, 0.4495, 0.4991], [0.7564, 0.4286, 0.7343], [0.7679, 0.5363, 0.6165], [0.8481, 0.4176, 0.6919], [0.1613, 0.4182, 0.6644], [0.7709, 0.9977, 0.4823]]]],[0, 0, 0], 1, false, Sep65689), 
LCon81434 = concatenate_layer([Sep65689,[[[0.966]]]], 2, Con81434), 
LMul53983 = multiply_layer([[[[[[0.9624, 0.2443], [0.0931, 0.5768]]], [[[0.4052, 0.1062], [0.8876, 0.2944]]]]], [[[[[0.7752, 0.3681], [0.2172, 0.0104]]], [[[0.8517, 0.3343], [0.0142, 0.9323]]]]]], Mul53983), 
LRes45718 = reshape_layer(Mul53983, [2, 1, 4], Res45718), 
LRes91878 = reshape_layer(Res45718, [2, 4], Res91878), 
LDot91544 = dot_layer(Con81434,Res91878, 2, 2, Dot91544), 
exec_layers([LCro41028,LRes43069,LSep65689,LCon81434,LMul53983,LRes45718,LRes91878,LDot91544],["Cro41028","Res43069","Sep65689","Con81434","Mul53983","Res45718","Res91878","Dot91544"],Dot91544,"Dot91544")

Actual (Unparsed): [[[2.6488321, 1.4825791]]]

Expected (Unparsed): [[[2.6488321328471294,1.4825790824835203]]]

Actual:   [[[2.6489, 1.4826]]]

Expected: [[[2.6489, 1.4826]]]