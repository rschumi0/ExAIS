import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Bat85643 = tf.keras.layers.Input(shape=([4, 4]))
in0Glo67437 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con99846 = tf.keras.layers.Input(shape=([1, 1]))
in0ELU51442 = tf.keras.layers.Input(shape=([1, 2]))

Bat85643 = keras.layers.BatchNormalization(axis=1, epsilon=0.12214383652202654,  name = 'Bat85643', )(in0Bat85643)
Res16494 = keras.layers.Reshape((4, 4, 1), name = 'Res16494', )(Bat85643)
Max7444 = keras.layers.MaxPool2D(pool_size=(4, 3), strides=(1, 3), padding='valid', name = 'Max7444', )(Res16494)
Res66592 = keras.layers.Reshape((1, 1), name = 'Res66592', )(Max7444)
Cro16772 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro16772', )(Res66592)
Fla45727 = keras.layers.Flatten(name = 'Fla45727', )(Cro16772)
Glo67437 = keras.layers.GlobalMaxPool2D(name = 'Glo67437', )(in0Glo67437)
Mas44567 = keras.layers.Masking(mask_value=1, name = 'Mas44567', )(Glo67437)
Max16445 = keras.layers.Maximum(name = 'Max16445', )([Fla45727,Mas44567])
Res82091 = keras.layers.Reshape((1, 1), name = 'Res82091', )(Max16445)
Con99846 = keras.layers.Concatenate(axis=2, name = 'Con99846', )([Res82091,in0Con99846])
ELU51442 = keras.layers.ELU(alpha=0.7743304421006769, name = 'ELU51442', input_shape=(1, 2))(in0ELU51442)
Max82782 = keras.layers.Maximum(name = 'Max82782', )([Con99846,ELU51442])
model = tf.keras.models.Model(inputs=[in0Bat85643,in0Glo67437,in0Con99846,in0ELU51442], outputs=Max82782)
w = model.get_layer('Bat85643').get_weights() 
w[0] = np.array([0.2977, 0.9516, 0.874, 0.3052])
w[1] = np.array([0.6533, 0.5387, 0.5016, 0.5144])
w[2] = np.array([0.9606, 0.5633, 0.6, 0.8511])
w[3] = np.array([0.1752, 0.4219, 0.4876, 0.3993])
model.get_layer('Bat85643').set_weights(w) 
in0Bat85643 = tf.constant([[[1.7389, 1.8577, 1.0765, 1.6395], [1.2059, 1.4004, 1.403, 1.7635], [1.2838, 1.1914, 1.3596, 1.6864], [1.5173, 1.1476, 1.4013, 1.4428]]])
in0Glo67437 = tf.constant([[[[1.6305]]]])
in0Con99846 = tf.constant([[[0.7286]]])
in0ELU51442 = tf.constant([[[0.1284, 0.774]]])
print (np.array2string(model.predict([in0Bat85643,in0Glo67437,in0Con99846,in0ELU51442],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max82782.png')

LBat85643 = batch_normalization_layer([[[1.7389, 1.8577, 1.0765, 1.6395], [1.2059, 1.4004, 1.403, 1.7635], [1.2838, 1.1914, 1.3596, 1.6864], [1.5173, 1.1476, 1.4013, 1.4428]]], 1, 0.12214383652202654, [0.2977, 0.9516, 0.874, 0.3052], [0.6533, 0.5387, 0.5016, 0.5144], [0.9606, 0.5633, 0.6, 0.8511], [0.1752, 0.4219, 0.4876, 0.3993], Bat85643), 
LRes16494 = reshape_layer(Bat85643, [4, 4, 1], Res16494), 
LMax7444 = max_pool2D_layer(Res16494, 4, 3, 1, 3, false, Max7444), 
LRes66592 = reshape_layer(Max7444, [1, 1], Res66592), 
LCro16772 = cropping1D_layer(Res66592, 0, 0, Cro16772), 
LFla45727 = flatten_layer(Cro16772, Fla45727), 
LGlo67437 = global_max_pool2D_layer([[[[1.6305]]]], Glo67437), 
LMas44567 = masking_layer(Glo67437, 1, Mas44567), 
LMax16445 = maximum_layer([Fla45727,Mas44567], Max16445), 
LRes82091 = reshape_layer(Max16445, [1, 1], Res82091), 
LCon99846 = concatenate_layer([Res82091,[[[0.7286]]]], 2, Con99846), 
LELU51442 = elu_layer([[[0.1284, 0.774]]], 0.7743304421006769, ELU51442), 
LMax82782 = maximum_layer([Con99846,ELU51442], Max82782), 
exec_layers([LBat85643,LRes16494,LMax7444,LRes66592,LCro16772,LFla45727,LGlo67437,LMas44567,LMax16445,LRes82091,LCon99846,LELU51442,LMax82782],["Bat85643","Res16494","Max7444","Res66592","Cro16772","Fla45727","Glo67437","Mas44567","Max16445","Res82091","Con99846","ELU51442","Max82782"],Max82782,"Max82782")

Actual (Unparsed): [[[1.6305000, 0.7740000]]]

Expected (Unparsed): [[[1.6305,0.774]]]

Actual:   [[[1.6305, 0.774]]]

Expected: [[[1.6305, 0.774]]]