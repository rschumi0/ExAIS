import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL57757 = tf.keras.layers.Input(shape=([1, 2]))
in0Con64151 = tf.keras.layers.Input(shape=([1]))
in0LST83900 = tf.keras.layers.Input(shape=([2, 3]))
in0Con16114 = tf.keras.layers.Input(shape=([3, 3]))
in0Dot87662 = tf.keras.layers.Input(shape=([2]))
in1Dot87662 = tf.keras.layers.Input(shape=([2]))
in0Loc61393 = tf.keras.layers.Input(shape=([2, 1]))

ReL57757 = keras.layers.ReLU(max_value=9.64923757324442, negative_slope=6.173558929902063, threshold=9.397537891968124, name = 'ReL57757', input_shape=(1, 2))(in0ReL57757)
Fla52259 = keras.layers.Flatten(name = 'Fla52259', )(ReL57757)
Con64151 = keras.layers.Concatenate(axis=1, name = 'Con64151', )([Fla52259,in0Con64151])
LST83900 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST83900', )(in0LST83900)
Res82289 = keras.layers.Reshape((3, 1), name = 'Res82289', )(LST83900)
Con16114 = keras.layers.Concatenate(axis=2, name = 'Con16114', )([Res82289,in0Con16114])
Dot87662 = keras.layers.Dot(axes=(1, 1), name = 'Dot87662', )([in0Dot87662,in1Dot87662])
Res61580 = keras.layers.Reshape((1, 1), name = 'Res61580', )(Dot87662)
Loc61393 = keras.layers.LocallyConnected1D(4, (2),strides=(1), name = 'Loc61393', )(in0Loc61393)
Dot54768 = keras.layers.Dot(axes=(1, 1), name = 'Dot54768', )([Res61580,Loc61393])
Zer5635 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer5635', )(Dot54768)
Add8022 = keras.layers.Add(name = 'Add8022', )([Con16114,Zer5635])
Sim7073 = keras.layers.SimpleRNN(3,name = 'Sim7073', )(Add8022)
Ave31319 = keras.layers.Average(name = 'Ave31319', )([Con64151,Sim7073])
model = tf.keras.models.Model(inputs=[in0ReL57757,in0Con64151,in0LST83900,in0Con16114,in0Dot87662,in1Dot87662,in0Loc61393], outputs=Ave31319)
w = model.get_layer('LST83900').get_weights() 
w[0] = np.array([[6, 2, 7, 6, 9, 10, 6, 6, 8, 6, 10, 4], [7, 3, 1, 3, 2, 8, 10, 10, 2, 1, 8, 6], [9, 1, 6, 10, 7, 7, 8, 10, 2, 1, 7, 10]])
w[1] = np.array([[6, 10, 2, 5, 2, 10, 2, 3, 4, 10, 3, 7], [10, 7, 4, 7, 4, 6, 8, 5, 8, 6, 1, 5], [8, 3, 5, 3, 4, 5, 9, 4, 10, 7, 1, 10]])
w[2] = np.array([7, 4, 4, 9, 5, 10, 8, 8, 3, 4, 1, 2])
model.get_layer('LST83900').set_weights(w) 
w = model.get_layer('Loc61393').get_weights() 
w[0] = np.array([[[0.1966, 0.3464, 0.9738, 0.7357], [0.731, 0.7907, 0.6779, 0.6837]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc61393').set_weights(w) 
w = model.get_layer('Sim7073').get_weights() 
w[0] = np.array([[5, 5, 10], [8, 8, 6], [4, 2, 8], [9, 4, 10]])
w[1] = np.array([[9, 6, 9], [3, 9, 4], [1, 4, 4]])
w[2] = np.array([10, 1, 4])
model.get_layer('Sim7073').set_weights(w) 
in0ReL57757 = tf.constant([[[0.8285, 0.2831]]])
in0Con64151 = tf.constant([[0.6173]])
in0LST83900 = tf.constant([[[6, 1, 10], [8, 4, 3]]])
in0Con16114 = tf.constant([[[0.0652, 0.2923, 0.3217], [0.5102, 0.4674, 0.0241], [0.7224, 0.9727, 0.7632]]])
in0Dot87662 = tf.constant([[0.5686, 0.8833]])
in1Dot87662 = tf.constant([[0.8887, 0.4268]])
in0Loc61393 = tf.constant([[[0.1851], [0.1812]]])
print (np.array2string(model.predict([in0ReL57757,in0Con64151,in0LST83900,in0Con16114,in0Dot87662,in1Dot87662,in0Loc61393],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave31319.png')

LReL57757 = relu_layer([[[0.8285, 0.2831]]], 9.64923757324442, 6.173558929902063, 9.397537891968124, ReL57757), 
LFla52259 = flatten_layer(ReL57757, Fla52259), 
LCon64151 = concatenate_layer([Fla52259,[[0.6173]]], 1, Con64151), 
LLST83900 = lstm_layer([[[6, 1, 10], [8, 4, 3]]],[[6, 2, 7, 6, 9, 10, 6, 6, 8, 6, 10, 4], [7, 3, 1, 3, 2, 8, 10, 10, 2, 1, 8, 6], [9, 1, 6, 10, 7, 7, 8, 10, 2, 1, 7, 10]],[[6, 10, 2, 5, 2, 10, 2, 3, 4, 10, 3, 7], [10, 7, 4, 7, 4, 6, 8, 5, 8, 6, 1, 5], [8, 3, 5, 3, 4, 5, 9, 4, 10, 7, 1, 10]],[7, 4, 4, 9, 5, 10, 8, 8, 3, 4, 1, 2], LST83900), 
LRes82289 = reshape_layer(LST83900, [3, 1], Res82289), 
LCon16114 = concatenate_layer([Res82289,[[[0.0652, 0.2923, 0.3217], [0.5102, 0.4674, 0.0241], [0.7224, 0.9727, 0.7632]]]], 2, Con16114), 
LDot87662 = dot_layer([[0.5686, 0.8833]], [[0.8887, 0.4268]], 1, 1, Dot87662), 
LRes61580 = reshape_layer(Dot87662, [1, 1], Res61580), 
LLoc61393 = locally_connected1D_layer([[[0.1851], [0.1812]]], 2,[[[0.1966, 0.3464, 0.9738, 0.7357], [0.731, 0.7907, 0.6779, 0.6837]]],[[0, 0, 0, 0]], 1, Loc61393), 
LDot54768 = dot_layer(Res61580,Loc61393, 1, 1, Dot54768), 
LZer5635 = zero_padding1D_layer(Dot54768, 2, 0, Zer5635), 
LAdd8022 = add_layer([Con16114,Zer5635], Add8022), 
LSim7073 = simple_rnn_layer(Add8022,[[5, 5, 10], [8, 8, 6], [4, 2, 8], [9, 4, 10]],[[9, 6, 9], [3, 9, 4], [1, 4, 4]],[10, 1, 4], Sim7073), 
LAve31319 = average_layer([Con64151,Sim7073], Ave31319), 
exec_layers([LReL57757,LFla52259,LCon64151,LLST83900,LRes82289,LCon16114,LDot87662,LRes61580,LLoc61393,LDot54768,LZer5635,LAdd8022,LSim7073,LAve31319],["ReL57757","Fla52259","Con64151","LST83900","Res82289","Con16114","Dot87662","Res61580","Loc61393","Dot54768","Zer5635","Add8022","Sim7073","Ave31319"],Ave31319,"Ave31319")

Actual (Unparsed): [[-25.9507303, -27.6342597, 0.8086500]]

Expected (Unparsed): [[-25.950730199314478,-27.634259719498772,0.80865]]

Actual:   [[-25.9507, -27.6342, 0.8087]]

Expected: [[-25.9507, -27.6342, 0.8087]]