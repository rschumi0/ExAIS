import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep57483 = tf.keras.layers.Input(shape=([2, 2]))

Sep57483 = keras.layers.SeparableConv1D(4, (2),strides=(1), padding='valid', name = 'Sep57483', )(in0Sep57483)
Zer57449 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer57449', )(Sep57483)
Max22846 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max22846', )(Zer57449)
model = tf.keras.models.Model(inputs=[in0Sep57483], outputs=Max22846)
w = model.get_layer('Sep57483').get_weights() 
w[0] = np.array([[[0.9516], [0.4035]], [[0.6454], [0.2098]]])
w[1] = np.array([[[0.6457, 0.324, 0.9212, 0.5772], [0.1117, 0.2335, 0.4358, 0.4434]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep57483').set_weights(w) 
in0Sep57483 = tf.constant([[[0.5199, 0.9422], [0.3989, 0.121]]])
print (np.array2string(model.predict([in0Sep57483],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max22846.png')

LSep57483 = separable_conv1D_layer([[[0.5199, 0.9422], [0.3989, 0.121]]], 2,[[[[0.9516], [0.4035]], [[0.6454], [0.2098]]],[[[0.6457, 0.324, 0.9212, 0.5772], [0.1117, 0.2335, 0.4358, 0.4434]]]],[0, 0, 0, 0], 1, false, Sep57483), 
LZer57449 = zero_padding1D_layer(Sep57483, 1, 1, Zer57449), 
LMax22846 = max_pool1D_layer(Zer57449, 2, Max22846), 
exec_layers([LSep57483,LZer57449,LMax22846],["Sep57483","Zer57449","Max22846"],Max22846,"Max22846")

Actual (Unparsed): [[[0.5309885, 0.3384076, 0.8696592, 0.6139891]]]

Expected (Unparsed): [[[0.5309885242800001,0.33840763285000003,0.8696591455799999,0.61398913458]]]

Actual:   [[[0.531, 0.3385, 0.8697, 0.614]]]

Expected: [[[0.531, 0.3385, 0.8697, 0.614]]]