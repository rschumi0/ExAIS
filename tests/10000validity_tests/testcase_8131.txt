import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla5408 = tf.keras.layers.Input(shape=([3, 2]))
in0Con10858 = tf.keras.layers.Input(shape=([6, 1]))
in0Sub65096 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub65096 = tf.keras.layers.Input(shape=([3, 2]))

Fla5408 = keras.layers.Flatten(name = 'Fla5408', )(in0Fla5408)
Res49560 = keras.layers.Reshape((6, 1), name = 'Res49560', )(Fla5408)
Con10858 = keras.layers.Concatenate(axis=2, name = 'Con10858', )([Res49560,in0Con10858])
Sub65096 = keras.layers.Subtract(name = 'Sub65096', )([in0Sub65096,in1Sub65096])
Zer74050 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer74050', )(Sub65096)
Mul31540 = keras.layers.Multiply(name = 'Mul31540', )([Con10858,Zer74050])
ReL89315 = keras.layers.ReLU(max_value=1.2397407769520692, negative_slope=3.7043284073430174, threshold=4.4806174640573895, name = 'ReL89315', )(Mul31540)
model = tf.keras.models.Model(inputs=[in0Fla5408,in0Con10858,in0Sub65096,in1Sub65096], outputs=ReL89315)
in0Fla5408 = tf.constant([[[1.9156, 1.3215], [1.8574, 1.9509], [1.4224, 1.9766]]])
in0Con10858 = tf.constant([[[0.8625], [0.5424], [0.0707], [0.3804], [0.176], [0.9846]]])
in0Sub65096 = tf.constant([[[0.9647, 0.7432], [0.4413, 0.9772], [0.6804, 0.0489]]])
in1Sub65096 = tf.constant([[[0.1903, 0.336], [0.8377, 0.2551], [0.2995, 0.6303]]])
print (np.array2string(model.predict([in0Fla5408,in0Con10858,in0Sub65096,in1Sub65096],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ReL89315.png')

LFla5408 = flatten_layer([[[1.9156, 1.3215], [1.8574, 1.9509], [1.4224, 1.9766]]], Fla5408), 
LRes49560 = reshape_layer(Fla5408, [6, 1], Res49560), 
LCon10858 = concatenate_layer([Res49560,[[[0.8625], [0.5424], [0.0707], [0.3804], [0.176], [0.9846]]]], 2, Con10858), 
LSub65096 = subtract_layer([[[0.9647, 0.7432], [0.4413, 0.9772], [0.6804, 0.0489]]], [[[0.1903, 0.336], [0.8377, 0.2551], [0.2995, 0.6303]]], Sub65096), 
LZer74050 = zero_padding1D_layer(Sub65096, 3, 0, Zer74050), 
LMul31540 = multiply_layer([Con10858,Zer74050], Mul31540), 
LReL89315 = relu_layer(Mul31540, 1.2397407769520692, 3.7043284073430174, 4.4806174640573895, ReL89315), 
exec_layers([LFla5408,LRes49560,LCon10858,LSub65096,LZer74050,LMul31540,LReL89315],["Fla5408","Res49560","Con10858","Sub65096","Zer74050","Mul31540","ReL89315"],ReL89315,"ReL89315")

Actual (Unparsed): [[[-16.5976786, -16.5976786], [-16.5976786, -16.5976786], [-16.5976786, -16.5976786], [-11.0012648, -16.0238822], [-18.6863247, -16.1268970], [-13.8087378, -18.7182081]]]

Expected (Unparsed): [[[-16.59767855454502,-16.59767855454502],[-16.59767855454502,-16.59767855454502],[-16.59767855454502,-16.59767855454502],[-11.001264544457694,-16.023882233095403],[-18.686324712971125,-16.12689693898716],[-13.808738075185461,-18.7182081639194]]]

Actual:   [[[-16.5976, -16.5976], [-16.5976, -16.5976], [-16.5976, -16.5976], [-11.0012, -16.0238], [-18.6863, -16.1268], [-13.8087, -18.7182]]]

Expected: [[[-16.5976, -16.5976], [-16.5976, -16.5976], [-16.5976, -16.5976], [-11.0012, -16.0238], [-18.6863, -16.1268], [-13.8087, -18.7182]]]