import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot97832 = tf.keras.layers.Input(shape=([3]))
in1Dot97832 = tf.keras.layers.Input(shape=([3]))
in0Min61011 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Min61011 = tf.keras.layers.Input(shape=([2, 1, 1]))

Dot97832 = keras.layers.Dot(axes=(1, 1), name = 'Dot97832', )([in0Dot97832,in1Dot97832])
Res97593 = keras.layers.Reshape((1, 1), name = 'Res97593', )(Dot97832)
Min61011 = keras.layers.Minimum(name = 'Min61011', )([in0Min61011,in1Min61011])
Res31015 = keras.layers.Reshape((2, 1), name = 'Res31015', )(Min61011)
Dot4020 = keras.layers.Dot(axes=(1, 2), name = 'Dot4020', )([Res97593,Res31015])
model = tf.keras.models.Model(inputs=[in0Dot97832,in1Dot97832,in0Min61011,in1Min61011], outputs=Dot4020)
in0Dot97832 = tf.constant([[0.7683, 0.1969, 0.4549]])
in1Dot97832 = tf.constant([[0.0319, 0.6265, 0.1689]])
in0Min61011 = tf.constant([[[[0.497]], [[0.2032]]]])
in1Min61011 = tf.constant([[[[0.6056]], [[0.2116]]]])
print (np.array2string(model.predict([in0Dot97832,in1Dot97832,in0Min61011,in1Min61011],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot4020.png')

LDot97832 = dot_layer([[0.7683, 0.1969, 0.4549]], [[0.0319, 0.6265, 0.1689]], 1, 1, Dot97832), 
LRes97593 = reshape_layer(Dot97832, [1, 1], Res97593), 
LMin61011 = minimum_layer([[[[[0.497]], [[0.2032]]]], [[[[0.6056]], [[0.2116]]]]], Min61011), 
LRes31015 = reshape_layer(Min61011, [2, 1], Res31015), 
LDot4020 = dot_layer(Res97593,Res31015, 1, 2, Dot4020), 
exec_layers([LDot97832,LRes97593,LMin61011,LRes31015,LDot4020],["Dot97832","Res97593","Min61011","Res31015","Dot4020"],Dot4020,"Dot4020")

Actual (Unparsed): [[[0.1116755, 0.0456589]]]

Expected (Unparsed): [[[0.11167551730999999,0.04565888353599999]]]

Actual:   [[[0.1117, 0.0457]]]

Expected: [[[0.1117, 0.0457]]]