import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot70326 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot70326 = tf.keras.layers.Input(shape=([2, 2]))

Dot70326 = keras.layers.Dot(axes=(1, 2), name = 'Dot70326', )([in0Dot70326,in1Dot70326])
Sof10370 = keras.layers.Softmax(axis=1, name = 'Sof10370', )(Dot70326)
model = tf.keras.models.Model(inputs=[in0Dot70326,in1Dot70326], outputs=Sof10370)
in0Dot70326 = tf.constant([[[0.0362, 0.8089], [0.5814, 0.9276]]])
in1Dot70326 = tf.constant([[[0.5179, 0.0087], [0.0756, 0.3726]]])
print (np.array2string(model.predict([in0Dot70326,in1Dot70326],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof10370.png')

LDot70326 = dot_layer([[[0.0362, 0.8089], [0.5814, 0.9276]]], [[[0.5179, 0.0087], [0.0756, 0.3726]]], 1, 2, Dot70326), 
LSof10370 = softmax_layer(Dot70326, 1, Sof10370), 
exec_layers([LDot70326,LSof10370],["Dot70326","Sof10370"],Sof10370,"Sof10370")

Actual (Unparsed): [[[0.4005454, 0.4532841], [0.5994546, 0.5467159]]]

Expected (Unparsed): [[[0.4005453648094516,0.45328409203202225],[0.5994546351905483,0.5467159079679778]]]

Actual:   [[[0.4006, 0.4533], [0.5995, 0.5468]]]

Expected: [[[0.4006, 0.4533], [0.5995, 0.5468]]]