import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro58283 = tf.keras.layers.Input(shape=([1, 3, 3]))
in0Up_47227 = tf.keras.layers.Input(shape=([2, 4, 2, 2]))
in0Con89463 = tf.keras.layers.Input(shape=([1, 5, 2]))

Cro58283 = keras.layers.Cropping2D(cropping=((0, 0), (1, 1)), name = 'Cro58283', )(in0Cro58283)
PRe75465 = keras.layers.PReLU(name = 'PRe75465', )(Cro58283)
Zer84187 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer84187', )(PRe75465)
Up_47227 = keras.layers.UpSampling3D(size=(1, 2, 2), name = 'Up_47227', )(in0Up_47227)
Res16748 = keras.layers.Reshape((2, 8, 8), name = 'Res16748', )(Up_47227)
Res55461 = keras.layers.Reshape((2, 64), name = 'Res55461', )(Res16748)
Res98094 = keras.layers.Reshape((2, 64, 1), name = 'Res98094', )(Res55461)
Max63843 = keras.layers.MaxPool2D(pool_size=(1, 60), strides=(1, 6), padding='same', name = 'Max63843', )(Res98094)
Dep57868 = keras.layers.DepthwiseConv2D((2, 7),strides=(1, 1), padding='valid', name = 'Dep57868', )(Max63843)
Con89463 = keras.layers.Concatenate(axis=3, name = 'Con89463', )([Dep57868,in0Con89463])
Add23693 = keras.layers.Add(name = 'Add23693', )([Zer84187,Con89463])
model = tf.keras.models.Model(inputs=[in0Cro58283,in0Up_47227,in0Con89463], outputs=Add23693)
w = model.get_layer('PRe75465').get_weights() 
w[0] = np.array([[[0.4969, 0.0201, 0.777]]])
model.get_layer('PRe75465').set_weights(w) 
w = model.get_layer('Dep57868').get_weights() 
w[0] = np.array([[[[0.3497]], [[0.6779]], [[0.6616]], [[0.7595]], [[0.5785]], [[0.4389]], [[0.6375]]], [[[0.4671]], [[0.9203]], [[0.6974]], [[0.5629]], [[0.3814]], [[0.5387]], [[0.522]]]])
w[1] = np.array([0])
model.get_layer('Dep57868').set_weights(w) 
in0Cro58283 = tf.constant([[[[1.6162, 1.3661, 1.2665], [1.2526, 1.4199, 1.1074], [1.9415, 1.961, 1.0843]]]])
in0Up_47227 = tf.constant([[[[[1.5328, 1.9542], [1.4066, 1.7145]], [[1.0224, 1.8741], [1.8207, 1.9269]], [[1.692, 1.5513], [1.3154, 1.9248]], [[1.5371, 1.2517], [1.1253, 1.0863]]], [[[1.9638, 1.4449], [1.27, 1.885]], [[1.3055, 1.8747], [1.2, 1.1099]], [[1.5183, 1.4464], [1.5163, 1.7968]], [[1.267, 1.4599], [1.9771, 1.7022]]]]])
in0Con89463 = tf.constant([[[[0.605, 0.0979], [0.5516, 0.0756], [0.9076, 0.1587], [0.1967, 0.0441], [0.1129, 0.4191]]]])
print (np.array2string(model.predict([in0Cro58283,in0Up_47227,in0Con89463],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add23693.png')

LCro58283 = cropping2D_layer([[[[1.6162, 1.3661, 1.2665], [1.2526, 1.4199, 1.1074], [1.9415, 1.961, 1.0843]]]], 0, 0, 1, 1, Cro58283), 
LPRe75465 = prelu_layer(Cro58283, [[[0.4969, 0.0201, 0.777]]], PRe75465), 
LZer84187 = zero_padding2D_layer(PRe75465, 0, 0, 4, 0, Zer84187), 
LUp_47227 = up_sampling3D_layer([[[[[1.5328, 1.9542], [1.4066, 1.7145]], [[1.0224, 1.8741], [1.8207, 1.9269]], [[1.692, 1.5513], [1.3154, 1.9248]], [[1.5371, 1.2517], [1.1253, 1.0863]]], [[[1.9638, 1.4449], [1.27, 1.885]], [[1.3055, 1.8747], [1.2, 1.1099]], [[1.5183, 1.4464], [1.5163, 1.7968]], [[1.267, 1.4599], [1.9771, 1.7022]]]]], 1, 2, 2, Up_47227), 
LRes16748 = reshape_layer(Up_47227, [2, 8, 8], Res16748), 
LRes55461 = reshape_layer(Res16748, [2, 64], Res55461), 
LRes98094 = reshape_layer(Res55461, [2, 64, 1], Res98094), 
LMax63843 = max_pool2D_layer(Res98094, 1, 60, 1, 6, true, Max63843), 
LDep57868 = depthwise_conv2D_layer(Max63843, 2, 7,[[[[0.3497]], [[0.6779]], [[0.6616]], [[0.7595]], [[0.5785]], [[0.4389]], [[0.6375]]], [[[0.4671]], [[0.9203]], [[0.6974]], [[0.5629]], [[0.3814]], [[0.5387]], [[0.522]]]],[0], 1, 1, false, Dep57868), 
LCon89463 = concatenate_layer([Dep57868,[[[[0.605, 0.0979], [0.5516, 0.0756], [0.9076, 0.1587], [0.1967, 0.0441], [0.1129, 0.4191]]]]], 3, Con89463), 
LAdd23693 = add_layer([Zer84187,Con89463], Add23693), 
exec_layers([LCro58283,LPRe75465,LZer84187,LUp_47227,LRes16748,LRes55461,LRes98094,LMax63843,LDep57868,LCon89463,LAdd23693],["Cro58283","PRe75465","Zer84187","Up_47227","Res16748","Res55461","Res98094","Max63843","Dep57868","Con89463","Add23693"],Add23693,"Add23693")

Actual (Unparsed): [[[[16.0699843, 0.6050000, 0.0979000], [16.0600672, 0.5516000, 0.0756000], [16.0573607, 0.9076000, 0.1587000], [16.0538077, 0.1967000, 0.0441000], [17.2905470, 1.5327999, 1.5264999]]]]

Expected (Unparsed): [[[[16.06998429,0.605,0.0979],[16.060067110000002,0.5516,0.0756],[16.05736056,0.9076,0.1587],[16.0538075,0.1967,0.0441],[17.29054683,1.5328,1.5265]]]]

Actual:   [[[[16.07, 0.605, 0.0979], [16.0601, 0.5516, 0.0756], [16.0574, 0.9076, 0.1587], [16.0539, 0.1967, 0.0441], [17.2906, 1.5328, 1.5265]]]]

Expected: [[[[16.07, 0.605, 0.0979], [16.0601, 0.5516, 0.0756], [16.0574, 0.9076, 0.1587], [16.0539, 0.1967, 0.0441], [17.2906, 1.5328, 1.5265]]]]