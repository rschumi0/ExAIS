import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub29644 = tf.keras.layers.Input(shape=([2]))
in1Sub29644 = tf.keras.layers.Input(shape=([2]))
in0Add12673 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Add12673 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Glo74989 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con45755 = tf.keras.layers.Input(shape=([2]))
in0Con85579 = tf.keras.layers.Input(shape=([1]))

Sub29644 = keras.layers.Subtract(name = 'Sub29644', )([in0Sub29644,in1Sub29644])
Add12673 = keras.layers.Add(name = 'Add12673', )([in0Add12673,in1Add12673])
Res62542 = keras.layers.Reshape((2, 2, 1), name = 'Res62542', )(Add12673)
Res41510 = keras.layers.Reshape((2, 2), name = 'Res41510', )(Res62542)
Fla96406 = keras.layers.Flatten(name = 'Fla96406', )(Res41510)
Glo74989 = keras.layers.GlobalAveragePooling2D(name = 'Glo74989', )(in0Glo74989)
Thr53097 = keras.layers.ThresholdedReLU(theta=8.628272871987365, name = 'Thr53097', )(Glo74989)
Con45755 = keras.layers.Concatenate(axis=1, name = 'Con45755', )([Thr53097,in0Con45755])
Ave30442 = keras.layers.Average(name = 'Ave30442', )([Fla96406,Con45755])
Res48836 = keras.layers.Reshape((4, 1), name = 'Res48836', )(Ave30442)
Sim67797 = keras.layers.SimpleRNN(1,name = 'Sim67797', )(Res48836)
Res45391 = keras.layers.Reshape((1, 1), name = 'Res45391', )(Sim67797)
Res31148 = keras.layers.Reshape((1, 1, 1), name = 'Res31148', )(Res45391)
Glo27476 = keras.layers.GlobalAveragePooling2D(name = 'Glo27476', )(Res31148)
Con85579 = keras.layers.Concatenate(axis=1, name = 'Con85579', )([Glo27476,in0Con85579])
Add51756 = keras.layers.Add(name = 'Add51756', )([Sub29644,Con85579])
model = tf.keras.models.Model(inputs=[in0Sub29644,in1Sub29644,in0Add12673,in1Add12673,in0Glo74989,in0Con45755,in0Con85579], outputs=Add51756)
w = model.get_layer('Sim67797').get_weights() 
w[0] = np.array([[8]])
w[1] = np.array([[8]])
w[2] = np.array([10])
model.get_layer('Sim67797').set_weights(w) 
in0Sub29644 = tf.constant([[0.1847, 0.3289]])
in1Sub29644 = tf.constant([[0.5677, 0.8622]])
in0Add12673 = tf.constant([[[[[0.5921]], [[0.031]]], [[[0.5542]], [[0.0139]]]]])
in1Add12673 = tf.constant([[[[[0.6748]], [[0.6796]]], [[[0.9077]], [[0.8115]]]]])
in0Glo74989 = tf.constant([[[[1.4561, 1.5408], [1.4598, 1.0687]], [[1.6348, 1.8645], [1.5212, 1.1989]]]])
in0Con45755 = tf.constant([[0.1935, 0.6443]])
in0Con85579 = tf.constant([[0.1062]])
print (np.array2string(model.predict([in0Sub29644,in1Sub29644,in0Add12673,in1Add12673,in0Glo74989,in0Con45755,in0Con85579],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add51756.png')

LSub29644 = subtract_layer([[0.1847, 0.3289]], [[0.5677, 0.8622]], Sub29644), 
LAdd12673 = add_layer([[[[[[0.5921]], [[0.031]]], [[[0.5542]], [[0.0139]]]]], [[[[[0.6748]], [[0.6796]]], [[[0.9077]], [[0.8115]]]]]], Add12673), 
LRes62542 = reshape_layer(Add12673, [2, 2, 1], Res62542), 
LRes41510 = reshape_layer(Res62542, [2, 2], Res41510), 
LFla96406 = flatten_layer(Res41510, Fla96406), 
LGlo74989 = global_average_pooling2D_layer([[[[1.4561, 1.5408], [1.4598, 1.0687]], [[1.6348, 1.8645], [1.5212, 1.1989]]]], Glo74989), 
LThr53097 = thresholded_relu_layer(Glo74989, 8.628272871987365, Thr53097), 
LCon45755 = concatenate_layer([Thr53097,[[0.1935, 0.6443]]], 1, Con45755), 
LAve30442 = average_layer([Fla96406,Con45755], Ave30442), 
LRes48836 = reshape_layer(Ave30442, [4, 1], Res48836), 
LSim67797 = simple_rnn_layer(Res48836,[[8]],[[8]],[10], Sim67797), 
LRes45391 = reshape_layer(Sim67797, [1, 1], Res45391), 
LRes31148 = reshape_layer(Res45391, [1, 1, 1], Res31148), 
LGlo27476 = global_average_pooling2D_layer(Res31148, Glo27476), 
LCon85579 = concatenate_layer([Glo27476,[[0.1062]]], 1, Con85579), 
LAdd51756 = add_layer([Sub29644,Con85579], Add51756), 
exec_layers([LSub29644,LAdd12673,LRes62542,LRes41510,LFla96406,LGlo74989,LThr53097,LCon45755,LAve30442,LRes48836,LSim67797,LRes45391,LRes31148,LGlo27476,LCon85579,LAdd51756],["Sub29644","Add12673","Res62542","Res41510","Fla96406","Glo74989","Thr53097","Con45755","Ave30442","Res48836","Sim67797","Res45391","Res31148","Glo27476","Con85579","Add51756"],Add51756,"Add51756")

Actual (Unparsed): [[0.6170000, -0.4271000]]

Expected (Unparsed): [[0.617,-0.42709999999999987]]

Actual:   [[0.617, -0.4271]]

Expected: [[0.617, -0.427]]