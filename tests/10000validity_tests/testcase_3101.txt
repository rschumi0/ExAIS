import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep48402 = tf.keras.layers.Input(shape=([2, 2, 2]))

Sep48402 = keras.layers.SeparableConv2D(4, (2, 1),strides=(1, 1), padding='same', name = 'Sep48402', )(in0Sep48402)
Max55974 = keras.layers.MaxPool2D(pool_size=(2, 2), strides=(1, 1), padding='same', name = 'Max55974', )(Sep48402)
model = tf.keras.models.Model(inputs=[in0Sep48402], outputs=Max55974)
w = model.get_layer('Sep48402').get_weights() 
w[0] = np.array([[[[0.5083], [0.6003]]], [[[0.5097], [0.2417]]]])
w[1] = np.array([[[[0.047, 0.2785, 0.2253, 0.1294], [0.0429, 0.5757, 0.1319, 0.5732]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep48402').set_weights(w) 
in0Sep48402 = tf.constant([[[[0.9427, 0.5122], [0.7068, 0.973]], [[0.7492, 0.8292], [0.0564, 0.5435]]]])
print (np.array2string(model.predict([in0Sep48402],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max55974.png')

LSep48402 = separable_conv2D_layer([[[[0.9427, 0.5122], [0.7068, 0.973]], [[0.7492, 0.8292], [0.0564, 0.5435]]]], 2, 1,[[[[[0.5083], [0.6003]]], [[[0.5097], [0.2417]]]],[[[[0.047, 0.2785, 0.2253, 0.1294], [0.0429, 0.5757, 0.1319, 0.5732]]]]],[0, 0, 0, 0], 1, 1, true, Sep48402), 
LMax55974 = max_pool2D_layer(Sep48402, 2, 2, 1, 1, true, Max55974), 
exec_layers([LSep48402,LMax55974],["Sep48402","Max55974"],Max55974,"Max55974")

Actual (Unparsed): [[[[0.0622575, 0.5321931, 0.2609835, 0.4603082], [0.0489297, 0.5199497, 0.1817881, 0.4603082]], [[0.0392527, 0.3926234, 0.1514541, 0.3345990], [0.0153441, 0.1958137, 0.0494930, 0.1907236]]]]

Expected (Unparsed): [[[[0.06225749432,0.532193120935,0.260983546215,0.46030824270799997],[0.04892969140499999,0.5199496981649999,0.18178807267099997,0.46030824270799997]],[[0.039252742724,0.39262338839199995,0.151454075952,0.334598949016],[0.015344086484999998,0.19581370930499994,0.049493023730999994,0.190723634988]]]]

Actual:   [[[[0.0623, 0.5322, 0.261, 0.4604], [0.049, 0.52, 0.1818, 0.4604]], [[0.0393, 0.3927, 0.1515, 0.3346], [0.0154, 0.1959, 0.0495, 0.1908]]]]

Expected: [[[[0.0623, 0.5322, 0.261, 0.4604], [0.049, 0.52, 0.1818, 0.4604]], [[0.0393, 0.3927, 0.1515, 0.3346], [0.0154, 0.1959, 0.0495, 0.1908]]]]