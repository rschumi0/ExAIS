import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL24785 = tf.keras.layers.Input(shape=([2, 1, 1]))

ReL24785 = keras.layers.ReLU(max_value=2.495580458470327, negative_slope=6.796600597371909, threshold=8.855565837815039, name = 'ReL24785', input_shape=(2, 1, 1))(in0ReL24785)
Res28331 = keras.layers.Reshape((2, 1), name = 'Res28331', )(ReL24785)
Con60258 = keras.layers.Conv1D(3, (2),strides=(1), padding='same', dilation_rate=(1), name = 'Con60258', )(Res28331)
GRU1429 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU1429', )(Con60258)
model = tf.keras.models.Model(inputs=[in0ReL24785], outputs=GRU1429)
w = model.get_layer('Con60258').get_weights() 
w[0] = np.array([[[0.7398, 0.0868, 0.0893]], [[0.0117, 0.2242, 0.2985]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con60258').set_weights(w) 
w = model.get_layer('GRU1429').get_weights() 
w[0] = np.array([[10, 1, 10, 6, 5, 10], [2, 4, 2, 7, 8, 1], [2, 8, 6, 3, 10, 7]])
w[1] = np.array([[4, 1, 10, 5, 9, 6], [7, 7, 6, 9, 8, 3]])
w[2] = np.array([[6, 9, 2, 10, 10, 7], [8, 10, 8, 10, 3, 2]])
model.get_layer('GRU1429').set_weights(w) 
in0ReL24785 = tf.constant([[[[0.8713]], [[0.9443]]]])
print (np.array2string(model.predict([in0ReL24785],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU1429.png')

LReL24785 = relu_layer([[[[0.8713]], [[0.9443]]]], 2.495580458470327, 6.796600597371909, 8.855565837815039, ReL24785), 
LRes28331 = reshape_layer(ReL24785, [2, 1], Res28331), 
LCon60258 = conv1D_layer(Res28331, 2,[[[0.7398, 0.0868, 0.0893]], [[0.0117, 0.2242, 0.2985]]],[0, 0, 0], 1, true, 1, Con60258), 
LGRU1429 = gru_layer(Con60258,[[10, 1, 10, 6, 5, 10], [2, 4, 2, 7, 8, 1], [2, 8, 6, 3, 10, 7]],[[4, 1, 10, 5, 9, 6], [7, 7, 6, 9, 8, 3]],[[6, 9, 2, 10, 10, 7], [8, 10, 8, 10, 3, 2]], true, GRU1429), 
exec_layers([LReL24785,LRes28331,LCon60258,LGRU1429],["ReL24785","Res28331","Con60258","GRU1429"],GRU1429,"GRU1429")

Actual (Unparsed): [[-1.0000000, -1.0000000]]

Expected (Unparsed): [[-1.0,-1.0]]

Actual:   [[-1, -1]]

Expected: [[-1, -1]]