import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub19961 = tf.keras.layers.Input(shape=([3]))
in1Sub19961 = tf.keras.layers.Input(shape=([3]))
in0Con45297 = tf.keras.layers.Input(shape=([3, 1]))
in0Con88070 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Sub19961 = keras.layers.Subtract(name = 'Sub19961', )([in0Sub19961,in1Sub19961])
Res14793 = keras.layers.Reshape((3, 1), name = 'Res14793', )(Sub19961)
Con45297 = keras.layers.Concatenate(axis=2, name = 'Con45297', )([Res14793,in0Con45297])
Con88070 = keras.layers.Conv3DTranspose(3, (1, 2, 1),strides=(1, 3, 1), padding='valid', name = 'Con88070', )(in0Con88070)
Up_70483 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_70483', )(Con88070)
Res3292 = keras.layers.Reshape((2, 6, 6), name = 'Res3292', )(Up_70483)
Res31871 = keras.layers.Reshape((2, 36), name = 'Res31871', )(Res3292)
Con87616 = keras.layers.Conv1D(2, (2),strides=(1), padding='valid', dilation_rate=(1), name = 'Con87616', )(Res31871)
Zer19319 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer19319', )(Con87616)
Add54728 = keras.layers.Add(name = 'Add54728', )([Con45297,Zer19319])
model = tf.keras.models.Model(inputs=[in0Sub19961,in1Sub19961,in0Con45297,in0Con88070], outputs=Add54728)
w = model.get_layer('Con88070').get_weights() 
w[0] = np.array([[[[[0.7381, 0.705], [0.5887, 0.0362], [0.1913, 0.901]]], [[[0.4637, 0.943], [0.2775, 0.0049], [0.2967, 0.9864]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con88070').set_weights(w) 
w = model.get_layer('Con87616').get_weights() 
w[0] = np.array([[[0.9275, 0.2552], [0.8789, 0.2138], [0.0461, 0.2879], [0.4017, 0.2596], [0.6963, 0.0559], [0.3237, 0.1424], [0.6769, 0.7947], [0.8266, 0.5449], [0.7072, 0.1536], [0.8561, 0.0792], [0.0791, 0.1291], [0.3148, 0.0273], [0.9336, 0.319], [0.868, 0.889], [0.3527, 0.4751], [0.8269, 0.7235], [0.2597, 0.4193], [0.017, 0.6312], [0.4621, 0.2705], [0.0203, 0.3629], [0.0355, 0.5824], [0.6873, 0.9688], [0.6492, 0.4332], [0.3534, 0.601], [0.3641, 0.7277], [0.7695, 0.0705], [0.8934, 0.9721], [0.3546, 0.5258], [0.3139, 0.5644], [0.0146, 0.6677], [0.7357, 0.2084], [0.437, 0.2435], [0.4965, 0.4018], [0.4653, 0.1764], [0.0334, 0.076], [0.8858, 0.5754]], [[0.7015, 0.3722], [0.7194, 0.043], [0.4607, 0.2271], [0.8978, 0.1559], [0.53, 0.9114], [0.0285, 0.7252], [0.8228, 0.9135], [0.8027, 0.4617], [0.2183, 0.5966], [0.4859, 0.9682], [0.4995, 0.8671], [0.8443, 0.5617], [0.093, 0.6884], [0.8083, 0.2859], [0.5845, 0.6525], [0.1503, 0.6198], [0.3487, 0.9739], [0.464, 0.8068], [0.5369, 0.2137], [0.771, 0.437], [0.0899, 0.7598], [0.1534, 0.8966], [0.4117, 0.5876], [0.9134, 0.5685], [0.8288, 0.113], [0.8929, 0.2147], [0.985, 0.0077], [0.7529, 0.7986], [0.8799, 0.6951], [0.2096, 0.1184], [0.3409, 0.8699], [0.4478, 0.0124], [0.3433, 0.7903], [0.1971, 0.5714], [0.7362, 0.2837], [0.2386, 0.7454]]])
w[1] = np.array([0, 0])
model.get_layer('Con87616').set_weights(w) 
in0Sub19961 = tf.constant([[0.1912, 0.2774, 0.3196]])
in1Sub19961 = tf.constant([[0.6666, 0.7842, 0.888]])
in0Con45297 = tf.constant([[[0.3458], [0.2542], [0.9132]]])
in0Con88070 = tf.constant([[[[[0.632, 0.7913]], [[0.8518, 0.7808]]], [[[0.6069, 0.33]], [[0.1737, 0.1245]]]]])
print (np.array2string(model.predict([in0Sub19961,in1Sub19961,in0Con45297,in0Con88070],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add54728.png')

LSub19961 = subtract_layer([[0.1912, 0.2774, 0.3196]], [[0.6666, 0.7842, 0.888]], Sub19961), 
LRes14793 = reshape_layer(Sub19961, [3, 1], Res14793), 
LCon45297 = concatenate_layer([Res14793,[[[0.3458], [0.2542], [0.9132]]]], 2, Con45297), 
LCon88070 = conv3D_transpose_layer([[[[[0.632, 0.7913]], [[0.8518, 0.7808]]], [[[0.6069, 0.33]], [[0.1737, 0.1245]]]]], 1, 2, 1,[[[[[0.7381, 0.705], [0.5887, 0.0362], [0.1913, 0.901]]], [[[0.4637, 0.943], [0.2775, 0.0049], [0.2967, 0.9864]]]]],[0, 0, 0], 1, 3, 1, false, Con88070), 
LUp_70483 = up_sampling3D_layer(Con88070, 1, 1, 2, Up_70483), 
LRes3292 = reshape_layer(Up_70483, [2, 6, 6], Res3292), 
LRes31871 = reshape_layer(Res3292, [2, 36], Res31871), 
LCon87616 = conv1D_layer(Res31871, 2,[[[0.9275, 0.2552], [0.8789, 0.2138], [0.0461, 0.2879], [0.4017, 0.2596], [0.6963, 0.0559], [0.3237, 0.1424], [0.6769, 0.7947], [0.8266, 0.5449], [0.7072, 0.1536], [0.8561, 0.0792], [0.0791, 0.1291], [0.3148, 0.0273], [0.9336, 0.319], [0.868, 0.889], [0.3527, 0.4751], [0.8269, 0.7235], [0.2597, 0.4193], [0.017, 0.6312], [0.4621, 0.2705], [0.0203, 0.3629], [0.0355, 0.5824], [0.6873, 0.9688], [0.6492, 0.4332], [0.3534, 0.601], [0.3641, 0.7277], [0.7695, 0.0705], [0.8934, 0.9721], [0.3546, 0.5258], [0.3139, 0.5644], [0.0146, 0.6677], [0.7357, 0.2084], [0.437, 0.2435], [0.4965, 0.4018], [0.4653, 0.1764], [0.0334, 0.076], [0.8858, 0.5754]], [[0.7015, 0.3722], [0.7194, 0.043], [0.4607, 0.2271], [0.8978, 0.1559], [0.53, 0.9114], [0.0285, 0.7252], [0.8228, 0.9135], [0.8027, 0.4617], [0.2183, 0.5966], [0.4859, 0.9682], [0.4995, 0.8671], [0.8443, 0.5617], [0.093, 0.6884], [0.8083, 0.2859], [0.5845, 0.6525], [0.1503, 0.6198], [0.3487, 0.9739], [0.464, 0.8068], [0.5369, 0.2137], [0.771, 0.437], [0.0899, 0.7598], [0.1534, 0.8966], [0.4117, 0.5876], [0.9134, 0.5685], [0.8288, 0.113], [0.8929, 0.2147], [0.985, 0.0077], [0.7529, 0.7986], [0.8799, 0.6951], [0.2096, 0.1184], [0.3409, 0.8699], [0.4478, 0.0124], [0.3433, 0.7903], [0.1971, 0.5714], [0.7362, 0.2837], [0.2386, 0.7454]]],[0, 0], 1, false, 1, Con87616), 
LZer19319 = zero_padding1D_layer(Con87616, 2, 0, Zer19319), 
LAdd54728 = add_layer([Con45297,Zer19319], Add54728), 
exec_layers([LSub19961,LRes14793,LCon45297,LCon88070,LUp_70483,LRes3292,LRes31871,LCon87616,LZer19319,LAdd54728],["Sub19961","Res14793","Con45297","Con88070","Up_70483","Res3292","Res31871","Con87616","Zer19319","Add54728"],Add54728,"Add54728")

Actual (Unparsed): [[[-0.4754000, 0.3458000], [-0.5068000, 0.2542000], [12.8420168, 13.0892708]]]

Expected (Unparsed): [[[-0.47539999999999993,0.3458],[-0.5068,0.2542],[12.842016700605008,13.089270720726997]]]

Actual:   [[[-0.4754, 0.3458], [-0.5068, 0.2542], [12.8421, 13.0893]]]

Expected: [[[-0.4753, 0.3458], [-0.5068, 0.2542], [12.8421, 13.0893]]]