import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add22765 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Add22765 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Glo99988 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Con42841 = tf.keras.layers.Input(shape=([6]))

Add22765 = keras.layers.Add(name = 'Add22765', )([in0Add22765,in1Add22765])
Res85978 = keras.layers.Reshape((2, 4), name = 'Res85978', )(Add22765)
Fla629 = keras.layers.Flatten(name = 'Fla629', )(Res85978)
Glo99988 = keras.layers.GlobalAveragePooling3D(name = 'Glo99988', )(in0Glo99988)
Con42841 = keras.layers.Concatenate(axis=1, name = 'Con42841', )([Glo99988,in0Con42841])
Max6888 = keras.layers.Maximum(name = 'Max6888', )([Fla629,Con42841])
Sof27896 = keras.layers.Softmax(axis=1, name = 'Sof27896', )(Max6888)
model = tf.keras.models.Model(inputs=[in0Add22765,in1Add22765,in0Glo99988,in0Con42841], outputs=Sof27896)
in0Add22765 = tf.constant([[[[0.8963, 0.961], [0.6165, 0.5398]], [[0.9058, 0.4074], [0.0271, 0.4157]]]])
in1Add22765 = tf.constant([[[[0.302, 0.7297], [0.6322, 0.5953]], [[0.2808, 0.4468], [0.1047, 0.2068]]]])
in0Glo99988 = tf.constant([[[[[1.2472, 1.6221]]], [[[1.6575, 1.3738]]]]])
in0Con42841 = tf.constant([[0.7459, 0.8738, 0.4472, 0.0731, 0.436, 0.8231]])
print (np.array2string(model.predict([in0Add22765,in1Add22765,in0Glo99988,in0Con42841],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof27896.png')

LAdd22765 = add_layer([[[[[0.8963, 0.961], [0.6165, 0.5398]], [[0.9058, 0.4074], [0.0271, 0.4157]]]], [[[[0.302, 0.7297], [0.6322, 0.5953]], [[0.2808, 0.4468], [0.1047, 0.2068]]]]], Add22765), 
LRes85978 = reshape_layer(Add22765, [2, 4], Res85978), 
LFla629 = flatten_layer(Res85978, Fla629), 
LGlo99988 = global_average_pooling3D_layer([[[[[1.2472, 1.6221]]], [[[1.6575, 1.3738]]]]], Glo99988), 
LCon42841 = concatenate_layer([Glo99988,[[0.7459, 0.8738, 0.4472, 0.0731, 0.436, 0.8231]]], 1, Con42841), 
LMax6888 = maximum_layer([Fla629,Con42841], Max6888), 
LSof27896 = softmax_layer(Max6888, 1, Sof27896), 
exec_layers([LAdd22765,LRes85978,LFla629,LGlo99988,LCon42841,LMax6888,LSof27896],["Add22765","Res85978","Fla629","Glo99988","Con42841","Max6888","Sof27896"],Sof27896,"Sof27896")

Actual (Unparsed): [[0.1659913, 0.2106684, 0.1354070, 0.1208663, 0.1272540, 0.0912666, 0.0600745, 0.0884719]]

Expected (Unparsed): [[0.1659912648962133,0.2106683647281835,0.13540701463105284,0.12086632294800503,0.12725400976592932,0.09126662483721132,0.06007448241058725,0.08847191578281752]]

Actual:   [[0.166, 0.2107, 0.1355, 0.1209, 0.1273, 0.0913, 0.0601, 0.0885]]

Expected: [[0.166, 0.2107, 0.1355, 0.1209, 0.1273, 0.0913, 0.0601, 0.0885]]