import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min87806 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min87806 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Sof44642 = tf.keras.layers.Input(shape=([2, 2]))

Min87806 = keras.layers.Minimum(name = 'Min87806', )([in0Min87806,in1Min87806])
Res90779 = keras.layers.Reshape((2, 1, 2), name = 'Res90779', )(Min87806)
Res49428 = keras.layers.Reshape((2, 2), name = 'Res49428', )(Res90779)
Sof44642 = keras.layers.Softmax(axis=1, name = 'Sof44642', input_shape=(2, 2))(in0Sof44642)
Min99119 = keras.layers.Minimum(name = 'Min99119', )([Res49428,Sof44642])
Res7042 = keras.layers.Reshape((2, 2, 1), name = 'Res7042', )(Min99119)
Loc63407 = keras.layers.LocallyConnected2D(2, (1, 2),strides=(1, 12), name = 'Loc63407', )(Res7042)
Res70887 = keras.layers.Reshape((2, 2), name = 'Res70887', )(Loc63407)
Sep42697 = keras.layers.SeparableConv1D(2, (1),strides=(2), padding='same', name = 'Sep42697', )(Res70887)
model = tf.keras.models.Model(inputs=[in0Min87806,in1Min87806,in0Sof44642], outputs=Sep42697)
w = model.get_layer('Loc63407').get_weights() 
w[0] = np.array([[[0.8181, 0.031], [0.2695, 0.7742]], [[0.3879, 0.7097], [0.5625, 0.252]]])
w[1] = np.array([[[0, 0]], [[0, 0]]])
model.get_layer('Loc63407').set_weights(w) 
w = model.get_layer('Sep42697').get_weights() 
w[0] = np.array([[[0.1651], [0.871]]])
w[1] = np.array([[[0.6869, 0.9293], [0.8847, 0.5319]]])
w[2] = np.array([0, 0])
model.get_layer('Sep42697').set_weights(w) 
in0Min87806 = tf.constant([[[[[0.5198], [0.4525]]], [[[0.437], [0.3102]]]]])
in1Min87806 = tf.constant([[[[[0.708], [0.7265]]], [[[0.6049], [0.9448]]]]])
in0Sof44642 = tf.constant([[[0.3554, 0.8424], [0.2258, 0.9334]]])
print (np.array2string(model.predict([in0Min87806,in1Min87806,in0Sof44642],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep42697.png')

LMin87806 = minimum_layer([[[[[[0.5198], [0.4525]]], [[[0.437], [0.3102]]]]], [[[[[0.708], [0.7265]]], [[[0.6049], [0.9448]]]]]], Min87806), 
LRes90779 = reshape_layer(Min87806, [2, 1, 2], Res90779), 
LRes49428 = reshape_layer(Res90779, [2, 2], Res49428), 
LSof44642 = softmax_layer([[[0.3554, 0.8424], [0.2258, 0.9334]]], 1, Sof44642), 
LMin99119 = minimum_layer([Res49428,Sof44642], Min99119), 
LRes7042 = reshape_layer(Min99119, [2, 2, 1], Res7042), 
LLoc63407 = locally_connected2D_layer(Res7042, 1, 2,[[[0.8181, 0.031], [0.2695, 0.7742]], [[0.3879, 0.7097], [0.5625, 0.252]]],[[[0, 0]], [[0, 0]]], 1, 12, Loc63407), 
LRes70887 = reshape_layer(Loc63407, [2, 2], Res70887), 
LSep42697 = separable_conv1D_layer(Res70887, 1,[[[[0.1651], [0.871]]],[[[0.6869, 0.9293], [0.8847, 0.5319]]]],[0, 0], 2, true, Sep42697), 
exec_layers([LMin87806,LRes90779,LRes49428,LSof44642,LMin99119,LRes7042,LLoc63407,LRes70887,LSep42697],["Min87806","Res90779","Res49428","Sof44642","Min99119","Res7042","Loc63407","Res70887","Sep42697"],Sep42697,"Sep42697")

Actual (Unparsed): [[[0.3444246, 0.2537208]]]

Expected (Unparsed): [[[0.34442457611577476,0.2537208438158459]]]

Actual:   [[[0.3445, 0.2538]]]

Expected: [[[0.3445, 0.2538]]]