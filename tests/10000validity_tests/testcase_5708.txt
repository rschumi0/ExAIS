import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub913 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub913 = tf.keras.layers.Input(shape=([3, 3, 3]))

Sub913 = keras.layers.Subtract(name = 'Sub913', )([in0Sub913,in1Sub913])
Res76105 = keras.layers.Reshape((3, 9), name = 'Res76105', )(Sub913)
LST46792 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST46792', )(Res76105)
Res41545 = keras.layers.Reshape((1, 1), name = 'Res41545', )(LST46792)
Cro66647 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro66647', )(Res41545)
model = tf.keras.models.Model(inputs=[in0Sub913,in1Sub913], outputs=Cro66647)
w = model.get_layer('LST46792').get_weights() 
w[0] = np.array([[10, 3, 3, 7], [5, 6, 3, 5], [6, 9, 8, 7], [1, 3, 10, 5], [7, 4, 5, 5], [8, 5, 5, 8], [3, 5, 7, 3], [1, 6, 5, 9], [3, 3, 3, 1]])
w[1] = np.array([[4, 6, 8, 6]])
w[2] = np.array([2, 5, 3, 8])
model.get_layer('LST46792').set_weights(w) 
in0Sub913 = tf.constant([[[[0.99, 0.2374, 0.8038], [0.3307, 0.9584, 0.2109], [0.9352, 0.9285, 0.0231]], [[0.8332, 0.1124, 0.5701], [0.4763, 0.5203, 0.8379], [0.5383, 0.3266, 0.9856]], [[0.6319, 0.829, 0.8935], [0.7442, 0.86, 0.7231], [0.1522, 0.0542, 0.206]]]])
in1Sub913 = tf.constant([[[[0.8772, 0.6124, 0.8908], [0.1437, 0.5058, 0.1289], [0.5449, 0.9508, 0.9309]], [[0.0639, 0.0899, 0.9117], [0.6275, 0.6459, 0.2745], [0.3555, 0.9099, 0.204]], [[0.3591, 0.0904, 0.57], [0.1954, 0.0407, 0.6126], [0.1051, 0.5897, 0.8864]]]])
print (np.array2string(model.predict([in0Sub913,in1Sub913],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro66647.png')

LSub913 = subtract_layer([[[[0.99, 0.2374, 0.8038], [0.3307, 0.9584, 0.2109], [0.9352, 0.9285, 0.0231]], [[0.8332, 0.1124, 0.5701], [0.4763, 0.5203, 0.8379], [0.5383, 0.3266, 0.9856]], [[0.6319, 0.829, 0.8935], [0.7442, 0.86, 0.7231], [0.1522, 0.0542, 0.206]]]], [[[[0.8772, 0.6124, 0.8908], [0.1437, 0.5058, 0.1289], [0.5449, 0.9508, 0.9309]], [[0.0639, 0.0899, 0.9117], [0.6275, 0.6459, 0.2745], [0.3555, 0.9099, 0.204]], [[0.3591, 0.0904, 0.57], [0.1954, 0.0407, 0.6126], [0.1051, 0.5897, 0.8864]]]], Sub913), 
LRes76105 = reshape_layer(Sub913, [3, 9], Res76105), 
LLST46792 = lstm_layer(Res76105,[[10, 3, 3, 7], [5, 6, 3, 5], [6, 9, 8, 7], [1, 3, 10, 5], [7, 4, 5, 5], [8, 5, 5, 8], [3, 5, 7, 3], [1, 6, 5, 9], [3, 3, 3, 1]],[[4, 6, 8, 6]],[2, 5, 3, 8], LST46792), 
LRes41545 = reshape_layer(LST46792, [1, 1], Res41545), 
LCro66647 = cropping1D_layer(Res41545, 0, 0, Cro66647), 
exec_layers([LSub913,LRes76105,LLST46792,LRes41545,LCro66647],["Sub913","Res76105","LST46792","Res41545","Cro66647"],Cro66647,"Cro66647")

Actual (Unparsed): [[[0.9946392]]]

Expected (Unparsed): [[[0.9946391533689607]]]

Actual:   [[[0.9947]]]

Expected: [[[0.9947]]]