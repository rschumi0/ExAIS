import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot41108 = tf.keras.layers.Input(shape=([3]))
in1Dot41108 = tf.keras.layers.Input(shape=([3]))
in0Con77190 = tf.keras.layers.Input(shape=([1, 2, 3]))
in0Sep78560 = tf.keras.layers.Input(shape=([2, 2, 2]))

Dot41108 = keras.layers.Dot(axes=(1, 1), name = 'Dot41108', )([in0Dot41108,in1Dot41108])
Res78411 = keras.layers.Reshape((1, 1), name = 'Res78411', )(Dot41108)
Res82198 = keras.layers.Reshape((1, 1, 1), name = 'Res82198', )(Res78411)
Zer37877 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer37877', )(Res82198)
Con77190 = keras.layers.Concatenate(axis=3, name = 'Con77190', )([Zer37877,in0Con77190])
Sep78560 = keras.layers.SeparableConv2D(3, (2, 2),strides=(1, 1), padding='same', name = 'Sep78560', )(in0Sep78560)
Loc85113 = keras.layers.LocallyConnected2D(4, (2, 1),strides=(1, 1), name = 'Loc85113', )(Sep78560)
Lay79495 = keras.layers.LayerNormalization(axis=1, epsilon=1.743368277782886, name = 'Lay79495', )(Loc85113)
Sub39978 = keras.layers.Subtract(name = 'Sub39978', )([Con77190,Lay79495])
model = tf.keras.models.Model(inputs=[in0Dot41108,in1Dot41108,in0Con77190,in0Sep78560], outputs=Sub39978)
w = model.get_layer('Sep78560').get_weights() 
w[0] = np.array([[[[0.43], [0.3249]], [[0.0556], [0.3491]]], [[[0.1413], [0.0843]], [[0.8589], [0.8782]]]])
w[1] = np.array([[[[0.748, 0.4853, 0.7255], [0.4117, 0.288, 0.3157]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep78560').set_weights(w) 
w = model.get_layer('Loc85113').get_weights() 
w[0] = np.array([[[0.3892, 0.7463, 0.5531, 0.2352], [0.0087, 0.2977, 0.3265, 0.5905], [0.8547, 0.4037, 0.5661, 0.6616], [0.1102, 0.9794, 0.4217, 0.9381], [0.2668, 0.839, 0.8067, 0.1075], [0.212, 0.3534, 0.3045, 0.7574]], [[0.2445, 0.8459, 0.1884, 0.012], [0.2584, 0.0288, 0.8826, 0.7328], [0.7667, 0.5083, 0.26, 0.8999], [0.3965, 0.8845, 0.2807, 0.0572], [0.9832, 0.2532, 0.6023, 0.2509], [0.413, 0.9853, 0.9634, 0.7209]]])
w[1] = np.array([[[0, 0, 0, 0], [0, 0, 0, 0]]])
model.get_layer('Loc85113').set_weights(w) 
in0Dot41108 = tf.constant([[0.6921, 0.139, 0.7603]])
in1Dot41108 = tf.constant([[0.3582, 0.3278, 0.2806]])
in0Con77190 = tf.constant([[[[0.5077, 0.4751, 0.9401], [0.0715, 0.7202, 0.079]]]])
in0Sep78560 = tf.constant([[[[0.3608, 0.9332], [0.8635, 0.116]], [[0.257, 0.5579], [0.6968, 0.0402]]]])
print (np.array2string(model.predict([in0Dot41108,in1Dot41108,in0Con77190,in0Sep78560],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub39978.png')

LDot41108 = dot_layer([[0.6921, 0.139, 0.7603]], [[0.3582, 0.3278, 0.2806]], 1, 1, Dot41108), 
LRes78411 = reshape_layer(Dot41108, [1, 1], Res78411), 
LRes82198 = reshape_layer(Res78411, [1, 1, 1], Res82198), 
LZer37877 = zero_padding2D_layer(Res82198, 0, 0, 1, 0, Zer37877), 
LCon77190 = concatenate_layer([Zer37877,[[[[0.5077, 0.4751, 0.9401], [0.0715, 0.7202, 0.079]]]]], 3, Con77190), 
LSep78560 = separable_conv2D_layer([[[[0.3608, 0.9332], [0.8635, 0.116]], [[0.257, 0.5579], [0.6968, 0.0402]]]], 2, 2,[[[[[0.43], [0.3249]], [[0.0556], [0.3491]]], [[[0.1413], [0.0843]], [[0.8589], [0.8782]]]],[[[[0.748, 0.4853, 0.7255], [0.4117, 0.288, 0.3157]]]]],[0, 0, 0], 1, 1, true, Sep78560), 
LLoc85113 = locally_connected2D_layer(Sep78560, 2, 1,[[[0.3892, 0.7463, 0.5531, 0.2352], [0.0087, 0.2977, 0.3265, 0.5905], [0.8547, 0.4037, 0.5661, 0.6616], [0.1102, 0.9794, 0.4217, 0.9381], [0.2668, 0.839, 0.8067, 0.1075], [0.212, 0.3534, 0.3045, 0.7574]], [[0.2445, 0.8459, 0.1884, 0.012], [0.2584, 0.0288, 0.8826, 0.7328], [0.7667, 0.5083, 0.26, 0.8999], [0.3965, 0.8845, 0.2807, 0.0572], [0.9832, 0.2532, 0.6023, 0.2509], [0.413, 0.9853, 0.9634, 0.7209]]],[[[0, 0, 0, 0], [0, 0, 0, 0]]], 1, 1, Loc85113), 
LLay79495 = layer_normalization_layer(Loc85113, 1, 1.743368277782886, Lay79495), 
LSub39978 = subtract_layer(Con77190,Lay79495, Sub39978), 
exec_layers([LDot41108,LRes78411,LRes82198,LZer37877,LCon77190,LSep78560,LLoc85113,LLay79495,LSub39978],["Dot41108","Res78411","Res82198","Zer37877","Con77190","Sep78560","Loc85113","Lay79495","Sub39978"],Sub39978,"Sub39978")

Actual (Unparsed): [[[[0.0000000, 0.5077000, 0.4751000, 0.9401000], [0.5068146, 0.0715000, 0.7202000, 0.0790000]]]]

Expected (Unparsed): [[[[0.0,0.5077,0.4751,0.9401],[0.5068146,0.0715,0.7202,0.079]]]]

Actual:   [[[[0, 0.5077, 0.4751, 0.9401], [0.5069, 0.0715, 0.7202, 0.079]]]]

Expected: [[[[0, 0.5077, 0.4751, 0.9401], [0.5069, 0.0715, 0.7202, 0.079]]]]