import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul27355 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Mul27355 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Mul27355 = keras.layers.Multiply(name = 'Mul27355', )([in0Mul27355,in1Mul27355])
Res64617 = keras.layers.Reshape((1, 1, 1), name = 'Res64617', )(Mul27355)
Res2303 = keras.layers.Reshape((1, 1), name = 'Res2303', )(Res64617)
GRU13703 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU13703', )(Res2303)
model = tf.keras.models.Model(inputs=[in0Mul27355,in1Mul27355], outputs=GRU13703)
w = model.get_layer('GRU13703').get_weights() 
w[0] = np.array([[9, 2, 8]])
w[1] = np.array([[10, 5, 9]])
w[2] = np.array([[5, 4, 5], [3, 3, 7]])
model.get_layer('GRU13703').set_weights(w) 
in0Mul27355 = tf.constant([[[[[0.934]]]]])
in1Mul27355 = tf.constant([[[[[0.8367]]]]])
print (np.array2string(model.predict([in0Mul27355,in1Mul27355],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU13703.png')

LMul27355 = multiply_layer([[[[[[0.934]]]]], [[[[[0.8367]]]]]], Mul27355), 
LRes64617 = reshape_layer(Mul27355, [1, 1, 1], Res64617), 
LRes2303 = reshape_layer(Res64617, [1, 1], Res2303), 
LGRU13703 = gru_layer(Res2303,[[9, 2, 8]],[[10, 5, 9]],[[5, 4, 5], [3, 3, 7]], true, GRU13703), 
exec_layers([LMul27355,LRes64617,LRes2303,LGRU13703],["Mul27355","Res64617","Res2303","GRU13703"],GRU13703,"GRU13703")

Actual (Unparsed): [[0.0000003]]

Expected (Unparsed): [[2.9588336547536887e-7]]

Actual:   [[0]]

Expected: [[0]]