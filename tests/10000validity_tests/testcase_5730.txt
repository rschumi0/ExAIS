import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min14337 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Min14337 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Min50599 = tf.keras.layers.Input(shape=([1, 2]))
in1Min50599 = tf.keras.layers.Input(shape=([1, 2]))

Min14337 = keras.layers.Minimum(name = 'Min14337', )([in0Min14337,in1Min14337])
Bat42250 = keras.layers.BatchNormalization(axis=2, epsilon=0.929358179220561,  name = 'Bat42250', )(Min14337)
Res30794 = keras.layers.Reshape((2, 1, 2), name = 'Res30794', )(Bat42250)
Res23370 = keras.layers.Reshape((2, 2), name = 'Res23370', )(Res30794)
Min50599 = keras.layers.Minimum(name = 'Min50599', )([in0Min50599,in1Min50599])
Cro62899 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro62899', )(Min50599)
Zer74070 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer74070', )(Cro62899)
Sub91635 = keras.layers.Subtract(name = 'Sub91635', )([Res23370,Zer74070])
model = tf.keras.models.Model(inputs=[in0Min14337,in1Min14337,in0Min50599,in1Min50599], outputs=Sub91635)
w = model.get_layer('Bat42250').get_weights() 
w[0] = np.array([0.4686])
w[1] = np.array([0.3672])
w[2] = np.array([0.6649])
w[3] = np.array([0.4595])
model.get_layer('Bat42250').set_weights(w) 
in0Min14337 = tf.constant([[[[[0.5133, 0.3079]]], [[[0.7794, 0.1247]]]]])
in1Min14337 = tf.constant([[[[[0.5824, 0.6135]]], [[[0.298, 0.0984]]]]])
in0Min50599 = tf.constant([[[0.4751, 0.2629]]])
in1Min50599 = tf.constant([[[0.4404, 0.8839]]])
print (np.array2string(model.predict([in0Min14337,in1Min14337,in0Min50599,in1Min50599],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub91635.png')

LMin14337 = minimum_layer([[[[[[0.5133, 0.3079]]], [[[0.7794, 0.1247]]]]], [[[[[0.5824, 0.6135]]], [[[0.298, 0.0984]]]]]], Min14337), 
LBat42250 = batch_normalization_layer(Min14337, 2, 0.929358179220561, [0.4686], [0.3672], [0.6649], [0.4595], Bat42250), 
LRes30794 = reshape_layer(Bat42250, [2, 1, 2], Res30794), 
LRes23370 = reshape_layer(Res30794, [2, 2], Res23370), 
LMin50599 = minimum_layer([[[[0.4751, 0.2629]]], [[[0.4404, 0.8839]]]], Min50599), 
LCro62899 = cropping1D_layer(Min50599, 0, 0, Cro62899), 
LZer74070 = zero_padding1D_layer(Cro62899, 1, 0, Zer74070), 
LSub91635 = subtract_layer(Res23370,Zer74070, Sub91635), 
exec_layers([LMin14337,LBat42250,LRes30794,LRes23370,LMin50599,LCro62899,LZer74070,LSub91635],["Min14337","Bat42250","Res30794","Res23370","Min50599","Cro62899","Zer74070","Sub91635"],Sub91635,"Sub91635")

Actual (Unparsed): [[[0.3069201, 0.2252480], [-0.2190885, -0.1209544]]]

Expected (Unparsed): [[[0.306920098337195,0.2252479888283551],[-0.21908849551506032,-0.12095438187321247]]]

Actual:   [[[0.307, 0.2253], [-0.219, -0.1209]]]

Expected: [[[0.307, 0.2253], [-0.219, -0.1209]]]