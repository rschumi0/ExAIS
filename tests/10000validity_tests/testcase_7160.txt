import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub39653 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub39653 = tf.keras.layers.Input(shape=([3, 3, 3]))
in0Min89944 = tf.keras.layers.Input(shape=([1, 2]))
in1Min89944 = tf.keras.layers.Input(shape=([1, 2]))
in0Con87867 = tf.keras.layers.Input(shape=([2, 1]))

Sub39653 = keras.layers.Subtract(name = 'Sub39653', )([in0Sub39653,in1Sub39653])
Cro67046 = keras.layers.Cropping2D(cropping=((1, 0), (2, 0)), name = 'Cro67046', )(Sub39653)
Res34240 = keras.layers.Reshape((2, 3), name = 'Res34240', )(Cro67046)
Min89944 = keras.layers.Minimum(name = 'Min89944', )([in0Min89944,in1Min89944])
Zer60430 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer60430', )(Min89944)
Con87867 = keras.layers.Concatenate(axis=2, name = 'Con87867', )([Zer60430,in0Con87867])
Ave55072 = keras.layers.Average(name = 'Ave55072', )([Res34240,Con87867])
model = tf.keras.models.Model(inputs=[in0Sub39653,in1Sub39653,in0Min89944,in1Min89944,in0Con87867], outputs=Ave55072)
in0Sub39653 = tf.constant([[[[0.6556, 0.8686, 0.3549], [0.8188, 0.2317, 0.7969], [0.3954, 0.7691, 0.9434]], [[0.309, 0.6149, 0.7401], [0.5946, 0.9934, 0.7568], [0.0413, 0.4044, 0.6674]], [[0.6041, 0.8124, 0.3457], [0.9028, 0.4136, 0.7684], [0.3817, 0.876, 0.0137]]]])
in1Sub39653 = tf.constant([[[[0.281, 0.4323, 0.5924], [0.2215, 0.2752, 0.555], [0.2174, 0.0216, 0.8792]], [[0.0007, 0.7227, 0.7733], [0.4962, 0.5221, 0.3016], [0.5619, 0.9859, 0.5505]], [[0.0431, 0.6983, 0.9415], [0.6353, 0.1672, 0.2802], [0.626, 0.8442, 0.7167]]]])
in0Min89944 = tf.constant([[[0.6807, 0.9918]]])
in1Min89944 = tf.constant([[[0.6579, 0.9798]]])
in0Con87867 = tf.constant([[[0.4578], [0.6331]]])
print (np.array2string(model.predict([in0Sub39653,in1Sub39653,in0Min89944,in1Min89944,in0Con87867],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave55072.png')

LSub39653 = subtract_layer([[[[0.6556, 0.8686, 0.3549], [0.8188, 0.2317, 0.7969], [0.3954, 0.7691, 0.9434]], [[0.309, 0.6149, 0.7401], [0.5946, 0.9934, 0.7568], [0.0413, 0.4044, 0.6674]], [[0.6041, 0.8124, 0.3457], [0.9028, 0.4136, 0.7684], [0.3817, 0.876, 0.0137]]]], [[[[0.281, 0.4323, 0.5924], [0.2215, 0.2752, 0.555], [0.2174, 0.0216, 0.8792]], [[0.0007, 0.7227, 0.7733], [0.4962, 0.5221, 0.3016], [0.5619, 0.9859, 0.5505]], [[0.0431, 0.6983, 0.9415], [0.6353, 0.1672, 0.2802], [0.626, 0.8442, 0.7167]]]], Sub39653), 
LCro67046 = cropping2D_layer(Sub39653, 1, 0, 2, 0, Cro67046), 
LRes34240 = reshape_layer(Cro67046, [2, 3], Res34240), 
LMin89944 = minimum_layer([[[[0.6807, 0.9918]]], [[[0.6579, 0.9798]]]], Min89944), 
LZer60430 = zero_padding1D_layer(Min89944, 1, 0, Zer60430), 
LCon87867 = concatenate_layer([Zer60430,[[[0.4578], [0.6331]]]], 2, Con87867), 
LAve55072 = average_layer([Res34240,Con87867], Ave55072), 
exec_layers([LSub39653,LCro67046,LRes34240,LMin89944,LZer60430,LCon87867,LAve55072],["Sub39653","Cro67046","Res34240","Min89944","Zer60430","Con87867","Ave55072"],Ave55072,"Ave55072")

Actual (Unparsed): [[[-0.2603000, -0.2907500, 0.2873500], [0.2068000, 0.5058000, -0.0349500]]]

Expected (Unparsed): [[[-0.2603,-0.29075,0.28735],[0.2068,0.5058,-0.03494999999999998]]]

Actual:   [[[-0.2603, -0.2907, 0.2874], [0.2068, 0.5058, -0.0349]]]

Expected: [[[-0.2603, -0.2907, 0.2874], [0.2068, 0.5058, -0.0349]]]