import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot89473 = tf.keras.layers.Input(shape=([2]))
in1Dot89473 = tf.keras.layers.Input(shape=([2]))
in0Con65944 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot154 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot154 = tf.keras.layers.Input(shape=([3, 2]))
in0Con77864 = tf.keras.layers.Input(shape=([3, 3, 1]))
in0Dep68505 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Max36096 = tf.keras.layers.Input(shape=([2, 1]))
in1Max36096 = tf.keras.layers.Input(shape=([2, 1]))
in0Con93347 = tf.keras.layers.Input(shape=([3, 5]))

Dot89473 = keras.layers.Dot(axes=(1, 1), name = 'Dot89473', )([in0Dot89473,in1Dot89473])
Res80059 = keras.layers.Reshape((1, 1), name = 'Res80059', )(Dot89473)
Zer80435 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer80435', )(Res80059)
Con65944 = keras.layers.Concatenate(axis=2, name = 'Con65944', )([Zer80435,in0Con65944])
Dot154 = keras.layers.Dot(axes=(2, 2), name = 'Dot154', )([in0Dot154,in1Dot154])
Max47246 = keras.layers.Maximum(name = 'Max47246', )([Con65944,Dot154])
Res57072 = keras.layers.Reshape((3, 3, 1), name = 'Res57072', )(Max47246)
Con77864 = keras.layers.Concatenate(axis=3, name = 'Con77864', )([Res57072,in0Con77864])
Dep68505 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep68505', )(in0Dep68505)
Zer35095 = keras.layers.ZeroPadding2D(padding=((2, 0), (2, 0)), name = 'Zer35095', )(Dep68505)
Add12401 = keras.layers.Add(name = 'Add12401', )([Con77864,Zer35095])
Res86390 = keras.layers.Reshape((3, 6), name = 'Res86390', )(Add12401)
Max36096 = keras.layers.Maximum(name = 'Max36096', )([in0Max36096,in1Max36096])
Zer88623 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer88623', )(Max36096)
Con93347 = keras.layers.Concatenate(axis=2, name = 'Con93347', )([Zer88623,in0Con93347])
Ave60748 = keras.layers.Average(name = 'Ave60748', )([Res86390,Con93347])
model = tf.keras.models.Model(inputs=[in0Dot89473,in1Dot89473,in0Con65944,in0Dot154,in1Dot154,in0Con77864,in0Dep68505,in0Max36096,in1Max36096,in0Con93347], outputs=Ave60748)
w = model.get_layer('Dep68505').get_weights() 
w[0] = np.array([[[[0.3586], [0.2788]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep68505').set_weights(w) 
in0Dot89473 = tf.constant([[0.8365, 0.4441]])
in1Dot89473 = tf.constant([[0.9353, 0.5793]])
in0Con65944 = tf.constant([[[0.8287, 0.923], [0.0115, 0.8316], [0.3943, 0.2863]]])
in0Dot154 = tf.constant([[[0.6502, 0.9491], [0.6761, 0.4408], [0.1043, 0.3801]]])
in1Dot154 = tf.constant([[[0.5148, 0.0974], [0.6676, 0.1106], [0.2012, 0.7012]]])
in0Con77864 = tf.constant([[[[0.0315], [0.5714], [0.4665]], [[0.3914], [0.0761], [0.3918]], [[0.8287], [0.4494], [0.586]]]])
in0Dep68505 = tf.constant([[[[0.4699, 0.6256]]]])
in0Max36096 = tf.constant([[[0.3266], [0.9344]]])
in1Max36096 = tf.constant([[[0.5202], [0.6271]]])
in0Con93347 = tf.constant([[[0.1607, 0.9597, 0.1316, 0.0072, 0.3518], [0.6835, 0.8156, 0.5895, 0.7725, 0.1093], [0.9539, 0.6939, 0.6835, 0.3758, 0.9765]]])
print (np.array2string(model.predict([in0Dot89473,in1Dot89473,in0Con65944,in0Dot154,in1Dot154,in0Con77864,in0Dep68505,in0Max36096,in1Max36096,in0Con93347],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave60748.png')

LDot89473 = dot_layer([[0.8365, 0.4441]], [[0.9353, 0.5793]], 1, 1, Dot89473), 
LRes80059 = reshape_layer(Dot89473, [1, 1], Res80059), 
LZer80435 = zero_padding1D_layer(Res80059, 2, 0, Zer80435), 
LCon65944 = concatenate_layer([Zer80435,[[[0.8287, 0.923], [0.0115, 0.8316], [0.3943, 0.2863]]]], 2, Con65944), 
LDot154 = dot_layer([[[0.6502, 0.9491], [0.6761, 0.4408], [0.1043, 0.3801]]], [[[0.5148, 0.0974], [0.6676, 0.1106], [0.2012, 0.7012]]], 2, 2, Dot154), 
LMax47246 = maximum_layer([Con65944,Dot154], Max47246), 
LRes57072 = reshape_layer(Max47246, [3, 3, 1], Res57072), 
LCon77864 = concatenate_layer([Res57072,[[[[0.0315], [0.5714], [0.4665]], [[0.3914], [0.0761], [0.3918]], [[0.8287], [0.4494], [0.586]]]]], 3, Con77864), 
LDep68505 = depthwise_conv2D_layer([[[[0.4699, 0.6256]]]], 1, 1,[[[[0.3586], [0.2788]]]],[0, 0], 1, 1, true, Dep68505), 
LZer35095 = zero_padding2D_layer(Dep68505, 2, 0, 2, 0, Zer35095), 
LAdd12401 = add_layer([Con77864,Zer35095], Add12401), 
LRes86390 = reshape_layer(Add12401, [3, 6], Res86390), 
LMax36096 = maximum_layer([[[[0.3266], [0.9344]]], [[[0.5202], [0.6271]]]], Max36096), 
LZer88623 = zero_padding1D_layer(Max36096, 1, 0, Zer88623), 
LCon93347 = concatenate_layer([Zer88623,[[[0.1607, 0.9597, 0.1316, 0.0072, 0.3518], [0.6835, 0.8156, 0.5895, 0.7725, 0.1093], [0.9539, 0.6939, 0.6835, 0.3758, 0.9765]]]], 2, Con93347), 
LAve60748 = average_layer([Res86390,Con93347], Ave60748), 
exec_layers([LDot89473,LRes80059,LZer80435,LCon65944,LDot154,LMax47246,LRes57072,LCon77864,LDep68505,LZer35095,LAdd12401,LRes86390,LMax36096,LZer88623,LCon93347,LAve60748],["Dot89473","Res80059","Zer80435","Con65944","Dot154","Max47246","Res57072","Con77864","Dep68505","Zer35095","Add12401","Res86390","Max36096","Zer88623","Con93347","Ave60748"],Ave60748,"Ave60748")

Actual (Unparsed): [[[0.2135827, 0.0961000, 0.8942000, 0.3515000, 0.4651000, 0.4091500], [0.4555951, 0.5374500, 0.6578584, 0.3328000, 0.8020500, 0.2505500], [0.9870228, 0.8913000, 0.5441000, 0.5664500, 0.4159087, 0.8684586]]]

Expected (Unparsed): [[[0.21358265,0.0961,0.8942,0.35150000000000003,0.4651,0.40915],[0.45559510000000003,0.53745,0.6578584199999999,0.3328,0.8020499999999999,0.25055],[0.9870227900000001,0.8913,0.5441,0.56645,0.41590871,0.8684586400000001]]]

Actual:   [[[0.2136, 0.0961, 0.8942, 0.3515, 0.4651, 0.4092], [0.4556, 0.5375, 0.6579, 0.3328, 0.8021, 0.2506], [0.9871, 0.8913, 0.5441, 0.5665, 0.416, 0.8685]]]

Expected: [[[0.2136, 0.0961, 0.8942, 0.3516, 0.4651, 0.4092], [0.4556, 0.5375, 0.6579, 0.3328, 0.8021, 0.2506], [0.9871, 0.8913, 0.5441, 0.5665, 0.416, 0.8685]]]