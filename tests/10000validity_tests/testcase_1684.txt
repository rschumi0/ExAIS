import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub47381 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub47381 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot86308 = tf.keras.layers.Input(shape=([3]))
in1Dot86308 = tf.keras.layers.Input(shape=([3]))
in0Con53089 = tf.keras.layers.Input(shape=([2, 2, 1]))

Sub47381 = keras.layers.Subtract(name = 'Sub47381', )([in0Sub47381,in1Sub47381])
Dot86308 = keras.layers.Dot(axes=(1, 1), name = 'Dot86308', )([in0Dot86308,in1Dot86308])
Res57880 = keras.layers.Reshape((1, 1), name = 'Res57880', )(Dot86308)
Res97684 = keras.layers.Reshape((1, 1, 1), name = 'Res97684', )(Res57880)
Cro16801 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro16801', )(Res97684)
Zer83526 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer83526', )(Cro16801)
Con53089 = keras.layers.Concatenate(axis=3, name = 'Con53089', )([Zer83526,in0Con53089])
Add11423 = keras.layers.Add(name = 'Add11423', )([Sub47381,Con53089])
Res7445 = keras.layers.Reshape((2, 4), name = 'Res7445', )(Add11423)
Sep50862 = keras.layers.SeparableConv1D(4, (2),strides=(1), padding='valid', name = 'Sep50862', )(Res7445)
Bat73542 = keras.layers.BatchNormalization(axis=1, epsilon=0.7042102240945989,  name = 'Bat73542', )(Sep50862)
model = tf.keras.models.Model(inputs=[in0Sub47381,in1Sub47381,in0Dot86308,in1Dot86308,in0Con53089], outputs=Bat73542)
w = model.get_layer('Sep50862').get_weights() 
w[0] = np.array([[[0.4863], [0.7517], [0.0747], [0.2239]], [[0.2731], [0.8928], [0.9075], [0.6337]]])
w[1] = np.array([[[0.8134, 0.0967, 0.8017, 0.5297], [0.7115, 0.8227, 0.7116, 0.9561], [0.117, 0.7706, 0.2271, 0.8858], [0.0369, 0.0668, 0.0816, 0.1967]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep50862').set_weights(w) 
w = model.get_layer('Bat73542').get_weights() 
w[0] = np.array([0.8843])
w[1] = np.array([0.3434])
w[2] = np.array([0.5897])
w[3] = np.array([0.9808])
model.get_layer('Bat73542').set_weights(w) 
in0Sub47381 = tf.constant([[[[0.4711, 0.374], [0.6004, 0.0465]], [[0.9583, 0.3083], [0.9594, 0.0901]]]])
in1Sub47381 = tf.constant([[[[0.289, 0.4439], [0.8048, 0.5411]], [[0.1473, 0.9616], [0.9333, 0.3503]]]])
in0Dot86308 = tf.constant([[0.9898, 0.0741, 0.5516]])
in1Dot86308 = tf.constant([[0.3714, 0.7137, 0.3035]])
in0Con53089 = tf.constant([[[[0.6057], [0.0578]], [[0.3322], [0.8376]]]])
print (np.array2string(model.predict([in0Sub47381,in1Sub47381,in0Dot86308,in1Dot86308,in0Con53089],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat73542.png')

LSub47381 = subtract_layer([[[[0.4711, 0.374], [0.6004, 0.0465]], [[0.9583, 0.3083], [0.9594, 0.0901]]]], [[[[0.289, 0.4439], [0.8048, 0.5411]], [[0.1473, 0.9616], [0.9333, 0.3503]]]], Sub47381), 
LDot86308 = dot_layer([[0.9898, 0.0741, 0.5516]], [[0.3714, 0.7137, 0.3035]], 1, 1, Dot86308), 
LRes57880 = reshape_layer(Dot86308, [1, 1], Res57880), 
LRes97684 = reshape_layer(Res57880, [1, 1, 1], Res97684), 
LCro16801 = cropping2D_layer(Res97684, 0, 0, 0, 0, Cro16801), 
LZer83526 = zero_padding2D_layer(Cro16801, 1, 0, 1, 0, Zer83526), 
LCon53089 = concatenate_layer([Zer83526,[[[[0.6057], [0.0578]], [[0.3322], [0.8376]]]]], 3, Con53089), 
LAdd11423 = add_layer([Sub47381,Con53089], Add11423), 
LRes7445 = reshape_layer(Add11423, [2, 4], Res7445), 
LSep50862 = separable_conv1D_layer(Res7445, 2,[[[[0.4863], [0.7517], [0.0747], [0.2239]], [[0.2731], [0.8928], [0.9075], [0.6337]]],[[[0.8134, 0.0967, 0.8017, 0.5297], [0.7115, 0.8227, 0.7116, 0.9561], [0.117, 0.7706, 0.2271, 0.8858], [0.0369, 0.0668, 0.0816, 0.1967]]]],[0, 0, 0, 0], 1, false, Sep50862), 
LBat73542 = batch_normalization_layer(Sep50862, 1, 0.7042102240945989, [0.8843], [0.3434], [0.5897], [0.9808], Bat73542), 
exec_layers([LSub47381,LDot86308,LRes57880,LRes97684,LCro16801,LZer83526,LCon53089,LAdd11423,LRes7445,LSep50862,LBat73542],["Sub47381","Dot86308","Res57880","Res97684","Cro16801","Zer83526","Con53089","Add11423","Res7445","Sep50862","Bat73542"],Bat73542,"Bat73542")

Actual (Unparsed): [[[0.2196731, 0.3238570, 0.2660218, 0.4921160]]]

Expected (Unparsed): [[[0.2196730742328465,0.3238569916715666,0.26602179942063975,0.492116013975783]]]

Actual:   [[[0.2197, 0.3239, 0.2661, 0.4922]]]

Expected: [[[0.2197, 0.3239, 0.2661, 0.4922]]]