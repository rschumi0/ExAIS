import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul41832 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul41832 = tf.keras.layers.Input(shape=([2, 1, 1]))

Mul41832 = keras.layers.Multiply(name = 'Mul41832', )([in0Mul41832,in1Mul41832])
Zer4612 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer4612', )(Mul41832)
Ave6688 = keras.layers.AveragePooling2D(pool_size=(1, 2), name = 'Ave6688', )(Zer4612)
ELU88125 = keras.layers.ELU(alpha=8.116269282641987, name = 'ELU88125', )(Ave6688)
Res18103 = keras.layers.Reshape((4, 1), name = 'Res18103', )(ELU88125)
GRU21512 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU21512', )(Res18103)
model = tf.keras.models.Model(inputs=[in0Mul41832,in1Mul41832], outputs=GRU21512)
w = model.get_layer('GRU21512').get_weights() 
w[0] = np.array([[5, 1, 6, 8, 7, 2]])
w[1] = np.array([[3, 7, 8, 10, 2, 3], [9, 9, 6, 8, 1, 5]])
w[2] = np.array([2, 8, 8, 4, 6, 8])
model.get_layer('GRU21512').set_weights(w) 
in0Mul41832 = tf.constant([[[[0.5856]], [[0.779]]]])
in1Mul41832 = tf.constant([[[[0.115]], [[0.1488]]]])
print (np.array2string(model.predict([in0Mul41832,in1Mul41832],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU21512.png')

LMul41832 = multiply_layer([[[[[0.5856]], [[0.779]]]], [[[[0.115]], [[0.1488]]]]], Mul41832), 
LZer4612 = zero_padding2D_layer(Mul41832, 1, 1, 1, 1, Zer4612), 
LAve6688 = average_pooling2D_layer(Zer4612, 1, 2, Ave6688), 
LELU88125 = elu_layer(Ave6688, 8.116269282641987, ELU88125), 
LRes18103 = reshape_layer(ELU88125, [4, 1], Res18103), 
LGRU21512 = gru_layer(Res18103,[[5, 1, 6, 8, 7, 2]],[[3, 7, 8, 10, 2, 3], [9, 9, 6, 8, 1, 5]],[2, 8, 8, 4, 6, 8], false, GRU21512), 
exec_layers([LMul41832,LZer4612,LAve6688,LELU88125,LRes18103,LGRU21512],["Mul41832","Zer4612","Ave6688","ELU88125","Res18103","GRU21512"],GRU21512,"GRU21512")

Actual (Unparsed): [[0.2779064, 0.0006296]]

Expected (Unparsed): [[0.27790637085285524,0.0006295630699103764]]

Actual:   [[0.278, 0.0007]]

Expected: [[0.278, 0.0007]]