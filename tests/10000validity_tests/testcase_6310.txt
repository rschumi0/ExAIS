import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro35701 = tf.keras.layers.Input(shape=([3, 1, 3]))
in0Dep74976 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con17828 = tf.keras.layers.Input(shape=([1]))
in0Loc39371 = tf.keras.layers.Input(shape=([1, 1]))
in0GRU50758 = tf.keras.layers.Input(shape=([3, 2]))
in0Con97836 = tf.keras.layers.Input(shape=([2]))
in0Con91162 = tf.keras.layers.Input(shape=([2]))

Cro35701 = keras.layers.Cropping2D(cropping=((0, 2), (0, 0)), name = 'Cro35701', )(in0Cro35701)
Res73086 = keras.layers.Reshape((1, 3), name = 'Res73086', )(Cro35701)
Fla63481 = keras.layers.Flatten(name = 'Fla63481', )(Res73086)
Dep74976 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep74976', )(in0Dep74976)
Res90159 = keras.layers.Reshape((1, 2), name = 'Res90159', )(Dep74976)
Fla1554 = keras.layers.Flatten(name = 'Fla1554', )(Res90159)
Con17828 = keras.layers.Concatenate(axis=1, name = 'Con17828', )([Fla1554,in0Con17828])
Loc39371 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc39371', )(in0Loc39371)
Fla45513 = keras.layers.Flatten(name = 'Fla45513', )(Loc39371)
GRU50758 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU50758', )(in0GRU50758)
Con97836 = keras.layers.Concatenate(axis=1, name = 'Con97836', )([GRU50758,in0Con97836])
Add29684 = keras.layers.Add(name = 'Add29684', )([Fla45513,Con97836])
Dot42098 = keras.layers.Dot(axes=(1, 1), name = 'Dot42098', )([Con17828,Add29684])
Con91162 = keras.layers.Concatenate(axis=1, name = 'Con91162', )([Dot42098,in0Con91162])
Min84344 = keras.layers.Minimum(name = 'Min84344', )([Fla63481,Con91162])
model = tf.keras.models.Model(inputs=[in0Cro35701,in0Dep74976,in0Con17828,in0Loc39371,in0GRU50758,in0Con97836,in0Con91162], outputs=Min84344)
w = model.get_layer('Dep74976').get_weights() 
w[0] = np.array([[[[0.2688], [0.7951]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep74976').set_weights(w) 
w = model.get_layer('Loc39371').get_weights() 
w[0] = np.array([[[0.0746, 0.8462, 0.3418]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc39371').set_weights(w) 
w = model.get_layer('GRU50758').get_weights() 
w[0] = np.array([[6, 1, 2], [7, 8, 4]])
w[1] = np.array([[6, 8, 8]])
w[2] = np.array([[6, 7, 8], [10, 10, 6]])
model.get_layer('GRU50758').set_weights(w) 
in0Cro35701 = tf.constant([[[[1.2326, 1.6233, 1.4266]], [[1.0315, 1.9431, 1.4629]], [[1.1866, 1.5447, 1.4564]]]])
in0Dep74976 = tf.constant([[[[0.1034, 0.3796]]]])
in0Con17828 = tf.constant([[0.7369]])
in0Loc39371 = tf.constant([[[0.5445]]])
in0GRU50758 = tf.constant([[[1, 9], [2, 5], [8, 4]]])
in0Con97836 = tf.constant([[0.4658, 0.4705]])
in0Con91162 = tf.constant([[0.7519, 0.6456]])
print (np.array2string(model.predict([in0Cro35701,in0Dep74976,in0Con17828,in0Loc39371,in0GRU50758,in0Con97836,in0Con91162],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min84344.png')

LCro35701 = cropping2D_layer([[[[1.2326, 1.6233, 1.4266]], [[1.0315, 1.9431, 1.4629]], [[1.1866, 1.5447, 1.4564]]]], 0, 2, 0, 0, Cro35701), 
LRes73086 = reshape_layer(Cro35701, [1, 3], Res73086), 
LFla63481 = flatten_layer(Res73086, Fla63481), 
LDep74976 = depthwise_conv2D_layer([[[[0.1034, 0.3796]]]], 1, 1,[[[[0.2688], [0.7951]]]],[0, 0], 1, 1, false, Dep74976), 
LRes90159 = reshape_layer(Dep74976, [1, 2], Res90159), 
LFla1554 = flatten_layer(Res90159, Fla1554), 
LCon17828 = concatenate_layer([Fla1554,[[0.7369]]], 1, Con17828), 
LLoc39371 = locally_connected1D_layer([[[0.5445]]], 1,[[[0.0746, 0.8462, 0.3418]]],[[0, 0, 0]], 1, Loc39371), 
LFla45513 = flatten_layer(Loc39371, Fla45513), 
LGRU50758 = gru_layer([[[1, 9], [2, 5], [8, 4]]],[[6, 1, 2], [7, 8, 4]],[[6, 8, 8]],[[6, 7, 8], [10, 10, 6]], true, GRU50758), 
LCon97836 = concatenate_layer([GRU50758,[[0.4658, 0.4705]]], 1, Con97836), 
LAdd29684 = add_layer([Fla45513,Con97836], Add29684), 
LDot42098 = dot_layer(Con17828,Add29684, 1, 1, Dot42098), 
LCon91162 = concatenate_layer([Dot42098,[[0.7519, 0.6456]]], 1, Con91162), 
LMin84344 = minimum_layer([Fla63481,Con91162], Min84344), 
exec_layers([LCro35701,LRes73086,LFla63481,LDep74976,LRes90159,LFla1554,LCon17828,LLoc39371,LFla45513,LGRU50758,LCon97836,LAdd29684,LDot42098,LCon91162,LMin84344],["Cro35701","Res73086","Fla63481","Dep74976","Res90159","Fla1554","Con17828","Loc39371","Fla45513","GRU50758","Con97836","Add29684","Dot42098","Con91162","Min84344"],Min84344,"Min84344")

Actual (Unparsed): [[0.7646380, 0.7519000, 0.6456000]]

Expected (Unparsed): [[0.7646380280579879,0.7519,0.6456]]

Actual:   [[0.7647, 0.7519, 0.6456]]

Expected: [[0.7647, 0.7519, 0.6456]]