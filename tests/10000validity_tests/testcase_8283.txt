import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo82590 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Ave37753 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave37753 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0LST43916 = tf.keras.layers.Input(shape=([3, 1]))
in0Ave29261 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave29261 = tf.keras.layers.Input(shape=([1, 1]))

Glo82590 = keras.layers.GlobalMaxPool2D(name = 'Glo82590', )(in0Glo82590)
Res82680 = keras.layers.Reshape((1, 1), name = 'Res82680', )(Glo82590)
Res17823 = keras.layers.Reshape((1, 1, 1), name = 'Res17823', )(Res82680)
Zer74622 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer74622', )(Res17823)
Ave37753 = keras.layers.Average(name = 'Ave37753', )([in0Ave37753,in1Ave37753])
Mul97707 = keras.layers.Multiply(name = 'Mul97707', )([Zer74622,Ave37753])
Res77775 = keras.layers.Reshape((2, 1), name = 'Res77775', )(Mul97707)
Max82072 = keras.layers.MaxPool1D(pool_size=(1), strides=(2), padding='same', name = 'Max82072', )(Res77775)
Zer49747 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer49747', )(Max82072)
LST43916 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST43916', )(in0LST43916)
Res35049 = keras.layers.Reshape((2, 1), name = 'Res35049', )(LST43916)
Ave29261 = keras.layers.Average(name = 'Ave29261', )([in0Ave29261,in1Ave29261])
Zer69392 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer69392', )(Ave29261)
Ave33946 = keras.layers.Average(name = 'Ave33946', )([Res35049,Zer69392])
Max2887 = keras.layers.Maximum(name = 'Max2887', )([Zer49747,Ave33946])
Res36045 = keras.layers.Reshape((2, 1, 1), name = 'Res36045', )(Max2887)
Glo66741 = keras.layers.GlobalMaxPool2D(name = 'Glo66741', )(Res36045)
model = tf.keras.models.Model(inputs=[in0Glo82590,in0Ave37753,in1Ave37753,in0LST43916,in0Ave29261,in1Ave29261], outputs=Glo66741)
w = model.get_layer('LST43916').get_weights() 
w[0] = np.array([[5, 9, 10, 8, 6, 8, 4, 1]])
w[1] = np.array([[2, 6, 9, 2, 4, 8, 5, 4], [10, 1, 3, 5, 7, 10, 1, 3]])
w[2] = np.array([8, 9, 6, 4, 10, 7, 2, 7])
model.get_layer('LST43916').set_weights(w) 
in0Glo82590 = tf.constant([[[[1.329]]]])
in0Ave37753 = tf.constant([[[[0.5023]], [[0.0907]]]])
in1Ave37753 = tf.constant([[[[0.2689]], [[0.4679]]]])
in0LST43916 = tf.constant([[[9], [8], [9]]])
in0Ave29261 = tf.constant([[[0.3048]]])
in1Ave29261 = tf.constant([[[0.1993]]])
print (np.array2string(model.predict([in0Glo82590,in0Ave37753,in1Ave37753,in0LST43916,in0Ave29261,in1Ave29261],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo66741.png')

LGlo82590 = global_max_pool2D_layer([[[[1.329]]]], Glo82590), 
LRes82680 = reshape_layer(Glo82590, [1, 1], Res82680), 
LRes17823 = reshape_layer(Res82680, [1, 1, 1], Res17823), 
LZer74622 = zero_padding2D_layer(Res17823, 1, 0, 0, 0, Zer74622), 
LAve37753 = average_layer([[[[[0.5023]], [[0.0907]]]], [[[[0.2689]], [[0.4679]]]]], Ave37753), 
LMul97707 = multiply_layer([Zer74622,Ave37753], Mul97707), 
LRes77775 = reshape_layer(Mul97707, [2, 1], Res77775), 
LMax82072 = max_pool1D_layer(Res77775, 1, 2, true, Max82072), 
LZer49747 = zero_padding1D_layer(Max82072, 1, 0, Zer49747), 
LLST43916 = lstm_layer([[[9], [8], [9]]],[[5, 9, 10, 8, 6, 8, 4, 1]],[[2, 6, 9, 2, 4, 8, 5, 4], [10, 1, 3, 5, 7, 10, 1, 3]],[8, 9, 6, 4, 10, 7, 2, 7], LST43916), 
LRes35049 = reshape_layer(LST43916, [2, 1], Res35049), 
LAve29261 = average_layer([[[[0.3048]]], [[[0.1993]]]], Ave29261), 
LZer69392 = zero_padding1D_layer(Ave29261, 1, 0, Zer69392), 
LAve33946 = average_layer([Res35049,Zer69392], Ave33946), 
LMax2887 = maximum_layer([Zer49747,Ave33946], Max2887), 
LRes36045 = reshape_layer(Max2887, [2, 1, 1], Res36045), 
LGlo66741 = global_max_pool2D_layer(Res36045, Glo66741), 
exec_layers([LGlo82590,LRes82680,LRes17823,LZer74622,LAve37753,LMul97707,LRes77775,LMax82072,LZer49747,LLST43916,LRes35049,LAve29261,LZer69392,LAve33946,LMax2887,LRes36045,LGlo66741],["Glo82590","Res82680","Res17823","Zer74622","Ave37753","Mul97707","Res77775","Max82072","Zer49747","LST43916","Res35049","Ave29261","Zer69392","Ave33946","Max2887","Res36045","Glo66741"],Glo66741,"Glo66741")

Actual (Unparsed): [[0.6235524]]

Expected (Unparsed): [[0.6235523767776898]]

Actual:   [[0.6236]]

Expected: [[0.6236]]