import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot6088 = tf.keras.layers.Input(shape=([2]))
in1Dot6088 = tf.keras.layers.Input(shape=([2]))
in0Per60891 = tf.keras.layers.Input(shape=([2, 1]))
in0Max80517 = tf.keras.layers.Input(shape=([1, 1]))
in1Max80517 = tf.keras.layers.Input(shape=([1, 1]))

Dot6088 = keras.layers.Dot(axes=(1, 1), name = 'Dot6088', )([in0Dot6088,in1Dot6088])
Res1842 = keras.layers.Reshape((1, 1), name = 'Res1842', )(Dot6088)
Res40520 = keras.layers.Reshape((1, 1, 1), name = 'Res40520', )(Res1842)
Per60891 = keras.layers.Permute((1,2), name = 'Per60891',)(in0Per60891)
Res95519 = keras.layers.Reshape((2, 1, 1), name = 'Res95519', )(Per60891)
Max70566 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(7, 1), padding='valid', name = 'Max70566', )(Res95519)
Sub25432 = keras.layers.Subtract(name = 'Sub25432', )([Res40520,Max70566])
Res1446 = keras.layers.Reshape((1, 1), name = 'Res1446', )(Sub25432)
Fla97703 = keras.layers.Flatten(name = 'Fla97703', )(Res1446)
Max80517 = keras.layers.Maximum(name = 'Max80517', )([in0Max80517,in1Max80517])
Glo94530 = keras.layers.GlobalMaxPool1D(name = 'Glo94530', )(Max80517)
Max6428 = keras.layers.Maximum(name = 'Max6428', )([Fla97703,Glo94530])
model = tf.keras.models.Model(inputs=[in0Dot6088,in1Dot6088,in0Per60891,in0Max80517,in1Max80517], outputs=Max6428)
in0Dot6088 = tf.constant([[0.4151, 0.2615]])
in1Dot6088 = tf.constant([[0.423, 0.4403]])
in0Per60891 = tf.constant([[[1.2917], [1.4151]]])
in0Max80517 = tf.constant([[[0.663]]])
in1Max80517 = tf.constant([[[0.3402]]])
print (np.array2string(model.predict([in0Dot6088,in1Dot6088,in0Per60891,in0Max80517,in1Max80517],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max6428.png')

LDot6088 = dot_layer([[0.4151, 0.2615]], [[0.423, 0.4403]], 1, 1, Dot6088), 
LRes1842 = reshape_layer(Dot6088, [1, 1], Res1842), 
LRes40520 = reshape_layer(Res1842, [1, 1, 1], Res40520), 
LPer60891 = permute_layer([[[1.2917], [1.4151]]], 1,2, Per60891), 
LRes95519 = reshape_layer(Per60891, [2, 1, 1], Res95519), 
LMax70566 = max_pool2D_layer(Res95519, 1, 1, 7, 1, false, Max70566), 
LSub25432 = subtract_layer(Res40520,Max70566, Sub25432), 
LRes1446 = reshape_layer(Sub25432, [1, 1], Res1446), 
LFla97703 = flatten_layer(Res1446, Fla97703), 
LMax80517 = maximum_layer([[[[0.663]]], [[[0.3402]]]], Max80517), 
LGlo94530 = global_max_pool1D_layer(Max80517, Glo94530), 
LMax6428 = maximum_layer([Fla97703,Glo94530], Max6428), 
exec_layers([LDot6088,LRes1842,LRes40520,LPer60891,LRes95519,LMax70566,LSub25432,LRes1446,LFla97703,LMax80517,LGlo94530,LMax6428],["Dot6088","Res1842","Res40520","Per60891","Res95519","Max70566","Sub25432","Res1446","Fla97703","Max80517","Glo94530","Max6428"],Max6428,"Max6428")

Actual (Unparsed): [[0.6630000]]

Expected (Unparsed): [[0.663]]

Actual:   [[0.663]]

Expected: [[0.663]]