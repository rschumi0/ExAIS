import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lea47004 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Per59672 = tf.keras.layers.Input(shape=([3, 1]))

Lea47004 = keras.layers.LeakyReLU(alpha=2.2371316056726283, name = 'Lea47004', input_shape=(2, 2, 1, 1))(in0Lea47004)
Res3765 = keras.layers.Reshape((2, 2, 1), name = 'Res3765', )(Lea47004)
Res88750 = keras.layers.Reshape((2, 2), name = 'Res88750', )(Res3765)
Zer8726 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer8726', )(Res88750)
Per59672 = keras.layers.Permute((2,1), name = 'Per59672',)(in0Per59672)
Res71423 = keras.layers.Reshape((1, 3, 1), name = 'Res71423', )(Per59672)
Res31482 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res31482', )(Res71423)
Zer16200 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer16200', )(Res31482)
Res41834 = keras.layers.Reshape((3, 5, 3), name = 'Res41834', )(Zer16200)
Res13423 = keras.layers.Reshape((3, 15), name = 'Res13423', )(Res41834)
Dot77019 = keras.layers.Dot(axes=(1, 1), name = 'Dot77019', )([Zer8726,Res13423])
model = tf.keras.models.Model(inputs=[in0Lea47004,in0Per59672], outputs=Dot77019)
in0Lea47004 = tf.constant([[[[[0.4595]], [[0.1019]]], [[[0.7873]], [[0.525]]]]])
in0Per59672 = tf.constant([[[1.7014], [1.8464], [1.7386]]])
print (np.array2string(model.predict([in0Lea47004,in0Per59672],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot77019.png')

LLea47004 = leaky_relu_layer([[[[[0.4595]], [[0.1019]]], [[[0.7873]], [[0.525]]]]], 2.2371316056726283, Lea47004), 
LRes3765 = reshape_layer(Lea47004, [2, 2, 1], Res3765), 
LRes88750 = reshape_layer(Res3765, [2, 2], Res88750), 
LZer8726 = zero_padding1D_layer(Res88750, 1, 0, Zer8726), 
LPer59672 = permute_layer([[[1.7014], [1.8464], [1.7386]]], 2,1, Per59672), 
LRes71423 = reshape_layer(Per59672, [1, 3, 1], Res71423), 
LRes31482 = reshape_layer(Res71423, [1, 3, 1, 1], Res31482), 
LZer16200 = zero_padding3D_layer(Res31482, 1, 1, 1, 1, 1, 1, Zer16200), 
LRes41834 = reshape_layer(Zer16200, [3, 5, 3], Res41834), 
LRes13423 = reshape_layer(Res41834, [3, 15], Res13423), 
LDot77019 = dot_layer(Zer8726,Res13423, 1, 1, Dot77019), 
exec_layers([LLea47004,LRes3765,LRes88750,LZer8726,LPer59672,LRes71423,LRes31482,LZer16200,LRes41834,LRes13423,LDot77019],["Lea47004","Res3765","Res88750","Zer8726","Per59672","Res71423","Res31482","Zer16200","Res41834","Res13423","Dot77019"],Dot77019,"Dot77019")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.7817933, 0.0000000, 0.0000000, 0.8484208, 0.0000000, 0.0000000, 0.7988867, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.1733727, 0.0000000, 0.0000000, 0.1881482, 0.0000000, 0.0000000, 0.1771633, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.0,0.7817933,0.0,0.0,0.8484208000000001,0.0,0.0,0.7988867,0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0,0.17337266,0.0,0.0,0.18814816,0.0,0.0,0.17716334,0.0,0.0,0.0,0.0]]]

Actual:   [[[0, 0, 0, 0, 0.7818, 0, 0, 0.8485, 0, 0, 0.7989, 0, 0, 0, 0], [0, 0, 0, 0, 0.1734, 0, 0, 0.1882, 0, 0, 0.1772, 0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0, 0.7818, 0, 0, 0.8485, 0, 0, 0.7989, 0, 0, 0, 0], [0, 0, 0, 0, 0.1734, 0, 0, 0.1882, 0, 0, 0.1772, 0, 0, 0, 0]]]