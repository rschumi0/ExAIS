import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max28341 = tf.keras.layers.Input(shape=([2, 2, 1]))

Max28341 = keras.layers.MaxPool2D(pool_size=(1, 2), name = 'Max28341', )(in0Max28341)
Glo78155 = keras.layers.GlobalMaxPool2D(name = 'Glo78155', )(Max28341)
ReL18216 = keras.layers.ReLU(max_value=7.794130912723557, negative_slope=1.0166688336175587, threshold=0.44074584255449967, name = 'ReL18216', )(Glo78155)
Sof82981 = keras.layers.Softmax(axis=1, name = 'Sof82981', )(ReL18216)
model = tf.keras.models.Model(inputs=[in0Max28341], outputs=Sof82981)
in0Max28341 = tf.constant([[[[1.5158], [1.5237]], [[1.2868], [1.698]]]])
print (np.array2string(model.predict([in0Max28341],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof82981.png')

LMax28341 = max_pool2D_layer([[[[1.5158], [1.5237]], [[1.2868], [1.698]]]], 1, 2, Max28341), 
LGlo78155 = global_max_pool2D_layer(Max28341, Glo78155), 
LReL18216 = relu_layer(Glo78155, 7.794130912723557, 1.0166688336175587, 0.44074584255449967, ReL18216), 
LSof82981 = softmax_layer(ReL18216, 1, Sof82981), 
exec_layers([LMax28341,LGlo78155,LReL18216,LSof82981],["Max28341","Glo78155","ReL18216","Sof82981"],Sof82981,"Sof82981")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[1.0]]

Actual:   [[1]]

Expected: [[1]]