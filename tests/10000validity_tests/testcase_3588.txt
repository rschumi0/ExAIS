import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave44414 = tf.keras.layers.Input(shape=([1, 2]))
in0Add93742 = tf.keras.layers.Input(shape=([2, 2]))
in1Add93742 = tf.keras.layers.Input(shape=([2, 2]))

Ave44414 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave44414', )(in0Ave44414)
Zer76793 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer76793', )(Ave44414)
Add93742 = keras.layers.Add(name = 'Add93742', )([in0Add93742,in1Add93742])
Per78725 = keras.layers.Permute((1,2), name = 'Per78725',)(Add93742)
Ave82968 = keras.layers.Average(name = 'Ave82968', )([Zer76793,Per78725])
Res30995 = keras.layers.Reshape((2, 2, 1), name = 'Res30995', )(Ave82968)
Ave17404 = keras.layers.AveragePooling2D(pool_size=(2, 1), name = 'Ave17404', )(Res30995)
model = tf.keras.models.Model(inputs=[in0Ave44414,in0Add93742,in1Add93742], outputs=Ave17404)
in0Ave44414 = tf.constant([[[1.1094, 1.719]]])
in0Add93742 = tf.constant([[[0.9417, 0.3947], [0.3648, 0.1757]]])
in1Add93742 = tf.constant([[[0.4465, 0.7043], [0.1279, 0.1349]]])
print (np.array2string(model.predict([in0Ave44414,in0Add93742,in1Add93742],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave17404.png')

LAve44414 = average_pooling1D_layer([[[1.1094, 1.719]]], 1, Ave44414), 
LZer76793 = zero_padding1D_layer(Ave44414, 1, 0, Zer76793), 
LAdd93742 = add_layer([[[[0.9417, 0.3947], [0.3648, 0.1757]]], [[[0.4465, 0.7043], [0.1279, 0.1349]]]], Add93742), 
LPer78725 = permute_layer(Add93742, 1,2, Per78725), 
LAve82968 = average_layer([Zer76793,Per78725], Ave82968), 
LRes30995 = reshape_layer(Ave82968, [2, 2, 1], Res30995), 
LAve17404 = average_pooling2D_layer(Res30995, 2, 1, Ave17404), 
exec_layers([LAve44414,LZer76793,LAdd93742,LPer78725,LAve82968,LRes30995,LAve17404],["Ave44414","Zer76793","Add93742","Per78725","Ave82968","Res30995","Ave17404"],Ave17404,"Ave17404")

Actual (Unparsed): [[[[0.7475750], [0.7821500]]]]

Expected (Unparsed): [[[[0.747575],[0.7821500000000001]]]]

Actual:   [[[[0.7476], [0.7822]]]]

Expected: [[[[0.7476], [0.7822]]]]