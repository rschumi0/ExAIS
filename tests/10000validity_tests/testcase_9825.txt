import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min96195 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Min96195 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Min52196 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min52196 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Con94957 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Dot57700 = tf.keras.layers.Input(shape=([3]))
in1Dot57700 = tf.keras.layers.Input(shape=([3]))
in0Con4375 = tf.keras.layers.Input(shape=([7]))
in0Add98350 = tf.keras.layers.Input(shape=([2, 1]))
in1Add98350 = tf.keras.layers.Input(shape=([2, 1]))

Min96195 = keras.layers.Minimum(name = 'Min96195', )([in0Min96195,in1Min96195])
Zer16888 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer16888', )(Min96195)
Min52196 = keras.layers.Minimum(name = 'Min52196', )([in0Min52196,in1Min52196])
Con94957 = keras.layers.Concatenate(axis=4, name = 'Con94957', )([Min52196,in0Con94957])
Ave69717 = keras.layers.Average(name = 'Ave69717', )([Zer16888,Con94957])
Res700 = keras.layers.Reshape((2, 1, 4), name = 'Res700', )(Ave69717)
Res67852 = keras.layers.Reshape((2, 4), name = 'Res67852', )(Res700)
Fla45810 = keras.layers.Flatten(name = 'Fla45810', )(Res67852)
Dot57700 = keras.layers.Dot(axes=(1, 1), name = 'Dot57700', )([in0Dot57700,in1Dot57700])
Con4375 = keras.layers.Concatenate(axis=1, name = 'Con4375', )([Dot57700,in0Con4375])
Mul61007 = keras.layers.Multiply(name = 'Mul61007', )([Fla45810,Con4375])
Res52722 = keras.layers.Reshape((8, 1), name = 'Res52722', )(Mul61007)
Add98350 = keras.layers.Add(name = 'Add98350', )([in0Add98350,in1Add98350])
Zer20732 = keras.layers.ZeroPadding1D(padding=((6, 0)), name = 'Zer20732', )(Add98350)
Sub86885 = keras.layers.Subtract(name = 'Sub86885', )([Res52722,Zer20732])
model = tf.keras.models.Model(inputs=[in0Min96195,in1Min96195,in0Min52196,in1Min52196,in0Con94957,in0Dot57700,in1Dot57700,in0Con4375,in0Add98350,in1Add98350], outputs=Sub86885)
in0Min96195 = tf.constant([[[[[0.3346, 0.0892]]], [[[0.7555, 0.2069]]]]])
in1Min96195 = tf.constant([[[[[0.2274, 0.2808]]], [[[0.8777, 0.9502]]]]])
in0Min52196 = tf.constant([[[[[0.042], [0.0504]]], [[[0.5041], [0.0031]]]]])
in1Min52196 = tf.constant([[[[[0.1098], [0.0689]]], [[[0.2066], [0.2239]]]]])
in0Con94957 = tf.constant([[[[[0.9189], [0.9349]]], [[[0.0347], [0.7063]]]]])
in0Dot57700 = tf.constant([[0.333, 0.9071, 0.2353]])
in1Dot57700 = tf.constant([[0.8747, 0.4779, 0.6803]])
in0Con4375 = tf.constant([[0.7912, 0.1016, 0.0262, 0.5155, 0.8699, 0.4473, 0.7869]])
in0Add98350 = tf.constant([[[0.6794], [0.9938]]])
in1Add98350 = tf.constant([[[0.2364], [0.7599]]])
print (np.array2string(model.predict([in0Min96195,in1Min96195,in0Min52196,in1Min52196,in0Con94957,in0Dot57700,in1Dot57700,in0Con4375,in0Add98350,in1Add98350],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub86885.png')

LMin96195 = minimum_layer([[[[[[0.3346, 0.0892]]], [[[0.7555, 0.2069]]]]], [[[[[0.2274, 0.2808]]], [[[0.8777, 0.9502]]]]]], Min96195), 
LZer16888 = zero_padding3D_layer(Min96195, 0, 0, 0, 0, 1, 0, Zer16888), 
LMin52196 = minimum_layer([[[[[[0.042], [0.0504]]], [[[0.5041], [0.0031]]]]], [[[[[0.1098], [0.0689]]], [[[0.2066], [0.2239]]]]]], Min52196), 
LCon94957 = concatenate_layer([Min52196,[[[[[0.9189], [0.9349]]], [[[0.0347], [0.7063]]]]]], 4, Con94957), 
LAve69717 = average_layer([Zer16888,Con94957], Ave69717), 
LRes700 = reshape_layer(Ave69717, [2, 1, 4], Res700), 
LRes67852 = reshape_layer(Res700, [2, 4], Res67852), 
LFla45810 = flatten_layer(Res67852, Fla45810), 
LDot57700 = dot_layer([[0.333, 0.9071, 0.2353]], [[0.8747, 0.4779, 0.6803]], 1, 1, Dot57700), 
LCon4375 = concatenate_layer([Dot57700,[[0.7912, 0.1016, 0.0262, 0.5155, 0.8699, 0.4473, 0.7869]]], 1, Con4375), 
LMul61007 = multiply_layer([Fla45810,Con4375], Mul61007), 
LRes52722 = reshape_layer(Mul61007, [8, 1], Res52722), 
LAdd98350 = add_layer([[[[0.6794], [0.9938]]], [[[0.2364], [0.7599]]]], Add98350), 
LZer20732 = zero_padding1D_layer(Add98350, 6, 0, Zer20732), 
LSub86885 = subtract_layer(Res52722,Zer20732, Sub86885), 
exec_layers([LMin96195,LZer16888,LMin52196,LCon94957,LAve69717,LRes700,LRes67852,LFla45810,LDot57700,LCon4375,LMul61007,LRes52722,LAdd98350,LZer20732,LSub86885],["Min96195","Zer16888","Min52196","Con94957","Ave69717","Res700","Res67852","Fla45810","Dot57700","Con4375","Mul61007","Res52722","Add98350","Zer20732","Sub86885"],Sub86885,"Sub86885")

Actual (Unparsed): [[[0.0185819], [0.3635168], [0.0141122], [0.0134157], [0.0532511], [0.0150928], [-0.7461391], [-1.3944014]]]

Expected (Unparsed): [[[0.01858190838],[0.36351684],[0.01411224],[0.01341571],[0.05325115],[0.015092765000000001],[-0.74613911],[-1.39440146]]]

Actual:   [[[0.0186], [0.3636], [0.0142], [0.0135], [0.0533], [0.0151], [-0.7461], [-1.3944]]]

Expected: [[[0.0186], [0.3636], [0.0142], [0.0135], [0.0533], [0.0151], [-0.7461], [-1.3944]]]