import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep98463 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Ave70427 = tf.keras.layers.Input(shape=([2, 1]))
in0Min5780 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min5780 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con23874 = tf.keras.layers.Input(shape=([2, 1, 3]))

Sep98463 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='valid', name = 'Sep98463', )(in0Sep98463)
Zer12932 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer12932', )(Sep98463)
Ave70427 = keras.layers.AveragePooling1D(pool_size=(1), strides=(1), padding='same', name = 'Ave70427', )(in0Ave70427)
PRe65544 = keras.layers.PReLU(name = 'PRe65544', )(Ave70427)
Res89920 = keras.layers.Reshape((2, 1, 1), name = 'Res89920', )(PRe65544)
Min5780 = keras.layers.Minimum(name = 'Min5780', )([in0Min5780,in1Min5780])
Zer34612 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer34612', )(Min5780)
Mul67521 = keras.layers.Multiply(name = 'Mul67521', )([Res89920,Zer34612])
Con23874 = keras.layers.Concatenate(axis=3, name = 'Con23874', )([Mul67521,in0Con23874])
Max90046 = keras.layers.Maximum(name = 'Max90046', )([Zer12932,Con23874])
model = tf.keras.models.Model(inputs=[in0Sep98463,in0Ave70427,in0Min5780,in1Min5780,in0Con23874], outputs=Max90046)
w = model.get_layer('Sep98463').get_weights() 
w[0] = np.array([[[[0.992]]]])
w[1] = np.array([[[[0.5254, 0.9475, 0.2879, 0.0617]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep98463').set_weights(w) 
w = model.get_layer('PRe65544').get_weights() 
w[0] = np.array([[0.9892], [0.0454]])
model.get_layer('PRe65544').set_weights(w) 
in0Sep98463 = tf.constant([[[[0.3668]]]])
in0Ave70427 = tf.constant([[[1.7305], [1.0413]]])
in0Min5780 = tf.constant([[[[0.0429]]]])
in1Min5780 = tf.constant([[[[0.0321]]]])
in0Con23874 = tf.constant([[[[0.7987, 0.3519, 0.9507]], [[0.6726, 0.4401, 0.8007]]]])
print (np.array2string(model.predict([in0Sep98463,in0Ave70427,in0Min5780,in1Min5780,in0Con23874],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max90046.png')

LSep98463 = separable_conv2D_layer([[[[0.3668]]]], 1, 1,[[[[[0.992]]]],[[[[0.5254, 0.9475, 0.2879, 0.0617]]]]],[0, 0, 0, 0], 1, 1, false, Sep98463), 
LZer12932 = zero_padding2D_layer(Sep98463, 1, 0, 0, 0, Zer12932), 
LAve70427 = average_pooling1D_layer([[[1.7305], [1.0413]]], 1, 1, true, Ave70427), 
LPRe65544 = prelu_layer(Ave70427, [[0.9892], [0.0454]], PRe65544), 
LRes89920 = reshape_layer(PRe65544, [2, 1, 1], Res89920), 
LMin5780 = minimum_layer([[[[[0.0429]]]], [[[[0.0321]]]]], Min5780), 
LZer34612 = zero_padding2D_layer(Min5780, 1, 0, 0, 0, Zer34612), 
LMul67521 = multiply_layer([Res89920,Zer34612], Mul67521), 
LCon23874 = concatenate_layer([Mul67521,[[[[0.7987, 0.3519, 0.9507]], [[0.6726, 0.4401, 0.8007]]]]], 3, Con23874), 
LMax90046 = maximum_layer([Zer12932,Con23874], Max90046), 
exec_layers([LSep98463,LZer12932,LAve70427,LPRe65544,LRes89920,LMin5780,LZer34612,LMul67521,LCon23874,LMax90046],["Sep98463","Zer12932","Ave70427","PRe65544","Res89920","Min5780","Zer34612","Mul67521","Con23874","Max90046"],Max90046,"Max90046")

Actual (Unparsed): [[[[0.0000000, 0.7987000, 0.3519000, 0.9507000]], [[0.1911750, 0.6726000, 0.4401000, 0.8007000]]]]

Expected (Unparsed): [[[[0,0.7987,0.3519,0.9507]],[[0.19117498624,0.6726,0.4401,0.8007]]]]

Actual:   [[[[0, 0.7987, 0.3519, 0.9507]], [[0.1912, 0.6726, 0.4401, 0.8007]]]]

Expected: [[[[0, 0.7987, 0.3519, 0.9507]], [[0.1912, 0.6726, 0.4401, 0.8007]]]]