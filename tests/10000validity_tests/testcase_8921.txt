import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max18816 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max18816 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Glo88181 = tf.keras.layers.Input(shape=([1, 1, 2]))

Max18816 = keras.layers.Maximum(name = 'Max18816', )([in0Max18816,in1Max18816])
Res59331 = keras.layers.Reshape((1, 2), name = 'Res59331', )(Max18816)
Glo88181 = keras.layers.GlobalMaxPool2D(name = 'Glo88181', )(in0Glo88181)
Res38215 = keras.layers.Reshape((1, 2), name = 'Res38215', )(Glo88181)
Mul27710 = keras.layers.Multiply(name = 'Mul27710', )([Res59331,Res38215])
Den18202 = keras.layers.Dense(2,name = 'Den18202', )(Mul27710)
model = tf.keras.models.Model(inputs=[in0Max18816,in1Max18816,in0Glo88181], outputs=Den18202)
w = model.get_layer('Den18202').get_weights() 
w[0] = np.array([[0.9447, 0.613], [0.583, 0.6762]])
w[1] = np.array([0.5766, 0.0035])
model.get_layer('Den18202').set_weights(w) 
in0Max18816 = tf.constant([[[[0.9841], [0.8537]]]])
in1Max18816 = tf.constant([[[[0.165], [0.1735]]]])
in0Glo88181 = tf.constant([[[[1.4875, 1.4895]]]])
print (np.array2string(model.predict([in0Max18816,in1Max18816,in0Glo88181],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den18202.png')

LMax18816 = maximum_layer([[[[[0.9841], [0.8537]]]], [[[[0.165], [0.1735]]]]], Max18816), 
LRes59331 = reshape_layer(Max18816, [1, 2], Res59331), 
LGlo88181 = global_max_pool2D_layer([[[[1.4875, 1.4895]]]], Glo88181), 
LRes38215 = reshape_layer(Glo88181, [1, 2], Res38215), 
LMul27710 = multiply_layer([Res59331,Res38215], Mul27710), 
LDen18202 = dense_layer(Mul27710, [[0.9447, 0.613], [0.583, 0.6762]],[0.5766, 0.0035], Den18202), 
exec_layers([LMax18816,LRes59331,LGlo88181,LRes38215,LMul27710,LDen18202],["Max18816","Res59331","Glo88181","Res38215","Mul27710","Den18202"],Den18202,"Den18202")

Actual (Unparsed): [[[2.7008326, 1.7606858]]]

Expected (Unparsed): [[[2.700832639575,1.76068583838]]]

Actual:   [[[2.7009, 1.7607]]]

Expected: [[[2.7009, 1.7607]]]