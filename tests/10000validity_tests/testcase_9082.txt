import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay97433 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max93127 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max93127 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con48227 = tf.keras.layers.Input(shape=([2, 3, 1]))

Lay97433 = keras.layers.LayerNormalization(axis=2, epsilon=1.2146144436084847, name = 'Lay97433', )(in0Lay97433)
Res68349 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res68349', )(Lay97433)
Con28027 = keras.layers.Conv3D(3, (1, 1, 1),strides=(1, 2, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con28027', )(Res68349)
Res3598 = keras.layers.Reshape((2, 1, 3), name = 'Res3598', )(Con28027)
Zer48395 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer48395', )(Res3598)
Max93127 = keras.layers.Maximum(name = 'Max93127', )([in0Max93127,in1Max93127])
Zer98621 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer98621', )(Max93127)
Con48227 = keras.layers.Concatenate(axis=3, name = 'Con48227', )([Zer98621,in0Con48227])
Max90590 = keras.layers.Maximum(name = 'Max90590', )([Zer48395,Con48227])
model = tf.keras.models.Model(inputs=[in0Lay97433,in0Max93127,in1Max93127,in0Con48227], outputs=Max90590)
w = model.get_layer('Con28027').get_weights() 
w[0] = np.array([[[[[0.3679, 0.5173, 0.3187]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con28027').set_weights(w) 
in0Lay97433 = tf.constant([[[[1.8251], [1.6822]], [[1.4583], [1.944]]]])
in0Max93127 = tf.constant([[[[0.1288, 0.4358], [0.0214, 0.8649]]]])
in1Max93127 = tf.constant([[[[0.1161, 0.145], [0.8395, 0.6074]]]])
in0Con48227 = tf.constant([[[[0.6815], [0.8456], [0.3738]], [[0.2777], [0.3733], [0.3544]]]])
print (np.array2string(model.predict([in0Lay97433,in0Max93127,in1Max93127,in0Con48227],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max90590.png')

LLay97433 = layer_normalization_layer([[[[1.8251], [1.6822]], [[1.4583], [1.944]]]], 2, 1.2146144436084847, Lay97433), 
LRes68349 = reshape_layer(Lay97433, [2, 2, 1, 1], Res68349), 
LCon28027 = conv3D_layer(Res68349, 1, 1, 1,[[[[[0.3679, 0.5173, 0.3187]]]]],[0, 0, 0], 1, 2, 1, true, 1, 1, 1, Con28027), 
LRes3598 = reshape_layer(Con28027, [2, 1, 3], Res3598), 
LZer48395 = zero_padding2D_layer(Res3598, 0, 0, 2, 0, Zer48395), 
LMax93127 = maximum_layer([[[[[0.1288, 0.4358], [0.0214, 0.8649]]]], [[[[0.1161, 0.145], [0.8395, 0.6074]]]]], Max93127), 
LZer98621 = zero_padding2D_layer(Max93127, 1, 0, 1, 0, Zer98621), 
LCon48227 = concatenate_layer([Zer98621,[[[[0.6815], [0.8456], [0.3738]], [[0.2777], [0.3733], [0.3544]]]]], 3, Con48227), 
LMax90590 = maximum_layer([Zer48395,Con48227], Max90590), 
exec_layers([LLay97433,LRes68349,LCon28027,LRes3598,LZer48395,LMax93127,LZer98621,LCon48227,LMax90590],["Lay97433","Res68349","Con28027","Res3598","Zer48395","Max93127","Zer98621","Con48227","Max90590"],Max90590,"Max90590")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.6815000], [0.0000000, 0.0000000, 0.8456000], [0.0238014, 0.0334668, 0.3738000]], [[0.0000000, 0.0000000, 0.2777000], [0.1288000, 0.4358000, 0.3733000], [0.8395000, 0.8649000, 0.3544000]]]]

Expected (Unparsed): [[[[0,0,0.6815],[0,0,0.8456],[0.023801374032396638,0.03346684095395156,0.3738]],[[0,0,0.2777],[0.1288,0.4358,0.3733],[0.8395,0.8649,0.3544]]]]

Actual:   [[[[0, 0, 0.6815], [0, 0, 0.8456], [0.0239, 0.0335, 0.3738]], [[0, 0, 0.2777], [0.1288, 0.4358, 0.3733], [0.8395, 0.8649, 0.3544]]]]

Expected: [[[[0, 0, 0.6815], [0, 0, 0.8456], [0.0239, 0.0335, 0.3738]], [[0, 0, 0.2777], [0.1288, 0.4358, 0.3733], [0.8395, 0.8649, 0.3544]]]]