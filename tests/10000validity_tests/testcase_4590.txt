import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min39387 = tf.keras.layers.Input(shape=([1, 2]))
in1Min39387 = tf.keras.layers.Input(shape=([1, 2]))
in0Cro369 = tf.keras.layers.Input(shape=([4, 1]))
in0Con62214 = tf.keras.layers.Input(shape=([2, 3, 2]))
in0Min22681 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Min22681 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Min39387 = keras.layers.Minimum(name = 'Min39387', )([in0Min39387,in1Min39387])
Res4351 = keras.layers.Reshape((1, 2, 1), name = 'Res4351', )(Min39387)
Sep4064 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep4064', )(Res4351)
Zer64699 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer64699', )(Sep4064)
Cro369 = keras.layers.Cropping1D(cropping=((2, 0)), name = 'Cro369', )(in0Cro369)
Res41590 = keras.layers.Reshape((2, 1, 1), name = 'Res41590', )(Cro369)
Dep84144 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep84144', )(Res41590)
Zer38171 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer38171', )(Dep84144)
Con62214 = keras.layers.Concatenate(axis=3, name = 'Con62214', )([Zer38171,in0Con62214])
Ave81837 = keras.layers.Average(name = 'Ave81837', )([Zer64699,Con62214])
Res49625 = keras.layers.Reshape((2, 3, 3, 1), name = 'Res49625', )(Ave81837)
Min22681 = keras.layers.Minimum(name = 'Min22681', )([in0Min22681,in1Min22681])
Zer18240 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (2, 0)), name = 'Zer18240', )(Min22681)
Min20023 = keras.layers.Minimum(name = 'Min20023', )([Res49625,Zer18240])
PRe71293 = keras.layers.PReLU(name = 'PRe71293', )(Min20023)
model = tf.keras.models.Model(inputs=[in0Min39387,in1Min39387,in0Cro369,in0Con62214,in0Min22681,in1Min22681], outputs=PRe71293)
w = model.get_layer('Sep4064').get_weights() 
w[0] = np.array([[[[0.3919]]]])
w[1] = np.array([[[[0.9287, 0.0803, 0.2799]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep4064').set_weights(w) 
w = model.get_layer('Dep84144').get_weights() 
w[0] = np.array([[[[0.7078]]]])
w[1] = np.array([0])
model.get_layer('Dep84144').set_weights(w) 
w = model.get_layer('PRe71293').get_weights() 
w[0] = np.array([[[[0.4846], [0.8928], [0.413]], [[0.9088], [0.3354], [0.0159]], [[0.3206], [0.9619], [0.1669]]], [[[0.6141], [0.7097], [0.4056]], [[0.5563], [0.0926], [0.8917]], [[0.848], [0.7756], [0.8645]]]])
model.get_layer('PRe71293').set_weights(w) 
in0Min39387 = tf.constant([[[0.7213, 0.4763]]])
in1Min39387 = tf.constant([[[0.8429, 0.8323]]])
in0Cro369 = tf.constant([[[1.3531], [1.3315], [1.479], [1.2003]]])
in0Con62214 = tf.constant([[[[0.4477, 0.7917], [0.5032, 0.0686], [0.3667, 0.4135]], [[0.6537, 0.4883], [0.0826, 0.8363], [0.2306, 0.0664]]]])
in0Min22681 = tf.constant([[[[[0.4963]]], [[[0.8833]]]]])
in1Min22681 = tf.constant([[[[[0.4925]]], [[[0.6651]]]]])
print (np.array2string(model.predict([in0Min39387,in1Min39387,in0Cro369,in0Con62214,in0Min22681,in1Min22681],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe71293.png')

LMin39387 = minimum_layer([[[[0.7213, 0.4763]]], [[[0.8429, 0.8323]]]], Min39387), 
LRes4351 = reshape_layer(Min39387, [1, 2, 1], Res4351), 
LSep4064 = separable_conv2D_layer(Res4351, 1, 1,[[[[[0.3919]]]],[[[[0.9287, 0.0803, 0.2799]]]]],[0, 0, 0], 1, 1, true, Sep4064), 
LZer64699 = zero_padding2D_layer(Sep4064, 1, 0, 1, 0, Zer64699), 
LCro369 = cropping1D_layer([[[1.3531], [1.3315], [1.479], [1.2003]]], 2, 0, Cro369), 
LRes41590 = reshape_layer(Cro369, [2, 1, 1], Res41590), 
LDep84144 = depthwise_conv2D_layer(Res41590, 1, 1,[[[[0.7078]]]],[0], 1, 1, true, Dep84144), 
LZer38171 = zero_padding2D_layer(Dep84144, 0, 0, 2, 0, Zer38171), 
LCon62214 = concatenate_layer([Zer38171,[[[[0.4477, 0.7917], [0.5032, 0.0686], [0.3667, 0.4135]], [[0.6537, 0.4883], [0.0826, 0.8363], [0.2306, 0.0664]]]]], 3, Con62214), 
LAve81837 = average_layer([Zer64699,Con62214], Ave81837), 
LRes49625 = reshape_layer(Ave81837, [2, 3, 3, 1], Res49625), 
LMin22681 = minimum_layer([[[[[[0.4963]]], [[[0.8833]]]]], [[[[[0.4925]]], [[[0.6651]]]]]], Min22681), 
LZer18240 = zero_padding3D_layer(Min22681, 0, 0, 2, 0, 2, 0, Zer18240), 
LMin20023 = minimum_layer([Res49625,Zer18240], Min20023), 
LPRe71293 = prelu_layer(Min20023, [[[[0.4846], [0.8928], [0.413]], [[0.9088], [0.3354], [0.0159]], [[0.3206], [0.9619], [0.1669]]], [[[0.6141], [0.7097], [0.4056]], [[0.5563], [0.0926], [0.8917]], [[0.848], [0.7756], [0.8645]]]], PRe71293), 
exec_layers([LMin39387,LRes4351,LSep4064,LZer64699,LCro369,LRes41590,LDep84144,LZer38171,LCon62214,LAve81837,LRes49625,LMin22681,LZer18240,LMin20023,LPRe71293],["Min39387","Res4351","Sep4064","Zer64699","Cro369","Res41590","Dep84144","Zer38171","Con62214","Ave81837","Res49625","Min22681","Zer18240","Min20023","PRe71293"],PRe71293,"PRe71293")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.2067500]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0593233]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0.20675]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0.0593233427015]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.2068]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.0594]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.2068]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0.0594]]]]]