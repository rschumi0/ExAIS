import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave44179 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave44179 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Fla17677 = tf.keras.layers.Input(shape=([3, 4, 1]))
in0Ave74219 = tf.keras.layers.Input(shape=([2, 1]))

Ave44179 = keras.layers.Average(name = 'Ave44179', )([in0Ave44179,in1Ave44179])
Res10099 = keras.layers.Reshape((2, 2), name = 'Res10099', )(Ave44179)
Zer25431 = keras.layers.ZeroPadding1D(padding=((20, 0)), name = 'Zer25431', )(Res10099)
Fla17677 = keras.layers.Flatten(name = 'Fla17677', )(in0Fla17677)
Res23289 = keras.layers.Reshape((12, 1), name = 'Res23289', )(Fla17677)
Zer22590 = keras.layers.ZeroPadding1D(padding=((10, 0)), name = 'Zer22590', )(Res23289)
Ave74219 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave74219', )(in0Ave74219)
Res36465 = keras.layers.Reshape((2, 1, 1), name = 'Res36465', )(Ave74219)
Cro11695 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro11695', )(Res36465)
Sof97280 = keras.layers.Softmax(axis=1, name = 'Sof97280', )(Cro11695)
Res19539 = keras.layers.Reshape((2, 1), name = 'Res19539', )(Sof97280)
Dot28792 = keras.layers.Dot(axes=(2, 2), name = 'Dot28792', )([Zer22590,Res19539])
Min98743 = keras.layers.Minimum(name = 'Min98743', )([Zer25431,Dot28792])
model = tf.keras.models.Model(inputs=[in0Ave44179,in1Ave44179,in0Fla17677,in0Ave74219], outputs=Min98743)
in0Ave44179 = tf.constant([[[[0.4326], [0.9609]], [[0.4821], [0.3494]]]])
in1Ave44179 = tf.constant([[[[0.1148], [0.4038]], [[0.2501], [0.588]]]])
in0Fla17677 = tf.constant([[[[1.9428], [1.8757], [1.8393], [1.0648]], [[1.4689], [1.3447], [1.3985], [1.8016]], [[1.3197], [1.5797], [1.1494], [1.2451]]]])
in0Ave74219 = tf.constant([[[1.6784], [1.5254]]])
print (np.array2string(model.predict([in0Ave44179,in1Ave44179,in0Fla17677,in0Ave74219],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min98743.png')

LAve44179 = average_layer([[[[[0.4326], [0.9609]], [[0.4821], [0.3494]]]], [[[[0.1148], [0.4038]], [[0.2501], [0.588]]]]], Ave44179), 
LRes10099 = reshape_layer(Ave44179, [2, 2], Res10099), 
LZer25431 = zero_padding1D_layer(Res10099, 20, 0, Zer25431), 
LFla17677 = flatten_layer([[[[1.9428], [1.8757], [1.8393], [1.0648]], [[1.4689], [1.3447], [1.3985], [1.8016]], [[1.3197], [1.5797], [1.1494], [1.2451]]]], Fla17677), 
LRes23289 = reshape_layer(Fla17677, [12, 1], Res23289), 
LZer22590 = zero_padding1D_layer(Res23289, 10, 0, Zer22590), 
LAve74219 = average_pooling1D_layer([[[1.6784], [1.5254]]], 1, Ave74219), 
LRes36465 = reshape_layer(Ave74219, [2, 1, 1], Res36465), 
LCro11695 = cropping2D_layer(Res36465, 0, 0, 0, 0, Cro11695), 
LSof97280 = softmax_layer(Cro11695, 1, Sof97280), 
LRes19539 = reshape_layer(Sof97280, [2, 1], Res19539), 
LDot28792 = dot_layer(Zer22590,Res19539, 2, 2, Dot28792), 
LMin98743 = minimum_layer([Zer25431,Dot28792], Min98743), 
exec_layers([LAve44179,LRes10099,LZer25431,LFla17677,LRes23289,LZer22590,LAve74219,LRes36465,LCro11695,LSof97280,LRes19539,LDot28792,LMin98743],["Ave44179","Res10099","Zer25431","Fla17677","Res23289","Zer22590","Ave74219","Res36465","Cro11695","Sof97280","Res19539","Dot28792","Min98743"],Min98743,"Min98743")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.0000000, 0.0000000], [0.2737000, 0.5308210], [0.3661000, 0.4687000]]]

Expected (Unparsed): [[[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0,0],[0.2737,0.5308210135557653],[0.3661,0.4687]]]

Actual:   [[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0.2737, 0.5309], [0.3661, 0.4687]]]

Expected: [[[0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0, 0], [0.2737, 0.5309], [0.3661, 0.4687]]]