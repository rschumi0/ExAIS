import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave71452 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave71452 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Ave71452 = keras.layers.Average(name = 'Ave71452', )([in0Ave71452,in1Ave71452])
Res33792 = keras.layers.Reshape((1, 1, 2), name = 'Res33792', )(Ave71452)
Con36769 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con36769', )(Res33792)
Res75774 = keras.layers.Reshape((1, 4), name = 'Res75774', )(Con36769)
Glo494 = keras.layers.GlobalMaxPool1D(name = 'Glo494', )(Res75774)
model = tf.keras.models.Model(inputs=[in0Ave71452,in1Ave71452], outputs=Glo494)
w = model.get_layer('Con36769').get_weights() 
w[0] = np.array([[[[0.4751, 0.4312, 0.1471, 0.2458], [0.5934, 0.6846, 0.5376, 0.132]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con36769').set_weights(w) 
in0Ave71452 = tf.constant([[[[[0.5698], [0.8662]]]]])
in1Ave71452 = tf.constant([[[[[0.6451], [0.3852]]]]])
print (np.array2string(model.predict([in0Ave71452,in1Ave71452],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo494.png')

LAve71452 = average_layer([[[[[[0.5698], [0.8662]]]]], [[[[[0.6451], [0.3852]]]]]], Ave71452), 
LRes33792 = reshape_layer(Ave71452, [1, 1, 2], Res33792), 
LCon36769 = conv2D_layer(Res33792, 1, 1,[[[[0.4751, 0.4312, 0.1471, 0.2458], [0.5934, 0.6846, 0.5376, 0.132]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con36769), 
LRes75774 = reshape_layer(Con36769, [1, 4], Res75774), 
LGlo494 = global_max_pool1D_layer(Res75774, Glo494), 
exec_layers([LAve71452,LRes33792,LCon36769,LRes75774,LGlo494],["Ave71452","Res33792","Con36769","Res75774","Glo494"],Glo494,"Glo494")

Actual (Unparsed): [[0.6598899, 0.6902867, 0.4257322, 0.2319036]]

Expected (Unparsed): [[0.659889875,0.6902866599999999,0.42573221499999997,0.23190360999999998]]

Actual:   [[0.6599, 0.6903, 0.4258, 0.232]]

Expected: [[0.6599, 0.6903, 0.4258, 0.232]]