import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul99486 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul99486 = tf.keras.layers.Input(shape=([2, 2, 2]))

Mul99486 = keras.layers.Multiply(name = 'Mul99486', )([in0Mul99486,in1Mul99486])
Sep57070 = keras.layers.SeparableConv2D(4, (1, 1),strides=(2, 2), padding='same', name = 'Sep57070', )(Mul99486)
Res3468 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res3468', )(Sep57070)
Glo22144 = keras.layers.GlobalMaxPool3D(name = 'Glo22144', )(Res3468)
model = tf.keras.models.Model(inputs=[in0Mul99486,in1Mul99486], outputs=Glo22144)
w = model.get_layer('Sep57070').get_weights() 
w[0] = np.array([[[[0.3298], [0.946]]]])
w[1] = np.array([[[[0.5349, 0.0086, 0.0238, 0.8212], [0.2987, 0.2961, 0.3863, 0.7742]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep57070').set_weights(w) 
in0Mul99486 = tf.constant([[[[0.1371, 0.0649], [0.0118, 0.6801]], [[0.7952, 0.0123], [0.5244, 0.9365]]]])
in1Mul99486 = tf.constant([[[[0.2916, 0.215], [0.7533, 0.5092]], [[0.3706, 0.4692], [0.7462, 0.1405]]]])
print (np.array2string(model.predict([in0Mul99486,in1Mul99486],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo22144.png')

LMul99486 = multiply_layer([[[[[0.1371, 0.0649], [0.0118, 0.6801]], [[0.7952, 0.0123], [0.5244, 0.9365]]]], [[[[0.2916, 0.215], [0.7533, 0.5092]], [[0.3706, 0.4692], [0.7462, 0.1405]]]]], Mul99486), 
LSep57070 = separable_conv2D_layer(Mul99486, 1, 1,[[[[[0.3298], [0.946]]]],[[[[0.5349, 0.0086, 0.0238, 0.8212], [0.2987, 0.2961, 0.3863, 0.7742]]]]],[0, 0, 0, 0], 2, 2, true, Sep57070), 
LRes3468 = reshape_layer(Sep57070, [1, 1, 4, 1], Res3468), 
LGlo22144 = global_max_pool3D_layer(Res3468, Glo22144), 
exec_layers([LMul99486,LSep57070,LRes3468,LGlo22144],["Mul99486","Sep57070","Res3468","Glo22144"],Glo22144,"Glo22144")

Actual (Unparsed): [[0.0210469]]

Expected (Unparsed): [[0.0210468581169136]]

Actual:   [[0.0211]]

Expected: [[0.0211]]