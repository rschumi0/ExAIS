import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add10157 = tf.keras.layers.Input(shape=([1, 1]))
in1Add10157 = tf.keras.layers.Input(shape=([1, 1]))

Add10157 = keras.layers.Add(name = 'Add10157', )([in0Add10157,in1Add10157])
GRU31518 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU31518', )(Add10157)
Res5014 = keras.layers.Reshape((2, 1), name = 'Res5014', )(GRU31518)
Res9760 = keras.layers.Reshape((2, 1, 1), name = 'Res9760', )(Res5014)
Zer76902 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer76902', )(Res9760)
model = tf.keras.models.Model(inputs=[in0Add10157,in1Add10157], outputs=Zer76902)
w = model.get_layer('GRU31518').get_weights() 
w[0] = np.array([[5, 10, 7, 5, 9, 10]])
w[1] = np.array([[5, 8, 6, 3, 9, 6], [8, 8, 7, 9, 8, 4]])
w[2] = np.array([3, 9, 4, 5, 8, 6])
model.get_layer('GRU31518').set_weights(w) 
in0Add10157 = tf.constant([[[0.9666]]])
in1Add10157 = tf.constant([[[0.2128]]])
print (np.array2string(model.predict([in0Add10157,in1Add10157],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer76902.png')

LAdd10157 = add_layer([[[[0.9666]]], [[[0.2128]]]], Add10157), 
LGRU31518 = gru_layer(Add10157,[[5, 10, 7, 5, 9, 10]],[[5, 8, 6, 3, 9, 6], [8, 8, 7, 9, 8, 4]],[3, 9, 4, 5, 8, 6], false, GRU31518), 
LRes5014 = reshape_layer(GRU31518, [2, 1], Res5014), 
LRes9760 = reshape_layer(Res5014, [2, 1, 1], Res9760), 
LZer76902 = zero_padding2D_layer(Res9760, 1, 1, 1, 1, Zer76902), 
exec_layers([LAdd10157,LGRU31518,LRes5014,LRes9760,LZer76902],["Add10157","GRU31518","Res5014","Res9760","Zer76902"],Zer76902,"Zer76902")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0001368], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[0.00013677999629901902],[0]],[[0],[9.317095983618622e-10],[0]],[[0],[0],[0]]]]

Actual:   [[[[0], [0], [0]], [[0], [0.0002], [0]], [[0], [0], [0]], [[0], [0], [0]]]]

Expected: [[[[0], [0], [0]], [[0], [0.0002], [0]], [[0], [0], [0]], [[0], [0], [0]]]]