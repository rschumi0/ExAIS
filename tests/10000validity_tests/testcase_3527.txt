import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave65378 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Ave65378 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con77116 = tf.keras.layers.Input(shape=([2]))
in0Lay23533 = tf.keras.layers.Input(shape=([2]))
in0Sub44332 = tf.keras.layers.Input(shape=([3]))
in1Sub44332 = tf.keras.layers.Input(shape=([3]))
in0Con48359 = tf.keras.layers.Input(shape=([1]))

Ave65378 = keras.layers.Average(name = 'Ave65378', )([in0Ave65378,in1Ave65378])
Bat39308 = keras.layers.BatchNormalization(axis=2, epsilon=0.9385794320049451,  name = 'Bat39308', )(Ave65378)
Res17909 = keras.layers.Reshape((1, 1, 2), name = 'Res17909', )(Bat39308)
Res75348 = keras.layers.Reshape((1, 2), name = 'Res75348', )(Res17909)
Fla36932 = keras.layers.Flatten(name = 'Fla36932', )(Res75348)
Con77116 = keras.layers.Concatenate(axis=1, name = 'Con77116', )([Fla36932,in0Con77116])
Lay23533 = keras.layers.LayerNormalization(axis=1, epsilon=2.926909936458263, name = 'Lay23533', )(in0Lay23533)
Res24447 = keras.layers.Reshape((2, 1), name = 'Res24447', )(Lay23533)
Loc6475 = keras.layers.LocallyConnected1D(4, (2),strides=(12), name = 'Loc6475', )(Res24447)
Fla64657 = keras.layers.Flatten(name = 'Fla64657', )(Loc6475)
Sub44332 = keras.layers.Subtract(name = 'Sub44332', )([in0Sub44332,in1Sub44332])
Con48359 = keras.layers.Concatenate(axis=1, name = 'Con48359', )([Sub44332,in0Con48359])
Mul37555 = keras.layers.Multiply(name = 'Mul37555', )([Fla64657,Con48359])
ReL60124 = keras.layers.ReLU(max_value=3.1979158775549648, negative_slope=3.095496408271298, threshold=2.8790536651849283, name = 'ReL60124', )(Mul37555)
Add60067 = keras.layers.Add(name = 'Add60067', )([Con77116,ReL60124])
model = tf.keras.models.Model(inputs=[in0Ave65378,in1Ave65378,in0Con77116,in0Lay23533,in0Sub44332,in1Sub44332,in0Con48359], outputs=Add60067)
w = model.get_layer('Bat39308').get_weights() 
w[0] = np.array([0.3304])
w[1] = np.array([0.7289])
w[2] = np.array([0.197])
w[3] = np.array([0.6221])
model.get_layer('Bat39308').set_weights(w) 
w = model.get_layer('Loc6475').get_weights() 
w[0] = np.array([[[0.5413, 0.9735, 0.418, 0.3161], [0.3025, 0.9596, 0.0855, 0.3519]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc6475').set_weights(w) 
in0Ave65378 = tf.constant([[[[[0.4933, 0.3762]]]]])
in1Ave65378 = tf.constant([[[[[0.9588, 0.2008]]]]])
in0Con77116 = tf.constant([[0.8833, 0.6012]])
in0Lay23533 = tf.constant([[1.0484, 1.8854]])
in0Sub44332 = tf.constant([[0.2047, 0.7447, 0.824]])
in1Sub44332 = tf.constant([[0.9753, 0.8959, 0.7727]])
in0Con48359 = tf.constant([[0.3222]])
print (np.array2string(model.predict([in0Ave65378,in1Ave65378,in0Con77116,in0Lay23533,in0Sub44332,in1Sub44332,in0Con48359],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add60067.png')

LAve65378 = average_layer([[[[[[0.4933, 0.3762]]]]], [[[[[0.9588, 0.2008]]]]]], Ave65378), 
LBat39308 = batch_normalization_layer(Ave65378, 2, 0.9385794320049451, [0.3304], [0.7289], [0.197], [0.6221], Bat39308), 
LRes17909 = reshape_layer(Bat39308, [1, 1, 2], Res17909), 
LRes75348 = reshape_layer(Res17909, [1, 2], Res75348), 
LFla36932 = flatten_layer(Res75348, Fla36932), 
LCon77116 = concatenate_layer([Fla36932,[[0.8833, 0.6012]]], 1, Con77116), 
LLay23533 = layer_normalization_layer([[1.0484, 1.8854]], 1, 2.926909936458263, Lay23533), 
LRes24447 = reshape_layer(Lay23533, [2, 1], Res24447), 
LLoc6475 = locally_connected1D_layer(Res24447, 2,[[[0.5413, 0.9735, 0.418, 0.3161], [0.3025, 0.9596, 0.0855, 0.3519]]],[[0, 0, 0, 0]], 12, Loc6475), 
LFla64657 = flatten_layer(Loc6475, Fla64657), 
LSub44332 = subtract_layer([[0.2047, 0.7447, 0.824]], [[0.9753, 0.8959, 0.7727]], Sub44332), 
LCon48359 = concatenate_layer([Sub44332,[[0.3222]]], 1, Con48359), 
LMul37555 = multiply_layer([Fla64657,Con48359], Mul37555), 
LReL60124 = relu_layer(Mul37555, 3.1979158775549648, 3.095496408271298, 2.8790536651849283, ReL60124), 
LAdd60067 = add_layer([Con77116,ReL60124], Add60067), 
exec_layers([LAve65378,LBat39308,LRes17909,LRes75348,LFla36932,LCon77116,LLay23533,LRes24447,LLoc6475,LFla64657,LSub44332,LCon48359,LMul37555,LReL60124,LAdd60067],["Ave65378","Bat39308","Res17909","Res75348","Fla36932","Con77116","Lay23533","Res24447","Loc6475","Fla64657","Sub44332","Con48359","Mul37555","ReL60124","Add60067"],Add60067,"Add60067")

Actual (Unparsed): [[-7.9079283, -8.1574550, -8.0413464, -8.3024161]]

Expected (Unparsed): [[-7.907928286756914,-8.157455045942326,-8.041346422752499,-8.302416101642601]]

Actual:   [[-7.9079, -8.1574, -8.0413, -8.3024]]

Expected: [[-7.9079, -8.1574, -8.0413, -8.3024]]