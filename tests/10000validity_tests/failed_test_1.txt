import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max9690 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Ave30701 = tf.keras.layers.Input(shape=([2, 1]))

Max9690 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max9690', )(in0Max9690)
Res75521 = keras.layers.Reshape((2, 2), name = 'Res75521', )(Max9690)
Loc54739 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc54739', )(Res75521)
Ave30701 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave30701', )(in0Ave30701)
Max6660 = keras.layers.MaxPool1D(pool_size=(2), name = 'Max6660', )(Ave30701)
Zer41 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer41', )(Max6660)
Dot12893 = keras.layers.Dot(axes=(1, 1), name = 'Dot12893', )([Loc54739,Zer41])
Den71480 = keras.layers.Dense(2,name = 'Den71480', )(Dot12893)
model = tf.keras.models.Model(inputs=[in0Max9690,in0Ave30701], outputs=Den71480)
w = model.get_layer('Loc54739').get_weights() 
w[0] = np.array([[[0.7555, 0.1962, 0.4704], [0.8312, 0.446, 0.4753]], [[0.9284, 0.4316, 0.9228], [0.6349, 0.6713, 0.1759]]])
w[1] = np.array([[0, 0, 0], [0, 0, 0]])
model.get_layer('Loc54739').set_weights(w) 
w = model.get_layer('Den71480').get_weights() 
w[0] = np.array([[0.2972, 0.7753], [0.1385, 0.1282]])
w[1] = np.array([0.199, 0.9958])
model.get_layer('Den71480').set_weights(w) 
in0Max9690 = tf.constant([[[[1.5917], [1.1107]], [[1.4495], [1.7146]]]])
in0Ave30701 = tf.constant([[[1.2732, 1.5439], [1.9474, 1.95]]])
print (np.array2string(model.predict([in0Max9690,in0Ave30701],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den71480.png')

LMax9690 = max_pool2D_layer([[[[1.5917], [1.1107]], [[1.4495], [1.7146]]]], 1, 1, Max9690), 
LRes75521 = reshape_layer(Max9690, [2, 2], Res75521), 
LLoc54739 = locally_connected1D_layer(Res75521, 1,[[[0.7555, 0.1962, 0.4704], [0.8312, 0.446, 0.4753]], [[0.9284, 0.4316, 0.9228], [0.6349, 0.6713, 0.1759]]],[[0, 0, 0], [0, 0, 0]], 1, Loc54739), 
LAve30701 = average_pooling1D_layer([[[1.2732, 1.5439], [1.9474, 1.95]]], 1, Ave30701), 
LMax6660 = max_pool1D_layer(Ave30701, 2, Max6660), 
LZer41 = zero_padding1D_layer(Max6660, 1, 0, Zer41), 
LDot12893 = dot_layer(Loc54739,Zer41, 1, 1, Dot12893), 
LDen71480 = dense_layer(Dot12893, [[0.2972, 0.7753], [0.1385, 0.1282]],[0.199, 0.9958], Den71480), 
exec_layers([LMax9690,LRes75521,LLoc54739,LAve30701,LMax6660,LZer41,LDot12893,LDen71480],["Max9690","Res75521","Loc54739","Ave30701","Max6660","Zer41","Dot12893","Den71480"],Den71480,"Den71480")

Actual (Unparsed): 

Expected (Unparsed): [[[2.265349783444575,5.279730579719434],[1.7070660800738104,4.122303774155959],[1.5904194981501676,3.880473536445943]]]

Actual:   

Expected: [[[2.2654, 5.2798], [1.7071, 4.1224], [1.5905, 3.8805]]]