import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den1222 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Dot80789 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot80789 = tf.keras.layers.Input(shape=([2, 2]))
in0Con78441 = tf.keras.layers.Input(shape=([2, 4]))

Den1222 = keras.layers.Dense(3,name = 'Den1222', )(in0Den1222)
Lay37571 = keras.layers.LayerNormalization(axis=1, epsilon=1.3705099456502328, name = 'Lay37571', )(Den1222)
Res7572 = keras.layers.Reshape((2, 6), name = 'Res7572', )(Lay37571)
Dot80789 = keras.layers.Dot(axes=(2, 1), name = 'Dot80789', )([in0Dot80789,in1Dot80789])
Con78441 = keras.layers.Concatenate(axis=2, name = 'Con78441', )([Dot80789,in0Con78441])
Min85654 = keras.layers.Minimum(name = 'Min85654', )([Res7572,Con78441])
model = tf.keras.models.Model(inputs=[in0Den1222,in0Dot80789,in1Dot80789,in0Con78441], outputs=Min85654)
w = model.get_layer('Den1222').get_weights() 
w[0] = np.array([[0.5584, 0.0169, 0.42], [0.1014, 0.7502, 0.8803]])
w[1] = np.array([0.7294, 0.2619, 0.3703])
model.get_layer('Den1222').set_weights(w) 
in0Den1222 = tf.constant([[[[0.0066, 0.1939], [0.0171, 0.6461]], [[0.1248, 0.2323], [0.4263, 0.3948]]]])
in0Dot80789 = tf.constant([[[0.7973, 0.831], [0.3793, 0.1621]]])
in1Dot80789 = tf.constant([[[0.779, 0.433], [0.3659, 0.7743]]])
in0Con78441 = tf.constant([[[0.5533, 0.4163, 0.6562, 0.6257], [0.2005, 0.6379, 0.2852, 0.7396]]])
print (np.array2string(model.predict([in0Den1222,in0Dot80789,in1Dot80789,in0Con78441],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min85654.png')

LDen1222 = dense_layer([[[[0.0066, 0.1939], [0.0171, 0.6461]], [[0.1248, 0.2323], [0.4263, 0.3948]]]], [[0.5584, 0.0169, 0.42], [0.1014, 0.7502, 0.8803]],[0.7294, 0.2619, 0.3703], Den1222), 
LLay37571 = layer_normalization_layer(Den1222, 1, 1.3705099456502328, Lay37571), 
LRes7572 = reshape_layer(Lay37571, [2, 6], Res7572), 
LDot80789 = dot_layer([[[0.7973, 0.831], [0.3793, 0.1621]]], [[[0.779, 0.433], [0.3659, 0.7743]]], 2, 1, Dot80789), 
LCon78441 = concatenate_layer([Dot80789,[[[0.5533, 0.4163, 0.6562, 0.6257], [0.2005, 0.6379, 0.2852, 0.7396]]]], 2, Con78441), 
LMin85654 = minimum_layer([Res7572,Con78441], Min85654), 
exec_layers([LDen1222,LLay37571,LRes7572,LDot80789,LCon78441,LMin85654],["Den1222","Lay37571","Res7572","Dot80789","Con78441","Min85654"],Min85654,"Min85654")

Actual (Unparsed): [[[-0.0298395, -0.0131558, -0.0356178, -0.0863837, 0.0773331, 0.0210750], [0.0298395, 0.0131558, 0.0356178, 0.0863837, -0.0773331, -0.0210750]]]

Expected (Unparsed): [[[-0.029839515999133436,-0.013155767855043996,-0.03561776707532149,-0.08638365227916416,0.07733313419821866,0.021074973064180078],[0.02983951599913353,0.01315576785504395,0.035617767075321584,0.08638365227916425,-0.07733313419821866,-0.021074973064180078]]]

Actual:   [[[-0.0298, -0.0131, -0.0356, -0.0863, 0.0774, 0.0211], [0.0299, 0.0132, 0.0357, 0.0864, -0.0773, -0.021]]]

Expected: [[[-0.0298, -0.0131, -0.0356, -0.0863, 0.0774, 0.0211], [0.0299, 0.0132, 0.0357, 0.0864, -0.0773, -0.021]]]