import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU67096 = tf.keras.layers.Input(shape=([2, 1]))

GRU67096 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU67096', )(in0GRU67096)
Res64222 = keras.layers.Reshape((2, 1), name = 'Res64222', )(GRU67096)
Res47385 = keras.layers.Reshape((2, 1, 1), name = 'Res47385', )(Res64222)
Res45488 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res45488', )(Res47385)
Glo84026 = keras.layers.GlobalAveragePooling3D(name = 'Glo84026', )(Res45488)
Res24214 = keras.layers.Reshape((1, 1), name = 'Res24214', )(Glo84026)
Max9735 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max9735', )(Res24214)
model = tf.keras.models.Model(inputs=[in0GRU67096], outputs=Max9735)
w = model.get_layer('GRU67096').get_weights() 
w[0] = np.array([[9, 6, 3, 6, 5, 2]])
w[1] = np.array([[3, 8, 9, 9, 9, 8], [6, 7, 4, 7, 10, 5]])
w[2] = np.array([2, 2, 5, 1, 9, 6])
model.get_layer('GRU67096').set_weights(w) 
in0GRU67096 = tf.constant([[[2], [2]]])
print (np.array2string(model.predict([in0GRU67096],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max9735.png')

LGRU67096 = gru_layer([[[2], [2]]],[[9, 6, 3, 6, 5, 2]],[[3, 8, 9, 9, 9, 8], [6, 7, 4, 7, 10, 5]],[2, 2, 5, 1, 9, 6], false, GRU67096), 
LRes64222 = reshape_layer(GRU67096, [2, 1], Res64222), 
LRes47385 = reshape_layer(Res64222, [2, 1, 1], Res47385), 
LRes45488 = reshape_layer(Res47385, [2, 1, 1, 1], Res45488), 
LGlo84026 = global_average_pooling3D_layer(Res45488, Glo84026), 
LRes24214 = reshape_layer(Glo84026, [1, 1], Res24214), 
LMax9735 = max_pool1D_layer(Res24214, 1, Max9735), 
exec_layers([LGRU67096,LRes64222,LRes47385,LRes45488,LGlo84026,LRes24214,LMax9735],["GRU67096","Res64222","Res47385","Res45488","Glo84026","Res24214","Max9735"],Max9735,"Max9735")

Actual (Unparsed): [[[0.0000008]]]

Expected (Unparsed): [[[8.335864001463551e-7]]]

Actual:   [[[0]]]

Expected: [[[0]]]