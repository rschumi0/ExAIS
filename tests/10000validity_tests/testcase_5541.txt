import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub6010 = tf.keras.layers.Input(shape=([2]))
in1Sub6010 = tf.keras.layers.Input(shape=([2]))
in0Glo28868 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Mul37121 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Mul37121 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Sub6010 = keras.layers.Subtract(name = 'Sub6010', )([in0Sub6010,in1Sub6010])
Res99176 = keras.layers.Reshape((2, 1), name = 'Res99176', )(Sub6010)
Res87251 = keras.layers.Reshape((2, 1, 1), name = 'Res87251', )(Res99176)
Cro70212 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro70212', )(Res87251)
Res62494 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res62494', )(Cro70212)
Up_13572 = keras.layers.UpSampling3D(size=(2, 1, 1), name = 'Up_13572', )(Res62494)
Zer73547 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer73547', )(Up_13572)
Glo28868 = keras.layers.GlobalMaxPool3D(name = 'Glo28868', )(in0Glo28868)
Res28515 = keras.layers.Reshape((2, 1), name = 'Res28515', )(Glo28868)
Res20073 = keras.layers.Reshape((2, 1, 1), name = 'Res20073', )(Res28515)
Res78345 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res78345', )(Res20073)
Zer14739 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer14739', )(Res78345)
Mul37121 = keras.layers.Multiply(name = 'Mul37121', )([in0Mul37121,in1Mul37121])
Ave54589 = keras.layers.Average(name = 'Ave54589', )([Zer14739,Mul37121])
Add59526 = keras.layers.Add(name = 'Add59526', )([Zer73547,Ave54589])
model = tf.keras.models.Model(inputs=[in0Sub6010,in1Sub6010,in0Glo28868,in0Mul37121,in1Mul37121], outputs=Add59526)
in0Sub6010 = tf.constant([[0.0893, 0.4283]])
in1Sub6010 = tf.constant([[0.5518, 0.6474]])
in0Glo28868 = tf.constant([[[[[1.9129, 1.3685], [1.1512, 1.3053]], [[1.4713, 1.714], [1.2481, 1.703]]], [[[1.9076, 1.6195], [1.5964, 1.2734]], [[1.3556, 1.0044], [1.5347, 1.2888]]]]])
in0Mul37121 = tf.constant([[[[[0.4928], [0.2233]], [[0.9178], [0.0113]]], [[[0.87], [0.662]], [[0.5325], [0.8612]]]]])
in1Mul37121 = tf.constant([[[[[0.5433], [0.1813]], [[0.2008], [0.9888]]], [[[0.1168], [0.0469]], [[0.4352], [0.5542]]]]])
print (np.array2string(model.predict([in0Sub6010,in1Sub6010,in0Glo28868,in0Mul37121,in1Mul37121],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add59526.png')

LSub6010 = subtract_layer([[0.0893, 0.4283]], [[0.5518, 0.6474]], Sub6010), 
LRes99176 = reshape_layer(Sub6010, [2, 1], Res99176), 
LRes87251 = reshape_layer(Res99176, [2, 1, 1], Res87251), 
LCro70212 = cropping2D_layer(Res87251, 1, 0, 0, 0, Cro70212), 
LRes62494 = reshape_layer(Cro70212, [1, 1, 1, 1], Res62494), 
LUp_13572 = up_sampling3D_layer(Res62494, 2, 1, 1, Up_13572), 
LZer73547 = zero_padding3D_layer(Up_13572, 0, 0, 1, 0, 1, 0, Zer73547), 
LGlo28868 = global_max_pool3D_layer([[[[[1.9129, 1.3685], [1.1512, 1.3053]], [[1.4713, 1.714], [1.2481, 1.703]]], [[[1.9076, 1.6195], [1.5964, 1.2734]], [[1.3556, 1.0044], [1.5347, 1.2888]]]]], Glo28868), 
LRes28515 = reshape_layer(Glo28868, [2, 1], Res28515), 
LRes20073 = reshape_layer(Res28515, [2, 1, 1], Res20073), 
LRes78345 = reshape_layer(Res20073, [2, 1, 1, 1], Res78345), 
LZer14739 = zero_padding3D_layer(Res78345, 0, 0, 1, 0, 1, 0, Zer14739), 
LMul37121 = multiply_layer([[[[[[0.4928], [0.2233]], [[0.9178], [0.0113]]], [[[0.87], [0.662]], [[0.5325], [0.8612]]]]], [[[[[0.5433], [0.1813]], [[0.2008], [0.9888]]], [[[0.1168], [0.0469]], [[0.4352], [0.5542]]]]]], Mul37121), 
LAve54589 = average_layer([Zer14739,Mul37121], Ave54589), 
LAdd59526 = add_layer([Zer73547,Ave54589], Add59526), 
exec_layers([LSub6010,LRes99176,LRes87251,LCro70212,LRes62494,LUp_13572,LZer73547,LGlo28868,LRes28515,LRes20073,LRes78345,LZer14739,LMul37121,LAve54589,LAdd59526],["Sub6010","Res99176","Res87251","Cro70212","Res62494","Up_13572","Zer73547","Glo28868","Res28515","Res20073","Res78345","Zer14739","Mul37121","Ave54589","Add59526"],Add59526,"Add59526")

Actual (Unparsed): [[[[[0.1338691], [0.0202421]], [[0.0921471], [0.7429367]]], [[[0.0508080], [0.0155239]], [[0.1158720], [0.8765385]]]]]

Expected (Unparsed): [[[[[0.13386912],[0.020242145]],[[0.09214712],[0.7429367200000001]]],[[[0.050808],[0.0155239]],[[0.11587199999999999],[0.8765385200000001]]]]]

Actual:   [[[[[0.1339], [0.0203]], [[0.0922], [0.743]]], [[[0.0509], [0.0156]], [[0.1159], [0.8766]]]]]

Expected: [[[[[0.1339], [0.0203]], [[0.0922], [0.743]]], [[[0.0509], [0.0156]], [[0.1159], [0.8766]]]]]