import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub43697 = tf.keras.layers.Input(shape=([2, 2]))
in1Sub43697 = tf.keras.layers.Input(shape=([2, 2]))
in0Max8624 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max8624 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Add95356 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add95356 = tf.keras.layers.Input(shape=([1, 2, 1]))

Sub43697 = keras.layers.Subtract(name = 'Sub43697', )([in0Sub43697,in1Sub43697])
Res89610 = keras.layers.Reshape((2, 2, 1), name = 'Res89610', )(Sub43697)
Zer12016 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer12016', )(Res89610)
Max8624 = keras.layers.Maximum(name = 'Max8624', )([in0Max8624,in1Max8624])
Zer40009 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer40009', )(Max8624)
Add95356 = keras.layers.Add(name = 'Add95356', )([in0Add95356,in1Add95356])
Zer85936 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer85936', )(Add95356)
Mul14359 = keras.layers.Multiply(name = 'Mul14359', )([Zer40009,Zer85936])
Ave5861 = keras.layers.Average(name = 'Ave5861', )([Zer12016,Mul14359])
model = tf.keras.models.Model(inputs=[in0Sub43697,in1Sub43697,in0Max8624,in1Max8624,in0Add95356,in1Add95356], outputs=Ave5861)
in0Sub43697 = tf.constant([[[0.4534, 0.8105], [0.571, 0.7636]]])
in1Sub43697 = tf.constant([[[0.7599, 0.3706], [0.3667, 0.6233]]])
in0Max8624 = tf.constant([[[[0.2624]]]])
in1Max8624 = tf.constant([[[[0.765]]]])
in0Add95356 = tf.constant([[[[0.0972], [0.0013]]]])
in1Add95356 = tf.constant([[[[0.897], [0.9537]]]])
print (np.array2string(model.predict([in0Sub43697,in1Sub43697,in0Max8624,in1Max8624,in0Add95356,in1Add95356],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave5861.png')

LSub43697 = subtract_layer([[[0.4534, 0.8105], [0.571, 0.7636]]], [[[0.7599, 0.3706], [0.3667, 0.6233]]], Sub43697), 
LRes89610 = reshape_layer(Sub43697, [2, 2, 1], Res89610), 
LZer12016 = zero_padding2D_layer(Res89610, 1, 0, 1, 0, Zer12016), 
LMax8624 = maximum_layer([[[[[0.2624]]]], [[[[0.765]]]]], Max8624), 
LZer40009 = zero_padding2D_layer(Max8624, 1, 1, 1, 1, Zer40009), 
LAdd95356 = add_layer([[[[[0.0972], [0.0013]]]], [[[[0.897], [0.9537]]]]], Add95356), 
LZer85936 = zero_padding2D_layer(Add95356, 2, 0, 1, 0, Zer85936), 
LMul14359 = multiply_layer([Zer40009,Zer85936], Mul14359), 
LAve5861 = average_layer([Zer12016,Mul14359], Ave5861), 
exec_layers([LSub43697,LRes89610,LZer12016,LMax8624,LZer40009,LAdd95356,LZer85936,LMul14359,LAve5861],["Sub43697","Res89610","Zer12016","Max8624","Zer40009","Add95356","Zer85936","Mul14359","Ave5861"],Ave5861,"Ave5861")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [-0.1532500], [0.2199500]], [[0.0000000], [0.1021500], [0.0701500]]]]

Expected (Unparsed): [[[[0],[0],[0]],[[0],[-0.15325],[0.21995]],[[0],[0.10214999999999996],[0.07014999999999999]]]]

Actual:   [[[[0], [0], [0]], [[0], [-0.1532], [0.22]], [[0], [0.1022], [0.0702]]]]

Expected: [[[[0], [0], [0]], [[0], [-0.1532], [0.22]], [[0], [0.1022], [0.0702]]]]