import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep3870 = tf.keras.layers.Input(shape=([1, 1, 2]))

Sep3870 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='same', name = 'Sep3870', )(in0Sep3870)
Res82983 = keras.layers.Reshape((1, 2), name = 'Res82983', )(Sep3870)
GRU53680 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU53680', )(Res82983)
model = tf.keras.models.Model(inputs=[in0Sep3870], outputs=GRU53680)
w = model.get_layer('Sep3870').get_weights() 
w[0] = np.array([[[[0.6727], [0.6193]]]])
w[1] = np.array([[[[0.3717, 0.9635], [0.6187, 0.8008]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep3870').set_weights(w) 
w = model.get_layer('GRU53680').get_weights() 
w[0] = np.array([[1, 2, 5, 3, 6, 9, 2, 7, 9], [8, 4, 10, 5, 8, 2, 6, 1, 1]])
w[1] = np.array([[7, 2, 7, 7, 4, 4, 6, 7, 9], [7, 10, 10, 5, 5, 8, 8, 2, 3], [8, 1, 4, 4, 10, 10, 7, 2, 8]])
w[2] = np.array([[1, 5, 3, 9, 10, 1, 10, 2, 1], [10, 2, 10, 2, 8, 3, 4, 1, 2]])
model.get_layer('GRU53680').set_weights(w) 
in0Sep3870 = tf.constant([[[[0.5951, 0.9612]]]])
print (np.array2string(model.predict([in0Sep3870],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU53680.png')

LSep3870 = separable_conv2D_layer([[[[0.5951, 0.9612]]]], 1, 1,[[[[[0.6727], [0.6193]]]],[[[[0.3717, 0.9635], [0.6187, 0.8008]]]]],[0, 0], 1, 1, true, Sep3870), 
LRes82983 = reshape_layer(Sep3870, [1, 2], Res82983), 
LGRU53680 = gru_layer(Res82983,[[1, 2, 5, 3, 6, 9, 2, 7, 9], [8, 4, 10, 5, 8, 2, 6, 1, 1]],[[7, 2, 7, 7, 4, 4, 6, 7, 9], [7, 10, 10, 5, 5, 8, 8, 2, 3], [8, 1, 4, 4, 10, 10, 7, 2, 8]],[[1, 5, 3, 9, 10, 1, 10, 2, 1], [10, 2, 10, 2, 8, 3, 4, 1, 2]], true, GRU53680), 
exec_layers([LSep3870,LRes82983,LGRU53680],["Sep3870","Res82983","GRU53680"],GRU53680,"GRU53680")

Actual (Unparsed): [[0.0000000, 0.0000103, 0.0000000]]

Expected (Unparsed): [[1.00435478822547e-8,1.0295326095685821e-5,3.0615285628643325e-11]]

Actual:   [[0, 0.0001, 0]]

Expected: [[0, 0.0001, 0]]