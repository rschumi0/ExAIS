import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot74178 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot74178 = tf.keras.layers.Input(shape=([2, 3]))
in0Dot79546 = tf.keras.layers.Input(shape=([3]))
in1Dot79546 = tf.keras.layers.Input(shape=([3]))
in0Con6177 = tf.keras.layers.Input(shape=([3]))
in0Dot62950 = tf.keras.layers.Input(shape=([3]))
in1Dot62950 = tf.keras.layers.Input(shape=([3]))
in0Con12931 = tf.keras.layers.Input(shape=([3]))

Dot74178 = keras.layers.Dot(axes=(2, 2), name = 'Dot74178', )([in0Dot74178,in1Dot74178])
Fla89370 = keras.layers.Flatten(name = 'Fla89370', )(Dot74178)
Dot79546 = keras.layers.Dot(axes=(1, 1), name = 'Dot79546', )([in0Dot79546,in1Dot79546])
Con6177 = keras.layers.Concatenate(axis=1, name = 'Con6177', )([Dot79546,in0Con6177])
Sub12776 = keras.layers.Subtract(name = 'Sub12776', )([Fla89370,Con6177])
Fla3355 = keras.layers.Flatten(name = 'Fla3355', )(Sub12776)
Dot62950 = keras.layers.Dot(axes=(1, 1), name = 'Dot62950', )([in0Dot62950,in1Dot62950])
Con12931 = keras.layers.Concatenate(axis=1, name = 'Con12931', )([Dot62950,in0Con12931])
Max74531 = keras.layers.Maximum(name = 'Max74531', )([Fla3355,Con12931])
Res38645 = keras.layers.Reshape((4, 1), name = 'Res38645', )(Max74531)
Con59467 = keras.layers.Conv1D(3, (3),strides=(1), padding='same', dilation_rate=(1), name = 'Con59467', )(Res38645)
model = tf.keras.models.Model(inputs=[in0Dot74178,in1Dot74178,in0Dot79546,in1Dot79546,in0Con6177,in0Dot62950,in1Dot62950,in0Con12931], outputs=Con59467)
w = model.get_layer('Con59467').get_weights() 
w[0] = np.array([[[0.883, 0.6399, 0.5817]], [[0.3767, 0.6683, 0.0244]], [[0.8902, 0.992, 0.6454]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con59467').set_weights(w) 
in0Dot74178 = tf.constant([[[0.3788, 0.3094, 0.9677], [0.7582, 0.0281, 0.0742]]])
in1Dot74178 = tf.constant([[[0.855, 0.8361, 0.0591], [0.6232, 0.7432, 0.5977]]])
in0Dot79546 = tf.constant([[0.0114, 0.7898, 0.6306]])
in1Dot79546 = tf.constant([[0.005, 0.9228, 0.6087]])
in0Con6177 = tf.constant([[0.5026, 0.2977, 0.585]])
in0Dot62950 = tf.constant([[0.9517, 0.3967, 0.2531]])
in1Dot62950 = tf.constant([[0.7294, 0.4031, 0.8333]])
in0Con12931 = tf.constant([[0.1737, 0.1641, 0.4163]])
print (np.array2string(model.predict([in0Dot74178,in1Dot74178,in0Dot79546,in1Dot79546,in0Con6177,in0Dot62950,in1Dot62950,in0Con12931],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con59467.png')

LDot74178 = dot_layer([[[0.3788, 0.3094, 0.9677], [0.7582, 0.0281, 0.0742]]], [[[0.855, 0.8361, 0.0591], [0.6232, 0.7432, 0.5977]]], 2, 2, Dot74178), 
LFla89370 = flatten_layer(Dot74178, Fla89370), 
LDot79546 = dot_layer([[0.0114, 0.7898, 0.6306]], [[0.005, 0.9228, 0.6087]], 1, 1, Dot79546), 
LCon6177 = concatenate_layer([Dot79546,[[0.5026, 0.2977, 0.585]]], 1, Con6177), 
LSub12776 = subtract_layer(Fla89370,Con6177, Sub12776), 
LFla3355 = flatten_layer(Sub12776, Fla3355), 
LDot62950 = dot_layer([[0.9517, 0.3967, 0.2531]], [[0.7294, 0.4031, 0.8333]], 1, 1, Dot62950), 
LCon12931 = concatenate_layer([Dot62950,[[0.1737, 0.1641, 0.4163]]], 1, Con12931), 
LMax74531 = maximum_layer([Fla3355,Con12931], Max74531), 
LRes38645 = reshape_layer(Max74531, [4, 1], Res38645), 
LCon59467 = conv1D_layer(Res38645, 3,[[[0.883, 0.6399, 0.5817]], [[0.3767, 0.6683, 0.0244]], [[0.8902, 0.992, 0.6454]]],[0, 0, 0], 1, true, 1, Con59467), 
exec_layers([LDot74178,LFla89370,LDot79546,LCon6177,LSub12776,LFla3355,LDot62950,LCon12931,LMax74531,LRes38645,LCon59467],["Dot74178","Fla89370","Dot79546","Con6177","Sub12776","Fla3355","Dot62950","Con12931","Max74531","Res38645","Con59467"],Con59467,"Con59467")

Actual (Unparsed): [[[0.8834989, 1.2492055, 0.3756689], [1.4813715, 1.4189895, 0.8769692], [0.9915658, 1.0125848, 0.5930840], [0.4909833, 0.5203775, 0.2302966]]]

Expected (Unparsed): [[[0.883498925472,1.249205528794,0.37566893197400003],[1.481371508417,1.418989553961,0.8769692187],[0.991565777311,1.012584751376,0.593083993273],[0.4909832862899999,0.5203774491369999,0.23029663447099993]]]

Actual:   [[[0.8835, 1.2493, 0.3757], [1.4814, 1.419, 0.877], [0.9916, 1.0126, 0.5931], [0.491, 0.5204, 0.2303]]]

Expected: [[[0.8835, 1.2493, 0.3757], [1.4814, 1.419, 0.877], [0.9916, 1.0126, 0.5931], [0.491, 0.5204, 0.2303]]]