import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub77096 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Sub77096 = tf.keras.layers.Input(shape=([2, 2, 2]))

Sub77096 = keras.layers.Subtract(name = 'Sub77096', )([in0Sub77096,in1Sub77096])
Dep34712 = keras.layers.DepthwiseConv2D((1, 2),strides=(1, 1), padding='same', name = 'Dep34712', )(Sub77096)
model = tf.keras.models.Model(inputs=[in0Sub77096,in1Sub77096], outputs=Dep34712)
w = model.get_layer('Dep34712').get_weights() 
w[0] = np.array([[[[0.9711], [0.8125]], [[0.9587], [0.8097]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep34712').set_weights(w) 
in0Sub77096 = tf.constant([[[[0.1856, 0.1438], [0.1685, 0.6786]], [[0.5332, 0.7423], [0.0182, 0.904]]]])
in1Sub77096 = tf.constant([[[[0.4953, 0.6263], [0.7204, 0.2607]], [[0.4665, 0.4668], [0.556, 0.0087]]]])
print (np.array2string(model.predict([in0Sub77096,in1Sub77096],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep34712.png')

LSub77096 = subtract_layer([[[[0.1856, 0.1438], [0.1685, 0.6786]], [[0.5332, 0.7423], [0.0182, 0.904]]]], [[[[0.4953, 0.6263], [0.7204, 0.2607]], [[0.4665, 0.4668], [0.556, 0.0087]]]], Sub77096), 
LDep34712 = depthwise_conv2D_layer(Sub77096, 1, 2,[[[[0.9711], [0.8125]], [[0.9587], [0.8097]]]],[0, 0], 1, 1, true, Dep34712), 
exec_layers([LSub77096,LDep34712],["Sub77096","Dep34712"],Dep34712,"Dep34712")

Actual (Unparsed): [[[[-0.8298562, -0.0536576], [-0.5359501, 0.3395438]], [[-0.4508165, 0.9487681], [-0.5222576, 0.7274312]]]]

Expected (Unparsed): [[[[-0.8298562,-0.05365761999999996],[-0.53595009,0.33954375]],[[-0.45081649000000007,0.94876816],[-0.52225758,0.72743125]]]]

Actual:   [[[[-0.8298, -0.0536], [-0.5359, 0.3396]], [[-0.4508, 0.9488], [-0.5222, 0.7275]]]]

Expected: [[[[-0.8298, -0.0536], [-0.5359, 0.3396]], [[-0.4508, 0.9488], [-0.5222, 0.7275]]]]