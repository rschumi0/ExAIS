import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max92336 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max92336 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con13672 = tf.keras.layers.Input(shape=([2, 3, 2]))
in0Ave96338 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Ave96338 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Glo60321 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Con70407 = tf.keras.layers.Input(shape=([1]))
in0Glo71494 = tf.keras.layers.Input(shape=([1, 2]))
in0Con27996 = tf.keras.layers.Input(shape=([16]))

Max92336 = keras.layers.Maximum(name = 'Max92336', )([in0Max92336,in1Max92336])
Res12875 = keras.layers.Reshape((1, 2), name = 'Res12875', )(Max92336)
Cro47599 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro47599', )(Res12875)
Res92561 = keras.layers.Reshape((1, 2, 1), name = 'Res92561', )(Cro47599)
Zer14765 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer14765', )(Res92561)
Con13672 = keras.layers.Concatenate(axis=3, name = 'Con13672', )([Zer14765,in0Con13672])
Ave96338 = keras.layers.Average(name = 'Ave96338', )([in0Ave96338,in1Ave96338])
Res17508 = keras.layers.Reshape((2, 2, 2), name = 'Res17508', )(Ave96338)
Con94521 = keras.layers.Conv2D(3, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con94521', )(Res17508)
Zer42244 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer42244', )(Con94521)
Max85583 = keras.layers.Maximum(name = 'Max85583', )([Con13672,Zer42244])
Res10279 = keras.layers.Reshape((2, 9), name = 'Res10279', )(Max85583)
Fla851 = keras.layers.Flatten(name = 'Fla851', )(Res10279)
Glo60321 = keras.layers.GlobalMaxPool3D(name = 'Glo60321', )(in0Glo60321)
Con70407 = keras.layers.Concatenate(axis=1, name = 'Con70407', )([Glo60321,in0Con70407])
Glo71494 = keras.layers.GlobalMaxPool1D(name = 'Glo71494', )(in0Glo71494)
Min59970 = keras.layers.Minimum(name = 'Min59970', )([Con70407,Glo71494])
Con27996 = keras.layers.Concatenate(axis=1, name = 'Con27996', )([Min59970,in0Con27996])
Add12042 = keras.layers.Add(name = 'Add12042', )([Fla851,Con27996])
model = tf.keras.models.Model(inputs=[in0Max92336,in1Max92336,in0Con13672,in0Ave96338,in1Ave96338,in0Glo60321,in0Con70407,in0Glo71494,in0Con27996], outputs=Add12042)
w = model.get_layer('Con94521').get_weights() 
w[0] = np.array([[[[0.4249, 0.0365, 0.7505], [0.2611, 0.1506, 0.6707]], [[0.7183, 0.0491, 0.0759], [0.9058, 0.6562, 0.8272]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con94521').set_weights(w) 
in0Max92336 = tf.constant([[[[0.2442], [0.0854]]]])
in1Max92336 = tf.constant([[[[0.878], [0.6304]]]])
in0Con13672 = tf.constant([[[[0.5085, 0.733], [0.6577, 0.0559], [0.8674, 0.8896]], [[0.3722, 0.9283], [0.6758, 0.0581], [0.4765, 0.453]]]])
in0Ave96338 = tf.constant([[[[[0.7248], [0.663]], [[0.4609], [0.1865]]], [[[0.476], [0.0666]], [[0.6534], [0.5456]]]]])
in1Ave96338 = tf.constant([[[[[0.069], [0.1594]], [[0.1481], [0.7124]]], [[[0.4384], [0.9361]], [[0.2956], [0.1784]]]]])
in0Glo60321 = tf.constant([[[[[1.414], [1.6917]]], [[[1.5557], [1.9842]]]]])
in0Con70407 = tf.constant([[0.7969]])
in0Glo71494 = tf.constant([[[1.9363, 1.16]]])
in0Con27996 = tf.constant([[0.6406, 0.5307, 0.3218, 0.8453, 0.0489, 0.9093, 0.4257, 0.9567, 0.9526, 0.4247, 0.5604, 0.9231, 0.3944, 0.724, 0.6306, 0.645]])
print (np.array2string(model.predict([in0Max92336,in1Max92336,in0Con13672,in0Ave96338,in1Ave96338,in0Glo60321,in0Con70407,in0Glo71494,in0Con27996],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add12042.png')

LMax92336 = maximum_layer([[[[[0.2442], [0.0854]]]], [[[[0.878], [0.6304]]]]], Max92336), 
LRes12875 = reshape_layer(Max92336, [1, 2], Res12875), 
LCro47599 = cropping1D_layer(Res12875, 0, 0, Cro47599), 
LRes92561 = reshape_layer(Cro47599, [1, 2, 1], Res92561), 
LZer14765 = zero_padding2D_layer(Res92561, 1, 0, 1, 0, Zer14765), 
LCon13672 = concatenate_layer([Zer14765,[[[[0.5085, 0.733], [0.6577, 0.0559], [0.8674, 0.8896]], [[0.3722, 0.9283], [0.6758, 0.0581], [0.4765, 0.453]]]]], 3, Con13672), 
LAve96338 = average_layer([[[[[[0.7248], [0.663]], [[0.4609], [0.1865]]], [[[0.476], [0.0666]], [[0.6534], [0.5456]]]]], [[[[[0.069], [0.1594]], [[0.1481], [0.7124]]], [[[0.4384], [0.9361]], [[0.2956], [0.1784]]]]]], Ave96338), 
LRes17508 = reshape_layer(Ave96338, [2, 2, 2], Res17508), 
LCon94521 = conv2D_layer(Res17508, 1, 2,[[[[0.4249, 0.0365, 0.7505], [0.2611, 0.1506, 0.6707]], [[0.7183, 0.0491, 0.0759], [0.9058, 0.6562, 0.8272]]]],[0, 0, 0], 1, 1, false, 1, 1, Con94521), 
LZer42244 = zero_padding2D_layer(Con94521, 0, 0, 2, 0, Zer42244), 
LMax85583 = maximum_layer([Con13672,Zer42244], Max85583), 
LRes10279 = reshape_layer(Max85583, [2, 9], Res10279), 
LFla851 = flatten_layer(Res10279, Fla851), 
LGlo60321 = global_max_pool3D_layer([[[[[1.414], [1.6917]]], [[[1.5557], [1.9842]]]]], Glo60321), 
LCon70407 = concatenate_layer([Glo60321,[[0.7969]]], 1, Con70407), 
LGlo71494 = global_max_pool1D_layer([[[1.9363, 1.16]]], Glo71494), 
LMin59970 = minimum_layer([Con70407,Glo71494], Min59970), 
LCon27996 = concatenate_layer([Min59970,[[0.6406, 0.5307, 0.3218, 0.8453, 0.0489, 0.9093, 0.4257, 0.9567, 0.9526, 0.4247, 0.5604, 0.9231, 0.3944, 0.724, 0.6306, 0.645]]], 1, Con27996), 
LAdd12042 = add_layer([Fla851,Con27996], Add12042), 
exec_layers([LMax92336,LRes12875,LCro47599,LRes92561,LZer14765,LCon13672,LAve96338,LRes17508,LCon94521,LZer42244,LMax85583,LRes10279,LFla851,LGlo60321,LCon70407,LGlo71494,LMin59970,LCon27996,LAdd12042],["Max92336","Res12875","Cro47599","Res92561","Zer14765","Con13672","Ave96338","Res17508","Con94521","Zer42244","Max85583","Res10279","Fla851","Glo60321","Con70407","Glo71494","Min59970","Con27996","Add12042"],Add12042,"Add12042")

Actual (Unparsed): [[1.9363000, 1.3054000, 1.3736000, 0.5307000, 0.9795000, 0.9012000, 0.9507413, 1.7767000, 1.3942619, 0.9567000, 1.3248000, 1.3530000, 1.4384000, 1.5989000, 0.4525000, 1.7178997, 1.1071000, 1.6598450]]

Expected (Unparsed): [[1.9363,1.3054000000000001,1.3736,0.5307,0.9794999999999999,0.9012,0.9507412900000001,1.7767,1.39426188,0.9567,1.3248,1.353,1.4384000000000001,1.5989,0.45249999999999996,1.7178997150000002,1.1071,1.6598449949999998]]

Actual:   [[1.9363, 1.3054, 1.3736, 0.5307, 0.9795, 0.9012, 0.9508, 1.7767, 1.3943, 0.9567, 1.3248, 1.353, 1.4384, 1.5989, 0.4525, 1.7179, 1.1071, 1.6599]]

Expected: [[1.9363, 1.3055, 1.3736, 0.5307, 0.9795, 0.9012, 0.9508, 1.7767, 1.3943, 0.9567, 1.3248, 1.353, 1.4385, 1.5989, 0.4525, 1.7179, 1.1071, 1.6599]]