import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min17743 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Min17743 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con40566 = tf.keras.layers.Input(shape=([1, 2]))
in0Con28780 = tf.keras.layers.Input(shape=([1, 1]))

Min17743 = keras.layers.Minimum(name = 'Min17743', )([in0Min17743,in1Min17743])
Res44508 = keras.layers.Reshape((1, 2, 1), name = 'Res44508', )(Min17743)
Res89698 = keras.layers.Reshape((1, 2), name = 'Res89698', )(Res44508)
Con40566 = keras.layers.Concatenate(axis=2, name = 'Con40566', )([Res89698,in0Con40566])
Con28780 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con28780', )(in0Con28780)
Sim57120 = keras.layers.SimpleRNN(3,name = 'Sim57120', )(Con28780)
Res80007 = keras.layers.Reshape((3, 1), name = 'Res80007', )(Sim57120)
Res69859 = keras.layers.Reshape((3, 1, 1), name = 'Res69859', )(Res80007)
Glo95837 = keras.layers.GlobalAveragePooling2D(name = 'Glo95837', )(Res69859)
Res60477 = keras.layers.Reshape((1, 1), name = 'Res60477', )(Glo95837)
Sep43870 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep43870', )(Res60477)
Max50887 = keras.layers.Maximum(name = 'Max50887', )([Con40566,Sep43870])
Res99299 = keras.layers.Reshape((1, 4, 1), name = 'Res99299', )(Max50887)
Res29918 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res29918', )(Res99299)
Glo85209 = keras.layers.GlobalAveragePooling3D(name = 'Glo85209', )(Res29918)
model = tf.keras.models.Model(inputs=[in0Min17743,in1Min17743,in0Con40566,in0Con28780], outputs=Glo85209)
w = model.get_layer('Con28780').get_weights() 
w[0] = np.array([[[0.0665, 0.2387, 0.5112, 0.7819]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con28780').set_weights(w) 
w = model.get_layer('Sim57120').get_weights() 
w[0] = np.array([[5, 4, 6], [9, 6, 1], [8, 8, 3], [5, 2, 7]])
w[1] = np.array([[2, 6, 3], [9, 1, 2], [1, 5, 10]])
w[2] = np.array([3, 5, 4])
model.get_layer('Sim57120').set_weights(w) 
w = model.get_layer('Sep43870').get_weights() 
w[0] = np.array([[[0.9971]]])
w[1] = np.array([[[0.5055, 0.8075, 0.2176, 0.2546]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep43870').set_weights(w) 
in0Min17743 = tf.constant([[[[[0.3985]], [[0.4005]]]]])
in1Min17743 = tf.constant([[[[[0.1716]], [[0.7744]]]]])
in0Con40566 = tf.constant([[[0.5411, 0.4485]]])
in0Con28780 = tf.constant([[[0.6813]]])
print (np.array2string(model.predict([in0Min17743,in1Min17743,in0Con40566,in0Con28780],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo85209.png')

LMin17743 = minimum_layer([[[[[[0.3985]], [[0.4005]]]]], [[[[[0.1716]], [[0.7744]]]]]], Min17743), 
LRes44508 = reshape_layer(Min17743, [1, 2, 1], Res44508), 
LRes89698 = reshape_layer(Res44508, [1, 2], Res89698), 
LCon40566 = concatenate_layer([Res89698,[[[0.5411, 0.4485]]]], 2, Con40566), 
LCon28780 = conv1D_layer([[[0.6813]]], 1,[[[0.0665, 0.2387, 0.5112, 0.7819]]],[0, 0, 0, 0], 1, false, 1, Con28780), 
LSim57120 = simple_rnn_layer(Con28780,[[5, 4, 6], [9, 6, 1], [8, 8, 3], [5, 2, 7]],[[2, 6, 3], [9, 1, 2], [1, 5, 10]],[3, 5, 4], Sim57120), 
LRes80007 = reshape_layer(Sim57120, [3, 1], Res80007), 
LRes69859 = reshape_layer(Res80007, [3, 1, 1], Res69859), 
LGlo95837 = global_average_pooling2D_layer(Res69859, Glo95837), 
LRes60477 = reshape_layer(Glo95837, [1, 1], Res60477), 
LSep43870 = separable_conv1D_layer(Res60477, 1,[[[[0.9971]]],[[[0.5055, 0.8075, 0.2176, 0.2546]]]],[0, 0, 0, 0], 1, true, Sep43870), 
LMax50887 = maximum_layer([Con40566,Sep43870], Max50887), 
LRes99299 = reshape_layer(Max50887, [1, 4, 1], Res99299), 
LRes29918 = reshape_layer(Res99299, [1, 4, 1, 1], Res29918), 
LGlo85209 = global_average_pooling3D_layer(Res29918, Glo85209), 
exec_layers([LMin17743,LRes44508,LRes89698,LCon40566,LCon28780,LSim57120,LRes80007,LRes69859,LGlo95837,LRes60477,LSep43870,LMax50887,LRes99299,LRes29918,LGlo85209],["Min17743","Res44508","Res89698","Con40566","Con28780","Sim57120","Res80007","Res69859","Glo95837","Res60477","Sep43870","Max50887","Res99299","Res29918","Glo85209"],Glo85209,"Glo85209")

Actual (Unparsed): [[0.5746981]]

Expected (Unparsed): [[0.5746980720269727]]

Actual:   [[0.5747]]

Expected: [[0.5747]]