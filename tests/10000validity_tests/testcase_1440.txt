import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot55337 = tf.keras.layers.Input(shape=([2]))
in1Dot55337 = tf.keras.layers.Input(shape=([2]))
in0Con18379 = tf.keras.layers.Input(shape=([2]))
in0Sep49790 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con20645 = tf.keras.layers.Input(shape=([1]))
in0Sub48822 = tf.keras.layers.Input(shape=([3]))
in1Sub48822 = tf.keras.layers.Input(shape=([3]))

Dot55337 = keras.layers.Dot(axes=(1, 1), name = 'Dot55337', )([in0Dot55337,in1Dot55337])
Con18379 = keras.layers.Concatenate(axis=1, name = 'Con18379', )([Dot55337,in0Con18379])
Sep49790 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='same', name = 'Sep49790', )(in0Sep49790)
Res81261 = keras.layers.Reshape((1, 2), name = 'Res81261', )(Sep49790)
Fla46959 = keras.layers.Flatten(name = 'Fla46959', )(Res81261)
Con20645 = keras.layers.Concatenate(axis=1, name = 'Con20645', )([Fla46959,in0Con20645])
Sub48822 = keras.layers.Subtract(name = 'Sub48822', )([in0Sub48822,in1Sub48822])
Sub87353 = keras.layers.Subtract(name = 'Sub87353', )([Con20645,Sub48822])
Dot41324 = keras.layers.Dot(axes=(1, 1), name = 'Dot41324', )([Con18379,Sub87353])
model = tf.keras.models.Model(inputs=[in0Dot55337,in1Dot55337,in0Con18379,in0Sep49790,in0Con20645,in0Sub48822,in1Sub48822], outputs=Dot41324)
w = model.get_layer('Sep49790').get_weights() 
w[0] = np.array([[[[0.1335]]]])
w[1] = np.array([[[[0.2244, 0.3436]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep49790').set_weights(w) 
in0Dot55337 = tf.constant([[0.632, 0.851]])
in1Dot55337 = tf.constant([[0.0515, 0.7353]])
in0Con18379 = tf.constant([[0.7365, 0.9666]])
in0Sep49790 = tf.constant([[[[0.8644]]]])
in0Con20645 = tf.constant([[0.5293]])
in0Sub48822 = tf.constant([[0.2897, 0.2844, 0.3443]])
in1Sub48822 = tf.constant([[0.8096, 0.9453, 0.2593]])
print (np.array2string(model.predict([in0Dot55337,in1Dot55337,in0Con18379,in0Sep49790,in0Con20645,in0Sub48822,in1Sub48822],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot41324.png')

LDot55337 = dot_layer([[0.632, 0.851]], [[0.0515, 0.7353]], 1, 1, Dot55337), 
LCon18379 = concatenate_layer([Dot55337,[[0.7365, 0.9666]]], 1, Con18379), 
LSep49790 = separable_conv2D_layer([[[[0.8644]]]], 1, 1,[[[[[0.1335]]]],[[[[0.2244, 0.3436]]]]],[0, 0], 1, 1, true, Sep49790), 
LRes81261 = reshape_layer(Sep49790, [1, 2], Res81261), 
LFla46959 = flatten_layer(Res81261, Fla46959), 
LCon20645 = concatenate_layer([Fla46959,[[0.5293]]], 1, Con20645), 
LSub48822 = subtract_layer([[0.2897, 0.2844, 0.3443]], [[0.8096, 0.9453, 0.2593]], Sub48822), 
LSub87353 = subtract_layer(Con20645,Sub48822, Sub87353), 
LDot41324 = dot_layer(Con18379,Sub87353, 1, 1, Dot41324), 
exec_layers([LDot55337,LCon18379,LSep49790,LRes81261,LFla46959,LCon20645,LSub48822,LSub87353,LDot41324],["Dot55337","Con18379","Sep49790","Res81261","Fla46959","Con20645","Sub48822","Sub87353","Dot41324"],Dot41324,"Dot41324")

Actual (Unparsed): [[1.3047064]]

Expected (Unparsed): [[1.3047064365262422]]

Actual:   [[1.3048]]

Expected: [[1.3048]]