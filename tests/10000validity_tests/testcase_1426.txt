import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add41846 = tf.keras.layers.Input(shape=([2, 2]))
in1Add41846 = tf.keras.layers.Input(shape=([2, 2]))

Add41846 = keras.layers.Add(name = 'Add41846', )([in0Add41846,in1Add41846])
Fla99757 = keras.layers.Flatten(name = 'Fla99757', )(Add41846)
Res6335 = keras.layers.Reshape((4, 1), name = 'Res6335', )(Fla99757)
Res95038 = keras.layers.Reshape((4, 1, 1), name = 'Res95038', )(Res6335)
Con42119 = keras.layers.Conv2D(4, (2, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con42119', )(Res95038)
model = tf.keras.models.Model(inputs=[in0Add41846,in1Add41846], outputs=Con42119)
w = model.get_layer('Con42119').get_weights() 
w[0] = np.array([[[[0.6628, 0.2895, 0.876, 0.4385]]], [[[0.1044, 0.3055, 0.2829, 0.8097]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con42119').set_weights(w) 
in0Add41846 = tf.constant([[[0.6309, 0.2712], [0.3505, 0.9944]]])
in1Add41846 = tf.constant([[[0.1073, 0.7391], [0.3403, 0.2672]]])
print (np.array2string(model.predict([in0Add41846,in1Add41846],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con42119.png')

LAdd41846 = add_layer([[[[0.6309, 0.2712], [0.3505, 0.9944]]], [[[0.1073, 0.7391], [0.3403, 0.2672]]]], Add41846), 
LFla99757 = flatten_layer(Add41846, Fla99757), 
LRes6335 = reshape_layer(Fla99757, [4, 1], Res6335), 
LRes95038 = reshape_layer(Res6335, [4, 1, 1], Res95038), 
LCon42119 = conv2D_layer(Res95038, 2, 1,[[[[0.6628, 0.2895, 0.876, 0.4385]]], [[[0.1044, 0.3055, 0.2829, 0.8097]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con42119), 
exec_layers([LAdd41846,LFla99757,LRes6335,LRes95038,LCon42119],["Add41846","Fla99757","Res6335","Res95038","Con42119"],Con42119,"Con42119")

Actual (Unparsed): [[[[0.5947543, 0.5223556, 0.9324771, 1.1417406]], [[0.7417463, 0.5035212, 1.0804501, 1.0023573]], [[0.5895733, 0.5854054, 0.9620474, 1.3244333]], [[0.8361885, 0.3652332, 1.1051616, 0.5532116]]]]

Expected (Unparsed): [[[[0.59475428,0.5223555499999999,0.93247707,1.14174061]],[[0.7417463599999999,0.5035212499999999,1.08045012,1.00235731]],[[0.58957328,0.5854054,0.9620474399999999,1.32443332]],[[0.83618848,0.3652332,1.1051616,0.5532116]]]]

Actual:   [[[[0.5948, 0.5224, 0.9325, 1.1418]], [[0.7418, 0.5036, 1.0805, 1.0024]], [[0.5896, 0.5855, 0.9621, 1.3245]], [[0.8362, 0.3653, 1.1052, 0.5533]]]]

Expected: [[[[0.5948, 0.5224, 0.9325, 1.1418]], [[0.7418, 0.5036, 1.0805, 1.0024]], [[0.5896, 0.5855, 0.9621, 1.3245]], [[0.8362, 0.3653, 1.1052, 0.5533]]]]