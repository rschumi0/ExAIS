import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max51278 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Max51278 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Max51278 = keras.layers.Maximum(name = 'Max51278', )([in0Max51278,in1Max51278])
Lay79544 = keras.layers.LayerNormalization(axis=2, epsilon=2.7412078393448076, name = 'Lay79544', )(Max51278)
model = tf.keras.models.Model(inputs=[in0Max51278,in1Max51278], outputs=Lay79544)
in0Max51278 = tf.constant([[[[[0.9373, 0.9454], [0.5923, 0.4755]], [[0.6839, 0.6234], [0.581, 0.6603]]]]])
in1Max51278 = tf.constant([[[[[0.7288, 0.7063], [0.6233, 0.7628]], [[0.9339, 0.7733], [0.634, 0.2613]]]]])
print (np.array2string(model.predict([in0Max51278,in1Max51278],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lay79544.png')

LMax51278 = maximum_layer([[[[[[0.9373, 0.9454], [0.5923, 0.4755]], [[0.6839, 0.6234], [0.581, 0.6603]]]]], [[[[[0.7288, 0.7063], [0.6233, 0.7628]], [[0.9339, 0.7733], [0.634, 0.2613]]]]]], Max51278), 
LLay79544 = layer_normalization_layer(Max51278, 2, 2.7412078393448076, Lay79544), 
exec_layers([LMax51278,LLay79544],["Max51278","Lay79544"],Lay79544,"Lay79544")

Actual (Unparsed): [[[[[0.0010268, 0.0519032], [-0.0032313, 0.0309396]], [[-0.0010268, -0.0519032], [0.0032313, -0.0309396]]]]]

Expected (Unparsed): [[[[[0.001026780730876068,0.05190319836420071],[-0.003231324192303991,0.03093961614351631]],[[-0.001026780730876068,-0.05190319836420078],[0.003231324192304058,-0.03093961614351631]]]]]

Actual:   [[[[[0.0011, 0.052], [-0.0032, 0.031]], [[-0.001, -0.0519], [0.0033, -0.0309]]]]]

Expected: [[[[[0.0011, 0.052], [-0.0032, 0.031]], [[-0.001, -0.0519], [0.0033, -0.0309]]]]]