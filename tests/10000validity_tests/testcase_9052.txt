import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max39436 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Max39436 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Glo66834 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con35524 = tf.keras.layers.Input(shape=([1]))
in0Con85657 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Loc52150 = tf.keras.layers.Input(shape=([1, 1]))

Max39436 = keras.layers.Maximum(name = 'Max39436', )([in0Max39436,in1Max39436])
Res58846 = keras.layers.Reshape((2, 1, 1), name = 'Res58846', )(Max39436)
Res9836 = keras.layers.Reshape((2, 1), name = 'Res9836', )(Res58846)
Fla23781 = keras.layers.Flatten(name = 'Fla23781', )(Res9836)
Glo66834 = keras.layers.GlobalAveragePooling2D(name = 'Glo66834', )(in0Glo66834)
Con35524 = keras.layers.Concatenate(axis=1, name = 'Con35524', )([Glo66834,in0Con35524])
Max10432 = keras.layers.Maximum(name = 'Max10432', )([Fla23781,Con35524])
Res38885 = keras.layers.Reshape((2, 1), name = 'Res38885', )(Max10432)
Res8901 = keras.layers.Reshape((2, 1, 1), name = 'Res8901', )(Res38885)
Res64574 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res64574', )(Res8901)
Up_44327 = keras.layers.UpSampling3D(size=(1, 1, 1), name = 'Up_44327', )(Res64574)
Con91991 = keras.layers.Conv3D(3, (2, 1, 1),strides=(7, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con91991', )(Up_44327)
Res61961 = keras.layers.Reshape((1, 1, 3), name = 'Res61961', )(Con91991)
Zer19196 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer19196', )(Res61961)
Con85657 = keras.layers.Concatenate(axis=3, name = 'Con85657', )([Zer19196,in0Con85657])
Loc52150 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc52150', )(in0Loc52150)
Ave99530 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave99530', )(Loc52150)
Res78541 = keras.layers.Reshape((1, 3, 1), name = 'Res78541', )(Ave99530)
Max36048 = keras.layers.MaxPool2D(pool_size=(1, 3), strides=(12, 1), padding='same', name = 'Max36048', )(Res78541)
Up_9224 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_9224', )(Max36048)
Res35553 = keras.layers.Reshape((1, 6), name = 'Res35553', )(Up_9224)
Fla8892 = keras.layers.Flatten(name = 'Fla8892', )(Res35553)
Res4423 = keras.layers.Reshape((6, 1), name = 'Res4423', )(Fla8892)
Res14406 = keras.layers.Reshape((6, 1, 1), name = 'Res14406', )(Res4423)
Sep81562 = keras.layers.SeparableConv2D(4, (5, 1),strides=(4, 4), padding='same', name = 'Sep81562', )(Res14406)
Mul89928 = keras.layers.Multiply(name = 'Mul89928', )([Con85657,Sep81562])
model = tf.keras.models.Model(inputs=[in0Max39436,in1Max39436,in0Glo66834,in0Con35524,in0Con85657,in0Loc52150], outputs=Mul89928)
w = model.get_layer('Con91991').get_weights() 
w[0] = np.array([[[[[0.1723, 0.901, 0.0226]]]], [[[[0.3862, 0.2129, 0.0257]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con91991').set_weights(w) 
w = model.get_layer('Loc52150').get_weights() 
w[0] = np.array([[[0.8414, 0.2318, 0.145]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc52150').set_weights(w) 
w = model.get_layer('Sep81562').get_weights() 
w[0] = np.array([[[[0.1532]]], [[[0.2727]]], [[[0.9246]]], [[[0.9464]]], [[[0.9351]]]])
w[1] = np.array([[[[0.732, 0.0617, 0.93, 0.4727]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep81562').set_weights(w) 
in0Max39436 = tf.constant([[[[[0.0915]]], [[[0.2185]]]]])
in1Max39436 = tf.constant([[[[[0.0553]]], [[[0.1141]]]]])
in0Glo66834 = tf.constant([[[[1.3996]]]])
in0Con35524 = tf.constant([[0.6681]])
in0Con85657 = tf.constant([[[[0.0002]], [[0.4033]]]])
in0Loc52150 = tf.constant([[[0.0697]]])
print (np.array2string(model.predict([in0Max39436,in1Max39436,in0Glo66834,in0Con35524,in0Con85657,in0Loc52150],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul89928.png')

LMax39436 = maximum_layer([[[[[[0.0915]]], [[[0.2185]]]]], [[[[[0.0553]]], [[[0.1141]]]]]], Max39436), 
LRes58846 = reshape_layer(Max39436, [2, 1, 1], Res58846), 
LRes9836 = reshape_layer(Res58846, [2, 1], Res9836), 
LFla23781 = flatten_layer(Res9836, Fla23781), 
LGlo66834 = global_average_pooling2D_layer([[[[1.3996]]]], Glo66834), 
LCon35524 = concatenate_layer([Glo66834,[[0.6681]]], 1, Con35524), 
LMax10432 = maximum_layer([Fla23781,Con35524], Max10432), 
LRes38885 = reshape_layer(Max10432, [2, 1], Res38885), 
LRes8901 = reshape_layer(Res38885, [2, 1, 1], Res8901), 
LRes64574 = reshape_layer(Res8901, [2, 1, 1, 1], Res64574), 
LUp_44327 = up_sampling3D_layer(Res64574, 1, 1, 1, Up_44327), 
LCon91991 = conv3D_layer(Up_44327, 2, 1, 1,[[[[[0.1723, 0.901, 0.0226]]]], [[[[0.3862, 0.2129, 0.0257]]]]],[0, 0, 0], 7, 1, 1, false, 1, 1, 1, Con91991), 
LRes61961 = reshape_layer(Con91991, [1, 1, 3], Res61961), 
LZer19196 = zero_padding2D_layer(Res61961, 1, 0, 0, 0, Zer19196), 
LCon85657 = concatenate_layer([Zer19196,[[[[0.0002]], [[0.4033]]]]], 3, Con85657), 
LLoc52150 = locally_connected1D_layer([[[0.0697]]], 1,[[[0.8414, 0.2318, 0.145]]],[[0, 0, 0]], 1, Loc52150), 
LAve99530 = average_pooling1D_layer(Loc52150, 1, Ave99530), 
LRes78541 = reshape_layer(Ave99530, [1, 3, 1], Res78541), 
LMax36048 = max_pool2D_layer(Res78541, 1, 3, 12, 1, true, Max36048), 
LUp_9224 = up_sampling2D_layer(Max36048, 1, 2, Up_9224), 
LRes35553 = reshape_layer(Up_9224, [1, 6], Res35553), 
LFla8892 = flatten_layer(Res35553, Fla8892), 
LRes4423 = reshape_layer(Fla8892, [6, 1], Res4423), 
LRes14406 = reshape_layer(Res4423, [6, 1, 1], Res14406), 
LSep81562 = separable_conv2D_layer(Res14406, 5, 1,[[[[[0.1532]]], [[[0.2727]]], [[[0.9246]]], [[[0.9464]]], [[[0.9351]]]],[[[[0.732, 0.0617, 0.93, 0.4727]]]]],[0, 0, 0, 0], 4, 4, true, Sep81562), 
LMul89928 = multiply_layer([Con85657,Sep81562], Mul89928), 
exec_layers([LMax39436,LRes58846,LRes9836,LFla23781,LGlo66834,LCon35524,LMax10432,LRes38885,LRes8901,LRes64574,LUp_44327,LCon91991,LRes61961,LZer19196,LCon85657,LLoc52150,LAve99530,LRes78541,LMax36048,LUp_9224,LRes35553,LFla8892,LRes4423,LRes14406,LSep81562,LMul89928],["Max39436","Res58846","Res9836","Fla23781","Glo66834","Con35524","Max10432","Res38885","Res8901","Res64574","Up_44327","Con91991","Res61961","Zer19196","Con85657","Loc52150","Ave99530","Res78541","Max36048","Up_9224","Res35553","Fla8892","Res4423","Res14406","Sep81562","Mul89928"],Mul89928,"Mul89928")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000, 0.0000171]], [[0.0103511, 0.0024528, 0.0012857, 0.0054006]]]]

Expected (Unparsed): [[[[0.0,0.0,0.0,1.706995442649616e-5]],[[0.010351095077141157,0.0024527569647903916,0.0012856964240367799,0.005400567933828043]]]]

Actual:   [[[[0, 0, 0, 0.0001]], [[0.0104, 0.0025, 0.0013, 0.0055]]]]

Expected: [[[[0, 0, 0, 0.0001]], [[0.0104, 0.0025, 0.0013, 0.0055]]]]