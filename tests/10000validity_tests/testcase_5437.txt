import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max81560 = tf.keras.layers.Input(shape=([1, 1]))
in1Max81560 = tf.keras.layers.Input(shape=([1, 1]))
in0Con70898 = tf.keras.layers.Input(shape=([6, 7]))
in0Con68935 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Max88529 = tf.keras.layers.Input(shape=([2, 2]))
in1Max88529 = tf.keras.layers.Input(shape=([2, 2]))
in0Con67153 = tf.keras.layers.Input(shape=([4, 6]))

Max81560 = keras.layers.Maximum(name = 'Max81560', )([in0Max81560,in1Max81560])
Zer8451 = keras.layers.ZeroPadding1D(padding=((5, 0)), name = 'Zer8451', )(Max81560)
Con70898 = keras.layers.Concatenate(axis=2, name = 'Con70898', )([Zer8451,in0Con70898])
Con68935 = keras.layers.Conv3DTranspose(4, (1, 1, 1),strides=(4, 2, 1), padding='valid', name = 'Con68935', )(in0Con68935)
Res85400 = keras.layers.Reshape((4, 2, 4), name = 'Res85400', )(Con68935)
Res4732 = keras.layers.Reshape((4, 8), name = 'Res4732', )(Res85400)
Max88529 = keras.layers.Maximum(name = 'Max88529', )([in0Max88529,in1Max88529])
Zer53650 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer53650', )(Max88529)
Con67153 = keras.layers.Concatenate(axis=2, name = 'Con67153', )([Zer53650,in0Con67153])
Max6908 = keras.layers.Maximum(name = 'Max6908', )([Res4732,Con67153])
Zer19779 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer19779', )(Max6908)
Max76910 = keras.layers.Maximum(name = 'Max76910', )([Con70898,Zer19779])
model = tf.keras.models.Model(inputs=[in0Max81560,in1Max81560,in0Con70898,in0Con68935,in0Max88529,in1Max88529,in0Con67153], outputs=Max76910)
w = model.get_layer('Con68935').get_weights() 
w[0] = np.array([[[[[0.8191, 0.2224], [0.2126, 0.1308], [0.3088, 0.1198], [0.9519, 0.8774]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con68935').set_weights(w) 
in0Max81560 = tf.constant([[[0.849]]])
in1Max81560 = tf.constant([[[0.0604]]])
in0Con70898 = tf.constant([[[0.1715, 0.1316, 0.2652, 0.1293, 0.6039, 0.3697, 0.0205], [0.8972, 0.6554, 0.2694, 0.3465, 0.9655, 0.8552, 0.2016], [0.0328, 0.7019, 0.65, 0.8819, 0.4184, 0.8565, 0.7494], [0.9482, 0.0464, 0.8107, 0.1153, 0.6804, 0.4169, 0.5384], [0.9504, 0.4126, 0.1501, 0.6193, 0.1484, 0.274, 0.4959], [0.8722, 0.0617, 0.5131, 0.534, 0.4323, 0.1143, 0.8109]]])
in0Con68935 = tf.constant([[[[[0.0289, 0.557]]]]])
in0Max88529 = tf.constant([[[0.1542, 0.5051], [0.7364, 0.6292]]])
in1Max88529 = tf.constant([[[0.4682, 0.6406], [0.5396, 0.8925]]])
in0Con67153 = tf.constant([[[0.6979, 0.747, 0.5279, 0.3803, 0.2377, 0.3355], [0.0974, 0.3074, 0.317, 0.5485, 0.1991, 0.5932], [0.8272, 0.8198, 0.9361, 0.519, 0.7761, 0.9344], [0.9372, 0.1973, 0.9885, 0.7884, 0.1489, 0.7768]]])
print (np.array2string(model.predict([in0Max81560,in1Max81560,in0Con70898,in0Con68935,in0Max88529,in1Max88529,in0Con67153],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max76910.png')

LMax81560 = maximum_layer([[[[0.849]]], [[[0.0604]]]], Max81560), 
LZer8451 = zero_padding1D_layer(Max81560, 5, 0, Zer8451), 
LCon70898 = concatenate_layer([Zer8451,[[[0.1715, 0.1316, 0.2652, 0.1293, 0.6039, 0.3697, 0.0205], [0.8972, 0.6554, 0.2694, 0.3465, 0.9655, 0.8552, 0.2016], [0.0328, 0.7019, 0.65, 0.8819, 0.4184, 0.8565, 0.7494], [0.9482, 0.0464, 0.8107, 0.1153, 0.6804, 0.4169, 0.5384], [0.9504, 0.4126, 0.1501, 0.6193, 0.1484, 0.274, 0.4959], [0.8722, 0.0617, 0.5131, 0.534, 0.4323, 0.1143, 0.8109]]]], 2, Con70898), 
LCon68935 = conv3D_transpose_layer([[[[[0.0289, 0.557]]]]], 1, 1, 1,[[[[[0.8191, 0.2224], [0.2126, 0.1308], [0.3088, 0.1198], [0.9519, 0.8774]]]]],[0, 0, 0, 0], 4, 2, 1, false, Con68935), 
LRes85400 = reshape_layer(Con68935, [4, 2, 4], Res85400), 
LRes4732 = reshape_layer(Res85400, [4, 8], Res4732), 
LMax88529 = maximum_layer([[[[0.1542, 0.5051], [0.7364, 0.6292]]], [[[0.4682, 0.6406], [0.5396, 0.8925]]]], Max88529), 
LZer53650 = zero_padding1D_layer(Max88529, 2, 0, Zer53650), 
LCon67153 = concatenate_layer([Zer53650,[[[0.6979, 0.747, 0.5279, 0.3803, 0.2377, 0.3355], [0.0974, 0.3074, 0.317, 0.5485, 0.1991, 0.5932], [0.8272, 0.8198, 0.9361, 0.519, 0.7761, 0.9344], [0.9372, 0.1973, 0.9885, 0.7884, 0.1489, 0.7768]]]], 2, Con67153), 
LMax6908 = maximum_layer([Res4732,Con67153], Max6908), 
LZer19779 = zero_padding1D_layer(Max6908, 1, 1, Zer19779), 
LMax76910 = maximum_layer([Con70898,Zer19779], Max76910), 
exec_layers([LMax81560,LZer8451,LCon70898,LCon68935,LRes85400,LRes4732,LMax88529,LZer53650,LCon67153,LMax6908,LZer19779,LMax76910],["Max81560","Zer8451","Con70898","Con68935","Res85400","Res4732","Max88529","Zer53650","Con67153","Max6908","Zer19779","Max76910"],Max76910,"Max76910")

Actual (Unparsed): [[[0.0000000, 0.1715000, 0.1316000, 0.2652000, 0.1293000, 0.6039000, 0.3697000, 0.0205000], [0.1475488, 0.8972000, 0.6979000, 0.7470000, 0.5279000, 0.9655000, 0.8552000, 0.3355000], [0.0000000, 0.0328000, 0.7019000, 0.6500000, 0.8819000, 0.5485000, 0.8565000, 0.7494000], [0.4682000, 0.9482000, 0.8272000, 0.8198000, 0.9361000, 0.6804000, 0.7761000, 0.9344000], [0.7364000, 0.9504000, 0.9372000, 0.1973000, 0.9885000, 0.7884000, 0.2740000, 0.7768000], [0.8490000, 0.8722000, 0.0617000, 0.5131000, 0.5340000, 0.4323000, 0.1143000, 0.8109000]]]

Expected (Unparsed): [[[0,0.1715,0.1316,0.2652,0.1293,0.6039,0.3697,0.0205],[0.14754879,0.8972,0.6979,0.747,0.5279,0.9655,0.8552,0.3355],[0,0.0328,0.7019,0.65,0.8819,0.5485,0.8565,0.7494],[0.4682,0.9482,0.8272,0.8198,0.9361,0.6804,0.7761,0.9344],[0.7364,0.9504,0.9372,0.1973,0.9885,0.7884,0.274,0.7768],[0.849,0.8722,0.0617,0.5131,0.534,0.4323,0.1143,0.8109]]]

Actual:   [[[0, 0.1715, 0.1316, 0.2652, 0.1293, 0.6039, 0.3697, 0.0205], [0.1476, 0.8972, 0.6979, 0.747, 0.5279, 0.9655, 0.8552, 0.3355], [0, 0.0328, 0.7019, 0.65, 0.8819, 0.5485, 0.8565, 0.7494], [0.4682, 0.9482, 0.8272, 0.8198, 0.9361, 0.6804, 0.7761, 0.9344], [0.7364, 0.9504, 0.9372, 0.1973, 0.9885, 0.7884, 0.274, 0.7768], [0.849, 0.8722, 0.0617, 0.5131, 0.534, 0.4323, 0.1143, 0.8109]]]

Expected: [[[0, 0.1715, 0.1316, 0.2652, 0.1293, 0.6039, 0.3697, 0.0205], [0.1476, 0.8972, 0.6979, 0.747, 0.5279, 0.9655, 0.8552, 0.3355], [0, 0.0328, 0.7019, 0.65, 0.8819, 0.5485, 0.8565, 0.7494], [0.4682, 0.9482, 0.8272, 0.8198, 0.9361, 0.6804, 0.7761, 0.9344], [0.7364, 0.9504, 0.9372, 0.1973, 0.9885, 0.7884, 0.274, 0.7768], [0.849, 0.8722, 0.0617, 0.5131, 0.534, 0.4323, 0.1143, 0.8109]]]