import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla29774 = tf.keras.layers.Input(shape=([3, 1]))
in0Add85711 = tf.keras.layers.Input(shape=([2, 1]))
in1Add85711 = tf.keras.layers.Input(shape=([2, 1]))
in0Min99524 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Min99524 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Fla29774 = keras.layers.Flatten(name = 'Fla29774', )(in0Fla29774)
Res86321 = keras.layers.Reshape((3, 1), name = 'Res86321', )(Fla29774)
Res12463 = keras.layers.Reshape((3, 1, 1), name = 'Res12463', )(Res86321)
Res88608 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res88608', )(Res12463)
Glo71058 = keras.layers.GlobalAveragePooling3D(name = 'Glo71058', )(Res88608)
Res44590 = keras.layers.Reshape((1, 1), name = 'Res44590', )(Glo71058)
Zer58364 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer58364', )(Res44590)
Add85711 = keras.layers.Add(name = 'Add85711', )([in0Add85711,in1Add85711])
Ave78192 = keras.layers.Average(name = 'Ave78192', )([Zer58364,Add85711])
Fla96370 = keras.layers.Flatten(name = 'Fla96370', )(Ave78192)
Min99524 = keras.layers.Minimum(name = 'Min99524', )([in0Min99524,in1Min99524])
Res96175 = keras.layers.Reshape((1, 1, 2), name = 'Res96175', )(Min99524)
Res32524 = keras.layers.Reshape((1, 2), name = 'Res32524', )(Res96175)
LST43657 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST43657', )(Res32524)
Min66257 = keras.layers.Minimum(name = 'Min66257', )([Fla96370,LST43657])
model = tf.keras.models.Model(inputs=[in0Fla29774,in0Add85711,in1Add85711,in0Min99524,in1Min99524], outputs=Min66257)
w = model.get_layer('LST43657').get_weights() 
w[0] = np.array([[5, 6, 7, 5, 10, 8, 7, 9], [8, 5, 8, 1, 3, 9, 4, 3]])
w[1] = np.array([[1, 4, 5, 5, 7, 8, 10, 7], [5, 6, 9, 1, 4, 4, 5, 7]])
w[2] = np.array([9, 10, 9, 10, 9, 2, 1, 1])
model.get_layer('LST43657').set_weights(w) 
in0Fla29774 = tf.constant([[[1.512], [1.5389], [1.0778]]])
in0Add85711 = tf.constant([[[0.0409], [0.3895]]])
in1Add85711 = tf.constant([[[0.3977], [0.2444]]])
in0Min99524 = tf.constant([[[[[0.4106, 0.5186]]]]])
in1Min99524 = tf.constant([[[[[0.0869, 0.5302]]]]])
print (np.array2string(model.predict([in0Fla29774,in0Add85711,in1Add85711,in0Min99524,in1Min99524],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min66257.png')

LFla29774 = flatten_layer([[[1.512], [1.5389], [1.0778]]], Fla29774), 
LRes86321 = reshape_layer(Fla29774, [3, 1], Res86321), 
LRes12463 = reshape_layer(Res86321, [3, 1, 1], Res12463), 
LRes88608 = reshape_layer(Res12463, [3, 1, 1, 1], Res88608), 
LGlo71058 = global_average_pooling3D_layer(Res88608, Glo71058), 
LRes44590 = reshape_layer(Glo71058, [1, 1], Res44590), 
LZer58364 = zero_padding1D_layer(Res44590, 1, 0, Zer58364), 
LAdd85711 = add_layer([[[[0.0409], [0.3895]]], [[[0.3977], [0.2444]]]], Add85711), 
LAve78192 = average_layer([Zer58364,Add85711], Ave78192), 
LFla96370 = flatten_layer(Ave78192, Fla96370), 
LMin99524 = minimum_layer([[[[[[0.4106, 0.5186]]]]], [[[[[0.0869, 0.5302]]]]]], Min99524), 
LRes96175 = reshape_layer(Min99524, [1, 1, 2], Res96175), 
LRes32524 = reshape_layer(Res96175, [1, 2], Res32524), 
LLST43657 = lstm_layer(Res32524,[[5, 6, 7, 5, 10, 8, 7, 9], [8, 5, 8, 1, 3, 9, 4, 3]],[[1, 4, 5, 5, 7, 8, 10, 7], [5, 6, 9, 1, 4, 4, 5, 7]],[9, 10, 9, 10, 9, 2, 1, 1], LST43657), 
LMin66257 = minimum_layer([Fla96370,LST43657], Min66257), 
exec_layers([LFla29774,LRes86321,LRes12463,LRes88608,LGlo71058,LRes44590,LZer58364,LAdd85711,LAve78192,LFla96370,LMin99524,LRes96175,LRes32524,LLST43657,LMin66257],["Fla29774","Res86321","Res12463","Res88608","Glo71058","Res44590","Zer58364","Add85711","Ave78192","Fla96370","Min99524","Res96175","Res32524","LST43657","Min66257"],Min66257,"Min66257")

Actual (Unparsed): [[0.2193000, 0.7354752]]

Expected (Unparsed): [[0.2193,0.7354751784671354]]

Actual:   [[0.2193, 0.7355]]

Expected: [[0.2193, 0.7355]]