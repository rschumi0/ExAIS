import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot41191 = tf.keras.layers.Input(shape=([2]))
in1Dot41191 = tf.keras.layers.Input(shape=([2]))
in0Con7051 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Con31643 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con15838 = tf.keras.layers.Input(shape=([3, 1]))
in0Dot27359 = tf.keras.layers.Input(shape=([2]))
in1Dot27359 = tf.keras.layers.Input(shape=([2]))
in0Con94562 = tf.keras.layers.Input(shape=([3, 2]))
in0Add13058 = tf.keras.layers.Input(shape=([1, 2]))
in1Add13058 = tf.keras.layers.Input(shape=([1, 2]))
in0Con89455 = tf.keras.layers.Input(shape=([3, 1]))
in0Sub68207 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub68207 = tf.keras.layers.Input(shape=([3, 3]))

Dot41191 = keras.layers.Dot(axes=(1, 1), name = 'Dot41191', )([in0Dot41191,in1Dot41191])
Res29596 = keras.layers.Reshape((1, 1), name = 'Res29596', )(Dot41191)
Res34305 = keras.layers.Reshape((1, 1, 1), name = 'Res34305', )(Res29596)
Con7051 = keras.layers.Concatenate(axis=3, name = 'Con7051', )([Res34305,in0Con7051])
Con31643 = keras.layers.Conv2D(2, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con31643', )(in0Con31643)
Sub37688 = keras.layers.Subtract(name = 'Sub37688', )([Con7051,Con31643])
Res71372 = keras.layers.Reshape((1, 2), name = 'Res71372', )(Sub37688)
Zer16723 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer16723', )(Res71372)
Con15838 = keras.layers.Concatenate(axis=2, name = 'Con15838', )([Zer16723,in0Con15838])
Dot27359 = keras.layers.Dot(axes=(1, 1), name = 'Dot27359', )([in0Dot27359,in1Dot27359])
Res43319 = keras.layers.Reshape((1, 1), name = 'Res43319', )(Dot27359)
Zer99877 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer99877', )(Res43319)
Con94562 = keras.layers.Concatenate(axis=2, name = 'Con94562', )([Zer99877,in0Con94562])
Add13058 = keras.layers.Add(name = 'Add13058', )([in0Add13058,in1Add13058])
Zer29432 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer29432', )(Add13058)
Con89455 = keras.layers.Concatenate(axis=2, name = 'Con89455', )([Zer29432,in0Con89455])
Sub68207 = keras.layers.Subtract(name = 'Sub68207', )([in0Sub68207,in1Sub68207])
Ave11260 = keras.layers.Average(name = 'Ave11260', )([Con89455,Sub68207])
Sub3854 = keras.layers.Subtract(name = 'Sub3854', )([Con94562,Ave11260])
Add21148 = keras.layers.Add(name = 'Add21148', )([Con15838,Sub3854])
model = tf.keras.models.Model(inputs=[in0Dot41191,in1Dot41191,in0Con7051,in0Con31643,in0Con15838,in0Dot27359,in1Dot27359,in0Con94562,in0Add13058,in1Add13058,in0Con89455,in0Sub68207,in1Sub68207], outputs=Add21148)
w = model.get_layer('Con31643').get_weights() 
w[0] = np.array([[[[0.9744, 0.5201], [0.8146, 0.5441]]]])
w[1] = np.array([0, 0])
model.get_layer('Con31643').set_weights(w) 
in0Dot41191 = tf.constant([[0.7123, 0.2118]])
in1Dot41191 = tf.constant([[0.9938, 0.3701]])
in0Con7051 = tf.constant([[[[0.7218]]]])
in0Con31643 = tf.constant([[[[0.7942, 0.585]]]])
in0Con15838 = tf.constant([[[0.6428], [0.3613], [0.7173]]])
in0Dot27359 = tf.constant([[0.1556, 0.9343]])
in1Dot27359 = tf.constant([[0.3999, 0.6335]])
in0Con94562 = tf.constant([[[0.1928, 0.3586], [0.4625, 0.873], [0.9148, 0.4929]]])
in0Add13058 = tf.constant([[[0.0799, 0.8381]]])
in1Add13058 = tf.constant([[[0.0379, 0.0321]]])
in0Con89455 = tf.constant([[[0.9467], [0.9763], [0.9911]]])
in0Sub68207 = tf.constant([[[0.0585, 0.0826, 0.9891], [0.3369, 0.2516, 0.0022], [0.7767, 0.9372, 0.0974]]])
in1Sub68207 = tf.constant([[[0.0801, 0.5722, 0.28], [0.0438, 0.7555, 0.1341], [0.7944, 0.4409, 0.3786]]])
print (np.array2string(model.predict([in0Dot41191,in1Dot41191,in0Con7051,in0Con31643,in0Con15838,in0Dot27359,in1Dot27359,in0Con94562,in0Add13058,in1Add13058,in0Con89455,in0Sub68207,in1Sub68207],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add21148.png')

LDot41191 = dot_layer([[0.7123, 0.2118]], [[0.9938, 0.3701]], 1, 1, Dot41191), 
LRes29596 = reshape_layer(Dot41191, [1, 1], Res29596), 
LRes34305 = reshape_layer(Res29596, [1, 1, 1], Res34305), 
LCon7051 = concatenate_layer([Res34305,[[[[0.7218]]]]], 3, Con7051), 
LCon31643 = conv2D_layer([[[[0.7942, 0.585]]]], 1, 1,[[[[0.9744, 0.5201], [0.8146, 0.5441]]]],[0, 0], 1, 1, true, 1, 1, Con31643), 
LSub37688 = subtract_layer(Con7051,Con31643, Sub37688), 
LRes71372 = reshape_layer(Sub37688, [1, 2], Res71372), 
LZer16723 = zero_padding1D_layer(Res71372, 2, 0, Zer16723), 
LCon15838 = concatenate_layer([Zer16723,[[[0.6428], [0.3613], [0.7173]]]], 2, Con15838), 
LDot27359 = dot_layer([[0.1556, 0.9343]], [[0.3999, 0.6335]], 1, 1, Dot27359), 
LRes43319 = reshape_layer(Dot27359, [1, 1], Res43319), 
LZer99877 = zero_padding1D_layer(Res43319, 2, 0, Zer99877), 
LCon94562 = concatenate_layer([Zer99877,[[[0.1928, 0.3586], [0.4625, 0.873], [0.9148, 0.4929]]]], 2, Con94562), 
LAdd13058 = add_layer([[[[0.0799, 0.8381]]], [[[0.0379, 0.0321]]]], Add13058), 
LZer29432 = zero_padding1D_layer(Add13058, 2, 0, Zer29432), 
LCon89455 = concatenate_layer([Zer29432,[[[0.9467], [0.9763], [0.9911]]]], 2, Con89455), 
LSub68207 = subtract_layer([[[0.0585, 0.0826, 0.9891], [0.3369, 0.2516, 0.0022], [0.7767, 0.9372, 0.0974]]], [[[0.0801, 0.5722, 0.28], [0.0438, 0.7555, 0.1341], [0.7944, 0.4409, 0.3786]]], Sub68207), 
LAve11260 = average_layer([Con89455,Sub68207], Ave11260), 
LSub3854 = subtract_layer(Con94562,Ave11260, Sub3854), 
LAdd21148 = add_layer([Con15838,Sub3854], Add21148), 
exec_layers([LDot41191,LRes29596,LRes34305,LCon7051,LCon31643,LSub37688,LRes71372,LZer16723,LCon15838,LDot27359,LRes43319,LZer99877,LCon94562,LAdd13058,LZer29432,LCon89455,LSub68207,LAve11260,LSub3854,LAdd21148],["Dot41191","Res29596","Res34305","Con7051","Con31643","Sub37688","Res71372","Zer16723","Con15838","Dot27359","Res43319","Zer99877","Con94562","Add13058","Zer29432","Con89455","Sub68207","Ave11260","Sub3854","Add21148"],Add21148,"Add21148")

Actual (Unparsed): [[[0.0108000, 0.4376000, 0.1735000], [-0.1465500, 0.7144500, 0.8121000], [0.1399149, 0.2219881, 0.8552500]]]

Expected (Unparsed): [[[0.0108,0.4376,0.17350000000000004],[-0.14654999999999999,0.71445,0.8121],[0.1399149300000001,0.22198807999999992,0.8552500000000001]]]

Actual:   [[[0.0108, 0.4376, 0.1735], [-0.1465, 0.7145, 0.8121], [0.14, 0.222, 0.8553]]]

Expected: [[[0.0108, 0.4376, 0.1736], [-0.1465, 0.7145, 0.8121], [0.14, 0.222, 0.8553]]]