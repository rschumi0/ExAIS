import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot96355 = tf.keras.layers.Input(shape=([2]))
in1Dot96355 = tf.keras.layers.Input(shape=([2]))
in0Ave45267 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Ave45267 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Ave72721 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave72721 = tf.keras.layers.Input(shape=([1, 2]))
in0Con1952 = tf.keras.layers.Input(shape=([1, 2]))
in0Mul18798 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul18798 = tf.keras.layers.Input(shape=([2, 2]))
in0Con85790 = tf.keras.layers.Input(shape=([1]))

Dot96355 = keras.layers.Dot(axes=(1, 1), name = 'Dot96355', )([in0Dot96355,in1Dot96355])
Res22453 = keras.layers.Reshape((1, 1), name = 'Res22453', )(Dot96355)
Res52064 = keras.layers.Reshape((1, 1, 1), name = 'Res52064', )(Res22453)
Res26812 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res26812', )(Res52064)
Zer1350 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer1350', )(Res26812)
Ave45267 = keras.layers.Average(name = 'Ave45267', )([in0Ave45267,in1Ave45267])
Res20477 = keras.layers.Reshape((1, 1, 4), name = 'Res20477', )(Ave45267)
Dep2145 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep2145', )(Res20477)
Res13685 = keras.layers.Reshape((1, 4), name = 'Res13685', )(Dep2145)
Ave72721 = keras.layers.Average(name = 'Ave72721', )([in0Ave72721,in1Ave72721])
Con1952 = keras.layers.Concatenate(axis=2, name = 'Con1952', )([Ave72721,in0Con1952])
Ave66717 = keras.layers.Average(name = 'Ave66717', )([Res13685,Con1952])
Res85397 = keras.layers.Reshape((1, 4, 1), name = 'Res85397', )(Ave66717)
Res98805 = keras.layers.Reshape((1, 4, 1, 1), name = 'Res98805', )(Res85397)
Cro98488 = keras.layers.Cropping3D(cropping=((0, 0), (1, 1), (0, 0)), name = 'Cro98488', )(Res98805)
Add29458 = keras.layers.Add(name = 'Add29458', )([Zer1350,Cro98488])
Res27193 = keras.layers.Reshape((1, 2, 1), name = 'Res27193', )(Add29458)
Res41721 = keras.layers.Reshape((1, 2), name = 'Res41721', )(Res27193)
Fla3529 = keras.layers.Flatten(name = 'Fla3529', )(Res41721)
Mul18798 = keras.layers.Multiply(name = 'Mul18798', )([in0Mul18798,in1Mul18798])
Res20275 = keras.layers.Reshape((2, 2, 1), name = 'Res20275', )(Mul18798)
Res15766 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res15766', )(Res20275)
Cro55909 = keras.layers.Cropping3D(cropping=((1, 0), (0, 1), (0, 0)), name = 'Cro55909', )(Res15766)
Fla39952 = keras.layers.Flatten(name = 'Fla39952', )(Cro55909)
Con85790 = keras.layers.Concatenate(axis=1, name = 'Con85790', )([Fla39952,in0Con85790])
Add20277 = keras.layers.Add(name = 'Add20277', )([Fla3529,Con85790])
model = tf.keras.models.Model(inputs=[in0Dot96355,in1Dot96355,in0Ave45267,in1Ave45267,in0Ave72721,in1Ave72721,in0Con1952,in0Mul18798,in1Mul18798,in0Con85790], outputs=Add20277)
w = model.get_layer('Dep2145').get_weights() 
w[0] = np.array([[[[0.1184], [0.763], [0.2281], [0.5944]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Dep2145').set_weights(w) 
in0Dot96355 = tf.constant([[0.585, 0.7836]])
in1Dot96355 = tf.constant([[0.9071, 0.0602]])
in0Ave45267 = tf.constant([[[[[0.986, 0.6543], [0.0149, 0.3531]]]]])
in1Ave45267 = tf.constant([[[[[0.8956, 0.1158], [0.702, 0.2906]]]]])
in0Ave72721 = tf.constant([[[0.1527, 0.5172]]])
in1Ave72721 = tf.constant([[[0.9232, 0.1267]]])
in0Con1952 = tf.constant([[[0.2908, 0.6898]]])
in0Mul18798 = tf.constant([[[0.1096, 0.8882], [0.0609, 0.2381]]])
in1Mul18798 = tf.constant([[[0.9928, 0.9217], [0.681, 0.4767]]])
in0Con85790 = tf.constant([[0.2811]])
print (np.array2string(model.predict([in0Dot96355,in1Dot96355,in0Ave45267,in1Ave45267,in0Ave72721,in1Ave72721,in0Con1952,in0Mul18798,in1Mul18798,in0Con85790],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add20277.png')

LDot96355 = dot_layer([[0.585, 0.7836]], [[0.9071, 0.0602]], 1, 1, Dot96355), 
LRes22453 = reshape_layer(Dot96355, [1, 1], Res22453), 
LRes52064 = reshape_layer(Res22453, [1, 1, 1], Res52064), 
LRes26812 = reshape_layer(Res52064, [1, 1, 1, 1], Res26812), 
LZer1350 = zero_padding3D_layer(Res26812, 0, 0, 1, 0, 0, 0, Zer1350), 
LAve45267 = average_layer([[[[[[0.986, 0.6543], [0.0149, 0.3531]]]]], [[[[[0.8956, 0.1158], [0.702, 0.2906]]]]]], Ave45267), 
LRes20477 = reshape_layer(Ave45267, [1, 1, 4], Res20477), 
LDep2145 = depthwise_conv2D_layer(Res20477, 1, 1,[[[[0.1184], [0.763], [0.2281], [0.5944]]]],[0, 0, 0, 0], 1, 1, true, Dep2145), 
LRes13685 = reshape_layer(Dep2145, [1, 4], Res13685), 
LAve72721 = average_layer([[[[0.1527, 0.5172]]], [[[0.9232, 0.1267]]]], Ave72721), 
LCon1952 = concatenate_layer([Ave72721,[[[0.2908, 0.6898]]]], 2, Con1952), 
LAve66717 = average_layer([Res13685,Con1952], Ave66717), 
LRes85397 = reshape_layer(Ave66717, [1, 4, 1], Res85397), 
LRes98805 = reshape_layer(Res85397, [1, 4, 1, 1], Res98805), 
LCro98488 = cropping3D_layer(Res98805, 0, 0, 1, 1, 0, 0, Cro98488), 
LAdd29458 = add_layer([Zer1350,Cro98488], Add29458), 
LRes27193 = reshape_layer(Add29458, [1, 2, 1], Res27193), 
LRes41721 = reshape_layer(Res27193, [1, 2], Res41721), 
LFla3529 = flatten_layer(Res41721, Fla3529), 
LMul18798 = multiply_layer([[[[0.1096, 0.8882], [0.0609, 0.2381]]], [[[0.9928, 0.9217], [0.681, 0.4767]]]], Mul18798), 
LRes20275 = reshape_layer(Mul18798, [2, 2, 1], Res20275), 
LRes15766 = reshape_layer(Res20275, [2, 2, 1, 1], Res15766), 
LCro55909 = cropping3D_layer(Res15766, 1, 0, 0, 1, 0, 0, Cro55909), 
LFla39952 = flatten_layer(Cro55909, Fla39952), 
LCon85790 = concatenate_layer([Fla39952,[[0.2811]]], 1, Con85790), 
LAdd20277 = add_layer([Fla3529,Con85790], Add20277), 
exec_layers([LDot96355,LRes22453,LRes52064,LRes26812,LZer1350,LAve45267,LRes20477,LDep2145,LRes13685,LAve72721,LCon1952,LAve66717,LRes85397,LRes98805,LCro98488,LAdd29458,LRes27193,LRes41721,LFla3529,LMul18798,LRes20275,LRes15766,LCro55909,LFla39952,LCon85790,LAdd20277],["Dot96355","Res22453","Res52064","Res26812","Zer1350","Ave45267","Res20477","Dep2145","Res13685","Ave72721","Con1952","Ave66717","Res85397","Res98805","Cro98488","Add29458","Res27193","Res41721","Fla3529","Mul18798","Res20275","Res15766","Cro55909","Fla39952","Con85790","Add20277"],Add20277,"Add20277")

Actual (Unparsed): [[0.3493445, 1.0452074]]

Expected (Unparsed): [[0.349344475,1.0452074425]]

Actual:   [[0.3494, 1.0453]]

Expected: [[0.3494, 1.0453]]