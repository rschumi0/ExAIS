import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add17859 = tf.keras.layers.Input(shape=([2, 1]))
in1Add17859 = tf.keras.layers.Input(shape=([2, 1]))
in0Min51309 = tf.keras.layers.Input(shape=([1, 1]))
in1Min51309 = tf.keras.layers.Input(shape=([1, 1]))
in0Sof79833 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Add17859 = keras.layers.Add(name = 'Add17859', )([in0Add17859,in1Add17859])
Res22189 = keras.layers.Reshape((2, 1, 1), name = 'Res22189', )(Add17859)
Dep76107 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='same', name = 'Dep76107', )(Res22189)
Res28151 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res28151', )(Dep76107)
Zer58633 = keras.layers.ZeroPadding3D(padding=((0, 0), (2, 0), (0, 0)), name = 'Zer58633', )(Res28151)
Min51309 = keras.layers.Minimum(name = 'Min51309', )([in0Min51309,in1Min51309])
Res31806 = keras.layers.Reshape((1, 1, 1), name = 'Res31806', )(Min51309)
Res24048 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res24048', )(Res31806)
Zer67 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer67', )(Res24048)
Sof79833 = keras.layers.Softmax(axis=1, name = 'Sof79833', input_shape=(1, 2, 1, 1))(in0Sof79833)
Min69722 = keras.layers.Minimum(name = 'Min69722', )([Zer67,Sof79833])
Zer48385 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer48385', )(Min69722)
Max31386 = keras.layers.Maximum(name = 'Max31386', )([Zer58633,Zer48385])
model = tf.keras.models.Model(inputs=[in0Add17859,in1Add17859,in0Min51309,in1Min51309,in0Sof79833], outputs=Max31386)
w = model.get_layer('Dep76107').get_weights() 
w[0] = np.array([[[[0.1298]]]])
w[1] = np.array([0])
model.get_layer('Dep76107').set_weights(w) 
in0Add17859 = tf.constant([[[0.7743], [0.1457]]])
in1Add17859 = tf.constant([[[0.2908], [0.2558]]])
in0Min51309 = tf.constant([[[0.3533]]])
in1Min51309 = tf.constant([[[0.9729]]])
in0Sof79833 = tf.constant([[[[[0.5841]], [[0.1974]]]]])
print (np.array2string(model.predict([in0Add17859,in1Add17859,in0Min51309,in1Min51309,in0Sof79833],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max31386.png')

LAdd17859 = add_layer([[[[0.7743], [0.1457]]], [[[0.2908], [0.2558]]]], Add17859), 
LRes22189 = reshape_layer(Add17859, [2, 1, 1], Res22189), 
LDep76107 = depthwise_conv2D_layer(Res22189, 1, 1,[[[[0.1298]]]],[0], 1, 1, true, Dep76107), 
LRes28151 = reshape_layer(Dep76107, [2, 1, 1, 1], Res28151), 
LZer58633 = zero_padding3D_layer(Res28151, 0, 0, 2, 0, 0, 0, Zer58633), 
LMin51309 = minimum_layer([[[[0.3533]]], [[[0.9729]]]], Min51309), 
LRes31806 = reshape_layer(Min51309, [1, 1, 1], Res31806), 
LRes24048 = reshape_layer(Res31806, [1, 1, 1, 1], Res24048), 
LZer67 = zero_padding3D_layer(Res24048, 0, 0, 1, 0, 0, 0, Zer67), 
LSof79833 = softmax_layer([[[[[0.5841]], [[0.1974]]]]], 1, Sof79833), 
LMin69722 = minimum_layer([Zer67,Sof79833], Min69722), 
LZer48385 = zero_padding3D_layer(Min69722, 1, 0, 1, 0, 0, 0, Zer48385), 
LMax31386 = maximum_layer([Zer58633,Zer48385], Max31386), 
exec_layers([LAdd17859,LRes22189,LDep76107,LRes28151,LZer58633,LMin51309,LRes31806,LRes24048,LZer67,LSof79833,LMin69722,LZer48385,LMax31386],["Add17859","Res22189","Dep76107","Res28151","Zer58633","Min51309","Res31806","Res24048","Zer67","Sof79833","Min69722","Zer48385","Max31386"],Max31386,"Max31386")

Actual (Unparsed): [[[[[0.0000000]], [[0.0000000]], [[0.1382500]]], [[[0.0000000]], [[0.0000000]], [[0.3533000]]]]]

Expected (Unparsed): [[[[[0]],[[0]],[[0.13824998]]],[[[0]],[[0]],[[0.3533]]]]]

Actual:   [[[[[0]], [[0]], [[0.1383]]], [[[0]], [[0]], [[0.3533]]]]]

Expected: [[[[[0]], [[0]], [[0.1383]]], [[[0]], [[0]], [[0.3533]]]]]