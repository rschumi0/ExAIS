import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per70066 = tf.keras.layers.Input(shape=([3, 2]))

Per70066 = keras.layers.Permute((1,2), name = 'Per70066',)(in0Per70066)
Den24863 = keras.layers.Dense(3,name = 'Den24863', )(Per70066)
model = tf.keras.models.Model(inputs=[in0Per70066], outputs=Den24863)
w = model.get_layer('Den24863').get_weights() 
w[0] = np.array([[0.787, 0.706, 0.3502], [0.085, 0.4617, 0.943]])
w[1] = np.array([0.9581, 0.3222, 0.2977])
model.get_layer('Den24863').set_weights(w) 
in0Per70066 = tf.constant([[[1.3053, 1.2742], [1.8079, 1.4728], [1.1869, 1.7668]]])
print (np.array2string(model.predict([in0Per70066],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Den24863.png')

LPer70066 = permute_layer([[[1.3053, 1.2742], [1.8079, 1.4728], [1.1869, 1.7668]]], 1,2, Per70066), 
LDen24863 = dense_layer(Per70066, [[0.787, 0.706, 0.3502], [0.085, 0.4617, 0.943]],[0.9581, 0.3222, 0.2977], Den24863), 
exec_layers([LPer70066,LDen24863],["Per70066","Den24863"],Den24863,"Den24863")

Actual (Unparsed): [[[2.0936781, 1.8320399, 1.9563866], [2.5061053, 2.2785691, 2.3196770], [2.0423683, 1.9758830, 2.3794448]]]

Expected (Unparsed): [[[2.0936781,1.8320399399999998,1.95638666],[2.5061053,2.27856916,2.3196769799999997],[2.0423683,1.9758829599999999,2.37944478]]]

Actual:   [[[2.0937, 1.8321, 1.9564], [2.5062, 2.2786, 2.3197], [2.0424, 1.9759, 2.3795]]]

Expected: [[[2.0937, 1.8321, 1.9564], [2.5062, 2.2786, 2.3197], [2.0424, 1.9759, 2.3795]]]