import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min18221 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min18221 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Glo57415 = tf.keras.layers.Input(shape=([2, 1]))
in0Max70148 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con75856 = tf.keras.layers.Input(shape=([1, 1, 1]))

Min18221 = keras.layers.Minimum(name = 'Min18221', )([in0Min18221,in1Min18221])
Res12427 = keras.layers.Reshape((1, 2, 2), name = 'Res12427', )(Min18221)
Glo57415 = keras.layers.GlobalAveragePooling1D(name = 'Glo57415', )(in0Glo57415)
Res63781 = keras.layers.Reshape((1, 1), name = 'Res63781', )(Glo57415)
Res81930 = keras.layers.Reshape((1, 1, 1), name = 'Res81930', )(Res63781)
Sep82901 = keras.layers.SeparableConv2D(4, (1, 1),strides=(1, 1), padding='same', name = 'Sep82901', )(Res81930)
Con39899 = keras.layers.Conv2D(2, (1, 1),strides=(6, 1), padding='valid', dilation_rate=(1, 1), name = 'Con39899', )(Sep82901)
Max70148 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(2, 1), padding='same', name = 'Max70148', )(in0Max70148)
Con75856 = keras.layers.Concatenate(axis=3, name = 'Con75856', )([Max70148,in0Con75856])
Add31408 = keras.layers.Add(name = 'Add31408', )([Con39899,Con75856])
Zer57465 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer57465', )(Add31408)
Max84197 = keras.layers.Maximum(name = 'Max84197', )([Res12427,Zer57465])
model = tf.keras.models.Model(inputs=[in0Min18221,in1Min18221,in0Glo57415,in0Max70148,in0Con75856], outputs=Max84197)
w = model.get_layer('Sep82901').get_weights() 
w[0] = np.array([[[[0.8704]]]])
w[1] = np.array([[[[0.1706, 0.6155, 0.799, 0.6142]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep82901').set_weights(w) 
w = model.get_layer('Con39899').get_weights() 
w[0] = np.array([[[[0.0107, 0.4629], [0.0774, 0.4739], [0.4504, 0.2305], [0.1596, 0.8613]]]])
w[1] = np.array([0, 0])
model.get_layer('Con39899').set_weights(w) 
in0Min18221 = tf.constant([[[[[0.4583], [0.6661]], [[0.6739], [0.8724]]]]])
in1Min18221 = tf.constant([[[[[0.1166], [0.2811]], [[0.2988], [0.8185]]]]])
in0Glo57415 = tf.constant([[[1.2329], [1.5852]]])
in0Max70148 = tf.constant([[[[1.472]], [[1.957]]]])
in0Con75856 = tf.constant([[[[0.5868]]]])
print (np.array2string(model.predict([in0Min18221,in1Min18221,in0Glo57415,in0Max70148,in0Con75856],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max84197.png')

LMin18221 = minimum_layer([[[[[[0.4583], [0.6661]], [[0.6739], [0.8724]]]]], [[[[[0.1166], [0.2811]], [[0.2988], [0.8185]]]]]], Min18221), 
LRes12427 = reshape_layer(Min18221, [1, 2, 2], Res12427), 
LGlo57415 = global_average_pooling1D_layer([[[1.2329], [1.5852]]], Glo57415), 
LRes63781 = reshape_layer(Glo57415, [1, 1], Res63781), 
LRes81930 = reshape_layer(Res63781, [1, 1, 1], Res81930), 
LSep82901 = separable_conv2D_layer(Res81930, 1, 1,[[[[[0.8704]]]],[[[[0.1706, 0.6155, 0.799, 0.6142]]]]],[0, 0, 0, 0], 1, 1, true, Sep82901), 
LCon39899 = conv2D_layer(Sep82901, 1, 1,[[[[0.0107, 0.4629], [0.0774, 0.4739], [0.4504, 0.2305], [0.1596, 0.8613]]]],[0, 0], 6, 1, false, 1, 1, Con39899), 
LMax70148 = max_pool2D_layer([[[[1.472]], [[1.957]]]], 1, 1, 2, 1, true, Max70148), 
LCon75856 = concatenate_layer([Max70148,[[[[0.5868]]]]], 3, Con75856), 
LAdd31408 = add_layer([Con39899,Con75856], Add31408), 
LZer57465 = zero_padding2D_layer(Add31408, 0, 0, 1, 0, Zer57465), 
LMax84197 = maximum_layer([Res12427,Zer57465], Max84197), 
exec_layers([LMin18221,LRes12427,LGlo57415,LRes63781,LRes81930,LSep82901,LCon39899,LMax70148,LCon75856,LAdd31408,LZer57465,LMax84197],["Min18221","Res12427","Glo57415","Res63781","Res81930","Sep82901","Con39899","Max70148","Con75856","Add31408","Zer57465","Max84197"],Max84197,"Max84197")

Actual (Unparsed): [[[[0.1166000, 0.2811000], [2.0942464, 1.9160569]]]]

Expected (Unparsed): [[[[0.1166,0.2811],[2.094246412697805,1.916056886357888]]]]

Actual:   [[[[0.1166, 0.2811], [2.0943, 1.9161]]]]

Expected: [[[[0.1166, 0.2811], [2.0943, 1.9161]]]]