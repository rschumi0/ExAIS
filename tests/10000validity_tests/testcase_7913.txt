import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max64640 = tf.keras.layers.Input(shape=([1, 1]))
in1Max64640 = tf.keras.layers.Input(shape=([1, 1]))

Max64640 = keras.layers.Maximum(name = 'Max64640', )([in0Max64640,in1Max64640])
Res21710 = keras.layers.Reshape((1, 1, 1), name = 'Res21710', )(Max64640)
Zer24601 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer24601', )(Res21710)
Dep90846 = keras.layers.DepthwiseConv2D((2, 2),strides=(1, 1), padding='same', name = 'Dep90846', )(Zer24601)
Res90002 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res90002', )(Dep90846)
Con23967 = keras.layers.Conv3D(2, (3, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con23967', )(Res90002)
model = tf.keras.models.Model(inputs=[in0Max64640,in1Max64640], outputs=Con23967)
w = model.get_layer('Dep90846').get_weights() 
w[0] = np.array([[[[0.3686]], [[0.8879]]], [[[0.4428]], [[0.2435]]]])
w[1] = np.array([0])
model.get_layer('Dep90846').set_weights(w) 
w = model.get_layer('Con23967').get_weights() 
w[0] = np.array([[[[[0.9085, 0.668]]]], [[[[0.299, 0.8141]]]], [[[[0.8101, 0.4184]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con23967').set_weights(w) 
in0Max64640 = tf.constant([[[0.7218]]])
in1Max64640 = tf.constant([[[0.5394]]])
print (np.array2string(model.predict([in0Max64640,in1Max64640],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con23967.png')

LMax64640 = maximum_layer([[[[0.7218]]], [[[0.5394]]]], Max64640), 
LRes21710 = reshape_layer(Max64640, [1, 1, 1], Res21710), 
LZer24601 = zero_padding2D_layer(Res21710, 1, 1, 1, 1, Zer24601), 
LDep90846 = depthwise_conv2D_layer(Zer24601, 2, 2,[[[[0.3686]], [[0.8879]]], [[[0.4428]], [[0.2435]]]],[0], 1, 1, true, Dep90846), 
LRes90002 = reshape_layer(Dep90846, [3, 3, 1, 1], Res90002), 
LCon23967 = conv3D_layer(Res90002, 3, 1, 1,[[[[[0.9085, 0.668]]]], [[[[0.299, 0.8141]]]], [[[[0.8101, 0.4184]]]]],[0, 0], 1, 1, 1, true, 1, 1, 1, Con23967), 
exec_layers([LMax64640,LRes21710,LZer24601,LDep90846,LRes90002,LCon23967],["Max64640","Res21710","Zer24601","Dep90846","Res90002","Con23967"],Con23967,"Con23967")

Actual (Unparsed): [[[[[0.5717337, 0.4112316]], [[0.3110959, 0.3715146]], [[0.0000000, 0.0000000]]], [[[0.3513014, 0.6391520]], [[0.3699191, 0.4300973]], [[0.0000000, 0.0000000]]], [[[0.5822452, 0.4281120]], [[0.2417114, 0.1777251]], [[0.0000000, 0.0000000]]]]]

Expected (Unparsed): [[[[[0.5717336585220001,0.41123162647800005]],[[0.311095843308,0.37151458869600007]],[[0.0,0.0]]],[[[0.35130139533000004,0.639152016102]],[[0.36991903536000004,0.43009727698800004]],[[0.0,0.0]]],[[[0.5822451308700001,0.4281119949600001]],[[0.24171140358,0.17772506064000002]],[[0.0,0.0]]]]]

Actual:   [[[[[0.5718, 0.4113]], [[0.3111, 0.3716]], [[0, 0]]], [[[0.3514, 0.6392]], [[0.37, 0.4301]], [[0, 0]]], [[[0.5823, 0.4282]], [[0.2418, 0.1778]], [[0, 0]]]]]

Expected: [[[[[0.5718, 0.4113]], [[0.3111, 0.3716]], [[0, 0]]], [[[0.3514, 0.6392]], [[0.37, 0.4301]], [[0, 0]]], [[[0.5823, 0.4282]], [[0.2418, 0.1778]], [[0, 0]]]]]