import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot78768 = tf.keras.layers.Input(shape=([2]))
in1Dot78768 = tf.keras.layers.Input(shape=([2]))
in0Con42481 = tf.keras.layers.Input(shape=([1]))
in0Con15841 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Mul93972 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Mul93972 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Dot19599 = tf.keras.layers.Input(shape=([3]))
in1Dot19599 = tf.keras.layers.Input(shape=([3]))
in0Ave97555 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave97555 = tf.keras.layers.Input(shape=([1, 1]))
in0Con38496 = tf.keras.layers.Input(shape=([2, 2]))

Dot78768 = keras.layers.Dot(axes=(1, 1), name = 'Dot78768', )([in0Dot78768,in1Dot78768])
Con42481 = keras.layers.Concatenate(axis=1, name = 'Con42481', )([Dot78768,in0Con42481])
Con15841 = keras.layers.Conv3DTranspose(2, (1, 1, 1),strides=(1, 1, 2), padding='same', name = 'Con15841', )(in0Con15841)
Glo32065 = keras.layers.GlobalAveragePooling3D(name = 'Glo32065', )(Con15841)
Sub45102 = keras.layers.Subtract(name = 'Sub45102', )([Con42481,Glo32065])
Res39282 = keras.layers.Reshape((2, 1), name = 'Res39282', )(Sub45102)
Res18350 = keras.layers.Reshape((2, 1, 1), name = 'Res18350', )(Res39282)
Res50732 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res50732', )(Res18350)
Zer6395 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer6395', )(Res50732)
Mul93972 = keras.layers.Multiply(name = 'Mul93972', )([in0Mul93972,in1Mul93972])
Zer38856 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer38856', )(Mul93972)
Mul68281 = keras.layers.Multiply(name = 'Mul68281', )([Zer6395,Zer38856])
Res70290 = keras.layers.Reshape((2, 1, 3), name = 'Res70290', )(Mul68281)
Res62607 = keras.layers.Reshape((2, 3), name = 'Res62607', )(Res70290)
Dot19599 = keras.layers.Dot(axes=(1, 1), name = 'Dot19599', )([in0Dot19599,in1Dot19599])
Res9461 = keras.layers.Reshape((1, 1), name = 'Res9461', )(Dot19599)
Ave97555 = keras.layers.Average(name = 'Ave97555', )([in0Ave97555,in1Ave97555])
Max16786 = keras.layers.Maximum(name = 'Max16786', )([Res9461,Ave97555])
Zer11536 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer11536', )(Max16786)
Con38496 = keras.layers.Concatenate(axis=2, name = 'Con38496', )([Zer11536,in0Con38496])
Max39749 = keras.layers.Maximum(name = 'Max39749', )([Res62607,Con38496])
model = tf.keras.models.Model(inputs=[in0Dot78768,in1Dot78768,in0Con42481,in0Con15841,in0Mul93972,in1Mul93972,in0Dot19599,in1Dot19599,in0Ave97555,in1Ave97555,in0Con38496], outputs=Max39749)
w = model.get_layer('Con15841').get_weights() 
w[0] = np.array([[[[[0.731, 0.6513], [0.8721, 0.0053]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con15841').set_weights(w) 
in0Dot78768 = tf.constant([[0.547, 0.4295]])
in1Dot78768 = tf.constant([[0.9098, 0.2535]])
in0Con42481 = tf.constant([[0.0143]])
in0Con15841 = tf.constant([[[[[0.1039, 0.2708], [0.0788, 0.7361]], [[0.1246, 0.1727], [0.697, 0.7483]]]]])
in0Mul93972 = tf.constant([[[[[0.2528], [0.8605]]]]])
in1Mul93972 = tf.constant([[[[[0.1119], [0.0677]]]]])
in0Dot19599 = tf.constant([[0.5295, 0.8052, 0.7326]])
in1Dot19599 = tf.constant([[0.7657, 0.023, 0.6184]])
in0Ave97555 = tf.constant([[[0.5227]]])
in1Ave97555 = tf.constant([[[0.1683]]])
in0Con38496 = tf.constant([[[0.8689, 0.7486], [0.3196, 0.0543]]])
print (np.array2string(model.predict([in0Dot78768,in1Dot78768,in0Con42481,in0Con15841,in0Mul93972,in1Mul93972,in0Dot19599,in1Dot19599,in0Ave97555,in1Ave97555,in0Con38496],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max39749.png')

LDot78768 = dot_layer([[0.547, 0.4295]], [[0.9098, 0.2535]], 1, 1, Dot78768), 
LCon42481 = concatenate_layer([Dot78768,[[0.0143]]], 1, Con42481), 
LCon15841 = conv3D_transpose_layer([[[[[0.1039, 0.2708], [0.0788, 0.7361]], [[0.1246, 0.1727], [0.697, 0.7483]]]]], 1, 1, 1,[[[[[0.731, 0.6513], [0.8721, 0.0053]]]]],[0, 0], 1, 1, 2, true, Con15841), 
LGlo32065 = global_average_pooling3D_layer(Con15841, Glo32065), 
LSub45102 = subtract_layer(Con42481,Glo32065, Sub45102), 
LRes39282 = reshape_layer(Sub45102, [2, 1], Res39282), 
LRes18350 = reshape_layer(Res39282, [2, 1, 1], Res18350), 
LRes50732 = reshape_layer(Res18350, [2, 1, 1, 1], Res50732), 
LZer6395 = zero_padding3D_layer(Res50732, 0, 0, 0, 0, 2, 0, Zer6395), 
LMul93972 = multiply_layer([[[[[[0.2528], [0.8605]]]]], [[[[[0.1119], [0.0677]]]]]], Mul93972), 
LZer38856 = zero_padding3D_layer(Mul93972, 1, 0, 0, 0, 1, 0, Zer38856), 
LMul68281 = multiply_layer([Zer6395,Zer38856], Mul68281), 
LRes70290 = reshape_layer(Mul68281, [2, 1, 3], Res70290), 
LRes62607 = reshape_layer(Res70290, [2, 3], Res62607), 
LDot19599 = dot_layer([[0.5295, 0.8052, 0.7326]], [[0.7657, 0.023, 0.6184]], 1, 1, Dot19599), 
LRes9461 = reshape_layer(Dot19599, [1, 1], Res9461), 
LAve97555 = average_layer([[[[0.5227]]], [[[0.1683]]]], Ave97555), 
LMax16786 = maximum_layer([Res9461,Ave97555], Max16786), 
LZer11536 = zero_padding1D_layer(Max16786, 1, 0, Zer11536), 
LCon38496 = concatenate_layer([Zer11536,[[[0.8689, 0.7486], [0.3196, 0.0543]]]], 2, Con38496), 
LMax39749 = maximum_layer([Res62607,Con38496], Max39749), 
exec_layers([LDot78768,LCon42481,LCon15841,LGlo32065,LSub45102,LRes39282,LRes18350,LRes50732,LZer6395,LMul93972,LZer38856,LMul68281,LRes70290,LRes62607,LDot19599,LRes9461,LAve97555,LMax16786,LZer11536,LCon38496,LMax39749],["Dot78768","Con42481","Con15841","Glo32065","Sub45102","Res39282","Res18350","Res50732","Zer6395","Mul93972","Zer38856","Mul68281","Res70290","Res62607","Dot19599","Res9461","Ave97555","Max16786","Zer11536","Con38496","Max39749"],Max39749,"Max39749")

Actual (Unparsed): [[[0.0000000, 0.8689000, 0.7486000], [0.8769976, 0.3196000, 0.0543000]]]

Expected (Unparsed): [[[0,0.8689,0.7486],[0.87699759,0.3196,0.0543]]]

Actual:   [[[0, 0.8689, 0.7486], [0.877, 0.3196, 0.0543]]]

Expected: [[[0, 0.8689, 0.7486], [0.877, 0.3196, 0.0543]]]