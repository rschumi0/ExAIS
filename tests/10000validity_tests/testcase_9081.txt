import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul34850 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul34850 = tf.keras.layers.Input(shape=([1, 2]))
in0Con95114 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Ave26323 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con47011 = tf.keras.layers.Input(shape=([1, 2]))
in0Ave41455 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave41455 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Con58007 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con13838 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min94723 = tf.keras.layers.Input(shape=([1, 2]))
in1Min94723 = tf.keras.layers.Input(shape=([1, 2]))
in0Con24354 = tf.keras.layers.Input(shape=([2, 4]))

Mul34850 = keras.layers.Multiply(name = 'Mul34850', )([in0Mul34850,in1Mul34850])
Res67987 = keras.layers.Reshape((1, 2, 1), name = 'Res67987', )(Mul34850)
Con95114 = keras.layers.Concatenate(axis=3, name = 'Con95114', )([Res67987,in0Con95114])
Ave26323 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave26323', )(in0Ave26323)
Max76809 = keras.layers.Maximum(name = 'Max76809', )([Con95114,Ave26323])
ReL94060 = keras.layers.ReLU(max_value=8.711610516955826, negative_slope=2.397659279104981, threshold=9.128321038587014, name = 'ReL94060', )(Max76809)
Res60870 = keras.layers.Reshape((1, 4), name = 'Res60870', )(ReL94060)
Con47011 = keras.layers.Concatenate(axis=2, name = 'Con47011', )([Res60870,in0Con47011])
Ave41455 = keras.layers.Average(name = 'Ave41455', )([in0Ave41455,in1Ave41455])
Res91614 = keras.layers.Reshape((1, 2, 1), name = 'Res91614', )(Ave41455)
Zer32728 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer32728', )(Res91614)
Con58007 = keras.layers.Concatenate(axis=3, name = 'Con58007', )([Zer32728,in0Con58007])
Con13838 = keras.layers.Conv2DTranspose(3, (1, 1),strides=(1, 1), padding='valid', name = 'Con13838', )(in0Con13838)
Sub37016 = keras.layers.Subtract(name = 'Sub37016', )([Con58007,Con13838])
Res58878 = keras.layers.Reshape((2, 6), name = 'Res58878', )(Sub37016)
Min94723 = keras.layers.Minimum(name = 'Min94723', )([in0Min94723,in1Min94723])
Zer7257 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer7257', )(Min94723)
Con24354 = keras.layers.Concatenate(axis=2, name = 'Con24354', )([Zer7257,in0Con24354])
Ave66745 = keras.layers.Average(name = 'Ave66745', )([Res58878,Con24354])
Cro12631 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro12631', )(Ave66745)
Max10790 = keras.layers.Maximum(name = 'Max10790', )([Con47011,Cro12631])
model = tf.keras.models.Model(inputs=[in0Mul34850,in1Mul34850,in0Con95114,in0Ave26323,in0Con47011,in0Ave41455,in1Ave41455,in0Con58007,in0Con13838,in0Min94723,in1Min94723,in0Con24354], outputs=Max10790)
w = model.get_layer('Con13838').get_weights() 
w[0] = np.array([[[[0.3842, 0.557], [0.6315, 0.1489], [0.8066, 0.5803]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con13838').set_weights(w) 
in0Mul34850 = tf.constant([[[0.9051, 0.3231]]])
in1Mul34850 = tf.constant([[[0.5379, 0.7041]]])
in0Con95114 = tf.constant([[[[0.751], [0.8986]]]])
in0Ave26323 = tf.constant([[[[1.4482, 1.046], [1.6872, 1.5877]]]])
in0Con47011 = tf.constant([[[0.2683, 0.7888]]])
in0Ave41455 = tf.constant([[[[[0.5327]], [[0.4546]]]]])
in1Ave41455 = tf.constant([[[[[0.3953]], [[0.0061]]]]])
in0Con58007 = tf.constant([[[[0.7478, 0.0128], [0.3592, 0.5586]], [[0.1737, 0.3669], [0.3801, 0.3304]]]])
in0Con13838 = tf.constant([[[[0.5313, 0.9962], [0.225, 0.8126]], [[0.3439, 0.6412], [0.5833, 0.347]]]])
in0Min94723 = tf.constant([[[0.0595, 0.7374]]])
in1Min94723 = tf.constant([[[0.9029, 0.346]]])
in0Con24354 = tf.constant([[[0.287, 0.1082, 0.5097, 0.9024], [0.8375, 0.5686, 0.6163, 0.4574]]])
print (np.array2string(model.predict([in0Mul34850,in1Mul34850,in0Con95114,in0Ave26323,in0Con47011,in0Ave41455,in1Ave41455,in0Con58007,in0Con13838,in0Min94723,in1Min94723,in0Con24354],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max10790.png')

LMul34850 = multiply_layer([[[[0.9051, 0.3231]]], [[[0.5379, 0.7041]]]], Mul34850), 
LRes67987 = reshape_layer(Mul34850, [1, 2, 1], Res67987), 
LCon95114 = concatenate_layer([Res67987,[[[[0.751], [0.8986]]]]], 3, Con95114), 
LAve26323 = average_pooling2D_layer([[[[1.4482, 1.046], [1.6872, 1.5877]]]], 1, 1, Ave26323), 
LMax76809 = maximum_layer([Con95114,Ave26323], Max76809), 
LReL94060 = relu_layer(Max76809, 8.711610516955826, 2.397659279104981, 9.128321038587014, ReL94060), 
LRes60870 = reshape_layer(ReL94060, [1, 4], Res60870), 
LCon47011 = concatenate_layer([Res60870,[[[0.2683, 0.7888]]]], 2, Con47011), 
LAve41455 = average_layer([[[[[[0.5327]], [[0.4546]]]]], [[[[[0.3953]], [[0.0061]]]]]], Ave41455), 
LRes91614 = reshape_layer(Ave41455, [1, 2, 1], Res91614), 
LZer32728 = zero_padding2D_layer(Res91614, 1, 0, 0, 0, Zer32728), 
LCon58007 = concatenate_layer([Zer32728,[[[[0.7478, 0.0128], [0.3592, 0.5586]], [[0.1737, 0.3669], [0.3801, 0.3304]]]]], 3, Con58007), 
LCon13838 = conv2D_transpose_layer([[[[0.5313, 0.9962], [0.225, 0.8126]], [[0.3439, 0.6412], [0.5833, 0.347]]]], 1, 1,[[[[0.3842, 0.557], [0.6315, 0.1489], [0.8066, 0.5803]]]],[0, 0, 0], 1, 1, false, Con13838), 
LSub37016 = subtract_layer(Con58007,Con13838, Sub37016), 
LRes58878 = reshape_layer(Sub37016, [2, 6], Res58878), 
LMin94723 = minimum_layer([[[[0.0595, 0.7374]]], [[[0.9029, 0.346]]]], Min94723), 
LZer7257 = zero_padding1D_layer(Min94723, 1, 0, Zer7257), 
LCon24354 = concatenate_layer([Zer7257,[[[0.287, 0.1082, 0.5097, 0.9024], [0.8375, 0.5686, 0.6163, 0.4574]]]], 2, Con24354), 
LAve66745 = average_layer([Res58878,Con24354], Ave66745), 
LCro12631 = cropping1D_layer(Ave66745, 1, 0, Cro12631), 
LMax10790 = maximum_layer([Con47011,Cro12631], Max10790), 
exec_layers([LMul34850,LRes67987,LCon95114,LAve26323,LMax76809,LReL94060,LRes60870,LCon47011,LAve41455,LRes91614,LZer32728,LCon58007,LCon13838,LSub37016,LRes58878,LMin94723,LZer7257,LCon24354,LAve66745,LCro12631,LMax10790],["Mul34850","Res67987","Con95114","Ave26323","Max76809","ReL94060","Res60870","Con47011","Ave41455","Res91614","Zer32728","Con58007","Con13838","Sub37016","Res58878","Min94723","Zer7257","Con24354","Ave66745","Cro12631","Max10790"],Max10790,"Max10790")

Actual (Unparsed): [[[0.0171126, 0.1035262, 0.2774609, 0.1907836, 0.2881889, 0.7888000]]]

Expected (Unparsed): [[[0.017112609999999973,0.10352623499999998,0.27746095,0.19078356999999999,0.288188875,0.7888]]]

Actual:   [[[0.0172, 0.1036, 0.2775, 0.1908, 0.2882, 0.7888]]]

Expected: [[[0.0172, 0.1036, 0.2775, 0.1908, 0.2882, 0.7888]]]