import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul54910 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Mul54910 = tf.keras.layers.Input(shape=([2, 2, 2]))

Mul54910 = keras.layers.Multiply(name = 'Mul54910', )([in0Mul54910,in1Mul54910])
Loc21761 = keras.layers.LocallyConnected2D(3, (2, 1),strides=(1, 1), name = 'Loc21761', )(Mul54910)
Lea61088 = keras.layers.LeakyReLU(alpha=4.424112473504134, name = 'Lea61088', )(Loc21761)
model = tf.keras.models.Model(inputs=[in0Mul54910,in1Mul54910], outputs=Lea61088)
w = model.get_layer('Loc21761').get_weights() 
w[0] = np.array([[[0.6653, 0.8426, 0.143], [0.3786, 0.4525, 0.7606], [0.4809, 0.0173, 0.3091], [0.6387, 0.4209, 0.9225]], [[0.2275, 0.733, 0.9801], [0.6675, 0.3047, 0.0072], [0.4486, 0.0522, 0.2661], [0.8767, 0.2002, 0.5461]]])
w[1] = np.array([[[0, 0, 0], [0, 0, 0]]])
model.get_layer('Loc21761').set_weights(w) 
in0Mul54910 = tf.constant([[[[0.6925, 0.1921], [0.6866, 0.0105]], [[0.2208, 0.9986], [0.3114, 0.5446]]]])
in1Mul54910 = tf.constant([[[[0.3463, 0.9045], [0.8077, 0.0771]], [[0.8451, 0.0165], [0.6553, 0.1592]]]])
print (np.array2string(model.predict([in0Mul54910,in1Mul54910],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lea61088.png')

LMul54910 = multiply_layer([[[[[0.6925, 0.1921], [0.6866, 0.0105]], [[0.2208, 0.9986], [0.3114, 0.5446]]]], [[[[0.3463, 0.9045], [0.8077, 0.0771]], [[0.8451, 0.0165], [0.6553, 0.1592]]]]], Mul54910), 
LLoc21761 = locally_connected2D_layer(Mul54910, 2, 1,[[[0.6653, 0.8426, 0.143], [0.3786, 0.4525, 0.7606], [0.4809, 0.0173, 0.3091], [0.6387, 0.4209, 0.9225]], [[0.2275, 0.733, 0.9801], [0.6675, 0.3047, 0.0072], [0.4486, 0.0522, 0.2661], [0.8767, 0.2002, 0.5461]]],[[[0, 0, 0], [0, 0, 0]]], 1, 1, Loc21761), 
LLea61088 = leaky_relu_layer(Loc21761, 4.424112473504134, Lea61088), 
exec_layers([LMul54910,LLoc21761,LLea61088],["Mul54910","Loc21761","Lea61088"],Lea61088,"Lea61088")

Actual (Unparsed): [[[[0.3255897, 0.2908534, 0.2393283], [0.2942560, 0.4347535, 0.6451843]]]]

Expected (Unparsed): [[[[0.32558967004699996,0.290853385769,0.239328264698],[0.29425600113100003,0.43475350693299997,0.645184291556]]]]

Actual:   [[[[0.3256, 0.2909, 0.2394], [0.2943, 0.4348, 0.6452]]]]

Expected: [[[[0.3256, 0.2909, 0.2394], [0.2943, 0.4348, 0.6452]]]]