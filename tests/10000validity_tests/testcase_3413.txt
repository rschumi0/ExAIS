import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot96606 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot96606 = tf.keras.layers.Input(shape=([3, 3]))
in0Con82867 = tf.keras.layers.Input(shape=([3, 1]))
in0Loc96868 = tf.keras.layers.Input(shape=([2, 1]))

Dot96606 = keras.layers.Dot(axes=(1, 2), name = 'Dot96606', )([in0Dot96606,in1Dot96606])
Con82867 = keras.layers.Concatenate(axis=2, name = 'Con82867', )([Dot96606,in0Con82867])
Loc96868 = keras.layers.LocallyConnected1D(4, (2),strides=(10), name = 'Loc96868', )(in0Loc96868)
Zer51718 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer51718', )(Loc96868)
Mul85841 = keras.layers.Multiply(name = 'Mul85841', )([Con82867,Zer51718])
model = tf.keras.models.Model(inputs=[in0Dot96606,in1Dot96606,in0Con82867,in0Loc96868], outputs=Mul85841)
w = model.get_layer('Loc96868').get_weights() 
w[0] = np.array([[[0.1942, 0.1132, 0.6102, 0.705], [0.1779, 0.952, 0.7733, 0.7247]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc96868').set_weights(w) 
in0Dot96606 = tf.constant([[[0.3076, 0.664, 0.6086], [0.8743, 0.655, 0.2585], [0.8297, 0.9347, 0.7401]]])
in1Dot96606 = tf.constant([[[0.3251, 0.0651, 0.6736], [0.957, 0.1923, 0.9484], [0.8699, 0.1168, 0.5642]]])
in0Con82867 = tf.constant([[[0.3678], [0.7903], [0.949]]])
in0Loc96868 = tf.constant([[[0.9029], [0.2384]]])
print (np.array2string(model.predict([in0Dot96606,in1Dot96606,in0Con82867,in0Loc96868],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul85841.png')

LDot96606 = dot_layer([[[0.3076, 0.664, 0.6086], [0.8743, 0.655, 0.2585], [0.8297, 0.9347, 0.7401]]], [[[0.3251, 0.0651, 0.6736], [0.957, 0.1923, 0.9484], [0.8699, 0.1168, 0.5642]]], 1, 2, Dot96606), 
LCon82867 = concatenate_layer([Dot96606,[[[0.3678], [0.7903], [0.949]]]], 2, Con82867), 
LLoc96868 = locally_connected1D_layer([[[0.9029], [0.2384]]], 2,[[[0.1942, 0.1132, 0.6102, 0.705], [0.1779, 0.952, 0.7733, 0.7247]]],[[0, 0, 0, 0]], 10, Loc96868), 
LZer51718 = zero_padding1D_layer(Loc96868, 2, 0, Zer51718), 
LMul85841 = multiply_layer([Con82867,Zer51718], Mul85841), 
exec_layers([LDot96606,LCon82867,LLoc96868,LZer51718,LMul85841],["Dot96606","Con82867","Loc96868","Zer51718","Mul85841"],Mul85841,"Mul85841")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.1553059, 0.4391229, 0.7185234, 0.7680380]]]

Expected (Unparsed): [[[0.0,0.0,0.0,0.0],[0.0,0.0,0.0,0.0],[0.1553059283661878,0.43912286918139715,0.718523449974948,0.7680380180199999]]]

Actual:   [[[0, 0, 0, 0], [0, 0, 0, 0], [0.1554, 0.4392, 0.7186, 0.7681]]]

Expected: [[[0, 0, 0, 0], [0, 0, 0, 0], [0.1554, 0.4392, 0.7186, 0.7681]]]