import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max24396 = tf.keras.layers.Input(shape=([2, 2]))
in1Max24396 = tf.keras.layers.Input(shape=([2, 2]))
in0Max70667 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max70667 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Add83379 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add83379 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Max19398 = tf.keras.layers.Input(shape=([1, 2]))
in1Max19398 = tf.keras.layers.Input(shape=([1, 2]))
in0Con19263 = tf.keras.layers.Input(shape=([3, 15]))

Max24396 = keras.layers.Maximum(name = 'Max24396', )([in0Max24396,in1Max24396])
Res18432 = keras.layers.Reshape((2, 2, 1), name = 'Res18432', )(Max24396)
Res81097 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res81097', )(Res18432)
Con41440 = keras.layers.Conv3DTranspose(4, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con41440', )(Res81097)
Up_31394 = keras.layers.UpSampling3D(size=(1, 1, 2), name = 'Up_31394', )(Con41440)
Res64713 = keras.layers.Reshape((2, 2, 8), name = 'Res64713', )(Up_31394)
Res46419 = keras.layers.Reshape((2, 16), name = 'Res46419', )(Res64713)
Zer56933 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer56933', )(Res46419)
Max70667 = keras.layers.Maximum(name = 'Max70667', )([in0Max70667,in1Max70667])
Res93630 = keras.layers.Reshape((2, 2), name = 'Res93630', )(Max70667)
Zer71321 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer71321', )(Res93630)
Add83379 = keras.layers.Add(name = 'Add83379', )([in0Add83379,in1Add83379])
Res1597 = keras.layers.Reshape((1, 2), name = 'Res1597', )(Add83379)
Max19398 = keras.layers.Maximum(name = 'Max19398', )([in0Max19398,in1Max19398])
Sub39591 = keras.layers.Subtract(name = 'Sub39591', )([Res1597,Max19398])
Dot53028 = keras.layers.Dot(axes=(2, 2), name = 'Dot53028', )([Zer71321,Sub39591])
Con19263 = keras.layers.Concatenate(axis=2, name = 'Con19263', )([Dot53028,in0Con19263])
Min61198 = keras.layers.Minimum(name = 'Min61198', )([Zer56933,Con19263])
model = tf.keras.models.Model(inputs=[in0Max24396,in1Max24396,in0Max70667,in1Max70667,in0Add83379,in1Add83379,in0Max19398,in1Max19398,in0Con19263], outputs=Min61198)
w = model.get_layer('Con41440').get_weights() 
w[0] = np.array([[[[[0.0718], [0.7451], [0.5429], [0.4126]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con41440').set_weights(w) 
in0Max24396 = tf.constant([[[0.797, 0.6859], [0.365, 0.91]]])
in1Max24396 = tf.constant([[[0.1775, 0.0905], [0.0298, 0.9642]]])
in0Max70667 = tf.constant([[[[0.7471, 0.2687]], [[0.0051, 0.2424]]]])
in1Max70667 = tf.constant([[[[0.4154, 0.9093]], [[0.0903, 0.7411]]]])
in0Add83379 = tf.constant([[[[0.2451], [0.3346]]]])
in1Add83379 = tf.constant([[[[0.3562], [0.3995]]]])
in0Max19398 = tf.constant([[[0.4348, 0.8394]]])
in1Max19398 = tf.constant([[[0.9101, 0.7222]]])
in0Con19263 = tf.constant([[[0.0216, 0.6692, 0.86, 0.0934, 0.9244, 0.4263, 0.4944, 0.1896, 0.9786, 0.8572, 0.701, 0.3768, 0.6737, 0.277, 0.403], [0.4321, 0.1269, 0.8837, 0.5422, 0.4866, 0.2115, 0.0363, 0.2874, 0.6717, 0.6419, 0.9859, 0.8164, 0.4387, 0.6415, 0.3709], [0.8045, 0.4814, 0.8429, 0.8462, 0.9214, 0.0207, 0.6283, 0.0647, 0.8291, 0.3223, 0.2015, 0.8549, 0.4067, 0.7086, 0.3027]]])
print (np.array2string(model.predict([in0Max24396,in1Max24396,in0Max70667,in1Max70667,in0Add83379,in1Add83379,in0Max19398,in1Max19398,in0Con19263],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min61198.png')

LMax24396 = maximum_layer([[[[0.797, 0.6859], [0.365, 0.91]]], [[[0.1775, 0.0905], [0.0298, 0.9642]]]], Max24396), 
LRes18432 = reshape_layer(Max24396, [2, 2, 1], Res18432), 
LRes81097 = reshape_layer(Res18432, [2, 2, 1, 1], Res81097), 
LCon41440 = conv3D_transpose_layer(Res81097, 1, 1, 1,[[[[[0.0718], [0.7451], [0.5429], [0.4126]]]]],[0, 0, 0, 0], 1, 1, 1, false, Con41440), 
LUp_31394 = up_sampling3D_layer(Con41440, 1, 1, 2, Up_31394), 
LRes64713 = reshape_layer(Up_31394, [2, 2, 8], Res64713), 
LRes46419 = reshape_layer(Res64713, [2, 16], Res46419), 
LZer56933 = zero_padding1D_layer(Res46419, 1, 0, Zer56933), 
LMax70667 = maximum_layer([[[[[0.7471, 0.2687]], [[0.0051, 0.2424]]]], [[[[0.4154, 0.9093]], [[0.0903, 0.7411]]]]], Max70667), 
LRes93630 = reshape_layer(Max70667, [2, 2], Res93630), 
LZer71321 = zero_padding1D_layer(Res93630, 1, 0, Zer71321), 
LAdd83379 = add_layer([[[[[0.2451], [0.3346]]]], [[[[0.3562], [0.3995]]]]], Add83379), 
LRes1597 = reshape_layer(Add83379, [1, 2], Res1597), 
LMax19398 = maximum_layer([[[[0.4348, 0.8394]]], [[[0.9101, 0.7222]]]], Max19398), 
LSub39591 = subtract_layer(Res1597,Max19398, Sub39591), 
LDot53028 = dot_layer(Zer71321,Sub39591, 2, 2, Dot53028), 
LCon19263 = concatenate_layer([Dot53028,[[[0.0216, 0.6692, 0.86, 0.0934, 0.9244, 0.4263, 0.4944, 0.1896, 0.9786, 0.8572, 0.701, 0.3768, 0.6737, 0.277, 0.403], [0.4321, 0.1269, 0.8837, 0.5422, 0.4866, 0.2115, 0.0363, 0.2874, 0.6717, 0.6419, 0.9859, 0.8164, 0.4387, 0.6415, 0.3709], [0.8045, 0.4814, 0.8429, 0.8462, 0.9214, 0.0207, 0.6283, 0.0647, 0.8291, 0.3223, 0.2015, 0.8549, 0.4067, 0.7086, 0.3027]]]], 2, Con19263), 
LMin61198 = minimum_layer([Zer56933,Con19263], Min61198), 
exec_layers([LMax24396,LRes18432,LRes81097,LCon41440,LUp_31394,LRes64713,LRes46419,LZer56933,LMax70667,LRes93630,LZer71321,LAdd83379,LRes1597,LMax19398,LSub39591,LDot53028,LCon19263,LMin61198],["Max24396","Res18432","Res81097","Con41440","Up_31394","Res64713","Res46419","Zer56933","Max70667","Res93630","Zer71321","Add83379","Res1597","Max19398","Sub39591","Dot53028","Con19263","Min61198"],Min61198,"Min61198")

Actual (Unparsed): [[[-0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [-0.3264537, 0.4321000, 0.1269000, 0.3288422, 0.0572246, 0.4866000, 0.2115000, 0.0363000, 0.0492476, 0.5110641, 0.3723751, 0.2830023, 0.0492476, 0.4387000, 0.3723751, 0.2830023], [-0.1059225, 0.2719615, 0.1981585, 0.1505990, 0.0262070, 0.2719615, 0.0207000, 0.1505990, 0.0647000, 0.7184254, 0.3223000, 0.2015000, 0.0692296, 0.4067000, 0.5234642, 0.3027000]]]

Expected (Unparsed): [[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-0.32645377000000003,0.4321,0.1269,0.32884220000000003,0.05722460000000001,0.4866,0.2115,0.0363,0.04924762,0.51106409,0.37237511,0.28300234,0.04924762,0.4387,0.37237511,0.28300234],[-0.10592247000000005,0.27196149999999997,0.19815850000000002,0.150599,0.026207,0.27196149999999997,0.0207,0.150599,0.0647,0.71842542,0.3223,0.2015,0.06922956,0.4067,0.5234641800000001,0.3027]]]

Actual:   [[[-0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [-0.3264, 0.4321, 0.1269, 0.3289, 0.0573, 0.4866, 0.2115, 0.0363, 0.0493, 0.5111, 0.3724, 0.2831, 0.0493, 0.4387, 0.3724, 0.2831], [-0.1059, 0.272, 0.1982, 0.1506, 0.0263, 0.272, 0.0207, 0.1506, 0.0647, 0.7185, 0.3223, 0.2015, 0.0693, 0.4067, 0.5235, 0.3027]]]

Expected: [[[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0], [-0.3264, 0.4321, 0.1269, 0.3289, 0.0573, 0.4866, 0.2115, 0.0363, 0.0493, 0.5111, 0.3724, 0.2831, 0.0493, 0.4387, 0.3724, 0.2831], [-0.1059, 0.272, 0.1982, 0.1506, 0.0263, 0.272, 0.0207, 0.1506, 0.0647, 0.7185, 0.3223, 0.2015, 0.0693, 0.4067, 0.5235, 0.3027]]]