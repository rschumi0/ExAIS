import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul40645 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul40645 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Ave37851 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave37851 = tf.keras.layers.Input(shape=([1, 2, 1]))

Mul40645 = keras.layers.Multiply(name = 'Mul40645', )([in0Mul40645,in1Mul40645])
Res79003 = keras.layers.Reshape((1, 4), name = 'Res79003', )(Mul40645)
Ave37851 = keras.layers.Average(name = 'Ave37851', )([in0Ave37851,in1Ave37851])
ReL13009 = keras.layers.ReLU(max_value=9.112324955004855, negative_slope=8.400823563842316, threshold=3.8439545590729765, name = 'ReL13009', )(Ave37851)
Res95616 = keras.layers.Reshape((1, 2), name = 'Res95616', )(ReL13009)
Dot39365 = keras.layers.Dot(axes=(1, 1), name = 'Dot39365', )([Res79003,Res95616])
model = tf.keras.models.Model(inputs=[in0Mul40645,in1Mul40645,in0Ave37851,in1Ave37851], outputs=Dot39365)
in0Mul40645 = tf.constant([[[[0.9215, 0.3426], [0.2163, 0.5963]]]])
in1Mul40645 = tf.constant([[[[0.0572, 0.9516], [0.4245, 0.024]]]])
in0Ave37851 = tf.constant([[[[0.4896], [0.6494]]]])
in1Ave37851 = tf.constant([[[[0.1286], [0.1399]]]])
print (np.array2string(model.predict([in0Mul40645,in1Mul40645,in0Ave37851,in1Ave37851],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot39365.png')

LMul40645 = multiply_layer([[[[[0.9215, 0.3426], [0.2163, 0.5963]]]], [[[[0.0572, 0.9516], [0.4245, 0.024]]]]], Mul40645), 
LRes79003 = reshape_layer(Mul40645, [1, 4], Res79003), 
LAve37851 = average_layer([[[[[0.4896], [0.6494]]]], [[[[0.1286], [0.1399]]]]], Ave37851), 
LReL13009 = relu_layer(Ave37851, 9.112324955004855, 8.400823563842316, 3.8439545590729765, ReL13009), 
LRes95616 = reshape_layer(ReL13009, [1, 2], Res95616), 
LDot39365 = dot_layer(Res79003,Res95616, 1, 1, Dot39365), 
exec_layers([LMul40645,LRes79003,LAve37851,LReL13009,LRes95616,LDot39365],["Mul40645","Res79003","Ave37851","ReL13009","Res95616","Dot39365"],Dot39365,"Dot39365")

Actual (Unparsed): [[[-1.5652539, -1.5273719], [-9.6813339, -9.4470277], [-2.7266388, -2.6606491], [-0.4249810, -0.4146956]]]

Expected (Unparsed): [[[-1.5652538530690985,-1.5273718228774014],[-9.681334042445576,-9.44702790240783],[-2.7266389053610545,-2.6606492148503333],[-0.4249809512091202,-0.4146956283568343]]]

Actual:   [[[-1.5652, -1.5273], [-9.6813, -9.447], [-2.7266, -2.6606], [-0.4249, -0.4146]]]

Expected: [[[-1.5652, -1.5273], [-9.6813, -9.447], [-2.7266, -2.6606], [-0.4249, -0.4146]]]