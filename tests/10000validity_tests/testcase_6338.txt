import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add26730 = tf.keras.layers.Input(shape=([1, 2]))
in1Add26730 = tf.keras.layers.Input(shape=([1, 2]))
in0Con92761 = tf.keras.layers.Input(shape=([1, 2]))
in0Min43023 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Min43023 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Add74992 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Add74992 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Dep13977 = tf.keras.layers.Input(shape=([2, 1, 2]))

Add26730 = keras.layers.Add(name = 'Add26730', )([in0Add26730,in1Add26730])
Con92761 = keras.layers.Concatenate(axis=2, name = 'Con92761', )([Add26730,in0Con92761])
Min43023 = keras.layers.Minimum(name = 'Min43023', )([in0Min43023,in1Min43023])
Thr16885 = keras.layers.ThresholdedReLU(theta=1.9589705133832114, name = 'Thr16885', )(Min43023)
Res5247 = keras.layers.Reshape((2, 1, 4), name = 'Res5247', )(Thr16885)
Res68681 = keras.layers.Reshape((2, 4), name = 'Res68681', )(Res5247)
Dot4677 = keras.layers.Dot(axes=(2, 2), name = 'Dot4677', )([Con92761,Res68681])
Res62757 = keras.layers.Reshape((1, 2, 1), name = 'Res62757', )(Dot4677)
Zer53841 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer53841', )(Res62757)
Add74992 = keras.layers.Add(name = 'Add74992', )([in0Add74992,in1Add74992])
Min86964 = keras.layers.Minimum(name = 'Min86964', )([Zer53841,Add74992])
Res84612 = keras.layers.Reshape((2, 2), name = 'Res84612', )(Min86964)
Dep13977 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep13977', )(in0Dep13977)
Res45598 = keras.layers.Reshape((2, 2), name = 'Res45598', )(Dep13977)
Cro85990 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro85990', )(Res45598)
Zer45500 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer45500', )(Cro85990)
Max92757 = keras.layers.Maximum(name = 'Max92757', )([Res84612,Zer45500])
model = tf.keras.models.Model(inputs=[in0Add26730,in1Add26730,in0Con92761,in0Min43023,in1Min43023,in0Add74992,in1Add74992,in0Dep13977], outputs=Max92757)
w = model.get_layer('Dep13977').get_weights() 
w[0] = np.array([[[[0.3941], [0.9533]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep13977').set_weights(w) 
in0Add26730 = tf.constant([[[0.271, 0.0936]]])
in1Add26730 = tf.constant([[[0.9577, 0.6778]]])
in0Con92761 = tf.constant([[[0.6561, 0.0522]]])
in0Min43023 = tf.constant([[[[[0.7636, 0.8259], [0.6572, 0.4838]]], [[[0.6135, 0.7049], [0.597, 0.7312]]]]])
in1Min43023 = tf.constant([[[[[0.7952, 0.3915], [0.0679, 0.6386]]], [[[0.0234, 0.7554], [0.3719, 0.2647]]]]])
in0Add74992 = tf.constant([[[[0.9682], [0.2313]], [[0.776], [0.1922]]]])
in1Add74992 = tf.constant([[[[0.3832], [0.7702]], [[0.4767], [0.4026]]]])
in0Dep13977 = tf.constant([[[[0.1579, 0.9499]], [[0.2238, 0.0628]]]])
print (np.array2string(model.predict([in0Add26730,in1Add26730,in0Con92761,in0Min43023,in1Min43023,in0Add74992,in1Add74992,in0Dep13977],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max92757.png')

LAdd26730 = add_layer([[[[0.271, 0.0936]]], [[[0.9577, 0.6778]]]], Add26730), 
LCon92761 = concatenate_layer([Add26730,[[[0.6561, 0.0522]]]], 2, Con92761), 
LMin43023 = minimum_layer([[[[[[0.7636, 0.8259], [0.6572, 0.4838]]], [[[0.6135, 0.7049], [0.597, 0.7312]]]]], [[[[[0.7952, 0.3915], [0.0679, 0.6386]]], [[[0.0234, 0.7554], [0.3719, 0.2647]]]]]], Min43023), 
LThr16885 = thresholded_relu_layer(Min43023, 1.9589705133832114, Thr16885), 
LRes5247 = reshape_layer(Thr16885, [2, 1, 4], Res5247), 
LRes68681 = reshape_layer(Res5247, [2, 4], Res68681), 
LDot4677 = dot_layer(Con92761,Res68681, 2, 2, Dot4677), 
LRes62757 = reshape_layer(Dot4677, [1, 2, 1], Res62757), 
LZer53841 = zero_padding2D_layer(Res62757, 1, 0, 0, 0, Zer53841), 
LAdd74992 = add_layer([[[[[0.9682], [0.2313]], [[0.776], [0.1922]]]], [[[[0.3832], [0.7702]], [[0.4767], [0.4026]]]]], Add74992), 
LMin86964 = minimum_layer([Zer53841,Add74992], Min86964), 
LRes84612 = reshape_layer(Min86964, [2, 2], Res84612), 
LDep13977 = depthwise_conv2D_layer([[[[0.1579, 0.9499]], [[0.2238, 0.0628]]]], 1, 1,[[[[0.3941], [0.9533]]]],[0, 0], 1, 1, false, Dep13977), 
LRes45598 = reshape_layer(Dep13977, [2, 2], Res45598), 
LCro85990 = cropping1D_layer(Res45598, 1, 0, Cro85990), 
LZer45500 = zero_padding1D_layer(Cro85990, 1, 0, Zer45500), 
LMax92757 = maximum_layer([Res84612,Zer45500], Max92757), 
exec_layers([LAdd26730,LCon92761,LMin43023,LThr16885,LRes5247,LRes68681,LDot4677,LRes62757,LZer53841,LAdd74992,LMin86964,LRes84612,LDep13977,LRes45598,LCro85990,LZer45500,LMax92757],["Add26730","Con92761","Min43023","Thr16885","Res5247","Res68681","Dot4677","Res62757","Zer53841","Add74992","Min86964","Res84612","Dep13977","Res45598","Cro85990","Zer45500","Max92757"],Max92757,"Max92757")

Actual (Unparsed): [[[0.0000000, 0.0000000], [0.0881996, 0.0598672]]]

Expected (Unparsed): [[[0,0],[0.08819958,0.059867239999999995]]]

Actual:   [[[0, 0], [0.0882, 0.0599]]]

Expected: [[[0, 0], [0.0882, 0.0599]]]