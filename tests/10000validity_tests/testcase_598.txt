import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo58253 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Mul55561 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul55561 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max8620 = tf.keras.layers.Input(shape=([2, 1]))
in0Con98793 = tf.keras.layers.Input(shape=([7]))
in0Zer46925 = tf.keras.layers.Input(shape=([2, 2]))
in0Con23855 = tf.keras.layers.Input(shape=([6]))

Glo58253 = keras.layers.GlobalMaxPool3D(name = 'Glo58253', )(in0Glo58253)
Res54891 = keras.layers.Reshape((1, 1), name = 'Res54891', )(Glo58253)
Loc99428 = keras.layers.LocallyConnected1D(3, (1),strides=(1), name = 'Loc99428', )(Res54891)
Res43006 = keras.layers.Reshape((1, 3, 1), name = 'Res43006', )(Loc99428)
Zer56190 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer56190', )(Res43006)
Mul55561 = keras.layers.Multiply(name = 'Mul55561', )([in0Mul55561,in1Mul55561])
Zer94163 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer94163', )(Mul55561)
Ave4622 = keras.layers.Average(name = 'Ave4622', )([Zer56190,Zer94163])
Res44865 = keras.layers.Reshape((2, 4), name = 'Res44865', )(Ave4622)
Fla2631 = keras.layers.Flatten(name = 'Fla2631', )(Res44865)
Max8620 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='valid', name = 'Max8620', )(in0Max8620)
Res53961 = keras.layers.Reshape((1, 1, 1), name = 'Res53961', )(Max8620)
PRe67925 = keras.layers.PReLU(name = 'PRe67925', )(Res53961)
Glo9287 = keras.layers.GlobalMaxPool2D(name = 'Glo9287', )(PRe67925)
Con98793 = keras.layers.Concatenate(axis=1, name = 'Con98793', )([Glo9287,in0Con98793])
Ave42933 = keras.layers.Average(name = 'Ave42933', )([Fla2631,Con98793])
Zer46925 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer46925', )(in0Zer46925)
Res8763 = keras.layers.Reshape((4, 2, 1), name = 'Res8763', )(Zer46925)
Res19246 = keras.layers.Reshape((4, 2, 1, 1), name = 'Res19246', )(Res8763)
Cro53918 = keras.layers.Cropping3D(cropping=((1, 2), (0, 1), (0, 0)), name = 'Cro53918', )(Res19246)
Res45093 = keras.layers.Reshape((1, 1, 1), name = 'Res45093', )(Cro53918)
Res86691 = keras.layers.Reshape((1, 1), name = 'Res86691', )(Res45093)
GRU54187 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU54187', )(Res86691)
Fla70946 = keras.layers.Flatten(name = 'Fla70946', )(GRU54187)
Lea80369 = keras.layers.LeakyReLU(alpha=3.789476959860017, name = 'Lea80369', )(Fla70946)
Con23855 = keras.layers.Concatenate(axis=1, name = 'Con23855', )([Lea80369,in0Con23855])
Sub24912 = keras.layers.Subtract(name = 'Sub24912', )([Ave42933,Con23855])
model = tf.keras.models.Model(inputs=[in0Glo58253,in0Mul55561,in1Mul55561,in0Max8620,in0Con98793,in0Zer46925,in0Con23855], outputs=Sub24912)
w = model.get_layer('Loc99428').get_weights() 
w[0] = np.array([[[0.527, 0.3443, 0.8463]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc99428').set_weights(w) 
w = model.get_layer('PRe67925').get_weights() 
w[0] = np.array([[[0.3223]]])
model.get_layer('PRe67925').set_weights(w) 
w = model.get_layer('GRU54187').get_weights() 
w[0] = np.array([[10, 7, 6, 9, 7, 5]])
w[1] = np.array([[9, 7, 7, 2, 7, 6], [1, 6, 2, 8, 4, 8]])
w[2] = np.array([[9, 8, 6, 6, 7, 2], [2, 6, 3, 2, 1, 2]])
model.get_layer('GRU54187').set_weights(w) 
in0Glo58253 = tf.constant([[[[[1.0441], [1.1908]]], [[[1.662], [1.9046]]]]])
in0Mul55561 = tf.constant([[[[0.7838], [0.1148]], [[0.3286], [0.772]]]])
in1Mul55561 = tf.constant([[[[0.2898], [0.5771]], [[0.2643], [0.0688]]]])
in0Max8620 = tf.constant([[[1.0306], [1.1357]]])
in0Con98793 = tf.constant([[0.739, 0.058, 0.6348, 0.2327, 0.4485, 0.5944, 0.612]])
in0Zer46925 = tf.constant([[[1.1037, 1.738], [1.6987, 1.141]]])
in0Con23855 = tf.constant([[0.6644, 0.6808, 0.594, 0.668, 0.6701, 0.0876]])
print (np.array2string(model.predict([in0Glo58253,in0Mul55561,in1Mul55561,in0Max8620,in0Con98793,in0Zer46925,in0Con23855],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub24912.png')

LGlo58253 = global_max_pool3D_layer([[[[[1.0441], [1.1908]]], [[[1.662], [1.9046]]]]], Glo58253), 
LRes54891 = reshape_layer(Glo58253, [1, 1], Res54891), 
LLoc99428 = locally_connected1D_layer(Res54891, 1,[[[0.527, 0.3443, 0.8463]]],[[0, 0, 0]], 1, Loc99428), 
LRes43006 = reshape_layer(Loc99428, [1, 3, 1], Res43006), 
LZer56190 = zero_padding2D_layer(Res43006, 1, 0, 1, 0, Zer56190), 
LMul55561 = multiply_layer([[[[[0.7838], [0.1148]], [[0.3286], [0.772]]]], [[[[0.2898], [0.5771]], [[0.2643], [0.0688]]]]], Mul55561), 
LZer94163 = zero_padding2D_layer(Mul55561, 0, 0, 2, 0, Zer94163), 
LAve4622 = average_layer([Zer56190,Zer94163], Ave4622), 
LRes44865 = reshape_layer(Ave4622, [2, 4], Res44865), 
LFla2631 = flatten_layer(Res44865, Fla2631), 
LMax8620 = max_pool1D_layer([[[1.0306], [1.1357]]], 2, 1, false, Max8620), 
LRes53961 = reshape_layer(Max8620, [1, 1, 1], Res53961), 
LPRe67925 = prelu_layer(Res53961, [[[0.3223]]], PRe67925), 
LGlo9287 = global_max_pool2D_layer(PRe67925, Glo9287), 
LCon98793 = concatenate_layer([Glo9287,[[0.739, 0.058, 0.6348, 0.2327, 0.4485, 0.5944, 0.612]]], 1, Con98793), 
LAve42933 = average_layer([Fla2631,Con98793], Ave42933), 
LZer46925 = zero_padding1D_layer([[[1.1037, 1.738], [1.6987, 1.141]]], 1, 1, Zer46925), 
LRes8763 = reshape_layer(Zer46925, [4, 2, 1], Res8763), 
LRes19246 = reshape_layer(Res8763, [4, 2, 1, 1], Res19246), 
LCro53918 = cropping3D_layer(Res19246, 1, 2, 0, 1, 0, 0, Cro53918), 
LRes45093 = reshape_layer(Cro53918, [1, 1, 1], Res45093), 
LRes86691 = reshape_layer(Res45093, [1, 1], Res86691), 
LGRU54187 = gru_layer(Res86691,[[10, 7, 6, 9, 7, 5]],[[9, 7, 7, 2, 7, 6], [1, 6, 2, 8, 4, 8]],[[9, 8, 6, 6, 7, 2], [2, 6, 3, 2, 1, 2]], true, GRU54187), 
LFla70946 = flatten_layer(GRU54187, Fla70946), 
LLea80369 = leaky_relu_layer(Fla70946, 3.789476959860017, Lea80369), 
LCon23855 = concatenate_layer([Lea80369,[[0.6644, 0.6808, 0.594, 0.668, 0.6701, 0.0876]]], 1, Con23855), 
LSub24912 = subtract_layer(Ave42933,Con23855, Sub24912), 
exec_layers([LGlo58253,LRes54891,LLoc99428,LRes43006,LZer56190,LMul55561,LZer94163,LAve4622,LRes44865,LFla2631,LMax8620,LRes53961,LPRe67925,LGlo9287,LCon98793,LAve42933,LZer46925,LRes8763,LRes19246,LCro53918,LRes45093,LRes86691,LGRU54187,LFla70946,LLea80369,LCon23855,LSub24912],["Glo58253","Res54891","Loc99428","Res43006","Zer56190","Mul55561","Zer94163","Ave4622","Res44865","Fla2631","Max8620","Res53961","PRe67925","Glo9287","Con98793","Ave42933","Zer46925","Res8763","Res19246","Cro53918","Res45093","Res86691","GRU54187","Fla70946","Lea80369","Con23855","Sub24912"],Sub24912,"Sub24912")

Actual (Unparsed): [[0.5678500, 0.3695000, -0.5786137, -0.3468372, -0.4776500, -0.1928189, -0.1872493, 0.6346441]]

Expected (Unparsed): [[0.5678499997311857,0.3694999996330884,-0.57861369,-0.34683722999999994,-0.47764999999999996,-0.19281895,-0.18724931,0.6346441450000001]]

Actual:   [[0.5679, 0.3695, -0.5786, -0.3468, -0.4776, -0.1928, -0.1872, 0.6347]]

Expected: [[0.5679, 0.3695, -0.5786, -0.3468, -0.4776, -0.1928, -0.1872, 0.6347]]