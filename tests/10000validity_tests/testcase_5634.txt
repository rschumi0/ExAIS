import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave77342 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Ave77342 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0GRU12636 = tf.keras.layers.Input(shape=([2, 3]))
in0Con17298 = tf.keras.layers.Input(shape=([1]))
in0Con62188 = tf.keras.layers.Input(shape=([2]))
in0Min84898 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in1Min84898 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0Sub6339 = tf.keras.layers.Input(shape=([2]))
in1Sub6339 = tf.keras.layers.Input(shape=([2]))
in0Con37141 = tf.keras.layers.Input(shape=([2]))

Ave77342 = keras.layers.Average(name = 'Ave77342', )([in0Ave77342,in1Ave77342])
Res95797 = keras.layers.Reshape((1, 2), name = 'Res95797', )(Ave77342)
Fla54580 = keras.layers.Flatten(name = 'Fla54580', )(Res95797)
GRU12636 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU12636', )(in0GRU12636)
Con17298 = keras.layers.Concatenate(axis=1, name = 'Con17298', )([GRU12636,in0Con17298])
Max7761 = keras.layers.Maximum(name = 'Max7761', )([Fla54580,Con17298])
Con62188 = keras.layers.Concatenate(axis=1, name = 'Con62188', )([Max7761,in0Con62188])
Min84898 = keras.layers.Minimum(name = 'Min84898', )([in0Min84898,in1Min84898])
Res68771 = keras.layers.Reshape((2, 1, 2), name = 'Res68771', )(Min84898)
Res91008 = keras.layers.Reshape((2, 2), name = 'Res91008', )(Res68771)
Fla69146 = keras.layers.Flatten(name = 'Fla69146', )(Res91008)
Sub6339 = keras.layers.Subtract(name = 'Sub6339', )([in0Sub6339,in1Sub6339])
Con37141 = keras.layers.Concatenate(axis=1, name = 'Con37141', )([Sub6339,in0Con37141])
Add99195 = keras.layers.Add(name = 'Add99195', )([Fla69146,Con37141])
Sub50878 = keras.layers.Subtract(name = 'Sub50878', )([Con62188,Add99195])
model = tf.keras.models.Model(inputs=[in0Ave77342,in1Ave77342,in0GRU12636,in0Con17298,in0Con62188,in0Min84898,in1Min84898,in0Sub6339,in1Sub6339,in0Con37141], outputs=Sub50878)
w = model.get_layer('GRU12636').get_weights() 
w[0] = np.array([[6, 3, 4], [2, 3, 2], [7, 9, 10]])
w[1] = np.array([[2, 2, 3]])
w[2] = np.array([[10, 3, 9], [1, 1, 7]])
model.get_layer('GRU12636').set_weights(w) 
in0Ave77342 = tf.constant([[[[0.7568, 0.9092]]]])
in1Ave77342 = tf.constant([[[[0.9772, 0.6704]]]])
in0GRU12636 = tf.constant([[[1, 6, 7], [10, 10, 2]]])
in0Con17298 = tf.constant([[0.1241]])
in0Con62188 = tf.constant([[0.043, 0.9619]])
in0Min84898 = tf.constant([[[[[0.3272], [0.6473]]], [[[0.4949], [0.5108]]]]])
in1Min84898 = tf.constant([[[[[0.7392], [0.4332]]], [[[0.6839], [0.6057]]]]])
in0Sub6339 = tf.constant([[0.0229, 0.6196]])
in1Sub6339 = tf.constant([[0.5517, 0.5671]])
in0Con37141 = tf.constant([[0.3811, 0.8452]])
print (np.array2string(model.predict([in0Ave77342,in1Ave77342,in0GRU12636,in0Con17298,in0Con62188,in0Min84898,in1Min84898,in0Sub6339,in1Sub6339,in0Con37141],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub50878.png')

LAve77342 = average_layer([[[[[0.7568, 0.9092]]]], [[[[0.9772, 0.6704]]]]], Ave77342), 
LRes95797 = reshape_layer(Ave77342, [1, 2], Res95797), 
LFla54580 = flatten_layer(Res95797, Fla54580), 
LGRU12636 = gru_layer([[[1, 6, 7], [10, 10, 2]]],[[6, 3, 4], [2, 3, 2], [7, 9, 10]],[[2, 2, 3]],[[10, 3, 9], [1, 1, 7]], true, GRU12636), 
LCon17298 = concatenate_layer([GRU12636,[[0.1241]]], 1, Con17298), 
LMax7761 = maximum_layer([Fla54580,Con17298], Max7761), 
LCon62188 = concatenate_layer([Max7761,[[0.043, 0.9619]]], 1, Con62188), 
LMin84898 = minimum_layer([[[[[[0.3272], [0.6473]]], [[[0.4949], [0.5108]]]]], [[[[[0.7392], [0.4332]]], [[[0.6839], [0.6057]]]]]], Min84898), 
LRes68771 = reshape_layer(Min84898, [2, 1, 2], Res68771), 
LRes91008 = reshape_layer(Res68771, [2, 2], Res91008), 
LFla69146 = flatten_layer(Res91008, Fla69146), 
LSub6339 = subtract_layer([[0.0229, 0.6196]], [[0.5517, 0.5671]], Sub6339), 
LCon37141 = concatenate_layer([Sub6339,[[0.3811, 0.8452]]], 1, Con37141), 
LAdd99195 = add_layer([Fla69146,Con37141], Add99195), 
LSub50878 = subtract_layer(Con62188,Add99195, Sub50878), 
exec_layers([LAve77342,LRes95797,LFla54580,LGRU12636,LCon17298,LMax7761,LCon62188,LMin84898,LRes68771,LRes91008,LFla69146,LSub6339,LCon37141,LAdd99195,LSub50878],["Ave77342","Res95797","Fla54580","GRU12636","Con17298","Max7761","Con62188","Min84898","Res68771","Res91008","Fla69146","Sub6339","Con37141","Add99195","Sub50878"],Sub50878,"Sub50878")

Actual (Unparsed): [[1.0686000, 0.3041000, -0.8330000, -0.3941000]]

Expected (Unparsed): [[1.0686,0.3041000000000001,-0.833,-0.3940999999999999]]

Actual:   [[1.0686, 0.3041, -0.833, -0.3941]]

Expected: [[1.0686, 0.3042, -0.833, -0.394]]