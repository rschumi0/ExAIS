import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim56571 = tf.keras.layers.Input(shape=([2, 2]))

Sim56571 = keras.layers.SimpleRNN(2,name = 'Sim56571', )(in0Sim56571)
Bat50948 = keras.layers.BatchNormalization(axis=1, epsilon=0.23550245711358792,  name = 'Bat50948', )(Sim56571)
Res17671 = keras.layers.Reshape((2, 1), name = 'Res17671', )(Bat50948)
Loc57888 = keras.layers.LocallyConnected1D(3, (2),strides=(1), name = 'Loc57888', )(Res17671)
model = tf.keras.models.Model(inputs=[in0Sim56571], outputs=Loc57888)
w = model.get_layer('Sim56571').get_weights() 
w[0] = np.array([[4, 4], [10, 10]])
w[1] = np.array([[2, 9], [6, 3]])
w[2] = np.array([8, 3])
model.get_layer('Sim56571').set_weights(w) 
w = model.get_layer('Bat50948').get_weights() 
w[0] = np.array([0.4534, 0.6636])
w[1] = np.array([0.0159, 0.4085])
w[2] = np.array([0.7647, 0.6269])
w[3] = np.array([0.5702, 0.3747])
model.get_layer('Bat50948').set_weights(w) 
w = model.get_layer('Loc57888').get_weights() 
w[0] = np.array([[[0.2684, 0.733, 0.0137], [0.5713, 0.4178, 0.6994]]])
w[1] = np.array([[0, 0, 0]])
model.get_layer('Loc57888').set_weights(w) 
in0Sim56571 = tf.constant([[[5, 2], [5, 1]]])
print (np.array2string(model.predict([in0Sim56571],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc57888.png')

LSim56571 = simple_rnn_layer([[[5, 2], [5, 1]]],[[4, 4], [10, 10]],[[2, 9], [6, 3]],[8, 3], Sim56571), 
LBat50948 = batch_normalization_layer(Sim56571, 1, 0.23550245711358792, [0.4534, 0.6636], [0.0159, 0.4085], [0.7647, 0.6269], [0.5702, 0.3747], Bat50948), 
LRes17671 = reshape_layer(Bat50948, [2, 1], Res17671), 
LLoc57888 = locally_connected1D_layer(Res17671, 2,[[[0.2684, 0.733, 0.0137], [0.5713, 0.4178, 0.6994]]],[[0, 0, 0]], 1, Loc57888), 
exec_layers([LSim56571,LBat50948,LRes17671,LLoc57888],["Sim56571","Bat50948","Res17671","Loc57888"],Loc57888,"Loc57888")

Actual (Unparsed): [[[0.4506194, 0.4018693, 0.5092279]]]

Expected (Unparsed): [[[0.4506193509500197,0.4018693400971182,0.5092278561371101]]]

Actual:   [[[0.4507, 0.4019, 0.5093]]]

Expected: [[[0.4507, 0.4019, 0.5093]]]