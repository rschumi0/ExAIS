import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep82143 = tf.keras.layers.Input(shape=([1, 1]))
in0Min67134 = tf.keras.layers.Input(shape=([2, 2]))
in1Min67134 = tf.keras.layers.Input(shape=([2, 2]))

Sep82143 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep82143', )(in0Sep82143)
Zer34491 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer34491', )(Sep82143)
Min67134 = keras.layers.Minimum(name = 'Min67134', )([in0Min67134,in1Min67134])
Min86980 = keras.layers.Minimum(name = 'Min86980', )([Zer34491,Min67134])
Res10202 = keras.layers.Reshape((2, 2, 1), name = 'Res10202', )(Min86980)
Max54037 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max54037', )(Res10202)
Res1995 = keras.layers.Reshape((1, 2), name = 'Res1995', )(Max54037)
Per49453 = keras.layers.Permute((2,1), name = 'Per49453',)(Res1995)
model = tf.keras.models.Model(inputs=[in0Sep82143,in0Min67134,in1Min67134], outputs=Per49453)
w = model.get_layer('Sep82143').get_weights() 
w[0] = np.array([[[0.1433]]])
w[1] = np.array([[[0.7864, 0.9012]]])
w[2] = np.array([0, 0])
model.get_layer('Sep82143').set_weights(w) 
in0Sep82143 = tf.constant([[[0.5243]]])
in0Min67134 = tf.constant([[[0.8645, 0.678], [0.156, 0.6308]]])
in1Min67134 = tf.constant([[[0.3543, 0.5982], [0.6224, 0.8648]]])
print (np.array2string(model.predict([in0Sep82143,in0Min67134,in1Min67134],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per49453.png')

LSep82143 = separable_conv1D_layer([[[0.5243]]], 1,[[[[0.1433]]],[[[0.7864, 0.9012]]]],[0, 0], 1, true, Sep82143), 
LZer34491 = zero_padding1D_layer(Sep82143, 1, 0, Zer34491), 
LMin67134 = minimum_layer([[[[0.8645, 0.678], [0.156, 0.6308]]], [[[0.3543, 0.5982], [0.6224, 0.8648]]]], Min67134), 
LMin86980 = minimum_layer([Zer34491,Min67134], Min86980), 
LRes10202 = reshape_layer(Min86980, [2, 2, 1], Res10202), 
LMax54037 = max_pool2D_layer(Res10202, 2, 1, Max54037), 
LRes1995 = reshape_layer(Max54037, [1, 2], Res1995), 
LPer49453 = permute_layer(Res1995, 2,1, Per49453), 
exec_layers([LSep82143,LZer34491,LMin67134,LMin86980,LRes10202,LMax54037,LRes1995,LPer49453],["Sep82143","Zer34491","Min67134","Min86980","Res10202","Max54037","Res1995","Per49453"],Per49453,"Per49453")

Actual (Unparsed): [[[0.0590840], [0.0677091]]]

Expected (Unparsed): [[[0.059083954216000004],[0.067709129628]]]

Actual:   [[[0.0591], [0.0678]]]

Expected: [[[0.0591], [0.0678]]]