import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave37969 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave37969 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave59692 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Ave59692 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Dot97282 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot97282 = tf.keras.layers.Input(shape=([2, 2]))
in0Con60936 = tf.keras.layers.Input(shape=([2, 2]))

Ave37969 = keras.layers.Average(name = 'Ave37969', )([in0Ave37969,in1Ave37969])
Res69628 = keras.layers.Reshape((1, 1, 1), name = 'Res69628', )(Ave37969)
Res75532 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res75532', )(Res69628)
Zer73098 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer73098', )(Res75532)
Ave59692 = keras.layers.Average(name = 'Ave59692', )([in0Ave59692,in1Ave59692])
Ave39281 = keras.layers.Average(name = 'Ave39281', )([Zer73098,Ave59692])
Res99148 = keras.layers.Reshape((1, 2, 2), name = 'Res99148', )(Ave39281)
Res63575 = keras.layers.Reshape((1, 4), name = 'Res63575', )(Res99148)
Zer68377 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer68377', )(Res63575)
Dot97282 = keras.layers.Dot(axes=(1, 2), name = 'Dot97282', )([in0Dot97282,in1Dot97282])
Con60936 = keras.layers.Concatenate(axis=2, name = 'Con60936', )([Dot97282,in0Con60936])
Ave82073 = keras.layers.Average(name = 'Ave82073', )([Zer68377,Con60936])
Glo76404 = keras.layers.GlobalAveragePooling1D(name = 'Glo76404', )(Ave82073)
model = tf.keras.models.Model(inputs=[in0Ave37969,in1Ave37969,in0Ave59692,in1Ave59692,in0Dot97282,in1Dot97282,in0Con60936], outputs=Glo76404)
in0Ave37969 = tf.constant([[[0.8681]]])
in1Ave37969 = tf.constant([[[0.1464]]])
in0Ave59692 = tf.constant([[[[[0.3743], [0.3808]], [[0.9323], [0.7981]]]]])
in1Ave59692 = tf.constant([[[[[0.6262], [0.0929]], [[0.2692], [0.3977]]]]])
in0Dot97282 = tf.constant([[[0.086, 0.707], [0.6237, 0.4039]]])
in1Dot97282 = tf.constant([[[0.3481, 0.2573], [0.6596, 0.3377]]])
in0Con60936 = tf.constant([[[0.4721, 0.9749], [0.4338, 0.0531]]])
print (np.array2string(model.predict([in0Ave37969,in1Ave37969,in0Ave59692,in1Ave59692,in0Dot97282,in1Dot97282,in0Con60936],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo76404.png')

LAve37969 = average_layer([[[[0.8681]]], [[[0.1464]]]], Ave37969), 
LRes69628 = reshape_layer(Ave37969, [1, 1, 1], Res69628), 
LRes75532 = reshape_layer(Res69628, [1, 1, 1, 1], Res75532), 
LZer73098 = zero_padding3D_layer(Res75532, 0, 0, 1, 0, 1, 0, Zer73098), 
LAve59692 = average_layer([[[[[[0.3743], [0.3808]], [[0.9323], [0.7981]]]]], [[[[[0.6262], [0.0929]], [[0.2692], [0.3977]]]]]], Ave59692), 
LAve39281 = average_layer([Zer73098,Ave59692], Ave39281), 
LRes99148 = reshape_layer(Ave39281, [1, 2, 2], Res99148), 
LRes63575 = reshape_layer(Res99148, [1, 4], Res63575), 
LZer68377 = zero_padding1D_layer(Res63575, 1, 0, Zer68377), 
LDot97282 = dot_layer([[[0.086, 0.707], [0.6237, 0.4039]]], [[[0.3481, 0.2573], [0.6596, 0.3377]]], 1, 2, Dot97282), 
LCon60936 = concatenate_layer([Dot97282,[[[0.4721, 0.9749], [0.4338, 0.0531]]]], 2, Con60936), 
LAve82073 = average_layer([Zer68377,Con60936], Ave82073), 
LGlo76404 = global_average_pooling1D_layer(Ave82073, Glo76404), 
exec_layers([LAve37969,LRes69628,LRes75532,LZer73098,LAve59692,LAve39281,LRes99148,LRes63575,LZer68377,LDot97282,LCon60936,LAve82073,LGlo76404],["Ave37969","Res69628","Res75532","Zer73098","Ave59692","Ave39281","Res99148","Res63575","Zer68377","Dot97282","Con60936","Ave82073","Glo76404"],Glo76404,"Glo76404")

Actual (Unparsed): [[0.1976424, 0.2471271, 0.3015687, 0.3951438]]

Expected (Unparsed): [[0.19764244500000003,0.24712708,0.30156875,0.39514375]]

Actual:   [[0.1977, 0.2472, 0.3016, 0.3952]]

Expected: [[0.1977, 0.2472, 0.3016, 0.3952]]