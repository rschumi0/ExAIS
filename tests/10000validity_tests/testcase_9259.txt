import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min4168 = tf.keras.layers.Input(shape=([1, 2]))
in1Min4168 = tf.keras.layers.Input(shape=([1, 2]))

Min4168 = keras.layers.Minimum(name = 'Min4168', )([in0Min4168,in1Min4168])
Sep58705 = keras.layers.SeparableConv1D(2, (2),strides=(2), padding='same', name = 'Sep58705', )(Min4168)
ELU35708 = keras.layers.ELU(alpha=-7.9092122637324636, name = 'ELU35708', )(Sep58705)
Res57087 = keras.layers.Reshape((1, 2, 1), name = 'Res57087', )(ELU35708)
Loc25450 = keras.layers.LocallyConnected2D(3, (1, 2),strides=(1, 1), name = 'Loc25450', )(Res57087)
Res91113 = keras.layers.Reshape((1, 3), name = 'Res91113', )(Loc25450)
GRU14190 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU14190', )(Res91113)
model = tf.keras.models.Model(inputs=[in0Min4168,in1Min4168], outputs=GRU14190)
w = model.get_layer('Sep58705').get_weights() 
w[0] = np.array([[[0.1632], [0.405]], [[0.3897], [0.7881]]])
w[1] = np.array([[[0.0225, 0.3037], [0.1074, 0.4712]]])
w[2] = np.array([0, 0])
model.get_layer('Sep58705').set_weights(w) 
w = model.get_layer('Loc25450').get_weights() 
w[0] = np.array([[[0.3737, 0.5967, 0.4022], [0.0533, 0.6603, 0.3622]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc25450').set_weights(w) 
w = model.get_layer('GRU14190').get_weights() 
w[0] = np.array([[5, 9, 10], [3, 3, 3], [5, 9, 4]])
w[1] = np.array([[8, 6, 1]])
w[2] = np.array([2, 5, 10])
model.get_layer('GRU14190').set_weights(w) 
in0Min4168 = tf.constant([[[0.8419, 0.6874]]])
in1Min4168 = tf.constant([[[0.6651, 0.0439]]])
print (np.array2string(model.predict([in0Min4168,in1Min4168],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU14190.png')

LMin4168 = minimum_layer([[[[0.8419, 0.6874]]], [[[0.6651, 0.0439]]]], Min4168), 
LSep58705 = separable_conv1D_layer(Min4168, 2,[[[[0.1632], [0.405]], [[0.3897], [0.7881]]],[[[0.0225, 0.3037], [0.1074, 0.4712]]]],[0, 0], 2, true, Sep58705), 
LELU35708 = elu_layer(Sep58705, -7.9092122637324636, ELU35708), 
LRes57087 = reshape_layer(ELU35708, [1, 2, 1], Res57087), 
LLoc25450 = locally_connected2D_layer(Res57087, 1, 2,[[[0.3737, 0.5967, 0.4022], [0.0533, 0.6603, 0.3622]]],[[[0, 0, 0]]], 1, 1, Loc25450), 
LRes91113 = reshape_layer(Loc25450, [1, 3], Res91113), 
LGRU14190 = gru_layer(Res91113,[[5, 9, 10], [3, 3, 3], [5, 9, 4]],[[8, 6, 1]],[2, 5, 10], false, GRU14190), 
exec_layers([LMin4168,LSep58705,LELU35708,LRes57087,LLoc25450,LRes91113,LGRU14190],["Min4168","Sep58705","ELU35708","Res57087","Loc25450","Res91113","GRU14190"],GRU14190,"GRU14190")

Actual (Unparsed): [[0.1004298]]

Expected (Unparsed): [[0.10042984471756594]]

Actual:   [[0.1005]]

Expected: [[0.1005]]