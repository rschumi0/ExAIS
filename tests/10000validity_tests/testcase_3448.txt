import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min83575 = tf.keras.layers.Input(shape=([1, 2]))
in1Min83575 = tf.keras.layers.Input(shape=([1, 2]))
in0Con92339 = tf.keras.layers.Input(shape=([1, 2]))
in0Sep87405 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot51449 = tf.keras.layers.Input(shape=([2]))
in1Dot51449 = tf.keras.layers.Input(shape=([2]))
in0Con95174 = tf.keras.layers.Input(shape=([3]))

Min83575 = keras.layers.Minimum(name = 'Min83575', )([in0Min83575,in1Min83575])
Con92339 = keras.layers.Concatenate(axis=2, name = 'Con92339', )([Min83575,in0Con92339])
Sep87405 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep87405', )(in0Sep87405)
Sub36109 = keras.layers.Subtract(name = 'Sub36109', )([Con92339,Sep87405])
Fla49081 = keras.layers.Flatten(name = 'Fla49081', )(Sub36109)
Dot51449 = keras.layers.Dot(axes=(1, 1), name = 'Dot51449', )([in0Dot51449,in1Dot51449])
Con95174 = keras.layers.Concatenate(axis=1, name = 'Con95174', )([Dot51449,in0Con95174])
Max94481 = keras.layers.Maximum(name = 'Max94481', )([Fla49081,Con95174])
model = tf.keras.models.Model(inputs=[in0Min83575,in1Min83575,in0Con92339,in0Sep87405,in0Dot51449,in1Dot51449,in0Con95174], outputs=Max94481)
w = model.get_layer('Sep87405').get_weights() 
w[0] = np.array([[[0.7102]]])
w[1] = np.array([[[0.5111, 0.1601, 0.9251, 0.1468]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep87405').set_weights(w) 
in0Min83575 = tf.constant([[[0.0934, 0.2412]]])
in1Min83575 = tf.constant([[[0.4585, 0.7951]]])
in0Con92339 = tf.constant([[[0.6043, 0.984]]])
in0Sep87405 = tf.constant([[[0.437]]])
in0Dot51449 = tf.constant([[0.5306, 0.1857]])
in1Dot51449 = tf.constant([[0.2349, 0.197]])
in0Con95174 = tf.constant([[0.0825, 0.0199, 0.0559]])
print (np.array2string(model.predict([in0Min83575,in1Min83575,in0Con92339,in0Sep87405,in0Dot51449,in1Dot51449,in0Con95174],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max94481.png')

LMin83575 = minimum_layer([[[[0.0934, 0.2412]]], [[[0.4585, 0.7951]]]], Min83575), 
LCon92339 = concatenate_layer([Min83575,[[[0.6043, 0.984]]]], 2, Con92339), 
LSep87405 = separable_conv1D_layer([[[0.437]]], 1,[[[[0.7102]]],[[[0.5111, 0.1601, 0.9251, 0.1468]]]],[0, 0, 0, 0], 1, true, Sep87405), 
LSub36109 = subtract_layer(Con92339,Sep87405, Sub36109), 
LFla49081 = flatten_layer(Sub36109, Fla49081), 
LDot51449 = dot_layer([[0.5306, 0.1857]], [[0.2349, 0.197]], 1, 1, Dot51449), 
LCon95174 = concatenate_layer([Dot51449,[[0.0825, 0.0199, 0.0559]]], 1, Con95174), 
LMax94481 = maximum_layer([Fla49081,Con95174], Max94481), 
exec_layers([LMin83575,LCon92339,LSep87405,LSub36109,LFla49081,LDot51449,LCon95174,LMax94481],["Min83575","Con92339","Sep87405","Sub36109","Fla49081","Dot51449","Con95174","Max94481"],Max94481,"Max94481")

Actual (Unparsed): [[0.1612208, 0.1915118, 0.3171884, 0.9384396]]

Expected (Unparsed): [[0.16122083999999998,0.19151178026,0.31718836925999994,0.93843953368]]

Actual:   [[0.1613, 0.1916, 0.3172, 0.9385]]

Expected: [[0.1613, 0.1916, 0.3172, 0.9385]]