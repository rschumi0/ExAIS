import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot85029 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot85029 = tf.keras.layers.Input(shape=([2, 3]))
in0Add81994 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Add81994 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Con25995 = tf.keras.layers.Input(shape=([3, 2]))

Dot85029 = keras.layers.Dot(axes=(1, 1), name = 'Dot85029', )([in0Dot85029,in1Dot85029])
Add81994 = keras.layers.Add(name = 'Add81994', )([in0Add81994,in1Add81994])
Res12734 = keras.layers.Reshape((1, 1, 4), name = 'Res12734', )(Add81994)
Res78312 = keras.layers.Reshape((1, 4), name = 'Res78312', )(Res12734)
Fla87514 = keras.layers.Flatten(name = 'Fla87514', )(Res78312)
Res13562 = keras.layers.Reshape((4, 1), name = 'Res13562', )(Fla87514)
Ave95263 = keras.layers.AveragePooling1D(pool_size=(4), name = 'Ave95263', )(Res13562)
Zer52120 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer52120', )(Ave95263)
Con25995 = keras.layers.Concatenate(axis=2, name = 'Con25995', )([Zer52120,in0Con25995])
Ave83764 = keras.layers.Average(name = 'Ave83764', )([Dot85029,Con25995])
model = tf.keras.models.Model(inputs=[in0Dot85029,in1Dot85029,in0Add81994,in1Add81994,in0Con25995], outputs=Ave83764)
in0Dot85029 = tf.constant([[[0.4381, 0.572, 0.0266], [0.8403, 0.9575, 0.6898]]])
in1Dot85029 = tf.constant([[[0.6123, 0.5401, 0.5194], [0.0776, 0.1923, 0.8419]]])
in0Add81994 = tf.constant([[[[[0.788, 0.5817], [0.3628, 0.533]]]]])
in1Add81994 = tf.constant([[[[[0.3633, 0.6866], [0.2715, 0.8229]]]]])
in0Con25995 = tf.constant([[[0.3192, 0.1606], [0.4451, 0.7443], [0.4287, 0.1819]]])
print (np.array2string(model.predict([in0Dot85029,in1Dot85029,in0Add81994,in1Add81994,in0Con25995],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave83764.png')

LDot85029 = dot_layer([[[0.4381, 0.572, 0.0266], [0.8403, 0.9575, 0.6898]]], [[[0.6123, 0.5401, 0.5194], [0.0776, 0.1923, 0.8419]]], 1, 1, Dot85029), 
LAdd81994 = add_layer([[[[[[0.788, 0.5817], [0.3628, 0.533]]]]], [[[[[0.3633, 0.6866], [0.2715, 0.8229]]]]]], Add81994), 
LRes12734 = reshape_layer(Add81994, [1, 1, 4], Res12734), 
LRes78312 = reshape_layer(Res12734, [1, 4], Res78312), 
LFla87514 = flatten_layer(Res78312, Fla87514), 
LRes13562 = reshape_layer(Fla87514, [4, 1], Res13562), 
LAve95263 = average_pooling1D_layer(Res13562, 4, Ave95263), 
LZer52120 = zero_padding1D_layer(Ave95263, 2, 0, Zer52120), 
LCon25995 = concatenate_layer([Zer52120,[[[0.3192, 0.1606], [0.4451, 0.7443], [0.4287, 0.1819]]]], 2, Con25995), 
LAve83764 = average_layer([Dot85029,Con25995], Ave83764), 
exec_layers([LDot85029,LAdd81994,LRes12734,LRes78312,LFla87514,LRes13562,LAve95263,LZer52120,LCon25995,LAve83764],["Dot85029","Add81994","Res12734","Res78312","Fla87514","Res13562","Ave95263","Zer52120","Con25995","Ave83764"],Ave83764,"Ave83764")

Actual (Unparsed): [[[0.1667280, 0.3587038, 0.5477989], [0.2122688, 0.4690822, 0.9237580], [0.5861328, 0.2878576, 0.3882293]]]

Expected (Unparsed): [[[0.16672795499999998,0.35870375,0.547798855],[0.21226879999999998,0.46908222499999996,0.9237580249999999],[0.58613283,0.2878576,0.38822933000000004]]]

Actual:   [[[0.1668, 0.3588, 0.5478], [0.2123, 0.4691, 0.9238], [0.5862, 0.2879, 0.3883]]]

Expected: [[[0.1668, 0.3588, 0.5478], [0.2123, 0.4691, 0.9238], [0.5862, 0.2879, 0.3883]]]