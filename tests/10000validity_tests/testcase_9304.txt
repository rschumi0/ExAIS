import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub82504 = tf.keras.layers.Input(shape=([3, 2, 3]))
in1Sub82504 = tf.keras.layers.Input(shape=([3, 2, 3]))
in0Max14328 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Max14328 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Con32771 = tf.keras.layers.Input(shape=([3, 2, 2]))

Sub82504 = keras.layers.Subtract(name = 'Sub82504', )([in0Sub82504,in1Sub82504])
Max14328 = keras.layers.Maximum(name = 'Max14328', )([in0Max14328,in1Max14328])
Zer36933 = keras.layers.ZeroPadding2D(padding=((2, 0), (0, 0)), name = 'Zer36933', )(Max14328)
Con32771 = keras.layers.Concatenate(axis=3, name = 'Con32771', )([Zer36933,in0Con32771])
Max55091 = keras.layers.Maximum(name = 'Max55091', )([Sub82504,Con32771])
Res7960 = keras.layers.Reshape((3, 6), name = 'Res7960', )(Max55091)
Per29756 = keras.layers.Permute((1,2), name = 'Per29756',)(Res7960)
Res52995 = keras.layers.Reshape((3, 6, 1), name = 'Res52995', )(Per29756)
Res97413 = keras.layers.Reshape((3, 6, 1, 1), name = 'Res97413', )(Res52995)
Glo20330 = keras.layers.GlobalAveragePooling3D(name = 'Glo20330', )(Res97413)
model = tf.keras.models.Model(inputs=[in0Sub82504,in1Sub82504,in0Max14328,in1Max14328,in0Con32771], outputs=Glo20330)
in0Sub82504 = tf.constant([[[[0.0804, 0.0596, 0.4478], [0.007, 0.8219, 0.9146]], [[0.9706, 0.0198, 0.0078], [0.3583, 0.8639, 0.2746]], [[0.5568, 0.9485, 0.0651], [0.7696, 0.9807, 0.1478]]]])
in1Sub82504 = tf.constant([[[[0.2809, 0.4515, 0.8494], [0.5098, 0.3306, 0.1072]], [[0.5249, 0.3375, 0.5202], [0.5862, 0.7631, 0.3723]], [[0.1564, 0.7391, 0.3385], [0.3265, 0.5677, 0.5388]]]])
in0Max14328 = tf.constant([[[[0.0637], [0.2325]]]])
in1Max14328 = tf.constant([[[[0.4241], [0.3423]]]])
in0Con32771 = tf.constant([[[[0.5147, 0.9014], [0.6458, 0.9467]], [[0.1481, 0.6827], [0.9247, 0.2621]], [[0.6469, 0.3537], [0.6787, 0.3065]]]])
print (np.array2string(model.predict([in0Sub82504,in1Sub82504,in0Max14328,in1Max14328,in0Con32771],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo20330.png')

LSub82504 = subtract_layer([[[[0.0804, 0.0596, 0.4478], [0.007, 0.8219, 0.9146]], [[0.9706, 0.0198, 0.0078], [0.3583, 0.8639, 0.2746]], [[0.5568, 0.9485, 0.0651], [0.7696, 0.9807, 0.1478]]]], [[[[0.2809, 0.4515, 0.8494], [0.5098, 0.3306, 0.1072]], [[0.5249, 0.3375, 0.5202], [0.5862, 0.7631, 0.3723]], [[0.1564, 0.7391, 0.3385], [0.3265, 0.5677, 0.5388]]]], Sub82504), 
LMax14328 = maximum_layer([[[[[0.0637], [0.2325]]]], [[[[0.4241], [0.3423]]]]], Max14328), 
LZer36933 = zero_padding2D_layer(Max14328, 2, 0, 0, 0, Zer36933), 
LCon32771 = concatenate_layer([Zer36933,[[[[0.5147, 0.9014], [0.6458, 0.9467]], [[0.1481, 0.6827], [0.9247, 0.2621]], [[0.6469, 0.3537], [0.6787, 0.3065]]]]], 3, Con32771), 
LMax55091 = maximum_layer([Sub82504,Con32771], Max55091), 
LRes7960 = reshape_layer(Max55091, [3, 6], Res7960), 
LPer29756 = permute_layer(Res7960, 1,2, Per29756), 
LRes52995 = reshape_layer(Per29756, [3, 6, 1], Res52995), 
LRes97413 = reshape_layer(Res52995, [3, 6, 1, 1], Res97413), 
LGlo20330 = global_average_pooling3D_layer(Res97413, Glo20330), 
exec_layers([LSub82504,LMax14328,LZer36933,LCon32771,LMax55091,LRes7960,LPer29756,LRes52995,LRes97413,LGlo20330],["Sub82504","Max14328","Zer36933","Con32771","Max55091","Res7960","Per29756","Res52995","Res97413","Glo20330"],Glo20330,"Glo20330")

Actual (Unparsed): [[0.4624944]]

Expected (Unparsed): [[0.46249444444444443]]

Actual:   [[0.4625]]

Expected: [[0.4625]]