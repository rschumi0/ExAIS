import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max97295 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max97295 = tf.keras.layers.Input(shape=([1, 2, 2]))

Max97295 = keras.layers.Maximum(name = 'Max97295', )([in0Max97295,in1Max97295])
Dep37450 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep37450', )(Max97295)
model = tf.keras.models.Model(inputs=[in0Max97295,in1Max97295], outputs=Dep37450)
w = model.get_layer('Dep37450').get_weights() 
w[0] = np.array([[[[0.3631], [0.0235]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep37450').set_weights(w) 
in0Max97295 = tf.constant([[[[0.9621, 0.7354], [0.4551, 0.8021]]]])
in1Max97295 = tf.constant([[[[0.3896, 0.1664], [0.1673, 0.3254]]]])
print (np.array2string(model.predict([in0Max97295,in1Max97295],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep37450.png')

LMax97295 = maximum_layer([[[[[0.9621, 0.7354], [0.4551, 0.8021]]]], [[[[0.3896, 0.1664], [0.1673, 0.3254]]]]], Max97295), 
LDep37450 = depthwise_conv2D_layer(Max97295, 1, 1,[[[[0.3631], [0.0235]]]],[0, 0], 1, 1, false, Dep37450), 
exec_layers([LMax97295,LDep37450],["Max97295","Dep37450"],Dep37450,"Dep37450")

Actual (Unparsed): [[[[0.3493385, 0.0172819], [0.1652468, 0.0188494]]]]

Expected (Unparsed): [[[[0.34933850999999994,0.017281900000000003],[0.16524681,0.01884935]]]]

Actual:   [[[[0.3494, 0.0173], [0.1653, 0.0189]]]]

Expected: [[[[0.3494, 0.0173], [0.1653, 0.0189]]]]