import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add53761 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add53761 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Ave64992 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave64992 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Add53761 = keras.layers.Add(name = 'Add53761', )([in0Add53761,in1Add53761])
Res12930 = keras.layers.Reshape((1, 2, 2, 1), name = 'Res12930', )(Add53761)
Glo61939 = keras.layers.GlobalMaxPool3D(name = 'Glo61939', )(Res12930)
Res71617 = keras.layers.Reshape((1, 1), name = 'Res71617', )(Glo61939)
PRe54776 = keras.layers.PReLU(name = 'PRe54776', )(Res71617)
Ave64992 = keras.layers.Average(name = 'Ave64992', )([in0Ave64992,in1Ave64992])
Res96335 = keras.layers.Reshape((1, 2, 1), name = 'Res96335', )(Ave64992)
Glo3872 = keras.layers.GlobalMaxPool2D(name = 'Glo3872', )(Res96335)
Res16039 = keras.layers.Reshape((1, 1), name = 'Res16039', )(Glo3872)
PRe81421 = keras.layers.PReLU(name = 'PRe81421', )(Res16039)
Add39433 = keras.layers.Add(name = 'Add39433', )([PRe54776,PRe81421])
Zer86796 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer86796', )(Add39433)
model = tf.keras.models.Model(inputs=[in0Add53761,in1Add53761,in0Ave64992,in1Ave64992], outputs=Zer86796)
w = model.get_layer('PRe54776').get_weights() 
w[0] = np.array([[0.0373]])
model.get_layer('PRe54776').set_weights(w) 
w = model.get_layer('PRe81421').get_weights() 
w[0] = np.array([[0.3255]])
model.get_layer('PRe81421').set_weights(w) 
in0Add53761 = tf.constant([[[[0.4809, 0.9722], [0.1736, 0.6571]]]])
in1Add53761 = tf.constant([[[[0.7156, 0.6759], [0.5016, 0.0493]]]])
in0Ave64992 = tf.constant([[[[[0.9868]], [[0.8401]]]]])
in1Ave64992 = tf.constant([[[[[0.9636]], [[0.4]]]]])
print (np.array2string(model.predict([in0Add53761,in1Add53761,in0Ave64992,in1Ave64992],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer86796.png')

LAdd53761 = add_layer([[[[[0.4809, 0.9722], [0.1736, 0.6571]]]], [[[[0.7156, 0.6759], [0.5016, 0.0493]]]]], Add53761), 
LRes12930 = reshape_layer(Add53761, [1, 2, 2, 1], Res12930), 
LGlo61939 = global_max_pool3D_layer(Res12930, Glo61939), 
LRes71617 = reshape_layer(Glo61939, [1, 1], Res71617), 
LPRe54776 = prelu_layer(Res71617, [[0.0373]], PRe54776), 
LAve64992 = average_layer([[[[[[0.9868]], [[0.8401]]]]], [[[[[0.9636]], [[0.4]]]]]], Ave64992), 
LRes96335 = reshape_layer(Ave64992, [1, 2, 1], Res96335), 
LGlo3872 = global_max_pool2D_layer(Res96335, Glo3872), 
LRes16039 = reshape_layer(Glo3872, [1, 1], Res16039), 
LPRe81421 = prelu_layer(Res16039, [[0.3255]], PRe81421), 
LAdd39433 = add_layer([PRe54776,PRe81421], Add39433), 
LZer86796 = zero_padding1D_layer(Add39433, 1, 1, Zer86796), 
exec_layers([LAdd53761,LRes12930,LGlo61939,LRes71617,LPRe54776,LAve64992,LRes96335,LGlo3872,LRes16039,LPRe81421,LAdd39433,LZer86796],["Add53761","Res12930","Glo61939","Res71617","PRe54776","Ave64992","Res96335","Glo3872","Res16039","PRe81421","Add39433","Zer86796"],Zer86796,"Zer86796")

Actual (Unparsed): [[[0.0000000], [2.6233000], [0.0000000]]]

Expected (Unparsed): [[[0],[2.6233],[0]]]

Actual:   [[[0], [2.6233], [0]]]

Expected: [[[0], [2.6233], [0]]]