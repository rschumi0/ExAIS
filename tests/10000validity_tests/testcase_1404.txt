import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add30692 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Add30692 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dot66345 = tf.keras.layers.Input(shape=([3]))
in1Dot66345 = tf.keras.layers.Input(shape=([3]))
in0Con41063 = tf.keras.layers.Input(shape=([1, 1]))
in0Min38337 = tf.keras.layers.Input(shape=([1, 2]))
in1Min38337 = tf.keras.layers.Input(shape=([1, 2]))
in0Min72422 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Min72422 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))

Add30692 = keras.layers.Add(name = 'Add30692', )([in0Add30692,in1Add30692])
Res33506 = keras.layers.Reshape((1, 4), name = 'Res33506', )(Add30692)
Dot66345 = keras.layers.Dot(axes=(1, 1), name = 'Dot66345', )([in0Dot66345,in1Dot66345])
Res14379 = keras.layers.Reshape((1, 1), name = 'Res14379', )(Dot66345)
Sep58797 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep58797', )(Res14379)
Con41063 = keras.layers.Concatenate(axis=2, name = 'Con41063', )([Sep58797,in0Con41063])
Add78230 = keras.layers.Add(name = 'Add78230', )([Res33506,Con41063])
Min38337 = keras.layers.Minimum(name = 'Min38337', )([in0Min38337,in1Min38337])
Max41805 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max41805', )(Min38337)
Res73286 = keras.layers.Reshape((1, 2, 1), name = 'Res73286', )(Max41805)
Res7424 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res7424', )(Res73286)
Min72422 = keras.layers.Minimum(name = 'Min72422', )([in0Min72422,in1Min72422])
Zer29352 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (0, 0)), name = 'Zer29352', )(Min72422)
Mul66230 = keras.layers.Multiply(name = 'Mul66230', )([Res7424,Zer29352])
Res99046 = keras.layers.Reshape((1, 2, 1), name = 'Res99046', )(Mul66230)
Res84945 = keras.layers.Reshape((1, 2), name = 'Res84945', )(Res99046)
Dot96228 = keras.layers.Dot(axes=(1, 1), name = 'Dot96228', )([Add78230,Res84945])
model = tf.keras.models.Model(inputs=[in0Add30692,in1Add30692,in0Dot66345,in1Dot66345,in0Con41063,in0Min38337,in1Min38337,in0Min72422,in1Min72422], outputs=Dot96228)
w = model.get_layer('Sep58797').get_weights() 
w[0] = np.array([[[0.1485]]])
w[1] = np.array([[[0.3219, 0.8501, 0.6763]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep58797').set_weights(w) 
in0Add30692 = tf.constant([[[[0.3949, 0.3279], [0.6147, 0.6239]]]])
in1Add30692 = tf.constant([[[[0.6783, 0.3181], [0.2968, 0.3805]]]])
in0Dot66345 = tf.constant([[0.4578, 0.1969, 0.3218]])
in1Dot66345 = tf.constant([[0.9326, 0.7123, 0.13]])
in0Con41063 = tf.constant([[[0.9052]]])
in0Min38337 = tf.constant([[[0.7682, 0.0653]]])
in1Min38337 = tf.constant([[[0.3854, 0.6468]]])
in0Min72422 = tf.constant([[[[[0.315]]]]])
in1Min72422 = tf.constant([[[[[0.5076]]]]])
print (np.array2string(model.predict([in0Add30692,in1Add30692,in0Dot66345,in1Dot66345,in0Con41063,in0Min38337,in1Min38337,in0Min72422,in1Min72422],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot96228.png')

LAdd30692 = add_layer([[[[[0.3949, 0.3279], [0.6147, 0.6239]]]], [[[[0.6783, 0.3181], [0.2968, 0.3805]]]]], Add30692), 
LRes33506 = reshape_layer(Add30692, [1, 4], Res33506), 
LDot66345 = dot_layer([[0.4578, 0.1969, 0.3218]], [[0.9326, 0.7123, 0.13]], 1, 1, Dot66345), 
LRes14379 = reshape_layer(Dot66345, [1, 1], Res14379), 
LSep58797 = separable_conv1D_layer(Res14379, 1,[[[[0.1485]]],[[[0.3219, 0.8501, 0.6763]]]],[0, 0, 0], 1, false, Sep58797), 
LCon41063 = concatenate_layer([Sep58797,[[[0.9052]]]], 2, Con41063), 
LAdd78230 = add_layer([Res33506,Con41063], Add78230), 
LMin38337 = minimum_layer([[[[0.7682, 0.0653]]], [[[0.3854, 0.6468]]]], Min38337), 
LMax41805 = max_pool1D_layer(Min38337, 1, Max41805), 
LRes73286 = reshape_layer(Max41805, [1, 2, 1], Res73286), 
LRes7424 = reshape_layer(Res73286, [1, 2, 1, 1], Res7424), 
LMin72422 = minimum_layer([[[[[[0.315]]]]], [[[[[0.5076]]]]]], Min72422), 
LZer29352 = zero_padding3D_layer(Min72422, 0, 0, 1, 0, 0, 0, Zer29352), 
LMul66230 = multiply_layer([Res7424,Zer29352], Mul66230), 
LRes99046 = reshape_layer(Mul66230, [1, 2, 1], Res99046), 
LRes84945 = reshape_layer(Res99046, [1, 2], Res84945), 
LDot96228 = dot_layer(Add78230,Res84945, 1, 1, Dot96228), 
exec_layers([LAdd30692,LRes33506,LDot66345,LRes14379,LSep58797,LCon41063,LAdd78230,LMin38337,LMax41805,LRes73286,LRes7424,LMin72422,LZer29352,LMul66230,LRes99046,LRes84945,LDot96228],["Add30692","Res33506","Dot66345","Res14379","Sep58797","Con41063","Add78230","Min38337","Max41805","Res73286","Res7424","Min72422","Zer29352","Mul66230","Res99046","Res84945","Dot96228"],Dot96228,"Dot96228")

Actual (Unparsed): [[[0.0000000, 0.0226740], [0.0000000, 0.0148694], [0.0000000, 0.0200072], [0.0000000, 0.0392795]]]

Expected (Unparsed): [[[0.0,0.0226740262370545],[0.0,0.0148693598623176],[0.0,0.0200072375087759],[0.0,0.039279517199999996]]]

Actual:   [[[0, 0.0227], [0, 0.0149], [0, 0.0201], [0, 0.0393]]]

Expected: [[[0, 0.0227], [0, 0.0149], [0, 0.0201], [0, 0.0393]]]