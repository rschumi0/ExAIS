import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST3902 = tf.keras.layers.Input(shape=([2, 2]))

LST3902 = keras.layers.LSTM(3,recurrent_activation='sigmoid', name = 'LST3902', )(in0LST3902)
Res83905 = keras.layers.Reshape((3, 1), name = 'Res83905', )(LST3902)
Res9582 = keras.layers.Reshape((3, 1, 1), name = 'Res9582', )(Res83905)
Res59960 = keras.layers.Reshape((3, 1, 1, 1), name = 'Res59960', )(Res9582)
Con86483 = keras.layers.Conv3DTranspose(4, (3, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con86483', )(Res59960)
Res57837 = keras.layers.Reshape((5, 1, 4), name = 'Res57837', )(Con86483)
Res41303 = keras.layers.Reshape((5, 4), name = 'Res41303', )(Res57837)
Glo60597 = keras.layers.GlobalAveragePooling1D(name = 'Glo60597', )(Res41303)
model = tf.keras.models.Model(inputs=[in0LST3902], outputs=Glo60597)
w = model.get_layer('LST3902').get_weights() 
w[0] = np.array([[3, 4, 10, 4, 10, 9, 6, 8, 5, 9, 6, 3], [1, 8, 3, 4, 6, 6, 8, 1, 7, 8, 8, 6]])
w[1] = np.array([[8, 2, 10, 4, 6, 7, 3, 5, 2, 7, 9, 2], [7, 10, 4, 2, 1, 3, 2, 5, 8, 4, 1, 7], [8, 3, 2, 4, 2, 9, 9, 8, 8, 10, 1, 2]])
w[2] = np.array([3, 5, 8, 8, 5, 1, 5, 7, 7, 10, 4, 9])
model.get_layer('LST3902').set_weights(w) 
w = model.get_layer('Con86483').get_weights() 
w[0] = np.array([[[[[0.0016], [0.9455], [0.0206], [0.1803]]]], [[[[0.7183], [0.7852], [0.3605], [0.7759]]]], [[[[0.8057], [0.6966], [0.9966], [0.2074]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con86483').set_weights(w) 
in0LST3902 = tf.constant([[[3, 7], [6, 8]]])
print (np.array2string(model.predict([in0LST3902],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo60597.png')

LLST3902 = lstm_layer([[[3, 7], [6, 8]]],[[3, 4, 10, 4, 10, 9, 6, 8, 5, 9, 6, 3], [1, 8, 3, 4, 6, 6, 8, 1, 7, 8, 8, 6]],[[8, 2, 10, 4, 6, 7, 3, 5, 2, 7, 9, 2], [7, 10, 4, 2, 1, 3, 2, 5, 8, 4, 1, 7], [8, 3, 2, 4, 2, 9, 9, 8, 8, 10, 1, 2]],[3, 5, 8, 8, 5, 1, 5, 7, 7, 10, 4, 9], LST3902), 
LRes83905 = reshape_layer(LST3902, [3, 1], Res83905), 
LRes9582 = reshape_layer(Res83905, [3, 1, 1], Res9582), 
LRes59960 = reshape_layer(Res9582, [3, 1, 1, 1], Res59960), 
LCon86483 = conv3D_transpose_layer(Res59960, 3, 1, 1,[[[[[0.0016], [0.9455], [0.0206], [0.1803]]]], [[[[0.7183], [0.7852], [0.3605], [0.7759]]]], [[[[0.8057], [0.6966], [0.9966], [0.2074]]]]],[0, 0, 0, 0], 1, 1, 1, false, Con86483), 
LRes57837 = reshape_layer(Con86483, [5, 1, 4], Res57837), 
LRes41303 = reshape_layer(Res57837, [5, 4], Res41303), 
LGlo60597 = global_average_pooling1D_layer(Res41303, Glo60597), 
exec_layers([LLST3902,LRes83905,LRes9582,LRes59960,LCon86483,LRes57837,LRes41303,LGlo60597],["LST3902","Res83905","Res9582","Res59960","Con86483","Res57837","Res41303","Glo60597"],Glo60597,"Glo60597")

Actual (Unparsed): [[0.8824323, 1.4039905, 0.7968845, 0.6730455]]

Expected (Unparsed): [[0.8824322855774204,1.4039904868786528,0.7968844781332014,0.6730454952136119]]

Actual:   [[0.8825, 1.404, 0.7969, 0.6731]]

Expected: [[0.8825, 1.404, 0.7969, 0.6731]]