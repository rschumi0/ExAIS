import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave26822 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Ave26822 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Con13577 = tf.keras.layers.Input(shape=([2, 1, 3]))
in0Add28887 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Add28887 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in0Dot6350 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot6350 = tf.keras.layers.Input(shape=([2, 2]))

Ave26822 = keras.layers.Average(name = 'Ave26822', )([in0Ave26822,in1Ave26822])
Res86081 = keras.layers.Reshape((2, 1, 1), name = 'Res86081', )(Ave26822)
Con13577 = keras.layers.Concatenate(axis=3, name = 'Con13577', )([Res86081,in0Con13577])
Add28887 = keras.layers.Add(name = 'Add28887', )([in0Add28887,in1Add28887])
Res92006 = keras.layers.Reshape((1, 1, 4), name = 'Res92006', )(Add28887)
Dot6350 = keras.layers.Dot(axes=(1, 1), name = 'Dot6350', )([in0Dot6350,in1Dot6350])
Res50057 = keras.layers.Reshape((1, 1, 4), name = 'Res50057', )(Dot6350)
Ave95335 = keras.layers.Average(name = 'Ave95335', )([Res92006,Res50057])
Zer51280 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer51280', )(Ave95335)
Add45341 = keras.layers.Add(name = 'Add45341', )([Con13577,Zer51280])
model = tf.keras.models.Model(inputs=[in0Ave26822,in1Ave26822,in0Con13577,in0Add28887,in1Add28887,in0Dot6350,in1Dot6350], outputs=Add45341)
in0Ave26822 = tf.constant([[[[[0.5245]]], [[[0.1068]]]]])
in1Ave26822 = tf.constant([[[[[0.5921]]], [[[0.2127]]]]])
in0Con13577 = tf.constant([[[[0.134, 0.1991, 0.3875]], [[0.5897, 0.1684, 0.157]]]])
in0Add28887 = tf.constant([[[[[0.7934, 0.4424], [0.0953, 0.8197]]]]])
in1Add28887 = tf.constant([[[[[0.0603, 0.2901], [0.6648, 0.9746]]]]])
in0Dot6350 = tf.constant([[[0.938, 0.7103], [0.9018, 0.5442]]])
in1Dot6350 = tf.constant([[[0.813, 0.0558], [0.1286, 0.2213]]])
print (np.array2string(model.predict([in0Ave26822,in1Ave26822,in0Con13577,in0Add28887,in1Add28887,in0Dot6350,in1Dot6350],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add45341.png')

LAve26822 = average_layer([[[[[[0.5245]]], [[[0.1068]]]]], [[[[[0.5921]]], [[[0.2127]]]]]], Ave26822), 
LRes86081 = reshape_layer(Ave26822, [2, 1, 1], Res86081), 
LCon13577 = concatenate_layer([Res86081,[[[[0.134, 0.1991, 0.3875]], [[0.5897, 0.1684, 0.157]]]]], 3, Con13577), 
LAdd28887 = add_layer([[[[[[0.7934, 0.4424], [0.0953, 0.8197]]]]], [[[[[0.0603, 0.2901], [0.6648, 0.9746]]]]]], Add28887), 
LRes92006 = reshape_layer(Add28887, [1, 1, 4], Res92006), 
LDot6350 = dot_layer([[[0.938, 0.7103], [0.9018, 0.5442]]], [[[0.813, 0.0558], [0.1286, 0.2213]]], 1, 1, Dot6350), 
LRes50057 = reshape_layer(Dot6350, [1, 1, 4], Res50057), 
LAve95335 = average_layer([Res92006,Res50057], Ave95335), 
LZer51280 = zero_padding2D_layer(Ave95335, 1, 0, 0, 0, Zer51280), 
LAdd45341 = add_layer([Con13577,Zer51280], Add45341), 
exec_layers([LAve26822,LRes86081,LCon13577,LAdd28887,LRes92006,LDot6350,LRes50057,LAve95335,LZer51280,LAdd45341],["Ave26822","Res86081","Con13577","Add28887","Res92006","Dot6350","Res50057","Ave95335","Zer51280","Add45341"],Add45341,"Add45341")

Actual (Unparsed): [[[[0.5583000, 0.1340000, 0.1991000, 0.3875000]], [[1.0258828, 1.0819044, 0.8721790, 1.1341831]]]]

Expected (Unparsed): [[[[0.5583,0.134,0.1991,0.3875]],[[1.02588274,1.0819043700000002,0.87217901,1.1341831]]]]

Actual:   [[[[0.5583, 0.134, 0.1991, 0.3875]], [[1.0259, 1.082, 0.8722, 1.1342]]]]

Expected: [[[[0.5583, 0.134, 0.1991, 0.3875]], [[1.0259, 1.082, 0.8722, 1.1342]]]]