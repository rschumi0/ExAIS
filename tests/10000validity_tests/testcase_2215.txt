import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max67216 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con35804 = tf.keras.layers.Input(shape=([2, 2]))
in0Sub49264 = tf.keras.layers.Input(shape=([3]))
in1Sub49264 = tf.keras.layers.Input(shape=([3]))

Max67216 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max67216', )(in0Max67216)
Res37796 = keras.layers.Reshape((2, 1), name = 'Res37796', )(Max67216)
Con35804 = keras.layers.Concatenate(axis=2, name = 'Con35804', )([Res37796,in0Con35804])
Sub49264 = keras.layers.Subtract(name = 'Sub49264', )([in0Sub49264,in1Sub49264])
Res25501 = keras.layers.Reshape((3, 1), name = 'Res25501', )(Sub49264)
Per92518 = keras.layers.Permute((2,1), name = 'Per92518',)(Res25501)
Zer47735 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer47735', )(Per92518)
Min52518 = keras.layers.Minimum(name = 'Min52518', )([Con35804,Zer47735])
Sof58009 = keras.layers.Softmax(axis=1, name = 'Sof58009', )(Min52518)
model = tf.keras.models.Model(inputs=[in0Max67216,in0Con35804,in0Sub49264,in1Sub49264], outputs=Sof58009)
in0Max67216 = tf.constant([[[[1.4363]], [[1.2093]]]])
in0Con35804 = tf.constant([[[0.5199, 0.6019], [0.7766, 0.1254]]])
in0Sub49264 = tf.constant([[0.4745, 0.0262, 0.8204]])
in1Sub49264 = tf.constant([[0.2733, 0.4624, 0.2021]])
print (np.array2string(model.predict([in0Max67216,in0Con35804,in0Sub49264,in1Sub49264],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof58009.png')

LMax67216 = max_pool2D_layer([[[[1.4363]], [[1.2093]]]], 1, 1, Max67216), 
LRes37796 = reshape_layer(Max67216, [2, 1], Res37796), 
LCon35804 = concatenate_layer([Res37796,[[[0.5199, 0.6019], [0.7766, 0.1254]]]], 2, Con35804), 
LSub49264 = subtract_layer([[0.4745, 0.0262, 0.8204]], [[0.2733, 0.4624, 0.2021]], Sub49264), 
LRes25501 = reshape_layer(Sub49264, [3, 1], Res25501), 
LPer92518 = permute_layer(Res25501, 2,1, Per92518), 
LZer47735 = zero_padding1D_layer(Per92518, 1, 0, Zer47735), 
LMin52518 = minimum_layer([Con35804,Zer47735], Min52518), 
LSof58009 = softmax_layer(Min52518, 1, Sof58009), 
exec_layers([LMax67216,LRes37796,LCon35804,LSub49264,LRes25501,LPer92518,LZer47735,LMin52518,LSof58009],["Max67216","Res37796","Con35804","Sub49264","Res25501","Per92518","Zer47735","Min52518","Sof58009"],Sof58009,"Sof58009")

Actual (Unparsed): [[[0.4498690, 0.6073532, 0.4686910], [0.5501310, 0.3926468, 0.5313090]]]

Expected (Unparsed): [[[0.4498690005968698,0.6073531952574274,0.468691017481062],[0.5501309994031301,0.3926468047425726,0.531308982518938]]]

Actual:   [[[0.4499, 0.6074, 0.4687], [0.5502, 0.3927, 0.5314]]]

Expected: [[[0.4499, 0.6074, 0.4687], [0.5502, 0.3927, 0.5314]]]