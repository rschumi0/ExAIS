import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max47374 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in1Max47374 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Con37411 = tf.keras.layers.Input(shape=([2, 1]))
in0Max88299 = tf.keras.layers.Input(shape=([2, 2]))
in1Max88299 = tf.keras.layers.Input(shape=([2, 2]))
in0GRU958 = tf.keras.layers.Input(shape=([3, 2]))
in0Con67951 = tf.keras.layers.Input(shape=([3]))

Max47374 = keras.layers.Maximum(name = 'Max47374', )([in0Max47374,in1Max47374])
Res16576 = keras.layers.Reshape((1, 1, 1), name = 'Res16576', )(Max47374)
Res49312 = keras.layers.Reshape((1, 1), name = 'Res49312', )(Res16576)
Zer38708 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer38708', )(Res49312)
Con37411 = keras.layers.Concatenate(axis=2, name = 'Con37411', )([Zer38708,in0Con37411])
Max88299 = keras.layers.Maximum(name = 'Max88299', )([in0Max88299,in1Max88299])
Sub19016 = keras.layers.Subtract(name = 'Sub19016', )([Con37411,Max88299])
Fla20524 = keras.layers.Flatten(name = 'Fla20524', )(Sub19016)
GRU958 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU958', )(in0GRU958)
Res24664 = keras.layers.Reshape((2, 1), name = 'Res24664', )(GRU958)
Res85835 = keras.layers.Reshape((2, 1, 1), name = 'Res85835', )(Res24664)
Res88641 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res88641', )(Res85835)
Glo71646 = keras.layers.GlobalMaxPool3D(name = 'Glo71646', )(Res88641)
Con67951 = keras.layers.Concatenate(axis=1, name = 'Con67951', )([Glo71646,in0Con67951])
Add7007 = keras.layers.Add(name = 'Add7007', )([Fla20524,Con67951])
model = tf.keras.models.Model(inputs=[in0Max47374,in1Max47374,in0Con37411,in0Max88299,in1Max88299,in0GRU958,in0Con67951], outputs=Add7007)
w = model.get_layer('GRU958').get_weights() 
w[0] = np.array([[8, 4, 5, 6, 6, 1], [5, 5, 5, 7, 1, 9]])
w[1] = np.array([[3, 4, 2, 7, 10, 1], [1, 7, 6, 1, 1, 10]])
w[2] = np.array([[1, 5, 2, 10, 2, 7], [7, 10, 1, 8, 4, 2]])
model.get_layer('GRU958').set_weights(w) 
in0Max47374 = tf.constant([[[[[0.9539]]]]])
in1Max47374 = tf.constant([[[[[0.4913]]]]])
in0Con37411 = tf.constant([[[0.8037], [0.1242]]])
in0Max88299 = tf.constant([[[0.8256, 0.0846], [0.4571, 0.6879]]])
in1Max88299 = tf.constant([[[0.1874, 0.8668], [0.5094, 0.1387]]])
in0GRU958 = tf.constant([[[4, 2], [6, 3], [2, 6]]])
in0Con67951 = tf.constant([[0.833, 0.9228, 0.9637]])
print (np.array2string(model.predict([in0Max47374,in1Max47374,in0Con37411,in0Max88299,in1Max88299,in0GRU958,in0Con67951],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add7007.png')

LMax47374 = maximum_layer([[[[[[0.9539]]]]], [[[[[0.4913]]]]]], Max47374), 
LRes16576 = reshape_layer(Max47374, [1, 1, 1], Res16576), 
LRes49312 = reshape_layer(Res16576, [1, 1], Res49312), 
LZer38708 = zero_padding1D_layer(Res49312, 1, 0, Zer38708), 
LCon37411 = concatenate_layer([Zer38708,[[[0.8037], [0.1242]]]], 2, Con37411), 
LMax88299 = maximum_layer([[[[0.8256, 0.0846], [0.4571, 0.6879]]], [[[0.1874, 0.8668], [0.5094, 0.1387]]]], Max88299), 
LSub19016 = subtract_layer(Con37411,Max88299, Sub19016), 
LFla20524 = flatten_layer(Sub19016, Fla20524), 
LGRU958 = gru_layer([[[4, 2], [6, 3], [2, 6]]],[[8, 4, 5, 6, 6, 1], [5, 5, 5, 7, 1, 9]],[[3, 4, 2, 7, 10, 1], [1, 7, 6, 1, 1, 10]],[[1, 5, 2, 10, 2, 7], [7, 10, 1, 8, 4, 2]], true, GRU958), 
LRes24664 = reshape_layer(GRU958, [2, 1], Res24664), 
LRes85835 = reshape_layer(Res24664, [2, 1, 1], Res85835), 
LRes88641 = reshape_layer(Res85835, [2, 1, 1, 1], Res88641), 
LGlo71646 = global_max_pool3D_layer(Res88641, Glo71646), 
LCon67951 = concatenate_layer([Glo71646,[[0.833, 0.9228, 0.9637]]], 1, Con67951), 
LAdd7007 = add_layer([Fla20524,Con67951], Add7007), 
exec_layers([LMax47374,LRes16576,LRes49312,LZer38708,LCon37411,LMax88299,LSub19016,LFla20524,LGRU958,LRes24664,LRes85835,LRes88641,LGlo71646,LCon67951,LAdd7007],["Max47374","Res16576","Res49312","Zer38708","Con37411","Max88299","Sub19016","Fla20524","GRU958","Res24664","Res85835","Res88641","Glo71646","Con67951","Add7007"],Add7007,"Add7007")

Actual (Unparsed): [[-0.8256000, 0.7699000, 1.3673000, 0.4000000]]

Expected (Unparsed): [[-0.8256,0.7698999999999999,1.3673,0.4]]

Actual:   [[-0.8256, 0.7699, 1.3673, 0.4]]

Expected: [[-0.8256, 0.7699, 1.3673, 0.4]]