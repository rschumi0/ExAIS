import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul58623 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul58623 = tf.keras.layers.Input(shape=([2, 2, 1]))

Mul58623 = keras.layers.Multiply(name = 'Mul58623', )([in0Mul58623,in1Mul58623])
Res12814 = keras.layers.Reshape((2, 2), name = 'Res12814', )(Mul58623)
Glo62822 = keras.layers.GlobalMaxPool1D(name = 'Glo62822', )(Res12814)
Res54353 = keras.layers.Reshape((2, 1), name = 'Res54353', )(Glo62822)
PRe51283 = keras.layers.PReLU(name = 'PRe51283', )(Res54353)
model = tf.keras.models.Model(inputs=[in0Mul58623,in1Mul58623], outputs=PRe51283)
w = model.get_layer('PRe51283').get_weights() 
w[0] = np.array([[0.3073], [0.976]])
model.get_layer('PRe51283').set_weights(w) 
in0Mul58623 = tf.constant([[[[0.1754], [0.3456]], [[0.6795], [0.9305]]]])
in1Mul58623 = tf.constant([[[[0.2854], [0.3615]], [[0.0144], [0.2566]]]])
print (np.array2string(model.predict([in0Mul58623,in1Mul58623],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe51283.png')

LMul58623 = multiply_layer([[[[[0.1754], [0.3456]], [[0.6795], [0.9305]]]], [[[[0.2854], [0.3615]], [[0.0144], [0.2566]]]]], Mul58623), 
LRes12814 = reshape_layer(Mul58623, [2, 2], Res12814), 
LGlo62822 = global_max_pool1D_layer(Res12814, Glo62822), 
LRes54353 = reshape_layer(Glo62822, [2, 1], Res54353), 
LPRe51283 = prelu_layer(Res54353, [[0.3073], [0.976]], PRe51283), 
exec_layers([LMul58623,LRes12814,LGlo62822,LRes54353,LPRe51283],["Mul58623","Res12814","Glo62822","Res54353","PRe51283"],PRe51283,"PRe51283")

Actual (Unparsed): [[[0.0500592], [0.2387663]]]

Expected (Unparsed): [[[0.05005916],[0.2387663]]]

Actual:   [[[0.0501], [0.2388]]]

Expected: [[[0.0501], [0.2388]]]