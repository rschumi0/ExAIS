import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Lay14325 = tf.keras.layers.Input(shape=([4, 4]))
in0Up_87487 = tf.keras.layers.Input(shape=([1, 2]))
in0Con1092 = tf.keras.layers.Input(shape=([4, 2]))

Lay14325 = keras.layers.LayerNormalization(axis=2, epsilon=1.539943400866027, name = 'Lay14325', )(in0Lay14325)
Up_87487 = keras.layers.UpSampling1D(size=(1), name = 'Up_87487', )(in0Up_87487)
Zer74936 = keras.layers.ZeroPadding1D(padding=((3, 0)), name = 'Zer74936', )(Up_87487)
Con1092 = keras.layers.Concatenate(axis=2, name = 'Con1092', )([Zer74936,in0Con1092])
Add78643 = keras.layers.Add(name = 'Add78643', )([Lay14325,Con1092])
Res2005 = keras.layers.Reshape((4, 4, 1), name = 'Res2005', )(Add78643)
Sep58931 = keras.layers.SeparableConv2D(4, (3, 2),strides=(4, 4), padding='valid', name = 'Sep58931', )(Res2005)
model = tf.keras.models.Model(inputs=[in0Lay14325,in0Up_87487,in0Con1092], outputs=Sep58931)
w = model.get_layer('Sep58931').get_weights() 
w[0] = np.array([[[[0.9516]], [[0.2272]]], [[[0.0119]], [[0.7525]]], [[[0.2103]], [[0.9688]]]])
w[1] = np.array([[[[0.9923, 0.0265, 0.4688, 0.904]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep58931').set_weights(w) 
in0Lay14325 = tf.constant([[[1.4146, 1.5354, 1.462, 1.8218], [1.5122, 1.0726, 1.2935, 1.135], [1.4374, 1.6083, 1.3025, 1.2628], [1.0316, 1.189, 1.8813, 1.2752]]])
in0Up_87487 = tf.constant([[[1.729, 1.5826]]])
in0Con1092 = tf.constant([[[0.3162, 0.4414], [0.3055, 0.3444], [0.426, 0.2343], [0.0871, 0.2779]]])
print (np.array2string(model.predict([in0Lay14325,in0Up_87487,in0Con1092],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep58931.png')

LLay14325 = layer_normalization_layer([[[1.4146, 1.5354, 1.462, 1.8218], [1.5122, 1.0726, 1.2935, 1.135], [1.4374, 1.6083, 1.3025, 1.2628], [1.0316, 1.189, 1.8813, 1.2752]]], 2, 1.539943400866027, Lay14325), 
LUp_87487 = up_sampling1D_layer([[[1.729, 1.5826]]], 1, Up_87487), 
LZer74936 = zero_padding1D_layer(Up_87487, 3, 0, Zer74936), 
LCon1092 = concatenate_layer([Zer74936,[[[0.3162, 0.4414], [0.3055, 0.3444], [0.426, 0.2343], [0.0871, 0.2779]]]], 2, Con1092), 
LAdd78643 = add_layer([Lay14325,Con1092], Add78643), 
LRes2005 = reshape_layer(Add78643, [4, 4, 1], Res2005), 
LSep58931 = separable_conv2D_layer(Res2005, 3, 2,[[[[[0.9516]], [[0.2272]]], [[[0.0119]], [[0.7525]]], [[[0.2103]], [[0.9688]]]],[[[[0.9923, 0.0265, 0.4688, 0.904]]]]],[0, 0, 0, 0], 4, 4, false, Sep58931), 
exec_layers([LLay14325,LUp_87487,LZer74936,LCon1092,LAdd78643,LRes2005,LSep58931],["Lay14325","Up_87487","Zer74936","Con1092","Add78643","Res2005","Sep58931"],Sep58931,"Sep58931")

Actual (Unparsed): [[[[-0.0539469, -0.0014407, -0.0254865, -0.0491464]]]]

Expected (Unparsed): [[[[-0.05394686793131698,-0.001440685276811347,-0.025486538029024883,-0.04914639585801728]]]]

Actual:   [[[[-0.0539, -0.0014, -0.0254, -0.0491]]]]

Expected: [[[[-0.0539, -0.0014, -0.0254, -0.0491]]]]