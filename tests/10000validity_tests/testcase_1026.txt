import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mas72578 = tf.keras.layers.Input(shape=([1]))
in0Con19084 = tf.keras.layers.Input(shape=([3, 2]))
in0Dot12769 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot12769 = tf.keras.layers.Input(shape=([3, 2]))
in0Ave44978 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Ave44978 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Mas72578 = keras.layers.Masking(mask_value=1, name = 'Mas72578', )(in0Mas72578)
Res61230 = keras.layers.Reshape((1, 1), name = 'Res61230', )(Mas72578)
Zer45224 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer45224', )(Res61230)
Con19084 = keras.layers.Concatenate(axis=2, name = 'Con19084', )([Zer45224,in0Con19084])
Dot12769 = keras.layers.Dot(axes=(2, 2), name = 'Dot12769', )([in0Dot12769,in1Dot12769])
Add21563 = keras.layers.Add(name = 'Add21563', )([Con19084,Dot12769])
Res62607 = keras.layers.Reshape((3, 3, 1), name = 'Res62607', )(Add21563)
Res39234 = keras.layers.Reshape((3, 3, 1, 1), name = 'Res39234', )(Res62607)
Ave44978 = keras.layers.Average(name = 'Ave44978', )([in0Ave44978,in1Ave44978])
Zer67020 = keras.layers.ZeroPadding3D(padding=((2, 0), (1, 0), (0, 0)), name = 'Zer67020', )(Ave44978)
Mul42548 = keras.layers.Multiply(name = 'Mul42548', )([Res39234,Zer67020])
model = tf.keras.models.Model(inputs=[in0Mas72578,in0Con19084,in0Dot12769,in1Dot12769,in0Ave44978,in1Ave44978], outputs=Mul42548)
in0Mas72578 = tf.constant([[1.5644]])
in0Con19084 = tf.constant([[[0.7044, 0.388], [0.4715, 0.0927], [0.5407, 0.4132]]])
in0Dot12769 = tf.constant([[[0.9944, 0.4444], [0.2118, 0.9506], [0.0737, 0.0332]]])
in1Dot12769 = tf.constant([[[0.2456, 0.5151], [0.7087, 0.1192], [0.3614, 0.5636]]])
in0Ave44978 = tf.constant([[[[[0.0013]], [[0.3849]]]]])
in1Ave44978 = tf.constant([[[[[0.5849]], [[0.8257]]]]])
print (np.array2string(model.predict([in0Mas72578,in0Con19084,in0Dot12769,in1Dot12769,in0Ave44978,in1Ave44978],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul42548.png')

LMas72578 = masking_layer([[1.5644]], 1, Mas72578), 
LRes61230 = reshape_layer(Mas72578, [1, 1], Res61230), 
LZer45224 = zero_padding1D_layer(Res61230, 2, 0, Zer45224), 
LCon19084 = concatenate_layer([Zer45224,[[[0.7044, 0.388], [0.4715, 0.0927], [0.5407, 0.4132]]]], 2, Con19084), 
LDot12769 = dot_layer([[[0.9944, 0.4444], [0.2118, 0.9506], [0.0737, 0.0332]]], [[[0.2456, 0.5151], [0.7087, 0.1192], [0.3614, 0.5636]]], 2, 2, Dot12769), 
LAdd21563 = add_layer([Con19084,Dot12769], Add21563), 
LRes62607 = reshape_layer(Add21563, [3, 3, 1], Res62607), 
LRes39234 = reshape_layer(Res62607, [3, 3, 1, 1], Res39234), 
LAve44978 = average_layer([[[[[[0.0013]], [[0.3849]]]]], [[[[[0.5849]], [[0.8257]]]]]], Ave44978), 
LZer67020 = zero_padding3D_layer(Ave44978, 2, 0, 1, 0, 0, 0, Zer67020), 
LMul42548 = multiply_layer([Res39234,Zer67020], Mul42548), 
exec_layers([LMas72578,LRes61230,LZer45224,LCon19084,LDot12769,LAdd21563,LRes62607,LRes39234,LAve44978,LZer67020,LMul42548],["Mas72578","Res61230","Zer45224","Con19084","Dot12769","Add21563","Res62607","Res39234","Ave44978","Zer67020","Mul42548"],Mul42548,"Mul42548")

Actual (Unparsed): [[[[[0.0000000]], [[0.0000000]], [[0.0000000]]], [[[0.0000000]], [[0.0000000]], [[0.0000000]]], [[[0.0000000]], [[0.1749481]], [[0.2775583]]]]]

Expected (Unparsed): [[[[[0.0]],[[0.0]],[[0.0]]],[[[0.0]],[[0.0]],[[0.0]]],[[[0.0]],[[0.17494805745299996]],[[0.27755831751]]]]]

Actual:   [[[[[0]], [[0]], [[0]]], [[[0]], [[0]], [[0]]], [[[0]], [[0.175]], [[0.2776]]]]]

Expected: [[[[[0]], [[0]], [[0]]], [[[0]], [[0]], [[0]]], [[[0]], [[0.175]], [[0.2776]]]]]