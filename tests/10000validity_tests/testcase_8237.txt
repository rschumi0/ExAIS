import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot35512 = tf.keras.layers.Input(shape=([2]))
in1Dot35512 = tf.keras.layers.Input(shape=([2]))
in0PRe21736 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Con40906 = tf.keras.layers.Input(shape=([1, 2, 1]))

Dot35512 = keras.layers.Dot(axes=(1, 1), name = 'Dot35512', )([in0Dot35512,in1Dot35512])
Res84870 = keras.layers.Reshape((1, 1), name = 'Res84870', )(Dot35512)
Res14319 = keras.layers.Reshape((1, 1, 1), name = 'Res14319', )(Res84870)
Con8535 = keras.layers.Conv2D(3, (1, 1),strides=(8, 1), padding='valid', dilation_rate=(1, 1), name = 'Con8535', )(Res14319)
Zer93021 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer93021', )(Con8535)
PRe21736 = keras.layers.PReLU(name = 'PRe21736', input_shape=(1, 2, 2))(in0PRe21736)
Con40906 = keras.layers.Concatenate(axis=3, name = 'Con40906', )([PRe21736,in0Con40906])
Max6047 = keras.layers.Maximum(name = 'Max6047', )([Zer93021,Con40906])
model = tf.keras.models.Model(inputs=[in0Dot35512,in1Dot35512,in0PRe21736,in0Con40906], outputs=Max6047)
w = model.get_layer('Con8535').get_weights() 
w[0] = np.array([[[[0.5352, 0.3119, 0.9046]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con8535').set_weights(w) 
w = model.get_layer('PRe21736').get_weights() 
w[0] = np.array([[[0.9848, 0.7415], [0.7448, 0.8725]]])
model.get_layer('PRe21736').set_weights(w) 
in0Dot35512 = tf.constant([[0.915, 0.5582]])
in1Dot35512 = tf.constant([[0.7992, 0.468]])
in0PRe21736 = tf.constant([[[[0.8024, 0.1373], [0.815, 0.3703]]]])
in0Con40906 = tf.constant([[[[0.7947], [0.7307]]]])
print (np.array2string(model.predict([in0Dot35512,in1Dot35512,in0PRe21736,in0Con40906],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max6047.png')

LDot35512 = dot_layer([[0.915, 0.5582]], [[0.7992, 0.468]], 1, 1, Dot35512), 
LRes84870 = reshape_layer(Dot35512, [1, 1], Res84870), 
LRes14319 = reshape_layer(Res84870, [1, 1, 1], Res14319), 
LCon8535 = conv2D_layer(Res14319, 1, 1,[[[[0.5352, 0.3119, 0.9046]]]],[0, 0, 0], 8, 1, false, 1, 1, Con8535), 
LZer93021 = zero_padding2D_layer(Con8535, 0, 0, 1, 0, Zer93021), 
LPRe21736 = prelu_layer([[[[0.8024, 0.1373], [0.815, 0.3703]]]], [[[0.9848, 0.7415], [0.7448, 0.8725]]], PRe21736), 
LCon40906 = concatenate_layer([PRe21736,[[[[0.7947], [0.7307]]]]], 3, Con40906), 
LMax6047 = maximum_layer([Zer93021,Con40906], Max6047), 
exec_layers([LDot35512,LRes84870,LRes14319,LCon8535,LZer93021,LPRe21736,LCon40906,LMax6047],["Dot35512","Res84870","Res14319","Con8535","Zer93021","PRe21736","Con40906","Max6047"],Max6047,"Max6047")

Actual (Unparsed): [[[[0.8024000, 0.1373000, 0.7947000], [0.8150000, 0.3703000, 0.8978206]]]]

Expected (Unparsed): [[[[0.8024,0.1373,0.7947],[0.815,0.3703,0.89782056576]]]]

Actual:   [[[[0.8024, 0.1373, 0.7947], [0.815, 0.3703, 0.8979]]]]

Expected: [[[[0.8024, 0.1373, 0.7947], [0.815, 0.3703, 0.8979]]]]