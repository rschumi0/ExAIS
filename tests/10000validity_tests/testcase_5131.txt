import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro27954 = tf.keras.layers.Input(shape=([4, 3, 4]))
in0Glo54250 = tf.keras.layers.Input(shape=([2, 2]))

Cro27954 = keras.layers.Cropping2D(cropping=((0, 3), (2, 0)), name = 'Cro27954', )(in0Cro27954)
Con23202 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con23202', )(Cro27954)
Res510 = keras.layers.Reshape((1, 1, 4, 1), name = 'Res510', )(Con23202)
Zer12270 = keras.layers.ZeroPadding3D(padding=((3, 0), (2, 0), (1, 0)), name = 'Zer12270', )(Res510)
Glo54250 = keras.layers.GlobalAveragePooling1D(name = 'Glo54250', )(in0Glo54250)
Res20899 = keras.layers.Reshape((2, 1), name = 'Res20899', )(Glo54250)
Res55564 = keras.layers.Reshape((2, 1, 1), name = 'Res55564', )(Res20899)
Res28825 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res28825', )(Res55564)
Zer65293 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer65293', )(Res28825)
Zer88204 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer88204', )(Zer65293)
Add41886 = keras.layers.Add(name = 'Add41886', )([Zer12270,Zer88204])
Glo10263 = keras.layers.GlobalMaxPool3D(name = 'Glo10263', )(Add41886)
model = tf.keras.models.Model(inputs=[in0Cro27954,in0Glo54250], outputs=Glo10263)
w = model.get_layer('Con23202').get_weights() 
w[0] = np.array([[[[0.9392, 0.6652, 0.5064, 0.571], [0.0288, 0.0823, 0.6184, 0.6051], [0.7568, 0.2458, 0.3584, 0.0049], [0.378, 0.5315, 0.2502, 0.1103]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con23202').set_weights(w) 
in0Cro27954 = tf.constant([[[[1.5427, 1.405, 1.8703, 1.3555], [1.3183, 1.168, 1.8971, 1.9274], [1.5941, 1.4422, 1.1875, 1.5296]], [[1.3818, 1.4594, 1.8813, 1.5036], [1.2103, 1.1111, 1.1252, 1.2139], [1.1089, 1.3473, 1.2662, 1.3333]], [[1.6166, 1.1651, 1.2963, 1.809], [1.1007, 1.9803, 1.5174, 1.5822], [1.3932, 1.6588, 1.4494, 1.0772]], [[1.3801, 1.1186, 1.4596, 1.06], [1.7193, 1.2095, 1.4573, 1.7174], [1.3001, 1.529, 1.2684, 1.7092]]]])
in0Glo54250 = tf.constant([[[1.4112, 1.9353], [1.9798, 1.506]]])
print (np.array2string(model.predict([in0Cro27954,in0Glo54250],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo10263.png')

LCro27954 = cropping2D_layer([[[[1.5427, 1.405, 1.8703, 1.3555], [1.3183, 1.168, 1.8971, 1.9274], [1.5941, 1.4422, 1.1875, 1.5296]], [[1.3818, 1.4594, 1.8813, 1.5036], [1.2103, 1.1111, 1.1252, 1.2139], [1.1089, 1.3473, 1.2662, 1.3333]], [[1.6166, 1.1651, 1.2963, 1.809], [1.1007, 1.9803, 1.5174, 1.5822], [1.3932, 1.6588, 1.4494, 1.0772]], [[1.3801, 1.1186, 1.4596, 1.06], [1.7193, 1.2095, 1.4573, 1.7174], [1.3001, 1.529, 1.2684, 1.7092]]]], 0, 3, 2, 0, Cro27954), 
LCon23202 = conv2D_layer(Cro27954, 1, 1,[[[[0.9392, 0.6652, 0.5064, 0.571], [0.0288, 0.0823, 0.6184, 0.6051], [0.7568, 0.2458, 0.3584, 0.0049], [0.378, 0.5315, 0.2502, 0.1103]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con23202), 
LRes510 = reshape_layer(Con23202, [1, 1, 4, 1], Res510), 
LZer12270 = zero_padding3D_layer(Res510, 3, 0, 2, 0, 1, 0, Zer12270), 
LGlo54250 = global_average_pooling1D_layer([[[1.4112, 1.9353], [1.9798, 1.506]]], Glo54250), 
LRes20899 = reshape_layer(Glo54250, [2, 1], Res20899), 
LRes55564 = reshape_layer(Res20899, [2, 1, 1], Res55564), 
LRes28825 = reshape_layer(Res55564, [2, 1, 1, 1], Res28825), 
LZer65293 = zero_padding3D_layer(Res28825, 1, 1, 1, 1, 1, 1, Zer65293), 
LZer88204 = zero_padding3D_layer(Zer65293, 0, 0, 0, 0, 2, 0, Zer88204), 
LAdd41886 = add_layer([Zer12270,Zer88204], Add41886), 
LGlo10263 = global_max_pool3D_layer(Add41886, Glo10263), 
exec_layers([LCro27954,LCon23202,LRes510,LZer12270,LGlo54250,LRes20899,LRes55564,LRes28825,LZer65293,LZer88204,LAdd41886,LGlo10263],["Cro27954","Con23202","Res510","Zer12270","Glo54250","Res20899","Res55564","Res28825","Zer65293","Zer88204","Add41886","Glo10263"],Glo10263,"Glo10263")

Actual (Unparsed): [[3.0156029]]

Expected (Unparsed): [[3.01560288]]

Actual:   [[3.0157]]

Expected: [[3.0157]]