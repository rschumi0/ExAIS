import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul74395 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Mul74395 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Ave67362 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Ave67362 = tf.keras.layers.Input(shape=([1, 2, 2]))

Mul74395 = keras.layers.Multiply(name = 'Mul74395', )([in0Mul74395,in1Mul74395])
Mas1204 = keras.layers.Masking(mask_value=1, name = 'Mas1204', )(Mul74395)
Res75973 = keras.layers.Reshape((2, 2, 2), name = 'Res75973', )(Mas1204)
Ave67362 = keras.layers.Average(name = 'Ave67362', )([in0Ave67362,in1Ave67362])
Zer87295 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer87295', )(Ave67362)
Sub63339 = keras.layers.Subtract(name = 'Sub63339', )([Res75973,Zer87295])
Up_13018 = keras.layers.UpSampling2D(size=(1, 1), name = 'Up_13018', )(Sub63339)
model = tf.keras.models.Model(inputs=[in0Mul74395,in1Mul74395,in0Ave67362,in1Ave67362], outputs=Up_13018)
in0Mul74395 = tf.constant([[[[[0.9882], [0.3902]], [[0.0495], [0.609]]], [[[0.5926], [0.8764]], [[0.8343], [0.0628]]]]])
in1Mul74395 = tf.constant([[[[[0.6683], [0.0548]], [[0.4097], [0.6295]]], [[[0.8982], [0.7408]], [[0.8988], [0.7098]]]]])
in0Ave67362 = tf.constant([[[[0.345, 0.887], [0.4572, 0.9872]]]])
in1Ave67362 = tf.constant([[[[0.6993, 0.3531], [0.111, 0.9786]]]])
print (np.array2string(model.predict([in0Mul74395,in1Mul74395,in0Ave67362,in1Ave67362],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_13018.png')

LMul74395 = multiply_layer([[[[[[0.9882], [0.3902]], [[0.0495], [0.609]]], [[[0.5926], [0.8764]], [[0.8343], [0.0628]]]]], [[[[[0.6683], [0.0548]], [[0.4097], [0.6295]]], [[[0.8982], [0.7408]], [[0.8988], [0.7098]]]]]], Mul74395), 
LMas1204 = masking_layer(Mul74395, 1, Mas1204), 
LRes75973 = reshape_layer(Mas1204, [2, 2, 2], Res75973), 
LAve67362 = average_layer([[[[[0.345, 0.887], [0.4572, 0.9872]]]], [[[[0.6993, 0.3531], [0.111, 0.9786]]]]], Ave67362), 
LZer87295 = zero_padding2D_layer(Ave67362, 1, 0, 0, 0, Zer87295), 
LSub63339 = subtract_layer(Res75973,Zer87295, Sub63339), 
LUp_13018 = up_sampling2D_layer(Sub63339, 1, 1, Up_13018), 
exec_layers([LMul74395,LMas1204,LRes75973,LAve67362,LZer87295,LSub63339,LUp_13018],["Mul74395","Mas1204","Res75973","Ave67362","Zer87295","Sub63339","Up_13018"],Up_13018,"Up_13018")

Actual (Unparsed): [[[[0.6604140, 0.0213830], [0.0202802, 0.3833655]], [[0.0101233, 0.0291871], [0.4657688, -0.9383246]]]]

Expected (Unparsed): [[[[0.66041406,0.02138296],[0.02028015,0.38336549999999997]],[[0.010123320000000047,0.02918712000000001],[0.4657688400000001,-0.93832456]]]]

Actual:   [[[[0.6605, 0.0214], [0.0203, 0.3834]], [[0.0102, 0.0292], [0.4658, -0.9383]]]]

Expected: [[[[0.6605, 0.0214], [0.0203, 0.3834]], [[0.0102, 0.0292], [0.4658, -0.9383]]]]