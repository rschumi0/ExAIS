import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro46124 = tf.keras.layers.Input(shape=([2, 2, 3, 1]))
in0Mul61491 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul61491 = tf.keras.layers.Input(shape=([1, 1, 2]))

Cro46124 = keras.layers.Cropping3D(cropping=((0, 0), (0, 1), (2, 0)), name = 'Cro46124', )(in0Cro46124)
Zer52551 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer52551', )(Cro46124)
Mul61491 = keras.layers.Multiply(name = 'Mul61491', )([in0Mul61491,in1Mul61491])
Res39295 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res39295', )(Mul61491)
Cro31689 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro31689', )(Res39295)
Zer57335 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer57335', )(Cro31689)
Sub98315 = keras.layers.Subtract(name = 'Sub98315', )([Zer52551,Zer57335])
Res9174 = keras.layers.Reshape((2, 1, 3), name = 'Res9174', )(Sub98315)
Res96945 = keras.layers.Reshape((2, 3), name = 'Res96945', )(Res9174)
Sim26576 = keras.layers.SimpleRNN(3,name = 'Sim26576', )(Res96945)
model = tf.keras.models.Model(inputs=[in0Cro46124,in0Mul61491,in1Mul61491], outputs=Sim26576)
w = model.get_layer('Sim26576').get_weights() 
w[0] = np.array([[4, 7, 2], [10, 5, 8], [5, 7, 7]])
w[1] = np.array([[5, 8, 2], [6, 7, 9], [6, 10, 5]])
w[2] = np.array([4, 10, 9])
model.get_layer('Sim26576').set_weights(w) 
in0Cro46124 = tf.constant([[[[[1.9024], [1.1149], [1.7099]], [[1.9786], [1.3639], [1.4314]]], [[[1.9468], [1.8279], [1.3719]], [[1.837], [1.123], [1.5263]]]]])
in0Mul61491 = tf.constant([[[[0.1015, 0.3328]]]])
in1Mul61491 = tf.constant([[[[0.0422, 0.0452]]]])
print (np.array2string(model.predict([in0Cro46124,in0Mul61491,in1Mul61491],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim26576.png')

LCro46124 = cropping3D_layer([[[[[1.9024], [1.1149], [1.7099]], [[1.9786], [1.3639], [1.4314]]], [[[1.9468], [1.8279], [1.3719]], [[1.837], [1.123], [1.5263]]]]], 0, 0, 0, 1, 2, 0, Cro46124), 
LZer52551 = zero_padding3D_layer(Cro46124, 0, 0, 0, 0, 2, 0, Zer52551), 
LMul61491 = multiply_layer([[[[[0.1015, 0.3328]]]], [[[[0.0422, 0.0452]]]]], Mul61491), 
LRes39295 = reshape_layer(Mul61491, [1, 1, 2, 1], Res39295), 
LCro31689 = cropping3D_layer(Res39295, 0, 0, 0, 0, 0, 0, Cro31689), 
LZer57335 = zero_padding3D_layer(Cro31689, 1, 0, 0, 0, 1, 0, Zer57335), 
LSub98315 = subtract_layer(Zer52551,Zer57335, Sub98315), 
LRes9174 = reshape_layer(Sub98315, [2, 1, 3], Res9174), 
LRes96945 = reshape_layer(Res9174, [2, 3], Res96945), 
LSim26576 = simple_rnn_layer(Res96945,[[4, 7, 2], [10, 5, 8], [5, 7, 7]],[[5, 8, 2], [6, 7, 9], [6, 10, 5]],[4, 10, 9], Sim26576), 
exec_layers([LCro46124,LZer52551,LMul61491,LRes39295,LCro31689,LZer57335,LSub98315,LRes9174,LRes96945,LSim26576],["Cro46124","Zer52551","Mul61491","Res39295","Cro31689","Zer57335","Sub98315","Res9174","Res96945","Sim26576"],Sim26576,"Sim26576")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[1.0,1.0,1.0]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]