import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Fla12831 = tf.keras.layers.Input(shape=([4, 4, 1]))
in0Min61041 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Min61041 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Fla12831 = keras.layers.Flatten(name = 'Fla12831', )(in0Fla12831)
Res48872 = keras.layers.Reshape((16, 1), name = 'Res48872', )(Fla12831)
Res71353 = keras.layers.Reshape((16, 1, 1), name = 'Res71353', )(Res48872)
Res21024 = keras.layers.Reshape((16, 1, 1, 1), name = 'Res21024', )(Res71353)
Zer36917 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer36917', )(Res21024)
Min61041 = keras.layers.Minimum(name = 'Min61041', )([in0Min61041,in1Min61041])
Zer31962 = keras.layers.ZeroPadding3D(padding=((15, 0), (0, 0), (1, 0)), name = 'Zer31962', )(Min61041)
Mul92228 = keras.layers.Multiply(name = 'Mul92228', )([Zer36917,Zer31962])
Glo29515 = keras.layers.GlobalAveragePooling3D(name = 'Glo29515', )(Mul92228)
Res96790 = keras.layers.Reshape((1, 1), name = 'Res96790', )(Glo29515)
Res73638 = keras.layers.Reshape((1, 1, 1), name = 'Res73638', )(Res96790)
Res51395 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res51395', )(Res73638)
Zer65211 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer65211', )(Res51395)
model = tf.keras.models.Model(inputs=[in0Fla12831,in0Min61041,in1Min61041], outputs=Zer65211)
in0Fla12831 = tf.constant([[[[1.5795], [1.8266], [1.1299], [1.9]], [[1.3454], [1.0554], [1.6961], [1.5917]], [[1.9342], [1.6583], [1.2248], [1.1839]], [[1.9273], [1.1482], [1.7102], [1.684]]]])
in0Min61041 = tf.constant([[[[[0.3624], [0.6455]]]]])
in1Min61041 = tf.constant([[[[[0.6899], [0.6973]]]]])
print (np.array2string(model.predict([in0Fla12831,in0Min61041,in1Min61041],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer65211.png')

LFla12831 = flatten_layer([[[[1.5795], [1.8266], [1.1299], [1.9]], [[1.3454], [1.0554], [1.6961], [1.5917]], [[1.9342], [1.6583], [1.2248], [1.1839]], [[1.9273], [1.1482], [1.7102], [1.684]]]], Fla12831), 
LRes48872 = reshape_layer(Fla12831, [16, 1], Res48872), 
LRes71353 = reshape_layer(Res48872, [16, 1, 1], Res71353), 
LRes21024 = reshape_layer(Res71353, [16, 1, 1, 1], Res21024), 
LZer36917 = zero_padding3D_layer(Res21024, 0, 0, 0, 0, 2, 0, Zer36917), 
LMin61041 = minimum_layer([[[[[[0.3624], [0.6455]]]]], [[[[[0.6899], [0.6973]]]]]], Min61041), 
LZer31962 = zero_padding3D_layer(Min61041, 15, 0, 0, 0, 1, 0, Zer31962), 
LMul92228 = multiply_layer([Zer36917,Zer31962], Mul92228), 
LGlo29515 = global_average_pooling3D_layer(Mul92228, Glo29515), 
LRes96790 = reshape_layer(Glo29515, [1, 1], Res96790), 
LRes73638 = reshape_layer(Res96790, [1, 1, 1], Res73638), 
LRes51395 = reshape_layer(Res73638, [1, 1, 1, 1], Res51395), 
LZer65211 = zero_padding3D_layer(Res51395, 1, 1, 1, 1, 1, 1, Zer65211), 
exec_layers([LFla12831,LRes48872,LRes71353,LRes21024,LZer36917,LMin61041,LZer31962,LMul92228,LGlo29515,LRes96790,LRes73638,LRes51395,LZer65211],["Fla12831","Res48872","Res71353","Res21024","Zer36917","Min61041","Zer31962","Mul92228","Glo29515","Res96790","Res73638","Res51395","Zer65211"],Zer65211,"Zer65211")

Actual (Unparsed): [[[[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0226463], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]], [[[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000]]]]]

Expected (Unparsed): [[[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0.022646291666666665],[0]],[[0],[0],[0]]],[[[0],[0],[0]],[[0],[0],[0]],[[0],[0],[0]]]]]

Actual:   [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.0227], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]

Expected: [[[[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0.0227], [0]], [[0], [0], [0]]], [[[0], [0], [0]], [[0], [0], [0]], [[0], [0], [0]]]]]