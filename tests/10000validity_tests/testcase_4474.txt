import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per73954 = tf.keras.layers.Input(shape=([4, 4]))

Per73954 = keras.layers.Permute((2,1), name = 'Per73954',)(in0Per73954)
Res95523 = keras.layers.Reshape((4, 4, 1), name = 'Res95523', )(Per73954)
Con10499 = keras.layers.Conv2D(4, (1, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con10499', )(Res95523)
model = tf.keras.models.Model(inputs=[in0Per73954], outputs=Con10499)
w = model.get_layer('Con10499').get_weights() 
w[0] = np.array([[[[0.5791, 0.0388, 0.9035, 0.7028]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con10499').set_weights(w) 
in0Per73954 = tf.constant([[[1.9055, 1.7048, 1.7038, 1.4452], [1.1853, 1.3819, 1.4059, 1.3903], [1.4105, 1.2214, 1.5649, 1.1609], [1.0627, 1.7318, 1.8098, 1.3349]]])
print (np.array2string(model.predict([in0Per73954],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con10499.png')

LPer73954 = permute_layer([[[1.9055, 1.7048, 1.7038, 1.4452], [1.1853, 1.3819, 1.4059, 1.3903], [1.4105, 1.2214, 1.5649, 1.1609], [1.0627, 1.7318, 1.8098, 1.3349]]], 2,1, Per73954), 
LRes95523 = reshape_layer(Per73954, [4, 4, 1], Res95523), 
LCon10499 = conv2D_layer(Res95523, 1, 1,[[[[0.5791, 0.0388, 0.9035, 0.7028]]]],[0, 0, 0, 0], 1, 1, false, 1, 1, Con10499), 
exec_layers([LPer73954,LRes95523,LCon10499],["Per73954","Res95523","Con10499"],Con10499,"Con10499")

Actual (Unparsed): [[[[1.1034751, 0.0739334, 1.7216193, 1.3391854], [0.6864072, 0.0459896, 1.0709185, 0.8330288], [0.8168206, 0.0547274, 1.2743868, 0.9912994], [0.6154096, 0.0412328, 0.9601495, 0.7468656]], [[0.9872497, 0.0661462, 1.5402868, 1.1981334], [0.8002583, 0.0536177, 1.2485466, 0.9711993], [0.7073128, 0.0473903, 1.1035349, 0.8583999], [1.0028854, 0.0671938, 1.5646813, 1.2171090]], [[0.9866706, 0.0661074, 1.5393833, 1.1974306], [0.8141567, 0.0545489, 1.2702307, 0.9880665], [0.9062336, 0.0607181, 1.4138872, 1.0998117], [1.0480552, 0.0702202, 1.6351543, 1.2719275]], [[0.8369153, 0.0560738, 1.3057382, 1.0156865], [0.8051228, 0.0539436, 1.2561361, 0.9771029], [0.6722772, 0.0450429, 1.0488731, 0.8158805], [0.7730406, 0.0517941, 1.2060822, 0.9381677]]]]

Expected (Unparsed): [[[[1.10347505,0.0739334,1.7216192499999998,1.3391853999999999],[0.6864072299999999,0.045989640000000005,1.07091855,0.83302884],[0.81682055,0.0547274,1.2743867500000001,0.9912994],[0.61540957,0.04123276,0.96014945,0.7468655599999999]],[[0.98724968,0.06614624000000001,1.5402868,1.19813344],[0.8002582899999999,0.05361772,1.24854665,0.9711993199999999],[0.70731274,0.04739032,1.1035349,0.85839992],[1.00288538,0.06719384,1.5646813,1.21710904]],[[0.9866705799999999,0.06610744,1.5393833,1.1974306399999999],[0.8141566899999999,0.05454892,1.2702306499999998,0.98806652],[0.9062335899999999,0.06071812,1.4138871499999999,1.09981172],[1.04805518,0.07022024,1.6351543,1.27192744]],[[0.8369153199999999,0.05607376,1.3057382,1.01568656],[0.80512273,0.05394364000000001,1.25613605,0.97710284],[0.67227719,0.04504292,1.04887315,0.81588052],[0.7730405899999999,0.05179412,1.2060821499999999,0.9381677199999999]]]]

Actual:   [[[[1.1035, 0.074, 1.7217, 1.3392], [0.6865, 0.046, 1.071, 0.8331], [0.8169, 0.0548, 1.2744, 0.9913], [0.6155, 0.0413, 0.9602, 0.7469]], [[0.9873, 0.0662, 1.5403, 1.1982], [0.8003, 0.0537, 1.2486, 0.9712], [0.7074, 0.0474, 1.1036, 0.8584], [1.0029, 0.0672, 1.5647, 1.2172]], [[0.9867, 0.0662, 1.5394, 1.1975], [0.8142, 0.0546, 1.2703, 0.9881], [0.9063, 0.0608, 1.4139, 1.0999], [1.0481, 0.0703, 1.6352, 1.272]], [[0.837, 0.0561, 1.3058, 1.0157], [0.8052, 0.054, 1.2562, 0.9772], [0.6723, 0.0451, 1.0489, 0.8159], [0.7731, 0.0518, 1.2061, 0.9382]]]]

Expected: [[[[1.1035, 0.074, 1.7217, 1.3392], [0.6865, 0.046, 1.071, 0.8331], [0.8169, 0.0548, 1.2744, 0.9913], [0.6155, 0.0413, 0.9602, 0.7469]], [[0.9873, 0.0662, 1.5403, 1.1982], [0.8003, 0.0537, 1.2486, 0.9712], [0.7074, 0.0474, 1.1036, 0.8584], [1.0029, 0.0672, 1.5647, 1.2172]], [[0.9867, 0.0662, 1.5394, 1.1975], [0.8142, 0.0546, 1.2703, 0.9881], [0.9063, 0.0608, 1.4139, 1.0999], [1.0481, 0.0703, 1.6352, 1.272]], [[0.837, 0.0561, 1.3058, 1.0157], [0.8052, 0.054, 1.2562, 0.9772], [0.6723, 0.0451, 1.0489, 0.8159], [0.7731, 0.0518, 1.2061, 0.9382]]]]