import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo46512 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Mul24839 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul24839 = tf.keras.layers.Input(shape=([2, 2, 1]))

Glo46512 = keras.layers.GlobalMaxPool2D(name = 'Glo46512', )(in0Glo46512)
ELU17096 = keras.layers.ELU(alpha=6.095931632170874, name = 'ELU17096', )(Glo46512)
Res18547 = keras.layers.Reshape((2, 1), name = 'Res18547', )(ELU17096)
Res74962 = keras.layers.Reshape((2, 1, 1), name = 'Res74962', )(Res18547)
Zer90151 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer90151', )(Res74962)
Mul24839 = keras.layers.Multiply(name = 'Mul24839', )([in0Mul24839,in1Mul24839])
Den91259 = keras.layers.Dense(1,name = 'Den91259', )(Mul24839)
Add57555 = keras.layers.Add(name = 'Add57555', )([Zer90151,Den91259])
Zer21352 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer21352', )(Add57555)
model = tf.keras.models.Model(inputs=[in0Glo46512,in0Mul24839,in1Mul24839], outputs=Zer21352)
w = model.get_layer('Den91259').get_weights() 
w[0] = np.array([[0.1725]])
w[1] = np.array([0.9965])
model.get_layer('Den91259').set_weights(w) 
in0Glo46512 = tf.constant([[[[1.9673, 1.0035]]]])
in0Mul24839 = tf.constant([[[[0.9876], [0.4226]], [[0.7641], [0.9175]]]])
in1Mul24839 = tf.constant([[[[0.4339], [0.5752]], [[0.7472], [0.4279]]]])
print (np.array2string(model.predict([in0Glo46512,in0Mul24839,in1Mul24839],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Zer21352.png')

LGlo46512 = global_max_pool2D_layer([[[[1.9673, 1.0035]]]], Glo46512), 
LELU17096 = elu_layer(Glo46512, 6.095931632170874, ELU17096), 
LRes18547 = reshape_layer(ELU17096, [2, 1], Res18547), 
LRes74962 = reshape_layer(Res18547, [2, 1, 1], Res74962), 
LZer90151 = zero_padding2D_layer(Res74962, 0, 0, 1, 0, Zer90151), 
LMul24839 = multiply_layer([[[[[0.9876], [0.4226]], [[0.7641], [0.9175]]]], [[[[0.4339], [0.5752]], [[0.7472], [0.4279]]]]], Mul24839), 
LDen91259 = dense_layer(Mul24839, [[0.1725]],[0.9965], Den91259), 
LAdd57555 = add_layer([Zer90151,Den91259], Add57555), 
LZer21352 = zero_padding2D_layer(Add57555, 1, 1, 1, 1, Zer21352), 
exec_layers([LGlo46512,LELU17096,LRes18547,LRes74962,LZer90151,LMul24839,LDen91259,LAdd57555,LZer21352],["Glo46512","ELU17096","Res18547","Res74962","Zer90151","Mul24839","Den91259","Add57555","Zer21352"],Zer21352,"Zer21352")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [1.0704196], [3.0057313], [0.0000000]], [[0.0000000], [1.0949864], [2.0677232], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[1.0704196379000002],[3.0057312172],[0]],[[0],[1.0949863772000001],[2.067723198125],[0]],[[0],[0],[0],[0]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [1.0705], [3.0058], [0]], [[0], [1.095], [2.0678], [0]], [[0], [0], [0], [0]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [1.0705], [3.0058], [0]], [[0], [1.095], [2.0678], [0]], [[0], [0], [0], [0]]]]