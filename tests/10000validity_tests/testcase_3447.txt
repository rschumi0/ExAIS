import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max63223 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Max63223 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Max63223 = keras.layers.Maximum(name = 'Max63223', )([in0Max63223,in1Max63223])
PRe22493 = keras.layers.PReLU(name = 'PRe22493', )(Max63223)
Res53818 = keras.layers.Reshape((2, 2, 2), name = 'Res53818', )(PRe22493)
Res65395 = keras.layers.Reshape((2, 4), name = 'Res65395', )(Res53818)
Cro70053 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro70053', )(Res65395)
model = tf.keras.models.Model(inputs=[in0Max63223,in1Max63223], outputs=Cro70053)
w = model.get_layer('PRe22493').get_weights() 
w[0] = np.array([[[[0.2858], [0.4936]], [[0.3376], [0.8099]]], [[[0.551], [0.2587]], [[0.7872], [0.0585]]]])
model.get_layer('PRe22493').set_weights(w) 
in0Max63223 = tf.constant([[[[[0.7508], [0.4432]], [[0.4048], [0.6153]]], [[[0.2994], [0.7762]], [[0.4089], [0.9462]]]]])
in1Max63223 = tf.constant([[[[[0.3133], [0.0787]], [[0.3807], [0.3092]]], [[[0.2615], [0.3499]], [[0.0258], [0.5466]]]]])
print (np.array2string(model.predict([in0Max63223,in1Max63223],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro70053.png')

LMax63223 = maximum_layer([[[[[[0.7508], [0.4432]], [[0.4048], [0.6153]]], [[[0.2994], [0.7762]], [[0.4089], [0.9462]]]]], [[[[[0.3133], [0.0787]], [[0.3807], [0.3092]]], [[[0.2615], [0.3499]], [[0.0258], [0.5466]]]]]], Max63223), 
LPRe22493 = prelu_layer(Max63223, [[[[0.2858], [0.4936]], [[0.3376], [0.8099]]], [[[0.551], [0.2587]], [[0.7872], [0.0585]]]], PRe22493), 
LRes53818 = reshape_layer(PRe22493, [2, 2, 2], Res53818), 
LRes65395 = reshape_layer(Res53818, [2, 4], Res65395), 
LCro70053 = cropping1D_layer(Res65395, 0, 0, Cro70053), 
exec_layers([LMax63223,LPRe22493,LRes53818,LRes65395,LCro70053],["Max63223","PRe22493","Res53818","Res65395","Cro70053"],Cro70053,"Cro70053")

Actual (Unparsed): [[[0.7508000, 0.4432000, 0.4048000, 0.6153000], [0.2994000, 0.7762000, 0.4089000, 0.9462000]]]

Expected (Unparsed): [[[0.7508,0.4432,0.4048,0.6153],[0.2994,0.7762,0.4089,0.9462]]]

Actual:   [[[0.7508, 0.4432, 0.4048, 0.6153], [0.2994, 0.7762, 0.4089, 0.9462]]]

Expected: [[[0.7508, 0.4432, 0.4048, 0.6153], [0.2994, 0.7762, 0.4089, 0.9462]]]