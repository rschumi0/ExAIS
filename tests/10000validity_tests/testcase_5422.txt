import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max86554 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Max86554 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con57379 = tf.keras.layers.Input(shape=([1, 2, 4, 1]))
in0Ave21302 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Ave21302 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Sub97559 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))
in1Sub97559 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))
in0Con49787 = tf.keras.layers.Input(shape=([1, 12]))

Max86554 = keras.layers.Maximum(name = 'Max86554', )([in0Max86554,in1Max86554])
ReL10787 = keras.layers.ReLU(max_value=1.90816911946371, negative_slope=1.7046026225342121, threshold=8.151671084294204, name = 'ReL10787', )(Max86554)
Res37317 = keras.layers.Reshape((1, 1, 2), name = 'Res37317', )(ReL10787)
Loc47444 = keras.layers.LocallyConnected2D(3, (1, 1),strides=(1, 1), name = 'Loc47444', )(Res37317)
Lay18905 = keras.layers.LayerNormalization(axis=1, epsilon=1.1426154335519019, name = 'Lay18905', )(Loc47444)
Res2630 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res2630', )(Lay18905)
Zer68587 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (1, 0)), name = 'Zer68587', )(Res2630)
Con57379 = keras.layers.Concatenate(axis=4, name = 'Con57379', )([Zer68587,in0Con57379])
Ave21302 = keras.layers.Average(name = 'Ave21302', )([in0Ave21302,in1Ave21302])
Con61389 = keras.layers.Conv3DTranspose(2, (1, 1, 1),strides=(1, 1, 1), padding='valid', name = 'Con61389', )(Ave21302)
Zer75431 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer75431', )(Con61389)
Add54594 = keras.layers.Add(name = 'Add54594', )([Con57379,Zer75431])
Res99618 = keras.layers.Reshape((1, 2, 8), name = 'Res99618', )(Add54594)
Res66230 = keras.layers.Reshape((1, 16), name = 'Res66230', )(Res99618)
Sub97559 = keras.layers.Subtract(name = 'Sub97559', )([in0Sub97559,in1Sub97559])
Res18726 = keras.layers.Reshape((3, 2, 6), name = 'Res18726', )(Sub97559)
Res31358 = keras.layers.Reshape((3, 12), name = 'Res31358', )(Res18726)
Con56135 = keras.layers.Conv1D(4, (2),strides=(10), padding='valid', dilation_rate=(1), name = 'Con56135', )(Res31358)
Con49787 = keras.layers.Concatenate(axis=2, name = 'Con49787', )([Con56135,in0Con49787])
Max16281 = keras.layers.Maximum(name = 'Max16281', )([Res66230,Con49787])
model = tf.keras.models.Model(inputs=[in0Max86554,in1Max86554,in0Con57379,in0Ave21302,in1Ave21302,in0Sub97559,in1Sub97559,in0Con49787], outputs=Max16281)
w = model.get_layer('Loc47444').get_weights() 
w[0] = np.array([[[0.2381, 0.0487, 0.5375], [0.0445, 0.7919, 0.6276]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc47444').set_weights(w) 
w = model.get_layer('Con61389').get_weights() 
w[0] = np.array([[[[[0.2668], [0.0144]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con61389').set_weights(w) 
w = model.get_layer('Con56135').get_weights() 
w[0] = np.array([[[0.9496, 0.3629, 0.083, 0.0953], [0.6269, 0.9344, 0.1966, 0.9156], [0.8509, 0.6104, 0.3628, 0.652], [0.3729, 0.5012, 0.7242, 0.0248], [0.4303, 0.9268, 0.2071, 0.4565], [0.5913, 0.1373, 0.4028, 0.3466], [0.6405, 0.3352, 0.0026, 0.9537], [0.7224, 0.7579, 0.6198, 0.9573], [0.4809, 0.555, 0.5629, 0.0717], [0.1226, 0.0744, 0.011, 0.7925], [0.1701, 0.9561, 0.0873, 0.4718], [0.1686, 0.1269, 0.5283, 0.4376]], [[0.7642, 0.3858, 0.9983, 0.7995], [0.3792, 0.7769, 0.6167, 0.9162], [0.1781, 0.3558, 0.9307, 0.2402], [0.1381, 0.2737, 0.3939, 0.3994], [0.8174, 0.3283, 0.3897, 0.9275], [0.8487, 0.2572, 0.9797, 0.0138], [0.2767, 0.0897, 0.8484, 0.0064], [0.6036, 0.8116, 0.367, 0.1729], [0.8133, 0.4492, 0.3046, 0.4021], [0.7005, 0.4315, 0.4805, 0.1082], [0.5511, 0.7515, 0.565, 0.5949], [0.5869, 0.0157, 0.3177, 0.5254]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con56135').set_weights(w) 
in0Max86554 = tf.constant([[[[[0.2637, 0.877]]]]])
in1Max86554 = tf.constant([[[[[0.9469, 0.4265]]]]])
in0Con57379 = tf.constant([[[[[0.0354], [0.2873], [0.0802], [0.9126]], [[0.8276], [0.8443], [0.6652], [0.3902]]]]])
in0Ave21302 = tf.constant([[[[[0.2472], [0.9416]], [[0.2716], [0.06]]]]])
in1Ave21302 = tf.constant([[[[[0.1723], [0.8705]], [[0.284], [0.204]]]]])
in0Sub97559 = tf.constant([[[[[0.3937, 0.2631], [0.414, 0.1374], [0.7996, 0.2569]], [[0.6504, 0.8803], [0.487, 0.6868], [0.6266, 0.9881]]], [[[0.1165, 0.9313], [0.5237, 0.8856], [0.0219, 0.4748]], [[0.1559, 0.0156], [0.1692, 0.4624], [0.6316, 0.9593]]], [[[0.3563, 0.2945], [0.798, 0.6019], [0.6237, 0.6168]], [[0.2743, 0.3608], [0.7069, 0.8962], [0.2498, 0.4758]]]]])
in1Sub97559 = tf.constant([[[[[0.503, 0.1434], [0.3857, 0.3638], [0.9475, 0.2399]], [[0.0928, 0.0856], [0.3995, 0.7601], [0.1819, 0.0403]]], [[[0.6208, 0.1392], [0.3805, 0.1067], [0.7004, 0.533]], [[0.494, 0.5861], [0.8229, 0.7368], [0.0533, 0.462]]], [[[0.6096, 0.0906], [0.1331, 0.6939], [0.871, 0.3798]], [[0.6538, 0.485], [0.001, 0.3637], [0.886, 0.7257]]]]])
in0Con49787 = tf.constant([[[0.5433, 0.4509, 0.601, 0.8259, 0.4379, 0.5654, 0.8396, 0.3643, 0.6129, 0.888, 0.2216, 0.6223]]])
print (np.array2string(model.predict([in0Max86554,in1Max86554,in0Con57379,in0Ave21302,in1Ave21302,in0Sub97559,in1Sub97559,in0Con49787],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max16281.png')

LMax86554 = maximum_layer([[[[[[0.2637, 0.877]]]]], [[[[[0.9469, 0.4265]]]]]], Max86554), 
LReL10787 = relu_layer(Max86554, 1.90816911946371, 1.7046026225342121, 8.151671084294204, ReL10787), 
LRes37317 = reshape_layer(ReL10787, [1, 1, 2], Res37317), 
LLoc47444 = locally_connected2D_layer(Res37317, 1, 1,[[[0.2381, 0.0487, 0.5375], [0.0445, 0.7919, 0.6276]]],[[[0, 0, 0]]], 1, 1, Loc47444), 
LLay18905 = layer_normalization_layer(Loc47444, 1, 1.1426154335519019, Lay18905), 
LRes2630 = reshape_layer(Lay18905, [1, 1, 3, 1], Res2630), 
LZer68587 = zero_padding3D_layer(Res2630, 0, 0, 1, 0, 1, 0, Zer68587), 
LCon57379 = concatenate_layer([Zer68587,[[[[[0.0354], [0.2873], [0.0802], [0.9126]], [[0.8276], [0.8443], [0.6652], [0.3902]]]]]], 4, Con57379), 
LAve21302 = average_layer([[[[[[0.2472], [0.9416]], [[0.2716], [0.06]]]]], [[[[[0.1723], [0.8705]], [[0.284], [0.204]]]]]], Ave21302), 
LCon61389 = conv3D_transpose_layer(Ave21302, 1, 1, 1,[[[[[0.2668], [0.0144]]]]],[0, 0], 1, 1, 1, false, Con61389), 
LZer75431 = zero_padding3D_layer(Con61389, 0, 0, 0, 0, 2, 0, Zer75431), 
LAdd54594 = add_layer([Con57379,Zer75431], Add54594), 
LRes99618 = reshape_layer(Add54594, [1, 2, 8], Res99618), 
LRes66230 = reshape_layer(Res99618, [1, 16], Res66230), 
LSub97559 = subtract_layer([[[[[0.3937, 0.2631], [0.414, 0.1374], [0.7996, 0.2569]], [[0.6504, 0.8803], [0.487, 0.6868], [0.6266, 0.9881]]], [[[0.1165, 0.9313], [0.5237, 0.8856], [0.0219, 0.4748]], [[0.1559, 0.0156], [0.1692, 0.4624], [0.6316, 0.9593]]], [[[0.3563, 0.2945], [0.798, 0.6019], [0.6237, 0.6168]], [[0.2743, 0.3608], [0.7069, 0.8962], [0.2498, 0.4758]]]]], [[[[[0.503, 0.1434], [0.3857, 0.3638], [0.9475, 0.2399]], [[0.0928, 0.0856], [0.3995, 0.7601], [0.1819, 0.0403]]], [[[0.6208, 0.1392], [0.3805, 0.1067], [0.7004, 0.533]], [[0.494, 0.5861], [0.8229, 0.7368], [0.0533, 0.462]]], [[[0.6096, 0.0906], [0.1331, 0.6939], [0.871, 0.3798]], [[0.6538, 0.485], [0.001, 0.3637], [0.886, 0.7257]]]]], Sub97559), 
LRes18726 = reshape_layer(Sub97559, [3, 2, 6], Res18726), 
LRes31358 = reshape_layer(Res18726, [3, 12], Res31358), 
LCon56135 = conv1D_layer(Res31358, 2,[[[0.9496, 0.3629, 0.083, 0.0953], [0.6269, 0.9344, 0.1966, 0.9156], [0.8509, 0.6104, 0.3628, 0.652], [0.3729, 0.5012, 0.7242, 0.0248], [0.4303, 0.9268, 0.2071, 0.4565], [0.5913, 0.1373, 0.4028, 0.3466], [0.6405, 0.3352, 0.0026, 0.9537], [0.7224, 0.7579, 0.6198, 0.9573], [0.4809, 0.555, 0.5629, 0.0717], [0.1226, 0.0744, 0.011, 0.7925], [0.1701, 0.9561, 0.0873, 0.4718], [0.1686, 0.1269, 0.5283, 0.4376]], [[0.7642, 0.3858, 0.9983, 0.7995], [0.3792, 0.7769, 0.6167, 0.9162], [0.1781, 0.3558, 0.9307, 0.2402], [0.1381, 0.2737, 0.3939, 0.3994], [0.8174, 0.3283, 0.3897, 0.9275], [0.8487, 0.2572, 0.9797, 0.0138], [0.2767, 0.0897, 0.8484, 0.0064], [0.6036, 0.8116, 0.367, 0.1729], [0.8133, 0.4492, 0.3046, 0.4021], [0.7005, 0.4315, 0.4805, 0.1082], [0.5511, 0.7515, 0.565, 0.5949], [0.5869, 0.0157, 0.3177, 0.5254]]],[0, 0, 0, 0], 10, false, 1, Con56135), 
LCon49787 = concatenate_layer([Con56135,[[[0.5433, 0.4509, 0.601, 0.8259, 0.4379, 0.5654, 0.8396, 0.3643, 0.6129, 0.888, 0.2216, 0.6223]]]], 2, Con49787), 
LMax16281 = maximum_layer([Res66230,Con49787], Max16281), 
exec_layers([LMax86554,LReL10787,LRes37317,LLoc47444,LLay18905,LRes2630,LZer68587,LCon57379,LAve21302,LCon61389,LZer75431,LAdd54594,LRes99618,LRes66230,LSub97559,LRes18726,LRes31358,LCon56135,LCon49787,LMax16281],["Max86554","ReL10787","Res37317","Loc47444","Lay18905","Res2630","Zer68587","Con57379","Ave21302","Con61389","Zer75431","Add54594","Res99618","Res66230","Sub97559","Res18726","Res31358","Con56135","Con49787","Max16281"],Max16281,"Max16281")

Actual (Unparsed): [[[0.0000000, 1.2032664, 0.6802326, 2.1655709, 0.5433000, 0.4509000, 0.6010000, 0.9256471, 0.4379000, 0.8276000, 0.8396000, 0.8443000, 0.6129000, 0.8880000, 0.2216000, 0.6223000]]]

Expected (Unparsed): [[[0,1.20326635,0.6802326000000001,2.16557094,0.5433,0.4509,0.601,0.9256471199999999,0.4379,0.8276,0.8396,0.8443,0.6129,0.888,0.2216,0.6223]]]

Actual:   [[[0, 1.2033, 0.6803, 2.1656, 0.5433, 0.4509, 0.601, 0.9257, 0.4379, 0.8276, 0.8396, 0.8443, 0.6129, 0.888, 0.2216, 0.6223]]]

Expected: [[[0, 1.2033, 0.6803, 2.1656, 0.5433, 0.4509, 0.601, 0.9257, 0.4379, 0.8276, 0.8396, 0.8443, 0.6129, 0.888, 0.2216, 0.6223]]]