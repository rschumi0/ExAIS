import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max75005 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Max75005 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Add7635 = tf.keras.layers.Input(shape=([2, 2]))
in1Add7635 = tf.keras.layers.Input(shape=([2, 2]))
in0Con4628 = tf.keras.layers.Input(shape=([2, 2]))

Max75005 = keras.layers.Maximum(name = 'Max75005', )([in0Max75005,in1Max75005])
Res15134 = keras.layers.Reshape((2, 1, 4), name = 'Res15134', )(Max75005)
Res7177 = keras.layers.Reshape((2, 4), name = 'Res7177', )(Res15134)
Add7635 = keras.layers.Add(name = 'Add7635', )([in0Add7635,in1Add7635])
Con4628 = keras.layers.Concatenate(axis=2, name = 'Con4628', )([Add7635,in0Con4628])
Mul77202 = keras.layers.Multiply(name = 'Mul77202', )([Res7177,Con4628])
Res40168 = keras.layers.Reshape((2, 4, 1), name = 'Res40168', )(Mul77202)
Dep36634 = keras.layers.DepthwiseConv2D((2, 3),strides=(2, 2), padding='valid', name = 'Dep36634', )(Res40168)
model = tf.keras.models.Model(inputs=[in0Max75005,in1Max75005,in0Add7635,in1Add7635,in0Con4628], outputs=Dep36634)
w = model.get_layer('Dep36634').get_weights() 
w[0] = np.array([[[[0.8558]], [[0.8297]], [[0.2595]]], [[[0.8937]], [[0.5152]], [[0.2332]]]])
w[1] = np.array([0])
model.get_layer('Dep36634').set_weights(w) 
in0Max75005 = tf.constant([[[[[0.4919, 0.7728], [0.3434, 0.3249]]], [[[0.5557, 0.5637], [0.3681, 0.0754]]]]])
in1Max75005 = tf.constant([[[[[0.8195, 0.2889], [0.5477, 0.7084]]], [[[0.1572, 0.0978], [0.8236, 0.1088]]]]])
in0Add7635 = tf.constant([[[0.4652, 0.6455], [0.6543, 0.9308]]])
in1Add7635 = tf.constant([[[0.4626, 0.8037], [0.4729, 0.1831]]])
in0Con4628 = tf.constant([[[0.0434, 0.1488], [0.2748, 0.9548]]])
print (np.array2string(model.predict([in0Max75005,in1Max75005,in0Add7635,in1Add7635,in0Con4628],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dep36634.png')

LMax75005 = maximum_layer([[[[[[0.4919, 0.7728], [0.3434, 0.3249]]], [[[0.5557, 0.5637], [0.3681, 0.0754]]]]], [[[[[0.8195, 0.2889], [0.5477, 0.7084]]], [[[0.1572, 0.0978], [0.8236, 0.1088]]]]]], Max75005), 
LRes15134 = reshape_layer(Max75005, [2, 1, 4], Res15134), 
LRes7177 = reshape_layer(Res15134, [2, 4], Res7177), 
LAdd7635 = add_layer([[[[0.4652, 0.6455], [0.6543, 0.9308]]], [[[0.4626, 0.8037], [0.4729, 0.1831]]]], Add7635), 
LCon4628 = concatenate_layer([Add7635,[[[0.0434, 0.1488], [0.2748, 0.9548]]]], 2, Con4628), 
LMul77202 = multiply_layer([Res7177,Con4628], Mul77202), 
LRes40168 = reshape_layer(Mul77202, [2, 4, 1], Res40168), 
LDep36634 = depthwise_conv2D_layer(Res40168, 2, 3,[[[[0.8558]], [[0.8297]], [[0.2595]]], [[[0.8937]], [[0.5152]], [[0.2332]]]],[0], 2, 2, false, Dep36634), 
exec_layers([LMax75005,LRes15134,LRes7177,LAdd7635,LCon4628,LMul77202,LRes40168,LDep36634],["Max75005","Res15134","Res7177","Add7635","Con4628","Mul77202","Res40168","Dep36634"],Dep36634,"Dep36634")

Actual (Unparsed): [[[[2.5221525]]]]

Expected (Unparsed): [[[[2.5221524942419995]]]]

Actual:   [[[[2.5222]]]]

Expected: [[[[2.5222]]]]