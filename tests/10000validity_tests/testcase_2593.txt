import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave73652 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave73652 = tf.keras.layers.Input(shape=([2, 2]))
in0Con6113 = tf.keras.layers.Input(shape=([2, 6]))
in0Max15587 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in1Max15587 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Ave73652 = keras.layers.Average(name = 'Ave73652', )([in0Ave73652,in1Ave73652])
Per33661 = keras.layers.Permute((2,1), name = 'Per33661',)(Ave73652)
Con6113 = keras.layers.Concatenate(axis=2, name = 'Con6113', )([Per33661,in0Con6113])
Max15587 = keras.layers.Maximum(name = 'Max15587', )([in0Max15587,in1Max15587])
Res226 = keras.layers.Reshape((1, 2, 4), name = 'Res226', )(Max15587)
Res88102 = keras.layers.Reshape((1, 8), name = 'Res88102', )(Res226)
Ave2727 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave2727', )(Res88102)
Zer29375 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer29375', )(Ave2727)
Min36119 = keras.layers.Minimum(name = 'Min36119', )([Con6113,Zer29375])
model = tf.keras.models.Model(inputs=[in0Ave73652,in1Ave73652,in0Con6113,in0Max15587,in1Max15587], outputs=Min36119)
in0Ave73652 = tf.constant([[[0.5964, 0.6838], [0.1054, 0.9662]]])
in1Ave73652 = tf.constant([[[0.2067, 0.1564], [0.2925, 0.0759]]])
in0Con6113 = tf.constant([[[0.8115, 0.9586, 0.7889, 0.549, 0.2023, 0.3597], [0.7522, 0.4757, 0.6325, 0.4031, 0.741, 0.5579]]])
in0Max15587 = tf.constant([[[[[0.0242, 0.1885], [0.2949, 0.6836]], [[0.8906, 0.3555], [0.2944, 0.2418]]]]])
in1Max15587 = tf.constant([[[[[0.1719, 0.1238], [0.0424, 0.0494]], [[0.9414, 0.6535], [0.4046, 0.8763]]]]])
print (np.array2string(model.predict([in0Ave73652,in1Ave73652,in0Con6113,in0Max15587,in1Max15587],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min36119.png')

LAve73652 = average_layer([[[[0.5964, 0.6838], [0.1054, 0.9662]]], [[[0.2067, 0.1564], [0.2925, 0.0759]]]], Ave73652), 
LPer33661 = permute_layer(Ave73652, 2,1, Per33661), 
LCon6113 = concatenate_layer([Per33661,[[[0.8115, 0.9586, 0.7889, 0.549, 0.2023, 0.3597], [0.7522, 0.4757, 0.6325, 0.4031, 0.741, 0.5579]]]], 2, Con6113), 
LMax15587 = maximum_layer([[[[[[0.0242, 0.1885], [0.2949, 0.6836]], [[0.8906, 0.3555], [0.2944, 0.2418]]]]], [[[[[0.1719, 0.1238], [0.0424, 0.0494]], [[0.9414, 0.6535], [0.4046, 0.8763]]]]]], Max15587), 
LRes226 = reshape_layer(Max15587, [1, 2, 4], Res226), 
LRes88102 = reshape_layer(Res226, [1, 8], Res88102), 
LAve2727 = average_pooling1D_layer(Res88102, 1, Ave2727), 
LZer29375 = zero_padding1D_layer(Ave2727, 1, 0, Zer29375), 
LMin36119 = minimum_layer([Con6113,Zer29375], Min36119), 
exec_layers([LAve73652,LPer33661,LCon6113,LMax15587,LRes226,LRes88102,LAve2727,LZer29375,LMin36119],["Ave73652","Per33661","Con6113","Max15587","Res226","Res88102","Ave2727","Zer29375","Min36119"],Min36119,"Min36119")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.1719000, 0.1885000, 0.2949000, 0.4757000, 0.6325000, 0.4031000, 0.4046000, 0.5579000]]]

Expected (Unparsed): [[[0,0,0,0,0,0,0,0],[0.1719,0.1885,0.2949,0.4757,0.6325,0.4031,0.4046,0.5579]]]

Actual:   [[[0, 0, 0, 0, 0, 0, 0, 0], [0.1719, 0.1885, 0.2949, 0.4757, 0.6325, 0.4031, 0.4046, 0.5579]]]

Expected: [[[0, 0, 0, 0, 0, 0, 0, 0], [0.1719, 0.1885, 0.2949, 0.4757, 0.6325, 0.4031, 0.4046, 0.5579]]]