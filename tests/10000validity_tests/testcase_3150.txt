import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max79665 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Max79665 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in0Con15421 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Ave82584 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave82584 = tf.keras.layers.Input(shape=([2, 2]))

Max79665 = keras.layers.Maximum(name = 'Max79665', )([in0Max79665,in1Max79665])
Res31422 = keras.layers.Reshape((2, 2, 1), name = 'Res31422', )(Max79665)
Con15421 = keras.layers.Concatenate(axis=3, name = 'Con15421', )([Res31422,in0Con15421])
Ave82584 = keras.layers.Average(name = 'Ave82584', )([in0Ave82584,in1Ave82584])
Res88460 = keras.layers.Reshape((2, 2, 1), name = 'Res88460', )(Ave82584)
Con68088 = keras.layers.Conv2D(3, (2, 1),strides=(7, 11), padding='same', dilation_rate=(1, 1), name = 'Con68088', )(Res88460)
Zer30602 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer30602', )(Con68088)
Ave149 = keras.layers.Average(name = 'Ave149', )([Con15421,Zer30602])
Con54777 = keras.layers.Conv2DTranspose(3, (2, 1),strides=(1, 1), padding='valid', name = 'Con54777', )(Ave149)
Res21940 = keras.layers.Reshape((3, 2, 3, 1), name = 'Res21940', )(Con54777)
Cro12587 = keras.layers.Cropping3D(cropping=((1, 0), (1, 0), (1, 0)), name = 'Cro12587', )(Res21940)
model = tf.keras.models.Model(inputs=[in0Max79665,in1Max79665,in0Con15421,in0Ave82584,in1Ave82584], outputs=Cro12587)
w = model.get_layer('Con68088').get_weights() 
w[0] = np.array([[[[0.9928, 0.0409, 0.1531]]], [[[0.6876, 0.9916, 0.4383]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con68088').set_weights(w) 
w = model.get_layer('Con54777').get_weights() 
w[0] = np.array([[[[0.0415, 0.5204, 0.3303], [0.6866, 0.7237, 0.2982], [0.5777, 0.2458, 0.0966]]], [[[0.5445, 0.7435, 0.4594], [0.6856, 0.6318, 0.4574], [0.9187, 0.9407, 0.2592]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con54777').set_weights(w) 
in0Max79665 = tf.constant([[[[[0.3084]], [[0.6247]]], [[[0.3887]], [[0.7434]]]]])
in1Max79665 = tf.constant([[[[[0.9142]], [[0.212]]], [[[0.4382]], [[0.4034]]]]])
in0Con15421 = tf.constant([[[[0.8088, 0.1701], [0.0976, 0.617]], [[0.0444, 0.3227], [0.4904, 0.6586]]]])
in0Ave82584 = tf.constant([[[0.7352, 0.3671], [0.5782, 0.2489]]])
in1Ave82584 = tf.constant([[[0.1997, 0.4035], [0.7834, 0.8181]]])
print (np.array2string(model.predict([in0Max79665,in1Max79665,in0Con15421,in0Ave82584,in1Ave82584],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro12587.png')

LMax79665 = maximum_layer([[[[[[0.3084]], [[0.6247]]], [[[0.3887]], [[0.7434]]]]], [[[[[0.9142]], [[0.212]]], [[[0.4382]], [[0.4034]]]]]], Max79665), 
LRes31422 = reshape_layer(Max79665, [2, 2, 1], Res31422), 
LCon15421 = concatenate_layer([Res31422,[[[[0.8088, 0.1701], [0.0976, 0.617]], [[0.0444, 0.3227], [0.4904, 0.6586]]]]], 3, Con15421), 
LAve82584 = average_layer([[[[0.7352, 0.3671], [0.5782, 0.2489]]], [[[0.1997, 0.4035], [0.7834, 0.8181]]]], Ave82584), 
LRes88460 = reshape_layer(Ave82584, [2, 2, 1], Res88460), 
LCon68088 = conv2D_layer(Res88460, 2, 1,[[[[0.9928, 0.0409, 0.1531]]], [[[0.6876, 0.9916, 0.4383]]]],[0, 0, 0], 7, 11, true, 1, 1, Con68088), 
LZer30602 = zero_padding2D_layer(Con68088, 1, 0, 1, 0, Zer30602), 
LAve149 = average_layer([Con15421,Zer30602], Ave149), 
LCon54777 = conv2D_transpose_layer(Ave149, 2, 1,[[[[0.0415, 0.5204, 0.3303], [0.6866, 0.7237, 0.2982], [0.5777, 0.2458, 0.0966]]], [[[0.5445, 0.7435, 0.4594], [0.6856, 0.6318, 0.4574], [0.9187, 0.9407, 0.2592]]]],[0, 0, 0], 1, 1, false, Con54777), 
LRes21940 = reshape_layer(Con54777, [3, 2, 3, 1], Res21940), 
LCro12587 = cropping3D_layer(Res21940, 1, 0, 1, 0, 1, 0, Cro12587), 
exec_layers([LMax79665,LRes31422,LCon15421,LAve82584,LRes88460,LCon68088,LZer30602,LAve149,LCon54777,LRes21940,LCro12587],["Max79665","Res31422","Con15421","Ave82584","Res88460","Con68088","Zer30602","Ave149","Con54777","Res21940","Cro12587"],Cro12587,"Cro12587")

Actual (Unparsed): [[[[[1.5433272], [1.0920899]]], [[[1.1838436], [1.4601661]]]]]

Expected (Unparsed): [[[[[1.54332720236275],[1.092089915601]]],[[[1.183843606138],[1.4601661198147502]]]]]

Actual:   [[[[[1.5434], [1.0921]]], [[[1.1839], [1.4602]]]]]

Expected: [[[[[1.5434], [1.0921]]], [[[1.1839], [1.4602]]]]]