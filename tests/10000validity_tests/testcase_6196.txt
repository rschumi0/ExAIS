import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep37062 = tf.keras.layers.Input(shape=([1, 2]))

Sep37062 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='same', name = 'Sep37062', )(in0Sep37062)
Bat71321 = keras.layers.BatchNormalization(axis=1, epsilon=0.9001314848538323,  name = 'Bat71321', )(Sep37062)
Res78164 = keras.layers.Reshape((1, 3, 1), name = 'Res78164', )(Bat71321)
Con26921 = keras.layers.Conv2D(4, (1, 1),strides=(6, 1), padding='same', dilation_rate=(1, 1), name = 'Con26921', )(Res78164)
PRe12411 = keras.layers.PReLU(name = 'PRe12411', )(Con26921)
model = tf.keras.models.Model(inputs=[in0Sep37062], outputs=PRe12411)
w = model.get_layer('Sep37062').get_weights() 
w[0] = np.array([[[0.2072], [0.0798]]])
w[1] = np.array([[[0.3397, 0.2081, 0.2643], [0.8812, 0.2868, 0.8213]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep37062').set_weights(w) 
w = model.get_layer('Bat71321').get_weights() 
w[0] = np.array([0.1982])
w[1] = np.array([0.3104])
w[2] = np.array([0.3226])
w[3] = np.array([0.7288])
model.get_layer('Bat71321').set_weights(w) 
w = model.get_layer('Con26921').get_weights() 
w[0] = np.array([[[[0.5784, 0.0251, 0.4859, 0.9315]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con26921').set_weights(w) 
w = model.get_layer('PRe12411').get_weights() 
w[0] = np.array([[[0.4543, 0.4948, 0.2309, 0.7421], [0.0053, 0.1628, 0.6014, 0.823], [0.9478, 0.2596, 0.2323, 0.2983]]])
model.get_layer('PRe12411').set_weights(w) 
in0Sep37062 = tf.constant([[[0.8285, 0.4054]]])
print (np.array2string(model.predict([in0Sep37062],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe12411.png')

LSep37062 = separable_conv1D_layer([[[0.8285, 0.4054]]], 1,[[[[0.2072], [0.0798]]],[[[0.3397, 0.2081, 0.2643], [0.8812, 0.2868, 0.8213]]]],[0, 0, 0], 1, true, Sep37062), 
LBat71321 = batch_normalization_layer(Sep37062, 1, 0.9001314848538323, [0.1982], [0.3104], [0.3226], [0.7288], Bat71321), 
LRes78164 = reshape_layer(Bat71321, [1, 3, 1], Res78164), 
LCon26921 = conv2D_layer(Res78164, 1, 1,[[[[0.5784, 0.0251, 0.4859, 0.9315]]]],[0, 0, 0, 0], 6, 1, true, 1, 1, Con26921), 
LPRe12411 = prelu_layer(Con26921, [[[0.4543, 0.4948, 0.2309, 0.7421], [0.0053, 0.1628, 0.6014, 0.823], [0.9478, 0.2596, 0.2323, 0.2983]]], PRe12411), 
exec_layers([LSep37062,LBat71321,LRes78164,LCon26921,LPRe12411],["Sep37062","Bat71321","Res78164","Con26921","PRe12411"],PRe12411,"PRe12411")

Actual (Unparsed): [[[[0.1583574, 0.0068720, 0.1330323, 0.2550310], [0.1546011, 0.0067090, 0.1298766, 0.2489815], [0.1570208, 0.0068140, 0.1319094, 0.2528784]]]]

Expected (Unparsed): [[[[0.15835744240748972,0.006872012110006902,0.1330322981773846,0.25503104703073426],[0.15460105800462307,0.0067090016526902465,0.12987664952359326,0.24898147567653245],[0.1570207741923514,0.0068140066255671155,0.13190939519374748,0.2528783733751302]]]]

Actual:   [[[[0.1584, 0.0069, 0.1331, 0.2551], [0.1547, 0.0068, 0.1299, 0.249], [0.1571, 0.0069, 0.132, 0.2529]]]]

Expected: [[[[0.1584, 0.0069, 0.1331, 0.2551], [0.1547, 0.0068, 0.1299, 0.249], [0.1571, 0.0069, 0.132, 0.2529]]]]