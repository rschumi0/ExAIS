import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add92730 = tf.keras.layers.Input(shape=([2, 2]))
in1Add92730 = tf.keras.layers.Input(shape=([2, 2]))

Add92730 = keras.layers.Add(name = 'Add92730', )([in0Add92730,in1Add92730])
GRU77178 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU77178', )(Add92730)
model = tf.keras.models.Model(inputs=[in0Add92730,in1Add92730], outputs=GRU77178)
w = model.get_layer('GRU77178').get_weights() 
w[0] = np.array([[9, 9, 2, 6, 1, 4], [2, 10, 8, 6, 7, 1]])
w[1] = np.array([[8, 8, 8, 4, 9, 10], [4, 3, 10, 9, 6, 8]])
w[2] = np.array([[4, 4, 5, 8, 1, 4], [5, 2, 4, 2, 5, 10]])
model.get_layer('GRU77178').set_weights(w) 
in0Add92730 = tf.constant([[[0.2929, 0.2785], [0.6022, 0.2362]]])
in1Add92730 = tf.constant([[[0.9878, 0.16], [0.5187, 0.926]]])
print (np.array2string(model.predict([in0Add92730,in1Add92730],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU77178.png')

LAdd92730 = add_layer([[[[0.2929, 0.2785], [0.6022, 0.2362]]], [[[0.9878, 0.16], [0.5187, 0.926]]]], Add92730), 
LGRU77178 = gru_layer(Add92730,[[9, 9, 2, 6, 1, 4], [2, 10, 8, 6, 7, 1]],[[8, 8, 8, 4, 9, 10], [4, 3, 10, 9, 6, 8]],[[4, 4, 5, 8, 1, 4], [5, 2, 4, 2, 5, 10]], true, GRU77178), 
exec_layers([LAdd92730,LGRU77178],["Add92730","GRU77178"],GRU77178,"GRU77178")

Actual (Unparsed): [[0.0000000, 0.0000000]]

Expected (Unparsed): [[1.0085599009692481e-9,3.0574387466203035e-10]]

Actual:   [[0, 0]]

Expected: [[0, 0]]