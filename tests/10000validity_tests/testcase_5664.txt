import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave67175 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Ave67175 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Ave67175 = keras.layers.Average(name = 'Ave67175', )([in0Ave67175,in1Ave67175])
Res5101 = keras.layers.Reshape((2, 2, 4), name = 'Res5101', )(Ave67175)
Con86202 = keras.layers.Conv2D(2, (2, 1),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con86202', )(Res5101)
model = tf.keras.models.Model(inputs=[in0Ave67175,in1Ave67175], outputs=Con86202)
w = model.get_layer('Con86202').get_weights() 
w[0] = np.array([[[[0.066, 0.4259], [0.3995, 0.8803], [0.2701, 0.6909], [0.0163, 0.2453]]], [[[0.9081, 0.6676], [0.0268, 0.1472], [0.4052, 0.3738], [0.3619, 0.923]]]])
w[1] = np.array([0, 0])
model.get_layer('Con86202').set_weights(w) 
in0Ave67175 = tf.constant([[[[[0.1374, 0.1708], [0.7905, 0.6889]], [[0.749, 0.6053], [0.8813, 0.6423]]], [[[0.5254, 0.2763], [0.4283, 0.0924]], [[0.1393, 0.1625], [0.8689, 0.7782]]]]])
in1Ave67175 = tf.constant([[[[[0.4402, 0.6785], [0.0659, 0.4494]], [[0.4557, 0.5175], [0.0278, 0.8364]]], [[[0.4624, 0.2397], [0.361, 0.5074]], [[0.5953, 0.5088], [0.9331, 0.6361]]]]])
print (np.array2string(model.predict([in0Ave67175,in1Ave67175],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con86202.png')

LAve67175 = average_layer([[[[[[0.1374, 0.1708], [0.7905, 0.6889]], [[0.749, 0.6053], [0.8813, 0.6423]]], [[[0.5254, 0.2763], [0.4283, 0.0924]], [[0.1393, 0.1625], [0.8689, 0.7782]]]]], [[[[[0.4402, 0.6785], [0.0659, 0.4494]], [[0.4557, 0.5175], [0.0278, 0.8364]]], [[[0.4624, 0.2397], [0.361, 0.5074]], [[0.5953, 0.5088], [0.9331, 0.6361]]]]]], Ave67175), 
LRes5101 = reshape_layer(Ave67175, [2, 2, 4], Res5101), 
LCon86202 = conv2D_layer(Res5101, 2, 1,[[[[0.066, 0.4259], [0.3995, 0.8803], [0.2701, 0.6909], [0.0163, 0.2453]]], [[[0.9081, 0.6676], [0.0268, 0.1472], [0.4052, 0.3738], [0.3619, 0.923]]]],[0, 0], 1, 1, false, 1, 1, Con86202), 
exec_layers([LAve67175,LRes5101,LCon86202],["Ave67175","Res5101","Con86202"],Con86202,"Con86202")

Actual (Unparsed): [[[[1.0375134, 1.7243083], [1.3624031, 2.5302628]]]]

Expected (Unparsed): [[[[1.03751342,1.7243083],[1.362403095,2.5302628449999998]]]]

Actual:   [[[[1.0376, 1.7244], [1.3625, 2.5303]]]]

Expected: [[[[1.0376, 1.7244], [1.3625, 2.5303]]]]