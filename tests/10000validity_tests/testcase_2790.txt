import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Loc91404 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con79101 = tf.keras.layers.Input(shape=([1, 2, 4, 2]))
in0Up_31731 = tf.keras.layers.Input(shape=([1, 1, 2, 3]))

Loc91404 = keras.layers.LocallyConnected2D(2, (2, 1),strides=(1, 1), name = 'Loc91404', )(in0Loc91404)
Cro14248 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro14248', )(Loc91404)
Res19262 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res19262', )(Cro14248)
Zer47704 = keras.layers.ZeroPadding3D(padding=((0, 0), (1, 0), (2, 0)), name = 'Zer47704', )(Res19262)
Con79101 = keras.layers.Concatenate(axis=4, name = 'Con79101', )([Zer47704,in0Con79101])
Up_31731 = keras.layers.UpSampling3D(size=(1, 2, 2), name = 'Up_31731', )(in0Up_31731)
Min29327 = keras.layers.Minimum(name = 'Min29327', )([Con79101,Up_31731])
model = tf.keras.models.Model(inputs=[in0Loc91404,in0Con79101,in0Up_31731], outputs=Min29327)
w = model.get_layer('Loc91404').get_weights() 
w[0] = np.array([[[0.5555, 0.8782], [0.6063, 0.4971]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc91404').set_weights(w) 
in0Loc91404 = tf.constant([[[[0.4242]], [[0.2312]]]])
in0Con79101 = tf.constant([[[[[0.5296, 0.0939], [0.5912, 0.868], [0.9127, 0.2351], [0.5857, 0.4458]], [[0.2173, 0.7937], [0.5801, 0.6427], [0.9208, 0.94], [0.0576, 0.4206]]]]])
in0Up_31731 = tf.constant([[[[[1.7024, 1.2756, 1.8304], [1.5323, 1.2054, 1.4244]]]]])
print (np.array2string(model.predict([in0Loc91404,in0Con79101,in0Up_31731],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min29327.png')

LLoc91404 = locally_connected2D_layer([[[[0.4242]], [[0.2312]]]], 2, 1,[[[0.5555, 0.8782], [0.6063, 0.4971]]],[[[0, 0]]], 1, 1, Loc91404), 
LCro14248 = cropping2D_layer(Loc91404, 0, 0, 0, 0, Cro14248), 
LRes19262 = reshape_layer(Cro14248, [1, 1, 2, 1], Res19262), 
LZer47704 = zero_padding3D_layer(Res19262, 0, 0, 1, 0, 2, 0, Zer47704), 
LCon79101 = concatenate_layer([Zer47704,[[[[[0.5296, 0.0939], [0.5912, 0.868], [0.9127, 0.2351], [0.5857, 0.4458]], [[0.2173, 0.7937], [0.5801, 0.6427], [0.9208, 0.94], [0.0576, 0.4206]]]]]], 4, Con79101), 
LUp_31731 = up_sampling3D_layer([[[[[1.7024, 1.2756, 1.8304], [1.5323, 1.2054, 1.4244]]]]], 1, 2, 2, Up_31731), 
LMin29327 = minimum_layer([Con79101,Up_31731], Min29327), 
exec_layers([LLoc91404,LCro14248,LRes19262,LZer47704,LCon79101,LUp_31731,LMin29327],["Loc91404","Cro14248","Res19262","Zer47704","Con79101","Up_31731","Min29327"],Min29327,"Min29327")

Actual (Unparsed): [[[[[0.0000000, 0.5296000, 0.0939000], [0.0000000, 0.5912000, 0.8680000], [0.0000000, 0.9127000, 0.2351000], [0.0000000, 0.5857000, 0.4458000]], [[0.0000000, 0.2173000, 0.7937000], [0.0000000, 0.5801000, 0.6427000], [0.3758197, 0.9208000, 0.9400000], [0.4874620, 0.0576000, 0.4206000]]]]]

Expected (Unparsed): [[[[[0,0.5296,0.0939],[0,0.5912,0.868],[0,0.9127,0.2351],[0,0.5857,0.4458]],[[0,0.2173,0.7937],[0,0.5801,0.6427],[0.37581966,0.9208,0.94],[0.48746196,0.0576,0.4206]]]]]

Actual:   [[[[[0, 0.5296, 0.0939], [0, 0.5912, 0.868], [0, 0.9127, 0.2351], [0, 0.5857, 0.4458]], [[0, 0.2173, 0.7937], [0, 0.5801, 0.6427], [0.3759, 0.9208, 0.94], [0.4875, 0.0576, 0.4206]]]]]

Expected: [[[[[0, 0.5296, 0.0939], [0, 0.5912, 0.868], [0, 0.9127, 0.2351], [0, 0.5857, 0.4458]], [[0, 0.2173, 0.7937], [0, 0.5801, 0.6427], [0.3759, 0.9208, 0.94], [0.4875, 0.0576, 0.4206]]]]]