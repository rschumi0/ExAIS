import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add6499 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Add6499 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Dot76605 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot76605 = tf.keras.layers.Input(shape=([3, 2]))
in0Con61368 = tf.keras.layers.Input(shape=([3, 1]))

Add6499 = keras.layers.Add(name = 'Add6499', )([in0Add6499,in1Add6499])
Res52288 = keras.layers.Reshape((2, 1, 4), name = 'Res52288', )(Add6499)
Res52867 = keras.layers.Reshape((2, 4), name = 'Res52867', )(Res52288)
Zer12679 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer12679', )(Res52867)
Dot76605 = keras.layers.Dot(axes=(2, 2), name = 'Dot76605', )([in0Dot76605,in1Dot76605])
Con61368 = keras.layers.Concatenate(axis=2, name = 'Con61368', )([Dot76605,in0Con61368])
Max62064 = keras.layers.Maximum(name = 'Max62064', )([Zer12679,Con61368])
Res48658 = keras.layers.Reshape((3, 4, 1), name = 'Res48658', )(Max62064)
Sep98548 = keras.layers.SeparableConv2D(4, (3, 4),strides=(2, 2), padding='valid', name = 'Sep98548', )(Res48658)
model = tf.keras.models.Model(inputs=[in0Add6499,in1Add6499,in0Dot76605,in1Dot76605,in0Con61368], outputs=Sep98548)
w = model.get_layer('Sep98548').get_weights() 
w[0] = np.array([[[[0.1911]], [[0.8541]], [[0.2416]], [[0.6192]]], [[[0.3464]], [[0.1669]], [[0.7836]], [[0.3679]]], [[[0.95]], [[0.5568]], [[0.6567]], [[0.4718]]]])
w[1] = np.array([[[[0.3851, 0.4825, 0.7246, 0.4889]]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep98548').set_weights(w) 
in0Add6499 = tf.constant([[[[[0.8487, 0.8249], [0.3089, 0.5071]]], [[[0.8675, 0.7568], [0.9735, 0.3902]]]]])
in1Add6499 = tf.constant([[[[[0.2547, 0.376], [0.6114, 0.569]]], [[[0.0544, 0.2375], [0.7433, 0.939]]]]])
in0Dot76605 = tf.constant([[[0.0832, 0.9539], [0.546, 0.6788], [0.8736, 0.2878]]])
in1Dot76605 = tf.constant([[[0.1307, 0.2876], [0.4998, 0.7605], [0.9304, 0.5928]]])
in0Con61368 = tf.constant([[[0.9964], [0.5188], [0.6415]]])
print (np.array2string(model.predict([in0Add6499,in1Add6499,in0Dot76605,in1Dot76605,in0Con61368],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep98548.png')

LAdd6499 = add_layer([[[[[[0.8487, 0.8249], [0.3089, 0.5071]]], [[[0.8675, 0.7568], [0.9735, 0.3902]]]]], [[[[[0.2547, 0.376], [0.6114, 0.569]]], [[[0.0544, 0.2375], [0.7433, 0.939]]]]]], Add6499), 
LRes52288 = reshape_layer(Add6499, [2, 1, 4], Res52288), 
LRes52867 = reshape_layer(Res52288, [2, 4], Res52867), 
LZer12679 = zero_padding1D_layer(Res52867, 1, 0, Zer12679), 
LDot76605 = dot_layer([[[0.0832, 0.9539], [0.546, 0.6788], [0.8736, 0.2878]]], [[[0.1307, 0.2876], [0.4998, 0.7605], [0.9304, 0.5928]]], 2, 2, Dot76605), 
LCon61368 = concatenate_layer([Dot76605,[[[0.9964], [0.5188], [0.6415]]]], 2, Con61368), 
LMax62064 = maximum_layer([Zer12679,Con61368], Max62064), 
LRes48658 = reshape_layer(Max62064, [3, 4, 1], Res48658), 
LSep98548 = separable_conv2D_layer(Res48658, 3, 4,[[[[[0.1911]], [[0.8541]], [[0.2416]], [[0.6192]]], [[[0.3464]], [[0.1669]], [[0.7836]], [[0.3679]]], [[[0.95]], [[0.5568]], [[0.6567]], [[0.4718]]]],[[[[0.3851, 0.4825, 0.7246, 0.4889]]]]],[0, 0, 0, 0], 2, 2, false, Sep98548), 
exec_layers([LAdd6499,LRes52288,LRes52867,LZer12679,LDot76605,LCon61368,LMax62064,LRes48658,LSep98548],["Add6499","Res52288","Res52867","Zer12679","Dot76605","Con61368","Max62064","Res48658","Sep98548"],Sep98548,"Sep98548")

Actual (Unparsed): [[[[2.4513825, 3.0713894, 4.6124948, 3.1121290]]]]

Expected (Unparsed): [[[[2.4513824687467904,3.071389356453717,4.612494772406971,3.1121290287465753]]]]

Actual:   [[[[2.4514, 3.0714, 4.6125, 3.1122]]]]

Expected: [[[[2.4514, 3.0714, 4.6125, 3.1122]]]]