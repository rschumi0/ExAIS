import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max30602 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max30602 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Ave48491 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))
in1Ave48491 = tf.keras.layers.Input(shape=([2, 2, 1, 1]))

Max30602 = keras.layers.Maximum(name = 'Max30602', )([in0Max30602,in1Max30602])
Res88203 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res88203', )(Max30602)
Zer86878 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer86878', )(Res88203)
Ave48491 = keras.layers.Average(name = 'Ave48491', )([in0Ave48491,in1Ave48491])
Zer39867 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer39867', )(Ave48491)
Max29582 = keras.layers.Maximum(name = 'Max29582', )([Zer86878,Zer39867])
Res52884 = keras.layers.Reshape((2, 2, 3), name = 'Res52884', )(Max29582)
Res67580 = keras.layers.Reshape((2, 6), name = 'Res67580', )(Res52884)
Zer99381 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer99381', )(Res67580)
Res87303 = keras.layers.Reshape((4, 6, 1), name = 'Res87303', )(Zer99381)
Max19307 = keras.layers.MaxPool2D(pool_size=(4, 4), strides=(1, 5), padding='same', name = 'Max19307', )(Res87303)
model = tf.keras.models.Model(inputs=[in0Max30602,in1Max30602,in0Ave48491,in1Ave48491], outputs=Max19307)
in0Max30602 = tf.constant([[[[0.2633, 0.9419]]]])
in1Max30602 = tf.constant([[[[0.917, 0.3032]]]])
in0Ave48491 = tf.constant([[[[[0.8364]], [[0.626]]], [[[0.1148]], [[0.3817]]]]])
in1Ave48491 = tf.constant([[[[[0.5887]], [[0.0801]]], [[[0.5257]], [[0.2761]]]]])
print (np.array2string(model.predict([in0Max30602,in1Max30602,in0Ave48491,in1Ave48491],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max19307.png')

LMax30602 = maximum_layer([[[[[0.2633, 0.9419]]]], [[[[0.917, 0.3032]]]]], Max30602), 
LRes88203 = reshape_layer(Max30602, [1, 1, 2, 1], Res88203), 
LZer86878 = zero_padding3D_layer(Res88203, 1, 0, 1, 0, 1, 0, Zer86878), 
LAve48491 = average_layer([[[[[[0.8364]], [[0.626]]], [[[0.1148]], [[0.3817]]]]], [[[[[0.5887]], [[0.0801]]], [[[0.5257]], [[0.2761]]]]]], Ave48491), 
LZer39867 = zero_padding3D_layer(Ave48491, 0, 0, 0, 0, 2, 0, Zer39867), 
LMax29582 = maximum_layer([Zer86878,Zer39867], Max29582), 
LRes52884 = reshape_layer(Max29582, [2, 2, 3], Res52884), 
LRes67580 = reshape_layer(Res52884, [2, 6], Res67580), 
LZer99381 = zero_padding1D_layer(Res67580, 2, 0, Zer99381), 
LRes87303 = reshape_layer(Zer99381, [4, 6, 1], Res87303), 
LMax19307 = max_pool2D_layer(Res87303, 4, 4, 1, 5, true, Max19307), 
exec_layers([LMax30602,LRes88203,LZer86878,LAve48491,LZer39867,LMax29582,LRes52884,LRes67580,LZer99381,LRes87303,LMax19307],["Max30602","Res88203","Zer86878","Ave48491","Zer39867","Max29582","Res52884","Res67580","Zer99381","Res87303","Max19307"],Max19307,"Max19307")

Actual (Unparsed): [[[[0.7125500], [0.3530500]], [[0.7125500], [0.9419000]], [[0.7125500], [0.9419000]], [[0.7125500], [0.9419000]]]]

Expected (Unparsed): [[[[0.71255],[0.35305]],[[0.71255],[0.9419]],[[0.71255],[0.9419]],[[0.71255],[0.9419]]]]

Actual:   [[[[0.7126], [0.3531]], [[0.7126], [0.9419]], [[0.7126], [0.9419]], [[0.7126], [0.9419]]]]

Expected: [[[[0.7126], [0.3531]], [[0.7126], [0.9419]], [[0.7126], [0.9419]], [[0.7126], [0.9419]]]]