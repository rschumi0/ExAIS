import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU79221 = tf.keras.layers.Input(shape=([3, 1]))

GRU79221 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU79221', )(in0GRU79221)
ELU56101 = keras.layers.ELU(alpha=-2.255161035530402, name = 'ELU56101', )(GRU79221)
model = tf.keras.models.Model(inputs=[in0GRU79221], outputs=ELU56101)
w = model.get_layer('GRU79221').get_weights() 
w[0] = np.array([[2, 7, 9, 10, 4, 3]])
w[1] = np.array([[7, 6, 1, 7, 4, 9], [6, 6, 3, 7, 5, 1]])
w[2] = np.array([[8, 5, 7, 7, 6, 8], [7, 6, 1, 1, 4, 1]])
model.get_layer('GRU79221').set_weights(w) 
in0GRU79221 = tf.constant([[[5], [7], [7]]])
print (np.array2string(model.predict([in0GRU79221],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU56101.png')

LGRU79221 = gru_layer([[[5], [7], [7]]],[[2, 7, 9, 10, 4, 3]],[[7, 6, 1, 7, 4, 9], [6, 6, 3, 7, 5, 1]],[[8, 5, 7, 7, 6, 8], [7, 6, 1, 1, 4, 1]], true, GRU79221), 
LELU56101 = elu_layer(GRU79221, -2.255161035530402, ELU56101), 
exec_layers([LGRU79221,LELU56101],["GRU79221","ELU56101"],ELU56101,"ELU56101")

Actual (Unparsed): [[0.0000000, -0.0000000]]

Expected (Unparsed): [[1.4396928094122047e-11,0.0]]

Actual:   [[0, -0]]

Expected: [[0, 0]]