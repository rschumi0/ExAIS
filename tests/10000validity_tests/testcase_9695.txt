import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ELU79746 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Sub92929 = tf.keras.layers.Input(shape=([3]))
in1Sub92929 = tf.keras.layers.Input(shape=([3]))
in0Con86087 = tf.keras.layers.Input(shape=([5]))

ELU79746 = keras.layers.ELU(alpha=-1.8552199184009037, name = 'ELU79746', input_shape=(2, 1, 1, 2))(in0ELU79746)
Res37290 = keras.layers.Reshape((2, 1, 2), name = 'Res37290', )(ELU79746)
Res7626 = keras.layers.Reshape((2, 2), name = 'Res7626', )(Res37290)
Zer4462 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer4462', )(Res7626)
Fla69446 = keras.layers.Flatten(name = 'Fla69446', )(Zer4462)
Sub92929 = keras.layers.Subtract(name = 'Sub92929', )([in0Sub92929,in1Sub92929])
Con86087 = keras.layers.Concatenate(axis=1, name = 'Con86087', )([Sub92929,in0Con86087])
Sub84969 = keras.layers.Subtract(name = 'Sub84969', )([Fla69446,Con86087])
Res36573 = keras.layers.Reshape((8, 1), name = 'Res36573', )(Sub84969)
Res77518 = keras.layers.Reshape((8, 1, 1), name = 'Res77518', )(Res36573)
Con14411 = keras.layers.Conv2D(2, (7, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con14411', )(Res77518)
model = tf.keras.models.Model(inputs=[in0ELU79746,in0Sub92929,in1Sub92929,in0Con86087], outputs=Con14411)
w = model.get_layer('Con14411').get_weights() 
w[0] = np.array([[[[0.2705, 0.5528]]], [[[0.6816, 0.5801]]], [[[0.9465, 0.7771]]], [[[0.2903, 0.5894]]], [[[0.2415, 0.6775]]], [[[0.7361, 0.1893]]], [[[0.4418, 0.6413]]]])
w[1] = np.array([0, 0])
model.get_layer('Con14411').set_weights(w) 
in0ELU79746 = tf.constant([[[[[0.082, 0.9877]]], [[[0.4197, 0.4369]]]]])
in0Sub92929 = tf.constant([[0.4468, 0.472, 0.0267]])
in1Sub92929 = tf.constant([[0.0836, 0.7498, 0.4337]])
in0Con86087 = tf.constant([[0.4112, 0.0191, 0.57, 0.7358, 0.3926]])
print (np.array2string(model.predict([in0ELU79746,in0Sub92929,in1Sub92929,in0Con86087],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con14411.png')

LELU79746 = elu_layer([[[[[0.082, 0.9877]]], [[[0.4197, 0.4369]]]]], -1.8552199184009037, ELU79746), 
LRes37290 = reshape_layer(ELU79746, [2, 1, 2], Res37290), 
LRes7626 = reshape_layer(Res37290, [2, 2], Res7626), 
LZer4462 = zero_padding1D_layer(Res7626, 1, 1, Zer4462), 
LFla69446 = flatten_layer(Zer4462, Fla69446), 
LSub92929 = subtract_layer([[0.4468, 0.472, 0.0267]], [[0.0836, 0.7498, 0.4337]], Sub92929), 
LCon86087 = concatenate_layer([Sub92929,[[0.4112, 0.0191, 0.57, 0.7358, 0.3926]]], 1, Con86087), 
LSub84969 = subtract_layer(Fla69446,Con86087, Sub84969), 
LRes36573 = reshape_layer(Sub84969, [8, 1], Res36573), 
LRes77518 = reshape_layer(Res36573, [8, 1, 1], Res77518), 
LCon14411 = conv2D_layer(Res77518, 7, 1,[[[[0.2705, 0.5528]]], [[[0.6816, 0.5801]]], [[[0.9465, 0.7771]]], [[[0.2903, 0.5894]]], [[[0.2415, 0.6775]]], [[[0.7361, 0.1893]]], [[[0.4418, 0.6413]]]],[0, 0], 1, 1, true, 1, 1, Con14411), 
exec_layers([LELU79746,LRes37290,LRes7626,LZer4462,LFla69446,LSub92929,LCon86087,LSub84969,LRes36573,LRes77518,LCon14411],["ELU79746","Res37290","Res7626","Zer4462","Fla69446","Sub92929","Con86087","Sub84969","Res36573","Res77518","Con14411"],Con14411,"Con14411")

Actual (Unparsed): [[[[0.5763023, 0.4364166]], [[0.4563168, 0.5788263]], [[0.5326401, 0.6744580]], [[0.3949929, 0.4545079]], [[0.3231820, 0.6401120]], [[0.3990573, 0.2647803]], [[-0.0054026, -0.2520218]], [[-0.7927652, -0.6589483]]]]

Expected (Unparsed): [[[[0.57630234,0.43641657]],[[0.45631677000000004,0.5788263300000001]],[[0.5326401100000001,0.6744579600000001]],[[0.3949928800000001,0.45450795]],[[0.3231820199999999,0.6401119600000003]],[[0.39905731,0.26478029]],[[-0.0054025799999999485,-0.25202177]],[[-0.7927651399999999,-0.65894825]]]]

Actual:   [[[[0.5764, 0.4365]], [[0.4564, 0.5789]], [[0.5327, 0.6745]], [[0.395, 0.4546]], [[0.3232, 0.6402]], [[0.3991, 0.2648]], [[-0.0054, -0.252]], [[-0.7927, -0.6589]]]]

Expected: [[[[0.5764, 0.4365]], [[0.4564, 0.5789]], [[0.5327, 0.6745]], [[0.395, 0.4546]], [[0.3232, 0.6402]], [[0.3991, 0.2648]], [[-0.0054, -0.252]], [[-0.7927, -0.6589]]]]