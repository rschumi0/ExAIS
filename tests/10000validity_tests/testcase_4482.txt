import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max81400 = tf.keras.layers.Input(shape=([2, 1]))
in0Con27753 = tf.keras.layers.Input(shape=([2, 3, 3, 2]))
in0Sub78987 = tf.keras.layers.Input(shape=([2, 3, 3, 3]))
in1Sub78987 = tf.keras.layers.Input(shape=([2, 3, 3, 3]))

Max81400 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='valid', name = 'Max81400', )(in0Max81400)
Res79068 = keras.layers.Reshape((1, 1, 1), name = 'Res79068', )(Max81400)
Res99150 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res99150', )(Res79068)
Zer31084 = keras.layers.ZeroPadding3D(padding=((1, 0), (2, 0), (2, 0)), name = 'Zer31084', )(Res99150)
Con27753 = keras.layers.Concatenate(axis=4, name = 'Con27753', )([Zer31084,in0Con27753])
Sub78987 = keras.layers.Subtract(name = 'Sub78987', )([in0Sub78987,in1Sub78987])
Sub78834 = keras.layers.Subtract(name = 'Sub78834', )([Con27753,Sub78987])
Res4201 = keras.layers.Reshape((2, 3, 9), name = 'Res4201', )(Sub78834)
Res60099 = keras.layers.Reshape((2, 27), name = 'Res60099', )(Res4201)
Glo7504 = keras.layers.GlobalAveragePooling1D(name = 'Glo7504', )(Res60099)
Res61833 = keras.layers.Reshape((27, 1), name = 'Res61833', )(Glo7504)
Res74126 = keras.layers.Reshape((27, 1, 1), name = 'Res74126', )(Res61833)
Res29821 = keras.layers.Reshape((27, 1, 1, 1), name = 'Res29821', )(Res74126)
Glo58029 = keras.layers.GlobalAveragePooling3D(name = 'Glo58029', )(Res29821)
model = tf.keras.models.Model(inputs=[in0Max81400,in0Con27753,in0Sub78987,in1Sub78987], outputs=Glo58029)
in0Max81400 = tf.constant([[[1.8819], [1.9873]]])
in0Con27753 = tf.constant([[[[[0.2305, 0.0682], [0.4192, 0.4297], [0.6014, 0.239]], [[0.3214, 0.1488], [0.8535, 0.2536], [0.8338, 0.5718]], [[0.5748, 0.1829], [0.2055, 0.3138], [0.2245, 0.1794]]], [[[0.5613, 0.7498], [0.9819, 0.7221], [0.5476, 0.5216]], [[0.6787, 0.9384], [0.224, 0.1305], [0.302, 0.8841]], [[0.7516, 0.7452], [0.9646, 0.5112], [0.0287, 0.5307]]]]])
in0Sub78987 = tf.constant([[[[[0.7766, 0.6968, 0.3732], [0.3561, 0.3849, 0.912], [0.412, 0.9891, 0.376]], [[0.8238, 0.8135, 0.5788], [0.07, 0.4556, 0.691], [0.8925, 0.9974, 0.4656]], [[0.0115, 0.0891, 0.3948], [0.2736, 0.7232, 0.7605], [0.3601, 0.8788, 0.0243]]], [[[0.7093, 0.2797, 0.196], [0.0005, 0.9847, 0.0653], [0.1341, 0.2971, 0.2369]], [[0.9379, 0.5715, 0.709], [0.0226, 0.9871, 0.8467], [0.5763, 0.2967, 0.4951]], [[0.3741, 0.6529, 0.9584], [0.0675, 0.5192, 0.6799], [0.9864, 0.9377, 0.9251]]]]])
in1Sub78987 = tf.constant([[[[[0.2408, 0.3916, 0.4263], [0.0658, 0.5998, 0.9467], [0.4243, 0.9233, 0.1341]], [[0.4073, 0.9457, 0.3328], [0.6576, 0.7326, 0.2456], [0.7222, 0.4038, 0.6317]], [[0.739, 0.6822, 0.6872], [0.6169, 0.9679, 0.0491], [0.2938, 0.6274, 0.1658]]], [[[0.9546, 0.4657, 0.203], [0.5458, 0.6037, 0.9385], [0.132, 0.3002, 0.378]], [[0.8669, 0.4775, 0.4383], [0.231, 0.6318, 0.8933], [0.0166, 0.2393, 0.4584]], [[0.18, 0.0146, 0.6078], [0.4968, 0.1066, 0.0991], [0.3838, 0.5168, 0.6202]]]]])
print (np.array2string(model.predict([in0Max81400,in0Con27753,in0Sub78987,in1Sub78987],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo58029.png')

LMax81400 = max_pool1D_layer([[[1.8819], [1.9873]]], 2, 1, false, Max81400), 
LRes79068 = reshape_layer(Max81400, [1, 1, 1], Res79068), 
LRes99150 = reshape_layer(Res79068, [1, 1, 1, 1], Res99150), 
LZer31084 = zero_padding3D_layer(Res99150, 1, 0, 2, 0, 2, 0, Zer31084), 
LCon27753 = concatenate_layer([Zer31084,[[[[[0.2305, 0.0682], [0.4192, 0.4297], [0.6014, 0.239]], [[0.3214, 0.1488], [0.8535, 0.2536], [0.8338, 0.5718]], [[0.5748, 0.1829], [0.2055, 0.3138], [0.2245, 0.1794]]], [[[0.5613, 0.7498], [0.9819, 0.7221], [0.5476, 0.5216]], [[0.6787, 0.9384], [0.224, 0.1305], [0.302, 0.8841]], [[0.7516, 0.7452], [0.9646, 0.5112], [0.0287, 0.5307]]]]]], 4, Con27753), 
LSub78987 = subtract_layer([[[[[0.7766, 0.6968, 0.3732], [0.3561, 0.3849, 0.912], [0.412, 0.9891, 0.376]], [[0.8238, 0.8135, 0.5788], [0.07, 0.4556, 0.691], [0.8925, 0.9974, 0.4656]], [[0.0115, 0.0891, 0.3948], [0.2736, 0.7232, 0.7605], [0.3601, 0.8788, 0.0243]]], [[[0.7093, 0.2797, 0.196], [0.0005, 0.9847, 0.0653], [0.1341, 0.2971, 0.2369]], [[0.9379, 0.5715, 0.709], [0.0226, 0.9871, 0.8467], [0.5763, 0.2967, 0.4951]], [[0.3741, 0.6529, 0.9584], [0.0675, 0.5192, 0.6799], [0.9864, 0.9377, 0.9251]]]]], [[[[[0.2408, 0.3916, 0.4263], [0.0658, 0.5998, 0.9467], [0.4243, 0.9233, 0.1341]], [[0.4073, 0.9457, 0.3328], [0.6576, 0.7326, 0.2456], [0.7222, 0.4038, 0.6317]], [[0.739, 0.6822, 0.6872], [0.6169, 0.9679, 0.0491], [0.2938, 0.6274, 0.1658]]], [[[0.9546, 0.4657, 0.203], [0.5458, 0.6037, 0.9385], [0.132, 0.3002, 0.378]], [[0.8669, 0.4775, 0.4383], [0.231, 0.6318, 0.8933], [0.0166, 0.2393, 0.4584]], [[0.18, 0.0146, 0.6078], [0.4968, 0.1066, 0.0991], [0.3838, 0.5168, 0.6202]]]]], Sub78987), 
LSub78834 = subtract_layer(Con27753,Sub78987, Sub78834), 
LRes4201 = reshape_layer(Sub78834, [2, 3, 9], Res4201), 
LRes60099 = reshape_layer(Res4201, [2, 27], Res60099), 
LGlo7504 = global_average_pooling1D_layer(Res60099, Glo7504), 
LRes61833 = reshape_layer(Glo7504, [27, 1], Res61833), 
LRes74126 = reshape_layer(Res61833, [27, 1, 1], Res74126), 
LRes29821 = reshape_layer(Res74126, [27, 1, 1, 1], Res29821), 
LGlo58029 = global_average_pooling3D_layer(Res29821, Glo58029), 
exec_layers([LMax81400,LRes79068,LRes99150,LZer31084,LCon27753,LSub78987,LSub78834,LRes4201,LRes60099,LGlo7504,LRes61833,LRes74126,LRes29821,LGlo58029],["Max81400","Res79068","Res99150","Zer31084","Con27753","Sub78987","Sub78834","Res4201","Res60099","Glo7504","Res61833","Res74126","Res29821","Glo58029"],Glo58029,"Glo58029")

Actual (Unparsed): [[0.3008556]]

Expected (Unparsed): [[0.3008555555555556]]

Actual:   [[0.3009]]

Expected: [[0.3009]]