import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave17070 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave17070 = tf.keras.layers.Input(shape=([2, 2]))

Ave17070 = keras.layers.Average(name = 'Ave17070', )([in0Ave17070,in1Ave17070])
Cro79435 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro79435', )(Ave17070)
Res7771 = keras.layers.Reshape((1, 2, 1), name = 'Res7771', )(Cro79435)
PRe2813 = keras.layers.PReLU(name = 'PRe2813', )(Res7771)
Mas85080 = keras.layers.Masking(mask_value=2, name = 'Mas85080', )(PRe2813)
model = tf.keras.models.Model(inputs=[in0Ave17070,in1Ave17070], outputs=Mas85080)
w = model.get_layer('PRe2813').get_weights() 
w[0] = np.array([[[0.6964], [0.5384]]])
model.get_layer('PRe2813').set_weights(w) 
in0Ave17070 = tf.constant([[[0.4351, 0.0447], [0.2307, 0.933]]])
in1Ave17070 = tf.constant([[[0.6577, 0.275], [0.0074, 0.2411]]])
print (np.array2string(model.predict([in0Ave17070,in1Ave17070],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mas85080.png')

LAve17070 = average_layer([[[[0.4351, 0.0447], [0.2307, 0.933]]], [[[0.6577, 0.275], [0.0074, 0.2411]]]], Ave17070), 
LCro79435 = cropping1D_layer(Ave17070, 0, 1, Cro79435), 
LRes7771 = reshape_layer(Cro79435, [1, 2, 1], Res7771), 
LPRe2813 = prelu_layer(Res7771, [[[0.6964], [0.5384]]], PRe2813), 
LMas85080 = masking_layer(PRe2813, 2, Mas85080), 
exec_layers([LAve17070,LCro79435,LRes7771,LPRe2813,LMas85080],["Ave17070","Cro79435","Res7771","PRe2813","Mas85080"],Mas85080,"Mas85080")

Actual (Unparsed): [[[[0.5464000], [0.1598500]]]]

Expected (Unparsed): [[[[0.5464],[0.15985000000000002]]]]

Actual:   [[[[0.5464], [0.1599]]]]

Expected: [[[[0.5464], [0.1599]]]]