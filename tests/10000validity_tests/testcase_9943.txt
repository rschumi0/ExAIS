import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max96087 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max96087 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Max96087 = keras.layers.Maximum(name = 'Max96087', )([in0Max96087,in1Max96087])
Res59651 = keras.layers.Reshape((2, 2, 2), name = 'Res59651', )(Max96087)
Res5231 = keras.layers.Reshape((2, 4), name = 'Res5231', )(Res59651)
Sim43765 = keras.layers.SimpleRNN(2,name = 'Sim43765', )(Res5231)
Res9884 = keras.layers.Reshape((2, 1), name = 'Res9884', )(Sim43765)
Res92452 = keras.layers.Reshape((2, 1, 1), name = 'Res92452', )(Res9884)
Res20159 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res20159', )(Res92452)
Up_12316 = keras.layers.UpSampling3D(size=(2, 1, 2), name = 'Up_12316', )(Res20159)
model = tf.keras.models.Model(inputs=[in0Max96087,in1Max96087], outputs=Up_12316)
w = model.get_layer('Sim43765').get_weights() 
w[0] = np.array([[7, 4], [10, 9], [10, 4], [10, 10]])
w[1] = np.array([[3, 8], [5, 7]])
w[2] = np.array([7, 7])
model.get_layer('Sim43765').set_weights(w) 
in0Max96087 = tf.constant([[[[[0.608, 0.6961]], [[0.8707, 0.7497]]], [[[0.3096, 0.2326]], [[0.6106, 0.677]]]]])
in1Max96087 = tf.constant([[[[[0.8589, 0.6683]], [[0.5183, 0.4548]]], [[[0.1907, 0.4819]], [[0.1922, 0.5292]]]]])
print (np.array2string(model.predict([in0Max96087,in1Max96087],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Up_12316.png')

LMax96087 = maximum_layer([[[[[[0.608, 0.6961]], [[0.8707, 0.7497]]], [[[0.3096, 0.2326]], [[0.6106, 0.677]]]]], [[[[[0.8589, 0.6683]], [[0.5183, 0.4548]]], [[[0.1907, 0.4819]], [[0.1922, 0.5292]]]]]], Max96087), 
LRes59651 = reshape_layer(Max96087, [2, 2, 2], Res59651), 
LRes5231 = reshape_layer(Res59651, [2, 4], Res5231), 
LSim43765 = simple_rnn_layer(Res5231,[[7, 4], [10, 9], [10, 4], [10, 10]],[[3, 8], [5, 7]],[7, 7], Sim43765), 
LRes9884 = reshape_layer(Sim43765, [2, 1], Res9884), 
LRes92452 = reshape_layer(Res9884, [2, 1, 1], Res92452), 
LRes20159 = reshape_layer(Res92452, [2, 1, 1, 1], Res20159), 
LUp_12316 = up_sampling3D_layer(Res20159, 2, 1, 2, Up_12316), 
exec_layers([LMax96087,LRes59651,LRes5231,LSim43765,LRes9884,LRes92452,LRes20159,LUp_12316],["Max96087","Res59651","Res5231","Sim43765","Res9884","Res92452","Res20159","Up_12316"],Up_12316,"Up_12316")

Actual (Unparsed): [[[[[1.0000000], [1.0000000]]], [[[1.0000000], [1.0000000]]], [[[1.0000000], [1.0000000]]], [[[1.0000000], [1.0000000]]]]]

Expected (Unparsed): [[[[[1.0],[1.0]]],[[[1.0],[1.0]]],[[[1.0],[1.0]]],[[[1.0],[1.0]]]]]

Actual:   [[[[[1], [1]]], [[[1], [1]]], [[[1], [1]]], [[[1], [1]]]]]

Expected: [[[[[1], [1]]], [[[1], [1]]], [[[1], [1]]], [[[1], [1]]]]]