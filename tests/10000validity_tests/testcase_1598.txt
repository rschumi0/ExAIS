import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max14402 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max14402 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Cro69178 = tf.keras.layers.Input(shape=([3, 3]))
in0Con21887 = tf.keras.layers.Input(shape=([44]))
in0Loc35497 = tf.keras.layers.Input(shape=([1, 2]))
in0Con85360 = tf.keras.layers.Input(shape=([2, 6, 3]))
in0Con35599 = tf.keras.layers.Input(shape=([2, 2, 1]))

Max14402 = keras.layers.Maximum(name = 'Max14402', )([in0Max14402,in1Max14402])
Res36956 = keras.layers.Reshape((1, 2), name = 'Res36956', )(Max14402)
Zer1413 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer1413', )(Res36956)
Cro69178 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro69178', )(in0Cro69178)
Sep82856 = keras.layers.SeparableConv1D(2, (1),strides=(1), padding='same', name = 'Sep82856', )(Cro69178)
Sub29771 = keras.layers.Subtract(name = 'Sub29771', )([Zer1413,Sep82856])
Fla93080 = keras.layers.Flatten(name = 'Fla93080', )(Sub29771)
Con21887 = keras.layers.Concatenate(axis=1, name = 'Con21887', )([Fla93080,in0Con21887])
Loc35497 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc35497', )(in0Loc35497)
Res22454 = keras.layers.Reshape((1, 4, 1), name = 'Res22454', )(Loc35497)
Zer70023 = keras.layers.ZeroPadding2D(padding=((1, 0), (2, 0)), name = 'Zer70023', )(Res22454)
Con85360 = keras.layers.Concatenate(axis=3, name = 'Con85360', )([Zer70023,in0Con85360])
Con35599 = keras.layers.Conv2D(4, (2, 2),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con35599', )(in0Con35599)
Zer89977 = keras.layers.ZeroPadding2D(padding=((0, 0), (4, 0)), name = 'Zer89977', )(Con35599)
Sub79019 = keras.layers.Subtract(name = 'Sub79019', )([Con85360,Zer89977])
Fla15454 = keras.layers.Flatten(name = 'Fla15454', )(Sub79019)
Max77145 = keras.layers.Maximum(name = 'Max77145', )([Con21887,Fla15454])
model = tf.keras.models.Model(inputs=[in0Max14402,in1Max14402,in0Cro69178,in0Con21887,in0Loc35497,in0Con85360,in0Con35599], outputs=Max77145)
w = model.get_layer('Sep82856').get_weights() 
w[0] = np.array([[[0.2312], [0.4843], [0.8634]]])
w[1] = np.array([[[0.2594, 0.3148], [0.0165, 0.3645], [0.265, 0.6206]]])
w[2] = np.array([0, 0])
model.get_layer('Sep82856').set_weights(w) 
w = model.get_layer('Loc35497').get_weights() 
w[0] = np.array([[[0.471, 0.8179, 0.3752, 0.2667], [0.7735, 0.3346, 0.209, 0.0286]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc35497').set_weights(w) 
w = model.get_layer('Con35599').get_weights() 
w[0] = np.array([[[[0.8285, 0.9637, 0.6475, 0.2385]], [[0.4208, 0.5606, 0.4724, 0.8957]]], [[[0.8273, 0.7717, 0.0411, 0.6787]], [[0.9391, 0.3258, 0.1789, 0.4128]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con35599').set_weights(w) 
in0Max14402 = tf.constant([[[[0.8115, 0.0217]]]])
in1Max14402 = tf.constant([[[[0.6447, 0.988]]]])
in0Cro69178 = tf.constant([[[1.7468, 1.4883, 1.0183], [1.9662, 1.7071, 1.6513], [1.1981, 1.621, 1.3328]]])
in0Con21887 = tf.constant([[0.8502, 0.9357, 0.5934, 0.2147, 0.0667, 0.6789, 0.9238, 0.2745, 0.7483, 0.023, 0.7409, 0.2981, 0.2439, 0.6151, 0.1627, 0.7637, 0.2967, 0.613, 0.4939, 0.1015, 0.8839, 0.9556, 0.6613, 0.3993, 0.7422, 0.2206, 0.3432, 0.905, 0.1501, 0.3846, 0.2893, 0.1498, 0.0852, 0.8203, 0.3907, 0.6769, 0.7026, 0.4274, 0.9052, 0.5609, 0.1923, 0.8764, 0.8674, 0.1264]])
in0Loc35497 = tf.constant([[[0.8918, 0.055]]])
in0Con85360 = tf.constant([[[[0.6014, 0.3472, 0.7725], [0.9879, 0.3569, 0.0608], [0.9421, 0.7101, 0.1169], [0.5641, 0.0896, 0.7503], [0.2635, 0.3565, 0.137], [0.4678, 0.404, 0.822]], [[0.6601, 0.8724, 0.0703], [0.2334, 0.1273, 0.384], [0.8999, 0.2513, 0.1263], [0.195, 0.1032, 0.6347], [0.5283, 0.4284, 0.5015], [0.3432, 0.5367, 0.8911]]]])
in0Con35599 = tf.constant([[[[0.2125], [0.5566]], [[0.8843], [0.433]]]])
print (np.array2string(model.predict([in0Max14402,in1Max14402,in0Cro69178,in0Con21887,in0Loc35497,in0Con85360,in0Con35599],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max77145.png')

LMax14402 = maximum_layer([[[[[0.8115, 0.0217]]]], [[[[0.6447, 0.988]]]]], Max14402), 
LRes36956 = reshape_layer(Max14402, [1, 2], Res36956), 
LZer1413 = zero_padding1D_layer(Res36956, 1, 0, Zer1413), 
LCro69178 = cropping1D_layer([[[1.7468, 1.4883, 1.0183], [1.9662, 1.7071, 1.6513], [1.1981, 1.621, 1.3328]]], 0, 1, Cro69178), 
LSep82856 = separable_conv1D_layer(Cro69178, 1,[[[[0.2312], [0.4843], [0.8634]]],[[[0.2594, 0.3148], [0.0165, 0.3645], [0.265, 0.6206]]]],[0, 0], 1, true, Sep82856), 
LSub29771 = subtract_layer(Zer1413,Sep82856, Sub29771), 
LFla93080 = flatten_layer(Sub29771, Fla93080), 
LCon21887 = concatenate_layer([Fla93080,[[0.8502, 0.9357, 0.5934, 0.2147, 0.0667, 0.6789, 0.9238, 0.2745, 0.7483, 0.023, 0.7409, 0.2981, 0.2439, 0.6151, 0.1627, 0.7637, 0.2967, 0.613, 0.4939, 0.1015, 0.8839, 0.9556, 0.6613, 0.3993, 0.7422, 0.2206, 0.3432, 0.905, 0.1501, 0.3846, 0.2893, 0.1498, 0.0852, 0.8203, 0.3907, 0.6769, 0.7026, 0.4274, 0.9052, 0.5609, 0.1923, 0.8764, 0.8674, 0.1264]]], 1, Con21887), 
LLoc35497 = locally_connected1D_layer([[[0.8918, 0.055]]], 1,[[[0.471, 0.8179, 0.3752, 0.2667], [0.7735, 0.3346, 0.209, 0.0286]]],[[0, 0, 0, 0]], 1, Loc35497), 
LRes22454 = reshape_layer(Loc35497, [1, 4, 1], Res22454), 
LZer70023 = zero_padding2D_layer(Res22454, 1, 0, 2, 0, Zer70023), 
LCon85360 = concatenate_layer([Zer70023,[[[[0.6014, 0.3472, 0.7725], [0.9879, 0.3569, 0.0608], [0.9421, 0.7101, 0.1169], [0.5641, 0.0896, 0.7503], [0.2635, 0.3565, 0.137], [0.4678, 0.404, 0.822]], [[0.6601, 0.8724, 0.0703], [0.2334, 0.1273, 0.384], [0.8999, 0.2513, 0.1263], [0.195, 0.1032, 0.6347], [0.5283, 0.4284, 0.5015], [0.3432, 0.5367, 0.8911]]]]], 3, Con85360), 
LCon35599 = conv2D_layer([[[[0.2125], [0.5566]], [[0.8843], [0.433]]]], 2, 2,[[[[0.8285, 0.9637, 0.6475, 0.2385]], [[0.4208, 0.5606, 0.4724, 0.8957]]], [[[0.8273, 0.7717, 0.0411, 0.6787]], [[0.9391, 0.3258, 0.1789, 0.4128]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con35599), 
LZer89977 = zero_padding2D_layer(Con35599, 0, 0, 4, 0, Zer89977), 
LSub79019 = subtract_layer(Con85360,Zer89977, Sub79019), 
LFla15454 = flatten_layer(Sub79019, Fla15454), 
LMax77145 = maximum_layer([Con21887,Fla15454], Max77145), 
exec_layers([LMax14402,LRes36956,LZer1413,LCro69178,LSep82856,LSub29771,LFla93080,LCon21887,LLoc35497,LRes22454,LZer70023,LCon85360,LCon35599,LZer89977,LSub79019,LFla15454,LMax77145],["Max14402","Res36956","Zer1413","Cro69178","Sep82856","Sub29771","Fla93080","Con21887","Loc35497","Res22454","Zer70023","Con85360","Con35599","Zer89977","Sub79019","Fla15454","Max77145"],Max77145,"Max77145")

Actual (Unparsed): [[0.0000000, 0.6014000, 0.3472000, 0.7725000, 0.8502000, 0.9879000, 0.5934000, 0.2147000, 0.0667000, 0.9421000, 0.9238000, 0.2745000, 0.7483000, 0.5641000, 0.7409000, 0.7503000, 0.2439000, 0.6151000, 0.1627000, 0.7637000, 0.2967000, 0.6130000, 0.4939000, 0.3953738, 0.8839000, 0.9556000, 0.8724000, 0.3993000, 0.7422000, 0.2334000, 0.3432000, 0.9050000, 0.4625803, 0.8999000, 0.2893000, 0.1498000, 0.7478062, 0.8203000, 0.3907000, 0.6769000, 0.7026000, 0.4274000, 0.9052000, 0.5609000, 0.1923000, 0.8764000, 0.8674000, 0.7878295]]

Expected (Unparsed): [[0,0.6014,0.3472,0.7725,0.8502,0.9879,0.5934,0.2147,0.0667,0.9421,0.9238,0.2745,0.7483,0.5641,0.7409,0.7503,0.2439,0.6151,0.1627,0.7637,0.2967,0.613,0.4939,0.3953738,0.8839,0.9556,0.8724,0.3993,0.7422,0.2334,0.3432,0.905,0.4625803,0.8999,0.2893,0.1498,0.74780622,0.8203,0.3907,0.6769,0.7026,0.4274,0.9052,0.5609,0.1923,0.8764,0.8674,0.7878295]]

Actual:   [[0, 0.6014, 0.3472, 0.7725, 0.8502, 0.9879, 0.5934, 0.2147, 0.0667, 0.9421, 0.9238, 0.2745, 0.7483, 0.5641, 0.7409, 0.7503, 0.2439, 0.6151, 0.1627, 0.7637, 0.2967, 0.613, 0.4939, 0.3954, 0.8839, 0.9556, 0.8724, 0.3993, 0.7422, 0.2334, 0.3432, 0.905, 0.4626, 0.8999, 0.2893, 0.1498, 0.7479, 0.8203, 0.3907, 0.6769, 0.7026, 0.4274, 0.9052, 0.5609, 0.1923, 0.8764, 0.8674, 0.7879]]

Expected: [[0, 0.6014, 0.3472, 0.7725, 0.8502, 0.9879, 0.5934, 0.2147, 0.0667, 0.9421, 0.9238, 0.2745, 0.7483, 0.5641, 0.7409, 0.7503, 0.2439, 0.6151, 0.1627, 0.7637, 0.2967, 0.613, 0.4939, 0.3954, 0.8839, 0.9556, 0.8724, 0.3993, 0.7422, 0.2334, 0.3432, 0.905, 0.4626, 0.8999, 0.2893, 0.1498, 0.7479, 0.8203, 0.3907, 0.6769, 0.7026, 0.4274, 0.9052, 0.5609, 0.1923, 0.8764, 0.8674, 0.7879]]