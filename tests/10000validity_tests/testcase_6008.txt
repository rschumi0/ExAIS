import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Up_67130 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Con49330 = tf.keras.layers.Input(shape=([6, 8]))
in0Zer5796 = tf.keras.layers.Input(shape=([2, 1, 4]))

Up_67130 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_67130', )(in0Up_67130)
Sep2281 = keras.layers.SeparableConv2D(2, (3, 1),strides=(4, 4), padding='valid', name = 'Sep2281', )(Up_67130)
Zer25442 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer25442', )(Sep2281)
Dep5068 = keras.layers.DepthwiseConv2D((2, 2),strides=(1, 1), padding='valid', name = 'Dep5068', )(Zer25442)
Res65713 = keras.layers.Reshape((2, 4), name = 'Res65713', )(Dep5068)
Zer42540 = keras.layers.ZeroPadding1D(padding=((4, 0)), name = 'Zer42540', )(Res65713)
Con49330 = keras.layers.Concatenate(axis=2, name = 'Con49330', )([Zer42540,in0Con49330])
Zer5796 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer5796', )(in0Zer5796)
Res26356 = keras.layers.Reshape((4, 12), name = 'Res26356', )(Zer5796)
Up_52467 = keras.layers.UpSampling1D(size=(1), name = 'Up_52467', )(Res26356)
Zer96180 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer96180', )(Up_52467)
Add15127 = keras.layers.Add(name = 'Add15127', )([Con49330,Zer96180])
model = tf.keras.models.Model(inputs=[in0Up_67130,in0Con49330,in0Zer5796], outputs=Add15127)
w = model.get_layer('Sep2281').get_weights() 
w[0] = np.array([[[[0.2799], [0.1477]]], [[[0.1411], [0.6146]]], [[[0.0044], [0.2708]]]])
w[1] = np.array([[[[0.6113, 0.6805], [0.8433, 0.0542]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep2281').set_weights(w) 
w = model.get_layer('Dep5068').get_weights() 
w[0] = np.array([[[[0.0535], [0.4715]], [[0.2366], [0.367]]], [[[0.452], [0.3646]], [[0.1666], [0.9]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep5068').set_weights(w) 
in0Up_67130 = tf.constant([[[[1.1276, 1.4931], [1.4458, 1.5677]], [[1.6653, 1.7273], [1.2928, 1.6132]]]])
in0Con49330 = tf.constant([[[0.371, 0.7859, 0.3529, 0.3975, 0.6366, 0.5371, 0.8442, 0.9735], [0.6748, 0.3533, 0.2865, 0.6306, 0.5016, 0.801, 0.7857, 0.1091], [0.4413, 0.0951, 0.336, 0.7984, 0.5877, 0.3385, 0.0697, 0.0356], [0.0005, 0.4438, 0.6416, 0.7571, 0.6474, 0.2908, 0.5618, 0.2621], [0.537, 0.2111, 0.5014, 0.7718, 0.7083, 0.4645, 0.075, 0.9353], [0.7462, 0.9718, 0.3752, 0.421, 0.2702, 0.206, 0.5794, 0.2627]]])
in0Zer5796 = tf.constant([[[[1.9158, 1.6328, 1.8428, 1.4759]], [[1.6079, 1.962, 1.8878, 1.2169]]]])
print (np.array2string(model.predict([in0Up_67130,in0Con49330,in0Zer5796],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add15127.png')

LUp_67130 = up_sampling2D_layer([[[[1.1276, 1.4931], [1.4458, 1.5677]], [[1.6653, 1.7273], [1.2928, 1.6132]]]], 2, 1, Up_67130), 
LSep2281 = separable_conv2D_layer(Up_67130, 3, 1,[[[[[0.2799], [0.1477]]], [[[0.1411], [0.6146]]], [[[0.0044], [0.2708]]]],[[[[0.6113, 0.6805], [0.8433, 0.0542]]]]],[0, 0], 4, 4, false, Sep2281), 
LZer25442 = zero_padding2D_layer(Sep2281, 1, 1, 1, 1, Zer25442), 
LDep5068 = depthwise_conv2D_layer(Zer25442, 2, 2,[[[[0.0535], [0.4715]], [[0.2366], [0.367]]], [[[0.452], [0.3646]], [[0.1666], [0.9]]]],[0, 0], 1, 1, false, Dep5068), 
LRes65713 = reshape_layer(Dep5068, [2, 4], Res65713), 
LZer42540 = zero_padding1D_layer(Res65713, 4, 0, Zer42540), 
LCon49330 = concatenate_layer([Zer42540,[[[0.371, 0.7859, 0.3529, 0.3975, 0.6366, 0.5371, 0.8442, 0.9735], [0.6748, 0.3533, 0.2865, 0.6306, 0.5016, 0.801, 0.7857, 0.1091], [0.4413, 0.0951, 0.336, 0.7984, 0.5877, 0.3385, 0.0697, 0.0356], [0.0005, 0.4438, 0.6416, 0.7571, 0.6474, 0.2908, 0.5618, 0.2621], [0.537, 0.2111, 0.5014, 0.7718, 0.7083, 0.4645, 0.075, 0.9353], [0.7462, 0.9718, 0.3752, 0.421, 0.2702, 0.206, 0.5794, 0.2627]]]], 2, Con49330), 
LZer5796 = zero_padding2D_layer([[[[1.9158, 1.6328, 1.8428, 1.4759]], [[1.6079, 1.962, 1.8878, 1.2169]]]], 1, 1, 1, 1, Zer5796), 
LRes26356 = reshape_layer(Zer5796, [4, 12], Res26356), 
LUp_52467 = up_sampling1D_layer(Res26356, 1, Up_52467), 
LZer96180 = zero_padding1D_layer(Up_52467, 1, 1, Zer96180), 
LAdd15127 = add_layer([Con49330,Zer96180], Add15127), 
exec_layers([LUp_67130,LSep2281,LZer25442,LDep5068,LRes65713,LZer42540,LCon49330,LZer5796,LRes26356,LUp_52467,LZer96180,LAdd15127],["Up_67130","Sep2281","Zer25442","Dep5068","Res65713","Zer42540","Con49330","Zer5796","Res26356","Up_52467","Zer96180","Add15127"],Add15127,"Add15127")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.3710000, 0.7859000, 0.3529000, 0.3975000, 0.6366000, 0.5371000, 0.8442000, 0.9735000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.6748000, 0.3533000, 0.2865000, 0.6306000, 0.5016000, 0.8010000, 0.7857000, 0.1091000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 2.3571000, 1.7279000, 2.1788000, 2.2743000, 0.5877000, 0.3385000, 0.0697000, 0.0356000], [0.0000000, 0.0000000, 0.0000000, 0.0000000, 1.6084000, 2.4058000, 2.5294000, 1.9740000, 0.6474000, 0.2908000, 0.5618000, 0.2621000], [0.2747179, 0.3735675, 0.7453331, 0.1513364, 0.5370000, 0.2111000, 0.5014000, 0.7718000, 0.7083000, 0.4645000, 0.0750000, 0.9353000], [0.3901456, 0.1523325, 0.0882197, 0.1957079, 0.7462000, 0.9718000, 0.3752000, 0.4210000, 0.2702000, 0.2060000, 0.5794000, 0.2627000]]]

Expected (Unparsed): [[[0,0,0,0,0.371,0.7859,0.3529,0.3975,0.6366,0.5371,0.8442,0.9735],[0,0,0,0,0.6748,0.3533,0.2865,0.6306,0.5016,0.801,0.7857,0.1091],[0,0,0,0,2.3571,1.7279,2.1788,2.2743,0.5877,0.3385,0.0697,0.0356],[0,0,0,0,1.6084,2.4058,2.5294,1.9740000000000002,0.6474,0.2908,0.5618,0.2621],[0.27471790033358023,0.3735675342306,0.7453330789362441,0.1513363588671964,0.537,0.2111,0.5014,0.7718,0.7083,0.4645,0.075,0.9353],[0.39014558954937023,0.152332538958478,0.08821973390063952,0.195707880433031,0.7462,0.9718,0.3752,0.421,0.2702,0.206,0.5794,0.2627]]]

Actual:   [[[0, 0, 0, 0, 0.371, 0.7859, 0.3529, 0.3975, 0.6366, 0.5371, 0.8442, 0.9735], [0, 0, 0, 0, 0.6748, 0.3533, 0.2865, 0.6306, 0.5016, 0.801, 0.7857, 0.1091], [0, 0, 0, 0, 2.3571, 1.7279, 2.1788, 2.2743, 0.5877, 0.3385, 0.0697, 0.0356], [0, 0, 0, 0, 1.6084, 2.4058, 2.5294, 1.974, 0.6474, 0.2908, 0.5618, 0.2621], [0.2748, 0.3736, 0.7454, 0.1514, 0.537, 0.2111, 0.5014, 0.7718, 0.7083, 0.4645, 0.075, 0.9353], [0.3902, 0.1524, 0.0883, 0.1958, 0.7462, 0.9718, 0.3752, 0.421, 0.2702, 0.206, 0.5794, 0.2627]]]

Expected: [[[0, 0, 0, 0, 0.371, 0.7859, 0.3529, 0.3975, 0.6366, 0.5371, 0.8442, 0.9735], [0, 0, 0, 0, 0.6748, 0.3533, 0.2865, 0.6306, 0.5016, 0.801, 0.7857, 0.1091], [0, 0, 0, 0, 2.3571, 1.7279, 2.1788, 2.2743, 0.5877, 0.3385, 0.0697, 0.0356], [0, 0, 0, 0, 1.6084, 2.4058, 2.5294, 1.9741, 0.6474, 0.2908, 0.5618, 0.2621], [0.2748, 0.3736, 0.7454, 0.1514, 0.537, 0.2111, 0.5014, 0.7718, 0.7083, 0.4645, 0.075, 0.9353], [0.3902, 0.1524, 0.0883, 0.1958, 0.7462, 0.9718, 0.3752, 0.421, 0.2702, 0.206, 0.5794, 0.2627]]]