import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max28305 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Max28305 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Mul26584 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul26584 = tf.keras.layers.Input(shape=([2, 2]))
in0Max97618 = tf.keras.layers.Input(shape=([2, 1, 1]))

Max28305 = keras.layers.Maximum(name = 'Max28305', )([in0Max28305,in1Max28305])
Res27463 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res27463', )(Max28305)
Zer37279 = keras.layers.ZeroPadding3D(padding=((1, 0), (3, 0), (0, 0)), name = 'Zer37279', )(Res27463)
Mul26584 = keras.layers.Multiply(name = 'Mul26584', )([in0Mul26584,in1Mul26584])
Res7954 = keras.layers.Reshape((2, 2, 1), name = 'Res7954', )(Mul26584)
Max97618 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max97618', )(in0Max97618)
Zer50823 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer50823', )(Max97618)
Max65592 = keras.layers.Maximum(name = 'Max65592', )([Res7954,Zer50823])
Res12790 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res12790', )(Max65592)
Up_30239 = keras.layers.UpSampling3D(size=(1, 2, 1), name = 'Up_30239', )(Res12790)
Sub75413 = keras.layers.Subtract(name = 'Sub75413', )([Zer37279,Up_30239])
model = tf.keras.models.Model(inputs=[in0Max28305,in1Max28305,in0Mul26584,in1Mul26584,in0Max97618], outputs=Sub75413)
in0Max28305 = tf.constant([[[[0.7006]]]])
in1Max28305 = tf.constant([[[[0.1782]]]])
in0Mul26584 = tf.constant([[[0.6987, 0.2014], [0.9086, 0.0105]]])
in1Mul26584 = tf.constant([[[0.9498, 0.6924], [0.0946, 0.8397]]])
in0Max97618 = tf.constant([[[[1.8963]], [[1.2344]]]])
print (np.array2string(model.predict([in0Max28305,in1Max28305,in0Mul26584,in1Mul26584,in0Max97618],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub75413.png')

LMax28305 = maximum_layer([[[[[0.7006]]]], [[[[0.1782]]]]], Max28305), 
LRes27463 = reshape_layer(Max28305, [1, 1, 1, 1], Res27463), 
LZer37279 = zero_padding3D_layer(Res27463, 1, 0, 3, 0, 0, 0, Zer37279), 
LMul26584 = multiply_layer([[[[0.6987, 0.2014], [0.9086, 0.0105]]], [[[0.9498, 0.6924], [0.0946, 0.8397]]]], Mul26584), 
LRes7954 = reshape_layer(Mul26584, [2, 2, 1], Res7954), 
LMax97618 = max_pool2D_layer([[[[1.8963]], [[1.2344]]]], 2, 1, Max97618), 
LZer50823 = zero_padding2D_layer(Max97618, 1, 0, 1, 0, Zer50823), 
LMax65592 = maximum_layer([Res7954,Zer50823], Max65592), 
LRes12790 = reshape_layer(Max65592, [2, 2, 1, 1], Res12790), 
LUp_30239 = up_sampling3D_layer(Res12790, 1, 2, 1, Up_30239), 
LSub75413 = subtract_layer(Zer37279,Up_30239, Sub75413), 
exec_layers([LMax28305,LRes27463,LZer37279,LMul26584,LRes7954,LMax97618,LZer50823,LMax65592,LRes12790,LUp_30239,LSub75413],["Max28305","Res27463","Zer37279","Mul26584","Res7954","Max97618","Zer50823","Max65592","Res12790","Up_30239","Sub75413"],Sub75413,"Sub75413")

Actual (Unparsed): [[[[[-0.6636253]], [[-0.6636253]], [[-0.1394494]], [[-0.1394494]]], [[[-0.0859536]], [[-0.0859536]], [[-1.8963000]], [[-1.1956999]]]]]

Expected (Unparsed): [[[[[-0.66362526]],[[-0.66362526]],[[-0.13944936]],[[-0.13944936]]],[[[-0.08595356]],[[-0.08595356]],[[-1.8963]],[[-1.1957]]]]]

Actual:   [[[[[-0.6636]], [[-0.6636]], [[-0.1394]], [[-0.1394]]], [[[-0.0859]], [[-0.0859]], [[-1.8963]], [[-1.1956]]]]]

Expected: [[[[[-0.6636]], [[-0.6636]], [[-0.1394]], [[-0.1394]]], [[[-0.0859]], [[-0.0859]], [[-1.8963]], [[-1.1957]]]]]