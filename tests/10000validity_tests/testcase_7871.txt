import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add2929 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add2929 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Ave97758 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Ave97758 = tf.keras.layers.Input(shape=([2, 2, 1]))

Add2929 = keras.layers.Add(name = 'Add2929', )([in0Add2929,in1Add2929])
Zer52045 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer52045', )(Add2929)
Ave97758 = keras.layers.Average(name = 'Ave97758', )([in0Ave97758,in1Ave97758])
Lay57112 = keras.layers.LayerNormalization(axis=1, epsilon=1.8685850217644826, name = 'Lay57112', )(Ave97758)
Max78948 = keras.layers.Maximum(name = 'Max78948', )([Zer52045,Lay57112])
model = tf.keras.models.Model(inputs=[in0Add2929,in1Add2929,in0Ave97758,in1Ave97758], outputs=Max78948)
in0Add2929 = tf.constant([[[[0.4209], [0.8501]]]])
in1Add2929 = tf.constant([[[[0.3293], [0.1075]]]])
in0Ave97758 = tf.constant([[[[0.3091], [0.7892]], [[0.4989], [0.917]]]])
in1Ave97758 = tf.constant([[[[0.8262], [0.0629]], [[0.6054], [0.0089]]]])
print (np.array2string(model.predict([in0Add2929,in1Add2929,in0Ave97758,in1Ave97758],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max78948.png')

LAdd2929 = add_layer([[[[[0.4209], [0.8501]]]], [[[[0.3293], [0.1075]]]]], Add2929), 
LZer52045 = zero_padding2D_layer(Add2929, 1, 0, 0, 0, Zer52045), 
LAve97758 = average_layer([[[[[0.3091], [0.7892]], [[0.4989], [0.917]]]], [[[[0.8262], [0.0629]], [[0.6054], [0.0089]]]]], Ave97758), 
LLay57112 = layer_normalization_layer(Ave97758, 1, 1.8685850217644826, Lay57112), 
LMax78948 = maximum_layer([Zer52045,Lay57112], Max78948), 
exec_layers([LAdd2929,LZer52045,LAve97758,LLay57112,LMax78948],["Add2929","Zer52045","Ave97758","Lay57112","Max78948"],Max78948,"Max78948")

Actual (Unparsed): [[[[0.0056694], [0.0000000]], [[0.7502000], [0.9576000]]]]

Expected (Unparsed): [[[[0.0056694155576494445],[0]],[[0.7502],[0.9576]]]]

Actual:   [[[[0.0057], [0]], [[0.7502], [0.9576]]]]

Expected: [[[[0.0057], [0]], [[0.7502], [0.9576]]]]