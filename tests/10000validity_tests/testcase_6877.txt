import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con34308 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Min86805 = tf.keras.layers.Input(shape=([1, 1]))
in1Min86805 = tf.keras.layers.Input(shape=([1, 1]))
in0Con48138 = tf.keras.layers.Input(shape=([1, 3]))
in0Con63705 = tf.keras.layers.Input(shape=([1, 4, 1]))
in0Add44582 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Add44582 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Add11277 = tf.keras.layers.Input(shape=([1, 2]))
in1Add11277 = tf.keras.layers.Input(shape=([1, 2]))

Con34308 = keras.layers.Conv2DTranspose(4, (1, 1),strides=(1, 1), padding='valid', name = 'Con34308', )(in0Con34308)
Res74212 = keras.layers.Reshape((1, 4), name = 'Res74212', )(Con34308)
Min86805 = keras.layers.Minimum(name = 'Min86805', )([in0Min86805,in1Min86805])
Ave59156 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave59156', )(Min86805)
Con48138 = keras.layers.Concatenate(axis=2, name = 'Con48138', )([Ave59156,in0Con48138])
Sub57194 = keras.layers.Subtract(name = 'Sub57194', )([Res74212,Con48138])
Res95532 = keras.layers.Reshape((1, 4, 1), name = 'Res95532', )(Sub57194)
Con63705 = keras.layers.Concatenate(axis=3, name = 'Con63705', )([Res95532,in0Con63705])
Add44582 = keras.layers.Add(name = 'Add44582', )([in0Add44582,in1Add44582])
Res10698 = keras.layers.Reshape((1, 1, 2), name = 'Res10698', )(Add44582)
Add11277 = keras.layers.Add(name = 'Add11277', )([in0Add11277,in1Add11277])
Res43582 = keras.layers.Reshape((1, 1, 2), name = 'Res43582', )(Add11277)
Add16558 = keras.layers.Add(name = 'Add16558', )([Res10698,Res43582])
Zer82904 = keras.layers.ZeroPadding2D(padding=((0, 0), (3, 0)), name = 'Zer82904', )(Add16558)
Sub85120 = keras.layers.Subtract(name = 'Sub85120', )([Con63705,Zer82904])
model = tf.keras.models.Model(inputs=[in0Con34308,in0Min86805,in1Min86805,in0Con48138,in0Con63705,in0Add44582,in1Add44582,in0Add11277,in1Add11277], outputs=Sub85120)
w = model.get_layer('Con34308').get_weights() 
w[0] = np.array([[[[0.2408, 0.4619], [0.0302, 0.7893], [0.454, 0.038], [0.8609, 0.619]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con34308').set_weights(w) 
in0Con34308 = tf.constant([[[[0.5396, 0.1076]]]])
in0Min86805 = tf.constant([[[0.5993]]])
in1Min86805 = tf.constant([[[0.0454]]])
in0Con48138 = tf.constant([[[0.8633, 0.4425, 0.6726]]])
in0Con63705 = tf.constant([[[[0.5469], [0.5308], [0.3401], [0.1708]]]])
in0Add44582 = tf.constant([[[[[0.5116], [0.1696]]]]])
in1Add44582 = tf.constant([[[[[0.6536], [0.3555]]]]])
in0Add11277 = tf.constant([[[0.1423, 0.6629]]])
in1Add11277 = tf.constant([[[0.0659, 0.4408]]])
print (np.array2string(model.predict([in0Con34308,in0Min86805,in1Min86805,in0Con48138,in0Con63705,in0Add44582,in1Add44582,in0Add11277,in1Add11277],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub85120.png')

LCon34308 = conv2D_transpose_layer([[[[0.5396, 0.1076]]]], 1, 1,[[[[0.2408, 0.4619], [0.0302, 0.7893], [0.454, 0.038], [0.8609, 0.619]]]],[0, 0, 0, 0], 1, 1, false, Con34308), 
LRes74212 = reshape_layer(Con34308, [1, 4], Res74212), 
LMin86805 = minimum_layer([[[[0.5993]]], [[[0.0454]]]], Min86805), 
LAve59156 = average_pooling1D_layer(Min86805, 1, Ave59156), 
LCon48138 = concatenate_layer([Ave59156,[[[0.8633, 0.4425, 0.6726]]]], 2, Con48138), 
LSub57194 = subtract_layer(Res74212,Con48138, Sub57194), 
LRes95532 = reshape_layer(Sub57194, [1, 4, 1], Res95532), 
LCon63705 = concatenate_layer([Res95532,[[[[0.5469], [0.5308], [0.3401], [0.1708]]]]], 3, Con63705), 
LAdd44582 = add_layer([[[[[[0.5116], [0.1696]]]]], [[[[[0.6536], [0.3555]]]]]], Add44582), 
LRes10698 = reshape_layer(Add44582, [1, 1, 2], Res10698), 
LAdd11277 = add_layer([[[[0.1423, 0.6629]]], [[[0.0659, 0.4408]]]], Add11277), 
LRes43582 = reshape_layer(Add11277, [1, 1, 2], Res43582), 
LAdd16558 = add_layer([Res10698,Res43582], Add16558), 
LZer82904 = zero_padding2D_layer(Add16558, 0, 0, 3, 0, Zer82904), 
LSub85120 = subtract_layer(Con63705,Zer82904, Sub85120), 
exec_layers([LCon34308,LRes74212,LMin86805,LAve59156,LCon48138,LSub57194,LRes95532,LCon63705,LAdd44582,LRes10698,LAdd11277,LRes43582,LAdd16558,LZer82904,LSub85120],["Con34308","Res74212","Min86805","Ave59156","Con48138","Sub57194","Res95532","Con63705","Add44582","Res10698","Add11277","Res43582","Add16558","Zer82904","Sub85120"],Sub85120,"Sub85120")

Actual (Unparsed): [[[[0.1342361, 0.5469000], [-0.7620754, 0.5308000], [-0.1934328, 0.3401000], [-1.5148539, -1.4580000]]]]

Expected (Unparsed): [[[[0.13423612000000001,0.5469],[-0.7620754,0.5308],[-0.19343280000000002,0.3401],[-1.51485396,-1.458]]]]

Actual:   [[[[0.1343, 0.5469], [-0.762, 0.5308], [-0.1934, 0.3401], [-1.5148, -1.458]]]]

Expected: [[[[0.1343, 0.5469], [-0.762, 0.5308], [-0.1934, 0.3401], [-1.5148, -1.458]]]]