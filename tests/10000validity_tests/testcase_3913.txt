import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min48315 = tf.keras.layers.Input(shape=([2, 1]))
in1Min48315 = tf.keras.layers.Input(shape=([2, 1]))

Min48315 = keras.layers.Minimum(name = 'Min48315', )([in0Min48315,in1Min48315])
GRU96428 = keras.layers.GRU(2,reset_after=True, recurrent_activation='sigmoid', name = 'GRU96428', )(Min48315)
model = tf.keras.models.Model(inputs=[in0Min48315,in1Min48315], outputs=GRU96428)
w = model.get_layer('GRU96428').get_weights() 
w[0] = np.array([[1, 8, 8, 6, 7, 7]])
w[1] = np.array([[6, 7, 9, 2, 10, 3], [1, 6, 1, 2, 9, 5]])
w[2] = np.array([[9, 8, 5, 7, 9, 9], [2, 7, 6, 3, 9, 7]])
model.get_layer('GRU96428').set_weights(w) 
in0Min48315 = tf.constant([[[0.8947], [0.1918]]])
in1Min48315 = tf.constant([[[0.697], [0.4355]]])
print (np.array2string(model.predict([in0Min48315,in1Min48315],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU96428.png')

LMin48315 = minimum_layer([[[[0.8947], [0.1918]]], [[[0.697], [0.4355]]]], Min48315), 
LGRU96428 = gru_layer(Min48315,[[1, 8, 8, 6, 7, 7]],[[6, 7, 9, 2, 10, 3], [1, 6, 1, 2, 9, 5]],[[9, 8, 5, 7, 9, 9], [2, 7, 6, 3, 9, 7]], true, GRU96428), 
exec_layers([LMin48315,LGRU96428],["Min48315","GRU96428"],GRU96428,"GRU96428")

Actual (Unparsed): [[0.0000221, 0.0000001]]

Expected (Unparsed): [[2.210446137682826e-5,6.710276959773626e-8]]

Actual:   [[0.0001, 0]]

Expected: [[0.0001, 0]]