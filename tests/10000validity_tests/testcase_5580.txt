import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul27180 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Mul27180 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Mul27180 = keras.layers.Multiply(name = 'Mul27180', )([in0Mul27180,in1Mul27180])
Res98567 = keras.layers.Reshape((2, 2, 2), name = 'Res98567', )(Mul27180)
Res26712 = keras.layers.Reshape((2, 4), name = 'Res26712', )(Res98567)
Max89547 = keras.layers.MaxPool1D(pool_size=(2), strides=(1), padding='same', name = 'Max89547', )(Res26712)
Sof20946 = keras.layers.Softmax(axis=1, name = 'Sof20946', )(Max89547)
Res2661 = keras.layers.Reshape((2, 4, 1), name = 'Res2661', )(Sof20946)
Glo45536 = keras.layers.GlobalMaxPool2D(name = 'Glo45536', )(Res2661)
model = tf.keras.models.Model(inputs=[in0Mul27180,in1Mul27180], outputs=Glo45536)
in0Mul27180 = tf.constant([[[[[0.9594, 0.7808]], [[0.0705, 0.7915]]], [[[0.9796, 0.499]], [[0.6826, 0.428]]]]])
in1Mul27180 = tf.constant([[[[[0.4047, 0.1505]], [[0.1398, 0.8045]]], [[[0.1187, 0.1165]], [[0.2336, 0.3624]]]]])
print (np.array2string(model.predict([in0Mul27180,in1Mul27180],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo45536.png')

LMul27180 = multiply_layer([[[[[[0.9594, 0.7808]], [[0.0705, 0.7915]]], [[[0.9796, 0.499]], [[0.6826, 0.428]]]]], [[[[[0.4047, 0.1505]], [[0.1398, 0.8045]]], [[[0.1187, 0.1165]], [[0.2336, 0.3624]]]]]], Mul27180), 
LRes98567 = reshape_layer(Mul27180, [2, 2, 2], Res98567), 
LRes26712 = reshape_layer(Res98567, [2, 4], Res26712), 
LMax89547 = max_pool1D_layer(Res26712, 2, 1, true, Max89547), 
LSof20946 = softmax_layer(Max89547, 1, Sof20946), 
LRes2661 = reshape_layer(Sof20946, [2, 4, 1], Res2661), 
LGlo45536 = global_max_pool2D_layer(Res2661, Glo45536), 
exec_layers([LMul27180,LRes98567,LRes26712,LMax89547,LSof20946,LRes2661,LGlo45536],["Mul27180","Res98567","Res26712","Max89547","Sof20946","Res2661","Glo45536"],Glo45536,"Glo45536")

Actual (Unparsed): [[0.6181385]]

Expected (Unparsed): [[0.6181384964682389]]

Actual:   [[0.6182]]

Expected: [[0.6182]]