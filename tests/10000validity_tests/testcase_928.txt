import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave18480 = tf.keras.layers.Input(shape=([2, 2, 1]))

Ave18480 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave18480', )(in0Ave18480)
Res45082 = keras.layers.Reshape((2, 2), name = 'Res45082', )(Ave18480)
Loc19654 = keras.layers.LocallyConnected1D(4, (2),strides=(1), name = 'Loc19654', )(Res45082)
Res23647 = keras.layers.Reshape((1, 4, 1), name = 'Res23647', )(Loc19654)
Loc59936 = keras.layers.LocallyConnected2D(2, (1, 4),strides=(1, 4), name = 'Loc59936', )(Res23647)
model = tf.keras.models.Model(inputs=[in0Ave18480], outputs=Loc59936)
w = model.get_layer('Loc19654').get_weights() 
w[0] = np.array([[[0.7695, 0.5964, 0.1337, 0.7671], [0.0086, 0.5141, 0.3322, 0.131], [0.1513, 0.5671, 0.6842, 0.4889], [0.8111, 0.5662, 0.2299, 0.2448]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc19654').set_weights(w) 
w = model.get_layer('Loc59936').get_weights() 
w[0] = np.array([[[0.492, 0.0066], [0.3105, 0.5753], [0.8864, 0.7951], [0.4068, 0.7524]]])
w[1] = np.array([[[0, 0]]])
model.get_layer('Loc59936').set_weights(w) 
in0Ave18480 = tf.constant([[[[1.3976], [1.5814]], [[1.4614], [1.3733]]]])
print (np.array2string(model.predict([in0Ave18480],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc59936.png')

LAve18480 = average_pooling2D_layer([[[[1.3976], [1.5814]], [[1.4614], [1.3733]]]], 1, 1, Ave18480), 
LRes45082 = reshape_layer(Ave18480, [2, 2], Res45082), 
LLoc19654 = locally_connected1D_layer(Res45082, 2,[[[0.7695, 0.5964, 0.1337, 0.7671], [0.0086, 0.5141, 0.3322, 0.131], [0.1513, 0.5671, 0.6842, 0.4889], [0.8111, 0.5662, 0.2299, 0.2448]]],[[0, 0, 0, 0]], 1, Loc19654), 
LRes23647 = reshape_layer(Loc19654, [1, 4, 1], Res23647), 
LLoc59936 = locally_connected2D_layer(Res23647, 1, 4,[[[0.492, 0.0066], [0.3105, 0.5753], [0.8864, 0.7951], [0.4068, 0.7524]]],[[[0, 0]]], 1, 4, Loc59936), 
exec_layers([LAve18480,LRes45082,LLoc19654,LRes23647,LLoc59936],["Ave18480","Res45082","Loc19654","Res23647","Loc59936"],Loc59936,"Loc59936")

Actual (Unparsed): [[[[4.9479063, 5.2527111]]]]

Expected (Unparsed): [[[[4.9479062045580005,5.252711047897001]]]]

Actual:   [[[[4.948, 5.2528]]]]

Expected: [[[[4.948, 5.2528]]]]