import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo69742 = tf.keras.layers.Input(shape=([2, 2]))
in0Max8506 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Max8506 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Glo69742 = keras.layers.GlobalAveragePooling1D(name = 'Glo69742', )(in0Glo69742)
Res62419 = keras.layers.Reshape((2, 1), name = 'Res62419', )(Glo69742)
Res4024 = keras.layers.Reshape((2, 1, 1), name = 'Res4024', )(Res62419)
Con84289 = keras.layers.Conv2DTranspose(4, (2, 1),strides=(1, 1), padding='same', name = 'Con84289', )(Res4024)
Res9588 = keras.layers.Reshape((2, 4), name = 'Res9588', )(Con84289)
LST60491 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST60491', )(Res9588)
Res16332 = keras.layers.Reshape((2, 1), name = 'Res16332', )(LST60491)
Max8506 = keras.layers.Maximum(name = 'Max8506', )([in0Max8506,in1Max8506])
Res32618 = keras.layers.Reshape((2, 1), name = 'Res32618', )(Max8506)
Sub14191 = keras.layers.Subtract(name = 'Sub14191', )([Res16332,Res32618])
model = tf.keras.models.Model(inputs=[in0Glo69742,in0Max8506,in1Max8506], outputs=Sub14191)
w = model.get_layer('Con84289').get_weights() 
w[0] = np.array([[[[0.168], [0.7183], [0.4272], [0.3008]]], [[[0.5991], [0.6847], [0.0387], [0.7768]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con84289').set_weights(w) 
w = model.get_layer('LST60491').get_weights() 
w[0] = np.array([[4, 6, 7, 5, 4, 10, 5, 9], [4, 9, 3, 2, 6, 8, 9, 8], [9, 10, 1, 7, 3, 9, 1, 2], [2, 5, 5, 5, 4, 9, 6, 1]])
w[1] = np.array([[6, 4, 2, 7, 9, 5, 8, 2], [7, 8, 2, 10, 8, 1, 1, 6]])
w[2] = np.array([2, 10, 7, 8, 2, 8, 10, 8])
model.get_layer('LST60491').set_weights(w) 
in0Glo69742 = tf.constant([[[1.7082, 1.9086], [1.5776, 1.7474]]])
in0Max8506 = tf.constant([[[[[0.7145]], [[0.6242]]]]])
in1Max8506 = tf.constant([[[[[0.2063]], [[0.833]]]]])
print (np.array2string(model.predict([in0Glo69742,in0Max8506,in1Max8506],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub14191.png')

LGlo69742 = global_average_pooling1D_layer([[[1.7082, 1.9086], [1.5776, 1.7474]]], Glo69742), 
LRes62419 = reshape_layer(Glo69742, [2, 1], Res62419), 
LRes4024 = reshape_layer(Res62419, [2, 1, 1], Res4024), 
LCon84289 = conv2D_transpose_layer(Res4024, 2, 1,[[[[0.168], [0.7183], [0.4272], [0.3008]]], [[[0.5991], [0.6847], [0.0387], [0.7768]]]],[0, 0, 0, 0], 1, 1, true, Con84289), 
LRes9588 = reshape_layer(Con84289, [2, 4], Res9588), 
LLST60491 = lstm_layer(Res9588,[[4, 6, 7, 5, 4, 10, 5, 9], [4, 9, 3, 2, 6, 8, 9, 8], [9, 10, 1, 7, 3, 9, 1, 2], [2, 5, 5, 5, 4, 9, 6, 1]],[[6, 4, 2, 7, 9, 5, 8, 2], [7, 8, 2, 10, 8, 1, 1, 6]],[2, 10, 7, 8, 2, 8, 10, 8], LST60491), 
LRes16332 = reshape_layer(LST60491, [2, 1], Res16332), 
LMax8506 = maximum_layer([[[[[[0.7145]], [[0.6242]]]]], [[[[[0.2063]], [[0.833]]]]]], Max8506), 
LRes32618 = reshape_layer(Max8506, [2, 1], Res32618), 
LSub14191 = subtract_layer(Res16332,Res32618, Sub14191), 
exec_layers([LGlo69742,LRes62419,LRes4024,LCon84289,LRes9588,LLST60491,LRes16332,LMax8506,LRes32618,LSub14191],["Glo69742","Res62419","Res4024","Con84289","Res9588","LST60491","Res16332","Max8506","Res32618","Sub14191"],Sub14191,"Sub14191")

Actual (Unparsed): [[[0.2495276], [0.1310276]]]

Expected (Unparsed): [[[0.2495275610867438],[0.13102758007581583]]]

Actual:   [[[0.2496], [0.1311]]]

Expected: [[[0.2496], [0.1311]]]