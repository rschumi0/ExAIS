import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min39413 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in1Min39413 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))

Min39413 = keras.layers.Minimum(name = 'Min39413', )([in0Min39413,in1Min39413])
Res22344 = keras.layers.Reshape((2, 1, 4), name = 'Res22344', )(Min39413)
Glo35438 = keras.layers.GlobalAveragePooling2D(name = 'Glo35438', )(Res22344)
Res65454 = keras.layers.Reshape((4, 1), name = 'Res65454', )(Glo35438)
Sim14305 = keras.layers.SimpleRNN(3,name = 'Sim14305', )(Res65454)
model = tf.keras.models.Model(inputs=[in0Min39413,in1Min39413], outputs=Sim14305)
w = model.get_layer('Sim14305').get_weights() 
w[0] = np.array([[9, 3, 1]])
w[1] = np.array([[3, 10, 8], [5, 4, 5], [1, 5, 8]])
w[2] = np.array([5, 3, 4])
model.get_layer('Sim14305').set_weights(w) 
in0Min39413 = tf.constant([[[[[0.9421, 0.3054], [0.5482, 0.5929]]], [[[0.8053, 0.7211], [0.0548, 0.4674]]]]])
in1Min39413 = tf.constant([[[[[0.0384, 0.1556], [0.5173, 0.817]]], [[[0.2279, 0.6562], [0.4061, 0.1407]]]]])
print (np.array2string(model.predict([in0Min39413,in1Min39413],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sim14305.png')

LMin39413 = minimum_layer([[[[[[0.9421, 0.3054], [0.5482, 0.5929]]], [[[0.8053, 0.7211], [0.0548, 0.4674]]]]], [[[[[0.0384, 0.1556], [0.5173, 0.817]]], [[[0.2279, 0.6562], [0.4061, 0.1407]]]]]], Min39413), 
LRes22344 = reshape_layer(Min39413, [2, 1, 4], Res22344), 
LGlo35438 = global_average_pooling2D_layer(Res22344, Glo35438), 
LRes65454 = reshape_layer(Glo35438, [4, 1], Res65454), 
LSim14305 = simple_rnn_layer(Res65454,[[9, 3, 1]],[[3, 10, 8], [5, 4, 5], [1, 5, 8]],[5, 3, 4], Sim14305), 
exec_layers([LMin39413,LRes22344,LGlo35438,LRes65454,LSim14305],["Min39413","Res22344","Glo35438","Res65454","Sim14305"],Sim14305,"Sim14305")

Actual (Unparsed): [[1.0000000, 1.0000000, 1.0000000]]

Expected (Unparsed): [[0.9999999999999981,1.0,1.0]]

Actual:   [[1, 1, 1]]

Expected: [[1, 1, 1]]