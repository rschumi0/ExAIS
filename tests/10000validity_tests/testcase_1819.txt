import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul11887 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Mul11887 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Mul11887 = keras.layers.Multiply(name = 'Mul11887', )([in0Mul11887,in1Mul11887])
Res33107 = keras.layers.Reshape((2, 2, 4), name = 'Res33107', )(Mul11887)
Res1320 = keras.layers.Reshape((2, 8), name = 'Res1320', )(Res33107)
Cro30766 = keras.layers.Cropping1D(cropping=((0, 1)), name = 'Cro30766', )(Res1320)
Sep20327 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='same', name = 'Sep20327', )(Cro30766)
model = tf.keras.models.Model(inputs=[in0Mul11887,in1Mul11887], outputs=Sep20327)
w = model.get_layer('Sep20327').get_weights() 
w[0] = np.array([[[0.9523], [0.052], [0.1595], [0.104], [0.518], [0.4953], [0.7799], [0.2463]]])
w[1] = np.array([[[0.7265, 0.7702, 0.257], [0.4352, 0.3067, 0.8994], [0.7199, 0.2853, 0.4165], [0.4319, 0.8921, 0.6597], [0.7742, 0.5798, 0.1653], [0.4937, 0.0415, 0.4987], [0.1821, 0.6909, 0.2245], [0.0622, 0.212, 0.1573]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep20327').set_weights(w) 
in0Mul11887 = tf.constant([[[[[0.9909, 0.3097], [0.3598, 0.0247]], [[0.8657, 0.4662], [0.3208, 0.9109]]], [[[0.2879, 0.837], [0.4905, 0.0687]], [[0.8026, 0.4998], [0.8872, 0.5915]]]]])
in1Mul11887 = tf.constant([[[[[0.6076, 0.3579], [0.253, 0.7858]], [[0.1887, 0.4154], [0.6662, 0.6943]]], [[[0.5157, 0.3242], [0.247, 0.9903]], [[0.5323, 0.9839], [0.1187, 0.4426]]]]])
print (np.array2string(model.predict([in0Mul11887,in1Mul11887],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep20327.png')

LMul11887 = multiply_layer([[[[[[0.9909, 0.3097], [0.3598, 0.0247]], [[0.8657, 0.4662], [0.3208, 0.9109]]], [[[0.2879, 0.837], [0.4905, 0.0687]], [[0.8026, 0.4998], [0.8872, 0.5915]]]]], [[[[[0.6076, 0.3579], [0.253, 0.7858]], [[0.1887, 0.4154], [0.6662, 0.6943]]], [[[0.5157, 0.3242], [0.247, 0.9903]], [[0.5323, 0.9839], [0.1187, 0.4426]]]]]], Mul11887), 
LRes33107 = reshape_layer(Mul11887, [2, 2, 4], Res33107), 
LRes1320 = reshape_layer(Res33107, [2, 8], Res1320), 
LCro30766 = cropping1D_layer(Res1320, 0, 1, Cro30766), 
LSep20327 = separable_conv1D_layer(Cro30766, 1,[[[[0.9523], [0.052], [0.1595], [0.104], [0.518], [0.4953], [0.7799], [0.2463]]],[[[0.7265, 0.7702, 0.257], [0.4352, 0.3067, 0.8994], [0.7199, 0.2853, 0.4165], [0.4319, 0.8921, 0.6597], [0.7742, 0.5798, 0.1653], [0.4937, 0.0415, 0.4987], [0.1821, 0.6909, 0.2245], [0.0622, 0.212, 0.1573]]]],[0, 0, 0], 1, true, Sep20327), 
exec_layers([LMul11887,LRes33107,LRes1320,LCro30766,LSep20327],["Mul11887","Res33107","Res1320","Cro30766","Sep20327"],Sep20327,"Sep20327")

Actual (Unparsed): [[[0.5832814, 0.6505303, 0.2836586]]]

Expected (Unparsed): [[[0.5832814280878393,0.65053033451662,0.2836586448646941]]]

Actual:   [[[0.5833, 0.6506, 0.2837]]]

Expected: [[[0.5833, 0.6506, 0.2837]]]