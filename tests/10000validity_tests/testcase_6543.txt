import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max51134 = tf.keras.layers.Input(shape=([1, 1]))
in1Max51134 = tf.keras.layers.Input(shape=([1, 1]))
in0Con19179 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Min77582 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Min77582 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in0Dot65031 = tf.keras.layers.Input(shape=([2]))
in1Dot65031 = tf.keras.layers.Input(shape=([2]))
in0Con93261 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Dep83386 = tf.keras.layers.Input(shape=([1, 2, 2]))

Max51134 = keras.layers.Maximum(name = 'Max51134', )([in0Max51134,in1Max51134])
Res62538 = keras.layers.Reshape((1, 1, 1), name = 'Res62538', )(Max51134)
Zer64322 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer64322', )(Res62538)
Con19179 = keras.layers.Concatenate(axis=3, name = 'Con19179', )([Zer64322,in0Con19179])
Min77582 = keras.layers.Minimum(name = 'Min77582', )([in0Min77582,in1Min77582])
Res16027 = keras.layers.Reshape((1, 2, 2), name = 'Res16027', )(Min77582)
Dot65031 = keras.layers.Dot(axes=(1, 1), name = 'Dot65031', )([in0Dot65031,in1Dot65031])
Res48835 = keras.layers.Reshape((1, 1), name = 'Res48835', )(Dot65031)
Res12349 = keras.layers.Reshape((1, 1, 1), name = 'Res12349', )(Res48835)
Zer30092 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer30092', )(Res12349)
Con93261 = keras.layers.Concatenate(axis=3, name = 'Con93261', )([Zer30092,in0Con93261])
Dep83386 = keras.layers.DepthwiseConv2D((1, 2),strides=(1, 1), padding='same', name = 'Dep83386', )(in0Dep83386)
Min88487 = keras.layers.Minimum(name = 'Min88487', )([Con93261,Dep83386])
Add34642 = keras.layers.Add(name = 'Add34642', )([Res16027,Min88487])
Add66113 = keras.layers.Add(name = 'Add66113', )([Con19179,Add34642])
model = tf.keras.models.Model(inputs=[in0Max51134,in1Max51134,in0Con19179,in0Min77582,in1Min77582,in0Dot65031,in1Dot65031,in0Con93261,in0Dep83386], outputs=Add66113)
w = model.get_layer('Dep83386').get_weights() 
w[0] = np.array([[[[0.1033], [0.7711]], [[0.9571], [0.2865]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep83386').set_weights(w) 
in0Max51134 = tf.constant([[[0.3588]]])
in1Max51134 = tf.constant([[[0.1557]]])
in0Con19179 = tf.constant([[[[0.3589], [0.6655]]]])
in0Min77582 = tf.constant([[[[[0.547, 0.0513]], [[0.3344, 0.2113]]]]])
in1Min77582 = tf.constant([[[[[0.251, 0.0475]], [[0.7665, 0.2315]]]]])
in0Dot65031 = tf.constant([[0.9052, 0.2466]])
in1Dot65031 = tf.constant([[0.377, 0.0073]])
in0Con93261 = tf.constant([[[[0.5492], [0.5508]]]])
in0Dep83386 = tf.constant([[[[0.1295, 0.183], [0.5917, 0.4225]]]])
print (np.array2string(model.predict([in0Max51134,in1Max51134,in0Con19179,in0Min77582,in1Min77582,in0Dot65031,in1Dot65031,in0Con93261,in0Dep83386],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add66113.png')

LMax51134 = maximum_layer([[[[0.3588]]], [[[0.1557]]]], Max51134), 
LRes62538 = reshape_layer(Max51134, [1, 1, 1], Res62538), 
LZer64322 = zero_padding2D_layer(Res62538, 0, 0, 1, 0, Zer64322), 
LCon19179 = concatenate_layer([Zer64322,[[[[0.3589], [0.6655]]]]], 3, Con19179), 
LMin77582 = minimum_layer([[[[[[0.547, 0.0513]], [[0.3344, 0.2113]]]]], [[[[[0.251, 0.0475]], [[0.7665, 0.2315]]]]]], Min77582), 
LRes16027 = reshape_layer(Min77582, [1, 2, 2], Res16027), 
LDot65031 = dot_layer([[0.9052, 0.2466]], [[0.377, 0.0073]], 1, 1, Dot65031), 
LRes48835 = reshape_layer(Dot65031, [1, 1], Res48835), 
LRes12349 = reshape_layer(Res48835, [1, 1, 1], Res12349), 
LZer30092 = zero_padding2D_layer(Res12349, 0, 0, 1, 0, Zer30092), 
LCon93261 = concatenate_layer([Zer30092,[[[[0.5492], [0.5508]]]]], 3, Con93261), 
LDep83386 = depthwise_conv2D_layer([[[[0.1295, 0.183], [0.5917, 0.4225]]]], 1, 2,[[[[0.1033], [0.7711]], [[0.9571], [0.2865]]]],[0, 0], 1, 1, true, Dep83386), 
LMin88487 = minimum_layer([Con93261,Dep83386], Min88487), 
LAdd34642 = add_layer([Res16027,Min88487], Add34642), 
LAdd66113 = add_layer([Con19179,Add34642], Add66113), 
exec_layers([LMax51134,LRes62538,LZer64322,LCon19179,LMin77582,LRes16027,LDot65031,LRes48835,LRes12349,LZer30092,LCon93261,LDep83386,LMin88487,LAdd34642,LAdd66113],["Max51134","Res62538","Zer64322","Con19179","Min77582","Res16027","Dot65031","Res48835","Res12349","Zer30092","Con93261","Dep83386","Min88487","Add34642","Add66113"],Add66113,"Add66113")

Actual (Unparsed): [[[[0.2510000, 0.6685576], [0.7543226, 1.2025897]]]]

Expected (Unparsed): [[[[0.251,0.66855755],[0.75432261,1.20258975]]]]

Actual:   [[[[0.251, 0.6686], [0.7544, 1.2026]]]]

Expected: [[[[0.251, 0.6686], [0.7544, 1.2026]]]]