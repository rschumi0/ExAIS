import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub64935 = tf.keras.layers.Input(shape=([2]))
in1Sub64935 = tf.keras.layers.Input(shape=([2]))

Sub64935 = keras.layers.Subtract(name = 'Sub64935', )([in0Sub64935,in1Sub64935])
Res51974 = keras.layers.Reshape((2, 1), name = 'Res51974', )(Sub64935)
Res62374 = keras.layers.Reshape((2, 1, 1), name = 'Res62374', )(Res51974)
Glo34017 = keras.layers.GlobalMaxPool2D(name = 'Glo34017', )(Res62374)
Res20452 = keras.layers.Reshape((1, 1), name = 'Res20452', )(Glo34017)
PRe41501 = keras.layers.PReLU(name = 'PRe41501', )(Res20452)
model = tf.keras.models.Model(inputs=[in0Sub64935,in1Sub64935], outputs=PRe41501)
w = model.get_layer('PRe41501').get_weights() 
w[0] = np.array([[0.5092]])
model.get_layer('PRe41501').set_weights(w) 
in0Sub64935 = tf.constant([[0.9187, 0.9303]])
in1Sub64935 = tf.constant([[0.4879, 0.5298]])
print (np.array2string(model.predict([in0Sub64935,in1Sub64935],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe41501.png')

LSub64935 = subtract_layer([[0.9187, 0.9303]], [[0.4879, 0.5298]], Sub64935), 
LRes51974 = reshape_layer(Sub64935, [2, 1], Res51974), 
LRes62374 = reshape_layer(Res51974, [2, 1, 1], Res62374), 
LGlo34017 = global_max_pool2D_layer(Res62374, Glo34017), 
LRes20452 = reshape_layer(Glo34017, [1, 1], Res20452), 
LPRe41501 = prelu_layer(Res20452, [[0.5092]], PRe41501), 
exec_layers([LSub64935,LRes51974,LRes62374,LGlo34017,LRes20452,LPRe41501],["Sub64935","Res51974","Res62374","Glo34017","Res20452","PRe41501"],PRe41501,"PRe41501")

Actual (Unparsed): [[[0.4308000]]]

Expected (Unparsed): [[[0.43079999999999996]]]

Actual:   [[[0.4308]]]

Expected: [[[0.4308]]]