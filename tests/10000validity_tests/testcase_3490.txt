import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot15810 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot15810 = tf.keras.layers.Input(shape=([2, 2]))

Dot15810 = keras.layers.Dot(axes=(2, 2), name = 'Dot15810', )([in0Dot15810,in1Dot15810])
Sim44191 = keras.layers.SimpleRNN(3,name = 'Sim44191', )(Dot15810)
Bat21140 = keras.layers.BatchNormalization(axis=1, epsilon=0.48174286845462755,  name = 'Bat21140', )(Sim44191)
model = tf.keras.models.Model(inputs=[in0Dot15810,in1Dot15810], outputs=Bat21140)
w = model.get_layer('Sim44191').get_weights() 
w[0] = np.array([[6, 7, 9], [3, 2, 8]])
w[1] = np.array([[6, 3, 10], [1, 6, 10], [9, 3, 3]])
w[2] = np.array([5, 2, 5])
model.get_layer('Sim44191').set_weights(w) 
w = model.get_layer('Bat21140').get_weights() 
w[0] = np.array([0.6322, 0.9921, 0.1497])
w[1] = np.array([0.7164, 0.4, 0.9775])
w[2] = np.array([0.1316, 0.3837, 0.7714])
w[3] = np.array([0.3561, 0.6786, 0.3946])
model.get_layer('Bat21140').set_weights(w) 
in0Dot15810 = tf.constant([[[0.5175, 0.3735], [0.2433, 0.2855]]])
in1Dot15810 = tf.constant([[[0.141, 0.315], [0.3142, 0.7503]]])
print (np.array2string(model.predict([in0Dot15810,in1Dot15810],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat21140.png')

LDot15810 = dot_layer([[[0.5175, 0.3735], [0.2433, 0.2855]]], [[[0.141, 0.315], [0.3142, 0.7503]]], 2, 2, Dot15810), 
LSim44191 = simple_rnn_layer(Dot15810,[[6, 7, 9], [3, 2, 8]],[[6, 3, 10], [1, 6, 10], [9, 3, 3]],[5, 2, 5], Sim44191), 
LBat21140 = batch_normalization_layer(Sim44191, 1, 0.48174286845462755, [0.6322, 0.9921, 0.1497], [0.7164, 0.4, 0.9775], [0.1316, 0.3837, 0.7714], [0.3561, 0.6786, 0.3946], Bat21140), 
exec_layers([LDot15810,LSim44191,LBat21140],["Dot15810","Sim44191","Bat21140"],Bat21140,"Bat21140")

Actual (Unparsed): [[1.3161814, 0.9676158, 1.0140562]]

Expected (Unparsed): [[1.316181433139418,0.967615764461377,1.014056196069849]]

Actual:   [[1.3162, 0.9677, 1.0141]]

Expected: [[1.3162, 0.9677, 1.0141]]