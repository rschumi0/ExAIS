import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot62996 = tf.keras.layers.Input(shape=([3]))
in1Dot62996 = tf.keras.layers.Input(shape=([3]))
in0Add87016 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Add87016 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Dot51167 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot51167 = tf.keras.layers.Input(shape=([3, 2]))

Dot62996 = keras.layers.Dot(axes=(1, 1), name = 'Dot62996', )([in0Dot62996,in1Dot62996])
Res49748 = keras.layers.Reshape((1, 1), name = 'Res49748', )(Dot62996)
Res95446 = keras.layers.Reshape((1, 1, 1), name = 'Res95446', )(Res49748)
Zer98959 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer98959', )(Res95446)
Add87016 = keras.layers.Add(name = 'Add87016', )([in0Add87016,in1Add87016])
Add59304 = keras.layers.Add(name = 'Add59304', )([Zer98959,Add87016])
Res10638 = keras.layers.Reshape((1, 2), name = 'Res10638', )(Add59304)
Zer34437 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer34437', )(Res10638)
Dot51167 = keras.layers.Dot(axes=(1, 1), name = 'Dot51167', )([in0Dot51167,in1Dot51167])
Lay25149 = keras.layers.LayerNormalization(axis=1, epsilon=1.101451287466676, name = 'Lay25149', )(Dot51167)
Min31483 = keras.layers.Minimum(name = 'Min31483', )([Zer34437,Lay25149])
Max75771 = keras.layers.MaxPool1D(pool_size=(1), strides=(11), padding='valid', name = 'Max75771', )(Min31483)
model = tf.keras.models.Model(inputs=[in0Dot62996,in1Dot62996,in0Add87016,in1Add87016,in0Dot51167,in1Dot51167], outputs=Max75771)
in0Dot62996 = tf.constant([[0.4207, 0.292, 0.9344]])
in1Dot62996 = tf.constant([[0.8208, 0.794, 0.3387]])
in0Add87016 = tf.constant([[[[0.8127], [0.8068]]]])
in1Add87016 = tf.constant([[[[0.1356], [0.9258]]]])
in0Dot51167 = tf.constant([[[0.014, 0.6837], [0.3603, 0.3811], [0.5859, 0.7623]]])
in1Dot51167 = tf.constant([[[0.7976, 0.3973], [0.4957, 0.5416], [0.2917, 0.5113]]])
print (np.array2string(model.predict([in0Dot62996,in1Dot62996,in0Add87016,in1Add87016,in0Dot51167,in1Dot51167],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max75771.png')

LDot62996 = dot_layer([[0.4207, 0.292, 0.9344]], [[0.8208, 0.794, 0.3387]], 1, 1, Dot62996), 
LRes49748 = reshape_layer(Dot62996, [1, 1], Res49748), 
LRes95446 = reshape_layer(Res49748, [1, 1, 1], Res95446), 
LZer98959 = zero_padding2D_layer(Res95446, 0, 0, 1, 0, Zer98959), 
LAdd87016 = add_layer([[[[[0.8127], [0.8068]]]], [[[[0.1356], [0.9258]]]]], Add87016), 
LAdd59304 = add_layer([Zer98959,Add87016], Add59304), 
LRes10638 = reshape_layer(Add59304, [1, 2], Res10638), 
LZer34437 = zero_padding1D_layer(Res10638, 1, 0, Zer34437), 
LDot51167 = dot_layer([[[0.014, 0.6837], [0.3603, 0.3811], [0.5859, 0.7623]]], [[[0.7976, 0.3973], [0.4957, 0.5416], [0.2917, 0.5113]]], 1, 1, Dot51167), 
LLay25149 = layer_normalization_layer(Dot51167, 1, 1.101451287466676, Lay25149), 
LMin31483 = minimum_layer([Zer34437,Lay25149], Min31483), 
LMax75771 = max_pool1D_layer(Min31483, 1, 11, false, Max75771), 
exec_layers([LDot62996,LRes49748,LRes95446,LZer98959,LAdd87016,LAdd59304,LRes10638,LZer34437,LDot51167,LLay25149,LMin31483,LMax75771],["Dot62996","Res49748","Res95446","Zer98959","Add87016","Add59304","Res10638","Zer34437","Dot51167","Lay25149","Min31483","Max75771"],Max75771,"Max75771")

Actual (Unparsed): [[[-0.2731126, -0.1724738]]]

Expected (Unparsed): [[[-0.2731125696542728,-0.17247378216018175]]]

Actual:   [[[-0.2731, -0.1724]]]

Expected: [[[-0.2731, -0.1724]]]