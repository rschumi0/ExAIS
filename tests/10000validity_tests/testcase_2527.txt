import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con19640 = tf.keras.layers.Input(shape=([2, 1, 2, 2]))
in0Min30924 = tf.keras.layers.Input(shape=([1, 1]))
in1Min30924 = tf.keras.layers.Input(shape=([1, 1]))
in0Con73325 = tf.keras.layers.Input(shape=([2, 3]))
in0Con46415 = tf.keras.layers.Input(shape=([3, 5, 2]))
in0Sub52572 = tf.keras.layers.Input(shape=([3, 3, 3]))
in1Sub52572 = tf.keras.layers.Input(shape=([3, 3, 3]))

Con19640 = keras.layers.Conv3D(2, (1, 1, 2),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con19640', )(in0Con19640)
Res41466 = keras.layers.Reshape((2, 1, 4), name = 'Res41466', )(Con19640)
Res59288 = keras.layers.Reshape((2, 4), name = 'Res59288', )(Res41466)
Min30924 = keras.layers.Minimum(name = 'Min30924', )([in0Min30924,in1Min30924])
Zer14521 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer14521', )(Min30924)
Con73325 = keras.layers.Concatenate(axis=2, name = 'Con73325', )([Zer14521,in0Con73325])
Ave33072 = keras.layers.Average(name = 'Ave33072', )([Res59288,Con73325])
Res72025 = keras.layers.Reshape((2, 4, 1), name = 'Res72025', )(Ave33072)
Zer835 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer835', )(Res72025)
Con46415 = keras.layers.Concatenate(axis=3, name = 'Con46415', )([Zer835,in0Con46415])
Sub52572 = keras.layers.Subtract(name = 'Sub52572', )([in0Sub52572,in1Sub52572])
Zer99031 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer99031', )(Sub52572)
Mul22204 = keras.layers.Multiply(name = 'Mul22204', )([Con46415,Zer99031])
model = tf.keras.models.Model(inputs=[in0Con19640,in0Min30924,in1Min30924,in0Con73325,in0Con46415,in0Sub52572,in1Sub52572], outputs=Mul22204)
w = model.get_layer('Con19640').get_weights() 
w[0] = np.array([[[[[0.6586, 0.9904], [0.2607, 0.5808]], [[0.4801, 0.5132], [0.6475, 0.9925]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con19640').set_weights(w) 
in0Con19640 = tf.constant([[[[[0.3779, 0.7722], [0.2377, 0.5538]]], [[[0.7202, 0.9261], [0.645, 0.3153]]]]])
in0Min30924 = tf.constant([[[0.7593]]])
in1Min30924 = tf.constant([[[0.6239]]])
in0Con73325 = tf.constant([[[0.1676, 0.9651, 0.6374], [0.3516, 0.0687, 0.0499]]])
in0Con46415 = tf.constant([[[[0.6334, 0.9841], [0.7191, 0.5736], [0.7499, 0.6643], [0.5496, 0.459], [0.5244, 0.0012]], [[0.2659, 0.8718], [0.3606, 0.8438], [0.6464, 0.4694], [0.3525, 0.6789], [0.3297, 0.9576]], [[0.5858, 0.2987], [0.7074, 0.2074], [0.3091, 0.7048], [0.165, 0.7805], [0.1495, 0.6081]]]])
in0Sub52572 = tf.constant([[[[0.1826, 0.907, 0.928], [0.7696, 0.5111, 0.0793], [0.6545, 0.9781, 0.3366]], [[0.3403, 0.9739, 0.9445], [0.1994, 0.2504, 0.3499], [0.996, 0.5129, 0.9451]], [[0.4315, 0.2448, 0.1225], [0.6178, 0.1286, 0.2694], [0.5755, 0.0938, 0.8289]]]])
in1Sub52572 = tf.constant([[[[0.7908, 0.5004, 0.5562], [0.7947, 0.3836, 0.9749], [0.9479, 0.7852, 0.8618]], [[0.5325, 0.5667, 0.7265], [0.6152, 0.5023, 0.8924], [0.8175, 0.8361, 0.7095]], [[0.7463, 0.806, 0.2717], [0.169, 0.4628, 0.2915], [0.8676, 0.3022, 0.8773]]]])
print (np.array2string(model.predict([in0Con19640,in0Min30924,in1Min30924,in0Con73325,in0Con46415,in0Sub52572,in1Sub52572],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul22204.png')

LCon19640 = conv3D_layer([[[[[0.3779, 0.7722], [0.2377, 0.5538]]], [[[0.7202, 0.9261], [0.645, 0.3153]]]]], 1, 1, 2,[[[[[0.6586, 0.9904], [0.2607, 0.5808]], [[0.4801, 0.5132], [0.6475, 0.9925]]]]],[0, 0], 1, 1, 1, true, 1, 1, 1, Con19640), 
LRes41466 = reshape_layer(Con19640, [2, 1, 4], Res41466), 
LRes59288 = reshape_layer(Res41466, [2, 4], Res59288), 
LMin30924 = minimum_layer([[[[0.7593]]], [[[0.6239]]]], Min30924), 
LZer14521 = zero_padding1D_layer(Min30924, 1, 0, Zer14521), 
LCon73325 = concatenate_layer([Zer14521,[[[0.1676, 0.9651, 0.6374], [0.3516, 0.0687, 0.0499]]]], 2, Con73325), 
LAve33072 = average_layer([Res59288,Con73325], Ave33072), 
LRes72025 = reshape_layer(Ave33072, [2, 4, 1], Res72025), 
LZer835 = zero_padding2D_layer(Res72025, 1, 0, 1, 0, Zer835), 
LCon46415 = concatenate_layer([Zer835,[[[[0.6334, 0.9841], [0.7191, 0.5736], [0.7499, 0.6643], [0.5496, 0.459], [0.5244, 0.0012]], [[0.2659, 0.8718], [0.3606, 0.8438], [0.6464, 0.4694], [0.3525, 0.6789], [0.3297, 0.9576]], [[0.5858, 0.2987], [0.7074, 0.2074], [0.3091, 0.7048], [0.165, 0.7805], [0.1495, 0.6081]]]]], 3, Con46415), 
LSub52572 = subtract_layer([[[[0.1826, 0.907, 0.928], [0.7696, 0.5111, 0.0793], [0.6545, 0.9781, 0.3366]], [[0.3403, 0.9739, 0.9445], [0.1994, 0.2504, 0.3499], [0.996, 0.5129, 0.9451]], [[0.4315, 0.2448, 0.1225], [0.6178, 0.1286, 0.2694], [0.5755, 0.0938, 0.8289]]]], [[[[0.7908, 0.5004, 0.5562], [0.7947, 0.3836, 0.9749], [0.9479, 0.7852, 0.8618]], [[0.5325, 0.5667, 0.7265], [0.6152, 0.5023, 0.8924], [0.8175, 0.8361, 0.7095]], [[0.7463, 0.806, 0.2717], [0.169, 0.4628, 0.2915], [0.8676, 0.3022, 0.8773]]]], Sub52572), 
LZer99031 = zero_padding2D_layer(Sub52572, 0, 0, 2, 0, Zer99031), 
LMul22204 = multiply_layer([Con46415,Zer99031], Mul22204), 
exec_layers([LCon19640,LRes41466,LRes59288,LMin30924,LZer14521,LCon73325,LAve33072,LRes72025,LZer835,LCon46415,LSub52572,LZer99031,LMul22204],["Con19640","Res41466","Res59288","Min30924","Zer14521","Con73325","Ave33072","Res72025","Zer835","Con46415","Sub52572","Zer99031","Mul22204"],Mul22204,"Mul22204")

Actual (Unparsed): [[[[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [-0.0000000, 0.3049093, 0.2469867], [-0.0000000, 0.0700740, -0.4110804], [-0.0000000, 0.1011568, -0.0006302]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [-0.1597182, 0.2632141, 0.1023292], [-0.2632066, -0.0887948, -0.3683033], [0.1066060, -0.1065590, 0.2256106]], [[0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000], [-0.3536328, -0.1734669, -0.1051562], [0.1291861, -0.0551430, -0.0172491], [-0.1273314, -0.0311558, -0.0294321]]]]

Expected (Unparsed): [[[[0,0.0,0.0],[0,0.0,0.0],[-0.0,0.3049093400000001,0.24698674],[-0.0,0.070074,-0.4110804],[-0.0,0.10115675999999997,-0.0006302399999999999]],[[0,0.0,0.0],[0.0,0.0,0.0],[-0.159718205766,0.26321408,0.10232919999999998],[-0.2632065725519999,-0.08879474999999998,-0.36830324999999997],[0.10660601195999998,-0.10655903999999998,0.22561056000000004]],[[0,0.0,0.0],[0.0,0.0,0.0],[-0.353632816654,-0.17346692,-0.10515616],[0.12918611732399998,-0.055143000000000005,-0.017249050000000005],[-0.127331390752,-0.031155800000000004,-0.02943204]]]]

Actual:   [[[[0, 0, 0], [0, 0, 0], [-0, 0.305, 0.247], [-0, 0.0701, -0.411], [-0, 0.1012, -0.0006]], [[0, 0, 0], [0, 0, 0], [-0.1597, 0.2633, 0.1024], [-0.2632, -0.0887, -0.3683], [0.1067, -0.1065, 0.2257]], [[0, 0, 0], [0, 0, 0], [-0.3536, -0.1734, -0.1051], [0.1292, -0.0551, -0.0172], [-0.1273, -0.0311, -0.0294]]]]

Expected: [[[[0, 0, 0], [0, 0, 0], [-0, 0.305, 0.247], [-0, 0.0701, -0.411], [-0, 0.1012, -0.0006]], [[0, 0, 0], [0, 0, 0], [-0.1597, 0.2633, 0.1024], [-0.2632, -0.0887, -0.3683], [0.1067, -0.1065, 0.2257]], [[0, 0, 0], [0, 0, 0], [-0.3536, -0.1734, -0.1051], [0.1292, -0.0551, -0.0172], [-0.1273, -0.0311, -0.0294]]]]