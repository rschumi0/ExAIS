import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add43945 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in1Add43945 = tf.keras.layers.Input(shape=([2, 1, 1, 2]))
in0Dot24486 = tf.keras.layers.Input(shape=([2]))
in1Dot24486 = tf.keras.layers.Input(shape=([2]))
in0Con99854 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot52746 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot52746 = tf.keras.layers.Input(shape=([2, 2]))

Add43945 = keras.layers.Add(name = 'Add43945', )([in0Add43945,in1Add43945])
Res87910 = keras.layers.Reshape((2, 1, 2), name = 'Res87910', )(Add43945)
PRe56179 = keras.layers.PReLU(name = 'PRe56179', )(Res87910)
Res9482 = keras.layers.Reshape((2, 2), name = 'Res9482', )(PRe56179)
Dot24486 = keras.layers.Dot(axes=(1, 1), name = 'Dot24486', )([in0Dot24486,in1Dot24486])
Res63284 = keras.layers.Reshape((1, 1), name = 'Res63284', )(Dot24486)
Zer83480 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer83480', )(Res63284)
Con99854 = keras.layers.Concatenate(axis=2, name = 'Con99854', )([Zer83480,in0Con99854])
Dot52746 = keras.layers.Dot(axes=(2, 1), name = 'Dot52746', )([in0Dot52746,in1Dot52746])
Mul27572 = keras.layers.Multiply(name = 'Mul27572', )([Con99854,Dot52746])
Max47037 = keras.layers.Maximum(name = 'Max47037', )([Res9482,Mul27572])
Res49863 = keras.layers.Reshape((2, 2, 1), name = 'Res49863', )(Max47037)
Cro83543 = keras.layers.Cropping2D(cropping=((0, 1), (0, 0)), name = 'Cro83543', )(Res49863)
model = tf.keras.models.Model(inputs=[in0Add43945,in1Add43945,in0Dot24486,in1Dot24486,in0Con99854,in0Dot52746,in1Dot52746], outputs=Cro83543)
w = model.get_layer('PRe56179').get_weights() 
w[0] = np.array([[[0.7864, 0.9297]], [[0.1106, 0.9894]]])
model.get_layer('PRe56179').set_weights(w) 
in0Add43945 = tf.constant([[[[[0.7965, 0.1069]]], [[[0.6189, 0.7912]]]]])
in1Add43945 = tf.constant([[[[[0.7998, 0.5208]]], [[[0.6853, 0.8966]]]]])
in0Dot24486 = tf.constant([[0.3938, 0.0598]])
in1Dot24486 = tf.constant([[0.4825, 0.5828]])
in0Con99854 = tf.constant([[[0.0742], [0.6689]]])
in0Dot52746 = tf.constant([[[0.4699, 0.0191], [0.3187, 0.7078]]])
in1Dot52746 = tf.constant([[[0.1967, 0.856], [0.8261, 0.0485]]])
print (np.array2string(model.predict([in0Add43945,in1Add43945,in0Dot24486,in1Dot24486,in0Con99854,in0Dot52746,in1Dot52746],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro83543.png')

LAdd43945 = add_layer([[[[[[0.7965, 0.1069]]], [[[0.6189, 0.7912]]]]], [[[[[0.7998, 0.5208]]], [[[0.6853, 0.8966]]]]]], Add43945), 
LRes87910 = reshape_layer(Add43945, [2, 1, 2], Res87910), 
LPRe56179 = prelu_layer(Res87910, [[[0.7864, 0.9297]], [[0.1106, 0.9894]]], PRe56179), 
LRes9482 = reshape_layer(PRe56179, [2, 2], Res9482), 
LDot24486 = dot_layer([[0.3938, 0.0598]], [[0.4825, 0.5828]], 1, 1, Dot24486), 
LRes63284 = reshape_layer(Dot24486, [1, 1], Res63284), 
LZer83480 = zero_padding1D_layer(Res63284, 1, 0, Zer83480), 
LCon99854 = concatenate_layer([Zer83480,[[[0.0742], [0.6689]]]], 2, Con99854), 
LDot52746 = dot_layer([[[0.4699, 0.0191], [0.3187, 0.7078]]], [[[0.1967, 0.856], [0.8261, 0.0485]]], 2, 1, Dot52746), 
LMul27572 = multiply_layer([Con99854,Dot52746], Mul27572), 
LMax47037 = maximum_layer([Res9482,Mul27572], Max47037), 
LRes49863 = reshape_layer(Max47037, [2, 2, 1], Res49863), 
LCro83543 = cropping2D_layer(Res49863, 0, 1, 0, 0, Cro83543), 
exec_layers([LAdd43945,LRes87910,LPRe56179,LRes9482,LDot24486,LRes63284,LZer83480,LCon99854,LDot52746,LMul27572,LMax47037,LRes49863,LCro83543],["Add43945","Res87910","PRe56179","Res9482","Dot24486","Res63284","Zer83480","Con99854","Dot52746","Mul27572","Max47037","Res49863","Cro83543"],Cro83543,"Cro83543")

Actual (Unparsed): [[[[1.5963000], [0.6277000]]]]

Expected (Unparsed): [[[[1.5962999999999998],[0.6277]]]]

Actual:   [[[[1.5963], [0.6277]]]]

Expected: [[[[1.5963], [0.6277]]]]