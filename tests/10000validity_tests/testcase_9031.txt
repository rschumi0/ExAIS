import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot33138 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot33138 = tf.keras.layers.Input(shape=([2, 3]))

Dot33138 = keras.layers.Dot(axes=(1, 1), name = 'Dot33138', )([in0Dot33138,in1Dot33138])
PRe74672 = keras.layers.PReLU(name = 'PRe74672', )(Dot33138)
model = tf.keras.models.Model(inputs=[in0Dot33138,in1Dot33138], outputs=PRe74672)
w = model.get_layer('PRe74672').get_weights() 
w[0] = np.array([[0.722, 0.6993, 0.5736], [0.8504, 0.0479, 0.5481], [0.7167, 0.2141, 0.035]])
model.get_layer('PRe74672').set_weights(w) 
in0Dot33138 = tf.constant([[[0.5605, 0.9449, 0.6979], [0.5685, 0.8538, 0.4763]]])
in1Dot33138 = tf.constant([[[0.5824, 0.2188, 0.3946], [0.9572, 0.606, 0.1846]]])
print (np.array2string(model.predict([in0Dot33138,in1Dot33138],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe74672.png')

LDot33138 = dot_layer([[[0.5605, 0.9449, 0.6979], [0.5685, 0.8538, 0.4763]]], [[[0.5824, 0.2188, 0.3946], [0.9572, 0.606, 0.1846]]], 1, 1, Dot33138), 
LPRe74672 = prelu_layer(Dot33138, [[0.722, 0.6993, 0.5736], [0.8504, 0.0479, 0.5481], [0.7167, 0.2141, 0.035]], PRe74672), 
exec_layers([LDot33138,LPRe74672],["Dot33138","PRe74672"],PRe74672,"PRe74672")

Actual (Unparsed): [[[0.8706034, 0.4671484, 0.3261184], [1.3675671, 0.7241469, 0.5304690], [0.8623713, 0.4413383, 0.3633163]]]

Expected (Unparsed): [[[0.8706034,0.4671484,0.3261184],[1.36756712,0.7241469199999999,0.53046902],[0.86237132,0.44133831999999995,0.36331631999999997]]]

Actual:   [[[0.8707, 0.4672, 0.3262], [1.3676, 0.7242, 0.5305], [0.8624, 0.4414, 0.3634]]]

Expected: [[[0.8707, 0.4672, 0.3262], [1.3676, 0.7242, 0.5305], [0.8624, 0.4414, 0.3634]]]