import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro17213 = tf.keras.layers.Input(shape=([3, 4, 2]))

Cro17213 = keras.layers.Cropping2D(cropping=((1, 0), (1, 0)), name = 'Cro17213', )(in0Cro17213)
Res44512 = keras.layers.Reshape((2, 6), name = 'Res44512', )(Cro17213)
Sep29094 = keras.layers.SeparableConv1D(3, (1),strides=(1), padding='valid', name = 'Sep29094', )(Res44512)
Res13177 = keras.layers.Reshape((2, 3, 1), name = 'Res13177', )(Sep29094)
Glo71867 = keras.layers.GlobalMaxPool2D(name = 'Glo71867', )(Res13177)
model = tf.keras.models.Model(inputs=[in0Cro17213], outputs=Glo71867)
w = model.get_layer('Sep29094').get_weights() 
w[0] = np.array([[[0.8482], [0.8779], [0.9286], [0.1187], [0.935], [0.2497]]])
w[1] = np.array([[[0.1341, 0.1738, 0.0318], [0.4703, 0.2705, 0.1103], [0.0109, 0.7826, 0.8787], [0.9427, 0.1334, 0.7007], [0.6075, 0.8236, 0.0321], [0.1171, 0.5642, 0.36]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep29094').set_weights(w) 
in0Cro17213 = tf.constant([[[[1.967, 1.2583], [1.5578, 1.8279], [1.9059, 1.2029], [1.0793, 1.8938]], [[1.5042, 1.94], [1.6013, 1.3456], [1.9247, 1.745], [1.8995, 1.6553]], [[1.6986, 1.1657], [1.6327, 1.3436], [1.3519, 1.4077], [1.5505, 1.0213]]]])
print (np.array2string(model.predict([in0Cro17213],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo71867.png')

LCro17213 = cropping2D_layer([[[[1.967, 1.2583], [1.5578, 1.8279], [1.9059, 1.2029], [1.0793, 1.8938]], [[1.5042, 1.94], [1.6013, 1.3456], [1.9247, 1.745], [1.8995, 1.6553]], [[1.6986, 1.1657], [1.6327, 1.3436], [1.3519, 1.4077], [1.5505, 1.0213]]]], 1, 0, 1, 0, Cro17213), 
LRes44512 = reshape_layer(Cro17213, [2, 6], Res44512), 
LSep29094 = separable_conv1D_layer(Res44512, 1,[[[[0.8482], [0.8779], [0.9286], [0.1187], [0.935], [0.2497]]],[[[0.1341, 0.1738, 0.0318], [0.4703, 0.2705, 0.1103], [0.0109, 0.7826, 0.8787], [0.9427, 0.1334, 0.7007], [0.6075, 0.8236, 0.0321], [0.1171, 0.5642, 0.36]]]],[0, 0, 0], 1, false, Sep29094), 
LRes13177 = reshape_layer(Sep29094, [2, 3, 1], Res13177), 
LGlo71867 = global_max_pool2D_layer(Res13177, Glo71867), 
exec_layers([LCro17213,LRes44512,LSep29094,LRes13177,LGlo71867],["Cro17213","Res44512","Sep29094","Res13177","Glo71867"],Glo71867,"Glo71867")

Actual (Unparsed): [[3.6778955]]

Expected (Unparsed): [[3.677895478542]]

Actual:   [[3.6779]]

Expected: [[3.6779]]