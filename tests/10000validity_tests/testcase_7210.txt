import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max35240 = tf.keras.layers.Input(shape=([2, 1]))
in1Max35240 = tf.keras.layers.Input(shape=([2, 1]))
in0Con59982 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot90020 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot90020 = tf.keras.layers.Input(shape=([2, 3]))

Max35240 = keras.layers.Maximum(name = 'Max35240', )([in0Max35240,in1Max35240])
GRU53652 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU53652', )(Max35240)
Res30715 = keras.layers.Reshape((1, 1), name = 'Res30715', )(GRU53652)
Zer54122 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer54122', )(Res30715)
Con59982 = keras.layers.Concatenate(axis=2, name = 'Con59982', )([Zer54122,in0Con59982])
Dot90020 = keras.layers.Dot(axes=(2, 2), name = 'Dot90020', )([in0Dot90020,in1Dot90020])
Mul86669 = keras.layers.Multiply(name = 'Mul86669', )([Con59982,Dot90020])
model = tf.keras.models.Model(inputs=[in0Max35240,in1Max35240,in0Con59982,in0Dot90020,in1Dot90020], outputs=Mul86669)
w = model.get_layer('GRU53652').get_weights() 
w[0] = np.array([[10, 6, 9]])
w[1] = np.array([[10, 2, 1]])
w[2] = np.array([[6, 8, 6], [1, 1, 2]])
model.get_layer('GRU53652').set_weights(w) 
in0Max35240 = tf.constant([[[0.9083], [0.4888]]])
in1Max35240 = tf.constant([[[0.0676], [0.6545]]])
in0Con59982 = tf.constant([[[0.7948], [0.8252]]])
in0Dot90020 = tf.constant([[[0.0198, 0.4456, 0.8016], [0.497, 0.9975, 0.0609]]])
in1Dot90020 = tf.constant([[[0.1003, 0.4899, 0.7441], [0.8899, 0.5101, 0.685]]])
print (np.array2string(model.predict([in0Max35240,in1Max35240,in0Con59982,in0Dot90020,in1Dot90020],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Mul86669.png')

LMax35240 = maximum_layer([[[[0.9083], [0.4888]]], [[[0.0676], [0.6545]]]], Max35240), 
LGRU53652 = gru_layer(Max35240,[[10, 6, 9]],[[10, 2, 1]],[[6, 8, 6], [1, 1, 2]], true, GRU53652), 
LRes30715 = reshape_layer(GRU53652, [1, 1], Res30715), 
LZer54122 = zero_padding1D_layer(Res30715, 1, 0, Zer54122), 
LCon59982 = concatenate_layer([Zer54122,[[[0.7948], [0.8252]]]], 2, Con59982), 
LDot90020 = dot_layer([[[0.0198, 0.4456, 0.8016], [0.497, 0.9975, 0.0609]]], [[[0.1003, 0.4899, 0.7441], [0.8899, 0.5101, 0.685]]], 2, 2, Dot90020), 
LMul86669 = multiply_layer([Con59982,Dot90020], Mul86669), 
exec_layers([LMax35240,LGRU53652,LRes30715,LZer54122,LCon59982,LDot90020,LMul86669],["Max35240","GRU53652","Res30715","Zer54122","Con59982","Dot90020","Mul86669"],Mul86669,"Mul86669")

Actual (Unparsed): [[[0.0000000, 0.6310844], [0.0000008, 0.8192764]]]

Expected (Unparsed): [[[0.0,0.6310843777840001],[8.256678046122779e-7,0.8192763430600001]]]

Actual:   [[[0, 0.6311], [0, 0.8193]]]

Expected: [[[0, 0.6311], [0, 0.8193]]]