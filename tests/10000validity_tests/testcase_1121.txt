import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0PRe32488 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

PRe32488 = keras.layers.PReLU(name = 'PRe32488', input_shape=(1, 2, 1, 2))(in0PRe32488)
Res1569 = keras.layers.Reshape((1, 2, 2), name = 'Res1569', )(PRe32488)
Glo43544 = keras.layers.GlobalAveragePooling2D(name = 'Glo43544', )(Res1569)
Res87233 = keras.layers.Reshape((2, 1), name = 'Res87233', )(Glo43544)
Res65845 = keras.layers.Reshape((2, 1, 1), name = 'Res65845', )(Res87233)
Dep20110 = keras.layers.DepthwiseConv2D((1, 1),strides=(2, 2), padding='same', name = 'Dep20110', )(Res65845)
Bat47738 = keras.layers.BatchNormalization(axis=1, epsilon=0.5215930747485497,  name = 'Bat47738', )(Dep20110)
model = tf.keras.models.Model(inputs=[in0PRe32488], outputs=Bat47738)
w = model.get_layer('PRe32488').get_weights() 
w[0] = np.array([[[[0.9643, 0.7805]], [[0.4051, 0.5749]]]])
model.get_layer('PRe32488').set_weights(w) 
w = model.get_layer('Dep20110').get_weights() 
w[0] = np.array([[[[0.8696]]]])
w[1] = np.array([0])
model.get_layer('Dep20110').set_weights(w) 
w = model.get_layer('Bat47738').get_weights() 
w[0] = np.array([0.8491])
w[1] = np.array([0.6155])
w[2] = np.array([0.4326])
w[3] = np.array([0.8461])
model.get_layer('Bat47738').set_weights(w) 
in0PRe32488 = tf.constant([[[[[0.7689, 0.8669]], [[0.8319, 0.1749]]]]])
print (np.array2string(model.predict([in0PRe32488],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat47738.png')

LPRe32488 = prelu_layer([[[[[0.7689, 0.8669]], [[0.8319, 0.1749]]]]], [[[[0.9643, 0.7805]], [[0.4051, 0.5749]]]], PRe32488), 
LRes1569 = reshape_layer(PRe32488, [1, 2, 2], Res1569), 
LGlo43544 = global_average_pooling2D_layer(Res1569, Glo43544), 
LRes87233 = reshape_layer(Glo43544, [2, 1], Res87233), 
LRes65845 = reshape_layer(Res87233, [2, 1, 1], Res65845), 
LDep20110 = depthwise_conv2D_layer(Res65845, 1, 1,[[[[0.8696]]]],[0], 2, 2, true, Dep20110), 
LBat47738 = batch_normalization_layer(Dep20110, 1, 0.5215930747485497, [0.8491], [0.6155], [0.4326], [0.8461], Bat47738), 
exec_layers([LPRe32488,LRes1569,LGlo43544,LRes87233,LRes65845,LDep20110,LBat47738],["PRe32488","Res1569","Glo43544","Res87233","Res65845","Dep20110","Bat47738"],Bat47738,"Bat47738")

Actual (Unparsed): [[[[0.8067609]]]]

Expected (Unparsed): [[[[0.8067608967924274]]]]

Actual:   [[[[0.8068]]]]

Expected: [[[[0.8068]]]]