import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max51461 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Max51461 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Mul58956 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul58956 = tf.keras.layers.Input(shape=([2, 1]))

Max51461 = keras.layers.Maximum(name = 'Max51461', )([in0Max51461,in1Max51461])
Res95765 = keras.layers.Reshape((2, 1, 1), name = 'Res95765', )(Max51461)
Mul58956 = keras.layers.Multiply(name = 'Mul58956', )([in0Mul58956,in1Mul58956])
Lay51831 = keras.layers.LayerNormalization(axis=1, epsilon=2.8870723649850945, name = 'Lay51831', )(Mul58956)
Res990 = keras.layers.Reshape((2, 1, 1), name = 'Res990', )(Lay51831)
Sub58077 = keras.layers.Subtract(name = 'Sub58077', )([Res95765,Res990])
model = tf.keras.models.Model(inputs=[in0Max51461,in1Max51461,in0Mul58956,in1Mul58956], outputs=Sub58077)
in0Max51461 = tf.constant([[[[[0.7038]]], [[[0.5962]]]]])
in1Max51461 = tf.constant([[[[[0.4104]]], [[[0.4743]]]]])
in0Mul58956 = tf.constant([[[0.0833], [0.5275]]])
in1Mul58956 = tf.constant([[[0.0419], [0.4128]]])
print (np.array2string(model.predict([in0Max51461,in1Max51461,in0Mul58956,in1Mul58956],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub58077.png')

LMax51461 = maximum_layer([[[[[[0.7038]]], [[[0.5962]]]]], [[[[[0.4104]]], [[[0.4743]]]]]], Max51461), 
LRes95765 = reshape_layer(Max51461, [2, 1, 1], Res95765), 
LMul58956 = multiply_layer([[[[0.0833], [0.5275]]], [[[0.0419], [0.4128]]]], Mul58956), 
LLay51831 = layer_normalization_layer(Mul58956, 1, 2.8870723649850945, Lay51831), 
LRes990 = reshape_layer(Lay51831, [2, 1, 1], Res990), 
LSub58077 = subtract_layer(Res95765,Res990, Sub58077), 
exec_layers([LMax51461,LRes95765,LMul58956,LLay51831,LRes990,LSub58077],["Max51461","Res95765","Mul58956","Lay51831","Res990","Sub58077"],Sub58077,"Sub58077")

Actual (Unparsed): [[[[0.7667252]], [[0.5332748]]]]

Expected (Unparsed): [[[[0.7667251499662998]],[[0.5332748500337001]]]]

Actual:   [[[[0.7668]], [[0.5333]]]]

Expected: [[[[0.7668]], [[0.5333]]]]