import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add54980 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Add54980 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Max27048 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Max27048 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in0Con95862 = tf.keras.layers.Input(shape=([1]))

Add54980 = keras.layers.Add(name = 'Add54980', )([in0Add54980,in1Add54980])
Res46881 = keras.layers.Reshape((2, 1), name = 'Res46881', )(Add54980)
Fla45087 = keras.layers.Flatten(name = 'Fla45087', )(Res46881)
Max27048 = keras.layers.Maximum(name = 'Max27048', )([in0Max27048,in1Max27048])
Res12240 = keras.layers.Reshape((2, 1, 1), name = 'Res12240', )(Max27048)
Res92862 = keras.layers.Reshape((2, 1), name = 'Res92862', )(Res12240)
Con8932 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con8932', )(Res92862)
Res72179 = keras.layers.Reshape((2, 4, 1), name = 'Res72179', )(Con8932)
Glo18775 = keras.layers.GlobalAveragePooling2D(name = 'Glo18775', )(Res72179)
Con95862 = keras.layers.Concatenate(axis=1, name = 'Con95862', )([Glo18775,in0Con95862])
Min8865 = keras.layers.Minimum(name = 'Min8865', )([Fla45087,Con95862])
model = tf.keras.models.Model(inputs=[in0Add54980,in1Add54980,in0Max27048,in1Max27048,in0Con95862], outputs=Min8865)
w = model.get_layer('Con8932').get_weights() 
w[0] = np.array([[[0.8004, 0.7147, 0.3933, 0.7391]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con8932').set_weights(w) 
in0Add54980 = tf.constant([[[[0.8829]], [[0.5245]]]])
in1Add54980 = tf.constant([[[[0.6601]], [[0.2925]]]])
in0Max27048 = tf.constant([[[[[0.5313]]], [[[0.5047]]]]])
in1Max27048 = tf.constant([[[[[0.2725]]], [[[0.2604]]]]])
in0Con95862 = tf.constant([[0.9777]])
print (np.array2string(model.predict([in0Add54980,in1Add54980,in0Max27048,in1Max27048,in0Con95862],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min8865.png')

LAdd54980 = add_layer([[[[[0.8829]], [[0.5245]]]], [[[[0.6601]], [[0.2925]]]]], Add54980), 
LRes46881 = reshape_layer(Add54980, [2, 1], Res46881), 
LFla45087 = flatten_layer(Res46881, Fla45087), 
LMax27048 = maximum_layer([[[[[[0.5313]]], [[[0.5047]]]]], [[[[[0.2725]]], [[[0.2604]]]]]], Max27048), 
LRes12240 = reshape_layer(Max27048, [2, 1, 1], Res12240), 
LRes92862 = reshape_layer(Res12240, [2, 1], Res92862), 
LCon8932 = conv1D_layer(Res92862, 1,[[[0.8004, 0.7147, 0.3933, 0.7391]]],[0, 0, 0, 0], 1, false, 1, Con8932), 
LRes72179 = reshape_layer(Con8932, [2, 4, 1], Res72179), 
LGlo18775 = global_average_pooling2D_layer(Res72179, Glo18775), 
LCon95862 = concatenate_layer([Glo18775,[[0.9777]]], 1, Con95862), 
LMin8865 = minimum_layer([Fla45087,Con95862], Min8865), 
exec_layers([LAdd54980,LRes46881,LFla45087,LMax27048,LRes12240,LRes92862,LCon8932,LRes72179,LGlo18775,LCon95862,LMin8865],["Add54980","Res46881","Fla45087","Max27048","Res12240","Res92862","Con8932","Res72179","Glo18775","Con95862","Min8865"],Min8865,"Min8865")

Actual (Unparsed): [[0.3428513, 0.8170000]]

Expected (Unparsed): [[0.34285125000000005,0.817]]

Actual:   [[0.3429, 0.817]]

Expected: [[0.3429, 0.817]]