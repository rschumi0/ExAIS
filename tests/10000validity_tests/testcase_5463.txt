import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Zer65368 = tf.keras.layers.Input(shape=([2, 4, 4, 1]))
in0Ave80729 = tf.keras.layers.Input(shape=([2, 2]))
in0Con15030 = tf.keras.layers.Input(shape=([2, 2]))

Zer65368 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer65368', )(in0Zer65368)
Res89107 = keras.layers.Reshape((4, 6, 6), name = 'Res89107', )(Zer65368)
Res67886 = keras.layers.Reshape((4, 36), name = 'Res67886', )(Res89107)
Res22077 = keras.layers.Reshape((4, 36, 1), name = 'Res22077', )(Res67886)
Res25481 = keras.layers.Reshape((4, 36, 1, 1), name = 'Res25481', )(Res22077)
Cro44196 = keras.layers.Cropping3D(cropping=((2, 0), (26, 6), (0, 0)), name = 'Cro44196', )(Res25481)
Res39442 = keras.layers.Reshape((2, 4, 1), name = 'Res39442', )(Cro44196)
Res60892 = keras.layers.Reshape((2, 4), name = 'Res60892', )(Res39442)
Ave80729 = keras.layers.AveragePooling1D(pool_size=(2), name = 'Ave80729', )(in0Ave80729)
Zer75505 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer75505', )(Ave80729)
Con15030 = keras.layers.Concatenate(axis=2, name = 'Con15030', )([Zer75505,in0Con15030])
Sub52432 = keras.layers.Subtract(name = 'Sub52432', )([Res60892,Con15030])
model = tf.keras.models.Model(inputs=[in0Zer65368,in0Ave80729,in0Con15030], outputs=Sub52432)
in0Zer65368 = tf.constant([[[[[1.228], [1.8391], [1.2749], [1.4192]], [[1.5975], [1.1897], [1.5917], [1.8074]], [[1.9833], [1.0405], [1.112], [1.4331]], [[1.1676], [1.8726], [1.581], [1.5019]]], [[[1.5402], [1.5148], [1.2539], [1.8453]], [[1.6456], [1.2427], [1.6464], [1.8941]], [[1.8528], [1.6433], [1.6785], [1.0541]], [[1.1283], [1.503], [1.2445], [1.1708]]]]])
in0Ave80729 = tf.constant([[[1.1572, 1.0625], [1.4558, 1.9325]]])
in0Con15030 = tf.constant([[[0.7332, 0.0707], [0.7616, 0.203]]])
print (np.array2string(model.predict([in0Zer65368,in0Ave80729,in0Con15030],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub52432.png')

LZer65368 = zero_padding3D_layer([[[[[1.228], [1.8391], [1.2749], [1.4192]], [[1.5975], [1.1897], [1.5917], [1.8074]], [[1.9833], [1.0405], [1.112], [1.4331]], [[1.1676], [1.8726], [1.581], [1.5019]]], [[[1.5402], [1.5148], [1.2539], [1.8453]], [[1.6456], [1.2427], [1.6464], [1.8941]], [[1.8528], [1.6433], [1.6785], [1.0541]], [[1.1283], [1.503], [1.2445], [1.1708]]]]], 1, 1, 1, 1, 1, 1, Zer65368), 
LRes89107 = reshape_layer(Zer65368, [4, 6, 6], Res89107), 
LRes67886 = reshape_layer(Res89107, [4, 36], Res67886), 
LRes22077 = reshape_layer(Res67886, [4, 36, 1], Res22077), 
LRes25481 = reshape_layer(Res22077, [4, 36, 1, 1], Res25481), 
LCro44196 = cropping3D_layer(Res25481, 2, 0, 26, 6, 0, 0, Cro44196), 
LRes39442 = reshape_layer(Cro44196, [2, 4, 1], Res39442), 
LRes60892 = reshape_layer(Res39442, [2, 4], Res60892), 
LAve80729 = average_pooling1D_layer([[[1.1572, 1.0625], [1.4558, 1.9325]]], 2, Ave80729), 
LZer75505 = zero_padding1D_layer(Ave80729, 1, 0, Zer75505), 
LCon15030 = concatenate_layer([Zer75505,[[[0.7332, 0.0707], [0.7616, 0.203]]]], 2, Con15030), 
LSub52432 = subtract_layer(Res60892,Con15030, Sub52432), 
exec_layers([LZer65368,LRes89107,LRes67886,LRes22077,LRes25481,LCro44196,LRes39442,LRes60892,LAve80729,LZer75505,LCon15030,LSub52432],["Zer65368","Res89107","Res67886","Res22077","Res25481","Cro44196","Res39442","Res60892","Ave80729","Zer75505","Con15030","Sub52432"],Sub52432,"Sub52432")

Actual (Unparsed): [[[1.5030000, 1.2445000, 0.4376000, -0.0707000], [-1.3065000, -1.4975000, -0.7616000, -0.2030000]]]

Expected (Unparsed): [[[1.503,1.2445,0.4376000000000001,-0.0707],[-1.3065,-1.4975,-0.7616,-0.203]]]

Actual:   [[[1.503, 1.2445, 0.4376, -0.0707], [-1.3065, -1.4975, -0.7616, -0.203]]]

Expected: [[[1.503, 1.2445, 0.4377, -0.0707], [-1.3065, -1.4975, -0.7616, -0.203]]]