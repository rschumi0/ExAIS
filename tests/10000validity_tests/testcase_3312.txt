import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max82271 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Max82271 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Con40727 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Thr27664 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))
in0Mas79526 = tf.keras.layers.Input(shape=([3, 4]))
in0Con47474 = tf.keras.layers.Input(shape=([3, 4]))

Max82271 = keras.layers.Maximum(name = 'Max82271', )([in0Max82271,in1Max82271])
Con40727 = keras.layers.Concatenate(axis=4, name = 'Con40727', )([Max82271,in0Con40727])
Thr27664 = keras.layers.ThresholdedReLU(theta=3.5198924456063714, name = 'Thr27664', input_shape=(1, 2, 2, 2))(in0Thr27664)
Add41069 = keras.layers.Add(name = 'Add41069', )([Con40727,Thr27664])
Res25655 = keras.layers.Reshape((1, 2, 4), name = 'Res25655', )(Add41069)
Res97078 = keras.layers.Reshape((1, 8), name = 'Res97078', )(Res25655)
Zer33724 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer33724', )(Res97078)
Mas79526 = keras.layers.Masking(mask_value=2, name = 'Mas79526', )(in0Mas79526)
Con47474 = keras.layers.Concatenate(axis=2, name = 'Con47474', )([Mas79526,in0Con47474])
Sub11373 = keras.layers.Subtract(name = 'Sub11373', )([Zer33724,Con47474])
model = tf.keras.models.Model(inputs=[in0Max82271,in1Max82271,in0Con40727,in0Thr27664,in0Mas79526,in0Con47474], outputs=Sub11373)
in0Max82271 = tf.constant([[[[[0.8922], [0.8472]], [[0.2241], [0.9611]]]]])
in1Max82271 = tf.constant([[[[[0.3143], [0.3895]], [[0.4664], [0.581]]]]])
in0Con40727 = tf.constant([[[[[0.2972], [0.1061]], [[0.0212], [0.8785]]]]])
in0Thr27664 = tf.constant([[[[[0.5014, 0.3056], [0.8406, 0.24]], [[0.3461, 0.4015], [0.5278, 0.1453]]]]])
in0Mas79526 = tf.constant([[[1.2426, 1.9643, 1.6923, 1.5944], [1.5401, 1.174, 1.9332, 1.2398], [1.4709, 1.8213, 1.9593, 1.5411]]])
in0Con47474 = tf.constant([[[0.1195, 0.6098, 0.6515, 0.4807], [0.2361, 0.2569, 0.7929, 0.1172], [0.5881, 0.0068, 0.4599, 0.8641]]])
print (np.array2string(model.predict([in0Max82271,in1Max82271,in0Con40727,in0Thr27664,in0Mas79526,in0Con47474],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub11373.png')

LMax82271 = maximum_layer([[[[[[0.8922], [0.8472]], [[0.2241], [0.9611]]]]], [[[[[0.3143], [0.3895]], [[0.4664], [0.581]]]]]], Max82271), 
LCon40727 = concatenate_layer([Max82271,[[[[[0.2972], [0.1061]], [[0.0212], [0.8785]]]]]], 4, Con40727), 
LThr27664 = thresholded_relu_layer([[[[[0.5014, 0.3056], [0.8406, 0.24]], [[0.3461, 0.4015], [0.5278, 0.1453]]]]], 3.5198924456063714, Thr27664), 
LAdd41069 = add_layer([Con40727,Thr27664], Add41069), 
LRes25655 = reshape_layer(Add41069, [1, 2, 4], Res25655), 
LRes97078 = reshape_layer(Res25655, [1, 8], Res97078), 
LZer33724 = zero_padding1D_layer(Res97078, 2, 0, Zer33724), 
LMas79526 = masking_layer([[[1.2426, 1.9643, 1.6923, 1.5944], [1.5401, 1.174, 1.9332, 1.2398], [1.4709, 1.8213, 1.9593, 1.5411]]], 2, Mas79526), 
LCon47474 = concatenate_layer([Mas79526,[[[0.1195, 0.6098, 0.6515, 0.4807], [0.2361, 0.2569, 0.7929, 0.1172], [0.5881, 0.0068, 0.4599, 0.8641]]]], 2, Con47474), 
LSub11373 = subtract_layer(Zer33724,Con47474, Sub11373), 
exec_layers([LMax82271,LCon40727,LThr27664,LAdd41069,LRes25655,LRes97078,LZer33724,LMas79526,LCon47474,LSub11373],["Max82271","Con40727","Thr27664","Add41069","Res25655","Res97078","Zer33724","Mas79526","Con47474","Sub11373"],Sub11373,"Sub11373")

Actual (Unparsed): [[[-1.2426000, -1.9643000, -1.6923000, -1.5944000, -0.1195000, -0.6098000, -0.6515000, -0.4807000], [-1.5401000, -1.1740000, -1.9332000, -1.2398000, -0.2361000, -0.2569000, -0.7929000, -0.1172000], [-0.5787001, -1.5241000, -1.1121001, -1.4350000, -0.1217000, 0.0144000, 0.5012000, 0.0144000]]]

Expected (Unparsed): [[[-1.2426,-1.9643,-1.6923,-1.5944,-0.1195,-0.6098,-0.6515,-0.4807],[-1.5401,-1.174,-1.9332,-1.2398,-0.2361,-0.2569,-0.7929,-0.1172],[-0.5787000000000001,-1.5240999999999998,-1.1121,-1.4349999999999998,-0.12169999999999997,0.0144,0.5012,0.014399999999999968]]]

Actual:   [[[-1.2426, -1.9643, -1.6923, -1.5944, -0.1195, -0.6098, -0.6515, -0.4807], [-1.5401, -1.174, -1.9332, -1.2398, -0.2361, -0.2569, -0.7929, -0.1172], [-0.5787, -1.5241, -1.1121, -1.435, -0.1217, 0.0144, 0.5012, 0.0144]]]

Expected: [[[-1.2426, -1.9643, -1.6923, -1.5944, -0.1195, -0.6098, -0.6515, -0.4807], [-1.5401, -1.174, -1.9332, -1.2398, -0.2361, -0.2569, -0.7929, -0.1172], [-0.5787, -1.524, -1.1121, -1.4349, -0.1216, 0.0144, 0.5012, 0.0144]]]