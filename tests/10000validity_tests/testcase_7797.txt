import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot40524 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot40524 = tf.keras.layers.Input(shape=([3, 2]))

Dot40524 = keras.layers.Dot(axes=(1, 1), name = 'Dot40524', )([in0Dot40524,in1Dot40524])
Lea37920 = keras.layers.LeakyReLU(alpha=3.054946979812323, name = 'Lea37920', )(Dot40524)
Den57293 = keras.layers.Dense(4,name = 'Den57293', )(Lea37920)
Bat22860 = keras.layers.BatchNormalization(axis=2, epsilon=0.12735296841671725,  name = 'Bat22860', )(Den57293)
model = tf.keras.models.Model(inputs=[in0Dot40524,in1Dot40524], outputs=Bat22860)
w = model.get_layer('Den57293').get_weights() 
w[0] = np.array([[0.8673, 0.2912, 0.9471, 0.9607], [0.227, 0.9474, 0.9747, 0.4063]])
w[1] = np.array([0.6956, 0.1102, 0.9706, 0.4426])
model.get_layer('Den57293').set_weights(w) 
w = model.get_layer('Bat22860').get_weights() 
w[0] = np.array([0.4732, 0.8153, 0.0698, 0.3756])
w[1] = np.array([0.5385, 0.0275, 0.8292, 0.2484])
w[2] = np.array([0.2226, 0.5967, 0.4534, 0.7447])
w[3] = np.array([0.9392, 0.0775, 0.7109, 0.0521])
model.get_layer('Bat22860').set_weights(w) 
in0Dot40524 = tf.constant([[[0.5318, 0.5472], [0.8858, 0.9626], [0.3944, 0.3334]]])
in1Dot40524 = tf.constant([[[0.7834, 0.9771], [0.3448, 0.1102], [0.6554, 0.8458]]])
print (np.array2string(model.predict([in0Dot40524,in1Dot40524],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Bat22860.png')

LDot40524 = dot_layer([[[0.5318, 0.5472], [0.8858, 0.9626], [0.3944, 0.3334]]], [[[0.7834, 0.9771], [0.3448, 0.1102], [0.6554, 0.8458]]], 1, 1, Dot40524), 
LLea37920 = leaky_relu_layer(Dot40524, 3.054946979812323, Lea37920), 
LDen57293 = dense_layer(Lea37920, [[0.8673, 0.2912, 0.9471, 0.9607], [0.227, 0.9474, 0.9747, 0.4063]],[0.6956, 0.1102, 0.9706, 0.4426], Den57293), 
LBat22860 = batch_normalization_layer(Den57293, 2, 0.12735296841671725, [0.4732, 0.8153, 0.0698, 0.3756], [0.5385, 0.0275, 0.8292, 0.2484], [0.2226, 0.5967, 0.4534, 0.7447], [0.9392, 0.0775, 0.7109, 0.0521], Bat22860), 
exec_layers([LDot40524,LLea37920,LDen57293,LBat22860],["Dot40524","Lea37920","Den57293","Bat22860"],Bat22860,"Bat22860")

Actual (Unparsed): [[[1.2437801, 1.2881450, 1.0100823, 1.1582844], [1.2402891, 1.2394663, 1.0078920, 1.1469459]]]

Expected (Unparsed): [[[1.2437800707478017,1.288145084805313,1.010082341623218,1.1582844728204718],[1.240289094710578,1.2394662766069555,1.0078919569316513,1.146945873852101]]]

Actual:   [[[1.2438, 1.2882, 1.0101, 1.1583], [1.2403, 1.2395, 1.0079, 1.147]]]

Expected: [[[1.2438, 1.2882, 1.0101, 1.1583], [1.2403, 1.2395, 1.0079, 1.147]]]