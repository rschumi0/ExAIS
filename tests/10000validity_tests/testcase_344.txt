import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0GRU13408 = tf.keras.layers.Input(shape=([2, 1]))
in0Mul7115 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul7115 = tf.keras.layers.Input(shape=([1, 2]))
in0Sof76232 = tf.keras.layers.Input(shape=([1, 1, 1]))

GRU13408 = keras.layers.GRU(1,reset_after=False, recurrent_activation='sigmoid', name = 'GRU13408', )(in0GRU13408)
Res72384 = keras.layers.Reshape((1, 1), name = 'Res72384', )(GRU13408)
Res90347 = keras.layers.Reshape((1, 1, 1), name = 'Res90347', )(Res72384)
Zer68845 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer68845', )(Res90347)
Mul7115 = keras.layers.Multiply(name = 'Mul7115', )([in0Mul7115,in1Mul7115])
Res74571 = keras.layers.Reshape((1, 2, 1), name = 'Res74571', )(Mul7115)
Sof76232 = keras.layers.Softmax(axis=1, name = 'Sof76232', input_shape=(1, 1, 1))(in0Sof76232)
Zer48854 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer48854', )(Sof76232)
Sub16526 = keras.layers.Subtract(name = 'Sub16526', )([Res74571,Zer48854])
Mul19167 = keras.layers.Multiply(name = 'Mul19167', )([Zer68845,Sub16526])
Res10783 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res10783', )(Mul19167)
Glo91479 = keras.layers.GlobalMaxPool3D(name = 'Glo91479', )(Res10783)
model = tf.keras.models.Model(inputs=[in0GRU13408,in0Mul7115,in1Mul7115,in0Sof76232], outputs=Glo91479)
w = model.get_layer('GRU13408').get_weights() 
w[0] = np.array([[4, 4, 9]])
w[1] = np.array([[7, 3, 5]])
w[2] = np.array([1, 6, 7])
model.get_layer('GRU13408').set_weights(w) 
in0GRU13408 = tf.constant([[[4], [3]]])
in0Mul7115 = tf.constant([[[0.8141, 0.7639]]])
in1Mul7115 = tf.constant([[[0.4537, 0.0501]]])
in0Sof76232 = tf.constant([[[[0.9064]]]])
print (np.array2string(model.predict([in0GRU13408,in0Mul7115,in1Mul7115,in0Sof76232],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo91479.png')

LGRU13408 = gru_layer([[[4], [3]]],[[4, 4, 9]],[[7, 3, 5]],[1, 6, 7], false, GRU13408), 
LRes72384 = reshape_layer(GRU13408, [1, 1], Res72384), 
LRes90347 = reshape_layer(Res72384, [1, 1, 1], Res90347), 
LZer68845 = zero_padding2D_layer(Res90347, 0, 0, 1, 0, Zer68845), 
LMul7115 = multiply_layer([[[[0.8141, 0.7639]]], [[[0.4537, 0.0501]]]], Mul7115), 
LRes74571 = reshape_layer(Mul7115, [1, 2, 1], Res74571), 
LSof76232 = softmax_layer([[[[0.9064]]]], 1, Sof76232), 
LZer48854 = zero_padding2D_layer(Sof76232, 0, 0, 1, 0, Zer48854), 
LSub16526 = subtract_layer(Res74571,Zer48854, Sub16526), 
LMul19167 = multiply_layer([Zer68845,Sub16526], Mul19167), 
LRes10783 = reshape_layer(Mul19167, [1, 2, 1, 1], Res10783), 
LGlo91479 = global_max_pool3D_layer(Res10783, Glo91479), 
exec_layers([LGRU13408,LRes72384,LRes90347,LZer68845,LMul7115,LRes74571,LSof76232,LZer48854,LSub16526,LMul19167,LRes10783,LGlo91479],["GRU13408","Res72384","Res90347","Zer68845","Mul7115","Res74571","Sof76232","Zer48854","Sub16526","Mul19167","Res10783","Glo91479"],Glo91479,"Glo91479")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0.0]]

Actual:   [[0]]

Expected: [[0]]