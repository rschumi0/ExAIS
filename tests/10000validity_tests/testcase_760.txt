import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub61326 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))
in1Sub61326 = tf.keras.layers.Input(shape=([3, 2, 3, 2]))
in0Max36582 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Max36582 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Sub61326 = keras.layers.Subtract(name = 'Sub61326', )([in0Sub61326,in1Sub61326])
Max36582 = keras.layers.Maximum(name = 'Max36582', )([in0Max36582,in1Max36582])
Zer85394 = keras.layers.ZeroPadding3D(padding=((2, 0), (1, 0), (2, 0)), name = 'Zer85394', )(Max36582)
Add49381 = keras.layers.Add(name = 'Add49381', )([Sub61326,Zer85394])
Res71383 = keras.layers.Reshape((3, 2, 6), name = 'Res71383', )(Add49381)
Res37884 = keras.layers.Reshape((3, 12), name = 'Res37884', )(Res71383)
Con87716 = keras.layers.Conv1D(2, (1),strides=(5), padding='same', dilation_rate=(1), name = 'Con87716', )(Res37884)
model = tf.keras.models.Model(inputs=[in0Sub61326,in1Sub61326,in0Max36582,in1Max36582], outputs=Con87716)
w = model.get_layer('Con87716').get_weights() 
w[0] = np.array([[[0.8543, 0.5514], [0.639, 0.0547], [0.7343, 0.3108], [0.392, 0.324], [0.9906, 0.3538], [0.2745, 0.7559], [0.1717, 0.4941], [0.9635, 0.943], [0.941, 0.8127], [0.9309, 0.2533], [0.171, 0.346], [0.1359, 0.5058]]])
w[1] = np.array([0, 0])
model.get_layer('Con87716').set_weights(w) 
in0Sub61326 = tf.constant([[[[[0.1703, 0.6184], [0.4665, 0.6305], [0.0254, 0.3186]], [[0.8576, 0.9657], [0.4127, 0.334], [0.6945, 0.4778]]], [[[0.9571, 0.8193], [0.8216, 0.337], [0.0423, 0.3664]], [[0.0636, 0.7329], [0.2103, 0.6288], [0.2005, 0.9187]]], [[[0.3315, 0.964], [0.4227, 0.8729], [0.4914, 0.5056]], [[0.3437, 0.0305], [0.2752, 0.1995], [0.9624, 0.3628]]]]])
in1Sub61326 = tf.constant([[[[[0.2821, 0.1142], [0.1919, 0.0635], [0.2479, 0.7724]], [[0.7014, 0.2407], [0.115, 0.341], [0.8533, 0.3032]]], [[[0.7543, 0.2632], [0.461, 0.1841], [0.8101, 0.3205]], [[0.9414, 0.1492], [0.3213, 0.1718], [0.1894, 0.6998]]], [[[0.3488, 0.1314], [0.1654, 0.0003], [0.8349, 0.3223]], [[0.7517, 0.3342], [0.3104, 0.3672], [0.9095, 0.3253]]]]])
in0Max36582 = tf.constant([[[[[0.8706, 0.4648]]]]])
in1Max36582 = tf.constant([[[[[0.5461, 0.0471]]]]])
print (np.array2string(model.predict([in0Sub61326,in1Sub61326,in0Max36582,in1Max36582],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con87716.png')

LSub61326 = subtract_layer([[[[[0.1703, 0.6184], [0.4665, 0.6305], [0.0254, 0.3186]], [[0.8576, 0.9657], [0.4127, 0.334], [0.6945, 0.4778]]], [[[0.9571, 0.8193], [0.8216, 0.337], [0.0423, 0.3664]], [[0.0636, 0.7329], [0.2103, 0.6288], [0.2005, 0.9187]]], [[[0.3315, 0.964], [0.4227, 0.8729], [0.4914, 0.5056]], [[0.3437, 0.0305], [0.2752, 0.1995], [0.9624, 0.3628]]]]], [[[[[0.2821, 0.1142], [0.1919, 0.0635], [0.2479, 0.7724]], [[0.7014, 0.2407], [0.115, 0.341], [0.8533, 0.3032]]], [[[0.7543, 0.2632], [0.461, 0.1841], [0.8101, 0.3205]], [[0.9414, 0.1492], [0.3213, 0.1718], [0.1894, 0.6998]]], [[[0.3488, 0.1314], [0.1654, 0.0003], [0.8349, 0.3223]], [[0.7517, 0.3342], [0.3104, 0.3672], [0.9095, 0.3253]]]]], Sub61326), 
LMax36582 = maximum_layer([[[[[[0.8706, 0.4648]]]]], [[[[[0.5461, 0.0471]]]]]], Max36582), 
LZer85394 = zero_padding3D_layer(Max36582, 2, 0, 1, 0, 2, 0, Zer85394), 
LAdd49381 = add_layer([Sub61326,Zer85394], Add49381), 
LRes71383 = reshape_layer(Add49381, [3, 2, 6], Res71383), 
LRes37884 = reshape_layer(Res71383, [3, 12], Res37884), 
LCon87716 = conv1D_layer(Res37884, 1,[[[0.8543, 0.5514], [0.639, 0.0547], [0.7343, 0.3108], [0.392, 0.324], [0.9906, 0.3538], [0.2745, 0.7559], [0.1717, 0.4941], [0.9635, 0.943], [0.941, 0.8127], [0.9309, 0.2533], [0.171, 0.346], [0.1359, 0.5058]]],[0, 0], 5, true, 1, Con87716), 
exec_layers([LSub61326,LMax36582,LZer85394,LAdd49381,LRes71383,LRes37884,LCon87716],["Sub61326","Max36582","Zer85394","Add49381","Res71383","Res37884","Con87716"],Con87716,"Con87716")

Actual (Unparsed): [[[1.3011490, 0.8476280]]]

Expected (Unparsed): [[[1.3011490200000002,0.84762797]]]

Actual:   [[[1.3012, 0.8477]]]

Expected: [[[1.3012, 0.8477]]]