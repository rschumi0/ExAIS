import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max71782 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max71782 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con88743 = tf.keras.layers.Input(shape=([2, 2, 3, 3]))
in0Mul39277 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul39277 = tf.keras.layers.Input(shape=([2, 2]))
in0Con69958 = tf.keras.layers.Input(shape=([2, 2, 3, 3]))
in0Con30909 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))

Max71782 = keras.layers.Maximum(name = 'Max71782', )([in0Max71782,in1Max71782])
Res84967 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res84967', )(Max71782)
Zer45616 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer45616', )(Res84967)
Con88743 = keras.layers.Concatenate(axis=4, name = 'Con88743', )([Zer45616,in0Con88743])
Mul39277 = keras.layers.Multiply(name = 'Mul39277', )([in0Mul39277,in1Mul39277])
PRe12683 = keras.layers.PReLU(name = 'PRe12683', )(Mul39277)
Res21144 = keras.layers.Reshape((2, 2, 1), name = 'Res21144', )(PRe12683)
Res54787 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res54787', )(Res21144)
Zer99910 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer99910', )(Res54787)
Con69958 = keras.layers.Concatenate(axis=4, name = 'Con69958', )([Zer99910,in0Con69958])
Con30909 = keras.layers.Conv3DTranspose(4, (1, 1, 2),strides=(1, 1, 1), padding='same', name = 'Con30909', )(in0Con30909)
Zer5476 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer5476', )(Con30909)
Max31022 = keras.layers.Maximum(name = 'Max31022', )([Con69958,Zer5476])
Sub77365 = keras.layers.Subtract(name = 'Sub77365', )([Con88743,Max31022])
model = tf.keras.models.Model(inputs=[in0Max71782,in1Max71782,in0Con88743,in0Mul39277,in1Mul39277,in0Con69958,in0Con30909], outputs=Sub77365)
w = model.get_layer('PRe12683').get_weights() 
w[0] = np.array([[0.4409, 0.9772], [0.0543, 0.577]])
model.get_layer('PRe12683').set_weights(w) 
w = model.get_layer('Con30909').get_weights() 
w[0] = np.array([[[[[0.2315], [0.6766], [0.0731], [0.5828]], [[0.9884], [0.531], [0.1758], [0.6714]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con30909').set_weights(w) 
in0Max71782 = tf.constant([[[[0.8814, 0.6526]]]])
in1Max71782 = tf.constant([[[[0.6152, 0.4322]]]])
in0Con88743 = tf.constant([[[[[0.4369, 0.0741, 0.9807], [0.261, 0.0039, 0.0961], [0.1475, 0.378, 0.3422]], [[0.9195, 0.5182, 0.4899], [0.469, 0.9054, 0.1767], [0.5492, 0.3274, 0.171]]], [[[0.5208, 0.6174, 0.2768], [0.5908, 0.027, 0.3643], [0.975, 0.9122, 0.8442]], [[0.2939, 0.8793, 0.5799], [0.012, 0.6777, 0.2749], [0.242, 0.493, 0.3865]]]]])
in0Mul39277 = tf.constant([[[0.9438, 0.7962], [0.8474, 0.0203]]])
in1Mul39277 = tf.constant([[[0.1112, 0.8135], [0.5835, 0.8188]]])
in0Con69958 = tf.constant([[[[[0.502, 0.4491, 0.7426], [0.0942, 0.893, 0.6154], [0.6712, 0.6321, 0.7506]], [[0.5101, 0.1477, 0.9407], [0.8015, 0.6621, 0.8765], [0.9048, 0.2686, 0.169]]], [[[0.4036, 0.5075, 0.7487], [0.5268, 0.1268, 0.4726], [0.4036, 0.62, 0.9364]], [[0.5405, 0.1913, 0.9158], [0.6092, 0.3548, 0.385], [0.0622, 0.6761, 0.2943]]]]])
in0Con30909 = tf.constant([[[[[0.1488], [0.3665]]]]])
print (np.array2string(model.predict([in0Max71782,in1Max71782,in0Con88743,in0Mul39277,in1Mul39277,in0Con69958,in0Con30909],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub77365.png')

LMax71782 = maximum_layer([[[[[0.8814, 0.6526]]]], [[[[0.6152, 0.4322]]]]], Max71782), 
LRes84967 = reshape_layer(Max71782, [1, 1, 2, 1], Res84967), 
LZer45616 = zero_padding3D_layer(Res84967, 1, 0, 1, 0, 1, 0, Zer45616), 
LCon88743 = concatenate_layer([Zer45616,[[[[[0.4369, 0.0741, 0.9807], [0.261, 0.0039, 0.0961], [0.1475, 0.378, 0.3422]], [[0.9195, 0.5182, 0.4899], [0.469, 0.9054, 0.1767], [0.5492, 0.3274, 0.171]]], [[[0.5208, 0.6174, 0.2768], [0.5908, 0.027, 0.3643], [0.975, 0.9122, 0.8442]], [[0.2939, 0.8793, 0.5799], [0.012, 0.6777, 0.2749], [0.242, 0.493, 0.3865]]]]]], 4, Con88743), 
LMul39277 = multiply_layer([[[[0.9438, 0.7962], [0.8474, 0.0203]]], [[[0.1112, 0.8135], [0.5835, 0.8188]]]], Mul39277), 
LPRe12683 = prelu_layer(Mul39277, [[0.4409, 0.9772], [0.0543, 0.577]], PRe12683), 
LRes21144 = reshape_layer(PRe12683, [2, 2, 1], Res21144), 
LRes54787 = reshape_layer(Res21144, [2, 2, 1, 1], Res54787), 
LZer99910 = zero_padding3D_layer(Res54787, 0, 0, 0, 0, 2, 0, Zer99910), 
LCon69958 = concatenate_layer([Zer99910,[[[[[0.502, 0.4491, 0.7426], [0.0942, 0.893, 0.6154], [0.6712, 0.6321, 0.7506]], [[0.5101, 0.1477, 0.9407], [0.8015, 0.6621, 0.8765], [0.9048, 0.2686, 0.169]]], [[[0.4036, 0.5075, 0.7487], [0.5268, 0.1268, 0.4726], [0.4036, 0.62, 0.9364]], [[0.5405, 0.1913, 0.9158], [0.6092, 0.3548, 0.385], [0.0622, 0.6761, 0.2943]]]]]], 4, Con69958), 
LCon30909 = conv3D_transpose_layer([[[[[0.1488], [0.3665]]]]], 1, 1, 2,[[[[[0.2315], [0.6766], [0.0731], [0.5828]], [[0.9884], [0.531], [0.1758], [0.6714]]]]],[0, 0, 0, 0], 1, 1, 1, true, Con30909), 
LZer5476 = zero_padding3D_layer(Con30909, 1, 0, 1, 0, 1, 0, Zer5476), 
LMax31022 = maximum_layer([Con69958,Zer5476], Max31022), 
LSub77365 = subtract_layer(Con88743,Max31022, Sub77365), 
exec_layers([LMax71782,LRes84967,LZer45616,LCon88743,LMul39277,LPRe12683,LRes21144,LRes54787,LZer99910,LCon69958,LCon30909,LZer5476,LMax31022,LSub77365],["Max71782","Res84967","Zer45616","Con88743","Mul39277","PRe12683","Res21144","Res54787","Zer99910","Con69958","Con30909","Zer5476","Max31022","Sub77365"],Sub77365,"Sub77365")

Actual (Unparsed): [[[[[0.0000000, -0.0651000, -0.3750000, 0.2381000], [0.0000000, 0.1668000, -0.8891000, -0.5193000], [-0.1049506, -0.5237000, -0.2541000, -0.4084000]], [[0.0000000, 0.4094000, 0.3705000, -0.4508000], [0.0000000, -0.3325000, 0.2433000, -0.6998000], [-0.6477087, -0.3556000, 0.0588000, 0.0020000]]], [[[0.0000000, 0.1172000, 0.1099000, -0.4719000], [0.0000000, 0.0640000, -0.0998000, -0.1083000], [-0.4944579, 0.5714000, 0.2922000, -0.0922000]], [[0.0000000, -0.2466000, 0.6880000, -0.3358999], [0.8469528, -0.5972000, 0.3229000, -0.1101000], [0.4206813, -0.0849867, -0.1831000, 0.0729995]]]]]

Expected (Unparsed): [[[[[0,-0.06509999999999999,-0.375,0.23809999999999998],[0,0.1668,-0.8891,-0.5193],[-0.10495055999999998,-0.5237,-0.2541,-0.40840000000000004]],[[0,0.4094,0.3705,-0.4508],[0,-0.3325,0.24329999999999996,-0.6998],[-0.6477087,-0.3556,0.05880000000000002,0.0020000000000000018]]],[[[0,0.11720000000000003,0.1099,-0.47190000000000004],[0,0.06399999999999995,-0.0998,-0.10830000000000001],[-0.49445790000000006,0.5713999999999999,0.2922,-0.09220000000000006]],[[0,-0.24659999999999999,0.688,-0.3359],[0.8469528,-0.5972,0.32289999999999996,-0.11010000000000003],[0.42068132999999996,-0.08498669999999997,-0.18310000000000004,0.07299948000000006]]]]]

Actual:   [[[[[0, -0.0651, -0.375, 0.2381], [0, 0.1668, -0.8891, -0.5193], [-0.1049, -0.5237, -0.2541, -0.4084]], [[0, 0.4094, 0.3705, -0.4508], [0, -0.3325, 0.2433, -0.6998], [-0.6477, -0.3556, 0.0588, 0.002]]], [[[0, 0.1172, 0.1099, -0.4719], [0, 0.064, -0.0998, -0.1083], [-0.4944, 0.5714, 0.2922, -0.0922]], [[0, -0.2466, 0.688, -0.3358], [0.847, -0.5972, 0.3229, -0.1101], [0.4207, -0.0849, -0.1831, 0.073]]]]]

Expected: [[[[[0, -0.065, -0.375, 0.2381], [0, 0.1668, -0.8891, -0.5193], [-0.1049, -0.5237, -0.2541, -0.4084]], [[0, 0.4094, 0.3705, -0.4508], [0, -0.3325, 0.2433, -0.6998], [-0.6477, -0.3556, 0.0589, 0.0021]]], [[[0, 0.1173, 0.1099, -0.4719], [0, 0.064, -0.0998, -0.1083], [-0.4944, 0.5714, 0.2922, -0.0922]], [[0, -0.2465, 0.688, -0.3359], [0.847, -0.5972, 0.3229, -0.1101], [0.4207, -0.0849, -0.1831, 0.073]]]]]