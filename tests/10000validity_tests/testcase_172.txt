import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max71328 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max71328 = tf.keras.layers.Input(shape=([2, 2, 2]))

Max71328 = keras.layers.Maximum(name = 'Max71328', )([in0Max71328,in1Max71328])
Res22695 = keras.layers.Reshape((2, 4), name = 'Res22695', )(Max71328)
PRe21732 = keras.layers.PReLU(name = 'PRe21732', )(Res22695)
model = tf.keras.models.Model(inputs=[in0Max71328,in1Max71328], outputs=PRe21732)
w = model.get_layer('PRe21732').get_weights() 
w[0] = np.array([[0.7067, 0.7022, 0.0268, 0.0611], [0.3982, 0.8676, 0.7833, 0.849]])
model.get_layer('PRe21732').set_weights(w) 
in0Max71328 = tf.constant([[[[0.9067, 0.7455], [0.096, 0.9284]], [[0.2223, 0.6986], [0.2304, 0.4956]]]])
in1Max71328 = tf.constant([[[[0.0157, 0.1595], [0.1286, 0.4974]], [[0.1222, 0.0515], [0.809, 0.9215]]]])
print (np.array2string(model.predict([in0Max71328,in1Max71328],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe21732.png')

LMax71328 = maximum_layer([[[[[0.9067, 0.7455], [0.096, 0.9284]], [[0.2223, 0.6986], [0.2304, 0.4956]]]], [[[[0.0157, 0.1595], [0.1286, 0.4974]], [[0.1222, 0.0515], [0.809, 0.9215]]]]], Max71328), 
LRes22695 = reshape_layer(Max71328, [2, 4], Res22695), 
LPRe21732 = prelu_layer(Res22695, [[0.7067, 0.7022, 0.0268, 0.0611], [0.3982, 0.8676, 0.7833, 0.849]], PRe21732), 
exec_layers([LMax71328,LRes22695,LPRe21732],["Max71328","Res22695","PRe21732"],PRe21732,"PRe21732")

Actual (Unparsed): [[[0.9067000, 0.7455000, 0.1286000, 0.9284000], [0.2223000, 0.6986000, 0.8090000, 0.9215000]]]

Expected (Unparsed): [[[0.9067,0.7455,0.1286,0.9284],[0.2223,0.6986,0.809,0.9215]]]

Actual:   [[[0.9067, 0.7455, 0.1286, 0.9284], [0.2223, 0.6986, 0.809, 0.9215]]]

Expected: [[[0.9067, 0.7455, 0.1286, 0.9284], [0.2223, 0.6986, 0.809, 0.9215]]]