import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub21107 = tf.keras.layers.Input(shape=([3, 3, 3, 2]))
in1Sub21107 = tf.keras.layers.Input(shape=([3, 3, 3, 2]))

Sub21107 = keras.layers.Subtract(name = 'Sub21107', )([in0Sub21107,in1Sub21107])
Res18012 = keras.layers.Reshape((3, 3, 6), name = 'Res18012', )(Sub21107)
Res13253 = keras.layers.Reshape((3, 18), name = 'Res13253', )(Res18012)
Zer35216 = keras.layers.ZeroPadding1D(padding=((1, 1)), name = 'Zer35216', )(Res13253)
Lea72593 = keras.layers.LeakyReLU(alpha=5.752081164269068, name = 'Lea72593', )(Zer35216)
ELU64020 = keras.layers.ELU(alpha=-1.5091850552603816, name = 'ELU64020', )(Lea72593)
Res95881 = keras.layers.Reshape((5, 18, 1), name = 'Res95881', )(ELU64020)
Glo87972 = keras.layers.GlobalMaxPool2D(name = 'Glo87972', )(Res95881)
model = tf.keras.models.Model(inputs=[in0Sub21107,in1Sub21107], outputs=Glo87972)
in0Sub21107 = tf.constant([[[[[0.6077, 0.9245], [0.5586, 0.5564], [0.0828, 0.8234]], [[0.785, 0.0213], [0.1761, 0.3832], [0.0231, 0.6769]], [[0.4235, 0.9637], [0.0952, 0.9244], [0.2085, 0.2858]]], [[[0.3257, 0.8016], [0.9698, 0.0119], [0.378, 0.3211]], [[0.7072, 0.3805], [0.4732, 0.0719], [0.2282, 0.6729]], [[0.2969, 0.8068], [0.9975, 0.1911], [0.8365, 0.7816]]], [[[0.1593, 0.8534], [0.1127, 0.6797], [0.2852, 0.4798]], [[0.269, 0.0625], [0.6671, 0.3297], [0.766, 0.4144]], [[0.5248, 0.48], [0.4895, 0.022], [0.323, 0.1874]]]]])
in1Sub21107 = tf.constant([[[[[0.4286, 0.1191], [0.5079, 0.4653], [0.202, 0.9587]], [[0.3594, 0.724], [0.1228, 0.7312], [0.3334, 0.472]], [[0.6762, 0.5384], [0.2182, 0.7574], [0.2562, 0.9543]]], [[[0.6677, 0.2404], [0.7601, 0.0558], [0.1887, 0.5296]], [[0.1677, 0.1906], [0.4572, 0.6919], [0.5486, 0.164]], [[0.9211, 0.6485], [0.0361, 0.9737], [0.0012, 0.5086]]], [[[0.1792, 0.6983], [0.8501, 0.7592], [0.745, 0.654]], [[0.5473, 0.6306], [0.4791, 0.4748], [0.8138, 0.8848]], [[0.5542, 0.342], [0.8177, 0.7393], [0.4352, 0.1917]]]]])
print (np.array2string(model.predict([in0Sub21107,in1Sub21107],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo87972.png')

LSub21107 = subtract_layer([[[[[0.6077, 0.9245], [0.5586, 0.5564], [0.0828, 0.8234]], [[0.785, 0.0213], [0.1761, 0.3832], [0.0231, 0.6769]], [[0.4235, 0.9637], [0.0952, 0.9244], [0.2085, 0.2858]]], [[[0.3257, 0.8016], [0.9698, 0.0119], [0.378, 0.3211]], [[0.7072, 0.3805], [0.4732, 0.0719], [0.2282, 0.6729]], [[0.2969, 0.8068], [0.9975, 0.1911], [0.8365, 0.7816]]], [[[0.1593, 0.8534], [0.1127, 0.6797], [0.2852, 0.4798]], [[0.269, 0.0625], [0.6671, 0.3297], [0.766, 0.4144]], [[0.5248, 0.48], [0.4895, 0.022], [0.323, 0.1874]]]]], [[[[[0.4286, 0.1191], [0.5079, 0.4653], [0.202, 0.9587]], [[0.3594, 0.724], [0.1228, 0.7312], [0.3334, 0.472]], [[0.6762, 0.5384], [0.2182, 0.7574], [0.2562, 0.9543]]], [[[0.6677, 0.2404], [0.7601, 0.0558], [0.1887, 0.5296]], [[0.1677, 0.1906], [0.4572, 0.6919], [0.5486, 0.164]], [[0.9211, 0.6485], [0.0361, 0.9737], [0.0012, 0.5086]]], [[[0.1792, 0.6983], [0.8501, 0.7592], [0.745, 0.654]], [[0.5473, 0.6306], [0.4791, 0.4748], [0.8138, 0.8848]], [[0.5542, 0.342], [0.8177, 0.7393], [0.4352, 0.1917]]]]], Sub21107), 
LRes18012 = reshape_layer(Sub21107, [3, 3, 6], Res18012), 
LRes13253 = reshape_layer(Res18012, [3, 18], Res13253), 
LZer35216 = zero_padding1D_layer(Res13253, 1, 1, Zer35216), 
LLea72593 = leaky_relu_layer(Zer35216, 5.752081164269068, Lea72593), 
LELU64020 = elu_layer(Lea72593, -1.5091850552603816, ELU64020), 
LRes95881 = reshape_layer(ELU64020, [5, 18, 1], Res95881), 
LGlo87972 = global_max_pool2D_layer(Res95881, Glo87972), 
exec_layers([LSub21107,LRes18012,LRes13253,LZer35216,LLea72593,LELU64020,LRes95881,LGlo87972],["Sub21107","Res18012","Res13253","Zer35216","Lea72593","ELU64020","Res95881","Glo87972"],Glo87972,"Glo87972")

Actual (Unparsed): [[1.4924460]]

Expected (Unparsed): [[1.4924459708899378]]

Actual:   [[1.4925]]

Expected: [[1.4925]]