import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add85939 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Add85939 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Max8307 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Max8307 = tf.keras.layers.Input(shape=([2, 1, 1]))

Add85939 = keras.layers.Add(name = 'Add85939', )([in0Add85939,in1Add85939])
Res17037 = keras.layers.Reshape((1, 1), name = 'Res17037', )(Add85939)
LST31624 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST31624', )(Res17037)
Thr6416 = keras.layers.ThresholdedReLU(theta=9.490581118687242, name = 'Thr6416', )(LST31624)
Res37402 = keras.layers.Reshape((2, 1), name = 'Res37402', )(Thr6416)
Res55473 = keras.layers.Reshape((2, 1, 1), name = 'Res55473', )(Res37402)
Max8307 = keras.layers.Maximum(name = 'Max8307', )([in0Max8307,in1Max8307])
Sub87203 = keras.layers.Subtract(name = 'Sub87203', )([Res55473,Max8307])
model = tf.keras.models.Model(inputs=[in0Add85939,in1Add85939,in0Max8307,in1Max8307], outputs=Sub87203)
w = model.get_layer('LST31624').get_weights() 
w[0] = np.array([[4, 5, 2, 4, 5, 1, 2, 6]])
w[1] = np.array([[10, 1, 4, 6, 2, 7, 9, 10], [3, 4, 8, 3, 6, 2, 4, 6]])
w[2] = np.array([1, 1, 3, 10, 4, 1, 8, 2])
model.get_layer('LST31624').set_weights(w) 
in0Add85939 = tf.constant([[[[0.2588]]]])
in1Add85939 = tf.constant([[[[0.5259]]]])
in0Max8307 = tf.constant([[[[0.8985]], [[0.1018]]]])
in1Max8307 = tf.constant([[[[0.4467]], [[0.3781]]]])
print (np.array2string(model.predict([in0Add85939,in1Add85939,in0Max8307,in1Max8307],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub87203.png')

LAdd85939 = add_layer([[[[[0.2588]]]], [[[[0.5259]]]]], Add85939), 
LRes17037 = reshape_layer(Add85939, [1, 1], Res17037), 
LLST31624 = lstm_layer(Res17037,[[4, 5, 2, 4, 5, 1, 2, 6]],[[10, 1, 4, 6, 2, 7, 9, 10], [3, 4, 8, 3, 6, 2, 4, 6]],[1, 1, 3, 10, 4, 1, 8, 2], LST31624), 
LThr6416 = thresholded_relu_layer(LST31624, 9.490581118687242, Thr6416), 
LRes37402 = reshape_layer(Thr6416, [2, 1], Res37402), 
LRes55473 = reshape_layer(Res37402, [2, 1, 1], Res55473), 
LMax8307 = maximum_layer([[[[[0.8985]], [[0.1018]]]], [[[[0.4467]], [[0.3781]]]]], Max8307), 
LSub87203 = subtract_layer(Res55473,Max8307, Sub87203), 
exec_layers([LAdd85939,LRes17037,LLST31624,LThr6416,LRes37402,LRes55473,LMax8307,LSub87203],["Add85939","Res17037","LST31624","Thr6416","Res37402","Res55473","Max8307","Sub87203"],Sub87203,"Sub87203")

Actual (Unparsed): [[[[-0.8985000]], [[-0.3781000]]]]

Expected (Unparsed): [[[[-0.8985]],[[-0.3781]]]]

Actual:   [[[[-0.8985]], [[-0.3781]]]]

Expected: [[[[-0.8985]], [[-0.3781]]]]