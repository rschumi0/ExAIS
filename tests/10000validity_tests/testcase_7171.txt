import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max37034 = tf.keras.layers.Input(shape=([1, 1]))
in1Max37034 = tf.keras.layers.Input(shape=([1, 1]))

Max37034 = keras.layers.Maximum(name = 'Max37034', )([in0Max37034,in1Max37034])
Den72091 = keras.layers.Dense(1,name = 'Den72091', )(Max37034)
Res46081 = keras.layers.Reshape((1, 1, 1), name = 'Res46081', )(Den72091)
Res44924 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res44924', )(Res46081)
Glo74137 = keras.layers.GlobalMaxPool3D(name = 'Glo74137', )(Res44924)
model = tf.keras.models.Model(inputs=[in0Max37034,in1Max37034], outputs=Glo74137)
w = model.get_layer('Den72091').get_weights() 
w[0] = np.array([[0.2814]])
w[1] = np.array([0.9886])
model.get_layer('Den72091').set_weights(w) 
in0Max37034 = tf.constant([[[0.6139]]])
in1Max37034 = tf.constant([[[0.56]]])
print (np.array2string(model.predict([in0Max37034,in1Max37034],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo74137.png')

LMax37034 = maximum_layer([[[[0.6139]]], [[[0.56]]]], Max37034), 
LDen72091 = dense_layer(Max37034, [[0.2814]],[0.9886], Den72091), 
LRes46081 = reshape_layer(Den72091, [1, 1, 1], Res46081), 
LRes44924 = reshape_layer(Res46081, [1, 1, 1, 1], Res44924), 
LGlo74137 = global_max_pool3D_layer(Res44924, Glo74137), 
exec_layers([LMax37034,LDen72091,LRes46081,LRes44924,LGlo74137],["Max37034","Den72091","Res46081","Res44924","Glo74137"],Glo74137,"Glo74137")

Actual (Unparsed): [[1.1613515]]

Expected (Unparsed): [[1.1613514600000001]]

Actual:   [[1.1614]]

Expected: [[1.1614]]