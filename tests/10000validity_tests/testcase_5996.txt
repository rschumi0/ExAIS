import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add69445 = tf.keras.layers.Input(shape=([2, 2]))
in1Add69445 = tf.keras.layers.Input(shape=([2, 2]))

Add69445 = keras.layers.Add(name = 'Add69445', )([in0Add69445,in1Add69445])
GRU94337 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU94337', )(Add69445)
Res70026 = keras.layers.Reshape((3, 1), name = 'Res70026', )(GRU94337)
Per46127 = keras.layers.Permute((1,2), name = 'Per46127',)(Res70026)
model = tf.keras.models.Model(inputs=[in0Add69445,in1Add69445], outputs=Per46127)
w = model.get_layer('GRU94337').get_weights() 
w[0] = np.array([[2, 10, 3, 2, 8, 2, 1, 8, 9], [6, 5, 10, 9, 9, 7, 5, 10, 8]])
w[1] = np.array([[9, 6, 10, 10, 3, 5, 8, 8, 10], [5, 7, 7, 9, 2, 6, 7, 7, 8], [8, 8, 7, 4, 4, 6, 10, 9, 5]])
w[2] = np.array([2, 10, 4, 1, 8, 10, 2, 2, 4])
model.get_layer('GRU94337').set_weights(w) 
in0Add69445 = tf.constant([[[0.2158, 0.017], [0.1487, 0.71]]])
in1Add69445 = tf.constant([[[0.9357, 0.7089], [0.8936, 0.0056]]])
print (np.array2string(model.predict([in0Add69445,in1Add69445],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Per46127.png')

LAdd69445 = add_layer([[[[0.2158, 0.017], [0.1487, 0.71]]], [[[0.9357, 0.7089], [0.8936, 0.0056]]]], Add69445), 
LGRU94337 = gru_layer(Add69445,[[2, 10, 3, 2, 8, 2, 1, 8, 9], [6, 5, 10, 9, 9, 7, 5, 10, 8]],[[9, 6, 10, 10, 3, 5, 8, 8, 10], [5, 7, 7, 9, 2, 6, 7, 7, 8], [8, 8, 7, 4, 4, 6, 10, 9, 5]],[2, 10, 4, 1, 8, 10, 2, 2, 4], false, GRU94337), 
LRes70026 = reshape_layer(GRU94337, [3, 1], Res70026), 
LPer46127 = permute_layer(Res70026, 1,2, Per46127), 
exec_layers([LAdd69445,LGRU94337,LRes70026,LPer46127],["Add69445","GRU94337","Res70026","Per46127"],Per46127,"Per46127")

Actual (Unparsed): [[[0.0004030], [0.0000000], [0.0000010]]]

Expected (Unparsed): [[[0.00040300170282173934],[4.969380462637406e-11],[1.0329342297726479e-6]]]

Actual:   [[[0.0005], [0], [0]]]

Expected: [[[0.0005], [0], [0]]]