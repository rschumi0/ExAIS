import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul5585 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul5585 = tf.keras.layers.Input(shape=([1, 1]))

Mul5585 = keras.layers.Multiply(name = 'Mul5585', )([in0Mul5585,in1Mul5585])
Res5484 = keras.layers.Reshape((1, 1, 1), name = 'Res5484', )(Mul5585)
Res82887 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res82887', )(Res5484)
Glo32789 = keras.layers.GlobalMaxPool3D(name = 'Glo32789', )(Res82887)
Res45703 = keras.layers.Reshape((1, 1), name = 'Res45703', )(Glo32789)
Res81127 = keras.layers.Reshape((1, 1, 1), name = 'Res81127', )(Res45703)
Sep15752 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='valid', name = 'Sep15752', )(Res81127)
Res66945 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res66945', )(Sep15752)
Cro49756 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (1, 1)), name = 'Cro49756', )(Res66945)
model = tf.keras.models.Model(inputs=[in0Mul5585,in1Mul5585], outputs=Cro49756)
w = model.get_layer('Sep15752').get_weights() 
w[0] = np.array([[[[0.659]]]])
w[1] = np.array([[[[0.8683, 0.4011, 0.9494]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep15752').set_weights(w) 
in0Mul5585 = tf.constant([[[0.8605]]])
in1Mul5585 = tf.constant([[[0.1526]]])
print (np.array2string(model.predict([in0Mul5585,in1Mul5585],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro49756.png')

LMul5585 = multiply_layer([[[[0.8605]]], [[[0.1526]]]], Mul5585), 
LRes5484 = reshape_layer(Mul5585, [1, 1, 1], Res5484), 
LRes82887 = reshape_layer(Res5484, [1, 1, 1, 1], Res82887), 
LGlo32789 = global_max_pool3D_layer(Res82887, Glo32789), 
LRes45703 = reshape_layer(Glo32789, [1, 1], Res45703), 
LRes81127 = reshape_layer(Res45703, [1, 1, 1], Res81127), 
LSep15752 = separable_conv2D_layer(Res81127, 1, 1,[[[[[0.659]]]],[[[[0.8683, 0.4011, 0.9494]]]]],[0, 0, 0], 1, 1, false, Sep15752), 
LRes66945 = reshape_layer(Sep15752, [1, 1, 3, 1], Res66945), 
LCro49756 = cropping3D_layer(Res66945, 0, 0, 0, 0, 1, 1, Cro49756), 
exec_layers([LMul5585,LRes5484,LRes82887,LGlo32789,LRes45703,LRes81127,LSep15752,LRes66945,LCro49756],["Mul5585","Res5484","Res82887","Glo32789","Res45703","Res81127","Sep15752","Res66945","Cro49756"],Cro49756,"Cro49756")

Actual (Unparsed): [[[[[0.0347091]]]]]

Expected (Unparsed): [[[[[0.03470911056627001]]]]]

Actual:   [[[[[0.0348]]]]]

Expected: [[[[[0.0348]]]]]