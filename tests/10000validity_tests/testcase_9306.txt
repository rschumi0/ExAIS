import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max83684 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Max83684 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))

Max83684 = keras.layers.Maximum(name = 'Max83684', )([in0Max83684,in1Max83684])
Res15397 = keras.layers.Reshape((2, 2, 4), name = 'Res15397', )(Max83684)
Loc5958 = keras.layers.LocallyConnected2D(3, (1, 2),strides=(2, 1), name = 'Loc5958', )(Res15397)
model = tf.keras.models.Model(inputs=[in0Max83684,in1Max83684], outputs=Loc5958)
w = model.get_layer('Loc5958').get_weights() 
w[0] = np.array([[[0.0637, 0.993, 0.5497], [0.33, 0.1577, 0.2699], [0.1985, 0.5635, 0.7917], [0.2601, 0.7139, 0.1911], [0.0056, 0.6342, 0.2815], [0.8536, 0.2078, 0.0135], [0.9917, 0.9449, 0.8375], [0.8838, 0.796, 0.4638]]])
w[1] = np.array([[[0, 0, 0]]])
model.get_layer('Loc5958').set_weights(w) 
in0Max83684 = tf.constant([[[[[0.2338, 0.475], [0.8373, 0.0029]], [[0.5691, 0.9234], [0.1379, 0.6877]]], [[[0.6472, 0.4238], [0.5798, 0.7092]], [[0.3168, 0.8251], [0.714, 0.2963]]]]])
in1Max83684 = tf.constant([[[[[0.8074, 0.5768], [0.836, 0.4259]], [[0.0008, 0.8713], [0.7888, 0.8256]]], [[[0.1049, 0.9769], [0.7227, 0.7047]], [[0.7946, 0.564], [0.977, 0.568]]]]])
print (np.array2string(model.predict([in0Max83684,in1Max83684],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Loc5958.png')

LMax83684 = maximum_layer([[[[[[0.2338, 0.475], [0.8373, 0.0029]], [[0.5691, 0.9234], [0.1379, 0.6877]]], [[[0.6472, 0.4238], [0.5798, 0.7092]], [[0.3168, 0.8251], [0.714, 0.2963]]]]], [[[[[0.8074, 0.5768], [0.836, 0.4259]], [[0.0008, 0.8713], [0.7888, 0.8256]]], [[[0.1049, 0.9769], [0.7227, 0.7047]], [[0.7946, 0.564], [0.977, 0.568]]]]]], Max83684), 
LRes15397 = reshape_layer(Max83684, [2, 2, 4], Res15397), 
LLoc5958 = locally_connected2D_layer(Res15397, 1, 2,[[[0.0637, 0.993, 0.5497], [0.33, 0.1577, 0.2699], [0.1985, 0.5635, 0.7917], [0.2601, 0.7139, 0.1911], [0.0056, 0.6342, 0.2815], [0.8536, 0.2078, 0.0135], [0.9917, 0.9449, 0.8375], [0.8838, 0.796, 0.4638]]],[[[0, 0, 0]]], 2, 1, Loc5958), 
exec_layers([LMax83684,LRes15397,LLoc5958],["Max83684","Res15397","Loc5958"],Loc5958,"Loc5958")

Actual (Unparsed): [[[[2.8220755, 3.6238986, 2.5599868]]]]

Expected (Unparsed): [[[[2.8220754599999998,3.6238985800000005,2.5599868299999997]]]]

Actual:   [[[[2.8221, 3.6239, 2.56]]]]

Expected: [[[[2.8221, 3.6239, 2.56]]]]