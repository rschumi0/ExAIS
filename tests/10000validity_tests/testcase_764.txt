import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con119 = tf.keras.layers.Input(shape=([2, 1, 2, 1]))
in0ReL26507 = tf.keras.layers.Input(shape=([1, 1]))
in0Con90823 = tf.keras.layers.Input(shape=([2, 8]))
in0Max36139 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max36139 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con65552 = tf.keras.layers.Input(shape=([2, 22]))

Con119 = keras.layers.Conv3DTranspose(3, (1, 1, 2),strides=(1, 1, 1), padding='valid', name = 'Con119', )(in0Con119)
Res34450 = keras.layers.Reshape((2, 1, 9), name = 'Res34450', )(Con119)
PRe56095 = keras.layers.PReLU(name = 'PRe56095', )(Res34450)
Res49119 = keras.layers.Reshape((2, 9), name = 'Res49119', )(PRe56095)
ReL26507 = keras.layers.ReLU(max_value=6.16006275829235, negative_slope=8.982366607473805, threshold=5.690552070524658, name = 'ReL26507', input_shape=(1, 1))(in0ReL26507)
Zer63099 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer63099', )(ReL26507)
Con90823 = keras.layers.Concatenate(axis=2, name = 'Con90823', )([Zer63099,in0Con90823])
Min83608 = keras.layers.Minimum(name = 'Min83608', )([Res49119,Con90823])
Res51822 = keras.layers.Reshape((2, 9, 1), name = 'Res51822', )(Min83608)
Res37159 = keras.layers.Reshape((2, 9, 1, 1), name = 'Res37159', )(Res51822)
Con42063 = keras.layers.Conv3DTranspose(2, (1, 4, 1),strides=(1, 1, 1), padding='valid', name = 'Con42063', )(Res37159)
Res7444 = keras.layers.Reshape((2, 12, 2), name = 'Res7444', )(Con42063)
Res3722 = keras.layers.Reshape((2, 24), name = 'Res3722', )(Res7444)
Max36139 = keras.layers.Maximum(name = 'Max36139', )([in0Max36139,in1Max36139])
Res66724 = keras.layers.Reshape((1, 2), name = 'Res66724', )(Max36139)
Per41627 = keras.layers.Permute((1,2), name = 'Per41627',)(Res66724)
Zer90568 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer90568', )(Per41627)
Con65552 = keras.layers.Concatenate(axis=2, name = 'Con65552', )([Zer90568,in0Con65552])
Min15203 = keras.layers.Minimum(name = 'Min15203', )([Res3722,Con65552])
model = tf.keras.models.Model(inputs=[in0Con119,in0ReL26507,in0Con90823,in0Max36139,in1Max36139,in0Con65552], outputs=Min15203)
w = model.get_layer('Con119').get_weights() 
w[0] = np.array([[[[[0.5696], [0.2965], [0.8849]], [[0.9944], [0.9979], [0.5781]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con119').set_weights(w) 
w = model.get_layer('PRe56095').get_weights() 
w[0] = np.array([[[0.5708, 0.2388, 0.5855, 0.8876, 0.3412, 0.9056, 0.0125, 0.5182, 0.1698]], [[0.9377, 0.0626, 0.9621, 0.4436, 0.0882, 0.7139, 0.6945, 0.9692, 0.1893]]])
model.get_layer('PRe56095').set_weights(w) 
w = model.get_layer('Con42063').get_weights() 
w[0] = np.array([[[[[0.0214], [0.4969]]], [[[0.3804], [0.4446]]], [[[0.0325], [0.2665]]], [[[0.08], [0.255]]]]])
w[1] = np.array([0, 0])
model.get_layer('Con42063').set_weights(w) 
in0Con119 = tf.constant([[[[[0.9679], [0.4542]]], [[[0.1536], [0.0498]]]]])
in0ReL26507 = tf.constant([[[0.5095]]])
in0Con90823 = tf.constant([[[0.0777, 0.753, 0.1762, 0.4193, 0.0185, 0.4163, 0.3046, 0.0551], [0.0463, 0.1789, 0.2106, 0.1796, 0.3657, 0.0906, 0.2795, 0.1458]]])
in0Max36139 = tf.constant([[[[0.4117, 0.2539]]]])
in1Max36139 = tf.constant([[[[0.8041, 0.5589]]]])
in0Con65552 = tf.constant([[[0.2151, 0.9463, 0.9188, 0.7229, 0.1235, 0.6182, 0.124, 0.3747, 0.4213, 0.0071, 0.0457, 0.2304, 0.8473, 0.9997, 0.3807, 0.652, 0.3021, 0.6509, 0.7602, 0.9564, 0.0652, 0.3115], [0.2677, 0.4257, 0.0525, 0.0489, 0.257, 0.0902, 0.145, 0.3028, 0.4228, 0.1176, 0.5656, 0.1665, 0.8459, 0.0463, 0.1258, 0.2922, 0.9164, 0.1594, 0.9223, 0.1799, 0.6149, 0.0122]]])
print (np.array2string(model.predict([in0Con119,in0ReL26507,in0Con90823,in0Max36139,in1Max36139,in0Con65552],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min15203.png')

LCon119 = conv3D_transpose_layer([[[[[0.9679], [0.4542]]], [[[0.1536], [0.0498]]]]], 1, 1, 2,[[[[[0.5696], [0.2965], [0.8849]], [[0.9944], [0.9979], [0.5781]]]]],[0, 0, 0], 1, 1, 1, false, Con119), 
LRes34450 = reshape_layer(Con119, [2, 1, 9], Res34450), 
LPRe56095 = prelu_layer(Res34450, [[[0.5708, 0.2388, 0.5855, 0.8876, 0.3412, 0.9056, 0.0125, 0.5182, 0.1698]], [[0.9377, 0.0626, 0.9621, 0.4436, 0.0882, 0.7139, 0.6945, 0.9692, 0.1893]]], PRe56095), 
LRes49119 = reshape_layer(PRe56095, [2, 9], Res49119), 
LReL26507 = relu_layer([[[0.5095]]], 6.16006275829235, 8.982366607473805, 5.690552070524658, ReL26507), 
LZer63099 = zero_padding1D_layer(ReL26507, 1, 0, Zer63099), 
LCon90823 = concatenate_layer([Zer63099,[[[0.0777, 0.753, 0.1762, 0.4193, 0.0185, 0.4163, 0.3046, 0.0551], [0.0463, 0.1789, 0.2106, 0.1796, 0.3657, 0.0906, 0.2795, 0.1458]]]], 2, Con90823), 
LMin83608 = minimum_layer([Res49119,Con90823], Min83608), 
LRes51822 = reshape_layer(Min83608, [2, 9, 1], Res51822), 
LRes37159 = reshape_layer(Res51822, [2, 9, 1, 1], Res37159), 
LCon42063 = conv3D_transpose_layer(Res37159, 1, 4, 1,[[[[[0.0214], [0.4969]]], [[[0.3804], [0.4446]]], [[[0.0325], [0.2665]]], [[[0.08], [0.255]]]]],[0, 0], 1, 1, 1, false, Con42063), 
LRes7444 = reshape_layer(Con42063, [2, 12, 2], Res7444), 
LRes3722 = reshape_layer(Res7444, [2, 24], Res3722), 
LMax36139 = maximum_layer([[[[[0.4117, 0.2539]]]], [[[[0.8041, 0.5589]]]]], Max36139), 
LRes66724 = reshape_layer(Max36139, [1, 2], Res66724), 
LPer41627 = permute_layer(Res66724, 1,2, Per41627), 
LZer90568 = zero_padding1D_layer(Per41627, 1, 0, Zer90568), 
LCon65552 = concatenate_layer([Zer90568,[[[0.2151, 0.9463, 0.9188, 0.7229, 0.1235, 0.6182, 0.124, 0.3747, 0.4213, 0.0071, 0.0457, 0.2304, 0.8473, 0.9997, 0.3807, 0.652, 0.3021, 0.6509, 0.7602, 0.9564, 0.0652, 0.3115], [0.2677, 0.4257, 0.0525, 0.0489, 0.257, 0.0902, 0.145, 0.3028, 0.4228, 0.1176, 0.5656, 0.1665, 0.8459, 0.0463, 0.1258, 0.2922, 0.9164, 0.1594, 0.9223, 0.1799, 0.6149, 0.0122]]]], 2, Con65552), 
LMin15203 = minimum_layer([Res3722,Con65552], Min15203), 
exec_layers([LCon119,LRes34450,LPRe56095,LRes49119,LReL26507,LZer63099,LCon90823,LMin83608,LRes51822,LRes37159,LCon42063,LRes7444,LRes3722,LMax36139,LRes66724,LPer41627,LZer90568,LCon65552,LMin15203],["Con119","Res34450","PRe56095","Res49119","ReL26507","Zer63099","Con90823","Min83608","Res51822","Res37159","Con42063","Res7444","Res3722","Max36139","Res66724","Per41627","Zer90568","Con65552","Min15203"],Min15203,"Min15203")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0016628, 0.0386091, 0.0456713, 0.4087111, 0.1235000, 0.4430446, 0.1066880, 0.3747000, 0.2258641, 0.0071000, 0.0436695, 0.2304000, 0.1990242, 0.4482945, 0.1320587, 0.2784658, 0.0641635, 0.2118299, 0.0261588, 0.0923572, 0.0044080, 0.0140505], [-0.9959155, -23.1247863, -17.7021220, -20.6682132, -1.4922555, -12.3146189, -3.6659887, -11.7046589, 0.0805496, 0.2118565, 0.0835265, 0.1176000, 0.0715512, 0.1665000, 0.0376629, 0.0463000, 0.0317588, 0.0834778, 0.0165283, 0.0386715, 0.0049113, 0.0203447, 0.0023032, 0.0073413]]]

Expected (Unparsed): [[[0.0,0.0,0.00166278,0.038609130000000005,0.04567128,0.40871112,0.1235,0.44304463000000005,0.106688,0.3747,0.22586412,0.0071,0.043669469999999995,0.2304,0.19902421,0.44829447,0.13205872999999999,0.2784658,0.06416354,0.21182986,0.02615875,0.09235715,0.0044080000000000005,0.0140505],[-0.9959155349510834,-23.12478641669128,-17.702122098032156,-20.668213291685404,-1.4922555154145705,-12.31461896072268,-3.665988722645097,-11.704658925223248,0.08054962796399999,0.21185649085799999,0.083526497508,0.1176,0.07155116168999999,0.1665,0.037662853085999995,0.0463,0.0317588013,0.083477771034,0.016528270902,0.038671473378,0.00491128845,0.02034470187,0.0023031503999999996,0.007341291899999999]]]

Actual:   [[[0, 0, 0.0017, 0.0387, 0.0457, 0.4088, 0.1235, 0.4431, 0.1067, 0.3747, 0.2259, 0.0071, 0.0437, 0.2304, 0.1991, 0.4483, 0.1321, 0.2785, 0.0642, 0.2119, 0.0262, 0.0924, 0.0045, 0.0141], [-0.9959, -23.1247, -17.7021, -20.6682, -1.4922, -12.3146, -3.6659, -11.7046, 0.0806, 0.2119, 0.0836, 0.1176, 0.0716, 0.1665, 0.0377, 0.0463, 0.0318, 0.0835, 0.0166, 0.0387, 0.005, 0.0204, 0.0024, 0.0074]]]

Expected: [[[0, 0, 0.0017, 0.0387, 0.0457, 0.4088, 0.1235, 0.4431, 0.1067, 0.3747, 0.2259, 0.0071, 0.0437, 0.2304, 0.1991, 0.4483, 0.1321, 0.2785, 0.0642, 0.2119, 0.0262, 0.0924, 0.0045, 0.0141], [-0.9959, -23.1247, -17.7021, -20.6682, -1.4922, -12.3146, -3.6659, -11.7046, 0.0806, 0.2119, 0.0836, 0.1176, 0.0716, 0.1665, 0.0377, 0.0463, 0.0318, 0.0835, 0.0166, 0.0387, 0.005, 0.0204, 0.0024, 0.0074]]]