import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro37948 = tf.keras.layers.Input(shape=([4, 3]))

Cro37948 = keras.layers.Cropping1D(cropping=((3, 0)), name = 'Cro37948', )(in0Cro37948)
Res75083 = keras.layers.Reshape((1, 3, 1), name = 'Res75083', )(Cro37948)
Glo18551 = keras.layers.GlobalMaxPool2D(name = 'Glo18551', )(Res75083)
Res67271 = keras.layers.Reshape((1, 1), name = 'Res67271', )(Glo18551)
Res59087 = keras.layers.Reshape((1, 1, 1), name = 'Res59087', )(Res67271)
Ave97249 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(6, 6), padding='valid', name = 'Ave97249', )(Res59087)
Res59217 = keras.layers.Reshape((1, 1), name = 'Res59217', )(Ave97249)
GRU68608 = keras.layers.GRU(3,reset_after=True, recurrent_activation='sigmoid', name = 'GRU68608', )(Res59217)
model = tf.keras.models.Model(inputs=[in0Cro37948], outputs=GRU68608)
w = model.get_layer('GRU68608').get_weights() 
w[0] = np.array([[8, 9, 8, 10, 7, 6, 4, 10, 2]])
w[1] = np.array([[9, 9, 2, 6, 5, 6, 6, 4, 1], [4, 3, 1, 4, 3, 1, 2, 1, 6], [2, 10, 2, 9, 4, 6, 4, 7, 10]])
w[2] = np.array([[9, 5, 1, 10, 6, 3, 3, 4, 1], [6, 5, 8, 2, 3, 7, 4, 8, 8]])
model.get_layer('GRU68608').set_weights(w) 
in0Cro37948 = tf.constant([[[1.6512, 1.3092, 1.5311], [1.7233, 1.076, 1.4827], [1.6018, 1.6586, 1.532], [1.0767, 1.9552, 1.0061]]])
print (np.array2string(model.predict([in0Cro37948],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU68608.png')

LCro37948 = cropping1D_layer([[[1.6512, 1.3092, 1.5311], [1.7233, 1.076, 1.4827], [1.6018, 1.6586, 1.532], [1.0767, 1.9552, 1.0061]]], 3, 0, Cro37948), 
LRes75083 = reshape_layer(Cro37948, [1, 3, 1], Res75083), 
LGlo18551 = global_max_pool2D_layer(Res75083, Glo18551), 
LRes67271 = reshape_layer(Glo18551, [1, 1], Res67271), 
LRes59087 = reshape_layer(Res67271, [1, 1, 1], Res59087), 
LAve97249 = average_pooling2D_layer(Res59087, 1, 1, 6, 6, false, Ave97249), 
LRes59217 = reshape_layer(Ave97249, [1, 1], Res59217), 
LGRU68608 = gru_layer(Res59217,[[8, 9, 8, 10, 7, 6, 4, 10, 2]],[[9, 9, 2, 6, 5, 6, 6, 4, 1], [4, 3, 1, 4, 3, 1, 2, 1, 6], [2, 10, 2, 9, 4, 6, 4, 7, 10]],[[9, 5, 1, 10, 6, 3, 3, 4, 1], [6, 5, 8, 2, 3, 7, 4, 8, 8]], true, GRU68608), 
exec_layers([LCro37948,LRes75083,LGlo18551,LRes67271,LRes59087,LAve97249,LRes59217,LGRU68608],["Cro37948","Res75083","Glo18551","Res67271","Res59087","Ave97249","Res59217","GRU68608"],GRU68608,"GRU68608")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[4.929390229334375e-14,1.0347278589506459e-12,1.9874102363571995e-11]]

Actual:   [[0, 0, 0]]

Expected: [[0, 0, 0]]