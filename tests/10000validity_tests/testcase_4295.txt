import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub59704 = tf.keras.layers.Input(shape=([3, 2, 2]))
in1Sub59704 = tf.keras.layers.Input(shape=([3, 2, 2]))
in0Con8607 = tf.keras.layers.Input(shape=([2, 3]))
in0Mas55369 = tf.keras.layers.Input(shape=([2, 4]))

Sub59704 = keras.layers.Subtract(name = 'Sub59704', )([in0Sub59704,in1Sub59704])
Ave8115 = keras.layers.AveragePooling2D(pool_size=(1, 2), strides=(1, 1), padding='valid', name = 'Ave8115', )(Sub59704)
Res57849 = keras.layers.Reshape((3, 2), name = 'Res57849', )(Ave8115)
Glo25308 = keras.layers.GlobalMaxPool1D(name = 'Glo25308', )(Res57849)
Res91722 = keras.layers.Reshape((2, 1), name = 'Res91722', )(Glo25308)
Con8607 = keras.layers.Concatenate(axis=2, name = 'Con8607', )([Res91722,in0Con8607])
Mas55369 = keras.layers.Masking(mask_value=2, name = 'Mas55369', )(in0Mas55369)
Add35674 = keras.layers.Add(name = 'Add35674', )([Con8607,Mas55369])
model = tf.keras.models.Model(inputs=[in0Sub59704,in1Sub59704,in0Con8607,in0Mas55369], outputs=Add35674)
in0Sub59704 = tf.constant([[[[0.8443, 0.0352], [0.8188, 0.6895]], [[0.2915, 0.1249], [0.7365, 0.8322]], [[0.7268, 0.3799], [0.3615, 0.9326]]]])
in1Sub59704 = tf.constant([[[[0.7707, 0.7603], [0.3122, 0.8186]], [[0.5393, 0.2769], [0.9269, 0.7758]], [[0.0052, 0.6341], [0.0524, 0.9919]]]])
in0Con8607 = tf.constant([[[0.3721, 0.7695, 0.6724], [0.5022, 0.2072, 0.5377]]])
in0Mas55369 = tf.constant([[[1.9217, 1.4271, 1.3, 1.2464], [1.5777, 1.9142, 1.2034, 1.8028]]])
print (np.array2string(model.predict([in0Sub59704,in1Sub59704,in0Con8607,in0Mas55369],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add35674.png')

LSub59704 = subtract_layer([[[[0.8443, 0.0352], [0.8188, 0.6895]], [[0.2915, 0.1249], [0.7365, 0.8322]], [[0.7268, 0.3799], [0.3615, 0.9326]]]], [[[[0.7707, 0.7603], [0.3122, 0.8186]], [[0.5393, 0.2769], [0.9269, 0.7758]], [[0.0052, 0.6341], [0.0524, 0.9919]]]], Sub59704), 
LAve8115 = average_pooling2D_layer(Sub59704, 1, 2, 1, 1, false, Ave8115), 
LRes57849 = reshape_layer(Ave8115, [3, 2], Res57849), 
LGlo25308 = global_max_pool1D_layer(Res57849, Glo25308), 
LRes91722 = reshape_layer(Glo25308, [2, 1], Res91722), 
LCon8607 = concatenate_layer([Res91722,[[[0.3721, 0.7695, 0.6724], [0.5022, 0.2072, 0.5377]]]], 2, Con8607), 
LMas55369 = masking_layer([[[1.9217, 1.4271, 1.3, 1.2464], [1.5777, 1.9142, 1.2034, 1.8028]]], 2, Mas55369), 
LAdd35674 = add_layer([Con8607,Mas55369], Add35674), 
exec_layers([LSub59704,LAve8115,LRes57849,LGlo25308,LRes91722,LCon8607,LMas55369,LAdd35674],["Sub59704","Ave8115","Res57849","Glo25308","Res91722","Con8607","Mas55369","Add35674"],Add35674,"Add35674")

Actual (Unparsed): [[[2.4370500, 1.7991999, 2.0695000, 1.9188000], [1.5299000, 2.4164000, 1.4106000, 2.3405001]]]

Expected (Unparsed): [[[2.43705,1.7992,2.0695,1.9188],[1.5299,2.4164,1.4106,2.3405]]]

Actual:   [[[2.4371, 1.7992, 2.0695, 1.9188], [1.5299, 2.4164, 1.4106, 2.3406]]]

Expected: [[[2.4371, 1.7992, 2.0695, 1.9188], [1.5299, 2.4164, 1.4106, 2.3405]]]