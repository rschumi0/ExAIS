import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add68988 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Add68988 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Mas23061 = tf.keras.layers.Input(shape=([2]))
in0Con66450 = tf.keras.layers.Input(shape=([1]))
in0Sub62437 = tf.keras.layers.Input(shape=([3]))
in1Sub62437 = tf.keras.layers.Input(shape=([3]))

Add68988 = keras.layers.Add(name = 'Add68988', )([in0Add68988,in1Add68988])
Con88978 = keras.layers.Conv3D(3, (1, 1, 1),strides=(4, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con88978', )(Add68988)
Res33229 = keras.layers.Reshape((1, 1, 3), name = 'Res33229', )(Con88978)
Res73335 = keras.layers.Reshape((1, 3), name = 'Res73335', )(Res33229)
Fla77149 = keras.layers.Flatten(name = 'Fla77149', )(Res73335)
Mas23061 = keras.layers.Masking(mask_value=2, name = 'Mas23061', )(in0Mas23061)
Con66450 = keras.layers.Concatenate(axis=1, name = 'Con66450', )([Mas23061,in0Con66450])
Max94675 = keras.layers.Maximum(name = 'Max94675', )([Fla77149,Con66450])
Res15668 = keras.layers.Reshape((3, 1), name = 'Res15668', )(Max94675)
Sub62437 = keras.layers.Subtract(name = 'Sub62437', )([in0Sub62437,in1Sub62437])
Res68158 = keras.layers.Reshape((3, 1), name = 'Res68158', )(Sub62437)
Res65147 = keras.layers.Reshape((3, 1, 1), name = 'Res65147', )(Res68158)
Ave34252 = keras.layers.AveragePooling2D(pool_size=(3, 1), name = 'Ave34252', )(Res65147)
Res43389 = keras.layers.Reshape((1, 1), name = 'Res43389', )(Ave34252)
Dot44309 = keras.layers.Dot(axes=(2, 2), name = 'Dot44309', )([Res15668,Res43389])
ELU72704 = keras.layers.ELU(alpha=-5.532067689146256, name = 'ELU72704', )(Dot44309)
model = tf.keras.models.Model(inputs=[in0Add68988,in1Add68988,in0Mas23061,in0Con66450,in0Sub62437,in1Sub62437], outputs=ELU72704)
w = model.get_layer('Con88978').get_weights() 
w[0] = np.array([[[[[0.6903, 0.7781, 0.5378], [0.1194, 0.8584, 0.8605]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con88978').set_weights(w) 
in0Add68988 = tf.constant([[[[[0.9957, 0.4037]]]]])
in1Add68988 = tf.constant([[[[[0.9486, 0.2555]]]]])
in0Mas23061 = tf.constant([[1.8659, 1.1277]])
in0Con66450 = tf.constant([[0.7723]])
in0Sub62437 = tf.constant([[0.3105, 0.3612, 0.02]])
in1Sub62437 = tf.constant([[0.924, 0.7886, 0.6634]])
print (np.array2string(model.predict([in0Add68988,in1Add68988,in0Mas23061,in0Con66450,in0Sub62437,in1Sub62437],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='ELU72704.png')

LAdd68988 = add_layer([[[[[[0.9957, 0.4037]]]]], [[[[[0.9486, 0.2555]]]]]], Add68988), 
LCon88978 = conv3D_layer(Add68988, 1, 1, 1,[[[[[0.6903, 0.7781, 0.5378], [0.1194, 0.8584, 0.8605]]]]],[0, 0, 0], 4, 1, 1, true, 1, 1, 1, Con88978), 
LRes33229 = reshape_layer(Con88978, [1, 1, 3], Res33229), 
LRes73335 = reshape_layer(Res33229, [1, 3], Res73335), 
LFla77149 = flatten_layer(Res73335, Fla77149), 
LMas23061 = masking_layer([[1.8659, 1.1277]], 2, Mas23061), 
LCon66450 = concatenate_layer([Mas23061,[[0.7723]]], 1, Con66450), 
LMax94675 = maximum_layer([Fla77149,Con66450], Max94675), 
LRes15668 = reshape_layer(Max94675, [3, 1], Res15668), 
LSub62437 = subtract_layer([[0.3105, 0.3612, 0.02]], [[0.924, 0.7886, 0.6634]], Sub62437), 
LRes68158 = reshape_layer(Sub62437, [3, 1], Res68158), 
LRes65147 = reshape_layer(Res68158, [3, 1, 1], Res65147), 
LAve34252 = average_pooling2D_layer(Res65147, 3, 1, Ave34252), 
LRes43389 = reshape_layer(Ave34252, [1, 1], Res43389), 
LDot44309 = dot_layer(Res15668,Res43389, 2, 2, Dot44309), 
LELU72704 = elu_layer(Dot44309, -5.532067689146256, ELU72704), 
exec_layers([LAdd68988,LCon88978,LRes33229,LRes73335,LFla77149,LMas23061,LCon66450,LMax94675,LRes15668,LSub62437,LRes68158,LRes65147,LAve34252,LRes43389,LDot44309,LELU72704],["Add68988","Con88978","Res33229","Res73335","Fla77149","Mas23061","Con66450","Max94675","Res15668","Sub62437","Res68158","Res65147","Ave34252","Res43389","Dot44309","ELU72704"],ELU72704,"ELU72704")

Actual (Unparsed): [[[3.5914950], [3.8100433], [3.2952961]]]

Expected (Unparsed): [[[3.5914948779677167],[3.8100432924963576],[3.295296018643639]]]

Actual:   [[[3.5915], [3.8101], [3.2953]]]

Expected: [[[3.5915], [3.8101], [3.2953]]]