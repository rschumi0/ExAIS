import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0ReL72905 = tf.keras.layers.Input(shape=([1, 1, 1, 1]))
in0Ave62526 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave62526 = tf.keras.layers.Input(shape=([1, 1]))

ReL72905 = keras.layers.ReLU(max_value=6.192774763272489, negative_slope=4.025657610001096, threshold=8.771518660791433, name = 'ReL72905', input_shape=(1, 1, 1, 1))(in0ReL72905)
Res47466 = keras.layers.Reshape((1, 1, 1), name = 'Res47466', )(ReL72905)
Res79237 = keras.layers.Reshape((1, 1), name = 'Res79237', )(Res47466)
Ave62526 = keras.layers.Average(name = 'Ave62526', )([in0Ave62526,in1Ave62526])
Sim11544 = keras.layers.SimpleRNN(1,name = 'Sim11544', )(Ave62526)
Res63843 = keras.layers.Reshape((1, 1), name = 'Res63843', )(Sim11544)
Cro94416 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro94416', )(Res63843)
Per89547 = keras.layers.Permute((2,1), name = 'Per89547',)(Cro94416)
Add40633 = keras.layers.Add(name = 'Add40633', )([Res79237,Per89547])
Cro77481 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro77481', )(Add40633)
model = tf.keras.models.Model(inputs=[in0ReL72905,in0Ave62526,in1Ave62526], outputs=Cro77481)
w = model.get_layer('Sim11544').get_weights() 
w[0] = np.array([[9]])
w[1] = np.array([[8]])
w[2] = np.array([4])
model.get_layer('Sim11544').set_weights(w) 
in0ReL72905 = tf.constant([[[[[0.1534]]]]])
in0Ave62526 = tf.constant([[[0.6775]]])
in1Ave62526 = tf.constant([[[0.2037]]])
print (np.array2string(model.predict([in0ReL72905,in0Ave62526,in1Ave62526],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro77481.png')

LReL72905 = relu_layer([[[[[0.1534]]]]], 6.192774763272489, 4.025657610001096, 8.771518660791433, ReL72905), 
LRes47466 = reshape_layer(ReL72905, [1, 1, 1], Res47466), 
LRes79237 = reshape_layer(Res47466, [1, 1], Res79237), 
LAve62526 = average_layer([[[[0.6775]]], [[[0.2037]]]], Ave62526), 
LSim11544 = simple_rnn_layer(Ave62526,[[9]],[[8]],[4], Sim11544), 
LRes63843 = reshape_layer(Sim11544, [1, 1], Res63843), 
LCro94416 = cropping1D_layer(Res63843, 0, 0, Cro94416), 
LPer89547 = permute_layer(Cro94416, 2,1, Per89547), 
LAdd40633 = add_layer([Res79237,Per89547], Add40633), 
LCro77481 = cropping1D_layer(Add40633, 0, 0, Cro77481), 
exec_layers([LReL72905,LRes47466,LRes79237,LAve62526,LSim11544,LRes63843,LCro94416,LPer89547,LAdd40633,LCro77481],["ReL72905","Res47466","Res79237","Ave62526","Sim11544","Res63843","Cro94416","Per89547","Add40633","Cro77481"],Cro77481,"Cro77481")

Actual (Unparsed): [[[-33.6935952]]]

Expected (Unparsed): [[[-33.69359521190422]]]

Actual:   [[[-33.6935]]]

Expected: [[[-33.6935]]]