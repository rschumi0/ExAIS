import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den28617 = tf.keras.layers.Input(shape=([2, 5, 4]))

Den28617 = keras.layers.Dense(4,name = 'Den28617', )(in0Den28617)
Res71604 = keras.layers.Reshape((2, 5, 4, 1), name = 'Res71604', )(Den28617)
Cro18956 = keras.layers.Cropping3D(cropping=((0, 1), (1, 3), (2, 1)), name = 'Cro18956', )(Res71604)
Res66324 = keras.layers.Reshape((1, 1, 1), name = 'Res66324', )(Cro18956)
Max80837 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max80837', )(Res66324)
Zer47137 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer47137', )(Max80837)
Fla40696 = keras.layers.Flatten(name = 'Fla40696', )(Zer47137)
model = tf.keras.models.Model(inputs=[in0Den28617], outputs=Fla40696)
w = model.get_layer('Den28617').get_weights() 
w[0] = np.array([[0.0036, 0.4797, 0.3672, 0.5388], [0.1273, 0.8449, 0.022, 0.8408], [0.8336, 0.7912, 0.5624, 0.1879], [0.3422, 0.7205, 0.8352, 0.2307]])
w[1] = np.array([0.7114, 0.4631, 0.302, 0.7196])
model.get_layer('Den28617').set_weights(w) 
in0Den28617 = tf.constant([[[[0.6594, 0.9416, 0.9556, 0.9771], [0.66, 0.314, 0.3522, 0.305], [0.1947, 0.2036, 0.1968, 0.2904], [0.4631, 0.2858, 0.1752, 0.9112], [0.0947, 0.9449, 0.5993, 0.3103]], [[0.6403, 0.7151, 0.5664, 0.4434], [0.8655, 0.8102, 0.4712, 0.9949], [0.1428, 0.8622, 0.3882, 0.5679], [0.6608, 0.3, 0.8493, 0.1677], [0.0048, 0.7621, 0.4508, 0.1635]]]])
print (np.array2string(model.predict([in0Den28617],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Fla40696.png')

LDen28617 = dense_layer([[[[0.6594, 0.9416, 0.9556, 0.9771], [0.66, 0.314, 0.3522, 0.305], [0.1947, 0.2036, 0.1968, 0.2904], [0.4631, 0.2858, 0.1752, 0.9112], [0.0947, 0.9449, 0.5993, 0.3103]], [[0.6403, 0.7151, 0.5664, 0.4434], [0.8655, 0.8102, 0.4712, 0.9949], [0.1428, 0.8622, 0.3882, 0.5679], [0.6608, 0.3, 0.8493, 0.1677], [0.0048, 0.7621, 0.4508, 0.1635]]]], [[0.0036, 0.4797, 0.3672, 0.5388], [0.1273, 0.8449, 0.022, 0.8408], [0.8336, 0.7912, 0.5624, 0.1879], [0.3422, 0.7205, 0.8352, 0.2307]],[0.7114, 0.4631, 0.302, 0.7196], Den28617), 
LRes71604 = reshape_layer(Den28617, [2, 5, 4, 1], Res71604), 
LCro18956 = cropping3D_layer(Res71604, 0, 1, 1, 3, 2, 1, Cro18956), 
LRes66324 = reshape_layer(Cro18956, [1, 1, 1], Res66324), 
LMax80837 = max_pool2D_layer(Res66324, 1, 1, Max80837), 
LZer47137 = zero_padding2D_layer(Max80837, 1, 1, 1, 1, Zer47137), 
LFla40696 = flatten_layer(Zer47137, Fla40696), 
exec_layers([LDen28617,LRes71604,LCro18956,LRes66324,LMax80837,LZer47137,LFla40696],["Den28617","Res71604","Cro18956","Res66324","Max80837","Zer47137","Fla40696"],Fla40696,"Fla40696")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 1.0040733, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0,0,0,0,1.00407328,0,0,0,0]]

Actual:   [[0, 0, 0, 0, 1.0041, 0, 0, 0, 0]]

Expected: [[0, 0, 0, 0, 1.0041, 0, 0, 0, 0]]