import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot90979 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot90979 = tf.keras.layers.Input(shape=([3, 3]))
in0Con44114 = tf.keras.layers.Input(shape=([3, 1]))
in0Min22491 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))
in1Min22491 = tf.keras.layers.Input(shape=([2, 1, 1, 1]))

Dot90979 = keras.layers.Dot(axes=(1, 1), name = 'Dot90979', )([in0Dot90979,in1Dot90979])
Con44114 = keras.layers.Concatenate(axis=2, name = 'Con44114', )([Dot90979,in0Con44114])
Min22491 = keras.layers.Minimum(name = 'Min22491', )([in0Min22491,in1Min22491])
Res17727 = keras.layers.Reshape((2, 1, 1), name = 'Res17727', )(Min22491)
Res98678 = keras.layers.Reshape((2, 1), name = 'Res98678', )(Res17727)
Loc27470 = keras.layers.LocallyConnected1D(4, (1),strides=(1), name = 'Loc27470', )(Res98678)
Zer95126 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer95126', )(Loc27470)
Max29989 = keras.layers.Maximum(name = 'Max29989', )([Con44114,Zer95126])
Thr69249 = keras.layers.ThresholdedReLU(theta=4.038438802926879, name = 'Thr69249', )(Max29989)
model = tf.keras.models.Model(inputs=[in0Dot90979,in1Dot90979,in0Con44114,in0Min22491,in1Min22491], outputs=Thr69249)
w = model.get_layer('Loc27470').get_weights() 
w[0] = np.array([[[0.4171, 0.0487, 0.125, 0.5101]], [[0.1996, 0.5433, 0.3419, 0.1316]]])
w[1] = np.array([[0, 0, 0, 0], [0, 0, 0, 0]])
model.get_layer('Loc27470').set_weights(w) 
in0Dot90979 = tf.constant([[[0.2519, 0.2832, 0.092], [0.1161, 0.9516, 0.8405], [0.6273, 0.1188, 0.8139]]])
in1Dot90979 = tf.constant([[[0.6419, 0.4386, 0.8963], [0.5294, 0.8921, 0.9782], [0.8971, 0.9474, 0.5724]]])
in0Con44114 = tf.constant([[[0.0877], [0.3135], [0.0517]]])
in0Min22491 = tf.constant([[[[[0.1443]]], [[[0.5698]]]]])
in1Min22491 = tf.constant([[[[[0.6322]]], [[[0.273]]]]])
print (np.array2string(model.predict([in0Dot90979,in1Dot90979,in0Con44114,in0Min22491,in1Min22491],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr69249.png')

LDot90979 = dot_layer([[[0.2519, 0.2832, 0.092], [0.1161, 0.9516, 0.8405], [0.6273, 0.1188, 0.8139]]], [[[0.6419, 0.4386, 0.8963], [0.5294, 0.8921, 0.9782], [0.8971, 0.9474, 0.5724]]], 1, 1, Dot90979), 
LCon44114 = concatenate_layer([Dot90979,[[[0.0877], [0.3135], [0.0517]]]], 2, Con44114), 
LMin22491 = minimum_layer([[[[[[0.1443]]], [[[0.5698]]]]], [[[[[0.6322]]], [[[0.273]]]]]], Min22491), 
LRes17727 = reshape_layer(Min22491, [2, 1, 1], Res17727), 
LRes98678 = reshape_layer(Res17727, [2, 1], Res98678), 
LLoc27470 = locally_connected1D_layer(Res98678, 1,[[[0.4171, 0.0487, 0.125, 0.5101]], [[0.1996, 0.5433, 0.3419, 0.1316]]],[[0, 0, 0, 0], [0, 0, 0, 0]], 1, Loc27470), 
LZer95126 = zero_padding1D_layer(Loc27470, 1, 0, Zer95126), 
LMax29989 = maximum_layer([Con44114,Zer95126], Max29989), 
LThr69249 = thresholded_relu_layer(Max29989, 4.038438802926879, Thr69249), 
exec_layers([LDot90979,LCon44114,LMin22491,LRes17727,LRes98678,LLoc27470,LZer95126,LMax29989,LThr69249],["Dot90979","Con44114","Min22491","Res17727","Res98678","Loc27470","Zer95126","Max29989","Thr69249"],Thr69249,"Thr69249")

Actual (Unparsed): [[[0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[0,0,0,0],[0,0,0,0],[0,0,0,0]]]

Actual:   [[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]

Expected: [[[0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]