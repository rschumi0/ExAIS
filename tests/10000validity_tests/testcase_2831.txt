import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub83260 = tf.keras.layers.Input(shape=([3, 2, 2, 2]))
in1Sub83260 = tf.keras.layers.Input(shape=([3, 2, 2, 2]))
in0Mul3771 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Mul3771 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))

Sub83260 = keras.layers.Subtract(name = 'Sub83260', )([in0Sub83260,in1Sub83260])
Res21027 = keras.layers.Reshape((3, 2, 4), name = 'Res21027', )(Sub83260)
Up_70272 = keras.layers.UpSampling2D(size=(1, 2), name = 'Up_70272', )(Res21027)
Res89518 = keras.layers.Reshape((3, 4, 4, 1), name = 'Res89518', )(Up_70272)
Mul3771 = keras.layers.Multiply(name = 'Mul3771', )([in0Mul3771,in1Mul3771])
Zer71867 = keras.layers.ZeroPadding3D(padding=((2, 0), (2, 0), (3, 0)), name = 'Zer71867', )(Mul3771)
Max41296 = keras.layers.Maximum(name = 'Max41296', )([Res89518,Zer71867])
model = tf.keras.models.Model(inputs=[in0Sub83260,in1Sub83260,in0Mul3771,in1Mul3771], outputs=Max41296)
in0Sub83260 = tf.constant([[[[[0.1322, 0.8104], [0.8116, 0.6632]], [[0.8319, 0.9328], [0.9386, 0.4173]]], [[[0.3515, 0.0076], [0.2537, 0.193]], [[0.8717, 0.1025], [0.2999, 0.4061]]], [[[0.5171, 0.4764], [0.4791, 0.1317]], [[0.1351, 0.8219], [0.9764, 0.6082]]]]])
in1Sub83260 = tf.constant([[[[[0.7083, 0.7969], [0.6308, 0.7164]], [[0.7846, 0.2302], [0.1873, 0.0395]]], [[[0.0397, 0.2792], [0.482, 0.0228]], [[0.8456, 0.9883], [0.7612, 0.4351]]], [[[0.5058, 0.1544], [0.516, 0.8072]], [[0.6422, 0.1356], [0.9277, 0.7725]]]]])
in0Mul3771 = tf.constant([[[[[0.0708]], [[0.2626]]]]])
in1Mul3771 = tf.constant([[[[[0.2585]], [[0.2665]]]]])
print (np.array2string(model.predict([in0Sub83260,in1Sub83260,in0Mul3771,in1Mul3771],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max41296.png')

LSub83260 = subtract_layer([[[[[0.1322, 0.8104], [0.8116, 0.6632]], [[0.8319, 0.9328], [0.9386, 0.4173]]], [[[0.3515, 0.0076], [0.2537, 0.193]], [[0.8717, 0.1025], [0.2999, 0.4061]]], [[[0.5171, 0.4764], [0.4791, 0.1317]], [[0.1351, 0.8219], [0.9764, 0.6082]]]]], [[[[[0.7083, 0.7969], [0.6308, 0.7164]], [[0.7846, 0.2302], [0.1873, 0.0395]]], [[[0.0397, 0.2792], [0.482, 0.0228]], [[0.8456, 0.9883], [0.7612, 0.4351]]], [[[0.5058, 0.1544], [0.516, 0.8072]], [[0.6422, 0.1356], [0.9277, 0.7725]]]]], Sub83260), 
LRes21027 = reshape_layer(Sub83260, [3, 2, 4], Res21027), 
LUp_70272 = up_sampling2D_layer(Res21027, 1, 2, Up_70272), 
LRes89518 = reshape_layer(Up_70272, [3, 4, 4, 1], Res89518), 
LMul3771 = multiply_layer([[[[[[0.0708]], [[0.2626]]]]], [[[[[0.2585]], [[0.2665]]]]]], Mul3771), 
LZer71867 = zero_padding3D_layer(Mul3771, 2, 0, 2, 0, 3, 0, Zer71867), 
LMax41296 = maximum_layer([Res89518,Zer71867], Max41296), 
exec_layers([LSub83260,LRes21027,LUp_70272,LRes89518,LMul3771,LZer71867,LMax41296],["Sub83260","Res21027","Up_70272","Res89518","Mul3771","Zer71867","Max41296"],Max41296,"Max41296")

Actual (Unparsed): [[[[[0.0000000], [0.0135000], [0.1808000], [0.0000000]], [[0.0000000], [0.0135000], [0.1808000], [0.0000000]], [[0.0473000], [0.7026000], [0.7513000], [0.3778000]], [[0.0473000], [0.7026000], [0.7513000], [0.3778000]]], [[[0.3118000], [0.0000000], [0.0000000], [0.1702000]], [[0.3118000], [0.0000000], [0.0000000], [0.1702000]], [[0.0261000], [0.0000000], [0.0000000], [0.0000000]], [[0.0261000], [0.0000000], [0.0000000], [0.0000000]]], [[[0.0113000], [0.3220000], [0.0000000], [0.0000000]], [[0.0113000], [0.3220000], [0.0000000], [0.0000000]], [[0.0000000], [0.6863000], [0.0487000], [0.0183018]], [[0.0000000], [0.6863000], [0.0487000], [0.0699829]]]]]

Expected (Unparsed): [[[[[0],[0.013499999999999956],[0.18079999999999996],[0]],[[0],[0.013499999999999956],[0.18079999999999996],[0]],[[0.04730000000000001],[0.7026],[0.7513],[0.3778]],[[0.04730000000000001],[0.7026],[0.7513],[0.3778]]],[[[0.31179999999999997],[0],[0],[0.17020000000000002]],[[0.31179999999999997],[0],[0],[0.17020000000000002]],[[0.026100000000000012],[0],[0],[0]],[[0.026100000000000012],[0],[0],[0]]],[[[0.011299999999999977],[0.32199999999999995],[0],[0]],[[0.011299999999999977],[0.32199999999999995],[0],[0]],[[0],[0.6862999999999999],[0.04870000000000008],[0.0183018]],[[0],[0.6862999999999999],[0.04870000000000008],[0.0699829]]]]]

Actual:   [[[[[0], [0.0135], [0.1808], [0]], [[0], [0.0135], [0.1808], [0]], [[0.0473], [0.7026], [0.7513], [0.3778]], [[0.0473], [0.7026], [0.7513], [0.3778]]], [[[0.3118], [0], [0], [0.1702]], [[0.3118], [0], [0], [0.1702]], [[0.0261], [0], [0], [0]], [[0.0261], [0], [0], [0]]], [[[0.0113], [0.322], [0], [0]], [[0.0113], [0.322], [0], [0]], [[0], [0.6863], [0.0487], [0.0184]], [[0], [0.6863], [0.0487], [0.07]]]]]

Expected: [[[[[0], [0.0135], [0.1808], [0]], [[0], [0.0135], [0.1808], [0]], [[0.0474], [0.7026], [0.7513], [0.3778]], [[0.0474], [0.7026], [0.7513], [0.3778]]], [[[0.3118], [0], [0], [0.1703]], [[0.3118], [0], [0], [0.1703]], [[0.0262], [0], [0], [0]], [[0.0262], [0], [0], [0]]], [[[0.0113], [0.322], [0], [0]], [[0.0113], [0.322], [0], [0]], [[0], [0.6863], [0.0488], [0.0184]], [[0], [0.6863], [0.0488], [0.07]]]]]