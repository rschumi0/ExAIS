import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max26786 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Max26786 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min41733 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Min41733 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Max26786 = keras.layers.Maximum(name = 'Max26786', )([in0Max26786,in1Max26786])
Res91766 = keras.layers.Reshape((2, 2, 2, 1), name = 'Res91766', )(Max26786)
Min41733 = keras.layers.Minimum(name = 'Min41733', )([in0Min41733,in1Min41733])
Sub54484 = keras.layers.Subtract(name = 'Sub54484', )([Res91766,Min41733])
model = tf.keras.models.Model(inputs=[in0Max26786,in1Max26786,in0Min41733,in1Min41733], outputs=Sub54484)
in0Max26786 = tf.constant([[[[0.225, 0.2976], [0.7246, 0.7747]], [[0.9839, 0.5581], [0.6285, 0.1138]]]])
in1Max26786 = tf.constant([[[[0.0793, 0.8491], [0.604, 0.0386]], [[0.6145, 0.5372], [0.4858, 0.4422]]]])
in0Min41733 = tf.constant([[[[[0.676], [0.9728]], [[0.8387], [0.3037]]], [[[0.6736], [0.8657]], [[0.9252], [0.4687]]]]])
in1Min41733 = tf.constant([[[[[0.5981], [0.3716]], [[0.7333], [0.2925]]], [[[0.0321], [0.071]], [[0.9884], [0.854]]]]])
print (np.array2string(model.predict([in0Max26786,in1Max26786,in0Min41733,in1Min41733],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub54484.png')

LMax26786 = maximum_layer([[[[[0.225, 0.2976], [0.7246, 0.7747]], [[0.9839, 0.5581], [0.6285, 0.1138]]]], [[[[0.0793, 0.8491], [0.604, 0.0386]], [[0.6145, 0.5372], [0.4858, 0.4422]]]]], Max26786), 
LRes91766 = reshape_layer(Max26786, [2, 2, 2, 1], Res91766), 
LMin41733 = minimum_layer([[[[[[0.676], [0.9728]], [[0.8387], [0.3037]]], [[[0.6736], [0.8657]], [[0.9252], [0.4687]]]]], [[[[[0.5981], [0.3716]], [[0.7333], [0.2925]]], [[[0.0321], [0.071]], [[0.9884], [0.854]]]]]], Min41733), 
LSub54484 = subtract_layer(Res91766,Min41733, Sub54484), 
exec_layers([LMax26786,LRes91766,LMin41733,LSub54484],["Max26786","Res91766","Min41733","Sub54484"],Sub54484,"Sub54484")

Actual (Unparsed): [[[[[-0.3731000], [0.4775000]], [[-0.0087000], [0.4822000]]], [[[0.9518000], [0.4871000]], [[-0.2967000], [-0.0265000]]]]]

Expected (Unparsed): [[[[[-0.3731],[0.4775]],[[-0.00869999999999993],[0.4822000000000001]]],[[[0.9518],[0.48710000000000003]],[[-0.2967000000000001],[-0.026500000000000024]]]]]

Actual:   [[[[[-0.3731], [0.4775]], [[-0.0087], [0.4822]]], [[[0.9518], [0.4871]], [[-0.2967], [-0.0265]]]]]

Expected: [[[[[-0.3731], [0.4775]], [[-0.0086], [0.4823]]], [[[0.9518], [0.4872]], [[-0.2967], [-0.0265]]]]]