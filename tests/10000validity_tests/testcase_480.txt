import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul28965 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Mul28965 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Ave8332 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Ave8332 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sep62210 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Min19230 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Min19230 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con49371 = tf.keras.layers.Input(shape=([7]))

Mul28965 = keras.layers.Multiply(name = 'Mul28965', )([in0Mul28965,in1Mul28965])
ELU14900 = keras.layers.ELU(alpha=-8.626902305712544, name = 'ELU14900', )(Mul28965)
Res15796 = keras.layers.Reshape((2, 2, 2), name = 'Res15796', )(ELU14900)
Ave8332 = keras.layers.Average(name = 'Ave8332', )([in0Ave8332,in1Ave8332])
Res65048 = keras.layers.Reshape((2, 4), name = 'Res65048', )(Ave8332)
Fla39716 = keras.layers.Flatten(name = 'Fla39716', )(Res65048)
Sep62210 = keras.layers.SeparableConv2D(2, (2, 1),strides=(1, 1), padding='valid', name = 'Sep62210', )(in0Sep62210)
Res299 = keras.layers.Reshape((1, 4), name = 'Res299', )(Sep62210)
Min19230 = keras.layers.Minimum(name = 'Min19230', )([in0Min19230,in1Min19230])
Res15841 = keras.layers.Reshape((2, 2, 2), name = 'Res15841', )(Min19230)
Res98281 = keras.layers.Reshape((2, 4), name = 'Res98281', )(Res15841)
Zer37670 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer37670', )(Res98281)
Dot80463 = keras.layers.Dot(axes=(2, 2), name = 'Dot80463', )([Res299,Zer37670])
Res45568 = keras.layers.Reshape((1, 3, 1), name = 'Res45568', )(Dot80463)
Res4015 = keras.layers.Reshape((1, 3, 1, 1), name = 'Res4015', )(Res45568)
Glo40250 = keras.layers.GlobalMaxPool3D(name = 'Glo40250', )(Res4015)
Con49371 = keras.layers.Concatenate(axis=1, name = 'Con49371', )([Glo40250,in0Con49371])
Mul46022 = keras.layers.Multiply(name = 'Mul46022', )([Fla39716,Con49371])
Res58637 = keras.layers.Reshape((2, 2, 2), name = 'Res58637', )(Mul46022)
Sub75357 = keras.layers.Subtract(name = 'Sub75357', )([Res15796,Res58637])
model = tf.keras.models.Model(inputs=[in0Mul28965,in1Mul28965,in0Ave8332,in1Ave8332,in0Sep62210,in0Min19230,in1Min19230,in0Con49371], outputs=Sub75357)
w = model.get_layer('Sep62210').get_weights() 
w[0] = np.array([[[[0.3453], [0.1919]]], [[[0.3678], [0.3862]]]])
w[1] = np.array([[[[0.5231, 0.3733], [0.5495, 0.0114]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep62210').set_weights(w) 
in0Mul28965 = tf.constant([[[[[0.1241], [0.4718]], [[0.9863], [0.2597]]], [[[0.0419], [0.4019]], [[0.7798], [0.022]]]]])
in1Mul28965 = tf.constant([[[[[0.2288], [0.198]], [[0.651], [0.0018]]], [[[0.2714], [0.5868]], [[0.584], [0.5078]]]]])
in0Ave8332 = tf.constant([[[[0.3149, 0.0018], [0.1543, 0.9564]], [[0.6803, 0.075], [0.1639, 0.584]]]])
in1Ave8332 = tf.constant([[[[0.8628, 0.206], [0.0564, 0.9758]], [[0.057, 0.4411], [0.2242, 0.4555]]]])
in0Sep62210 = tf.constant([[[[0.1397, 0.9388], [0.4334, 0.8843]], [[0.7337, 0.5001], [0.1146, 0.5659]]]])
in0Min19230 = tf.constant([[[[[0.5746], [0.9963]], [[0.1925], [0.7651]]], [[[0.908], [0.0403]], [[0.4616], [0.8155]]]]])
in1Min19230 = tf.constant([[[[[0.0551], [0.9185]], [[0.2532], [0.9103]]], [[[0.6011], [0.6214]], [[0.2861], [0.4515]]]]])
in0Con49371 = tf.constant([[0.9299, 0.3657, 0.9412, 0.1078, 0.5359, 0.7415, 0.289]])
print (np.array2string(model.predict([in0Mul28965,in1Mul28965,in0Ave8332,in1Ave8332,in0Sep62210,in0Min19230,in1Min19230,in0Con49371],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub75357.png')

LMul28965 = multiply_layer([[[[[[0.1241], [0.4718]], [[0.9863], [0.2597]]], [[[0.0419], [0.4019]], [[0.7798], [0.022]]]]], [[[[[0.2288], [0.198]], [[0.651], [0.0018]]], [[[0.2714], [0.5868]], [[0.584], [0.5078]]]]]], Mul28965), 
LELU14900 = elu_layer(Mul28965, -8.626902305712544, ELU14900), 
LRes15796 = reshape_layer(ELU14900, [2, 2, 2], Res15796), 
LAve8332 = average_layer([[[[[0.3149, 0.0018], [0.1543, 0.9564]], [[0.6803, 0.075], [0.1639, 0.584]]]], [[[[0.8628, 0.206], [0.0564, 0.9758]], [[0.057, 0.4411], [0.2242, 0.4555]]]]], Ave8332), 
LRes65048 = reshape_layer(Ave8332, [2, 4], Res65048), 
LFla39716 = flatten_layer(Res65048, Fla39716), 
LSep62210 = separable_conv2D_layer([[[[0.1397, 0.9388], [0.4334, 0.8843]], [[0.7337, 0.5001], [0.1146, 0.5659]]]], 2, 1,[[[[[0.3453], [0.1919]]], [[[0.3678], [0.3862]]]],[[[[0.5231, 0.3733], [0.5495, 0.0114]]]]],[0, 0], 1, 1, false, Sep62210), 
LRes299 = reshape_layer(Sep62210, [1, 4], Res299), 
LMin19230 = minimum_layer([[[[[[0.5746], [0.9963]], [[0.1925], [0.7651]]], [[[0.908], [0.0403]], [[0.4616], [0.8155]]]]], [[[[[0.0551], [0.9185]], [[0.2532], [0.9103]]], [[[0.6011], [0.6214]], [[0.2861], [0.4515]]]]]], Min19230), 
LRes15841 = reshape_layer(Min19230, [2, 2, 2], Res15841), 
LRes98281 = reshape_layer(Res15841, [2, 4], Res98281), 
LZer37670 = zero_padding1D_layer(Res98281, 1, 0, Zer37670), 
LDot80463 = dot_layer(Res299,Zer37670, 2, 2, Dot80463), 
LRes45568 = reshape_layer(Dot80463, [1, 3, 1], Res45568), 
LRes4015 = reshape_layer(Res45568, [1, 3, 1, 1], Res4015), 
LGlo40250 = global_max_pool3D_layer(Res4015, Glo40250), 
LCon49371 = concatenate_layer([Glo40250,[[0.9299, 0.3657, 0.9412, 0.1078, 0.5359, 0.7415, 0.289]]], 1, Con49371), 
LMul46022 = multiply_layer([Fla39716,Con49371], Mul46022), 
LRes58637 = reshape_layer(Mul46022, [2, 2, 2], Res58637), 
LSub75357 = subtract_layer(Res15796,Res58637, Sub75357), 
exec_layers([LMul28965,LELU14900,LRes15796,LAve8332,LRes65048,LFla39716,LSep62210,LRes299,LMin19230,LRes15841,LRes98281,LZer37670,LDot80463,LRes45568,LRes4015,LGlo40250,LCon49371,LMul46022,LRes58637,LSub75357],["Mul28965","ELU14900","Res15796","Ave8332","Res65048","Fla39716","Sep62210","Res299","Min19230","Res15841","Res98281","Zer37670","Dot80463","Res45568","Res4015","Glo40250","Con49371","Mul46022","Res58637","Sub75357"],Sub75357,"Sub75357")

Actual (Unparsed): [[[[-0.1790845, -0.0032002], [0.6035548, -0.9088259]], [[-0.0283688, 0.0975459], [0.3115151, -0.1390362]]]]

Expected (Unparsed): [[[[-0.17908452014595178,-0.003200209999999981],[0.6035548049999999,-0.90882586]],[[-0.028368810000000008,0.09754592499999995],[0.311515125,-0.13903614999999997]]]]

Actual:   [[[[-0.179, -0.0032], [0.6036, -0.9088]], [[-0.0283, 0.0976], [0.3116, -0.139]]]]

Expected: [[[[-0.179, -0.0032], [0.6036, -0.9088]], [[-0.0283, 0.0976], [0.3116, -0.139]]]]