import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max11401 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max11401 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Add85489 = tf.keras.layers.Input(shape=([2, 1]))
in1Add85489 = tf.keras.layers.Input(shape=([2, 1]))
in0Con57371 = tf.keras.layers.Input(shape=([2, 1]))

Max11401 = keras.layers.Maximum(name = 'Max11401', )([in0Max11401,in1Max11401])
Res69263 = keras.layers.Reshape((1, 2), name = 'Res69263', )(Max11401)
Zer82300 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer82300', )(Res69263)
Add85489 = keras.layers.Add(name = 'Add85489', )([in0Add85489,in1Add85489])
Con57371 = keras.layers.Concatenate(axis=2, name = 'Con57371', )([Add85489,in0Con57371])
Sub66816 = keras.layers.Subtract(name = 'Sub66816', )([Zer82300,Con57371])
Con16200 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con16200', )(Sub66816)
model = tf.keras.models.Model(inputs=[in0Max11401,in1Max11401,in0Add85489,in1Add85489,in0Con57371], outputs=Con16200)
w = model.get_layer('Con16200').get_weights() 
w[0] = np.array([[[0.5269, 0.2407, 0.3269, 0.3547], [0.6576, 0.9635, 0.1215, 0.4276]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con16200').set_weights(w) 
in0Max11401 = tf.constant([[[[0.4185, 0.0654]]]])
in1Max11401 = tf.constant([[[[0.1327, 0.5669]]]])
in0Add85489 = tf.constant([[[0.2898], [0.9283]]])
in1Add85489 = tf.constant([[[0.1562], [0.452]]])
in0Con57371 = tf.constant([[[0.8518], [0.44]]])
print (np.array2string(model.predict([in0Max11401,in1Max11401,in0Add85489,in1Add85489,in0Con57371],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con16200.png')

LMax11401 = maximum_layer([[[[[0.4185, 0.0654]]]], [[[[0.1327, 0.5669]]]]], Max11401), 
LRes69263 = reshape_layer(Max11401, [1, 2], Res69263), 
LZer82300 = zero_padding1D_layer(Res69263, 1, 0, Zer82300), 
LAdd85489 = add_layer([[[[0.2898], [0.9283]]], [[[0.1562], [0.452]]]], Add85489), 
LCon57371 = concatenate_layer([Add85489,[[[0.8518], [0.44]]]], 2, Con57371), 
LSub66816 = subtract_layer(Zer82300,Con57371, Sub66816), 
LCon16200 = conv1D_layer(Sub66816, 1,[[[0.5269, 0.2407, 0.3269, 0.3547], [0.6576, 0.9635, 0.1215, 0.4276]]],[0, 0, 0, 0], 1, false, 1, Con16200), 
exec_layers([LMax11401,LRes69263,LZer82300,LAdd85489,LCon57371,LSub66816,LCon16200],["Max11401","Res69263","Zer82300","Add85489","Con57371","Sub66816","Con16200"],Con16200,"Con16200")

Actual (Unparsed): [[[-0.7951411, -0.9280615, -0.2492911, -0.5224259], [-0.4233230, -0.1092371, -0.2989941, -0.2868880]]]

Expected (Unparsed): [[[-0.79514108,-0.9280615,-0.24929110000000002,-0.52242588],[-0.4233229800000001,-0.10923711000000005,-0.2989940700000001,-0.2868880200000001]]]

Actual:   [[[-0.7951, -0.928, -0.2492, -0.5224], [-0.4233, -0.1092, -0.2989, -0.2868]]]

Expected: [[[-0.7951, -0.928, -0.2492, -0.5224], [-0.4233, -0.1092, -0.2989, -0.2868]]]