import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per54275 = tf.keras.layers.Input(shape=([3, 2]))
in0Cro68867 = tf.keras.layers.Input(shape=([2, 1, 2]))

Per54275 = keras.layers.Permute((1,2), name = 'Per54275',)(in0Per54275)
Cro68867 = keras.layers.Cropping2D(cropping=((0, 1), (0, 0)), name = 'Cro68867', )(in0Cro68867)
Res79102 = keras.layers.Reshape((1, 2), name = 'Res79102', )(Cro68867)
Zer66626 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer66626', )(Res79102)
Dot44095 = keras.layers.Dot(axes=(2, 2), name = 'Dot44095', )([Per54275,Zer66626])
Max99482 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max99482', )(Dot44095)
model = tf.keras.models.Model(inputs=[in0Per54275,in0Cro68867], outputs=Max99482)
in0Per54275 = tf.constant([[[1.3182, 1.9027], [1.8318, 1.3611], [1.1853, 1.38]]])
in0Cro68867 = tf.constant([[[[1.8735, 1.3101]], [[1.2869, 1.9495]]]])
print (np.array2string(model.predict([in0Per54275,in0Cro68867],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max99482.png')

LPer54275 = permute_layer([[[1.3182, 1.9027], [1.8318, 1.3611], [1.1853, 1.38]]], 1,2, Per54275), 
LCro68867 = cropping2D_layer([[[[1.8735, 1.3101]], [[1.2869, 1.9495]]]], 0, 1, 0, 0, Cro68867), 
LRes79102 = reshape_layer(Cro68867, [1, 2], Res79102), 
LZer66626 = zero_padding1D_layer(Res79102, 2, 0, Zer66626), 
LDot44095 = dot_layer(Per54275,Zer66626, 2, 2, Dot44095), 
LMax99482 = max_pool1D_layer(Dot44095, 1, Max99482), 
exec_layers([LPer54275,LCro68867,LRes79102,LZer66626,LDot44095,LMax99482],["Per54275","Cro68867","Res79102","Zer66626","Dot44095","Max99482"],Max99482,"Max99482")

Actual (Unparsed): [[[0.0000000, 0.0000000, 4.9623748], [0.0000000, 0.0000000, 5.2150543], [0.0000000, 0.0000000, 4.0285975]]]

Expected (Unparsed): [[[0.0,0.0,4.96237497],[0.0,0.0,5.2150544100000005],[0.0,0.0,4.02859755]]]

Actual:   [[[0, 0, 4.9624], [0, 0, 5.2151], [0, 0, 4.0286]]]

Expected: [[[0, 0, 4.9624], [0, 0, 5.2151], [0, 0, 4.0286]]]