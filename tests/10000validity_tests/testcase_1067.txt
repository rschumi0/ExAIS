import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul68726 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Mul68726 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Sof6067 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con77905 = tf.keras.layers.Input(shape=([2, 2, 1]))

Mul68726 = keras.layers.Multiply(name = 'Mul68726', )([in0Mul68726,in1Mul68726])
Res13796 = keras.layers.Reshape((1, 1, 2), name = 'Res13796', )(Mul68726)
Zer73218 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer73218', )(Res13796)
Sof6067 = keras.layers.Softmax(axis=1, name = 'Sof6067', input_shape=(2, 2, 1))(in0Sof6067)
Con77905 = keras.layers.Concatenate(axis=3, name = 'Con77905', )([Sof6067,in0Con77905])
Ave85905 = keras.layers.Average(name = 'Ave85905', )([Zer73218,Con77905])
Con51070 = keras.layers.Conv2DTranspose(4, (2, 1),strides=(1, 11), padding='same', name = 'Con51070', )(Ave85905)
model = tf.keras.models.Model(inputs=[in0Mul68726,in1Mul68726,in0Sof6067,in0Con77905], outputs=Con51070)
w = model.get_layer('Con51070').get_weights() 
w[0] = np.array([[[[0.5809, 0.851], [0.903, 0.3989], [0.9273, 0.9527], [0.6918, 0.5512]]], [[[0.0832, 0.0503], [0.7311, 0.2121], [0.6513, 0.217], [0.1513, 0.4796]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con51070').set_weights(w) 
in0Mul68726 = tf.constant([[[[[0.8087], [0.3794]]]]])
in1Mul68726 = tf.constant([[[[[0.1635], [0.2322]]]]])
in0Sof6067 = tf.constant([[[[0.9815], [0.3811]], [[0.9648], [0.8402]]]])
in0Con77905 = tf.constant([[[[0.1602], [0.7597]], [[0.6706], [0.5565]]]])
print (np.array2string(model.predict([in0Mul68726,in1Mul68726,in0Sof6067,in0Con77905],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con51070.png')

LMul68726 = multiply_layer([[[[[[0.8087], [0.3794]]]]], [[[[[0.1635], [0.2322]]]]]], Mul68726), 
LRes13796 = reshape_layer(Mul68726, [1, 1, 2], Res13796), 
LZer73218 = zero_padding2D_layer(Res13796, 1, 0, 1, 0, Zer73218), 
LSof6067 = softmax_layer([[[[0.9815], [0.3811]], [[0.9648], [0.8402]]]], 1, Sof6067), 
LCon77905 = concatenate_layer([Sof6067,[[[[0.1602], [0.7597]], [[0.6706], [0.5565]]]]], 3, Con77905), 
LAve85905 = average_layer([Zer73218,Con77905], Ave85905), 
LCon51070 = conv2D_transpose_layer(Ave85905, 2, 1,[[[[0.5809, 0.851], [0.903, 0.3989], [0.9273, 0.9527], [0.6918, 0.5512]]], [[[0.0832, 0.0503], [0.7311, 0.2121], [0.6513, 0.217], [0.1513, 0.4796]]]],[0, 0, 0, 0], 1, 11, true, Con51070), 
exec_layers([LMul68726,LRes13796,LZer73218,LSof6067,LCon77905,LAve85905,LCon51070],["Mul68726","Res13796","Zer73218","Sof6067","Con77905","Ave85905","Con51070"],Con51070,"Con51070")

Actual (Unparsed): [[[[0.2146027, 0.2595869, 0.3100720, 0.2185452], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.4357144, 0.3263427, 0.5414081, 0.3433056], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]], [[0.4543554, 0.5589065, 0.7308959, 0.4328800], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.5258818, 0.6870496, 0.8610025, 0.6468220], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000], [0.0000000, 0.0000000, 0.0000000, 0.0000000]]]]

Expected (Unparsed): [[[[0.21460270056828326,0.2595868586919604,0.31007196376307294,0.21854521893809326],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0.43571440137626183,0.32634267178733756,0.5414080738968972,0.3433055753659803],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],[[0.45435540539536134,0.558906547089537,0.7308958733898326,0.43288005247175565],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0.5258817945504093,0.68704964481856,0.861002507080317,0.6468220259684752],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]]]

Actual:   [[[[0.2147, 0.2596, 0.3101, 0.2186], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0.4358, 0.3264, 0.5415, 0.3434], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0.4544, 0.559, 0.7309, 0.4329], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0.5259, 0.6871, 0.8611, 0.6469], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]]

Expected: [[[[0.2147, 0.2596, 0.3101, 0.2186], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0.4358, 0.3264, 0.5415, 0.3434], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]], [[0.4544, 0.559, 0.7309, 0.4329], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0.5259, 0.6871, 0.8611, 0.6469], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0], [0, 0, 0, 0]]]]