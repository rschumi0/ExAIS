import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub583 = tf.keras.layers.Input(shape=([2, 3]))
in1Sub583 = tf.keras.layers.Input(shape=([2, 3]))

Sub583 = keras.layers.Subtract(name = 'Sub583', )([in0Sub583,in1Sub583])
Res61020 = keras.layers.Reshape((2, 3, 1), name = 'Res61020', )(Sub583)
Zer47961 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer47961', )(Res61020)
Max73018 = keras.layers.MaxPool2D(pool_size=(1, 1), strides=(1, 1), padding='same', name = 'Max73018', )(Zer47961)
Res47286 = keras.layers.Reshape((4, 5, 1, 1), name = 'Res47286', )(Max73018)
Cro5182 = keras.layers.Cropping3D(cropping=((1, 0), (1, 3), (0, 0)), name = 'Cro5182', )(Res47286)
Res86207 = keras.layers.Reshape((3, 1, 1), name = 'Res86207', )(Cro5182)
Res54081 = keras.layers.Reshape((3, 1), name = 'Res54081', )(Res86207)
Sep84392 = keras.layers.SeparableConv1D(3, (1),strides=(2), padding='same', name = 'Sep84392', )(Res54081)
model = tf.keras.models.Model(inputs=[in0Sub583,in1Sub583], outputs=Sep84392)
w = model.get_layer('Sep84392').get_weights() 
w[0] = np.array([[[0.3015]]])
w[1] = np.array([[[0.086, 0.3823, 0.6822]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep84392').set_weights(w) 
in0Sub583 = tf.constant([[[0.0528, 0.2148, 0.2782], [0.8893, 0.8444, 0.6823]]])
in1Sub583 = tf.constant([[[0.4151, 0.6845, 0.6701], [0.4499, 0.3873, 0.3123]]])
print (np.array2string(model.predict([in0Sub583,in1Sub583],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep84392.png')

LSub583 = subtract_layer([[[0.0528, 0.2148, 0.2782], [0.8893, 0.8444, 0.6823]]], [[[0.4151, 0.6845, 0.6701], [0.4499, 0.3873, 0.3123]]], Sub583), 
LRes61020 = reshape_layer(Sub583, [2, 3, 1], Res61020), 
LZer47961 = zero_padding2D_layer(Res61020, 1, 1, 1, 1, Zer47961), 
LMax73018 = max_pool2D_layer(Zer47961, 1, 1, 1, 1, true, Max73018), 
LRes47286 = reshape_layer(Max73018, [4, 5, 1, 1], Res47286), 
LCro5182 = cropping3D_layer(Res47286, 1, 0, 1, 3, 0, 0, Cro5182), 
LRes86207 = reshape_layer(Cro5182, [3, 1, 1], Res86207), 
LRes54081 = reshape_layer(Res86207, [3, 1], Res54081), 
LSep84392 = separable_conv1D_layer(Res54081, 1,[[[[0.3015]]],[[[0.086, 0.3823, 0.6822]]]],[0, 0, 0], 2, true, Sep84392), 
exec_layers([LSub583,LRes61020,LZer47961,LMax73018,LRes47286,LCro5182,LRes86207,LRes54081,LSep84392],["Sub583","Res61020","Zer47961","Max73018","Res47286","Cro5182","Res86207","Res54081","Sep84392"],Sep84392,"Sep84392")

Actual (Unparsed): [[[-0.0093941, -0.0417599, -0.0745191], [0.0000000, 0.0000000, 0.0000000]]]

Expected (Unparsed): [[[-0.009394076699999998,-0.04175994793499999,-0.07451905959],[0.0,0.0,0.0]]]

Actual:   [[[-0.0093, -0.0417, -0.0745], [0, 0, 0]]]

Expected: [[[-0.0093, -0.0417, -0.0745], [0, 0, 0]]]