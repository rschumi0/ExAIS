import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot25692 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot25692 = tf.keras.layers.Input(shape=([3, 2]))

Dot25692 = keras.layers.Dot(axes=(1, 1), name = 'Dot25692', )([in0Dot25692,in1Dot25692])
Sim54291 = keras.layers.SimpleRNN(1,name = 'Sim54291', )(Dot25692)
Lea90149 = keras.layers.LeakyReLU(alpha=8.258635966726485, name = 'Lea90149', )(Sim54291)
model = tf.keras.models.Model(inputs=[in0Dot25692,in1Dot25692], outputs=Lea90149)
w = model.get_layer('Sim54291').get_weights() 
w[0] = np.array([[9], [1]])
w[1] = np.array([[10]])
w[2] = np.array([1])
model.get_layer('Sim54291').set_weights(w) 
in0Dot25692 = tf.constant([[[0.5052, 0.983], [0.3351, 0.4466], [0.432, 0.0666]]])
in1Dot25692 = tf.constant([[[0.8349, 0.9874], [0.1211, 0.2991], [0.2943, 0.2466]]])
print (np.array2string(model.predict([in0Dot25692,in1Dot25692],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Lea90149.png')

LDot25692 = dot_layer([[[0.5052, 0.983], [0.3351, 0.4466], [0.432, 0.0666]]], [[[0.8349, 0.9874], [0.1211, 0.2991], [0.2943, 0.2466]]], 1, 1, Dot25692), 
LSim54291 = simple_rnn_layer(Dot25692,[[9], [1]],[[10]],[1], Sim54291), 
LLea90149 = leaky_relu_layer(Sim54291, 8.258635966726485, Lea90149), 
exec_layers([LDot25692,LSim54291,LLea90149],["Dot25692","Sim54291","Lea90149"],Lea90149,"Lea90149")

Actual (Unparsed): [[1.0000000]]

Expected (Unparsed): [[1.0]]

Actual:   [[1]]

Expected: [[1]]