import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sep20828 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Con81457 = tf.keras.layers.Input(shape=([3, 4, 1]))
in0Zer72464 = tf.keras.layers.Input(shape=([1, 2, 3]))
in0Ave78572 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave78572 = tf.keras.layers.Input(shape=([1, 1]))
in0Ave36409 = tf.keras.layers.Input(shape=([1, 1]))
in0Con1498 = tf.keras.layers.Input(shape=([3, 11]))

Sep20828 = keras.layers.SeparableConv2D(2, (1, 1),strides=(1, 1), padding='valid', name = 'Sep20828', )(in0Sep20828)
Zer9153 = keras.layers.ZeroPadding2D(padding=((2, 0), (3, 0)), name = 'Zer9153', )(Sep20828)
Con81457 = keras.layers.Concatenate(axis=3, name = 'Con81457', )([Zer9153,in0Con81457])
Zer72464 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer72464', )(in0Zer72464)
Min6915 = keras.layers.Minimum(name = 'Min6915', )([Con81457,Zer72464])
Res1721 = keras.layers.Reshape((3, 12), name = 'Res1721', )(Min6915)
Ave78572 = keras.layers.Average(name = 'Ave78572', )([in0Ave78572,in1Ave78572])
Ave36409 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave36409', )(in0Ave36409)
Mul85642 = keras.layers.Multiply(name = 'Mul85642', )([Ave78572,Ave36409])
Zer31765 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer31765', )(Mul85642)
Con1498 = keras.layers.Concatenate(axis=2, name = 'Con1498', )([Zer31765,in0Con1498])
Sub80202 = keras.layers.Subtract(name = 'Sub80202', )([Res1721,Con1498])
Res18339 = keras.layers.Reshape((3, 12, 1), name = 'Res18339', )(Sub80202)
Con69878 = keras.layers.Conv2D(4, (2, 11),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con69878', )(Res18339)
model = tf.keras.models.Model(inputs=[in0Sep20828,in0Con81457,in0Zer72464,in0Ave78572,in1Ave78572,in0Ave36409,in0Con1498], outputs=Con69878)
w = model.get_layer('Sep20828').get_weights() 
w[0] = np.array([[[[0.375], [0.3049]]]])
w[1] = np.array([[[[0.5528, 0.5843], [0.2291, 0.8588]]]])
w[2] = np.array([0, 0])
model.get_layer('Sep20828').set_weights(w) 
w = model.get_layer('Con69878').get_weights() 
w[0] = np.array([[[[0.4537, 0.1884, 0.2125, 0.7227]], [[0.4398, 0.0914, 0.3409, 0.8507]], [[0.3239, 0.9794, 0.8493, 0.9459]], [[0.9876, 0.639, 0.5599, 0.9895]], [[0.3833, 0.0273, 0.1692, 0.671]], [[0.8536, 0.1105, 0.5633, 0.3543]], [[0.3979, 0.5388, 0.7532, 0.347]], [[0.9155, 0.3129, 0.173, 0.5785]], [[0.1345, 0.5713, 0.4, 0.031]], [[0.15, 0.3751, 0.7143, 0.7815]], [[0.2346, 0.9013, 0.2942, 0.312]]], [[[0.8619, 0.7689, 0.2616, 0.8249]], [[0.6886, 0.3156, 0.2369, 0.6587]], [[0.576, 0.5203, 0.5414, 0.5426]], [[0.6016, 0.9232, 0.6913, 0.3516]], [[0.4113, 0.3335, 0.3723, 0.2265]], [[0.1912, 0.3352, 0.6488, 0.4088]], [[0.0021, 0.6014, 0.7706, 0.908]], [[0.2115, 0.8111, 0.5689, 0.1665]], [[0.2833, 0.5242, 0.1007, 0.2151]], [[0.2408, 0.7178, 0.897, 0.4239]], [[0.705, 0.8089, 0.8976, 0.8446]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con69878').set_weights(w) 
in0Sep20828 = tf.constant([[[[0.7732, 0.4661]]]])
in0Con81457 = tf.constant([[[[0.4317], [0.6212], [0.7783], [0.4131]], [[0.8606], [0.3341], [0.9392], [0.1229]], [[0.3749], [0.5034], [0.6999], [0.988]]]])
in0Zer72464 = tf.constant([[[[1.7256, 1.4447, 1.3021], [1.9343, 1.4434, 1.9078]]]])
in0Ave78572 = tf.constant([[[0.4002]]])
in1Ave78572 = tf.constant([[[0.1466]]])
in0Ave36409 = tf.constant([[[1.635]]])
in0Con1498 = tf.constant([[[0.3234, 0.0194, 0.4898, 0.8778, 0.1845, 0.3944, 0.0077, 0.34, 0.6617, 0.0903, 0.0518], [0.6923, 0.6487, 0.7761, 0.278, 0.1473, 0.3906, 0.1792, 0.6476, 0.0992, 0.8882, 0.5936], [0.5824, 0.8993, 0.0227, 0.3993, 0.4193, 0.288, 0.8291, 0.8355, 0.387, 0.2929, 0.5052]]])
print (np.array2string(model.predict([in0Sep20828,in0Con81457,in0Zer72464,in0Ave78572,in1Ave78572,in0Ave36409,in0Con1498],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con69878.png')

LSep20828 = separable_conv2D_layer([[[[0.7732, 0.4661]]]], 1, 1,[[[[[0.375], [0.3049]]]],[[[[0.5528, 0.5843], [0.2291, 0.8588]]]]],[0, 0], 1, 1, false, Sep20828), 
LZer9153 = zero_padding2D_layer(Sep20828, 2, 0, 3, 0, Zer9153), 
LCon81457 = concatenate_layer([Zer9153,[[[[0.4317], [0.6212], [0.7783], [0.4131]], [[0.8606], [0.3341], [0.9392], [0.1229]], [[0.3749], [0.5034], [0.6999], [0.988]]]]], 3, Con81457), 
LZer72464 = zero_padding2D_layer([[[[1.7256, 1.4447, 1.3021], [1.9343, 1.4434, 1.9078]]]], 1, 1, 1, 1, Zer72464), 
LMin6915 = minimum_layer([Con81457,Zer72464], Min6915), 
LRes1721 = reshape_layer(Min6915, [3, 12], Res1721), 
LAve78572 = average_layer([[[[0.4002]]], [[[0.1466]]]], Ave78572), 
LAve36409 = average_pooling1D_layer([[[1.635]]], 1, Ave36409), 
LMul85642 = multiply_layer([Ave78572,Ave36409], Mul85642), 
LZer31765 = zero_padding1D_layer(Mul85642, 2, 0, Zer31765), 
LCon1498 = concatenate_layer([Zer31765,[[[0.3234, 0.0194, 0.4898, 0.8778, 0.1845, 0.3944, 0.0077, 0.34, 0.6617, 0.0903, 0.0518], [0.6923, 0.6487, 0.7761, 0.278, 0.1473, 0.3906, 0.1792, 0.6476, 0.0992, 0.8882, 0.5936], [0.5824, 0.8993, 0.0227, 0.3993, 0.4193, 0.288, 0.8291, 0.8355, 0.387, 0.2929, 0.5052]]]], 2, Con1498), 
LSub80202 = subtract_layer(Res1721,Con1498, Sub80202), 
LRes18339 = reshape_layer(Sub80202, [3, 12, 1], Res18339), 
LCon69878 = conv2D_layer(Res18339, 2, 11,[[[[0.4537, 0.1884, 0.2125, 0.7227]], [[0.4398, 0.0914, 0.3409, 0.8507]], [[0.3239, 0.9794, 0.8493, 0.9459]], [[0.9876, 0.639, 0.5599, 0.9895]], [[0.3833, 0.0273, 0.1692, 0.671]], [[0.8536, 0.1105, 0.5633, 0.3543]], [[0.3979, 0.5388, 0.7532, 0.347]], [[0.9155, 0.3129, 0.173, 0.5785]], [[0.1345, 0.5713, 0.4, 0.031]], [[0.15, 0.3751, 0.7143, 0.7815]], [[0.2346, 0.9013, 0.2942, 0.312]]], [[[0.8619, 0.7689, 0.2616, 0.8249]], [[0.6886, 0.3156, 0.2369, 0.6587]], [[0.576, 0.5203, 0.5414, 0.5426]], [[0.6016, 0.9232, 0.6913, 0.3516]], [[0.4113, 0.3335, 0.3723, 0.2265]], [[0.1912, 0.3352, 0.6488, 0.4088]], [[0.0021, 0.6014, 0.7706, 0.908]], [[0.2115, 0.8111, 0.5689, 0.1665]], [[0.2833, 0.5242, 0.1007, 0.2151]], [[0.2408, 0.7178, 0.897, 0.4239]], [[0.705, 0.8089, 0.8976, 0.8446]]]],[0, 0, 0, 0], 1, 1, true, 1, 1, Con69878), 
exec_layers([LSep20828,LZer9153,LCon81457,LZer72464,LMin6915,LRes1721,LAve78572,LAve36409,LMul85642,LZer31765,LCon1498,LSub80202,LRes18339,LCon69878],["Sep20828","Zer9153","Con81457","Zer72464","Min6915","Res1721","Ave78572","Ave36409","Mul85642","Zer31765","Con1498","Sub80202","Res18339","Con69878"],Con69878,"Con69878")

Actual (Unparsed): [[[[-0.6810448, -2.3534808, -2.1865329, -1.7458202], [-1.5774749, -2.7048934, -2.4820728, -2.0108796], [-1.8614913, -2.2777903, -2.8714534, -2.6677155], [-2.1380656, -2.5554491, -2.6865477, -1.8848419], [-2.9967873, -2.8710842, -2.7270277, -2.5166412], [-3.4584170, -3.4643092, -3.8808712, -4.3111251], [-4.2719199, -4.2281596, -4.0879675, -4.8002141], [-3.3606187, -3.2019285, -2.6249117, -3.7426363], [-3.0655703, -3.0585343, -2.4652204, -3.2209089], [-1.8634676, -2.1958006, -2.4377106, -2.9569519], [-1.1943920, -0.8430361, -1.5821307, -2.3289942], [-1.8553605, -1.6309594, -1.5612832, -2.1076280]], [[-1.6466951, -2.8224940, -3.0749746, -2.1881123], [-2.3796187, -2.7564596, -3.0305496, -2.5704077], [-2.9954749, -3.1400991, -3.7709333, -3.1362143], [-3.4873053, -3.7446764, -4.3731334, -3.6565928], [-3.7272476, -4.4973347, -4.0362136, -4.2688252], [-4.0063914, -5.2076291, -4.2699976, -5.1765149], [-3.7941460, -5.4422015, -5.1708287, -5.8145505], [-2.8653791, -3.9805251, -4.0162673, -4.6056488], [-2.9678099, -2.8006485, -2.5447264, -3.2394567], [-3.0398913, -3.5485684, -3.2138196, -2.8307439], [-2.6456241, -2.5574485, -2.9743882, -2.6108141], [-2.8569687, -1.4997257, -1.8650841, -2.7093392]], [[-1.5979289, -1.1852436, -1.2637008, -1.3242914], [-1.2312542, -1.2131781, -1.6289353, -1.2613936], [-2.1010367, -1.6329254, -1.5589343, -1.8873493], [-1.9859028, -2.4119212, -2.1972009, -2.9092513], [-2.3810586, -2.6825523, -2.7872361, -3.0892182], [-2.3963908, -2.3910365, -2.4309292, -3.1073950], [-2.7773083, -2.0070199, -2.1880224, -3.1554582], [-2.5814590, -1.8580820, -2.4627669, -2.8665200], [-2.1272147, -1.3392091, -1.8134688, -2.2094183], [-2.5073188, -1.3068785, -1.6039777, -2.8297154], [-2.0099597, -1.7663567, -1.9702192, -2.6977585], [-1.6916307, -1.2594414, -1.6042495, -2.4622172]]]]

Expected (Unparsed): [[[[-0.68104477,-2.3534808399999996,-2.1865329200000003,-1.7458201800000002],[-1.57747488,-2.7048934,-2.48207284,-2.0108796],[-1.8614913299999998,-2.27779031,-2.87145339,-2.66771551],[-2.13806556,-2.55544909,-2.686547670000001,-1.8848419299999997],[-2.9967872900000003,-2.87108424,-2.7270277000000003,-2.5166411499999994],[-3.458417009999999,-3.46430925,-3.88087124,-4.311125080000001],[-4.27191996,-4.228159630000001,-4.0879674999999995,-4.800214110000001],[-3.360618689999999,-3.20192854,-2.62491171,-3.74263631],[-3.065570370000001,-3.05853439,-2.465220429999999,-3.220908970000001],[-1.8634676499999996,-2.19580061,-2.43771059,-2.9569519099999995],[-1.19439195,-0.8430361,-1.5821307499999997,-2.32899427],[-1.85536049,-1.6309593699999998,-1.56128316,-2.10762798]],[[-1.6466951508000003,-2.8224940168000003,-3.0749746192000003,-2.1881122992],[-2.3796187117,-2.7564596715,-3.0305496007,-2.570407748499999],[-2.9954749244,-3.1400991288,-3.770933351699999,-3.1362142544000005],[-3.4873053039999995,-3.7446763926999997,-4.3731333726,-3.6565927534],[-3.7272476273999993,-4.4973346804,-4.0362136221,-4.2688252183],[-4.0063913771,-5.2076290801,-4.269997604399999,-5.1765148840999995],[-3.794146010000001,-5.442201529999999,-5.17082875,-5.8145504699999995],[-2.865379119999999,-3.9805251200000002,-4.01626729,-4.605648889999999],[-2.96780994,-2.80064848,-2.5447264399999994,-3.2394567100000002],[-3.0398912900000004,-3.54856844,-3.21381957,-2.83074393],[-2.64562413,-2.5574485,-2.97438819,-2.6108140499999997],[-2.85696875,-1.49972574,-1.8650841199999997,-2.7093391799999997]],[[-1.5979289224,-1.1852436145,-1.2637007996999998,-1.3242913886999998],[-1.2312541597,-1.2131781356999998,-1.6289352928000003,-1.261393659],[-2.1010366784,-1.6329253710000002,-1.5589342691000003,-1.8873492455],[-1.9859027851,-2.4119212246000004,-2.1972008637,-2.9092513231],[-2.3810586082,-2.6825522626000007,-2.7872360981,-3.0892182063000004],[-2.3963908032999997,-2.3910365256,-2.4309292225,-3.1073950443],[-2.7773082799999997,-2.00701983,-2.1880224399999997,-3.15545817],[-2.58145898,-1.8580819599999998,-2.46276683,-2.86652005],[-2.12721468,-1.33920907,-1.81346878,-2.20941827],[-2.50731877,-1.3068784900000001,-1.6039776899999998,-2.8297153700000006],[-2.00995972,-1.7663566699999997,-1.97021914,-2.6977585199999994],[-1.69163072,-1.25944141,-1.6042494800000002,-2.4622171800000006]]]]

Actual:   [[[[-0.681, -2.3534, -2.1865, -1.7458], [-1.5774, -2.7048, -2.482, -2.0108], [-1.8614, -2.2777, -2.8714, -2.6677], [-2.138, -2.5554, -2.6865, -1.8848], [-2.9967, -2.871, -2.727, -2.5166], [-3.4584, -3.4643, -3.8808, -4.3111], [-4.2719, -4.2281, -4.0879, -4.8002], [-3.3606, -3.2019, -2.6249, -3.7426], [-3.0655, -3.0585, -2.4652, -3.2209], [-1.8634, -2.1958, -2.4377, -2.9569], [-1.1943, -0.843, -1.5821, -2.3289], [-1.8553, -1.6309, -1.5612, -2.1076]], [[-1.6466, -2.8224, -3.0749, -2.1881], [-2.3796, -2.7564, -3.0305, -2.5704], [-2.9954, -3.14, -3.7709, -3.1362], [-3.4873, -3.7446, -4.3731, -3.6565], [-3.7272, -4.4973, -4.0362, -4.2688], [-4.0063, -5.2076, -4.2699, -5.1765], [-3.7941, -5.4422, -5.1708, -5.8145], [-2.8653, -3.9805, -4.0162, -4.6056], [-2.9678, -2.8006, -2.5447, -3.2394], [-3.0398, -3.5485, -3.2138, -2.8307], [-2.6456, -2.5574, -2.9743, -2.6108], [-2.8569, -1.4997, -1.865, -2.7093]], [[-1.5979, -1.1852, -1.2637, -1.3242], [-1.2312, -1.2131, -1.6289, -1.2613], [-2.101, -1.6329, -1.5589, -1.8873], [-1.9859, -2.4119, -2.1972, -2.9092], [-2.381, -2.6825, -2.7872, -3.0892], [-2.3963, -2.391, -2.4309, -3.1073], [-2.7773, -2.007, -2.188, -3.1554], [-2.5814, -1.858, -2.4627, -2.8665], [-2.1272, -1.3392, -1.8134, -2.2094], [-2.5073, -1.3068, -1.6039, -2.8297], [-2.0099, -1.7663, -1.9702, -2.6977], [-1.6916, -1.2594, -1.6042, -2.4622]]]]

Expected: [[[[-0.681, -2.3534, -2.1865, -1.7458], [-1.5774, -2.7048, -2.482, -2.0108], [-1.8614, -2.2777, -2.8714, -2.6677], [-2.138, -2.5554, -2.6865, -1.8848], [-2.9967, -2.871, -2.727, -2.5166], [-3.4584, -3.4643, -3.8808, -4.3111], [-4.2719, -4.2281, -4.0879, -4.8002], [-3.3606, -3.2019, -2.6249, -3.7426], [-3.0655, -3.0585, -2.4652, -3.2209], [-1.8634, -2.1958, -2.4377, -2.9569], [-1.1943, -0.843, -1.5821, -2.3289], [-1.8553, -1.6309, -1.5612, -2.1076]], [[-1.6466, -2.8224, -3.0749, -2.1881], [-2.3796, -2.7564, -3.0305, -2.5704], [-2.9954, -3.14, -3.7709, -3.1362], [-3.4873, -3.7446, -4.3731, -3.6565], [-3.7272, -4.4973, -4.0362, -4.2688], [-4.0063, -5.2076, -4.2699, -5.1765], [-3.7941, -5.4422, -5.1708, -5.8145], [-2.8653, -3.9805, -4.0162, -4.6056], [-2.9678, -2.8006, -2.5447, -3.2394], [-3.0398, -3.5485, -3.2138, -2.8307], [-2.6456, -2.5574, -2.9743, -2.6108], [-2.8569, -1.4997, -1.865, -2.7093]], [[-1.5979, -1.1852, -1.2637, -1.3242], [-1.2312, -1.2131, -1.6289, -1.2613], [-2.101, -1.6329, -1.5589, -1.8873], [-1.9859, -2.4119, -2.1972, -2.9092], [-2.381, -2.6825, -2.7872, -3.0892], [-2.3963, -2.391, -2.4309, -3.1073], [-2.7773, -2.007, -2.188, -3.1554], [-2.5814, -1.858, -2.4627, -2.8665], [-2.1272, -1.3392, -1.8134, -2.2094], [-2.5073, -1.3068, -1.6039, -2.8297], [-2.0099, -1.7663, -1.9702, -2.6977], [-1.6916, -1.2594, -1.6042, -2.4622]]]]