import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul92678 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Mul92678 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Con86862 = tf.keras.layers.Input(shape=([14]))
in0Max78902 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Max78902 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Dot7145 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot7145 = tf.keras.layers.Input(shape=([2, 3]))
in0Con50861 = tf.keras.layers.Input(shape=([15]))
in0Glo5643 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Con75339 = tf.keras.layers.Input(shape=([14]))

Mul92678 = keras.layers.Multiply(name = 'Mul92678', )([in0Mul92678,in1Mul92678])
Res21529 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res21529', )(Mul92678)
Up_74728 = keras.layers.UpSampling3D(size=(1, 2, 2), name = 'Up_74728', )(Res21529)
Res14697 = keras.layers.Reshape((2, 4, 2), name = 'Res14697', )(Up_74728)
Max35897 = keras.layers.MaxPool2D(pool_size=(1, 4), strides=(1, 9), padding='same', name = 'Max35897', )(Res14697)
Glo50262 = keras.layers.GlobalMaxPool2D(name = 'Glo50262', )(Max35897)
Con86862 = keras.layers.Concatenate(axis=1, name = 'Con86862', )([Glo50262,in0Con86862])
Max78902 = keras.layers.Maximum(name = 'Max78902', )([in0Max78902,in1Max78902])
Res42318 = keras.layers.Reshape((1, 1, 2, 1), name = 'Res42318', )(Max78902)
Con15722 = keras.layers.Conv3DTranspose(4, (1, 1, 2),strides=(1, 1, 2), padding='valid', name = 'Con15722', )(Res42318)
Res62700 = keras.layers.Reshape((1, 1, 16), name = 'Res62700', )(Con15722)
Res89654 = keras.layers.Reshape((1, 16), name = 'Res89654', )(Res62700)
Fla7024 = keras.layers.Flatten(name = 'Fla7024', )(Res89654)
Dot7145 = keras.layers.Dot(axes=(2, 2), name = 'Dot7145', )([in0Dot7145,in1Dot7145])
Res46229 = keras.layers.Reshape((2, 2, 1), name = 'Res46229', )(Dot7145)
Con88145 = keras.layers.Conv2DTranspose(4, (1, 2),strides=(1, 7), padding='valid', name = 'Con88145', )(Res46229)
Res87914 = keras.layers.Reshape((2, 14, 4, 1), name = 'Res87914', )(Con88145)
Glo76202 = keras.layers.GlobalAveragePooling3D(name = 'Glo76202', )(Res87914)
Con50861 = keras.layers.Concatenate(axis=1, name = 'Con50861', )([Glo76202,in0Con50861])
Mul56780 = keras.layers.Multiply(name = 'Mul56780', )([Fla7024,Con50861])
Glo5643 = keras.layers.GlobalAveragePooling3D(name = 'Glo5643', )(in0Glo5643)
Res32396 = keras.layers.Reshape((2, 1), name = 'Res32396', )(Glo5643)
GRU85329 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU85329', )(Res32396)
Con75339 = keras.layers.Concatenate(axis=1, name = 'Con75339', )([GRU85329,in0Con75339])
Add77075 = keras.layers.Add(name = 'Add77075', )([Mul56780,Con75339])
Dot86369 = keras.layers.Dot(axes=(1, 1), name = 'Dot86369', )([Con86862,Add77075])
model = tf.keras.models.Model(inputs=[in0Mul92678,in1Mul92678,in0Con86862,in0Max78902,in1Max78902,in0Dot7145,in1Dot7145,in0Con50861,in0Glo5643,in0Con75339], outputs=Dot86369)
w = model.get_layer('Con15722').get_weights() 
w[0] = np.array([[[[[0.5775], [0.8489], [0.4803], [0.9252]], [[0.6343], [0.4965], [0.1253], [0.3133]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con15722').set_weights(w) 
w = model.get_layer('Con88145').get_weights() 
w[0] = np.array([[[[0.8471], [0.9907], [0.9595], [0.1283]], [[0.65], [0.6885], [0.5157], [0.5713]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con88145').set_weights(w) 
w = model.get_layer('GRU85329').get_weights() 
w[0] = np.array([[5, 2, 8, 9, 3, 5]])
w[1] = np.array([[2, 8, 1, 5, 6, 4], [5, 10, 1, 4, 3, 9]])
w[2] = np.array([8, 8, 1, 6, 2, 7])
model.get_layer('GRU85329').set_weights(w) 
in0Mul92678 = tf.constant([[[[0.0662], [0.9034]], [[0.9743], [0.4036]]]])
in1Mul92678 = tf.constant([[[[0.3196], [0.1645]], [[0.8672], [0.7447]]]])
in0Con86862 = tf.constant([[0.0928, 0.6454, 0.8225, 0.4078, 0.334, 0.3717, 0.1784, 0.3434, 0.7901, 0.8444, 0.1693, 0.7547, 0.3678, 0.7787]])
in0Max78902 = tf.constant([[[[0.0375, 0.4757]]]])
in1Max78902 = tf.constant([[[[0.9566, 0.2037]]]])
in0Dot7145 = tf.constant([[[0.8545, 0.644, 0.5675], [0.696, 0.9704, 0.4238]]])
in1Dot7145 = tf.constant([[[0.2049, 0.818, 0.7634], [0.1515, 0.4407, 0.5522]]])
in0Con50861 = tf.constant([[0.4368, 0.2281, 0.5928, 0.1631, 0.0907, 0.2578, 0.6849, 0.599, 0.7953, 0.7231, 0.9881, 0.4802, 0.289, 0.9758, 0.3801]])
in0Glo5643 = tf.constant([[[[[1.2193, 1.9721]]]]])
in0Con75339 = tf.constant([[0.5617, 0.7742, 0.1272, 0.212, 0.4153, 0.2085, 0.8812, 0.3484, 0.5327, 0.5409, 0.7909, 0.7885, 0.9395, 0.0188]])
print (np.array2string(model.predict([in0Mul92678,in1Mul92678,in0Con86862,in0Max78902,in1Max78902,in0Dot7145,in1Dot7145,in0Con50861,in0Glo5643,in0Con75339],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot86369.png')

LMul92678 = multiply_layer([[[[[0.0662], [0.9034]], [[0.9743], [0.4036]]]], [[[[0.3196], [0.1645]], [[0.8672], [0.7447]]]]], Mul92678), 
LRes21529 = reshape_layer(Mul92678, [2, 2, 1, 1], Res21529), 
LUp_74728 = up_sampling3D_layer(Res21529, 1, 2, 2, Up_74728), 
LRes14697 = reshape_layer(Up_74728, [2, 4, 2], Res14697), 
LMax35897 = max_pool2D_layer(Res14697, 1, 4, 1, 9, true, Max35897), 
LGlo50262 = global_max_pool2D_layer(Max35897, Glo50262), 
LCon86862 = concatenate_layer([Glo50262,[[0.0928, 0.6454, 0.8225, 0.4078, 0.334, 0.3717, 0.1784, 0.3434, 0.7901, 0.8444, 0.1693, 0.7547, 0.3678, 0.7787]]], 1, Con86862), 
LMax78902 = maximum_layer([[[[[0.0375, 0.4757]]]], [[[[0.9566, 0.2037]]]]], Max78902), 
LRes42318 = reshape_layer(Max78902, [1, 1, 2, 1], Res42318), 
LCon15722 = conv3D_transpose_layer(Res42318, 1, 1, 2,[[[[[0.5775], [0.8489], [0.4803], [0.9252]], [[0.6343], [0.4965], [0.1253], [0.3133]]]]],[0, 0, 0, 0], 1, 1, 2, false, Con15722), 
LRes62700 = reshape_layer(Con15722, [1, 1, 16], Res62700), 
LRes89654 = reshape_layer(Res62700, [1, 16], Res89654), 
LFla7024 = flatten_layer(Res89654, Fla7024), 
LDot7145 = dot_layer([[[0.8545, 0.644, 0.5675], [0.696, 0.9704, 0.4238]]], [[[0.2049, 0.818, 0.7634], [0.1515, 0.4407, 0.5522]]], 2, 2, Dot7145), 
LRes46229 = reshape_layer(Dot7145, [2, 2, 1], Res46229), 
LCon88145 = conv2D_transpose_layer(Res46229, 1, 2,[[[[0.8471], [0.9907], [0.9595], [0.1283]], [[0.65], [0.6885], [0.5157], [0.5713]]]],[0, 0, 0, 0], 1, 7, false, Con88145), 
LRes87914 = reshape_layer(Con88145, [2, 14, 4, 1], Res87914), 
LGlo76202 = global_average_pooling3D_layer(Res87914, Glo76202), 
LCon50861 = concatenate_layer([Glo76202,[[0.4368, 0.2281, 0.5928, 0.1631, 0.0907, 0.2578, 0.6849, 0.599, 0.7953, 0.7231, 0.9881, 0.4802, 0.289, 0.9758, 0.3801]]], 1, Con50861), 
LMul56780 = multiply_layer([Fla7024,Con50861], Mul56780), 
LGlo5643 = global_average_pooling3D_layer([[[[[1.2193, 1.9721]]]]], Glo5643), 
LRes32396 = reshape_layer(Glo5643, [2, 1], Res32396), 
LGRU85329 = gru_layer(Res32396,[[5, 2, 8, 9, 3, 5]],[[2, 8, 1, 5, 6, 4], [5, 10, 1, 4, 3, 9]],[8, 8, 1, 6, 2, 7], false, GRU85329), 
LCon75339 = concatenate_layer([GRU85329,[[0.5617, 0.7742, 0.1272, 0.212, 0.4153, 0.2085, 0.8812, 0.3484, 0.5327, 0.5409, 0.7909, 0.7885, 0.9395, 0.0188]]], 1, Con75339), 
LAdd77075 = add_layer([Mul56780,Con75339], Add77075), 
LDot86369 = dot_layer(Con86862,Add77075, 1, 1, Dot86369), 
exec_layers([LMul92678,LRes21529,LUp_74728,LRes14697,LMax35897,LGlo50262,LCon86862,LMax78902,LRes42318,LCon15722,LRes62700,LRes89654,LFla7024,LDot7145,LRes46229,LCon88145,LRes87914,LGlo76202,LCon50861,LMul56780,LGlo5643,LRes32396,LGRU85329,LCon75339,LAdd77075,LDot86369],["Mul92678","Res21529","Up_74728","Res14697","Max35897","Glo50262","Con86862","Max78902","Res42318","Con15722","Res62700","Res89654","Fla7024","Dot7145","Res46229","Con88145","Res87914","Glo76202","Con50861","Mul56780","Glo5643","Res32396","GRU85329","Con75339","Add77075","Dot86369"],Dot86369,"Dot86369")

Actual (Unparsed): [[4.9020285]]

Expected (Unparsed): [[4.902028549334001]]

Actual:   [[4.9021]]

Expected: [[4.9021]]