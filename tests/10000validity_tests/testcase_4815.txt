import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Cro55365 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Cro55365 = keras.layers.Cropping3D(cropping=((0, 0), (0, 0), (0, 0)), name = 'Cro55365', )(in0Cro55365)
Res1436 = keras.layers.Reshape((2, 2, 2), name = 'Res1436', )(Cro55365)
Res22457 = keras.layers.Reshape((2, 4), name = 'Res22457', )(Res1436)
Sep88392 = keras.layers.SeparableConv1D(3, (2),strides=(2), padding='same', name = 'Sep88392', )(Res22457)
model = tf.keras.models.Model(inputs=[in0Cro55365], outputs=Sep88392)
w = model.get_layer('Sep88392').get_weights() 
w[0] = np.array([[[0.4569], [0.7911], [0.5215], [0.7594]], [[0.7624], [0.7706], [0.853], [0.6973]]])
w[1] = np.array([[[0.6688, 0.1047, 0.2981], [0.6439, 0.8218, 0.1971], [0.6904, 0.8738, 0.9217], [0.2055, 0.2952, 0.6061]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep88392').set_weights(w) 
in0Cro55365 = tf.constant([[[[[1.8111, 1.67]], [[1.4646, 1.6936]]], [[[1.1314, 1.2003]], [[1.2831, 1.2977]]]]])
print (np.array2string(model.predict([in0Cro55365],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sep88392.png')

LCro55365 = cropping3D_layer([[[[[1.8111, 1.67]], [[1.4646, 1.6936]]], [[[1.1314, 1.2003]], [[1.2831, 1.2977]]]]], 0, 0, 0, 0, 0, 0, Cro55365), 
LRes1436 = reshape_layer(Cro55365, [2, 2, 2], Res1436), 
LRes22457 = reshape_layer(Res1436, [2, 4], Res22457), 
LSep88392 = separable_conv1D_layer(Res22457, 2,[[[[0.4569], [0.7911], [0.5215], [0.7594]], [[0.7624], [0.7706], [0.853], [0.6973]]],[[[0.6688, 0.1047, 0.2981], [0.6439, 0.8218, 0.1971], [0.6904, 0.8738, 0.9217], [0.2055, 0.2952, 0.6061]]]],[0, 0, 0], 2, true, Sep88392), 
exec_layers([LCro55365,LRes1436,LRes22457,LSep88392],["Cro55365","Res1436","Res22457","Sep88392"],Sep88392,"Sep88392")

Actual (Unparsed): [[[4.3097792, 4.2933298, 3.9872533]]]

Expected (Unparsed): [[[4.309779191016999,4.293329802909,3.9872533058179997]]]

Actual:   [[[4.3098, 4.2934, 3.9873]]]

Expected: [[[4.3098, 4.2934, 3.9873]]]