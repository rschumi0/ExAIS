import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min48400 = tf.keras.layers.Input(shape=([1, 1]))
in1Min48400 = tf.keras.layers.Input(shape=([1, 1]))
in0Up_10650 = tf.keras.layers.Input(shape=([3, 4, 1]))

Min48400 = keras.layers.Minimum(name = 'Min48400', )([in0Min48400,in1Min48400])
Res12224 = keras.layers.Reshape((1, 1, 1), name = 'Res12224', )(Min48400)
Zer85911 = keras.layers.ZeroPadding2D(padding=((5, 0), (3, 0)), name = 'Zer85911', )(Res12224)
Up_10650 = keras.layers.UpSampling2D(size=(2, 1), name = 'Up_10650', )(in0Up_10650)
Min46608 = keras.layers.Minimum(name = 'Min46608', )([Zer85911,Up_10650])
Thr47547 = keras.layers.ThresholdedReLU(theta=1.465268729420493, name = 'Thr47547', )(Min46608)
model = tf.keras.models.Model(inputs=[in0Min48400,in1Min48400,in0Up_10650], outputs=Thr47547)
in0Min48400 = tf.constant([[[0.4809]]])
in1Min48400 = tf.constant([[[0.267]]])
in0Up_10650 = tf.constant([[[[1.8765], [1.3156], [1.5421], [1.8738]], [[1.7927], [1.3791], [1.0567], [1.4995]], [[1.4467], [1.2232], [1.8739], [1.2724]]]])
print (np.array2string(model.predict([in0Min48400,in1Min48400,in0Up_10650],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr47547.png')

LMin48400 = minimum_layer([[[[0.4809]]], [[[0.267]]]], Min48400), 
LRes12224 = reshape_layer(Min48400, [1, 1, 1], Res12224), 
LZer85911 = zero_padding2D_layer(Res12224, 5, 0, 3, 0, Zer85911), 
LUp_10650 = up_sampling2D_layer([[[[1.8765], [1.3156], [1.5421], [1.8738]], [[1.7927], [1.3791], [1.0567], [1.4995]], [[1.4467], [1.2232], [1.8739], [1.2724]]]], 2, 1, Up_10650), 
LMin46608 = minimum_layer([Zer85911,Up_10650], Min46608), 
LThr47547 = thresholded_relu_layer(Min46608, 1.465268729420493, Thr47547), 
exec_layers([LMin48400,LRes12224,LZer85911,LUp_10650,LMin46608,LThr47547],["Min48400","Res12224","Zer85911","Up_10650","Min46608","Thr47547"],Thr47547,"Thr47547")

Actual (Unparsed): [[[[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]], [[0.0000000], [0.0000000], [0.0000000], [0.0000000]]]]

Expected (Unparsed): [[[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]],[[0],[0],[0],[0]]]]

Actual:   [[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]

Expected: [[[[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]], [[0], [0], [0], [0]]]]