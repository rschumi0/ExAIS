import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sub77910 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub77910 = tf.keras.layers.Input(shape=([3, 3]))

Sub77910 = keras.layers.Subtract(name = 'Sub77910', )([in0Sub77910,in1Sub77910])
PRe98393 = keras.layers.PReLU(name = 'PRe98393', )(Sub77910)
model = tf.keras.models.Model(inputs=[in0Sub77910,in1Sub77910], outputs=PRe98393)
w = model.get_layer('PRe98393').get_weights() 
w[0] = np.array([[0.7973, 0.4583, 0.29], [0.7692, 0.4449, 0.6069], [0.0199, 0.847, 0.8208]])
model.get_layer('PRe98393').set_weights(w) 
in0Sub77910 = tf.constant([[[0.2976, 0.6756, 0.1595], [0.7093, 0.4001, 0.4018], [0.6672, 0.1401, 0.4811]]])
in1Sub77910 = tf.constant([[[0.8978, 0.3534, 0.7815], [0.0684, 0.8601, 0.5812], [0.0695, 0.654, 0.5467]]])
print (np.array2string(model.predict([in0Sub77910,in1Sub77910],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe98393.png')

LSub77910 = subtract_layer([[[0.2976, 0.6756, 0.1595], [0.7093, 0.4001, 0.4018], [0.6672, 0.1401, 0.4811]]], [[[0.8978, 0.3534, 0.7815], [0.0684, 0.8601, 0.5812], [0.0695, 0.654, 0.5467]]], Sub77910), 
LPRe98393 = prelu_layer(Sub77910, [[0.7973, 0.4583, 0.29], [0.7692, 0.4449, 0.6069], [0.0199, 0.847, 0.8208]], PRe98393), 
exec_layers([LSub77910,LPRe98393],["Sub77910","PRe98393"],PRe98393,"PRe98393")

Actual (Unparsed): [[[-0.4785395, 0.3222000, -0.1803800], [0.6409000, -0.2046540, -0.1088779], [0.5977000, -0.4352733, -0.0538445]]]

Expected (Unparsed): [[[-0.4785394600000001,0.3222,-0.18037999999999998],[0.6409,-0.204654,-0.10887786000000003],[0.5977,-0.43527330000000003,-0.053844479999999945]]]

Actual:   [[[-0.4785, 0.3222, -0.1803], [0.6409, -0.2046, -0.1088], [0.5977, -0.4352, -0.0538]]]

Expected: [[[-0.4785, 0.3222, -0.1803], [0.6409, -0.2046, -0.1088], [0.5977, -0.4352, -0.0538]]]