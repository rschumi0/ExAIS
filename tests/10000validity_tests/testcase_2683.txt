import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave99893 = tf.keras.layers.Input(shape=([2, 1]))
in1Ave99893 = tf.keras.layers.Input(shape=([2, 1]))
in0Con43978 = tf.keras.layers.Input(shape=([2, 3, 1]))
in0Max12132 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Max12132 = tf.keras.layers.Input(shape=([1, 2, 2]))

Ave99893 = keras.layers.Average(name = 'Ave99893', )([in0Ave99893,in1Ave99893])
Res15455 = keras.layers.Reshape((2, 1, 1), name = 'Res15455', )(Ave99893)
Zer18437 = keras.layers.ZeroPadding2D(padding=((0, 0), (2, 0)), name = 'Zer18437', )(Res15455)
Con43978 = keras.layers.Concatenate(axis=3, name = 'Con43978', )([Zer18437,in0Con43978])
Max12132 = keras.layers.Maximum(name = 'Max12132', )([in0Max12132,in1Max12132])
Sof23359 = keras.layers.Softmax(axis=1, name = 'Sof23359', )(Max12132)
Zer91430 = keras.layers.ZeroPadding2D(padding=((1, 0), (1, 0)), name = 'Zer91430', )(Sof23359)
Max54797 = keras.layers.Maximum(name = 'Max54797', )([Con43978,Zer91430])
model = tf.keras.models.Model(inputs=[in0Ave99893,in1Ave99893,in0Con43978,in0Max12132,in1Max12132], outputs=Max54797)
in0Ave99893 = tf.constant([[[0.7172], [0.118]]])
in1Ave99893 = tf.constant([[[0.0525], [0.7806]]])
in0Con43978 = tf.constant([[[[0.434], [0.575], [0.6831]], [[0.2772], [0.2429], [0.2408]]]])
in0Max12132 = tf.constant([[[[0.8656, 0.9003], [0.0089, 0.965]]]])
in1Max12132 = tf.constant([[[[0.6279, 0.7914], [0.7576, 0.4353]]]])
print (np.array2string(model.predict([in0Ave99893,in1Ave99893,in0Con43978,in0Max12132,in1Max12132],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max54797.png')

LAve99893 = average_layer([[[[0.7172], [0.118]]], [[[0.0525], [0.7806]]]], Ave99893), 
LRes15455 = reshape_layer(Ave99893, [2, 1, 1], Res15455), 
LZer18437 = zero_padding2D_layer(Res15455, 0, 0, 2, 0, Zer18437), 
LCon43978 = concatenate_layer([Zer18437,[[[[0.434], [0.575], [0.6831]], [[0.2772], [0.2429], [0.2408]]]]], 3, Con43978), 
LMax12132 = maximum_layer([[[[[0.8656, 0.9003], [0.0089, 0.965]]]], [[[[0.6279, 0.7914], [0.7576, 0.4353]]]]], Max12132), 
LSof23359 = softmax_layer(Max12132, 1, Sof23359), 
LZer91430 = zero_padding2D_layer(Sof23359, 1, 0, 1, 0, Zer91430), 
LMax54797 = maximum_layer([Con43978,Zer91430], Max54797), 
exec_layers([LAve99893,LRes15455,LZer18437,LCon43978,LMax12132,LSof23359,LZer91430,LMax54797],["Ave99893","Res15455","Zer18437","Con43978","Max12132","Sof23359","Zer91430","Max54797"],Max54797,"Max54797")

Actual (Unparsed): [[[[0.0000000, 0.4340000], [0.0000000, 0.5750000], [0.3848500, 0.6831000]], [[0.0000000, 0.2772000], [1.0000000, 1.0000000], [1.0000000, 1.0000000]]]]

Expected (Unparsed): [[[[0,0.434],[0,0.575],[0.38484999999999997,0.6831]],[[0,0.2772],[1.0,1.0],[1.0,1.0]]]]

Actual:   [[[[0, 0.434], [0, 0.575], [0.3849, 0.6831]], [[0, 0.2772], [1, 1], [1, 1]]]]

Expected: [[[[0, 0.434], [0, 0.575], [0.3849, 0.6831]], [[0, 0.2772], [1, 1], [1, 1]]]]