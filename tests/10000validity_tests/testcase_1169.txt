import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul9492 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Mul9492 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Mul97865 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Mul97865 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Ave49045 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in1Ave49045 = tf.keras.layers.Input(shape=([1, 1, 2, 1]))
in0Per13753 = tf.keras.layers.Input(shape=([4, 1]))
in0Con87678 = tf.keras.layers.Input(shape=([1]))
in0Con28062 = tf.keras.layers.Input(shape=([2, 1]))

Mul9492 = keras.layers.Multiply(name = 'Mul9492', )([in0Mul9492,in1Mul9492])
Res59793 = keras.layers.Reshape((2, 2), name = 'Res59793', )(Mul9492)
Mul97865 = keras.layers.Multiply(name = 'Mul97865', )([in0Mul97865,in1Mul97865])
Res44921 = keras.layers.Reshape((2, 1), name = 'Res44921', )(Mul97865)
Ave49045 = keras.layers.Average(name = 'Ave49045', )([in0Ave49045,in1Ave49045])
Res58764 = keras.layers.Reshape((1, 1, 2), name = 'Res58764', )(Ave49045)
Res62377 = keras.layers.Reshape((1, 2), name = 'Res62377', )(Res58764)
Fla1985 = keras.layers.Flatten(name = 'Fla1985', )(Res62377)
Per13753 = keras.layers.Permute((1,2), name = 'Per13753',)(in0Per13753)
Glo733 = keras.layers.GlobalAveragePooling1D(name = 'Glo733', )(Per13753)
Con87678 = keras.layers.Concatenate(axis=1, name = 'Con87678', )([Glo733,in0Con87678])
Mul31941 = keras.layers.Multiply(name = 'Mul31941', )([Fla1985,Con87678])
Res66328 = keras.layers.Reshape((2, 1), name = 'Res66328', )(Mul31941)
Min41922 = keras.layers.Minimum(name = 'Min41922', )([Res44921,Res66328])
Con28062 = keras.layers.Concatenate(axis=2, name = 'Con28062', )([Min41922,in0Con28062])
Ave24669 = keras.layers.Average(name = 'Ave24669', )([Res59793,Con28062])
model = tf.keras.models.Model(inputs=[in0Mul9492,in1Mul9492,in0Mul97865,in1Mul97865,in0Ave49045,in1Ave49045,in0Per13753,in0Con87678,in0Con28062], outputs=Ave24669)
in0Mul9492 = tf.constant([[[[0.1398, 0.4104]], [[0.47, 0.3002]]]])
in1Mul9492 = tf.constant([[[[0.7389, 0.6678]], [[0.5146, 0.3702]]]])
in0Mul97865 = tf.constant([[[[0.2809]], [[0.1936]]]])
in1Mul97865 = tf.constant([[[[0.8531]], [[0.371]]]])
in0Ave49045 = tf.constant([[[[[0.4112], [0.5266]]]]])
in1Ave49045 = tf.constant([[[[[0.2596], [0.349]]]]])
in0Per13753 = tf.constant([[[1.6461], [1.6393], [1.675], [1.7291]]])
in0Con87678 = tf.constant([[0.8409]])
in0Con28062 = tf.constant([[[0.1028], [0.9424]]])
print (np.array2string(model.predict([in0Mul9492,in1Mul9492,in0Mul97865,in1Mul97865,in0Ave49045,in1Ave49045,in0Per13753,in0Con87678,in0Con28062],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave24669.png')

LMul9492 = multiply_layer([[[[[0.1398, 0.4104]], [[0.47, 0.3002]]]], [[[[0.7389, 0.6678]], [[0.5146, 0.3702]]]]], Mul9492), 
LRes59793 = reshape_layer(Mul9492, [2, 2], Res59793), 
LMul97865 = multiply_layer([[[[[0.2809]], [[0.1936]]]], [[[[0.8531]], [[0.371]]]]], Mul97865), 
LRes44921 = reshape_layer(Mul97865, [2, 1], Res44921), 
LAve49045 = average_layer([[[[[[0.4112], [0.5266]]]]], [[[[[0.2596], [0.349]]]]]], Ave49045), 
LRes58764 = reshape_layer(Ave49045, [1, 1, 2], Res58764), 
LRes62377 = reshape_layer(Res58764, [1, 2], Res62377), 
LFla1985 = flatten_layer(Res62377, Fla1985), 
LPer13753 = permute_layer([[[1.6461], [1.6393], [1.675], [1.7291]]], 1,2, Per13753), 
LGlo733 = global_average_pooling1D_layer(Per13753, Glo733), 
LCon87678 = concatenate_layer([Glo733,[[0.8409]]], 1, Con87678), 
LMul31941 = multiply_layer([Fla1985,Con87678], Mul31941), 
LRes66328 = reshape_layer(Mul31941, [2, 1], Res66328), 
LMin41922 = minimum_layer([Res44921,Res66328], Min41922), 
LCon28062 = concatenate_layer([Min41922,[[[0.1028], [0.9424]]]], 2, Con28062), 
LAve24669 = average_layer([Res59793,Con28062], Ave24669), 
exec_layers([LMul9492,LRes59793,LMul97865,LRes44921,LAve49045,LRes58764,LRes62377,LFla1985,LPer13753,LGlo733,LCon87678,LMul31941,LRes66328,LMin41922,LCon28062,LAve24669],["Mul9492","Res59793","Mul97865","Res44921","Ave49045","Res58764","Res62377","Fla1985","Per13753","Glo733","Con87678","Mul31941","Res66328","Min41922","Con28062","Ave24669"],Ave24669,"Ave24669")

Actual (Unparsed): [[[0.1714670, 0.1884326], [0.1568438, 0.5267670]]]

Expected (Unparsed): [[[0.171467005,0.18843256],[0.15684379999999998,0.52676702]]]

Actual:   [[[0.1715, 0.1885], [0.1569, 0.5268]]]

Expected: [[[0.1715, 0.1885], [0.1569, 0.5268]]]