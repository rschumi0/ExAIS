import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add3289 = tf.keras.layers.Input(shape=([2, 1]))
in1Add3289 = tf.keras.layers.Input(shape=([2, 1]))

Add3289 = keras.layers.Add(name = 'Add3289', )([in0Add3289,in1Add3289])
Res36199 = keras.layers.Reshape((2, 1, 1), name = 'Res36199', )(Add3289)
Cro7225 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro7225', )(Res36199)
Res13120 = keras.layers.Reshape((1, 1), name = 'Res13120', )(Cro7225)
Loc85888 = keras.layers.LocallyConnected1D(2, (1),strides=(1), name = 'Loc85888', )(Res13120)
Res34963 = keras.layers.Reshape((1, 2, 1), name = 'Res34963', )(Loc85888)
Ave23595 = keras.layers.AveragePooling2D(pool_size=(1, 2), name = 'Ave23595', )(Res34963)
model = tf.keras.models.Model(inputs=[in0Add3289,in1Add3289], outputs=Ave23595)
w = model.get_layer('Loc85888').get_weights() 
w[0] = np.array([[[0.6386, 0.6426]]])
w[1] = np.array([[0, 0]])
model.get_layer('Loc85888').set_weights(w) 
in0Add3289 = tf.constant([[[0.9627], [0.7767]]])
in1Add3289 = tf.constant([[[0.8252], [0.4481]]])
print (np.array2string(model.predict([in0Add3289,in1Add3289],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave23595.png')

LAdd3289 = add_layer([[[[0.9627], [0.7767]]], [[[0.8252], [0.4481]]]], Add3289), 
LRes36199 = reshape_layer(Add3289, [2, 1, 1], Res36199), 
LCro7225 = cropping2D_layer(Res36199, 1, 0, 0, 0, Cro7225), 
LRes13120 = reshape_layer(Cro7225, [1, 1], Res13120), 
LLoc85888 = locally_connected1D_layer(Res13120, 1,[[[0.6386, 0.6426]]],[[0, 0]], 1, Loc85888), 
LRes34963 = reshape_layer(Loc85888, [1, 2, 1], Res34963), 
LAve23595 = average_pooling2D_layer(Res34963, 1, 2, Ave23595), 
exec_layers([LAdd3289,LRes36199,LCro7225,LRes13120,LLoc85888,LRes34963,LAve23595],["Add3289","Res36199","Cro7225","Res13120","Loc85888","Res34963","Ave23595"],Ave23595,"Ave23595")

Actual (Unparsed): [[[[0.7846069]]]]

Expected (Unparsed): [[[[0.7846068799999999]]]]

Actual:   [[[[0.7847]]]]

Expected: [[[[0.7847]]]]