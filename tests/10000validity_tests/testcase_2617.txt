import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con61872 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot3478 = tf.keras.layers.Input(shape=([2]))
in1Dot3478 = tf.keras.layers.Input(shape=([2]))
in0Con79955 = tf.keras.layers.Input(shape=([2]))
in0Sub53472 = tf.keras.layers.Input(shape=([3]))
in1Sub53472 = tf.keras.layers.Input(shape=([3]))
in0Con99308 = tf.keras.layers.Input(shape=([1]))
in0Sub85630 = tf.keras.layers.Input(shape=([2]))
in1Sub85630 = tf.keras.layers.Input(shape=([2]))
in0Con28713 = tf.keras.layers.Input(shape=([3]))

Con61872 = keras.layers.Conv1D(4, (1),strides=(1), padding='valid', dilation_rate=(1), name = 'Con61872', )(in0Con61872)
Fla82707 = keras.layers.Flatten(name = 'Fla82707', )(Con61872)
Dot3478 = keras.layers.Dot(axes=(1, 1), name = 'Dot3478', )([in0Dot3478,in1Dot3478])
Con79955 = keras.layers.Concatenate(axis=1, name = 'Con79955', )([Dot3478,in0Con79955])
Sub53472 = keras.layers.Subtract(name = 'Sub53472', )([in0Sub53472,in1Sub53472])
Max1113 = keras.layers.Maximum(name = 'Max1113', )([Con79955,Sub53472])
Con99308 = keras.layers.Concatenate(axis=1, name = 'Con99308', )([Max1113,in0Con99308])
Max70439 = keras.layers.Maximum(name = 'Max70439', )([Fla82707,Con99308])
Sub85630 = keras.layers.Subtract(name = 'Sub85630', )([in0Sub85630,in1Sub85630])
Res49182 = keras.layers.Reshape((2, 1), name = 'Res49182', )(Sub85630)
Glo26106 = keras.layers.GlobalMaxPool1D(name = 'Glo26106', )(Res49182)
Con28713 = keras.layers.Concatenate(axis=1, name = 'Con28713', )([Glo26106,in0Con28713])
Ave82759 = keras.layers.Average(name = 'Ave82759', )([Max70439,Con28713])
model = tf.keras.models.Model(inputs=[in0Con61872,in0Dot3478,in1Dot3478,in0Con79955,in0Sub53472,in1Sub53472,in0Con99308,in0Sub85630,in1Sub85630,in0Con28713], outputs=Ave82759)
w = model.get_layer('Con61872').get_weights() 
w[0] = np.array([[[0.2756, 0.505, 0.5574, 0.428]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con61872').set_weights(w) 
in0Con61872 = tf.constant([[[0.3146]]])
in0Dot3478 = tf.constant([[0.0757, 0.0372]])
in1Dot3478 = tf.constant([[0.0146, 0.9898]])
in0Con79955 = tf.constant([[0.5243, 0.0069]])
in0Sub53472 = tf.constant([[0.449, 0.1249, 0.1361]])
in1Sub53472 = tf.constant([[0.824, 0.9973, 0.5059]])
in0Con99308 = tf.constant([[0.9529]])
in0Sub85630 = tf.constant([[0.8198, 0.9784]])
in1Sub85630 = tf.constant([[0.3199, 0.6933]])
in0Con28713 = tf.constant([[0.9678, 0.9035, 0.1356]])
print (np.array2string(model.predict([in0Con61872,in0Dot3478,in1Dot3478,in0Con79955,in0Sub53472,in1Sub53472,in0Con99308,in0Sub85630,in1Sub85630,in0Con28713],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave82759.png')

LCon61872 = conv1D_layer([[[0.3146]]], 1,[[[0.2756, 0.505, 0.5574, 0.428]]],[0, 0, 0, 0], 1, false, 1, Con61872), 
LFla82707 = flatten_layer(Con61872, Fla82707), 
LDot3478 = dot_layer([[0.0757, 0.0372]], [[0.0146, 0.9898]], 1, 1, Dot3478), 
LCon79955 = concatenate_layer([Dot3478,[[0.5243, 0.0069]]], 1, Con79955), 
LSub53472 = subtract_layer([[0.449, 0.1249, 0.1361]], [[0.824, 0.9973, 0.5059]], Sub53472), 
LMax1113 = maximum_layer([Con79955,Sub53472], Max1113), 
LCon99308 = concatenate_layer([Max1113,[[0.9529]]], 1, Con99308), 
LMax70439 = maximum_layer([Fla82707,Con99308], Max70439), 
LSub85630 = subtract_layer([[0.8198, 0.9784]], [[0.3199, 0.6933]], Sub85630), 
LRes49182 = reshape_layer(Sub85630, [2, 1], Res49182), 
LGlo26106 = global_max_pool1D_layer(Res49182, Glo26106), 
LCon28713 = concatenate_layer([Glo26106,[[0.9678, 0.9035, 0.1356]]], 1, Con28713), 
LAve82759 = average_layer([Max70439,Con28713], Ave82759), 
exec_layers([LCon61872,LFla82707,LDot3478,LCon79955,LSub53472,LMax1113,LCon99308,LMax70439,LSub85630,LRes49182,LGlo26106,LCon28713,LAve82759],["Con61872","Fla82707","Dot3478","Con79955","Sub53472","Max1113","Con99308","Max70439","Sub85630","Res49182","Glo26106","Con28713","Ave82759"],Ave82759,"Ave82759")

Actual (Unparsed): [[0.2933019, 0.7460500, 0.5394290, 0.5442500]]

Expected (Unparsed): [[0.29330187999999996,0.74605,0.53942902,0.54425]]

Actual:   [[0.2934, 0.7461, 0.5395, 0.5443]]

Expected: [[0.2934, 0.7461, 0.5395, 0.5443]]