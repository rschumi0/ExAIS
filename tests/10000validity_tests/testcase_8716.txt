import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min6972 = tf.keras.layers.Input(shape=([1, 1]))
in1Min6972 = tf.keras.layers.Input(shape=([1, 1]))
in0Con5255 = tf.keras.layers.Input(shape=([1, 3]))
in0Min85820 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in1Min85820 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))

Min6972 = keras.layers.Minimum(name = 'Min6972', )([in0Min6972,in1Min6972])
Thr916 = keras.layers.ThresholdedReLU(theta=3.1323651611451235, name = 'Thr916', )(Min6972)
Con5255 = keras.layers.Concatenate(axis=2, name = 'Con5255', )([Thr916,in0Con5255])
Min85820 = keras.layers.Minimum(name = 'Min85820', )([in0Min85820,in1Min85820])
Res9795 = keras.layers.Reshape((1, 2, 2), name = 'Res9795', )(Min85820)
Res98245 = keras.layers.Reshape((1, 4), name = 'Res98245', )(Res9795)
Per89709 = keras.layers.Permute((1,2), name = 'Per89709',)(Res98245)
Min98193 = keras.layers.Minimum(name = 'Min98193', )([Con5255,Per89709])
model = tf.keras.models.Model(inputs=[in0Min6972,in1Min6972,in0Con5255,in0Min85820,in1Min85820], outputs=Min98193)
in0Min6972 = tf.constant([[[0.5066]]])
in1Min6972 = tf.constant([[[0.4054]]])
in0Con5255 = tf.constant([[[0.9547, 0.5992, 0.2701]]])
in0Min85820 = tf.constant([[[[[0.9028], [0.4914]], [[0.544], [0.501]]]]])
in1Min85820 = tf.constant([[[[[0.7876], [0.6273]], [[0.0205], [0.0227]]]]])
print (np.array2string(model.predict([in0Min6972,in1Min6972,in0Con5255,in0Min85820,in1Min85820],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min98193.png')

LMin6972 = minimum_layer([[[[0.5066]]], [[[0.4054]]]], Min6972), 
LThr916 = thresholded_relu_layer(Min6972, 3.1323651611451235, Thr916), 
LCon5255 = concatenate_layer([Thr916,[[[0.9547, 0.5992, 0.2701]]]], 2, Con5255), 
LMin85820 = minimum_layer([[[[[[0.9028], [0.4914]], [[0.544], [0.501]]]]], [[[[[0.7876], [0.6273]], [[0.0205], [0.0227]]]]]], Min85820), 
LRes9795 = reshape_layer(Min85820, [1, 2, 2], Res9795), 
LRes98245 = reshape_layer(Res9795, [1, 4], Res98245), 
LPer89709 = permute_layer(Res98245, 1,2, Per89709), 
LMin98193 = minimum_layer([Con5255,Per89709], Min98193), 
exec_layers([LMin6972,LThr916,LCon5255,LMin85820,LRes9795,LRes98245,LPer89709,LMin98193],["Min6972","Thr916","Con5255","Min85820","Res9795","Res98245","Per89709","Min98193"],Min98193,"Min98193")

Actual (Unparsed): [[[0.0000000, 0.4914000, 0.0205000, 0.0227000]]]

Expected (Unparsed): [[[0,0.4914,0.0205,0.0227]]]

Actual:   [[[0, 0.4914, 0.0205, 0.0227]]]

Expected: [[[0, 0.4914, 0.0205, 0.0227]]]