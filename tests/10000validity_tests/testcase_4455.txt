import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Den1563 = tf.keras.layers.Input(shape=([2, 4, 2]))

Den1563 = keras.layers.Dense(2,name = 'Den1563', )(in0Den1563)
Res83923 = keras.layers.Reshape((2, 8), name = 'Res83923', )(Den1563)
LST54255 = keras.layers.LSTM(1,recurrent_activation='sigmoid', name = 'LST54255', )(Res83923)
Res64606 = keras.layers.Reshape((1, 1), name = 'Res64606', )(LST54255)
Glo79257 = keras.layers.GlobalAveragePooling1D(name = 'Glo79257', )(Res64606)
Thr47264 = keras.layers.ThresholdedReLU(theta=9.772487729279781, name = 'Thr47264', )(Glo79257)
model = tf.keras.models.Model(inputs=[in0Den1563], outputs=Thr47264)
w = model.get_layer('Den1563').get_weights() 
w[0] = np.array([[0.8835, 0.9096], [0.788, 0.2015]])
w[1] = np.array([0.754, 0.9878])
model.get_layer('Den1563').set_weights(w) 
w = model.get_layer('LST54255').get_weights() 
w[0] = np.array([[2, 3, 1, 2], [9, 2, 6, 4], [4, 7, 9, 6], [3, 5, 6, 8], [1, 5, 7, 1], [2, 10, 2, 7], [3, 10, 9, 6], [3, 3, 10, 1]])
w[1] = np.array([[5, 5, 10, 10]])
w[2] = np.array([3, 2, 6, 5])
model.get_layer('LST54255').set_weights(w) 
in0Den1563 = tf.constant([[[[0.6305, 0.1078], [0.6351, 0.9155], [0.0285, 0.7774], [0.4769, 0.1489]], [[0.5743, 0.3402], [0.2199, 0.3767], [0.092, 0.9715], [0.1543, 0.0989]]]])
print (np.array2string(model.predict([in0Den1563],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Thr47264.png')

LDen1563 = dense_layer([[[[0.6305, 0.1078], [0.6351, 0.9155], [0.0285, 0.7774], [0.4769, 0.1489]], [[0.5743, 0.3402], [0.2199, 0.3767], [0.092, 0.9715], [0.1543, 0.0989]]]], [[0.8835, 0.9096], [0.788, 0.2015]],[0.754, 0.9878], Den1563), 
LRes83923 = reshape_layer(Den1563, [2, 8], Res83923), 
LLST54255 = lstm_layer(Res83923,[[2, 3, 1, 2], [9, 2, 6, 4], [4, 7, 9, 6], [3, 5, 6, 8], [1, 5, 7, 1], [2, 10, 2, 7], [3, 10, 9, 6], [3, 3, 10, 1]],[[5, 5, 10, 10]],[3, 2, 6, 5], LST54255), 
LRes64606 = reshape_layer(LST54255, [1, 1], Res64606), 
LGlo79257 = global_average_pooling1D_layer(Res64606, Glo79257), 
LThr47264 = thresholded_relu_layer(Glo79257, 9.772487729279781, Thr47264), 
exec_layers([LDen1563,LRes83923,LLST54255,LRes64606,LGlo79257,LThr47264],["Den1563","Res83923","LST54255","Res64606","Glo79257","Thr47264"],Thr47264,"Thr47264")

Actual (Unparsed): [[0.0000000]]

Expected (Unparsed): [[0]]

Actual:   [[0]]

Expected: [[0]]