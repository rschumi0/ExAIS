import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min68155 = tf.keras.layers.Input(shape=([1, 1]))
in1Min68155 = tf.keras.layers.Input(shape=([1, 1]))
in0Con16813 = tf.keras.layers.Input(shape=([2, 2, 1, 3]))
in0Con16879 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in0Glo22897 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con17407 = tf.keras.layers.Input(shape=([14]))

Min68155 = keras.layers.Minimum(name = 'Min68155', )([in0Min68155,in1Min68155])
Res14449 = keras.layers.Reshape((1, 1, 1), name = 'Res14449', )(Min68155)
Res63206 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res63206', )(Res14449)
Zer81489 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (0, 0)), name = 'Zer81489', )(Res63206)
Con16813 = keras.layers.Concatenate(axis=4, name = 'Con16813', )([Zer81489,in0Con16813])
Con16879 = keras.layers.Conv3D(4, (1, 2, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con16879', )(in0Con16879)
Min36267 = keras.layers.Minimum(name = 'Min36267', )([Con16813,Con16879])
Res20227 = keras.layers.Reshape((2, 2, 4), name = 'Res20227', )(Min36267)
Res19320 = keras.layers.Reshape((2, 8), name = 'Res19320', )(Res20227)
Fla69641 = keras.layers.Flatten(name = 'Fla69641', )(Res19320)
Glo22897 = keras.layers.GlobalMaxPool2D(name = 'Glo22897', )(in0Glo22897)
Con17407 = keras.layers.Concatenate(axis=1, name = 'Con17407', )([Glo22897,in0Con17407])
Add11118 = keras.layers.Add(name = 'Add11118', )([Fla69641,Con17407])
model = tf.keras.models.Model(inputs=[in0Min68155,in1Min68155,in0Con16813,in0Con16879,in0Glo22897,in0Con17407], outputs=Add11118)
w = model.get_layer('Con16879').get_weights() 
w[0] = np.array([[[[[0.4852, 0.3245, 0.0517, 0.0086], [0.8828, 0.4989, 0.3044, 0.5373]]], [[[0.6447, 0.5224, 0.3565, 0.1909], [0.0509, 0.1762, 0.51, 0.3751]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con16879').set_weights(w) 
in0Min68155 = tf.constant([[[0.4373]]])
in1Min68155 = tf.constant([[[0.9053]]])
in0Con16813 = tf.constant([[[[[0.6316, 0.0553, 0.3674]], [[0.5239, 0.2887, 0.2752]]], [[[0.3841, 0.764, 0.4636]], [[0.8439, 0.8663, 0.3781]]]]])
in0Con16879 = tf.constant([[[[[0.6811, 0.5383]], [[0.0685, 0.6522]]], [[[0.8306, 0.4676]], [[0.7735, 0.6388]]]]])
in0Glo22897 = tf.constant([[[[1.3194, 1.5432]], [[1.4466, 1.7238]]]])
in0Con17407 = tf.constant([[0.8226, 0.871, 0.7684, 0.7419, 0.8633, 0.3974, 0.5087, 0.9652, 0.0504, 0.3137, 0.5754, 0.5494, 0.7533, 0.8923]])
print (np.array2string(model.predict([in0Min68155,in1Min68155,in0Con16813,in0Con16879,in0Glo22897,in0Con17407],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add11118.png')

LMin68155 = minimum_layer([[[[0.4373]]], [[[0.9053]]]], Min68155), 
LRes14449 = reshape_layer(Min68155, [1, 1, 1], Res14449), 
LRes63206 = reshape_layer(Res14449, [1, 1, 1, 1], Res63206), 
LZer81489 = zero_padding3D_layer(Res63206, 1, 0, 1, 0, 0, 0, Zer81489), 
LCon16813 = concatenate_layer([Zer81489,[[[[[0.6316, 0.0553, 0.3674]], [[0.5239, 0.2887, 0.2752]]], [[[0.3841, 0.764, 0.4636]], [[0.8439, 0.8663, 0.3781]]]]]], 4, Con16813), 
LCon16879 = conv3D_layer([[[[[0.6811, 0.5383]], [[0.0685, 0.6522]]], [[[0.8306, 0.4676]], [[0.7735, 0.6388]]]]], 1, 2, 1,[[[[[0.4852, 0.3245, 0.0517, 0.0086], [0.8828, 0.4989, 0.3044, 0.5373]]], [[[0.6447, 0.5224, 0.3565, 0.1909], [0.0509, 0.1762, 0.51, 0.3751]]]]],[0, 0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con16879), 
LMin36267 = minimum_layer([Con16813,Con16879], Min36267), 
LRes20227 = reshape_layer(Min36267, [2, 2, 4], Res20227), 
LRes19320 = reshape_layer(Res20227, [2, 8], Res19320), 
LFla69641 = flatten_layer(Res19320, Fla69641), 
LGlo22897 = global_max_pool2D_layer([[[[1.3194, 1.5432]], [[1.4466, 1.7238]]]], Glo22897), 
LCon17407 = concatenate_layer([Glo22897,[[0.8226, 0.871, 0.7684, 0.7419, 0.8633, 0.3974, 0.5087, 0.9652, 0.0504, 0.3137, 0.5754, 0.5494, 0.7533, 0.8923]]], 1, Con17407), 
LAdd11118 = add_layer([Fla69641,Con17407], Add11118), 
exec_layers([LMin68155,LRes14449,LRes63206,LZer81489,LCon16813,LCon16879,LMin36267,LRes20227,LRes19320,LFla69641,LGlo22897,LCon17407,LAdd11118],["Min68155","Res14449","Res63206","Zer81489","Con16813","Con16879","Min36267","Res20227","Res19320","Fla69641","Glo22897","Con17407","Add11118"],Add11118,"Add11118")

Actual (Unparsed): [[1.4466000, 2.3554000, 0.8779000, 1.2384000, 0.7684000, 1.0895108, 1.0653712, 0.6726000, 0.5087000, 1.3493000, 0.8144000, 0.7773000, 1.0127000, 1.1190981, 0.9877407, 1.2421794]]

Expected (Unparsed): [[1.4466,2.3554,0.8779,1.2384,0.7684,1.08951083,1.06537113,0.6726,0.5087,1.3493,0.8144,0.7773,1.0127000000000002,1.1190980700000002,0.98774067,1.24217934]]

Actual:   [[1.4466, 2.3554, 0.8779, 1.2384, 0.7684, 1.0896, 1.0654, 0.6726, 0.5087, 1.3493, 0.8144, 0.7773, 1.0127, 1.1191, 0.9878, 1.2422]]

Expected: [[1.4466, 2.3554, 0.8779, 1.2384, 0.7684, 1.0896, 1.0654, 0.6726, 0.5087, 1.3493, 0.8144, 0.7773, 1.0128, 1.1191, 0.9878, 1.2422]]