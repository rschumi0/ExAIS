import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sof93672 = tf.keras.layers.Input(shape=([2, 1]))
in0Con35780 = tf.keras.layers.Input(shape=([1, 4]))
in0Min51155 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Min51155 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in0Con8412 = tf.keras.layers.Input(shape=([1, 12]))
in0Dot83638 = tf.keras.layers.Input(shape=([3, 3]))
in1Dot83638 = tf.keras.layers.Input(shape=([3, 3]))
in0Con17708 = tf.keras.layers.Input(shape=([3, 1, 4, 3]))
in0Sub16813 = tf.keras.layers.Input(shape=([3, 3, 3, 3]))
in1Sub16813 = tf.keras.layers.Input(shape=([3, 3, 3, 3]))

Sof93672 = keras.layers.Softmax(axis=1, name = 'Sof93672', input_shape=(2, 1))(in0Sof93672)
Glo29015 = keras.layers.GlobalAveragePooling1D(name = 'Glo29015', )(Sof93672)
Res34791 = keras.layers.Reshape((1, 1), name = 'Res34791', )(Glo29015)
Con35780 = keras.layers.Concatenate(axis=2, name = 'Con35780', )([Res34791,in0Con35780])
Min51155 = keras.layers.Minimum(name = 'Min51155', )([in0Min51155,in1Min51155])
Res85265 = keras.layers.Reshape((2, 2, 2), name = 'Res85265', )(Min51155)
Loc32556 = keras.layers.LocallyConnected2D(4, (2, 2),strides=(1, 1), name = 'Loc32556', )(Res85265)
ReL609 = keras.layers.ReLU(max_value=8.081397561740703, negative_slope=7.08038975071575, threshold=8.051825539554105, name = 'ReL609', )(Loc32556)
Res72277 = keras.layers.Reshape((1, 4), name = 'Res72277', )(ReL609)
Con8412 = keras.layers.Concatenate(axis=2, name = 'Con8412', )([Res72277,in0Con8412])
Dot83638 = keras.layers.Dot(axes=(1, 2), name = 'Dot83638', )([in0Dot83638,in1Dot83638])
Res48129 = keras.layers.Reshape((3, 3, 1), name = 'Res48129', )(Dot83638)
Loc75804 = keras.layers.LocallyConnected2D(4, (1, 3),strides=(1, 1), name = 'Loc75804', )(Res48129)
Res23413 = keras.layers.Reshape((3, 1, 4, 1), name = 'Res23413', )(Loc75804)
Con17708 = keras.layers.Concatenate(axis=4, name = 'Con17708', )([Res23413,in0Con17708])
Sub16813 = keras.layers.Subtract(name = 'Sub16813', )([in0Sub16813,in1Sub16813])
Con65423 = keras.layers.Conv3D(4, (3, 2, 1),strides=(1, 9, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con65423', )(Sub16813)
Zer13192 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (1, 0)), name = 'Zer13192', )(Con65423)
Min89392 = keras.layers.Minimum(name = 'Min89392', )([Con17708,Zer13192])
Res89540 = keras.layers.Reshape((3, 1, 16), name = 'Res89540', )(Min89392)
Res19910 = keras.layers.Reshape((3, 16), name = 'Res19910', )(Res89540)
Zer69369 = keras.layers.ZeroPadding1D(padding=((2, 0)), name = 'Zer69369', )(Res19910)
Dot32189 = keras.layers.Dot(axes=(2, 2), name = 'Dot32189', )([Con8412,Zer69369])
Sub82364 = keras.layers.Subtract(name = 'Sub82364', )([Con35780,Dot32189])
model = tf.keras.models.Model(inputs=[in0Sof93672,in0Con35780,in0Min51155,in1Min51155,in0Con8412,in0Dot83638,in1Dot83638,in0Con17708,in0Sub16813,in1Sub16813], outputs=Sub82364)
w = model.get_layer('Loc32556').get_weights() 
w[0] = np.array([[[0.5198, 0.5819, 0.3148, 0.8942], [0.9115, 0.4758, 0.1546, 0.8106], [0.9625, 0.2427, 0.8658, 0.7344], [0.3919, 0.8938, 0.6921, 0.9853], [0.8929, 0.5401, 0.2905, 0.18], [0.3429, 0.0405, 0.2345, 0.1891], [0.7857, 0.1433, 0.4602, 0.7459], [0.9115, 0.4899, 0.7503, 0.9343]]])
w[1] = np.array([[[0, 0, 0, 0]]])
model.get_layer('Loc32556').set_weights(w) 
w = model.get_layer('Loc75804').get_weights() 
w[0] = np.array([[[0.6997, 0.5276, 0.6544, 0.0672], [0.4393, 0.4455, 0.8775, 0.699], [0.737, 0.4154, 0.1688, 0.43]], [[0.9453, 0.7901, 0.9324, 0.721], [0.8129, 0.4868, 0.6316, 0.1813], [0.4269, 0.4567, 0.5983, 0.8226]], [[0.9329, 0.5568, 0.4649, 0.0725], [0.7977, 0.1861, 0.7923, 0.5229], [0.8834, 0.9727, 0.8712, 0.8297]]])
w[1] = np.array([[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]])
model.get_layer('Loc75804').set_weights(w) 
w = model.get_layer('Con65423').get_weights() 
w[0] = np.array([[[[[0.7108, 0.2333, 0.9086, 0.0978], [0.176, 0.5364, 0.8138, 0.8137], [0.6089, 0.5295, 0.4358, 0.8919]]], [[[0.5028, 0.3219, 1, 0.6337], [0.6216, 0.2948, 0.1631, 0.5273], [0.2345, 0.4156, 0.0686, 0.8272]]]], [[[[0.4537, 0.1167, 0.362, 0.0252], [0.8132, 0.3565, 0.6761, 0.304], [0.3281, 0.336, 0.5281, 0.3709]]], [[[0.2746, 0.3582, 0.3992, 0.0361], [0.8469, 0.487, 0.0083, 0.5227], [0.6599, 0.986, 0.4388, 0.7726]]]], [[[[0.7942, 0.9996, 0.8245, 0.9474], [0.7072, 0.5775, 0.7648, 0.916], [0.8705, 0.9355, 0.4967, 0.7638]]], [[[0.4382, 0.7988, 0.1289, 0.2664], [0.5963, 0.7764, 0.914, 0.8264], [0.5008, 0.9821, 0.6206, 0.5902]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con65423').set_weights(w) 
in0Sof93672 = tf.constant([[[0.4842], [0.0774]]])
in0Con35780 = tf.constant([[[0.0758, 0.2381, 0.6953, 0.5839]]])
in0Min51155 = tf.constant([[[[[0.6557], [0.959]], [[0.4181], [0.4689]]], [[[0.6515], [0.7349]], [[0.9321], [0.3718]]]]])
in1Min51155 = tf.constant([[[[[0.4304], [0.2304]], [[0.8293], [0.7184]]], [[[0.2716], [0.5845]], [[0.7795], [0.8352]]]]])
in0Con8412 = tf.constant([[[0.3401, 0.7603, 0.915, 0.5232, 0.7549, 0.5339, 0.105, 0.2185, 0.3797, 0.0391, 0.3697, 0.5613]]])
in0Dot83638 = tf.constant([[[0.4764, 0.9199, 0.8454], [0.732, 0.4349, 0.4216], [0.092, 0.6498, 0.3867]]])
in1Dot83638 = tf.constant([[[0.2339, 0.2521, 0.1967], [0.5894, 0.9447, 0.1951], [0.6269, 0.5927, 0.9717]]])
in0Con17708 = tf.constant([[[[[0.1553, 0.6116, 0.2744], [0.0989, 0.8685, 0.4427], [0.4873, 0.8654, 0.2147], [0.5054, 0.3104, 0.2323]]], [[[0.0371, 0.4101, 0.3812], [0.2841, 0.2091, 0.6521], [0.5967, 0.4465, 0.536], [0.9989, 0.5413, 0.5782]]], [[[0.3096, 0.291, 0.1346], [0.3638, 0.2273, 0.9884], [0.0914, 0.3356, 0.1619], [0.609, 0.707, 0.4323]]]]])
in0Sub16813 = tf.constant([[[[[0.3843, 0.9457, 0.4524], [0.1308, 0.5965, 0.5621], [0.0133, 0.0236, 0.9258]], [[0.1496, 0.8394, 0.6578], [0.496, 0.2283, 0.9762], [0.8865, 0.3677, 0.7329]], [[0.494, 0.8386, 0.8378], [0.4944, 0.6786, 0.4987], [0.7073, 0.13, 0.8109]]], [[[0.9938, 0.1144, 0.3092], [0.7097, 0.9431, 0.2211], [0.7441, 0.5986, 0.4367]], [[0.3783, 0.5382, 0.402], [0.8219, 0.3919, 0.7206], [0.2755, 0.499, 0.1682]], [[0.8905, 0.0327, 0.3513], [0.3232, 0.9012, 0.1431], [0.2709, 0.3078, 0.4268]]], [[[0.1436, 0.4785, 0.2238], [0.0685, 0.6331, 0.9821], [0.7823, 0.3834, 0.5]], [[0.5712, 0.7918, 0.8478], [0.6701, 0.2001, 0.1524], [0.3033, 0.457, 0.4803]], [[0.5833, 0.8766, 0.5467], [0.2701, 0.2096, 0.7113], [0.7541, 0.0271, 0.696]]]]])
in1Sub16813 = tf.constant([[[[[0.107, 0.9542, 0.674], [0.833, 0.8208, 0.0059], [0.2146, 0.3491, 0.3528]], [[0.0646, 0.2333, 0.2526], [0.0131, 0.4105, 0.7157], [0.1942, 0.4461, 0.8065]], [[0.3312, 0.176, 0.074], [0.4433, 0.4369, 0.4361], [0.6151, 0.7319, 0.5809]]], [[[0.4871, 0.4289, 0.5565], [0.2093, 0.0977, 0.9479], [0.1166, 0.6154, 0.473]], [[0.8635, 0.1544, 0.9085], [0.0101, 0.0545, 0.1894], [0.9242, 0.785, 0.4676]], [[0.3628, 0.5524, 0.36], [0.2901, 0.6343, 0.913], [0.5931, 0.7921, 0.363]]], [[[0.1789, 0.8771, 0.1548], [0.7612, 0.6117, 0.639], [0.456, 0.3094, 0.5543]], [[0.992, 0.7304, 0.9882], [0.7084, 0.145, 0.6924], [0.1005, 0.0123, 0.549]], [[0.2695, 0.5309, 0.8316], [0.7877, 0.5713, 0.5233], [0.9754, 0.9031, 0.2995]]]]])
print (np.array2string(model.predict([in0Sof93672,in0Con35780,in0Min51155,in1Min51155,in0Con8412,in0Dot83638,in1Dot83638,in0Con17708,in0Sub16813,in1Sub16813],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub82364.png')

LSof93672 = softmax_layer([[[0.4842], [0.0774]]], 1, Sof93672), 
LGlo29015 = global_average_pooling1D_layer(Sof93672, Glo29015), 
LRes34791 = reshape_layer(Glo29015, [1, 1], Res34791), 
LCon35780 = concatenate_layer([Res34791,[[[0.0758, 0.2381, 0.6953, 0.5839]]]], 2, Con35780), 
LMin51155 = minimum_layer([[[[[[0.6557], [0.959]], [[0.4181], [0.4689]]], [[[0.6515], [0.7349]], [[0.9321], [0.3718]]]]], [[[[[0.4304], [0.2304]], [[0.8293], [0.7184]]], [[[0.2716], [0.5845]], [[0.7795], [0.8352]]]]]], Min51155), 
LRes85265 = reshape_layer(Min51155, [2, 2, 2], Res85265), 
LLoc32556 = locally_connected2D_layer(Res85265, 2, 2,[[[0.5198, 0.5819, 0.3148, 0.8942], [0.9115, 0.4758, 0.1546, 0.8106], [0.9625, 0.2427, 0.8658, 0.7344], [0.3919, 0.8938, 0.6921, 0.9853], [0.8929, 0.5401, 0.2905, 0.18], [0.3429, 0.0405, 0.2345, 0.1891], [0.7857, 0.1433, 0.4602, 0.7459], [0.9115, 0.4899, 0.7503, 0.9343]]],[[[0, 0, 0, 0]]], 1, 1, Loc32556), 
LReL609 = relu_layer(Loc32556, 8.081397561740703, 7.08038975071575, 8.051825539554105, ReL609), 
LRes72277 = reshape_layer(ReL609, [1, 4], Res72277), 
LCon8412 = concatenate_layer([Res72277,[[[0.3401, 0.7603, 0.915, 0.5232, 0.7549, 0.5339, 0.105, 0.2185, 0.3797, 0.0391, 0.3697, 0.5613]]]], 2, Con8412), 
LDot83638 = dot_layer([[[0.4764, 0.9199, 0.8454], [0.732, 0.4349, 0.4216], [0.092, 0.6498, 0.3867]]], [[[0.2339, 0.2521, 0.1967], [0.5894, 0.9447, 0.1951], [0.6269, 0.5927, 0.9717]]], 1, 2, Dot83638), 
LRes48129 = reshape_layer(Dot83638, [3, 3, 1], Res48129), 
LLoc75804 = locally_connected2D_layer(Res48129, 1, 3,[[[0.6997, 0.5276, 0.6544, 0.0672], [0.4393, 0.4455, 0.8775, 0.699], [0.737, 0.4154, 0.1688, 0.43]], [[0.9453, 0.7901, 0.9324, 0.721], [0.8129, 0.4868, 0.6316, 0.1813], [0.4269, 0.4567, 0.5983, 0.8226]], [[0.9329, 0.5568, 0.4649, 0.0725], [0.7977, 0.1861, 0.7923, 0.5229], [0.8834, 0.9727, 0.8712, 0.8297]]],[[[0, 0, 0, 0]], [[0, 0, 0, 0]], [[0, 0, 0, 0]]], 1, 1, Loc75804), 
LRes23413 = reshape_layer(Loc75804, [3, 1, 4, 1], Res23413), 
LCon17708 = concatenate_layer([Res23413,[[[[[0.1553, 0.6116, 0.2744], [0.0989, 0.8685, 0.4427], [0.4873, 0.8654, 0.2147], [0.5054, 0.3104, 0.2323]]], [[[0.0371, 0.4101, 0.3812], [0.2841, 0.2091, 0.6521], [0.5967, 0.4465, 0.536], [0.9989, 0.5413, 0.5782]]], [[[0.3096, 0.291, 0.1346], [0.3638, 0.2273, 0.9884], [0.0914, 0.3356, 0.1619], [0.609, 0.707, 0.4323]]]]]], 4, Con17708), 
LSub16813 = subtract_layer([[[[[0.3843, 0.9457, 0.4524], [0.1308, 0.5965, 0.5621], [0.0133, 0.0236, 0.9258]], [[0.1496, 0.8394, 0.6578], [0.496, 0.2283, 0.9762], [0.8865, 0.3677, 0.7329]], [[0.494, 0.8386, 0.8378], [0.4944, 0.6786, 0.4987], [0.7073, 0.13, 0.8109]]], [[[0.9938, 0.1144, 0.3092], [0.7097, 0.9431, 0.2211], [0.7441, 0.5986, 0.4367]], [[0.3783, 0.5382, 0.402], [0.8219, 0.3919, 0.7206], [0.2755, 0.499, 0.1682]], [[0.8905, 0.0327, 0.3513], [0.3232, 0.9012, 0.1431], [0.2709, 0.3078, 0.4268]]], [[[0.1436, 0.4785, 0.2238], [0.0685, 0.6331, 0.9821], [0.7823, 0.3834, 0.5]], [[0.5712, 0.7918, 0.8478], [0.6701, 0.2001, 0.1524], [0.3033, 0.457, 0.4803]], [[0.5833, 0.8766, 0.5467], [0.2701, 0.2096, 0.7113], [0.7541, 0.0271, 0.696]]]]], [[[[[0.107, 0.9542, 0.674], [0.833, 0.8208, 0.0059], [0.2146, 0.3491, 0.3528]], [[0.0646, 0.2333, 0.2526], [0.0131, 0.4105, 0.7157], [0.1942, 0.4461, 0.8065]], [[0.3312, 0.176, 0.074], [0.4433, 0.4369, 0.4361], [0.6151, 0.7319, 0.5809]]], [[[0.4871, 0.4289, 0.5565], [0.2093, 0.0977, 0.9479], [0.1166, 0.6154, 0.473]], [[0.8635, 0.1544, 0.9085], [0.0101, 0.0545, 0.1894], [0.9242, 0.785, 0.4676]], [[0.3628, 0.5524, 0.36], [0.2901, 0.6343, 0.913], [0.5931, 0.7921, 0.363]]], [[[0.1789, 0.8771, 0.1548], [0.7612, 0.6117, 0.639], [0.456, 0.3094, 0.5543]], [[0.992, 0.7304, 0.9882], [0.7084, 0.145, 0.6924], [0.1005, 0.0123, 0.549]], [[0.2695, 0.5309, 0.8316], [0.7877, 0.5713, 0.5233], [0.9754, 0.9031, 0.2995]]]]], Sub16813), 
LCon65423 = conv3D_layer(Sub16813, 3, 2, 1,[[[[[0.7108, 0.2333, 0.9086, 0.0978], [0.176, 0.5364, 0.8138, 0.8137], [0.6089, 0.5295, 0.4358, 0.8919]]], [[[0.5028, 0.3219, 1, 0.6337], [0.6216, 0.2948, 0.1631, 0.5273], [0.2345, 0.4156, 0.0686, 0.8272]]]], [[[[0.4537, 0.1167, 0.362, 0.0252], [0.8132, 0.3565, 0.6761, 0.304], [0.3281, 0.336, 0.5281, 0.3709]]], [[[0.2746, 0.3582, 0.3992, 0.0361], [0.8469, 0.487, 0.0083, 0.5227], [0.6599, 0.986, 0.4388, 0.7726]]]], [[[[0.7942, 0.9996, 0.8245, 0.9474], [0.7072, 0.5775, 0.7648, 0.916], [0.8705, 0.9355, 0.4967, 0.7638]]], [[[0.4382, 0.7988, 0.1289, 0.2664], [0.5963, 0.7764, 0.914, 0.8264], [0.5008, 0.9821, 0.6206, 0.5902]]]]],[0, 0, 0, 0], 1, 9, 1, true, 1, 1, 1, Con65423), 
LZer13192 = zero_padding3D_layer(Con65423, 0, 0, 0, 0, 1, 0, Zer13192), 
LMin89392 = minimum_layer([Con17708,Zer13192], Min89392), 
LRes89540 = reshape_layer(Min89392, [3, 1, 16], Res89540), 
LRes19910 = reshape_layer(Res89540, [3, 16], Res19910), 
LZer69369 = zero_padding1D_layer(Res19910, 2, 0, Zer69369), 
LDot32189 = dot_layer(Con8412,Zer69369, 2, 2, Dot32189), 
LSub82364 = subtract_layer(Con35780,Dot32189, Sub82364), 
exec_layers([LSof93672,LGlo29015,LRes34791,LCon35780,LMin51155,LRes85265,LLoc32556,LReL609,LRes72277,LCon8412,LDot83638,LRes48129,LLoc75804,LRes23413,LCon17708,LSub16813,LCon65423,LZer13192,LMin89392,LRes89540,LRes19910,LZer69369,LDot32189,LSub82364],["Sof93672","Glo29015","Res34791","Con35780","Min51155","Res85265","Loc32556","ReL609","Res72277","Con8412","Dot83638","Res48129","Loc75804","Res23413","Con17708","Sub16813","Con65423","Zer13192","Min89392","Res89540","Res19910","Zer69369","Dot32189","Sub82364"],Sub82364,"Sub82364")

Actual (Unparsed): [[[0.5000000, 0.0758000, -1.6102550, 0.2410467, 2.5391848]]]

Expected (Unparsed): [[[0.5,0.0758,-1.6102551475800004,0.24104661487199985,2.539184737888001]]]

Actual:   [[[0.5, 0.0758, -1.6102, 0.2411, 2.5392]]]

Expected: [[[0.5, 0.0758, -1.6102, 0.2411, 2.5392]]]