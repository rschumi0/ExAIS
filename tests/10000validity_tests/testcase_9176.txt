import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave6138 = tf.keras.layers.Input(shape=([1, 1]))
in1Ave6138 = tf.keras.layers.Input(shape=([1, 1]))
in0Up_30543 = tf.keras.layers.Input(shape=([3, 4]))

Ave6138 = keras.layers.Average(name = 'Ave6138', )([in0Ave6138,in1Ave6138])
Max88213 = keras.layers.MaxPool1D(pool_size=(1), name = 'Max88213', )(Ave6138)
Fla18417 = keras.layers.Flatten(name = 'Fla18417', )(Max88213)
Up_30543 = keras.layers.UpSampling1D(size=(1), name = 'Up_30543', )(in0Up_30543)
Res76404 = keras.layers.Reshape((3, 4, 1), name = 'Res76404', )(Up_30543)
Cro60033 = keras.layers.Cropping2D(cropping=((0, 2), (3, 0)), name = 'Cro60033', )(Res76404)
Sof51952 = keras.layers.Softmax(axis=1, name = 'Sof51952', )(Cro60033)
Res28795 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res28795', )(Sof51952)
Glo44977 = keras.layers.GlobalAveragePooling3D(name = 'Glo44977', )(Res28795)
Dot46366 = keras.layers.Dot(axes=(1, 1), name = 'Dot46366', )([Fla18417,Glo44977])
model = tf.keras.models.Model(inputs=[in0Ave6138,in1Ave6138,in0Up_30543], outputs=Dot46366)
in0Ave6138 = tf.constant([[[0.268]]])
in1Ave6138 = tf.constant([[[0.8375]]])
in0Up_30543 = tf.constant([[[1.9732, 1.5462, 1.7723, 1.4824], [1.896, 1.8317, 1.0068, 1.5342], [1.2699, 1.8147, 1.9052, 1.6442]]])
print (np.array2string(model.predict([in0Ave6138,in1Ave6138,in0Up_30543],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Dot46366.png')

LAve6138 = average_layer([[[[0.268]]], [[[0.8375]]]], Ave6138), 
LMax88213 = max_pool1D_layer(Ave6138, 1, Max88213), 
LFla18417 = flatten_layer(Max88213, Fla18417), 
LUp_30543 = up_sampling1D_layer([[[1.9732, 1.5462, 1.7723, 1.4824], [1.896, 1.8317, 1.0068, 1.5342], [1.2699, 1.8147, 1.9052, 1.6442]]], 1, Up_30543), 
LRes76404 = reshape_layer(Up_30543, [3, 4, 1], Res76404), 
LCro60033 = cropping2D_layer(Res76404, 0, 2, 3, 0, Cro60033), 
LSof51952 = softmax_layer(Cro60033, 1, Sof51952), 
LRes28795 = reshape_layer(Sof51952, [1, 1, 1, 1], Res28795), 
LGlo44977 = global_average_pooling3D_layer(Res28795, Glo44977), 
LDot46366 = dot_layer(Fla18417,Glo44977, 1, 1, Dot46366), 
exec_layers([LAve6138,LMax88213,LFla18417,LUp_30543,LRes76404,LCro60033,LSof51952,LRes28795,LGlo44977,LDot46366],["Ave6138","Max88213","Fla18417","Up_30543","Res76404","Cro60033","Sof51952","Res28795","Glo44977","Dot46366"],Dot46366,"Dot46366")

Actual (Unparsed): [[0.5527500]]

Expected (Unparsed): [[0.5527500000000001]]

Actual:   [[0.5528]]

Expected: [[0.5528]]