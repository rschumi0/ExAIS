import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add2117 = tf.keras.layers.Input(shape=([2, 2, 2]))
in1Add2117 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sof72155 = tf.keras.layers.Input(shape=([1, 1]))
in0Con72644 = tf.keras.layers.Input(shape=([2, 3]))

Add2117 = keras.layers.Add(name = 'Add2117', )([in0Add2117,in1Add2117])
Res86751 = keras.layers.Reshape((2, 4), name = 'Res86751', )(Add2117)
Sof72155 = keras.layers.Softmax(axis=1, name = 'Sof72155', input_shape=(1, 1))(in0Sof72155)
Zer48326 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer48326', )(Sof72155)
Con72644 = keras.layers.Concatenate(axis=2, name = 'Con72644', )([Zer48326,in0Con72644])
Max31518 = keras.layers.Maximum(name = 'Max31518', )([Res86751,Con72644])
Res2310 = keras.layers.Reshape((2, 4, 1), name = 'Res2310', )(Max31518)
Up_13850 = keras.layers.UpSampling2D(size=(2, 2), name = 'Up_13850', )(Res2310)
Res40458 = keras.layers.Reshape((4, 8), name = 'Res40458', )(Up_13850)
Glo57948 = keras.layers.GlobalAveragePooling1D(name = 'Glo57948', )(Res40458)
model = tf.keras.models.Model(inputs=[in0Add2117,in1Add2117,in0Sof72155,in0Con72644], outputs=Glo57948)
in0Add2117 = tf.constant([[[[0.7814, 0.1938], [0.4791, 0.8095]], [[0.1751, 0.1397], [0.0121, 0.0161]]]])
in1Add2117 = tf.constant([[[[0.2631, 0.745], [0.9092, 0.5381]], [[0.642, 0.2403], [0.7657, 0.9304]]]])
in0Sof72155 = tf.constant([[[0.7491]]])
in0Con72644 = tf.constant([[[0.6501, 0.6422, 0.9871], [0.7464, 0.6208, 0.207]]])
print (np.array2string(model.predict([in0Add2117,in1Add2117,in0Sof72155,in0Con72644],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo57948.png')

LAdd2117 = add_layer([[[[[0.7814, 0.1938], [0.4791, 0.8095]], [[0.1751, 0.1397], [0.0121, 0.0161]]]], [[[[0.2631, 0.745], [0.9092, 0.5381]], [[0.642, 0.2403], [0.7657, 0.9304]]]]], Add2117), 
LRes86751 = reshape_layer(Add2117, [2, 4], Res86751), 
LSof72155 = softmax_layer([[[0.7491]]], 1, Sof72155), 
LZer48326 = zero_padding1D_layer(Sof72155, 1, 0, Zer48326), 
LCon72644 = concatenate_layer([Zer48326,[[[0.6501, 0.6422, 0.9871], [0.7464, 0.6208, 0.207]]]], 2, Con72644), 
LMax31518 = maximum_layer([Res86751,Con72644], Max31518), 
LRes2310 = reshape_layer(Max31518, [2, 4, 1], Res2310), 
LUp_13850 = up_sampling2D_layer(Res2310, 2, 2, Up_13850), 
LRes40458 = reshape_layer(Up_13850, [4, 8], Res40458), 
LGlo57948 = global_average_pooling1D_layer(Res40458, Glo57948), 
exec_layers([LAdd2117,LRes86751,LSof72155,LZer48326,LCon72644,LMax31518,LRes2310,LUp_13850,LRes40458,LGlo57948],["Add2117","Res86751","Sof72155","Zer48326","Con72644","Max31518","Res2310","Up_13850","Res40458","Glo57948"],Glo57948,"Glo57948")

Actual (Unparsed): [[1.0222500, 1.0222500, 0.8426000, 0.8426000, 1.0830500, 1.0830500, 1.1470500, 1.1470500]]

Expected (Unparsed): [[1.02225,1.02225,0.8425999999999999,0.8425999999999999,1.08305,1.08305,1.14705,1.14705]]

Actual:   [[1.0223, 1.0223, 0.8426, 0.8426, 1.0831, 1.0831, 1.1471, 1.1471]]

Expected: [[1.0223, 1.0223, 0.8426, 0.8426, 1.0831, 1.0831, 1.1471, 1.1471]]