import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul58401 = tf.keras.layers.Input(shape=([1, 1]))
in1Mul58401 = tf.keras.layers.Input(shape=([1, 1]))
in0Dot61972 = tf.keras.layers.Input(shape=([2]))
in1Dot61972 = tf.keras.layers.Input(shape=([2]))

Mul58401 = keras.layers.Multiply(name = 'Mul58401', )([in0Mul58401,in1Mul58401])
Fla42002 = keras.layers.Flatten(name = 'Fla42002', )(Mul58401)
Dot61972 = keras.layers.Dot(axes=(1, 1), name = 'Dot61972', )([in0Dot61972,in1Dot61972])
Min21480 = keras.layers.Minimum(name = 'Min21480', )([Fla42002,Dot61972])
Res2722 = keras.layers.Reshape((1, 1), name = 'Res2722', )(Min21480)
Res3516 = keras.layers.Reshape((1, 1, 1), name = 'Res3516', )(Res2722)
Res86488 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res86488', )(Res3516)
Glo91372 = keras.layers.GlobalMaxPool3D(name = 'Glo91372', )(Res86488)
model = tf.keras.models.Model(inputs=[in0Mul58401,in1Mul58401,in0Dot61972,in1Dot61972], outputs=Glo91372)
in0Mul58401 = tf.constant([[[0.1545]]])
in1Mul58401 = tf.constant([[[0.4783]]])
in0Dot61972 = tf.constant([[0.2415, 0.0195]])
in1Dot61972 = tf.constant([[0.1865, 0.4778]])
print (np.array2string(model.predict([in0Mul58401,in1Mul58401,in0Dot61972,in1Dot61972],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo91372.png')

LMul58401 = multiply_layer([[[[0.1545]]], [[[0.4783]]]], Mul58401), 
LFla42002 = flatten_layer(Mul58401, Fla42002), 
LDot61972 = dot_layer([[0.2415, 0.0195]], [[0.1865, 0.4778]], 1, 1, Dot61972), 
LMin21480 = minimum_layer([Fla42002,Dot61972], Min21480), 
LRes2722 = reshape_layer(Min21480, [1, 1], Res2722), 
LRes3516 = reshape_layer(Res2722, [1, 1, 1], Res3516), 
LRes86488 = reshape_layer(Res3516, [1, 1, 1, 1], Res86488), 
LGlo91372 = global_max_pool3D_layer(Res86488, Glo91372), 
exec_layers([LMul58401,LFla42002,LDot61972,LMin21480,LRes2722,LRes3516,LRes86488,LGlo91372],["Mul58401","Fla42002","Dot61972","Min21480","Res2722","Res3516","Res86488","Glo91372"],Glo91372,"Glo91372")

Actual (Unparsed): [[0.0543569]]

Expected (Unparsed): [[0.05435685]]

Actual:   [[0.0544]]

Expected: [[0.0544]]