import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Add62833 = tf.keras.layers.Input(shape=([2, 2]))
in1Add62833 = tf.keras.layers.Input(shape=([2, 2]))
in0Glo98606 = tf.keras.layers.Input(shape=([1, 2, 2, 2]))

Add62833 = keras.layers.Add(name = 'Add62833', )([in0Add62833,in1Add62833])
Res22860 = keras.layers.Reshape((2, 2, 1), name = 'Res22860', )(Add62833)
PRe86246 = keras.layers.PReLU(name = 'PRe86246', )(Res22860)
Zer42125 = keras.layers.ZeroPadding2D(padding=((2, 0), (1, 0)), name = 'Zer42125', )(PRe86246)
Glo98606 = keras.layers.GlobalAveragePooling3D(name = 'Glo98606', )(in0Glo98606)
Res70356 = keras.layers.Reshape((2, 1), name = 'Res70356', )(Glo98606)
Res31757 = keras.layers.Reshape((2, 1, 1), name = 'Res31757', )(Res70356)
Zer59981 = keras.layers.ZeroPadding2D(padding=((1, 1), (1, 1)), name = 'Zer59981', )(Res31757)
Sub57785 = keras.layers.Subtract(name = 'Sub57785', )([Zer42125,Zer59981])
Res6831 = keras.layers.Reshape((4, 3, 1, 1), name = 'Res6831', )(Sub57785)
Glo88117 = keras.layers.GlobalAveragePooling3D(name = 'Glo88117', )(Res6831)
model = tf.keras.models.Model(inputs=[in0Add62833,in1Add62833,in0Glo98606], outputs=Glo88117)
w = model.get_layer('PRe86246').get_weights() 
w[0] = np.array([[[0.5213], [0.5859]], [[0.68], [0.8849]]])
model.get_layer('PRe86246').set_weights(w) 
in0Add62833 = tf.constant([[[0.7938, 0.5941], [0.7073, 0.6832]]])
in1Add62833 = tf.constant([[[0.1321, 0.6039], [0.6055, 0.0528]]])
in0Glo98606 = tf.constant([[[[[1.6401, 1.4861], [1.599, 1.1305]], [[1.5352, 1.7339], [1.1732, 1.8783]]]]])
print (np.array2string(model.predict([in0Add62833,in1Add62833,in0Glo98606],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Glo88117.png')

LAdd62833 = add_layer([[[[0.7938, 0.5941], [0.7073, 0.6832]]], [[[0.1321, 0.6039], [0.6055, 0.0528]]]], Add62833), 
LRes22860 = reshape_layer(Add62833, [2, 2, 1], Res22860), 
LPRe86246 = prelu_layer(Res22860, [[[0.5213], [0.5859]], [[0.68], [0.8849]]], PRe86246), 
LZer42125 = zero_padding2D_layer(PRe86246, 2, 0, 1, 0, Zer42125), 
LGlo98606 = global_average_pooling3D_layer([[[[[1.6401, 1.4861], [1.599, 1.1305]], [[1.5352, 1.7339], [1.1732, 1.8783]]]]], Glo98606), 
LRes70356 = reshape_layer(Glo98606, [2, 1], Res70356), 
LRes31757 = reshape_layer(Res70356, [2, 1, 1], Res31757), 
LZer59981 = zero_padding2D_layer(Res31757, 1, 1, 1, 1, Zer59981), 
LSub57785 = subtract_layer(Zer42125,Zer59981, Sub57785), 
LRes6831 = reshape_layer(Sub57785, [4, 3, 1, 1], Res6831), 
LGlo88117 = global_average_pooling3D_layer(Res6831, Glo88117), 
exec_layers([LAdd62833,LRes22860,LPRe86246,LZer42125,LGlo98606,LRes70356,LRes31757,LZer59981,LSub57785,LRes6831,LGlo88117],["Add62833","Res22860","PRe86246","Zer42125","Glo98606","Res70356","Res31757","Zer59981","Sub57785","Res6831","Glo88117"],Glo88117,"Glo88117")

Actual (Unparsed): [[0.0940521]]

Expected (Unparsed): [[0.09405208333333336]]

Actual:   [[0.0941]]

Expected: [[0.0941]]