import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con1577 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Min9120 = tf.keras.layers.Input(shape=([2, 1]))
in1Min9120 = tf.keras.layers.Input(shape=([2, 1]))
in0Con96671 = tf.keras.layers.Input(shape=([2, 1]))
in0Dot12028 = tf.keras.layers.Input(shape=([2, 2]))
in1Dot12028 = tf.keras.layers.Input(shape=([2, 2]))
in0Con46423 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sep77042 = tf.keras.layers.Input(shape=([2, 2, 2]))
in0Sub92116 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))
in1Sub92116 = tf.keras.layers.Input(shape=([2, 3, 2, 2]))
in0Con52536 = tf.keras.layers.Input(shape=([2, 3]))

Con1577 = keras.layers.Conv2D(3, (1, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con1577', )(in0Con1577)
Zer84613 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer84613', )(Con1577)
Min9120 = keras.layers.Minimum(name = 'Min9120', )([in0Min9120,in1Min9120])
Con96671 = keras.layers.Concatenate(axis=2, name = 'Con96671', )([Min9120,in0Con96671])
Dot12028 = keras.layers.Dot(axes=(1, 2), name = 'Dot12028', )([in0Dot12028,in1Dot12028])
Max58261 = keras.layers.Maximum(name = 'Max58261', )([Con96671,Dot12028])
Res61044 = keras.layers.Reshape((2, 2, 1), name = 'Res61044', )(Max58261)
Con46423 = keras.layers.Concatenate(axis=3, name = 'Con46423', )([Res61044,in0Con46423])
Sep77042 = keras.layers.SeparableConv2D(3, (1, 2),strides=(1, 1), padding='valid', name = 'Sep77042', )(in0Sep77042)
Zer2395 = keras.layers.ZeroPadding2D(padding=((0, 0), (1, 0)), name = 'Zer2395', )(Sep77042)
Max82942 = keras.layers.Maximum(name = 'Max82942', )([Con46423,Zer2395])
Ave646 = keras.layers.Average(name = 'Ave646', )([Zer84613,Max82942])
Res21625 = keras.layers.Reshape((2, 6), name = 'Res21625', )(Ave646)
Sub92116 = keras.layers.Subtract(name = 'Sub92116', )([in0Sub92116,in1Sub92116])
Res95978 = keras.layers.Reshape((2, 3, 4), name = 'Res95978', )(Sub92116)
Res88285 = keras.layers.Reshape((2, 12), name = 'Res88285', )(Res95978)
Sep86392 = keras.layers.SeparableConv1D(3, (2),strides=(1), padding='valid', name = 'Sep86392', )(Res88285)
ReL33901 = keras.layers.ReLU(max_value=6.449817882327183, negative_slope=8.558116016571553, threshold=4.553534134977991, name = 'ReL33901', )(Sep86392)
Zer76569 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer76569', )(ReL33901)
Con52536 = keras.layers.Concatenate(axis=2, name = 'Con52536', )([Zer76569,in0Con52536])
Ave45327 = keras.layers.Average(name = 'Ave45327', )([Res21625,Con52536])
model = tf.keras.models.Model(inputs=[in0Con1577,in0Min9120,in1Min9120,in0Con96671,in0Dot12028,in1Dot12028,in0Con46423,in0Sep77042,in0Sub92116,in1Sub92116,in0Con52536], outputs=Ave45327)
w = model.get_layer('Con1577').get_weights() 
w[0] = np.array([[[[0.8544, 0.8386, 0.8885], [0.2973, 0.9782, 0.2931]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con1577').set_weights(w) 
w = model.get_layer('Sep77042').get_weights() 
w[0] = np.array([[[[0.4622], [0.2234]], [[0.2542], [0.6258]]]])
w[1] = np.array([[[[0.4769, 0.3232, 0.394], [0.1882, 0.3377, 0.4752]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep77042').set_weights(w) 
w = model.get_layer('Sep86392').get_weights() 
w[0] = np.array([[[0.5027], [0.053], [0.3195], [0.7349], [0.185], [0.9322], [0.1525], [0.3453], [0.3585], [0.1055], [0.9318], [0.9583]], [[0.7088], [0.0262], [0.6202], [0.462], [0.4758], [0.0987], [0.132], [0.9702], [0.0464], [0.6098], [0.5279], [0.9408]]])
w[1] = np.array([[[0.5059, 0.8401, 0.2363], [0.0233, 0.1059, 0.4333], [0.8205, 0.3038, 0.7037], [0.8678, 0.8348, 0.462], [0.8633, 0.2252, 0.5776], [0.4283, 0.762, 0.8187], [0.3525, 0.6413, 0.8095], [0.3397, 0.123, 0.3092], [0.0283, 0.4981, 0.1459], [0.5024, 0.5985, 0.011], [0.6676, 0.8118, 0.6263], [0.8997, 0.6267, 0.7281]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep86392').set_weights(w) 
in0Con1577 = tf.constant([[[[0.9693, 0.817]], [[0.3782, 0.1997]]]])
in0Min9120 = tf.constant([[[0.7962], [0.829]]])
in1Min9120 = tf.constant([[[0.3765], [0.262]]])
in0Con96671 = tf.constant([[[0.2361], [0.6953]]])
in0Dot12028 = tf.constant([[[0.9512, 0.9298], [0.8154, 0.6856]]])
in1Dot12028 = tf.constant([[[0.4717, 0.655], [0.4346, 0.1786]]])
in0Con46423 = tf.constant([[[[0.6854, 0.9011], [0.9435, 0.9846]], [[0.0182, 0.2716], [0.818, 0.4304]]]])
in0Sep77042 = tf.constant([[[[0.5994, 0.928], [0.6239, 0.1205]], [[0.1685, 0.8562], [0.5103, 0.7457]]]])
in0Sub92116 = tf.constant([[[[[0.043, 0.2959], [0.9976, 0.6718]], [[0.5569, 0.9738], [0.5571, 0.6601]], [[0.5175, 0.127], [0.631, 0.2502]]], [[[0.0946, 0.2077], [0.2219, 0.569]], [[0.8376, 0.1881], [0.6171, 0.1843]], [[0.1375, 0.3944], [0.2231, 0.3475]]]]])
in1Sub92116 = tf.constant([[[[[0.6816, 0.6044], [0.1696, 0.3461]], [[0.8389, 0.3479], [0.6864, 0.9775]], [[0.4539, 0.9636], [0.2489, 0.3438]]], [[[0.2318, 0.9904], [0.1454, 0.2688]], [[0.7486, 0.8914], [0.4266, 0.6426]], [[0.1397, 0.9483], [0.1642, 0.9087]]]]])
in0Con52536 = tf.constant([[[0.2262, 0.4412, 0.2364], [0.1224, 0.5547, 0.3609]]])
print (np.array2string(model.predict([in0Con1577,in0Min9120,in1Min9120,in0Con96671,in0Dot12028,in1Dot12028,in0Con46423,in0Sep77042,in0Sub92116,in1Sub92116,in0Con52536],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Ave45327.png')

LCon1577 = conv2D_layer([[[[0.9693, 0.817]], [[0.3782, 0.1997]]]], 1, 1,[[[[0.8544, 0.8386, 0.8885], [0.2973, 0.9782, 0.2931]]]],[0, 0, 0], 1, 1, true, 1, 1, Con1577), 
LZer84613 = zero_padding2D_layer(Con1577, 0, 0, 1, 0, Zer84613), 
LMin9120 = minimum_layer([[[[0.7962], [0.829]]], [[[0.3765], [0.262]]]], Min9120), 
LCon96671 = concatenate_layer([Min9120,[[[0.2361], [0.6953]]]], 2, Con96671), 
LDot12028 = dot_layer([[[0.9512, 0.9298], [0.8154, 0.6856]]], [[[0.4717, 0.655], [0.4346, 0.1786]]], 1, 2, Dot12028), 
LMax58261 = maximum_layer([Con96671,Dot12028], Max58261), 
LRes61044 = reshape_layer(Max58261, [2, 2, 1], Res61044), 
LCon46423 = concatenate_layer([Res61044,[[[[0.6854, 0.9011], [0.9435, 0.9846]], [[0.0182, 0.2716], [0.818, 0.4304]]]]], 3, Con46423), 
LSep77042 = separable_conv2D_layer([[[[0.5994, 0.928], [0.6239, 0.1205]], [[0.1685, 0.8562], [0.5103, 0.7457]]]], 1, 2,[[[[[0.4622], [0.2234]], [[0.2542], [0.6258]]]],[[[[0.4769, 0.3232, 0.394], [0.1882, 0.3377, 0.4752]]]]],[0, 0, 0], 1, 1, false, Sep77042), 
LZer2395 = zero_padding2D_layer(Sep77042, 0, 0, 1, 0, Zer2395), 
LMax82942 = maximum_layer([Con46423,Zer2395], Max82942), 
LAve646 = average_layer([Zer84613,Max82942], Ave646), 
LRes21625 = reshape_layer(Ave646, [2, 6], Res21625), 
LSub92116 = subtract_layer([[[[[0.043, 0.2959], [0.9976, 0.6718]], [[0.5569, 0.9738], [0.5571, 0.6601]], [[0.5175, 0.127], [0.631, 0.2502]]], [[[0.0946, 0.2077], [0.2219, 0.569]], [[0.8376, 0.1881], [0.6171, 0.1843]], [[0.1375, 0.3944], [0.2231, 0.3475]]]]], [[[[[0.6816, 0.6044], [0.1696, 0.3461]], [[0.8389, 0.3479], [0.6864, 0.9775]], [[0.4539, 0.9636], [0.2489, 0.3438]]], [[[0.2318, 0.9904], [0.1454, 0.2688]], [[0.7486, 0.8914], [0.4266, 0.6426]], [[0.1397, 0.9483], [0.1642, 0.9087]]]]], Sub92116), 
LRes95978 = reshape_layer(Sub92116, [2, 3, 4], Res95978), 
LRes88285 = reshape_layer(Res95978, [2, 12], Res88285), 
LSep86392 = separable_conv1D_layer(Res88285, 2,[[[[0.5027], [0.053], [0.3195], [0.7349], [0.185], [0.9322], [0.1525], [0.3453], [0.3585], [0.1055], [0.9318], [0.9583]], [[0.7088], [0.0262], [0.6202], [0.462], [0.4758], [0.0987], [0.132], [0.9702], [0.0464], [0.6098], [0.5279], [0.9408]]],[[[0.5059, 0.8401, 0.2363], [0.0233, 0.1059, 0.4333], [0.8205, 0.3038, 0.7037], [0.8678, 0.8348, 0.462], [0.8633, 0.2252, 0.5776], [0.4283, 0.762, 0.8187], [0.3525, 0.6413, 0.8095], [0.3397, 0.123, 0.3092], [0.0283, 0.4981, 0.1459], [0.5024, 0.5985, 0.011], [0.6676, 0.8118, 0.6263], [0.8997, 0.6267, 0.7281]]]],[0, 0, 0], 1, false, Sep86392), 
LReL33901 = relu_layer(Sep86392, 6.449817882327183, 8.558116016571553, 4.553534134977991, ReL33901), 
LZer76569 = zero_padding1D_layer(ReL33901, 1, 0, Zer76569), 
LCon52536 = concatenate_layer([Zer76569,[[[0.2262, 0.4412, 0.2364], [0.1224, 0.5547, 0.3609]]]], 2, Con52536), 
LAve45327 = average_layer([Res21625,Con52536], Ave45327), 
exec_layers([LCon1577,LZer84613,LMin9120,LCon96671,LDot12028,LMax58261,LRes61044,LCon46423,LSep77042,LZer2395,LMax82942,LAve646,LRes21625,LSub92116,LRes95978,LRes88285,LSep86392,LReL33901,LZer76569,LCon52536,LAve45327],["Con1577","Zer84613","Min9120","Con96671","Dot12028","Max58261","Res61044","Con46423","Sep77042","Zer2395","Max82942","Ave646","Res21625","Sub92116","Res95978","Res88285","Sep86392","ReL33901","Zer76569","Con52536","Ave45327"],Ave45327,"Ave45327")

Actual (Unparsed): [[[0.2456920, 0.1713500, 0.2252750, 0.5206215, 0.8594861, 0.6395214], [-19.7496399, -19.2090210, -18.0520970, 0.3306512, 0.6099763, 0.3866907]]]

Expected (Unparsed): [[[0.24569201000000002,0.17135,0.225275,0.520621495,0.859486095,0.6395214375],[-19.749640007609297,-19.209021064873706,-18.052097032759796,0.33065122249999995,0.609976265,0.3866906925]]]

Actual:   [[[0.2457, 0.1714, 0.2253, 0.5207, 0.8595, 0.6396], [-19.7496, -19.209, -18.052, 0.3307, 0.61, 0.3867]]]

Expected: [[[0.2457, 0.1714, 0.2253, 0.5207, 0.8595, 0.6396], [-19.7496, -19.209, -18.052, 0.3307, 0.61, 0.3867]]]