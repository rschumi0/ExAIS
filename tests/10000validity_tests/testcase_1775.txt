import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo66248 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Sim13756 = tf.keras.layers.Input(shape=([2, 2]))
in0Con94809 = tf.keras.layers.Input(shape=([35]))

Glo66248 = keras.layers.GlobalMaxPool2D(name = 'Glo66248', )(in0Glo66248)
Res34990 = keras.layers.Reshape((2, 1), name = 'Res34990', )(Glo66248)
Res64062 = keras.layers.Reshape((2, 1, 1), name = 'Res64062', )(Res34990)
Res91413 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res91413', )(Res64062)
Zer15835 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer15835', )(Res91413)
Res38874 = keras.layers.Reshape((4, 3, 3), name = 'Res38874', )(Zer15835)
Res24880 = keras.layers.Reshape((4, 9), name = 'Res24880', )(Res38874)
Fla11651 = keras.layers.Flatten(name = 'Fla11651', )(Res24880)
Sim13756 = keras.layers.SimpleRNN(1,name = 'Sim13756', )(in0Sim13756)
Con94809 = keras.layers.Concatenate(axis=1, name = 'Con94809', )([Sim13756,in0Con94809])
Min13822 = keras.layers.Minimum(name = 'Min13822', )([Fla11651,Con94809])
model = tf.keras.models.Model(inputs=[in0Glo66248,in0Sim13756,in0Con94809], outputs=Min13822)
w = model.get_layer('Sim13756').get_weights() 
w[0] = np.array([[4], [1]])
w[1] = np.array([[8]])
w[2] = np.array([7])
model.get_layer('Sim13756').set_weights(w) 
in0Glo66248 = tf.constant([[[[1.2722, 1.2755]], [[1.6704, 1.2802]]]])
in0Sim13756 = tf.constant([[[5, 7], [4, 7]]])
in0Con94809 = tf.constant([[0.1658, 0.6578, 0.7855, 0.8231, 0.3718, 0.7563, 0.7196, 0.1763, 0.3867, 0.9198, 0.0973, 0.6146, 0.1645, 0.6607, 0.7318, 0.1978, 0.9438, 0.6023, 0.0272, 0.9644, 0.3206, 0.5386, 0.6517, 0.0634, 0.0232, 0.2234, 0.2335, 0.1451, 0.0008, 0.3199, 0.0744, 0.5273, 0.1454, 0.3664, 0.5926]])
print (np.array2string(model.predict([in0Glo66248,in0Sim13756,in0Con94809],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Min13822.png')

LGlo66248 = global_max_pool2D_layer([[[[1.2722, 1.2755]], [[1.6704, 1.2802]]]], Glo66248), 
LRes34990 = reshape_layer(Glo66248, [2, 1], Res34990), 
LRes64062 = reshape_layer(Res34990, [2, 1, 1], Res64062), 
LRes91413 = reshape_layer(Res64062, [2, 1, 1, 1], Res91413), 
LZer15835 = zero_padding3D_layer(Res91413, 1, 1, 1, 1, 1, 1, Zer15835), 
LRes38874 = reshape_layer(Zer15835, [4, 3, 3], Res38874), 
LRes24880 = reshape_layer(Res38874, [4, 9], Res24880), 
LFla11651 = flatten_layer(Res24880, Fla11651), 
LSim13756 = simple_rnn_layer([[[5, 7], [4, 7]]],[[4], [1]],[[8]],[7], Sim13756), 
LCon94809 = concatenate_layer([Sim13756,[[0.1658, 0.6578, 0.7855, 0.8231, 0.3718, 0.7563, 0.7196, 0.1763, 0.3867, 0.9198, 0.0973, 0.6146, 0.1645, 0.6607, 0.7318, 0.1978, 0.9438, 0.6023, 0.0272, 0.9644, 0.3206, 0.5386, 0.6517, 0.0634, 0.0232, 0.2234, 0.2335, 0.1451, 0.0008, 0.3199, 0.0744, 0.5273, 0.1454, 0.3664, 0.5926]]], 1, Con94809), 
LMin13822 = minimum_layer([Fla11651,Con94809], Min13822), 
exec_layers([LGlo66248,LRes34990,LRes64062,LRes91413,LZer15835,LRes38874,LRes24880,LFla11651,LSim13756,LCon94809,LMin13822],["Glo66248","Res34990","Res64062","Res91413","Zer15835","Res38874","Res24880","Fla11651","Sim13756","Con94809","Min13822"],Min13822,"Min13822")

Actual (Unparsed): [[0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.1645000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.5386000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000, 0.0000000]]

Expected (Unparsed): [[0,0,0,0,0,0,0,0,0,0,0,0,0,0.1645,0,0,0,0,0,0,0,0,0.5386,0,0,0,0,0,0,0,0,0,0,0,0,0]]

Actual:   [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.1645, 0, 0, 0, 0, 0, 0, 0, 0, 0.5386, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]

Expected: [[0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0.1645, 0, 0, 0, 0, 0, 0, 0, 0, 0.5386, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]]