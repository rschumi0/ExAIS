import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con97313 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Max56537 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Max56537 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in0Glo77225 = tf.keras.layers.Input(shape=([1, 1]))
in0Con17389 = tf.keras.layers.Input(shape=([1]))
in0Con11494 = tf.keras.layers.Input(shape=([4]))

Con97313 = keras.layers.Conv2D(3, (1, 2),strides=(1, 1), padding='valid', dilation_rate=(1, 1), name = 'Con97313', )(in0Con97313)
Res87359 = keras.layers.Reshape((2, 3), name = 'Res87359', )(Con97313)
Fla95319 = keras.layers.Flatten(name = 'Fla95319', )(Res87359)
Max56537 = keras.layers.Maximum(name = 'Max56537', )([in0Max56537,in1Max56537])
Res98744 = keras.layers.Reshape((1, 1, 2), name = 'Res98744', )(Max56537)
Res38186 = keras.layers.Reshape((1, 2), name = 'Res38186', )(Res98744)
Fla55870 = keras.layers.Flatten(name = 'Fla55870', )(Res38186)
Glo77225 = keras.layers.GlobalMaxPool1D(name = 'Glo77225', )(in0Glo77225)
Con17389 = keras.layers.Concatenate(axis=1, name = 'Con17389', )([Glo77225,in0Con17389])
Sub66401 = keras.layers.Subtract(name = 'Sub66401', )([Fla55870,Con17389])
Con11494 = keras.layers.Concatenate(axis=1, name = 'Con11494', )([Sub66401,in0Con11494])
Add52213 = keras.layers.Add(name = 'Add52213', )([Fla95319,Con11494])
model = tf.keras.models.Model(inputs=[in0Con97313,in0Max56537,in1Max56537,in0Glo77225,in0Con17389,in0Con11494], outputs=Add52213)
w = model.get_layer('Con97313').get_weights() 
w[0] = np.array([[[[0.5322, 0.9897, 0.7604]], [[0.9187, 0.4511, 0.1594]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con97313').set_weights(w) 
in0Con97313 = tf.constant([[[[0.4539], [0.2285]], [[0.9867], [0.2441]]]])
in0Max56537 = tf.constant([[[[[0.4767, 0.5769]]]]])
in1Max56537 = tf.constant([[[[[0.3176, 0.6965]]]]])
in0Glo77225 = tf.constant([[[1.8726]]])
in0Con17389 = tf.constant([[0.4512]])
in0Con11494 = tf.constant([[0.4662, 0.5124, 0.0326, 0.3021]])
print (np.array2string(model.predict([in0Con97313,in0Max56537,in1Max56537,in0Glo77225,in0Con17389,in0Con11494],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Add52213.png')

LCon97313 = conv2D_layer([[[[0.4539], [0.2285]], [[0.9867], [0.2441]]]], 1, 2,[[[[0.5322, 0.9897, 0.7604]], [[0.9187, 0.4511, 0.1594]]]],[0, 0, 0], 1, 1, false, 1, 1, Con97313), 
LRes87359 = reshape_layer(Con97313, [2, 3], Res87359), 
LFla95319 = flatten_layer(Res87359, Fla95319), 
LMax56537 = maximum_layer([[[[[[0.4767, 0.5769]]]]], [[[[[0.3176, 0.6965]]]]]], Max56537), 
LRes98744 = reshape_layer(Max56537, [1, 1, 2], Res98744), 
LRes38186 = reshape_layer(Res98744, [1, 2], Res38186), 
LFla55870 = flatten_layer(Res38186, Fla55870), 
LGlo77225 = global_max_pool1D_layer([[[1.8726]]], Glo77225), 
LCon17389 = concatenate_layer([Glo77225,[[0.4512]]], 1, Con17389), 
LSub66401 = subtract_layer(Fla55870,Con17389, Sub66401), 
LCon11494 = concatenate_layer([Sub66401,[[0.4662, 0.5124, 0.0326, 0.3021]]], 1, Con11494), 
LAdd52213 = add_layer([Fla95319,Con11494], Add52213), 
exec_layers([LCon97313,LRes87359,LFla95319,LMax56537,LRes98744,LRes38186,LFla55870,LGlo77225,LCon17389,LSub66401,LCon11494,LAdd52213],["Con97313","Res87359","Fla95319","Max56537","Res98744","Res38186","Fla55870","Glo77225","Con17389","Sub66401","Con11494","Add52213"],Add52213,"Add52213")

Actual (Unparsed): [[-0.9444114, 0.7976012, 0.8477685, 1.2617764, 1.1192505, 1.0912962]]

Expected (Unparsed): [[-0.9444114700000001,0.79760118,0.84776846,1.26177641,1.1192505,1.09129622]]

Actual:   [[-0.9444, 0.7977, 0.8478, 1.2618, 1.1193, 1.0913]]

Expected: [[-0.9444, 0.7977, 0.8478, 1.2618, 1.1193, 1.0913]]