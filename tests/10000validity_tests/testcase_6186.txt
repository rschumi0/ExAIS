import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo64154 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con42727 = tf.keras.layers.Input(shape=([2, 1, 3, 1]))
in0Min92863 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))
in1Min92863 = tf.keras.layers.Input(shape=([1, 1, 2, 2]))

Glo64154 = keras.layers.GlobalAveragePooling2D(name = 'Glo64154', )(in0Glo64154)
Res50230 = keras.layers.Reshape((2, 1), name = 'Res50230', )(Glo64154)
Res55966 = keras.layers.Reshape((2, 1, 1), name = 'Res55966', )(Res50230)
Res35875 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res35875', )(Res55966)
Zer73005 = keras.layers.ZeroPadding3D(padding=((0, 0), (0, 0), (2, 0)), name = 'Zer73005', )(Res35875)
Con42727 = keras.layers.Concatenate(axis=4, name = 'Con42727', )([Zer73005,in0Con42727])
Min92863 = keras.layers.Minimum(name = 'Min92863', )([in0Min92863,in1Min92863])
Thr69351 = keras.layers.ThresholdedReLU(theta=0.13874140031000828, name = 'Thr69351', )(Min92863)
Zer5987 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (1, 0)), name = 'Zer5987', )(Thr69351)
Min44044 = keras.layers.Minimum(name = 'Min44044', )([Con42727,Zer5987])
Res86035 = keras.layers.Reshape((2, 1, 6), name = 'Res86035', )(Min44044)
Con81523 = keras.layers.Conv2D(2, (2, 1),strides=(1, 1), padding='same', dilation_rate=(1, 1), name = 'Con81523', )(Res86035)
model = tf.keras.models.Model(inputs=[in0Glo64154,in0Con42727,in0Min92863,in1Min92863], outputs=Con81523)
w = model.get_layer('Con81523').get_weights() 
w[0] = np.array([[[[0.2328, 0.8453], [0.3004, 0.6666], [0.5623, 0.1422], [0.0722, 0.7648], [0.3768, 0.4663], [0.5874, 0.1316]]], [[[0.4966, 0.5845], [0.5603, 0.5989], [0.3505, 0.4628], [0.0313, 0.7829], [0.2616, 0.8906], [0.2064, 0.1561]]]])
w[1] = np.array([0, 0])
model.get_layer('Con81523').set_weights(w) 
in0Glo64154 = tf.constant([[[[1.1932, 1.9562]], [[1.8627, 1.8124]]]])
in0Con42727 = tf.constant([[[[[0.3655], [0.743], [0.1383]]], [[[0.8691], [0.7281], [0.0711]]]]])
in0Min92863 = tf.constant([[[[[0.7065, 0.0209], [0.0149, 0.1706]]]]])
in1Min92863 = tf.constant([[[[[0.6867, 0.9735], [0.6982, 0.7395]]]]])
print (np.array2string(model.predict([in0Glo64154,in0Con42727,in0Min92863,in1Min92863],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Con81523.png')

LGlo64154 = global_average_pooling2D_layer([[[[1.1932, 1.9562]], [[1.8627, 1.8124]]]], Glo64154), 
LRes50230 = reshape_layer(Glo64154, [2, 1], Res50230), 
LRes55966 = reshape_layer(Res50230, [2, 1, 1], Res55966), 
LRes35875 = reshape_layer(Res55966, [2, 1, 1, 1], Res35875), 
LZer73005 = zero_padding3D_layer(Res35875, 0, 0, 0, 0, 2, 0, Zer73005), 
LCon42727 = concatenate_layer([Zer73005,[[[[[0.3655], [0.743], [0.1383]]], [[[0.8691], [0.7281], [0.0711]]]]]], 4, Con42727), 
LMin92863 = minimum_layer([[[[[[0.7065, 0.0209], [0.0149, 0.1706]]]]], [[[[[0.6867, 0.9735], [0.6982, 0.7395]]]]]], Min92863), 
LThr69351 = thresholded_relu_layer(Min92863, 0.13874140031000828, Thr69351), 
LZer5987 = zero_padding3D_layer(Thr69351, 1, 0, 0, 0, 1, 0, Zer5987), 
LMin44044 = minimum_layer([Con42727,Zer5987], Min44044), 
LRes86035 = reshape_layer(Min44044, [2, 1, 6], Res86035), 
LCon81523 = conv2D_layer(Res86035, 2, 1,[[[[0.2328, 0.8453], [0.3004, 0.6666], [0.5623, 0.1422], [0.0722, 0.7648], [0.3768, 0.4663], [0.5874, 0.1316]]], [[[0.4966, 0.5845], [0.5603, 0.5989], [0.3505, 0.4628], [0.0313, 0.7829], [0.2616, 0.8906], [0.2064, 0.1561]]]],[0, 0], 1, 1, true, 1, 1, Con81523), 
exec_layers([LGlo64154,LRes50230,LRes55966,LRes35875,LZer73005,LCon42727,LMin92863,LThr69351,LZer5987,LMin44044,LRes86035,LCon81523],["Glo64154","Res50230","Res55966","Res35875","Zer73005","Con42727","Min92863","Thr69351","Zer5987","Min44044","Res86035","Con81523"],Con81523,"Con81523")

Actual (Unparsed): [[[[0.0146750, 0.0110987]], [[0.0417641, 0.0093568]]]]

Expected (Unparsed): [[[[0.014675039999999999,0.01109871]],[[0.04176414,0.009356759999999999]]]]

Actual:   [[[[0.0147, 0.0111]], [[0.0418, 0.0094]]]]

Expected: [[[[0.0147, 0.0111]], [[0.0418, 0.0094]]]]