import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min72477 = tf.keras.layers.Input(shape=([1, 1]))
in1Min72477 = tf.keras.layers.Input(shape=([1, 1]))
in0Con95862 = tf.keras.layers.Input(shape=([1]))
in0Ave72276 = tf.keras.layers.Input(shape=([1, 2, 1]))
in1Ave72276 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0GRU35763 = tf.keras.layers.Input(shape=([3, 3]))
in0Max52780 = tf.keras.layers.Input(shape=([1, 1]))
in1Max52780 = tf.keras.layers.Input(shape=([1, 1]))

Min72477 = keras.layers.Minimum(name = 'Min72477', )([in0Min72477,in1Min72477])
Fla48760 = keras.layers.Flatten(name = 'Fla48760', )(Min72477)
Con95862 = keras.layers.Concatenate(axis=1, name = 'Con95862', )([Fla48760,in0Con95862])
Ave72276 = keras.layers.Average(name = 'Ave72276', )([in0Ave72276,in1Ave72276])
Fla15192 = keras.layers.Flatten(name = 'Fla15192', )(Ave72276)
Max97465 = keras.layers.Maximum(name = 'Max97465', )([Con95862,Fla15192])
Res18516 = keras.layers.Reshape((2, 1), name = 'Res18516', )(Max97465)
GRU35763 = keras.layers.GRU(2,reset_after=False, recurrent_activation='sigmoid', name = 'GRU35763', )(in0GRU35763)
ELU91085 = keras.layers.ELU(alpha=1.3498524200447033, name = 'ELU91085', )(GRU35763)
Res41327 = keras.layers.Reshape((2, 1), name = 'Res41327', )(ELU91085)
Max52780 = keras.layers.Maximum(name = 'Max52780', )([in0Max52780,in1Max52780])
Zer23153 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer23153', )(Max52780)
Add89907 = keras.layers.Add(name = 'Add89907', )([Res41327,Zer23153])
Sub78680 = keras.layers.Subtract(name = 'Sub78680', )([Res18516,Add89907])
model = tf.keras.models.Model(inputs=[in0Min72477,in1Min72477,in0Con95862,in0Ave72276,in1Ave72276,in0GRU35763,in0Max52780,in1Max52780], outputs=Sub78680)
w = model.get_layer('GRU35763').get_weights() 
w[0] = np.array([[9, 9, 6, 9, 3, 2], [1, 1, 6, 5, 2, 7], [6, 4, 9, 1, 8, 6]])
w[1] = np.array([[7, 3, 2, 3, 2, 10], [10, 3, 7, 7, 9, 5]])
w[2] = np.array([8, 9, 4, 10, 2, 9])
model.get_layer('GRU35763').set_weights(w) 
in0Min72477 = tf.constant([[[0.9985]]])
in1Min72477 = tf.constant([[[0.4317]]])
in0Con95862 = tf.constant([[0.3951]])
in0Ave72276 = tf.constant([[[[0.5238], [0.6654]]]])
in1Ave72276 = tf.constant([[[[0.9148], [0.05]]]])
in0GRU35763 = tf.constant([[[2, 8, 5], [6, 3, 8], [8, 1, 1]]])
in0Max52780 = tf.constant([[[0.7303]]])
in1Max52780 = tf.constant([[[0.6491]]])
print (np.array2string(model.predict([in0Min72477,in1Min72477,in0Con95862,in0Ave72276,in1Ave72276,in0GRU35763,in0Max52780,in1Max52780],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub78680.png')

LMin72477 = minimum_layer([[[[0.9985]]], [[[0.4317]]]], Min72477), 
LFla48760 = flatten_layer(Min72477, Fla48760), 
LCon95862 = concatenate_layer([Fla48760,[[0.3951]]], 1, Con95862), 
LAve72276 = average_layer([[[[[0.5238], [0.6654]]]], [[[[0.9148], [0.05]]]]], Ave72276), 
LFla15192 = flatten_layer(Ave72276, Fla15192), 
LMax97465 = maximum_layer([Con95862,Fla15192], Max97465), 
LRes18516 = reshape_layer(Max97465, [2, 1], Res18516), 
LGRU35763 = gru_layer([[[2, 8, 5], [6, 3, 8], [8, 1, 1]]],[[9, 9, 6, 9, 3, 2], [1, 1, 6, 5, 2, 7], [6, 4, 9, 1, 8, 6]],[[7, 3, 2, 3, 2, 10], [10, 3, 7, 7, 9, 5]],[8, 9, 4, 10, 2, 9], false, GRU35763), 
LELU91085 = elu_layer(GRU35763, 1.3498524200447033, ELU91085), 
LRes41327 = reshape_layer(ELU91085, [2, 1], Res41327), 
LMax52780 = maximum_layer([[[[0.7303]]], [[[0.6491]]]], Max52780), 
LZer23153 = zero_padding1D_layer(Max52780, 1, 0, Zer23153), 
LAdd89907 = add_layer([Res41327,Zer23153], Add89907), 
LSub78680 = subtract_layer(Res18516,Add89907, Sub78680), 
exec_layers([LMin72477,LFla48760,LCon95862,LAve72276,LFla15192,LMax97465,LRes18516,LGRU35763,LELU91085,LRes41327,LMax52780,LZer23153,LAdd89907,LSub78680],["Min72477","Fla48760","Con95862","Ave72276","Fla15192","Max97465","Res18516","GRU35763","ELU91085","Res41327","Max52780","Zer23153","Add89907","Sub78680"],Sub78680,"Sub78680")

Actual (Unparsed): [[[0.7193000], [-0.3352000]]]

Expected (Unparsed): [[[0.7193],[-0.33519999999999994]]]

Actual:   [[[0.7193], [-0.3352]]]

Expected: [[[0.7193], [-0.3351]]]