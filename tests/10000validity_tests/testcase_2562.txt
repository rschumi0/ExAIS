import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave96365 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Ave96365 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Ave96365 = keras.layers.Average(name = 'Ave96365', )([in0Ave96365,in1Ave96365])
Res19972 = keras.layers.Reshape((2, 2, 2), name = 'Res19972', )(Ave96365)
Res53734 = keras.layers.Reshape((2, 4), name = 'Res53734', )(Res19972)
Max84976 = keras.layers.MaxPool1D(pool_size=(2), strides=(2), padding='same', name = 'Max84976', )(Res53734)
Res26266 = keras.layers.Reshape((1, 4, 1), name = 'Res26266', )(Max84976)
Ave56173 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave56173', )(Res26266)
Glo39049 = keras.layers.GlobalMaxPool2D(name = 'Glo39049', )(Ave56173)
Res18482 = keras.layers.Reshape((1, 1), name = 'Res18482', )(Glo39049)
Cro68299 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro68299', )(Res18482)
Cro38138 = keras.layers.Cropping1D(cropping=((0, 0)), name = 'Cro38138', )(Cro68299)
model = tf.keras.models.Model(inputs=[in0Ave96365,in1Ave96365], outputs=Cro38138)
in0Ave96365 = tf.constant([[[[[0.8177, 0.7661]], [[0.7838, 0.4446]]], [[[0.2895, 0.0099]], [[0.122, 0.4216]]]]])
in1Ave96365 = tf.constant([[[[[0.1367, 0.9101]], [[0.9603, 0.6507]]], [[[0.6105, 0.2306]], [[0.7039, 0.1505]]]]])
print (np.array2string(model.predict([in0Ave96365,in1Ave96365],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Cro38138.png')

LAve96365 = average_layer([[[[[[0.8177, 0.7661]], [[0.7838, 0.4446]]], [[[0.2895, 0.0099]], [[0.122, 0.4216]]]]], [[[[[0.1367, 0.9101]], [[0.9603, 0.6507]]], [[[0.6105, 0.2306]], [[0.7039, 0.1505]]]]]], Ave96365), 
LRes19972 = reshape_layer(Ave96365, [2, 2, 2], Res19972), 
LRes53734 = reshape_layer(Res19972, [2, 4], Res53734), 
LMax84976 = max_pool1D_layer(Res53734, 2, 2, true, Max84976), 
LRes26266 = reshape_layer(Max84976, [1, 4, 1], Res26266), 
LAve56173 = average_pooling2D_layer(Res26266, 1, 1, Ave56173), 
LGlo39049 = global_max_pool2D_layer(Ave56173, Glo39049), 
LRes18482 = reshape_layer(Glo39049, [1, 1], Res18482), 
LCro68299 = cropping1D_layer(Res18482, 0, 0, Cro68299), 
LCro38138 = cropping1D_layer(Cro68299, 0, 0, Cro38138), 
exec_layers([LAve96365,LRes19972,LRes53734,LMax84976,LRes26266,LAve56173,LGlo39049,LRes18482,LCro68299,LCro38138],["Ave96365","Res19972","Res53734","Max84976","Res26266","Ave56173","Glo39049","Res18482","Cro68299","Cro38138"],Cro38138,"Cro38138")

Actual (Unparsed): [[[0.8720500]]]

Expected (Unparsed): [[[0.87205]]]

Actual:   [[[0.8721]]]

Expected: [[[0.8721]]]