import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Con30979 = tf.keras.layers.Input(shape=([2, 2]))
in0Con13780 = tf.keras.layers.Input(shape=([2]))
in0Sub14353 = tf.keras.layers.Input(shape=([3]))
in1Sub14353 = tf.keras.layers.Input(shape=([3]))
in0Con82642 = tf.keras.layers.Input(shape=([3, 1]))
in0Sub93576 = tf.keras.layers.Input(shape=([3, 2]))
in1Sub93576 = tf.keras.layers.Input(shape=([3, 2]))

Con30979 = keras.layers.Conv1D(3, (2),strides=(1), padding='same', dilation_rate=(1), name = 'Con30979', )(in0Con30979)
Res55242 = keras.layers.Reshape((2, 3, 1), name = 'Res55242', )(Con30979)
Dep72166 = keras.layers.DepthwiseConv2D((1, 3),strides=(2, 2), padding='valid', name = 'Dep72166', )(Res55242)
Res12606 = keras.layers.Reshape((1, 1), name = 'Res12606', )(Dep72166)
Fla53106 = keras.layers.Flatten(name = 'Fla53106', )(Res12606)
Con13780 = keras.layers.Concatenate(axis=1, name = 'Con13780', )([Fla53106,in0Con13780])
Sub14353 = keras.layers.Subtract(name = 'Sub14353', )([in0Sub14353,in1Sub14353])
Add71320 = keras.layers.Add(name = 'Add71320', )([Con13780,Sub14353])
ELU28329 = keras.layers.ELU(alpha=7.815263745398255, name = 'ELU28329', )(Add71320)
Res8861 = keras.layers.Reshape((3, 1), name = 'Res8861', )(ELU28329)
Con82642 = keras.layers.Concatenate(axis=2, name = 'Con82642', )([Res8861,in0Con82642])
Sub93576 = keras.layers.Subtract(name = 'Sub93576', )([in0Sub93576,in1Sub93576])
Sub37932 = keras.layers.Subtract(name = 'Sub37932', )([Con82642,Sub93576])
model = tf.keras.models.Model(inputs=[in0Con30979,in0Con13780,in0Sub14353,in1Sub14353,in0Con82642,in0Sub93576,in1Sub93576], outputs=Sub37932)
w = model.get_layer('Con30979').get_weights() 
w[0] = np.array([[[0.0842, 0.1481, 0.7653], [0.757, 0.8488, 0.5119]], [[0.5662, 0.3046, 0.7211], [0.4664, 0.0784, 0.9595]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con30979').set_weights(w) 
w = model.get_layer('Dep72166').get_weights() 
w[0] = np.array([[[[0.0097]], [[0.5853]], [[0.7124]]]])
w[1] = np.array([0])
model.get_layer('Dep72166').set_weights(w) 
in0Con30979 = tf.constant([[[0.2898, 0.9953], [0.9853, 0.0675]]])
in0Con13780 = tf.constant([[0.1619, 0.1763]])
in0Sub14353 = tf.constant([[0.7688, 0.6738, 0.9009]])
in1Sub14353 = tf.constant([[0.7695, 0.6369, 0.8707]])
in0Con82642 = tf.constant([[[0.9419], [0.8523], [0.5231]]])
in0Sub93576 = tf.constant([[[0.7134, 0.9911], [0.0734, 0.9642], [0.6885, 0.0076]]])
in1Sub93576 = tf.constant([[[0.7348, 0.889], [0.9902, 0.0248], [0.3616, 0.4459]]])
print (np.array2string(model.predict([in0Con30979,in0Con13780,in0Sub14353,in1Sub14353,in0Con82642,in0Sub93576,in1Sub93576],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sub37932.png')

LCon30979 = conv1D_layer([[[0.2898, 0.9953], [0.9853, 0.0675]]], 2,[[[0.0842, 0.1481, 0.7653], [0.757, 0.8488, 0.5119]], [[0.5662, 0.3046, 0.7211], [0.4664, 0.0784, 0.9595]]],[0, 0, 0], 1, true, 1, Con30979), 
LRes55242 = reshape_layer(Con30979, [2, 3, 1], Res55242), 
LDep72166 = depthwise_conv2D_layer(Res55242, 1, 3,[[[[0.0097]], [[0.5853]], [[0.7124]]]],[0], 2, 2, false, Dep72166), 
LRes12606 = reshape_layer(Dep72166, [1, 1], Res12606), 
LFla53106 = flatten_layer(Res12606, Fla53106), 
LCon13780 = concatenate_layer([Fla53106,[[0.1619, 0.1763]]], 1, Con13780), 
LSub14353 = subtract_layer([[0.7688, 0.6738, 0.9009]], [[0.7695, 0.6369, 0.8707]], Sub14353), 
LAdd71320 = add_layer([Con13780,Sub14353], Add71320), 
LELU28329 = elu_layer(Add71320, 7.815263745398255, ELU28329), 
LRes8861 = reshape_layer(ELU28329, [3, 1], Res8861), 
LCon82642 = concatenate_layer([Res8861,[[[0.9419], [0.8523], [0.5231]]]], 2, Con82642), 
LSub93576 = subtract_layer([[[0.7134, 0.9911], [0.0734, 0.9642], [0.6885, 0.0076]]], [[[0.7348, 0.889], [0.9902, 0.0248], [0.3616, 0.4459]]], Sub93576), 
LSub37932 = subtract_layer(Con82642,Sub93576, Sub37932), 
exec_layers([LCon30979,LRes55242,LDep72166,LRes12606,LFla53106,LCon13780,LSub14353,LAdd71320,LELU28329,LRes8861,LCon82642,LSub93576,LSub37932],["Con30979","Res55242","Dep72166","Res12606","Fla53106","Con13780","Sub14353","Add71320","ELU28329","Res8861","Con82642","Sub93576","Sub37932"],Sub37932,"Sub37932")

Actual (Unparsed): [[[1.8055713, 0.8398000], [1.1156000, -0.0871000], [-0.1204000, 0.9614000]]]

Expected (Unparsed): [[[1.8055712876000003,0.8398],[1.1156,-0.08709999999999996],[-0.12040000000000001,0.9614]]]

Actual:   [[[1.8056, 0.8398], [1.1156, -0.0871], [-0.1204, 0.9614]]]

Expected: [[[1.8056, 0.8398], [1.1156, -0.087], [-0.1204, 0.9614]]]