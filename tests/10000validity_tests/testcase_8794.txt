import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul27357 = tf.keras.layers.Input(shape=([1, 2]))
in1Mul27357 = tf.keras.layers.Input(shape=([1, 2]))
in0Min60787 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Min60787 = tf.keras.layers.Input(shape=([2, 2, 1]))
in0Min59955 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in1Min59955 = tf.keras.layers.Input(shape=([1, 2, 1, 1]))
in0Glo23417 = tf.keras.layers.Input(shape=([1, 1]))
in0Con86034 = tf.keras.layers.Input(shape=([3]))

Mul27357 = keras.layers.Multiply(name = 'Mul27357', )([in0Mul27357,in1Mul27357])
Sof93869 = keras.layers.Softmax(axis=1, name = 'Sof93869', )(Mul27357)
Zer38936 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer38936', )(Sof93869)
Min60787 = keras.layers.Minimum(name = 'Min60787', )([in0Min60787,in1Min60787])
Res769 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res769', )(Min60787)
Min59955 = keras.layers.Minimum(name = 'Min59955', )([in0Min59955,in1Min59955])
Zer472 = keras.layers.ZeroPadding3D(padding=((1, 0), (0, 0), (0, 0)), name = 'Zer472', )(Min59955)
Mul86663 = keras.layers.Multiply(name = 'Mul86663', )([Res769,Zer472])
Res24308 = keras.layers.Reshape((2, 2, 1), name = 'Res24308', )(Mul86663)
Res1587 = keras.layers.Reshape((2, 2), name = 'Res1587', )(Res24308)
Dot76126 = keras.layers.Dot(axes=(2, 2), name = 'Dot76126', )([Zer38936,Res1587])
Fla83750 = keras.layers.Flatten(name = 'Fla83750', )(Dot76126)
Glo23417 = keras.layers.GlobalAveragePooling1D(name = 'Glo23417', )(in0Glo23417)
Con86034 = keras.layers.Concatenate(axis=1, name = 'Con86034', )([Glo23417,in0Con86034])
Max36460 = keras.layers.Maximum(name = 'Max36460', )([Fla83750,Con86034])
model = tf.keras.models.Model(inputs=[in0Mul27357,in1Mul27357,in0Min60787,in1Min60787,in0Min59955,in1Min59955,in0Glo23417,in0Con86034], outputs=Max36460)
in0Mul27357 = tf.constant([[[0.6751, 0.4314]]])
in1Mul27357 = tf.constant([[[0.0497, 0.4967]]])
in0Min60787 = tf.constant([[[[0.2791], [0.6904]], [[0.7074], [0.4384]]]])
in1Min60787 = tf.constant([[[[0.4079], [0.6284]], [[0.5163], [0.4305]]]])
in0Min59955 = tf.constant([[[[[0.4036]], [[0.9055]]]]])
in1Min59955 = tf.constant([[[[[0.1891]], [[0.1594]]]]])
in0Glo23417 = tf.constant([[[1.2364]]])
in0Con86034 = tf.constant([[0.7357, 0.646, 0.2291]])
print (np.array2string(model.predict([in0Mul27357,in1Mul27357,in0Min60787,in1Min60787,in0Min59955,in1Min59955,in0Glo23417,in0Con86034],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Max36460.png')

LMul27357 = multiply_layer([[[[0.6751, 0.4314]]], [[[0.0497, 0.4967]]]], Mul27357), 
LSof93869 = softmax_layer(Mul27357, 1, Sof93869), 
LZer38936 = zero_padding1D_layer(Sof93869, 1, 0, Zer38936), 
LMin60787 = minimum_layer([[[[[0.2791], [0.6904]], [[0.7074], [0.4384]]]], [[[[0.4079], [0.6284]], [[0.5163], [0.4305]]]]], Min60787), 
LRes769 = reshape_layer(Min60787, [2, 2, 1, 1], Res769), 
LMin59955 = minimum_layer([[[[[[0.4036]], [[0.9055]]]]], [[[[[0.1891]], [[0.1594]]]]]], Min59955), 
LZer472 = zero_padding3D_layer(Min59955, 1, 0, 0, 0, 0, 0, Zer472), 
LMul86663 = multiply_layer([Res769,Zer472], Mul86663), 
LRes24308 = reshape_layer(Mul86663, [2, 2, 1], Res24308), 
LRes1587 = reshape_layer(Res24308, [2, 2], Res1587), 
LDot76126 = dot_layer(Zer38936,Res1587, 2, 2, Dot76126), 
LFla83750 = flatten_layer(Dot76126, Fla83750), 
LGlo23417 = global_average_pooling1D_layer([[[1.2364]]], Glo23417), 
LCon86034 = concatenate_layer([Glo23417,[[0.7357, 0.646, 0.2291]]], 1, Con86034), 
LMax36460 = maximum_layer([Fla83750,Con86034], Max36460), 
exec_layers([LMul27357,LSof93869,LZer38936,LMin60787,LRes769,LMin59955,LZer472,LMul86663,LRes24308,LRes1587,LDot76126,LFla83750,LGlo23417,LCon86034,LMax36460],["Mul27357","Sof93869","Zer38936","Min60787","Res769","Min59955","Zer472","Mul86663","Res24308","Res1587","Dot76126","Fla83750","Glo23417","Con86034","Max36460"],Max36460,"Max36460")

Actual (Unparsed): [[1.2364000, 0.7357000, 0.6460000, 0.2291000]]

Expected (Unparsed): [[1.2364,0.7357,0.646,0.2291]]

Actual:   [[1.2364, 0.7357, 0.646, 0.2291]]

Expected: [[1.2364, 0.7357, 0.646, 0.2291]]