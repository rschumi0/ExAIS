import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max67378 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max67378 = tf.keras.layers.Input(shape=([2, 1, 2]))

Max67378 = keras.layers.Maximum(name = 'Max67378', )([in0Max67378,in1Max67378])
Cro31317 = keras.layers.Cropping2D(cropping=((0, 0), (0, 0)), name = 'Cro31317', )(Max67378)
Ave50772 = keras.layers.AveragePooling2D(pool_size=(1, 1), name = 'Ave50772', )(Cro31317)
Sof18277 = keras.layers.Softmax(axis=1, name = 'Sof18277', )(Ave50772)
model = tf.keras.models.Model(inputs=[in0Max67378,in1Max67378], outputs=Sof18277)
in0Max67378 = tf.constant([[[[0.9129, 0.0689]], [[0.0786, 0.1821]]]])
in1Max67378 = tf.constant([[[[0.6967, 0.3524]], [[0.7833, 0.1838]]]])
print (np.array2string(model.predict([in0Max67378,in1Max67378],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='Sof18277.png')

LMax67378 = maximum_layer([[[[[0.9129, 0.0689]], [[0.0786, 0.1821]]]], [[[[0.6967, 0.3524]], [[0.7833, 0.1838]]]]], Max67378), 
LCro31317 = cropping2D_layer(Max67378, 0, 0, 0, 0, Cro31317), 
LAve50772 = average_pooling2D_layer(Cro31317, 1, 1, Ave50772), 
LSof18277 = softmax_layer(Ave50772, 1, Sof18277), 
exec_layers([LMax67378,LCro31317,LAve50772,LSof18277],["Max67378","Cro31317","Ave50772","Sof18277"],Sof18277,"Sof18277")

Actual (Unparsed): [[[[0.5323547, 0.5420504]], [[0.4676453, 0.4579496]]]]

Expected (Unparsed): [[[[0.532354726408728,0.5420504368238119]],[[0.4676452735912719,0.457949563176188]]]]

Actual:   [[[[0.5324, 0.5421]], [[0.4677, 0.458]]]]

Expected: [[[[0.5324, 0.5421]], [[0.4677, 0.458]]]]