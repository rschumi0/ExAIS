import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot1121 = tf.keras.layers.Input(shape=([2]))
in1Dot1121 = tf.keras.layers.Input(shape=([2]))

Dot1121 = keras.layers.Dot(axes=(1, 1), name = 'Dot1121', )([in0Dot1121,in1Dot1121])
Res98337 = keras.layers.Reshape((1, 1), name = 'Res98337', )(Dot1121)
GRU39242 = keras.layers.GRU(3,reset_after=False, recurrent_activation='sigmoid', name = 'GRU39242', )(Res98337)
model = tf.keras.models.Model(inputs=[in0Dot1121,in1Dot1121], outputs=GRU39242)
w = model.get_layer('GRU39242').get_weights() 
w[0] = np.array([[2, 10, 9, 4, 3, 5, 2, 7, 4]])
w[1] = np.array([[9, 10, 10, 4, 2, 5, 4, 8, 2], [9, 6, 3, 2, 5, 1, 2, 2, 2], [6, 5, 10, 1, 2, 1, 3, 1, 2]])
w[2] = np.array([6, 7, 5, 7, 4, 3, 9, 5, 8])
model.get_layer('GRU39242').set_weights(w) 
in0Dot1121 = tf.constant([[0.2813, 0.5262]])
in1Dot1121 = tf.constant([[0.4477, 0.3807]])
print (np.array2string(model.predict([in0Dot1121,in1Dot1121],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='GRU39242.png')

LDot1121 = dot_layer([[0.2813, 0.5262]], [[0.4477, 0.3807]], 1, 1, Dot1121), 
LRes98337 = reshape_layer(Dot1121, [1, 1], Res98337), 
LGRU39242 = gru_layer(Res98337,[[2, 10, 9, 4, 3, 5, 2, 7, 4]],[[9, 10, 10, 4, 2, 5, 4, 8, 2], [9, 6, 3, 2, 5, 1, 2, 2, 2], [6, 5, 10, 1, 2, 1, 3, 1, 2]],[6, 7, 5, 7, 4, 3, 9, 5, 8], false, GRU39242), 
exec_layers([LDot1121,LRes98337,LGRU39242],["Dot1121","Res98337","GRU39242"],GRU39242,"GRU39242")

Actual (Unparsed): [[0.0012891, 0.0000349, 0.0003574]]

Expected (Unparsed): [[0.001289095286234981,3.491271892434051e-5,0.00035737725134131834]]

Actual:   [[0.0013, 0.0001, 0.0004]]

Expected: [[0.0013, 0.0001, 0.0004]]