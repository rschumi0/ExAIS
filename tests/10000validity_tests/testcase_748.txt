import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul58044 = tf.keras.layers.Input(shape=([2, 2]))
in1Mul58044 = tf.keras.layers.Input(shape=([2, 2]))
in0Max51575 = tf.keras.layers.Input(shape=([2, 2, 1]))
in1Max51575 = tf.keras.layers.Input(shape=([2, 2, 1]))

Mul58044 = keras.layers.Multiply(name = 'Mul58044', )([in0Mul58044,in1Mul58044])
Res93488 = keras.layers.Reshape((2, 2, 1), name = 'Res93488', )(Mul58044)
Max51575 = keras.layers.Maximum(name = 'Max51575', )([in0Max51575,in1Max51575])
Sub14048 = keras.layers.Subtract(name = 'Sub14048', )([Res93488,Max51575])
Res13206 = keras.layers.Reshape((2, 2), name = 'Res13206', )(Sub14048)
PRe59014 = keras.layers.PReLU(name = 'PRe59014', )(Res13206)
model = tf.keras.models.Model(inputs=[in0Mul58044,in1Mul58044,in0Max51575,in1Max51575], outputs=PRe59014)
w = model.get_layer('PRe59014').get_weights() 
w[0] = np.array([[0.3326, 0.8514], [0.8156, 0.9808]])
model.get_layer('PRe59014').set_weights(w) 
in0Mul58044 = tf.constant([[[0.6046, 0.7008], [0.9332, 0.0774]]])
in1Mul58044 = tf.constant([[[0.6263, 0.3372], [0.5935, 0.3218]]])
in0Max51575 = tf.constant([[[[0.0146], [0.5325]], [[0.9476], [0.561]]]])
in1Max51575 = tf.constant([[[[0.8687], [0.3173]], [[0.1363], [0.4032]]]])
print (np.array2string(model.predict([in0Mul58044,in1Mul58044,in0Max51575,in1Max51575],steps=1), separator=', '))
from tensorflow.keras.utils import plot_model
plot_model(model, to_file='PRe59014.png')

LMul58044 = multiply_layer([[[[0.6046, 0.7008], [0.9332, 0.0774]]], [[[0.6263, 0.3372], [0.5935, 0.3218]]]], Mul58044), 
LRes93488 = reshape_layer(Mul58044, [2, 2, 1], Res93488), 
LMax51575 = maximum_layer([[[[[0.0146], [0.5325]], [[0.9476], [0.561]]]], [[[[0.8687], [0.3173]], [[0.1363], [0.4032]]]]], Max51575), 
LSub14048 = subtract_layer(Res93488,Max51575, Sub14048), 
LRes13206 = reshape_layer(Sub14048, [2, 2], Res13206), 
LPRe59014 = prelu_layer(Res13206, [[0.3326, 0.8514], [0.8156, 0.9808]], PRe59014), 
exec_layers([LMul58044,LRes93488,LMax51575,LSub14048,LRes13206,LPRe59014],["Mul58044","Res93488","Max51575","Sub14048","Res13206","PRe59014"],PRe59014,"PRe59014")

Actual (Unparsed): [[[-0.1629870, -0.2521764], [-0.3211391, -0.5257997]]]

Expected (Unparsed): [[[-0.16298697805200002,-0.252176370336],[-0.32113907447999995,-0.525799700544]]]

Actual:   [[[-0.1629, -0.2521], [-0.3211, -0.5257]]]

Expected: [[[-0.1629, -0.2521], [-0.3211, -0.5257]]]