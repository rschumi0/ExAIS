import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Per89572 = tf.keras.layers.Input(shape=([1, 1]))
in0Con87147 = tf.keras.layers.Input(shape=([1, 1, 1]))
in0Mul13825 = tf.keras.layers.Input(shape=([1, 1, 2]))
in1Mul13825 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Ave80703 = tf.keras.layers.Input(shape=([2, 1, 1]))
in1Ave80703 = tf.keras.layers.Input(shape=([2, 1, 1]))
in0Con3184 = tf.keras.layers.Input(shape=([2, 1]))
in0Max74603 = tf.keras.layers.Input(shape=([2, 2]))
in0Con91356 = tf.keras.layers.Input(shape=([1, 2, 1]))
in0Max29928 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))
in1Max29928 = tf.keras.layers.Input(shape=([2, 2, 1, 2]))

Per89572 = keras.layers.Permute((2,1), name = 'Per89572',)(in0Per89572)
Res59966 = keras.layers.Reshape((1, 1, 1), name = 'Res59966', )(Per89572)
Con87147 = keras.layers.Concatenate(axis=3, name = 'Con87147', )([Res59966,in0Con87147])
Mul13825 = keras.layers.Multiply(name = 'Mul13825', )([in0Mul13825,in1Mul13825])
Ave69214 = keras.layers.Average(name = 'Ave69214', )([Con87147,Mul13825])
Res33853 = keras.layers.Reshape((1, 2), name = 'Res33853', )(Ave69214)
Zer91256 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer91256', )(Res33853)
Ave80703 = keras.layers.Average(name = 'Ave80703', )([in0Ave80703,in1Ave80703])
Sof86939 = keras.layers.Softmax(axis=1, name = 'Sof86939', )(Ave80703)
Res58734 = keras.layers.Reshape((2, 1), name = 'Res58734', )(Sof86939)
Con3184 = keras.layers.Concatenate(axis=2, name = 'Con3184', )([Res58734,in0Con3184])
Max74603 = keras.layers.MaxPool1D(pool_size=(1), strides=(3), padding='valid', name = 'Max74603', )(in0Max74603)
Res87812 = keras.layers.Reshape((1, 2, 1), name = 'Res87812', )(Max74603)
Con91356 = keras.layers.Concatenate(axis=3, name = 'Con91356', )([Res87812,in0Con91356])
Max29928 = keras.layers.Maximum(name = 'Max29928', )([in0Max29928,in1Max29928])
Res756 = keras.layers.Reshape((2, 2, 2), name = 'Res756', )(Max29928)
Max20862 = keras.layers.MaxPool2D(pool_size=(2, 1), name = 'Max20862', )(Res756)
Max3024 = keras.layers.Maximum(name = 'Max3024', )([Con91356,Max20862])
Res8608 = keras.layers.Reshape((1, 4), name = 'Res8608', )(Max3024)
Zer24509 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer24509', )(Res8608)
Dot94833 = keras.layers.Dot(axes=(2, 1), name = 'Dot94833', )([Con3184,Zer24509])
Mul11869 = keras.layers.Multiply(name = 'Mul11869', )([Zer91256,Dot94833])
model = tf.keras.models.Model(inputs=[in0Per89572,in0Con87147,in0Mul13825,in1Mul13825,in0Ave80703,in1Ave80703,in0Con3184,in0Max74603,in0Con91356,in0Max29928,in1Max29928], outputs=Mul11869)
in0Per89572 = tf.constant([[[1.8889]]])
in0Con87147 = tf.constant([[[[0.5502]]]])
in0Mul13825 = tf.constant([[[[0.5817, 0.6635]]]])
in1Mul13825 = tf.constant([[[[0.0782, 0.2541]]]])
in0Ave80703 = tf.constant([[[[0.1841]], [[0.3201]]]])
in1Ave80703 = tf.constant([[[[0.454]], [[0.0881]]]])
in0Con3184 = tf.constant([[[0.8059], [0.1581]]])
in0Max74603 = tf.constant([[[1.2597, 1.748], [1.5939, 1.9803]]])
in0Con91356 = tf.constant([[[[0.1777], [0.1828]]]])
in0Max29928 = tf.constant([[[[[0.4242, 0.0588]], [[0.6346, 0.8462]]], [[[0.3758, 0.9411]], [[0.2218, 0.7342]]]]])
in1Max29928 = tf.constant([[[[[0.7584, 0.2504]], [[0.6968, 0.2926]]], [[[0.828, 0.5373]], [[0.8558, 0.1551]]]]])
print (np.array2string(model.predict([in0Per89572,in0Con87147,in0Mul13825,in1Mul13825,in0Ave80703,in1Ave80703,in0Con3184,in0Max74603,in0Con91356,in0Max29928,in1Max29928],steps=1), separator=', '))


LPer89572 = permute_layer([[[1.8889]]], 2,1, Per89572), 
LRes59966 = reshape_layer(Per89572, [1, 1, 1], Res59966), 
LCon87147 = concatenate_layer([Res59966,[[[[0.5502]]]]], 3, Con87147), 
LMul13825 = multiply_layer([[[[[0.5817, 0.6635]]]], [[[[0.0782, 0.2541]]]]], Mul13825), 
LAve69214 = average_layer([Con87147,Mul13825], Ave69214), 
LRes33853 = reshape_layer(Ave69214, [1, 2], Res33853), 
LZer91256 = zero_padding1D_layer(Res33853, 1, 0, Zer91256), 
LAve80703 = average_layer([[[[[0.1841]], [[0.3201]]]], [[[[0.454]], [[0.0881]]]]], Ave80703), 
LSof86939 = softmax_layer(Ave80703, 1, Sof86939), 
LRes58734 = reshape_layer(Sof86939, [2, 1], Res58734), 
LCon3184 = concatenate_layer([Res58734,[[[0.8059], [0.1581]]]], 2, Con3184), 
LMax74603 = max_pool1D_layer([[[1.2597, 1.748], [1.5939, 1.9803]]], 1, 3, false, Max74603), 
LRes87812 = reshape_layer(Max74603, [1, 2, 1], Res87812), 
LCon91356 = concatenate_layer([Res87812,[[[[0.1777], [0.1828]]]]], 3, Con91356), 
LMax29928 = maximum_layer([[[[[[0.4242, 0.0588]], [[0.6346, 0.8462]]], [[[0.3758, 0.9411]], [[0.2218, 0.7342]]]]], [[[[[0.7584, 0.2504]], [[0.6968, 0.2926]]], [[[0.828, 0.5373]], [[0.8558, 0.1551]]]]]], Max29928), 
LRes756 = reshape_layer(Max29928, [2, 2, 2], Res756), 
LMax20862 = max_pool2D_layer(Res756, 2, 1, Max20862), 
LMax3024 = maximum_layer([Con91356,Max20862], Max3024), 
LRes8608 = reshape_layer(Max3024, [1, 4], Res8608), 
LZer24509 = zero_padding1D_layer(Res8608, 1, 0, Zer24509), 
LDot94833 = dot_layer(Con3184,Zer24509, 2, 1, Dot94833), 
LMul11869 = multiply_layer([Zer91256,Dot94833], Mul11869), 
exec_layers([LPer89572,LRes59966,LCon87147,LMul13825,LAve69214,LRes33853,LZer91256,LAve80703,LSof86939,LRes58734,LCon3184,LMax74603,LRes87812,LCon91356,LMax29928,LRes756,LMax20862,LMax3024,LRes8608,LZer24509,LDot94833,LMul11869],["Per89572","Res59966","Con87147","Mul13825","Ave69214","Res33853","Zer91256","Ave80703","Sof86939","Res58734","Con3184","Max74603","Res87812","Con91356","Max29928","Res756","Max20862","Max3024","Res8608","Zer24509","Dot94833","Mul11869"],Mul11869,"Mul11869")

Actual (Unparsed): 
 ValueError(ValueError: Operands could not be broadcast together with shapes (2, 2) (2, 4)

Expected (Unparsed): 
Mul11869: Inconsistent Input Shapes, Input Shape [1,2,2]

Actual:   

Expected: 