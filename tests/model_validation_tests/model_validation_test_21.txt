import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Max20242 = tf.keras.layers.Input(shape=([2, 1, 2]))
in1Max20242 = tf.keras.layers.Input(shape=([2, 1, 2]))
in0Con57358 = tf.keras.layers.Input(shape=([2, 6]))
in0Mul65930 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in1Mul65930 = tf.keras.layers.Input(shape=([2, 2, 2, 2]))
in0Sub46184 = tf.keras.layers.Input(shape=([2, 2, 3]))
in1Sub46184 = tf.keras.layers.Input(shape=([2, 2, 3]))

Max20242 = keras.layers.Maximum(name = 'Max20242', )([in0Max20242,in1Max20242])
Res67703 = keras.layers.Reshape((2, 2), name = 'Res67703', )(Max20242)
Con57358 = keras.layers.Concatenate(axis=2, name = 'Con57358', )([Res67703,in0Con57358])
Mul65930 = keras.layers.Multiply(name = 'Mul65930', )([in0Mul65930,in1Mul65930])
Res41381 = keras.layers.Reshape((2, 2, 4), name = 'Res41381', )(Mul65930)
Res38444 = keras.layers.Reshape((2, 8), name = 'Res38444', )(Res41381)
Sub46184 = keras.layers.Subtract(name = 'Sub46184', )([in0Sub46184,in1Sub46184])
Res14762 = keras.layers.Reshape((2, 6), name = 'Res14762', )(Sub46184)
Dot44177 = keras.layers.Dot(axes=(1, 1), name = 'Dot44177', )([Res38444,Res14762])
Dot99236 = keras.layers.Dot(axes=(2, 2), name = 'Dot99236', )([Con57358,Dot44177])
model = tf.keras.models.Model(inputs=[in0Max20242,in1Max20242,in0Con57358,in0Mul65930,in1Mul65930,in0Sub46184,in1Sub46184], outputs=Dot99236)
in0Max20242 = tf.constant([[[[0.3059, 0.5105]], [[0.2443, 0.5597]]]])
in1Max20242 = tf.constant([[[[0.7977, 0.6055]], [[0.4076, 0.3455]]]])
in0Con57358 = tf.constant([[[0.8417, 0.728, 0.5868, 0.4009, 0.9819, 0.6127], [0.4007, 0.7629, 0.7656, 0.6454, 0.2277, 0.9881]]])
in0Mul65930 = tf.constant([[[[[0.6366, 0.4784], [0.9373, 0.2716]], [[0.2759, 0.9374], [0.0907, 0.8805]]], [[[0.2081, 0.8414], [0.9471, 0.8244]], [[0.6253, 0.4734], [0.4198, 0.7893]]]]])
in1Mul65930 = tf.constant([[[[[0.0975, 0.1838], [0.55, 0.3007]], [[0.5751, 0.6039], [0.6224, 0.8271]]], [[[0.658, 0.1926], [0.2395, 0.1374]], [[0.8713, 0.7393], [0.7332, 0.3078]]]]])
in0Sub46184 = tf.constant([[[[0.6338, 0.7195, 0.1997], [0.1254, 0.7158, 0.0753]], [[0.0009, 0.8869, 0.242], [0.0747, 0.7915, 0.7553]]]])
in1Sub46184 = tf.constant([[[[0.716, 0.3961, 0.0051], [0.9032, 0.1189, 0.4763]], [[0.258, 0.6452, 0.863], [0.4647, 0.3153, 0.6414]]]])
print (np.array2string(model.predict([in0Max20242,in1Max20242,in0Con57358,in0Mul65930,in1Mul65930,in0Sub46184,in1Sub46184],steps=1), separator=', '))


LMax20242 = maximum_layer([[[[[0.3059, 0.5105]], [[0.2443, 0.5597]]]], [[[[0.7977, 0.6055]], [[0.4076, 0.3455]]]]], Max20242), 
LRes67703 = reshape_layer(Max20242, [2, 2], Res67703), 
LCon57358 = concatenate_layer([Res67703,[[[0.8417, 0.728, 0.5868, 0.4009, 0.9819, 0.6127], [0.4007, 0.7629, 0.7656, 0.6454, 0.2277, 0.9881]]]], 2, Con57358), 
LMul65930 = multiply_layer([[[[[[0.6366, 0.4784], [0.9373, 0.2716]], [[0.2759, 0.9374], [0.0907, 0.8805]]], [[[0.2081, 0.8414], [0.9471, 0.8244]], [[0.6253, 0.4734], [0.4198, 0.7893]]]]], [[[[[0.0975, 0.1838], [0.55, 0.3007]], [[0.5751, 0.6039], [0.6224, 0.8271]]], [[[0.658, 0.1926], [0.2395, 0.1374]], [[0.8713, 0.7393], [0.7332, 0.3078]]]]]], Mul65930), 
LRes41381 = reshape_layer(Mul65930, [2, 2, 4], Res41381), 
LRes38444 = reshape_layer(Res41381, [2, 8], Res38444), 
LSub46184 = subtract_layer([[[[0.6338, 0.7195, 0.1997], [0.1254, 0.7158, 0.0753]], [[0.0009, 0.8869, 0.242], [0.0747, 0.7915, 0.7553]]]], [[[[0.716, 0.3961, 0.0051], [0.9032, 0.1189, 0.4763]], [[0.258, 0.6452, 0.863], [0.4647, 0.3153, 0.6414]]]], Sub46184), 
LRes14762 = reshape_layer(Sub46184, [2, 6], Res14762), 
LDot44177 = dot_layer(Res38444,Res14762, 1, 1, Dot44177), 
LDot99236 = dot_layer(Con57358,Dot44177, 2, 2, Dot99236), 
exec_layers([LMax20242,LRes67703,LCon57358,LMul65930,LRes41381,LRes38444,LSub46184,LRes14762,LDot44177,LDot99236],["Max20242","Res67703","Con57358","Mul65930","Res41381","Res38444","Sub46184","Res14762","Dot44177","Dot99236"],Dot99236,"Dot99236")

Actual (Unparsed): 
 ValueError('Dimension incompatibility 'ValueError: Dimension incompatibility 8 != 6. Layer shapes: (None, 2, 8), (None, 8, 6). Chosen axes: 2, 2

Expected (Unparsed): 
Dot99236: Dot Axis Error, Input Shape [1,2,8]

Actual:   

Expected: 