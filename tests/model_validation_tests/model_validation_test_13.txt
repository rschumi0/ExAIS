import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo1182 = tf.keras.layers.Input(shape=([2, 1, 1]))

Glo1182 = keras.layers.GlobalAveragePooling2D(name = 'Glo1182', )(in0Glo1182)
Res23315 = keras.layers.Reshape((1, 1), name = 'Res23315', )(Glo1182)
Per90902 = keras.layers.Permute((2,1), name = 'Per90902',)(Res23315)
Fla50024 = keras.layers.Flatten(name = 'Fla50024', )(Per90902)
Sep32430 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='valid', name = 'Sep32430', )(Fla50024)
Lea9599 = keras.layers.LeakyReLU(alpha=2.6511955122817032, name = 'Lea9599', )(Sep32430)
model = tf.keras.models.Model(inputs=[in0Glo1182], outputs=Lea9599)
w = model.get_layer('Sep32430').get_weights() 
w[0] = np.array([[[0.5367], [0.1744]]])
w[1] = np.array([[[0.5024, 0.7962, 0.5953, 0.0485], [0.0117, 0.2996, 0.9454, 0.7702]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep32430').set_weights(w) 
in0Glo1182 = tf.constant([[[[1.9828]], [[1.6319]]]])
print (np.array2string(model.predict([in0Glo1182],steps=1), separator=', '))


LGlo1182 = global_average_pooling2D_layer([[[[1.9828]], [[1.6319]]]], Glo1182), 
LRes23315 = reshape_layer(Glo1182, [1, 1], Res23315), 
LPer90902 = permute_layer(Res23315, 2,1, Per90902), 
LFla50024 = flatten_layer(Per90902, Fla50024), 
LSep32430 = separable_conv1D_layer(Fla50024, 1,[[[[0.5367], [0.1744]]],[[[0.5024, 0.7962, 0.5953, 0.0485], [0.0117, 0.2996, 0.9454, 0.7702]]]],[0, 0, 0, 0], 1, false, Sep32430), 
LLea9599 = leaky_relu_layer(Sep32430, 2.6511955122817032, Lea9599), 
exec_layers([LGlo1182,LRes23315,LPer90902,LFla50024,LSep32430,LLea9599],["Glo1182","Res23315","Per90902","Fla50024","Sep32430","Lea9599"],Lea9599,"Lea9599")

Actual (Unparsed): 
 ValueError('Input ' + str(input_index) + ' of layer ' +ValueError: Input 0 of layer Sep32430 is incompatible with the layer: : expected min_ndim=3, found ndim=2. Full shape received: (None, 1)

Expected (Unparsed): 
Sep32430: Dimension error, Input Shape [1,1]

Actual:   

Expected: 