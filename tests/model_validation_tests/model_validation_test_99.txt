import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave9359 = tf.keras.layers.Input(shape=([1, 2]))
in1Ave9359 = tf.keras.layers.Input(shape=([1, 2]))
in0Con45042 = tf.keras.layers.Input(shape=([1, 1, 2]))
in0Dot92261 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot92261 = tf.keras.layers.Input(shape=([2, 3]))
in0Min58206 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))
in1Min58206 = tf.keras.layers.Input(shape=([2, 2, 2, 1]))

Ave9359 = keras.layers.Average(name = 'Ave9359', )([in0Ave9359,in1Ave9359])
Res32600 = keras.layers.Reshape((1, 2, 1), name = 'Res32600', )(Ave9359)
Res2541 = keras.layers.Reshape((1, 2, 1, 1), name = 'Res2541', )(Res32600)
Cro60940 = keras.layers.Cropping3D(cropping=((0, 0), (1, 0), (0, 0)), name = 'Cro60940', )(Res2541)
Res91231 = keras.layers.Reshape((1, 1, 1), name = 'Res91231', )(Cro60940)
Con45042 = keras.layers.Concatenate(axis=3, name = 'Con45042', )([Res91231,in0Con45042])
Dot92261 = keras.layers.Dot(axes=(1, 1), name = 'Dot92261', )([in0Dot92261,in1Dot92261])
Res62891 = keras.layers.Reshape((3, 3, 1), name = 'Res62891', )(Dot92261)
Max66561 = keras.layers.MaxPool2D(pool_size=(3, 3), name = 'Max66561', )(Res62891)
Sep71490 = keras.layers.SeparableConv2D(3, (1, 1),strides=(1, 1), padding='same', name = 'Sep71490', )(Max66561)
Sub18818 = keras.layers.Subtract(name = 'Sub18818', )([Con45042,Sep71490])
Res66471 = keras.layers.Reshape((1, 1, 3, 1), name = 'Res66471', )(Sub18818)
Zer33881 = keras.layers.ZeroPadding3D(padding=((1, 0), (1, 0), (1, 0)), name = 'Zer33881', )(Res66471)
Min58206 = keras.layers.Minimum(name = 'Min58206', )([in0Min58206,in1Min58206])
Sub58687 = keras.layers.Subtract(name = 'Sub58687', )([Zer33881,Min58206])
model = tf.keras.models.Model(inputs=[in0Ave9359,in1Ave9359,in0Con45042,in0Dot92261,in1Dot92261,in0Min58206,in1Min58206], outputs=Sub58687)
w = model.get_layer('Sep71490').get_weights() 
w[0] = np.array([[[[0.1477]]]])
w[1] = np.array([[[[0.1513, 0.5485, 0.3949]]]])
w[2] = np.array([0, 0, 0])
model.get_layer('Sep71490').set_weights(w) 
in0Ave9359 = tf.constant([[[0.0376, 0.8404]]])
in1Ave9359 = tf.constant([[[0.8401, 0.5696]]])
in0Con45042 = tf.constant([[[[0.0627, 0.8342]]]])
in0Dot92261 = tf.constant([[[0.9089, 0.8267, 0.2299], [0.9849, 0.4094, 0.6776]]])
in1Dot92261 = tf.constant([[[0.0001, 0.315, 0.7977], [0.3723, 0.8108, 0.4448]]])
in0Min58206 = tf.constant([[[[[0.7431], [0.2789]], [[0.2402], [0.3724]]], [[[0.5824], [0.8339]], [[0.3329], [0.7889]]]]])
in1Min58206 = tf.constant([[[[[0.9576], [0.0387]], [[0.0291], [0.9915]]], [[[0.1162], [0.1943]], [[0.2973], [0.4534]]]]])
print (np.array2string(model.predict([in0Ave9359,in1Ave9359,in0Con45042,in0Dot92261,in1Dot92261,in0Min58206,in1Min58206],steps=1), separator=', '))


LAve9359 = average_layer([[[[0.0376, 0.8404]]], [[[0.8401, 0.5696]]]], Ave9359), 
LRes32600 = reshape_layer(Ave9359, [1, 2, 1], Res32600), 
LRes2541 = reshape_layer(Res32600, [1, 2, 1, 1], Res2541), 
LCro60940 = cropping3D_layer(Res2541, 0, 0, 1, 0, 0, 0, Cro60940), 
LRes91231 = reshape_layer(Cro60940, [1, 1, 1], Res91231), 
LCon45042 = concatenate_layer([Res91231,[[[[0.0627, 0.8342]]]]], 3, Con45042), 
LDot92261 = dot_layer([[[0.9089, 0.8267, 0.2299], [0.9849, 0.4094, 0.6776]]], [[[0.0001, 0.315, 0.7977], [0.3723, 0.8108, 0.4448]]], 1, 1, Dot92261), 
LRes62891 = reshape_layer(Dot92261, [3, 3, 1], Res62891), 
LMax66561 = max_pool2D_layer(Res62891, 3, 3, Max66561), 
LSep71490 = separable_conv2D_layer(Max66561, 1, 1,[[[[[0.1477]]]],[[[[0.1513, 0.5485, 0.3949]]]]],[0, 0, 0], 1, 1, true, Sep71490), 
LSub18818 = subtract_layer(Con45042,Sep71490, Sub18818), 
LRes66471 = reshape_layer(Sub18818, [1, 1, 3, 1], Res66471), 
LZer33881 = zero_padding3D_layer(Res66471, 1, 0, 1, 0, 1, 0, Zer33881), 
LMin58206 = minimum_layer([[[[[[0.7431], [0.2789]], [[0.2402], [0.3724]]], [[[0.5824], [0.8339]], [[0.3329], [0.7889]]]]], [[[[[0.9576], [0.0387]], [[0.0291], [0.9915]]], [[[0.1162], [0.1943]], [[0.2973], [0.4534]]]]]], Min58206), 
LSub58687 = subtract_layer(Zer33881,Min58206, Sub58687), 
exec_layers([LAve9359,LRes32600,LRes2541,LCro60940,LRes91231,LCon45042,LDot92261,LRes62891,LMax66561,LSep71490,LSub18818,LRes66471,LZer33881,LMin58206,LSub58687],["Ave9359","Res32600","Res2541","Cro60940","Res91231","Con45042","Dot92261","Res62891","Max66561","Sep71490","Sub18818","Res66471","Zer33881","Min58206","Sub58687"],Sub58687,"Sub58687")

Actual (Unparsed): 
 ValueError(ValueError: Operands could not be broadcast together with shapes (2, 2, 4, 1) (2, 2, 2, 1)

Expected (Unparsed): 
Sub58687: Inconsistent Input Shapes, Input Shape [1,2,2,4,1]

Actual:   

Expected: 