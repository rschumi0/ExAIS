import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot41888 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot41888 = tf.keras.layers.Input(shape=([2, 3]))

Dot41888 = keras.layers.Dot(axes=(2, 2), name = 'Dot41888', )([in0Dot41888,in1Dot41888])
Res81352 = keras.layers.Reshape((2, 2, 1), name = 'Res81352', )(Dot41888)
Res59937 = keras.layers.Reshape((2, 2, 1, 1), name = 'Res59937', )(Res81352)
Cro75857 = keras.layers.Cropping3D(cropping=((0, 0), (1, 0), (0, 0)), name = 'Cro75857', )(Res59937)
Dep32022 = keras.layers.DepthwiseConv2D((2, 1),strides=(2, 2), padding='same', name = 'Dep32022', )(Cro75857)
model = tf.keras.models.Model(inputs=[in0Dot41888,in1Dot41888], outputs=Dep32022)
w = model.get_layer('Dep32022').get_weights() 
w[0] = np.array([[[[0.4385], [0.356]]], [[[0.0691], [0.2093]]]])
w[1] = np.array([0, 0])
model.get_layer('Dep32022').set_weights(w) 
in0Dot41888 = tf.constant([[[0.0103, 0.4665, 0.8227], [0.0742, 0.8281, 0.6416]]])
in1Dot41888 = tf.constant([[[0.7703, 0.0395, 0.959], [0.5375, 0.6102, 0.5849]]])
print (np.array2string(model.predict([in0Dot41888,in1Dot41888],steps=1), separator=', '))


LDot41888 = dot_layer([[[0.0103, 0.4665, 0.8227], [0.0742, 0.8281, 0.6416]]], [[[0.7703, 0.0395, 0.959], [0.5375, 0.6102, 0.5849]]], 2, 2, Dot41888), 
LRes81352 = reshape_layer(Dot41888, [2, 2, 1], Res81352), 
LRes59937 = reshape_layer(Res81352, [2, 2, 1, 1], Res59937), 
LCro75857 = cropping3D_layer(Res59937, 0, 0, 1, 0, 0, 0, Cro75857), 
LDep32022 = depthwise_conv2D_layer(Cro75857, 2, 1,[[[[0.4385], [0.356]]], [[[0.0691], [0.2093]]]],[0, 0], 2, 2, true, Dep32022), 
exec_layers([LDot41888,LRes81352,LRes59937,LCro75857,LDep32022],["Dot41888","Res81352","Res59937","Cro75857","Dep32022"],Dep32022,"Dep32022")

Actual (Unparsed): 
 ValueError(str(e))ValueError: Shape must be rank 4 but is rank 5 for '{{node Dep32022/depthwise}} = DepthwiseConv2dNative[T=DT_DOUBLE, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="SAME", strides=[1, 2, 2, 1]](Placeholder, Dep32022/depthwise/ReadVariableOp)' with input shapes: [?,2,1,1,1], [2,1,1,1].

Expected (Unparsed): 
Dep32022: Dimension error, Input Shape [1,2,1,1,1]

Actual:   

Expected: 