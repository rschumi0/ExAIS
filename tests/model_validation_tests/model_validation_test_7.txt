import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave21169 = tf.keras.layers.Input(shape=([2, 2]))
in1Ave21169 = tf.keras.layers.Input(shape=([2, 2]))
in0Con65216 = tf.keras.layers.Input(shape=([2, 2]))

Ave21169 = keras.layers.Average(name = 'Ave21169', )([in0Ave21169,in1Ave21169])
Thr16976 = keras.layers.ThresholdedReLU(theta=6.702226397717224, name = 'Thr16976', )(Ave21169)
Res66450 = keras.layers.Reshape((2, 2, 1), name = 'Res66450', )(Thr16976)
Con23073 = keras.layers.Conv2DTranspose(2, (1, 2),strides=(1, 1), padding='same', name = 'Con23073', )(Res66450)
Cro89906 = keras.layers.Cropping2D(cropping=((1, 0), (0, 0)), name = 'Cro89906', )(Con23073)
Con65216 = keras.layers.Conv1D(4, (2),strides=(11), padding='same', dilation_rate=(1), name = 'Con65216', )(in0Con65216)
Max63729 = keras.layers.Maximum(name = 'Max63729', )([Cro89906,Con65216])
model = tf.keras.models.Model(inputs=[in0Ave21169,in1Ave21169,in0Con65216], outputs=Max63729)
w = model.get_layer('Con23073').get_weights() 
w[0] = np.array([[[[0.5318], [0.6113]], [[0.8674], [0.1602]]]])
w[1] = np.array([0, 0])
model.get_layer('Con23073').set_weights(w) 
w = model.get_layer('Con65216').get_weights() 
w[0] = np.array([[[0.1521, 0.839, 0.5604, 0.0747], [0.7783, 0.7694, 0.9888, 0.7621]], [[0.5347, 0.7565, 0.428, 0.034], [0.7096, 0.7172, 0.3119, 0.9503]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con65216').set_weights(w) 
in0Ave21169 = tf.constant([[[0.0878, 0.9177], [0.4044, 0.7479]]])
in1Ave21169 = tf.constant([[[0.9447, 0.0824], [0.946, 0.223]]])
in0Con65216 = tf.constant([[[0.3344, 0.2534], [0.3814, 0.8847]]])
print (np.array2string(model.predict([in0Ave21169,in1Ave21169,in0Con65216],steps=1), separator=', '))


LAve21169 = average_layer([[[[0.0878, 0.9177], [0.4044, 0.7479]]], [[[0.9447, 0.0824], [0.946, 0.223]]]], Ave21169), 
LThr16976 = thresholded_relu_layer(Ave21169, 6.702226397717224, Thr16976), 
LRes66450 = reshape_layer(Thr16976, [2, 2, 1], Res66450), 
LCon23073 = conv2D_transpose_layer(Res66450, 1, 2,[[[[0.5318], [0.6113]], [[0.8674], [0.1602]]]],[0, 0], 1, 1, true, Con23073), 
LCro89906 = cropping2D_layer(Con23073, 1, 0, 0, 0, Cro89906), 
LCon65216 = conv1D_layer([[[0.3344, 0.2534], [0.3814, 0.8847]]], 2,[[[0.1521, 0.839, 0.5604, 0.0747], [0.7783, 0.7694, 0.9888, 0.7621]], [[0.5347, 0.7565, 0.428, 0.034], [0.7096, 0.7172, 0.3119, 0.9503]]],[0, 0, 0, 0], 11, true, 1, Con65216), 
LMax63729 = maximum_layer([Cro89906,Con65216], Max63729), 
exec_layers([LAve21169,LThr16976,LRes66450,LCon23073,LCro89906,LCon65216,LMax63729],["Ave21169","Thr16976","Res66450","Con23073","Cro89906","Con65216","Max63729"],Max63729,"Max63729")

Actual (Unparsed): 
 ValueError(ValueError: Operands could not be broadcast together with shapes (1, 2, 2) (1, 4)

Expected (Unparsed): 
Max63729: Inconsistent Input Dimensions, Input Shape [1,1,2,2]

Actual:   

Expected: 