import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot76588 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot76588 = tf.keras.layers.Input(shape=([2, 3]))

Dot76588 = keras.layers.Dot(axes=(1, 1), name = 'Dot76588', )([in0Dot76588,in1Dot76588])
Sim33457 = keras.layers.SimpleRNN(1,name = 'Sim33457', )(Dot76588)
Res41494 = keras.layers.Reshape((1, 1), name = 'Res41494', )(Sim33457)
Glo11621 = keras.layers.GlobalMaxPool1D(name = 'Glo11621', )(Res41494)
Res79296 = keras.layers.Reshape((1, 1), name = 'Res79296', )(Glo11621)
Res62752 = keras.layers.Reshape((1, 1, 1), name = 'Res62752', )(Res79296)
Zer64090 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer64090', )(Res62752)
model = tf.keras.models.Model(inputs=[in0Dot76588,in1Dot76588], outputs=Zer64090)
w = model.get_layer('Sim33457').get_weights() 
w[0] = np.array([[1], [3], [8]])
w[1] = np.array([[4]])
w[2] = np.array([8])
model.get_layer('Sim33457').set_weights(w) 
in0Dot76588 = tf.constant([[[0.2968, 0.2901, 0.0629], [0.5977, 0.0373, 0.3604]]])
in1Dot76588 = tf.constant([[[0.9272, 0.8626, 0.1764], [0.8056, 0.6195, 0.9412]]])
print (np.array2string(model.predict([in0Dot76588,in1Dot76588],steps=1), separator=', '))


LDot76588 = dot_layer([[[0.2968, 0.2901, 0.0629], [0.5977, 0.0373, 0.3604]]], [[[0.9272, 0.8626, 0.1764], [0.8056, 0.6195, 0.9412]]], 1, 1, Dot76588), 
LSim33457 = simple_rnn_layer(Dot76588,[[1], [3], [8]],[[4]],[8], Sim33457), 
LRes41494 = reshape_layer(Sim33457, [1, 1], Res41494), 
LGlo11621 = global_max_pool1D_layer(Res41494, Glo11621), 
LRes79296 = reshape_layer(Glo11621, [1, 1], Res79296), 
LRes62752 = reshape_layer(Res79296, [1, 1, 1], Res62752), 
LZer64090 = zero_padding3D_layer(Res62752, 1, 1, 1, 1, 1, 1, Zer64090), 
exec_layers([LDot76588,LSim33457,LRes41494,LGlo11621,LRes79296,LRes62752,LZer64090],["Dot76588","Sim33457","Res41494","Glo11621","Res79296","Res62752","Zer64090"],Zer64090,"Zer64090")

Actual (Unparsed): 
 ValueError('Input ' + str(input_index) + ' of layer ' +ValueError: Input 0 of layer Zer64090 is incompatible with the layer: expected ndim=5, found ndim=4. Full shape received: (None, 1, 1, 1)

Expected (Unparsed): 
Zer64090: Dimension error, Input Shape [1,1,1,1]

Actual:   

Expected: 