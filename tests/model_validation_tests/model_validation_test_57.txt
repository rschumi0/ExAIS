import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0LST52726 = tf.keras.layers.Input(shape=([1, 1]))

LST52726 = keras.layers.RNN(keras.layers.LSTMCell(3,recurrent_activation='sigmoid', ), name = 'LST52726', input_shape=(1, 1))(in0LST52726)
Res70748 = keras.layers.Reshape((3, 1), name = 'Res70748', )(LST52726)
Loc33316 = keras.layers.LocallyConnected1D(4, (3),strides=(2), name = 'Loc33316', )(Res70748)
Res36125 = keras.layers.Reshape((1, 4, 1), name = 'Res36125', )(Loc33316)
Glo30872 = keras.layers.GlobalMaxPool3D(name = 'Glo30872', )(Res36125)
model = tf.keras.models.Model(inputs=[in0LST52726], outputs=Glo30872)
w = model.get_layer('LST52726').get_weights() 
w[0] = np.array([[9, 10, 10, 5, 6, 1, 2, 3, 6, 3, 4, 6]])
w[1] = np.array([[2, 2, 8, 3, 7, 6, 9, 9, 9, 2, 3, 5], [8, 10, 6, 8, 5, 3, 2, 2, 1, 9, 5, 1], [4, 3, 8, 9, 8, 4, 6, 7, 1, 2, 3, 1]])
w[2] = np.array([2, 6, 1, 7, 10, 8, 10, 6, 10, 6, 4, 4])
model.get_layer('LST52726').set_weights(w) 
w = model.get_layer('Loc33316').get_weights() 
w[0] = np.array([[[0.4111, 0.2031, 0.8177, 0.5248], [0.105, 0.4436, 0.8217, 0.6155], [0.7154, 0.1796, 0.6525, 0.3546]]])
w[1] = np.array([[0, 0, 0, 0]])
model.get_layer('Loc33316').set_weights(w) 
in0LST52726 = tf.constant([[[5]]])
print (np.array2string(model.predict([in0LST52726],steps=1), separator=', '))


LLST52726 = lstmcell_layer([[[5]]],[[9, 10, 10, 5, 6, 1, 2, 3, 6, 3, 4, 6]],[[2, 2, 8, 3, 7, 6, 9, 9, 9, 2, 3, 5], [8, 10, 6, 8, 5, 3, 2, 2, 1, 9, 5, 1], [4, 3, 8, 9, 8, 4, 6, 7, 1, 2, 3, 1]],[2, 6, 1, 7, 10, 8, 10, 6, 10, 6, 4, 4], LST52726), 
LRes70748 = reshape_layer(LST52726, [3, 1], Res70748), 
LLoc33316 = locally_connected1D_layer(Res70748, 3,[[[0.4111, 0.2031, 0.8177, 0.5248], [0.105, 0.4436, 0.8217, 0.6155], [0.7154, 0.1796, 0.6525, 0.3546]]],[[0, 0, 0, 0]], 2, Loc33316), 
LRes36125 = reshape_layer(Loc33316, [1, 4, 1], Res36125), 
LGlo30872 = global_max_pool3D_layer(Res36125, Glo30872), 
exec_layers([LLST52726,LRes70748,LLoc33316,LRes36125,LGlo30872],["LST52726","Res70748","Loc33316","Res36125","Glo30872"],Glo30872,"Glo30872")

Actual (Unparsed): 
 ValueError('Input ' + str(input_index) + ' of layer ' +ValueError: Input 0 of layer Glo30872 is incompatible with the layer: expected ndim=5, found ndim=4. Full shape received: (None, 1, 4, 1)

Expected (Unparsed): 
Glo30872: Dimension error, Input Shape [1,1,4,1]

Actual:   

Expected: 