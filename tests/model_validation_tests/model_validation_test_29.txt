import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Dot40787 = tf.keras.layers.Input(shape=([3, 2]))
in1Dot40787 = tf.keras.layers.Input(shape=([3, 2]))
in0Con69744 = tf.keras.layers.Input(shape=([2, 1]))
in0Sub90933 = tf.keras.layers.Input(shape=([3, 3]))
in1Sub90933 = tf.keras.layers.Input(shape=([3, 3]))

Dot40787 = keras.layers.Dot(axes=(1, 1), name = 'Dot40787', )([in0Dot40787,in1Dot40787])
Con69744 = keras.layers.Concatenate(axis=2, name = 'Con69744', )([Dot40787,in0Con69744])
Sub90933 = keras.layers.Subtract(name = 'Sub90933', )([in0Sub90933,in1Sub90933])
Dot81735 = keras.layers.Dot(axes=(2, 2), name = 'Dot81735', )([Con69744,Sub90933])
Ave83281 = keras.layers.AveragePooling2D(pool_size=(1, 1), strides=(1, 11), padding='valid', name = 'Ave83281', )(Dot81735)
model = tf.keras.models.Model(inputs=[in0Dot40787,in1Dot40787,in0Con69744,in0Sub90933,in1Sub90933], outputs=Ave83281)
in0Dot40787 = tf.constant([[[0.2152, 0.4981], [0.2973, 0.7639], [0.4321, 0.1718]]])
in1Dot40787 = tf.constant([[[0.2117, 0.606], [0.4932, 0.4395], [0.4529, 0.3138]]])
in0Con69744 = tf.constant([[[0.4874], [0.254]]])
in0Sub90933 = tf.constant([[[0.9228, 0.0295, 0.4879], [0.0302, 0.0655, 0.0433], [0.6791, 0.3966, 0.0312]]])
in1Sub90933 = tf.constant([[[0.3238, 0.3501, 0.2323], [0.1368, 0.8099, 0.6154], [0.9201, 0.3392, 0.2644]]])
print (np.array2string(model.predict([in0Dot40787,in1Dot40787,in0Con69744,in0Sub90933,in1Sub90933],steps=1), separator=', '))


LDot40787 = dot_layer([[[0.2152, 0.4981], [0.2973, 0.7639], [0.4321, 0.1718]]], [[[0.2117, 0.606], [0.4932, 0.4395], [0.4529, 0.3138]]], 1, 1, Dot40787), 
LCon69744 = concatenate_layer([Dot40787,[[[0.4874], [0.254]]]], 2, Con69744), 
LSub90933 = subtract_layer([[[0.9228, 0.0295, 0.4879], [0.0302, 0.0655, 0.0433], [0.6791, 0.3966, 0.0312]]], [[[0.3238, 0.3501, 0.2323], [0.1368, 0.8099, 0.6154], [0.9201, 0.3392, 0.2644]]], Sub90933), 
LDot81735 = dot_layer(Con69744,Sub90933, 2, 2, Dot81735), 
LAve83281 = average_pooling2D_layer(Dot81735, 1, 1, 1, 11, false, Ave83281), 
exec_layers([LDot40787,LCon69744,LSub90933,LDot81735,LAve83281],["Dot40787","Con69744","Sub90933","Dot81735","Ave83281"],Ave83281,"Ave83281")

Actual (Unparsed): 
 ValueError('Input ' + str(input_index) + ' of layer ' +ValueError: Input 0 of layer Ave83281 is incompatible with the layer: expected ndim=4, found ndim=3. Full shape received: (None, 2, 3)

Expected (Unparsed): 
Ave83281: Dimension error, Input Shape [1,2,3]

Actual:   

Expected: 