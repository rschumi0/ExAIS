import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Min38268 = tf.keras.layers.Input(shape=([1, 1, 1]))
in1Min38268 = tf.keras.layers.Input(shape=([1, 1, 1]))

Min38268 = keras.layers.Minimum(name = 'Min38268', )([in0Min38268,in1Min38268])
Sep56532 = keras.layers.SeparableConv1D(4, (1),strides=(1), padding='same', name = 'Sep56532', )(Min38268)
GRU85055 = keras.layers.RNN(keras.layers.GRUCell(3,reset_after=True, recurrent_activation='sigmoid', ), name = 'GRU85055',)(Sep56532)
model = tf.keras.models.Model(inputs=[in0Min38268,in1Min38268], outputs=GRU85055)
w = model.get_layer('Sep56532').get_weights() 
w[0] = np.array([[[0.3761], [0.1499]]])
w[1] = np.array([[[0.5463, 0.1909, 0.3254, 0.3498], [0.9256, 0.31, 0.7332, 0.8233]]])
w[2] = np.array([0, 0, 0, 0])
model.get_layer('Sep56532').set_weights(w) 
w = model.get_layer('GRU85055').get_weights() 
w[0] = np.array([[10, 8, 5, 3, 6, 10, 5, 3, 2], [7, 4, 9, 8, 4, 2, 7, 5, 8]])
w[1] = np.array([[4, 7, 8, 3, 8, 8, 8, 9, 10], [8, 8, 9, 2, 7, 10, 7, 6, 5], [9, 7, 9, 7, 2, 3, 2, 4, 8]])
w[2] = np.array([[8, 7, 8, 9, 2, 1, 6, 7, 8], [2, 6, 9, 1, 8, 9, 7, 8, 5]])
model.get_layer('GRU85055').set_weights(w) 
in0Min38268 = tf.constant([[[[0.7153]]]])
in1Min38268 = tf.constant([[[[0.021]]]])
print (np.array2string(model.predict([in0Min38268,in1Min38268],steps=1), separator=', '))


LMin38268 = minimum_layer([[[[[0.7153]]]], [[[[0.021]]]]], Min38268), 
LSep56532 = separable_conv1D_layer(Min38268, 1,[[[[0.3761], [0.1499]]],[[[0.5463, 0.1909, 0.3254, 0.3498], [0.9256, 0.31, 0.7332, 0.8233]]]],[0, 0, 0, 0], 1, true, Sep56532), 
LGRU85055 = grucell_layer(Sep56532,[[10, 8, 5, 3, 6, 10, 5, 3, 2], [7, 4, 9, 8, 4, 2, 7, 5, 8]],[[4, 7, 8, 3, 8, 8, 8, 9, 10], [8, 8, 9, 2, 7, 10, 7, 6, 5], [9, 7, 9, 7, 2, 3, 2, 4, 8]],[[8, 7, 8, 9, 2, 1, 6, 7, 8], [2, 6, 9, 1, 8, 9, 7, 8, 5]], true, GRU85055), 
exec_layers([LMin38268,LSep56532,LGRU85055],["Min38268","Sep56532","GRU85055"],GRU85055,"GRU85055")

Actual (Unparsed): 
 ValueError(str(e))ValueError: Shape must be rank 4 but is rank 5 for '{{node Sep56532/separable_conv2d/depthwise}} = DepthwiseConv2dNative[T=DT_DOUBLE, data_format="NHWC", dilations=[1, 1, 1, 1], explicit_paddings=[], padding="SAME", strides=[1, 1, 1, 1]](Sep56532/ExpandDims, Sep56532/ExpandDims_1)' with input shapes: [?,1,1,1,1], [1,1,1,1].

Expected (Unparsed): 
Sep56532: Dimension error, Input Shape [1,1,1,1]

Actual:   

Expected: 