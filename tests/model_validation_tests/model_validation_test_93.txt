import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul95734 = tf.keras.layers.Input(shape=([1, 2, 2]))
in1Mul95734 = tf.keras.layers.Input(shape=([1, 2, 2]))
in0Dot70854 = tf.keras.layers.Input(shape=([2, 3]))
in1Dot70854 = tf.keras.layers.Input(shape=([2, 3]))

Mul95734 = keras.layers.Multiply(name = 'Mul95734', )([in0Mul95734,in1Mul95734])
Res26062 = keras.layers.Reshape((1, 4), name = 'Res26062', )(Mul95734)
Zer12426 = keras.layers.ZeroPadding1D(padding=((1, 0)), name = 'Zer12426', )(Res26062)
Dot70854 = keras.layers.Dot(axes=(2, 2), name = 'Dot70854', )([in0Dot70854,in1Dot70854])
Sub6884 = keras.layers.Subtract(name = 'Sub6884', )([Zer12426,Dot70854])
Glo55551 = keras.layers.GlobalMaxPool1D(name = 'Glo55551', )(Sub6884)
model = tf.keras.models.Model(inputs=[in0Mul95734,in1Mul95734,in0Dot70854,in1Dot70854], outputs=Glo55551)
in0Mul95734 = tf.constant([[[[0.8187, 0.6871], [0.407, 0.229]]]])
in1Mul95734 = tf.constant([[[[0.5777, 0.3816], [0.6818, 0.2053]]]])
in0Dot70854 = tf.constant([[[0.1263, 0.5532, 0.7108], [0.9752, 0.853, 0.2511]]])
in1Dot70854 = tf.constant([[[0.7768, 0.1462, 0.3416], [0.2731, 0.4961, 0.9719]]])
print (np.array2string(model.predict([in0Mul95734,in1Mul95734,in0Dot70854,in1Dot70854],steps=1), separator=', '))


LMul95734 = multiply_layer([[[[[0.8187, 0.6871], [0.407, 0.229]]]], [[[[0.5777, 0.3816], [0.6818, 0.2053]]]]], Mul95734), 
LRes26062 = reshape_layer(Mul95734, [1, 4], Res26062), 
LZer12426 = zero_padding1D_layer(Res26062, 1, 0, Zer12426), 
LDot70854 = dot_layer([[[0.1263, 0.5532, 0.7108], [0.9752, 0.853, 0.2511]]], [[[0.7768, 0.1462, 0.3416], [0.2731, 0.4961, 0.9719]]], 2, 2, Dot70854), 
LSub6884 = subtract_layer(Zer12426,Dot70854, Sub6884), 
LGlo55551 = global_max_pool1D_layer(Sub6884, Glo55551), 
exec_layers([LMul95734,LRes26062,LZer12426,LDot70854,LSub6884,LGlo55551],["Mul95734","Res26062","Zer12426","Dot70854","Sub6884","Glo55551"],Glo55551,"Glo55551")

Actual (Unparsed): 
 ValueError(ValueError: Operands could not be broadcast together with shapes (2, 4) (2, 2)

Expected (Unparsed): 
Sub6884: Inconsistent Input Shapes, Input Shape [1,2,4]

Actual:   

Expected: 