import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Glo44061 = tf.keras.layers.Input(shape=([1, 2, 2, 1]))
in0Max16346 = tf.keras.layers.Input(shape=([2, 1, 1]))

Glo44061 = keras.layers.GlobalMaxPool3D(name = 'Glo44061', )(in0Glo44061)
Res31678 = keras.layers.Reshape((1, 1), name = 'Res31678', )(Glo44061)
Res17482 = keras.layers.Reshape((1, 1, 1), name = 'Res17482', )(Res31678)
Zer26659 = keras.layers.ZeroPadding2D(padding=((1, 0), (0, 0)), name = 'Zer26659', )(Res17482)
Max16346 = keras.layers.MaxPool2D(pool_size=(1, 1), name = 'Max16346', )(in0Max16346)
Bat48170 = keras.layers.BatchNormalization(axis=2, epsilon=0.40184533390417543,  name = 'Bat48170', )(Max16346)
Dep33129 = keras.layers.DepthwiseConv2D((1, 1),strides=(1, 1), padding='valid', name = 'Dep33129', )(Bat48170)
Add98589 = keras.layers.Add(name = 'Add98589', )([Zer26659,Dep33129])
Cro54192 = keras.layers.Cropping1D(cropping=((1, 0)), name = 'Cro54192', )(Add98589)
model = tf.keras.models.Model(inputs=[in0Glo44061,in0Max16346], outputs=Cro54192)
w = model.get_layer('Bat48170').get_weights() 
w[0] = np.array([0.6381])
w[1] = np.array([0.9511])
w[2] = np.array([0.04])
w[3] = np.array([0.5198])
model.get_layer('Bat48170').set_weights(w) 
w = model.get_layer('Dep33129').get_weights() 
w[0] = np.array([[[[0.8275]]]])
w[1] = np.array([0])
model.get_layer('Dep33129').set_weights(w) 
in0Glo44061 = tf.constant([[[[[1.309], [1.1989]], [[1.5524], [1.2165]]]]])
in0Max16346 = tf.constant([[[[1.6496]], [[1.7404]]]])
print (np.array2string(model.predict([in0Glo44061,in0Max16346],steps=1), separator=', '))


LGlo44061 = global_max_pool3D_layer([[[[[1.309], [1.1989]], [[1.5524], [1.2165]]]]], Glo44061), 
LRes31678 = reshape_layer(Glo44061, [1, 1], Res31678), 
LRes17482 = reshape_layer(Res31678, [1, 1, 1], Res17482), 
LZer26659 = zero_padding2D_layer(Res17482, 1, 0, 0, 0, Zer26659), 
LMax16346 = max_pool2D_layer([[[[1.6496]], [[1.7404]]]], 1, 1, Max16346), 
LBat48170 = batch_normalization_layer(Max16346, 2, 0.40184533390417543, [0.6381], [0.9511], [0.04], [0.5198], Bat48170), 
LDep33129 = depthwise_conv2D_layer(Bat48170, 1, 1,[[[[0.8275]]]],[0], 1, 1, false, Dep33129), 
LAdd98589 = add_layer([Zer26659,Dep33129], Add98589), 
LCro54192 = cropping1D_layer(Add98589, 1, 0, Cro54192), 
exec_layers([LGlo44061,LRes31678,LRes17482,LZer26659,LMax16346,LBat48170,LDep33129,LAdd98589,LCro54192],["Glo44061","Res31678","Res17482","Zer26659","Max16346","Bat48170","Dep33129","Add98589","Cro54192"],Cro54192,"Cro54192")

Actual (Unparsed): 
 ValueError('Input ' + str(input_index) + ' of layer ' +ValueError: Input 0 of layer Cro54192 is incompatible with the layer: expected ndim=3, found ndim=4. Full shape received: (None, 2, 1, 1)

Expected (Unparsed): 
Cro54192: Dimension error, Input Shape [1,2,1,1]

Actual:   

Expected: 