import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave49364 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))
in1Ave49364 = tf.keras.layers.Input(shape=([1, 1, 1, 2]))

Ave49364 = keras.layers.Average(name = 'Ave49364', )([in0Ave49364,in1Ave49364])
Res49778 = keras.layers.Reshape((1, 1, 2), name = 'Res49778', )(Ave49364)
Res65084 = keras.layers.Reshape((1, 2), name = 'Res65084', )(Res49778)
GRU15004 = keras.layers.GRU(1,reset_after=True, recurrent_activation='sigmoid', name = 'GRU15004', )(Res65084)
Res39600 = keras.layers.Reshape((1, 1), name = 'Res39600', )(GRU15004)
Res17395 = keras.layers.Reshape((1, 1, 1), name = 'Res17395', )(Res39600)
Zer90076 = keras.layers.ZeroPadding3D(padding=((1, 1), (1, 1), (1, 1)), name = 'Zer90076', )(Res17395)
model = tf.keras.models.Model(inputs=[in0Ave49364,in1Ave49364], outputs=Zer90076)
w = model.get_layer('GRU15004').get_weights() 
w[0] = np.array([[3, 10, 7], [4, 5, 3]])
w[1] = np.array([[1, 6, 6]])
w[2] = np.array([[3, 7, 3], [1, 3, 9]])
model.get_layer('GRU15004').set_weights(w) 
in0Ave49364 = tf.constant([[[[[0.5376, 0.0646]]]]])
in1Ave49364 = tf.constant([[[[[0.3721, 0.8553]]]]])
print (np.array2string(model.predict([in0Ave49364,in1Ave49364],steps=1), separator=', '))


LAve49364 = average_layer([[[[[[0.5376, 0.0646]]]]], [[[[[0.3721, 0.8553]]]]]], Ave49364), 
LRes49778 = reshape_layer(Ave49364, [1, 1, 2], Res49778), 
LRes65084 = reshape_layer(Res49778, [1, 2], Res65084), 
LGRU15004 = gru_layer(Res65084,[[3, 10, 7], [4, 5, 3]],[[1, 6, 6]],[[3, 7, 3], [1, 3, 9]], true, GRU15004), 
LRes39600 = reshape_layer(GRU15004, [1, 1], Res39600), 
LRes17395 = reshape_layer(Res39600, [1, 1, 1], Res17395), 
LZer90076 = zero_padding3D_layer(Res17395, 1, 1, 1, 1, 1, 1, Zer90076), 
exec_layers([LAve49364,LRes49778,LRes65084,LGRU15004,LRes39600,LRes17395,LZer90076],["Ave49364","Res49778","Res65084","GRU15004","Res39600","Res17395","Zer90076"],Zer90076,"Zer90076")

Actual (Unparsed): 
 ValueError('Input ' + str(input_index) + ' of layer ' +ValueError: Input 0 of layer Zer90076 is incompatible with the layer: expected ndim=5, found ndim=4. Full shape received: (None, 1, 1, 1)

Expected (Unparsed): 
Zer90076: Dimension error, Input Shape [1,1,1,1]

Actual:   

Expected: 