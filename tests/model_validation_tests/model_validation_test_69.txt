import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul23258 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))
in1Mul23258 = tf.keras.layers.Input(shape=([1, 2, 1, 2]))

Mul23258 = keras.layers.Multiply(name = 'Mul23258', )([in0Mul23258,in1Mul23258])
Res17547 = keras.layers.Reshape((1, 2, 2), name = 'Res17547', )(Mul23258)
Ave5444 = keras.layers.AveragePooling2D(pool_size=(1, 2), name = 'Ave5444', )(Res17547)
Res73957 = keras.layers.Reshape((1, 2), name = 'Res73957', )(Ave5444)
Fla13731 = keras.layers.Flatten(name = 'Fla13731', )(Res73957)
Fla51315 = keras.layers.Flatten(name = 'Fla51315', )(Fla13731)
PRe69599 = keras.layers.PReLU(name = 'PRe69599', )(Fla51315)
model = tf.keras.models.Model(inputs=[in0Mul23258,in1Mul23258], outputs=PRe69599)
w = model.get_layer('PRe69599').get_weights() 
w[0] = np.array([[[[0.0322]]], [[[0.7536]]]])
model.get_layer('PRe69599').set_weights(w) 
in0Mul23258 = tf.constant([[[[[0.0368, 0.5183]], [[0.6129, 0.6316]]]]])
in1Mul23258 = tf.constant([[[[[0.1102, 0.87]], [[0.7027, 0.9444]]]]])
print (np.array2string(model.predict([in0Mul23258,in1Mul23258],steps=1), separator=', '))


LMul23258 = multiply_layer([[[[[[0.0368, 0.5183]], [[0.6129, 0.6316]]]]], [[[[[0.1102, 0.87]], [[0.7027, 0.9444]]]]]], Mul23258), 
LRes17547 = reshape_layer(Mul23258, [1, 2, 2], Res17547), 
LAve5444 = average_pooling2D_layer(Res17547, 1, 2, Ave5444), 
LRes73957 = reshape_layer(Ave5444, [1, 2], Res73957), 
LFla13731 = flatten_layer(Res73957, Fla13731), 
LFla51315 = flatten_layer(Fla13731, Fla51315), 
LPRe69599 = prelu_layer(Fla51315, [[[[0.0322]]], [[[0.7536]]]], PRe69599), 
exec_layers([LMul23258,LRes17547,LAve5444,LRes73957,LFla13731,LFla51315,LPRe69599],["Mul23258","Res17547","Ave5444","Res73957","Fla13731","Fla51315","PRe69599"],PRe69599,"PRe69599")

Actual (Unparsed): 
 ValueError(ValueError: Layer weight shape (2,) not compatible with provided weight shape (2, 1, 1, 1)

Expected (Unparsed): 
PRe69599: Inconsistent Input Dimensions, Input Shape [1,2]

Actual:   

Expected: 