import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Mul38519 = tf.keras.layers.Input(shape=([2, 1]))
in1Mul38519 = tf.keras.layers.Input(shape=([2, 1]))

Mul38519 = keras.layers.Multiply(name = 'Mul38519', )([in0Mul38519,in1Mul38519])
Ave46982 = keras.layers.AveragePooling1D(pool_size=(2), name = 'Ave46982', )(Mul38519)
Res96232 = keras.layers.Reshape((1, 1, 1), name = 'Res96232', )(Ave46982)
Res37643 = keras.layers.Reshape((1, 1, 1, 1), name = 'Res37643', )(Res96232)
Con21851 = keras.layers.Conv3D(4, (1, 1, 1),strides=(1, 1, 1), padding='valid', dilation_rate=(1, 1, 1), name = 'Con21851', )(Res37643)
Glo35375 = keras.layers.GlobalMaxPool2D(name = 'Glo35375', )(Con21851)
model = tf.keras.models.Model(inputs=[in0Mul38519,in1Mul38519], outputs=Glo35375)
w = model.get_layer('Con21851').get_weights() 
w[0] = np.array([[[[[0.4011, 0.0621, 0.0555, 0.4385]]]]])
w[1] = np.array([0, 0, 0, 0])
model.get_layer('Con21851').set_weights(w) 
in0Mul38519 = tf.constant([[[0.9813], [0.7295]]])
in1Mul38519 = tf.constant([[[0.8984], [0.399]]])
print (np.array2string(model.predict([in0Mul38519,in1Mul38519],steps=1), separator=', '))


LMul38519 = multiply_layer([[[[0.9813], [0.7295]]], [[[0.8984], [0.399]]]], Mul38519), 
LAve46982 = average_pooling1D_layer(Mul38519, 2, Ave46982), 
LRes96232 = reshape_layer(Ave46982, [1, 1, 1], Res96232), 
LRes37643 = reshape_layer(Res96232, [1, 1, 1, 1], Res37643), 
LCon21851 = conv3D_layer(Res37643, 1, 1, 1,[[[[[0.4011, 0.0621, 0.0555, 0.4385]]]]],[0, 0, 0, 0], 1, 1, 1, false, 1, 1, 1, Con21851), 
LGlo35375 = global_max_pool2D_layer(Con21851, Glo35375), 
exec_layers([LMul38519,LAve46982,LRes96232,LRes37643,LCon21851,LGlo35375],["Mul38519","Ave46982","Res96232","Res37643","Con21851","Glo35375"],Glo35375,"Glo35375")

Actual (Unparsed): 
 ValueError('Input ' + str(input_index) + ' of layer ' +ValueError: Input 0 of layer Glo35375 is incompatible with the layer: expected ndim=4, found ndim=5. Full shape received: (None, 1, 1, 1, 4)

Expected (Unparsed): 
Glo35375: Dimension error, Input Shape [1,1,1,1,4]

Actual:   

Expected: 