import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Ave86748 = tf.keras.layers.Input(shape=([2, 1]))
in0Max86278 = tf.keras.layers.Input(shape=([2, 2]))
in1Max86278 = tf.keras.layers.Input(shape=([2, 2]))

Ave86748 = keras.layers.AveragePooling1D(pool_size=(1), name = 'Ave86748', )(in0Ave86748)
Res27926 = keras.layers.Reshape((2, 1, 1), name = 'Res27926', )(Ave86748)
Res56155 = keras.layers.Reshape((2, 1, 1, 1), name = 'Res56155', )(Res27926)
Con31268 = keras.layers.Conv3D(3, (2, 1, 1),strides=(1, 1, 1), padding='same', dilation_rate=(1, 1, 1), name = 'Con31268', )(Res56155)
Res16330 = keras.layers.Reshape((2, 1, 3), name = 'Res16330', )(Con31268)
Res47228 = keras.layers.Reshape((2, 3), name = 'Res47228', )(Res16330)
Max86278 = keras.layers.Maximum(name = 'Max86278', )([in0Max86278,in1Max86278])
Sub46904 = keras.layers.Subtract(name = 'Sub46904', )([Res47228,Max86278])
model = tf.keras.models.Model(inputs=[in0Ave86748,in0Max86278,in1Max86278], outputs=Sub46904)
w = model.get_layer('Con31268').get_weights() 
w[0] = np.array([[[[[0.1148, 0.0263, 0.0564]]]], [[[[0.686, 0.1854, 0.6128]]]]])
w[1] = np.array([0, 0, 0])
model.get_layer('Con31268').set_weights(w) 
in0Ave86748 = tf.constant([[[1.6265], [1.4514]]])
in0Max86278 = tf.constant([[[0.832, 0.5449], [0.2491, 0.4419]]])
in1Max86278 = tf.constant([[[0.082, 0.1211], [0.3318, 0.9031]]])
print (np.array2string(model.predict([in0Ave86748,in0Max86278,in1Max86278],steps=1), separator=', '))


LAve86748 = average_pooling1D_layer([[[1.6265], [1.4514]]], 1, Ave86748), 
LRes27926 = reshape_layer(Ave86748, [2, 1, 1], Res27926), 
LRes56155 = reshape_layer(Res27926, [2, 1, 1, 1], Res56155), 
LCon31268 = conv3D_layer(Res56155, 2, 1, 1,[[[[[0.1148, 0.0263, 0.0564]]]], [[[[0.686, 0.1854, 0.6128]]]]],[0, 0, 0], 1, 1, 1, true, 1, 1, 1, Con31268), 
LRes16330 = reshape_layer(Con31268, [2, 1, 3], Res16330), 
LRes47228 = reshape_layer(Res16330, [2, 3], Res47228), 
LMax86278 = maximum_layer([[[[0.832, 0.5449], [0.2491, 0.4419]]], [[[0.082, 0.1211], [0.3318, 0.9031]]]], Max86278), 
LSub46904 = subtract_layer(Res47228,Max86278, Sub46904), 
exec_layers([LAve86748,LRes27926,LRes56155,LCon31268,LRes16330,LRes47228,LMax86278,LSub46904],["Ave86748","Res27926","Res56155","Con31268","Res16330","Res47228","Max86278","Sub46904"],Sub46904,"Sub46904")

Actual (Unparsed): 
 ValueError(ValueError: Operands could not be broadcast together with shapes (2, 3) (2, 2)

Expected (Unparsed): 
Sub46904: Inconsistent Input Shapes, Input Shape [1,2,3]

Actual:   

Expected: 