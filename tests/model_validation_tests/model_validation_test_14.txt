import os
os.environ['TF_CPP_MIN_LOG_LEVEL'] = '2'
import tensorflow as tf
from tensorflow import keras
from tensorflow.keras import layers
import numpy as np
np.set_printoptions(suppress=True,threshold=np.inf,formatter={'float_kind':'{:16.7f}'.format})
tf.keras.backend.set_floatx('float64')
in0Sim1344 = tf.keras.layers.Input(shape=([3, 2]))

Sim1344 = keras.layers.RNN(keras.layers.SimpleRNNCell(3,), name = 'Sim1344', input_shape=(3, 2))(in0Sim1344)
Res32872 = keras.layers.Reshape((3, 1), name = 'Res32872', )(Sim1344)
LST3175 = keras.layers.LSTM(2,recurrent_activation='sigmoid', name = 'LST3175', )(Res32872)
Glo56601 = keras.layers.GlobalMaxPool1D(name = 'Glo56601', )(LST3175)
model = tf.keras.models.Model(inputs=[in0Sim1344], outputs=Glo56601)
w = model.get_layer('Sim1344').get_weights() 
w[0] = np.array([[6, 7, 9], [3, 7, 2]])
w[1] = np.array([[7, 7, 4], [1, 9, 2], [2, 3, 7]])
w[2] = np.array([3, 4, 8])
model.get_layer('Sim1344').set_weights(w) 
w = model.get_layer('LST3175').get_weights() 
w[0] = np.array([[8, 2, 4, 5, 3, 2, 2, 9]])
w[1] = np.array([[3, 5, 3, 10, 5, 8, 7, 8], [8, 7, 10, 7, 8, 4, 8, 2]])
w[2] = np.array([4, 8, 10, 2, 9, 8, 1, 10])
model.get_layer('LST3175').set_weights(w) 
in0Sim1344 = tf.constant([[[9, 5], [6, 3], [5, 9]]])
print (np.array2string(model.predict([in0Sim1344],steps=1), separator=', '))


LSim1344 = simple_rnncell_layer([[[9, 5], [6, 3], [5, 9]]],[[6, 7, 9], [3, 7, 2]],[[7, 7, 4], [1, 9, 2], [2, 3, 7]],[3, 4, 8], Sim1344), 
LRes32872 = reshape_layer(Sim1344, [3, 1], Res32872), 
LLST3175 = lstm_layer(Res32872,[[8, 2, 4, 5, 3, 2, 2, 9]],[[3, 5, 3, 10, 5, 8, 7, 8], [8, 7, 10, 7, 8, 4, 8, 2]],[4, 8, 10, 2, 9, 8, 1, 10], LST3175), 
LGlo56601 = global_max_pool1D_layer(LST3175, Glo56601), 
exec_layers([LSim1344,LRes32872,LLST3175,LGlo56601],["Sim1344","Res32872","LST3175","Glo56601"],Glo56601,"Glo56601")

Actual (Unparsed): 
 ValueError('Input ' + str(input_index) + ' of layer ' +ValueError: Input 0 of layer Glo56601 is incompatible with the layer: expected ndim=3, found ndim=2. Full shape received: (None, 2)

Expected (Unparsed): 
Glo56601: Dimension error, Input Shape [1,2]

Actual:   

Expected: 